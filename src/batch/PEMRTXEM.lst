* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMRTXEM.cbl
* Options: int("PEMRTXEM.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMRTXEM.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMRTXEM.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "PEMRTXEM.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMRTXEM.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT DAT-IN           ASSIGN TO DATIN
    10        ORGANIZATION IS LINE SEQUENTIAL.
    11
    12     SELECT RATE-IN          ASSIGN TO RATEIN
    13        ORGANIZATION IS LINE SEQUENTIAL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMRTXEM.cbl
    14
    15     SELECT ERRATE           ASSIGN TO ERRATE
    16                             ORGANIZATION IS INDEXED
    17                             ACCESS IS DYNAMIC
    18                             RECORD KEY IS RT-CONTROL-PRIMARY
    19                             FILE STATUS IS ERRATE-FILE-STATUS.
    20
    21     SELECT DISK-DATE      ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    22
    23     SELECT INS-OUT          ASSIGN TO INSOUT
    24        ORGANIZATION IS LINE SEQUENTIAL.
    25
    26     SELECT DAT-OUT          ASSIGN TO DATOUT
    27        ORGANIZATION IS LINE SEQUENTIAL.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD  DAT-IN
    33     RECORDING MODE F
    34     LABEL RECORDS STANDARD
    35     BLOCK CONTAINS 0 RECORDS.
    36
    37 01  DAT-IN-REC                  PIC X(100).
    38
    39 FD  ERRATE.
    40
*   41                                 COPY ERCRATE.
    42******************************************************************01/20/90
    43*                                                                *ERCRATE
    44*                                                                *ERCRATE
    45*                            ERCRATE                             *   LV007
    46*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    47*                            VMOD=2.008                          *   CL**7
    48*                                                                *ERCRATE
    49*   ONLINE CREDIT SYSTEM                                         *ERCRATE
    50*                                                                *ERCRATE
    51*   FILE DESCRIPTION = RATES MASTER FILE                         *ERCRATE
    52*                                                                *ERCRATE
    53*   FILE TYPE = VSAM,KSDS                                        *ERCRATE
    54*   RECORD SIZE = 1765  RECFORM = FIXED                          *ERCRATE
    55*                                                                *ERCRATE
    56*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *ERCRATE
    57*       ALTERNATE PATH = NONE                                    *ERCRATE
    58*                                                                *ERCRATE
    59*   LOG = NO                                                     *ERCRATE
    60*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRATE
    61*                                                                *ERCRATE
    62******************************************************************ERCRATE
    63                                                                  ERCRATE
    64 01  RATE-RECORD.                                                 ERCRATE
    65     12  RT-RECORD-ID                      PIC XX.                ERCRATE
    66         88  VALID-RT-ID                      VALUE 'RT'.         ERCRATE
    67                                                                  ERCRATE
    68     12  RT-CONTROL-PRIMARY.                                      ERCRATE
    69         16  RT-COMPANY-CD                 PIC X.                 ERCRATE
    70         16  RT-STATE-CODE.                                       ERCRATE
    71             20  RT-ST-CODE                PIC XX.                ERCRATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ERCRATE)
    72             20  RT-ST-CLASS               PIC XX.                ERCRATE
    73             20  RT-ST-DEV                 PIC XXX.               ERCRATE
    74         16  RT-L-AH-CODE.                                        ERCRATE
    75             20  RT-L-AH                   PIC X.                 ERCRATE
    76             20  RT-LAH-NUM                PIC XX.                   CL**3
    77         16  RT-LIMITS.                                           ERCRATE
    78             20  RT-HIGH-AGE               PIC 99.                ERCRATE
    79             20  RT-HIGH-AMT               PIC 9(6).              ERCRATE
    80             20  RT-FUTURE                 PIC XX.                ERCRATE
    81             20  RT-SEX                    PIC X.                 ERCRATE
    82         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.     ERCRATE
    83                                                                  ERCRATE
    84     12  RT-MAINT-INFORMATION.                                    ERCRATE
    85         16  RT-LAST-MAINT-DT              PIC XX.                ERCRATE
    86         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCRATE
    87         16  RT-LAST-MAINT-USER            PIC X(4).              ERCRATE
    88         16  FILLER                        PIC X(10).             ERCRATE
    89                                                                  ERCRATE
    90     12  RT-STRUCTURE-COMMENT              PIC X(50).             ERCRATE
    91     12  RT-RATE-COMMENT                   PIC X(50).             ERCRATE
    92                                                                  ERCRATE
    93     12  CSL-RESERVED                      PIC X(10).                CL**7
    94     12  FILLER                            PIC X(12).                CL**7
    95                                                                  ERCRATE
    96     12  RT-MAX-AGE                        PIC 99.                ERCRATE
    97                                                                  ERCRATE
    98     12  RT-LIFE-LIMS-FLDS.                                       ERCRATE
    99         16  RT-LIFE-MORT-CODE             PIC X(4).              ERCRATE
   100         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.                 ERCRATE
   101             20  RT-L-EX-AGE               PIC 99.                ERCRATE
   102             20  RT-L-EX-TERM              PIC S999       COMP-3. ERCRATE
   103             20  RT-L-EX-FACE              PIC S9(7)      COMP-3. ERCRATE
   104         16  FILLER                        PIC X(20).             ERCRATE
   105                                                                  ERCRATE
   106     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.         ERCRATE
   107         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.                   ERCRATE
   108             20  RT-AH-AGE                 PIC 99.                ERCRATE
   109             20  RT-AH-TERM                PIC S999       COMP-3. ERCRATE
   110             20  RT-AH-BEN-M               PIC S9(5)      COMP-3. ERCRATE
   111             20  RT-AH-BEN-F               PIC S9(7)      COMP-3. ERCRATE
   112                                                                  ERCRATE
   113     12  RT-LIFE-RATES.                                           ERCRATE
   114         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3. ERCRATE
   115                                                                  ERCRATE
   116     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.                 ERCRATE
   117         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3. ERCRATE
   118                                                                  ERCRATE
   119     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.    CL**2
   120                                                                     CL**2
   121     12  RT-DISCOUNT-OPTION                PIC X.                    CL**5
   122         88  RT-DO-NOT-USE                     VALUE ' '.            CL**5
   123         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.            CL**5
   124         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.            CL**5
   125                                                                     CL**5
   126     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.    CL**5
   127     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.    CL**5
   128                                                                     CL**5
   129     12  RT-COMPOSITE-OPTION               PIC X.                    CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ERCRATE)
   130         88  RT-NO-COMPOSITE                   VALUE ' '.            CL**6
   131         88  RT-USE-COMPOSITE-RATE             VALUE '1'.            CL**6
   132                                                                     CL**6
   133     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.    CL**6
   134                                                                     CL**6
   135     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.    CL**7
   136     12  FILLER                            PIC X(13).                CL**7
   137                                                                     CL**4
   138     12  RT-TYPE-RATE                      PIC X.                    CL**4
   139         88  RT-IS-STND                        VALUE ' ' 'S'.        CL**4
   140         88  RT-IS-OB                          VALUE 'O'.            CL**4
   141                                                                  ERCRATE
   142     12  RT-SRT-ALPHA                      PIC X.                 ERCRATE
   143                                                                  ERCRATE
   144     12  RT-CONTROL-2.                                            ERCRATE
   145         16  RTC-1                         PIC X(7).              ERCRATE
   146         16  RTC-3                         PIC X(11).             ERCRATE
   147         16  RTC-4                         PIC 9(11) COMP-3.      ERCRATE
   148         16  RTC-2                         PIC X(3).              ERCRATE
   149******************************************************************ERCRATE
   150
   151 FD  DISK-DATE
*  152                                 COPY ELCDTEFD.
   153******************************************************************04/15/98
   154*                                                                *ELCDTEFD
   155*                                                                *ELCDTEFD
   156*                            ELCDTEFD.                           *   LV002
   157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   158*                            VMOD=2.007                          *   CL**2
   159*                                                                *ELCDTEFD
   160******************************************************************ELCDTEFD
   161     BLOCK CONTAINS 0 RECORDS
   162     RECORDING MODE F.                                            ELCDTEFD
   163                                                                  ELCDTEFD
   164 01  DATE-DISK.                                                   ELCDTEFD
   165     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   166     12  FILLER                      PIC  X(14).                  ELCDTEFD
   167     12  DD-CR1                      PIC  9.                      ELCDTEFD
   168     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   169     12  DD-CR2                      PIC  9.                      ELCDTEFD
   170     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   171     12  FILLER                      PIC  X(20).                  ELCDTEFD
   172                                                                  ELCDTEFD
   173 01  DATE-DISK-R.                                                 ELCDTEFD
   174     12  FILLER                      PIC  X(4).                   ELCDTEFD
   175     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   176                                     PIC  X(32).                  ELCDTEFD
   177                                                                  ELCDTEFD
   178 01  DATE-DISK-T.                                                 ELCDTEFD
   179     12  FILLER                      PIC  X(4).                   ELCDTEFD
   180     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   181                                     PIC  X(48).                  ELCDTEFD
   182                                                                  ELCDTEFD
   183 01  DATE-DISK-M.                                                 ELCDTEFD
   184     12  FILLER                      PIC  X(4).                   ELCDTEFD
   185     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   186                                     PIC  X(48).                  ELCDTEFD
   187                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   188 01  DATE-DISK-P.                                                 ELCDTEFD
   189     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   190     12  DD-IDX                      PIC  99.                     ELCDTEFD
   191     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   192     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   193         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   194                                     PIC  X.                      ELCDTEFD
   195         16  FILLER                  PIC  X(46).                  ELCDTEFD
   196     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   197         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   198             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   199             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   200             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   201             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   202         16  FILLER                  PIC  X(16).                  ELCDTEFD
   203                                                                  ELCDTEFD
   204 01  DATE-DISK-E.                                                 ELCDTEFD
   205     12  FILLER                      PIC  X(4).                   ELCDTEFD
   206     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   207                                     PIC  X(4).                   ELCDTEFD
   208                                                                  ELCDTEFD
   209 01  DATE-DISK-C.                                                 ELCDTEFD
   210     12  FILLER                      PIC  X(7).                   ELCDTEFD
   211     12  DD-CARR1-SECPAY-SW          PIC  X.
   212     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   213     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   214     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   215     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   216     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   217     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   218     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   219     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   220     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   221     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   222     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   223     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   224     12  DD-CARR2-SECPAY-SW          PIC  X.
   225     12  FILLER                      PIC  X(7).                   ELCDTEFD
   226                                                                  ELCDTEFD
   227 01  DATE-DISK-OPT.                                               ELCDTEFD
   228     12  FILLER                      PIC  X(04).                  ELCDTEFD
   229     12  DD-TLR-DATA.                                             ELCDTEFD
   230         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   231                                     PIC  X(03).                  ELCDTEFD
   232     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   233         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   234                                     PIC  X(06).                  ELCDTEFD
   235     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   236         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   237                                     PIC  X(07).                  ELCDTEFD
   238         16  FILLER                  PIC  X(05).                  ELCDTEFD
   239     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   240                                     PIC  X(96).                  ELCDTEFD
   241******************************************************************ELCDTEFD
   242
   243 FD  RATE-IN
   244     RECORDING MODE F
   245     LABEL RECORDS STANDARD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMRTXEM.cbl
   246     BLOCK CONTAINS 0 RECORDS.
   247
   248 01  RATE-IN-REC                 PIC X(100).
   249
   250 FD  INS-OUT
   251     RECORDING MODE F
   252     LABEL RECORDS STANDARD
   253     BLOCK CONTAINS 0 RECORDS.
   254
   255 01  INS-OUT-REC                 PIC X(1645).
   256
   257 FD  DAT-OUT
   258     RECORDING MODE F
   259     LABEL RECORDS STANDARD
   260     BLOCK CONTAINS 0 RECORDS.
   261
   262 01  DAT-OUT-REC                 PIC X(10).
   263
   264 WORKING-STORAGE SECTION.
   265 77  FILLER  PIC X(32) VALUE '********************************'.
   266 77  FILLER  PIC X(32) VALUE '  PEMRTXEM WORKING STORAGE      '.
   267 77  FILLER  PIC X(32) VALUE '********************************'.
   268
   269 77  WS-EOF-SW                   PIC X VALUE SPACES.
   270     88  END-OF-ERRATE                 VALUE 'Y'.
   271 77  WS-INPUT-SW                 PIC X.
   272     88  END-OF-INPUT              VALUE 'Y'.
   273 77  WS-FOUND-MATCH              PIC X VALUE ' '.
   274     88  FOUND-MATCH               VALUE 'Y'.
   275 77  WS-TBL-RECS                 PIC 9(9) VALUE ZEROS.
   276 77  WS-IN-RECS                  PIC 9(9) VALUE ZEROS.
   277 77  INS-RECS-OUT                PIC 9(9) VALUE ZEROS.
   278 77  DAT-RECS-OUT                PIC 9(9) VALUE ZEROS.
   279 77  S1                          PIC S9(5) VALUE +0 COMP-3.
   280 77  T1                          PIC S9(5) VALUE +0 COMP-3.
   281 77  PGM-SUB                     PIC S999    COMP    VALUE +083.
   282 77  IP-RECS                     PIC S9(5) COMP-3 VALUE +0.
   283 77  WS-STATE                    PIC XX  VALUE SPACES.
   284
   285
   286 01  T1M                         PIC S9(5) VALUE +0 COMP-3.
   287 01  WS-TABLE1-AREA.
   288     12  RATE-IN-TABLE OCCURS 500.
   289         16  RATE-TABLE.
   290             20  RTI-STATE       PIC XX.
   291             20  RTI-CLASS       PIC XX.
   292             20  RTI-DEV         PIC XXX.
   293             20  RTI-TRUNC-AT-AGE
   294                                 PIC X.
   295             20  RTI-X-MOS-INT   PIC 99.
   296             20  RTI-X-MOS-PMT   PIC 99.
   297             20  RTI-CREATE-LF-RATE-TABLE
   298                                 PIC X.
   299             20  RTI-RT-TYPE-SW  PIC X.
   300             20  RTI-TYPE        PIC X.
   301             20  RTI-BEN-CODE    PIC XX.
   302             20  RTI-MAX-ELIG-AGE PIC 99.
   303             20  RTI-ATT-AGE     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMRTXEM.cbl
   304             20  RTI-THRU-AGE1   PIC 99.
   305             20  RTI-THRU-TERM1  PIC 999.
   306             20  RTI-MAX-AH-BEN1 PIC 9(5).
   307             20  RTI-MAX-LF-BEN1 PIC 9(7).
   308             20  RTI-THRU-AGE2   PIC 99.
   309             20  RTI-THRU-TERM2  PIC 999.
   310             20  RTI-MAX-AH-BEN2 PIC 9(5).
   311             20  RTI-MAX-LF-BEN2 PIC 9(7).
   312             20  RTI-THRU-AGE3   PIC 99.
   313             20  RTI-THRU-TERM3  PIC 999.
   314             20  RTI-MAX-AH-BEN3 PIC 9(5).
   315             20  RTI-MAX-LF-BEN3 PIC 9(7).
   316             20  RTI-COV-TYPE    PIC XXX.
   317             20  RTI-RATE-DESC   PIC X(25).
   318
   319 01  T2M                         PIC S9(5) VALUE +0 COMP-3.
   320 01  WS-TABLE2-AREA.
   321     12  DAT-IN-TABLE OCCURS 1000.
   322         16  DAT-TABLE.
   323             20  DAT-OPTIONS     PIC X(10)  VALUE SPACES.
   324             20  DAT-OPTIONS-RATES REDEFINES DAT-OPTIONS
   325                                 PIC ZZ99.99999 BLANK WHEN ZERO.
   326             20  DAT-OPTIONS-NUM REDEFINES DAT-OPTIONS
   327                                 PIC 9999999999 BLANK WHEN ZERO.
   328
   329 01  WS-LF-SD-RATE               PIC 9V99999  VALUE ZEROS.
   330 01  WS-LF-SL-RATE               PIC 9V99999  VALUE ZEROS.
   331 01  WS-LF-JD-RATE               PIC 9V99999  VALUE ZEROS.
   332 01  WS-LF-JL-RATE               PIC 9V99999  VALUE ZEROS.
   333
   334 01  WS-LF-SN-RATE               PIC 99V99999 VALUE ZEROS.
   335 01  WS-LF-JN-RATE               PIC 99V99999 VALUE ZEROS.
   336
   337 01  WS-TRUNC-AT-AGE             PIC X   VALUE SPACES.
   338 01  WS-RT-TYPE-SW               PIC X   VALUE ZEROS.
   339 01  WS-X-MOS-INT                PIC 99  VALUE ZEROS.
   340 01  WS-X-MOS-PMTS               PIC 99  VALUE ZEROS.
   341 01  WS-CREATE-LF-TABLE          PIC X   VALUE SPACES.
   342
   343 01  WS-AH-MAX-ELIG-AGE          PIC 99.
   344 01  WS-AH-ATT-AGE               PIC 99.
   345 01  WS-AH-AGE1                  PIC 99.
   346 01  WS-AH-TERM1                 PIC 999.
   347 01  WS-AH-AMT1                  PIC 9(5).
   348 01  WS-AH-TOT-AMT1              PIC 9(7).
   349
   350 01  WS-AH-AGE2                  PIC 99.
   351 01  WS-AH-TERM2                 PIC 999.
   352 01  WS-AH-AMT2                  PIC 9(5).
   353 01  WS-AH-TOT-AMT2              PIC 9(7).
   354
   355 01  WS-AH-AGE3                  PIC 99.
   356 01  WS-AH-TERM3                 PIC 999.
   357 01  WS-AH-AMT3                  PIC 9(5).
   358 01  WS-AH-TOT-AMT3              PIC 9(7).
   359
   360
   361 01  WS-RATE-SW                  PIC X  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMRTXEM.cbl
   362     88  MOB-RATE                  VALUE 'Y'.
   363 01  WS-LF-MAX-ELIG-AGE          PIC 99.
   364 01  WS-LF-ATT-AGE               PIC 99.
   365 01  WS-LF-AGE1                  PIC 99.
   366 01  WS-LF-TERM1                 PIC 999.
   367 01  WS-LF-AMT1                  PIC 9(7).
   368
   369 01  WS-LF-AGE2                  PIC 99.
   370 01  WS-LF-TERM2                 PIC 999.
   371 01  WS-LF-AMT2                  PIC 9(7).
   372
   373 01  WS-LF-AGE3                  PIC 99.
   374 01  WS-LF-TERM3                 PIC 999.
   375 01  WS-LF-AMT3                  PIC 9(7).
   376 01  A1                          PIC S999 COMP-3 VALUE +1.
   377 01  L1                          PIC S999 COMP-3 VALUE +1.
   378* 1=7R, 2=7E, 3=14R, 4=14E, 5=30R, 6=30E
   379 01  WS-AH-RATE-TABLES.
   380     05  FILLER OCCURS 6.
   381         10  WS-AH-TABLE         PIC X(10).
   382
   383 01  WS-LF-RATE-TABLES.
   384     05  FILLER OCCURS 4.
   385         10  WS-LF-TABLE         PIC X(10).
   386
   387 01  RATE-OUT-EXTRACT.
   388     12  EX-STATE                PIC XXX.
   389     12  EX-BENCD-DESC           PIC X(10).
   390     12  EX-D1                   PIC X.
   391     12  EX-MAX-MOS              PIC 999.
   392     12  EX-D2                   PIC X.
   393     12  EX-MIN-MOS              PIC 999.
   394     12  EX-D3                   PIC X.
   395     12  FILLER OCCURS 180.
   396         16  EX-RATE             PIC 99.99999.
   397         16  EX-D4               PIC X.
   398
   399 01  WS-MISC.
   400     05  WS-RETURN-CODE          PIC S9(4)   COMP.
   401     05  WS-ABEND-MESSAGE        PIC X(80).
   402     05  WS-ABEND-FILE-STATUS    PIC XX      VALUE ZEROS.
   403     05  WS-ZERO                 PIC S9      VALUE +0 COMP-3.
   404     05  RATEIN-RECS             PIC 9(5)    VALUE ZEROS.
   405     05  WS-SAVE-ERRATE          PIC X(1645) VALUE SPACES.
   406     05  ERRATE-FILE-STATUS      PIC XX      VALUE ZEROS.
   407     05  WS-DATE                 PIC 9(6)    VALUE ZEROS.
   408
*  409                                 COPY ELCDTECX.
   410******************************************************************06/05/98
   411*                                                                *ELCDTECX
   412*                            ELCDTECX.                           *   LV005
   413*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   414*                            VMOD=2.015                          *ELCDTECX
   415*                                                                *ELCDTECX
   416*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   417*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   418*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   419*                                                                *ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420******************************************************************ELCDTECX
   421******************************************************************
   422*                   C H A N G E   L O G
   423*
   424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   425*-----------------------------------------------------------------
   426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   427* EFFECTIVE    NUMBER
   428*-----------------------------------------------------------------
   429* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   430*                                  BENEFIT CODES FROM 300 TO 900
   431* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   432* 051304    2003080800002  SMVA  ADD REFUND METHOD
   433* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   434******************************************************************
   435 01  DATE-CARD.                                                   ELCDTECX
   436     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   437     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   438     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   439     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   440     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   441     12  EP-SW                       PIC  X.                      ELCDTECX
   442         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   443     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   444         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   445     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   446     12  RUN-CENTURY.                                             ELCDTECX
   447         16 RUN-CENTURY-N            PIC  99.                        CL**4
   448     12  FILLER                      PIC  X.                         CL**4
   449     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   450     12  FILLER                      PIC  XXX.                    ELCDTECX
   451     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   452                                                                  ELCDTECX
   453 01  FILLER                          PIC  X(7)                       CL**6
   454                                          VALUE 'OPTIONS'.        ELCDTECX
   455 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   456     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   457     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   458     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   459         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   460         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   461     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   462     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   463     12  FILLER                      PIC  X.                      ELCDTECX
   464     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   465     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   466     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   467     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   468     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   469     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   470     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   471     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   472     12  FILLER                      PIC  X.                      ELCDTECX
   473     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   474     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   475     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   476     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   477     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   479     12  FILLER                      PIC  X.                      ELCDTECX
   480     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   481     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   482     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   483     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   484     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   485     12  DTE-R78                     PIC  X.                      ELCDTECX
   486     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   487     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   488     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   489     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   490     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   491     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   492     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   493                                     PIC  X.                      ELCDTECX
   494         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   495                                                 ' '.             ELCDTECX
   496         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   497         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   498     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   499         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   500         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   501     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   502     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   503                                     PIC  9.                         CL**4
   504     12  DTE-SYSTEM.                                              ELCDTECX
   505         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   506         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   507         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   508         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   509         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   510         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   511         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   512         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   513         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   514         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   515         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   516         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   517         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   518         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   519         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   520         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   521         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   522         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   523         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   524         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   525         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   526         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   527         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   528         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   529         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   530         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   531     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   532         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   533                                     PIC  X.                      ELCDTECX
   534     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   535                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   537     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   538     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   539     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   540*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   541     12  FILLER                      PIC  X.                      ELCDTECX
   542     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   543     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   544     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   545     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   546     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   547     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   548     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   549                                                                  ELCDTECX
   550     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   551     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   552     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   553     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   554                                                                  ELCDTECX
   555     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   556     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   557     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   558     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   559                                                                  ELCDTECX
   560     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   561     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   562                                                                  ELCDTECX
   563     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   564     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   565                                                                  ELCDTECX
   566     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   567                                                                  ELCDTECX
   568 01  DATE-CARD-FACTORS.                                           ELCDTECX
   569     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   570     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   571     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   572     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   573     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   574     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   575     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   576                                                                  ELCDTECX
   577 01  FILLER                          PIC  X(12)                   ELCDTECX
   578                                          VALUE 'COMPANY NAME'.   ELCDTECX
   579 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   580     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   581         16  CNT-ID                  PIC  X.                      ELCDTECX
   582         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   583                                                                  ELCDTECX
   584 01  FILLER                          PIC  X(11)                   ELCDTECX
   585                                          VALUE 'STATE NAMES'.    ELCDTECX
   586 01  STATE-NAMES.                                                 ELCDTECX
   587     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   588         16  STATE-SUB               PIC  XX.                     ELCDTECX
   589         16  STATE-PIC1.                                          ELCDTECX
   590             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   591             20  FILLER              PIC  XXX.                    ELCDTECX
   592             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   593             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   595             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   596                                                                  ELCDTECX
   597 01  FILLER                          PIC  X(13)                   ELCDTECX
   598                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   599 01  CARRIER-NAMES.                                               ELCDTECX
   600     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   601         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   602         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   603         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   604         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   605         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   606         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   607*        16  FILLER                  PIC  X.                      ELCDTECX
   608         16  CARRIER-SEC-PAY         PIC  X.
   609             88  SEC-PAY-CARRIER          VALUE 'Y'.
   610                                                                  ELCDTECX
   611 01  FILLER                          PIC  X(9)                       CL**6
   612                                          VALUE 'INS TYPES'.      ELCDTECX
   613 01  CLAS-INS-TYPES.                                              ELCDTECX
   614*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   615     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   616         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   617         16  CLAS-I-AB3.                                          ELCDTECX
   618             20  FILLER              PIC  X.                      ELCDTECX
   619             20  CLAS-I-AB2.                                      ELCDTECX
   620                 24  FILLER          PIC  X.                      ELCDTECX
   621                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   622         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   623             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   624             20  FILLER              PIC  X.                         CL**4
   625         16  CLAS-I-AB10.                                         ELCDTECX
   626             20  FILLER              PIC  X(9).                   ELCDTECX
   627             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   628         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   629         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   630         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   631         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   632             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   633         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   634         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   635         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   636         16  CLAS-I-BEN-CATEGORY     PIC  X.
   637         16  CLAS-I-REFUND-METHOD    PIC  X.
   638         16  CLAS-I-MAX-BENEFITS     PIC 99.
   639         16  FILLER                  PIC  XXX.
   640                                                                  ELCDTECX
   641 01  FILLER                          PIC  X(16)                   ELCDTECX
   642                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   643 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   644     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   645                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   646         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   647         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   648         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   649         16  CLAS-MORT-DESC.                                      ELCDTECX
   650             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   651             20  FILLER              PIC  XX.                        CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652             20  CLAS-YEAR           PIC  X(4).                      CL**6
   653             20  FILLER              PIC  X.                         CL**5
   654             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   655             20  FILLER              PIC  X.                         CL**5
   656             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   657             20  FILLER              PIC  X.                         CL**5
   658             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   659             20  FILLER              PIC  X(5).                      CL**6
   660                                                                  ELCDTECX
   661 01  FILLER                          PIC  X(15)                   ELCDTECX
   662                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   663 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   664     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   665         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   666         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   667         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   668         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   669         16  FILLER                  PIC  X(4).                      CL**6
   670                                                                  ELCDTECX
   671 01  FILLER                          PIC  X(7)                       CL**6
   672                                     VALUE 'INDEXES'.             ELCDTECX
   673 01  CLAS-INDEX-TBL.                                              ELCDTECX
   674     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   675     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   676     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   677     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   678     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   679     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   680     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   681     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   682     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   683     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   684     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   685     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   686     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   687     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   688     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   689     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   690     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   691                                                                  ELCDTECX
   692 01  CLAS-TYPE-MISC.                                              ELCDTECX
   693     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   694     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   695     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   696     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   697     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   698     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   699     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   700     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   701     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   702     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   703     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   704                                                                  ELCDTECX
   705 01  FILLER                          PIC  X(13)                   ELCDTECX
   706                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   707 01  CLAS-MISC.                                                   ELCDTECX
   708     12  DTE-FICH                    PIC  X.                      ELCDTECX
   709         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   711         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   712     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   713     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   714     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   715     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   716     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   717     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   718     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   719     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   720     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   721     12  STATE-L                     PIC  XX.                     ELCDTECX
   722     12  CLAS-CN                     PIC  99.                     ELCDTECX
   723     12  CLAS-CO                     PIC  99.                     ELCDTECX
   724     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   725         16  DTE-F-1                 PIC  X.                      ELCDTECX
   726         16  DTE-F-2                 PIC  X.                      ELCDTECX
   727     12  DTE-ABEND-WORK.                                          ELCDTECX
   728         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   729         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   730                                                                  ELCDTECX
   731 01  FILLER                          PIC  X(12)                   ELCDTECX
   732                                     VALUE 'WORKING DATE'.        ELCDTECX
   733 01  WS-DATE-AND-TIME.                                            ELCDTECX
   734     12  WS-ACCEPT-DATE.                                          ELCDTECX
   735         16  WS-AD-YY                PIC  99.                     ELCDTECX
   736         16  WS-AD-MM                PIC  99.                     ELCDTECX
   737         16  WS-AD-DD                PIC  99.                     ELCDTECX
   738     12  WS-CURRENT-DATE.                                         ELCDTECX
   739         16  WS-CD-MM                PIC  99.                     ELCDTECX
   740         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   741         16  WS-CD-DD                PIC  99.                     ELCDTECX
   742         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   743         16  WS-CD-YY                PIC  99.                     ELCDTECX
   744     12  WS-TIME-OF-DAY.                                          ELCDTECX
   745         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   746         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   747                                                                  ELCDTECX
   748 01  FILLER                          PIC  X(12)                   ELCDTECX
   749                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   750 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   751     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   752         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   753         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   754         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   755                                                                  ELCDTECX
   756 01  FILLER                          PIC  X(10)                   ELCDTECX
   757                                     VALUE 'STATE TLRS'.          ELCDTECX
   758 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   759     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   760         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   761         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   762                                                                  ELCDTECX
   763 01  FILLER                          PIC  X(13)                   ELCDTECX
   764                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   765 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   766     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   767         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   768                                                                  ELCDTECX
   769 01  FILLER                          PIC  X(13)                   ELCDTECX
   770                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   771 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   772     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   773     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   774     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   775                                     PIC  X.                         CL**5
   776     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   777     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   778     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   779     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   780     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   781     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   782     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   783     12  FILLER                      PIC  X(75).                  ELCDTECX
   784******************************************************************ELCDTECX
   785*01  MISC-CARR-PCT-DATA.                                          00001521
   786*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   787*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   788*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   789*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   790*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   791*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   792******************************************************************ELCDTECX
   793
*  794                                 COPY ELCDTEVR.
   795***************************************************************** 04/15/98
   796*                                                                *ELCDTEVR
   797*                                                                *ELCDTEVR
   798*                            ELCDTEVR.                           *   LV003
   799*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   800*                            VMOD=2.001                          *   CL**2
   801*                                                                *ELCDTEVR
   802*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   803*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   804*                                                                *ELCDTEVR
   805******************************************************************ELCDTEVR
   806 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   807     05  WS-RUN-DATE.                                             ELCDTEVR
   808         10  FILLER                  PIC  9(03).                  ELCDTEVR
   809         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   810         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   811             15  RUN-CC              PIC  99.                     ELCDTEVR
   812             15  RUN-YR              PIC  99.                     ELCDTEVR
   813         10  RUN-MO                  PIC  99.                     ELCDTEVR
   814         10  RUN-DA                  PIC  99.                     ELCDTEVR
   815     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   816            WS-RUN-DATE              PIC 9(11).                      CL**2
   817     05  WS-EP-DT.                                                ELCDTEVR
   818         10  FILLER                  PIC  9(03).                  ELCDTEVR
   819         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   820         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   821             15  EP-CC               PIC  99.                     ELCDTEVR
   822             15  EP-YR               PIC  99.                     ELCDTEVR
   823         10  EP-MO                   PIC  99.                     ELCDTEVR
   824         10  EP-DA                   PIC  99.                     ELCDTEVR
   825     05  WS-EP-DT-N REDEFINES                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   826            WS-EP-DT                 PIC 9(11).                      CL**2
   827     05  WS-DTE-CONV-DT.                                             CL**4
   828         10  FILLER                  PIC  9(03).                     CL**4
   829         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   830         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   831             15  DTE-CONV-CC         PIC  99.                        CL**4
   832             15  DTE-CONV-YR         PIC  99.                        CL**4
   833         10  DTE-CONV-MO             PIC  99.                        CL**4
   834         10  DTE-CONV-DA             PIC  99.                        CL**4
   835     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   836            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   837 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   838     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   839         10  FILLER                            PIC 999.           ELCDTEVR
   840         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   841         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   842             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   843             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   844         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   845         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   846     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   847            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   848     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   849         10  FILLER                            PIC 999.           ELCDTEVR
   850         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   851         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   852         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   853         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   854     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   855            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   856 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   857     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   858         10  FILLER                            PIC 999.           ELCDTEVR
   859         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   860         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   861             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   862             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   863         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   864         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   865     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   866            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   867     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   868         10  FILLER                            PIC 999.           ELCDTEVR
   869         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   870         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   871             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   872             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   873         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   874         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   875     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   876            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   877     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   878         10  FILLER                            PIC 999.           ELCDTEVR
   879         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   880         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   881             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   882             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   883         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   884         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   885     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   886            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   887 01  WS-RATE-RECORD.                                              ELCDTEVR
   888         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   889             10  FILLER                        PIC 999.           ELCDTEVR
   890             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   891             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   892                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   893                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   894             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   895             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   896         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   897                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   898
   899 PROCEDURE DIVISION.
   900
*  901                                 COPY ELCDTERX.
   902******************************************************************04/15/98
   903*                                                                *ELCDTERX
   904*                                                                *ELCDTERX
   905*                            ELCDTERX.                           *   LV002
   906*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   907*                            VMOD=2.007                          *ELCDTERX
   908*                                                                *ELCDTERX
   909*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   910*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   911*      = ELCDTEFD)                                               *ELCDTERX
   912*                                                                *ELCDTERX
   913******************************************************************ELCDTERX
   914                                                                  ELCDTERX
   915     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   916                                                                  ELCDTERX
   917     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   918     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   919     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   920                                                                  ELCDTERX
   921     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   922                                                                  ELCDTERX
   923******************************************************************ELCDTERX
   924*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   925*          WARNING MESSAGES.                                      ELCDTERX
   926******************************************************************ELCDTERX
   927     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   928         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   929                                                                  ELCDTERX
   930     OPEN INPUT DISK-DATE.                                        ELCDTERX
   931                                                                  ELCDTERX
   932     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   933                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   934                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   935                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   936                   CLAX-ID           CLAS-MISC                    ELCDTERX
   937                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   938                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   939                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   940                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   941                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   942                                                                  ELCDTERX
   943     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   944                                                                  ELCDTERX
   945     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   946                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   947                                                                  ELCDTERX
   948     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   949     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   950     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   951     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   952                                                                  ELCDTERX
   953     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   954         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   955     ELSE                                                         ELCDTERX
   956         ADD +1                 TO CLAS-CN.                       ELCDTERX
   957                                                                  ELCDTERX
   958     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   959         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   960     ELSE                                                         ELCDTERX
   961         ADD +1                 TO CLAS-CO.                       ELCDTERX
   962                                                                  ELCDTERX
   963 0005-READ--CARD.                                                 ELCDTERX
   964     READ DISK-DATE                                               ELCDTERX
   965         AT END CLOSE DISK-DATE                                   ELCDTERX
   966             GO TO 0060-READ--TEST.                               ELCDTERX
   967                                                                  ELCDTERX
   968     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   969                                                                  ELCDTERX
   970     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   971         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   972         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   973         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   974         GO TO 0005-READ--CARD.                                   ELCDTERX
   975                                                                  ELCDTERX
   976     IF DD-ID = 'CLAD'                                            ELCDTERX
   977         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   978         GO TO 0005-READ--CARD.                                   ELCDTERX
   979                                                                  ELCDTERX
   980     IF DD-ID = 'CLAX'                                            ELCDTERX
   981         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   982         GO TO 0005-READ--CARD.                                   ELCDTERX
   983                                                                  ELCDTERX
   984     IF DD-ID = 'CLAF'                                            ELCDTERX
   985         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   986         GO TO 0005-READ--CARD.                                   ELCDTERX
   987                                                                  ELCDTERX
   988     IF DD-ID = 'CLAC'                                            ELCDTERX
   989         GO TO 0010-READ--CLAC.                                   ELCDTERX
   990                                                                  ELCDTERX
   991     IF DD-ID = 'CARR'                                            ELCDTERX
   992         GO TO 0015-READ--CARR.                                   ELCDTERX
   993                                                                  ELCDTERX
   994     IF DD-ID = 'STAT'                                            ELCDTERX
   995         GO TO 0020-READ--STAT.                                   ELCDTERX
   996                                                                  ELCDTERX
   997     IF DD-ID = 'BUSC'                                            ELCDTERX
   998         GO TO 0025-READ--BUSC.                                   ELCDTERX
   999                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1000     IF DD-ID = 'MORT'                                            ELCDTERX
  1001         GO TO 0030-READ--MORT.                                   ELCDTERX
  1002                                                                  ELCDTERX
  1003     IF DD-ID = 'CLAI'                                            ELCDTERX
  1004         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1005                                                                  ELCDTERX
  1006     IF DD-ID = 'COLC'                                            ELCDTERX
  1007         GO TO 0065-READ--COLC.                                   ELCDTERX
  1008                                                                  ELCDTERX
  1009     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1010        DD-IDA = 'CL'                                             ELCDTERX
  1011         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1012                                                                  ELCDTERX
  1013     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1014        DD-IDA = 'PO'                                             ELCDTERX
  1015         GO TO 0050-READ--POXX.                                   ELCDTERX
  1016                                                                  ELCDTERX
  1017     IF DD-ID = 'OPCA'                                            ELCDTERX
  1018         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1019                                                                  ELCDTERX
  1020     IF DD-ID = 'OPST'                                            ELCDTERX
  1021         GO TO 0072-READ--OPST.                                   ELCDTERX
  1022                                                                  ELCDTERX
  1023     IF DD-ID = 'OPBS'                                            ELCDTERX
  1024         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1025                                                                  ELCDTERX
  1026     IF DD-ID = 'OPMS'                                            ELCDTERX
  1027         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1028                                                                  ELCDTERX
  1029     GO TO 0005-READ--CARD.                                       ELCDTERX
  1030                                                                  ELCDTERX
  1031 0010-READ--CLAC.                                                 ELCDTERX
  1032     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1033     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1034     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1035     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1036     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1037     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1038     GO TO 0005-READ--CARD.                                       ELCDTERX
  1039                                                                  ELCDTERX
  1040 0015-READ--CARR.                                                 ELCDTERX
  1041     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1042     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1043        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1044        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1045        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1046        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1047        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1048        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1049        MOVE DD-CARR1-SECPAY-SW
  1050                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1051     END-IF
  1052                                                                  ELCDTERX
  1053     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1054     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1055        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1056        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1057        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1058        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1059        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1060        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1061        MOVE DD-CARR2-SECPAY-SW
  1062                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1063     END-IF
  1064                                                                  ELCDTERX
  1065                                                                  ELCDTERX
  1066     GO TO 0005-READ--CARD.                                       ELCDTERX
  1067                                                                  ELCDTERX
  1068 0020-READ--STAT.                                                 ELCDTERX
  1069     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1070     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1071        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1072         GO TO 0005-READ--CARD.                                   ELCDTERX
  1073                                                                  ELCDTERX
  1074     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1075     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1076     GO TO 0020-READ--STAT.                                       ELCDTERX
  1077                                                                  ELCDTERX
  1078 0025-READ--BUSC.                                                 ELCDTERX
  1079     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1080     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1081        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1082         GO TO 0005-READ--CARD.                                   ELCDTERX
  1083                                                                  ELCDTERX
  1084     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1085     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1086     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1087                                                                  ELCDTERX
  1088 0030-READ--MORT.                                                 ELCDTERX
  1089     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1090     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1091        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1092         GO TO 0005-READ--CARD.                                   ELCDTERX
  1093                                                                  ELCDTERX
  1094     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1095     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1096     GO TO 0030-READ--MORT.                                       ELCDTERX
  1097                                                                  ELCDTERX
  1098 0035-READ--CLXX.                                                 ELCDTERX
  1099     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1100          GO TO 0005-READ--CARD.                                  ELCDTERX
  1101                                                                  ELCDTERX
  1102     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1103         DISPLAY '***********************************************'ELCDTERX
  1104         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1105         DISPLAY '***********************************************'ELCDTERX
  1106         GO TO 0055-READ--STOP.                                   ELCDTERX
  1107                                                                  ELCDTERX
  1108     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1109        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1110         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1111                                                                  ELCDTERX
  1112     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1113        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1114         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1115                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1116*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1117     GO TO 0005-READ--CARD.                                       ELCDTERX
  1118                                                                  ELCDTERX
  1119 0040-READ--CLAI.                                                 ELCDTERX
  1120     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1121     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1122        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1123         GO TO 0005-READ--CARD.                                   ELCDTERX
  1124                                                                  ELCDTERX
  1125     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1126     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1127     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1128                                                                  ELCDTERX
  1129 0045-READ--DUMP.                                                 ELCDTERX
  1130     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1131     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1132                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1133     PERFORM ABEND-PGM.                                           ELCDTERX
  1134                                                                  ELCDTERX
  1135 0050-READ--POXX.                                                 ELCDTERX
  1136     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1137         GO TO 0005-READ--CARD.                                   ELCDTERX
  1138                                                                  ELCDTERX
  1139     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1140         DISPLAY '***********************************************'ELCDTERX
  1141         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1142         DISPLAY '***********************************************'ELCDTERX
  1143         GO TO 0055-READ--STOP.                                   ELCDTERX
  1144                                                                  ELCDTERX
  1145     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1146     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1147     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1148     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1149                                                                  ELCDTERX
  1150     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1151         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1152     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1153         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1154                                                                  ELCDTERX
  1155     GO TO 0005-READ--CARD.                                       ELCDTERX
  1156                                                                  ELCDTERX
  1157 0055-READ--STOP.                                                 ELCDTERX
  1158     GOBACK.                                                      ELCDTERX
  1159                                                                  ELCDTERX
  1160 0060-READ--TEST.                                                 ELCDTERX
  1161     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1162        CLAX-ID         = SPACE  OR                               ELCDTERX
  1163        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1164         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1165                                                                  ELCDTERX
  1166     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1167     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1168                                                                  ELCDTERX
  1169 0065-READ--COLC.                                                 ELCDTERX
  1170     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1171     GO TO 0005-READ--CARD.                                       ELCDTERX
  1172                                                                  ELCDTERX
  1173 0070-READ--OPCA.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* PEMRTXEM.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1174                                                                  ELCDTERX
  1175     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1176                                                                  ELCDTERX
  1177     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1178             OR                                                   ELCDTERX
  1179         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1180         GO TO 0005-READ--CARD.                                   ELCDTERX
  1181                                                                  ELCDTERX
  1182     ADD 1                       TO INDEXCA.                      ELCDTERX
  1183     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1184                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1185     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1186                                                                  ELCDTERX
  1187 0072-READ--OPST.                                                 ELCDTERX
  1188                                                                  ELCDTERX
  1189     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1190                                                                  ELCDTERX
  1191     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1192             OR                                                   ELCDTERX
  1193         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1194         GO TO 0005-READ--CARD.                                   ELCDTERX
  1195                                                                  ELCDTERX
  1196     ADD 1                       TO INDEXST.                      ELCDTERX
  1197     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1198                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1199     GO TO 0072-READ--OPST.                                       ELCDTERX
  1200                                                                  ELCDTERX
  1201 0074-READ--OPBS.                                                 ELCDTERX
  1202                                                                  ELCDTERX
  1203     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1204                                                                  ELCDTERX
  1205     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1206             OR                                                   ELCDTERX
  1207         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1208         GO TO 0005-READ--CARD.                                   ELCDTERX
  1209                                                                  ELCDTERX
  1210     ADD 1                       TO INDEXBS.                      ELCDTERX
  1211     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1212     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1213                                                                  ELCDTERX
  1214 0079-READ--EXIT.                                                 ELCDTERX
  1215*    EXIT.                                                        ELCDTERX
  1216******************************************************************ELCDTERX
  1217
  1218     PERFORM 0400-OPEN-FILES     THRU 0400-EXIT
  1219
  1220     PERFORM 0600-INITIALIZE     THRU 0600-EXIT
  1221
  1222     PERFORM 0100-PROCESS-RATE   THRU 0100-EXIT UNTIL
  1223        END-OF-ERRATE
  1224
  1225     PERFORM 0800-BUILD-DAT-OUT  THRU 0800-EXIT
  1226
  1227     PERFORM 0500-CLOSE-FILES    THRU 0500-EXIT
  1228
  1229     DISPLAY ' TABLE RECORDS READ   '  WS-TBL-RECS
  1230     DISPLAY ' RATE RECORDS READ    '  WS-IN-RECS
  1231     DISPLAY ' INS  RECORDS WRITTEN '  INS-RECS-OUT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* PEMRTXEM.cbl
  1232     GOBACK
  1233
  1234     .
  1235 0100-PROCESS-RATE.
  1236
  1237     MOVE ' '                    TO WS-FOUND-MATCH
  1238
  1239     PERFORM VARYING T1 FROM +1 BY +1 UNTIL
  1240        (T1 > T1M)
  1241        OR ((RT-ST-CODE = RTI-STATE (T1))
  1242           AND (RT-ST-CLASS = RTI-CLASS (T1))
  1243           AND (RT-ST-DEV = RTI-DEV (T1))
  1244           AND (RT-L-AH = RTI-TYPE (T1))
  1245           AND (RT-LAH-NUM = RTI-BEN-CODE (T1))
  1246           AND (RT-EXPIRY-DATE = 99999999999))
  1247     END-PERFORM
  1248     IF T1 <= T1M
  1249        SET FOUND-MATCH          TO TRUE
  1250     END-IF
  1251
  1252     IF (FOUND-MATCH)
  1253        IF RTI-TYPE (T1) = 'A'
  1254           PERFORM 0150-PROCESS-AH-RATE
  1255                                 THRU 0150-EXIT
  1256        ELSE
  1257           IF (RTI-TYPE (T1) = 'L')
  1258              AND (RTI-CREATE-LF-RATE-TABLE (T1)) = 'Y'
  1259              PERFORM 0160-PROCESS-LF-RATE
  1260                                 THRU 0160-EXIT
  1261           END-IF
  1262        END-IF
  1263        PERFORM 0110-UPDATE-LIMS THRU 0110-EXIT
  1264     END-IF
  1265
  1266     PERFORM 0200-READ-RATE      THRU 0200-EXIT
  1267
  1268     .
  1269 0100-EXIT.
  1270     EXIT.
  1271
  1272
  1273 0110-UPDATE-LIMS.
  1274
  1275     DISPLAY ' I AM AT UPDATE LIMS ' RATE-TABLE (T1)
  1276
  1277     IF RTI-TYPE (T1) = 'L'
  1278        MOVE RTI-TRUNC-AT-AGE (T1)
  1279                                 TO WS-TRUNC-AT-AGE
  1280        MOVE RTI-X-MOS-INT (T1)  TO WS-X-MOS-INT
  1281        MOVE RTI-X-MOS-PMT (T1)  TO WS-X-MOS-PMTS
  1282        MOVE RTI-CREATE-LF-RATE-TABLE (T1)
  1283                                 TO WS-CREATE-LF-TABLE
  1284        MOVE RTI-RT-TYPE-SW (T1) TO WS-RT-TYPE-SW
  1285        MOVE RTI-MAX-ELIG-AGE (T1)
  1286                                  TO WS-LF-MAX-ELIG-AGE
  1287        MOVE RTI-ATT-AGE (T1)     TO WS-LF-ATT-AGE
  1288        MOVE RTI-THRU-AGE1 (T1)   TO WS-LF-AGE1
  1289        MOVE RTI-THRU-TERM1 (T1)  TO WS-LF-TERM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* PEMRTXEM.cbl
  1290        MOVE RTI-MAX-LF-BEN1 (T1) TO WS-LF-AMT1
  1291        MOVE RTI-THRU-AGE2 (T1)   TO WS-LF-AGE2
  1292        MOVE RTI-THRU-TERM2 (T1)  TO WS-LF-TERM2
  1293        MOVE RTI-MAX-LF-BEN2 (T1) TO WS-LF-AMT2
  1294        MOVE RTI-THRU-AGE3 (T1)   TO WS-LF-AGE3
  1295        MOVE RTI-THRU-TERM3 (T1)  TO WS-LF-TERM3
  1296        MOVE RTI-MAX-LF-BEN3 (T1) TO WS-LF-AMT3
  1297        IF RTI-STATE (T1) NOT = 'VA'
  1298          EVALUATE TRUE
  1299           WHEN RTI-COV-TYPE (T1) = 'SDL'
  1300             MOVE RT-L-RATE (12)  TO WS-LF-SD-RATE
  1301             DISPLAY ' FOUND SD ' WS-LF-SD-RATE
  1302           WHEN RTI-COV-TYPE (T1) = 'JDL'
  1303             MOVE RT-L-RATE (12)  TO WS-LF-JD-RATE
  1304             DISPLAY ' FOUND JD ' WS-LF-JD-RATE
  1305           WHEN RTI-COV-TYPE (T1) = 'SLL'
  1306             MOVE RT-L-RATE (12)  TO WS-LF-SL-RATE
  1307             DISPLAY ' FOUND SL ' WS-LF-SL-RATE
  1308           WHEN RTI-COV-TYPE (T1) = 'JLL'
  1309             MOVE RT-L-RATE (12)  TO WS-LF-JL-RATE
  1310             DISPLAY ' FOUND JL ' WS-LF-JL-RATE
  1311           WHEN RTI-COV-TYPE (T1) = 'SNL'
  1312             MOVE RT-DISCOUNT-OB-RATE
  1313                                  TO WS-LF-SN-RATE
  1314             DISPLAY ' FOUND SN ' WS-LF-SN-RATE
  1315           WHEN RTI-COV-TYPE (T1) = 'JNL'
  1316             MOVE RT-DISCOUNT-OB-RATE
  1317                                  TO WS-LF-JN-RATE
  1318             DISPLAY ' FOUND JN ' WS-LF-JN-RATE
  1319           WHEN OTHER
  1320             DISPLAY ' LIFE TYPE OTHER THAN SDL JDL SLL JLL '
  1321          END-EVALUATE
  1322        END-IF
  1323     ELSE
  1324        MOVE RTI-MAX-ELIG-AGE (T1) TO WS-AH-MAX-ELIG-AGE
  1325        MOVE RTI-ATT-AGE (T1)     TO WS-AH-ATT-AGE
  1326        MOVE RTI-THRU-AGE1 (T1)   TO WS-AH-AGE1
  1327        MOVE RTI-THRU-TERM1 (T1)  TO WS-AH-TERM1
  1328        MOVE RTI-MAX-AH-BEN1 (T1) TO WS-AH-AMT1
  1329        MOVE RTI-MAX-LF-BEN1 (T1) TO WS-AH-TOT-AMT1
  1330        MOVE RTI-THRU-AGE2 (T1)   TO WS-AH-AGE2
  1331        MOVE RTI-THRU-TERM2 (T1)  TO WS-AH-TERM2
  1332        MOVE RTI-MAX-AH-BEN2 (T1) TO WS-AH-AMT2
  1333        MOVE RTI-MAX-LF-BEN1 (T1) TO WS-AH-TOT-AMT2
  1334        MOVE RTI-THRU-AGE3 (T1)   TO WS-AH-AGE3
  1335        MOVE RTI-THRU-TERM3 (T1)  TO WS-AH-TERM3
  1336        MOVE RTI-MAX-AH-BEN3 (T1) TO WS-AH-AMT3
  1337        MOVE RTI-MAX-LF-BEN1 (T1) TO WS-AH-TOT-AMT3
  1338     END-IF
  1339
  1340     .
  1341 0110-EXIT.
  1342     EXIT.
  1343
  1344 0150-PROCESS-AH-RATE.
  1345
  1346     MOVE WS-SAVE-ERRATE         TO RATE-OUT-EXTRACT
  1347     MOVE RT-ST-CODE             TO EX-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* PEMRTXEM.cbl
  1348
  1349     EVALUATE RTI-RATE-DESC (T1)
  1350        WHEN '7R'
  1351           MOVE +1               TO A1
  1352        WHEN '7E'
  1353           MOVE +2               TO A1
  1354        WHEN '14R'
  1355           MOVE +3               TO A1
  1356        WHEN '14E'
  1357           MOVE +4               TO A1
  1358        WHEN '30R'
  1359           MOVE +5               TO A1
  1360        WHEN '30E'
  1361           MOVE +6               TO A1
  1362        WHEN OTHER
  1363           DISPLAY 'INVALID AH RATE DESCRIPTION '
  1364              RTI-RATE-DESC (T1) ' DEFAULT IS 14R '
  1365           MOVE +3               TO A1
  1366     END-EVALUATE
  1367
  1368     MOVE WS-STATE               TO WS-AH-TABLE (A1) (1:2)
  1369     MOVE RTI-RATE-DESC (T1)     TO EX-BENCD-DESC
  1370                                    WS-AH-TABLE (A1) (3:8)
  1371
  1372     MOVE ZEROS                  TO EX-MAX-MOS
  1373     MOVE 1                      TO EX-MIN-MOS
  1374
  1375     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  1376        (S1 > +180)
  1377        IF RT-AH-RATE (S1) NOT NUMERIC
  1378           MOVE ZEROS            TO RT-AH-RATE (S1)
  1379        END-IF
  1380        IF RT-AH-RATE (S1) NOT = ZEROS
  1381           MOVE S1               TO EX-MAX-MOS
  1382        END-IF
  1383        MOVE RT-AH-RATE (S1)     TO EX-RATE (S1)
  1384     END-PERFORM
  1385
  1386     PERFORM 0300-WRITE-RATE  THRU 0300-EXIT
  1387
  1388     .
  1389 0150-EXIT.
  1390     EXIT.
  1391
  1392 0160-PROCESS-LF-RATE.
  1393
  1394     MOVE WS-SAVE-ERRATE         TO RATE-OUT-EXTRACT
  1395     MOVE RT-ST-CODE             TO EX-STATE
  1396     MOVE RTI-RATE-DESC (T1)     TO EX-BENCD-DESC
  1397     EVALUATE RTI-COV-TYPE (T1)
  1398        WHEN 'SDL'
  1399           MOVE +1               TO L1
  1400        WHEN 'JDL'
  1401           MOVE +2               TO L1
  1402        WHEN 'SLL'
  1403           MOVE +3               TO L1
  1404        WHEN 'JLL'
  1405           MOVE +4               TO L1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* PEMRTXEM.cbl
  1406     END-EVALUATE
  1407
  1408     MOVE RT-ST-CODE             TO WS-LF-TABLE (L1)
  1409     MOVE RTI-RATE-DESC (T1)     TO WS-LF-TABLE (L1) (3:8)
  1410
  1411     MOVE ZEROS                  TO EX-MAX-MOS
  1412     MOVE 1                      TO EX-MIN-MOS
  1413
  1414     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  1415        (S1 > +180)
  1416        IF RT-L-RATE (S1) NOT NUMERIC
  1417           MOVE ZEROS            TO RT-L-RATE (S1)
  1418        END-IF
  1419        IF RT-L-RATE (S1) NOT = ZEROS
  1420           MOVE S1               TO EX-MAX-MOS
  1421        END-IF
  1422        MOVE RT-L-RATE (S1)      TO EX-RATE (S1)
  1423     END-PERFORM
  1424
  1425     PERFORM 0300-WRITE-RATE  THRU 0300-EXIT
  1426
  1427     .
  1428 0160-EXIT.
  1429     EXIT.
  1430
  1431 0200-READ-RATE.
  1432
  1433     READ ERRATE NEXT RECORD
  1434
  1435     IF ERRATE-FILE-STATUS = '10' OR '23'
  1436        SET END-OF-ERRATE        TO TRUE
  1437     ELSE
  1438        IF ERRATE-FILE-STATUS NOT = '00'
  1439           DISPLAY 'ERRATE READ NEXT ' ERRATE-FILE-STATUS
  1440           SET END-OF-ERRATE     TO TRUE
  1441        ELSE
  1442           IF RT-COMPANY-CD > DTE-CLASIC-COMPANY-CD
  1443              SET END-OF-ERRATE  TO TRUE
  1444           END-IF
  1445        END-IF
  1446     END-IF
  1447
  1448     IF NOT END-OF-ERRATE
  1449        ADD 1                    TO WS-IN-RECS
  1450     END-IF
  1451
  1452     .
  1453 0200-EXIT.
  1454     EXIT.
  1455
  1456 0300-WRITE-RATE.
  1457
  1458     WRITE INS-OUT-REC           FROM RATE-OUT-EXTRACT
  1459     ADD 1                       TO INS-RECS-OUT
  1460
  1461     .
  1462 0300-EXIT.
  1463     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* PEMRTXEM.cbl
  1464
  1465 0400-OPEN-FILES.
  1466
  1467     OPEN INPUT ERRATE RATE-IN DAT-IN
  1468         OUTPUT INS-OUT DAT-OUT
  1469
  1470     .
  1471 0400-EXIT.
  1472     EXIT.
  1473
  1474 0500-CLOSE-FILES.
  1475
  1476     CLOSE ERRATE INS-OUT RATE-IN DAT-IN DAT-OUT
  1477
  1478     .
  1479 0500-EXIT.
  1480     EXIT.
  1481
  1482 0550-START-RATE.
  1483
  1484     MOVE LOW-VALUES             TO RT-CONTROL-PRIMARY
  1485
  1486     MOVE DTE-CLASIC-COMPANY-CD  TO RT-COMPANY-CD
  1487     START ERRATE KEY >= RT-CONTROL-PRIMARY
  1488
  1489     IF ERRATE-FILE-STATUS = '10' OR '23'
  1490        SET END-OF-ERRATE TO TRUE
  1491     ELSE
  1492        IF ERRATE-FILE-STATUS NOT = '00'
  1493           DISPLAY 'ERRATE START     ' ERRATE-FILE-STATUS
  1494           SET END-OF-ERRATE TO TRUE
  1495        END-IF
  1496     END-IF
  1497
  1498     .
  1499 0550-EXIT.
  1500     EXIT.
  1501
  1502 0600-INITIALIZE.
  1503
  1504     PERFORM VARYING A1 FROM +1 BY +1 UNTIL
  1505        A1 > +6
  1506        MOVE 'AH0000'            TO WS-AH-TABLE (A1)
  1507     END-PERFORM
  1508
  1509     MOVE 'SD0000'               TO WS-LF-TABLE (1)
  1510     MOVE 'JD0000'               TO WS-LF-TABLE (2)
  1511     MOVE 'SL0000'               TO WS-LF-TABLE (3)
  1512     MOVE 'JL0000'               TO WS-LF-TABLE (4)
  1513
  1514     MOVE SPACES                 TO RATE-OUT-EXTRACT
  1515     MOVE ';'                    TO EX-D1
  1516                                    EX-D2
  1517                                    EX-D3
  1518     PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  1519        (S1 > +180)
  1520        MOVE ZEROS               TO EX-RATE (S1)
  1521        MOVE ';'                 TO EX-D4   (S1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* PEMRTXEM.cbl
  1522     END-PERFORM
  1523
  1524     MOVE RATE-OUT-EXTRACT       TO WS-SAVE-ERRATE
  1525
  1526     PERFORM 0700-BUILD-TABLES   THRU 0700-EXIT
  1527
  1528     PERFORM 0550-START-RATE     THRU 0550-EXIT
  1529     PERFORM 0200-READ-RATE      THRU 0200-EXIT
  1530
  1531     .
  1532 0600-EXIT.
  1533     EXIT.
  1534
  1535 0700-BUILD-TABLES.
  1536
  1537     MOVE ' '                    TO WS-INPUT-SW
  1538
  1539     PERFORM VARYING T1 FROM +1 BY +1 UNTIL
  1540        END-OF-INPUT
  1541        READ RATE-IN AT END
  1542           SET END-OF-INPUT      TO TRUE
  1543        END-READ
  1544        IF NOT END-OF-INPUT
  1545           MOVE RATE-IN-REC      TO RATE-TABLE (T1)
  1546        END-IF
  1547     END-PERFORM
  1548
  1549     SUBTRACT +2                 FROM T1
  1550     MOVE T1                     TO T1M
  1551     DISPLAY ' NUMBER OF RATE DETAIL RECORDS ' T1M
  1552     MOVE RTI-STATE (T1)         TO WS-STATE
  1553
  1554     MOVE ' '                    TO WS-INPUT-SW
  1555
  1556     PERFORM VARYING T1 FROM +1 BY +1 UNTIL
  1557        END-OF-INPUT
  1558        READ DAT-IN AT END
  1559           SET END-OF-INPUT      TO TRUE
  1560        END-READ
  1561        IF NOT END-OF-INPUT
  1562           READ DAT-IN AT END
  1563              SET END-OF-INPUT   TO TRUE
  1564           END-READ
  1565        END-IF
  1566        IF NOT END-OF-INPUT
  1567           MOVE DAT-IN-REC       TO DAT-OPTIONS (T1)
  1568        END-IF
  1569     END-PERFORM
  1570
  1571     SUBTRACT +2                 FROM T1
  1572     MOVE T1                     TO T2M
  1573     DISPLAY ' NUMBER OF DAT RECORDS         ' T2M
  1574
  1575     .
  1576 0700-EXIT.
  1577     EXIT.
  1578
  1579 0800-BUILD-DAT-OUT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* PEMRTXEM.cbl
  1580
  1581     IF WS-TRUNC-AT-AGE NOT NUMERIC
  1582        MOVE ZEROS               TO WS-TRUNC-AT-AGE
  1583     END-IF
  1584     MOVE WS-TRUNC-AT-AGE        TO DAT-OPTIONS (272)
  1585     IF WS-X-MOS-PMTS NOT NUMERIC
  1586        MOVE ZEROS               TO WS-X-MOS-PMTS
  1587     END-IF
  1588     IF WS-X-MOS-PMTS > ZEROS
  1589        MOVE WS-X-MOS-PMTS       TO DAT-OPTIONS (83)
  1590     END-IF
  1591
  1592     IF WS-X-MOS-INT NOT NUMERIC
  1593        MOVE ZEROS               TO WS-X-MOS-INT
  1594     END-IF
  1595     IF WS-X-MOS-INT > ZEROS
  1596        MOVE WS-X-MOS-INT        TO DAT-OPTIONS (84)
  1597     END-IF
  1598     IF WS-RT-TYPE-SW = 'Y'
  1599        MOVE '1'                 TO DAT-OPTIONS (403)
  1600     ELSE
  1601        MOVE '0'                 TO DAT-OPTIONS (403)
  1602     END-IF
  1603
  1604     IF WS-CREATE-LF-TABLE = 'Y'
  1605        MOVE '1'                 TO DAT-OPTIONS (80)
  1606     END-IF
  1607
  1608     IF WS-LF-SN-RATE > ZEROS
  1609        OR WS-LF-JN-RATE > ZEROS
  1610        MOVE '3'                 TO DAT-OPTIONS (80)
  1611        MOVE '1'                 TO DAT-OPTIONS (81)
  1612        MOVE '6'                 TO DAT-OPTIONS (82)
  1613     END-IF
  1614
  1615     MOVE WS-LF-SD-RATE          TO DAT-OPTIONS-RATES (91)
  1616     MOVE WS-LF-SL-RATE          TO DAT-OPTIONS-RATES (92)
  1617     MOVE WS-LF-JD-RATE          TO DAT-OPTIONS-RATES (93)
  1618     MOVE WS-LF-JL-RATE          TO DAT-OPTIONS-RATES (94)
  1619
  1620     IF WS-LF-SN-RATE NOT = ZEROS
  1621        MOVE WS-LF-SN-RATE       TO DAT-OPTIONS-RATES (95)
  1622     END-IF
  1623
  1624     IF WS-LF-JN-RATE NOT = ZEROS
  1625        MOVE WS-LF-JN-RATE       TO DAT-OPTIONS-RATES (96)
  1626     END-IF
  1627
  1628     IF DAT-OPTIONS (91) = SPACES
  1629        MOVE '0'                 TO DAT-OPTIONS (91)
  1630     END-IF
  1631     IF DAT-OPTIONS (92) = SPACES
  1632        MOVE '0'                 TO DAT-OPTIONS (92)
  1633     END-IF
  1634     IF DAT-OPTIONS (93) = SPACES
  1635        MOVE '0'                 TO DAT-OPTIONS (93)
  1636     END-IF
  1637     IF DAT-OPTIONS (94) = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* PEMRTXEM.cbl
  1638        MOVE '0'                 TO DAT-OPTIONS (94)
  1639     END-IF
  1640
  1641     MOVE WS-LF-MAX-ELIG-AGE     TO DAT-OPTIONS (230)
  1642     MOVE WS-LF-AMT1             TO DAT-OPTIONS (100)
  1643     MOVE WS-LF-AGE1             TO DAT-OPTIONS (281)
  1644     MOVE WS-LF-TERM1            TO DAT-OPTIONS (102)
  1645
  1646     MOVE WS-AH-MAX-ELIG-AGE     TO DAT-OPTIONS (231)
  1647     MOVE WS-AH-TOT-AMT1         TO DAT-OPTIONS (104)
  1648     MOVE WS-AH-AMT1             TO DAT-OPTIONS (106)
  1649     MOVE WS-AH-TERM1            TO DAT-OPTIONS (108)
  1650
  1651     MOVE WS-LF-ATT-AGE          TO DAT-OPTIONS (189)
  1652     MOVE WS-AH-ATT-AGE          TO DAT-OPTIONS (190)
  1653
  1654     MOVE WS-LF-AMT2             TO DAT-OPTIONS (282)
  1655     MOVE WS-LF-TERM2            TO DAT-OPTIONS (325)
  1656
  1657     MOVE WS-AH-AMT2             TO DAT-OPTIONS (322)
  1658     MOVE WS-AH-TERM2            TO DAT-OPTIONS (331)
  1659
  1660
  1661
  1662     MOVE WS-AH-TABLE (1)        TO DAT-OPTIONS (132)
  1663     MOVE WS-AH-TABLE (2)        TO DAT-OPTIONS (133)
  1664     MOVE WS-AH-TABLE (3)        TO DAT-OPTIONS (134)
  1665     MOVE WS-AH-TABLE (4)        TO DAT-OPTIONS (135)
  1666     MOVE WS-AH-TABLE (5)        TO DAT-OPTIONS (136)
  1667     MOVE WS-AH-TABLE (6)        TO DAT-OPTIONS (137)
  1668
  1669     IF WS-LF-TABLE (1) NOT = SPACES
  1670        MOVE WS-LF-TABLE (1)     TO DAT-OPTIONS (128)
  1671     END-IF
  1672     IF WS-LF-TABLE (2) NOT = SPACES
  1673        MOVE WS-LF-TABLE (2)     TO DAT-OPTIONS (129)
  1674     END-IF
  1675     IF WS-LF-TABLE (3) NOT = SPACES
  1676        MOVE WS-LF-TABLE (3)     TO DAT-OPTIONS (130)
  1677     END-IF
  1678     IF WS-LF-TABLE (4) NOT = SPACES
  1679        MOVE WS-LF-TABLE (4)     TO DAT-OPTIONS (131)
  1680     END-IF
  1681
  1682     DISPLAY ' WS STATE IS ' WS-STATE
  1683
  1684     IF WS-STATE = 'IN' OR 'TN' OR 'MD'
  1685        MOVE 25000               TO DAT-OPTIONS-NUM (409)
  1686     END-IF
  1687
  1688     PERFORM VARYING T1 FROM +1 BY +1 UNTIL
  1689        T1 > T2M
  1690        PERFORM 0850-WRITE-DAT-OUT
  1691                                 THRU 0850-EXIT
  1692     END-PERFORM
  1693
  1694     .
  1695 0800-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* PEMRTXEM.cbl
  1696     EXIT.
  1697
  1698 0850-WRITE-DAT-OUT.
  1699
  1700     WRITE DAT-OUT-REC           FROM DAT-OPTIONS (T1)
  1701     ADD 1                       TO DAT-RECS-OUT
  1702
  1703     .
  1704 0850-EXIT.
  1705     EXIT.
  1706
  1707 ABEND-PGM.
* 1708                     COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      115600     Code:        7556
