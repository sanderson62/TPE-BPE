* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMATX1.cbl
* Options: int("PEMATX1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMATX1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMATX1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMATX1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMATX1.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT ELTRLR           ASSIGN TO ELTRLR
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS AT-CONTROL-PRIMARY
    13                             FILE STATUS IS ELTRLR-FILE-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMATX1.cbl
    14
    15     SELECT ELTRLR-OUT       ASSIGN TO ELTRLROT
    16         ORGANIZATION IS LINE SEQUENTIAL.
    17
    18 DATA DIVISION.
    19 FILE SECTION.
    20
    21 FD  ELTRLR.
    22
*   23     COPY ELCTRLR.
    24******************************************************************04/16/98
    25*                                                                *ELCTRLR
    26*                            ELCTRLR.                            *   LV002
    27*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    28*                            VMOD=2.014                          *   CL**2
    29*                                                                *ELCTRLR
    30*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *ELCTRLR
    31*                                                                *ELCTRLR
    32*   FILE TYPE = VSAM,KSDS                                        *ELCTRLR
    33*   RECORD SIZE = 200    RECFORM = FIXED                         *ELCTRLR
    34*                                                                *ELCTRLR
    35*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *ELCTRLR
    36*       ALTERNATE INDEX = NONE                                   *ELCTRLR
    37*                                                                *ELCTRLR
    38*   LOG = YES                                                    *ELCTRLR
    39*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCTRLR
    40******************************************************************
    41*                   C H A N G E   L O G
    42*
    43* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    44*-----------------------------------------------------------------
    45*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    46* EFFECTIVE    NUMBER
    47*-----------------------------------------------------------------
    48* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
    49* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
    50* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
    51* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
    52* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
    53* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
    54* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
    55* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
    56* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
    57* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
    58* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
    59* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
    60* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAILER
    61* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM IND
    62* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
    63* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
    64* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
    65* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
    66* 040814    2014030500002  AJRA  ADD ICD CODES
    67* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
    68******************************************************************ELCTRLR
    69 01  ACTIVITY-TRAILERS.                                           ELCTRLR
    70     12  AT-RECORD-ID                    PIC XX.                  ELCTRLR
    71         88  VALID-AT-ID                       VALUE 'AT'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
    72                                                                  ELCTRLR
    73     12  AT-CONTROL-PRIMARY.                                      ELCTRLR
    74         16  AT-COMPANY-CD               PIC X.                   ELCTRLR
    75         16  AT-CARRIER                  PIC X.                   ELCTRLR
    76         16  AT-CLAIM-NO                 PIC X(7).                ELCTRLR
    77         16  AT-CERT-NO.                                          ELCTRLR
    78             20  AT-CERT-PRIME           PIC X(10).               ELCTRLR
    79             20  AT-CERT-SFX             PIC X.                   ELCTRLR
    80         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.      ELCTRLR
    81             88  AT-1ST-TRL-AVAIL             VALUE +4095.        ELCTRLR
    82             88  AT-LAST-TRL-AVAIL            VALUE +100.         ELCTRLR
    83             88  AT-RESV-EXP-HIST-TRL         VALUE +0.           ELCTRLR
    84             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.   ELCTRLR
    85             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19. ELCTRLR
    86             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29. ELCTRLR
    87             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39. ELCTRLR
    88             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49. ELCTRLR
    89             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59. ELCTRLR
    90             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69. ELCTRLR
    91             88  AT-DIAGNOSIS-TRL             VALUE +90.          ELCTRLR
    92             88  AT-BENEFICIARY-TRL           VALUE +91.
    93             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
    94             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
    95             88  AT-VFY-CAUSAL-STATE          VALUE +94.
    96             88  AT-ERROR-MSGS-TRL            VALUE +95.
    97                                                                  ELCTRLR
    98     12  AT-TRAILER-TYPE                 PIC X.                   ELCTRLR
    99         88  RESERVE-EXPENSE-TR               VALUE '1'.          ELCTRLR
   100         88  PAYMENT-TR                       VALUE '2'.          ELCTRLR
   101         88  AUTO-PAY-TR                      VALUE '3'.          ELCTRLR
   102         88  CORRESPONDENCE-TR                VALUE '4'.          ELCTRLR
   103         88  ADDRESS-TR                       VALUE '5'.          ELCTRLR
   104         88  GENERAL-INFO-TR                  VALUE '6'.          ELCTRLR
   105         88  AUTO-PROMPT-TR                   VALUE '7'.          ELCTRLR
   106         88  DENIAL-TR                        VALUE '8'.          ELCTRLR
   107         88  INCURRED-CHG-TR                  VALUE '9'.          ELCTRLR
   108         88  FORM-CONTROL-TR                  VALUE 'A'.          ELCTRLR
   109                                                                  ELCTRLR
   110     12  AT-RECORDED-DT                  PIC XX.                  ELCTRLR
   111     12  AT-RECORDED-BY                  PIC X(4).                ELCTRLR
   112     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.    ELCTRLR
   113                                                                  ELCTRLR
   114     12  AT-TRAILER-BODY                 PIC X(165).              ELCTRLR
   115                                                                  ELCTRLR
   116     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.       ELCTRLR
   117         16  AT-RESERVE-CONTROLS.                                 ELCTRLR
   118             20  AT-MANUAL-SW            PIC X.                   ELCTRLR
   119                 88  AT-MANUAL-RESERVES-USED VALUE '1'.           ELCTRLR
   120             20  AT-FUTURE-SW            PIC X.                   ELCTRLR
   121                 88  AT-FUTURE-RESERVES-USED VALUE '1'.           ELCTRLR
   122             20  AT-PTC-SW               PIC X.                   ELCTRLR
   123                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.           ELCTRLR
   124             20  AT-IBNR-SW              PIC X.                   ELCTRLR
   125                 88  AT-IBNR-RESERVES-USED   VALUE '1'.           ELCTRLR
   126             20  AT-PTC-LF-SW            PIC X.                   ELCTRLR
   127                 88  AT-LF-PTC-USED          VALUE '1'.           ELCTRLR
   128             20  AT-CDT-ACCESS-METHOD    PIC X.                   ELCTRLR
   129                 88  AT-CDT-ROUND-NEAR       VALUE '1'.           ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   130                 88  AT-CDT-ROUND-HIGH       VALUE '2'.           ELCTRLR
   131                 88  AT-CDT-INTERPOLATED     VALUE '3'.           ELCTRLR
   132             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.  ELCTRLR
   133         16  AT-LAST-COMPUTED-DT         PIC XX.                  ELCTRLR
   134         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.  ELCTRLR
   135         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.  ELCTRLR
   136         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.  ELCTRLR
   137         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   138         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   139         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.  ELCTRLR
   140         16  AT-EXPENSE-CONTROLS.                                 ELCTRLR
   141             20  AT-EXPENSE-METHOD       PIC X.                   ELCTRLR
   142                 88  NO-EXPENSE-CALCULATED    VALUE '1'.          ELCTRLR
   143                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.          ELCTRLR
   144                 88  PERCENT-OF-PMT           VALUE '3'.          ELCTRLR
   145                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.          ELCTRLR
   146             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.  ELCTRLR
   147             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.  ELCTRLR
   148         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.  ELCTRLR
   149         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.  ELCTRLR
   150                                                                  ELCTRLR
   151         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.  ELCTRLR
   152         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.  ELCTRLR
   153                                                                  ELCTRLR
   154*        16  FILLER                      PIC X(53).               ELCTRLR
   155         16  FILLER                      PIC X(47).               ELCTRLR
   156                                                                  ELCTRLR
   157         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   158         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   159                                                                  ELCTRLR
   160         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.                ELCTRLR
   161             20  AT-OPEN-CLOSE-DATE      PIC XX.                  ELCTRLR
   162             20  AT-OPEN-CLOSE-TYPE      PIC X.                   ELCTRLR
   163*                    C = CLOSED                                   ELCTRLR
   164*                    O = OPEN                                     ELCTRLR
   165             20  AT-OPEN-CLOSE-REASON    PIC X(5).                ELCTRLR
   166*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE      ELCTRLR
   167                                                                  ELCTRLR
   168     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   169         16  AT-PAYMENT-TYPE             PIC X.                   ELCTRLR
   170             88  PARTIAL-PAYMENT                VALUE '1'.        ELCTRLR
   171             88  FINAL-PAYMENT                  VALUE '2'.        ELCTRLR
   172             88  LUMP-SUM-PAYMENT               VALUE '3'.        ELCTRLR
   173             88  ADDITIONAL-PAYMENT             VALUE '4'.        ELCTRLR
   174             88  CHARGEABLE-EXPENSE             VALUE '5'.        ELCTRLR
   175             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.        ELCTRLR
   176             88  VOIDED-PAYMENT                 VALUE '9'.        ELCTRLR
   177             88  TRANSFER                       VALUE 'T'.
   178             88  LIFE-INTEREST                  VALUE 'I'.
   179                                                                  ELCTRLR
   180         16  AT-CLAIM-TYPE               PIC X.                   ELCTRLR
   181             88  PAID-FOR-AH                    VALUE 'A'.        ELCTRLR
   182             88  PAID-FOR-LIFE                  VALUE 'L'.        ELCTRLR
   183             88  PAID-FOR-IUI                   VALUE 'I'.        ELCTRLR
   184             88  PAID-FOR-GAP                   VALUE 'G'.        ELCTRLR
   185             88  PAID-FOR-FAM                   VALUE 'F'.
   186         16  AT-CLAIM-PREM-TYPE          PIC X.                   ELCTRLR
   187             88  AT-SINGLE-PREMIUM              VALUE '1'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   188             88  AT-O-B-COVERAGE                VALUE '2'.        ELCTRLR
   189             88  AT-OPEN-END-COVERAGE           VALUE '3'.        ELCTRLR
   190         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.    ELCTRLR
   191         16  AT-CHECK-NO                 PIC X(7).                ELCTRLR
   192         16  AT-PAID-FROM-DT             PIC XX.                  ELCTRLR
   193         16  AT-PAID-THRU-DT             PIC XX.                  ELCTRLR
   194         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.      ELCTRLR
   195         16  FILLER                      PIC X.                   ELCTRLR
   196         16  AT-PAYEES-NAME              PIC X(30).               ELCTRLR
   197         16  AT-PAYMENT-ORIGIN           PIC X.                   ELCTRLR
   198             88  ONLINE-MANUAL-PMT              VALUE '1'.        ELCTRLR
   199             88  ONLINE-AUTO-PMT                VALUE '2'.        ELCTRLR
   200             88  OFFLINE-PMT                    VALUE '3'.        ELCTRLR
   201         16  AT-CHECK-WRITTEN-DT         PIC XX.                  ELCTRLR
   202         16  AT-TO-BE-WRITTEN-DT         PIC XX.                  ELCTRLR
   203         16  AT-VOID-DATA.                                        ELCTRLR
   204             20  AT-VOID-DT              PIC XX.                  ELCTRLR
   205*00144       20  AT-VOID-REASON          PIC X(30).               ELCTRLR
   206             20  AT-VOID-REASON          PIC X(26).
   207         16  AT-PMT-APPROVED-BY          PIC X(04).
   208         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.    ELCTRLR
   209         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.    ELCTRLR
   210         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
   211                                         PIC S99V9(5)  COMP-3.
   212         16  AT-CREDIT-INTERFACE.                                 ELCTRLR
   213             20  AT-PMT-SELECT-DT        PIC XX.                  ELCTRLR
   214                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.       ELCTRLR
   215             20  AT-PMT-ACCEPT-DT        PIC XX.                  ELCTRLR
   216                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.       ELCTRLR
   217             20  AT-VOID-SELECT-DT       PIC XX.                  ELCTRLR
   218                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.       ELCTRLR
   219             20  AT-VOID-ACCEPT-DT       PIC XX.                  ELCTRLR
   220                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.       ELCTRLR
   221                                                                  ELCTRLR
   222         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.      ELCTRLR
   223                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.     ELCTRLR
   224                 88  CONVERSION-PAYMENT           VALUE +99999999.ELCTRLR
   225         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.      ELCTRLR
   226                                                                  ELCTRLR
   227         16  AT-FORCE-CONTROL            PIC X.                   ELCTRLR
   228             88  PAYMENT-WAS-FORCED           VALUE '1'.          ELCTRLR
   229         16  AT-PREV-LAST-PMT-DT         PIC XX.                  ELCTRLR
   230         16  AT-PREV-PAID-THRU-DT        PIC XX.                  ELCTRLR
   231         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   232         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.    ELCTRLR
   233         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.    ELCTRLR
   234         16  AT-BENEFIT-TYPE             PIC X.                   ELCTRLR
   235                                                                  ELCTRLR
   236         16  AT-EXPENSE-TYPE             PIC X.                   ELCTRLR
   237         16  AT-PAYMENT-APPROVAL-SW      PIC X.                   ELCTRLR
   238                                                                  ELCTRLR
   239         16  AT-PAYEE-TYPE-CD.                                    ELCTRLR
   240             20  AT-PAYEE-TYPE           PIC X.                   ELCTRLR
   241                 88  INSURED-PAID           VALUE 'I'.            ELCTRLR
   242                 88  BENEFICIARY-PAID       VALUE 'B'.            ELCTRLR
   243                 88  ACCOUNT-PAID           VALUE 'A'.            ELCTRLR
   244                 88  OTHER-1-PAID           VALUE 'O'.            ELCTRLR
   245                 88  OTHER-2-PAID           VALUE 'Q'.            ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   246                 88  DOCTOR-PAID            VALUE 'P'.            ELCTRLR
   247                 88  EMPLOYER-PAID          VALUE 'E'.            ELCTRLR
   248             20  AT-PAYEE-SEQ            PIC X.                   ELCTRLR
   249                                                                  ELCTRLR
   250         16  AT-CASH-PAYMENT             PIC X.                   ELCTRLR
   251         16  AT-GROUPED-PAYMENT          PIC X.                   ELCTRLR
   252         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.    ELCTRLR
   253         16  AT-APPROVAL-LEVEL-REQD      PIC X.                   ELCTRLR
   254         16  AT-APPROVED-LEVEL           PIC X.                   ELCTRLR
   255         16  AT-VOID-TYPE                PIC X.                   ELCTRLR
   256             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.            ELCTRLR
   257             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.            ELCTRLR
   258         16  AT-AIG-UNEMP-IND            PIC X.                   ELCTRLR
   259             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.            ELCTRLR
   260         16  AT-ASSOCIATES               PIC X.                   ELCTRLR
   261             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.        ELCTRLR
   262             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.        ELCTRLR
   263                                                                  ELCTRLR
   264         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.    ELCTRLR
   265         16  AT-CV-PMT-CODE              PIC X.                   ELCTRLR
   266             88  FULL-DEATH-PAYMENT         VALUE '1'.            ELCTRLR
   267             88  HALF-DEATH-PAYMENT         VALUE '2'.            ELCTRLR
   268             88  FULL-ADD-PAYMENT           VALUE '3'.            ELCTRLR
   269             88  HALF-ADD-PAYMENT           VALUE '4'.            ELCTRLR
   270             88  FULL-RIDER-PAYMENT         VALUE '5'.            ELCTRLR
   271             88  HALF-RIDER-PAYMENT         VALUE '6'.            ELCTRLR
   272             88  NON-CHG-EXP-PAYMENT        VALUE '7'.            ELCTRLR
   273             88  ADDL-PAYMENT               VALUE '8'.            ELCTRLR
   274                                                                  ELCTRLR
   275         16  AT-EOB-CODE1                PIC XXX.                 ELCTRLR
   276         16  AT-EOB-CODE2                PIC XXX.                 ELCTRLR
   277         16  AT-EOB-CODE3                PIC XXX.
   278         16  FILLER REDEFINES AT-EOB-CODE3.
   279             20  AT-PRINT-CLM-FORM       PIC X.
   280             20  AT-PRINT-SURVEY         PIC X.
   281             20  AT-SPECIAL-RELEASE      PIC X.
   282         16  AT-EOB-CODE4                PIC XXX.                 ELCTRLR
   283         16  FILLER REDEFINES AT-EOB-CODE4.
   284             20  AT-INT-PMT-SELECT-DT    PIC XX.
   285             20  FILLER                  PIC X.
   286         16  AT-EOB-CODE5                PIC XXX.                 ELCTRLR
   287         16  FILLER REDEFINES AT-EOB-CODE5.
   288             20  AT-PMT-PROOF-DT         PIC XX.
   289             20  FILLER                  PIC X.
   290                                                                  ELCTRLR
   291         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
   292             88  AT-PRINT-EOB            VALUE 'Y'.
   293                                                                  ELCTRLR
   294         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   295         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   296                                                                  ELCTRLR
   297     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.              ELCTRLR
   298         16  AT-SCHEDULE-START-DT        PIC XX.                  ELCTRLR
   299         16  AT-SCHEDULE-END-DT          PIC XX.                  ELCTRLR
   300         16  AT-TERMINATED-DT            PIC XX.                  ELCTRLR
   301         16  AT-LAST-PMT-TYPE            PIC X.                   ELCTRLR
   302             88  LAST-PMT-IS-FINAL              VALUE 'F'.        ELCTRLR
   303             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.        ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   304         16  AT-FIRST-PMT-DATA.                                   ELCTRLR
   305             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.    ELCTRLR
   306             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.      ELCTRLR
   307             20  AT-1ST-PAY-THRU-DT      PIC XX.                  ELCTRLR
   308         16  AT-REGULAR-PMT-DATA.                                 ELCTRLR
   309             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.    ELCTRLR
   310             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.      ELCTRLR
   311             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.      ELCTRLR
   312         16  AT-AUTO-PAYEE-CD.                                    ELCTRLR
   313             20  AT-AUTO-PAYEE-TYPE      PIC X.                   ELCTRLR
   314                 88  INSURED-PAID-AUTO      VALUE 'I'.            ELCTRLR
   315                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.            ELCTRLR
   316                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.            ELCTRLR
   317                 88  OTHER-1-PAID-AUTO      VALUE 'O'.            ELCTRLR
   318                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.            ELCTRLR
   319             20  AT-AUTO-PAYEE-SEQ       PIC X.                   ELCTRLR
   320         16  AT-AUTO-PAY-DAY             PIC 99.                  ELCTRLR
   321         16  AT-AUTO-CASH                PIC X.                   ELCTRLR
   322             88  AT-CASH                      VALUE 'Y'.          ELCTRLR
   323             88  AT-NON-CASH                  VALUE 'N'.          ELCTRLR
   324*        16  FILLER                      PIC X(129).              ELCTRLR
   325         16  AT-AUTO-END-LETTER          PIC X(4).
   326         16  FILLER                      PIC X(125).
   327                                                                  ELCTRLR
   328         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   329         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   330                                                                  ELCTRLR
   331     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.        ELCTRLR
   332         16  AT-LETTER-SENT-DT           PIC XX.                  ELCTRLR
   333         16  AT-RECEIPT-FOLLOW-UP        PIC XX.                  ELCTRLR
   334         16  AT-AUTO-RE-SEND-DT          PIC XX.                  ELCTRLR
   335         16  AT-LETTER-ANSWERED-DT       PIC XX.                  ELCTRLR
   336         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.      ELCTRLR
   337         16  AT-LETTER-ORIGIN            PIC X.                   ELCTRLR
   338             88  ONLINE-CREATION              VALUE '1' '3'.
   339             88  OFFLINE-CREATION             VALUE '2' '4'.
   340             88  NAPER-ONLINE-CREATION        VALUE '3'.
   341             88  NAPER-OFFLINE-CREATION       VALUE '4'.
   342         16  AT-STD-LETTER-FORM          PIC X(4).                ELCTRLR
   343         16  AT-REASON-TEXT              PIC X(70).               ELCTRLR
   344         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.      ELCTRLR
   345         16  AT-ADDRESEE-TYPE            PIC X.                   ELCTRLR
   346              88  INSURED-ADDRESEE            VALUE 'I'.          ELCTRLR
   347              88  BENEFICIARY-ADDRESEE        VALUE 'B'.          ELCTRLR
   348              88  ACCOUNT-ADDRESEE            VALUE 'A'.          ELCTRLR
   349              88  PHYSICIAN-ADDRESEE          VALUE 'P'.          ELCTRLR
   350              88  EMPLOYER-ADDRESEE           VALUE 'E'.          ELCTRLR
   351              88  OTHER-ADDRESEE-1            VALUE 'O'.          ELCTRLR
   352              88  OTHER-ADDRESEE-2            VALUE 'Q'.          ELCTRLR
   353         16  AT-ADDRESSEE-NAME           PIC X(30).               ELCTRLR
   354         16  AT-INITIAL-PRINT-DATE       PIC XX.                  ELCTRLR
   355         16  AT-RESEND-PRINT-DATE        PIC XX.                  ELCTRLR
   356         16  AT-CORR-SOL-UNSOL           PIC X.                   ELCTRLR
   357         16  AT-LETTER-PURGED-DT         PIC XX.                  ELCTRLR
   358*                                                                 ELCTRLR
   359*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.          ELCTRLR
   360*                                                                 ELCTRLR
   361         16  AT-CSO-REDEFINITION.                                 00001862
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   362             20  AT-RESEND-LETTER-FORM   PIC X(4).
   363             20  AT-AUTO-CLOSE-IND       PIC X(1).
   364             20  AT-LETTER-TO-BENE       PIC X(1).
   365             20  AT-STOP-LETTER-DT       PIC X(2).
   366             20  FILLER                  PIC X(19).
   367*             20  FILLER                  PIC X(27).               0000186
   368             20  AT-CSO-LETTER-STATUS    PIC X.                   00001864
   369                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.           00001865
   370                 88  AT-CSO-LETTER-PURGED    VALUE '2'.           00001866
   371                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.           00001867
   372             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.               00001868
   373             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.               00001869
   374*                                                                 ELCTRLR
   375*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED ELCTRLR
   376*                                                                 ELCTRLR
   377*        16  FILLER                      PIC X(26).               ELCTRLR
   378*                                                                 ELCTRLR
   379*        16  AT-DMD-BSR-CODE             PIC X.                   ELCTRLR
   380*            88  AT-AUTOMATED-BSR              VALUE 'A'.         ELCTRLR
   381*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.     ELCTRLR
   382*                                                                 ELCTRLR
   383*        16  AT-DMD-LETTER-STATUS        PIC X.                   ELCTRLR
   384*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.         ELCTRLR
   385*            88  AT-DMD-LETTER-PURGED          VALUE '2'.         ELCTRLR
   386*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.         ELCTRLR
   387*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.                  ELCTRLR
   388*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.                  ELCTRLR
   389                                                                  ELCTRLR
   390         16  AT-CORR-LAST-MAINT-DT       PIC XX.                  ELCTRLR
   391         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   392                                                                  ELCTRLR
   393     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.               ELCTRLR
   394         16  AT-ADDRESS-TYPE             PIC X.                   ELCTRLR
   395             88  INSURED-ADDRESS               VALUE 'I'.         ELCTRLR
   396             88  BENEFICIARY-ADDRESS           VALUE 'B'.         ELCTRLR
   397             88  ACCOUNT-ADDRESS               VALUE 'A'.         ELCTRLR
   398             88  PHYSICIAN-ADDRESS             VALUE 'P'.         ELCTRLR
   399             88  EMPLOYER-ADDRESS              VALUE 'E'.         ELCTRLR
   400             88  OTHER-ADDRESS-1               VALUE 'O'.         ELCTRLR
   401             88  OTHER-ADDRESS-2               VALUE 'Q'.         ELCTRLR
   402         16  AT-MAIL-TO-NAME             PIC X(30).               ELCTRLR
   403         16  AT-ADDRESS-LINE-1           PIC X(30).               ELCTRLR
   404         16  AT-ADDRESS-LINE-2           PIC X(30).               ELCTRLR
   405         16  AT-CITY-STATE.
   406             20  AT-CITY                 PIC X(28).
   407             20  AT-STATE                PIC XX.
   408         16  AT-ZIP.                                              ELCTRLR
   409             20  AT-ZIP-CODE.                                     ELCTRLR
   410                 24  AT-ZIP-1ST          PIC X.                   ELCTRLR
   411                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.ELCTRLR
   412                 24  FILLER              PIC X(4).                ELCTRLR
   413             20  AT-ZIP-PLUS4            PIC X(4).                ELCTRLR
   414         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.          ELCTRLR
   415             20  AT-CAN-POSTAL-1         PIC XXX.                 ELCTRLR
   416             20  AT-CAN-POSTAL-2         PIC XXX.                 ELCTRLR
   417             20  FILLER                  PIC XXX.                 ELCTRLR
   418         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.    ELCTRLR
   419*         16  FILLER                      PIC X(23).               ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   420         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
   421         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
   422         16  FILLER                      PIC X(13).
   423         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.                  ELCTRLR
   424         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).                ELCTRLR
   425                                                                  ELCTRLR
   426     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   427         16  AT-INFO-LINE-1              PIC X(60).               ELCTRLR
   428         16  FILLER REDEFINES AT-INFO-LINE-1.
   429             20  AT-NOTE-ERROR-NO OCCURS 15
   430                                         PIC X(4).
   431         16  AT-INFO-LINE-2              PIC X(60).               ELCTRLR
   432         16  FILLER REDEFINES AT-INFO-LINE-2.
   433             20  AT-ICD-CODE-1           PIC X(8).
   434             20  AT-ICD-CODE-2           PIC X(8).
   435             20  FILLER                  PIC X(44).
   436         16  AT-INFO-TRAILER-TYPE        PIC X.                   ELCTRLR
   437             88  AT-ERRORS-NOTE          VALUE 'E'.
   438             88  AT-PAYMENT-NOTE         VALUE 'P'.               ELCTRLR
   439             88  AT-CALL-NOTE            VALUE 'C'.               ELCTRLR
   440             88  AT-MAINT-NOTE           VALUE 'M'.               ELCTRLR
   441             88  AT-CERT-CHANGE          VALUE 'X'.               ELCTRLR
   442             88  AT-APPROVAL-NOTE        VALUE 'R'.
   443             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
   444             88  AT-CERT-CANCELLED       VALUE 'T'.
   445         16  AT-CALL-TYPE                PIC X.                   ELCTRLR
   446             88  AT-PHONE-CALL-IN        VALUE 'I'.               ELCTRLR
   447             88  AT-PHONE-CALL-OUT       VALUE 'O'.               ELCTRLR
   448         16  AT-NOTE-CONTINUATION        PIC X.                   ELCTRLR
   449             88  AT-CONTINUED-NOTE       VALUE 'X'.
   450         16  AT-EOB-CODES-EXIST          PIC X.
   451             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
   452         16  FILLER                      PIC X(35).               ELCTRLR
   453         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.                  ELCTRLR
   454         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   455                                                                  ELCTRLR
   456     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   457         16  AT-PROMPT-LINE-1            PIC X(60).               ELCTRLR
   458         16  AT-PROMPT-LINE-2            PIC X(60).               ELCTRLR
   459         16  AT-PROMPT-START-DT          PIC XX.                  ELCTRLR
   460         16  AT-PROMPT-END-DT            PIC XX.                  ELCTRLR
   461         16  FILLER                      PIC X(35).               ELCTRLR
   462         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   463         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   464                                                                  ELCTRLR
   465     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.           ELCTRLR
   466         16  AT-DENIAL-INFO-1            PIC X(60).               ELCTRLR
   467         16  AT-DENIAL-INFO-2            PIC X(60).               ELCTRLR
   468         16  AT-DENIAL-DT                PIC XX.                  ELCTRLR
   469         16  AT-RETRACTION-DT            PIC XX.                  ELCTRLR
   470         16  AT-DENIAL-REASON-CODE       PIC X(4).                ELCTRLR
   471*         16  FILLER                      PIC X(31).               ELCTRLR
   472         16  AT-DENIAL-PROOF-DT          PIC XX.
   473         16  FILLER                      PIC X(29).
   474         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.                  ELCTRLR
   475         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).                ELCTRLR
   476                                                                  ELCTRLR
   477     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCTRLR)
   478         16  AT-OLD-INCURRED-DT          PIC XX.                  ELCTRLR
   479         16  AT-OLD-REPORTED-DT          PIC XX.                  ELCTRLR
   480         16  AT-OLD-ESTABLISHED-DT       PIC XX.                  ELCTRLR
   481         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3. ELCTRLR
   482         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.   ELCTRLR
   483         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3. ELCTRLR
   484         16  AT-OLD-PAID-THRU-DT         PIC XX.                  ELCTRLR
   485         16  AT-LAST-PMT-MADE-DT         PIC XX.                  ELCTRLR
   486         16  FILLER                      PIC X(26).               ELCTRLR
   487         16  AT-OLD-DIAG-CODE            PIC X(6).                ELCTRLR
   488         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.   ELCTRLR
   489         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3. ELCTRLR
   490         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3. ELCTRLR
   491         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   492         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3. ELCTRLR
   493         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3. ELCTRLR
   494         16  AT-OLD-DIAG-DESCRIP         PIC X(60).               ELCTRLR
   495         16  AT-OLD-ICD-CODE-1           PIC X(8).
   496         16  AT-OLD-ICD-CODE-2           PIC X(8).
   497         16  FILLER                      PIC X(9).                ELCTRLR
   498         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).                ELCTRLR
   499                                                                  ELCTRLR
   500     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.          ELCTRLR
   501         16  AT-FORM-SEND-ON-DT          PIC XX.                  ELCTRLR
   502         16  AT-FORM-FOLLOW-UP-DT        PIC XX.                  ELCTRLR
   503         16  AT-FORM-RE-SEND-DT          PIC XX.                  ELCTRLR
   504         16  AT-FORM-ANSWERED-DT         PIC XX.                  ELCTRLR
   505         16  AT-FORM-PRINTED-DT          PIC XX.                  ELCTRLR
   506         16  AT-FORM-REPRINT-DT          PIC XX.                  ELCTRLR
   507         16  AT-FORM-TYPE                PIC X.                   ELCTRLR
   508             88  INITIAL-FORM                  VALUE '1'.         ELCTRLR
   509             88  PROGRESS-FORM                 VALUE '2'.         ELCTRLR
   510         16  AT-INSTRUCT-LN-1            PIC X(28).               ELCTRLR
   511         16  AT-INSTRUCT-LN-2            PIC X(28).               ELCTRLR
   512         16  AT-INSTRUCT-LN-3            PIC X(28).               ELCTRLR
   513         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.     ELCTRLR
   514         16  AT-FORM-ADDRESS             PIC X.                   ELCTRLR
   515             88  FORM-TO-INSURED              VALUE 'I'.          ELCTRLR
   516             88  FORM-TO-ACCOUNT              VALUE 'A'.          ELCTRLR
   517             88  FORM-TO-OTHER-1              VALUE 'O'.          ELCTRLR
   518             88  FORM-TO-OTHER-2              VALUE 'Q'.          ELCTRLR
   519         16  AT-RELATED-1.                                        ELCTRLR
   520             20 AT-REL-CARR-1            PIC X.                   ELCTRLR
   521             20 AT-REL-CLAIM-1           PIC X(7).                ELCTRLR
   522             20 AT-REL-CERT-1            PIC X(11).               ELCTRLR
   523         16  AT-RELATED-2.                                        ELCTRLR
   524             20 AT-REL-CARR-2            PIC X.                   ELCTRLR
   525             20 AT-REL-CLAIM-2           PIC X(7).                ELCTRLR
   526             20 AT-REL-CERT-2            PIC X(11).               ELCTRLR
   527         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   528         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.                  ELCTRLR
   529         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   530         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.                  ELCTRLR
   531         16  AT-FORM-REM-PRINT-DT        PIC XX.                  ELCTRLR
   532         16  AT-STOP-FORM-DT             PIC X(2).
   533                                                                  ELCTRLR
   534         16  FILLER                      PIC X(09).               ELCTRLR
   535         16  AT-FORM-LAST-MAINT-DT       PIC XX.                  ELCTRLR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMATX1.cbl
   536         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).                ELCTRLR
   537******************************************************************ELCTRLR
   538
   539 FD  ELTRLR-OUT
   540     RECORDING MODE F
   541     LABEL RECORDS STANDARD
   542     BLOCK CONTAINS 0 RECORDS.
   543
   544 01  ELTRLR-OUT-REC              PIC X(212).
   545
   546 WORKING-STORAGE SECTION.
   547 77  FILLER  PIC X(32) VALUE '********************************'.
   548 77  FILLER  PIC X(32) VALUE '   PEMATX1  WORKING STORAGE     '.
   549 77  FILLER  PIC X(32) VALUE '********************************'.
   550
   551 77  WS-EOF-SW               PIC X VALUE SPACES.
   552     88  END-OF-ELTRLR             VALUE 'Y'.
   553 77  TRL-RECS-IN             PIC 9(9) VALUE ZEROS.
   554 77  TRL-RECS-OUT            PIC 9(9) VALUE ZEROS.
   555 77  SUB1                    PIC S9(5) VALUE +0 COMP-3.
   556
   557 01  WS-SAVE-ELTRLR              PIC X(212) VALUE SPACES.
   558
   559 01  ELTRLR-DETAIL-RECORD.
   560     12  EX-CARRIER              PIC X.
   561     12  EX-TAB1                 PIC X.
   562     12  EX-CLAIM-NO             PIC X(7).
   563     12  EX-TAB2                 PIC X.
   564     12  EX-CERT-NO              PIC X(11).
   565     12  EX-TAB3                 PIC X.
   566     12  EX-STD-LETTER-FORM      PIC XXXX.
   567     12  EX-TAB4                 PIC X.
   568     12  EX-RECORDED-DT          PIC X(10).
   569     12  EX-TAB5                 PIC X.
   570     12  EX-LETTER-SENT-DT       PIC X(10).
   571     12  EX-TAB6                 PIC X.
   572     12  EX-RECEIPT-FOLLOW-UP    PIC X(10).
   573     12  EX-TAB7                 PIC X.
   574     12  EX-LETTER-ANSWERED-DT   PIC X(10).
   575     12  EX-TAB8                 PIC X.
   576     12  EX-STOP-LETTER-DT       PIC X(10).
   577     12  EX-TAB9                 PIC X.
   578     12  EX-EOR                  PIC X.
   579
   580******************************************************************
   581 01  WS-MISC.
   582     05  WS-WORK-SEQ             PIC X.
   583     05  WS-NUM-SEQ REDEFINES WS-WORK-SEQ PIC 9.
   584     05  ELTRLR-FILE-STATUS      PIC XX    VALUE ZEROS.
   585     05  WS-DATE                 PIC 9(11) VALUE ZEROS.
   586
*  587                                 COPY ELCDATE.
   588******************************************************************06/11/98
   589*                                                                *ELCDATE
   590*                                                                *ELCDATE
   591*                            ELCDATE.                            *   LV023
   592*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   593*                            VMOD=2.003                           ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   594*                                                                *ELCDATE
   595*                                                                *ELCDATE
   596*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   597*                 LENGTH = 200                                   *   CL*19
   598******************************************************************ELCDATE
   599                                                                  ELCDATE
   600 01  DATE-CONVERSION-DATA.                                        ELCDATE
   601     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   602     12  DC-OPTION-CODE                PIC X.                        CL*15
   603         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   604         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   605         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   606         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   607         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   608         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   609         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   610         88  FIND-CENTURY               VALUE '7'.                   CL*22
   611         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   612         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   613         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   614         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   615         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   616         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   617         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   618         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   619         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   620         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   621         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   622         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   623         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   624         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   625         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   626         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   627         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   628         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   629         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   630         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   631         88  THREE-CHARACTER-BIN                                  ELCDATE
   632                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   633         88  GREGORIAN-TO-BIN                                        CL**2
   634                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   635         88  BIN-TO-GREGORIAN                                        CL**2
   636                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   637         88  JULIAN-TO-BINARY                                        CL**2
   638                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   639     12  DC-ERROR-CODE                 PIC X.                        CL*15
   640         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   641         88  DATE-CONVERSION-ERROR                                ELCDATE
   642                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   643         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   644         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   645         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   646         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   647         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   648         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   649         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   650         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   651         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   652         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   653     12  DC-END-OF-MONTH               PIC X.                        CL*15
   654         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   655     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   656         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   657         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   658         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   659     12  FILLER                        PIC X.                        CL*15
   660     12  DC-CONVERSION-DATES.                                        CL*15
   661         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   662         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   663         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   664         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   665                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   666             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   667             20  SLASH1-1              PIC X.                        CL*15
   668             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   669             20  SLASH1-2              PIC X.                        CL*15
   670             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   671         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   672         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   673                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   674             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   675             20  SLASH2-1              PIC X.                        CL*15
   676             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   677             20  SLASH2-2              PIC X.                        CL*15
   678             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   679         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   680         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   681                     DC-GREG-DATE-1-YMD.                          ELCDATE
   682             20  DC-YMD-YEAR           PIC 99.                       CL*15
   683             20  DC-YMD-MONTH          PIC 99.                       CL*15
   684             20  DC-YMD-DAY            PIC 99.                       CL*15
   685         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   686         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   687                      DC-GREG-DATE-1-MDY.                         ELCDATE
   688             20  DC-MDY-MONTH          PIC 99.                       CL*15
   689             20  DC-MDY-DAY            PIC 99.                       CL*15
   690             20  DC-MDY-YEAR           PIC 99.                       CL*15
   691         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   692             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   693             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   694             20  FILLER                PIC XX.                       CL*15
   695             20  DC-ALPHA-CENTURY.                                   CL*15
   696                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   697             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   698         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   699         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   700         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   701         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   702         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   703                                       PIC 9(05).                    CL*20
   704         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   705             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   706             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   707         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   708         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   709         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   710     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   711         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   712         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   713             20  FILLER                PIC 9(3).                     CL*15
   714             20  HOLD-CEN-1-CCYY.                                    CL*15
   715                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   716                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   717             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   718             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   719         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   720             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   721             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   722             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   723                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   724                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   725             20  FILLER                PIC 9(3).                     CL*15
   726         16  HOLD-CENTURY-1-X.                                       CL*15
   727             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   728             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   729                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   730                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   731             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   732             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   733         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   734             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   735             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   736             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   737                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   738                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   739             20  FILLER                PIC XXX.                      CL*23
   740         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   741         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   742         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   743         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   744             20  DC-JULIAN-1-CCYY.                                   CL*15
   745                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   746                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   747             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   748         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   749         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   750             20  DC-JULIAN-2-CCYY.                                   CL*15
   751                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   752                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   753             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   754         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   755             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   756             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   757             20  DC-EDITA-DAY          PIC 99.                       CL*15
   758             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   759             20  DC-EDITA-CCYY.                                      CL*15
   760                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   761                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   762         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   763             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   764             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   765             20  DC-EDITB-DAY          PIC 99.                       CL*15
   766             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   767             20  DC-EDITB-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMATX1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   768                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   769                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   770         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   771         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   772                              DC-GREG-DATE-CYMD.                  ELCDATE
   773             20  DC-CYMD-CEN           PIC 99.                       CL*15
   774             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   775             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   776             20  DC-CYMD-DAY           PIC 99.                       CL*15
   777         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   778         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   779                              DC-GREG-DATE-MDCY.                  ELCDATE
   780             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   781             20  DC-MDCY-DAY           PIC 99.                       CL*15
   782             20  DC-MDCY-CEN           PIC 99.                       CL*15
   783             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   784    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   785        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   786    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   787    12  FILLER                         PIC X(28).                    CL*26
   788
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMATX1.cbl
   790 PROCEDURE DIVISION.
   791
   792     PERFORM 0400-OPEN-FILES     THRU 0400-EXIT
   793
   794     PERFORM 0600-INITIALIZE     THRU 0600-EXIT
   795
   796     PERFORM 0100-PROCESS-ELTRLR THRU 0100-EXIT UNTIL
   797           (END-OF-ELTRLR)
   798*          OR (TRL-RECS-IN > 1000)
   799
   800     PERFORM 0500-CLOSE-FILES    THRU 0500-EXIT
   801
   802     DISPLAY ' TRLR  RECORDS READ    '  TRL-RECS-IN
   803     DISPLAY ' TRLR  RECORDS WRITTEN '  TRL-RECS-OUT
   804     GOBACK
   805     .
   806
   807 0100-PROCESS-ELTRLR.
   808
   809     IF (AT-TRAILER-TYPE = '4')
   810        AND (AT-STD-LETTER-FORM (1:1) = 'X')
   811        PERFORM 0105-BUILD-EXTRACT THRU 0105-EXIT
   812     END-IF
   813
   814     PERFORM 0200-READ-ELTRLR    THRU 0200-EXIT
   815     .
   816 0100-EXIT.
   817     EXIT.
   818
   819 0105-BUILD-EXTRACT.
   820
   821     MOVE WS-SAVE-ELTRLR         TO ELTRLR-DETAIL-RECORD
   822     MOVE AT-CARRIER             TO EX-CARRIER
   823     MOVE AT-CLAIM-NO            TO EX-CLAIM-NO
   824     MOVE AT-CERT-NO             TO EX-CERT-NO
   825
   826     MOVE AT-STD-LETTER-FORM     TO EX-STD-LETTER-FORM
   827
   828     MOVE AT-LETTER-SENT-DT      TO DC-BIN-DATE-1
   829     MOVE ' '                    TO DC-OPTION-CODE
   830     PERFORM 8510-DATE-CONVERSION
   831                                 THRU 8590-EXIT
   832     IF NO-CONVERSION-ERROR
   833        MOVE DC-GREG-DATE-A-EDIT TO EX-LETTER-SENT-DT
   834     END-IF
   835
   836     MOVE AT-RECORDED-DT         TO DC-BIN-DATE-1
   837     MOVE ' '                    TO DC-OPTION-CODE
   838     PERFORM 8510-DATE-CONVERSION
   839                                 THRU 8590-EXIT
   840     IF NO-CONVERSION-ERROR
   841        MOVE DC-GREG-DATE-A-EDIT TO EX-RECORDED-DT
   842     END-IF
   843
   844     MOVE AT-RECEIPT-FOLLOW-UP   TO DC-BIN-DATE-1
   845     MOVE ' '                    TO DC-OPTION-CODE
   846     PERFORM 8510-DATE-CONVERSION
   847                                 THRU 8590-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMATX1.cbl
   848     IF NO-CONVERSION-ERROR
   849        MOVE DC-GREG-DATE-A-EDIT TO EX-RECEIPT-FOLLOW-UP
   850     END-IF
   851
   852     MOVE AT-LETTER-ANSWERED-DT  TO DC-BIN-DATE-1
   853     MOVE ' '                    TO DC-OPTION-CODE
   854     PERFORM 8510-DATE-CONVERSION
   855                                 THRU 8590-EXIT
   856     IF NO-CONVERSION-ERROR
   857        MOVE DC-GREG-DATE-A-EDIT TO EX-LETTER-ANSWERED-DT
   858     END-IF
   859
   860     MOVE AT-STOP-LETTER-DT      TO DC-BIN-DATE-1
   861     MOVE ' '                    TO DC-OPTION-CODE
   862     PERFORM 8510-DATE-CONVERSION
   863                                 THRU 8590-EXIT
   864     IF NO-CONVERSION-ERROR
   865        MOVE DC-GREG-DATE-A-EDIT TO EX-STOP-LETTER-DT
   866     END-IF
   867
   868     PERFORM 0300-WRITE-TRLR     THRU 0300-EXIT
   869
   870     .
   871 0105-EXIT.
   872     EXIT.
   873
   874 0200-READ-ELTRLR.
   875
   876     READ ELTRLR NEXT RECORD
   877
   878     IF ELTRLR-FILE-STATUS = '10' OR '23'
   879        SET END-OF-ELTRLR        TO TRUE
   880     ELSE
   881        IF ELTRLR-FILE-STATUS NOT = '00'
   882           DISPLAY 'ELTRLR READ NEXT ' ELTRLR-FILE-STATUS
   883           SET END-OF-ELTRLR     TO TRUE
   884        ELSE
   885           IF AT-COMPANY-CD > X'04'
   886              SET END-OF-ELTRLR TO TRUE
   887           END-IF
   888        END-IF
   889     END-IF
   890
   891     IF NOT END-OF-ELTRLR
   892        ADD 1 TO TRL-RECS-IN
   893     END-IF
   894
   895     .
   896 0200-EXIT.
   897     EXIT.
   898
   899 0300-WRITE-TRLR.
   900
   901     WRITE ELTRLR-OUT-REC        FROM ELTRLR-DETAIL-RECORD
   902     ADD 1 TO TRL-RECS-OUT
   903
   904     .
   905 0300-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMATX1.cbl
   906     EXIT.
   907
   908 0400-OPEN-FILES.
   909
   910     OPEN INPUT ELTRLR
   911         OUTPUT ELTRLR-OUT
   912
   913     IF ELTRLR-FILE-STATUS = '00' OR '97'
   914        CONTINUE
   915     ELSE
   916        DISPLAY 'ELTRLR OPEN ERR  ' ELTRLR-FILE-STATUS
   917     END-IF
   918
   919     .
   920 0400-EXIT.
   921     EXIT.
   922
   923 0500-CLOSE-FILES.
   924
   925     CLOSE ELTRLR ELTRLR-OUT
   926
   927     .
   928 0500-EXIT.
   929     EXIT.
   930
   931 0550-START-ELTRLR.
   932
   933     MOVE LOW-VALUES             TO AT-CONTROL-PRIMARY
   934     MOVE X'04'                  TO AT-COMPANY-CD
   935
   936     START ELTRLR KEY >= AT-CONTROL-PRIMARY
   937
   938     IF ELTRLR-FILE-STATUS = '10' OR '23'
   939        SET END-OF-ELTRLR        TO TRUE
   940     ELSE
   941        IF ELTRLR-FILE-STATUS NOT = '00'
   942           DISPLAY 'ELTRLR START     ' ELTRLR-FILE-STATUS
   943           SET END-OF-ELTRLR     TO TRUE
   944        END-IF
   945     END-IF
   946
   947     .
   948 0550-EXIT.
   949     EXIT.
   950
   951
   952 0600-INITIALIZE.
   953
   954     MOVE SPACES                 TO ELTRLR-DETAIL-RECORD
   955
   956     MOVE ';'                    TO EX-TAB1
   957                                    EX-TAB2
   958                                    EX-TAB3
   959                                    EX-TAB4
   960                                    EX-TAB5
   961                                    EX-TAB6
   962                                    EX-TAB7
   963                                    EX-TAB8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMATX1.cbl
   964                                    EX-TAB9
   965     MOVE 'E'                    TO EX-EOR
   966
   967     MOVE ELTRLR-DETAIL-RECORD   TO WS-SAVE-ELTRLR
   968     PERFORM 0550-START-ELTRLR   THRU 0550-EXIT
   969     PERFORM 0200-READ-ELTRLR    THRU 0200-EXIT
   970
   971     .
   972 0600-EXIT.
   973     EXIT.
   974
   975 8510-DATE-CONVERSION.
   976
   977     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
   978
   979     .
   980 8590-EXIT.
   981     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2508     Code:        1107
