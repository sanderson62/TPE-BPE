* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS158.cbl
* Options: int("ECS158.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS158.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS158.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS158.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS158.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/16/94 16:45:02.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.041.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED. 10/13/86.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS158.cbl
    14
    15*SECURITY.   ***************************************************
    16*            *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.
    18*            *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.
    22*            *
    23*            ***************************************************
    24
    25*REMARKS.
    26*        PROGRAM PULLS AN EXTRACT ON THE CLAS SYSTEM CERT FILE
    27*        AND THE EXTRACTS FROM ECS157 IN ORDER TO PROCESS
    28*        EXTRACTS FOR INSURANCE COMMISSION CALL.
    29*
    30*        RUN DATE IN DATE CARD IS CONSIDERED TO BE CALL-DATE.
    31*
    32*        BEGINNING OF 'CALL' PERIOD IS RUN DATE OR 12 MOS PRIOR
    33*        TO EP-DT
    34*
    35*
    36****************************************************************
    37*
    38*    RR   =  NUMBER OF MONTHS CERT WAS INFORCE DURING PERIOD
    39*                (USED TO CALCULATE MEAN INFORCE)
    40*
    41*    M1   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION, DEATH
    42*            CANCELLATION FROM START OF PERIOD OR ISSUE DATE
    43*            WHICHEVER WAS LATER.
    44*                (USED TO CALCULATE MEAN INFORCE)
    45*
    46*    M2   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION AT END
    47*            OF PERIOD IF INFORCE AT END OF PERIOD.
    48*                (USED TO CALCULATE UNEARNED PREMIUM AT END)
    49*
    50*    M3   =  NUMBER OF MONTHS REMAINING UNTIL EXPIRATION AT STAR
    51*            OF PERIOD.
    52*                (USED TO CALCULATE UNEARNED PREMIUM AT START)
    53*
    54*    M5   =  NUMBER OF FULL MONTHS REMAINING UNTIL EXPIRATION
    55*          AT END  OF PERIOD IF INFORCE AT END OF PERIOD.
    56*                (USED TO CALCULATE UNEARNED PREMIUM AT END)
    57*
    58*    M6   =  NUMBER OF FULL MONTHS REMAINING UNTIL EXPIRATION
    59*        AT START  OF PERIOD.
    60*                (USED TO CALCULATE UNEARNED PREMIUM AT START)
    61*
    62****************************************************************
    63******************************************************************
    64*                   C H A N G E   L O G
    65*
    66* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    67*-----------------------------------------------------------------
    68*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    69* EFFECTIVE    NUMBER
    70*-----------------------------------------------------------------
    71* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS158.cbl
    72* 120803                   PEMA  REMOVE SUPPLEMENTAL IBNR CALC
    73* 032609  CR2008030600001  PEMA  CHANGE TX AND VA TO ROA
    74* 120710  CR2010101500002  PEMA  MN ROA AND MEAN
    75* 062712    2012062600003  PEMA  ADD PROCESSING FOR AHL
    76* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    77******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS158.cbl
    79 ENVIRONMENT DIVISION.
    80 INPUT-OUTPUT SECTION.
    81 FILE-CONTROL.
    82
    83     SELECT CERTS        ASSIGN TO SYS010-UT-2400-S-SYS010.
    84     SELECT XTRS-IN      ASSIGN TO SYS012-UT-2400-S-SYS012.
    85     SELECT ERACCTT      ASSIGN TO SYS015-UT-FBA1-ERACCTT
    86                         ACCESS IS SEQUENTIAL
    87                         ORGANIZATION IS INDEXED
    88                         FILE STATUS IS ERACCTT-FILE-STATUS
    89                         RECORD KEY IS AM-CONTROL-PRIMARY.
    90     SELECT XTRACT       ASSIGN TO SYS011-UT-2400-S-SYS011.
    91     SELECT CLMS-HIST    ASSIGN TO SYS013-UT-2400-S-SYS013.
    92     SELECT SORTED-CLAIMS ASSIGN TO SYS016-UT-FBA1-S-SYS016.
    93     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    94     SELECT PRINTX       ASSIGN TO SYS008-UR-1403-S-SYS008.
    95     SELECT PRINTC       ASSIGN TO SYS009-UR-1403-S-SYS009.
    96     SELECT SORT-CLMS    ASSIGN TO SYS001-UT-FBA1-S-SORTWK1.
    97     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.
    98     SELECT ERRTBL-IN    ASSIGN TO SYS014-ERRTBLT
    99                         ACCESS IS DYNAMIC
   100                         ORGANIZATION IS INDEXED
   101                         FILE STATUS IS ERRTBL-FILE-STATUS
   102                         RECORD KEY IS RE-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS158.cbl
   104 DATA DIVISION.
   105 FILE SECTION.
   106
   107 FD  CLMS-HIST
*  108                            COPY ECSEXTFD.
   109******************************************************************07/10/97
   110*                                                                *ECSEXTFD
   111*                            ECSEXTFD                            *   LV001
   112*                            VMOD=2.001                          *ECSEXTFD
   113*                                                                *ECSEXTFD
   114*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
   115*                                                                *ECSEXTFD
   116******************************************************************ECSEXTFD
   117     RECORDING MODE F                                             ECSEXTFD
   118     LABEL RECORDS STANDARD                                       ECSEXTFD
   119     BLOCK CONTAINS 0 RECORDS
   120     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
   121******************************************************************ECSEXTFD
   122
   123 01  IN-CLMS                 PIC X(510).
   124
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS158.cbl
   126 FD  ERRTBL-IN.
*  127                                 COPY ERCREIN.
   128******************************************************************07/27/93
   129*                                                                *ERCREIN
   130*                            ERCREIN                             *   LV009
   131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   132*                            VMOD=2.010                          *   CL**9
   133*                                                                *ERCREIN
   134*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   135*                                                                *ERCREIN
   136*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   137*                                                                *ERCREIN
   138*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   139*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   140*                                                                *ERCREIN
   141*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   142*       ALTERNATE PATH = NONE                                    *ERCREIN
   143*                                                                *ERCREIN
   144*   LOG = NO                                                     *ERCREIN
   145*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   146*                                                                *ERCREIN
   147******************************************************************ERCREIN
   148*                   C H A N G E   L O G
   149*
   150* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   151*-----------------------------------------------------------------
   152*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   153* EFFECTIVE    NUMBER
   154*-----------------------------------------------------------------
   155* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   156* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   157******************************************************************
   158 01  REINSURANCE-RECORD.                                          ERCREIN
   159     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   160         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   161                                                                  ERCREIN
   162     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   163         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   164         16  RE-KEY.                                              ERCREIN
   165             20  RE-CODE                   PIC X.                 ERCREIN
   166                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   167                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   168             20  RE-TABLE                  PIC XXX.               ERCREIN
   169             20  FILLER                    PIC XXX.               ERCREIN
   170         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   171             20  FILLER                    PIC X.                 ERCREIN
   172             20  RE-COMPANY.                                      ERCREIN
   173                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   174                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   175                                                                  ERCREIN
   176     12  RE-MAINT-INFORMATION.                                    ERCREIN
   177         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   178         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   179         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   180         16  FILLER                        PIC X(10).             ERCREIN
   181                                                                  ERCREIN
   182     12  RE-TABLE-DATA.                                           ERCREIN
   183         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   184                                                                  ERCREIN
   185         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   186             20  RE-REI-COMP-NO.                                  ERCREIN
   187                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   188                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   189             20  RE-LF-QC                  PIC X.                 ERCREIN
   190             20  RE-AH-QC                  PIC X.                 ERCREIN
   191             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   192             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   193             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   194             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   195             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   196             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   197             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   198             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   199             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   200             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   201             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   202             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   203             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   204             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   205             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   206             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   207             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   208             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   209             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   210             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   211             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   212             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   213             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   214             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   215             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   216             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   217             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   218             20  RE-REMAINING              PIC X.                 ERCREIN
   219             20  RE-LF-RUNOFF-SW           PIC X.                      000
   220             20  RE-AH-RUNOFF-SW           PIC X.                      000
   221             20  FILLER                    PIC X(19).                  000
   222                                                                  ERCREIN
   223         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   224         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   225         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   226         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   227             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   228                                                                  ERCREIN
   229         16  FILLER                        PIC X(27).             ERCREIN
   230                                                                  ERCREIN
   231     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   232         16  RE-NAME                       PIC X(30).             ERCREIN
   233         16  RE-LF-PE                      PIC X.                 ERCREIN
   234         16  RE-AH-PE                      PIC X.                 ERCREIN
   235         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   236         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   237         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   238         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   239         16  RE-PRT-ST                     PIC X.                 ERCREIN
   240         16  RE-PRT-OW                     PIC X.                 ERCREIN
   241         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   242         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   243         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   244         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   245         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   246         16  RE-LF-COMM                    PIC X.                 ERCREIN
   247         16  RE-AH-COMM                    PIC X.                 ERCREIN
   248         16  RE-LF-TAX                     PIC X.                 ERCREIN
   249         16  RE-AH-TAX                     PIC X.                 ERCREIN
   250         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   251         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   252         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   253                                                                  ERCREIN
   254         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   255             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   256                                                                  ERCREIN
   257         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   258             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   259                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   260                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   261                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   262                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   263             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   264                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   265                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   266                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   267                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   268                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   269                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   270                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   271                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   272             20  FILLER                    PIC XXX.               ERCREIN
   273             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   274                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   275                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   276                                                                  ERCREIN
   277         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   278             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   279                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   280                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   281                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   282                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   283             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   284                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   285                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   286                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   287                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   288                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   289                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   290                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   291                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   292             20  FILLER                    PIC XXX.               ERCREIN
   293             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   294                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   295                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   296                                                                  ERCREIN
   297         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   298                                                                  ERCREIN
   299         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS158.cbl (/apps/prod/cid1p/copy/ERCREIN)
   300                                                                  ERCREIN
   301         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   302         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   303         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   304         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   305         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   306         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   307         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   308         16  RE-MORT-SW                    PIC X.                 ERCREIN
   309         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   310             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   311             88  RE-CEDED                          VALUE 'C'.        CL**2
   312             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   313             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   314                                                                  ERCREIN
   315         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   316             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   317         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   318             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   319         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   320             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   321         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   322             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   323         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   324             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   325                                                                     CL**3
   326         16  RE-PRT-CRSV                   PIC X.                    CL**5
   327                                                                     CL**5
   328         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   329                                                                     CL**8
   330         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   331                                                                     CL**8
   332         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   333                                                                     CL**9
   334         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   335             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   336             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   337
   338         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   339             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   340                                                                     CL**9
   341         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   342         16  FILLER                        PIC X(2281).              CL**9
   343                                                                  ERCREIN
   344         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   345                                                                  ERCREIN
   346******************************************************************ERCREIN
   347
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS158.cbl
   349 FD  CERTS
*  350                                 COPY ECSCRIFD.
   351******************************************************************07/10/97
   352*                                                                *ECSCRIFD
   353*                            ECSCRIFD                            *   LV001
   354*                            VMOD 2.005                          *ECSCRIFD
   355*                                                                *ECSCRIFD
   356*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   357*                                                                *ECSCRIFD
   358******************************************************************ECSCRIFD
   359     BLOCK CONTAINS 0 RECORDS
   360     RECORDING MODE F.                                            ECSCRIFD
   361                                                                  ECSCRIFD
   362 01  CERT-IN-RECORD.                                              ECSCRIFD
   363                                                                  ECSCRIFD
   364     12  FILLER                            PIC XXX.               ECSCRIFD
   365     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   366     12  FILLER                            PIC X(66).             ECSCRIFD
   367     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   368     12  FILLER                            PIC X(20).             ECSCRIFD
   369     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   370     12  FILLER                            PIC X(14).             ECSCRIFD
   371     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   372     12  FILLER                            PIC X(39).             ECSCRIFD
   373     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   374     12  FILLER                            PIC X(45).             ECSCRIFD
   375     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   376     12  FILLER                            PIC X(35).             ECSCRIFD
   377     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   378     12  FILLER                            PIC X(41).             ECSCRIFD
   379     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   380     12  FILLER                            PIC X(48).             ECSCRIFD
   381     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   382     12  FILLER                            PIC X(9).              ECSCRIFD
   383     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   384     12  FILLER                            PIC X(120).            ECSCRIFD
   385     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   386     12  FILLER                            PIC X(73).             ECSCRIFD
   387     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   388     12  FILLER                            PIC X(464).            ECSCRIFD
   389                                                                  ECSCRIFD
   390******************************************************************ECSCRIFD
*  391                                 COPY ECSCRT01.
   392******************************************************************
   393*                                                                *
   394*                            ECSCRT01                            *
   395*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   396*                            VMOD=2.016                          *
   397*                                                                *
   398*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   399*                                                                *
   400*   FILE TYPE = SEQUENTIAL
   401*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   402*                                                                *
   403*   KEY DATA =                         START=4, LEN=36           *
   404*                                                                *
   405*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   406*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   407******************************************************************
   408******************************************************************
   409*                   C H A N G E   L O G
   410*
   411* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   412*-----------------------------------------------------------------
   413*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   414* EFFECTIVE    NUMBER
   415*-----------------------------------------------------------------
   416* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   417* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   418* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   419* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   420* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   421* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   422* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   423* 032612  CR2011110200001  PEMA  AHL CHANGES
   424* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   425* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   426******************************************************************
   427
   428 01  CERTIFICATE-RECORD.
   429     12  CR-RECORD-ID                      PIC XX.
   430         88  VALID-CR-ID                      VALUE 'CR'.
   431
   432     12  CR-COMPANY-CD                     PIC X.
   433
   434     12  CR-FULL-CONTROL.
   435         16  CR-CONTROL-1.
   436             20  CR-ACCT-CONTROL.
   437                 24  CR-CARRIER            PIC X.
   438                 24  CR-GROUPING.
   439                     28  CR-GROUP-PREFIX   PIC XXX.
   440                     28  CR-GROUP-PRIME    PIC XXX.
   441                 24  CR-STATE              PIC XX.
   442                 24  CR-ACCOUNT.
   443                     28  CR-ACCT-PREFIX    PIC X(4).
   444                     28  CR-ACCT-PRIME     PIC X(6).
   445             20  CR-DT                     PIC 9(11)  COMP-3.
   446         16  CR-CERT-NO.
   447             20  CR-CERT.
   448                 24  CR-CERT-PREFIX        PIC X(3).
   449                 24  CR-CERT-PRIME         PIC X(7).
   450             20  CR-CERT-SFX               PIC X.
   451
   452     12  CR-INSUREDS-PROFILE.
   453         16  CR-NAME.
   454             20  CR-LNAME                  PIC X(15).
   455             20  CR-FNAME.
   456                 24  CR-1ST-INITIAL        PIC X.
   457                 24  FILLER                PIC X(9).
   458             20  CR-INIT                   PIC X.
   459         16  CR-AGE                        PIC 99.
   460         16  CR-SEX                        PIC X.
   461             88  CR-SEX-MALE                  VALUE 'M'.
   462             88  CR-SEX-FEMALE                VALUE 'F'.
   463         16  CR-SOC-SEC                    PIC X(11).
   464         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   465             20  CR-JT-LNAME               PIC X(15).
   466             20  CR-JT-FNAME.
   467                 24  CR-JT-1ST-INIT        PIC X.
   468                 24  FILLER                PIC X(9).
   469             20  CR-JT-INIT                PIC X.
   470         16  CR-JOINT-AGE                  PIC 99.
   471
   472         16  cr-ahl-ah-claim-no            pic x(9).
   473         16  cr-ahl-ah-cert-seq            pic x(3).
   474         16  cr-hst-proc-lf                pic x.
   475         16  f                             pic x(7).
   476
   477     12  CR-LF-COVERAGE-DATA.
   478         16  CR-LFTYP                      PIC XX.
   479         16  CR-LF-TERM                    PIC S999       COMP-3.
   480         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   481         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   482         16  CR-LF-DEV-CODE                PIC XXX.
   483         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   484
   485         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   486         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   487         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   488         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   489
   490         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   491         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   492         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   493         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   494
   495         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   496         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   497
   498         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   499         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   500
   501         16  CR-LF-REFUND-TYPE             PIC X.
   502         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   503
   504         16  CR-LF-COMM-CHARGEBACK         PIC X.
   505             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   506
   507         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   508
   509         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   510         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   511         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   512
   513         16  cr-ahl-lf-claim-no            pic x(9).
   514         16  cr-ahl-lf-cert-seq            pic x(3).
   515         16  FILLER                        PIC XX.
   516
   517     12  CR-AH-COVERAGE-DATA.
   518         16  CR-AHTYP                      PIC XX.
   519         16  CR-AH-TERM                    PIC S999       COMP-3.
   520         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   521         16  CR-AH-DEV-CODE                PIC XXX.
   522         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   523
   524         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   525         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   526         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   527         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   528
   529         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   530         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   531
   532         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   533         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   534
   535         16  CR-AH-REFUND-TYPE             PIC X.
   536         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   537
   538         16  CR-AH-COMM-CHARGEBACK         PIC X.
   539             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   540
   541         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   542
   543         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   544         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   545         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   546
   547         16  FILLER                        PIC XX.
   548*        16  FILLER                        PIC X(8).
   549
   550     12  CR-LOAN-DATA.
   551         16  CR-LIVES                      PIC S9(7)      COMP-3.
   552         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   553                                           PIC S9(5)V99   COMP-3.
   554         16  CR-BILLED                     PIC S9(7)      COMP-3.
   555         16  CR-APR                        PIC S999V9(4)  COMP-3.
   556         16  CR-PMT-FREQ                   PIC 99.
   557         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   558         16  CR-RATING-CLASS               PIC XX.
   559         16  CR-POLICY-FORM-NO             PIC X(12).
   560         16  CR-GRPTYP                     PIC XX.
   561         16  CR-IND-GRP                    PIC X.
   562             88  CR-INDIVIDUAL                VALUE '1'.
   563             88  CR-GROUP                     VALUE '2'.
   564         16  CR-SKIP                       PIC 99.
   565             88  NO-MONTHS-SKIPPED            VALUE 00.
   566             88  SKIP-JULY                    VALUE 01.
   567             88  SKIP-AUGUST                  VALUE 02.
   568             88  SKIP-SEPTEMBER               VALUE 03.
   569             88  SKIP-JULY-AUG                VALUE 04.
   570             88  SKIP-AUG-SEPT                VALUE 05.
   571             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   572             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   573             88  SKIP-JUNE                    VALUE 08.
   574             88  SKIP-JUNE-JULY               VALUE 09.
   575             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   576             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   577         16  CR-RESIDENT-STATE             PIC XX.
   578         16  CR-RATE-CODE.
   579             20  CR-LF-CLASS-CD            PIC XX.
   580             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   581         16  CR-MORT.
   582             20  CR-TAB                    PIC X.
   583             20  CR-INT                    PIC 99.
   584             20  CR-GRP                    PIC X.
   585         16  CR-MEMBER-NO                  PIC X(12).
   586         16  CR-OLD-LOF                    PIC XXX.
   587*        16  CR-LOAN-OFFICER               PIC XXX.
   588         16  CR-REIN-TABLE                 PIC XXX.
   589         16  CR-REIN-SPEC                  PIC X.
   590         16  CR-LOAN-1ST-PMT-DT.
   591             20  CR-1ST-PMT-YR             PIC 99.
   592             20  CR-1ST-PMT-MO             PIC 99.
   593             20  CR-1ST-PMT-DA             PIC 99.
   594         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   595         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   596         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   597         16  CR-LAST-ADD-ON-DT             PIC XX.
   598
   599         16  CR-UNDERWRITING-CODE          PIC X.
   600             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   601
   602         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   603         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   604         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   605         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   606
   607     12  CR-STATUS-INFORMATION.
   608         16  CR-ENTRY-STATUS               PIC X.
   609             88  CR-NORMAL-ENTRY              VALUE '1'.
   610             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   611             88  CR-CONVERSION-ENTRY          VALUE '4'.
   612             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   613             88  CR-POLICY-IS-CASH            VALUE 'C'.
   614             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   615             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   616             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   617             88  CR-POLICY-IS-VOID            VALUE 'V'.
   618             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   619             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   620                                                'C' '5' '9' 'P'.
   621         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   622
   623         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   624         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   625         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   626
   627         16  CR-LF-STATUS-AT-DEATH         PIC X.
   628         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   629
   630         16  CR-LF-CURRENT-STATUS          PIC X.
   631             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   632             88  CR-LF-POLICY-PENDING         VALUE '2'.
   633             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   634             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   635             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   636             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   637             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   638             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   639             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   640             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   641             88  CR-LF-IS-DECLINED            VALUE 'D'.
   642             88  CR-LF-IS-VOID                VALUE 'V'.
   643             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   644                                                    '4' '5' '9'.
   645
   646         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   647
   648         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   649         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   650
   651         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   652         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   653
   654         16  CR-AH-CURRENT-STATUS          PIC X.
   655             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   656             88  CR-AH-POLICY-PENDING         VALUE '2'.
   657             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   658             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   659             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   660             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   661             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   662             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   663             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   664             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   665             88  CR-AH-IS-DECLINED            VALUE 'D'.
   666             88  CR-AH-IS-VOID                VALUE 'V'.
   667             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   668                                                    '4' '5' '9'.
   669         16  CR-LOAN-OFFICER               PIC X(5).
   670         16  CR-CANCEL-REASON              PIC X.
   671         16  cr-xycor-lf-cov-code          pic x(4).
   672         16  cr-xycor-ah-cov-code          pic x(4).
   673         16  cr-temp-epiq                  pic x(4).
   674         16  FILLER                        PIC XX.
   675
   676     12  CR-DEATH-CLAIM-DATA.
   677         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   678
   679         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   680         16  CR-DTH-RPT-DT.
   681             20  CR-DTH-RPT-YR             PIC 99.
   682             20  CR-DTH-RPT-MO             PIC 99.
   683             20  CR-DTH-RPT-DA             PIC 99.
   684         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   685
   686         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   687         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   688         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   689         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   690         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   691
   692         16  CR-DTH-AGE                    PIC 99.
   693         16  CR-DTH-PAY-CD                 PIC X.
   694         16  CR-DEATH-CAUSE                PIC X(6).
   695
   696         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   697
   698     12  CR-DISAB-CLAIM-DATA.
   699         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   700
   701         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   702         16  CR-DIS-RPT-DT.
   703             20  CR-DIS-RPT-YR             PIC 99.
   704             20  CR-DIS-RPT-MO             PIC 99.
   705             20  CR-DIS-RPT-DA             PIC 99.
   706         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   707         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   708
   709         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   710         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   711         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   712         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   713         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   714
   715         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   716         16  CR-DIS-PAY-CD                 PIC X.
   717         16  FILLER                        PIC XX.
   718
   719         16  CR-DISAB-INCURRED-DETAIL.
   720             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   721**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   722                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   723                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   724                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   725
   726         16  CR-DISAB-CAUSE                PIC X(6).
   727         16  FILLER                        PIC X(14).
   728
   729     12  CR-REMIT-TO                       PIC 99.
   730
   731     12  CR-COMPENSATION-LEVELS.
   732         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   733             20  CR-COM-AGT.
   734                 24  CR-COM-AGT-PREFIX     PIC X(4).
   735                 24  CR-COM-AGT-PRIME      PIC X(6).
   736             20  CR-AGT-TYPE               PIC X.
   737             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   738             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   739
   740     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   741     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   742     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   743     12  CR-CLP-STATE                      PIC XX.
   744     12  CR-POST-CARD-IND                  PIC X.
   745     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   746     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   747     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   748     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   749     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   750     12  FILLER                            PIC X(07).
   751
   752     12  CR-CSR-CODE                       PIC XXX.
   753
   754     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS158.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   755     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   756
   757     12  CR-MICROFILM-NUMBERS.
   758*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   759         16  FILLER                        PIC X(5).
   760     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   761
   762     12  CR-USER-CODE                      PIC X.
   763     12  CR-USER-FUTURE                    PIC X(9).
   764
   765     12  CR-BENEFICIARY.
   766         16  CR-BANK-NO                    PIC X(10).
   767         16  FILLER                        PIC X(15).
   768
   769     12  CR-ENTRY-BATCH                    PIC X(6).
   770     12  CR-LF-EXIT-BATCH                  PIC X(6).
   771     12  CR-AH-EXIT-BATCH                  PIC X(6).
   772
   773     12  CR-NOTE-SW                        PIC X.
   774
   775     12  CR-ORIGIN-INDICATOR               PIC X.
   776         88  CR-ENTERED-MANUALLY              VALUE '1'.
   777         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   778
   779     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   780     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   781     12  FILLER                            PIC X(33).
   782
   783******************************************************************
   784
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS158.cbl
   786 FD  ERACCTT.
*  787                                 COPY ERCACCT.
   788******************************************************************04/19/98
   789*                                                                *ERCACCT
   790*                                                                *ERCACCT
   791*                            ERCACCT                             *   LV031
   792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   793*                            VMOD=2.031                          *ERCACCT
   794*                                                                *ERCACCT
   795*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   796*                                                                *ERCACCT
   797*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   798*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   799*                                                                *ERCACCT
   800*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   801*                                                                *ERCACCT
   802*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   803*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   804*                                                                *ERCACCT
   805*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   806*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   807*                                                                *ERCACCT
   808*   LOG = NO                                                     *ERCACCT
   809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   810*                                                                *ERCACCT
   811*                                                                *ERCACCT
   812******************************************************************ERCACCT
   813*                   C H A N G E   L O G
   814*
   815* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   816*-----------------------------------------------------------------
   817*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   818* EFFECTIVE    NUMBER
   819*-----------------------------------------------------------------
   820* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   821* 092705    2005050300006  PEMA  ADD SPP LEASES
   822* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   823* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   824* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   825* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   826* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   827******************************************************************
   828                                                                  ERCACCT
   829 01  ACCOUNT-MASTER.                                              ERCACCT
   830     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   831         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   832                                                                  ERCACCT
   833     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   834         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   835         16  AM-MSTR-CNTRL.                                       ERCACCT
   836             20  AM-CONTROL-A.                                    ERCACCT
   837                 24  AM-CARRIER            PIC X.                 ERCACCT
   838                 24  AM-GROUPING.                                 ERCACCT
   839                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   840                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   841                 24  AM-STATE              PIC XX.                ERCACCT
   842                 24  AM-ACCOUNT.                                  ERCACCT
   843                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   844                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   845             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   846                                           PIC X(19).             ERCACCT
   847             20  AM-CNTRL-B.                                      ERCACCT
   848                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   849                 24  FILLER                PIC X(4).              ERCACCT
   850             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   851                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   852                                                                  ERCACCT
   853     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   854         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   855         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   856         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   857         16  AM-VG-STATE                   PIC XX.                ERCACCT
   858         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   859         16  AM-VG-DATE.                                          ERCACCT
   860             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   861             20  FILLER                    PIC X(4).              ERCACCT
   862         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   863                                           PIC 9(11)      COMP-3. ERCACCT
   864     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   865         16  FILLER                        PIC X(10).
   866         16  AM-VG-KEY3.
   867             20  AM-VG3-ACCOUNT            PIC X(10).
   868             20  AM-VG3-EXP-DT             PIC XX.
   869         16  FILLER                        PIC X(4).
   870     12  AM-MAINT-INFORMATION.                                    ERCACCT
   871         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   872         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   873         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   874         16  FILLER                        PIC XX.                ERCACCT
   875                                                                  ERCACCT
   876     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   877     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   878                                                                  ERCACCT
   879     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   880         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   881         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   882                                                                  ERCACCT
   883     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   884     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   885                                                                  ERCACCT
   886     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   887     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   888                                                                  ERCACCT
   889     12  AM-NAME                           PIC X(30).             ERCACCT
   890     12  AM-PERSON                         PIC X(30).             ERCACCT
   891     12  AM-ADDRS                          PIC X(30).             ERCACCT
   892     12  AM-CITY.
   893         16  AM-ADDR-CITY                  PIC X(28).
   894         16  AM-ADDR-STATE                 PIC XX.
   895     12  AM-ZIP.                                                  ERCACCT
   896         16  AM-ZIP-PRIME.                                        ERCACCT
   897             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   898                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   899             20  FILLER                    PIC X(4).              ERCACCT
   900         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   901     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   902         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   903         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   904         16  FILLER                        PIC XXX.               ERCACCT
   905     12  AM-TEL-NO.                                               ERCACCT
   906         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   907         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   908         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   909     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   910         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   911         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   912                                                                  ERCACCT
   913     12  AM-COMM-STRUCTURE.                                       ERCACCT
   914         16  AM-DEFN-1.                                           ERCACCT
   915             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   916                 24  AM-AGT.                                      ERCACCT
   917                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   918                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   919                 24  AM-COM-TYP            PIC X.                 ERCACCT
   920                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   921                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   922                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   923                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   924                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   925                 24  AM-GL-CODES           PIC X.                 ERCACCT
   926                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   927                 24  FILLER                PIC X(01).             ERCACCT
   928         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   929             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   930                 24  FILLER                PIC X(11).             ERCACCT
   931                 24  AM-L-COMA             PIC XXX.               ERCACCT
   932                 24  AM-J-COMA             PIC XXX.               ERCACCT
   933                 24  AM-A-COMA             PIC XXX.               ERCACCT
   934                 24  FILLER                PIC X(6).              ERCACCT
   935                                                                  ERCACCT
   936     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   937         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   938                                                                  ERCACCT
   939     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   940                                                                  ERCACCT
   941     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   942         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   943         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   944     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   945         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   946         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   947     12  AM-GPCD                           PIC 99.                ERCACCT
   948     12  AM-IG                             PIC X.                 ERCACCT
   949         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   950         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   951     12  AM-STATUS                         PIC X.                 ERCACCT
   952         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   953         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   954         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   955         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   956         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   957         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   958     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   959     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
   960                                                                  ERCACCT
   961     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   962     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   963     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   964     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   965     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   966     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   967     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   968     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   969     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   970                                                                  ERCACCT
   971     12  AM-USER-FIELDS.                                          ERCACCT
   972         16  AM-FLD-1                      PIC XX.                ERCACCT
   973         16  AM-FLD-2                      PIC XX.                ERCACCT
   974         16  AM-FLD-3                      PIC XX.                ERCACCT
   975         16  AM-FLD-4                      PIC XX.                ERCACCT
   976         16  AM-FLD-5                      PIC XX.                ERCACCT
   977                                                                  ERCACCT
   978     12  AM-1ST-PROD-DATE.                                        ERCACCT
   979         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   980         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   981         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   982     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   983     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   984         16  AM-PUR-YR                     PIC XX.                ERCACCT
   985         16  AM-PUR-MO                     PIC XX.                ERCACCT
   986         16  AM-PUR-DA                     PIC XX.                ERCACCT
   987     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   988     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   989     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   990     12  AM-INACTIVE-DATE.                                        ERCACCT
   991         16  AM-INA-MO                     PIC 99.                ERCACCT
   992         16  AM-INA-DA                     PIC 99.                ERCACCT
   993         16  AM-INA-YR                     PIC 99.                ERCACCT
   994     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   995                                                                  ERCACCT
   996     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   997     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   998                                                                  ERCACCT
   999     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
  1000         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
  1001         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
  1002         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
  1003         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
  1004                                                                  ERCACCT
  1005     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
  1006         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
  1007         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
  1008                                                                  ERCACCT
  1009     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
  1010                                                                  ERCACCT
  1011     12  AM-OVER-SHORT.                                           ERCACCT
  1012         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
  1013         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
  1014                                                                  ERCACCT
  1015     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1016     12  AM-DCC-CLP-STATE                  PIC XX.
  1017                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1018     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
  1019     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
  1020                                                                  ERCACCT
  1021     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
  1022     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
  1023     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
  1024     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
  1025     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
  1026     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
  1027     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
  1028     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
  1029     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1030     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
  1031     12  AM-REI-MORT                       PIC X(4).              ERCACCT
  1032     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
  1033     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1034     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
  1035     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
  1036     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
  1037                                                                  ERCACCT
  1038     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
  1039                                                                  ERCACCT
  1040     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
  1041     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
  1042                                                                  ERCACCT
  1043     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
  1044     12  AM-EARN-METHODS.                                         ERCACCT
  1045         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
  1046             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
  1047             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
  1048             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
  1049             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1050         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
  1051             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
  1052             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
  1053             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
  1054             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
  1055         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
  1056             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
  1057             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
  1058             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
  1059             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
  1060             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
  1061             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
  1062                                                                  ERCACCT
  1063     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
  1064     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
  1065     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
  1066                                                                  ERCACCT
  1067     12  AM-RET-Y-N                        PIC X.                 ERCACCT
  1068     12  AM-RET-P-E                        PIC X.                 ERCACCT
  1069     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
  1070     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
  1071     12  AM-RET-GRP                        PIC X(6).              ERCACCT
  1072     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
  1073         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
  1074         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
  1075     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1076         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
  1077         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
  1078         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
  1079     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
  1080         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
  1081         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
  1082     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
  1083         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
  1084         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
  1085         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
  1086     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
  1087     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
  1088                                                                  ERCACCT
  1089     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
  1090         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
  1091         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
  1092         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
  1093         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
  1094         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
  1095                                                                  ERCACCT
  1096     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1097                                                                  ERCACCT
  1098     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
  1099                                                                  ERCACCT
  1100     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
  1101         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
  1102                                                                  ERCACCT
  1103     12  AM-INSURANCE-LIMITS.                                     ERCACCT
  1104         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
  1105         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
  1106                                                                  ERCACCT
  1107     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
  1108         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
  1109                                                                  ERCACCT
  1110     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
  1111         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
  1112         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
  1113                                                                  ERCACCT
  1114     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
  1115                                                                  ERCACCT
  1116     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
  1117     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1118     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1119     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1120     12  AM-DCC-UEF-STATE                  PIC XX.
  1121     12  FILLER                            PIC XXX.
  1122     12  AM-REPORT-CODE-3                  PIC X(10).
  1123*    12  FILLER                            PIC X(22).             ERCACCT
  1124                                                                  ERCACCT
  1125     12  AM-RESERVE-DATE.                                         ERCACCT
  1126         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
  1127         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
  1128         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
  1129                                                                  ERCACCT
  1130     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
  1131     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
  1132         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
  1133         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1134         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
  1135         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
  1136                                                                  ERCACCT
  1137     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
  1138         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
  1139         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
  1140         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
  1141         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
  1142                                                                  ERCACCT
  1143     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
  1144         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
  1145             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
  1146             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
  1147             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
  1148             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
  1149             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
  1150             20  FILLER                    PIC XX.                ERCACCT
  1151         16  FILLER                        PIC X(80).             ERCACCT
  1152                                                                  ERCACCT
  1153     12  AM-TRANSFER-DATA.                                        ERCACCT
  1154         16  AM-TRANSFERRED-FROM.                                 ERCACCT
  1155             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
  1156             20  AM-TRNFROM-GROUPING.                             ERCACCT
  1157                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
  1158                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
  1159             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
  1160             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
  1161                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
  1162                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
  1163             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
  1164         16  AM-TRANSFERRED-TO.                                   ERCACCT
  1165             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
  1166             20  AM-TRNTO-GROUPING.                               ERCACCT
  1167                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
  1168                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
  1169             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
  1170             20  AM-TRNTO-ACCOUNT.                                ERCACCT
  1171                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
  1172                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
  1173             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
  1174         16  FILLER                        PIC X(10).             ERCACCT
  1175                                                                  ERCACCT
  1176     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
  1177                                                                  ERCACCT
  1178     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
  1179         16  AM-DEFN-1-SAVED.                                     ERCACCT
  1180             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
  1181                 24  AM-AGT-SV             PIC X(10).             ERCACCT
  1182                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
  1183                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1184                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1185                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
  1186                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
  1187                 24  FILLER                PIC X.                 ERCACCT
  1188                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
  1189                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
  1190                 24  FILLER                PIC X.                 ERCACCT
  1191         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1192             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
  1193                 24  FILLER                PIC X(11).             ERCACCT
  1194                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
  1195                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
  1196                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
  1197                 24  FILLER                PIC X(6).              ERCACCT
  1198                                                                  ERCACCT
  1199     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
  1200         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
  1201            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
  1202            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
  1203            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
  1204                                                                  ERCACCT
  1205     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
  1206     12  FILLER                            PIC X(120).            ERCACCT
  1207                                                                  ERCACCT
  1208     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
  1209         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
  1210         16  AM-EXECUTIVE-ONE.                                    ERCACCT
  1211             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
  1212             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1213                                                          COMP-3. ERCACCT
  1214             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1215                                                          COMP-3. ERCACCT
  1216         16  AM-EXECUTIVE-TWO.                                    ERCACCT
  1217             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
  1218             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
  1219                                                          COMP-3. ERCACCT
  1220             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
  1221                                                          COMP-3. ERCACCT
  1222                                                                  ERCACCT
  1223     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
  1224         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
  1225         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
  1226         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
  1227         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
  1228             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
  1229                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
  1230                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
  1231             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
  1232                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
  1233                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
  1234             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
  1235                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
  1236                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
  1237         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
  1238             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
  1239                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
  1240                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
  1241                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
  1242             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
  1243                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
  1244                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
  1245             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
  1246                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
  1247                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
  1248                                                                  ERCACCT
  1249     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS158.cbl (/apps/prod/cid1p/copy/ERCACCT)
  1250         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
  1251                                                                  ERCACCT
  1252     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
  1253         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
  1254         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
  1255         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
  1256         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
  1257         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
  1258             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
  1259             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
  1260             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
  1261             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
  1262         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
  1263             20  AM-FLI-AGT                PIC X(9).              ERCACCT
  1264             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
  1265             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
  1266         16  FILLER                        PIC X(102).            ERCACCT
  1267                                                                  ERCACCT
  1268     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
  1269         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
  1270             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
  1271             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
  1272             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
  1273             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
  1274             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
  1275         16  FILLER                          PIC X(10).           ERCACCT
  1276******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS158.cbl
  1278 SD  SORT-CLMS.
  1279
  1280 01  SORT-CLMS-REC.
  1281     12  SORT-CLAIM-KEY.
  1282         16  S-CARRIER       PIC X(01).
  1283         16  S-GROUPING      PIC X(06).
  1284         16  S-STATE         PIC X(02).
  1285         16  S-ACCOUNT       PIC X(10).
  1286         16  S-EFF-DATE      PIC X(06).
  1287         16  S-CERT-NO       PIC X(11).
  1288     12  SORT-EP-EXTR        PIC X(510).
  1289
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS158.cbl
  1291 FD  SORTED-CLAIMS
  1292     BLOCK CONTAINS 0 RECORDS
  1293     RECORDING MODE IS F.
  1294
  1295 01  SORTED-CLAIMS-REC.
  1296     12  FILLER              PIC X(36).
  1297     12  SORTED-EXTRACT      PIC X(510).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS158.cbl
  1299 FD  XTRACT
  1300     BLOCK CONTAINS 0 RECORDS
  1301     RECORDING MODE IS F.
  1302
  1303
  1304 01  CALL-X                      PIC X(666).
  1305
  1306 FD  XTRS-IN
  1307     BLOCK CONTAINS 0 RECORDS
  1308     RECORDING MODE IS F.
  1309
  1310 01  XTR-RECORD                  PIC X(666).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS158.cbl
  1312 FD  DISK-DATE
* 1313                                 COPY ELCDTEFD.
  1314******************************************************************04/15/98
  1315*                                                                *ELCDTEFD
  1316*                                                                *ELCDTEFD
  1317*                            ELCDTEFD.                           *   LV002
  1318*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1319*                            VMOD=2.007                          *   CL**2
  1320*                                                                *ELCDTEFD
  1321******************************************************************ELCDTEFD
  1322     BLOCK CONTAINS 0 RECORDS
  1323     RECORDING MODE F.                                            ELCDTEFD
  1324                                                                  ELCDTEFD
  1325 01  DATE-DISK.                                                   ELCDTEFD
  1326     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1327     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1328     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1329     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1330     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1331     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1332     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1333                                                                  ELCDTEFD
  1334 01  DATE-DISK-R.                                                 ELCDTEFD
  1335     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1336     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1337                                     PIC  X(32).                  ELCDTEFD
  1338                                                                  ELCDTEFD
  1339 01  DATE-DISK-T.                                                 ELCDTEFD
  1340     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1341     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1342                                     PIC  X(48).                  ELCDTEFD
  1343                                                                  ELCDTEFD
  1344 01  DATE-DISK-M.                                                 ELCDTEFD
  1345     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1346     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1347                                     PIC  X(48).                  ELCDTEFD
  1348                                                                  ELCDTEFD
  1349 01  DATE-DISK-P.                                                 ELCDTEFD
  1350     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1351     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1352     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1353     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1354         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1355                                     PIC  X.                      ELCDTEFD
  1356         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1357     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1358         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1359             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1360             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1361             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1362             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1363         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1364                                                                  ELCDTEFD
  1365 01  DATE-DISK-E.                                                 ELCDTEFD
  1366     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1367     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1368                                     PIC  X(4).                   ELCDTEFD
  1369                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1370 01  DATE-DISK-C.                                                 ELCDTEFD
  1371     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1372     12  DD-CARR1-SECPAY-SW          PIC  X.
  1373     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1374     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1375     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1376     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1377     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1378     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1379     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1380     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1381     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1382     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1383     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1384     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1385     12  DD-CARR2-SECPAY-SW          PIC  X.
  1386     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1387                                                                  ELCDTEFD
  1388 01  DATE-DISK-OPT.                                               ELCDTEFD
  1389     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1390     12  DD-TLR-DATA.                                             ELCDTEFD
  1391         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1392                                     PIC  X(03).                  ELCDTEFD
  1393     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1394         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1395                                     PIC  X(06).                  ELCDTEFD
  1396     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1397         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1398                                     PIC  X(07).                  ELCDTEFD
  1399         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1400     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1401                                     PIC  X(96).                  ELCDTEFD
  1402******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS158.cbl
  1404 FD  PRINTX
* 1405                                 COPY ELCPRTFD.
  1406******************************************************************04/15/98
  1407*                                                                *ELCPRTFD
  1408*                                                                *ELCPRTFD
  1409*                            ELCPRTFD.                           *   LV003
  1410*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1411*                            VMOD=2.006                          *ELCPRTFD
  1412******************************************************************ELCPRTFD
  1413     RECORDING MODE F                                             ELCPRTFD
  1414     LABEL RECORDS OMITTED                                        ELCPRTFD
  1415     BLOCK CONTAINS 0 RECORDS
  1416     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  1417 01  PRT.                                                         ELCPRTFD
  1418     12  P-CTL               PIC  X.                                 CL**2
  1419     12  P-DATA              PIC  X(132).                         ELCPRTFD
  1420******************************************************************ELCPRTFD
  1421 FD  PRINTC
  1422     RECORDING MODE F.
  1423
  1424 01  PRTC.
  1425     12  PRTC-CTL                PIC X(01).
  1426     12  PRTC-DATA               PIC X(132).
  1427
  1428 FD  FICH
* 1429                                 COPY ECSFICH.
  1430******************************************************************10/06/86
  1431*                                                                *ECSFICH
  1432*                            ECSFICH                             *   LV001
  1433*                            VMOD=2.001                          *ECSFICH
  1434*                                                                *ECSFICH
  1435*  NO  CSO  MODS  IN  COPYBOOK  ECSFICH                          *ECSFICH
  1436*                                                                *ECSFICH
  1437******************************************************************ECSFICH
  1438     RECORDING MODE F                                             ECSFICH
  1439     LABEL RECORDS STANDARD                                       ECSFICH
  1440     BLOCK CONTAINS 0 RECORDS
  1441     RECORD CONTAINS 133 CHARACTERS.                              ECSFICH
  1442 01  FICH-REC                PIC  X(133).                         ECSFICH
  1443******************************************************************ECSFICH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS158.cbl
  1445 WORKING-STORAGE SECTION.
  1446 77  FILLER  PIC X(32) VALUE '********************************'.
  1447 77  FILLER  PIC X(32) VALUE '     ECS158 WORKING STORAGE     '.
  1448 77  FILLER  PIC X(32) VALUE '********* VMOD=2.041 ***********'.
  1449
  1450 77  WS-CLMS-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1451 77  WS-CERT-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1452 77  WS-ACCT-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1453 77  WS-RTBL-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1454 77  WS-SCLM-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1455 77  WS-RATE-DB-CNT          PIC 9(9)  VALUE ZEROS.
  1456 77  WS-TOT-CLMS-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1457 77  WS-TOT-CERT-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1458 77  WS-TOT-ACCT-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1459 77  WS-TOT-RTBL-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1460 77  WS-TOT-SCLM-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1461 77  WS-TOT-RATE-DB-CNT      PIC 9(9)  VALUE ZEROS.
  1462 77  FROM-LIFE-SW            PIC X(01) VALUE SPACES.
  1463 77  PAGE-CTR                PIC S9(07)    VALUE +0  COMP-3.
  1464 77  LF-BAL-REMTERM          PIC S9(03)V99 VALUE +0 COMP-3.
  1465 77  LINE-CTR                PIC S9(03)    VALUE +99 COMP-3.
  1466 77  WRK-A                   PIC S9(7)V99  VALUE +0  COMP-3.
  1467 77  WRK-B                   PIC S9(7)V99  VALUE +0  COMP-3.
  1468 77  WRK-ALT                 PIC S9(7)V99  VALUE +0  COMP-3.
  1469 77  WRK-C                   PIC S9(07)V99 VALUE +0  COMP-3.
  1470 77  WRK-D                   PIC S9(4)V9(11) VALUE +0  COMP-3.
  1471 77  WRK-E                   PIC S9(4)V9(11) VALUE +0  COMP-3.
  1472 77  WRK-F                   PIC S9(07)V99 VALUE +0  COMP-3.
  1473 77  WRK-G                   PIC S9(07)V99 VALUE +0  COMP-3.
  1474 77  WRK-H                   PIC S9(07)V99 VALUE +0  COMP-3.
  1475 77  WS-DIFF                 PIC S9(7)V9(5) VALUE +0 COMP-3.
  1476 77  WRK-REMTRM              PIC S9(03)    VALUE +0  COMP-3.
  1477 77  WS-MEAN-CALC            PIC S9(09)V99 VALUE +0  COMP-3.
  1478 77  WS-ACCT-MATCH-SW        PIC X(01)  VALUE SPACES.
  1479     88  ACCOUNT-MATCHED         VALUE '*'.
  1480 77  M4                      PIC S9(03)V99 VALUE +0  COMP-3.
  1481 77  M9                      PIC S9(03)V99 VALUE +0  COMP-3.
  1482 77  WORK-M4                 PIC S9(03)    VALUE +0  COMP-3.
  1483 77  ACCT-MATCH-CONTROL      PIC X(19)     VALUE LOW-VALUES.
  1484 77  ACCT-MATCH-EFF          PIC 9(11)     VALUE 0.
  1485 77  LIFE-AH-SUB             PIC S9(04)    VALUE +0  COMP.
  1486 77  CERT-CONTROL            PIC X(36)     VALUE LOW-VALUES.
  1487 77  CLAIMS-CONTROL          PIC X(36)     VALUE LOW-VALUES.
  1488 77  HOLD-CLAIMS-CONTROL     PIC X(36)     VALUE LOW-VALUES.
  1489 77  WS-LF-RATE-ATTEMPT      PIC 9(07)     VALUE ZEROS.
  1490 77  WS-AH-RATE-ATTEMPT      PIC 9(07)     VALUE ZEROS.
  1491 77  WS-LF-RATE-ERROR        PIC 9(07)     VALUE ZEROS.
  1492 77  WS-AH-RATE-ERROR        PIC 9(07)     VALUE ZEROS.
  1493 77  WS-HOLD-LF-PRIM-FAC     PIC S9(9)V99  VALUE +0  COMP-3.
  1494 77  WS-HOLD-AH-PRIM-FAC     PIC S9(9)V99  VALUE +0  COMP-3.
  1495 77  LF-DEV-TO-PRIM-FACTOR   PIC S99V9(5)  VALUE +0  COMP-3.
  1496 77  AH-DEV-TO-PRIM-FACTOR   PIC S99V9(5)  VALUE +0  COMP-3.
  1497 77  YR                      PIC S999      VALUE +3  COMP.
  1498 77  SA                      PIC S999      VALUE +0  COMP.
  1499 77  SB                      PIC S999      VALUE +0  COMP.
  1500 77  REM-TRM                 PIC S999      VALUE +0  COMP-3.
  1501 77  SV-FACTOR               PIC S9        VALUE +0  COMP-3.
  1502 77  COMM-PREMM              PIC S9(7)V99  VALUE +0  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS158.cbl
  1503 77  AGT-COMM                PIC S9(4)V99  VALUE +0  COMP-3.
  1504 77  REINS                   PIC S9(6)     VALUE +0  COMP-3.
  1505 77  FLD                     PIC S999      VALUE +0  COMP-3.
  1506 77  X                       PIC X         VALUE ' '.
  1507 77  ACC-SW                  PIC X         VALUE SPACES.
  1508 77  EFF-COUNT               PIC X         VALUE SPACES.
  1509 77  FLA-CLM-REIN-BASE       PIC S9(5)V99  VALUE +0  COMP-3.
  1510 77  ADJ-FLA-REIN-BASE       PIC S9(5)V9(4) VALUE +0 COMP-3.
  1511 77  REIN-RT-SW              PIC X         VALUE SPACE.
  1512 77  DTO-CC                  PIC 9(2)      VALUE 0.
  1513 77  DTO-YR                  PIC 9(2)      VALUE 0.
  1514 77  DTO-MO                  PIC 9(2)      VALUE 0.
  1515 77  WORK-MO                 PIC 9(3)      VALUE 0.
  1516 77  WORK-MO1                PIC 9(3)      VALUE 0.
  1517 77  CALL-CNT                PIC S9(7)     VALUE +0  COMP-3.
  1518 77  TEXAS-CNT               PIC S9(7)     VALUE +0  COMP-3.
  1519 77  ERRTBL-FILE-STATUS      PIC XX        VALUE '00'.
  1520 77  ERACCTT-FILE-STATUS     PIC XX        VALUE '00'.
  1521 77  LF-EARN-CODE            PIC X(01)     VALUE ' '.
  1522 77  AH-EARN-METHOD          PIC X(01)     VALUE ' '.
  1523 77  TEMP-3                  PIC S9(2)V9(9) VALUE +0 COMP-3.
  1524 77  WS-MATCH-SWITCH         PIC X(01)     VALUE ' '.
  1525     88  CLAIM-NO-CERT           VALUE '1'.
  1526     88  CERT-NO-CLAIM           VALUE '2'.
  1527     88  CERT-AND-CLAIM          VALUE '3'.
  1528 77  MEAN-CAL                PIC S9(11)V99 VALUE +0  COMP-3.
  1529 77  WS-ACCT-MATCH           PIC X(01)     VALUE SPACES.
  1530     88  FROM-CLAIM              VALUE '1'.
  1531     88  FROM-CERT               VALUE '2'.
  1532 77  SAVE-STATE              PIC X(02)     VALUE SPACES.
  1533 77  TEMP-STATE              PIC X(02)     VALUE SPACES.
  1534 77  SAVE-BUSC-TYPE          PIC 9(02)     VALUE ZEROS.
  1535 77  WS-REPORT-SW            PIC X(01)     VALUE SPACES.
  1536     88  STATE-IS-EXCLUDED       VALUE 'X'.
  1537     88  REPORT-OVER-UNDER-60    VALUES '4' '5'.
  1538 77  WS-EXCL-BUSC-SW         PIC X(01)     VALUE SPACES.
  1539     88  BUSC-TYPE-IS-EXCLUDED   VALUE 'X'.
  1540 77  EXCL-SUB                PIC S9(04)    VALUE +0  COMP.
  1541 77  STATE-TX                PIC X(02)     VALUE SPACES.
  1542 77  STATE-IL                PIC X(02)     VALUE SPACES.
  1543 77  STATE-GA                PIC X(02)     VALUE SPACES.
  1544 77  STATE-NC                PIC X(02)     VALUE SPACES.
  1545 77  STATE-UT                PIC X(02)     VALUE SPACES.
  1546 77  STATE-IA                PIC X(02)     VALUE SPACES.
  1547 77  STATE-NE                PIC X(02)     VALUE SPACES.
  1548 77  STATE-NV                PIC X(02)     VALUE SPACES.
  1549 77  STATE-OH                PIC X(02)     VALUE SPACES.
  1550 77  STATE-OR                PIC X(02)     VALUE SPACES.
  1551 77  STATE-WI                PIC X(02)     VALUE SPACES.
  1552 77  WS-PROCESS-SW           PIC X(01)     VALUE SPACES.
  1553     88  SINGLE-PERIOD-PROCESS   VALUE 'Y'.
  1554 77  NUMBER-OF-PERIODS       PIC S999      VALUE +3  COMP.
  1555 77  WK-DEV-FACTOR           PIC S9(7)     VALUE +1000000.
  1556
  1557 01  WS-DEBUG-AREA.
  1558     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1559         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1560         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS158.cbl
  1561         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1562         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1563         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1564     12  WS-S-CNT                PIC S9(11) COMP-3 VALUE +0.
  1565     12  WS-S-INFORCE-CNT        PIC S9(11) COMP-3 VALUE +0.
  1566     12  WS-S-STATUTORY          PIC S9(11)V99 COMP-3 VALUE +0.
  1567     12  FORMAT-DATE.
  1568         16  FORMAT-MONTH        PIC XX.
  1569         16  FILLER              PIC X  VALUE '/'.
  1570         16  FORMAT-DAY          PIC XX.
  1571         16  FILLER              PIC X  VALUE '/'.
  1572         16  FORMAT-YEAR         PIC XX.
  1573     12  BIN-DE-CLM-PROC-DT      PIC XX.
  1574     12  BIN-DE-INCUR            PIC XX.
  1575
  1576 01  WORK-DEVIATION-CODES.
  1577     12  WK-LF-DEV-CODE.
  1578         16  WK-LF-DEV-CODE-1    PIC X.
  1579         16  WK-LF-DEV-CODE-2    PIC X.
  1580         16  WK-LF-DEV-CODE-3    PIC X.
  1581     12  WK-AH-DEV-CODE.
  1582         16  WK-AH-DEV-CODE-1    PIC X.
  1583         16  WK-AH-DEV-CODE-2    PIC X.
  1584         16  WK-AH-DEV-CODE-3    PIC X.
  1585     12  WK-TEMP-DEV-PCT         PIC 9(7).
  1586     12  WK-TEMP-DEV-PCT-RDF     REDEFINES WK-TEMP-DEV-PCT.
  1587         16  WK-TEMP-DEV         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS158.cbl
* 1589                             COPY ECSEXTCL.
  1590******************************************************************11/18/98
  1591*                                                                *ECSEXTCL
  1592*                             ECSEXTCL                           *   LV010
  1593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  1594*                            VMOD=2.006                          *ECSEXTCL
  1595*                                                                *ECSEXTCL
  1596*     FILE DESCRIPTION = STATE CALL EXTRACT RECORD  (OFF-LINE)   *ECSEXTCL
  1597*                                                                *ECSEXTCL
  1598*     FILE TYPE = SEQUENTIAL                                     *ECSEXTCL
  1599*     RECORD SIZE = XXX  RECFORM = FIXED                         *ECSEXTCL
  1600*                                                                *ECSEXTCL
  1601*     KEY DATA =     START=1, LEN=XX                             *ECSEXTCL
  1602*                                                                *ECSEXTCL
  1603******************************************************************ECSEXTCL
  1604 01  CALL-EXTRACT.                                                ECSEXTCL
  1605     12  SORT-KEY.                                                ECSEXTCL
  1606         16  SX-RECORD-TYPE          PIC X.                       ECSEXTCL
  1607         16  SX-REIN-CO              PIC X(6).                    ECSEXTCL
  1608         16  SX-CARRIER              PIC X.                       ECSEXTCL
  1609         16  SX-GROUPING             PIC X(6).                    ECSEXTCL
  1610         16  SX-STATE                PIC XX.                      ECSEXTCL
  1611         16  SX-ACCOUNT              PIC X(10).                   ECSEXTCL
  1612         16  SX-TERM-CD              PIC X.                       ECSEXTCL
  1613         16  FILLER                  PIC X.                       ECSEXTCL
  1614         16  SX-CAL-TABLE            PIC XX.                      ECSEXTCL
  1615         16  SX-ACCT-TYPE            PIC XX.                      ECSEXTCL
  1616         16  SX-STATE-DEV            PIC XXX.                     ECSEXTCL
  1617     12  EX-REST-OF-RECORD.                                       ECSEXTCL
  1618         16  EX-REIN                 PIC X(6).                    ECSEXTCL
  1619         16  EX-CARRIER              PIC X.                       ECSEXTCL
  1620         16  EX-GROUPING             PIC X(6).                    ECSEXTCL
  1621         16  EX-STATE                PIC XX.                      ECSEXTCL
  1622         16  EX-TERM-CD              PIC X.                       ECSEXTCL
  1623         16  EX-STATE-DEV            PIC X(3).                    ECSEXTCL
  1624         16  EX-I-G                  PIC X.                       ECSEXTCL
  1625         16  EX-CAL-TABLE            PIC XX.                      ECSEXTCL
  1626         16  EX-ACCT-TYPE            PIC XX.                      ECSEXTCL
  1627         16  EX-ACCOUNT              PIC X(10).                   ECSEXTCL
  1628         16  EX-RECORD-TYPE          PIC X.                       ECSEXTCL
  1629         16  EX-TX-RESV-ADJ-REC      PIC X.                       ECSEXTCL
  1630         16  EX-LIFE-AH              PIC X.                       ECSEXTCL
  1631         16  EX-BEN-TYPE             PIC XX.                      ECSEXTCL
  1632         16  EX-TERM                 PIC S999         COMP-3.     ECSEXTCL
  1633         16  EX-PREM                 PIC S9(7)V99     COMP-3.     ECSEXTCL
  1634         16  EX-PREM-ALT             PIC S9(7)V99     COMP-3.     ECSEXTCL
  1635         16  EX-EFF-DATE             PIC 9(8).                       CL**9
  1636         16  EX-NAME                 PIC X(20).                   ECSEXTCL
  1637         16  EX-AGE                  PIC 99.                      ECSEXTCL
  1638         16  EX-ENTRY-DATE           PIC 9(8).                       CL**8
  1639         16  EX-EXIT-DATE            PIC 9(8).                       CL**9
  1640         16  EX-PMT-FREQ             PIC 99.                      ECSEXTCL
  1641         16  EX-APR                  PIC S9(3)V9(4)   COMP-3.     ECSEXTCL
  1642         16  EX-CAP-TERM             PIC S999         COMP-3.     ECSEXTCL
  1643         16  EX-EARN-METHOD          PIC X.                       ECSEXTCL
  1644         16  EX-PRIM-FAC-PREM        PIC S9(7)V99     COMP-3.     ECSEXTCL
  1645         16  EX-PRIM-FAC-PREM-ALT    PIC S9(7)V99     COMP-3.     ECSEXTCL
  1646         16  EX-INITIAL-AMT          PIC S9(9)V99     COMP-3.     ECSEXTCL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXTCL)
  1647         16  EX-BENEFIT              PIC S9(7)V99     COMP-3.     ECSEXTCL
  1648         16  EX-DATA-BY-YEAR   OCCURS 3 TIMES.                    ECSEXTCL
  1649             20  EX-INC-CNT          PIC S999         COMP-3.     ECSEXTCL
  1650             20  EX-PD-CNT           PIC S999         COMP-3.     ECSEXTCL
  1651             20  EX-C-CNT            PIC S999         COMP-3.     ECSEXTCL
  1652             20  EX-CLAIM-AMT        PIC S9(9)V99     COMP-3.     ECSEXTCL
  1653             20  RR                  PIC S999         COMP-3.     ECSEXTCL
  1654             20  M1                  PIC S999         COMP-3.     ECSEXTCL
  1655             20  M2                  PIC S999V9       COMP-3.     ECSEXTCL
  1656             20  M3                  PIC S999V9       COMP-3.     ECSEXTCL
  1657             20  M5                  PIC S999         COMP-3.     ECSEXTCL
  1658             20  M6                  PIC S999         COMP-3.     ECSEXTCL
  1659             20  EX-BEG-ST-RES       PIC S9(7)V99     COMP-3.     ECSEXTCL
  1660             20  EX-END-ST-RES       PIC S9(7)V99     COMP-3.     ECSEXTCL
  1661             20  EX-BEG-R78-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1662             20  EX-END-R78-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1663             20  EX-BEG-PRO-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1664             20  EX-END-PRO-RES      PIC S9(7)V99     COMP-3.     ECSEXTCL
  1665             20  EX-BEG-MEAN-RES     PIC S9(7)V99     COMP-3.     ECSEXTCL
  1666             20  EX-END-MEAN-RES     PIC S9(7)V99     COMP-3.     ECSEXTCL
  1667             20  EX-PRI-BEG-ST-RES   PIC S9(7)V99     COMP-3.     ECSEXTCL
  1668             20  EX-PRI-END-ST-RES   PIC S9(7)V99     COMP-3.     ECSEXTCL
  1669             20  EX-PRI-BEG-R78-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1670             20  EX-PRI-END-R78-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1671             20  EX-PRI-BEG-PRO-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1672             20  EX-PRI-END-PRO-RES  PIC S9(7)V99     COMP-3.     ECSEXTCL
  1673             20  EX-PRI-BEG-MEAN-RES PIC S9(7)V99     COMP-3.     ECSEXTCL
  1674             20  EX-PRI-END-MEAN-RES PIC S9(7)V99     COMP-3.     ECSEXTCL
  1675             20  EX-MEAN-INFORCE     PIC S9(11)V99    COMP-3.     ECSEXTCL
  1676             20  EX-OVR-COMM         PIC S9(5)V99     COMP-3.     ECSEXTCL
  1677             20  EX-AGT-COMM         PIC S9(5)V99     COMP-3.     ECSEXTCL
  1678             20  EX-CNC-AMT          PIC S9(7)V99     COMP-3.     ECSEXTCL
  1679             20  EX-B-IBNR           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1680             20  EX-E-IBNR           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1681             20  EX-B-LOSS           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1682             20  EX-E-LOSS           PIC S9(9)V99     COMP-3.     ECSEXTCL
  1683             20  EX-RETRO-PMTS       PIC S9(9)V99     COMP-3.     ECSEXTCL
  1684             20  FILLER              PIC X(12).                      CL*10
  1685                                                                  ECSEXTCL
  1686******************************************************************ECSEXTCL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS158.cbl
  1688
* 1689                             COPY ECSEXT01.
  1690******************************************************************04/29/98
  1691*                                                                *ECSEXT01
  1692*                            ECSEXT01                            *   LV015
  1693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1694*                            VMOD=2.015                          *ECSEXT01
  1695*                                                                *ECSEXT01
  1696*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1697*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1698*                                                                *ECSEXT01
  1699*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1700*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1701*                                                                *ECSEXT01
  1702*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1703*                                                                *ECSEXT01
  1704******************************************************************ECSEXT01
  1705******************************************************************
  1706*                   C H A N G E   L O G
  1707*
  1708* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1709*-----------------------------------------------------------------
  1710*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1711* EFFECTIVE    NUMBER
  1712*-----------------------------------------------------------------
  1713* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1714* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1715* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1716* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1717* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1718* 032612  CR2011110200001  PEMA  AHL CHANGES
  1719******************************************************************
  1720                                                                  ECSEXT01
  1721 01  DETAIL-EXTRACT.                                              ECSEXT01
  1722     02 DETAIL-FILE.                                              ECSEXT01
  1723     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1724         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1725                                                                  ECSEXT01
  1726     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1727                                                                  ECSEXT01
  1728     12  DE-REIN                           PIC X.                 ECSEXT01
  1729                                                                  ECSEXT01
  1730     12  DE-CONTROL.                                              ECSEXT01
  1731         16  DE-CNTRL1.                                           ECSEXT01
  1732             20  DE-CARRIER                PIC X.                 ECSEXT01
  1733             20  DE-GROUPING.                                     ECSEXT01
  1734                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1735                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1736             20  DE-STATE                  PIC XX.                ECSEXT01
  1737             20  DE-ACCOUNT.                                      ECSEXT01
  1738                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1739                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1740         16  DE-CNTRL2.                                           ECSEXT01
  1741             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1742             20  DE-CERT.                                         ECSEXT01
  1743                 24 DE-CERT-NO.                                   ECSEXT01
  1744                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1745                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1746                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1747                                                                  ECSEXT01
  1748     12  DE-TRANS                          PIC X.                 ECSEXT01
  1749         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1750         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1751         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1752         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1753         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1754         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1755         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1756         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1757         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1758         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1759                                                                  ECSEXT01
  1760     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1761     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1762                                                                  ECSEXT01
  1763     12  DE-NAME.                                                 ECSEXT01
  1764         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1765         16  DE-FNAME.                                            ECSEXT01
  1766             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1767             20  FILLER                    PIC X(9).              ECSEXT01
  1768         16  DE-INIT                       PIC X.                 ECSEXT01
  1769     12  DE-AGE                            PIC 99.                ECSEXT01
  1770     12  DE-SEX                            PIC X.                 ECSEXT01
  1771     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1772                                                                  ECSEXT01
  1773     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1774     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1775     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1776     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1777     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1778     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1779     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1780     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1781     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1782                                                                  ECSEXT01
  1783     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1784     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1785     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1786     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1787                                                                  ECSEXT01
  1788     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1789     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1790     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1791     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1792     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1793                                                                  ECSEXT01
  1794     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1795     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1796     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1797     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1798                                                                  ECSEXT01
  1799     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1800     12  DE-ADDL-CLP REDEFINES DE-LIVES
  1801                                           PIC S9(5)V99   COMP-3.
  1802     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1803     12  FILLER REDEFINES DE-NUM-BILLED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1804         16  DE-CLP-STATE                  PIC XX.
  1805         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1806     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1807     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1808                                                                  ECSEXT01
  1809     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1810     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1811     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1812     12  DE-IG                             PIC X.                 ECSEXT01
  1813     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1814*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1815     12  DE-MEMBER-NO.                                            ECSEXT01
  1816         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1817         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1818         16  FILLER                        PIC X(03).             ECSEXT01
  1819     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1820                                                                  ECSEXT01
  1821     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1822         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1823                                                                  ECSEXT01
  1824     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1825     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1826                                                                  ECSEXT01
  1827     12  DE-REI-AREA.                                             ECSEXT01
  1828         16  DE-REI-COMP.                                         ECSEXT01
  1829             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1830             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1831         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1832         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1833         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1834         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1835         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1836         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1837         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1838                                                                  ECSEXT01
  1839     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1840     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1841         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1842         16  F                             PIC X.
  1843*    12  FILLER                            PIC X(5).              ECSEXT01
  1844                                                                  ECSEXT01
  1845     12  DE-BILLED-AREA.                                          ECSEXT01
  1846         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1847             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1848                                                                  ECSEXT01
  1849         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1850             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1851             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1852             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1853             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1854             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1855             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1856                                                                  ECSEXT01
  1857         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1858             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
  1859                                                                  ECSEXT01
  1860         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1861         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1862         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1863         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1864                                                                  ECSEXT01
  1865         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1866*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1867*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1868                                                                  ECSEXT01
  1869     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1870         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1871         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1872         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1873                                                                  ECSEXT01
  1874     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1875         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1876         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1877     12  DE-CANCEL-REASON                  PIC X.
  1878                                                                  ECSEXT01
  1879     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1880     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1881                                                                  ECSEXT01
  1882     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1883         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1884             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1885         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1886             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1887                                                                  ECSEXT01
  1888     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1889         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1890                                                                  ECSEXT01
  1891     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1892     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1893         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1894         16  FILLER                        PIC X.
  1895                                                                  ECSEXT01
  1896****************************************************************  ECSEXT01
  1897**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1898****************************************************************  ECSEXT01
  1899     12  DE-COMM-LEVELS.                                          ECSEXT01
  1900         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1901             20  DE-AGT.                                          ECSEXT01
  1902                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1903                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1904             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1905             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1906             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1907                                                                  ECSEXT01
  1908     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1909****************************************************************  ECSEXT01
  1910*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1911****************************************************************  ECSEXT01
  1912     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1913     12  FILLER                            PIC X(334).            ECSEXT01
  1914     12  DE-TYPE                           PIC X.                 ECSEXT01
  1915         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1916         88  DE-AH                            VALUE '2'.          ECSEXT01
  1917         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1918         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1919         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1920         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1921                                                                  ECSEXT01
  1922     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1923     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1924                                                                  ECSEXT01
  1925     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1926     12  DE-REPORTED.                                             ECSEXT01
  1927         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1928         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1929         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1930     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1931     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1932                                                                  ECSEXT01
  1933     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1934     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1935     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1936     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1937     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1938     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1939         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1940         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1941         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1942         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1943         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1944         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1945         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1946                                                                  ECSEXT01
  1947     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1948                                                                  ECSEXT01
  1949     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1950     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1951     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1952     12  FILLER                            PIC XX.                ECSEXT01
  1953     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1954                                                                  ECSEXT01
  1955     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1956     12  DE-BENEFICIARY                    PIC X(10).
  1957     12  filler redefines de-beneficiary.
  1958         16  de-birth-date                 pic 9(11)  comp-3.
  1959         16  f                             pic x(4).
  1960     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1961     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1962     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1963     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1964     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1965     12  DE-CLM-CLASS                      PIC XX.
  1966     12  DE-CLM-DEV                        PIC XXX.
  1967     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1968     12  de-xycor-cert-seq                 pic x(3).
  1969     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1970     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1971     12  DE-XYCOR-STATUS                   PIC X.
  1972     12  FILLER                            PIC X(4).              ECSEXT01
  1973                                                                  ECSEXT01
  1974     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1975                                                                  ECSEXT01
  1976****************************************************************  ECSEXT01
  1977*******               RESERVE EXTRACT                      *****  ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS158.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1978****************************************************************  ECSEXT01
  1979     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1980     12  FILLER                            PIC X(334).            ECSEXT01
  1981                                                                  ECSEXT01
  1982     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1983         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1984         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1985                                                                  ECSEXT01
  1986     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1987     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1988     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1989                                                                  ECSEXT01
  1990     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1991                                                                  ECSEXT01
  1992     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1993     12  DE-RSV-REPORTED.                                         ECSEXT01
  1994         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1995         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1996         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1997     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1998                                                                  ECSEXT01
  1999     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  2000     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  2001     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  2002                                                                  ECSEXT01
  2003     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  2004     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  2005     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  2006                                                                  ECSEXT01
  2007     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  2008                                                                  ECSEXT01
  2009     12  DE-RATE-CLASS                     PIC XX.
  2010     12  DE-DEV-CODE                       PIC XXX.
  2011     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  2012     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  2013     12  FILLER                            PIC X(58).             ECSEXT01
  2014                                                                  ECSEXT01
  2015     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  2016******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS158.cbl
  2018 01  TEXAS-REGS-WORK-AREAS.
  2019     12  TEX-FACT-1          PIC S9(7)V9(2)    COMP-3.
  2020     12  TEX-FACT-2          PIC S9(3)   COMP-3.
  2021     12  TEX-FACT-3          PIC S9(3)   COMP-3.
  2022     12  TEX-FACT-4          PIC S9(7)   COMP-3.
  2023     12  TEX-FACT-5          PIC S9(3)   COMP-3.
  2024     12  TEX-FACT-6          PIC S9(3)   COMP-3.
  2025     12  TEX-FACT-7          PIC S9(7)   COMP-3.
  2026     12  TEX-FACT-8          PIC S9V9(6) COMP-3.
  2027     12  TEX-FACT-9          PIC S9(4)V9(11)   COMP-3.
  2028
  2029 01  NET-PAY-INTERFACE.
  2030     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  2031     05  NP-ORIG                 PIC S9(3)         COMP-3.
  2032     05  NP-REM                  PIC S9(3)         COMP-3.
  2033     05  NP-OPT                  PIC X(01).
  2034     05  NP-CAP                  PIC S9(3)         COMP-3.
  2035     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  2036     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  2037     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  2038
  2039 01  METHOD-TABLE.
  2040     05  M-TABLE.
  2041         10  FILLER              PIC X(03) VALUE 'AKP'.
  2042         10  FILLER              PIC X(03) VALUE 'ALP'.
  2043         10  FILLER              PIC X(03) VALUE 'ARR'.
  2044         10  FILLER              PIC X(03) VALUE 'AZP'.
  2045         10  FILLER              PIC X(03) VALUE 'CAP'.
  2046         10  FILLER              PIC X(03) VALUE 'DEP'.
  2047         10  FILLER              PIC X(03) VALUE 'GAP'.
  2048         10  FILLER              PIC X(03) VALUE 'IDP'.
  2049         10  FILLER              PIC X(03) VALUE 'ILP'.
  2050         10  FILLER              PIC X(03) VALUE 'KSP'.
  2051         10  FILLER              PIC X(03) VALUE 'KYP'.
  2052         10  FILLER              PIC X(03) VALUE 'LAP'.
  2053         10  FILLER              PIC X(03) VALUE 'MDP'.
  2054         10  FILLER              PIC X(03) VALUE 'MIP'.
  2055         10  FILLER              PIC X(03) VALUE 'MTP'.
  2056         10  FILLER              PIC X(03) VALUE 'NMR'.
  2057         10  FILLER              PIC X(03) VALUE 'NVP'.
  2058         10  FILLER              PIC X(03) VALUE 'OHO'.
  2059         10  FILLER              PIC X(03) VALUE 'OKK'.
  2060         10  FILLER              PIC X(03) VALUE 'ORP'.
  2061         10  FILLER              PIC X(03) VALUE 'PAR'.
  2062         10  FILLER              PIC X(03) VALUE 'SCP'.
  2063         10  FILLER              PIC X(03) VALUE 'SDP'.
  2064         10  FILLER              PIC X(03) VALUE 'TNR'.
  2065         10  FILLER              PIC X(03) VALUE 'TXT'.
  2066         10  FILLER              PIC X(03) VALUE 'UTR'.
  2067         10  FILLER              PIC X(03) VALUE 'VAV'.
  2068         10  FILLER              PIC X(03) VALUE 'WAR'.
  2069         10  FILLER              PIC X(03) VALUE 'WIP'.
  2070         10  FILLER              PIC X(03) VALUE 'WVR'.
  2071         10  FILLER              PIC X(03) VALUE 'WYP'.
  2072     05  MR-TABLE REDEFINES M-TABLE  OCCURS 31 TIMES
  2073                            INDEXED BY TABLE-INDEX.
  2074         10  T-STATE             PIC X(02).
  2075         10  METHOD-CODE         PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS158.cbl
  2076
  2077 01  TYPE-METHOD                 PIC X(01)     VALUE SPACES.
  2078     88  R78                           VALUE 'R'.
  2079     88  PRATA                         VALUE 'P'.
  2080     88  TEXAS-SPECIAL                 VALUE 'T'.
  2081     88  OK-SPECIAL                    VALUE 'K'.
  2082     88  MEAN                          VALUE 'M'.
  2083     88  ANTICIPATION                  VALUE 'A'.
  2084     88  OHIO-SPECIAL                  VALUE 'O'.
  2085     88  VIRGINIA-SPECIAL              VALUE 'V'.
  2086     88  1-3RD-2-3RDS                  VALUE '1'.
  2087     88  AH-EARN-NET-PAY               VALUE 'N'.
  2088
  2089 01  DEFAULT-AH-METHOD           PIC X(01)     VALUE 'R'.
  2090
  2091 01  WS-ABEND-AREA.
  2092     05  WS-ABEND-FILE-STATUS    PIC X(02).
  2093     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  2094     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  2095     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  2096
  2097 01  WORK-ABEND-CODE.
  2098     12  WAC-1                   PIC X.
  2099     12  WAC-2                   PIC X.
  2100     12  WAC-3-4.
  2101         16  WAC-3               PIC X.
  2102         16  WAC-4               PIC X.
  2103
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS158.cbl
* 2105                               COPY ELCCALC.
  2106******************************************************************04/15/98
  2107*                                                                *ELCCALC
  2108*                           ELCCALC.                            *    LV003
  2109*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2110*                            VMOD=2.025                          *   CL**3
  2111*                                                                *   CL**2
  2112*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  2113*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  2114*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  2115*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  2116*                                                                *   CL**2
  2117*  PASSED TO ELRTRM                                              *   CL**2
  2118*  -----------------                                             *   CL**2
  2119*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  2120*  ORIGINAL TERM                                                 *   CL**2
  2121*  BEGINNING DATE                                                *   CL**2
  2122*  ENDING DATE                                                   *   CL**2
  2123*  COMPANY I.D.                                                  *   CL**2
  2124*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  2125*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  2126*  FREE LOOK DAYS                                                *   CL**2
  2127*                                                                *   CL**2
  2128*  RETURNED FROM ELRTRM                                          *   CL**2
  2129*  ---------------------                                         *   CL**2
  2130*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  2131*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  2132*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  2133*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  2134*----------------------------------------------------------------*   CL**2
  2135*  PASSED TO ELRAMT                                              *   CL**2
  2136*  ----------------                                              *   CL**2
  2137*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  2138*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2139*  ORIGINAL AMOUNT                                               *   CL**2
  2140*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  2141*  A.P.R. - NET PAY ONLY                                         *   CL**2
  2142*  METHOD                                                            CL**2
  2143*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  2144*  COMPANY I.D.                                                  *   CL**2
  2145*  BENEFIT TYPE                                                  *   CL**2
  2146*                                                                *   CL**2
  2147*  RETURNED FROM ELRAMT                                          *   CL**2
  2148*  --------------------                                          *   CL**2
  2149*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  2150*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  2151*  REMAINING AMOUNT FACTOR                                           CL**2
  2152*----------------------------------------------------------------*   CL**2
  2153*  PASSED TO ELRESV                                              *   CL**2
  2154*  -----------------                                             *   CL**2
  2155*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  2156*  VALUATION DATE                                                *   CL**2
  2157*  PAID THRU DATE                                                *   CL**2
  2158*  BENEFIT                                                       *   CL**2
  2159*  INCURRED DATE                                                 *   CL**2
  2160*  REPORTED DATE                                                 *   CL**2
  2161*  ISSUE AGE                                                     *   CL**2
  2162*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2163*  CDT PERCENT                                                   *   CL**2
  2164*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  2165* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  2166* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  2167* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  2168*                                                                *   CL**2
  2169*  RETURNED FROM ELRESV                                          *   CL**2
  2170*  --------------------                                          *   CL**2
  2171*  CDT TABLE USED                                                *   CL**2
  2172*  CDT FACTOR USED                                               *   CL**2
  2173*  PAY TO CURRENT RESERVE                                        *   CL**2
  2174*  I.B.N.R. - A/H ONLY                                           *   CL**2
  2175*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  2176*----------------------------------------------------------------*   CL**2
  2177*  PASSED TO ELRATE                                              *   CL**2
  2178*  ----------------                                              *   CL**2
  2179*  CERT ISSUE DATE                                               *   CL**2
  2180*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2181*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2182*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  2183*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2184*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2185*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2186*  DEVIATION CODE                                                *   CL**2
  2187*  ISSUE AGE                                                     *   CL**2
  2188*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2189*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2190*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  2191*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2192*  A.P.R.                                                        *   CL**2
  2193*  METHOD                                                            CL**2
  2194*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2195*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2196*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2197*  BENEFIT CODE                                                  *   CL**2
  2198*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2199*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  2200*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  2201*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  2202*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  2203*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  2204*                                                                *   CL**2
  2205*  RETURNED FROM ELRATE                                          *   CL**2
  2206*  --------------------                                          *   CL**2
  2207*  CALCULATED PREMIUM                                            *   CL**2
  2208*  PREMIUM RATE                                                  *   CL**2
  2209*  MORTALITY CODE                                                *   CL**2
  2210*  MAX ATTAINED AGE                                              *   CL**2
  2211*  MAX AGE                                                       *   CL**2
  2212*  MAX TERM                                                      *   CL**2
  2213*  MAX MONTHLY BENEFIT                                           *   CL**2
  2214*  MAX TOTAL BENIFIT                                             *   CL**2
  2215*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  2216*----------------------------------------------------------------*   CL**2
  2217*  PASSED TO ELRFND                                              *   CL**2
  2218*  ----------------                                              *   CL**2
  2219*  CERT ISSUE DATE                                               *   CL**2
  2220*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2221*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2222*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2223*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  2224*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2225*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2226*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2227*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2228*  DEVIATION CODE                                                *   CL**2
  2229*  ISSUE AGE                                                     *   CL**2
  2230*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2231*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  2232*  PROCESS TYPE (CANCEL)                                         *   CL**2
  2233*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2234*  A.P.R.                                                        *   CL**2
  2235*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  2236*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  2237*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2238*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2239*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2240*  BENEFIT CODE                                                  *   CL**2
  2241*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2242*                                                                *   CL**2
  2243*  RETURNED FROM ELRFND                                          *   CL**2
  2244*  --------------------                                          *   CL**2
  2245*  CALCULATED REFUND                                             *   CL**2
  2246*----------------------------------------------------------------*   CL**2
  2247*  PASSED TO ELEARN                                              *   CL**2
  2248*  ----------------                                              *   CL**2
  2249*  CERT ISSUE DATE                                               *   CL**2
  2250*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  2251*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  2252*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  2253*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  2254*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  2255*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  2256*  DEVIATION CODE                                                *   CL**2
  2257*  ISSUE AGE                                                     *   CL**2
  2258*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  2259*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  2260*  A.P.R.                                                        *   CL**2
  2261*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  2262*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  2263*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  2264*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  2265*  BENEFIT CODE                                                  *   CL**2
  2266*  BENEFIT OVERRIDE CODE                                         *   CL**2
  2267*                                                                *   CL**2
  2268*  RETURNED FROM ELEARN                                          *   CL**2
  2269*  --------------------                                          *   CL**2
  2270*  INDICATED  EARNINGS                                           *   CL**2
  2271*----------------------------------------------------------------*   CL**2
  2272*                 LENGTH = 450                                   *   CL**2
  2273*                                                                *   CL**2
  2274******************************************************************   CL**2
  2275******************************************************************
  2276*                   C H A N G E   L O G
  2277*
  2278* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2279*-----------------------------------------------------------------
  2280*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2281* EFFECTIVE    NUMBER
  2282*-----------------------------------------------------------------
  2283* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  2284* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2285* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  2286* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  2287* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  2288* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2289* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  2290* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  2291* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2292* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  2293******************************************************************
  2294                                                                     CL**2
  2295 01  CALCULATION-PASS-AREA.                                          CL**2
  2296     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  2297                                     COMP.                           CL**2
  2298                                                                     CL**2
  2299     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  2300       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  2301       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  2302                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  2303       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  2304       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  2305       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  2306       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  2307       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  2308       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  2309       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  2310       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  2311       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  2312       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  2313       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  2314       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  2315       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  2316       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  2317       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  2318       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  2319       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  2320                                                                     CL**2
  2321     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  2322       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  2323***********************  INPUT AREAS ****************************    CL**2
  2324                                                                     CL**2
  2325     12  CP-CALCULATION-AREA.                                        CL**2
  2326         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  2327         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  2328         16  CP-VALUATION-DT       PIC XX.                           CL**2
  2329         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  2330         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  2331           88  CP-AH                               VALUE 'A' 'D'     CL**2
  2332                                                   'I' 'U'.          CL**2
  2333           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  2334           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  2335         16  CP-INCURRED-DT        PIC XX.                           CL**2
  2336         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2337         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  2338         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  2339         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  2340                                     COMP-3.                         CL**2
  2341         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  2342                                     COMP-3.                         CL**2
  2343         16  CP-CDT-METHOD         PIC X.                            CL**2
  2344           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  2345           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  2346           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  2347         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  2348           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  2349           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  2350         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  2351                                     COMP-3.                         CL**2
  2352         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  2353                                     COMP-3.                         CL**2
  2354         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  2355                                     COMP-3.                         CL**2
  2356         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  2357                                     COMP-3.                         CL**2
  2358         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2359                                     COMP-3.                         CL**2
  2360         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  2361                                     COMP-3.                         CL**2
  2362         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  2363                                     COMP-3.                         CL**2
  2364         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  2365           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  2366           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  2367           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  2368           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  2369           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  2370           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  2371           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  2372         16  CP-EARNING-METHOD     PIC X.                            CL**2
  2373           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  2374           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  2375           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2376           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2377           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2378           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2379           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  2380           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2381           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  2382           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2383           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  2384           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  2385           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  2386           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  2387         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  2388           88  CP-CLAIM                            VALUE '1'.        CL**2
  2389           88  CP-CANCEL                           VALUE '2'.        CL**2
  2390           88  CP-ISSUE                            VALUE '3'.        CL**2
  2391         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  2392           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  2393           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  2394           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2395           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  2396           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  2397           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  2398           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  2399           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  2400           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  2401           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  2402           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  2403           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  2404           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  2405           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  2406           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  2407           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  2408           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  2409           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  2410                                                     'W' 'X'.        CL**2
  2411           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  2412           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  2413           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  2414           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  2415           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  2416           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  2417           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  2418           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  2419           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  2420           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  2421           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  2422           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  2423           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  2424                                                                     CL**2
  2425         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  2426                                     COMP-3.                         CL**2
  2427         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  2428         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  2429         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  2430         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  2431         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  2432           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  2433               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  2434         16  CP-R78-OPTION         PIC X.                            CL**2
  2435           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  2436           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  2437                                                                     CL**2
  2438         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  2439         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  2440         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  2441         16  CP-RATE-FILE          PIC X.                            CL**2
  2442         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  2443                                     COMP-3.                         CL**2
  2444                                                                     CL**2
  2445         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  2446         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  2447                                                                     CL**2
  2448         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  2449                                     COMP-3.
  2450         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  2451                                   PIC S9(5)V99 COMP-3.
  2452         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2453                                     COMP-3.                         CL**2
  2454         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  2455                                     COMP-3.                         CL**2
  2456         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  2457                                     COMP-3.
  2458         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  2459                                  PIC S9(7)V99 COMP-3.
  2460                                                                     CL**2
  2461         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  2462         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  2463         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  2464           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  2465           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  2466           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  2467           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  2468         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  2469         16  CP-CARRIER            PIC X.                            CL**2
  2470         16  CP-REIN-FLAG          PIC X.                            CL**2
  2471         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  2472           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  2473                      '2' '3' '4' '5'.                               CL**2
  2474           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  2475           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  2476           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  2477           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  2478           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  2479           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  2480           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  2481           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  2482         16  CP-SIG-SWITCH         PIC X.                            CL**2
  2483         16  CP-RATING-METHOD      PIC X.                            CL**2
  2484           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  2485           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  2486           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  2487           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  2488           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  2489           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  2490           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  2491           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  2492           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  2493         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  2494                                     COMP-3.                         CL**2
  2495         16  CP-BEN-CATEGORY       PIC X.
  2496         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2497         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  2498                                   PIC S99V9(5) COMP-3.
  2499         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  2500         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  2501                                   PIC S99V9(5) COMP-3.
  2502         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  2503         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2504         16  CP-EXPIRE-DT          PIC XX.
  2505         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2506         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2507         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2508         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2509         16  CP-DDF-SPEC-CALC      PIC X.
  2510             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2511             88  CP-CALC-CLP              VALUE 'C'.
  2512         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2513         16  CP-CANCEL-REASON      PIC X.
  2514         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2515         16  CP-PMT-MODE           PIC X.
  2516         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2517         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2518         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2519         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2520         16  FILLER                PIC X.
  2521                                                                     CL**2
  2522***************    OUTPUT FROM ELRESV   ************************     CL**2
  2523                                                                     CL**2
  2524         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  2525                                                                     CL**2
  2526         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  2527                                     COMP-3.                         CL**2
  2528         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  2529                                     COMP-3.                         CL**2
  2530         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  2531                                     COMP-3.                         CL**2
  2532         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  2533                                     COMP-3.                         CL**2
  2534         16  FILLER                PIC X(09).                        CL**2
  2535***************    OUTPUT FROM ELRTRM   *************************    CL**2
  2536                                                                     CL**2
  2537         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  2538                                     COMP-3.                         CL**2
  2539         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  2540                                     COMP-3.                         CL**2
  2541         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  2542                                     COMP-3.                         CL**2
  2543         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  2544                                     COMP-3.                         CL**2
  2545         16  FILLER                PIC X(12).                        CL**2
  2546                                                                     CL**2
  2547***************    OUTPUT FROM ELRAMT   *************************    CL**2
  2548                                                                     CL**2
  2549         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  2550                                     COMP-3.                         CL**2
  2551         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  2552                                     COMP-3.                         CL**2
  2553         16  FILLER                PIC X(12).                        CL**2
  2554                                                                     CL**2
  2555***************    OUTPUT FROM ELRATE   *************************    CL**2
  2556                                                                     CL**2
  2557         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  2558                                     COMP-3.                         CL**2
  2559         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  2560                                     COMP-3.                         CL**2
  2561         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  2562         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  2563             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  2564         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  2565                                     COMP-3.                         CL**2
  2566         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  2567         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2568         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2569                                   PIC S9(7)V99 COMP-3.
  2570         16  FILLER                PIC X(07).                        CL**2
  2571                                                                     CL**2
  2572***************    OUTPUT FROM ELRFND   *************************    CL**2
  2573                                                                     CL**2
  2574         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  2575                                     COMP-3.                         CL**2
  2576         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  2577           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  2578           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  2579           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  2580           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  2581           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2582           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  2583           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  2584           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  2585           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2586           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2587           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2588           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2589           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2590           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2591         16  FILLER                PIC X(12).                        CL**2
  2592                                                                     CL**2
  2593***************    OUTPUT FROM ELEARN   *************************    CL**2
  2594                                                                     CL**2
  2595         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  2596                                     COMP-3.                         CL**2
  2597         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  2598                                     COMP-3.                         CL**2
  2599         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  2600                                     COMP-3.                         CL**2
  2601         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  2602                                     COMP-3.                         CL**2
  2603         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  2604                                     COMP-3.                         CL**2
  2605         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  2606                                     COMP-3.                         CL**2
  2607         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  2608           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  2609           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  2610           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  2611           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  2612           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2613           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  2614           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  2615           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  2616           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2617         16  FILLER                PIC X(12).                        CL**2
  2618                                                                     CL**2
  2619***************    OUTPUT FROM ELPMNT   *************************    CL**2
  2620                                                                     CL**2
  2621         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  2622                                     COMP-3.                         CL**2
  2623         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  2624                                     COMP-3.                         CL**2
  2625         16  FILLER                PIC X(12).                        CL**2
  2626                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2627***************   MISC WORK AREAS    *****************************   CL**2
  2628         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  2629                                     COMP-3.                         CL**2
  2630         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  2631                                     COMP-3.                         CL**2
  2632         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  2633                                     COMP-3.                         CL**2
  2634         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  2635                                     COMP-3.                         CL**2
  2636         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2637                                     COMP-3.                         CL**2
  2638         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2639                                     COMP-3.                         CL**2
  2640         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  2641             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  2642             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  2643             88  IO-ERROR                         VALUE 'E'.         CL**2
  2644                                                                     CL**2
  2645         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  2646                                                                     CL**2
  2647         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  2648                                                                     CL**2
  2649         16  CP-RESERVE-REMAINING-TERM                               CL**2
  2650                                   PIC S9(4)V9    VALUE ZERO         CL**2
  2651                                     COMP-3.                         CL**2
  2652                                                                     CL**2
  2653         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  2654                                                                     CL**2
  2655         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  2656                                     COMP-3.                         CL**2
  2657                                                                     CL**2
  2658         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  2659                                     COMP-3.                         CL**2
  2660                                                                     CL**2
  2661         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  2662                                     COMP-3.                         CL**2
  2663                                                                     CL**2
  2664         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  2665                                     COMP-3.                         CL**2
  2666                                                                     CL**2
  2667         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  2668                                     COMP-3.                         CL**2
  2669                                                                     CL**2
  2670         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  2671                                     COMP-3.                         CL**2
  2672                                                                     CL**2
  2673         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  2674                                     COMP-3.                         CL**2
  2675                                                                     CL**2
  2676         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  2677             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  2678                                                                     CL**2
  2679         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  2680                                     COMP-3.                         CL**2
  2681         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2682                                     COMP-3.
  2683         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2684         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2685         16  cp-net-only-state     pic x value spaces.
  2686         16  FILLER                PIC X(13).                        CL**2
  2687******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS158.cbl
  2689 01  INITIALIZED-FRONT.
  2690     12  FILLER              PIC X(35)      VALUE SPACES.
  2691     12  FILLER              PIC X(37)      VALUE SPACES.
  2692     12  FILLER              PIC X(02)      VALUE ZEROS.
  2693     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2694     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2695     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2696     12  FILLER              PIC X(26)      VALUE SPACES.
  2697     12  FILLER              PIC 9(02)      VALUE ZEROS.
  2698     12  FILLER              PIC X(12)      VALUE SPACES.
  2699     12  FILLER              PIC 9(02)      VALUE ZEROS.
  2700     12  FILLER              PIC S9(3)V9(4) VALUE +0 COMP-3.
  2701     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2702     12  FILLER              PIC X(01)      VALUE SPACES.
  2703     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2704     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2705     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2706     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2707 01  INITIALIZED-BACK.
  2708     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2709     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2710     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2711     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2712     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2713     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2714     12  FILLER              PIC S9(03)V9   VALUE +0 COMP-3.
  2715     12  FILLER              PIC S9(03)V9   VALUE +0 COMP-3.
  2716     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2717     12  FILLER              PIC S9(03)     VALUE +0 COMP-3.
  2718     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2719     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2720     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2721     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2722     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2723     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2724     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2725     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2726     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2727     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2728     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2729     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2730     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2731     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2732     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2733     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2734     12  FILLER              PIC S9(11)V99  VALUE +0 COMP-3.
  2735     12  FILLER              PIC S9(5)V99   VALUE +0 COMP-3.
  2736     12  FILLER              PIC S9(5)V99   VALUE +0 COMP-3.
  2737     12  FILLER              PIC S9(7)V99   VALUE +0 COMP-3.
  2738     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2739     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2740     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2741     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2742     12  FILLER              PIC S9(9)V99   VALUE +0 COMP-3.
  2743     12  FILLER              PIC X(12)      VALUE SPACES.
  2744
  2745******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS158.cbl
  2747 01  FILLER.
  2748     12  WS-RESERVE-WORK OCCURS 3 TIMES.
  2749         16  WS-AH-END-R78-RES      PIC S9(09)V99 COMP-3.
  2750         16  WS-AH-BEG-R78-RES      PIC S9(09)V99 COMP-3.
  2751         16  WS-AH-END-PRO-RES      PIC S9(09)V99 COMP-3.
  2752         16  WS-AH-BEG-PRO-RES      PIC S9(09)V99 COMP-3.
  2753         16  WS-AH-END-NET-RES      PIC S9(09)V99 COMP-3.
  2754         16  WS-AH-BEG-NET-RES      PIC S9(09)V99 COMP-3.
  2755         16  WS-AH-END-MEAN-RES     PIC S9(09)V99 COMP-3.
  2756         16  WS-AH-BEG-MEAN-RES     PIC S9(09)V99 COMP-3.
  2757         16  WS-AH-END-STATE-RES    PIC S9(09)V99 COMP-3.
  2758         16  WS-AH-BEG-STATE-RES    PIC S9(09)V99 COMP-3.
  2759         16  WS-LEV-LF-BEGIN-RES    PIC S9(09)V99 COMP-3.
  2760         16  WS-LEV-LF-BEGIN-ALT    PIC S9(09)V99 COMP-3.
  2761         16  WS-LEV-LF-END-RES      PIC S9(09)V99 COMP-3.
  2762         16  WS-LEV-LF-END-ALT      PIC S9(09)V99 COMP-3.
  2763         16  WS-RED-LF-BEGIN-RES    PIC S9(09)V99 COMP-3.
  2764         16  WS-RED-LF-BEGIN-ALT    PIC S9(09)V99 COMP-3.
  2765         16  WS-RED-LF-END-RES      PIC S9(09)V99 COMP-3.
  2766         16  WS-RED-LF-END-ALT      PIC S9(09)V99 COMP-3.
  2767
  2768     12  WS-RESERVE-INIT.
  2769         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2770         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2771         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2772         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2773         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2774         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2775         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2776         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2777         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2778         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2779         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2780         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2781         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2782         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2783         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2784         16  FILLER            PIC S9(09)V99 VALUE +0 COMP-3.
  2785
  2786     12  WS-REM-TERM-WORK OCCURS 3 TIMES.
  2787         16  WS-LF-BEG-REM-TRM1     PIC S9(03)V99 COMP-3.
  2788         16  WS-LF-END-REM-TRM1     PIC S9(03)V99 COMP-3.
  2789         16  WS-AH-BEG-REM-TRM1     PIC S9(03)V99 COMP-3.
  2790         16  WS-AH-END-REM-TRM1     PIC S9(03)V99 COMP-3.
  2791         16  WS-LF-LEV-MEAN-INFORCE PIC S9(11)V99 COMP-3.
  2792         16  WS-LF-RED-MEAN-INFORCE PIC S9(11)V99 COMP-3.
  2793
  2794     12  WS-REM-TERM-INIT.
  2795         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2796         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2797         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2798         16  FILLER                 PIC S9(03)V99 COMP-3 VALUE +0.
  2799         16  FILLER                 PIC S9(11)V99 COMP-3 VALUE +0.
  2800         16  FILLER                 PIC S9(11)V99 COMP-3 VALUE +0.
  2801
  2802 01  FILLER.
  2803     12  INTERMED                PIC S9(9)V9(6)  COMP-3.
  2804     12  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS158.cbl
  2805     12  FILLER OCCURS 2 TIMES.
  2806         16  WS-DEV           PIC X(03).
  2807         16  WS-BEN-TYPE      PIC X(02).
  2808         16  WS-TERM          PIC S9(03)  COMP-3.
  2809         16  FILLER OCCURS 2 TIMES.
  2810             20  FILLER OCCURS 3 TIMES.
  2811                 24  WS-CLAIM-AMT PIC S9(09)V99 COMP-3.
  2812                 24  WS-INC-CNT   PIC S9(03).
  2813                 24  WS-PD-CNT    PIC S9(03).
  2814
  2815     12  HOLD-LIFE-RECORD        PIC X(666)  VALUE SPACES.
  2816     12  HOLD-AH-RECORD          PIC X(666)  VALUE SPACES.
  2817     12  FROM-REIN               PIC X(01) VALUE SPACES.
  2818     12  WS-AGT-NO.
  2819         16  WS-AGT-SIX       PIC X(06)    VALUE SPACES.
  2820         16  FILLER           PIC X(04)    VALUE SPACES.
  2821
  2822 01  DATE-AREAS.
  2823     05  FIRST-PAY-DT              PIC X(02).
  2824     05  ENTRY-DT                  PIC X(02).
  2825     05  EXIT-DT                   PIC X(02).
  2826     05  EXPIRE-DT                 PIC X(02).
  2827     05  EFFECT-DT                 PIC X(02).
  2828     05  BEGIN-DT   OCCURS 3 TIMES PIC X(02).
  2829     05  END-DT     OCCURS 3 TIMES PIC X(02).
  2830     05  DT-START                  PIC X(02).
  2831     05  DT-END                    PIC X(02).
  2832     05  AH-CLM                    PIC X(02).
  2833     05  AH-CAN                    PIC X(02).
  2834     05  LF-CLM                    PIC X(02).
  2835     05  LF-CAN                    PIC X(02).
  2836     05  WS-CR-BIN-DATE            PIC XX.
  2837
  2838     05  CLM-INCUR-REIN-DATE.
  2839         10  CIRD-CCYY.
  2840             15  CIRD-CC         PIC 99.
  2841             15  CIRD-YR         PIC 99.
  2842         10  CIRD-MO             PIC 99.
  2843
  2844     05  BEGIN-DATE OCCURS 3 TIMES.
  2845         10  BEGIN-CCYY          PIC 9(04).
  2846         10  BEGIN-CCYR  REDEFINES  BEGIN-CCYY.
  2847             15  BEGIN-CC        PIC 99.
  2848             15  BEGIN-YR        PIC 99.
  2849         10  BEGIN-MO            PIC 99.
  2850         10  BEGIN-DA            PIC 99.
  2851
  2852
  2853     05  ENDING-DATE OCCURS 3 TIMES.
  2854         10  ENDING-CCYY         PIC 9(04).
  2855         10  ENDING-CCYR  REDEFINES  ENDING-CCYY.
  2856             15  ENDING-CC       PIC 99.
  2857             15  ENDING-YR       PIC 99.
  2858         10  ENDING-MO           PIC 99.
  2859         10  ENDING-DA           PIC 99.
  2860
  2861     05  ENTRY-DATE.
  2862         10  ENTRY-YR            PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS158.cbl
  2863         10  ENTRY-MO            PIC 99.
  2864         10  ENTRY-DA            PIC 99.
  2865
  2866     05  EXIT-DATE.
  2867         10  EXIT-YR             PIC 99.
  2868         10  EXIT-MO             PIC 99.
  2869         10  EXIT-DA             PIC 99.
  2870
  2871     05  EXPIRE-DATE.
  2872         10  EXPIRE-YR           PIC 99.
  2873         10  EXPIRE-MO           PIC 99.
  2874         10  EXPIRE-DA           PIC 99.
  2875
  2876 01  REM-TRM-MISC-FIELDS.
  2877     12  BGN-DT.
  2878         16  BGN-YR              PIC 99.
  2879         16  BGN-MO              PIC 99.
  2880         16  BGN-DA              PIC 99.
  2881     12  END-DTE.
  2882         16  END-YR              PIC 99.
  2883         16  END-MO              PIC 99.
  2884         16  END-DA              PIC 99.
  2885     12  REM-TRM1                PIC S9(3)V99    COMP-3.
  2886     12  REM-TRM2                PIC S9(3)V99    COMP-3.
  2887
* 2888                                 COPY ECSRITAB.
  2889******************************************************************04/29/98
  2890*                                                                *ECSRITAB
  2891*                            ECSRITAB                            *   LV015
  2892*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2893*                            VMOD=2.015                          *ECSRITAB
  2894*                                                                *ECSRITAB
  2895*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2896*                                                                *ECSRITAB
  2897******************************************************************ECSRITAB
  2898 01  REIN-WORK-AREAS.                                             ECSRITAB
  2899     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2900     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2901     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2902     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2903     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2904     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2905     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2906     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2907     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2908     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2909     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2910         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2911             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2912             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2913             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2914     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2915     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2916     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2917     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2918     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2919     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2920     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2921     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2922     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2923     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2924     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2925     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2926     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2927     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2928     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2929     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2930     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2931     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2932     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2933     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2934     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2935     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2936     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2937                                                                  ECSRITAB
  2938 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2939     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2940         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2941         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2942             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2943             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2944         16  REIN-WORK-FLDS.                                      ECSRITAB
  2945             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  2946             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2947             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2948             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2949             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2950             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2951             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2952             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2953             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2954             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2955             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2956             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2957             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2958             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2959             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2960             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2961             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2962             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2963             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2964             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2965             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2966             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2967             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2968             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2969             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2970             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2971             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2972             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2973     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2974                                                                  ECSRITAB
  2975     12  RWF-FIELDS.                                              ECSRITAB
  2976         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2977         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2978         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2979         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2980         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2981         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2982         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2983         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2984         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2985         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2986         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2987         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2988         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2989         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2990         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2991         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2992         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2993         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2994         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2995         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2996         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2997         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2998         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2999         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3000         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3001         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3002         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3003         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3004                                                                  ECSRITAB
  3005     12  WT-COMP-INFO.                                            ECSRITAB
  3006         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3007         16  WT-LF-QC                PIC X.                       ECSRITAB
  3008         16  WT-AH-QC                PIC X.                       ECSRITAB
  3009         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3010         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3011         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3012         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3013         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  3014         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3015         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3016         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3017         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3018         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3019         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3020         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3021         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3022         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3023         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3024         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3025         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3026         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3027         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3028         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3029         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3030         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3031         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3032         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3033         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3034         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3035         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3036         16  WT-REMAINING            PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3037         16  FILLER                  PIC X(21).                   ECSRITAB
  3038                                                                  ECSRITAB
  3039 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3040     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3041     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3042     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3043     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3044     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3045     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3046     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3047     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3048     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3049     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3050     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3051     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3052     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3053     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3054     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3055     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3056     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3057     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3058     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3059     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3060     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3061     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3062     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3063     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3064                                                                  ECSRITAB
  3065     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3066         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3067     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3068         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3069     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3070         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3071     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3072         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3073     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3074         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3075     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3076         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3077                                                                  ECSRITAB
  3078     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3079         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3080         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3081         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3082         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3083         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3084         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3085         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3086         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3087         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3088         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3089         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3090         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3091         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3092         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3093         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3094         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3095         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3096         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3097         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3098         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3099         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3100         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3101         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3102     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3103     12  REIN-SEARCH.                                             ECSRITAB
  3104         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3105         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3106         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3107         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3108     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3109     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3110     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3111     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3112     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3113     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3114     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3115     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3116     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3117     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3118     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3119     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3120     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3121     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3122     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3123     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3124     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3125     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3126     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3127     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3128     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3129     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  3130     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3131     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3132     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3133                                                                  ECSRITAB
  3134 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3135* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3136     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3137         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3138         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3139         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3140         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3141         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3142         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3143         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3144         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3145         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3146                                                                  ECSRITAB
  3147 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3148     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3149         16  RC2-REIN-CO.                                         ECSRITAB
  3150             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3151             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3152         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3153         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3154         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3155         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3156         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3157         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3158                                                                  ECSRITAB
  3159 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3160     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3161         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3162         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3163     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3164                                                                  ECSRITAB
  3165 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3166     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3167         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3168         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3169         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3170 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3171     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3172         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3173                                                                  ECSRITAB
  3174 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3175******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS158.cbl
  3177
  3178 01  ABEND-FIELDS.
  3179     12  PGM-SUB         PIC S999 COMP  VALUE +158.
  3180     12  FIRST-TIME-SW   PIC X  VALUE 'Y'.
  3181         88  FIRST-TIME         VALUE 'Y'.
  3182
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS158.cbl
  3184 01  HEAD-1.
  3185     05  FILLER      PIC X(54) VALUE SPACES.
  3186     05  FILLER      PIC X(18) VALUE 'STATE CALL EXTRACT'.
  3187     05  FILLER      PIC X(47) VALUE SPACES.
  3188     05  FILLER      PIC X(06) VALUE 'ECS158'.
  3189     05  FILLER      PIC X(06) VALUE SPACES.
  3190
  3191 01  HEAD-2.
  3192     05  FILLER      PIC X(47) VALUE SPACES.
  3193     05  HD-CLIENT   PIC X(30) VALUE SPACES.
  3194     05  FILLER      PIC X(42) VALUE SPACES.
  3195     05  HD-DATE     PIC X(08) VALUE SPACES.
  3196     05  FILLER      PIC X(05) VALUE SPACES.
  3197
  3198 01  HEAD-3.
  3199     05  FILLER      PIC X(53) VALUE SPACES.
  3200     05  HD-ALF-DTE  PIC X(18) VALUE SPACES.
  3201     05  FILLER      PIC X(41) VALUE SPACES.
  3202     05  FILLER      PIC X(05) VALUE 'PAGE'.
  3203     05  HD-PAGE     PIC ZZ,ZZZ.
  3204
  3205 01  HEAD-4.
  3206     12  FILLER      PIC X(50)   VALUE
  3207        ' CARR GROUP STATE ACCOUNT    CERTIFICATE EFF-DT   '.
  3208     12  FILLER      PIC X(55)   VALUE
  3209        '   BENEFIT     PREMIUM  TERM  REM TERM    UNEARN    L/A'.
  3210     12  FILLER      PIC X(25)   VALUE
  3211        '   BENEFIT DES  PRIM PREM'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS158.cbl
  3213 01  DETAIL-1.
  3214     12  FILLER      PIC X(02)   VALUE SPACES.
  3215     12  D-CARR      PIC X(01)   VALUE SPACES.
  3216     12  FILLER      PIC X(03)   VALUE SPACES.
  3217     12  D-GROUP     PIC X(06)   VALUE SPACES.
  3218     12  FILLER      PIC X(02)   VALUE SPACES.
  3219     12  D-STATE     PIC X(02)   VALUE SPACES.
  3220     12  FILLER      PIC X(02)   VALUE SPACES.
  3221     12  D-ACCOUNT   PIC X(10)   VALUE SPACES.
  3222     12  FILLER      PIC X(01)   VALUE SPACES.
  3223     12  D-CERT-NO   PIC X(11)   VALUE SPACES.
  3224     12  FILLER      PIC X(01)   VALUE SPACES.
  3225     12  D-EFF-DATE  PIC X(08)   VALUE SPACES.
  3226     12  FILLER      PIC X(01)   VALUE SPACES.
  3227     12  D-BENEFIT   PIC Z(9).99 VALUE ZEROS.
  3228     12  FILLER      PIC X(01)   VALUE SPACES.
  3229     12  D-PREM      PIC Z(7).99 VALUE ZEROS.
  3230     12  FILLER      PIC X(02)   VALUE SPACES.
  3231     12  D-TERM      PIC ZZ9     VALUE ZEROS.
  3232     12  FILLER      PIC X(04)   VALUE SPACES.
  3233     12  D-REM-TERM  PIC ZZ9     VALUE ZEROS.
  3234     12  FILLER      PIC X(05)   VALUE SPACES.
  3235     12  D-UNEARN    PIC Z(7).99 VALUE ZEROS.
  3236     12  FILLER      PIC X(03)   VALUE SPACES.
  3237     12  D-L-A       PIC X(01)   VALUE SPACES.
  3238     12  FILLER      PIC X(05)   VALUE SPACES.
  3239     12  D-BEN-DESC  PIC X(10)   VALUE SPACES.
  3240     12  FILLER      PIC X(01)   VALUE SPACES.
  3241     12  D-PRI-PREM  PIC Z(7).99 VALUE ZEROS.
  3242
  3243 01  HEAD-1B.
  3244     05  FILLER      PIC X(54) VALUE SPACES.
  3245     05  FILLER      PIC X(18) VALUE 'STATE CALL EXTRACT'.
  3246     05  FILLER      PIC X(47) VALUE SPACES.
  3247     05  FILLER      PIC X(07) VALUE 'ECS158B'.
  3248     05  FILLER      PIC X(06) VALUE SPACES.
  3249
  3250 01  HEAD-2B.
  3251     05  FILLER      PIC X(47) VALUE SPACES.
  3252     05  HD2B-CLIENT PIC X(30) VALUE SPACES.
  3253     05  FILLER      PIC X(42) VALUE SPACES.
  3254     05  HD2B-DATE   PIC X(08) VALUE SPACES.
  3255     05  FILLER      PIC X(05) VALUE SPACES.
  3256
  3257 01  HEAD-3B.
  3258     05  FILLER      PIC X(53) VALUE SPACES.
  3259     05  HD3B-ALF-DTE PIC X(18) VALUE SPACES.
  3260     05  FILLER      PIC X(41) VALUE SPACES.
  3261     05  FILLER      PIC X(05) VALUE 'PAGE'.
  3262     05  HD3B-PAGE   PIC ZZ,ZZZ.
  3263
  3264 01  HEAD-4B.
  3265     12  FILLER      PIC X(50)   VALUE
  3266        ' CARR GROUP STATE ACCOUNT    CERTIFICATE EFF-DT   '.
  3267     12  FILLER      PIC X(55)   VALUE
  3268        ' LIFE AMT       AH AMT                              L/A'.
  3269     12  FILLER      PIC X(25)   VALUE
  3270        '                         '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS158.cbl
  3272 01  DETAIL-1B.
  3273     12  FILLER      PIC X(02)   VALUE SPACES.
  3274     12  DB-CARR     PIC X(01)   VALUE SPACES.
  3275     12  FILLER      PIC X(03)   VALUE SPACES.
  3276     12  DB-GROUP    PIC X(06)   VALUE SPACES.
  3277     12  FILLER      PIC X(02)   VALUE SPACES.
  3278     12  DB-STATE    PIC X(02)   VALUE SPACES.
  3279     12  FILLER      PIC X(02)   VALUE SPACES.
  3280     12  DB-ACCOUNT  PIC X(10)   VALUE SPACES.
  3281     12  FILLER      PIC X(01)   VALUE SPACES.
  3282     12  DB-CERT-NO  PIC X(11)   VALUE SPACES.
  3283     12  FILLER      PIC X(01)   VALUE SPACES.
  3284     12  DB-EFF-DATE PIC X(08)   VALUE SPACES.
  3285     12  FILLER      PIC X(01)   VALUE SPACES.
  3286     12  DB-CLAIML   PIC Z(9).99 VALUE ZEROS.
  3287     12  FILLER      PIC X(03)   VALUE SPACES.
  3288     12  DB-CLAIMA   PIC Z(6).99 VALUE ZEROS.
  3289     12  FILLER      PIC X(02)   VALUE SPACES.
  3290     12  FILLER      PIC X(03)   VALUE SPACES.
  3291     12  FILLER      PIC X(04)   VALUE SPACES.
  3292     12  FILLER      PIC X(03)   VALUE SPACES.
  3293     12  FILLER      PIC X(05)   VALUE SPACES.
  3294     12  FILLER      PIC X(10)   VALUE SPACES.
  3295     12  FILLER      PIC X(03)   VALUE SPACES.
  3296     12  DB-L-A      PIC X(01)   VALUE SPACES.
  3297     12  FILLER      PIC X(05)   VALUE SPACES.
  3298     12  FILLER      PIC X(10)   VALUE SPACES.
  3299     12  FILLER      PIC X(01)   VALUE SPACES.
  3300     12  FILLER      PIC X(10)   VALUE SPACES.
  3301
  3302 01  DISPLAY-LINE.
  3303     12  FILLER             PIC X(05) VALUE SPACES.
  3304     12  DISPLAY-MESS       PIC X(30) VALUE SPACES.
  3305     12  FILLER             PIC X(03) VALUE SPACES.
  3306     12  DISPLAY-COUNT      PIC ZZ,ZZZ,ZZZ VALUE ZEROS.
  3307
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS158.cbl
* 3309                                 COPY ELCDATE.
  3310******************************************************************06/11/98
  3311*                                                                *ELCDATE
  3312*                                                                *ELCDATE
  3313*                            ELCDATE.                            *   LV023
  3314*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  3315*                            VMOD=2.003                           ELCDATE
  3316*                                                                *ELCDATE
  3317*                                                                *ELCDATE
  3318*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  3319*                 LENGTH = 200                                   *   CL*19
  3320******************************************************************ELCDATE
  3321                                                                  ELCDATE
  3322 01  DATE-CONVERSION-DATA.                                        ELCDATE
  3323     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  3324     12  DC-OPTION-CODE                PIC X.                        CL*15
  3325         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  3326         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  3327         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  3328         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  3329         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  3330         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  3331         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  3332         88  FIND-CENTURY               VALUE '7'.                   CL*22
  3333         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  3334         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  3335         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  3336         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  3337         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  3338         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  3339         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  3340         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  3341         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  3342         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  3343         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  3344         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  3345         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  3346         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  3347         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  3348         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  3349         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  3350         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  3351         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  3352         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  3353         88  THREE-CHARACTER-BIN                                  ELCDATE
  3354                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  3355         88  GREGORIAN-TO-BIN                                        CL**2
  3356                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  3357         88  BIN-TO-GREGORIAN                                        CL**2
  3358                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  3359         88  JULIAN-TO-BINARY                                        CL**2
  3360                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  3361     12  DC-ERROR-CODE                 PIC X.                        CL*15
  3362         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  3363         88  DATE-CONVERSION-ERROR                                ELCDATE
  3364                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  3365         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  3366         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3367         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  3368         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  3369         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  3370         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  3371         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  3372         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  3373         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  3374         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  3375     12  DC-END-OF-MONTH               PIC X.                        CL*15
  3376         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  3377     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  3378         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  3379         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  3380         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  3381     12  FILLER                        PIC X.                        CL*15
  3382     12  DC-CONVERSION-DATES.                                        CL*15
  3383         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  3384         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  3385         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  3386         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  3387                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  3388             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  3389             20  SLASH1-1              PIC X.                        CL*15
  3390             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  3391             20  SLASH1-2              PIC X.                        CL*15
  3392             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  3393         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  3394         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  3395                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  3396             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  3397             20  SLASH2-1              PIC X.                        CL*15
  3398             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  3399             20  SLASH2-2              PIC X.                        CL*15
  3400             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  3401         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  3402         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  3403                     DC-GREG-DATE-1-YMD.                          ELCDATE
  3404             20  DC-YMD-YEAR           PIC 99.                       CL*15
  3405             20  DC-YMD-MONTH          PIC 99.                       CL*15
  3406             20  DC-YMD-DAY            PIC 99.                       CL*15
  3407         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  3408         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  3409                      DC-GREG-DATE-1-MDY.                         ELCDATE
  3410             20  DC-MDY-MONTH          PIC 99.                       CL*15
  3411             20  DC-MDY-DAY            PIC 99.                       CL*15
  3412             20  DC-MDY-YEAR           PIC 99.                       CL*15
  3413         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  3414             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  3415             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  3416             20  FILLER                PIC XX.                       CL*15
  3417             20  DC-ALPHA-CENTURY.                                   CL*15
  3418                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  3419             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  3420         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  3421         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  3422         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  3423         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  3424         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3425                                       PIC 9(05).                    CL*20
  3426         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  3427             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  3428             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  3429         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  3430         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  3431         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  3432     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  3433         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  3434         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  3435             20  FILLER                PIC 9(3).                     CL*15
  3436             20  HOLD-CEN-1-CCYY.                                    CL*15
  3437                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  3438                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  3439             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  3440             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  3441         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  3442             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  3443             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  3444             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  3445                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  3446                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  3447             20  FILLER                PIC 9(3).                     CL*15
  3448         16  HOLD-CENTURY-1-X.                                       CL*15
  3449             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  3450             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  3451                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  3452                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  3453             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  3454             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  3455         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  3456             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  3457             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  3458             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  3459                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  3460                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  3461             20  FILLER                PIC XXX.                      CL*23
  3462         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  3463         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  3464         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  3465         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  3466             20  DC-JULIAN-1-CCYY.                                   CL*15
  3467                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  3468                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  3469             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  3470         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  3471         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  3472             20  DC-JULIAN-2-CCYY.                                   CL*15
  3473                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  3474                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  3475             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  3476         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  3477             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  3478             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  3479             20  DC-EDITA-DAY          PIC 99.                       CL*15
  3480             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  3481             20  DC-EDITA-CCYY.                                      CL*15
  3482                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDATE)
  3483                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  3484         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  3485             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  3486             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  3487             20  DC-EDITB-DAY          PIC 99.                       CL*15
  3488             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  3489             20  DC-EDITB-CCYY.                                      CL*15
  3490                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  3491                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  3492         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  3493         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  3494                              DC-GREG-DATE-CYMD.                  ELCDATE
  3495             20  DC-CYMD-CEN           PIC 99.                       CL*15
  3496             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  3497             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  3498             20  DC-CYMD-DAY           PIC 99.                       CL*15
  3499         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  3500         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  3501                              DC-GREG-DATE-MDCY.                  ELCDATE
  3502             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  3503             20  DC-MDCY-DAY           PIC 99.                       CL*15
  3504             20  DC-MDCY-CEN           PIC 99.                       CL*15
  3505             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  3506    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  3507        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  3508    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  3509    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS158.cbl
  3511
* 3512                                 COPY ELCDTECX.
  3513******************************************************************06/05/98
  3514*                                                                *ELCDTECX
  3515*                            ELCDTECX.                           *   LV005
  3516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3517*                            VMOD=2.015                          *ELCDTECX
  3518*                                                                *ELCDTECX
  3519*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  3520*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  3521*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  3522*                                                                *ELCDTECX
  3523******************************************************************ELCDTECX
  3524******************************************************************
  3525*                   C H A N G E   L O G
  3526*
  3527* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3528*-----------------------------------------------------------------
  3529*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3530* EFFECTIVE    NUMBER
  3531*-----------------------------------------------------------------
  3532* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  3533*                                  BENEFIT CODES FROM 300 TO 900
  3534* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  3535* 051304    2003080800002  SMVA  ADD REFUND METHOD
  3536* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  3537******************************************************************
  3538 01  DATE-CARD.                                                   ELCDTECX
  3539     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  3540     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  3541     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  3542     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  3543     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  3544     12  EP-SW                       PIC  X.                      ELCDTECX
  3545         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  3546     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  3547         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  3548     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  3549     12  RUN-CENTURY.                                             ELCDTECX
  3550         16 RUN-CENTURY-N            PIC  99.                        CL**4
  3551     12  FILLER                      PIC  X.                         CL**4
  3552     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  3553     12  FILLER                      PIC  XXX.                    ELCDTECX
  3554     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  3555                                                                  ELCDTECX
  3556 01  FILLER                          PIC  X(7)                       CL**6
  3557                                          VALUE 'OPTIONS'.        ELCDTECX
  3558 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  3559     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  3560     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  3561     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  3562         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  3563         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  3564     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  3565     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  3566     12  FILLER                      PIC  X.                      ELCDTECX
  3567     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  3568     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3569     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  3570     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  3571     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  3572     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  3573     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  3574     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  3575     12  FILLER                      PIC  X.                      ELCDTECX
  3576     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  3577     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  3578     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  3579     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  3580     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  3581     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  3582     12  FILLER                      PIC  X.                      ELCDTECX
  3583     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  3584     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  3585     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  3586     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  3587     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  3588     12  DTE-R78                     PIC  X.                      ELCDTECX
  3589     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  3590     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  3591     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  3592     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  3593     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  3594     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  3595     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  3596                                     PIC  X.                      ELCDTECX
  3597         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  3598                                                 ' '.             ELCDTECX
  3599         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  3600         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  3601     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  3602         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  3603         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  3604     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  3605     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  3606                                     PIC  9.                         CL**4
  3607     12  DTE-SYSTEM.                                              ELCDTECX
  3608         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  3609         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  3610         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  3611         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  3612         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  3613         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  3614         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3615         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3616         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3617         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3618         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3619         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3620         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3621         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3622         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3623         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3624         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3625         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3626         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3627         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3628         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3629         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  3630         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3631         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3632         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3633         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3634     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3635         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3636                                     PIC  X.                      ELCDTECX
  3637     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3638                                                                  ELCDTECX
  3639 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3640     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3641     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3642     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3643*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3644     12  FILLER                      PIC  X.                      ELCDTECX
  3645     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3646     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3647     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3648     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3649     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3650     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3651     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3652                                                                  ELCDTECX
  3653     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3654     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3655     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3656     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3657                                                                  ELCDTECX
  3658     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3659     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3660     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3661     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3662                                                                  ELCDTECX
  3663     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3664     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3665                                                                  ELCDTECX
  3666     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3667     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3668                                                                  ELCDTECX
  3669     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3670                                                                  ELCDTECX
  3671 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3672     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3673     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3674     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3675     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3676     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3677     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3678     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3679                                                                  ELCDTECX
  3680 01  FILLER                          PIC  X(12)                   ELCDTECX
  3681                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3682 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3683     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3684         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3685         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3686                                                                  ELCDTECX
  3687 01  FILLER                          PIC  X(11)                   ELCDTECX
  3688                                          VALUE 'STATE NAMES'.    ELCDTECX
  3689 01  STATE-NAMES.                                                 ELCDTECX
  3690     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3691         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3692         16  STATE-PIC1.                                          ELCDTECX
  3693             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3694             20  FILLER              PIC  XXX.                    ELCDTECX
  3695             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3696             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3697             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3698             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3699                                                                  ELCDTECX
  3700 01  FILLER                          PIC  X(13)                   ELCDTECX
  3701                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3702 01  CARRIER-NAMES.                                               ELCDTECX
  3703     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3704         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3705         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3706         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3707         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3708         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3709         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3710*        16  FILLER                  PIC  X.                      ELCDTECX
  3711         16  CARRIER-SEC-PAY         PIC  X.
  3712             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3713                                                                  ELCDTECX
  3714 01  FILLER                          PIC  X(9)                       CL**6
  3715                                          VALUE 'INS TYPES'.      ELCDTECX
  3716 01  CLAS-INS-TYPES.                                              ELCDTECX
  3717*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3718     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3719         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3720         16  CLAS-I-AB3.                                          ELCDTECX
  3721             20  FILLER              PIC  X.                      ELCDTECX
  3722             20  CLAS-I-AB2.                                      ELCDTECX
  3723                 24  FILLER          PIC  X.                      ELCDTECX
  3724                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3725         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3726             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3727             20  FILLER              PIC  X.                         CL**4
  3728         16  CLAS-I-AB10.                                         ELCDTECX
  3729             20  FILLER              PIC  X(9).                   ELCDTECX
  3730             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3731         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3732         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3733         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3734         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3735             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3736         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3737         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3738         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3739         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3740         16  CLAS-I-REFUND-METHOD    PIC  X.
  3741         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3742         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3743                                                                  ELCDTECX
  3744 01  FILLER                          PIC  X(16)                   ELCDTECX
  3745                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  3746 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3747     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3748                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3749         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3750         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3751         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3752         16  CLAS-MORT-DESC.                                      ELCDTECX
  3753             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3754             20  FILLER              PIC  XX.                        CL**5
  3755             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3756             20  FILLER              PIC  X.                         CL**5
  3757             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3758             20  FILLER              PIC  X.                         CL**5
  3759             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3760             20  FILLER              PIC  X.                         CL**5
  3761             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3762             20  FILLER              PIC  X(5).                      CL**6
  3763                                                                  ELCDTECX
  3764 01  FILLER                          PIC  X(15)                   ELCDTECX
  3765                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3766 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3767     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3768         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3769         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3770         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3771         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3772         16  FILLER                  PIC  X(4).                      CL**6
  3773                                                                  ELCDTECX
  3774 01  FILLER                          PIC  X(7)                       CL**6
  3775                                     VALUE 'INDEXES'.             ELCDTECX
  3776 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3777     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3778     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3779     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3780     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3781     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3782     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3783     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3784     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3785     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3786     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3787     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3788     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3789     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3790     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3791     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3792     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3793     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3794                                                                  ELCDTECX
  3795 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3796     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3797     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3798     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3799     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3800     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3801     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3802     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3803     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  3804     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3805     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3806     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3807                                                                  ELCDTECX
  3808 01  FILLER                          PIC  X(13)                   ELCDTECX
  3809                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3810 01  CLAS-MISC.                                                   ELCDTECX
  3811     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3812         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3813         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3814         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3815     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3816     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3817     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3818     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3819     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3820     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3821     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3822     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3823     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3824     12  STATE-L                     PIC  XX.                     ELCDTECX
  3825     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3826     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3827     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3828         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3829         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3830     12  DTE-ABEND-WORK.                                          ELCDTECX
  3831         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3832         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3833                                                                  ELCDTECX
  3834 01  FILLER                          PIC  X(12)                   ELCDTECX
  3835                                     VALUE 'WORKING DATE'.        ELCDTECX
  3836 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3837     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3838         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3839         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3840         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3841     12  WS-CURRENT-DATE.                                         ELCDTECX
  3842         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3843         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3844         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3845         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3846         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3847     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3848         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3849         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3850                                                                  ELCDTECX
  3851 01  FILLER                          PIC  X(12)                   ELCDTECX
  3852                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3853 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3854     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3855         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3856         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3857         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3858                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3859 01  FILLER                          PIC  X(10)                   ELCDTECX
  3860                                     VALUE 'STATE TLRS'.          ELCDTECX
  3861 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  3862     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3863         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3864         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3865                                                                  ELCDTECX
  3866 01  FILLER                          PIC  X(13)                   ELCDTECX
  3867                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3868 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3869     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3870         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3871                                                                  ELCDTECX
  3872 01  FILLER                          PIC  X(13)                   ELCDTECX
  3873                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3874 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3875     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3876     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3877     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3878                                     PIC  X.                         CL**5
  3879     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3880     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3881     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3882     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3883     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3884     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3885     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3886     12  FILLER                      PIC  X(75).                  ELCDTECX
  3887******************************************************************ELCDTECX
  3888*01  MISC-CARR-PCT-DATA.                                          00001521
  3889*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3890*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3891*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3892*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3893*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3894*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3895******************************************************************ELCDTECX
  3896
* 3897                                 COPY ELCDTEVR.
  3898***************************************************************** 04/15/98
  3899*                                                                *ELCDTEVR
  3900*                                                                *ELCDTEVR
  3901*                            ELCDTEVR.                           *   LV003
  3902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3903*                            VMOD=2.001                          *   CL**2
  3904*                                                                *ELCDTEVR
  3905*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3906*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3907*                                                                *ELCDTEVR
  3908******************************************************************ELCDTEVR
  3909 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3910     05  WS-RUN-DATE.                                             ELCDTEVR
  3911         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3912         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3913         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3914             15  RUN-CC              PIC  99.                     ELCDTEVR
  3915             15  RUN-YR              PIC  99.                     ELCDTEVR
  3916         10  RUN-MO                  PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3917         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3918     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3919            WS-RUN-DATE              PIC 9(11).                      CL**2
  3920     05  WS-EP-DT.                                                ELCDTEVR
  3921         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3922         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3923         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3924             15  EP-CC               PIC  99.                     ELCDTEVR
  3925             15  EP-YR               PIC  99.                     ELCDTEVR
  3926         10  EP-MO                   PIC  99.                     ELCDTEVR
  3927         10  EP-DA                   PIC  99.                     ELCDTEVR
  3928     05  WS-EP-DT-N REDEFINES                                        CL**2
  3929            WS-EP-DT                 PIC 9(11).                      CL**2
  3930     05  WS-DTE-CONV-DT.                                             CL**4
  3931         10  FILLER                  PIC  9(03).                     CL**4
  3932         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3933         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3934             15  DTE-CONV-CC         PIC  99.                        CL**4
  3935             15  DTE-CONV-YR         PIC  99.                        CL**4
  3936         10  DTE-CONV-MO             PIC  99.                        CL**4
  3937         10  DTE-CONV-DA             PIC  99.                        CL**4
  3938     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3939            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3940 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3941     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3942         10  FILLER                            PIC 999.           ELCDTEVR
  3943         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3944         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3945             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3946             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3947         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3948         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3949     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3950            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3951     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3952         10  FILLER                            PIC 999.           ELCDTEVR
  3953         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3954         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3955         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3956         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3957     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3958            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3959 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3960     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3961         10  FILLER                            PIC 999.           ELCDTEVR
  3962         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3963         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3964             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3965             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3966         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3967         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3968     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3969            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3970     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3971         10  FILLER                            PIC 999.           ELCDTEVR
  3972         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3973         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3974             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3975             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3976         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3977         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  3978     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3979            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3980     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3981         10  FILLER                            PIC 999.           ELCDTEVR
  3982         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3983         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3984             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3985             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3986         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3987         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3988     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3989            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3990 01  WS-RATE-RECORD.                                              ELCDTEVR
  3991         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3992             10  FILLER                        PIC 999.           ELCDTEVR
  3993             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3994             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3995                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3996                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3997             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3998             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3999         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  4000                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  4001
* 4002                                 COPY ELCCRTVR.
  4003***************************************************************** 04/24/98
  4004*                                                                *ELCCRTVR
  4005*                                                                *ELCCRTVR
  4006*                            ELCCRTVR                            *   LV003
  4007*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4008*                            VMOD=2.001                          *ELCCRTVR
  4009*                                                                *ELCCRTVR
  4010*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  4011*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  4012*                                                                *ELCCRTVR
  4013******************************************************************ELCCRTVR
  4014                                                                  ELCCRTVR
  4015 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  4016     05  WS-CR-DT.                                                ELCCRTVR
  4017         10  FILLER                PIC 999.                       ELCCRTVR
  4018         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  4019         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  4020             15  CR-CC             PIC 99.                        ELCCRTVR
  4021             15  CR-YR             PIC 99.                        ELCCRTVR
  4022         10  CR-MO                 PIC 99.                        ELCCRTVR
  4023         10  CR-DA                 PIC 99.                        ELCCRTVR
  4024     05  WS-CR-DT-N REDEFINES                                        CL**2
  4025            WS-CR-DT               PIC 9(11).                        CL**2
  4026     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  4027         10  FILLER                    PIC 999.                   ELCCRTVR
  4028         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4029         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  4030             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4031             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4032         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4033         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4034     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  4035            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  4036     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  4037         10  FILLER                    PIC 999.                   ELCCRTVR
  4038         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  4039         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  4040             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  4041             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  4042         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  4043         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  4044     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  4045            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  4046     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  4047         10  FILLER                    PIC 999.                   ELCCRTVR
  4048         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  4049         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  4050             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  4051             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  4052         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  4053         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  4054     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  4055            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  4056     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  4057         10  FILLER                    PIC 999.                   ELCCRTVR
  4058         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4059         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  4060             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  4061             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  4062         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  4063         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  4064     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  4065            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  4066     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  4067         10  FILLER                    PIC 999.                   ELCCRTVR
  4068         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4069         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  4070             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  4071             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  4072         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  4073         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  4074     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4075            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4076     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  4077         10  FILLER                    PIC 999.                   ELCCRTVR
  4078         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4079         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  4080             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  4081             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  4082         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  4083         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  4084     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  4085            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  4086     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  4087         10  FILLER                    PIC 999.                   ELCCRTVR
  4088         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  4089         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  4090             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4091             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  4092         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  4093         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  4094     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  4095            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  4096     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  4097         10  FILLER                    PIC 999.                   ELCCRTVR
  4098         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  4099         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  4100             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  4101             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  4102         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  4103         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  4104     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  4105            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  4106     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  4107         10  FILLER                    PIC 999.                   ELCCRTVR
  4108         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  4109         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  4110             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  4111             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  4112         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  4113         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  4114     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  4115          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  4116     05  WS-CR-DTH-DT.                                            ELCCRTVR
  4117         10  FILLER                    PIC 999.                   ELCCRTVR
  4118         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  4119         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  4120             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  4121             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  4122         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  4123         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  4124     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  4125            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  4126     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  4127         10  FILLER                    PIC 999.                   ELCCRTVR
  4128         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  4129         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  4130             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  4131             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  4132         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  4133         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  4134     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  4135            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  4136     05  WS-CR-DIS-DT.                                            ELCCRTVR
  4137         10  FILLER                    PIC 999.                   ELCCRTVR
  4138         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  4139         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  4140             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  4141             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  4142         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  4143         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  4144     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  4145            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  4146     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  4147         10  FILLER                    PIC 999.                   ELCCRTVR
  4148         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS158.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  4149         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  4150             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  4151             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  4152         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  4153         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  4154     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  4155            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  4156     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  4157         10  FILLER                    PIC 999.                   ELCCRTVR
  4158         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  4159         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  4160             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  4161             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  4162         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  4163         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  4164     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  4165            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  4166     05  COPY-NDX                      PIC 9.                        CL**6
  4167     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  4168         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  4169             15  FILLER                PIC 999.                   ELCCRTVR
  4170             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  4171             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  4172                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  4173                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  4174             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  4175             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  4176         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  4177                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  4178
* 4179                                 COPY ELCEXTVR.
  4180******************************************************************04/15/98
  4181*                                                                *ELCEXTVR
  4182*                                                                *ELCEXTVR
  4183*                             ELCEXTVR                           *   LV002
  4184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4185*                            VMOD=2.001                          *ELCEXTVR
  4186*                                                                *ELCEXTVR
  4187*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  4188*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  4189*                                                                *ELCEXTVR
  4190******************************************************************ELCEXTVR
  4191 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  4192     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  4193         10  FILLER              PIC 999.                         ELCEXTVR
  4194         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  4195         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  4196             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  4197             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  4198         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  4199         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  4200     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  4201            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  4202 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  4203     05  WS-DE-EFF.                                               ELCEXTVR
  4204         10  FILLER              PIC 999.                         ELCEXTVR
  4205         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  4206         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4207             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  4208             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  4209         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  4210         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  4211     05  WS-DE-EFF-N REDEFINES                                       CL**2
  4212            WS-DE-EFF            PIC 9(11).                          CL**2
  4213     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  4214         10  FILLER              PIC 999.                         ELCEXTVR
  4215         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  4216         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  4217             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  4218             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  4219         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  4220         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  4221     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  4222            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  4223     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  4224         10  FILLER                 PIC 999.                      ELCEXTVR
  4225         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  4226         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  4227             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  4228             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  4229         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  4230         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  4231     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  4232            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  4233     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  4234         10  FILLER                 PIC 999.                      ELCEXTVR
  4235         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  4236         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
  4237             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  4238             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  4239         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  4240         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  4241     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  4242            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  4243     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  4244         10  FILLER                 PIC 999.                      ELCEXTVR
  4245         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  4246         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  4247             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  4248             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  4249         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  4250         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  4251     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  4252            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  4253     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  4254         10  FILLER                 PIC 999.                      ELCEXTVR
  4255         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  4256         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  4257             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  4258             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  4259         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  4260         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  4261     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  4262            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  4263     05  WS-DE-PROC-DT.                                           ELCEXTVR
  4264         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4265         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  4266         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  4267             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  4268             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  4269         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  4270         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  4271     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  4272            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  4273     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  4274         10  FILLER                 PIC 999.                         CL**5
  4275         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  4276         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  4277             15  DE-CP-CC           PIC 99.                          CL**5
  4278             15  DE-CP-YR           PIC 99.                          CL**5
  4279         10  DE-CP-MO               PIC 99.                          CL**5
  4280         10  DE-CP-DA               PIC 99.                          CL**5
  4281     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  4282            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  4283     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  4284         10  FILLER                 PIC 999.                         CL**5
  4285         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  4286         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  4287             15  DE-RP-CC           PIC 99.                          CL**5
  4288             15  DE-RP-YR           PIC 99.                          CL**5
  4289         10  DE-RP-MO                      PIC 99.                   CL**5
  4290         10  DE-RP-DA                      PIC 99.                   CL**5
  4291     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  4292            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  4293     05  WS-DE-INCUR.                                             ELCEXTVR
  4294         10  FILLER                 PIC 999.                      ELCEXTVR
  4295         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  4296         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  4297             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  4298             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  4299         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  4300         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  4301     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  4302            WS-DE-INCUR             PIC 9(11).                       CL**2
  4303     05  WS-DE-PAY.                                               ELCEXTVR
  4304         10  FILLER                 PIC 999.                      ELCEXTVR
  4305         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  4306         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  4307             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  4308             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  4309         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  4310         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  4311     05  WS-DE-PAY-N REDEFINES                                       CL**2
  4312            WS-DE-PAY               PIC 9(11).                       CL**2
  4313     05  WS-DE-PAID-TO.                                           ELCEXTVR
  4314         10  FILLER                 PIC 999.                      ELCEXTVR
  4315         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  4316         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  4317             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  4318             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  4319         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  4320         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  4321     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  4322            WS-DE-PAID-TO           PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4323     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  4324         10 FILLER                  PIC 999.                      ELCEXTVR
  4325         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  4326         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  4327            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  4328            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  4329         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  4330         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  4331     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  4332            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  4333     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  4334         10 FILLER                  PIC 999.                      ELCEXTVR
  4335         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  4336         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  4337            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  4338            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  4339         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  4340         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  4341     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  4342            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  4343     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  4344         10  FILLER                 PIC 999.                      ELCEXTVR
  4345         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  4346         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  4347             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  4348             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  4349         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  4350         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  4351     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  4352            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
  4353     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  4354         10  FILLER                 PIC 999.                      ELCEXTVR
  4355         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  4356         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  4357             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  4358             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  4359         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  4360         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  4361     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  4362            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  4363     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  4364         10  FILLER                        PIC 999.               ELCEXTVR
  4365         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  4366         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  4367                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  4368             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  4369             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  4370         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  4371         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  4372     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  4373            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  4374     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  4375         10  FILLER                        PIC 999.               ELCEXTVR
  4376         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  4377         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  4378                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  4379             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  4380             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  4381         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  4382         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  4383     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  4384            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  4385                                                                     CL**5
  4386
* 4387                                 COPY ELCACCTV.
  4388******************************************************************04/14/98
  4389*                                                                *ELCACCTV
  4390*                            ELCACCTV                            *   LV002
  4391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4392*                            VMOD=2.001                          *ELCACCTV
  4393*                                                                *ELCACCTV
  4394*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  4395*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  4396*                                                                *ELCACCTV
  4397*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  4398*                                                                *ELCACCTV
  4399******************************************************************ELCACCTV
  4400                                                                  ELCACCTV
  4401 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  4402                                                                  ELCACCTV
  4403     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  4404         10  FILLER            PIC 999.                           ELCACCTV
  4405         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  4406         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  4407             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  4408             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  4409         10  AM-EXP-MO         PIC 99.                               CL**5
  4410         10  AM-EXP-DA         PIC 99.                               CL**5
  4411     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  4412            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  4413     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  4414         10  FILLER                    PIC 999.                   ELCACCTV
  4415         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  4416         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  4417             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  4418             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  4419         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  4420         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  4421     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  4422            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  4423     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  4424         10  FILLER                    PIC 999.                   ELCACCTV
  4425         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  4426         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  4427             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  4428             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  4429         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  4430         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  4431     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  4432            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  4433     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  4434         10 FILLER                     PIC 999.                   ELCACCTV
  4435         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  4436         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  4437            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  4438            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS158.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  4439         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  4440         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  4441     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  4442            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  4443     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  4444         10 FILLER                     PIC 999.                   ELCACCTV
  4445         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  4446         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  4447            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  4448            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  4449         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  4450         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  4451     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  4452            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  4453     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  4454         10  FILLER                    PIC 999.                   ELCACCTV
  4455         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  4456         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  4457             15  AM-AN-CC              PIC 99.                    ELCACCTV
  4458             15  AM-AN-YR              PIC 99.                    ELCACCTV
  4459         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  4460         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  4461     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  4462            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  4463     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  4464         10  FILLER                    PIC 999.                   ELCACCTV
  4465         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  4466         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  4467             15  AM-HI-CC              PIC 99.                    ELCACCTV
  4468             15  AM-HI-YR              PIC 99.                    ELCACCTV
  4469         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  4470         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  4471     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  4472            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  4473     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  4474         10  FILLER                    PIC 999.                   ELCACCTV
  4475         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  4476         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  4477             15  AM-LO-CC              PIC 99.                    ELCACCTV
  4478             15  AM-LO-YR              PIC 99.                    ELCACCTV
  4479         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  4480         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  4481     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  4482            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  4483     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  4484         10  FILLER                    PIC 999.                   ELCACCTV
  4485         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  4486         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  4487             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  4488             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  4489         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  4490         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  4491     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  4492            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  4493
* 4494                                 COPY ELCPSEVR.
  4495******************************************************************04/16/98
  4496*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  4497*                                                                *ELCPSEVR
  4498*                            ELCPSEVR                            *   LV003
  4499*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4500*                            VMOD=2.001                          *ELCPSEVR
  4501*                                                                *ELCPSEVR
  4502*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  4503*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  4504*                                                                *ELCPSEVR
  4505******************************************************************ELCPSEVR
  4506                                                                  ELCPSEVR
  4507 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  4508     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  4509         10  FILLER               PIC 999.                        ELCPSEVR
  4510         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  4511         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  4512             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  4513             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  4514         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  4515         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  4516     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  4517            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  4518     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  4519         10  FILLER              PIC 999.                         ELCPSEVR
  4520         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  4521         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  4522             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  4523             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  4524         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  4525         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  4526     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  4527            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  4528 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  4529     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  4530                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  4531         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  4532             15  FILLER              PIC 999.                     ELCPSEVR
  4533             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  4534             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  4535                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  4536                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  4537             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  4538             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  4539         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  4540                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  4541         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  4542             15  FILLER              PIC 999.                     ELCPSEVR
  4543             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  4544             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  4545                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  4546                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  4547             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  4548             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  4549         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  4550                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  4551         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  4552             15  FILLER              PIC 999.                     ELCPSEVR
  4553             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  4554             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  4555                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  4556                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  4557             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  4558             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  4559         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  4560                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  4561     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  4562         10  FILLER              PIC 999.                         ELCPSEVR
  4563         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  4564         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  4565             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  4566             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  4567         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  4568         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  4569     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  4570            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS158.cbl
  4572 PROCEDURE DIVISION.
  4573
  4574 0001-DT-CRD-READ SECTION.
* 4575                                 COPY ELCDTERX.
  4576******************************************************************04/15/98
  4577*                                                                *ELCDTERX
  4578*                                                                *ELCDTERX
  4579*                            ELCDTERX.                           *   LV002
  4580*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4581*                            VMOD=2.007                          *ELCDTERX
  4582*                                                                *ELCDTERX
  4583*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  4584*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  4585*      = ELCDTEFD)                                               *ELCDTERX
  4586*                                                                *ELCDTERX
  4587******************************************************************ELCDTERX
  4588                                                                  ELCDTERX
  4589     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  4590                                                                  ELCDTERX
  4591     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  4592     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  4593     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  4594                                                                  ELCDTERX
  4595     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  4596                                                                  ELCDTERX
  4597******************************************************************ELCDTERX
  4598*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  4599*          WARNING MESSAGES.                                      ELCDTERX
  4600******************************************************************ELCDTERX
  4601     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  4602         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  4603                                                                  ELCDTERX
  4604     OPEN INPUT DISK-DATE.                                        ELCDTERX
  4605                                                                  ELCDTERX
  4606     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  4607                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  4608                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  4609                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  4610                   CLAX-ID           CLAS-MISC                    ELCDTERX
  4611                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  4612                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  4613                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  4614                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  4615                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  4616                                                                  ELCDTERX
  4617     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  4618                                                                  ELCDTERX
  4619     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  4620                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  4621                                                                  ELCDTERX
  4622     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  4623     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  4624     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  4625     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  4626                                                                  ELCDTERX
  4627     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  4628         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  4629     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4630         ADD +1                 TO CLAS-CN.                       ELCDTERX
  4631                                                                  ELCDTERX
  4632     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  4633         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  4634     ELSE                                                         ELCDTERX
  4635         ADD +1                 TO CLAS-CO.                       ELCDTERX
  4636                                                                  ELCDTERX
  4637 0005-READ--CARD.                                                 ELCDTERX
  4638     READ DISK-DATE                                               ELCDTERX
  4639         AT END CLOSE DISK-DATE                                   ELCDTERX
  4640             GO TO 0060-READ--TEST.                               ELCDTERX
  4641                                                                  ELCDTERX
  4642     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  4643                                                                  ELCDTERX
  4644     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  4645         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  4646         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  4647         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  4648         GO TO 0005-READ--CARD.                                   ELCDTERX
  4649                                                                  ELCDTERX
  4650     IF DD-ID = 'CLAD'                                            ELCDTERX
  4651         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  4652         GO TO 0005-READ--CARD.                                   ELCDTERX
  4653                                                                  ELCDTERX
  4654     IF DD-ID = 'CLAX'                                            ELCDTERX
  4655         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  4656         GO TO 0005-READ--CARD.                                   ELCDTERX
  4657                                                                  ELCDTERX
  4658     IF DD-ID = 'CLAF'                                            ELCDTERX
  4659         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  4660         GO TO 0005-READ--CARD.                                   ELCDTERX
  4661                                                                  ELCDTERX
  4662     IF DD-ID = 'CLAC'                                            ELCDTERX
  4663         GO TO 0010-READ--CLAC.                                   ELCDTERX
  4664                                                                  ELCDTERX
  4665     IF DD-ID = 'CARR'                                            ELCDTERX
  4666         GO TO 0015-READ--CARR.                                   ELCDTERX
  4667                                                                  ELCDTERX
  4668     IF DD-ID = 'STAT'                                            ELCDTERX
  4669         GO TO 0020-READ--STAT.                                   ELCDTERX
  4670                                                                  ELCDTERX
  4671     IF DD-ID = 'BUSC'                                            ELCDTERX
  4672         GO TO 0025-READ--BUSC.                                   ELCDTERX
  4673                                                                  ELCDTERX
  4674     IF DD-ID = 'MORT'                                            ELCDTERX
  4675         GO TO 0030-READ--MORT.                                   ELCDTERX
  4676                                                                  ELCDTERX
  4677     IF DD-ID = 'CLAI'                                            ELCDTERX
  4678         GO TO 0040-READ--CLAI.                                   ELCDTERX
  4679                                                                  ELCDTERX
  4680     IF DD-ID = 'COLC'                                            ELCDTERX
  4681         GO TO 0065-READ--COLC.                                   ELCDTERX
  4682                                                                  ELCDTERX
  4683     IF DD-IDX NUMERIC AND                                        ELCDTERX
  4684        DD-IDA = 'CL'                                             ELCDTERX
  4685         GO TO 0035-READ--CLXX.                                   ELCDTERX
  4686                                                                  ELCDTERX
  4687     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4688        DD-IDA = 'PO'                                             ELCDTERX
  4689         GO TO 0050-READ--POXX.                                   ELCDTERX
  4690                                                                  ELCDTERX
  4691     IF DD-ID = 'OPCA'                                            ELCDTERX
  4692         GO TO 0070-READ--OPCA.                                   ELCDTERX
  4693                                                                  ELCDTERX
  4694     IF DD-ID = 'OPST'                                            ELCDTERX
  4695         GO TO 0072-READ--OPST.                                   ELCDTERX
  4696                                                                  ELCDTERX
  4697     IF DD-ID = 'OPBS'                                            ELCDTERX
  4698         GO TO 0074-READ--OPBS.                                   ELCDTERX
  4699                                                                  ELCDTERX
  4700     IF DD-ID = 'OPMS'                                            ELCDTERX
  4701         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  4702                                                                  ELCDTERX
  4703     GO TO 0005-READ--CARD.                                       ELCDTERX
  4704                                                                  ELCDTERX
  4705 0010-READ--CLAC.                                                 ELCDTERX
  4706     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4707     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4708     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4709     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  4710     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  4711     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  4712     GO TO 0005-READ--CARD.                                       ELCDTERX
  4713                                                                  ELCDTERX
  4714 0015-READ--CARR.                                                 ELCDTERX
  4715     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4716     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4717        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  4718        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4719        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  4720        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4721        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4722        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4723        MOVE DD-CARR1-SECPAY-SW
  4724                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4725     END-IF
  4726                                                                  ELCDTERX
  4727     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  4728     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  4729        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  4730        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  4731        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  4732        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  4733        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  4734        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  4735        MOVE DD-CARR2-SECPAY-SW
  4736                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  4737     END-IF
  4738                                                                  ELCDTERX
  4739                                                                  ELCDTERX
  4740     GO TO 0005-READ--CARD.                                       ELCDTERX
  4741                                                                  ELCDTERX
  4742 0020-READ--STAT.                                                 ELCDTERX
  4743     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4744     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4745        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4746         GO TO 0005-READ--CARD.                                   ELCDTERX
  4747                                                                  ELCDTERX
  4748     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  4749     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  4750     GO TO 0020-READ--STAT.                                       ELCDTERX
  4751                                                                  ELCDTERX
  4752 0025-READ--BUSC.                                                 ELCDTERX
  4753     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4754     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  4755        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  4756         GO TO 0005-READ--CARD.                                   ELCDTERX
  4757                                                                  ELCDTERX
  4758     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  4759     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  4760     GO TO 0025-READ--BUSC.                                       ELCDTERX
  4761                                                                  ELCDTERX
  4762 0030-READ--MORT.                                                 ELCDTERX
  4763     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4764     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4765        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  4766         GO TO 0005-READ--CARD.                                   ELCDTERX
  4767                                                                  ELCDTERX
  4768     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  4769     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  4770     GO TO 0030-READ--MORT.                                       ELCDTERX
  4771                                                                  ELCDTERX
  4772 0035-READ--CLXX.                                                 ELCDTERX
  4773     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  4774          GO TO 0005-READ--CARD.                                  ELCDTERX
  4775                                                                  ELCDTERX
  4776     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  4777         DISPLAY '***********************************************'ELCDTERX
  4778         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  4779         DISPLAY '***********************************************'ELCDTERX
  4780         GO TO 0055-READ--STOP.                                   ELCDTERX
  4781                                                                  ELCDTERX
  4782     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  4783        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  4784         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  4785                                                                  ELCDTERX
  4786     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  4787        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  4788         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  4789                                                                  ELCDTERX
  4790*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  4791     GO TO 0005-READ--CARD.                                       ELCDTERX
  4792                                                                  ELCDTERX
  4793 0040-READ--CLAI.                                                 ELCDTERX
  4794     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4795     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  4796        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  4797         GO TO 0005-READ--CARD.                                   ELCDTERX
  4798                                                                  ELCDTERX
  4799     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  4800     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  4801     GO TO 0040-READ--CLAI.                                       ELCDTERX
  4802                                                                  ELCDTERX
  4803 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4804     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  4805     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  4806                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  4807     PERFORM ABEND-PGM.                                           ELCDTERX
  4808                                                                  ELCDTERX
  4809 0050-READ--POXX.                                                 ELCDTERX
  4810     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  4811         GO TO 0005-READ--CARD.                                   ELCDTERX
  4812                                                                  ELCDTERX
  4813     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  4814         DISPLAY '***********************************************'ELCDTERX
  4815         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  4816         DISPLAY '***********************************************'ELCDTERX
  4817         GO TO 0055-READ--STOP.                                   ELCDTERX
  4818                                                                  ELCDTERX
  4819     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  4820     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  4821     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  4822     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  4823                                                                  ELCDTERX
  4824     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  4825         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  4826     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  4827         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  4828                                                                  ELCDTERX
  4829     GO TO 0005-READ--CARD.                                       ELCDTERX
  4830                                                                  ELCDTERX
  4831 0055-READ--STOP.                                                 ELCDTERX
  4832     GOBACK.                                                      ELCDTERX
  4833                                                                  ELCDTERX
  4834 0060-READ--TEST.                                                 ELCDTERX
  4835     IF DATX-COD        = SPACE  OR                               ELCDTERX
  4836        CLAX-ID         = SPACE  OR                               ELCDTERX
  4837        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  4838         GO TO 0045-READ--DUMP.                                   ELCDTERX
  4839                                                                  ELCDTERX
  4840     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  4841     GO TO 0079-READ--EXIT.                                       ELCDTERX
  4842                                                                  ELCDTERX
  4843 0065-READ--COLC.                                                 ELCDTERX
  4844     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  4845     GO TO 0005-READ--CARD.                                       ELCDTERX
  4846                                                                  ELCDTERX
  4847 0070-READ--OPCA.                                                 ELCDTERX
  4848                                                                  ELCDTERX
  4849     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4850                                                                  ELCDTERX
  4851     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  4852             OR                                                   ELCDTERX
  4853         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  4854         GO TO 0005-READ--CARD.                                   ELCDTERX
  4855                                                                  ELCDTERX
  4856     ADD 1                       TO INDEXCA.                      ELCDTERX
  4857     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  4858                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  4859     GO TO 0070-READ--OPCA.                                       ELCDTERX
  4860                                                                  ELCDTERX
  4861 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS158.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  4862                                                                  ELCDTERX
  4863     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4864                                                                  ELCDTERX
  4865     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  4866             OR                                                   ELCDTERX
  4867         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4868         GO TO 0005-READ--CARD.                                   ELCDTERX
  4869                                                                  ELCDTERX
  4870     ADD 1                       TO INDEXST.                      ELCDTERX
  4871     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  4872                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  4873     GO TO 0072-READ--OPST.                                       ELCDTERX
  4874                                                                  ELCDTERX
  4875 0074-READ--OPBS.                                                 ELCDTERX
  4876                                                                  ELCDTERX
  4877     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  4878                                                                  ELCDTERX
  4879     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  4880             OR                                                   ELCDTERX
  4881         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  4882         GO TO 0005-READ--CARD.                                   ELCDTERX
  4883                                                                  ELCDTERX
  4884     ADD 1                       TO INDEXBS.                      ELCDTERX
  4885     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  4886     GO TO 0074-READ--OPBS.                                       ELCDTERX
  4887                                                                  ELCDTERX
  4888 0079-READ--EXIT.                                                 ELCDTERX
  4889*    EXIT.                                                        ELCDTERX
  4890******************************************************************ELCDTERX
  4891
  4892     IF DEBUG-IS-ON
  4893         MOVE '3'                TO DTE-PGM-OPT.
  4894
  4895     IF EP-DT = RUN-DATE
  4896        MOVE ALPH-DATE           TO HD-ALF-DTE
  4897     ELSE
  4898        MOVE EP-DT               TO DC-GREG-DATE-CYMD
  4899        MOVE 'L'                 TO DC-OPTION-CODE
  4900        PERFORM 6150-DATE-CONVERSION-ROUTINE
  4901        IF NO-CONVERSION-ERROR
  4902           MOVE DC-GREG-DATE-1-ALPHA TO HD-ALF-DTE
  4903        ELSE
  4904           MOVE 'ALPHA-DATE ERROR'   TO  WS-ABEND-MESSAGE
  4905           MOVE DC-ERROR-CODE        TO  WS-ABEND-FILE-STATUS
  4906           GO TO ABEND-PGM.
  4907
  4908     IF EP-DT = RUN-DATE
  4909        SUBTRACT 1 FROM RUN-CCYY.
  4910
  4911     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  4912     MOVE 'L'                        TO DC-OPTION-CODE.
  4913     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4914     IF NO-CONVERSION-ERROR
  4915        MOVE DC-BIN-DATE-1           TO END-DT (1)
  4916     ELSE
  4917        MOVE SPACE TO DC-ERROR-CODE
  4918        MOVE LOW-VALUES              TO END-DT (1).
  4919
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS158.cbl
  4920     MOVE END-DT (1)                 TO DC-BIN-DATE-1.
  4921     MOVE '6'                        TO DC-OPTION-CODE.
  4922     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4923     move +0                         to dc-elapsed-days
  4924     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4925     IF NO-CONVERSION-ERROR
  4926        MOVE DC-BIN-DATE-2           TO END-DT (2)
  4927     ELSE
  4928        MOVE SPACE TO DC-ERROR-CODE
  4929        MOVE LOW-VALUES              TO END-DT (2).
  4930
  4931     MOVE END-DT (2)                 TO DC-BIN-DATE-1.
  4932     MOVE '6'                        TO DC-OPTION-CODE.
  4933     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4934     move +0                         to dc-elapsed-days
  4935     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4936     IF NO-CONVERSION-ERROR
  4937        MOVE DC-BIN-DATE-2           TO END-DT (3)
  4938     ELSE
  4939        MOVE SPACE TO DC-ERROR-CODE
  4940        MOVE LOW-VALUES              TO END-DT (3).
  4941
  4942     MOVE +0                         TO DC-ELAPSED-MONTHS.
  4943
  4944*    MOVE BIN-RUN-DATE               TO DC-BIN-DATE-1.
  4945*    MOVE '6'                        TO DC-OPTION-CODE.
  4946*    MOVE -12                        TO DC-ELAPSED-MONTHS.
  4947*    PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4948*    IF NO-CONVERSION-ERROR
  4949*       MOVE DC-BIN-DATE-2           TO BEGIN-DT (1)
  4950*    ELSE
  4951*       MOVE SPACE TO DC-ERROR-CODE
  4952*       MOVE LOW-VALUES              TO BEGIN-DT (1).
  4953
  4954     IF EP-DT = RUN-DATE
  4955        MOVE BIN-RUN-DATE               TO DC-BIN-DATE-1
  4956        MOVE '6'                        TO DC-OPTION-CODE
  4957        MOVE -12                        TO DC-ELAPSED-MONTHS
  4958        move +0                         to dc-elapsed-days
  4959        PERFORM 6150-DATE-CONVERSION-ROUTINE
  4960        IF NO-CONVERSION-ERROR
  4961          MOVE DC-BIN-DATE-2           TO BEGIN-DT (1)
  4962        ELSE
  4963           MOVE SPACE TO DC-ERROR-CODE
  4964           MOVE LOW-VALUES              TO BEGIN-DT (1)
  4965        END-IF
  4966     ELSE
  4967        MOVE BIN-RUN-DATE               TO BEGIN-DT (1)
  4968     END-IF
  4969
  4970     MOVE BEGIN-DT (1)               TO DC-BIN-DATE-1.
  4971     MOVE '6'                        TO DC-OPTION-CODE.
  4972     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4973     move +0                         to dc-elapsed-days
  4974     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4975     IF NO-CONVERSION-ERROR
  4976        MOVE DC-BIN-DATE-2           TO BEGIN-DT (2)
  4977     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS158.cbl
  4978        MOVE SPACE TO DC-ERROR-CODE
  4979        MOVE LOW-VALUES              TO BEGIN-DT (2).
  4980
  4981     MOVE BEGIN-DT (2)               TO DC-BIN-DATE-1.
  4982     MOVE '6'                        TO DC-OPTION-CODE.
  4983     MOVE -12                        TO DC-ELAPSED-MONTHS.
  4984     move +0                         to dc-elapsed-days
  4985     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  4986     IF NO-CONVERSION-ERROR
  4987        MOVE DC-BIN-DATE-2           TO BEGIN-DT (3)
  4988     ELSE
  4989        MOVE SPACE TO DC-ERROR-CODE
  4990        MOVE LOW-VALUES              TO BEGIN-DT (3).
  4991
  4992     MOVE +0                         TO DC-ELAPSED-MONTHS.
  4993
  4994     MOVE EP-MO TO ENDING-MO (1)
  4995                   ENDING-MO (2)
  4996                   ENDING-MO (3).
  4997     MOVE EP-DA TO ENDING-DA (1)
  4998                   ENDING-DA (2)
  4999                   ENDING-DA (3).
  5000
  5001     MOVE EP-CCYY      TO ENDING-CCYY (1).
  5002     COMPUTE ENDING-CCYY (2) = (EP-CCYY - 1).
  5003     COMPUTE ENDING-CCYY (3) = (EP-CCYY - 2).
  5004
  5005     MOVE RUN-CCYY     TO BEGIN-CCYY (1).
  5006     COMPUTE BEGIN-CCYY (2) = (RUN-CCYY - 1).
  5007     COMPUTE BEGIN-CCYY (3) = (RUN-CCYY - 2).
  5008
  5009     MOVE RUN-MO TO BEGIN-MO (1)
  5010                    BEGIN-MO (2)
  5011                    BEGIN-MO (3).
  5012     MOVE RUN-DA TO BEGIN-DA (1)
  5013                    BEGIN-DA (2)
  5014                    BEGIN-DA (3).
  5015
  5016     MOVE +3 TO NUMBER-OF-PERIODS.
  5017
  5018     IF EP-SW = '1'
  5019         MOVE ZEROS TO BEGIN-DATE (3)
  5020                       ENDING-DATE (3)
  5021         MOVE 'Y'   TO WS-PROCESS-SW
  5022         MOVE +2    TO NUMBER-OF-PERIODS.
  5023
  5024     MOVE HIGH-VALUES     TO REIN-HOLD-AREAS.
  5025     MOVE SPACES          TO REIN-LEVELS-END.
  5026     DISPLAY 'BEGIN 1 ' BEGIN-DATE (1)
  5027     DISPLAY 'BEGIN 2 ' BEGIN-DATE (2)
  5028     DISPLAY 'BEGIN 3 ' BEGIN-DATE (3)
  5029     DISPLAY ' END  1 ' ENDING-DATE (1)
  5030     DISPLAY ' END  2 ' ENDING-DATE (2)
  5031     DISPLAY ' END 3  ' ENDING-DATE (3)
  5032
  5033     INITIALIZE  CALL-EXTRACT.
  5034
  5035     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS158.cbl
  5036
  5037     MOVE +0 TO CLAS-INDEXS.
  5038
  5039     MOVE SPACES TO STATE-IL
  5040                    STATE-TX
  5041                    STATE-NC
  5042                    STATE-GA
  5043                    STATE-UT
  5044                    STATE-IA
  5045                    STATE-NE
  5046                    STATE-NV
  5047                    STATE-OH
  5048                    STATE-OR
  5049                    STATE-WI.
  5050
  5051 0070-FIND-TX.
  5052
  5053     ADD +1 TO CLAS-INDEXS.
  5054
  5055     IF CLAS-INDEXS GREATER CLAS-MAXS
  5056        GO TO 0080-SORT-CLAIMS.
  5057
  5058     IF STATE-ABBR (CLAS-INDEXS) = 'TX'
  5059        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-TX
  5060     ELSE
  5061     IF STATE-ABBR (CLAS-INDEXS) = 'IL'
  5062        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-IL
  5063     ELSE
  5064     IF STATE-ABBR (CLAS-INDEXS) = 'NC'
  5065        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NC
  5066     ELSE
  5067     IF STATE-ABBR (CLAS-INDEXS) = 'GA'
  5068        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-GA
  5069     ELSE
  5070     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  5071        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-UT
  5072     ELSE
  5073     IF STATE-ABBR (CLAS-INDEXS) = 'IA'
  5074        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-IA
  5075     ELSE
  5076     IF STATE-ABBR (CLAS-INDEXS) = 'NE'
  5077        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NE
  5078     ELSE
  5079     IF STATE-ABBR (CLAS-INDEXS) = 'NV'
  5080        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-NV
  5081     ELSE
  5082     IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  5083        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-OH
  5084     ELSE
  5085     IF STATE-ABBR (CLAS-INDEXS) = 'OR'
  5086        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-OR
  5087     ELSE
  5088     IF STATE-ABBR (CLAS-INDEXS) = 'WI'
  5089        MOVE STATE-SUB (CLAS-INDEXS) TO STATE-WI.
  5090
  5091     GO TO 0070-FIND-TX.
  5092
  5093 0080-SORT-CLAIMS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS158.cbl
  5094
  5095     SORT SORT-CLMS ON ASCENDING KEY SORT-CLAIM-KEY
  5096          INPUT PROCEDURE 0090-GET-ONLY-CLAIMS THRU
  5097                          0110-READ-CLAIMS-EXIT
  5098          GIVING SORTED-CLAIMS.
  5099
  5100     IF SORT-RETURN NOT = ZEROES
  5101        MOVE +0101 TO WS-RETURN-CODE
  5102        MOVE ' ERROR ON SORT ' TO WS-ABEND-MESSAGE
  5103        MOVE SPACES            TO WS-ABEND-FILE-STATUS
  5104        GO TO ABEND-PGM.
  5105
  5106     GO TO 0120-CERT-INPUTS-PROC.
  5107
  5108 0090-GET-ONLY-CLAIMS     SECTION.
  5109
  5110     OPEN  INPUT CLMS-HIST.
  5111
  5112 0100-READ-CLAIMS.
  5113
  5114     READ CLMS-HIST INTO DETAIL-EXTRACT AT END
  5115         CLOSE CLMS-HIST
  5116         GO TO 0110-READ-CLAIMS-EXIT.
  5117
  5118     ADD  1 TO WS-CLMS-DB-CNT
  5119               WS-TOT-CLMS-DB-CNT
  5120     IF WS-CLMS-DB-CNT > 10000
  5121        MOVE ZEROS TO WS-CLMS-DB-CNT
  5122        DISPLAY ' CLAIMS READ ' WS-TOT-CLMS-DB-CNT
  5123     END-IF
  5124     IF DE-REIN NOT = SPACE
  5125        GO TO 0100-READ-CLAIMS.
  5126
  5127     IF NOT DE-CLAIM
  5128        GO TO 0100-READ-CLAIMS.
  5129
* 5130     COPY ELCEXTM1.
  5131******************************************************************04/15/98
  5132*                                                                *ELCEXTM1
  5133*                                                                *ELCEXTM1
  5134*                            ELCEXTM1                            *   LV010
  5135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
  5136*                            VMOD=2.001                          *ELCEXTM1
  5137*                                                                *ELCEXTM1
  5138*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
  5139*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
  5140*                                                                *ELCEXTM1
  5141******************************************************************ELCEXTM1
  5142                                                                  ELCEXTM1
  5143     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
  5144     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
  5145     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
  5146     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
  5147     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
  5148     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
  5149                                                                     CL**9
  5150     EVALUATE TRUE                                                   CL**5
  5151        WHEN DE-ISSUE      OR                                        CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
  5152             DE-RC-ISSUE   OR                                        CL**8
  5153             DE-RR-RC-ISS  OR                                        CL**8
  5154             DE-CANCEL     OR                                        CL**8
  5155             DE-RC-CANCEL  OR                                        CL**8
  5156             DE-RR-RC-CNC                                            CL**8
  5157           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
  5158                                                                     CL**9
  5159        WHEN DE-CLAIM      OR                                        CL**8
  5160             DE-RR-RC-CLM                                            CL**6
  5161           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
  5162           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
  5163           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
  5164           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
  5165           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
  5166           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
  5167                                                                     CL**9
  5168        WHEN DE-RESERVE                                              CL**9
  5169           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
  5170           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
  5171           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
  5172                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
  5173           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
  5174                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
  5175           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
  5176     END-EVALUATE.                                                   CL**9
  5177                                                                     CL**9
  5178
  5179     IF DE-CLM-PROC-DT NOT NUMERIC
  5180        MOVE DE-PAY-MO    TO DE-CP-MO
  5181        MOVE DE-PAY-DA    TO DE-CP-DA
  5182        MOVE DE-PAY-YR    TO DE-CP-YR.
  5183
  5184     MOVE DE-INCUR        TO  DC-GREG-DATE-CYMD.
  5185     MOVE 'L'             TO  DC-OPTION-CODE.
  5186     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5187     IF NO-CONVERSION-ERROR
  5188        MOVE DC-BIN-DATE-1  TO  BIN-DE-INCUR
  5189     ELSE
  5190        MOVE 'DE-INCUR CONVERSION ERROR' TO
  5191                                         WS-ABEND-MESSAGE
  5192        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5193        DISPLAY 'DE CONTROL 1 ' DE-CONTROL
  5194        MOVE LOW-VALUES     TO  BIN-DE-INCUR.
  5195*       GO TO ABEND-PGM.
  5196
  5197     MOVE DE-CLM-PROC-DT  TO  DC-GREG-DATE-CYMD.
  5198     MOVE 'L'             TO  DC-OPTION-CODE.
  5199     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5200     IF NO-CONVERSION-ERROR
  5201        MOVE DC-BIN-DATE-1  TO  BIN-DE-CLM-PROC-DT
  5202     ELSE
  5203        MOVE 'DE-CLM-PROC-DT CONVERSION ERROR' TO
  5204                                         WS-ABEND-MESSAGE
  5205        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5206        GO TO ABEND-PGM.
  5207
  5208     IF BIN-DE-CLM-PROC-DT GREATER THAN END-DT (1)
  5209        GO TO 0100-READ-CLAIMS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS158.cbl
  5210
  5211     IF SINGLE-PERIOD-PROCESS AND
  5212            BIN-DE-CLM-PROC-DT NOT GREATER THAN BEGIN-DT (2)
  5213             GO TO 0100-READ-CLAIMS
  5214     ELSE
  5215         IF BIN-DE-CLM-PROC-DT NOT GREATER THAN BEGIN-DT (3)
  5216             GO TO 0100-READ-CLAIMS.
  5217
  5218     MOVE DE-CONTROL            TO SORT-CLAIM-KEY.
  5219
  5220     MOVE DETAIL-EXTRACT        TO SORT-EP-EXTR.
  5221
  5222     RELEASE SORT-CLMS-REC.
  5223
  5224     GO TO 0100-READ-CLAIMS.
  5225
  5226 0110-READ-CLAIMS-EXIT.
  5227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS158.cbl
  5229
  5230 0120-CERT-INPUTS-PROC SECTION.
  5231
  5232     OPEN OUTPUT XTRACT.
  5233
  5234 0140-OPEN-REST.
  5235
  5236     MOVE 'R' TO CP-RATE-FILE.
  5237     MOVE 'O' TO CP-IO-FUNCTION.
  5238     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  5239     IF IO-ERROR
  5240        MOVE +0302   TO WS-RETURN-CODE
  5241        MOVE ' ERROR ON ERRATE OPEN ' TO WS-ABEND-MESSAGE
  5242        GO TO ABEND-PGM.
  5243
  5244     OPEN INPUT CERTS  ERACCTT SORTED-CLAIMS
  5245          OUTPUT PRINTX.
  5246
  5247     IF DTE-PGM-OPT = '3' OR '4'
  5248        OPEN OUTPUT PRINTC.
  5249
  5250     IF ERACCTT-FILE-STATUS NOT = '00' AND '97'
  5251        MOVE ' ERROR ON OPEN ERACCT ' TO WS-ABEND-MESSAGE
  5252        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5253        GO TO ABEND-PGM.
  5254
  5255 0150-READ-ACCOUNT.
  5256
  5257     READ ERACCTT  NEXT RECORD.
  5258
  5259     IF ERACCTT-FILE-STATUS = '10'
  5260        MOVE HIGH-VALUES TO AM-CONTROL-PRIMARY.
  5261
  5262     IF ERACCTT-FILE-STATUS NOT = '00' AND '10'
  5263        MOVE ' ERROR ON READ ERACCT ' TO WS-ABEND-MESSAGE
  5264        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
  5265        GO TO ABEND-PGM.
  5266
  5267     ADD  1 TO WS-ACCT-DB-CNT
  5268               WS-TOT-ACCT-DB-CNT
  5269     IF WS-ACCT-DB-CNT > 10000
  5270        MOVE ZEROS TO WS-ACCT-DB-CNT
  5271        DISPLAY ' ACCTS  READ ' WS-TOT-ACCT-DB-CNT
  5272     END-IF
* 5273     COPY ELCACCTI.
  5274******************************************************************04/14/98
  5275*                                                                *ELCACCTI
  5276*                            ELCACCTI                            *   LV003
  5277*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5278*                            VMOD=2.001                          *ELCACCTI
  5279*                                                                *ELCACCTI
  5280*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  5281*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  5282*                                                                *ELCACCTI
  5283*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  5284*                                                                *ELCACCTI
  5285******************************************************************ELCACCTI
  5286     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS158.cbl (/apps/prod/cid1p/copy/ELCACCTI)
  5287     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  5288     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  5289     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  5290     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  5291     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  5292     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  5293     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  5294     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  5295
  5296 0160-READ-CERT-MASTER.
  5297
  5298     READ CERTS AT END
  5299          MOVE HIGH-VALUES TO CERT-IN-RECORD.
  5300
  5301     ADD  1 TO WS-CERT-DB-CNT
  5302               WS-TOT-CERT-DB-CNT
  5303     IF WS-CERT-DB-CNT > 10000
  5304        MOVE ZEROS TO WS-CERT-DB-CNT
  5305        DISPLAY ' CERT   READ ' WS-TOT-CERT-DB-CNT
  5306     END-IF
* 5307      COPY ELCCRTM1.
  5308******************************************************************04/15/98
  5309*                                                                *ELCCRTM1
  5310*                                                                *ELCCRTM1
  5311*                            ELCCRTM1                            *   LV003
  5312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5313*                            VMOD=2.001                          *ELCCRTM1
  5314*                                                                *ELCCRTM1
  5315*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  5316*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  5317*                                                                *ELCCRTM1
  5318******************************************************************ELCCRTM1
  5319     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  5320     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  5321     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  5322     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  5323     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  5324     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  5325     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  5326     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  5327     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  5328                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  5329     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  5330                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  5331     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  5332     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  5333     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  5334     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  5335     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  5336     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  5337           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  5338                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  5339     END-PERFORM.                                                 ELCCRTM1
  5340                                                                  ELCCRTM1
  5341
  5342     IF CR-STATE NOT = HIGH-VALUES
  5343         IF CR-STATE NOT = SAVE-STATE
  5344           MOVE CR-STATE TO TEMP-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS158.cbl
  5345           PERFORM 6200-LOCATE-STATE THRU 6200-EXIT.
  5346
  5347     IF CR-STATE NOT = HIGH-VALUES
  5348        IF STATE-IS-EXCLUDED
  5349            GO TO 0160-READ-CERT-MASTER.
  5350
  5351     IF (CR-CARRIER = '9')
  5352        AND (CR-STATE = 'NE')
  5353        AND (CR-ACCOUNT = '0000015860')
  5354        AND (CR-CERT-NO = '1098173790 ')
  5355        DISPLAY ' BIG CERT BYPASSED ' CR-CERT-NO
  5356        GO TO 0160-READ-CERT-MASTER
  5357     END-IF
  5358
  5359     IF CR-POLICY-IS-DECLINED OR
  5360        CR-POLICY-IS-VOID
  5361            GO TO 0160-READ-CERT-MASTER.
  5362
  5363     MOVE CR-FULL-CONTROL TO CERT-CONTROL.
  5364
  5365 0170-READ-SORTED-CLAIMS.
  5366
  5367     READ SORTED-CLAIMS AT END
  5368       MOVE HIGH-VALUES TO SORTED-EXTRACT.
  5369
  5370     ADD  1 TO WS-SCLM-DB-CNT
  5371               WS-TOT-SCLM-DB-CNT
  5372     IF WS-SCLM-DB-CNT > 10000
  5373        MOVE ZEROS TO WS-SCLM-DB-CNT
  5374        DISPLAY ' SCLMS  READ ' WS-TOT-SCLM-DB-CNT
  5375     END-IF
  5376     MOVE SORTED-EXTRACT TO DETAIL-EXTRACT.
  5377
  5378     MOVE DE-CONTROL TO CLAIMS-CONTROL.
  5379
  5380     IF SORTED-EXTRACT NOT = HIGH-VALUES
  5381        IF DE-STATE NOT = SAVE-STATE
  5382           MOVE DE-STATE TO TEMP-STATE
  5383           PERFORM 6200-LOCATE-STATE THRU 6200-EXIT.
  5384
  5385     IF SORTED-EXTRACT NOT = HIGH-VALUES
  5386        IF STATE-IS-EXCLUDED
  5387            GO TO 0170-READ-SORTED-CLAIMS.
  5388
  5389     IF SORTED-EXTRACT = HIGH-VALUES
  5390         GO TO 0230-PROCESS-CLAIMS-EXIT.
  5391
* 5392     COPY   ELCEXTM1.
  5393******************************************************************04/15/98
  5394*                                                                *ELCEXTM1
  5395*                                                                *ELCEXTM1
  5396*                            ELCEXTM1                            *   LV010
  5397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
  5398*                            VMOD=2.001                          *ELCEXTM1
  5399*                                                                *ELCEXTM1
  5400*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
  5401*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
  5402*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS158.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
  5403******************************************************************ELCEXTM1
  5404                                                                  ELCEXTM1
  5405     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
  5406     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
  5407     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
  5408     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
  5409     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
  5410     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
  5411                                                                     CL**9
  5412     EVALUATE TRUE                                                   CL**5
  5413        WHEN DE-ISSUE      OR                                        CL**8
  5414             DE-RC-ISSUE   OR                                        CL**8
  5415             DE-RR-RC-ISS  OR                                        CL**8
  5416             DE-CANCEL     OR                                        CL**8
  5417             DE-RC-CANCEL  OR                                        CL**8
  5418             DE-RR-RC-CNC                                            CL**8
  5419           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
  5420                                                                     CL**9
  5421        WHEN DE-CLAIM      OR                                        CL**8
  5422             DE-RR-RC-CLM                                            CL**6
  5423           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
  5424           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
  5425           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
  5426           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
  5427           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
  5428           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
  5429                                                                     CL**9
  5430        WHEN DE-RESERVE                                              CL**9
  5431           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
  5432           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
  5433           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
  5434                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
  5435           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
  5436                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
  5437           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
  5438     END-EVALUATE.                                                   CL**9
  5439                                                                     CL**9
  5440
  5441     IF DE-CLM-PROC-DT NOT NUMERIC
  5442        MOVE DE-PAY-MO    TO DE-CP-MO
  5443        MOVE DE-PAY-DA    TO DE-CP-DA
  5444        MOVE DE-PAY-YR    TO DE-CP-YR.
  5445
  5446     MOVE DE-INCUR        TO  DC-GREG-DATE-CYMD.
  5447     MOVE 'L'             TO  DC-OPTION-CODE.
  5448     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5449     IF NO-CONVERSION-ERROR
  5450        MOVE DC-BIN-DATE-1  TO  BIN-DE-INCUR
  5451     ELSE
  5452        MOVE 'DE-INCUR CONVERSION ERROR' TO
  5453                                         WS-ABEND-MESSAGE
  5454        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5455        DISPLAY 'CLAIMS CONTROL 2 ' CLAIMS-CONTROL
  5456        MOVE LOW-VALUES     TO  BIN-DE-INCUR.
  5457*       GO TO ABEND-PGM.
  5458
  5459     MOVE DE-CLM-PROC-DT  TO  DC-GREG-DATE-CYMD.
  5460     MOVE 'L'             TO  DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS158.cbl
  5461     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5462     IF NO-CONVERSION-ERROR
  5463        MOVE DC-BIN-DATE-1  TO  BIN-DE-CLM-PROC-DT
  5464     ELSE
  5465        MOVE 'DE-CLM-PROC-DT CONVERSION ERROR' TO
  5466                                         WS-ABEND-MESSAGE
  5467        MOVE DC-ERROR-CODE  TO  WS-ABEND-FILE-STATUS
  5468        GO TO ABEND-PGM.
  5469
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS158.cbl
  5471 0180-MATCH-ROUTINE.
  5472
  5473     IF CERT-CONTROL = HIGH-VALUES
  5474        IF CLAIMS-CONTROL = HIGH-VALUES
  5475           GO TO 6100-E-O-J-RTN.
  5476
  5477     IF CLAIMS-CONTROL LESS THAN CERT-CONTROL
  5478        MOVE '1' TO WS-MATCH-SWITCH
  5479        PERFORM 0190-PROCESS-CLAIMS THRU 0230-PROCESS-CLAIMS-EXIT
  5480        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT
  5481        GO TO 0180-MATCH-ROUTINE.
  5482
  5483     IF CLAIMS-CONTROL GREATER THAN CERT-CONTROL
  5484        MOVE '2' TO WS-MATCH-SWITCH
  5485        PERFORM 0240-PROCESS-CERTS THRU 1410-PROCESS-CERTS-EXIT
  5486        PERFORM 0160-READ-CERT-MASTER
  5487        GO TO 0180-MATCH-ROUTINE.
  5488
  5489     MOVE '3' TO WS-MATCH-SWITCH.
  5490     PERFORM 0190-PROCESS-CLAIMS THRU 0230-PROCESS-CLAIMS-EXIT.
  5491     PERFORM 0240-PROCESS-CERTS THRU 1410-PROCESS-CERTS-EXIT.
  5492     PERFORM 0160-READ-CERT-MASTER.
  5493
  5494     GO TO 0180-MATCH-ROUTINE.
  5495
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS158.cbl
  5497 0190-PROCESS-CLAIMS.
  5498
  5499     INITIALIZE  CALL-EXTRACT.
  5500
  5501     MOVE LOW-VALUES          TO HOLD-CLAIMS-CONTROL.
  5502
  5503     MOVE ZEROS TO WS-DEV (1)      WS-DEV (2)
  5504                   WS-BEN-TYPE (1) WS-BEN-TYPE (2)
  5505                   WS-TERM (1)     WS-TERM (2).
  5506
  5507     PERFORM 0200-ZERO-CLAIM-TABLE VARYING
  5508             SB FROM +1 BY +1 UNTIL SB GREATER THAN +2 AFTER
  5509             YR FROM +1 BY +1 UNTIL YR GREATER THAN +3.
  5510
  5511     GO TO 0210-CONTINUE-CLAIMS.
  5512
  5513 0200-ZERO-CLAIM-TABLE.
  5514
  5515     MOVE +0         TO WS-CLAIM-AMT (1 SB YR)
  5516                        WS-CLAIM-AMT (2 SB YR)
  5517                        WS-INC-CNT (1 SB YR)
  5518                        WS-PD-CNT  (1 SB YR)
  5519                        WS-INC-CNT (2 SB YR)
  5520                        WS-PD-CNT  (2 SB YR).
  5521
  5522 0210-CONTINUE-CLAIMS.
  5523
  5524     MOVE +1         TO LIFE-AH-SUB.
  5525
  5526     IF CERT-AND-CLAIM
  5527        GO TO 0220-CLAIMS-LOOP.
  5528
  5529     MOVE CLAIMS-CONTROL      TO ACCT-MATCH-CONTROL.
  5530     MOVE DE-EFF              TO ACCT-MATCH-EFF.
  5531
  5532     MOVE '1'                 TO WS-ACCT-MATCH.
  5533     PERFORM 0250-MATCH-TO-ACCOUNT THRU
  5534             0260-MATCH-ACCT-EXIT.
  5535
  5536     MOVE DE-CARRIER          TO EX-CARRIER.
  5537     MOVE DE-GROUPING         TO EX-GROUPING.
  5538     MOVE DE-STATE            TO EX-STATE.
  5539     MOVE DE-ACCOUNT          TO EX-ACCOUNT.
  5540     MOVE '2'                 TO EX-RECORD-TYPE.
  5541     MOVE '0'                 TO EX-TERM-CD.
  5542     MOVE '000'               TO EX-STATE-DEV.
  5543
  5544     IF DE-DTH OR DE-OB-DTH
  5545        MOVE 'L' TO EX-LIFE-AH
  5546     ELSE
  5547        MOVE 'A' TO EX-LIFE-AH.
  5548
  5549     IF DE-LF-TERM NOT NUMERIC
  5550        MOVE ZEROS            TO DE-LF-TERM.
  5551
  5552     IF DE-AH-TERM NOT NUMERIC
  5553        MOVE ZEROS            TO DE-AH-TERM.
  5554
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS158.cbl
  5555     IF DE-DTH OR DE-OB-DTH
  5556        IF DE-LF-TERM LESS THAN +60
  5557           MOVE '1' TO EX-TERM-CD
  5558        ELSE
  5559           MOVE '2' TO EX-TERM-CD
  5560     ELSE
  5561        IF DE-AH-TERM LESS THAN +60
  5562           MOVE '1' TO EX-TERM-CD
  5563        ELSE
  5564           MOVE '2' TO EX-TERM-CD.
  5565
  5566     IF DE-IG = '1' OR 'I'
  5567        MOVE 'I'              TO EX-I-G
  5568     ELSE
  5569        MOVE 'G'              TO EX-I-G.
  5570
  5571     MOVE '00'                TO EX-CAL-TABLE.
  5572     MOVE '01'                TO EX-ACCT-TYPE.
  5573
  5574     MOVE DE-ACC-NAME         TO EX-NAME.
  5575
  5576     IF ACCOUNT-MATCHED
  5577        MOVE AM-NAME          TO EX-NAME
  5578        MOVE AM-GPCD          TO EX-ACCT-TYPE.
  5579
  5580     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  5581        MOVE CR-RATING-CLASS  TO EX-CAL-TABLE
  5582     ELSE
  5583        MOVE AM-CAL-TABLE     TO EX-CAL-TABLE.
  5584
  5585 0220-CLAIMS-LOOP.
  5586
  5587     IF CLAIMS-CONTROL NOT = HOLD-CLAIMS-CONTROL AND
  5588        HOLD-CLAIMS-CONTROL NOT = LOW-VALUES
  5589           MOVE CLAIMS-CONTROL      TO HOLD-CLAIMS-CONTROL
  5590           GO TO 0230-PROCESS-CLAIMS-EXIT.
  5591
  5592     MOVE CLAIMS-CONTROL      TO HOLD-CLAIMS-CONTROL.
  5593
  5594     IF DE-DTH OR DE-OB-DTH
  5595        MOVE +1   TO LIFE-AH-SUB
  5596     ELSE
  5597        MOVE +2   TO LIFE-AH-SUB.
  5598
  5599     IF DE-LF-TERM NOT NUMERIC
  5600        MOVE ZEROS            TO DE-LF-TERM.
  5601
  5602     IF DE-AH-TERM NOT NUMERIC
  5603        MOVE ZEROS            TO DE-AH-TERM.
  5604
  5605     IF DE-DTH OR DE-OB-DTH
  5606        MOVE DE-LF-TYPE       TO WS-BEN-TYPE (LIFE-AH-SUB)
  5607        MOVE DE-LF-TERM       TO WS-TERM     (LIFE-AH-SUB)
  5608     ELSE
  5609        MOVE DE-AH-TYPE       TO WS-BEN-TYPE (LIFE-AH-SUB)
  5610        MOVE DE-AH-TERM       TO WS-TERM     (LIFE-AH-SUB).
  5611
  5612     IF AM-GPCD NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS158.cbl
  5613         MOVE ZEROS TO AM-GPCD.
  5614
  5615     IF ACCOUNT-MATCHED
  5616         IF AM-GPCD NOT = SAVE-BUSC-TYPE
  5617             PERFORM 6300-LOCATE-BUSC-TYPE THRU 6399-EXIT.
  5618
  5619     IF ACCOUNT-MATCHED
  5620         IF BUSC-TYPE-IS-EXCLUDED
  5621             GO TO 0225-CONTINUE-CLAIMS.
  5622
  5623     IF ACCOUNT-MATCHED
  5624        IF DE-AH OR DE-OB-AH
  5625           MOVE AM-AH-DEVIATION TO WS-DEV (LIFE-AH-SUB)
  5626        ELSE
  5627           MOVE AM-LF-DEVIATION TO WS-DEV (LIFE-AH-SUB).
  5628
  5629     IF NOT SINGLE-PERIOD-PROCESS
  5630         GO TO 0222-CONTINUE.
  5631
  5632     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5633       AND
  5634        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5635         ADD DE-CLAIM-AMT      TO WS-CLAIM-AMT (LIFE-AH-SUB 1 1)
  5636     ELSE
  5637     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5638       AND
  5639        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5640        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 2).
  5641
  5642     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5643       AND
  5644        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5645        IF DE-VOIDED-PAYMENT
  5646            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 1)
  5647        ELSE
  5648           IF DE-CLAIM-AMT NOT = ZEROS
  5649               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 1)
  5650           ELSE
  5651               NEXT SENTENCE
  5652     ELSE
  5653     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5654       AND
  5655        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5656        IF DE-VOIDED-PAYMENT
  5657            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 2)
  5658        ELSE
  5659           IF DE-CLAIM-AMT NOT = ZEROS
  5660               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 2).
  5661
  5662     IF BIN-DE-INCUR NOT GREATER THAN END-DT (1)
  5663       AND
  5664        BIN-DE-INCUR GREATER THAN BEGIN-DT (1)
  5665        MOVE +1                TO WS-INC-CNT (LIFE-AH-SUB 1 1)
  5666     ELSE
  5667     IF BIN-DE-INCUR NOT GREATER THAN END-DT (2)
  5668       AND
  5669        BIN-DE-INCUR GREATER THAN BEGIN-DT (2)
  5670        MOVE +1             TO WS-INC-CNT (LIFE-AH-SUB 1 2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS158.cbl
  5671
  5672     GO TO 0225-CONTINUE-CLAIMS.
  5673
  5674 0222-CONTINUE.
  5675     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5676       AND
  5677        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5678        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 1)
  5679     ELSE
  5680     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5681       AND
  5682        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5683        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 2)
  5684     ELSE
  5685     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (3)
  5686       AND
  5687        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (3)
  5688        ADD DE-CLAIM-AMT       TO WS-CLAIM-AMT (LIFE-AH-SUB 1 3).
  5689
  5690     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (1)
  5691       AND
  5692        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (1)
  5693        IF DE-VOIDED-PAYMENT
  5694            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 1)
  5695        ELSE
  5696           IF DE-CLAIM-AMT NOT = ZEROS
  5697               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 1)
  5698           ELSE
  5699               NEXT SENTENCE
  5700     ELSE
  5701     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (2)
  5702       AND
  5703        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (2)
  5704        IF DE-VOIDED-PAYMENT
  5705            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 2)
  5706        ELSE
  5707           IF DE-CLAIM-AMT NOT = ZEROS
  5708               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 2)
  5709           ELSE
  5710               NEXT SENTENCE
  5711     ELSE
  5712     IF BIN-DE-CLM-PROC-DT NOT GREATER THAN END-DT (3)
  5713       AND
  5714        BIN-DE-CLM-PROC-DT GREATER THAN BEGIN-DT (3)
  5715        IF DE-VOIDED-PAYMENT
  5716            SUBTRACT +1 FROM WS-PD-CNT (LIFE-AH-SUB 1 3)
  5717        ELSE
  5718           IF DE-CLAIM-AMT NOT = ZEROS
  5719               ADD +1 TO WS-PD-CNT (LIFE-AH-SUB 1 3).
  5720
  5721     IF BIN-DE-INCUR NOT GREATER THAN END-DT (1)
  5722       AND
  5723        BIN-DE-INCUR GREATER THAN BEGIN-DT (1)
  5724        MOVE +1                TO WS-INC-CNT (LIFE-AH-SUB 1 1)
  5725     ELSE
  5726     IF BIN-DE-INCUR NOT GREATER THAN END-DT (2)
  5727       AND
  5728        BIN-DE-INCUR GREATER THAN BEGIN-DT (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS158.cbl
  5729        MOVE +1             TO WS-INC-CNT (LIFE-AH-SUB 1 2)
  5730     ELSE
  5731     IF BIN-DE-INCUR NOT GREATER THAN END-DT (3)
  5732       AND
  5733        BIN-DE-INCUR GREATER THAN BEGIN-DT (3)
  5734        MOVE +1          TO WS-INC-CNT (LIFE-AH-SUB 1 3).
  5735
  5736 0225-CONTINUE-CLAIMS.
  5737
  5738     PERFORM 0170-READ-SORTED-CLAIMS.
  5739
  5740     GO TO 0220-CLAIMS-LOOP.
  5741
  5742 0230-PROCESS-CLAIMS-EXIT.
  5743     EXIT.
  5744
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS158.cbl
  5746 0240-PROCESS-CERTS.
  5747
  5748     IF CR-LF-CANC-DT NOT NUMERIC
  5749        MOVE ZEROS      TO CR-LF-CANC-DT.
  5750
  5751     IF CR-LF-CANCEL-EXIT-DATE NOT NUMERIC
  5752        MOVE ZEROS      TO CR-LF-CANCEL-EXIT-DATE.
  5753
  5754     IF CR-AH-CANC-DT NOT NUMERIC
  5755        MOVE ZEROS      TO CR-AH-CANC-DT.
  5756
  5757     IF CR-AH-CANCEL-EXIT-DATE NOT NUMERIC
  5758        MOVE ZEROS      TO CR-AH-CANCEL-EXIT-DATE.
  5759
  5760     IF CR-DTH-DT NOT NUMERIC
  5761        MOVE ZEROS      TO CR-DTH-DT.
  5762
  5763     IF CR-LF-CLAIM-EXIT-DATE  NOT NUMERIC
  5764        MOVE ZEROS      TO CR-LF-CLAIM-EXIT-DATE.
  5765
  5766     IF CR-DTH-DT NOT = ZEROS
  5767         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  5768             IF CR-LF-CURRENT-STATUS = '7'
  5769                 MOVE CR-DTH-DT  TO CR-LF-CLAIM-EXIT-DATE.
  5770
  5771     IF CR-LF-CANC-DT NOT = ZEROS
  5772         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  5773             MOVE CR-LF-CANC-DT TO CR-LF-CANCEL-EXIT-DATE.
  5774
  5775     IF CR-AH-CANC-DT NOT = ZEROS
  5776         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  5777             MOVE CR-AH-CANC-DT TO CR-AH-CANCEL-EXIT-DATE.
  5778
  5779     IF CERT-NO-CLAIM
  5780        MOVE ZEROS TO WS-DEV (1)      WS-DEV (2)
  5781                      WS-BEN-TYPE (1) WS-BEN-TYPE (2)
  5782                      WS-TERM (1)     WS-TERM (2)
  5783
  5784        PERFORM 0200-ZERO-CLAIM-TABLE VARYING
  5785             SB FROM +1 BY +1 UNTIL SB GREATER THAN +2 AFTER
  5786             YR FROM +1 BY +1 UNTIL YR GREATER THAN +3.
  5787
  5788     MOVE +1                  TO  LIFE-AH-SUB    YR.
  5789
  5790     INITIALIZE   CALL-EXTRACT.
  5791
  5792     MOVE CALL-EXTRACT        TO HOLD-LIFE-RECORD
  5793                                 HOLD-AH-RECORD.
  5794
  5795     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  5796     MOVE 'L'                        TO DC-OPTION-CODE.
  5797     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5798     IF NO-CONVERSION-ERROR
  5799        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  5800     ELSE
  5801        MOVE LOW-VALUES               TO EFFECT-DT.
  5802
  5803     MOVE CR-ENTRY-DATE              TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS158.cbl
  5804     MOVE 'L'                        TO DC-OPTION-CODE.
  5805     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5806     IF NO-CONVERSION-ERROR
  5807        MOVE DC-BIN-DATE-1            TO ENTRY-DT
  5808     ELSE
  5809        MOVE EFFECT-DT                TO ENTRY-DT.
  5810
  5811     IF ENTRY-DT GREATER THAN END-DT (1)
  5812        GO TO 1410-PROCESS-CERTS-EXIT.
  5813
  5814     MOVE CERT-CONTROL TO ACCT-MATCH-CONTROL.
  5815     MOVE CR-DT        TO ACCT-MATCH-EFF.
  5816     MOVE '2'          TO WS-ACCT-MATCH.
  5817
  5818     PERFORM 0250-MATCH-TO-ACCOUNT THRU
  5819             0260-MATCH-ACCT-EXIT.
  5820
  5821     GO TO 0265-CONTINUE-CERT.
  5822
  5823 0250-MATCH-TO-ACCOUNT.
  5824
  5825     MOVE ' ' TO WS-ACCT-MATCH-SW.
  5826
  5827     IF ACCT-MATCH-CONTROL GREATER THAN AM-CONTROL-A
  5828        PERFORM 0150-READ-ACCOUNT
  5829        GO TO 0250-MATCH-TO-ACCOUNT.
  5830
  5831     IF ACCT-MATCH-CONTROL LESS THAN AM-CONTROL-A
  5832        MOVE +0302 TO WS-RETURN-CODE
  5833        IF FROM-CLAIM
  5834           MOVE 'NO ACCOUNT MASTER FOR CLAIM ' TO
  5835                 WS-ABEND-MESSAGE
  5836           DISPLAY 'CLAIM CONTROL ' ACCT-MATCH-CONTROL
  5837           DISPLAY 'CLAIM EFF DTE ' ACCT-MATCH-EFF
  5838           GO TO 0260-MATCH-ACCT-EXIT
  5839        ELSE
  5840           MOVE 'NO ACCOUNT MASTER FOR CERT  ' TO
  5841                 WS-ABEND-MESSAGE
  5842           DISPLAY 'CERT  CONTROL ' ACCT-MATCH-CONTROL
  5843           DISPLAY 'CERT  EFF DTE ' ACCT-MATCH-EFF
  5844           GO TO 0260-MATCH-ACCT-EXIT.
  5845
  5846     IF ACCT-MATCH-EFF GREATER THAN WS-AM-EXPIRE-DT
  5847        PERFORM 0150-READ-ACCOUNT
  5848        GO TO 0250-MATCH-TO-ACCOUNT.
  5849
  5850     MOVE '*' TO WS-ACCT-MATCH-SW.
  5851
  5852 0260-MATCH-ACCT-EXIT.
  5853     EXIT.
  5854
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS158.cbl
  5856 0265-CONTINUE-CERT.
  5857
  5858     IF CR-LFPRM-CALC NOT NUMERIC
  5859        MOVE +0    TO CR-LFPRM-CALC.
  5860
  5861     IF CR-AHPRM-CALC NOT NUMERIC
  5862        MOVE +0    TO CR-AHPRM-CALC.
  5863
  5864     IF CR-LFRFND-CALC NOT NUMERIC
  5865        MOVE +0    TO CR-LFRFND-CALC.
  5866
  5867     IF CR-AHRFND-CALC NOT NUMERIC
  5868        MOVE +0    TO CR-AHRFND-CALC.
  5869
  5870     IF CR-APR NOT NUMERIC
  5871        MOVE +0    TO CR-APR.
  5872
  5873     IF CR-LF-DEV-CODE = SPACES OR LOW-VALUES
  5874        MOVE ZEROS TO CR-LF-DEV-CODE.
  5875
  5876     IF CR-AH-DEV-CODE = SPACES OR LOW-VALUES
  5877        MOVE ZEROS TO CR-AH-DEV-CODE.
  5878
  5879     IF DTE-CLIENT = 'CRI'
  5880         MOVE CR-LF-DEV-CODE     TO  WK-LF-DEV-CODE
  5881         MOVE 'P'                TO  WK-LF-DEV-CODE-1
  5882         MOVE '0'                TO  WK-LF-DEV-CODE-3
  5883         MOVE CR-AH-DEV-CODE     TO  WK-AH-DEV-CODE
  5884         MOVE 'P'                TO  WK-AH-DEV-CODE-1
  5885         MOVE '0'                TO  WK-AH-DEV-CODE-3.
  5886
  5887     MOVE CR-CARRIER        TO EX-CARRIER.
  5888     MOVE CR-GROUPING       TO EX-GROUPING.
  5889     MOVE CR-STATE          TO EX-STATE.
  5890     MOVE CR-ACCOUNT        TO EX-ACCOUNT
  5891
  5892     IF CR-IND-GRP = '1' OR 'I'
  5893        MOVE 'I'            TO EX-I-G
  5894     ELSE
  5895        MOVE 'G'            TO EX-I-G.
  5896
  5897     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  5898        MOVE CR-RATING-CLASS  TO EX-CAL-TABLE
  5899     ELSE
  5900        MOVE AM-CAL-TABLE     TO EX-CAL-TABLE.
  5901
  5902     IF ACCOUNT-MATCHED
  5903        MOVE AM-GPCD           TO EX-ACCT-TYPE
  5904        MOVE AM-NAME           TO EX-NAME.
  5905
  5906     IF ACCOUNT-MATCHED
  5907         IF AM-GPCD NOT = SAVE-BUSC-TYPE
  5908             PERFORM 6300-LOCATE-BUSC-TYPE THRU 6399-EXIT.
  5909
  5910     IF ACCOUNT-MATCHED
  5911         IF BUSC-TYPE-IS-EXCLUDED
  5912             GO TO 1410-PROCESS-CERTS-EXIT.
  5913
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS158.cbl
  5914     MOVE CR-DT             TO EX-EFF-DATE.
  5915     MOVE CR-AGE            TO EX-AGE.
  5916     MOVE CR-ENTRY-DATE     TO EX-ENTRY-DATE.
  5917     MOVE CR-PMT-FREQ       TO EX-PMT-FREQ.
  5918     MOVE CR-APR            TO EX-APR.
  5919     MOVE CR-LOAN-TERM      TO EX-CAP-TERM.
  5920     MOVE CR-LFAMT          TO EX-INITIAL-AMT.
  5921     MOVE CR-AHAMT          TO EX-BENEFIT.
  5922     MOVE '3'               TO EX-RECORD-TYPE.
  5923
  5924     MOVE CLAS-STARTL TO CLAS-INDEXL
  5925     MOVE CLAS-STARTA TO CLAS-INDEXA.
  5926     MOVE CLAS-STARTS TO CLAS-INDEXS.
  5927
  5928     MOVE WS-RESERVE-INIT   TO WS-RESERVE-WORK (1)
  5929                               WS-RESERVE-WORK (2)
  5930                               WS-RESERVE-WORK (3).
  5931
  5932     MOVE WS-REM-TERM-INIT  TO WS-REM-TERM-WORK (1)
  5933                               WS-REM-TERM-WORK (2)
  5934                               WS-REM-TERM-WORK (3).
  5935
  5936     MOVE LOW-VALUES TO LF-CAN LF-CLM
  5937                        AH-CAN AH-CLM.
  5938
  5939 0270-FIND-STATE.
  5940
  5941     IF CLAS-INDEXS GREATER THAN CLAS-MAXS
  5942        MOVE ' INVALID STATE ' TO WS-ABEND-MESSAGE
  5943        MOVE CR-STATE          TO WS-ABEND-FILE-STATUS
  5944        MOVE +0                TO WS-RETURN-CODE
  5945        GO TO ABEND-PGM.
  5946
  5947     IF STATE-PRIM-FAC-DEV (CLAS-INDEXS) = SPACES OR LOW-VALUES
  5948        MOVE ZEROS TO STATE-PRIM-FAC-DEV (CLAS-INDEXS).
  5949
  5950     IF STATE-SUB (CLAS-INDEXS) NOT = CR-STATE
  5951        ADD +1 TO CLAS-INDEXS
  5952        GO TO 0270-FIND-STATE.
  5953
  5954 0280-PROCESS-LIFE.
  5955
  5956     IF CR-LFTYP = ZEROS OR SPACES
  5957         GO TO 1000-PROCESS-AH.
  5958
  5959     IF CR-LF-DEV-PCT NOT NUMERIC
  5960         MOVE ZEROS TO CR-LF-DEV-PCT.
  5961
  5962     IF DTE-CLIENT  =  'CRI'
  5963         MOVE WK-LF-DEV-CODE      TO  EX-STATE-DEV
  5964     ELSE
  5965         IF CR-LF-DEV-PCT NOT = +0 AND +1.0
  5966             COMPUTE WK-TEMP-DEV-PCT =
  5967                             CR-LF-DEV-PCT * WK-DEV-FACTOR
  5968             MOVE WK-TEMP-DEV     TO  EX-STATE-DEV
  5969         ELSE
  5970             MOVE CR-LF-DEV-CODE  TO  EX-STATE-DEV.
  5971
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS158.cbl
  5972     MOVE 'L'             TO EX-LIFE-AH.
  5973
  5974 0290-CHECK-LF-STATUS.
  5975
  5976     MOVE ZEROS                  TO EX-EXIT-DATE
  5977     MOVE LOW-VALUES             TO EXIT-DT
  5978                                    EXPIRE-DT
  5979
  5980     IF CR-LF-CURRENT-STATUS NOT = '6' AND '7' AND '8'
  5981        GO TO 0300-FIND-LIFE-LOOP.
  5982
  5983     MOVE CR-LF-CANCEL-EXIT-DATE     TO DC-GREG-DATE-CYMD.
  5984     MOVE 'L'                        TO DC-OPTION-CODE.
  5985     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5986     IF NO-CONVERSION-ERROR
  5987        MOVE DC-BIN-DATE-1            TO LF-CAN
  5988     ELSE
  5989        MOVE LOW-VALUES               TO LF-CAN.
  5990
  5991     MOVE CR-LF-CLAIM-EXIT-DATE      TO DC-GREG-DATE-CYMD.
  5992     MOVE 'L'                        TO DC-OPTION-CODE.
  5993     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  5994     IF NO-CONVERSION-ERROR
  5995        MOVE DC-BIN-DATE-1            TO LF-CLM
  5996     ELSE
  5997        MOVE LOW-VALUES               TO LF-CLM.
  5998
  5999     IF LF-CAN = LOW-VALUES AND
  6000        LF-CLM = LOW-VALUES
  6001        GO TO 0300-FIND-LIFE-LOOP.
  6002
  6003     IF LF-CAN = LOW-VALUES AND
  6004        LF-CLM NOT = LOW-VALUES
  6005        MOVE CR-LF-CLAIM-EXIT-DATE TO EX-EXIT-DATE
  6006        GO TO 0300-FIND-LIFE-LOOP.
  6007
  6008     IF LF-CLM = LOW-VALUES
  6009        MOVE CR-LF-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  6010        GO TO 0300-FIND-LIFE-LOOP.
  6011
  6012     IF LF-CAN LESS THAN LF-CLM
  6013        MOVE CR-LF-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  6014        GO TO 0300-FIND-LIFE-LOOP.
  6015
  6016     MOVE CR-LF-CLAIM-EXIT-DATE TO EX-EXIT-DATE.
  6017
  6018 0300-FIND-LIFE-LOOP.
  6019
  6020     IF CLAS-INDEXL GREATER THAN CLAS-MAXL
  6021        MOVE ' INVALID LIFE TYPE ' TO WS-ABEND-MESSAGE
  6022        MOVE CR-LFTYP TO WS-ABEND-FILE-STATUS
  6023        GO TO ABEND-PGM.
  6024
  6025     IF CR-LFTYP NOT = CLAS-I-BEN (CLAS-INDEXL)
  6026        ADD +1 TO CLAS-INDEXL
  6027        GO TO 0300-FIND-LIFE-LOOP.
  6028
  6029     MOVE CLAS-I-EP (CLAS-INDEXL) TO LF-EARN-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS158.cbl
  6030
  6031*    IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  6032*       IF AM-EARN-METHOD-R NOT = SPACES AND ZEROS
  6033*          MOVE AM-EARN-METHOD-R TO LF-EARN-CODE
  6034*       ELSE
  6035*          NEXT SENTENCE
  6036*    ELSE
  6037*       IF AM-EARN-METHOD-L NOT = SPACES AND ZEROS
  6038*          MOVE AM-EARN-METHOD-L TO LF-EARN-CODE.
  6039
  6040 0310-WAS-LIFE-INFORCE.
  6041
  6042     IF EX-EXIT-DATE NOT = ZEROS
  6043        MOVE EX-EXIT-DATE        TO DC-GREG-DATE-CYMD
  6044        MOVE 'L'                 TO DC-OPTION-CODE
  6045        PERFORM 6150-DATE-CONVERSION-ROUTINE
  6046        IF NO-CONVERSION-ERROR
  6047           MOVE DC-BIN-DATE-1    TO EXIT-DT
  6048        ELSE
  6049           MOVE LOW-VALUES       TO EXIT-DT
  6050        END-IF
  6051     END-IF
  6052
  6053     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6054     MOVE 'L'                        TO DC-OPTION-CODE.
  6055     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6056     IF NO-CONVERSION-ERROR
  6057        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  6058     ELSE
  6059        MOVE LOW-VALUES               TO EFFECT-DT.
  6060
  6061     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  6062         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  6063
  6064     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  6065
  6066     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  6067         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  6068         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  6069                                        DC-ELAPSED-DAYS
  6070         MOVE '3'                    TO DC-OPTION-CODE
  6071         PERFORM 6150-DATE-CONVERSION-ROUTINE
  6072         IF NO-CONVERSION-ERROR
  6073             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  6074         ELSE
  6075             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  6076
  6077     IF FIRST-PAY-DT LESS THAN  EFFECT-DT
  6078         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  6079
  6080     IF CR-LOAN-1ST-PMT-DT = ZEROS
  6081         MOVE EFFECT-DT              TO DC-BIN-DATE-1
  6082         MOVE +1                     TO DC-ELAPSED-MONTHS
  6083         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  6084         MOVE '6'                    TO DC-OPTION-CODE
  6085         PERFORM 6150-DATE-CONVERSION-ROUTINE
  6086         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  6087         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS158.cbl
  6088
  6089     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  6090
  6091     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6092        (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  6093        MOVE CR-LF-TERM TO DC-ELAPSED-MONTHS
  6094     ELSE
  6095        COMPUTE DC-ELAPSED-MONTHS = CR-LF-TERM - +1.
  6096
  6097     MOVE '6'                     TO DC-OPTION-CODE.
  6098     move +0                         to dc-elapsed-days
  6099     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6100     IF NO-CONVERSION-ERROR
  6101         MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  6102     ELSE
  6103         MOVE LOW-VALUES           TO EXPIRE-DT.
  6104
  6105     IF (EXPIRE-DT = LOW-VALUES)      OR
  6106         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  6107        MOVE EFFECT-DT               TO DC-BIN-DATE-1
  6108        MOVE CR-LF-TERM              TO DC-ELAPSED-MONTHS
  6109        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  6110        MOVE '6'                     TO DC-OPTION-CODE
  6111        PERFORM 6150-DATE-CONVERSION-ROUTINE
  6112        IF NO-CONVERSION-ERROR
  6113           MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  6114        ELSE
  6115           MOVE LOW-VALUES           TO EXPIRE-DT.
  6116
  6117     MOVE CR-LF-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  6118     MOVE 'L'                    TO DC-OPTION-CODE
  6119     PERFORM 6150-DATE-CONVERSION-ROUTINE
  6120     IF NO-CONVERSION-ERROR
  6121        MOVE DC-BIN-DATE-1       TO EXPIRE-DT
  6122     ELSE
  6123        MOVE LOW-VALUES          TO EXPIRE-DT
  6124     END-IF
  6125
  6126     MOVE +0                         TO DC-ELAPSED-MONTHS
  6127
  6128     MOVE CR-LF-TERM                 TO EX-TERM.
  6129
  6130     IF CR-LF-TERM LESS THAN +60
  6131        MOVE '1'                     TO EX-TERM-CD
  6132     ELSE
  6133        MOVE '2'                     TO EX-TERM-CD.
  6134
  6135     MOVE CR-LFTYP                   TO EX-BEN-TYPE.
  6136
  6137     MOVE CR-LFPRM                   TO EX-PREM
  6138                                        EX-PRIM-FAC-PREM
  6139                                        WS-HOLD-LF-PRIM-FAC.
  6140
  6141     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  6142        MOVE CR-LFPRM-ALT      TO EX-PREM-ALT
  6143                                  EX-PRIM-FAC-PREM-ALT.
  6144
  6145 0315-LIFE-SUMMARY-ADJUSTMENTS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS158.cbl
  6146
  6147     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  6148         GO TO 0320-CHECK-LF-PERIOD-INFORCE.
  6149
  6150     IF CR-LFPRM NOT GREATER CR-LFRFND
  6151         MOVE ZERO                   TO EX-INITIAL-AMT
  6152                                        EX-PREM
  6153     ELSE
  6154         IF CR-LFRFND = ZERO
  6155             MOVE CR-LFAMT           TO EX-INITIAL-AMT
  6156             MOVE CR-LFPRM           TO EX-PREM
  6157         ELSE
  6158             COMPUTE TEMP-3 ROUNDED = CR-LFRFND / CR-LFPRM
  6159             COMPUTE EX-INITIAL-AMT ROUNDED =
  6160                              CR-LFAMT - (CR-LFAMT * TEMP-3)
  6161             COMPUTE EX-PREM ROUNDED =
  6162                              CR-LFPRM - CR-LFRFND.
  6163
  6164     MOVE EX-PREM                    TO CR-LFPRM.
  6165
  6166 0320-CHECK-LF-PERIOD-INFORCE.
  6167
  6168     IF YR GREATER THAN NUMBER-OF-PERIODS
  6169         GO TO 0390-END-PROCESS-LIFE.
  6170
  6171     IF ENTRY-DT GREATER END-DT (YR)
  6172        GO TO 0390-END-PROCESS-LIFE.
  6173
  6174     IF CR-ENTRY-STATUS = '5' OR 'M'
  6175        MOVE +0             TO EX-PREM
  6176                               EX-PREM-ALT
  6177                               EX-PRIM-FAC-PREM
  6178                               EX-PRIM-FAC-PREM-ALT
  6179        GO TO 0360-CALC-LF-REFUND.
  6180
  6181     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  6182        GO TO 0340-END-REM-TERM-LF.
  6183
  6184     MOVE EFFECT-DT         TO DT-START.
  6185     IF BEGIN-DT (YR) GREATER THAN DT-START
  6186        MOVE BEGIN-DT (YR) TO DT-START.
  6187
  6188*    IF EXPIRE-DT NOT GREATER THAN END-DT (YR)
  6189*       MOVE EXPIRE-DT TO DT-END
  6190*    ELSE
  6191*       MOVE END-DT (YR) TO DT-END.
  6192
  6193     IF EXPIRE-DT < END-DT (YR)
  6194        MOVE EXPIRE-DT           TO DT-END
  6195     ELSE
  6196        MOVE END-DT (YR)         TO DT-END
  6197     END-IF
  6198
  6199     IF EXIT-DT NOT = LOW-VALUES
  6200        IF EXIT-DT LESS THAN DT-END
  6201           MOVE EXIT-DT TO DT-END.
  6202
  6203     MOVE DT-START                   TO DC-BIN-DATE-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS158.cbl
  6204     MOVE DT-END                     TO DC-BIN-DATE-2.
  6205     MOVE '1'                        TO DC-OPTION-CODE.
  6206     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6207     IF NO-CONVERSION-ERROR
  6208        MOVE DC-ELAPSED-MONTHS       TO RR (YR)
  6209     ELSE
  6210        MOVE +0                      TO RR (YR).
  6211
  6212     IF RR (YR) LESS THAN +0
  6213        MOVE +0 TO RR (YR).
  6214
  6215     MOVE EXPIRE-DT TO DT-END.
  6216
  6217     IF EXIT-DT NOT = LOW-VALUES
  6218        IF EXIT-DT LESS THAN DT-END
  6219           IF EXIT-DT NOT GREATER THAN END-DT (YR)
  6220              MOVE EXIT-DT TO DT-END.
  6221
  6222     MOVE DT-START                   TO DC-BIN-DATE-1.
  6223     MOVE DT-END                     TO DC-BIN-DATE-2.
  6224     MOVE '1'                        TO DC-OPTION-CODE.
  6225     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6226     IF NO-CONVERSION-ERROR
  6227        MOVE DC-ELAPSED-MONTHS       TO M1 (YR)
  6228     ELSE
  6229        MOVE +0                      TO M1 (YR).
  6230
  6231     IF M1 (YR) LESS THAN +0
  6232        MOVE +0 TO M1 (YR).
  6233
  6234
  6235     IF EXPIRE-DT < END-DT (YR)
  6236        MOVE +0                  TO M2 (YR) M5 (YR)
  6237        GO TO 0330-REM-TERM-LF-BEGIN
  6238     END-IF
  6239
  6240     IF EXIT-DT NOT = LOW-VALUES
  6241        IF EXIT-DT <= END-DT (YR)
  6242           MOVE +0               TO M2 (YR) M5 (YR)
  6243           GO TO 0330-REM-TERM-LF-BEGIN
  6244        END-IF
  6245     END-IF
  6246
  6247     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6248     MOVE 'L'                        TO DC-OPTION-CODE.
  6249     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6250     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6251
  6252     MOVE ENDING-DATE (YR)           TO DC-GREG-DATE-CYMD.
  6253     MOVE 'L'                        TO DC-OPTION-CODE.
  6254     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6255     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  6256
  6257     IF CP-TERM-IS-DAYS
  6258        MOVE CR-LF-TERM-IN-DAYS      TO CP-TERM-OR-EXT-DAYS
  6259     ELSE
  6260        MOVE ZEROS                   TO CP-TERM-OR-EXT-DAYS.
  6261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS158.cbl
  6262     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6263                                        CP-LOAN-TERM.
  6264     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6265     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6266
  6267     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6268       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6269       ADD +1 TO CP-ORIGINAL-TERM CP-LOAN-TERM.
  6270
  6271     MOVE 'Y' TO FROM-LIFE-SW.
  6272     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  6273
  6274     IF REM-TRM2 GREATER CR-LF-TERM
  6275        MOVE CR-LF-TERM TO M2 (YR) M5 (YR)
  6276                           WS-LF-END-REM-TRM1 (YR)
  6277     ELSE
  6278     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6279       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6280        MOVE REM-TRM1       TO M2 (YR)
  6281                               WS-LF-END-REM-TRM1 (YR)
  6282        MOVE LF-BAL-REMTERM TO M5 (YR)
  6283     ELSE
  6284        MOVE REM-TRM1       TO M2 (YR)
  6285                               WS-LF-END-REM-TRM1 (YR)
  6286        MOVE REM-TRM2       TO M5 (YR).
  6287
  6288 0330-REM-TERM-LF-BEGIN.
  6289
  6290     IF (ENTRY-DT GREATER BEGIN-DT (YR)) OR
  6291        (DT-END NOT GREATER BEGIN-DT (YR))
  6292        MOVE +0 TO M3 (YR) M6 (YR)
  6293        GO TO 0340-END-REM-TERM-LF.
  6294
  6295     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6296     MOVE 'L'                        TO DC-OPTION-CODE.
  6297     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6298     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6299
  6300     MOVE BEGIN-DATE (YR)            TO DC-GREG-DATE-CYMD.
  6301     MOVE 'L'                        TO DC-OPTION-CODE.
  6302     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6303     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  6304
  6305     IF CP-TERM-IS-DAYS
  6306        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  6307     ELSE
  6308        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS.
  6309
  6310     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6311                                        CP-LOAN-TERM.
  6312
  6313     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6314     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6315
  6316     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6317       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6318       ADD +1 TO CP-ORIGINAL-TERM CP-LOAN-TERM.
  6319
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS158.cbl
  6320     MOVE 'Y' TO FROM-LIFE-SW.
  6321     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  6322
  6323     IF REM-TRM2 GREATER CR-LF-TERM
  6324        MOVE CR-LF-TERM TO M3 (YR) M6 (YR)
  6325                           WS-LF-BEG-REM-TRM1 (YR)
  6326     ELSE
  6327     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6328       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  6329        MOVE REM-TRM1       TO M3 (YR)
  6330                               WS-LF-BEG-REM-TRM1 (YR)
  6331        MOVE LF-BAL-REMTERM TO M6 (YR)
  6332     ELSE
  6333        MOVE REM-TRM1       TO M3 (YR)
  6334                               WS-LF-BEG-REM-TRM1 (YR)
  6335        MOVE REM-TRM2       TO M6 (YR).
  6336
  6337 0340-END-REM-TERM-LF.
  6338
  6339     IF M5 (YR) GREATER THAN +0
  6340         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  6341             COMPUTE EX-C-CNT (YR) = CR-LIVES -
  6342                                     CR-SUM-CAN-CNT-ITD
  6343         ELSE
  6344             MOVE +1 TO EX-C-CNT (YR).
  6345
  6346     IF DEBUG-LF-INFORCE-CNT
  6347         IF (YR = +1) AND
  6348            (EX-C-CNT (YR) GREATER THAN ZEROS)
  6349             ADD EX-C-CNT (YR) TO WS-S-INFORCE-CNT
  6350             DISPLAY ' CERT ', CR-FULL-CONTROL
  6351                     ' CNT ', EX-C-CNT (YR)
  6352                     ' TOT ', WS-S-INFORCE-CNT.
  6353
  6354     MOVE +0 TO SA.
  6355
  6356 0350-CALC-LIFE-COMMISSIONS.
  6357
  6358     IF (ENTRY-DT GREATER THAN END-DT (YR))
  6359       OR
  6360        (ENTRY-DT NOT GREATER THAN BEGIN-DT (YR))
  6361        GO TO 0360-CALC-LF-REFUND.
  6362
  6363     ADD +1 TO SA.
  6364
  6365     IF SA GREATER THAN +10
  6366        GO TO 0360-CALC-LF-REFUND.
  6367
  6368     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  6369         GO TO 0350-CALC-LIFE-COMMISSIONS.
  6370
  6371     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F'
  6372        COMPUTE AGT-COMM =
  6373         (CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (SA)
  6374        ADD AGT-COMM TO EX-AGT-COMM (YR)
  6375     ELSE
  6376        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B' OR 'S'
  6377           COMPUTE AGT-COMM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS158.cbl
  6378            (CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (SA)
  6379           ADD AGT-COMM TO EX-OVR-COMM (YR).
  6380
  6381     GO TO 0350-CALC-LIFE-COMMISSIONS.
  6382
  6383 0360-CALC-LF-REFUND.
  6384
  6385     IF LF-CAN GREATER THAN BEGIN-DT (YR) AND
  6386        LF-CAN NOT GREATER THAN END-DT (YR)
  6387        MOVE CR-LFRFND     TO EX-CNC-AMT (YR)
  6388     ELSE
  6389        GO TO 0380-FINISH-LIFE-YEAR.
  6390
  6391     MOVE +0 TO SA.
  6392
  6393 0370-CALC-LIFE-REF-COMM.
  6394
  6395     ADD +1 TO SA.
  6396
  6397     IF SA GREATER THAN +10
  6398        GO TO 0380-FINISH-LIFE-YEAR.
  6399
  6400     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  6401         GO TO 0370-CALC-LIFE-REF-COMM.
  6402
  6403     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F'
  6404        COMPUTE AGT-COMM =
  6405         -1 * CR-LFRFND * CR-LCOM-L (SA)
  6406        ADD AGT-COMM TO EX-AGT-COMM (YR)
  6407     ELSE
  6408        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B' OR 'S'
  6409           COMPUTE AGT-COMM =
  6410            -1 * CR-LFRFND * CR-LCOM-L (SA)
  6411           ADD AGT-COMM TO EX-OVR-COMM (YR).
  6412
  6413     GO TO 0370-CALC-LIFE-REF-COMM.
  6414
  6415 0380-FINISH-LIFE-YEAR.
  6416
  6417     ADD +1 TO YR.
  6418     GO TO 0320-CHECK-LF-PERIOD-INFORCE.
  6419
  6420 0390-END-PROCESS-LIFE.
  6421
  6422     IF CR-ENTRY-STATUS = '5' OR 'M'
  6423        GO TO 0400-RELEASE-LIFE-RECORD.
  6424
  6425     IF CR-LF-DEV-PCT NOT NUMERIC
  6426        MOVE +0       TO CR-LF-DEV-PCT.
  6427
  6428     IF DTE-CLIENT = 'CID' OR 'AHL'
  6429        GO TO 0400-RELEASE-LIFE-RECORD
  6430     END-IF
  6431
  6432     IF (CR-STATE = STATE-IL OR STATE-GA OR
  6433                    STATE-NC OR STATE-UT OR STATE-TX OR
  6434                    STATE-IA OR STATE-NE OR STATE-NV OR
  6435                    STATE-OH OR STATE-OR OR STATE-WI)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS158.cbl
  6436                AND
  6437         (RR (1) GREATER THAN +0 OR
  6438          RR (2) GREATER THAN +0 OR
  6439          RR (3) GREATER THAN +0)
  6440        NEXT SENTENCE
  6441     ELSE
  6442     IF DTE-CLIENT  =  'CRI' OR 'CVL' OR 'CID'
  6443         NEXT SENTENCE
  6444     ELSE
  6445         IF (RR (1) GREATER THAN +0 OR
  6446             RR (2) GREATER THAN +0 OR
  6447             RR (3) GREATER THAN +0)
  6448                   AND
  6449            ((CR-LF-DEV-CODE NOT =
  6450                   STATE-PRIM-FAC-DEV (CLAS-INDEXS))
  6451                   OR
  6452            (CR-LF-DEV-PCT NOT = +0 AND +1.0))
  6453             NEXT SENTENCE
  6454         ELSE
  6455             GO TO 0400-RELEASE-LIFE-RECORD.
  6456
  6457*    MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  6458*    MOVE 'L'                        TO DC-OPTION-CODE.
  6459*    PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6460*    MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6461     MOVE END-DT (1)                 TO CP-CERT-EFF-DT
  6462     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  6463     MOVE SPACES                     TO CP-ACCT-FLD-5.
  6464     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  6465     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  6466     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM.
  6467     MOVE CR-LF-CRIT-PERIOD          TO CP-CRITICAL-MONTHS.
  6468     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
  6469                                        CP-LOAN-TERM.
  6470     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
  6471                                        CP-RATING-BENEFIT-AMT.
  6472     MOVE CR-APR                     TO CP-LOAN-APR.
  6473     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  6474     MOVE LF-EARN-CODE               TO CP-EARNING-METHOD.
  6475     MOVE '3'                        TO CP-PROCESS-TYPE.
  6476     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  6477     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  6478        MOVE CR-RATING-CLASS         TO CP-CLASS-CODE
  6479     ELSE
  6480        MOVE AM-CAL-TABLE            TO CP-CLASS-CODE.
  6481
  6482     IF DTE-CLIENT  =  'CRI'
  6483         MOVE WK-LF-DEV-CODE         TO  CP-DEVIATION-CODE
  6484     ELSE
  6485         MOVE STATE-PRIM-FAC-DEV (CLAS-INDEXS)
  6486                                     TO  CP-DEVIATION-CODE.
  6487
  6488     MOVE +0                         TO CP-RATE-DEV-PCT.
  6489     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  6490     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  6491     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
  6492     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  6493     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS158.cbl
  6494     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
  6495
  6496     IF CP-STATE-STD-ABBRV = 'OR'
  6497         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  6498
  6499     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
  6500        COMPUTE CP-ORIGINAL-BENEFIT =
  6501         (CR-LFAMT - CR-LFPRM).
  6502
  6503     IF CP-TRUNCATED-LIFE
  6504        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM.
  6505
  6506     IF CP-TERM-IS-DAYS
  6507        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  6508     ELSE
  6509        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS.
  6510
  6511     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  6512     ADD 1 TO WS-LF-RATE-ATTEMPT.
  6513
  6514     IF DTE-CLIENT = 'CID' OR 'AHL'
  6515        IF CR-LFPRM-CALC NOT NUMERIC
  6516           MOVE +0               TO CR-LFPRM-CALC
  6517        END-IF
  6518        IF CR-LFPRM-CALC = ZEROS
  6519           MOVE CR-LFPRM         TO CR-LFPRM-CALC
  6520        END-IF
  6521     END-IF
  6522
  6523     IF NOT CP-ERROR-OCCURED
  6524        IF (CP-CALC-PREMIUM NOT = +0) AND
  6525           (CR-LFPRM-CALC NOT = +0)
  6526           IF DTE-CLIENT = 'CID'
  6527              COMPUTE WS-DIFF = (CP-CALC-PREMIUM -
  6528                 CR-LFPRM-CALC) / CR-LFPRM-CALC
  6529              IF WS-DIFF < 0
  6530                 COMPUTE WS-DIFF = WS-DIFF * -1
  6531              END-IF
  6532              IF WS-DIFF > 0.02
  6533                 MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  6534                                    WS-HOLD-LF-PRIM-FAC
  6535              END-IF
  6536           ELSE
  6537              MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  6538                                    WS-HOLD-LF-PRIM-FAC
  6539           END-IF
  6540        END-IF
  6541     ELSE
  6542        ADD 1 TO WS-LF-RATE-ERROR
  6543     END-IF
  6544
  6545     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L'
  6546        GO TO 0400-RELEASE-LIFE-RECORD.
  6547
  6548     IF CR-LF-DEV-PCT = +0
  6549        GO TO 0400-RELEASE-LIFE-RECORD.
  6550
  6551     MOVE 'L'          TO CP-BENEFIT-TYPE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS158.cbl
  6552     MOVE '2'          TO CP-EARNING-METHOD.
  6553     MOVE SPACES       TO CP-SPECIAL-CALC-CD.
  6554     MOVE 'LEV'        TO CP-DEVIATION-CODE.
  6555     MOVE CR-LFTYP     TO CP-BENEFIT-CD.
  6556     MOVE CR-LFAMT-ALT TO CP-ORIGINAL-BENEFIT
  6557                          CP-RATING-BENEFIT-AMT.
  6558
  6559     IF CP-STATE-STD-ABBRV = 'OR'
  6560         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  6561
  6562     MOVE CR-LFPRM-ALT TO CP-ORIGINAL-PREMIUM.
  6563     MOVE +0           TO CP-CRITICAL-MONTHS
  6564                          CP-RATE-DEV-PCT.
  6565
  6566     MOVE CR-LF-TERM   TO CP-ORIGINAL-TERM
  6567                          CP-REMAINING-TERM
  6568                          CP-LOAN-TERM.
  6569
  6570     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  6571        ADD +1 TO CP-ORIGINAL-TERM
  6572                  CP-REMAINING-TERM
  6573                  CP-LOAN-TERM.
  6574
  6575     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  6576     ADD 1 TO WS-LF-RATE-ATTEMPT.
  6577
  6578     IF NOT CP-ERROR-OCCURED
  6579        IF CP-CALC-PREMIUM NOT = +0
  6580           MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM-ALT
  6581        ELSE
  6582           NEXT SENTENCE
  6583     ELSE
  6584        ADD 1 TO WS-LF-RATE-ERROR.
  6585
  6586 0400-RELEASE-LIFE-RECORD.
  6587
  6588     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  6589     MOVE 'L'                        TO DC-OPTION-CODE.
  6590     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6591     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  6592
  6593     PERFORM 0410-BUILD-LIFE-CLAIMS
  6594         VARYING YR FROM +1 BY +1
  6595         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6596
  6597     GO TO 0420-END-LIFE-CLAIMS.
  6598
  6599 0410-BUILD-LIFE-CLAIMS.
  6600
  6601     IF CERT-AND-CLAIM
  6602        MOVE WS-CLAIM-AMT (1 1 YR) TO EX-CLAIM-AMT (YR)
  6603        MOVE WS-INC-CNT   (1 1 YR) TO EX-INC-CNT   (YR)
  6604        MOVE WS-PD-CNT    (1 1 YR) TO EX-PD-CNT    (YR).
  6605
  6606 0420-END-LIFE-CLAIMS.
  6607
  6608     IF CR-ENTRY-STATUS = '5' OR 'M'
  6609        GO TO 0460-END-LF-RESERVES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS158.cbl
  6610
  6611     MOVE EX-PREM       TO WRK-C.
  6612     MOVE EX-PREM-ALT   TO WRK-ALT.
  6613
  6614     PERFORM 0480-CALC-LIFE-UNEARN THRU 0540-LIFE-UNEARN-EXIT
  6615         VARYING YR FROM +1 BY +1
  6616         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6617
  6618     PERFORM 0430-BUILD-LF-DEV-RESERVES
  6619         VARYING YR FROM +1 BY +1
  6620         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6621
  6622     GO TO 0440-CALC-LF-PRIM-FAC.
  6623
  6624 0430-BUILD-LF-DEV-RESERVES.
  6625
  6626     IF (DTE-CLIENT = 'CID') AND
  6627        (STATE-ABBR (CLAS-INDEXS) = 'WY') AND
  6628        (CLAS-I-EP (CLAS-INDEXL) = 'T')
  6629           COMPUTE EX-BEG-ST-RES (YR) =
  6630             WS-RED-LF-BEGIN-RES (YR) +
  6631             WS-RED-LF-BEGIN-ALT (YR)
  6632           COMPUTE EX-END-ST-RES (YR) =
  6633             WS-RED-LF-END-RES (YR) +
  6634             WS-RED-LF-END-ALT (YR)
  6635           MOVE EX-BEG-ST-RES (YR) TO
  6636                EX-PRI-BEG-ST-RES (YR)
  6637           MOVE EX-END-ST-RES (YR) TO
  6638                EX-PRI-END-ST-RES (YR)
  6639     ELSE
  6640     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  6641        COMPUTE EX-BEG-ST-RES (YR) =
  6642          WS-LEV-LF-BEGIN-RES (YR) +
  6643          WS-LEV-LF-BEGIN-ALT (YR)
  6644        COMPUTE EX-END-ST-RES (YR) =
  6645          WS-LEV-LF-END-RES (YR) +
  6646          WS-LEV-LF-END-ALT (YR)
  6647          MOVE EX-BEG-ST-RES (YR) TO
  6648               EX-PRI-BEG-ST-RES (YR)
  6649          MOVE EX-END-ST-RES (YR) TO
  6650               EX-PRI-END-ST-RES (YR)
  6651     ELSE
  6652     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  6653        COMPUTE EX-BEG-ST-RES (YR) =
  6654          WS-RED-LF-BEGIN-RES (YR) +
  6655          WS-RED-LF-BEGIN-ALT (YR)
  6656        COMPUTE EX-END-ST-RES (YR) =
  6657          WS-RED-LF-END-RES (YR) +
  6658          WS-RED-LF-END-ALT (YR)
  6659          MOVE EX-BEG-ST-RES (YR) TO
  6660               EX-PRI-BEG-ST-RES (YR)
  6661          MOVE EX-END-ST-RES (YR) TO
  6662               EX-PRI-END-ST-RES (YR)
  6663     ELSE
  6664     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  6665        COMPUTE EX-BEG-ST-RES (YR) =
  6666          WS-RED-LF-BEGIN-RES (YR) +
  6667          WS-LEV-LF-BEGIN-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS158.cbl
  6668        COMPUTE EX-END-ST-RES (YR) =
  6669          WS-RED-LF-END-RES (YR) +
  6670          WS-LEV-LF-END-ALT (YR)
  6671          MOVE EX-BEG-ST-RES (YR) TO
  6672               EX-PRI-BEG-ST-RES (YR)
  6673          MOVE EX-END-ST-RES (YR) TO
  6674               EX-PRI-END-ST-RES (YR)
  6675     ELSE
  6676     IF (STATE-ABBR (CLAS-INDEXS) = 'OH')  AND
  6677        (EX-CAL-TABLE NOT = 'L ') AND
  6678        (EX-TERM GREATER THAN +60)  AND
  6679        (EX-APR GREATER THAN +0)  AND
  6680        (EX-EFF-DATE  GREATER THAN 19831031 )
  6681**      (EX-EFF-DATE  GREATER THAN 199831031 )
  6682           COMPUTE EX-BEG-ST-RES (YR) =
  6683             WS-RED-LF-BEGIN-RES (YR) +
  6684             WS-RED-LF-BEGIN-ALT (YR)
  6685           COMPUTE EX-END-ST-RES (YR) =
  6686             WS-RED-LF-END-RES (YR) +
  6687             WS-RED-LF-END-ALT (YR)
  6688           MOVE EX-BEG-ST-RES (YR) TO
  6689                EX-PRI-BEG-ST-RES (YR)
  6690           MOVE EX-END-ST-RES (YR) TO
  6691                EX-PRI-END-ST-RES (YR)
  6692     ELSE
  6693     IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T') AND
  6694         (DTE-CLIENT NOT = 'MON')
  6695           COMPUTE EX-BEG-ST-RES (YR) =
  6696             WS-RED-LF-BEGIN-RES (YR) +
  6697             WS-RED-LF-BEGIN-ALT (YR)
  6698           COMPUTE EX-END-ST-RES (YR) =
  6699             WS-RED-LF-END-RES (YR) +
  6700             WS-RED-LF-END-ALT (YR)
  6701           MOVE EX-BEG-ST-RES (YR) TO
  6702                EX-PRI-BEG-ST-RES (YR)
  6703           MOVE EX-END-ST-RES (YR) TO
  6704                EX-PRI-END-ST-RES (YR)
  6705     ELSE
  6706     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6707        COMPUTE EX-BEG-ST-RES (YR) =
  6708          WS-LEV-LF-BEGIN-RES (YR) +
  6709          WS-LEV-LF-BEGIN-ALT (YR)
  6710        COMPUTE EX-END-ST-RES (YR) =
  6711          WS-LEV-LF-END-RES (YR) +
  6712          WS-LEV-LF-END-ALT (YR)
  6713        MOVE EX-BEG-ST-RES (YR) TO
  6714             EX-PRI-BEG-ST-RES (YR)
  6715        MOVE EX-END-ST-RES (YR) TO
  6716             EX-PRI-END-ST-RES (YR)
  6717     ELSE
  6718     IF (DTE-CLIENT = 'MON') AND
  6719        (CLAS-I-EP (CLAS-INDEXL) = '2')
  6720          COMPUTE EX-BEG-ST-RES (YR) =
  6721            WS-LEV-LF-BEGIN-RES (YR) +
  6722            WS-LEV-LF-BEGIN-ALT (YR)
  6723          COMPUTE EX-END-ST-RES (YR) =
  6724            WS-LEV-LF-END-RES (YR) +
  6725            WS-LEV-LF-END-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS158.cbl
  6726          MOVE EX-BEG-ST-RES (YR) TO
  6727               EX-PRI-BEG-ST-RES (YR)
  6728          MOVE EX-END-ST-RES (YR) TO
  6729               EX-PRI-END-ST-RES (YR)
  6730     ELSE
  6731        COMPUTE EX-BEG-ST-RES (YR) =
  6732          WS-RED-LF-BEGIN-RES (YR) +
  6733          WS-RED-LF-BEGIN-ALT (YR)
  6734        COMPUTE EX-END-ST-RES (YR) =
  6735          WS-RED-LF-END-RES (YR) +
  6736          WS-RED-LF-END-ALT (YR)
  6737          MOVE EX-BEG-ST-RES (YR) TO
  6738               EX-PRI-BEG-ST-RES (YR)
  6739          MOVE EX-END-ST-RES (YR) TO
  6740               EX-PRI-END-ST-RES (YR).
  6741
  6742     IF CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T'
  6743        MOVE WS-LF-RED-MEAN-INFORCE (YR) TO
  6744             EX-MEAN-INFORCE (YR)
  6745     ELSE
  6746     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6747        MOVE WS-LF-LEV-MEAN-INFORCE (YR) TO
  6748             EX-MEAN-INFORCE (YR)
  6749     ELSE
  6750        MOVE WS-LF-RED-MEAN-INFORCE (YR) TO
  6751             EX-MEAN-INFORCE (YR).
  6752
  6753 0440-CALC-LF-PRIM-FAC.
  6754
  6755     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  6756        MOVE EX-PRIM-FAC-PREM     TO WRK-C
  6757        MOVE EX-PRIM-FAC-PREM-ALT TO WRK-ALT
  6758        PERFORM 0480-CALC-LIFE-UNEARN THRU
  6759                                      0530-CALC-UNEARN-FINISH
  6760            VARYING YR FROM +1 BY +1
  6761            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  6762        PERFORM 0450-BUILD-LF-PRI-RESERVES
  6763            VARYING YR FROM +1 BY +1
  6764            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  6765
  6766     GO TO 0460-END-LF-RESERVES.
  6767
  6768 0450-BUILD-LF-PRI-RESERVES.
  6769
  6770     IF (DTE-CLIENT = 'CID') AND
  6771        (STATE-ABBR (CLAS-INDEXS) = 'WY') AND
  6772        (CLAS-I-EP (CLAS-INDEXL) = 'T')
  6773          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6774            WS-RED-LF-BEGIN-RES (YR) +
  6775            WS-RED-LF-BEGIN-ALT (YR)
  6776          COMPUTE EX-PRI-END-ST-RES (YR) =
  6777            WS-RED-LF-END-RES (YR) +
  6778            WS-RED-LF-END-ALT (YR)
  6779     ELSE
  6780     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  6781        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6782          WS-LEV-LF-BEGIN-RES (YR) +
  6783          WS-LEV-LF-BEGIN-ALT (YR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS158.cbl
  6784        COMPUTE EX-PRI-END-ST-RES (YR) =
  6785          WS-LEV-LF-END-RES (YR) +
  6786          WS-LEV-LF-END-ALT (YR)
  6787     ELSE
  6788     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  6789        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6790          WS-RED-LF-BEGIN-RES (YR) +
  6791          WS-RED-LF-BEGIN-ALT (YR)
  6792        COMPUTE EX-PRI-END-ST-RES (YR) =
  6793          WS-RED-LF-END-RES (YR) +
  6794          WS-RED-LF-END-ALT (YR)
  6795     ELSE
  6796     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  6797        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6798          WS-RED-LF-BEGIN-RES (YR) +
  6799          WS-LEV-LF-BEGIN-ALT (YR)
  6800        COMPUTE EX-PRI-END-ST-RES (YR) =
  6801          WS-RED-LF-END-RES (YR) +
  6802          WS-LEV-LF-END-ALT (YR)
  6803     ELSE
  6804     IF (STATE-ABBR (CLAS-INDEXS) = 'OH')  AND
  6805        (EX-CAL-TABLE NOT = 'L ') AND
  6806        (EX-TERM GREATER THAN +60)  AND
  6807        (EX-APR GREATER THAN +0)  AND
  6808        (EX-EFF-DATE  GREATER THAN  19831031 )
  6809          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6810            WS-RED-LF-BEGIN-RES (YR) +
  6811            WS-RED-LF-BEGIN-ALT (YR)
  6812          COMPUTE EX-PRI-END-ST-RES (YR) =
  6813            WS-RED-LF-END-RES (YR) +
  6814            WS-RED-LF-END-ALT (YR)
  6815     ELSE
  6816     IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR 'T') AND
  6817        (DTE-CLIENT NOT = 'MON')
  6818          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6819            WS-RED-LF-BEGIN-RES (YR) +
  6820            WS-RED-LF-BEGIN-ALT (YR)
  6821          COMPUTE EX-PRI-END-ST-RES (YR) =
  6822            WS-RED-LF-END-RES (YR) +
  6823            WS-RED-LF-END-ALT (YR)
  6824     ELSE
  6825     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  6826        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6827          WS-LEV-LF-BEGIN-RES (YR) +
  6828          WS-LEV-LF-BEGIN-ALT (YR)
  6829        COMPUTE EX-PRI-END-ST-RES (YR) =
  6830          WS-LEV-LF-END-RES (YR) +
  6831          WS-LEV-LF-END-ALT (YR)
  6832     ELSE
  6833     IF (CLAS-I-EP (CLAS-INDEXL) = '2') AND
  6834        (DTE-CLIENT = 'MON')
  6835          COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6836            WS-LEV-LF-BEGIN-RES (YR) +
  6837            WS-LEV-LF-BEGIN-ALT (YR)
  6838          COMPUTE EX-PRI-END-ST-RES (YR) =
  6839            WS-LEV-LF-END-RES (YR) +
  6840            WS-LEV-LF-END-ALT (YR)
  6841     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS158.cbl
  6842        COMPUTE EX-PRI-BEG-ST-RES (YR) =
  6843          WS-RED-LF-BEGIN-RES (YR) +
  6844          WS-RED-LF-BEGIN-ALT (YR)
  6845        COMPUTE EX-PRI-END-ST-RES (YR) =
  6846          WS-RED-LF-END-RES (YR) +
  6847          WS-RED-LF-END-ALT (YR).
  6848
  6849 0460-END-LF-RESERVES.
  6850
  6851     IF DEBUG-LF-STATUTORY
  6852         GO TO 0460-CONTINUE.
  6853
  6854     IF DTE-PGM-OPT NOT = '3' AND '4'
  6855        GO TO 0470-BYPASS-LF-DETAIL.
  6856
  6857     IF M5 (1) = +0
  6858        GO TO 0470-BYPASS-LF-DETAIL.
  6859
  6860 0460-CONTINUE.
  6861
  6862     MOVE EX-CARRIER           TO D-CARR.
  6863     MOVE EX-GROUPING          TO D-GROUP.
  6864     MOVE EX-STATE             TO D-STATE.
  6865     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  6866     MOVE CR-CERT-NO           TO D-CERT-NO.
  6867     MOVE 'L'                  TO DC-OPTION-CODE.
  6868     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  6869     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  6870     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  6871     MOVE EX-PREM              TO D-PREM.
  6872     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM
  6873     MOVE EX-TERM              TO D-TERM.
  6874     MOVE M2 (1)               TO D-REM-TERM.
  6875     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  6876     MOVE EX-INITIAL-AMT       TO D-BENEFIT.
  6877     MOVE 'L'                  TO D-L-A.
  6878     MOVE CLAS-I-AB10 (CLAS-INDEXL) TO D-BEN-DESC.
  6879
  6880     PERFORM 1600-PRINT-A-LINE.
  6881
  6882     IF DEBUG-LF-STATUTORY
  6883         IF EX-END-ST-RES (1) NOT = ZEROS
  6884             ADD +1                TO WS-S-CNT
  6885             ADD EX-END-ST-RES (1) TO WS-S-STATUTORY
  6886             DISPLAY ' CNT ', WS-S-CNT
  6887                     ' TOT ', WS-S-STATUTORY
  6888                     ' RESV ', EX-END-ST-RES (1)
  6889                     ' CERT ', CR-FULL-CONTROL.
  6890
  6891 0470-BYPASS-LF-DETAIL.
  6892
  6893     MOVE CALL-EXTRACT TO HOLD-LIFE-RECORD.
  6894
  6895     IF CR-ENTRY-STATUS NOT = '9'
  6896        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT.
  6897
  6898     GO TO 1000-PROCESS-AH.
  6899
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS158.cbl
  6900 0480-CALC-LIFE-UNEARN.
  6901
  6902     MOVE +0     TO WS-LEV-LF-BEGIN-RES (YR)
  6903                    WS-LEV-LF-BEGIN-ALT (YR)
  6904                    WS-LEV-LF-END-RES (YR)
  6905                    WS-LEV-LF-END-ALT (YR)
  6906                    WS-RED-LF-BEGIN-RES (YR)
  6907                    WS-RED-LF-BEGIN-ALT (YR)
  6908                    WS-RED-LF-END-RES (YR)
  6909                    WS-RED-LF-END-ALT (YR)
  6910                    WRK-B  MEAN-CAL.
  6911
  6912 0490-CALC-LEVEL-BEG.
  6913
  6914     MOVE +0        TO WRK-B   WRK-H.
  6915
  6916     MOVE WS-LF-BEG-REM-TRM1 (YR) TO M4.
  6917
  6918     IF M4 NOT POSITIVE
  6919         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6920            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6921            (M4 = ZEROS) AND (M6 (YR) GREATER THAN +0)
  6922              NEXT SENTENCE
  6923         ELSE
  6924              GO TO 0500-CALC-LEVEL-END.
  6925
  6926     PERFORM 0550-CALC-LEVEL-UNEARN THRU 0590-LEVEL-EXIT.
  6927
  6928     MOVE WRK-B  TO WS-LEV-LF-BEGIN-RES (YR).
  6929     MOVE WRK-H  TO WS-LEV-LF-BEGIN-ALT (YR).
  6930
  6931 0500-CALC-LEVEL-END.
  6932
  6933     MOVE +0        TO WRK-B   WRK-H.
  6934
  6935     MOVE WS-LF-END-REM-TRM1 (YR) TO M4.
  6936
  6937     IF M4 NOT POSITIVE
  6938         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6939            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6940            (M4 = ZEROS) AND (M5 (YR) GREATER THAN +0)
  6941              NEXT SENTENCE
  6942         ELSE
  6943              GO TO 0510-CALC-REDUCE-BEG.
  6944
  6945     PERFORM 0550-CALC-LEVEL-UNEARN THRU 0590-LEVEL-EXIT.
  6946
  6947     MOVE WRK-B  TO WS-LEV-LF-END-RES (YR).
  6948     MOVE WRK-H  TO WS-LEV-LF-END-ALT (YR).
  6949
  6950 0510-CALC-REDUCE-BEG.
  6951
  6952     MOVE +0   TO WRK-B   WRK-H.
  6953
  6954     IF ENTRY-DT GREATER  BEGIN-DT (YR)
  6955        GO TO 0520-CALC-REDUCE-END.
  6956
  6957     MOVE WS-LF-BEG-REM-TRM1 (YR) TO M4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS158.cbl
  6958     MOVE M6 (YR)                TO M9
  6959
  6960     IF M4 NOT POSITIVE
  6961         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6962            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6963            (M4 = ZEROS) AND (M6 (YR) GREATER THAN +0)
  6964              NEXT SENTENCE
  6965         ELSE
  6966              GO TO 0520-CALC-REDUCE-END.
  6967
  6968     PERFORM 0600-CALC-REDUCE-UNEARN THRU 0640-REDUCE-EXIT.
  6969
  6970     MOVE WRK-B  TO WS-RED-LF-BEGIN-RES (YR).
  6971     MOVE WRK-H  TO WS-RED-LF-BEGIN-ALT (YR).
  6972
  6973 0520-CALC-REDUCE-END.
  6974
  6975     MOVE +0   TO WRK-B   WRK-H.
  6976
  6977     IF ENTRY-DT GREATER THAN END-DT (YR)
  6978        GO TO 0530-CALC-UNEARN-FINISH.
  6979
  6980     MOVE WS-LF-END-REM-TRM1 (YR) TO M4.
  6981     MOVE M5 (YR)                TO M9
  6982
  6983     IF M4 NOT POSITIVE
  6984         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  6985            (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L') AND
  6986            (M4 = ZEROS) AND (M5 (YR) GREATER THAN +0)
  6987              NEXT SENTENCE
  6988         ELSE
  6989              GO TO 0530-CALC-UNEARN-FINISH.
  6990
  6991     PERFORM 0600-CALC-REDUCE-UNEARN THRU 0640-REDUCE-EXIT.
  6992
  6993     MOVE WRK-B  TO WS-RED-LF-END-RES (YR).
  6994     MOVE WRK-H  TO WS-RED-LF-END-ALT (YR).
  6995
  6996 0530-CALC-UNEARN-FINISH.
  6997
  6998 0535-DUMMY-PARA.
  6999
  7000     IF (M5 (YR) NOT = +0) OR
  7001        (M6 (YR) NOT = +0)
  7002        PERFORM 0710-LEVEL-MEAN THRU 0730-L-EXIT
  7003        PERFORM 0740-REDUCING-MEAN THRU  0770-R-EXIT.
  7004
  7005 0540-LIFE-UNEARN-EXIT.
  7006     EXIT.
  7007
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS158.cbl
  7009 0550-CALC-LEVEL-UNEARN.
  7010
  7011 0560-CALC-PRO-FACTOR.
  7012
  7013     IF DTE-CLIENT = 'WSL' OR 'FLI' OR 'FLU' OR
  7014                     'MIC' OR 'MCC'
  7015        COMPUTE WRK-D ROUNDED = (M4 - .5) / EX-TERM
  7016     ELSE
  7017        COMPUTE WRK-D ROUNDED = M4 / EX-TERM.
  7018
  7019     IF WRK-D GREATER +1.000
  7020        MOVE +1.000 TO WRK-D.
  7021
  7022 0570-END-CALC-PRO-FACTOR.
  7023
  7024     COMPUTE WRK-B ROUNDED = WRK-D * WRK-C.
  7025
  7026     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  7027        GO TO 0590-LEVEL-EXIT.
  7028
  7029     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L'
  7030        GO TO 0580-COMPUTE-LEV-UNEARN.
  7031
  7032     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  7033        GO TO 0580-COMPUTE-LEV-UNEARN.
  7034
  7035     IF DTE-CLIENT = 'WSL' OR 'FLI' OR 'FLU' OR
  7036                     'MIC' OR 'MCC'
  7037        COMPUTE WRK-D ROUNDED = (M4 + .5) / (EX-TERM + 1)
  7038     ELSE
  7039        COMPUTE WRK-D ROUNDED = (M4 + 1) / (EX-TERM + 1).
  7040
  7041 0580-COMPUTE-LEV-UNEARN.
  7042
  7043     COMPUTE WRK-H ROUNDED = WRK-D * WRK-ALT.
  7044
  7045 0590-LEVEL-EXIT.
  7046     EXIT.
  7047
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS158.cbl
  7049 0600-CALC-REDUCE-UNEARN.
  7050
  7051 0610-CALC-R78-FACTOR.
  7052
  7053     COMPUTE WRK-F = M4 * (M4 + +1).
  7054
  7055     IF DTE-R78 = '1' OR DTE-CLIENT = 'FLI'
  7056         COMPUTE WRK-F = M4 * M4.
  7057
  7058     IF DTE-CLIENT = 'MPP'
  7059        COMPUTE WRK-F = (EX-TERM - M4) *
  7060                       ((EX-TERM - M4) + +1).
  7061
  7062     COMPUTE WRK-G = EX-TERM * (EX-TERM + +1).
  7063     COMPUTE WRK-E ROUNDED = WRK-F / WRK-G.
  7064
  7065     IF WRK-E GREATER +1.000
  7066         MOVE +1.000 TO WRK-E.
  7067
  7068 0620-CALC-R78-FACTOR-END.
  7069
  7070     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  7071
  7072     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  7073        GO TO 0640-REDUCE-EXIT.
  7074
  7075     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  7076         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  7077
  7078     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  7079        IF (DTE-CLIENT = 'CID')
  7080           AND (STATE-ABBR (CLAS-INDEXS) = 'TX' OR 'VA')
  7081           CONTINUE
  7082        ELSE
  7083           PERFORM 0650-TEXAS-REG-RED
  7084                                 THRU 0660-TEXAS-REG-RED-X
  7085           GO TO 0630-COMPUTE-RED-UNEARN
  7086        END-IF
  7087     END-IF
  7088
  7089     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  7090        PERFORM 0690-BALLOON-RED THRU 0700-BALLOON-RED-EXIT
  7091        COMPUTE WRK-H ROUNDED = WRK-E * WRK-ALT
  7092        GO TO 0640-REDUCE-EXIT.
  7093
  7094     if dte-client = 'AHL'
  7095        go to 0640-reduce-exit
  7096     end-if
  7097
  7098     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  7099         GO TO 0640-REDUCE-EXIT.
  7100
  7101     IF (DTE-CLIENT = 'NCL') AND
  7102        (CLAS-I-EP (CLAS-INDEXL) = 'N') AND
  7103        (EX-EFF-DATE  LESS THAN  19910101)
  7104         GO TO 0630-COMPUTE-RED-UNEARN.
  7105
  7106     IF (DTE-CLIENT = 'CID') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS158.cbl
  7107        ((STATE-ABBR (CLAS-INDEXS) = 'TX' OR 'VA')
  7108*       (EX-EFF-DATE > 19911231)
  7109              OR
  7110        ((STATE-ABBR (CLAS-INDEXS) = 'MN')
  7111         AND (EX-EFF-DATE > 20091231)))
  7112        PERFORM 0800-RULE-ANTIC  THRU 0800-EXIT
  7113        GO TO 0640-REDUCE-EXIT
  7114     END-IF
  7115
  7116     IF (CLAS-I-EP (CLAS-INDEXL) = 'N') AND
  7117        (DTE-CLIENT NOT = 'MON') AND
  7118        (CR-APR NOT = +0)
  7119         PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7120         GO TO 0630-COMPUTE-RED-UNEARN.
  7121
  7122*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  7123     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  7124        (EX-CAL-TABLE NOT = 'L ')
  7125         IF (EX-TERM GREATER THAN +60)  AND
  7126            (EX-APR GREATER THAN +0)  AND
  7127            (EX-EFF-DATE  GREATER THAN  19831031)
  7128             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7129             GO TO 0630-COMPUTE-RED-UNEARN.
  7130
  7131     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  7132         IF (EX-TERM GREATER THAN +61)  AND
  7133            (EX-APR GREATER THAN ZERO)  AND
  7134            (EX-EFF-DATE  GREATER THAN  19830318)
  7135             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7136             GO TO 0630-COMPUTE-RED-UNEARN.
  7137
  7138     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  7139         IF (EX-TERM GREATER THAN +62)  AND
  7140            (EX-APR GREATER THAN ZERO)  AND
  7141            (EX-EFF-DATE  GREATER THAN  19810831) AND
  7142            (EX-EFF-DATE  LESS THAN  19830901)
  7143             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7144             GO TO 0630-COMPUTE-RED-UNEARN.
  7145
  7146     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  7147         IF (EX-TERM GREATER THAN +60)  AND
  7148            (EX-APR GREATER THAN ZERO)  AND
  7149            (EX-EFF-DATE  GREATER THAN  19831231)
  7150             PERFORM 0670-NET-PAY-RED THRU 0680-NET-PAY-RED-X
  7151             GO TO 0630-COMPUTE-RED-UNEARN.
  7152
  7153 0630-COMPUTE-RED-UNEARN.
  7154     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  7155
  7156 0640-REDUCE-EXIT.
  7157     EXIT.
  7158
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS158.cbl
  7160 0650-TEXAS-REG-RED.
  7161
  7162     MOVE +0            TO WRK-B.
  7163     IF M4 NOT POSITIVE
  7164         GO TO 0660-TEXAS-REG-RED-X.
  7165
  7166     IF M4 NOT LESS EX-TERM
  7167         MOVE WRK-C     TO WRK-B
  7168         MOVE +1        TO WRK-E
  7169         GO TO 0660-TEXAS-REG-RED-X.
  7170
  7171     COMPUTE TEX-FACT-4 =
  7172         (EX-TERM * EX-TERM) + (EX-PMT-FREQ * EX-TERM).
  7173     DIVIDE M4 BY EX-PMT-FREQ
  7174         GIVING TEX-FACT-5
  7175         REMAINDER TEX-FACT-6.
  7176     COMPUTE TEX-FACT-5 = TEX-FACT-5 * EX-PMT-FREQ.
  7177     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  7178         (TEX-FACT-5 * EX-PMT-FREQ) +
  7179         (2 * (TEX-FACT-6 * (TEX-FACT-5 + EX-PMT-FREQ))).
  7180     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  7181     MOVE TEX-FACT-8   TO WRK-E.
  7182
  7183 0660-TEXAS-REG-RED-X.
  7184     EXIT.
  7185
  7186 0670-NET-PAY-RED.
  7187
  7188     MOVE ZERO          TO WRK-B.
  7189     IF M4 NOT POSITIVE
  7190         GO TO 0680-NET-PAY-RED-X.
  7191
  7192     IF M4 NOT LESS EX-TERM
  7193         MOVE WRK-C     TO WRK-B
  7194         MOVE +1        TO WRK-E
  7195         GO TO 0680-NET-PAY-RED-X.
  7196
  7197     MOVE EX-TERM       TO NP-ORIG, NP-CAP.
  7198     MOVE EX-APR        TO NP-APR.
  7199     MOVE M4            TO NP-REM.
  7200
  7201     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7202     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7203        MOVE EX-CAP-TERM TO NP-ORIG.
  7204
  7205     MOVE 'R' TO NP-OPT.
  7206     CALL 'ECSNETRM' USING
  7207         NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  7208
  7209     MOVE NP-FACTOR  TO WRK-E.
  7210
  7211 0680-NET-PAY-RED-X.
  7212     EXIT.
  7213
  7214 0690-BALLOON-RED.
  7215
  7216     IF CLAS-I-BAL (CLAS-INDEXL) = 'L'
  7217        GO TO 0700-BALLOON-RED-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS158.cbl
  7218
  7219     IF DTE-R78 = '1' OR DTE-CLIENT = 'FLI'
  7220        COMPUTE WRK-F = (M4 + 1) * (M4 + 1)
  7221     ELSE
  7222        COMPUTE WRK-F = (M4 + 1) * (M4 + 2).
  7223
  7224     IF DTE-CLIENT = 'MPP'
  7225        COMPUTE WRK-F = ((EX-TERM + 1) - (M4 + 1)) *
  7226                (((EX-TERM + 1) - (M4 + 1)) + 1).
  7227
  7228     COMPUTE WRK-G = (EX-TERM + 1) * (EX-TERM + 2).
  7229     COMPUTE WRK-E ROUNDED = WRK-F / WRK-G.
  7230
  7231 0700-BALLOON-RED-EXIT.
  7232     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS158.cbl
  7234
  7235 0710-LEVEL-MEAN.
  7236
  7237     MOVE +0 TO WS-LF-LEV-MEAN-INFORCE (YR).
  7238
  7239     IF RR (YR) NOT = +0
  7240        MOVE EX-INITIAL-AMT TO WS-LF-LEV-MEAN-INFORCE (YR)
  7241        ADD CR-LFAMT-ALT    TO WS-LF-LEV-MEAN-INFORCE (YR).
  7242
  7243 0720-IBNR-CALC.
  7244
  7245     IF DTE-CLIENT = 'MON' OR 'DCC' OR 'CID' OR 'AHL'
  7246         GO TO 0730-L-EXIT.
  7247
  7248     IF M6 (YR) POSITIVE
  7249        COMPUTE EX-B-IBNR (YR) =
  7250                EX-B-IBNR (YR) +
  7251                (MEAN-CAL * .0005).
  7252
  7253     IF M5 (YR) POSITIVE
  7254        COMPUTE EX-E-IBNR (YR) =
  7255                EX-E-IBNR (YR) +
  7256                (MEAN-CAL * .0005).
  7257
  7258 0730-L-EXIT.
  7259     EXIT.
  7260
  7261 0740-REDUCING-MEAN.
  7262
  7263     MOVE +0             TO MEAN-CAL
  7264                            WS-LF-RED-MEAN-INFORCE (YR).
  7265
  7266     DIVIDE EX-TERM INTO EX-INITIAL-AMT GIVING WRK-A.
  7267     MOVE RR (YR)        TO  WORK-M4.
  7268
  7269     IF DTE-CLIENT NOT = 'MON' AND 'CID' AND 'DCC' AND 'AHL'
  7270         IF M6 (YR) POSITIVE
  7271             COMPUTE EX-B-IBNR (YR) =
  7272             EX-B-IBNR (YR) + ((M6 (YR) * WRK-A) * .0005).
  7273
  7274 0750-R-MEAN.
  7275
  7276     COMPUTE  MEAN-CAL  =  MEAN-CAL  +  (M1 (YR) * WRK-A) +
  7277                           CR-LFAMT-ALT.
  7278     COMPUTE  M1 (YR) =  M1 (YR) - +1.
  7279     COMPUTE  WORK-M4  =  WORK-M4  -  +1.
  7280
  7281     IF WORK-M4  GREATER  ZERO
  7282         GO  TO  0750-R-MEAN.
  7283
  7284     IF RR (YR) NOT = +0
  7285        DIVIDE RR (YR) INTO MEAN-CAL GIVING MEAN-CAL.
  7286
  7287     MOVE MEAN-CAL TO WS-LF-RED-MEAN-INFORCE (YR).
  7288
  7289     IF DTE-CLIENT NOT = 'MON' AND 'CID' AND 'DCC' AND 'AHL'
  7290         IF M5 (YR) POSITIVE
  7291             COMPUTE EX-E-IBNR (YR) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS158.cbl
  7292             EX-E-IBNR (YR) + ((M5 (YR) * WRK-A) * .0005).
  7293
  7294     GO TO 0770-R-EXIT.
  7295
  7296 0760-R-NET-PAY-MEAN.
  7297
  7298     MOVE M3 (YR)                  TO NP-ORIG NP-REM NP-CAP.
  7299     MOVE EX-APR                   TO NP-APR.
  7300     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7301
  7302     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7303        MOVE EX-CAP-TERM TO NP-ORIG.
  7304
  7305     CALL 'ECSNETRM' USING
  7306        NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP,  NP-FACTOR.
  7307
  7308     COMPUTE NP-WORK1 = NP-FACTOR * 6.5
  7309     MOVE M2 (YR)                  TO NP-ORIG NP-REM NP-CAP.
  7310     MOVE EX-APR                   TO NP-APR.
  7311     MOVE CLAS-I-BAL (CLAS-INDEXL) TO NP-OPT.
  7312
  7313     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  7314        MOVE EX-CAP-TERM TO NP-ORIG.
  7315
  7316     CALL 'ECSNETRM' USING
  7317        NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  7318
  7319     COMPUTE  NP-WORK2 = NP-FACTOR * 6.5
  7320     SUBTRACT NP-WORK2 FROM NP-WORK1.
  7321
  7322     COMPUTE MEAN-CAL = NP-WORK1 * (EX-INITIAL-AMT / +1000)
  7323     IF RR (YR) NOT = +0
  7324        DIVIDE RR (YR) INTO MEAN-CAL GIVING MEAN-CAL.
  7325
  7326     MOVE MEAN-CAL TO WS-LF-RED-MEAN-INFORCE (YR).
  7327
  7328 0770-R-EXIT.
  7329     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS158.cbl
  7331
  7332 0800-RULE-ANTIC.
  7333
  7334     PERFORM 1700-CALC-REM-AMT   THRU 1799-EXIT
  7335
  7336     MOVE EFFECT-DT              TO  CP-CERT-EFF-DT
  7337
  7338     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  7339        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  7340        MOVE '3'                 TO  DC-OPTION-CODE
  7341        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7342        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  7343     ELSE
  7344        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  7345        MOVE +1                  TO  DC-ELAPSED-MONTHS
  7346        MOVE +0                  TO  DC-ELAPSED-DAYS
  7347        MOVE '6'                 TO  DC-OPTION-CODE
  7348        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7349        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  7350     END-IF
  7351     MOVE M4                     TO  CP-REMAINING-TERM
  7352     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  7353                                 TO CP-BENEFIT-TYPE
  7354     MOVE SPACES                 TO CP-ACCT-FLD-5
  7355     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  7356     MOVE CR-AGE                 TO CP-ISSUE-AGE
  7357     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  7358     MOVE CR-LF-CRIT-PERIOD      TO CP-CRITICAL-MONTHS
  7359     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  7360                                    CP-LOAN-TERM
  7361     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
  7362                                    CP-RATING-BENEFIT-AMT
  7363     MOVE WS-REM-AMT             TO CP-REMAINING-BENEFIT
  7364     MOVE CR-APR                 TO CP-LOAN-APR
  7365     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  7366     MOVE LF-EARN-CODE           TO CP-RATING-METHOD
  7367     MOVE '6'                    TO CP-EARNING-METHOD
  7368     MOVE '3'                    TO CP-PROCESS-TYPE
  7369     MOVE ' '                    TO CP-SPECIAL-CALC-CD
  7370     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  7371        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  7372     ELSE
  7373        MOVE AM-CAL-TABLE        TO CP-CLASS-CODE
  7374     END-IF
  7375
  7376     MOVE CR-LF-DEV-CODE         TO  CP-DEVIATION-CODE
  7377
  7378     MOVE CR-LF-DEV-PCT              TO CP-RATE-DEV-PCT
  7379     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  7380     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  7381     MOVE CR-LFTYP                   TO CP-BENEFIT-CD
  7382     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  7383     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS
  7384     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE
  7385
  7386     IF CP-STATE-STD-ABBRV = 'OR'
  7387        COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT
  7388     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS158.cbl
  7389
  7390     IF (CP-RATE-AS-STANDARD) AND (CP-EARN-AS-NET-PAY)
  7391        COMPUTE CP-ORIGINAL-BENEFIT =
  7392         (CR-LFAMT - CR-LFPRM)
  7393     END-IF
  7394
  7395     IF CP-TRUNCATED-LIFE
  7396        MOVE CR-LOAN-TERM            TO CP-LOAN-TERM
  7397     END-IF
  7398
  7399     IF CP-TERM-IS-DAYS
  7400        MOVE CR-LF-TERM-IN-DAYS    TO CP-TERM-OR-EXT-DAYS
  7401     ELSE
  7402        MOVE ZEROS                 TO CP-TERM-OR-EXT-DAYS
  7403     END-IF
  7404
  7405     CALL 'ELRFNDX' USING CALCULATION-PASS-AREA
  7406     MOVE CP-CALC-REFUND         TO WRK-B
  7407
  7408     .
  7409 0800-EXIT.
  7410     EXIT.
  7411
  7412 1000-PROCESS-AH.
  7413
  7414     MOVE ZEROS               TO  EX-EXIT-DATE.
  7415     MOVE INITIALIZED-BACK    TO  EX-DATA-BY-YEAR (1)
  7416                                  EX-DATA-BY-YEAR (2)
  7417                                  EX-DATA-BY-YEAR (3).
  7418
  7419     IF CR-AHTYP = ZEROS OR SPACES
  7420        GO TO 1400-CHECK-IF-REINSURANCE.
  7421
  7422     IF CR-AH-DEV-PCT NOT NUMERIC
  7423         MOVE ZEROS TO CR-AH-DEV-PCT.
  7424
  7425     IF DTE-CLIENT  = 'CRI'
  7426         MOVE WK-AH-DEV-CODE     TO  EX-STATE-DEV
  7427     ELSE
  7428         IF CR-AH-DEV-PCT NOT = +0 AND +1.0
  7429             COMPUTE WK-TEMP-DEV-PCT =
  7430                             CR-AH-DEV-PCT * WK-DEV-FACTOR
  7431             MOVE WK-TEMP-DEV    TO  EX-STATE-DEV
  7432         ELSE
  7433             MOVE CR-AH-DEV-CODE TO  EX-STATE-DEV.
  7434
  7435     MOVE 'A'             TO EX-LIFE-AH.
  7436
  7437 1010-CHECK-AH-STATUS.
  7438
  7439     MOVE +2 TO LIFE-AH-SUB.
  7440     MOVE +1 TO YR.
  7441
  7442     IF CR-AH-CURRENT-STATUS NOT = '6' AND '7' AND '8'
  7443        GO TO 1020-FIND-AH-LOOP.
  7444
  7445     MOVE CR-AH-CANCEL-EXIT-DATE     TO DC-GREG-DATE-CYMD.
  7446     MOVE 'L'                        TO DC-OPTION-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS158.cbl
  7447     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7448     IF NO-CONVERSION-ERROR
  7449        MOVE DC-BIN-DATE-1            TO AH-CAN
  7450     ELSE
  7451        MOVE LOW-VALUES               TO AH-CAN.
  7452
  7453     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO DC-GREG-DATE-CYMD.
  7454     MOVE 'L'                        TO DC-OPTION-CODE.
  7455     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7456     IF NO-CONVERSION-ERROR
  7457        MOVE DC-BIN-DATE-1            TO AH-CLM
  7458     ELSE
  7459        MOVE LOW-VALUES               TO AH-CLM.
  7460
  7461     IF AH-CAN = LOW-VALUES AND
  7462        AH-CLM = LOW-VALUES
  7463        GO TO 1020-FIND-AH-LOOP.
  7464
  7465     IF AH-CAN = LOW-VALUES AND
  7466        AH-CLM NOT = LOW-VALUES
  7467        MOVE CR-AH-SETTLEMENT-EXIT-DATE TO EX-EXIT-DATE
  7468        GO TO 1020-FIND-AH-LOOP.
  7469
  7470     IF AH-CLM = LOW-VALUES
  7471         MOVE CR-AH-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  7472         GO TO 1020-FIND-AH-LOOP.
  7473
  7474     IF AH-CAN LESS THAN AH-CLM
  7475         MOVE CR-AH-CANCEL-EXIT-DATE TO EX-EXIT-DATE
  7476         GO TO 1020-FIND-AH-LOOP.
  7477
  7478     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO EX-EXIT-DATE.
  7479
  7480 1020-FIND-AH-LOOP.
  7481
  7482
  7483     IF CLAS-INDEXA GREATER THAN CLAS-MAXA
  7484        MOVE ' INVALID AH   TYPE ' TO WS-ABEND-MESSAGE
  7485        MOVE CR-AHTYP TO WS-ABEND-FILE-STATUS
  7486        GO TO ABEND-PGM.
  7487
  7488     IF CR-AHTYP NOT = CLAS-I-BEN (CLAS-INDEXA)
  7489        ADD +1 TO CLAS-INDEXA
  7490        GO TO 1020-FIND-AH-LOOP.
  7491
  7492     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
  7493
  7494*    IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  7495*       IF AM-EARN-METHOD-A NOT = SPACES AND ZEROS
  7496*          MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
  7497
  7498     if dte-client = 'AHL'
  7499        move 'R'                 to type-method
  7500     else
  7501        PERFORM 1300-FIND-METHOD THRU 1310-METHOD-EXIT
  7502     end-if
  7503
  7504
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS158.cbl
  7505
  7506     MOVE EX-EXIT-DATE               TO DC-GREG-DATE-CYMD.
  7507     MOVE 'L'                        TO DC-OPTION-CODE.
  7508     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7509     IF NO-CONVERSION-ERROR
  7510        MOVE DC-BIN-DATE-1            TO EXIT-DT
  7511     ELSE
  7512        MOVE LOW-VALUES               TO EXIT-DT.
  7513
  7514     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7515     MOVE 'L'                        TO DC-OPTION-CODE.
  7516     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7517     IF NO-CONVERSION-ERROR
  7518        MOVE DC-BIN-DATE-1            TO EFFECT-DT
  7519     ELSE
  7520        MOVE LOW-VALUES               TO EFFECT-DT.
  7521
  7522     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  7523         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  7524
  7525     MOVE LOW-VALUES             TO     FIRST-PAY-DT.
  7526
  7527     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  7528         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  7529         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  7530                                        DC-ELAPSED-DAYS
  7531         MOVE '3'                    TO DC-OPTION-CODE
  7532         PERFORM 6150-DATE-CONVERSION-ROUTINE
  7533         IF NO-CONVERSION-ERROR
  7534             MOVE DC-BIN-DATE-1      TO FIRST-PAY-DT
  7535         ELSE
  7536             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  7537
  7538     IF FIRST-PAY-DT  LESS THAN  EFFECT-DT
  7539         MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT.
  7540
  7541     IF CR-LOAN-1ST-PMT-DT = ZEROS
  7542         MOVE EFFECT-DT              TO DC-BIN-DATE-1
  7543         MOVE +1                     TO DC-ELAPSED-MONTHS
  7544         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7545         MOVE '6'                    TO DC-OPTION-CODE
  7546         PERFORM 6150-DATE-CONVERSION-ROUTINE
  7547         MOVE DC-BIN-DATE-2          TO FIRST-PAY-DT
  7548         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  7549
  7550     MOVE FIRST-PAY-DT            TO DC-BIN-DATE-1.
  7551     COMPUTE DC-ELAPSED-MONTHS = CR-AH-TERM - +1
  7552     MOVE ZEROS                   TO DC-ELAPSED-DAYS.
  7553     MOVE '6'                     TO DC-OPTION-CODE.
  7554     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7555     IF NO-CONVERSION-ERROR
  7556         MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  7557     ELSE
  7558         MOVE LOW-VALUES           TO EXPIRE-DT.
  7559
  7560     IF (EXPIRE-DT = LOW-VALUES)      OR
  7561         (DTE-REM-TRM-CALC-OPTION = '1' OR '2')
  7562        MOVE EFFECT-DT               TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS158.cbl
  7563        MOVE CR-AH-TERM              TO DC-ELAPSED-MONTHS
  7564        MOVE ZEROS                   TO DC-ELAPSED-DAYS
  7565        MOVE '6'                     TO DC-OPTION-CODE
  7566        PERFORM 6150-DATE-CONVERSION-ROUTINE
  7567        IF NO-CONVERSION-ERROR
  7568           MOVE DC-BIN-DATE-2        TO EXPIRE-DT
  7569        ELSE
  7570           MOVE LOW-VALUES           TO EXPIRE-DT.
  7571
  7572     MOVE CR-AH-EXPIRE-DATE      TO DC-GREG-DATE-CYMD
  7573     MOVE 'L'                    TO DC-OPTION-CODE
  7574     PERFORM 6150-DATE-CONVERSION-ROUTINE
  7575     IF NO-CONVERSION-ERROR
  7576        MOVE DC-BIN-DATE-1       TO EXPIRE-DT
  7577     ELSE
  7578        MOVE LOW-VALUES          TO EXPIRE-DT
  7579     END-IF
  7580
  7581     MOVE +0                         TO DC-ELAPSED-MONTHS
  7582
  7583     MOVE CR-AH-TERM         TO EX-TERM
  7584
  7585     IF CR-AH-TERM LESS THAN +60
  7586        MOVE '1' TO EX-TERM-CD
  7587     ELSE
  7588        MOVE '2' TO EX-TERM-CD.
  7589
  7590     MOVE CR-AHTYP           TO EX-BEN-TYPE.
  7591
  7592     MOVE CR-AHPRM          TO EX-PREM
  7593                               EX-PRIM-FAC-PREM
  7594                               WS-HOLD-AH-PRIM-FAC.
  7595
  7596 1035-A-H-SUMMARY-ADJUSTMENTS.
  7597
  7598     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
  7599         GO TO 1040-CHECK-AH-PERIOD-INFORCE.
  7600
  7601     IF CR-AHPRM NOT GREATER CR-AHRFND
  7602         MOVE ZERO                   TO EX-BENEFIT
  7603                                        EX-PREM
  7604     ELSE
  7605         IF CR-AHRFND = ZERO
  7606             MOVE CR-AHAMT           TO EX-BENEFIT
  7607             MOVE CR-AHPRM           TO EX-PREM
  7608         ELSE
  7609             COMPUTE TEMP-3 ROUNDED = CR-AHRFND / CR-AHPRM
  7610             COMPUTE EX-BENEFIT ROUNDED =
  7611                              CR-AHAMT - (CR-AHAMT * TEMP-3)
  7612             COMPUTE EX-PREM ROUNDED =
  7613                              CR-AHPRM - CR-AHRFND.
  7614
  7615     MOVE EX-PREM                    TO CR-AHPRM.
  7616
  7617 1040-CHECK-AH-PERIOD-INFORCE.
  7618
  7619     IF YR GREATER THAN NUMBER-OF-PERIODS
  7620         GO TO 1110-END-PROCESS-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS158.cbl
  7621
  7622     IF ENTRY-DT GREATER END-DT (YR)
  7623        GO TO 1110-END-PROCESS-AH.
  7624
  7625     IF CR-ENTRY-STATUS = '5' OR 'M'
  7626        MOVE +0                TO EX-PREM
  7627                                  EX-PRIM-FAC-PREM
  7628                                  WS-HOLD-AH-PRIM-FAC
  7629        GO TO 1080-CALC-AH-REFUND.
  7630
  7631     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
  7632        GO TO 1060-END-REM-TERM-AH.
  7633
  7634     MOVE EFFECT-DT         TO DT-START.
  7635     IF BEGIN-DT (YR) GREATER THAN DT-START
  7636        MOVE BEGIN-DT (YR) TO DT-START.
  7637
  7638*    IF EXPIRE-DT NOT GREATER THAN END-DT (YR)
  7639*       MOVE EXPIRE-DT TO DT-END
  7640*    ELSE
  7641*       MOVE END-DT (YR) TO DT-END.
  7642
  7643     IF EXPIRE-DT < END-DT (YR)
  7644        MOVE EXPIRE-DT           TO DT-END
  7645     ELSE
  7646        MOVE END-DT (YR)         TO DT-END
  7647     END-IF
  7648
  7649     IF EXIT-DT NOT = LOW-VALUES
  7650        IF EXIT-DT LESS THAN DT-END
  7651           MOVE EXIT-DT TO DT-END.
  7652
  7653     MOVE DT-START                   TO DC-BIN-DATE-1.
  7654     MOVE DT-END                     TO DC-BIN-DATE-2.
  7655     MOVE '1'                        TO DC-OPTION-CODE.
  7656     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7657     IF NO-CONVERSION-ERROR
  7658        MOVE DC-ELAPSED-MONTHS       TO RR (YR)
  7659     ELSE
  7660        MOVE +0                      TO RR (YR).
  7661
  7662     IF RR (YR) LESS THAN +0
  7663        MOVE +0 TO RR (YR).
  7664
  7665     MOVE EXPIRE-DT TO DT-END.
  7666
  7667     IF EXIT-DT NOT = LOW-VALUES
  7668        IF EXIT-DT LESS THAN DT-END
  7669            IF EXIT-DT NOT GREATER THAN END-DT (YR)
  7670                MOVE EXIT-DT TO DT-END.
  7671
  7672     MOVE DT-START                   TO DC-BIN-DATE-1.
  7673     MOVE DT-END                     TO DC-BIN-DATE-2.
  7674     MOVE '1'                        TO DC-OPTION-CODE.
  7675     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7676     IF NO-CONVERSION-ERROR
  7677        MOVE DC-ELAPSED-MONTHS       TO M1 (YR)
  7678     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS158.cbl
  7679        MOVE +0                      TO M1 (YR).
  7680
  7681     IF M1 (YR) LESS THAN +0
  7682        MOVE +0 TO M1 (YR).
  7683
  7684     IF EXPIRE-DT < END-DT (YR)
  7685        MOVE +0                  TO M2 (YR) M5 (YR)
  7686        GO TO 1050-REM-TERM-AH-BEGIN
  7687     END-IF
  7688
  7689     IF EXIT-DT NOT = LOW-VALUES
  7690        IF EXIT-DT <= END-DT (YR)
  7691           MOVE +0               TO M2 (YR) M5 (YR)
  7692        GO TO 1050-REM-TERM-AH-BEGIN
  7693        END-IF
  7694     END-IF
  7695
  7696*    IF DT-END <= END-DT (YR)
  7697*        MOVE +0 TO M2 (YR) M5 (YR)
  7698*        GO TO 1050-REM-TERM-AH-BEGIN.
  7699
  7700     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7701     MOVE 'L'                        TO DC-OPTION-CODE.
  7702     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7703     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7704
  7705     MOVE ENDING-DATE(YR)            TO DC-GREG-DATE-CYMD.
  7706     MOVE 'L'                        TO DC-OPTION-CODE.
  7707     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7708     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  7709
  7710     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
  7711
  7712     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7713                                        CP-LOAN-TERM.
  7714     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  7715     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7716     MOVE 'N' TO FROM-LIFE-SW.
  7717     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  7718
  7719     IF REM-TRM2 GREATER CR-AH-TERM
  7720        MOVE CR-AH-TERM TO M2 (YR) M5 (YR)
  7721                           WS-AH-END-REM-TRM1 (YR)
  7722     ELSE
  7723        MOVE REM-TRM1 TO M2 (YR)
  7724                         WS-AH-END-REM-TRM1 (YR)
  7725        MOVE REM-TRM2 TO M5 (YR).
  7726
  7727 1050-REM-TERM-AH-BEGIN.
  7728
  7729     IF (ENTRY-DT GREATER BEGIN-DT (YR)) OR
  7730        (DT-END NOT GREATER BEGIN-DT (YR))
  7731        MOVE +0 TO M3 (YR) M6 (YR)
  7732        GO TO 1060-END-REM-TERM-AH.
  7733
  7734     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  7735     MOVE 'L'                        TO DC-OPTION-CODE.
  7736     PERFORM 6150-DATE-CONVERSION-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS158.cbl
  7737     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7738
  7739     MOVE BEGIN-DATE(YR)             TO DC-GREG-DATE-CYMD.
  7740     MOVE 'L'                        TO DC-OPTION-CODE.
  7741     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7742     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  7743
  7744     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
  7745
  7746     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7747                                        CP-LOAN-TERM.
  7748
  7749     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  7750     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7751     MOVE 'N' TO FROM-LIFE-SW.
  7752     PERFORM 6000-CALC-REM-TERM THRU 6010-REM-TERM-EXIT.
  7753
  7754     IF REM-TRM2 GREATER CR-AH-TERM
  7755        MOVE CR-AH-TERM TO M3 (YR) M6 (YR)
  7756                           WS-AH-BEG-REM-TRM1 (YR)
  7757     ELSE
  7758        MOVE REM-TRM1 TO M3 (YR)
  7759                         WS-AH-BEG-REM-TRM1 (YR)
  7760        MOVE REM-TRM2 TO M6 (YR).
  7761
  7762 1060-END-REM-TERM-AH.
  7763
  7764     IF M5 (YR) GREATER THAN +0
  7765         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  7766             COMPUTE EX-C-CNT (YR) = CR-LIVES -
  7767                                     CR-SUM-CAN-CNT-ITD
  7768         ELSE
  7769             MOVE +1 TO EX-C-CNT (YR).
  7770
  7771     IF DEBUG-AH-INFORCE-CNT
  7772         IF (YR = +1) AND
  7773            (EX-C-CNT (YR) GREATER THAN ZEROS)
  7774             ADD EX-C-CNT (YR) TO WS-S-INFORCE-CNT
  7775             DISPLAY ' CERT ', CR-FULL-CONTROL
  7776                     ' CNT ', EX-C-CNT (YR)
  7777                     ' TOT ', WS-S-INFORCE-CNT.
  7778
  7779     MOVE +0 TO SA.
  7780
  7781 1070-CALC-AH-COMMISSIONS.
  7782
  7783     IF (ENTRY-DT GREATER THAN END-DT (YR))
  7784       OR
  7785        (ENTRY-DT NOT GREATER THAN BEGIN-DT (YR))
  7786        GO TO 1080-CALC-AH-REFUND.
  7787
  7788     IF CR-ENTRY-STATUS = '5' OR 'M'
  7789        GO TO 1080-CALC-AH-REFUND.
  7790
  7791     ADD +1 TO SA.
  7792
  7793     IF SA GREATER THAN +10
  7794        GO TO 1080-CALC-AH-REFUND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS158.cbl
  7795
  7796     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  7797         GO TO 1070-CALC-AH-COMMISSIONS.
  7798
  7799     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F'
  7800        COMPUTE AGT-COMM =
  7801         CR-AHPRM * CR-LCOM-AH (SA)
  7802         ADD AGT-COMM TO EX-AGT-COMM (YR)
  7803     ELSE
  7804        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B' OR 'S'
  7805           COMPUTE AGT-COMM =
  7806            CR-AHPRM * CR-LCOM-AH (SA)
  7807            ADD AGT-COMM TO EX-OVR-COMM (YR).
  7808
  7809     GO TO 1070-CALC-AH-COMMISSIONS.
  7810
  7811 1080-CALC-AH-REFUND.
  7812
  7813     IF AH-CAN GREATER THAN BEGIN-DT (YR) AND
  7814        AH-CAN NOT GREATER THAN END-DT (YR)
  7815        MOVE CR-AHRFND     TO EX-CNC-AMT (YR)
  7816     ELSE
  7817        GO TO 1100-FINISH-AH-YEAR.
  7818
  7819     MOVE +0 TO SA.
  7820
  7821 1090-CALC-AH-REF-COMM.
  7822
  7823     ADD +1 TO SA.
  7824
  7825     IF SA GREATER THAN +10
  7826        GO TO 1100-FINISH-AH-YEAR.
  7827
  7828     IF CR-COM-AGT (SA) = ZEROS OR SPACES
  7829         GO TO 1090-CALC-AH-REF-COMM.
  7830
  7831     IF CR-AGT-TYPE (SA) = 'C' OR 'D' OR 'F'
  7832        COMPUTE AGT-COMM = -1 * CR-AHRFND * CR-LCOM-AH (SA)
  7833        ADD AGT-COMM TO EX-AGT-COMM (YR)
  7834     ELSE
  7835        IF CR-AGT-TYPE (SA) = 'O' OR 'P' OR 'G' OR 'B' OR 'S'
  7836           COMPUTE AGT-COMM = -1 * CR-AHRFND * CR-LCOM-AH (SA)
  7837           ADD AGT-COMM TO EX-OVR-COMM (YR).
  7838
  7839     GO TO 1090-CALC-AH-REF-COMM.
  7840
  7841 1100-FINISH-AH-YEAR.
  7842
  7843     ADD +1 TO YR.
  7844     GO TO 1040-CHECK-AH-PERIOD-INFORCE.
  7845
  7846 1110-END-PROCESS-AH.
  7847
  7848     IF CR-ENTRY-STATUS = '5' OR 'M'
  7849        GO TO 1120-RELEASE-AH-RECORD.
  7850
  7851     IF CR-AH-DEV-PCT NOT NUMERIC
  7852        MOVE +0       TO CR-AH-DEV-PCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS158.cbl
  7853
  7854     IF DTE-CLIENT = 'CID' OR 'AHL'
  7855        GO TO 1120-RELEASE-AH-RECORD
  7856     END-IF
  7857
  7858     IF (CR-STATE =  STATE-IL OR STATE-GA OR
  7859         STATE-NC OR STATE-UT OR STATE-TX OR
  7860         STATE-IA OR STATE-NE OR STATE-NV OR
  7861         STATE-OH OR STATE-OR OR STATE-WI)
  7862                     AND
  7863         (RR (1) GREATER THAN +0 OR
  7864          RR (2) GREATER THAN +0 OR
  7865          RR (3) GREATER THAN +0)
  7866        NEXT SENTENCE
  7867     ELSE
  7868     IF DTE-CLIENT = 'CRI' OR 'CVL' OR 'CID'
  7869         NEXT SENTENCE
  7870     ELSE
  7871         IF (RR (1) GREATER THAN +0 OR
  7872             RR (2) GREATER THAN +0 OR
  7873             RR (3) GREATER THAN +0)
  7874           AND ((CR-AH-DEV-CODE NOT =
  7875                   STATE-PRIM-FAC-DEV (CLAS-INDEXS))
  7876           OR (CR-AH-DEV-PCT NOT = +0 AND +1.0))
  7877             NEXT SENTENCE
  7878         ELSE
  7879             GO TO 1120-RELEASE-AH-RECORD.
  7880
  7881     MOVE EP-DT                      TO DC-GREG-DATE-CYMD.
  7882     MOVE 'L'                        TO DC-OPTION-CODE.
  7883     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  7884     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  7885     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  7886     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  7887     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  7888     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  7889     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  7890     IF CR-RATING-CLASS NOT = SPACES AND ZEROS
  7891        MOVE CR-RATING-CLASS         TO CP-CLASS-CODE
  7892     ELSE
  7893        MOVE AM-CAL-TABLE            TO CP-CLASS-CODE.
  7894
  7895     IF DTE-CLIENT = 'CRI'
  7896         MOVE WK-AH-DEV-CODE     TO  CP-DEVIATION-CODE
  7897     ELSE
  7898         MOVE STATE-PRIM-FAC-DEV (CLAS-INDEXS)
  7899                                 TO  CP-DEVIATION-CODE.
  7900
  7901     MOVE +0                         TO CP-RATE-DEV-PCT.
  7902     MOVE 'A'                        TO CP-BENEFIT-TYPE.
  7903     MOVE '3'                        TO CP-PROCESS-TYPE.
  7904     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  7905     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
  7906                                        CP-LOAN-TERM.
  7907     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
  7908                                        CP-RATING-BENEFIT-AMT.
  7909     IF CP-STATE-STD-ABBRV = 'OR'
  7910         COMPUTE CP-RATING-BENEFIT-AMT =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS158.cbl
  7911                                 CR-AHAMT * CR-AH-TERM.
  7912     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY
  7913     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  7914     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  7915     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  7916     MOVE CR-APR                     TO CP-LOAN-APR.
  7917     MOVE CR-AH-CRIT-PERIOD          TO CP-CRITICAL-MONTHS.
  7918     MOVE SPACES                     TO CP-ACCT-FLD-5.
  7919     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  7920
  7921     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  7922
  7923     ADD 1 TO WS-AH-RATE-ATTEMPT.
  7924
  7925     IF DTE-CLIENT = 'CID' OR 'AHL'
  7926        IF CR-AHPRM-CALC NOT NUMERIC
  7927           MOVE +0               TO CR-AHPRM-CALC
  7928        END-IF
  7929        IF CR-AHPRM-CALC = ZEROS
  7930           MOVE CR-AHPRM         TO CR-AHPRM-CALC
  7931        END-IF
  7932     END-IF
  7933
  7934     IF NOT CP-ERROR-OCCURED
  7935        IF (CP-CALC-PREMIUM NOT = +0) AND
  7936           (CR-AHPRM-CALC NOT = +0)
  7937           IF DTE-CLIENT = 'CID'
  7938              COMPUTE WS-DIFF = (CP-CALC-PREMIUM -
  7939                 CR-AHPRM-CALC) / CR-AHPRM-CALC
  7940              IF WS-DIFF < 0
  7941                 COMPUTE WS-DIFF = WS-DIFF * -1
  7942              END-IF
  7943              IF WS-DIFF > 0.02
  7944                 MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  7945                                    WS-HOLD-AH-PRIM-FAC
  7946              END-IF
  7947           ELSE
  7948              MOVE CP-CALC-PREMIUM TO EX-PRIM-FAC-PREM
  7949                                   WS-HOLD-AH-PRIM-FAC
  7950           END-IF
  7951        END-IF
  7952     ELSE
  7953        ADD 1 TO WS-AH-RATE-ERROR
  7954     END-IF
  7955
  7956     .
  7957 1120-RELEASE-AH-RECORD.
  7958
  7959     PERFORM 1130-BUILD-AH-CLAIMS
  7960         VARYING YR FROM +1 BY +1
  7961         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7962
  7963     GO TO 1140-END-AH-CLAIMS.
  7964
  7965 1130-BUILD-AH-CLAIMS.
  7966
  7967     IF CERT-AND-CLAIM
  7968        MOVE WS-CLAIM-AMT (2 1 YR) TO EX-CLAIM-AMT (YR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS158.cbl
  7969        MOVE WS-INC-CNT   (2 1 YR) TO EX-INC-CNT   (YR)
  7970        MOVE WS-PD-CNT    (2 1 YR) TO EX-PD-CNT    (YR).
  7971
  7972 1140-END-AH-CLAIMS.
  7973
  7974     IF CR-ENTRY-STATUS = '5' OR 'M'
  7975        GO TO 1180-END-AH-RESERVES.
  7976
  7977     MOVE EX-PREM TO WRK-C.
  7978
  7979*    PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  7980     PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  7981         VARYING YR FROM +1 BY +1
  7982         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7983
  7984     PERFORM 1150-BUILD-AH-DEV-RESERVES
  7985         VARYING YR FROM +1 BY +1
  7986         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  7987
  7988     GO TO 1160-CALC-AH-PRIM-FAC.
  7989
  7990 1150-BUILD-AH-DEV-RESERVES.
  7991
  7992     MOVE WS-AH-BEG-MEAN-RES (YR)  TO EX-BEG-MEAN-RES (YR)
  7993                                      EX-PRI-BEG-MEAN-RES (YR).
  7994
  7995     MOVE WS-AH-BEG-STATE-RES (YR) TO EX-BEG-ST-RES (YR)
  7996                                      EX-PRI-BEG-ST-RES (YR).
  7997
  7998     MOVE WS-AH-BEG-R78-RES (YR)   TO EX-BEG-R78-RES (YR)
  7999                                      EX-PRI-BEG-R78-RES (YR).
  8000
  8001     MOVE WS-AH-BEG-PRO-RES (YR)   TO EX-BEG-PRO-RES (YR)
  8002                                      EX-PRI-BEG-PRO-RES (YR).
  8003
  8004     MOVE WS-AH-END-MEAN-RES (YR)  TO EX-END-MEAN-RES (YR)
  8005                                      EX-PRI-END-MEAN-RES (YR).
  8006
  8007     MOVE WS-AH-END-STATE-RES (YR) TO EX-END-ST-RES (YR)
  8008                                      EX-PRI-END-ST-RES (YR).
  8009
  8010     MOVE WS-AH-END-R78-RES (YR)   TO EX-END-R78-RES (YR)
  8011                                      EX-PRI-END-R78-RES (YR).
  8012
  8013     MOVE WS-AH-END-PRO-RES (YR)   TO EX-END-PRO-RES (YR)
  8014                                      EX-PRI-END-PRO-RES (YR).
  8015
  8016 1160-CALC-AH-PRIM-FAC.
  8017
  8018     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  8019        MOVE EX-PRIM-FAC-PREM TO WRK-C
  8020*       PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  8021        PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  8022            VARYING YR FROM +1 BY +1
  8023            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  8024        PERFORM 1170-BUILD-AH-PRI-RESERVES
  8025            VARYING YR FROM +1 BY +1
  8026            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS158.cbl
  8027
  8028     GO TO 1180-END-AH-RESERVES.
  8029
  8030 1170-BUILD-AH-PRI-RESERVES.
  8031
  8032     MOVE WS-AH-BEG-MEAN-RES  (YR) TO EX-PRI-BEG-MEAN-RES (YR).
  8033     MOVE WS-AH-BEG-STATE-RES (YR) TO EX-PRI-BEG-ST-RES   (YR).
  8034     MOVE WS-AH-BEG-R78-RES   (YR) TO EX-PRI-BEG-R78-RES  (YR).
  8035     MOVE WS-AH-BEG-PRO-RES   (YR) TO EX-PRI-BEG-PRO-RES  (YR).
  8036
  8037     MOVE WS-AH-END-MEAN-RES  (YR) TO EX-PRI-END-MEAN-RES (YR).
  8038     MOVE WS-AH-END-STATE-RES (YR) TO EX-PRI-END-ST-RES   (YR).
  8039     MOVE WS-AH-END-R78-RES   (YR) TO EX-PRI-END-R78-RES  (YR).
  8040     MOVE WS-AH-END-PRO-RES   (YR) TO EX-PRI-END-PRO-RES  (YR).
  8041
  8042 1180-END-AH-RESERVES.
  8043
  8044     IF DEBUG-AH-STATUTORY
  8045         GO TO 1180-CONTINUE.
  8046
  8047     IF DTE-PGM-OPT NOT = '3' AND '4'
  8048        GO TO 1190-BYPASS-AH-DETAIL.
  8049
  8050     IF M5 (1) = +0
  8051        GO TO 1190-BYPASS-AH-DETAIL.
  8052
  8053 1180-CONTINUE.
  8054
  8055     MOVE EX-CARRIER           TO D-CARR.
  8056     MOVE EX-GROUPING          TO D-GROUP.
  8057     MOVE EX-STATE             TO D-STATE.
  8058     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  8059     MOVE CR-CERT-NO           TO D-CERT-NO.
  8060
  8061     MOVE 'L'                  TO DC-OPTION-CODE.
  8062     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  8063     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  8064     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  8065
  8066     MOVE EX-PREM              TO D-PREM.
  8067     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  8068     MOVE EX-TERM              TO D-TERM.
  8069     MOVE M2 (1)               TO D-REM-TERM.
  8070     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  8071     MOVE EX-BENEFIT           TO D-BENEFIT.
  8072     MOVE 'A'                  TO D-L-A.
  8073     MOVE CLAS-I-AB10 (CLAS-INDEXA) TO D-BEN-DESC.
  8074
  8075     PERFORM 1600-PRINT-A-LINE.
  8076
  8077     IF DEBUG-AH-STATUTORY
  8078         IF EX-END-ST-RES (1) NOT = ZEROS
  8079             ADD +1                TO WS-S-CNT
  8080             ADD EX-END-ST-RES (1) TO WS-S-STATUTORY
  8081             DISPLAY ' CNT ', WS-S-CNT
  8082                     ' TOT ', WS-S-STATUTORY
  8083                     ' RESV ', EX-END-ST-RES (1)
  8084                     ' CERT ', CR-FULL-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS158.cbl
  8085
  8086 1190-BYPASS-AH-DETAIL.
  8087
  8088     MOVE CALL-EXTRACT          TO HOLD-AH-RECORD.
  8089
  8090     IF CR-ENTRY-STATUS NOT = '9'
  8091        PERFORM 1500-RELEASE THRU 1540-RELEASE-EXIT.
  8092
  8093     GO TO 1400-CHECK-IF-REINSURANCE.
  8094
  8095 1200-CALC-AH-UNEARN.
  8096
  8097     MOVE +0 TO         WS-AH-END-R78-RES (YR)
  8098                        WS-AH-BEG-R78-RES (YR)
  8099                        WS-AH-END-PRO-RES (YR)
  8100                        WS-AH-BEG-PRO-RES (YR)
  8101                        WS-AH-END-NET-RES (YR)
  8102                        WS-AH-BEG-NET-RES (YR)
  8103                        WS-AH-END-MEAN-RES (YR)
  8104                        WS-AH-BEG-MEAN-RES (YR)
  8105                        WS-AH-END-STATE-RES (YR)
  8106                        WS-AH-BEG-STATE-RES (YR)
  8107                        WRK-B.
  8108
  8109     IF ENTRY-DT GREATER  BEGIN-DT (YR)
  8110        GO TO  1200-CALC-AH-END
  8111     END-IF
  8112
  8113     MOVE WS-AH-BEG-REM-TRM1 (YR)
  8114                                 TO M4
  8115                                    CP-REMAINING-TERM
  8116
  8117     IF M4 NOT POSITIVE
  8118        GO TO 1200-CALC-AH-END
  8119     END-IF
  8120
  8121     MOVE BEGIN-DATE (YR)        TO DC-GREG-DATE-CYMD
  8122     MOVE 'L'                    TO DC-OPTION-CODE
  8123     PERFORM 6150-DATE-CONVERSION-ROUTINE
  8124     MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
  8125
  8126     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  8127                                 TO CP-BENEFIT-TYPE
  8128     MOVE M4                     TO WRK-REMTRM
  8129     PERFORM 1250-CALC-UNEARNED-PREMIUM
  8130                                 THRU 1250-EXIT
  8131
  8132     MOVE CP-R78-U-PRM           TO WS-AH-BEG-R78-RES (YR)
  8133     MOVE CP-PRORATA-U-PRM       TO WS-AH-BEG-PRO-RES (YR)
  8134     MOVE CP-STATE-U-PRM         TO WS-AH-BEG-STATE-RES (YR)
  8135
  8136     COMPUTE WS-AH-BEG-MEAN-RES (YR) =
  8137        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5
  8138
  8139*    PERFORM 0560-CALC-PRO-FACTOR
  8140*
  8141*    COMPUTE WRK-B ROUNDED = WRK-D * WRK-C
  8142*    MOVE WRK-B TO WS-AH-BEG-PRO-RES (YR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS158.cbl
  8143     .
  8144 1200-CALC-AH-END.
  8145
  8146     IF ENTRY-DT GREATER THAN END-DT (YR)
  8147        GO TO  1200-EXIT
  8148     END-IF
  8149
  8150     MOVE WS-AH-END-REM-TRM1 (YR)
  8151                                 TO M4
  8152                                    CP-REMAINING-TERM
  8153
  8154     IF M4 NOT POSITIVE
  8155        GO TO 1200-EXIT
  8156     END-IF
  8157
  8158     MOVE ENDING-DATE (YR)       TO DC-GREG-DATE-CYMD
  8159     MOVE 'L'                    TO DC-OPTION-CODE
  8160     PERFORM 6150-DATE-CONVERSION-ROUTINE
  8161     MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
  8162
  8163     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  8164                                 TO CP-BENEFIT-TYPE
  8165     MOVE M4                     TO WRK-REMTRM
  8166     PERFORM 1250-CALC-UNEARNED-PREMIUM
  8167                                 THRU 1250-EXIT
  8168
  8169     MOVE CP-R78-U-PRM           TO WS-AH-END-R78-RES (YR)
  8170     MOVE CP-PRORATA-U-PRM       TO WS-AH-END-PRO-RES (YR)
  8171     MOVE CP-STATE-U-PRM         TO WS-AH-END-STATE-RES (YR)
  8172
  8173     COMPUTE WS-AH-END-MEAN-RES (YR) =
  8174        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5
  8175
  8176*    PERFORM 0560-CALC-PRO-FACTOR
  8177*
  8178*    COMPUTE WRK-B ROUNDED = WRK-D * WRK-C
  8179*    MOVE WRK-B TO WS-AH-END-PRO-RES (YR)
  8180     .
  8181 1200-EXIT.
  8182     EXIT.
  8183
  8184 1230-CALC-AH-R78-BEG.
  8185
  8186     IF ENTRY-DT GREATER THAN BEGIN-DT (YR)
  8187        GO TO 1240-CALC-AH-R78-END.
  8188
  8189     MOVE WS-AH-BEG-REM-TRM1 (YR) TO M4.
  8190
  8191     IF M4 NOT POSITIVE
  8192        GO TO 1240-CALC-AH-R78-END.
  8193
  8194     PERFORM 0610-CALC-R78-FACTOR.
  8195
  8196     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8197     MOVE WRK-B TO WS-AH-BEG-R78-RES (YR).
  8198
  8199 1240-CALC-AH-R78-END.
  8200
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS158.cbl
  8201     IF ENTRY-DT GREATER THAN END-DT (YR)
  8202        GO TO 1250-CALC-AH-MEAN-RES.
  8203
  8204     MOVE WS-AH-END-REM-TRM1 (YR) TO M4.
  8205
  8206     IF M4 NOT POSITIVE
  8207        GO TO 1250-CALC-AH-MEAN-RES.
  8208
  8209     PERFORM 0610-CALC-R78-FACTOR.
  8210
  8211     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8212     MOVE WRK-B TO WS-AH-END-R78-RES (YR).
  8213
  8214 1250-CALC-AH-MEAN-RES.
  8215
  8216     COMPUTE WS-AH-BEG-MEAN-RES (YR) =
  8217        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5.
  8218
  8219     COMPUTE WS-AH-END-MEAN-RES (YR) =
  8220        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5.
  8221
  8222 1260-CALC-AH-NET-BEG.
  8223
  8224     IF AH-EARN-NET-PAY
  8225         NEXT SENTENCE
  8226     ELSE
  8227         GO TO 1280-CALC-STATE-REGS.
  8228
  8229     IF ENTRY-DT GREATER THAN BEGIN-DT (YR)
  8230        GO TO 1270-CALC-AH-NET-END.
  8231
  8232     MOVE WS-AH-BEG-REM-TRM1 (YR) TO M4.
  8233
  8234     IF M4 NOT POSITIVE
  8235        GO TO 1270-CALC-AH-NET-END.
  8236
  8237     PERFORM 1275-NET-PAY-AH THRU 1275-NET-PAY-AH-X.
  8238
  8239     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8240     MOVE WRK-B TO WS-AH-BEG-NET-RES (YR).
  8241
  8242 1270-CALC-AH-NET-END.
  8243
  8244     IF ENTRY-DT GREATER THAN END-DT (YR)
  8245        GO TO 1280-CALC-STATE-REGS.
  8246
  8247     MOVE WS-AH-END-REM-TRM1 (YR) TO M4.
  8248
  8249     IF M4 NOT POSITIVE
  8250        GO TO 1280-CALC-STATE-REGS.
  8251
  8252     PERFORM 1275-NET-PAY-AH THRU 1275-NET-PAY-AH-X.
  8253
  8254     COMPUTE WRK-B ROUNDED = WRK-E * WRK-C.
  8255     MOVE WRK-B TO WS-AH-END-NET-RES (YR).
  8256
  8257     GO TO 1280-CALC-STATE-REGS.
  8258
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS158.cbl
  8259 1275-NET-PAY-AH.
  8260
  8261     MOVE ZERO                     TO WRK-B.
  8262
  8263     IF M4 NOT POSITIVE
  8264         GO TO 1275-NET-PAY-AH-X.
  8265
  8266     IF M4 NOT LESS EX-TERM
  8267         MOVE WRK-C                TO WRK-B
  8268         MOVE +1                   TO WRK-E
  8269         GO TO 1275-NET-PAY-AH-X.
  8270
  8271     MOVE EX-TERM                  TO NP-ORIG
  8272                                      NP-CAP.
  8273     MOVE EX-APR                   TO NP-APR.
  8274     MOVE M4                       TO NP-REM.
  8275
  8276     MOVE CLAS-I-BAL (CLAS-INDEXA) TO NP-OPT.
  8277     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
  8278        MOVE EX-CAP-TERM           TO NP-ORIG.
  8279
  8280     MOVE 'R'                      TO NP-OPT.
  8281
  8282     CALL 'ECSNETRM' USING
  8283         NP-APR, NP-ORIG, NP-REM, NP-OPT, NP-CAP, NP-FACTOR.
  8284
  8285     MOVE NP-FACTOR                TO WRK-E.
  8286
  8287 1275-NET-PAY-AH-X.
  8288     EXIT.
  8289
  8290 1280-CALC-STATE-REGS.
  8291
  8292     IF ANTICIPATION
  8293        IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  8294              IF EX-BEN-TYPE NOT = ZERO
  8295                 MOVE M6 (YR) TO WORK-M4
  8296                 MOVE M3 (YR) TO WRK-REMTRM
  8297                 PERFORM 1320-CHECK-AH-RATES THRU 1330-CHECK-EXIT
  8298                 IF CP-ERROR-RATE-NOT-FOUND OR
  8299                    CP-ERROR-RATE-IS-ZERO   OR
  8300                    CP-ERROR-IN-DATES
  8301                  NEXT SENTENCE
  8302                 ELSE
  8303                  COMPUTE WRK-B ROUNDED =
  8304                   ((M3 (YR) * EX-BENEFIT) / +100)
  8305                               * CP-PREMIUM-RATE
  8306                  MOVE WRK-B TO WS-AH-BEG-STATE-RES (YR).
  8307
  8308     IF ANTICIPATION
  8309        IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  8310              IF EX-BEN-TYPE NOT = ZERO
  8311                 MOVE M5 (YR) TO WORK-M4
  8312                 MOVE M2 (YR) TO WRK-REMTRM
  8313                 PERFORM 1320-CHECK-AH-RATES THRU 1330-CHECK-EXIT
  8314                 IF CP-ERROR-RATE-NOT-FOUND OR
  8315                    CP-ERROR-RATE-IS-ZERO   OR
  8316                    CP-ERROR-IN-DATES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS158.cbl
  8317                  NEXT SENTENCE
  8318                 ELSE
  8319                  COMPUTE WRK-B ROUNDED =
  8320                   ((M2 (YR) * EX-BENEFIT) / +100)
  8321                               * CP-PREMIUM-RATE
  8322                  MOVE WRK-B TO WS-AH-END-STATE-RES (YR).
  8323
  8324     IF R78
  8325        MOVE WS-AH-BEG-R78-RES (YR) TO
  8326                       WS-AH-BEG-STATE-RES (YR)
  8327        MOVE WS-AH-END-R78-RES (YR) TO
  8328                       WS-AH-END-STATE-RES (YR).
  8329
  8330     IF AH-EARN-NET-PAY
  8331        MOVE WS-AH-BEG-NET-RES (YR) TO
  8332                       WS-AH-BEG-STATE-RES (YR)
  8333        MOVE WS-AH-END-NET-RES (YR) TO
  8334                       WS-AH-END-STATE-RES (YR).
  8335
  8336     IF PRATA
  8337        MOVE WS-AH-BEG-PRO-RES (YR) TO
  8338                       WS-AH-BEG-STATE-RES (YR)
  8339        MOVE WS-AH-END-PRO-RES (YR) TO
  8340                       WS-AH-END-STATE-RES (YR).
  8341
  8342     IF MEAN
  8343        COMPUTE WS-AH-BEG-STATE-RES (YR) =
  8344        (WS-AH-BEG-PRO-RES (YR) + WS-AH-BEG-R78-RES (YR)) * .5
  8345        COMPUTE WS-AH-END-STATE-RES (YR) =
  8346        (WS-AH-END-PRO-RES (YR) + WS-AH-END-R78-RES (YR)) * .5.
  8347
  8348     IF 1-3RD-2-3RDS
  8349        COMPUTE WS-AH-BEG-STATE-RES (YR) =
  8350        (WS-AH-BEG-PRO-RES (YR) * .6667) +
  8351        (WS-AH-BEG-R78-RES (YR) * .3333)
  8352        COMPUTE WS-AH-END-STATE-RES (YR) =
  8353        (WS-AH-END-PRO-RES (YR) * .6667) +
  8354        (WS-AH-END-R78-RES (YR) * .3333).
  8355
  8356 1299-AH-UNEARN-EXIT.
  8357     EXIT.
  8358
  8359 1250-CALC-UNEARNED-PREMIUM.
  8360
  8361*    MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8362*    MOVE 'L'                    TO DC-OPTION-CODE
  8363*    PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0409-EXIT
  8364*    MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  8365     MOVE EFFECT-DT              TO CP-CERT-EFF-DT
  8366
  8367*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  8368
  8369     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  8370     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
  8371     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  8372                                    CP-RATING-BENEFIT-AMT
  8373     MOVE CLAS-I-BAL (CLAS-INDEXA)
  8374                                 TO CP-SPECIAL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS158.cbl
  8375     MOVE DTE-R78                TO CP-R78-OPTION
  8376     MOVE SPACES                 TO CP-ACCT-FLD-5
  8377     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  8378     MOVE CR-AGE                 TO CP-ISSUE-AGE
  8379     MOVE CR-APR                 TO CP-LOAN-APR
  8380     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  8381     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  8382     MOVE SPACES                 TO CP-DOMICILE-STATE
  8383     MOVE CR-CARRIER             TO CP-CARRIER
  8384
  8385     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8386         MOVE CR-RATING-CLASS    TO CP-CLASS-CODE
  8387     ELSE
  8388         MOVE AM-CAL-TABLE       TO CP-CLASS-CODE
  8389     END-IF
  8390
  8391     MOVE STATE-SUB (CLAS-INDEXS)
  8392                                 TO CP-STATE
  8393     MOVE STATE-ABBR (CLAS-INDEXS)
  8394                                 TO CP-STATE-STD-ABBRV
  8395     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  8396     MOVE CR-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS
  8397
  8398     MOVE ' ' TO CP-EARNING-METHOD
  8399
  8400
  8401     IF DTE-CLIENT = 'CID'
  8402        IF CP-STATE-STD-ABBRV = 'OH'
  8403           IF CR-LFTYP NOT = ZEROS AND SPACES
  8404              IF (CLAS-I-EP (CLAS-INDEXL) = 'N' OR '5')
  8405                          OR
  8406                 ((CR-LF-TERM > +60)
  8407                  AND (CR-APR > ZEROS))
  8408                 MOVE '5'          TO CP-EARNING-METHOD
  8409              END-IF
  8410           END-IF
  8411        END-IF
  8412     END-IF
  8413
  8414
  8415
  8416     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  8417
  8418     if dte-client not = 'AHL'
  8419        IF CP-STATE-STD-ABBRV = 'VA'
  8420           PERFORM 1320-CHECK-AH-RATES
  8421                                 THRU 1330-CHECK-EXIT
  8422           IF CP-ERROR-RATE-NOT-FOUND  OR
  8423              CP-ERROR-RATE-IS-ZERO  OR
  8424              CP-ERROR-IN-DATES
  8425              CONTINUE
  8426           ELSE
  8427              COMPUTE CP-STATE-U-PRM ROUNDED =
  8428                 ((WRK-REMTRM * CR-AHAMT)
  8429                 / +100) * CP-PREMIUM-RATE
  8430           END-IF
  8431        END-IF
  8432     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS158.cbl
  8433
  8434     .
  8435 1250-EXIT.
  8436     EXIT.
  8437
  8438 1300-FIND-METHOD.
  8439
  8440     IF STATE-ABBR (CLAS-INDEXS) = 'VA'
  8441        MOVE '1'                 TO STATE-CALL-EARN (CLAS-INDEXS)
  8442     END-IF
  8443
  8444     IF STATE-CALL-EARN (CLAS-INDEXS) = '2'
  8445        MOVE 'R' TO TYPE-METHOD
  8446        GO TO 1310-METHOD-EXIT
  8447     ELSE
  8448        IF STATE-CALL-EARN (CLAS-INDEXS) = '3'
  8449           MOVE 'P' TO TYPE-METHOD
  8450           GO TO 1310-METHOD-EXIT
  8451        ELSE
  8452           IF STATE-CALL-EARN (CLAS-INDEXS) = '4'
  8453              MOVE 'M' TO TYPE-METHOD
  8454              GO TO 1310-METHOD-EXIT
  8455           ELSE
  8456              IF STATE-CALL-EARN (CLAS-INDEXS) = '5'
  8457                 MOVE CLAS-I-EP (CLAS-INDEXA) TO TYPE-METHOD
  8458                 GO TO 1310-METHOD-EXIT.
  8459
  8460     SET TABLE-INDEX TO +1
  8461
  8462     SEARCH MR-TABLE VARYING TABLE-INDEX
  8463              AT END
  8464         MOVE DEFAULT-AH-METHOD             TO TYPE-METHOD
  8465              WHEN
  8466         T-STATE (TABLE-INDEX) = STATE-ABBR (CLAS-INDEXS)
  8467             MOVE METHOD-CODE (TABLE-INDEX) TO TYPE-METHOD.
  8468
  8469     IF AH-EARN-METHOD = 'A' OR 'C'
  8470        MOVE 'A' TO TYPE-METHOD
  8471        GO TO 1310-METHOD-EXIT.
  8472
  8473     IF DTE-CLIENT = 'CSO' OR 'CID'
  8474         IF STATE-ABBR (CLAS-INDEXS) = 'CO'
  8475             IF EX-EFF-DATE LESS THAN 19970101
  8476                 MOVE 'R'        TO  TYPE-METHOD
  8477                 GO TO 1310-METHOD-EXIT
  8478             ELSE
  8479                 MOVE 'M'        TO  TYPE-METHOD
  8480                 GO TO 1310-METHOD-EXIT.
  8481
  8482     IF TEXAS-SPECIAL
  8483        IF EX-EFF-DATE  GREATER THAN  19830831
  8484           MOVE 'M' TO TYPE-METHOD
  8485           GO TO 1310-METHOD-EXIT
  8486        ELSE
  8487           MOVE 'R' TO TYPE-METHOD
  8488           GO TO 1310-METHOD-EXIT.
  8489
  8490     IF OK-SPECIAL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS158.cbl
  8491        IF EX-EFF-DATE  GREATER THAN  19820629
  8492           MOVE 'M' TO TYPE-METHOD
  8493           GO TO 1310-METHOD-EXIT
  8494        ELSE
  8495           MOVE 'R' TO TYPE-METHOD
  8496           GO TO 1310-METHOD-EXIT.
  8497
  8498     IF OHIO-SPECIAL
  8499        IF EX-EFF-DATE  GREATER THAN  19831031
  8500           MOVE 'M' TO TYPE-METHOD
  8501           GO TO 1310-METHOD-EXIT
  8502        ELSE
  8503           MOVE 'P' TO TYPE-METHOD
  8504           GO TO 1310-METHOD-EXIT.
  8505
  8506     IF VIRGINIA-SPECIAL
  8507        MOVE 'A'                 TO TYPE-METHOD
  8508                                    AH-EARN-METHOD
  8509        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
  8510           MOVE 'P'              TO TYPE-METHOD
  8511                                    AH-EARN-METHOD
  8512        END-IF
  8513     END-IF
  8514
  8515     IF (DTE-CLIENT = 'NCL') AND
  8516        (EX-EFF-DATE  LESS THAN  19910101 )
  8517          NEXT SENTENCE
  8518     ELSE
  8519         IF (CR-APR GREATER THAN +0)
  8520            IF  (AH-EARN-METHOD = 'N') OR
  8521                (CLAS-I-EP (CLAS-INDEXA) = 'N')
  8522                 MOVE 'N' TO TYPE-METHOD.
  8523
  8524 1310-METHOD-EXIT.
  8525     EXIT.
  8526
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS158.cbl
  8528 1320-CHECK-AH-RATES.
  8529
  8530     MOVE EFFECT-DT              TO CP-CERT-EFF-DT
  8531
  8532     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
  8533     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8534     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8535     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
  8536     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  8537     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  8538     MOVE WRK-REMTRM                 TO CP-ORIGINAL-TERM.
  8539     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
  8540                                        CP-RATING-BENEFIT-AMT.
  8541     IF CP-STATE-STD-ABBRV = 'OR'
  8542         COMPUTE CP-RATING-BENEFIT-AMT =
  8543                                 CR-AHAMT * WRK-REMTRM.
  8544     MOVE CR-APR                     TO CP-LOAN-APR.
  8545     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  8546     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
  8547     MOVE '3'                        TO CP-PROCESS-TYPE.
  8548     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
  8549     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
  8550     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  8551         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
  8552     ELSE
  8553         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
  8554     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
  8555     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
  8556     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8557     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  8558     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
  8559     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
  8560
  8561     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
  8562
  8563 1330-CHECK-EXIT.
  8564     EXIT.
  8565
  8566 1400-CHECK-IF-REINSURANCE.
  8567
  8568     IF DTE-PGM-OPT = '2' OR '4'
  8569        PERFORM 2000-REINSURANCE-ROUTINE THRU
  8570                2030-REINSURANCE-ROUTINE-X.
  8571
  8572 1410-PROCESS-CERTS-EXIT.
  8573     EXIT.
  8574
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS158.cbl
  8576 1500-RELEASE.
  8577
  8578     IF CERT-NO-CLAIM OR
  8579        CERT-AND-CLAIM
  8580        GO TO 1520-RELEASE-SORT-RECORD.
  8581
  8582     MOVE +1 TO LIFE-AH-SUB
  8583                YR.
  8584
  8585 1510-ADD-CLAIMS-TO-EXTRACT.
  8586
  8587     IF LIFE-AH-SUB GREATER THAN +2
  8588        GO TO 1540-RELEASE-EXIT.
  8589
  8590     IF YR GREATER THAN NUMBER-OF-PERIODS
  8591         PERFORM 1520-RELEASE-SORT-RECORD
  8592         ADD +1 TO LIFE-AH-SUB
  8593         MOVE +1 TO YR
  8594         GO TO 1510-ADD-CLAIMS-TO-EXTRACT.
  8595
  8596     MOVE WS-CLAIM-AMT (LIFE-AH-SUB 1 YR) TO EX-CLAIM-AMT (YR).
  8597     MOVE WS-INC-CNT   (LIFE-AH-SUB 1 YR) TO EX-INC-CNT   (YR).
  8598     MOVE WS-PD-CNT    (LIFE-AH-SUB 1 YR) TO EX-PD-CNT    (YR).
  8599     MOVE WS-DEV       (LIFE-AH-SUB)      TO EX-STATE-DEV.
  8600     MOVE WS-BEN-TYPE  (LIFE-AH-SUB)      TO EX-BEN-TYPE.
  8601
  8602     IF LIFE-AH-SUB = +1
  8603         MOVE 'L'                       TO EX-LIFE-AH
  8604     ELSE
  8605         MOVE 'A'                       TO EX-LIFE-AH.
  8606
  8607     ADD +1 TO YR.
  8608     GO TO 1510-ADD-CLAIMS-TO-EXTRACT.
  8609
  8610 1520-RELEASE-SORT-RECORD.
  8611
  8612     IF SINGLE-PERIOD-PROCESS
  8613         MOVE ZEROS              TO  EX-INC-CNT          (2)
  8614                                     EX-PD-CNT           (2)
  8615                                     EX-C-CNT            (2)
  8616                                     RR                  (2)
  8617                                     M1                  (2)
  8618                                     M2                  (2)
  8619                                     M3                  (2)
  8620                                     M5                  (2)
  8621                                     M6                  (2)
  8622                                     EX-BEG-ST-RES       (2)
  8623                                     EX-END-ST-RES       (2)
  8624                                     EX-BEG-R78-RES      (2)
  8625                                     EX-END-R78-RES      (2)
  8626                                     EX-BEG-PRO-RES      (2)
  8627                                     EX-END-PRO-RES      (2)
  8628                                     EX-BEG-MEAN-RES     (2)
  8629                                     EX-END-MEAN-RES     (2)
  8630                                     EX-PRI-BEG-ST-RES   (2)
  8631                                     EX-PRI-END-ST-RES   (2)
  8632                                     EX-PRI-BEG-R78-RES  (2)
  8633                                     EX-PRI-END-R78-RES  (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS158.cbl
  8634                                     EX-PRI-BEG-PRO-RES  (2)
  8635                                     EX-PRI-END-PRO-RES  (2)
  8636                                     EX-PRI-BEG-MEAN-RES (2)
  8637                                     EX-PRI-END-MEAN-RES (2)
  8638                                     EX-MEAN-INFORCE     (2)
  8639                                     EX-OVR-COMM         (2)
  8640                                     EX-AGT-COMM         (2)
  8641                                     EX-CNC-AMT          (2)
  8642                                     EX-RETRO-PMTS       (2)
  8643         MOVE INITIALIZED-BACK   TO  EX-DATA-BY-YEAR   (3).
  8644
  8645     MOVE LOW-VALUES             TO SORT-KEY.
  8646
  8647     IF EX-CLAIM-AMT (1) NOT NUMERIC
  8648        MOVE ZEROS TO EX-CLAIM-AMT (1).
  8649
  8650     IF EX-CLAIM-AMT (2) NOT NUMERIC
  8651        MOVE ZEROS TO EX-CLAIM-AMT (2).
  8652
  8653     IF EX-CLAIM-AMT (3) NOT NUMERIC
  8654        MOVE ZEROS TO EX-CLAIM-AMT (3).
  8655
  8656     IF EX-BEN-TYPE = '00'
  8657        NEXT SENTENCE
  8658     ELSE
  8659        IF EX-CLAIM-AMT (1) GREATER THAN +0
  8660           PERFORM XXXX-PRINT-CLAIMS THRU XXXX-EXIT
  8661           WRITE CALL-X FROM CALL-EXTRACT
  8662           ADD +1 TO CALL-CNT
  8663        ELSE
  8664           WRITE CALL-X FROM CALL-EXTRACT
  8665           ADD +1 TO CALL-CNT.
  8666
  8667 1530-CHECK-FOR-TEXAS.
  8668
  8669     IF EX-BEN-TYPE = '00'
  8670        NEXT SENTENCE
  8671     ELSE
  8672        IF REPORT-OVER-UNDER-60  OR
  8673           EX-STATE = STATE-TX
  8674           IF (EX-CLAIM-AMT (1) GREATER THAN +0 OR
  8675               EX-CLAIM-AMT (2) GREATER THAN +0 OR
  8676               EX-CLAIM-AMT (3) GREATER THAN +0)
  8677             IF EX-TERM-CD = '1'
  8678                MOVE '2'    TO EX-TERM-CD
  8679                MOVE 'X'    TO EX-TX-RESV-ADJ-REC
  8680                WRITE CALL-X FROM CALL-EXTRACT
  8681                MOVE SPACES TO EX-TX-RESV-ADJ-REC
  8682                ADD +1 TO TEXAS-CNT
  8683             ELSE
  8684             IF EX-TERM-CD = '2'
  8685                MOVE '1'    TO EX-TERM-CD
  8686                MOVE 'X'    TO EX-TX-RESV-ADJ-REC
  8687                WRITE CALL-X FROM CALL-EXTRACT
  8688                MOVE SPACES TO EX-TX-RESV-ADJ-REC
  8689                ADD +1 TO TEXAS-CNT.
  8690
  8691 1540-RELEASE-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS158.cbl
  8692     EXIT.
  8693
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS158.cbl
  8695 XXXX-PRINT-CLAIMS.
  8696
  8697     IF DTE-PGM-OPT = '3' OR '4'
  8698        NEXT SENTENCE
  8699     ELSE
  8700        GO TO XXXX-EXIT.
  8701
  8702     MOVE SPACES              TO DETAIL-1B.
  8703
  8704     IF EX-LIFE-AH = 'L'
  8705        MOVE EX-CLAIM-AMT (1) TO DB-CLAIML
  8706     ELSE
  8707     IF EX-LIFE-AH = 'A'
  8708        MOVE EX-CLAIM-AMT (1) TO DB-CLAIMA.
  8709
  8710     MOVE EX-CARRIER       TO DB-CARR.
  8711     MOVE EX-GROUPING      TO DB-GROUP.
  8712     MOVE EX-STATE         TO DB-STATE.
  8713     MOVE EX-ACCOUNT       TO DB-ACCOUNT.
  8714     MOVE EX-EFF-DATE-YR   TO FORMAT-YEAR.
  8715     MOVE EX-EFF-DATE-MO   TO FORMAT-MONTH.
  8716     MOVE EX-EFF-DATE-DA   TO FORMAT-DAY.
  8717     MOVE FORMAT-DATE      TO DB-EFF-DATE.
  8718     MOVE EX-LIFE-AH       TO DB-L-A.
  8719     MOVE DETAIL-1B        TO PRTC-DATA.
  8720     MOVE SPACES           TO PRTC-CTL.
  8721     WRITE PRTC.
  8722
  8723 XXXX-EXIT.
  8724     EXIT.
  8725
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS158.cbl
  8727
  8728 1600-PRINT-A-LINE.
  8729
  8730     IF LINE-CTR GREATER THAN +60
  8731        MOVE +8 TO LINE-CTR
  8732        ADD +1 TO PAGE-CTR
  8733        PERFORM 1630-PRINT-HEADINGS THRU
  8734                1640-PRINT-HEADINGS-EXIT.
  8735
  8736     MOVE DETAIL-1 TO P-DATA.
  8737     MOVE ' '      TO X.
  8738     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8739     ADD +1 TO LINE-CTR.
  8740
  8741 1610-PRT-RTN.
* 8742                                 COPY ELCPRT2.
  8743******************************************************************04/15/98
  8744*                                                                *ELCPRT2
  8745*                                                                *ELCPRT2
  8746*                            ELCPRT2                             *   LV005
  8747*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  8748*                            VMOD=2.002                          *   CL**5
  8749*                                                                *   CL**4
  8750******************************************************************   CL**4
  8751                                                                     CL**4
  8752     IF DTE-FICH NOT = SPACE AND                                     CL**4
  8753        FICH-OPEN    = SPACE                                         CL**4
  8754         MOVE 'X'                TO  FICH-OPEN                       CL**4
  8755         OPEN OUTPUT FICH.                                           CL**4
  8756                                                                     CL**4
  8757     IF DTE-FICH NOT = SPACE                                         CL**4
  8758         MOVE X                  TO  P-CTL                           CL**4
  8759         WRITE FICH-REC FROM PRT.                                    CL**4
  8760                                                                     CL**4
  8761     IF DTE-FICH = SPACE OR '2'                                      CL**4
  8762       MOVE X                    TO  P-CTL                           CL**4
  8763       IF P-CTL = ' '                                                CL**4
  8764         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  8765       ELSE                                                          CL**4
  8766         IF P-CTL = '0'                                              CL**4
  8767           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  8768         ELSE                                                        CL**4
  8769           IF P-CTL = '-'                                            CL**4
  8770             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  8771           ELSE                                                      CL**4
  8772             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  8773                                                                     CL**4
  8774******************************************************************   CL**4
  8775 1620-E-PRT-RTN.
  8776     EXIT.
  8777
  8778 1630-PRINT-HEADINGS.
  8779
  8780     MOVE '1'             TO X.
  8781     MOVE HEAD-1          TO P-DATA.
  8782     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8783
  8784     MOVE ' '             TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS158.cbl
  8785     MOVE WS-CURRENT-DATE TO HD-DATE.
  8786     MOVE COMPANY-NAME    TO HD-CLIENT.
  8787     MOVE HEAD-2          TO P-DATA.
  8788     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8789
  8790     MOVE PAGE-CTR        TO HD-PAGE.
  8791     MOVE ALPH-DATE       TO HD-ALF-DTE.
  8792     MOVE HEAD-3          TO P-DATA.
  8793     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8794
  8795     MOVE '0'             TO X.
  8796     MOVE HEAD-4          TO P-DATA.
  8797     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
  8798
  8799 1640-PRINT-HEADINGS-EXIT.
  8800     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS158.cbl
  8802
  8803 1700-CALC-REM-AMT.
  8804
  8805     IF CR-LFTYP = 'QD'
  8806        MOVE +15.0               TO CR-APR
  8807     END-IF
  8808
  8809     if dte-client = 'AHL'
  8810        if cr-loan-term = zeros
  8811           move cr-lf-term       to cr-loan-term
  8812        end-if
  8813     end-if
  8814
  8815     MOVE +0                     TO WS-REM-AMT
  8816     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  8817        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8818           COMPUTE WS-REM-AMT =
  8819             CR-LFAMT + CR-LFAMT-ALT
  8820        ELSE
  8821           MOVE CR-LFAMT         TO WS-REM-AMT
  8822        END-IF
  8823        GO TO 1750-DISPLAY-AMTS
  8824     END-IF
  8825
  8826     if dte-client = 'AHL'
  8827        compute intermed rounded =
  8828           cr-lfamt / cr-loan-term
  8829     else
  8830        COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
  8831     end-if
  8832
  8833     IF M4 = CR-LF-TERM
  8834        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8835           COMPUTE WS-REM-AMT =
  8836             CR-LFAMT + CR-LFAMT-ALT
  8837        ELSE
  8838           MOVE CR-LFAMT         TO WS-REM-AMT
  8839        END-IF
  8840        GO TO 1750-DISPLAY-AMTS
  8841     END-IF
  8842
  8843     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8844        GO TO 1710-ORDINARY-REM
  8845     END-IF
  8846
  8847     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  8848        GO TO 1720-CALC-TEXAS-REM
  8849     END-IF
  8850
  8851     IF CR-LFTYP = 'QD'
  8852        MOVE +15.0               TO CR-APR
  8853        MOVE 'N'                 TO
  8854                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
  8855        GO TO 1730-CALC-NET-PAY-REM
  8856     END-IF
  8857
  8858     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  8859        GO TO 1730-CALC-NET-PAY-REM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS158.cbl
  8860     END-IF
  8861
  8862     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  8863        (CR-RATING-CLASS NOT = 'L ')
  8864         IF (CR-LF-TERM GREATER THAN +60) AND
  8865            (CR-DT GREATER THAN 19831031) AND
  8866            (CR-APR GREATER THAN ZERO)
  8867             GO TO 1730-CALC-NET-PAY-REM
  8868        END-IF
  8869     END-IF
  8870
  8871     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  8872         IF (CR-LF-TERM GREATER THAN +61) AND
  8873            (CR-DT  GREATER THAN 19830318) AND
  8874            (CR-APR GREATER THAN ZERO)
  8875             GO TO 1730-CALC-NET-PAY-REM
  8876        END-IF
  8877     END-IF
  8878
  8879     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  8880         IF (CR-LF-TERM GREATER THAN +62) AND
  8881            (CR-DT  GREATER THAN 19810831) AND
  8882            (CR-DT  LESS THAN 19830901) AND
  8883            (CR-APR GREATER THAN ZERO)
  8884             GO TO 1730-CALC-NET-PAY-REM
  8885        END-IF
  8886     END-IF
  8887
  8888     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  8889         IF (CR-LF-TERM GREATER THAN +60) AND
  8890            (CR-DT  GREATER THAN 19831231) AND
  8891            (CR-APR GREATER THAN ZERO)
  8892             GO TO 1730-CALC-NET-PAY-REM
  8893        END-IF
  8894     END-IF
  8895
  8896     .
  8897 1710-ORDINARY-REM.
  8898
  8899     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8900         COMPUTE WS-REM-AMT ROUNDED =
  8901                  (INTERMED * M9) + CR-LFAMT-ALT
  8902     else
  8903        if dte-client = 'AHL'
  8904           compute ws-rem-amt rounded = intermed *
  8905              (m9 + (cr-loan-term - cr-lf-term))
  8906        ELSE
  8907           COMPUTE WS-REM-AMT ROUNDED = INTERMED * M9
  8908        end-if
  8909     END-IF
  8910
  8911     GO TO 1750-DISPLAY-AMTS
  8912
  8913     .
  8914 1720-CALC-TEXAS-REM.
  8915
  8916     DIVIDE CR-LFAMT BY CR-LF-TERM
  8917         GIVING TEX-FACT-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS158.cbl
  8918     DIVIDE M9 BY CR-PMT-FREQ
  8919         GIVING TEX-FACT-2
  8920         REMAINDER TEX-FACT-3.
  8921
  8922     IF TEX-FACT-3 NOT = ZERO
  8923         ADD +1                  TO TEX-FACT-2
  8924     END-IF
  8925
  8926     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  8927         MOVE CR-LFAMT           TO WS-REM-AMT
  8928     ELSE
  8929         COMPUTE WS-REM-AMT ROUNDED =
  8930             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
  8931     END-IF
  8932
  8933     GO TO 1750-DISPLAY-AMTS
  8934
  8935     .
  8936 1730-CALC-NET-PAY-REM.
  8937
  8938     MOVE EFFECT-DT              TO  CP-CERT-EFF-DT
  8939
  8940     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  8941        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  8942        MOVE '3'                 TO  DC-OPTION-CODE
  8943        PERFORM 6150-DATE-CONVERSION-ROUTINE
  8944        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  8945     ELSE
  8946        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  8947        MOVE +1                  TO  DC-ELAPSED-MONTHS
  8948        MOVE +0                  TO  DC-ELAPSED-DAYS
  8949        MOVE '6'                 TO  DC-OPTION-CODE
  8950        PERFORM 6150-DATE-CONVERSION-ROUTINE
  8951        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  8952     END-IF
  8953
  8954     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  8955        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
  8956     ELSE
  8957        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
  8958     END-IF
  8959     MOVE CR-APR                 TO  CP-LOAN-APR
  8960     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
  8961     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
  8962     MOVE M9                     TO  CP-REMAINING-TERM
  8963     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  8964                                 TO CP-SPECIAL-CALC-CD
  8965     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  8966                                 TO  CP-BENEFIT-TYPE
  8967     MOVE CLAS-I-EP (CLAS-INDEXL)
  8968                                 TO  CP-EARNING-METHOD
  8969     if dte-client = 'ahl'
  8970        move +14                 to cp-loan-apr
  8971     end-if
  8972
  8973     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
  8974
  8975     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS158.cbl
  8976
  8977     .
  8978 1750-DISPLAY-AMTS.
  8979
  8980*    IF (CR-DT > 19921231) AND
  8981*       (CR-DT < 19940101) AND
  8982*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  8983*       MOVE CR-DT TO WS-DISPLAY-DATE
  8984*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  8985*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  8986*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  8987*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  8988*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  8989*       ELSE
  8990*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  8991*       END-IF
  8992*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  8993*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  8994*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  8995*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  8996*    END-IF
  8997
  8998     .
  8999 1799-EXIT.
  9000     EXIT.
  9001
  9002 2000-REINSURANCE-ROUTINE.
  9003
  9004     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  9005
  9006     IF CR-REIN-TABLE = SPACES OR ZEROS
  9007        GO TO 2030-REINSURANCE-ROUTINE-X.
  9008
  9009     MOVE CR-REIN-TABLE          TO REIN-SRCH.
  9010     PERFORM 2040-RR-READ-REIN THRU 2050-RR-READ-REIN-X.
  9011
  9012 2010-REINSURE-ROUTINE-GET-CALC.
* 9013                                 COPY ECSRTPFM.
  9014******************************************************************07/10/97
  9015*                                                                *ECSRTPFM
  9016*                            ECSRTPFM                            *   LV001
  9017*                            VMOD=2.002                          *ECSRTPFM
  9018*                                                                *ECSRTPFM
  9019******************************************************************ECSRTPFM
  9020                                                                  ECSRTPFM
  9021     IF    CR-LFAMT  NUMERIC                                      00000072
  9022           NEXT SENTENCE                                          00000073
  9023        ELSE                                                      00000074
  9024           MOVE ZEROS TO CR-LFAMT.                                00000075
  9025                                                                  00000076
  9026     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  9027           NEXT SENTENCE                                          00000078
  9028        ELSE                                                      00000079
  9029           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  9030                                                                  00000081
  9031                                                                  00000082
  9032     IF    CR-LFPRM  NUMERIC                                      00000083
  9033           NEXT SENTENCE                                          00000084
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  9034        ELSE                                                      00000085
  9035           MOVE ZEROS TO CR-LFPRM.                                00000086
  9036                                                                  00000087
  9037     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  9038           NEXT SENTENCE                                          00000089
  9039        ELSE                                                      00000090
  9040           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  9041                                                                  00000092
  9042                                                                  00000093
  9043     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  9044           NEXT SENTENCE                                          00000095
  9045        ELSE                                                      00000096
  9046           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  9047                                                                  00000098
  9048     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  9049           NEXT SENTENCE                                          00000100
  9050        ELSE                                                      00000101
  9051           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  9052                                                                  00000103
  9053     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  9054           NEXT SENTENCE                                          00000105
  9055        ELSE                                                      00000106
  9056           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  9057                                                                  00000108
  9058     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  9059     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  9060     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  9061         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  9062     ELSE                                                         ECSRTPFM
  9063         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  9064     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  9065                                                                  ECSRTPFM
  9066     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  9067     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  9068     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  9069         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  9070     ELSE                                                         ECSRTPFM
  9071         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
  9072     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  9073                                                                  ECSRTPFM
  9074     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  9075         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  9076             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  9077                                                                  ECSRTPFM
  9078
  9079 2020-REINSURE-ROUTINE-SKIP-1.
  9080     PERFORM 2060-REINSURE-CANCEL THRU 2070-REINSURE-CANCEL-X.
  9081
  9082     PERFORM 2080-REINSURE-CLAIM THRU 2090-REINSURE-CLAIM-X
  9083         VARYING YR FROM +1 BY +1
  9084         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9085
  9086     PERFORM 2100-REINSURANCE-EXTRACTS THRU
  9087             3050-REINSURANCE-EXTRACTS-X
  9088             VARYING SUB1 FROM +1 BY +1 UNTIL
  9089             REIN-COMP (SUB1) = SPACES.
  9090
  9091 2030-REINSURANCE-ROUTINE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS158.cbl
  9092     EXIT.
  9093
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS158.cbl
  9095 2040-RR-READ-REIN.
  9096     IF REIN-OPEN-SW = ' '
  9097        MOVE DTE-CLASIC-COMPANY-CD TO REIN-SRCH-COMP-CD
  9098        MOVE 'X'                   TO REIN-OPEN-SW
  9099        MOVE 'A'                   TO REIN-SRCH-CODE
  9100        OPEN INPUT ERRTBL-IN
  9101        IF ERRTBL-FILE-STATUS NOT = '00' AND '97'
  9102           MOVE ' ERROR ON OPEN ERRTBL ' TO WS-ABEND-MESSAGE
  9103           MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9104           GO TO ABEND-PGM
  9105        ELSE
  9106           PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT.
  9107
  9108     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  9109        MOVE REIN-SRCH   TO SAVE-REIN-SRCH
  9110        MOVE REIN-SEARCH TO RE-CONTROL-PRIMARY
  9111        READ ERRTBL-IN
  9112        IF ERRTBL-FILE-STATUS NOT = '00'
  9113           MOVE ' ERROR ON READ ERRTBL ' TO WS-ABEND-MESSAGE
  9114           MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  9115           GO TO ABEND-PGM.
  9116
  9117*    ADD  1 TO WS-RTBL-DB-CNT
  9118*              WS-TOT-RTBL-DB-CNT
  9119*    IF WS-RTBL-DB-CNT > 10000
  9120*       MOVE ZEROS TO WS-RTBL-DB-CNT
  9121*       DISPLAY ' RTBLS  READ ' WS-TOT-RTBL-DB-CNT
  9122*    END-IF
  9123     .
  9124 2050-RR-READ-REIN-X.
  9125     EXIT.
  9126
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS158.cbl
  9128 2060-REINSURE-CANCEL.
  9129
  9130     IF REIN-COMP (1) = SPACES
  9131        GO TO 2070-REINSURE-CANCEL-X.
  9132
  9133     IF CR-LFRFND = +0 AND
  9134        CR-AHRFND = +0
  9135        GO TO 2070-REINSURE-CANCEL-X.
  9136
  9137     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
  9138             VARYING SUB1 FROM +1 BY +1 UNTIL
  9139                       REIN-COMP (SUB1) = SPACES.
  9140
  9141 2070-REINSURE-CANCEL-X.
  9142     EXIT.
  9143
  9144 2080-REINSURE-CLAIM.
  9145
  9146     IF REIN-COMP (1) = SPACES
  9147        GO TO 2090-REINSURE-CLAIM-X.
  9148
  9149     IF CERT-NO-CLAIM
  9150        GO TO 2090-REINSURE-CLAIM-X.
  9151
  9152     MOVE WS-CLAIM-AMT (1 1 YR) TO RW-LFCLMWK.
  9153     MOVE WS-CLAIM-AMT (2 1 YR) TO RW-AHCLMWK.
  9154     MOVE +0                    TO RW-LFCLM
  9155                                   RW-AHCLM.
  9156
  9157     IF RW-LFCLMWK = +0
  9158         AND RW-AHCLMWK = +0
  9159             GO TO 2090-REINSURE-CLAIM-X.
  9160
  9161     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
  9162                  VARYING SUB1 FROM +1 BY +1 UNTIL
  9163                            REIN-COMP (SUB1) = SPACES.
  9164
  9165     MOVE RWF-LFCLML TO WS-CLAIM-AMT (1 2 YR)
  9166     MOVE RWF-AHCLML TO WS-CLAIM-AMT (2 2 YR).
  9167
  9168 2090-REINSURE-CLAIM-X.
  9169     EXIT.
  9170
  9171
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS158.cbl
  9173 2100-REINSURANCE-EXTRACTS.
  9174
  9175     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  9176        GO TO 3050-REINSURANCE-EXTRACTS-X.
  9177
  9178     IF REIN-REM-SW (SUB1) = 'Z'
  9179        GO TO 3050-REINSURANCE-EXTRACTS-X.
  9180
  9181     MOVE HOLD-LIFE-RECORD      TO CALL-EXTRACT.
  9182
  9183     MOVE REIN-COMP (SUB1)      TO EX-REIN.
  9184     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
  9185
  9186     MOVE ZEROS                 TO  EX-PREM
  9187                        EX-PRIM-FAC-PREM
  9188                           EX-OVR-COMM (1)
  9189                          EX-OVR-COMM (2)
  9190                          EX-OVR-COMM (3)
  9191                            EX-AGT-COMM (1)
  9192                            EX-AGT-COMM (2)
  9193                            EX-AGT-COMM (3)
  9194                            EX-INITIAL-AMT
  9195                            EX-BENEFIT
  9196                            EX-CNC-AMT (1)
  9197                            EX-CNC-AMT (2)
  9198                            EX-CNC-AMT (3)
  9199                            EX-CLAIM-AMT (1)
  9200                            EX-CLAIM-AMT (2)
  9201                            EX-CLAIM-AMT (3).
  9202
  9203
  9204     IF REIN-LF-FLG (SUB1) = 'X'
  9205         MOVE RWF-LFAMT          TO EX-INITIAL-AMT
  9206         MOVE RWF-LFPRM          TO EX-PREM
  9207                                    EX-PRIM-FAC-PREM
  9208         MOVE CR-LFTYP           TO EX-BEN-TYPE
  9209     ELSE
  9210         MOVE ZEROS              TO EX-BEN-TYPE.
  9211
  9212     IF REIN-LF-FLG (SUB1) = 'X'
  9213        IF SINGLE-PERIOD-PROCESS
  9214            IF LF-CAN GREATER THAN BEGIN-DT (1) AND
  9215               LF-CAN NOT GREATER THAN END-DT (1)
  9216               MOVE RWF-LFRFND   TO EX-CNC-AMT (1)
  9217            ELSE
  9218               NEXT SENTENCE
  9219        ELSE
  9220        IF LF-CAN GREATER THAN BEGIN-DT (1) AND
  9221           LF-CAN NOT GREATER THAN END-DT (1)
  9222           MOVE RWF-LFRFND       TO EX-CNC-AMT (1)
  9223        ELSE
  9224        IF LF-CAN GREATER THAN BEGIN-DT (2) AND
  9225           LF-CAN NOT GREATER THAN END-DT (2)
  9226           MOVE RWF-LFRFND       TO EX-CNC-AMT (2)
  9227        ELSE
  9228        IF LF-CAN GREATER THAN BEGIN-DT (3) AND
  9229           LF-CAN NOT GREATER THAN END-DT (3)
  9230           MOVE RWF-LFRFND       TO EX-CNC-AMT (3).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS158.cbl
  9231
  9232     IF (REIN-LF-FLG (SUB1) = 'X') AND
  9233        (CR-LFPRM NOT = +0)
  9234        COMPUTE LF-DEV-TO-PRIM-FACTOR =
  9235              (WS-HOLD-LF-PRIM-FAC / CR-LFPRM)
  9236        COMPUTE EX-PRIM-FAC-PREM =
  9237              (LF-DEV-TO-PRIM-FACTOR * EX-PREM).
  9238
  9239 2110-DO-REIN-LF-CLM.
  9240
  9241     IF SINGLE-PERIOD-PROCESS
  9242         MOVE WS-CLAIM-AMT (1 2 1) TO EX-CLAIM-AMT (1)
  9243         MOVE WS-CLAIM-AMT (1 2 2) TO EX-CLAIM-AMT (2)
  9244     ELSE
  9245         MOVE WS-CLAIM-AMT (1 2 1) TO EX-CLAIM-AMT (1)
  9246         MOVE WS-CLAIM-AMT (1 2 2) TO EX-CLAIM-AMT (2)
  9247         MOVE WS-CLAIM-AMT (1 2 3) TO EX-CLAIM-AMT (3).
  9248
  9249     MOVE +0 TO SB.
  9250
  9251 2120-DO-REIN-LF-ISS-COMM.
  9252
  9253     ADD +1                      TO SB.
  9254     IF SB GREATER THAN NUMBER-OF-PERIODS
  9255         MOVE +0      TO SB
  9256         GO TO 2130-DO-REIN-LF-CNC-COMM.
  9257
  9258     IF EX-PREM = +0
  9259        GO TO 2120-DO-REIN-LF-ISS-COMM.
  9260
  9261     IF ENTRY-DT GREATER THAN BEGIN-DT (SB) AND
  9262        NOT GREATER THAN END-DT (SB)
  9263        MOVE +1                     TO SV-FACTOR
  9264        MOVE EX-PREM                TO COMM-PREMM
  9265        MOVE 'X'                    TO FROM-REIN
  9266        PERFORM 5000-COMMISSIONS-LIFE THRU 5020-L-COMM-EXIT.
  9267
  9268     GO TO 2120-DO-REIN-LF-ISS-COMM.
  9269
  9270 2130-DO-REIN-LF-CNC-COMM.
  9271
  9272     ADD +1                      TO SB.
  9273     IF SB GREATER THAN NUMBER-OF-PERIODS
  9274         GO TO 2140-END-LIFE-REIN.
  9275
  9276     IF EX-CNC-AMT (SB) = +0
  9277        GO TO 2130-DO-REIN-LF-CNC-COMM.
  9278
  9279     MOVE -1                     TO SV-FACTOR.
  9280     MOVE EX-CNC-AMT (SB)        TO COMM-PREMM.
  9281     MOVE 'X'                    TO FROM-REIN.
  9282     PERFORM 5000-COMMISSIONS-LIFE THRU 5020-L-COMM-EXIT.
  9283
  9284     GO TO 2130-DO-REIN-LF-CNC-COMM.
  9285
  9286 2140-END-LIFE-REIN.
  9287
  9288     MOVE EX-PREM TO WRK-C.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS158.cbl
  9289     MOVE +0          TO WRK-ALT.
  9290
  9291     PERFORM 0480-CALC-LIFE-UNEARN THRU 0530-CALC-UNEARN-FINISH
  9292         VARYING YR FROM +1 BY +1
  9293         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9294
  9295     PERFORM 0430-BUILD-LF-DEV-RESERVES
  9296         VARYING YR FROM +1 BY +1
  9297         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9298
  9299     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  9300        MOVE EX-PRIM-FAC-PREM TO WRK-C
  9301        MOVE +0               TO WRK-ALT
  9302        PERFORM 0480-CALC-LIFE-UNEARN THRU
  9303                             0540-LIFE-UNEARN-EXIT
  9304            VARYING YR FROM +1 BY +1
  9305            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
  9306        PERFORM 0450-BUILD-LF-PRI-RESERVES
  9307            VARYING YR FROM +1 BY +1
  9308            UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9309
  9310     IF DTE-PGM-OPT NOT = '3' AND '4'
  9311        GO TO 2150-BYPASS-LF-DETAIL-REIN.
  9312
  9313     MOVE EX-CARRIER           TO D-CARR.
  9314     MOVE EX-GROUPING          TO D-GROUP.
  9315     MOVE EX-STATE             TO D-STATE.
  9316     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  9317     MOVE CR-CERT-NO           TO D-CERT-NO.
  9318
  9319     MOVE 'L'                  TO DC-OPTION-CODE.
  9320     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  9321     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  9322     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  9323
  9324     MOVE EX-PREM              TO D-PREM.
  9325     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  9326     MOVE EX-TERM              TO D-TERM.
  9327     MOVE M2 (1)               TO D-REM-TERM.
  9328     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  9329     MOVE EX-INITIAL-AMT       TO D-BENEFIT.
  9330     MOVE 'L'                  TO D-L-A.
  9331     MOVE 'LIFE REIN '         TO D-BEN-DESC.
  9332
  9333     PERFORM 1600-PRINT-A-LINE.
  9334
  9335 2150-BYPASS-LF-DETAIL-REIN.
  9336
  9337     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
  9338
  9339 3000-DO-AH-REIN.
  9340
  9341     MOVE HOLD-AH-RECORD        TO CALL-EXTRACT.
  9342
  9343     MOVE REIN-COMP (SUB1)      TO EX-REIN.
  9344
  9345     MOVE ZEROS                 TO EX-PREM
  9346                                   EX-PRIM-FAC-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS158.cbl
  9347                                   EX-OVR-COMM (1)
  9348                                   EX-OVR-COMM (2)
  9349                                   EX-OVR-COMM (3)
  9350                                   EX-AGT-COMM (1)
  9351                                   EX-AGT-COMM (2)
  9352                                   EX-AGT-COMM (3)
  9353                                   EX-INITIAL-AMT
  9354                                   EX-BENEFIT
  9355                                   EX-CNC-AMT (1)
  9356                                   EX-CNC-AMT (2)
  9357                                   EX-CNC-AMT (3)
  9358                                   EX-CLAIM-AMT (1)
  9359                                   EX-CLAIM-AMT (2)
  9360                                   EX-CLAIM-AMT (3).
  9361
  9362     IF REIN-AH-FLG (SUB1) = 'X'
  9363         MOVE RWF-AHAMT          TO EX-BENEFIT
  9364         MOVE RWF-AHPRM          TO EX-PREM
  9365                                    EX-PRIM-FAC-PREM
  9366         MOVE CR-AHTYP           TO EX-BEN-TYPE
  9367     ELSE
  9368         MOVE ZEROS              TO EX-BEN-TYPE.
  9369
  9370     IF REIN-AH-FLG (SUB1) = 'X'
  9371        IF SINGLE-PERIOD-PROCESS
  9372            IF AH-CAN GREATER THAN BEGIN-DT (1) AND
  9373               AH-CAN NOT GREATER THAN END-DT (1)
  9374               MOVE RWF-AHRFND   TO EX-CNC-AMT (1)
  9375            ELSE
  9376               NEXT SENTENCE
  9377        ELSE
  9378        IF AH-CAN GREATER THAN BEGIN-DT (1) AND
  9379           AH-CAN NOT GREATER THAN END-DT (1)
  9380           MOVE RWF-AHRFND       TO EX-CNC-AMT (1)
  9381        ELSE
  9382        IF AH-CAN GREATER THAN BEGIN-DT (2) AND
  9383           AH-CAN NOT GREATER THAN END-DT (2)
  9384           MOVE RWF-AHRFND       TO EX-CNC-AMT (2)
  9385        ELSE
  9386        IF AH-CAN GREATER THAN BEGIN-DT (3) AND
  9387           AH-CAN NOT GREATER THAN END-DT (3)
  9388           MOVE RWF-AHRFND       TO EX-CNC-AMT (3).
  9389
  9390     IF (REIN-AH-FLG (SUB1) = 'X') AND
  9391        (CR-AHPRM NOT = +0)
  9392        COMPUTE AH-DEV-TO-PRIM-FACTOR =
  9393              (WS-HOLD-AH-PRIM-FAC / CR-AHPRM)
  9394        COMPUTE EX-PRIM-FAC-PREM =
  9395              (AH-DEV-TO-PRIM-FACTOR * EX-PREM).
  9396
  9397 3010-DO-REIN-AH-CLM.
  9398
  9399     IF SINGLE-PERIOD-PROCESS
  9400         MOVE WS-CLAIM-AMT (2 2 1) TO EX-CLAIM-AMT (1)
  9401         MOVE WS-CLAIM-AMT (2 2 2) TO EX-CLAIM-AMT (2)
  9402     ELSE
  9403         MOVE WS-CLAIM-AMT (2 2 1) TO EX-CLAIM-AMT (1)
  9404         MOVE WS-CLAIM-AMT (2 2 2) TO EX-CLAIM-AMT (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS158.cbl
  9405         MOVE WS-CLAIM-AMT (2 2 3) TO EX-CLAIM-AMT (3).
  9406
  9407     MOVE +0                     TO SB.
  9408
  9409 3020-DO-REIN-AH-ISS-COMM.
  9410
  9411     ADD +1 TO SB.
  9412     IF SB GREATER THAN NUMBER-OF-PERIODS
  9413         MOVE +0      TO SB
  9414         GO TO 3030-DO-REIN-AH-CNC-COMM.
  9415
  9416     IF EX-PREM = +0
  9417        GO TO 3020-DO-REIN-AH-ISS-COMM.
  9418
  9419     IF ENTRY-DT GREATER THAN BEGIN-DT (SB) AND
  9420        NOT GREATER THAN END-DT (SB)
  9421        MOVE +1                     TO SV-FACTOR
  9422        MOVE EX-PREM                TO COMM-PREMM
  9423        MOVE 'X'                    TO FROM-REIN
  9424        PERFORM 5030-COMMISSIONS-AH THRU 5050-A-COMM-EXIT.
  9425
  9426     GO TO 3020-DO-REIN-AH-ISS-COMM.
  9427
  9428 3030-DO-REIN-AH-CNC-COMM.
  9429
  9430     ADD +1 TO SB.
  9431     IF SB GREATER THAN NUMBER-OF-PERIODS
  9432         GO TO 3040-END-AH-REIN.
  9433
  9434     IF EX-CNC-AMT (SB) = +0
  9435        GO TO 3030-DO-REIN-AH-CNC-COMM.
  9436
  9437     MOVE -1                     TO SV-FACTOR.
  9438     MOVE EX-CNC-AMT (SB)        TO COMM-PREMM.
  9439     MOVE 'X'                    TO FROM-REIN.
  9440     PERFORM 5030-COMMISSIONS-AH THRU 5050-A-COMM-EXIT.
  9441
  9442     GO TO 3030-DO-REIN-AH-CNC-COMM.
  9443
  9444 3040-END-AH-REIN.
  9445
  9446     MOVE EX-PREM TO WRK-C.
  9447
  9448*    PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  9449     PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  9450         VARYING YR FROM +1 BY +1
  9451         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9452
  9453     PERFORM 1150-BUILD-AH-DEV-RESERVES
  9454         VARYING YR FROM +1 BY +1
  9455         UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9456
  9457     IF EX-PREM NOT = EX-PRIM-FAC-PREM
  9458        MOVE EX-PRIM-FAC-PREM TO WRK-C
  9459*       PERFORM 1200-CALC-AH-UNEARN THRU 1299-AH-UNEARN-EXIT
  9460        PERFORM 1200-CALC-AH-UNEARN THRU 1200-EXIT
  9461            VARYING YR FROM +1 BY +1
  9462            UNTIL YR GREATER THAN NUMBER-OF-PERIODS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS158.cbl
  9463            PERFORM 1170-BUILD-AH-PRI-RESERVES
  9464                VARYING YR FROM +1 BY +1
  9465                UNTIL YR GREATER THAN NUMBER-OF-PERIODS.
  9466
  9467     IF DTE-PGM-OPT NOT = '3' AND '4'
  9468        GO TO 3050-BYPASS-AH-DETAIL-REIN.
  9469
  9470     MOVE EX-CARRIER           TO D-CARR.
  9471     MOVE EX-GROUPING          TO D-GROUP.
  9472     MOVE EX-STATE             TO D-STATE.
  9473     MOVE EX-ACCOUNT           TO D-ACCOUNT.
  9474     MOVE CR-CERT-NO           TO D-CERT-NO.
  9475
  9476     MOVE 'L'                  TO DC-OPTION-CODE.
  9477     MOVE EX-EFF-DATE          TO DC-GREG-DATE-CYMD.
  9478     PERFORM 6150-DATE-CONVERSION-ROUTINE.
  9479     MOVE DC-GREG-DATE-1-EDIT  TO D-EFF-DATE.
  9480
  9481     MOVE EX-PREM              TO D-PREM.
  9482     MOVE EX-PRIM-FAC-PREM     TO D-PRI-PREM.
  9483     MOVE EX-TERM              TO D-TERM.
  9484     MOVE M2 (1)               TO D-REM-TERM.
  9485     MOVE EX-END-ST-RES (1)    TO D-UNEARN.
  9486     MOVE EX-BENEFIT           TO D-BENEFIT.
  9487     MOVE 'A'                  TO D-L-A.
  9488     MOVE ' AH REIN'           TO D-BEN-DESC.
  9489
  9490     PERFORM 1600-PRINT-A-LINE.
  9491
  9492 3050-BYPASS-AH-DETAIL-REIN.
  9493
  9494     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
  9495
  9496 3050-REINSURANCE-EXTRACTS-X.
  9497     EXIT.
  9498
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS158.cbl
  9500 4000-REINSURANCE-ROUTINES.
* 9501                             COPY ECSRIRTN.
  9502******************************************************************04/30/98
  9503*                                                                *ECSRIRTN
  9504*                            ECSRIRTN                            *   LV012
  9505*                            VMOD=2.025.                         *ECSRIRTN
  9506*                                                                *ECSRIRTN
  9507******************************************************************ECSRIRTN
  9508******************************************************************
  9509*                   C H A N G E   L O G
  9510*
  9511* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  9512*-----------------------------------------------------------------
  9513*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  9514* EFFECTIVE    NUMBER
  9515*-----------------------------------------------------------------
  9516* 062703                   PEMA  ADD DCC CLIENT ID TO
  9517*                                SPECIAL CEDED CLAIM CALC
  9518* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  9519* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
  9520                                                                  ECSRIRTN
  9521 REINSURE-CALC.                                                   ECSRIRTN
  9522                                                                  ECSRIRTN
  9523     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  9524     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  9525     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  9526     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  9527                                   REIN-REM-SW (SUB1).            ECSRIRTN
  9528                                                                  ECSRIRTN
  9529     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  9530                                   WS-RWF-EP-STOP-DATE-N             CL*12
  9531                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  9532                                                                  ECSRIRTN
  9533     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9534                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  9535                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  9536                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9537                                                                  ECSRIRTN
  9538     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  9539        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  9540          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  9541          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  9542          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  9543                                                                  ECSRIRTN
  9544     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  9545        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  9546         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9547                                                                  ECSRIRTN
  9548     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  9549                                          WS-RWF-EP-STOP-DATE-N      CL*12
  9550                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  9551                                                                  ECSRIRTN
  9552     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  9553         GO TO CALC-CONTINUED.                                    ECSRIRTN
  9554                                                                  ECSRIRTN
  9555     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  9556         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  9557                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9558                                                                  ECSRIRTN
  9559     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  9560         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  9561                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  9562                                                                  ECSRIRTN
  9563 CALC-CONTINUED.                                                  ECSRIRTN
  9564                                                                  ECSRIRTN
  9565     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  9566     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  9567                                                                  ECSRIRTN
  9568     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  9569         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  9570     ELSE                                                         ECSRIRTN
  9571         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  9572     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  9573                                                                  ECSRIRTN
  9574     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  9575     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  9576     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  9577         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  9578     ELSE                                                         ECSRIRTN
  9579         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  9580     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  9581                                                                  ECSRIRTN
  9582     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  9583         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  9584         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  9585         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  9586         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  9587         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  9588         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  9589                                                                  ECSRIRTN
  9590     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  9591         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  9592                                                                  ECSRIRTN
  9593     IF CR-DT LESS WT-LO-DATE                                        CL**2
  9594         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9595                                                                  ECSRIRTN
  9596     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  9597         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  9598                                                                  ECSRIRTN
  9599     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  9600     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  9601                                                                  ECSRIRTN
  9602     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  9603         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  9604                                                                  ECSRIRTN
  9605     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  9606       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9607        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  9608        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  9609           NEXT SENTENCE                                          ECSRIRTN
  9610       ELSE                                                       ECSRIRTN
  9611           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  9612                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  9613                                                                  ECSRIRTN
  9614     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9615         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9616            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  9617             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  9618                                                                  ECSRIRTN
  9619     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  9620         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  9621            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  9622             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  9623                                                                  ECSRIRTN
  9624     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  9625         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  9626             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  9627                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  9628             ELSE                                                 ECSRIRTN
  9629                 NEXT SENTENCE                                    ECSRIRTN
  9630         ELSE                                                     ECSRIRTN
  9631             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9632                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9633                                                                  ECSRIRTN
  9634     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  9635         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  9636             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  9637                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  9638             ELSE                                                 ECSRIRTN
  9639                 NEXT SENTENCE                                    ECSRIRTN
  9640         ELSE                                                     ECSRIRTN
  9641             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  9642                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  9643                                                                  ECSRIRTN
  9644     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  9645         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  9646                                                                  ECSRIRTN
  9647     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  9648         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  9649         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  9650                                                                  ECSRIRTN
  9651     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  9652         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  9653                                                                  ECSRIRTN
  9654     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  9655         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  9656         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  9657                                                                  ECSRIRTN
  9658     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9659         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  9660                                                                  ECSRIRTN
  9661     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9662         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  9663                                                                  ECSRIRTN
  9664     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  9665                                                                  ECSRIRTN
  9666 REINSURE-CK-LIFE.                                                ECSRIRTN
  9667                                                                  ECSRIRTN
  9668     IF CR-LFTYP = ZERO                                           ECSRIRTN
  9669         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9670                                                                  ECSRIRTN
  9671     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  9672         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9673                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9674     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  9675         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  9676             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9677                                                                  ECSRIRTN
  9678     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9679                                                                  ECSRIRTN
  9680     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  9681         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  9682             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9683         ELSE                                                     ECSRIRTN
  9684             NEXT SENTENCE                                        ECSRIRTN
  9685     ELSE                                                         ECSRIRTN
  9686         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  9687             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9688                                                                  ECSRIRTN
  9689     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  9690         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  9691             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  9692         ELSE                                                     ECSRIRTN
  9693             NEXT SENTENCE                                        ECSRIRTN
  9694     ELSE                                                         ECSRIRTN
  9695         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  9696             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9697                                                                  ECSRIRTN
  9698     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9699         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  9700             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9701                                                                  ECSRIRTN
  9702     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9703         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  9704            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9705                                                                  ECSRIRTN
  9706     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  9707         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  9708             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9709                                                                  ECSRIRTN
  9710     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  9711         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  9712            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9713                                                                  ECSRIRTN
  9714     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9715         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9716             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9717                                                                  ECSRIRTN
  9718     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  9719         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9720            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  9721            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  9722             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9723                                                                  ECSRIRTN
  9724     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  9725         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  9726            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  9727             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9728                                                                  ECSRIRTN
  9729     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9730         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  9731             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9732                                                                  ECSRIRTN
  9733     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9734         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  9735             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9736                                                                  ECSRIRTN
  9737     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  9738        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  9739           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  9740            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9741                                                                  ECSRIRTN
  9742     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9743         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9744            CR-IND-GRP = '1'                                      ECSRIRTN
  9745             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9746                                                                  ECSRIRTN
  9747     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  9748         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9749            CR-IND-GRP = '1'                                      ECSRIRTN
  9750             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9751                                                                  ECSRIRTN
  9752     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  9753         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9754            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  9755            CR-IND-GRP = '1'                                      ECSRIRTN
  9756             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9757                                                                  ECSRIRTN
  9758     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  9759         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  9760            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  9761            CR-IND-GRP = '1'                                      ECSRIRTN
  9762             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  9763                                                                  ECSRIRTN
  9764     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9765         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  9766            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  9767                                                                  ECSRIRTN
  9768     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9769        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  9770                                                                  ECSRIRTN
  9771     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  9772         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9773                                                                  ECSRIRTN
  9774     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  9775         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9776                                                                  ECSRIRTN
  9777     IF CR-LF-TERM  NUMERIC                                       00002331
  9778        NEXT SENTENCE                                             00002332
  9779     ELSE                                                         00002333
  9780        MOVE ZEROS               TO CR-LF-TERM                    00002334
  9781     END-IF
  9782                                                                  00002335
  9783     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  9784         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9785                                                                  ECSRIRTN
  9786     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  9787         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9788                                                                  ECSRIRTN
  9789     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9790                                                                  ECSRIRTN
  9791     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  9792         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9793                                                                  ECSRIRTN
  9794     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  9795         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  9796                                                                  ECSRIRTN
  9797     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  9798                                                                  ECSRIRTN
  9799 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  9800     EXIT.                                                        ECSRIRTN
  9801                                                                  ECSRIRTN
  9802 REINSURE-CK-AH.                                                  ECSRIRTN
  9803                                                                  ECSRIRTN
  9804     IF CR-AHTYP = ZERO                                           ECSRIRTN
  9805         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9806                                                                  ECSRIRTN
  9807     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  9808         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9809                                                                  ECSRIRTN
  9810     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  9811         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  9812             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9813                                                                  ECSRIRTN
  9814     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  9815                                                                  ECSRIRTN
  9816     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  9817         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  9818             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  9819         ELSE                                                     ECSRIRTN
  9820             NEXT SENTENCE                                        ECSRIRTN
  9821     ELSE                                                         ECSRIRTN
  9822         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  9823             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9824                                                                  ECSRIRTN
  9825     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  9826         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  9827             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9828                                                                  ECSRIRTN
  9829     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  9830         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  9831             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9832                                                                  ECSRIRTN
  9833     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  9834         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  9835             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9836                                                                  ECSRIRTN
  9837     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  9838         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  9839             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9840                                                                  ECSRIRTN
  9841     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  9842         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  9843            CR-IND-GRP = '1'                                      ECSRIRTN
  9844             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9845                                                                  ECSRIRTN
  9846     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  9847         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9848             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9849                                                                  ECSRIRTN
  9850     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  9851         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  9852            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9853                                                                  ECSRIRTN
  9854     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  9855         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  9856            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  9857                                                                  ECSRIRTN
  9858     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  9859         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  9860             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  9861                                                                  ECSRIRTN
  9862     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  9863        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  9864                                                                  ECSRIRTN
  9865     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  9866         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9867                                                                  ECSRIRTN
  9868     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  9869         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9870                                                                  ECSRIRTN
  9871     IF CR-AH-TERM  NUMERIC                                       00002331
  9872        NEXT SENTENCE                                             00002332
  9873     ELSE                                                         00002333
  9874        MOVE ZEROS               TO CR-AH-TERM                    00002334
  9875     END-IF
  9876                                                                  00002335
  9877     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  9878         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9879                                                                  ECSRIRTN
  9880     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  9881         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9882                                                                  ECSRIRTN
  9883     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9884                                                                  ECSRIRTN
  9885     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  9886         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  9887             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  9888                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  9889                                                                  ECSRIRTN
  9890     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  9891         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  9892             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  9893                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  9894                                                                  ECSRIRTN
  9895     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  9896     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  9897                                                                  ECSRIRTN
  9898     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  9899         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  9900                                                                  ECSRIRTN
  9901     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  9902         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  9903                                                                  ECSRIRTN
  9904     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  9905                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9906     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  9907                                                                  ECSRIRTN
  9908     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  9909         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9910                                                                  ECSRIRTN
  9911     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9912         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  9913                                                                  ECSRIRTN
  9914     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  9915                                                                  ECSRIRTN
  9916 REINSURE-CK-AH-X.                                                ECSRIRTN
  9917     EXIT.                                                        ECSRIRTN
  9918                                                                  ECSRIRTN
  9919 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  9920                                                                  ECSRIRTN
  9921     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  9922        RS-AH-BEN = ZERO                                          ECSRIRTN
  9923         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9924                                                                  ECSRIRTN
  9925     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  9926        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  9927         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  9928                                                                  ECSRIRTN
  9929     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9930                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  9931                                                                  ECSRIRTN
  9932     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  9933         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  9934             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  9935                                     WT-AHBEN-HI.                 ECSRIRTN
  9936     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  9937         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  9938             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  9939                                     WT-AHMOA-HI.                 ECSRIRTN
  9940                                                                  ECSRIRTN
  9941     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  9942     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  9943                                                                  ECSRIRTN
  9944     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  9945         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  9946                                                                  ECSRIRTN
  9947     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  9948         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  9949                                                                  ECSRIRTN
  9950     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  9951                                                                  ECSRIRTN
  9952     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  9953         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  9954                                                                  ECSRIRTN
  9955     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  9956         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  9957                                       / RW-AHWRK                 ECSRIRTN
  9958       ELSE                                                       ECSRIRTN
  9959         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  9960                                                                  ECSRIRTN
  9961     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  9962         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  9963                                       / RS-LIFE-BEN              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  9964       ELSE                                                       ECSRIRTN
  9965         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  9966                                                                  ECSRIRTN
  9967     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  9968        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  9969          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9970          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9971                                      / CR-AH-TERM.               ECSRIRTN
  9972                                                                  ECSRIRTN
  9973     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9974        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  9975          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9976          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9977               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9978            ELSE                                                  ECSRIRTN
  9979                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9980                                                                  ECSRIRTN
  9981     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  9982        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  9983        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  9984          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  9985          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  9986                                      / CR-AH-TERM                ECSRIRTN
  9987         ELSE                                                     ECSRIRTN
  9988          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  9989          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  9990               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  9991            ELSE                                                  ECSRIRTN
  9992                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  9993                                                                  ECSRIRTN
  9994 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  9995     EXIT.                                                        ECSRIRTN
  9996                                                                  ECSRIRTN
  9997                                                                  ECSRIRTN
  9998 REIN-CALC-LIFE.                                                  ECSRIRTN
  9999                                                                  ECSRIRTN
 10000     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 10001         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 10002     ELSE                                                         ECSRIRTN
 10003         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 10004                                                                  ECSRIRTN
 10005     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 10006         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 10007     ELSE                                                         ECSRIRTN
 10008         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 10009           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 10010               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 10011           ELSE                                                   ECSRIRTN
 10012               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 10013                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 10014                                                                  ECSRIRTN
 10015 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 10016                                                                  ECSRIRTN
 10017     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
 10018                                                                  ECSRIRTN
 10019     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10020         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 10021                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10022     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10023         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 10024         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 10025                                                                  ECSRIRTN
 10026     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 10027         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 10028                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 10029         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 10030                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 10031     ELSE                                                         ECSRIRTN
 10032         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10033             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 10034             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 10035                                                                  ECSRIRTN
 10036     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 10037         (WT-LF-QC = '2' AND                                         CL**8
 10038          PGM-SUB = +50  AND                                         CL**8
 10039          DTE-CLIENT = 'LAP'))                                       CL**8
 10040          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 10041     ELSE                                                         ECSRIRTN
 10042         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 10043                                                                  ECSRIRTN
 10044     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 10045         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 10046         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 10047         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 10048                                                                  ECSRIRTN
 10049     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 10050                                                                  ECSRIRTN
 10051 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 10052                                                                  ECSRIRTN
 10053     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 10054         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 10055         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 10056                                                                  ECSRIRTN
 10057     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 10058     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 10059     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 10060                                       RW-LFPRM.                  ECSRIRTN
 10061                                                                  ECSRIRTN
 10062 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 10063                                                                  ECSRIRTN
 10064     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 10065                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 10066                                                                  ECSRIRTN
 10067     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 10068        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 10069                                                                  ECSRIRTN
 10070     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 10071        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10072         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 10073     ELSE                                                         ECSRIRTN
 10074         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10075         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
 10076                                                                  ECSRIRTN
 10077                                                                  ECSRIRTN
 10078 REIN-CALC-LIFE-X.                                                ECSRIRTN
 10079     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10080                                                                  ECSRIRTN
 10081 REIN-CALC-AH.                                                    ECSRIRTN
 10082                                                                  ECSRIRTN
 10083     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 10084         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 10085             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 10086                                 WT-AHBEN-HI.                     ECSRIRTN
 10087                                                                  ECSRIRTN
 10088     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 10089         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 10090             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 10091                                 WT-AHMOA-HI.                     ECSRIRTN
 10092                                                                  ECSRIRTN
 10093     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 10094     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 10095                                                                  ECSRIRTN
 10096     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 10097         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 10098                                                                  ECSRIRTN
 10099     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 10100         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 10101                                                                  ECSRIRTN
 10102     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 10103         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 10104                                                                  ECSRIRTN
 10105     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 10106         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 10107     ELSE                                                         ECSRIRTN
 10108         IF WT-REMAINING = 'L'                                    ECSRIRTN
 10109             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 10110         ELSE                                                     ECSRIRTN
 10111             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 10112             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 10113                                                                  ECSRIRTN
 10114 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 10115                                                                  ECSRIRTN
 10116     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10117         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 10118                                                                  ECSRIRTN
 10119     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10120         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 10121         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 10122                                                                  ECSRIRTN
 10123     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 10124         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 10125                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 10126         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 10127                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 10128     ELSE                                                         ECSRIRTN
 10129         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 10130             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 10131             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 10132                                                                  ECSRIRTN
 10133     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
 10134         (WT-AH-QC = '2' AND                                         CL**8
 10135          PGM-SUB = +50  AND                                         CL**8
 10136          DTE-CLIENT = 'LAP'))                                       CL**8
 10137         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10138     ELSE                                                         ECSRIRTN
 10139         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 10140                                                                  ECSRIRTN
 10141     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 10142         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 10143            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 10144                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 10145                                                                  ECSRIRTN
 10146     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 10147         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 10148         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 10149         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 10150                                                                  ECSRIRTN
 10151     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 10152                                                                  ECSRIRTN
 10153 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 10154                                                                  ECSRIRTN
 10155     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10156         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 10157         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 10158                                                                  ECSRIRTN
 10159     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 10160     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 10161     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 10162                                    RW-AHPRM.                     ECSRIRTN
 10163                                                                  ECSRIRTN
 10164 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 10165                                                                  ECSRIRTN
 10166     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 10167                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 10168                                                                  ECSRIRTN
 10169     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 10170                                                                  ECSRIRTN
 10171     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 10172        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10173         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 10174     ELSE                                                         ECSRIRTN
 10175         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10176         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 10177                                                                  ECSRIRTN
 10178                                                                  ECSRIRTN
 10179 REIN-CALC-AH-X.                                                  ECSRIRTN
 10180     EXIT.                                                        ECSRIRTN
 10181                                                                  ECSRIRTN
 10182 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 10183                                                                  ECSRIRTN
 10184     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 10185     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 10186     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 10187     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 10188                                                                  ECSRIRTN
 10189     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 10190         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 10191                                                                  ECSRIRTN
 10192     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 10193        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 10194           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 10195                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10196     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 10197        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 10198           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 10199                                                                  ECSRIRTN
 10200 REINSURE-CALC-X.                                                 ECSRIRTN
 10201                                                                  ECSRIRTN
 10202     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10203         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10204                                                                  ECSRIRTN
 10205     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10206                                                                  ECSRIRTN
 10207 REINSURE-SUBTRACT.                                               ECSRIRTN
 10208                                                                  ECSRIRTN
 10209     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 10210     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 10211     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 10212     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 10213                                                                  ECSRIRTN
 10214 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 10215     EXIT.                                                        ECSRIRTN
 10216                                                                  ECSRIRTN
 10217 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 10218                                                                  ECSRIRTN
 10219     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 10220     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 10221                                                                  ECSRIRTN
 10222     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 10223         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 10224                                                                  ECSRIRTN
 10225     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10226         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10227                                                                  ECSRIRTN
 10228     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 10229         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 10230             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 10231                                                                  ECSRIRTN
 10232     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10233         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 10234                                                                  ECSRIRTN
 10235     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10236         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 10237         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10238                                                                  ECSRIRTN
 10239     IF CR-LFPRM = ZERO                                           ECSRIRTN
 10240        MOVE ZERO                TO REIN-FACTOR
 10241     ELSE                                                         ECSRIRTN
 10242        IF DTE-CLIENT = 'GIC'  AND
 10243           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 10244           MOVE +1.0             TO REIN-FACTOR
 10245        ELSE
 10246           IF DTE-CLIENT = 'DCC'
 10247              COMPUTE REIN-FACTOR = CR-LFRFND /
 10248                 (CR-LFPRM + CR-LFPRM-ALT)
 10249           ELSE
 10250              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 10251                 (CR-LFPRM + CR-LFPRM-ALT)
 10252            END-IF
 10253         END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10254     END-IF
 10255                                                                  ECSRIRTN
 10256     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 10257         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 10258             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10259                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 10260                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10261             ELSE                                                 ECSRIRTN
 10262                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10263                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10264                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 10265                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10266         ELSE                                                     ECSRIRTN
 10267             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10268                 compute rein-factor rounded =
 10269                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 10270                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 10271                    rein-factor
 10272             ELSE                                                 ECSRIRTN
 10273*                COMPUTE RWF-LFRFND = REIN-FACTOR
 10274*                   * REIN-CALCED-LIFE *
 10275*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 10276                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10277                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10278                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 10279                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 10280                                                                  ECSRIRTN
 10281     IF CR-LFAMT = ZERO                                           ECSRIRTN
 10282         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10283             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 10284                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 10285                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 10286             ELSE                                                 ECSRIRTN
 10287                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 10288                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 10289                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 10290                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 10291                                                                  ECSRIRTN
 10292     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 10293                                                                  ECSRIRTN
 10294                                                                  ECSRIRTN
 10295 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 10296                                                                  ECSRIRTN
 10297     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 10298       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 10299         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 10300         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10301                                                                  ECSRIRTN
 10302     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10303       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 10304           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 10305           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 10306       ELSE                                                       ECSRIRTN
 10307           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
 10308               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 10309                                                                  ECSRIRTN
 10310     IF FLAT-CANCEL-LF                                            ECSRIRTN
 10311         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10312         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10313                                                                  ECSRIRTN
 10314     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 10315         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 10316         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 10317                                                                  ECSRIRTN
 10318     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 10319     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 10320     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 10321                                         RW-LFRFND.               ECSRIRTN
 10322                                                                  ECSRIRTN
 10323 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 10324                                                                  ECSRIRTN
 10325     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 10326                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 10327                                                                  ECSRIRTN
 10328     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 10329        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 10330                                                                  ECSRIRTN
 10331     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 10332        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10333         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 10334     ELSE                                                         ECSRIRTN
 10335         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10336         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 10337                                                                  ECSRIRTN
 10338                                                                  ECSRIRTN
 10339 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 10340                                                                  ECSRIRTN
 10341     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10342         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10343                                                                  ECSRIRTN
 10344     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10345         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 10346             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 10347                                                                  ECSRIRTN
 10348     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 10349         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 10350         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 10351             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 10352                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 10353         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10354                                                                  ECSRIRTN
 10355     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10356         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 10357                                                                  ECSRIRTN
 10358     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10359         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 10360         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10361                                                                  ECSRIRTN
 10362     IF CR-AHPRM = ZERO                                           ECSRIRTN
 10363        MOVE ZERO                TO REIN-FACTOR
 10364     ELSE
 10365        IF DTE-CLIENT = 'GIC'  AND
 10366           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 10367            MOVE +1.0            TO REIN-FACTOR
 10368        ELSE
 10369           IF DTE-CLIENT = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10370              COMPUTE REIN-FACTOR =
 10371                 CR-AHRFND / CR-AHPRM
 10372           ELSE
 10373              COMPUTE REIN-FACTOR ROUNDED =
 10374                                CR-AHRFND-CALC / CR-AHPRM
 10375           END-IF
 10376        END-IF
 10377     END-IF
 10378
 10379     IF CR-AHAMT NOT = ZERO
 10380        IF (DTE-CLIENT = 'DCC')
 10381           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 10382           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 10383        ELSE
 10384           IF WT-AH-QC = ('1' OR '4')
 10385              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 10386              compute rwf-ahrfnd rounded =
 10387                 cr-ahrfnd * rein-factor
 10388           ELSE
 10389              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 10390              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 10391                       RWF-AHAMT) / CR-AHAMT
 10392           END-IF
 10393        END-IF
 10394     ELSE
 10395        IF RWF-AH-LIMIT = ZERO
 10396           IF WT-AH-QC = ('1' OR '4')
 10397              COMPUTE RWF-AHRFND ROUNDED =
 10398                       CR-AHRFND * WT-AH-PCT
 10399           ELSE
 10400              COMPUTE RWF-AHRFND =
 10401                            REIN-FACTOR * REIN-CALCED-AH
 10402              COMPUTE RWF-AHRFND ROUNDED =
 10403                       RWF-AHRFND * WT-AH-PCT
 10404           END-IF
 10405        END-IF
 10406     END-IF
 10407
 10408     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 10409                                                                  ECSRIRTN
 10410                                                                  ECSRIRTN
 10411 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 10412                                                                  ECSRIRTN
 10413     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 10414       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 10415         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 10416         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10417                                                                  ECSRIRTN
 10418     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10419       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 10420           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 10421           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 10422       ELSE                                                       ECSRIRTN
 10423           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
 10424               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 10425                                                                  ECSRIRTN
 10426     IF FLAT-CANCEL-AH                                            ECSRIRTN
 10427         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10428         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10429                                                                  ECSRIRTN
 10430     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 10431         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 10432         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 10433                                                                  ECSRIRTN
 10434     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 10435     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 10436     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 10437                                    RW-AHRFND.                    ECSRIRTN
 10438                                                                  ECSRIRTN
 10439 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 10440                                                                  ECSRIRTN
 10441     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 10442                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 10443                                                                  ECSRIRTN
 10444     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 10445                                                                  ECSRIRTN
 10446     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 10447        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 10448         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 10449     ELSE                                                         ECSRIRTN
 10450         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 10451         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 10452                                                                  ECSRIRTN
 10453                                                                  ECSRIRTN
 10454 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 10455                                                                  ECSRIRTN
 10456     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10457         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10458                                                                  ECSRIRTN
 10459     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10460         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10461                                                                  ECSRIRTN
 10462     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 10463                                                                  ECSRIRTN
 10464 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 10465                                                                  ECSRIRTN
 10466     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 10467     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 10468                                                                  ECSRIRTN
 10469     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 10470         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 10471             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10472                                                                  ECSRIRTN
 10473     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 10474         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10475                                                                  ECSRIRTN
 10476     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 10477         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10478                                                                  ECSRIRTN
 10479 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 10480                                                                  ECSRIRTN
 10481     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10482         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10483                                                                  ECSRIRTN
 10484     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10485                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10486 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 10487                                                                  ECSRIRTN
 10488     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 10489     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 10490                                                                  ECSRIRTN
 10491 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 10492     EXIT.                                                        ECSRIRTN
 10493                                                                  ECSRIRTN
 10494 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 10495                                                                  ECSRIRTN
 10496     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10497         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 10498                                                                  ECSRIRTN
 10499 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 10500     EXIT.                                                        ECSRIRTN
 10501                                                                  ECSRIRTN
 10502 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 10503                                                                  ECSRIRTN
 10504     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 10505     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 10506                                                                  ECSRIRTN
 10507     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 10508         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 10509                                                                  ECSRIRTN
 10510     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 10511        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 10512          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 10513          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 10514          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 10515                                                                  ECSRIRTN
 10516     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 10517        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 10518          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 10519                                                                  ECSRIRTN
 10520     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 10521                                  RWF-AHCLML.                     ECSRIRTN
 10522                                                                  ECSRIRTN
 10523     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10524         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10525                                                                  ECSRIRTN
 10526     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 10527         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10528                                                                  ECSRIRTN
 10529     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10530         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10531             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 10532                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10533                                                                  ECSRIRTN
 10534     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 10535         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10536                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 10537                                                                  ECSRIRTN
 10538     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10539         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
 10540                                                                  ECSRIRTN
 10541     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10542         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10543             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10544                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10545             ELSE                                                 ECSRIRTN
 10546                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 10547         ELSE                                                     ECSRIRTN
 10548             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 10549                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 10550                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 10551             ELSE                                                 ECSRIRTN
 10552                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 10553                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 10554                                                                  ECSRIRTN
 10555     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10556         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10557                                                                  ECSRIRTN
 10558     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 10559         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 10560            OR 'DCC'
 10561             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 10562                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 10563         ELSE                                                     ECSRIRTN
 10564             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 10565                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 10566                                                                  ECSRIRTN
 10567     IF CR-LFAMT = ZERO                                           ECSRIRTN
 10568         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 10569             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10570                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 10571                                                                  ECSRIRTN
 10572     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10573         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10574             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 10575                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 10576                                                                  ECSRIRTN
 10577     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10578         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10579             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10580               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 10581                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10582                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10583                  ELSE                                            ECSRIRTN
 10584                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 10585                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 10586              ELSE                                                ECSRIRTN
 10587                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 10588                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 10589                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 10590                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 10591                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 10592                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 10593                                                                  ECSRIRTN
 10594     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10595                                                                  ECSRIRTN
 10596     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 10597                                                                  ECSRIRTN
 10598                                                                  ECSRIRTN
 10599 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 10600                                                                  ECSRIRTN
 10601     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10602         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10603                                                                  ECSRIRTN
 10604     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 10605         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 10606     ELSE                                                         ECSRIRTN
 10607         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 10608                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 10609                                                                  ECSRIRTN
 10610     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10611         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 10612                                                                  ECSRIRTN
 10613     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10614         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 10615             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10616         ELSE                                                     ECSRIRTN
 10617             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 10618     ELSE                                                         ECSRIRTN
 10619         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 10620             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 10621             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 10622         ELSE                                                     ECSRIRTN
 10623             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 10624             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 10625                                                                  ECSRIRTN
 10626                                                                  ECSRIRTN
 10627 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 10628                                                                  ECSRIRTN
 10629     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 10630         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 10631                                                                  ECSRIRTN
 10632     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10633         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10634                                                                  ECSRIRTN
 10635     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 10636         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 10637                                                                  ECSRIRTN
 10638     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 10639     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 10640                                                                  ECSRIRTN
 10641     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 10642             VARYING                                              ECSRIRTN
 10643         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 10644             UNTIL                                                ECSRIRTN
 10645         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 10646                                                                  ECSRIRTN
 10647     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10648         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 10649     ELSE                                                         ECSRIRTN
 10650         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 10651                                                                  ECSRIRTN
 10652 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 10653                                                                  ECSRIRTN
 10654     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 10655         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10656                                                                  ECSRIRTN
 10657     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10658       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 10659           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10660                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 10661               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10662                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10663               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 10664                                                                  ECSRIRTN
 10665     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10666       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 10667           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 10668                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 10669           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 10670                                                                  ECSRIRTN
 10671     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 10672         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10673                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10674                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 10675         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10676                                                                  ECSRIRTN
 10677     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10678         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10679                                                                  ECSRIRTN
 10680     IF INC-SUB = +1                                              ECSRIRTN
 10681         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10682     IF INC-SUB = +2                                              ECSRIRTN
 10683         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10684     IF INC-SUB = +3                                              ECSRIRTN
 10685         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10686     IF INC-SUB = +4                                              ECSRIRTN
 10687         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10688     IF INC-SUB = +5                                              ECSRIRTN
 10689         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 10690                                                                  ECSRIRTN
 10691     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10692                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10693                                                                  ECSRIRTN
 10694     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10695         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 10696                                                                  ECSRIRTN
 10697     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 10698              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 10699         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 10700     ELSE                                                         ECSRIRTN
 10701         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 10702                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 10703                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 10704                                                                  ECSRIRTN
 10705 CHECK-DISABS-EXIT.                                               ECSRIRTN
 10706      EXIT.                                                       ECSRIRTN
 10707                                                                  ECSRIRTN
 10708 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 10709                                                                  ECSRIRTN
 10710     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 10711         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10712                                                                  ECSRIRTN
 10713     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10714         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 10715             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 10716                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 10717                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10718     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 10719         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 10720             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 10721                                                                  ECSRIRTN
 10722 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 10723                                                                  ECSRIRTN
 10724     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 10725         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 10726         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 10727             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 10728                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 10729         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 10730         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10731                                                                  ECSRIRTN
 10732     IF WT-REMAINING = 'I'                                        ECSRIRTN
 10733         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 10734                                                                  ECSRIRTN
 10735     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10736         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 10737             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 10738                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10739             ELSE                                                 ECSRIRTN
 10740                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 10741         ELSE                                                     ECSRIRTN
 10742             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 10743                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 10744                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 10745             ELSE                                                 ECSRIRTN
 10746                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 10747                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 10748                                                                  ECSRIRTN
 10749     IF WT-REMAINING = 'L'                                        ECSRIRTN
 10750         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10751                                                                  ECSRIRTN
 10752     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10753         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 10754                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 10755     ELSE                                                         ECSRIRTN
 10756         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 10757             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10758                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 10759                                                                  ECSRIRTN
 10760     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10761         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 10762             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 10763                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 10764                                                                  ECSRIRTN
 10765     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 10766         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 10767             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 10768               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 10769                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 10770                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10771                  ELSE                                            ECSRIRTN
 10772                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 10773                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 10774              ELSE                                                ECSRIRTN
 10775                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10776                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 10777                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 10778                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 10779                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 10780                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 10781                                                                  ECSRIRTN
 10782                                                                  ECSRIRTN
 10783     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 10784        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 10785                               '220000' OR '230000')              ECSRIRTN
 10786           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 10787               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 10788                                                                  ECSRIRTN
 10789     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10790                                                                  ECSRIRTN
 10791     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 10792                                                                  ECSRIRTN
 10793                                                                  ECSRIRTN
 10794 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 10795                                                                  ECSRIRTN
 10796     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 10797         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10798                                                                  ECSRIRTN
 10799     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10800         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 10801         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10802                                                                  ECSRIRTN
 10803     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 10804                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 10805                                                                  ECSRIRTN
 10806     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 10807         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10808                                                                  ECSRIRTN
 10809     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10810         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 10811                                                                  ECSRIRTN
 10812     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 10813                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 10814         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 10815                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 10816         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 10817     ELSE                                                         ECSRIRTN
 10818         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 10819         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 10820                                                                  ECSRIRTN
 10821                                                                  ECSRIRTN
 10822 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 10823                                                                  ECSRIRTN
 10824     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10825         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10826                                                                  ECSRIRTN
 10827     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10828         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10829                                                                  ECSRIRTN
 10830     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 10831                                                                  ECSRIRTN
 10832 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 10833                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10834     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 10835     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 10836                                                                  ECSRIRTN
 10837     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 10838         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 10839             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 10840                                                                  ECSRIRTN
 10841     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 10842     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 10843                                                                  ECSRIRTN
 10844     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 10845         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 10846                                                                  ECSRIRTN
 10847     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 10848         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 10849                                                                  ECSRIRTN
 10850 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 10851                                                                  ECSRIRTN
 10852     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 10853         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 10854                                                                  ECSRIRTN
 10855     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 10856                                                                  ECSRIRTN
 10857 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 10858                                                                  ECSRIRTN
 10859     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 10860     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 10861                                                                  ECSRIRTN
 10862 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 10863     EXIT.                                                        ECSRIRTN
 10864                                                                  ECSRIRTN
 10865 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 10866                                                                  ECSRIRTN
 10867     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 10868         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 10869                                                                  ECSRIRTN
 10870 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 10871     EXIT.                                                        ECSRIRTN
 10872                                                                  ECSRIRTN
 10873                                                                  ECSRIRTN
 10874 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 10875                                                                  ECSRIRTN
 10876     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 10877     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 10878     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 10879     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 10880                                                                  ECSRIRTN
 10881     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 10882         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 10883         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 10884         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 10885         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 10886         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 10887         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
 10888         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 10889         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 10890         REIN-AH-LIMIT (1).                                       ECSRIRTN
 10891                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10892     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 10893         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 10894                                                                  ECSRIRTN
 10895     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 10896                                                                  ECSRIRTN
 10897 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 10898                                                                  ECSRIRTN
 10899     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 10900                                                                  ECSRIRTN
 10901 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 10902     EXIT.                                                        ECSRIRTN
 10903                                                                  ECSRIRTN
 10904 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 10905                                                                  ECSRIRTN
 10906     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 10907                                                                  ECSRIRTN
 10908     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 10909         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 10910                                                                  ECSRIRTN
 10911     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 10912         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 10913             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 10914                                                                  ECSRIRTN
 10915     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 10916         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 10917         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 10918         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 10919     ELSE                                                         ECSRIRTN
 10920         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 10921         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 10922         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 10923                                                                  ECSRIRTN
 10924     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 10925                                                                  ECSRIRTN
 10926     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 10927        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 10928         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 10929                                                                  ECSRIRTN
 10930     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 10931         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 10932                                                                  ECSRIRTN
 10933 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 10934     EXIT.                                                        ECSRIRTN
 10935                                                                  ECSRIRTN
 10936 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 10937                                                                  ECSRIRTN
 10938     CONTINUE.                                                    ECSRIRTN
 10939*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 10940 FIND-REI-CO-EXIT.                                                ECSRIRTN
 10941     EXIT.                                                        ECSRIRTN
 10942                                                                  ECSRIRTN
 10943 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 10944                                                                  ECSRIRTN
 10945     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
 10946         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10947                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10948                                                                  ECSRIRTN
 10949     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 10950         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 10951                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 10952                                                                  ECSRIRTN
 10953     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 10954                                                                  ECSRIRTN
 10955     START ERRTBL-IN                                              ECSRIRTN
 10956           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 10957             INVALID KEY                                          ECSRIRTN
 10958               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 10959                                                                  ECSRIRTN
 10960     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 10961     MOVE 0 TO SUB1.                                              ECSRIRTN
 10962 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 10963                                                                  ECSRIRTN
 10964     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 10965                                                                  ECSRIRTN
 10966     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 10967        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 10968                                                                  ECSRIRTN
 10969     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 10970        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 10971        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 10972                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 10973        GO TO ABEND-PGM.                                          ECSRIRTN
 10974                                                                  ECSRIRTN
 10975     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 10976        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 10977                                                                  ECSRIRTN
 10978     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 10979        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 10980                                                                  ECSRIRTN
 10981     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 10982        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 10983                                                                  ECSRIRTN
 10984     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 10985        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 10986                                                                  ECSRIRTN
 10987     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 10988        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10989                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 10990        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 212)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10991                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 10992        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 212)**
**    Index-name belongs to different table - unexpected behaviour may occur
 10993                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 10994     END-PERFORM.                                                 ECSRIRTN
 10995     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 10996                                                                  ECSRIRTN
 10997     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 10998        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 10999                                                                  ECSRIRTN
 11000     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 11001        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 11002                                                                  ECSRIRTN
 11003     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 11004        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 11005                                                                  ECSRIRTN
 11006     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 11007        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 11008                                                                  ECSRIRTN
 11009     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 11010        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 11011        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 11012        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 11013        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 11014        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 11015        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 11016          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 11017                                                                  ECSRIRTN
 11018     ADD +1 TO CO-SUB.                                            ECSRIRTN
 11019                                                                  ECSRIRTN
 11020     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 11021        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 11022        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 11023        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 11024        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 11025                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 11026        GO TO ABEND-PGM.                                          ECSRIRTN
 11027                                                                  ECSRIRTN
 11028     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 11029                                                                  ECSRIRTN
 11030     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 11031                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 11032     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 11033                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 11034     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 11035                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 11036                                                                  ECSRIRTN
 11037     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 11038         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 11039     ELSE                                                         ECSRIRTN
 11040         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 11041                                                                  ECSRIRTN
 11042     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 11043     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 11044     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 11045     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 11046                                                                  ECSRIRTN
 11047 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 11048                                                                  ECSRIRTN
 11049     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 11050        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 11051                                                                  ECSRIRTN
 11052     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 11053        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 11054                                                                  ECSRIRTN
 11055     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 11056        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 11057                                                                  ECSRIRTN
 11058     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 11059        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS158.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 11060                                                                  ECSRIRTN
 11061     ADD +1 TO SUB1.                                              ECSRIRTN
 11062                                                                  ECSRIRTN
 11063     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 11064        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 11065        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 11066                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 11067        GO TO ABEND-PGM.                                          ECSRIRTN
 11068                                                                  ECSRIRTN
 11069     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 11070     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 11071     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 11072     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 11073     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 11074     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 11075     if re-state-exhibit-opt-f = 'Y'
 11076        move 'Y'         to rc2-ecs152-rpt (sub1)
 11077     else
 11078        move 'N'         to rc2-ecs152-rpt (sub1)
 11079     end-if
 11080                                                                  ECSRIRTN
 11081     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 11082                                                                  ECSRIRTN
 11083 REIN-BUILD-EXIT.                                                 ECSRIRTN
 11084     EXIT.                                                        ECSRIRTN
 11085                                                                  ECSRIRTN
 11086 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 11087                                                                  ECSRIRTN
 11088     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 11089                                                                  ECSRIRTN
 11090     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 11091                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 11092                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 11093                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 11094                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 11095                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 11096                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 11097                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 11098                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 11099                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 11100                                                                  ECSRIRTN
 11101 ZERO-RCT-EXIT.                                                   ECSRIRTN
 11102     EXIT.                                                        ECSRIRTN
 11103                                                                  ECSRIRTN
 11104 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 11105                                                                  ECSRIRTN
 11106     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 11107                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 11108     move spaces      to rc2-ecs152-rpt (co-sub)
 11109                                                                  ECSRIRTN
 11110     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 11111                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 11112                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 11113                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
 11114                                                                  ECSRIRTN
 11115 ZERO-RC2-EXIT.                                                   ECSRIRTN
 11116     EXIT.                                                        ECSRIRTN
 11117******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS158.cbl
 11118
 11119 5000-COMMISSIONS-LIFE.
 11120     MOVE +0 TO SA.
 11121
 11122 5010-COMM-LIFE-LOOP.
 11123
 11124     ADD +1 TO SA.
 11125     IF SA GREATER +10
 11126         GO TO 5020-L-COMM-EXIT.
 11127
 11128     IF CR-COM-AGT (SA) = ZEROS OR SPACES
 11129        GO TO 5010-COMM-LIFE-LOOP.
 11130
 11131     IF FROM-REIN = 'X'
 11132        IF CR-AGT-TYPE (SA) = 'W'
 11133           MOVE CR-COM-AGT (SA) TO WS-AGT-NO
 11134           IF WS-AGT-SIX = REIN-COMP (SUB1)
 11135              COMPUTE AGT-COMM =
 11136                 SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11137                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11138           ELSE
 11139              NEXT SENTENCE
 11140        ELSE
 11141           IF CR-AGT-TYPE (SA) = 'R' OR 'D' OR 'U'
 11142              COMPUTE AGT-COMM =
 11143                 SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11144                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11145           ELSE
 11146              IF CR-AGT-TYPE (SA) = 'T' OR 'P' OR 'V' OR 'B'
 11147                 COMPUTE AGT-COMM =
 11148                   SV-FACTOR * (COMM-PREMM * CR-LCOM-L (SA))
 11149                   ADD AGT-COMM TO EX-OVR-COMM (SB).
 11150
 11151     GO TO 5010-COMM-LIFE-LOOP.
 11152
 11153 5020-L-COMM-EXIT.
 11154     EXIT.
 11155
 11156 5030-COMMISSIONS-AH.
 11157     MOVE +0 TO SA.
 11158
 11159 5040-COMM-AH-LOOP.
 11160     ADD +1 TO SA.
 11161
 11162     IF SA GREATER +10
 11163         GO TO 5050-A-COMM-EXIT.
 11164
 11165     IF CR-COM-AGT (SA) = ZEROS OR SPACES
 11166         GO TO 5040-COMM-AH-LOOP.
 11167
 11168     IF FROM-REIN = 'X'
 11169        IF CR-AGT-TYPE (SA) = 'W'
 11170           MOVE CR-COM-AGT (SA) TO WS-AGT-NO
 11171           IF WS-AGT-SIX = REIN-COMP (SUB1)
 11172              COMPUTE AGT-COMM =
 11173                SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11174                ADD AGT-COMM TO EX-AGT-COMM (SB)
 11175           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS158.cbl
 11176              NEXT SENTENCE
 11177        ELSE
 11178           IF CR-AGT-TYPE (SA) = 'R' OR 'D' OR 'U'
 11179              COMPUTE AGT-COMM =
 11180                SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11181                 ADD AGT-COMM TO EX-AGT-COMM (SB)
 11182           ELSE
 11183              IF CR-AGT-TYPE (SA) = 'T' OR 'P' OR 'V' OR 'B'
 11184                 COMPUTE AGT-COMM =
 11185                   SV-FACTOR * (COMM-PREMM * CR-LCOM-AH (SA))
 11186                   ADD AGT-COMM TO EX-OVR-COMM (SB).
 11187
 11188     GO TO 5040-COMM-AH-LOOP.
 11189
 11190 5050-A-COMM-EXIT.
 11191     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS158.cbl
 11193
 11194 6000-CALC-REM-TERM.
 11195
 11196     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
 11197         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 11198
 11199     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11200         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 11201         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 11202                                        DC-ELAPSED-DAYS
 11203         MOVE '3'                    TO DC-OPTION-CODE
 11204         PERFORM 6150-DATE-CONVERSION-ROUTINE
 11205         IF NO-CONVERSION-ERROR
 11206             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 11207         ELSE
 11208             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 11209
 11210     IF CR-LOAN-1ST-PMT-DT = ZEROS
 11211         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 11212         MOVE +1                     TO DC-ELAPSED-MONTHS
 11213         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 11214         MOVE '6'                    TO DC-OPTION-CODE
 11215         PERFORM 6150-DATE-CONVERSION-ROUTINE
 11216         MOVE DC-BIN-DATE-2          TO CP-FIRST-PAY-DATE
 11217         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
 11218
 11219     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 11220     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 11221     MOVE '3'                        TO CP-PROCESS-TYPE.
 11222     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 11223     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 11224     MOVE SPACES                     TO CP-ACCT-FLD-5.
 11225     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
 11226     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 11227
 11228     IF DTE-CLIENT = 'FIM'
 11229         MOVE '5'                    TO CP-REM-TERM-METHOD.
 11230
 11231     IF DTE-CLIENT = 'POS'
 11232        IF CR-CARRIER = '1'
 11233           MOVE '1'                TO CP-REM-TERM-METHOD
 11234        ELSE
 11235           MOVE '2'                TO CP-REM-TERM-METHOD.
 11236
 11237     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 11238
 11239     IF DTE-CLIENT = 'NCL'
 11240         MOVE CP-REMAINING-TERM-1 TO CP-REMAINING-TERM-2.
 11241
 11242     IF FROM-LIFE-SW = 'Y'
 11243        IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
 11244          (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
 11245          MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
 11246          COMPUTE CP-REMAINING-TERM-1 =
 11247                  CP-REMAINING-TERM-1 - +1
 11248          COMPUTE CP-REMAINING-TERM-2 =
 11249                  CP-REMAINING-TERM-2 - +1.
 11250
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS158.cbl
 11251     IF CP-REMAINING-TERM-1 NEGATIVE
 11252         MOVE ZEROS TO CP-REMAINING-TERM-1.
 11253
 11254     IF CP-REMAINING-TERM-2 NEGATIVE
 11255         MOVE ZEROS TO CP-REMAINING-TERM-2.
 11256
 11257     IF NO-CP-ERROR
 11258        MOVE CP-REMAINING-TERM-1        TO REM-TRM1
 11259        MOVE CP-REMAINING-TERM-2        TO REM-TRM2
 11260     ELSE
 11261        MOVE +0                         TO REM-TRM1
 11262                                           REM-TRM2.
 11263
 11264 6010-REM-TERM-EXIT.
 11265     EXIT.
 11266
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS158.cbl
 11268 6100-E-O-J-RTN.
 11269
 11270     OPEN INPUT XTRS-IN.
 11271
 11272 6103-READ-LOSS-XTRS.
 11273
 11274     READ XTRS-IN INTO CALL-EXTRACT
 11275             AT END
 11276                CLOSE XTRS-IN
 11277                GO TO 6107-CLOSE-FILES.
 11278
 11279     PERFORM 1520-RELEASE-SORT-RECORD THRU 1540-RELEASE-EXIT.
 11280
 11281     GO TO 6103-READ-LOSS-XTRS.
 11282
 11283 6107-CLOSE-FILES.
 11284
 11285     MOVE '0'                 TO X.
 11286     MOVE '   ECS158  EXTRACT COMPLETE  ' TO P-DATA.
 11287     PERFORM 1610-PRT-RTN THRU 1620-E-PRT-RTN.
 11288     DISPLAY '  CONTROL TOTALS  '.
 11289     DISPLAY ' LIFE RATE ATTEMPTS....... ' WS-LF-RATE-ATTEMPT.
 11290     DISPLAY ' LIFE RATE ERRORS  ....... ' WS-LF-RATE-ERROR.
 11291     DISPLAY ' AH   RATE ATTEMPTS....... ' WS-AH-RATE-ATTEMPT.
 11292     DISPLAY ' AH   RATE ERRORS  ....... ' WS-AH-RATE-ERROR.
 11293     DISPLAY ' TEXAS ADJ RECS    ....... ' TEXAS-CNT.
 11294     DISPLAY ' '.
 11295
 11296     CLOSE CERTS  PRINTX XTRACT.
 11297     CLOSE ERACCTT.
 11298
 11299     IF REIN-OPEN-SW = 'X'
 11300        CLOSE ERRTBL-IN.
 11301
 11302     CLOSE SORTED-CLAIMS.
 11303
 11304     IF DTE-PGM-OPT = '3' OR '4'
 11305        CLOSE PRINTC.
 11306
 11307     MOVE 'R' TO CP-RATE-FILE.
 11308     MOVE 'C' TO CP-IO-FUNCTION.
 11309     PERFORM 6130-CALL-RATING-ROUTINE THRU 6140-RATE-EXIT.
 11310
 11311     IF IO-ERROR
 11312        MOVE +0303   TO WS-RETURN-CODE
 11313        MOVE ' ERROR ON ERRATE CLOSE' TO WS-ABEND-MESSAGE
 11314        GO TO ABEND-PGM.
 11315
 11316     IF ERACCTT-FILE-STATUS NOT = '00'
 11317        MOVE ' ERROR ON CLOSE  ERACCT ' TO WS-ABEND-MESSAGE
 11318        MOVE ERACCTT-FILE-STATUS TO WS-ABEND-FILE-STATUS
 11319        GO TO ABEND-PGM.
 11320
 11321 6110-CLOSE-FICH.
*11322                             COPY ELCPRTC.
 11323******************************************************************04/15/98
 11324*                                                                *ELCPRTC
 11325*                                                                *ELCPRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS158.cbl (/apps/prod/cid1p/copy/ELCPRTC)
 11326*                            ELCPRTC.                            *   LV003
 11327*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11328*                            VMOD=2.002                          *   CL**2
 11329*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 11330*                                                                *ELCPRTC
 11331* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 11332******************************************************************ELCPRTC
 11333                                                                  ELCPRTC
 11334      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 11335          CLOSE FICH.                                             ELCPRTC
 11336                                                                  ELCPRTC
 11337******************************************************************ELCPRTC
 11338
 11339     MOVE ZEROS  TO RETURN-CODE.
 11340     GOBACK.
 11341
 11342 6120-E-O-J-XIT.
 11343     EXIT.
 11344
 11345 6130-CALL-RATING-ROUTINE.
 11346
 11347     ADD 1 TO WS-RATE-DB-CNT
 11348              WS-TOT-RATE-DB-CNT
 11349     IF WS-RATE-DB-CNT > 10000
 11350        DISPLAY ' RATES ' WS-TOT-RATE-DB-CNT
 11351        MOVE ZEROS TO WS-RATE-DB-CNT
 11352     END-IF
 11353     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 11354
 11355 6140-RATE-EXIT.
 11356     EXIT.
 11357
 11358 6150-DATE-CONVERSION-ROUTINE.
 11359     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 11360
 11361 6200-LOCATE-STATE.
 11362     MOVE SPACES TO SAVE-STATE
 11363                    WS-REPORT-SW.
 11364     MOVE +0     TO EXCL-SUB.
 11365
 11366 6200-LOCATE-STATE-LOOP.
 11367     ADD +1 TO EXCL-SUB.
 11368
 11369     IF EXCL-SUB GREATER THAN CLAS-MAXS
 11370         MOVE TEMP-STATE TO SAVE-STATE
 11371         GO TO 6200-EXIT.
 11372
 11373     IF STATE-SUB (EXCL-SUB) = TEMP-STATE
 11374         MOVE TEMP-STATE TO SAVE-STATE
 11375         MOVE STATE-CALL-BREAK (EXCL-SUB) TO WS-REPORT-SW
 11376         GO TO 6200-EXIT.
 11377
 11378     GO TO 6200-LOCATE-STATE-LOOP.
 11379
 11380 6200-EXIT.
 11381      EXIT.
 11382
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS158.cbl
 11384 6300-LOCATE-BUSC-TYPE.
 11385
 11386     MOVE ZEROS                  TO SAVE-BUSC-TYPE.
 11387     MOVE SPACES                 TO WS-EXCL-BUSC-SW.
 11388
 11389     MOVE +1                     TO CLAS-INDEXB.
 11390
 11391     IF AM-GPCD NOT NUMERIC
 11392         GO TO 6399-EXIT.
 11393
 11394     MOVE AM-GPCD            TO SAVE-BUSC-TYPE.
 11395
 11396 6300-LOCATE-BUSC-LOOP.
 11397
 11398     IF CLAS-INDEXB GREATER THAN CLAS-MAXB
 11399         GO TO 6399-EXIT.
 11400
 11401     IF CLAS-BUSC-CODE (CLAS-INDEXB) NOT = SAVE-BUSC-TYPE
 11402         ADD +1 TO CLAS-INDEXB
 11403         GO TO 6300-LOCATE-BUSC-LOOP.
 11404
 11405     MOVE CLAS-BUSC-EXCL (CLAS-INDEXB) TO WS-EXCL-BUSC-SW.
 11406
 11407 6399-EXIT.
 11408     EXIT.
 11409
 11410 9999-DUM-END.
 11411     MOVE ZEROS  TO RETURN-CODE.
 11412     GOBACK.
 11413
 11414 ABEND-PGM.
*11415                          COPY ELCABEND.
 11416***************************************************************** 04/14/98
 11417*                                                               * ELCABEND
 11418*                            ELCABEND.                          *    LV003
 11419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 11420*                            VMOD 2.002                              CL**2
 11421*                                                               * ELCABEND
 11422*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 11423*            AND THEN ABENDS.                                   * ELCABEND
 11424*                                                               * ELCABEND
 11425*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 11426*                                                               * ELCABEND
 11427***************************************************************** ELCABEND
 11428*APS-010.                                                         ELCABEND
 11429     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 11430     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 11431                                                                  ELCABEND
 11432     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 11433         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11434         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 11435                                 UPON CONSOLE.                    ELCABEND
 11436                                                                  ELCABEND
 11437     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 11438         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11439         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 11440                                 UPON CONSOLE.                    ELCABEND
 11441                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS158.cbl (/apps/prod/cid1p/copy/ELCABEND)
 11442     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11443     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 11444                                 UPON CONSOLE.                    ELCABEND
 11445                                                                  ELCABEND
 11446     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 11447     CALL 'ABORTME'.
 11448                                                                  ELCABEND
 11449 APS-EXIT.                                                        ELCABEND
 11450     EXIT.                                                        ELCABEND
 11451
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  212
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      285120     Code:       59817
