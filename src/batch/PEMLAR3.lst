* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMLAR3.cbl
* Options: int("PEMLAR3.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMLAR3.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMLAR3.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMLAR3.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    PEMLAR3.
     3*AUTHOR.        PABLO.
     4*               COLLEYVILE TEXAS.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT REPORT-EXT           ASSIGN TO SYS011
    10            ORGANIZATION IS LINE SEQUENTIAL.
    11     SELECT ELARCH-IN ASSIGN TO ARCHIN.
    12
    13 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMLAR3.cbl
    14 FILE SECTION.
    15
    16 FD  REPORT-EXT
    17     BLOCK CONTAINS 0 RECORDS
    18     RECORDING MODE IS F.
    19
    20 01  REPORT-RECORD               PIC X(90).
    21
    22 FD  ELARCH-IN
    23     BLOCK CONTAINS 0 RECORDS
    24     RECORDING MODE F.
    25
*   26                                 COPY ELCARCH.
    27******************************************************************04/14/98
    28*                                                                *ELCARCH
    29*                            ELCARCH.                            *   LV003
    30*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    31*                            VMOD=2.007                          *   CL**3
    32*                                                                *ELCARCH
    33*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ELCARCH
    34*                                                                *ELCARCH
    35*   FILE TYPE = VSAM,KSDS                                        *ELCARCH
    36*   RECORD SIZE = 090  RECFORM = FIXED                           *ELCARCH
    37*                                                                *ELCARCH
    38*   BASE CLUSTER = ELARCH                        RKP=2,LEN=8     *ELCARCH
    39*       ALTERNATE PATH1 = ELARCH2 (RECORD TYPE)  RKP=10,LEN=8    *ELCARCH
    40*                                                                *ELCARCH
    41*   LOG = NO                                                     *ELCARCH
    42*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCARCH
    43*                                                                *ELCARCH
    44*  THERE ARE CID MODS IN COPYBOOK ELCARCH                        *ELCARCH
    45******************************************************************ELCARCH
    46 01  LETTER-ARCHIVE.                                              ELCARCH
    47     12  LA-RECORD-ID                PIC XX.                      ELCARCH
    48         88  VALID-LA-ID                VALUE 'LA'.               ELCARCH
    49                                                                  ELCARCH
    50     12  LA-CONTROL-PRIMARY.                                      ELCARCH
    51         16  LA-COMPANY-CD           PIC X.                       ELCARCH
    52         16  LA-ARCHIVE-NO           PIC S9(8)     COMP.          ELCARCH
    53         16  LA-RECORD-TYPE          PIC X.                       ELCARCH
    54             88  LA-HEADER-DATA         VALUE '1'.                ELCARCH
    55             88  LA-ADDRESS-DATA        VALUE '2'.                ELCARCH
    56             88  LA-TEXT-DATA           VALUE '3'.                ELCARCH
    57             88  LA-FORM-CONTROL-HDR    VALUE '4'.                ELCARCH
    58         16  LA-LINE-SEQ-NO          PIC S9(4)     COMP.          ELCARCH
    59                                                                  ELCARCH
    60     12  LA-CONTROL-BY-TYPE.                                      ELCARCH
    61         16  LA-COMPANY-CD-A1        PIC X.                       ELCARCH
    62         16  LA-RECORD-TYPE-A1       PIC X.                       ELCARCH
    63         16  LA-ARCHIVE-NO-A1        PIC S9(8)     COMP.          ELCARCH
    64         16  LA-LINE-SEQ-NO-A1       PIC S9(4)     COMP.          ELCARCH
    65                                                                  ELCARCH
    66     12  LA-TEXT-RECORD.                                          ELCARCH
    67         16  LA-SKIP-CONTROL         PIC XX.                      ELCARCH
    68             88  NO-LINES-SKIPPED       VALUE SPACES.             ELCARCH
    69             88  SKIP-TO-NEXT-PAGE      VALUE '99'.               ELCARCH
    70         16  LA-TEXT-LINE            PIC X(70).                   ELCARCH
    71                                                                  ELCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCARCH)
    72     12  LA-ADDRESS-RECORD  REDEFINES  LA-TEXT-RECORD.            ELCARCH
    73         16  FILLER                  PIC XX.                      ELCARCH
    74         16  LA-ADDRESS-LINE         PIC X(30).                   ELCARCH
    75         16  FILLER                  PIC X(40).                   ELCARCH
    76                                                                  ELCARCH
    77     12  LA-HEADER-RECORD  REDEFINES  LA-TEXT-RECORD.             ELCARCH
    78         16  FILLER                  PIC XX.                      ELCARCH
    79         16  LA-CARRIER              PIC X.                       ELCARCH
    80         16  LA-CLAIM-NO             PIC X(7).                    ELCARCH
    81         16  LA-CERT-NO.                                          ELCARCH
    82             20  LA-CERT-PRIME       PIC X(10).                   ELCARCH
    83             20  LA-CERT-SFX         PIC X.                       ELCARCH
    84         16  LA-NO-OF-COPIES         PIC S9.                      ELCARCH
    85         16  LA-RESEND-DATE          PIC XX.                      ELCARCH
    86         16  LA-PROCESSOR-CD         PIC X(4).                    ELCARCH
    87         16  LA-CREATION-DT          PIC XX.                      ELCARCH
    88         16  LA-INITIAL-PRINT-DATE   PIC XX.                      ELCARCH
    89         16  LA-RESEND-PRINT-DATE    PIC XX.                      ELCARCH
    90         16  LA-CORR-TRLR-SEQ        PIC S9(4)    COMP.           ELCARCH
    91         16  LA-1ST-RESEND-PRINT-DT  PIC XX.                      ELCARCH
    92*                                                                 ELCARCH
    93* -----  16  LA-DMD-ADDITIONAL-FIELDS.                            ELCARCH
    94*   I        20  LA-DMD-LETTER-FORM      PIC X(4).                ELCARCH
    95*   I        20  LA-DMD-PROD-CODE        PIC XX.                  ELCARCH
    96*   I        20  LA-DMD-RES-ST           PIC XX.                  ELCARCH
    97*   I        20  LA-DMD-CORR-TRLR-SEQ    PIC S9(4)    COMP.       ELCARCH
    98*   I        20  LA-DMD-LETTER-STATUS    PIC X.                   ELCARCH
    99*  NEW           88  LA-DMD-LETTER-ONLINE   VALUE '1'.            ELCARCH
   100*  DMD           88  LA-DMD-LETTER-PURGED   VALUE '2'.            ELCARCH
   101*  CHGS          88  LA-DMD-LETTER-RELOADED VALUE '3'.            ELCARCH
   102*   I        20  LA-DMD-LETTER-PURGE-DT  PIC XX.                  ELCARCH
   103*   I        20  LA-DMD-LETTER-RELOAD-DT PIC XX.                  ELCARCH
   104*   I        20  LA-DMD-UND-CODE         PIC XX.                  ELCARCH
   105*   I        20  LA-DMD-BEN-CODE         PIC XX.                  ELCARCH
   106*   V    16  FILLER                  PIC X(15).                   ELCARCH
   107* -----                                                           ELCARCH
   108*                                                                 ELCARCH
   109* REINSERTED  CSO  MODS                                           ELCARCH
   110*                                                                 ELCARCH
   111         16  FILLER.                                              ELCARCH
   112             20  FILLER                  PIC X(29).               ELCARCH
   113             20  LA-CSO-LETTER-STATUS    PIC X.                   ELCARCH
   114                 88  LA-CSO-LETTER-ONLINE   VALUE '1'.            ELCARCH
   115                 88  LA-CSO-LETTER-PURGED   VALUE '2'.            ELCARCH
   116                 88  LA-CSO-LETTER-RELOADED VALUE '3'.            ELCARCH
   117             20  LA-CSO-LETTER-PURGE-DT  PIC XX.                  ELCARCH
   118             20  LA-CSO-LETTER-RELOAD-DT PIC XX.                  ELCARCH
   119*                                                                 ELCARCH
   120                                                                  ELCARCH
   121     12  LA-FORM-CONTROL-HEADER REDEFINES  LA-TEXT-RECORD.        ELCARCH
   122         16  FILLER                  PIC XX.                      ELCARCH
   123         16  LA4-CARRIER             PIC X.                       ELCARCH
   124         16  LA4-CLAIM-NO            PIC X(7).                    ELCARCH
   125         16  LA4-CERT-NO.                                         ELCARCH
   126             20  LA4-CERT-PRIME      PIC X(10).                   ELCARCH
   127             20  LA4-CERT-SFX        PIC X.                       ELCARCH
   128         16  LA4-NO-OF-COPIES        PIC S9.                      ELCARCH
   129         16  LA4-RESEND-DATE         PIC XX.                      ELCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCARCH)
   130         16  LA4-PROCESSOR-CD        PIC X(4).                    ELCARCH
   131         16  LA4-CREATION-DT         PIC XX.                      ELCARCH
   132         16  LA4-INITIAL-PRINT-DATE  PIC XX.                      ELCARCH
   133         16  LA4-RESEND-PRINT-DATE   PIC XX.                      ELCARCH
   134         16  LA4-FORM-TRLR-SEQ       PIC S9(4)    COMP.           ELCARCH
   135         16  LA4-FORM-TYPE           PIC X.                       ELCARCH
   136             88  LA4-INITIAL-FORM    VALUE '1'.                   ELCARCH
   137             88  LA4-PROGRESS-FORM   VALUE '2'.                   ELCARCH
   138         16  LA4-FORM-REM-PRINT-DT   PIC X(02).                   ELCARCH
   139         16  LA4-STATE               PIC X(02).                   ELCARCH
   140         16  FILLER                  PIC X(31).                   ELCARCH
   141******************************************************************ELCARCH
   142
   143 WORKING-STORAGE SECTION.
   144 77  FILLER  PIC X(32) VALUE '********************************'.
   145 77  FILLER  PIC X(32) VALUE '   PEMLAR3   WORKING STORAGE    '.
   146 77  FILLER  PIC X(32) VALUE '*********VMOD=2.001*************'.
   147 77  WS-NOV-PRINT                PIC 9(7) VALUE ZEROS.
   148 77  WS-NOV-REPRINT              PIC 9(7) VALUE ZEROS.
   149 77  WS-DEC-PRINT                PIC 9(7) VALUE ZEROS.
   150 77  WS-DEC-REPRINT              PIC 9(7) VALUE ZEROS.
   151 77  WS-JAN-PRINT                PIC 9(7) VALUE ZEROS.
   152 77  WS-JAN-REPRINT              PIC 9(7) VALUE ZEROS.
   153
   154 01  WS-HEAD-LINE.
   155     05  FILLER                  PIC X(25) VALUE
   156      ' CAR  CLM NO   CERT NO   '.
   157     05  FILLER                  PIC X(35) VALUE
   158      ' NC  RE DT   PROC   CR DT   PRT DT '.
   159     05  FILLER                  PIC X(29) VALUE
   160      '  RES PRT   TRLR ARCH NO  CNT'.
   161
   162
   163 01  WS-DETAIL-LINE.
   164     05  FILLER                  PIC XX   VALUE SPACES.
   165     05  D1-CARRIER              PIC XXX.
   166     05  D1-CLAIM-NO             PIC X(8).
   167     05  D1-CERT-NO              PIC X(12).
   168     05  D1-NOC                  PIC ZZ9.
   169     05  FILLER                  PIC XX.
   170     05  D1-RESEND-DATE          PIC X(9).
   171     05  D1-PROCESSOR-CD         PIC X(5).
   172     05  D1-CREATION-DT          PIC X(9).
   173     05  D1-INITIAL-PRINT-DATE   PIC X(9).
   174     05  D1-RESEND-PRINT-DATE    PIC X(9).
   175     05  D1-CORR-TRLR-SEQ        PIC Z9999.
   176     05  D1-ARCH-NO              PIC Z9999999.
   177     05  D1-ARCH-CNT             PIC ZZ99.
   178
   179 01  WS-FORM-INFO.
   180     05  WS-CARRIER              PIC X.
   181     05  WS-CLAIM-NO             PIC X(7).
   182     05  WS-CERT-NO              PIC X(11).
   183     05  WS-NO-OF-COPIES         PIC S9.
   184     05  WS-RESEND-DATE          PIC XX.
   185     05  WS-PROCESSOR-CD         PIC X(4).
   186     05  WS-CREATION-DT          PIC XX.
   187     05  WS-INITIAL-PRINT-DATE   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMLAR3.cbl
   188     05  WS-RESEND-PRINT-DATE    PIC XX.
   189     05  WS-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   190     05  WS-1ST-RESEND-PRINT-DT  PIC XX.
   191
   192 01  SV-FORM-INFO.
   193     05  SV-CARRIER              PIC X.
   194     05  SV-CLAIM-NO             PIC X(7).
   195     05  SV-CERT-NO              PIC X(11).
   196     05  SV-NO-OF-COPIES         PIC S9.
   197     05  SV-RESEND-DATE          PIC XX.
   198     05  SV-PROCESSOR-CD         PIC X(4).
   199     05  SV-CREATION-DT          PIC XX.
   200     05  SV-INITIAL-PRINT-DATE   PIC XX.
   201     05  SV-RESEND-PRINT-DATE    PIC XX.
   202     05  SV-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   203     05  SV-1ST-RESEND-PRINT-DT  PIC XX.
   204
   205 01  MISC.
   206     12  WS-SPACES               PIC X(5)  VALUE SPACES.
   207     12  QSAM-IN-CNT             PIC 9(11) VALUE ZEROS.
   208     12  WS-ARCH-CNT             PIC S9(5) COMP-3 VALUE +0.
   209     12  REC-1-CNT               PIC 9(9) VALUE ZEROS.
   210     12  REC-2-CNT               PIC 9(9) VALUE ZEROS.
   211     12  REC-3-CNT               PIC 9(9) VALUE ZEROS.
   212     12  REC-4-CNT               PIC 9(9) VALUE ZEROS.
   213     12  REC-O-CNT               PIC 9(9) VALUE ZEROS.
   214     12  WS-DISPLAY-ARCH-CNT     PIC ZZ,Z99 VALUE ZEROS.
   215     12  WS-DISPLAY-ARCH-NO      PIC 9(7) VALUE ZEROS.
   216     12  WS-SAVE-ARCH-NO         PIC S9(8) COMP VALUE +0.
   217     12  WS-ELARCH-SW            PIC X VALUE ' '.
   218         88  END-OF-ELARCH             VALUE 'Y'.
   219
   220     12  WS-RETURN-CODE      PIC X(4)            VALUE ZEROS.     EL545
   221     12  ABEND-OPTION        PIC X               VALUE 'Y'.       EL545
   222     12  WS-ABEND-MESSAGE    PIC X(80)           VALUE SPACES.    EL545
   223     12  WS-ABEND-FILE-STATUS PIC XX             VALUE SPACES.    EL545
   224     12  WS-ZERO             PIC S9              VALUE ZERO.      EL545
   225     12  PGM-SUB             PIC S999    COMP-3  VALUE +545.      EL545
   226
*  227                                 COPY ELCDATE.
   228******************************************************************06/11/98
   229*                                                                *ELCDATE
   230*                                                                *ELCDATE
   231*                            ELCDATE.                            *   LV023
   232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   233*                            VMOD=2.003                           ELCDATE
   234*                                                                *ELCDATE
   235*                                                                *ELCDATE
   236*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   237*                 LENGTH = 200                                   *   CL*19
   238******************************************************************ELCDATE
   239                                                                  ELCDATE
   240 01  DATE-CONVERSION-DATA.                                        ELCDATE
   241     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   242     12  DC-OPTION-CODE                PIC X.                        CL*15
   243         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   244         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   245         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   246         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   247         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   248         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   249         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   250         88  FIND-CENTURY               VALUE '7'.                   CL*22
   251         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   252         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   253         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   254         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   255         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   256         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   257         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   258         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   259         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   260         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   261         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   262         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   263         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   264         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   265         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   266         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   267         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   268         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   269         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   270         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   271         88  THREE-CHARACTER-BIN                                  ELCDATE
   272                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   273         88  GREGORIAN-TO-BIN                                        CL**2
   274                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   275         88  BIN-TO-GREGORIAN                                        CL**2
   276                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   277         88  JULIAN-TO-BINARY                                        CL**2
   278                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   279     12  DC-ERROR-CODE                 PIC X.                        CL*15
   280         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   281         88  DATE-CONVERSION-ERROR                                ELCDATE
   282                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   283         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   284         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   285         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   286         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   287         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   288         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   289         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   290         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   291         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   292         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   293     12  DC-END-OF-MONTH               PIC X.                        CL*15
   294         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   295     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   296         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   297         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   298         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   299     12  FILLER                        PIC X.                        CL*15
   300     12  DC-CONVERSION-DATES.                                        CL*15
   301         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   302         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   303         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   304         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   305                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   306             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   307             20  SLASH1-1              PIC X.                        CL*15
   308             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   309             20  SLASH1-2              PIC X.                        CL*15
   310             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   311         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   312         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   313                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   314             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   315             20  SLASH2-1              PIC X.                        CL*15
   316             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   317             20  SLASH2-2              PIC X.                        CL*15
   318             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   319         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   320         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   321                     DC-GREG-DATE-1-YMD.                          ELCDATE
   322             20  DC-YMD-YEAR           PIC 99.                       CL*15
   323             20  DC-YMD-MONTH          PIC 99.                       CL*15
   324             20  DC-YMD-DAY            PIC 99.                       CL*15
   325         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   326         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   327                      DC-GREG-DATE-1-MDY.                         ELCDATE
   328             20  DC-MDY-MONTH          PIC 99.                       CL*15
   329             20  DC-MDY-DAY            PIC 99.                       CL*15
   330             20  DC-MDY-YEAR           PIC 99.                       CL*15
   331         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   332             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   333             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   334             20  FILLER                PIC XX.                       CL*15
   335             20  DC-ALPHA-CENTURY.                                   CL*15
   336                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   337             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   338         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   339         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   340         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   341         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   342         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   343                                       PIC 9(05).                    CL*20
   344         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   345             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   346             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   347         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   348         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   349         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   350     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   351         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   352         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   353             20  FILLER                PIC 9(3).                     CL*15
   354             20  HOLD-CEN-1-CCYY.                                    CL*15
   355                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   356                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   357             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   358             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   359         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   360             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   361             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   362             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   363                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   364                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   365             20  FILLER                PIC 9(3).                     CL*15
   366         16  HOLD-CENTURY-1-X.                                       CL*15
   367             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   368             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   369                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   370                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   371             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   372             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   373         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   374             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   375             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   376             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   377                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   378                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   379             20  FILLER                PIC XXX.                      CL*23
   380         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   381         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   382         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   383         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   384             20  DC-JULIAN-1-CCYY.                                   CL*15
   385                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   386                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   387             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   388         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   389         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   390             20  DC-JULIAN-2-CCYY.                                   CL*15
   391                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   392                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   393             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   394         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   395             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   396             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   397             20  DC-EDITA-DAY          PIC 99.                       CL*15
   398             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   399             20  DC-EDITA-CCYY.                                      CL*15
   400                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   401                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   402         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   403             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   404             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   405             20  DC-EDITB-DAY          PIC 99.                       CL*15
   406             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   407             20  DC-EDITB-CCYY.                                      CL*15
   408                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   409                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   410         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   411         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   412                              DC-GREG-DATE-CYMD.                  ELCDATE
   413             20  DC-CYMD-CEN           PIC 99.                       CL*15
   414             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   415             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   416             20  DC-CYMD-DAY           PIC 99.                       CL*15
   417         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   418         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   419                              DC-GREG-DATE-MDCY.                  ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCDATE)
   420             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   421             20  DC-MDCY-DAY           PIC 99.                       CL*15
   422             20  DC-MDCY-CEN           PIC 99.                       CL*15
   423             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   424    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   425        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   426    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   427    12  FILLER                         PIC X(28).                    CL*26
   428
   429 PROCEDURE DIVISION.
   430
   431 0000-BEGIN-PROGRAM.
   432
   433     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
   434     PERFORM 0020-INIT           THRU 0020-EXIT
   435
   436     PERFORM 0140-PROCESS        THRU 0140-EXIT UNTIL
   437        (END-OF-ELARCH)
   438*       OR (REC-3-CNT > 1000000)
   439
   440     PERFORM 0200-CLOSE-FILES    THRU 0200-EXIT
   441
   442     DISPLAY ' TOTAL RECORDS READ   ' QSAM-IN-CNT
   443     DISPLAY ' HEADER RECORDS   1   ' REC-1-CNT
   444     DISPLAY ' ADDRESS RECORDS  2   ' REC-2-CNT
   445     DISPLAY ' TEXT RECORDS     3   ' REC-3-CNT
   446     DISPLAY ' FORM CNTRL HDR   4   ' REC-4-CNT
   447     DISPLAY ' ULAR             ?   ' REC-O-CNT
   448
   449     DISPLAY SPACES
   450     DISPLAY ' NOV 08 PRINT         ' WS-NOV-PRINT
   451     DISPLAY ' NOV 08 REPRINTS      ' WS-NOV-REPRINT
   452     DISPLAY ' DEC 08 PRINT         ' WS-DEC-PRINT
   453     DISPLAY ' DEC 08 REPRINTS      ' WS-DEC-REPRINT
   454     DISPLAY ' JAN 09 PRINT         ' WS-JAN-PRINT
   455     DISPLAY ' JAN 09 REPRINTS      ' WS-JAN-REPRINT
   456
   457     GOBACK
   458
   459     .
   460 0010-OPEN-FILES.
   461
   462     OPEN  INPUT ELARCH-IN
   463          OUTPUT REPORT-EXT
   464
   465     .
   466 0010-EXIT.
   467     EXIT.
   468
   469 0020-INIT.
   470
   471     MOVE ZEROS                  TO QSAM-IN-CNT
   472
   473     WRITE REPORT-RECORD         FROM WS-HEAD-LINE
   474
   475     WRITE REPORT-RECORD         FROM WS-SPACES
   476     WRITE REPORT-RECORD         FROM WS-SPACES
   477     PERFORM 0146-READ-ELARCH    THRU 0146-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMLAR3.cbl
   478
   479     .
   480 0020-EXIT.
   481     EXIT.
   482
   483 0140-PROCESS.
   484
   485     IF (LA-RECORD-TYPE = '1')
   486        IF ((LA-INITIAL-PRINT-DATE >= X'A341')
   487           AND (LA-INITIAL-PRINT-DATE < X'A3A1'))
   488                          OR
   489           ((LA-RESEND-PRINT-DATE >= X'A341')
   490           AND (LA-RESEND-PRINT-DATE < X'A3A1'))
   491           PERFORM 0150-PRINT-REPORT
   492                                 THRU 0150-EXIT
   493        END-IF
   494     END-IF
   495
   496     PERFORM 0146-READ-ELARCH    THRU 0146-EXIT
   497
   498     .
   499 0140-EXIT.
   500     EXIT.
   501
   502 0146-READ-ELARCH.
   503
   504     READ ELARCH-IN              AT END
   505        SET END-OF-ELARCH        TO TRUE
   506     END-READ
   507
   508     IF NOT END-OF-ELARCH
   509        ADD 1                    TO QSAM-IN-CNT
   510        EVALUATE LA-RECORD-TYPE
   511           WHEN '1'
   512              ADD 1              TO REC-1-CNT
   513           WHEN '2'
   514              ADD 1              TO REC-2-CNT
   515           WHEN '3'
   516              ADD 1              TO REC-3-CNT
   517           WHEN '4'
   518              ADD 1              TO REC-4-CNT
   519           WHEN OTHER
   520              ADD 1              TO REC-O-CNT
   521        END-EVALUATE
   522     END-IF
   523
   524     .
   525 0146-EXIT.
   526     EXIT.
   527
   528 0150-PRINT-REPORT.
   529
   530     EVALUATE TRUE
   531        WHEN (LA-INITIAL-PRINT-DATE >= X'A341')
   532           AND (LA-INITIAL-PRINT-DATE < X'A361')
   533           ADD 1                 TO WS-NOV-PRINT
   534        WHEN (LA-INITIAL-PRINT-DATE >= X'A361')
   535           AND (LA-INITIAL-PRINT-DATE < X'A381')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMLAR3.cbl
   536           ADD 1                 TO WS-DEC-PRINT
   537        WHEN (LA-INITIAL-PRINT-DATE >= X'A381')
   538           AND (LA-INITIAL-PRINT-DATE < X'A3A1')
   539           ADD 1                 TO WS-JAN-PRINT
   540     END-EVALUATE
   541
   542     EVALUATE TRUE
   543        WHEN (LA-RESEND-PRINT-DATE >= X'A341')
   544           AND (LA-RESEND-PRINT-DATE < X'A361')
   545           ADD 1                 TO WS-NOV-REPRINT
   546        WHEN (LA-RESEND-PRINT-DATE >= X'A361')
   547           AND (LA-RESEND-PRINT-DATE < X'A381')
   548           ADD 1                 TO WS-DEC-REPRINT
   549        WHEN (LA-RESEND-PRINT-DATE >= X'A381')
   550           AND (LA-RESEND-PRINT-DATE < X'A3A1')
   551           ADD 1                 TO WS-JAN-REPRINT
   552     END-EVALUATE
   553
   554     MOVE LA-CORR-TRLR-SEQ       TO D1-CORR-TRLR-SEQ
   555     MOVE LA-CARRIER             TO D1-CARRIER
   556     MOVE LA-CLAIM-NO            TO D1-CLAIM-NO
   557     MOVE LA-CERT-NO             TO D1-CERT-NO
   558     MOVE LA-ARCHIVE-NO          TO D1-ARCH-NO
   559     MOVE WS-ARCH-CNT            TO D1-ARCH-CNT
   560     MOVE LA-NO-OF-COPIES        TO D1-NOC
   561     MOVE LA-PROCESSOR-CD        TO D1-PROCESSOR-CD
   562
   563     IF LA-RESEND-DATE NOT = LOW-VALUES
   564        MOVE LA-RESEND-DATE      TO DC-BIN-DATE-1
   565        PERFORM 8500-DATE-CONVERSION
   566                                 THRU 8590-EXIT
   567        IF NO-CONVERSION-ERROR
   568           MOVE DC-GREG-DATE-1-EDIT
   569                                 TO D1-RESEND-DATE
   570        ELSE
   571           MOVE '00/00/00'       TO D1-RESEND-DATE
   572        END-IF
   573     END-IF
   574
   575     IF LA-CREATION-DT NOT = LOW-VALUES
   576        MOVE LA-CREATION-DT      TO DC-BIN-DATE-1
   577        PERFORM 8500-DATE-CONVERSION
   578                                 THRU 8590-EXIT
   579        IF NO-CONVERSION-ERROR
   580           MOVE DC-GREG-DATE-1-EDIT
   581                                 TO D1-CREATION-DT
   582        ELSE
   583           MOVE '00/00/00'       TO D1-CREATION-DT
   584        END-IF
   585     END-IF
   586
   587     IF LA-INITIAL-PRINT-DATE NOT = LOW-VALUES
   588        MOVE LA-INITIAL-PRINT-DATE
   589                                 TO DC-BIN-DATE-1
   590        PERFORM 8500-DATE-CONVERSION
   591                                 THRU 8590-EXIT
   592        IF NO-CONVERSION-ERROR
   593           MOVE DC-GREG-DATE-1-EDIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMLAR3.cbl
   594                                 TO D1-INITIAL-PRINT-DATE
   595        ELSE
   596           MOVE '00/00/00'       TO D1-INITIAL-PRINT-DATE
   597        END-IF
   598     END-IF
   599
   600     IF LA-RESEND-PRINT-DATE NOT = LOW-VALUES
   601        MOVE LA-RESEND-PRINT-DATE
   602                                 TO DC-BIN-DATE-1
   603        PERFORM 8500-DATE-CONVERSION
   604                                 THRU 8590-EXIT
   605        IF NO-CONVERSION-ERROR
   606           MOVE DC-GREG-DATE-1-EDIT
   607                                 TO D1-RESEND-PRINT-DATE
   608        ELSE
   609           MOVE '00/00/00'       TO D1-RESEND-PRINT-DATE
   610        END-IF
   611     END-IF
   612
   613     WRITE REPORT-RECORD         FROM WS-DETAIL-LINE
   614     WRITE REPORT-RECORD         FROM WS-SPACES
   615
   616     MOVE ZEROS                  TO WS-ARCH-CNT
   617
   618     .
   619 0150-EXIT.
   620     EXIT.
   621
   622 0200-CLOSE-FILES.
   623
   624     CLOSE ELARCH-IN
   625           REPORT-EXT
   626
   627     .
   628 0200-EXIT.
   629     EXIT.
   630
   631 8500-DATE-CONVERSION.
*                            COPY ELCDCS.
   632****************************************************************  04/15/98
   633*                                                              *  ELCDCS
   634*                                                              *  ELCDCS
   635*                            ELCDCS.                           *     LV003
   636*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   637*                            VMOD=2.002                        *     CL**3
   638*                                                              *  ELCDCS
   639*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
   640****************************************************************. ELCDCS
   641                                                                  ELCDCS
   642 8510-DATE-CONVERSION.                                            ELCDCS
   643     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
   644                                                                  ELCDCS
   645 8590-EXIT.                                                       ELCDCS
   646     EXIT.                                                        ELCDCS
   647                                                                  ELCDCS
   648
   649 ABEND-PGM SECTION.
*  650                          COPY ELCABEND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMLAR3.cbl (/apps/prod/cid1p/copy/ELCABEND)
   651***************************************************************** 04/14/98
   652*                                                               * ELCABEND
   653*                            ELCABEND.                          *    LV003
   654*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   655*                            VMOD 2.002                              CL**2
   656*                                                               * ELCABEND
   657*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   658*            AND THEN ABENDS.                                   * ELCABEND
   659*                                                               * ELCABEND
   660*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   661*                                                               * ELCABEND
   662***************************************************************** ELCABEND
   663*APS-010.                                                         ELCABEND
   664     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   665     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   666                                                                  ELCABEND
   667     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   668         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   669         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   670                                 UPON CONSOLE.                    ELCABEND
   671                                                                  ELCABEND
   672     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   673         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   674         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   675                                 UPON CONSOLE.                    ELCABEND
   676                                                                  ELCABEND
   677     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   678     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   679                                 UPON CONSOLE.                    ELCABEND
   680                                                                  ELCABEND
   681     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   682     CALL 'ABORTME'.
   683                                                                  ELCABEND
   684 APS-EXIT.                                                        ELCABEND
   685     EXIT.                                                        ELCABEND
   686
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2356     Code:        1950
