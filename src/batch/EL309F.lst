* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL309F.cbl
* Options: int("EL309F.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL309F.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL309F.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL309F.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. EL309F.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT HISTORY-INPUT-FILE                                    EL309
    10         ASSIGN TO SYS011-UT-2400-S-SYS011.                       EL309
    11                                                                  EL309
    12     SELECT HISTORY-OUTPUT-FILE                                   EL309
    13         ASSIGN TO SYS012-UT-2400-S-SYS012.                       EL309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL309F.cbl
    14                                                                  EL309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL309F.cbl
    16 DATA DIVISION.                                                   EL309
    17                                                                  EL309
    18 FILE SECTION.                                                    EL309
    19                                                                  EL309
    20 FD  HISTORY-INPUT-FILE
*                                      COPY ELCHAF.                     EL309
    21******************************************************************04/15/98
    22*                                                                *ELCHAF
    23*                            ELCHAF.                             *   LV002
    24*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    25*                            VMOD=2.006                          *   CL**2
    26*                                                                *ELCHAF
    27*   FILE DESCRIPTION = HISTORY ARCHIVE FILE                      *ELCHAF
    28*                                                                *ELCHAF
    29******************************************************************ELCHAF
    30                                                                  ELCHAF
    31     LABEL RECORDS STANDARD                                       ELCHAF
    32     BLOCK CONTAINS 0 RECORDS
    33     RECORDING MODE IS V.                                         ELCHAF
    34                                                                  ELCHAF
    35 01  HISTORY-INPUT-RECORD.                                        ELCHAF
    36     05  HIR-COMPANY-ID              PIC XXX.                     ELCHAF
    37     05  HIR-CLAIM-KEY               PIC X(20).                   ELCHAF
    38     05  HIR-DATE-ARCHIVED           PIC XX.                      ELCHAF
    39     05  HIR-PURGED-CLAIM            PIC X.                       ELCHAF
    40       88  RECORD-HAS-BEEN-PURGED                    VALUE 'Y'.   ELCHAF
    41     05  HIR-RECORD-ID               PIC XX.                      ELCHAF
    42*      88  CLAIM-RECORD                              VALUE 'CL'.  ELCHAF
    43*      88  CERTIFICATE-RECORD                        VALUE 'CM'.  ELCHAF
    44*      88  POLICY-RECORD                             VALUE 'PM'.  ELCHAF
    45*      88  ACTIVITY-TRAILER-RECORD                   VALUE 'AT'.  ELCHAF
    46*      88  LETTER-ARCHIVE-RECORD                     VALUE 'LA'.  ELCHAF
    47     05  FILLER                      PIC X(448).                  ELCHAF
    48                                                                  ELCHAF
    49 01  HISTORY-INPUT-CLAIM-RECORD.                                  ELCHAF
    50     05  FILLER                      PIC X(26).                   ELCHAF
    51     05  HIR-CLAIM-RECORD            PIC X(350).                  ELCHAF
    52                                                                  ELCHAF
    53 01  HISTORY-INPUT-CERT-RECORD.                                   ELCHAF
    54     05  FILLER                      PIC X(26).                   ELCHAF
    55     05  HIR-CERTIFICATE-RECORD      PIC X(450).                  ELCHAF
    56                                                                  ELCHAF
    57 01  HISTORY-INPUT-TRAILER-RECORD.                                ELCHAF
    58     05  FILLER                      PIC X(26).                   ELCHAF
    59     05  HIR-ACTIVITY-TRAILER-RECORD PIC X(200).                  ELCHAF
    60                                                                  ELCHAF
    61 01  HISTORY-INPUT-LETTER-RECORD.                                 ELCHAF
    62     05  FILLER                      PIC X(26).                   ELCHAF
    63     05  HIR-LETTER-ARCHIVE-RECORD   PIC X(90).                   ELCHAF
    64                                                                  EL309
    66 FD  HISTORY-OUTPUT-FILE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL309F.cbl
*                                      COPY ELCHAF REPLACING            EL309
*   67     HISTORY-INPUT-RECORD        BY  HISTORY-OUTPUT-RECORD        EL309
*   68     HISTORY-INPUT-CLAIM-RECORD  BY  HISTORY-OUTPUT-CLAIM-RECORD  EL309
*   69     HISTORY-INPUT-CERT-RECORD   BY  HISTORY-OUTPUT-CERT-RECORD   EL309
*   70     HISTORY-INPUT-TRAILER-RECORD BY HISTORY-OUTPUT-TRAILER-RECORDEL309
*   71     HISTORY-INPUT-LETTER-RECORD BY  HISTORY-OUTPUT-LETTER-RECORD EL309
*   72     HIR-COMPANY-ID              BY  HOR-COMPANY-ID               EL309
*   73     HIR-CLAIM-KEY               BY  HOR-CLAIM-KEY                EL309
*   74     HIR-DATE-ARCHIVED           BY  HOR-DATE-ARCHIVED            EL309
*   75     HIR-PURGED-CLAIM            BY  HOR-PURGED-CLAIM             EL309
*   76     HIR-RECORD-ID               BY  HOR-RECORD-ID                EL309
*   77     HIR-CLAIM-RECORD            BY  HOR-CLAIM-RECORD             EL309
*   78     HIR-CERTIFICATE-RECORD      BY  HOR-CERTIFICATE-RECORD       EL309
*   79     HIR-ACTIVITY-TRAILER-RECORD BY  HOR-ACTIVITY-TRAILER-RECORD  EL309
*   80     HIR-LETTER-ARCHIVE-RECORD   BY  HOR-LETTER-ARCHIVE-RECORD.   EL309
    81******************************************************************
    82*                                                                *
    83*                            ELCHAF.                             *
    84*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    85*                            VMOD=2.006                          *
    86*                                                                *
    87*   FILE DESCRIPTION = HISTORY ARCHIVE FILE                      *
    88*                                                                *
    89******************************************************************
    90
    91     LABEL RECORDS STANDARD
    92     BLOCK CONTAINS 0 RECORDS
    93     RECORDING MODE IS V.
    94
    95 01  HISTORY-OUTPUT-RECORD.
    96     05  HOR-COMPANY-ID              PIC XXX.
    97     05  HOR-CLAIM-KEY               PIC X(20).
    98     05  HOR-DATE-ARCHIVED           PIC XX.
    99     05  HOR-PURGED-CLAIM            PIC X.
   100       88  RECORD-HAS-BEEN-PURGED                    VALUE 'Y'.
   101     05  HOR-RECORD-ID               PIC XX.
   102*      88  CLAIM-RECORD                              VALUE 'CL'.
   103*      88  CERTIFICATE-RECORD                        VALUE 'CM'.
   104*      88  POLICY-RECORD                             VALUE 'PM'.
   105*      88  ACTIVITY-TRAILER-RECORD                   VALUE 'AT'.
   106*      88  LETTER-ARCHIVE-RECORD                     VALUE 'LA'.
   107     05  FILLER                      PIC X(448).
   108
   109 01  HISTORY-OUTPUT-CLAIM-RECORD.
   110     05  FILLER                      PIC X(26).
   111     05  HOR-CLAIM-RECORD            PIC X(350).
   112
   113 01  HISTORY-OUTPUT-CERT-RECORD.
   114     05  FILLER                      PIC X(26).
   115     05  HOR-CERTIFICATE-RECORD      PIC X(450).
   116
   117 01  HISTORY-OUTPUT-TRAILER-RECORD.
   118     05  FILLER                      PIC X(26).
   119     05  HOR-ACTIVITY-TRAILER-RECORD PIC X(200).
   120
   121 01  HISTORY-OUTPUT-LETTER-RECORD.
   122     05  FILLER                      PIC X(26).
   123     05  HOR-LETTER-ARCHIVE-RECORD   PIC X(90).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL309F.cbl
   124                                                                  EL309
   125 01  HISTORY-OUTPUT-RECORD2          PIC X(476).                  EL309
   126*01  HISTORY-OUTPUT-RECORD2          PIC X(1226).                 EL309
   127                                                                  EL309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL309F.cbl
   129 WORKING-STORAGE SECTION.                                         EL309
   130 77  FILLER  PIC X(32)   VALUE '********************************'.EL309
   131 77  FILLER  PIC X(32)   VALUE '*     EL309F WORKING STORAGE   *'.EL309
   132 77  FILLER   PIC X(32) VALUE  '******** VMOD=2.001 ************'.EL309
   133                                                                  EL309
   134 01  FILLER                          COMP-3.                      EL309
   135     05  WS-LINE-COUNT               PIC S9(3)   VALUE +99.       EL309
   136     05  WS-LINE-COUNT-MAX           PIC S9(3)   VALUE +60.       EL309
   137     05  WS-PAGE                     PIC S9(5)   VALUE ZERO.      EL309
   138     05  WS-REPORT-SW                PIC S9      VALUE +1.        EL309
   139     05  WS-RECORD-COUNT             PIC S9(9)   VALUE ZERO.      EL309
   140     05  WS-RETURN-CODE              PIC S9(3)   VALUE ZERO.      EL309
   141     05  WS-ZERO                     PIC S9      VALUE ZERO.      EL309
   142     05  WS-BYPASS-SW                PIC S9      VALUE ZERO.      EL309
   143     05  WS-DUP-SW                   PIC S9      VALUE ZERO.      EL309
   144     05  WS-CURRENT-TIME             PIC S9(7)   VALUE ZERO.      EL309
   145                                                                  EL309
   146     05  WS-WORK                     PIC S9(7)   VALUE ZERO.      EL309
   147                                                                  EL309
   148     05  WS-HISTORY-FILE-OPEN        PIC S9      VALUE +0.
   149         88  END-OF-HISTORY-FILE                 VALUE +1.
   150                                                                  EL309
   151     05  WS-HISTORY-INPUT-COUNT      PIC S9(9)   VALUE ZERO.      EL309
   152     05  WS-HISTORY-OUTPUT-COUNT     PIC S9(9)   VALUE ZERO.      EL309
   153                                                                  EL309
   154     05  WS-TOTAL-HISTORY-INPUT      PIC S9(9)   VALUE ZERO.      EL309
   155     05  WS-TOTAL-HISTORY-OUTPUT     PIC S9(9)   VALUE ZERO.      EL309
   156                                                                  EL309
   157     05  WS-CL-HISTORY-INPUT         PIC S9(9)   VALUE ZERO.      EL309
   158     05  WS-CL-HISTORY-OUTPUT        PIC S9(9)   VALUE ZERO.      EL309
   159     05  WS-CM-HISTORY-INPUT         PIC S9(9)   VALUE ZERO.      EL309
   160     05  WS-CM-HISTORY-OUTPUT        PIC S9(9)   VALUE ZERO.      EL309
   161     05  WS-PM-HISTORY-INPUT         PIC S9(9)   VALUE ZERO.      EL309
   162     05  WS-PM-HISTORY-OUTPUT        PIC S9(9)   VALUE ZERO.      EL309
   163     05  WS-AT-HISTORY-INPUT         PIC S9(9)   VALUE ZERO.      EL309
   164     05  WS-AT-HISTORY-OUTPUT        PIC S9(9)   VALUE ZERO.      EL309
   165     05  WS-LA-HISTORY-INPUT         PIC S9(9)   VALUE ZERO.      EL309
   166     05  WS-LA-HISTORY-OUTPUT        PIC S9(9)   VALUE ZERO.      EL309
   167     05  WS-OTHER-HISTORY-INPUT      PIC S9(9)   VALUE ZERO.      EL309
   168     05  WS-OTHER-HISTORY-OUTPUT     PIC S9(9)   VALUE ZERO.      EL309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL309F.cbl
   170 01  FILLER   COMP   SYNC.                                        EL309
   171     05  PGM-SUB                     PIC S9(4)   VALUE +309.      EL309
   172     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.      EL309
   173     05  WS-LENGTH                   REDEFINES                    EL309
   174         WS-INDEX                    PIC S9(4).                   EL309
   175     05  MAX-TABLE-INDX              PIC S9(4)   VALUE +100.      EL309
   176                                                                  EL309
   177 01  FILLER.                                                      EL309
   178     05  WS-LETTER-MESSAGE.                                       EL309
   179         10  FILLER              PIC X(25)  VALUE                 EL309
   180                  'ARCHIVE LETTER NOT FOUND '.                    EL309
   181         10  WS-NUMBER-DISPLAY   PIC ZZZZZZZ9  VALUE ZEROS.       EL309
   182         10  FILLER              PIC X(27)  VALUE SPACES.         EL309
   183                                                                  EL309
   184                                                                  EL309
   185     05  WS-DISPLAY-TIME             PIC 99B99B99.                EL309
   186                                                                  EL309
   187     05  WS-ACCEPT-TIME.                                          EL309
   188         10  WS-ACCEPT-HHMMSS        PIC 9(06)   VALUE ZEROS.     EL309
   189         10  FILLER                  PIC 9(02)   VALUE ZEROS.     EL309
   190                                                                  EL309
   191     05  X                           PIC X.                       EL309
   192     05  ABEND-CODE                  PIC X(4).                    EL309
   193     05  ABEND-OPTION                PIC X.                       EL309
   194     05  OLC-REPORT-NAME             PIC X(8) VALUE 'EL- 309'.    EL309
   195                                                                  EL309
   196     05  WS-SAVE-PRINT-RECORD        PIC X(133)  VALUE SPACES.    EL309
   197                                                                  EL309
   198                                                                  EL309
   199     05  WS-ABEND-MESSAGE            PIC X(80)   VALUE SPACES.    EL309
   200                                                                  EL309
   201     05  WS-ABEND-FILE-STATUS        PIC XX      VALUE ZERO.      EL309
   202                                                                  EL309
   203                                                                  EL309
   204     05  WS-CURRENT-DATE             PIC XX  VALUE LOW-VALUES.    EL309
   205     05  WS-RUN-DATE                 PIC XX  VALUE LOW-VALUES.    EL309
   206                                                                  EL309
   207     05  WS-COMPANY-ID.                                           EL309
   208         10 WS-FIRST-TWO             PIC X(2).                    EL309
   209         10 WS-COMPANY-INCREMENT     PIC X.                       EL309
   210     05  WS-COMPANY-CD               PIC X.                       EL309
   211                                                                  EL309
   212                                                                  EL309
   213     05  WS-COMPANY-NAME.                                         EL309
   214         10  WS-CN-CHAR              PIC X                        EL309
   215             OCCURS 30 TIMES         INDEXED BY CN1.              EL309
   216                                                                  EL309
   217                                                                  EL309
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL309F.cbl
   219
*  220                                 COPY ELCDATE.                    EL309
   221******************************************************************06/11/98
   222*                                                                *ELCDATE
   223*                                                                *ELCDATE
   224*                            ELCDATE.                            *   LV023
   225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   226*                            VMOD=2.003                           ELCDATE
   227*                                                                *ELCDATE
   228*                                                                *ELCDATE
   229*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   230*                 LENGTH = 200                                   *   CL*19
   231******************************************************************ELCDATE
   232                                                                  ELCDATE
   233 01  DATE-CONVERSION-DATA.                                        ELCDATE
   234     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   235     12  DC-OPTION-CODE                PIC X.                        CL*15
   236         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   237         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   238         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   239         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   240         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   241         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   242         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   243         88  FIND-CENTURY               VALUE '7'.                   CL*22
   244         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   245         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   246         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   247         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   248         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   249         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   250         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   251         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   252         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   253         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   254         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   255         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   256         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   257         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   258         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   259         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   260         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   261         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   262         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   263         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   264         88  THREE-CHARACTER-BIN                                  ELCDATE
   265                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   266         88  GREGORIAN-TO-BIN                                        CL**2
   267                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   268         88  BIN-TO-GREGORIAN                                        CL**2
   269                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   270         88  JULIAN-TO-BINARY                                        CL**2
   271                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   272     12  DC-ERROR-CODE                 PIC X.                        CL*15
   273         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   274         88  DATE-CONVERSION-ERROR                                ELCDATE
   275                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   276         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL309F.cbl (/apps/prod/cid1p/copy/ELCDATE)
   277         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   278         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   279         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   280         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   281         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   282         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   283         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   284         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   285         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   286     12  DC-END-OF-MONTH               PIC X.                        CL*15
   287         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   288     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   289         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   290         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   291         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   292     12  FILLER                        PIC X.                        CL*15
   293     12  DC-CONVERSION-DATES.                                        CL*15
   294         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   295         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   296         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   297         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   298                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   299             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   300             20  SLASH1-1              PIC X.                        CL*15
   301             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   302             20  SLASH1-2              PIC X.                        CL*15
   303             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   304         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   305         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   306                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   307             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   308             20  SLASH2-1              PIC X.                        CL*15
   309             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   310             20  SLASH2-2              PIC X.                        CL*15
   311             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   312         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   313         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   314                     DC-GREG-DATE-1-YMD.                          ELCDATE
   315             20  DC-YMD-YEAR           PIC 99.                       CL*15
   316             20  DC-YMD-MONTH          PIC 99.                       CL*15
   317             20  DC-YMD-DAY            PIC 99.                       CL*15
   318         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   319         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   320                      DC-GREG-DATE-1-MDY.                         ELCDATE
   321             20  DC-MDY-MONTH          PIC 99.                       CL*15
   322             20  DC-MDY-DAY            PIC 99.                       CL*15
   323             20  DC-MDY-YEAR           PIC 99.                       CL*15
   324         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   325             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   326             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   327             20  FILLER                PIC XX.                       CL*15
   328             20  DC-ALPHA-CENTURY.                                   CL*15
   329                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   330             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   331         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   332         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   333         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   334         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL309F.cbl (/apps/prod/cid1p/copy/ELCDATE)
   335         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   336                                       PIC 9(05).                    CL*20
   337         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   338             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   339             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   340         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   341         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   342         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   343     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   344         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   345         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   346             20  FILLER                PIC 9(3).                     CL*15
   347             20  HOLD-CEN-1-CCYY.                                    CL*15
   348                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   349                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   350             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   351             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   352         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   353             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   354             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   355             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   356                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   357                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   358             20  FILLER                PIC 9(3).                     CL*15
   359         16  HOLD-CENTURY-1-X.                                       CL*15
   360             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   361             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   362                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   363                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   364             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   365             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   366         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   367             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   368             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   369             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   370                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   371                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   372             20  FILLER                PIC XXX.                      CL*23
   373         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   374         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   375         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   376         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   377             20  DC-JULIAN-1-CCYY.                                   CL*15
   378                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   379                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   380             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   381         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   382         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   383             20  DC-JULIAN-2-CCYY.                                   CL*15
   384                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   385                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   386             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   387         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   388             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   389             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   390             20  DC-EDITA-DAY          PIC 99.                       CL*15
   391             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   392             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL309F.cbl (/apps/prod/cid1p/copy/ELCDATE)
   393                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   394                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   395         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   396             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   397             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   398             20  DC-EDITB-DAY          PIC 99.                       CL*15
   399             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   400             20  DC-EDITB-CCYY.                                      CL*15
   401                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   402                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   403         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   404         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   405                              DC-GREG-DATE-CYMD.                  ELCDATE
   406             20  DC-CYMD-CEN           PIC 99.                       CL*15
   407             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   408             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   409             20  DC-CYMD-DAY           PIC 99.                       CL*15
   410         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   411         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   412                              DC-GREG-DATE-MDCY.                  ELCDATE
   413             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   414             20  DC-MDCY-DAY           PIC 99.                       CL*15
   415             20  DC-MDCY-CEN           PIC 99.                       CL*15
   416             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   417    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   418        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   419    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   420    12  FILLER                         PIC X(28).                    CL*26
   421
   422 PROCEDURE DIVISION.                                              EL309
   423
   424 0000-MAIN-LOGIC SECTION.                                         EL309
   425
   426     PERFORM 0005-OPEN-FILES     THRU 0005-EXIT
   427     PERFORM 0010-INIT           THRU 0010-EXIT
   428
   429     PERFORM 0020-PROCESS-HISTORY-FILE
   430                                 THRU 0020-EXIT UNTIL
   431        END-OF-HISTORY-FILE
   432
   433     PERFORM 0050-CLOSE-FILES    THRU 0050-EXIT
   434
   435     DISPLAY ' HIST  IN ' WS-TOTAL-HISTORY-INPUT
   436     DISPLAY ' AT    IN ' WS-AT-HISTORY-INPUT
   437     DISPLAY ' LA    IN ' WS-LA-HISTORY-INPUT
   438     DISPLAY ' CM    IN ' WS-CM-HISTORY-INPUT
   439     DISPLAY ' PM    IN ' WS-PM-HISTORY-INPUT
   440     DISPLAY ' CL    IN ' WS-CL-HISTORY-INPUT
   441     DISPLAY ' OTHER IN ' WS-OTHER-HISTORY-INPUT
   442
   443     DISPLAY ' HIST  OT ' WS-TOTAL-HISTORY-OUTPUT
   444     DISPLAY ' AT    OT ' WS-AT-HISTORY-OUTPUT
   445     DISPLAY ' LA    OT ' WS-LA-HISTORY-OUTPUT
   446     DISPLAY ' CM    OT ' WS-CM-HISTORY-OUTPUT
   447     DISPLAY ' PM    OT ' WS-PM-HISTORY-OUTPUT
   448     DISPLAY ' CL    OT ' WS-CL-HISTORY-OUTPUT
   449     DISPLAY ' OTHER OT ' WS-OTHER-HISTORY-OUTPUT
   450
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL309F.cbl
   451
   452
   453     GOBACK
   454
   455     .
   456 0005-OPEN-FILES.
   457
   458     OPEN INPUT HISTORY-INPUT-FILE
   459     OPEN OUTPUT HISTORY-OUTPUT-FILE
   460
   461     .
   462 0005-EXIT.
   463     EXIT.
   464
   465 0010-INIT.
   466
   467     MOVE 'DCC'                  TO  WS-COMPANY-NAME
   468                                     WS-COMPANY-ID
   469
   470     MOVE X'05'                  TO  WS-COMPANY-CD
   471
   472     ACCEPT WS-ACCEPT-TIME       FROM TIME
   473     MOVE WS-ACCEPT-HHMMSS       TO WS-DISPLAY-TIME
   474     INSPECT WS-DISPLAY-TIME CONVERTING SPACES TO '.'
   475
   476     DISPLAY 'EL309-BEGIN PROCESSING ' WS-COMPANY-NAME ' AT '
   477             WS-DISPLAY-TIME UPON CONSOLE
   478
   479     ACCEPT DC-GREG-DATE-1-YMD   FROM DATE
   480     MOVE '3'                    TO DC-OPTION-CODE
   481     PERFORM 8500-DATE-CONVERSION
   482                                 THRU 8590-EXIT
   483     MOVE DC-BIN-DATE-1          TO WS-CURRENT-DATE
   484                                    WS-RUN-DATE
   485*    MOVE DC-GREG-DATE-1-ALPHA   TO WS-H3-DATE
   486
   487     ACCEPT WS-CURRENT-TIME      FROM TIME
   488
   489     MOVE +99                    TO WS-LINE-COUNT
   490
   491     PERFORM 0030-READ-INPUT     THRU 0030-EXIT
   492
   493     .
   494 0010-EXIT.
   495     EXIT.
   496
   497
   498
   499 0020-PROCESS-HISTORY-FILE.
   500
   501     IF HIR-COMPANY-ID = 'CID'
   502        PERFORM 0040-WRITE-HIST  THRU 0040-EXIT
   503     ELSE
   504        DISPLAY ' DROPPING RECORD ' HIR-COMPANY-ID '  '
   505           HIR-RECORD-ID '  ' HIR-CLAIM-KEY (2:19)
   506     END-IF
   507
   508     PERFORM 0030-READ-INPUT     THRU 0030-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL309F.cbl
   509
   510     .
   511 0020-EXIT.
   512     EXIT.
   513
   514 0030-READ-INPUT.
   515
   516     READ HISTORY-INPUT-FILE AT END
   517        SET END-OF-HISTORY-FILE TO TRUE
   518     END-READ
   519
   520     IF NOT END-OF-HISTORY-FILE
   521        ADD +1                   TO WS-TOTAL-HISTORY-INPUT
   522        EVALUATE HIR-RECORD-ID
   523           WHEN 'AT'
   524              ADD +1             TO WS-AT-HISTORY-INPUT
   525           WHEN 'LA'
   526              ADD +1             TO WS-LA-HISTORY-INPUT
   527           WHEN 'CM'
   528              ADD +1             TO WS-CM-HISTORY-INPUT
   529           WHEN 'PM'
   530              ADD +1             TO WS-PM-HISTORY-INPUT
   531           WHEN 'CL'
   532              ADD +1             TO WS-CL-HISTORY-INPUT
   533           WHEN OTHER
   534              ADD +1             TO WS-OTHER-HISTORY-INPUT
   535        END-EVALUATE
   536     END-IF
   537
   538     .
   539 0030-EXIT.
   540     EXIT.
   541
   542 0040-WRITE-HIST.
   543
   544     ADD +1                   TO WS-TOTAL-HISTORY-OUTPUT
   545
   546     EVALUATE HIR-RECORD-ID
   547        WHEN 'AT'
   548           MOVE HISTORY-INPUT-TRAILER-RECORD
   549                              TO HISTORY-OUTPUT-TRAILER-RECORD
   550           WRITE HISTORY-OUTPUT-TRAILER-RECORD
   551           ADD +1             TO WS-AT-HISTORY-OUTPUT
   552        WHEN 'LA'
   553           MOVE HISTORY-INPUT-LETTER-RECORD
   554                              TO HISTORY-OUTPUT-LETTER-RECORD
   555           WRITE HISTORY-OUTPUT-LETTER-RECORD
   556           ADD +1             TO WS-LA-HISTORY-OUTPUT
   557        WHEN 'CM'
   558           MOVE HISTORY-INPUT-CERT-RECORD
   559                              TO HISTORY-OUTPUT-CERT-RECORD
   560           WRITE HISTORY-OUTPUT-CERT-RECORD
   561           ADD +1             TO WS-CM-HISTORY-OUTPUT
   562        WHEN 'PM'
   563           ADD +1             TO WS-PM-HISTORY-OUTPUT
   564        WHEN 'CL'
   565           MOVE HISTORY-INPUT-CLAIM-RECORD
   566                              TO HISTORY-OUTPUT-CLAIM-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL309F.cbl
   567           WRITE HISTORY-OUTPUT-CLAIM-RECORD
   568           ADD +1             TO WS-CL-HISTORY-OUTPUT
   569        WHEN OTHER
   570           ADD +1             TO WS-OTHER-HISTORY-OUTPUT
   571     END-EVALUATE
   572
   573     .
   574 0040-EXIT.
   575     EXIT.
   576
   577 0050-CLOSE-FILES.
   578
   579     CLOSE HISTORY-INPUT-FILE
   580           HISTORY-OUTPUT-FILE
   581
   582    .
   583 0050-EXIT.
   584     EXIT.
   585
   586 8500-DATE-CONVERSION.
*                                      COPY ELCDCS.
   587****************************************************************  04/15/98
   588*                                                              *  ELCDCS
   589*                                                              *  ELCDCS
   590*                            ELCDCS.                           *     LV003
   591*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   592*                            VMOD=2.002                        *     CL**3
   593*                                                              *  ELCDCS
   594*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
   595****************************************************************. ELCDCS
   596                                                                  ELCDCS
   597 8510-DATE-CONVERSION.                                            ELCDCS
   598     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
   599                                                                  ELCDCS
   600 8590-EXIT.                                                       ELCDCS
   601     EXIT.                                                        ELCDCS
   602                                                                  ELCDCS
   603
   604 ABEND-PGM SECTION.
*                                      COPY ELCABEND SUPPRESS.          EL309
   640                                                                  EL309
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3120     Code:        2064
