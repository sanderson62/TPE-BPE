* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL547.cbl
* Options: int("EL547.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL547.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL547.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL547.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EL547.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
     8*    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
     9*    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
    10*    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
    11*    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
    12*    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
    13*    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
    14*    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL547.cbl
    15*    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
    16*    MUST ALSO BE MADE IN THIS PROGRAM.
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT CERTS        ASSIGN TO
    23*       '/data/seqfiles/ZI.XX.CERT.PEMA'.
    24        SYS010.
    25     SELECT EXTRACT      ASSIGN TO
    26*       '/data/seqfiles/ZI.XX.EXTR547'
    27        SYS011
    28        ORGANIZATION IS LINE SEQUENTIAL.
    29     SELECT CLMS-HIST    ASSIGN TO
    30*       '/data/seqfiles/ZI.XX.CLMS.A15860'.
    31        SYS013.
    32     SELECT DISK-DATE    ASSIGN TO
    33*       '/data/seqfiles/ZI.DD.ER.DATECARD.EL547'.
    34        SYS019.
    35     SELECT PRINTX       ASSIGN TO
    36*       '/data/seqfiles/sys008'.
    37        SYS008.
    38
    39 DATA DIVISION.
    40 FILE SECTION.
    41
    42 FD  CLMS-HIST
*   43                                 COPY ECSEXTFD.
    44******************************************************************07/10/97
    45*                                                                *ECSEXTFD
    46*                            ECSEXTFD                            *   LV001
    47*                            VMOD=2.001                          *ECSEXTFD
    48*                                                                *ECSEXTFD
    49*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
    50*                                                                *ECSEXTFD
    51******************************************************************ECSEXTFD
    52     RECORDING MODE F                                             ECSEXTFD
    53     LABEL RECORDS STANDARD                                       ECSEXTFD
    54     BLOCK CONTAINS 0 RECORDS
    55     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
    56******************************************************************ECSEXTFD
*   57                                 COPY ECSEXT01.
    58******************************************************************04/29/98
    59*                                                                *ECSEXT01
    60*                            ECSEXT01                            *   LV015
    61*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    62*                            VMOD=2.015                          *ECSEXT01
    63*                                                                *ECSEXT01
    64*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    65*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    66*                                                                *ECSEXT01
    67*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    68*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    69*                                                                *ECSEXT01
    70*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    71*                                                                *ECSEXT01
    72******************************************************************ECSEXT01
    73******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
    74*                   C H A N G E   L O G
    75*
    76* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    77*-----------------------------------------------------------------
    78*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    79* EFFECTIVE    NUMBER
    80*-----------------------------------------------------------------
    81* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    82* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    83* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    84* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    85* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    86* 032612  CR2011110200001  PEMA  AHL CHANGES
    87******************************************************************
    88                                                                  ECSEXT01
    89 01  DETAIL-EXTRACT.                                              ECSEXT01
    90     02 DETAIL-FILE.                                              ECSEXT01
    91     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
    92         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
    93                                                                  ECSEXT01
    94     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
    95                                                                  ECSEXT01
    96     12  DE-REIN                           PIC X.                 ECSEXT01
    97                                                                  ECSEXT01
    98     12  DE-CONTROL.                                              ECSEXT01
    99         16  DE-CNTRL1.                                           ECSEXT01
   100             20  DE-CARRIER                PIC X.                 ECSEXT01
   101             20  DE-GROUPING.                                     ECSEXT01
   102                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   103                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   104             20  DE-STATE                  PIC XX.                ECSEXT01
   105             20  DE-ACCOUNT.                                      ECSEXT01
   106                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
   107                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   108         16  DE-CNTRL2.                                           ECSEXT01
   109             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   110             20  DE-CERT.                                         ECSEXT01
   111                 24 DE-CERT-NO.                                   ECSEXT01
   112                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   113                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   114                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   115                                                                  ECSEXT01
   116     12  DE-TRANS                          PIC X.                 ECSEXT01
   117         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   118         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   119         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   120         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   121         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   122         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   123         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   124         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   125         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   126         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   127                                                                  ECSEXT01
   128     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   129     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   130                                                                  ECSEXT01
   131     12  DE-NAME.                                                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   132         16  DE-LNAME                      PIC X(15).             ECSEXT01
   133         16  DE-FNAME.                                            ECSEXT01
   134             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   135             20  FILLER                    PIC X(9).              ECSEXT01
   136         16  DE-INIT                       PIC X.                 ECSEXT01
   137     12  DE-AGE                            PIC 99.                ECSEXT01
   138     12  DE-SEX                            PIC X.                 ECSEXT01
   139     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   140                                                                  ECSEXT01
   141     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   142     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   143     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   144     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   145     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   146     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   147     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   148     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   149     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   150                                                                  ECSEXT01
   151     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   152     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   153     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   154     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   155                                                                  ECSEXT01
   156     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   157     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   158     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   159     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   160     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   161                                                                  ECSEXT01
   162     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   163     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   164     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   165     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   166                                                                  ECSEXT01
   167     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   168     12  DE-ADDL-CLP REDEFINES DE-LIVES
   169                                           PIC S9(5)V99   COMP-3.
   170     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   171     12  FILLER REDEFINES DE-NUM-BILLED.
   172         16  DE-CLP-STATE                  PIC XX.
   173         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   174     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   175     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   176                                                                  ECSEXT01
   177     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   178     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   179     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   180     12  DE-IG                             PIC X.                 ECSEXT01
   181     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   182*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   183     12  DE-MEMBER-NO.                                            ECSEXT01
   184         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   185         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   186         16  FILLER                        PIC X(03).             ECSEXT01
   187     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   188                                                                  ECSEXT01
   189     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   190         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   191                                                                  ECSEXT01
   192     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   193     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   194                                                                  ECSEXT01
   195     12  DE-REI-AREA.                                             ECSEXT01
   196         16  DE-REI-COMP.                                         ECSEXT01
   197             20  DE-REINCO                 PIC XXX.               ECSEXT01
   198             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   199         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   200         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   201         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   202         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   203         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   204         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   205         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   206                                                                  ECSEXT01
   207     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   208     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   209         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   210         16  F                             PIC X.
   211*    12  FILLER                            PIC X(5).              ECSEXT01
   212                                                                  ECSEXT01
   213     12  DE-BILLED-AREA.                                          ECSEXT01
   214         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   215             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   216                                                                  ECSEXT01
   217         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   218             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   219             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   220             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   221             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   222             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
   223             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   224                                                                  ECSEXT01
   225         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   226             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   227                                                                  ECSEXT01
   228         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   229         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   230         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   231         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   232                                                                  ECSEXT01
   233         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   234*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   235*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   236                                                                  ECSEXT01
   237     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   238         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   239         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   240         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   241                                                                  ECSEXT01
   242     12  DE-REVERSE-REASONS.                                      ECSEXT01
   243         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   244         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   245     12  DE-CANCEL-REASON                  PIC X.
   246                                                                  ECSEXT01
   247     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   248     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   249                                                                  ECSEXT01
   250     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   251         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   252             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   253         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   254             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   255                                                                  ECSEXT01
   256     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   257         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   258                                                                  ECSEXT01
   259     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   260     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   261         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   262         16  FILLER                        PIC X.
   263                                                                  ECSEXT01
   264****************************************************************  ECSEXT01
   265**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   266****************************************************************  ECSEXT01
   267     12  DE-COMM-LEVELS.                                          ECSEXT01
   268         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   269             20  DE-AGT.                                          ECSEXT01
   270                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   271                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   272             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   273             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   274             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   275                                                                  ECSEXT01
   276     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   277****************************************************************  ECSEXT01
   278*******                 CLAIM EXTRACT                      *****  ECSEXT01
   279****************************************************************  ECSEXT01
   280     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
   281     12  FILLER                            PIC X(334).            ECSEXT01
   282     12  DE-TYPE                           PIC X.                 ECSEXT01
   283         88  DE-DTH                           VALUE '1'.          ECSEXT01
   284         88  DE-AH                            VALUE '2'.          ECSEXT01
   285         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   286         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   287         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   288         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   289                                                                  ECSEXT01
   290     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   291     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   292                                                                  ECSEXT01
   293     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   294     12  DE-REPORTED.                                             ECSEXT01
   295         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   296         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   297         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   298     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   299     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-CNUM                           PIC X(7).              ECSEXT01
   302     12  DE-CHECK                          PIC X(7).              ECSEXT01
   303     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   304     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   305     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   306     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   307         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   308         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   309         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   310         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   311         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   312         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   313         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   314                                                                  ECSEXT01
   315     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   316                                                                  ECSEXT01
   317     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   318     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   319     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   320     12  FILLER                            PIC XX.                ECSEXT01
   321     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   322                                                                  ECSEXT01
   323     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   324     12  DE-BENEFICIARY                    PIC X(10).
   325     12  filler redefines de-beneficiary.
   326         16  de-birth-date                 pic 9(11)  comp-3.
   327         16  f                             pic x(4).
   328     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   329     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   330     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   331     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   332     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   333     12  DE-CLM-CLASS                      PIC XX.
   334     12  DE-CLM-DEV                        PIC XXX.
   335     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   336     12  de-xycor-cert-seq                 pic x(3).
   337     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   338     12  DE-XYCOR-ACTION-CD                PIC XXX.
   339     12  DE-XYCOR-STATUS                   PIC X.
   340     12  FILLER                            PIC X(4).              ECSEXT01
   341                                                                  ECSEXT01
   342     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   343                                                                  ECSEXT01
   344****************************************************************  ECSEXT01
   345*******               RESERVE EXTRACT                      *****  ECSEXT01
   346****************************************************************  ECSEXT01
   347     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   348     12  FILLER                            PIC X(334).            ECSEXT01
   349                                                                  ECSEXT01
   350     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   351         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   352         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   353                                                                  ECSEXT01
   354     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   355     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   356     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   357                                                                  ECSEXT01
   358     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   359                                                                  ECSEXT01
   360     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   361     12  DE-RSV-REPORTED.                                         ECSEXT01
   362         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   363         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL547.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   364         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   365     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   366                                                                  ECSEXT01
   367     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   368     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   369     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   370                                                                  ECSEXT01
   371     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   372     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   373     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   374                                                                  ECSEXT01
   375     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   376                                                                  ECSEXT01
   377     12  DE-RATE-CLASS                     PIC XX.
   378     12  DE-DEV-CODE                       PIC XXX.
   379     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   380     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   381     12  FILLER                            PIC X(58).             ECSEXT01
   382                                                                  ECSEXT01
   383     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   384******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL547.cbl
   385/
   386
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL547.cbl
   388 FD  CERTS
*  389                                 COPY ECSCRIFD.
   390******************************************************************07/10/97
   391*                                                                *ECSCRIFD
   392*                            ECSCRIFD                            *   LV001
   393*                            VMOD 2.005                          *ECSCRIFD
   394*                                                                *ECSCRIFD
   395*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   396*                                                                *ECSCRIFD
   397******************************************************************ECSCRIFD
   398     BLOCK CONTAINS 0 RECORDS
   399     RECORDING MODE F.                                            ECSCRIFD
   400                                                                  ECSCRIFD
   401 01  CERT-IN-RECORD.                                              ECSCRIFD
   402                                                                  ECSCRIFD
   403     12  FILLER                            PIC XXX.               ECSCRIFD
   404     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   405     12  FILLER                            PIC X(66).             ECSCRIFD
   406     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   407     12  FILLER                            PIC X(20).             ECSCRIFD
   408     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   409     12  FILLER                            PIC X(14).             ECSCRIFD
   410     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   411     12  FILLER                            PIC X(39).             ECSCRIFD
   412     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   413     12  FILLER                            PIC X(45).             ECSCRIFD
   414     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   415     12  FILLER                            PIC X(35).             ECSCRIFD
   416     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   417     12  FILLER                            PIC X(41).             ECSCRIFD
   418     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   419     12  FILLER                            PIC X(48).             ECSCRIFD
   420     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   421     12  FILLER                            PIC X(9).              ECSCRIFD
   422     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   423     12  FILLER                            PIC X(120).            ECSCRIFD
   424     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   425     12  FILLER                            PIC X(73).             ECSCRIFD
   426     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   427     12  FILLER                            PIC X(464).            ECSCRIFD
   428                                                                  ECSCRIFD
   429******************************************************************ECSCRIFD
*  430                                 COPY ECSCRT01.
   431******************************************************************
   432*                                                                *
   433*                            ECSCRT01                            *
   434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   435*                            VMOD=2.016                          *
   436*                                                                *
   437*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   438*                                                                *
   439*   FILE TYPE = SEQUENTIAL
   440*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   441*                                                                *
   442*   KEY DATA =                         START=4, LEN=36           *
   443*                                                                *
   444*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   445*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   446******************************************************************
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   456* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   457* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   458* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   459* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   460* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   462* 032612  CR2011110200001  PEMA  AHL CHANGES
   463* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   464* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   465******************************************************************
   466
   467 01  CERTIFICATE-RECORD.
   468     12  CR-RECORD-ID                      PIC XX.
   469         88  VALID-CR-ID                      VALUE 'CR'.
   470
   471     12  CR-COMPANY-CD                     PIC X.
   472
   473     12  CR-FULL-CONTROL.
   474         16  CR-CONTROL-1.
   475             20  CR-ACCT-CONTROL.
   476                 24  CR-CARRIER            PIC X.
   477                 24  CR-GROUPING.
   478                     28  CR-GROUP-PREFIX   PIC XXX.
   479                     28  CR-GROUP-PRIME    PIC XXX.
   480                 24  CR-STATE              PIC XX.
   481                 24  CR-ACCOUNT.
   482                     28  CR-ACCT-PREFIX    PIC X(4).
   483                     28  CR-ACCT-PRIME     PIC X(6).
   484             20  CR-DT                     PIC 9(11)  COMP-3.
   485         16  CR-CERT-NO.
   486             20  CR-CERT.
   487                 24  CR-CERT-PREFIX        PIC X(3).
   488                 24  CR-CERT-PRIME         PIC X(7).
   489             20  CR-CERT-SFX               PIC X.
   490
   491     12  CR-INSUREDS-PROFILE.
   492         16  CR-NAME.
   493             20  CR-LNAME                  PIC X(15).
   494             20  CR-FNAME.
   495                 24  CR-1ST-INITIAL        PIC X.
   496                 24  FILLER                PIC X(9).
   497             20  CR-INIT                   PIC X.
   498         16  CR-AGE                        PIC 99.
   499         16  CR-SEX                        PIC X.
   500             88  CR-SEX-MALE                  VALUE 'M'.
   501             88  CR-SEX-FEMALE                VALUE 'F'.
   502         16  CR-SOC-SEC                    PIC X(11).
   503         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   504             20  CR-JT-LNAME               PIC X(15).
   505             20  CR-JT-FNAME.
   506                 24  CR-JT-1ST-INIT        PIC X.
   507                 24  FILLER                PIC X(9).
   508             20  CR-JT-INIT                PIC X.
   509         16  CR-JOINT-AGE                  PIC 99.
   510
   511         16  cr-ahl-ah-claim-no            pic x(9).
   512         16  cr-ahl-ah-cert-seq            pic x(3).
   513         16  cr-hst-proc-lf                pic x.
   514         16  f                             pic x(7).
   515
   516     12  CR-LF-COVERAGE-DATA.
   517         16  CR-LFTYP                      PIC XX.
   518         16  CR-LF-TERM                    PIC S999       COMP-3.
   519         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   520         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   521         16  CR-LF-DEV-CODE                PIC XXX.
   522         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   523
   524         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   525         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   526         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   527         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   528
   529         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   530         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   531         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   532         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   533
   534         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   535         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   536
   537         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   538         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   539
   540         16  CR-LF-REFUND-TYPE             PIC X.
   541         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   542
   543         16  CR-LF-COMM-CHARGEBACK         PIC X.
   544             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   545
   546         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   547
   548         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   549         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   550         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   551
   552         16  cr-ahl-lf-claim-no            pic x(9).
   553         16  cr-ahl-lf-cert-seq            pic x(3).
   554         16  FILLER                        PIC XX.
   555
   556     12  CR-AH-COVERAGE-DATA.
   557         16  CR-AHTYP                      PIC XX.
   558         16  CR-AH-TERM                    PIC S999       COMP-3.
   559         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   560         16  CR-AH-DEV-CODE                PIC XXX.
   561         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   562
   563         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   564         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   565         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   566         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   567
   568         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   569         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   570
   571         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   572         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   573
   574         16  CR-AH-REFUND-TYPE             PIC X.
   575         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   576
   577         16  CR-AH-COMM-CHARGEBACK         PIC X.
   578             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   579
   580         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   581
   582         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   583         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   584         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   585
   586         16  FILLER                        PIC XX.
   587*        16  FILLER                        PIC X(8).
   588
   589     12  CR-LOAN-DATA.
   590         16  CR-LIVES                      PIC S9(7)      COMP-3.
   591         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   592                                           PIC S9(5)V99   COMP-3.
   593         16  CR-BILLED                     PIC S9(7)      COMP-3.
   594         16  CR-APR                        PIC S999V9(4)  COMP-3.
   595         16  CR-PMT-FREQ                   PIC 99.
   596         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   597         16  CR-RATING-CLASS               PIC XX.
   598         16  CR-POLICY-FORM-NO             PIC X(12).
   599         16  CR-GRPTYP                     PIC XX.
   600         16  CR-IND-GRP                    PIC X.
   601             88  CR-INDIVIDUAL                VALUE '1'.
   602             88  CR-GROUP                     VALUE '2'.
   603         16  CR-SKIP                       PIC 99.
   604             88  NO-MONTHS-SKIPPED            VALUE 00.
   605             88  SKIP-JULY                    VALUE 01.
   606             88  SKIP-AUGUST                  VALUE 02.
   607             88  SKIP-SEPTEMBER               VALUE 03.
   608             88  SKIP-JULY-AUG                VALUE 04.
   609             88  SKIP-AUG-SEPT                VALUE 05.
   610             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   611             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   612             88  SKIP-JUNE                    VALUE 08.
   613             88  SKIP-JUNE-JULY               VALUE 09.
   614             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   615             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   616         16  CR-RESIDENT-STATE             PIC XX.
   617         16  CR-RATE-CODE.
   618             20  CR-LF-CLASS-CD            PIC XX.
   619             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   620         16  CR-MORT.
   621             20  CR-TAB                    PIC X.
   622             20  CR-INT                    PIC 99.
   623             20  CR-GRP                    PIC X.
   624         16  CR-MEMBER-NO                  PIC X(12).
   625         16  CR-OLD-LOF                    PIC XXX.
   626*        16  CR-LOAN-OFFICER               PIC XXX.
   627         16  CR-REIN-TABLE                 PIC XXX.
   628         16  CR-REIN-SPEC                  PIC X.
   629         16  CR-LOAN-1ST-PMT-DT.
   630             20  CR-1ST-PMT-YR             PIC 99.
   631             20  CR-1ST-PMT-MO             PIC 99.
   632             20  CR-1ST-PMT-DA             PIC 99.
   633         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   634         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   635         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   636         16  CR-LAST-ADD-ON-DT             PIC XX.
   637
   638         16  CR-UNDERWRITING-CODE          PIC X.
   639             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   640
   641         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   642         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   643         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   644         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   645
   646     12  CR-STATUS-INFORMATION.
   647         16  CR-ENTRY-STATUS               PIC X.
   648             88  CR-NORMAL-ENTRY              VALUE '1'.
   649             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   650             88  CR-CONVERSION-ENTRY          VALUE '4'.
   651             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   652             88  CR-POLICY-IS-CASH            VALUE 'C'.
   653             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   654             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   655             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   656             88  CR-POLICY-IS-VOID            VALUE 'V'.
   657             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   658             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   659                                                'C' '5' '9' 'P'.
   660         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   661
   662         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   663         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   664         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   665
   666         16  CR-LF-STATUS-AT-DEATH         PIC X.
   667         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   668
   669         16  CR-LF-CURRENT-STATUS          PIC X.
   670             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   671             88  CR-LF-POLICY-PENDING         VALUE '2'.
   672             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   673             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   674             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   675             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   676             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   677             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   678             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   679             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   680             88  CR-LF-IS-DECLINED            VALUE 'D'.
   681             88  CR-LF-IS-VOID                VALUE 'V'.
   682             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   683                                                    '4' '5' '9'.
   684
   685         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   686
   687         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   688         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   689
   690         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   691         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   692
   693         16  CR-AH-CURRENT-STATUS          PIC X.
   694             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   695             88  CR-AH-POLICY-PENDING         VALUE '2'.
   696             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   697             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   698             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   699             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   700             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   701             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   702             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   703             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   704             88  CR-AH-IS-DECLINED            VALUE 'D'.
   705             88  CR-AH-IS-VOID                VALUE 'V'.
   706             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   707                                                    '4' '5' '9'.
   708         16  CR-LOAN-OFFICER               PIC X(5).
   709         16  CR-CANCEL-REASON              PIC X.
   710         16  cr-xycor-lf-cov-code          pic x(4).
   711         16  cr-xycor-ah-cov-code          pic x(4).
   712         16  cr-temp-epiq                  pic x(4).
   713         16  FILLER                        PIC XX.
   714
   715     12  CR-DEATH-CLAIM-DATA.
   716         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   717
   718         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   719         16  CR-DTH-RPT-DT.
   720             20  CR-DTH-RPT-YR             PIC 99.
   721             20  CR-DTH-RPT-MO             PIC 99.
   722             20  CR-DTH-RPT-DA             PIC 99.
   723         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   724
   725         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   726         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   727         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   728         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   729         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   730
   731         16  CR-DTH-AGE                    PIC 99.
   732         16  CR-DTH-PAY-CD                 PIC X.
   733         16  CR-DEATH-CAUSE                PIC X(6).
   734
   735         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   736
   737     12  CR-DISAB-CLAIM-DATA.
   738         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   739
   740         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   741         16  CR-DIS-RPT-DT.
   742             20  CR-DIS-RPT-YR             PIC 99.
   743             20  CR-DIS-RPT-MO             PIC 99.
   744             20  CR-DIS-RPT-DA             PIC 99.
   745         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   746         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   747
   748         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   749         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   750         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   751         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   752         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   753
   754         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   755         16  CR-DIS-PAY-CD                 PIC X.
   756         16  FILLER                        PIC XX.
   757
   758         16  CR-DISAB-INCURRED-DETAIL.
   759             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   760**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   761                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   762                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   763                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   764
   765         16  CR-DISAB-CAUSE                PIC X(6).
   766         16  FILLER                        PIC X(14).
   767
   768     12  CR-REMIT-TO                       PIC 99.
   769
   770     12  CR-COMPENSATION-LEVELS.
   771         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   772             20  CR-COM-AGT.
   773                 24  CR-COM-AGT-PREFIX     PIC X(4).
   774                 24  CR-COM-AGT-PRIME      PIC X(6).
   775             20  CR-AGT-TYPE               PIC X.
   776             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   777             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   778
   779     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   780     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   781     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   782     12  CR-CLP-STATE                      PIC XX.
   783     12  CR-POST-CARD-IND                  PIC X.
   784     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   785     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   786     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   787     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   788     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   789     12  FILLER                            PIC X(07).
   790
   791     12  CR-CSR-CODE                       PIC XXX.
   792
   793     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL547.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   794     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   795
   796     12  CR-MICROFILM-NUMBERS.
   797*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   798         16  FILLER                        PIC X(5).
   799     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   800
   801     12  CR-USER-CODE                      PIC X.
   802     12  CR-USER-FUTURE                    PIC X(9).
   803
   804     12  CR-BENEFICIARY.
   805         16  CR-BANK-NO                    PIC X(10).
   806         16  FILLER                        PIC X(15).
   807
   808     12  CR-ENTRY-BATCH                    PIC X(6).
   809     12  CR-LF-EXIT-BATCH                  PIC X(6).
   810     12  CR-AH-EXIT-BATCH                  PIC X(6).
   811
   812     12  CR-NOTE-SW                        PIC X.
   813
   814     12  CR-ORIGIN-INDICATOR               PIC X.
   815         88  CR-ENTERED-MANUALLY              VALUE '1'.
   816         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   817
   818     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   819     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   820     12  FILLER                            PIC X(33).
   821
   822******************************************************************
   823
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL547.cbl
   825 FD  EXTRACT
   826     BLOCK CONTAINS 0 RECORDS
   827     RECORDING MODE IS F.
   828
   829 01  EXTRACT-RECORD.
   830     05  EXT-ISSUE-CCYYMM        PIC 9(6).
   831     05  EXT-VALUE-CCYYMM        PIC 9(6).
   832     05  EXT-LF-INFORCE          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.
   833     05  EXT-LF-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   834     05  EXT-AH-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   835     05  EXT-LF-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   836     05  EXT-AH-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   837     05  EXT-LF-R78              PIC ZZZ,ZZZ,ZZ9.99.
   838     05  EXT-LF-PRO              PIC ZZZ,ZZZ,ZZ9.99.
   839     05  EXT-LF-ST               PIC ZZZ,ZZZ,ZZ9.99.
   840     05  EXT-AH-R78              PIC ZZZ,ZZZ,ZZ9.99.
   841     05  EXT-AH-PRO              PIC ZZZ,ZZZ,ZZ9.99.
   842     05  EXT-AH-ST               PIC ZZZ,ZZZ,ZZ9.99.
   843     05  EXT-LF-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
   844     05  EXT-AH-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
   845
   846
   847 FD  DISK-DATE
*  848                                 COPY ELCDTEFD.
   849******************************************************************04/15/98
   850*                                                                *ELCDTEFD
   851*                                                                *ELCDTEFD
   852*                            ELCDTEFD.                           *   LV002
   853*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   854*                            VMOD=2.007                          *   CL**2
   855*                                                                *ELCDTEFD
   856******************************************************************ELCDTEFD
   857     BLOCK CONTAINS 0 RECORDS
   858     RECORDING MODE F.                                            ELCDTEFD
   859                                                                  ELCDTEFD
   860 01  DATE-DISK.                                                   ELCDTEFD
   861     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   862     12  FILLER                      PIC  X(14).                  ELCDTEFD
   863     12  DD-CR1                      PIC  9.                      ELCDTEFD
   864     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   865     12  DD-CR2                      PIC  9.                      ELCDTEFD
   866     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   867     12  FILLER                      PIC  X(20).                  ELCDTEFD
   868                                                                  ELCDTEFD
   869 01  DATE-DISK-R.                                                 ELCDTEFD
   870     12  FILLER                      PIC  X(4).                   ELCDTEFD
   871     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   872                                     PIC  X(32).                  ELCDTEFD
   873                                                                  ELCDTEFD
   874 01  DATE-DISK-T.                                                 ELCDTEFD
   875     12  FILLER                      PIC  X(4).                   ELCDTEFD
   876     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   877                                     PIC  X(48).                  ELCDTEFD
   878                                                                  ELCDTEFD
   879 01  DATE-DISK-M.                                                 ELCDTEFD
   880     12  FILLER                      PIC  X(4).                   ELCDTEFD
   881     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   882                                     PIC  X(48).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   883                                                                  ELCDTEFD
   884 01  DATE-DISK-P.                                                 ELCDTEFD
   885     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   886     12  DD-IDX                      PIC  99.                     ELCDTEFD
   887     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   888     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   889         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   890                                     PIC  X.                      ELCDTEFD
   891         16  FILLER                  PIC  X(46).                  ELCDTEFD
   892     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   893         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   894             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   895             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   896             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   897             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   898         16  FILLER                  PIC  X(16).                  ELCDTEFD
   899                                                                  ELCDTEFD
   900 01  DATE-DISK-E.                                                 ELCDTEFD
   901     12  FILLER                      PIC  X(4).                   ELCDTEFD
   902     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   903                                     PIC  X(4).                   ELCDTEFD
   904                                                                  ELCDTEFD
   905 01  DATE-DISK-C.                                                 ELCDTEFD
   906     12  FILLER                      PIC  X(7).                   ELCDTEFD
   907     12  DD-CARR1-SECPAY-SW          PIC  X.
   908     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   909     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   910     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   911     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   912     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   913     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   914     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   915     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   916     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   917     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   918     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   919     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   920     12  DD-CARR2-SECPAY-SW          PIC  X.
   921     12  FILLER                      PIC  X(7).                   ELCDTEFD
   922                                                                  ELCDTEFD
   923 01  DATE-DISK-OPT.                                               ELCDTEFD
   924     12  FILLER                      PIC  X(04).                  ELCDTEFD
   925     12  DD-TLR-DATA.                                             ELCDTEFD
   926         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   927                                     PIC  X(03).                  ELCDTEFD
   928     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   929         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   930                                     PIC  X(06).                  ELCDTEFD
   931     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   932         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   933                                     PIC  X(07).                  ELCDTEFD
   934         16  FILLER                  PIC  X(05).                  ELCDTEFD
   935     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   936                                     PIC  X(96).                  ELCDTEFD
   937******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL547.cbl
   939 FD  PRINTX
*  940                                 COPY ELCPRTFD.
   941******************************************************************04/15/98
   942*                                                                *ELCPRTFD
   943*                                                                *ELCPRTFD
   944*                            ELCPRTFD.                           *   LV003
   945*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   946*                            VMOD=2.006                          *ELCPRTFD
   947******************************************************************ELCPRTFD
   948     RECORDING MODE F                                             ELCPRTFD
   949     LABEL RECORDS OMITTED                                        ELCPRTFD
   950     BLOCK CONTAINS 0 RECORDS
   951     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   952 01  PRT.                                                         ELCPRTFD
   953     12  P-CTL               PIC  X.                                 CL**2
   954     12  P-DATA              PIC  X(132).                         ELCPRTFD
   955******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL547.cbl
   957 WORKING-STORAGE SECTION.
   958 77  FILLER  PIC X(32) VALUE '********************************'.
   959 77  FILLER  PIC X(32) VALUE '      EL547   WORKING STORAGE   '.
   960 77  FILLER  PIC X(32) VALUE '********************************'.
   961
   962 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   963     88  THERE-ARE-NO-MORE-RECORDS  VALUE 'Y'.
   964     88  THERE-ARE-MORE-RECORDS     VALUE 'N'.
   965 77  IYR                         PIC S999   COMP-3 VALUE +0.
   966 77  VYR                         PIC S999   COMP-3 VALUE +0.
   967 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   968 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   969 77  X                           PIC X      VALUE ' '.
   970 77  WS-CRT-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   971 77  WS-CLM-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   972 77  WS-CRT-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   973 77  WS-CLM-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   974 77  INTERMED                    PIC S9(9)V9(6)  COMP-3.
   975 77  WS-REM-AMT                  PIC S9(11)V99 COMP-3 VALUE +0.
   976 77  LF-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   977 77  AH-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   978 77  LF-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   979 77  AH-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   980 77  REM-TRM1                    PIC S9(3)V99    COMP-3.
   981 77  REM-TRM2                    PIC S9(3)V99    COMP-3.
   982
   983 01  WS-ISSUE-YR-TABLE.
   984     05  WS-ISSUE         OCCURS 600.
   985         10  WS-ISSUE-CCYYMM     PIC 9(6).
   986         10  FILLER              PIC XX.
   987         10  WS-VALUATION OCCURS 600.
   988           12  WS-RECORD.
   989             15  WS-VALUATION-CCYYMM PIC 9(6).
   990             15  WS-LF-INFORCE   PIC S9(12)V99 COMP-3.
   991             15  WS-LF-WRITTEN   PIC S9(9)V99 COMP-3.
   992             15  WS-AH-WRITTEN   PIC S9(9)V99 COMP-3.
   993             15  WS-LF-REFUNDS   PIC S9(9)V99 COMP-3.
   994             15  WS-AH-REFUNDS   PIC S9(9)V99 COMP-3.
   995             15  WS-LF-R78       PIC S9(9)V99 COMP-3.
   996             15  WS-LF-PRO       PIC S9(9)V99 COMP-3.
   997             15  WS-LF-ST        PIC S9(9)V99 COMP-3.
   998             15  WS-AH-R78       PIC S9(9)V99 COMP-3.
   999             15  WS-AH-PRO       PIC S9(9)V99 COMP-3.
  1000             15  WS-AH-ST        PIC S9(9)V99 COMP-3.
  1001             15  WS-LF-CLAIM     PIC S9(9)V99 COMP-3.
  1002             15  WS-AH-CLAIM     PIC S9(9)V99 COMP-3.
  1003
  1004 01  FILLER                  PIC X(400)  VALUE LOW-VALUES.
  1005
  1006 01  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1007 01  WS-DISPLAY-TERM         PIC Z99.
  1008 01  WS-DISPLAY-RTERM        PIC Z99.99.
  1009 01  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1010 01  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1011 01  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1012 01  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1013 01  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1014 01  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL547.cbl
  1015 01  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1016 01  FILLER.
  1017     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1018     05  FILLER REDEFINES WS-END-YEAR.
  1019         10  FILLER              PIC 999.
  1020         10  WS-CCYYMM           PIC 9(6).
  1021         10  FILLER REDEFINES WS-CCYYMM.
  1022             15  WS-CCYY         PIC 9999.
  1023             15  WS-MM           PIC 99.
  1024         10  WS-DD               PIC 99.
  1025 01  WS-DEBUG-AREA.
  1026     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1027         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1028         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1029         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1030         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1031         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1032
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL547.cbl
  1034
  1035 01  TEXAS-REGS-WORK-AREAS.
  1036     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1037     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1038     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1039     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1040     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1041     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1042     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1043     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1044     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1045
  1046*01  NET-PAY-INTERFACE.
  1047*    05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1048*    05  NP-ORIG                 PIC S9(3)         COMP-3.
  1049*    05  NP-REM                  PIC S9(3)         COMP-3.
  1050*    05  NP-OPT                  PIC X(01).
  1051*    05  NP-CAP                  PIC S9(3)         COMP-3.
  1052*    05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1053*    05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1054*    05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1055
  1056 01  WS-ABEND-AREA.
  1057     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1058     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1059     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1060     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1061
  1062 01  WORK-ABEND-CODE.
  1063     12  WAC-1                   PIC X.
  1064     12  WAC-2                   PIC X.
  1065     12  WAC-3-4.
  1066         16  WAC-3               PIC X.
  1067         16  WAC-4               PIC X.
  1068
  1069 01  FILLER.
  1070     05  WS-WORK-DATE            PIC 9(11).
  1071     05  FILLER REDEFINES WS-WORK-DATE.
  1072         10  FILLER              PIC XXX.
  1073         10  WS-WORK-CCYYMM      PIC 9(6).
  1074         10  FILLER REDEFINES WS-WORK-CCYYMM.
  1075             15  WS-WORK-CCYY    PIC 9999.
  1076             15  WS-WORK-MM      PIC 99.
  1077         10  WS-WORK-DD          PIC 99.
  1078 01  FILLER.
  1079     05  WS-EFFECT-DATE          PIC 9(11).
  1080     05  FILLER REDEFINES WS-EFFECT-DATE.
  1081         10  FILLER              PIC 999.
  1082         10  WS-EFFECT-CCYYMM     PIC 9(6).
  1083         10  WS-EFFECT-DD        PIC 99.
  1084 01  FILLER.
  1085     05  WS-CANCEL-DATE          PIC 9(11).
  1086     05  FILLER REDEFINES WS-CANCEL-DATE.
  1087         10  FILLER              PIC 999.
  1088         10  WS-CANCEL-CCYYMM    PIC 9(6).
  1089         10  WS-CANCEL-DD        PIC 99.
  1090 01  FILLER.
  1091     05  WS-CLAIM-DATE           PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL547.cbl
  1092     05  FILLER REDEFINES WS-CLAIM-DATE.
  1093         10  FILLER              PIC 999.
  1094         10  WS-CLAIM-CCYYMM     PIC 9(6).
  1095         10  WS-CLAIM-DD         PIC 99.
  1096 01  FILLER.
  1097     05  WS-HI-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1098     05  WS-LO-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1099 01  FILLER.
  1100     05  WS-HI-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1101     05  WS-LO-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1102     05  FILLER REDEFINES WS-LO-VALUATION-CCYYMM.
  1103         10  WS-LO-VAL-CCYY      PIC 9999.
  1104         10  WS-LO-VAL-MM        PIC 99.
  1105 01  FILLER.
  1106     05  WS-BIN-VAL-DATES OCCURS 600
  1107                                 PIC XX.
  1108
  1109 01  ABEND-FIELDS.
  1110     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
  1111     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1112         88  FIRST-TIME                 VALUE 'Y'.
  1113
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL547.cbl
* 1115                                 COPY ELCCALC.
  1116******************************************************************04/15/98
  1117*                                                                *ELCCALC
  1118*                           ELCCALC.                            *    LV003
  1119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1120*                            VMOD=2.025                          *   CL**3
  1121*                                                                *   CL**2
  1122*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1123*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1124*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1125*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1126*                                                                *   CL**2
  1127*  PASSED TO ELRTRM                                              *   CL**2
  1128*  -----------------                                             *   CL**2
  1129*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1130*  ORIGINAL TERM                                                 *   CL**2
  1131*  BEGINNING DATE                                                *   CL**2
  1132*  ENDING DATE                                                   *   CL**2
  1133*  COMPANY I.D.                                                  *   CL**2
  1134*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1135*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1136*  FREE LOOK DAYS                                                *   CL**2
  1137*                                                                *   CL**2
  1138*  RETURNED FROM ELRTRM                                          *   CL**2
  1139*  ---------------------                                         *   CL**2
  1140*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1141*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1142*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1143*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1144*----------------------------------------------------------------*   CL**2
  1145*  PASSED TO ELRAMT                                              *   CL**2
  1146*  ----------------                                              *   CL**2
  1147*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1148*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1149*  ORIGINAL AMOUNT                                               *   CL**2
  1150*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1151*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1152*  METHOD                                                            CL**2
  1153*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1154*  COMPANY I.D.                                                  *   CL**2
  1155*  BENEFIT TYPE                                                  *   CL**2
  1156*                                                                *   CL**2
  1157*  RETURNED FROM ELRAMT                                          *   CL**2
  1158*  --------------------                                          *   CL**2
  1159*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1160*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1161*  REMAINING AMOUNT FACTOR                                           CL**2
  1162*----------------------------------------------------------------*   CL**2
  1163*  PASSED TO ELRESV                                              *   CL**2
  1164*  -----------------                                             *   CL**2
  1165*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1166*  VALUATION DATE                                                *   CL**2
  1167*  PAID THRU DATE                                                *   CL**2
  1168*  BENEFIT                                                       *   CL**2
  1169*  INCURRED DATE                                                 *   CL**2
  1170*  REPORTED DATE                                                 *   CL**2
  1171*  ISSUE AGE                                                     *   CL**2
  1172*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1173*  CDT PERCENT                                                   *   CL**2
  1174*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1175* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1176* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1177* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1178*                                                                *   CL**2
  1179*  RETURNED FROM ELRESV                                          *   CL**2
  1180*  --------------------                                          *   CL**2
  1181*  CDT TABLE USED                                                *   CL**2
  1182*  CDT FACTOR USED                                               *   CL**2
  1183*  PAY TO CURRENT RESERVE                                        *   CL**2
  1184*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1185*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1186*----------------------------------------------------------------*   CL**2
  1187*  PASSED TO ELRATE                                              *   CL**2
  1188*  ----------------                                              *   CL**2
  1189*  CERT ISSUE DATE                                               *   CL**2
  1190*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1191*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1192*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1193*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1194*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1195*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1196*  DEVIATION CODE                                                *   CL**2
  1197*  ISSUE AGE                                                     *   CL**2
  1198*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1199*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1200*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1201*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1202*  A.P.R.                                                        *   CL**2
  1203*  METHOD                                                            CL**2
  1204*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1205*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1206*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1207*  BENEFIT CODE                                                  *   CL**2
  1208*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1209*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1210*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1211*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1212*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1213*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1214*                                                                *   CL**2
  1215*  RETURNED FROM ELRATE                                          *   CL**2
  1216*  --------------------                                          *   CL**2
  1217*  CALCULATED PREMIUM                                            *   CL**2
  1218*  PREMIUM RATE                                                  *   CL**2
  1219*  MORTALITY CODE                                                *   CL**2
  1220*  MAX ATTAINED AGE                                              *   CL**2
  1221*  MAX AGE                                                       *   CL**2
  1222*  MAX TERM                                                      *   CL**2
  1223*  MAX MONTHLY BENEFIT                                           *   CL**2
  1224*  MAX TOTAL BENIFIT                                             *   CL**2
  1225*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1226*----------------------------------------------------------------*   CL**2
  1227*  PASSED TO ELRFND                                              *   CL**2
  1228*  ----------------                                              *   CL**2
  1229*  CERT ISSUE DATE                                               *   CL**2
  1230*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1231*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1232*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1233*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1234*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1235*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1236*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1237*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1238*  DEVIATION CODE                                                *   CL**2
  1239*  ISSUE AGE                                                     *   CL**2
  1240*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1241*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1242*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1243*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1244*  A.P.R.                                                        *   CL**2
  1245*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1246*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1247*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1248*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1249*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1250*  BENEFIT CODE                                                  *   CL**2
  1251*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1252*                                                                *   CL**2
  1253*  RETURNED FROM ELRFND                                          *   CL**2
  1254*  --------------------                                          *   CL**2
  1255*  CALCULATED REFUND                                             *   CL**2
  1256*----------------------------------------------------------------*   CL**2
  1257*  PASSED TO ELEARN                                              *   CL**2
  1258*  ----------------                                              *   CL**2
  1259*  CERT ISSUE DATE                                               *   CL**2
  1260*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1261*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1262*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1263*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1264*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1265*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1266*  DEVIATION CODE                                                *   CL**2
  1267*  ISSUE AGE                                                     *   CL**2
  1268*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1269*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1270*  A.P.R.                                                        *   CL**2
  1271*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1272*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1273*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1274*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1275*  BENEFIT CODE                                                  *   CL**2
  1276*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1277*                                                                *   CL**2
  1278*  RETURNED FROM ELEARN                                          *   CL**2
  1279*  --------------------                                          *   CL**2
  1280*  INDICATED  EARNINGS                                           *   CL**2
  1281*----------------------------------------------------------------*   CL**2
  1282*                 LENGTH = 450                                   *   CL**2
  1283*                                                                *   CL**2
  1284******************************************************************   CL**2
  1285******************************************************************
  1286*                   C H A N G E   L O G
  1287*
  1288* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1289*-----------------------------------------------------------------
  1290*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1291* EFFECTIVE    NUMBER
  1292*-----------------------------------------------------------------
  1293* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1294* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1295* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1296* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1297* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1298* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1299* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1300* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1301* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1302* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1303******************************************************************
  1304                                                                     CL**2
  1305 01  CALCULATION-PASS-AREA.                                          CL**2
  1306     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1307                                     COMP.                           CL**2
  1308                                                                     CL**2
  1309     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1310       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1311       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1312                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1313       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1314       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1315       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1316       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1317       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1318       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1319       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1320       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1321       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1322       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1323       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1324       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1325       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1326       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1327       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1328       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1329       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1330                                                                     CL**2
  1331     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1332       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1333***********************  INPUT AREAS ****************************    CL**2
  1334                                                                     CL**2
  1335     12  CP-CALCULATION-AREA.                                        CL**2
  1336         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1337         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1338         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1339         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1340         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1341           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1342                                                   'I' 'U'.          CL**2
  1343           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1344           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1345         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1346         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1347         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1348         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1349         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1350                                     COMP-3.                         CL**2
  1351         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1352                                     COMP-3.                         CL**2
  1353         16  CP-CDT-METHOD         PIC X.                            CL**2
  1354           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1355           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1356           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1357         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1358           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1359           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1360         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1361                                     COMP-3.                         CL**2
  1362         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1363                                     COMP-3.                         CL**2
  1364         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1365                                     COMP-3.                         CL**2
  1366         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1367                                     COMP-3.                         CL**2
  1368         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1369                                     COMP-3.                         CL**2
  1370         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1371                                     COMP-3.                         CL**2
  1372         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1373                                     COMP-3.                         CL**2
  1374         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1375           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1376           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1377           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1378           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1379           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1380           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1381           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1382         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1383           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1384           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1385           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1386           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1387           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1388           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1389           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1390           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1391           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1392           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1393           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1394           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1395           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1396           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1397         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1398           88  CP-CLAIM                            VALUE '1'.        CL**2
  1399           88  CP-CANCEL                           VALUE '2'.        CL**2
  1400           88  CP-ISSUE                            VALUE '3'.        CL**2
  1401         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1402           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1403           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1404           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1405           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1406           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1407           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1408           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1409           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1410           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1411           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1412           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1413           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1414           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1415           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1416           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1417           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1418           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1419           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1420                                                     'W' 'X'.        CL**2
  1421           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1422           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1423           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1424           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1425           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1426           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1427           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1428           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1429           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1430           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1431           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1432           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1433           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1434                                                                     CL**2
  1435         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1436                                     COMP-3.                         CL**2
  1437         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1438         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1439         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1440         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1441         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1442           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1443               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1444         16  CP-R78-OPTION         PIC X.                            CL**2
  1445           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1446           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1447                                                                     CL**2
  1448         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1449         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1450         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1451         16  CP-RATE-FILE          PIC X.                            CL**2
  1452         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1453                                     COMP-3.                         CL**2
  1454                                                                     CL**2
  1455         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1456         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1457                                                                     CL**2
  1458         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1459                                     COMP-3.
  1460         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1461                                   PIC S9(5)V99 COMP-3.
  1462         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1463                                     COMP-3.                         CL**2
  1464         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1465                                     COMP-3.                         CL**2
  1466         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1467                                     COMP-3.
  1468         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1469                                  PIC S9(7)V99 COMP-3.
  1470                                                                     CL**2
  1471         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1472         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1473         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1474           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1475           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1476           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1477           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1478         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1479         16  CP-CARRIER            PIC X.                            CL**2
  1480         16  CP-REIN-FLAG          PIC X.                            CL**2
  1481         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1482           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1483                      '2' '3' '4' '5'.                               CL**2
  1484           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1485           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1486           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1487           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1488           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1489           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1490           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1491           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1492         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1493         16  CP-RATING-METHOD      PIC X.                            CL**2
  1494           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1495           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1496           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1497           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1498           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1499           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1500           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1501           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1502           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1503         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1504                                     COMP-3.                         CL**2
  1505         16  CP-BEN-CATEGORY       PIC X.
  1506         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1507         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1508                                   PIC S99V9(5) COMP-3.
  1509         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1510         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1511                                   PIC S99V9(5) COMP-3.
  1512         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1513         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1514         16  CP-EXPIRE-DT          PIC XX.
  1515         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1516         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1517         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1518         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1519         16  CP-DDF-SPEC-CALC      PIC X.
  1520             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1521             88  CP-CALC-CLP              VALUE 'C'.
  1522         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1523         16  CP-CANCEL-REASON      PIC X.
  1524         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1525         16  CP-PMT-MODE           PIC X.
  1526         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1527         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1528         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1529         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1530         16  FILLER                PIC X.
  1531                                                                     CL**2
  1532***************    OUTPUT FROM ELRESV   ************************     CL**2
  1533                                                                     CL**2
  1534         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1535                                                                     CL**2
  1536         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1537                                     COMP-3.                         CL**2
  1538         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1539                                     COMP-3.                         CL**2
  1540         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1541                                     COMP-3.                         CL**2
  1542         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1543                                     COMP-3.                         CL**2
  1544         16  FILLER                PIC X(09).                        CL**2
  1545***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1546                                                                     CL**2
  1547         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1548                                     COMP-3.                         CL**2
  1549         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1550                                     COMP-3.                         CL**2
  1551         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1552                                     COMP-3.                         CL**2
  1553         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1554                                     COMP-3.                         CL**2
  1555         16  FILLER                PIC X(12).                        CL**2
  1556                                                                     CL**2
  1557***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1558                                                                     CL**2
  1559         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1560                                     COMP-3.                         CL**2
  1561         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1562                                     COMP-3.                         CL**2
  1563         16  FILLER                PIC X(12).                        CL**2
  1564                                                                     CL**2
  1565***************    OUTPUT FROM ELRATE   *************************    CL**2
  1566                                                                     CL**2
  1567         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1568                                     COMP-3.                         CL**2
  1569         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1570                                     COMP-3.                         CL**2
  1571         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1572         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1573             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1574         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1575                                     COMP-3.                         CL**2
  1576         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1577         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1578         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1579                                   PIC S9(7)V99 COMP-3.
  1580         16  FILLER                PIC X(07).                        CL**2
  1581                                                                     CL**2
  1582***************    OUTPUT FROM ELRFND   *************************    CL**2
  1583                                                                     CL**2
  1584         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1585                                     COMP-3.                         CL**2
  1586         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1587           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1588           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1589           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1590           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1591           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1592           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1593           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1594           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1595           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1596           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1597           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1598           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1599           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1600           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1601         16  FILLER                PIC X(12).                        CL**2
  1602                                                                     CL**2
  1603***************    OUTPUT FROM ELEARN   *************************    CL**2
  1604                                                                     CL**2
  1605         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1606                                     COMP-3.                         CL**2
  1607         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1608                                     COMP-3.                         CL**2
  1609         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1610                                     COMP-3.                         CL**2
  1611         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1612                                     COMP-3.                         CL**2
  1613         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1614                                     COMP-3.                         CL**2
  1615         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1616                                     COMP-3.                         CL**2
  1617         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1618           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1619           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1620           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1621           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1622           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1623           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1624           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1625           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1626           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1627         16  FILLER                PIC X(12).                        CL**2
  1628                                                                     CL**2
  1629***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1630                                                                     CL**2
  1631         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1632                                     COMP-3.                         CL**2
  1633         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1634                                     COMP-3.                         CL**2
  1635         16  FILLER                PIC X(12).                        CL**2
  1636                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1637***************   MISC WORK AREAS    *****************************   CL**2
  1638         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1639                                     COMP-3.                         CL**2
  1640         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1641                                     COMP-3.                         CL**2
  1642         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1643                                     COMP-3.                         CL**2
  1644         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1645                                     COMP-3.                         CL**2
  1646         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1647                                     COMP-3.                         CL**2
  1648         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1649                                     COMP-3.                         CL**2
  1650         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1651             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1652             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1653             88  IO-ERROR                         VALUE 'E'.         CL**2
  1654                                                                     CL**2
  1655         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1656                                                                     CL**2
  1657         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1658                                                                     CL**2
  1659         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1660                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1661                                     COMP-3.                         CL**2
  1662                                                                     CL**2
  1663         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1664                                                                     CL**2
  1665         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1666                                     COMP-3.                         CL**2
  1667                                                                     CL**2
  1668         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1669                                     COMP-3.                         CL**2
  1670                                                                     CL**2
  1671         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1672                                     COMP-3.                         CL**2
  1673                                                                     CL**2
  1674         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1675                                     COMP-3.                         CL**2
  1676                                                                     CL**2
  1677         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1678                                     COMP-3.                         CL**2
  1679                                                                     CL**2
  1680         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1681                                     COMP-3.                         CL**2
  1682                                                                     CL**2
  1683         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1684                                     COMP-3.                         CL**2
  1685                                                                     CL**2
  1686         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1687             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1688                                                                     CL**2
  1689         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1690                                     COMP-3.                         CL**2
  1691         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1692                                     COMP-3.
  1693         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1694         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL547.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1695         16  cp-net-only-state     pic x value spaces.
  1696         16  FILLER                PIC X(13).                        CL**2
  1697******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL547.cbl
  1698/
* 1699                                 COPY ELCDATE.
  1700******************************************************************06/11/98
  1701*                                                                *ELCDATE
  1702*                                                                *ELCDATE
  1703*                            ELCDATE.                            *   LV023
  1704*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1705*                            VMOD=2.003                           ELCDATE
  1706*                                                                *ELCDATE
  1707*                                                                *ELCDATE
  1708*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1709*                 LENGTH = 200                                   *   CL*19
  1710******************************************************************ELCDATE
  1711                                                                  ELCDATE
  1712 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1713     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1714     12  DC-OPTION-CODE                PIC X.                        CL*15
  1715         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1716         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1717         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1718         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1719         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1720         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1721         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1722         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1723         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1724         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1725         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1726         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1727         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1728         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1729         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1730         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1731         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1732         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1733         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1734         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1735         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1736         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1737         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1738         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1739         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1740         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1741         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1742         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1743         88  THREE-CHARACTER-BIN                                  ELCDATE
  1744                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1745         88  GREGORIAN-TO-BIN                                        CL**2
  1746                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1747         88  BIN-TO-GREGORIAN                                        CL**2
  1748                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1749         88  JULIAN-TO-BINARY                                        CL**2
  1750                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1751     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1752         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1753         88  DATE-CONVERSION-ERROR                                ELCDATE
  1754                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1755         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL547.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1756         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1757         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1758         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1759         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1760         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1761         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1762         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1763         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1764         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1765     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1766         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1767     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1768         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1769         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1770         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1771     12  FILLER                        PIC X.                        CL*15
  1772     12  DC-CONVERSION-DATES.                                        CL*15
  1773         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1774         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1775         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1776         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1777                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1778             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1779             20  SLASH1-1              PIC X.                        CL*15
  1780             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1781             20  SLASH1-2              PIC X.                        CL*15
  1782             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1783         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1784         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1785                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1786             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1787             20  SLASH2-1              PIC X.                        CL*15
  1788             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1789             20  SLASH2-2              PIC X.                        CL*15
  1790             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1791         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1792         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1793                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1794             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1795             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1796             20  DC-YMD-DAY            PIC 99.                       CL*15
  1797         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1798         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1799                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1800             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1801             20  DC-MDY-DAY            PIC 99.                       CL*15
  1802             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1803         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1804             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1805             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1806             20  FILLER                PIC XX.                       CL*15
  1807             20  DC-ALPHA-CENTURY.                                   CL*15
  1808                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1809             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1810         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1811         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1812         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1813         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL547.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1814         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1815                                       PIC 9(05).                    CL*20
  1816         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1817             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1818             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1819         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1820         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1821         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1822     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1823         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1824         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1825             20  FILLER                PIC 9(3).                     CL*15
  1826             20  HOLD-CEN-1-CCYY.                                    CL*15
  1827                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1828                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1829             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1830             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1831         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1832             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1833             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1834             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1835                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1836                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1837             20  FILLER                PIC 9(3).                     CL*15
  1838         16  HOLD-CENTURY-1-X.                                       CL*15
  1839             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1840             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1841                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1842                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1843             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1844             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1845         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1846             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1847             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1848             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1849                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1850                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1851             20  FILLER                PIC XXX.                      CL*23
  1852         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1853         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1854         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1855         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1856             20  DC-JULIAN-1-CCYY.                                   CL*15
  1857                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1858                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1859             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1860         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1861         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1862             20  DC-JULIAN-2-CCYY.                                   CL*15
  1863                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1864                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1865             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1866         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1867             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1868             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1869             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1870             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1871             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL547.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1872                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1873                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1874         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1875             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1876             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1877             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1878             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1879             20  DC-EDITB-CCYY.                                      CL*15
  1880                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1881                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1882         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1883         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1884                              DC-GREG-DATE-CYMD.                  ELCDATE
  1885             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1886             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1887             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1888             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1889         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1890         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1891                              DC-GREG-DATE-MDCY.                  ELCDATE
  1892             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1893             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1894             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1895             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1896    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1897        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1898    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1899    12  FILLER                         PIC X(28).                    CL*26
* 1900                                 COPY ELCFUNDT.
  1901***************************************************************** 12/03/98
  1902*                                                               * ELCFUNDT
  1903*                            ELCFUNDT.                          *    LV004
  1904*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1905*                            VMOD=2.001                         * ELCFUNDT
  1906*                                                               * ELCFUNDT
  1907*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  1908*                                                               * ELCFUNDT
  1909***************************************************************** ELCFUNDT
  1910                                                                  ELCFUNDT
  1911                                                                  ELCFUNDT
  1912 01  FUNCTION-DATE.                                                  CL**2
  1913     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  1914     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  1915         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  1916         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  1917             15  WS-FN-CC          PIC 99.                           CL**3
  1918             15  WS-FN-YR          PIC 99.                           CL**3
  1919         10  WS-FN-MO              PIC 99.                           CL**3
  1920         10  WS-FN-DA              PIC 99.                           CL**3
  1921     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  1922     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  1923     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  1924     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  1925     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  1926         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  1927         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  1928         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  1929     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL547.cbl
  1930     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  1931
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL547.cbl
  1932/
* 1933                                 COPY ELCDTECX.
  1934******************************************************************06/05/98
  1935*                                                                *ELCDTECX
  1936*                            ELCDTECX.                           *   LV005
  1937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1938*                            VMOD=2.015                          *ELCDTECX
  1939*                                                                *ELCDTECX
  1940*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1941*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1942*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1943*                                                                *ELCDTECX
  1944******************************************************************ELCDTECX
  1945******************************************************************
  1946*                   C H A N G E   L O G
  1947*
  1948* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1949*-----------------------------------------------------------------
  1950*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1951* EFFECTIVE    NUMBER
  1952*-----------------------------------------------------------------
  1953* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1954*                                  BENEFIT CODES FROM 300 TO 900
  1955* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1956* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1957* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1958******************************************************************
  1959 01  DATE-CARD.                                                   ELCDTECX
  1960     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1961     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1962     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1963     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1964     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1965     12  EP-SW                       PIC  X.                      ELCDTECX
  1966         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1967     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1968         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1969     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1970     12  RUN-CENTURY.                                             ELCDTECX
  1971         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1972     12  FILLER                      PIC  X.                         CL**4
  1973     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1974     12  FILLER                      PIC  XXX.                    ELCDTECX
  1975     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1976                                                                  ELCDTECX
  1977 01  FILLER                          PIC  X(7)                       CL**6
  1978                                          VALUE 'OPTIONS'.        ELCDTECX
  1979 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1980     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1981     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1982     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1983         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1984         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1985     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1986     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1987     12  FILLER                      PIC  X.                      ELCDTECX
  1988     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1989     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1990     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1991     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1992     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1993     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1994     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1995     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1996     12  FILLER                      PIC  X.                      ELCDTECX
  1997     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1998     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1999     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2000     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2001     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2002     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2003     12  FILLER                      PIC  X.                      ELCDTECX
  2004     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2005     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2006     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2007     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2008     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2009     12  DTE-R78                     PIC  X.                      ELCDTECX
  2010     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2011     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2012     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2013     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2014     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2015     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2016     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2017                                     PIC  X.                      ELCDTECX
  2018         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2019                                                 ' '.             ELCDTECX
  2020         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2021         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2022     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2023         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2024         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2025     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2026     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2027                                     PIC  9.                         CL**4
  2028     12  DTE-SYSTEM.                                              ELCDTECX
  2029         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2030         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2031         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2032         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2033         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2034         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2035         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2036         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2037         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2038         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2039         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2040         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2041         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2042         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2043         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2044         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2045         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2046         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2047         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2048         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  2049         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2050         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2051         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2052         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2053         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2054         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2055     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2056         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2057                                     PIC  X.                      ELCDTECX
  2058     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2059                                                                  ELCDTECX
  2060 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2061     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2062     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2063     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2064*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2065     12  FILLER                      PIC  X.                      ELCDTECX
  2066     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2067     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2068     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2069     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2070     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2071     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2072     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2073                                                                  ELCDTECX
  2074     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2075     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2076     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2077     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2078                                                                  ELCDTECX
  2079     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2080     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2081     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2082     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2083                                                                  ELCDTECX
  2084     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2085     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2086                                                                  ELCDTECX
  2087     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2088     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2089                                                                  ELCDTECX
  2090     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2091                                                                  ELCDTECX
  2092 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2093     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2094     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2095     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2096     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2097     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2098     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2099     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2100                                                                  ELCDTECX
  2101 01  FILLER                          PIC  X(12)                   ELCDTECX
  2102                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2103 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2104     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2105         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2106         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  2107                                                                  ELCDTECX
  2108 01  FILLER                          PIC  X(11)                   ELCDTECX
  2109                                          VALUE 'STATE NAMES'.    ELCDTECX
  2110 01  STATE-NAMES.                                                 ELCDTECX
  2111     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2112         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2113         16  STATE-PIC1.                                          ELCDTECX
  2114             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2115             20  FILLER              PIC  XXX.                    ELCDTECX
  2116             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2117             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2118             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2119             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2120                                                                  ELCDTECX
  2121 01  FILLER                          PIC  X(13)                   ELCDTECX
  2122                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2123 01  CARRIER-NAMES.                                               ELCDTECX
  2124     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2125         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2126         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2127         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2128         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2129         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2130         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2131*        16  FILLER                  PIC  X.                      ELCDTECX
  2132         16  CARRIER-SEC-PAY         PIC  X.
  2133             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2134                                                                  ELCDTECX
  2135 01  FILLER                          PIC  X(9)                       CL**6
  2136                                          VALUE 'INS TYPES'.      ELCDTECX
  2137 01  CLAS-INS-TYPES.                                              ELCDTECX
  2138*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2139     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2140         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2141         16  CLAS-I-AB3.                                          ELCDTECX
  2142             20  FILLER              PIC  X.                      ELCDTECX
  2143             20  CLAS-I-AB2.                                      ELCDTECX
  2144                 24  FILLER          PIC  X.                      ELCDTECX
  2145                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2146         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2147             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2148             20  FILLER              PIC  X.                         CL**4
  2149         16  CLAS-I-AB10.                                         ELCDTECX
  2150             20  FILLER              PIC  X(9).                   ELCDTECX
  2151             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2152         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2153         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2154         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2155         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2156             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2157         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2158         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2159         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2160         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2161         16  CLAS-I-REFUND-METHOD    PIC  X.
  2162         16  CLAS-I-MAX-BENEFITS     PIC 99.
  2163         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2164                                                                  ELCDTECX
  2165 01  FILLER                          PIC  X(16)                   ELCDTECX
  2166                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2167 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2168     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2169                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2170         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2171         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2172         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2173         16  CLAS-MORT-DESC.                                      ELCDTECX
  2174             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2175             20  FILLER              PIC  XX.                        CL**5
  2176             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2177             20  FILLER              PIC  X.                         CL**5
  2178             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2179             20  FILLER              PIC  X.                         CL**5
  2180             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2181             20  FILLER              PIC  X.                         CL**5
  2182             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2183             20  FILLER              PIC  X(5).                      CL**6
  2184                                                                  ELCDTECX
  2185 01  FILLER                          PIC  X(15)                   ELCDTECX
  2186                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2187 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2188     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2189         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2190         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2191         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2192         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2193         16  FILLER                  PIC  X(4).                      CL**6
  2194                                                                  ELCDTECX
  2195 01  FILLER                          PIC  X(7)                       CL**6
  2196                                     VALUE 'INDEXES'.             ELCDTECX
  2197 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2198     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2199     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2200     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2201     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2202     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2203     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2204     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2205     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2206     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2207     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2208     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2209     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2210     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2211     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2212     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2213     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2214     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2215                                                                  ELCDTECX
  2216 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2217     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2218     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2219     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2220     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2221     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2222     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2223     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2224     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2225     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2226     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2227     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2228                                                                  ELCDTECX
  2229 01  FILLER                          PIC  X(13)                   ELCDTECX
  2230                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2231 01  CLAS-MISC.                                                   ELCDTECX
  2232     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2233         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2234         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2235         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2236     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2237     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2238     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2239     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2240     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2241     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2242     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2243     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2244     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2245     12  STATE-L                     PIC  XX.                     ELCDTECX
  2246     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2247     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2248     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2249         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2250         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2251     12  DTE-ABEND-WORK.                                          ELCDTECX
  2252         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2253         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2254                                                                  ELCDTECX
  2255 01  FILLER                          PIC  X(12)                   ELCDTECX
  2256                                     VALUE 'WORKING DATE'.        ELCDTECX
  2257 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2258     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2259         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2260         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2261         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2262     12  WS-CURRENT-DATE.                                         ELCDTECX
  2263         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2264         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2265         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2266         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2267         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2268     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2269         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2270         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2271                                                                  ELCDTECX
  2272 01  FILLER                          PIC  X(12)                   ELCDTECX
  2273                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2274 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2275     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2276         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2277         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2278         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2279                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2280 01  FILLER                          PIC  X(10)                   ELCDTECX
  2281                                     VALUE 'STATE TLRS'.          ELCDTECX
  2282 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2283     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2284         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2285         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2286                                                                  ELCDTECX
  2287 01  FILLER                          PIC  X(13)                   ELCDTECX
  2288                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2289 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2290     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2291         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2292                                                                  ELCDTECX
  2293 01  FILLER                          PIC  X(13)                   ELCDTECX
  2294                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2295 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2296     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2297     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2298     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2299                                     PIC  X.                         CL**5
  2300     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2301     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2302     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2303     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2304     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2305     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2306     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2307     12  FILLER                      PIC  X(75).                  ELCDTECX
  2308******************************************************************ELCDTECX
  2309*01  MISC-CARR-PCT-DATA.                                          00001521
  2310*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2311*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2312*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2313*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2314*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2315*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2316******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL547.cbl
  2317/
* 2318                                 COPY ELCDTEVR.
  2319***************************************************************** 04/15/98
  2320*                                                                *ELCDTEVR
  2321*                                                                *ELCDTEVR
  2322*                            ELCDTEVR.                           *   LV003
  2323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2324*                            VMOD=2.001                          *   CL**2
  2325*                                                                *ELCDTEVR
  2326*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2327*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2328*                                                                *ELCDTEVR
  2329******************************************************************ELCDTEVR
  2330 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2331     05  WS-RUN-DATE.                                             ELCDTEVR
  2332         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2333         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2334         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2335             15  RUN-CC              PIC  99.                     ELCDTEVR
  2336             15  RUN-YR              PIC  99.                     ELCDTEVR
  2337         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2338         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2339     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2340            WS-RUN-DATE              PIC 9(11).                      CL**2
  2341     05  WS-EP-DT.                                                ELCDTEVR
  2342         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2343         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2344         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2345             15  EP-CC               PIC  99.                     ELCDTEVR
  2346             15  EP-YR               PIC  99.                     ELCDTEVR
  2347         10  EP-MO                   PIC  99.                     ELCDTEVR
  2348         10  EP-DA                   PIC  99.                     ELCDTEVR
  2349     05  WS-EP-DT-N REDEFINES                                        CL**2
  2350            WS-EP-DT                 PIC 9(11).                      CL**2
  2351     05  WS-DTE-CONV-DT.                                             CL**4
  2352         10  FILLER                  PIC  9(03).                     CL**4
  2353         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2354         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2355             15  DTE-CONV-CC         PIC  99.                        CL**4
  2356             15  DTE-CONV-YR         PIC  99.                        CL**4
  2357         10  DTE-CONV-MO             PIC  99.                        CL**4
  2358         10  DTE-CONV-DA             PIC  99.                        CL**4
  2359     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2360            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2361 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2362     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2363         10  FILLER                            PIC 999.           ELCDTEVR
  2364         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2365         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2366             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2367             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2368         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2369         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2370     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2371            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2372     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2373         10  FILLER                            PIC 999.           ELCDTEVR
  2374         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2375         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2376         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2377         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2378     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2379            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2380 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2381     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2382         10  FILLER                            PIC 999.           ELCDTEVR
  2383         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2384         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2385             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2386             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2387         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2388         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2389     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2390            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2391     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2392         10  FILLER                            PIC 999.           ELCDTEVR
  2393         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2394         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2395             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2396             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2397         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2398         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2399     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2400            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2401     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2402         10  FILLER                            PIC 999.           ELCDTEVR
  2403         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2404         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2405             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2406             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2407         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2408         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2409     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2410            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2411 01  WS-RATE-RECORD.                                              ELCDTEVR
  2412         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2413             10  FILLER                        PIC 999.           ELCDTEVR
  2414             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2415             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2416                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2417                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2418             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2419             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2420         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2421                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL547.cbl
  2422/
  2423 PROCEDURE DIVISION.
  2424
  2425 0001-DT-CRD-READ SECTION.
* 2426                                 COPY ELCDTERX.
  2427******************************************************************04/15/98
  2428*                                                                *ELCDTERX
  2429*                                                                *ELCDTERX
  2430*                            ELCDTERX.                           *   LV002
  2431*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2432*                            VMOD=2.007                          *ELCDTERX
  2433*                                                                *ELCDTERX
  2434*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2435*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2436*      = ELCDTEFD)                                               *ELCDTERX
  2437*                                                                *ELCDTERX
  2438******************************************************************ELCDTERX
  2439                                                                  ELCDTERX
  2440     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2441                                                                  ELCDTERX
  2442     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2443     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2444     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2445                                                                  ELCDTERX
  2446     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2447                                                                  ELCDTERX
  2448******************************************************************ELCDTERX
  2449*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2450*          WARNING MESSAGES.                                      ELCDTERX
  2451******************************************************************ELCDTERX
  2452     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2453         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2454                                                                  ELCDTERX
  2455     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2456                                                                  ELCDTERX
  2457     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2458                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2459                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2460                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2461                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2462                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2463                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2464                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2465                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2466                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2467                                                                  ELCDTERX
  2468     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2469                                                                  ELCDTERX
  2470     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2471                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2472                                                                  ELCDTERX
  2473     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2474     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2475     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2476     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2477                                                                  ELCDTERX
  2478     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2479         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2480     ELSE                                                         ELCDTERX
  2481         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2482                                                                  ELCDTERX
  2483     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2484         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2485     ELSE                                                         ELCDTERX
  2486         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2487                                                                  ELCDTERX
  2488 0005-READ--CARD.                                                 ELCDTERX
  2489     READ DISK-DATE                                               ELCDTERX
  2490         AT END CLOSE DISK-DATE                                   ELCDTERX
  2491             GO TO 0060-READ--TEST.                               ELCDTERX
  2492                                                                  ELCDTERX
  2493     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2494                                                                  ELCDTERX
  2495     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2496         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2497         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2498         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2499         GO TO 0005-READ--CARD.                                   ELCDTERX
  2500                                                                  ELCDTERX
  2501     IF DD-ID = 'CLAD'                                            ELCDTERX
  2502         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2503         GO TO 0005-READ--CARD.                                   ELCDTERX
  2504                                                                  ELCDTERX
  2505     IF DD-ID = 'CLAX'                                            ELCDTERX
  2506         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2507         GO TO 0005-READ--CARD.                                   ELCDTERX
  2508                                                                  ELCDTERX
  2509     IF DD-ID = 'CLAF'                                            ELCDTERX
  2510         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2511         GO TO 0005-READ--CARD.                                   ELCDTERX
  2512                                                                  ELCDTERX
  2513     IF DD-ID = 'CLAC'                                            ELCDTERX
  2514         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2515                                                                  ELCDTERX
  2516     IF DD-ID = 'CARR'                                            ELCDTERX
  2517         GO TO 0015-READ--CARR.                                   ELCDTERX
  2518                                                                  ELCDTERX
  2519     IF DD-ID = 'STAT'                                            ELCDTERX
  2520         GO TO 0020-READ--STAT.                                   ELCDTERX
  2521                                                                  ELCDTERX
  2522     IF DD-ID = 'BUSC'                                            ELCDTERX
  2523         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2524                                                                  ELCDTERX
  2525     IF DD-ID = 'MORT'                                            ELCDTERX
  2526         GO TO 0030-READ--MORT.                                   ELCDTERX
  2527                                                                  ELCDTERX
  2528     IF DD-ID = 'CLAI'                                            ELCDTERX
  2529         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2530                                                                  ELCDTERX
  2531     IF DD-ID = 'COLC'                                            ELCDTERX
  2532         GO TO 0065-READ--COLC.                                   ELCDTERX
  2533                                                                  ELCDTERX
  2534     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2535        DD-IDA = 'CL'                                             ELCDTERX
  2536         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2537                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2538     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2539        DD-IDA = 'PO'                                             ELCDTERX
  2540         GO TO 0050-READ--POXX.                                   ELCDTERX
  2541                                                                  ELCDTERX
  2542     IF DD-ID = 'OPCA'                                            ELCDTERX
  2543         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2544                                                                  ELCDTERX
  2545     IF DD-ID = 'OPST'                                            ELCDTERX
  2546         GO TO 0072-READ--OPST.                                   ELCDTERX
  2547                                                                  ELCDTERX
  2548     IF DD-ID = 'OPBS'                                            ELCDTERX
  2549         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2550                                                                  ELCDTERX
  2551     IF DD-ID = 'OPMS'                                            ELCDTERX
  2552         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2553                                                                  ELCDTERX
  2554     GO TO 0005-READ--CARD.                                       ELCDTERX
  2555                                                                  ELCDTERX
  2556 0010-READ--CLAC.                                                 ELCDTERX
  2557     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2558     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2559     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2560     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2561     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2562     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2563     GO TO 0005-READ--CARD.                                       ELCDTERX
  2564                                                                  ELCDTERX
  2565 0015-READ--CARR.                                                 ELCDTERX
  2566     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2567     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2568        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2569        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2570        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2571        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2572        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2573        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2574        MOVE DD-CARR1-SECPAY-SW
  2575                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2576     END-IF
  2577                                                                  ELCDTERX
  2578     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2579     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2580        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2581        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2582        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2583        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2584        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2585        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2586        MOVE DD-CARR2-SECPAY-SW
  2587                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2588     END-IF
  2589                                                                  ELCDTERX
  2590                                                                  ELCDTERX
  2591     GO TO 0005-READ--CARD.                                       ELCDTERX
  2592                                                                  ELCDTERX
  2593 0020-READ--STAT.                                                 ELCDTERX
  2594     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2595     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2596        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2597         GO TO 0005-READ--CARD.                                   ELCDTERX
  2598                                                                  ELCDTERX
  2599     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2600     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2601     GO TO 0020-READ--STAT.                                       ELCDTERX
  2602                                                                  ELCDTERX
  2603 0025-READ--BUSC.                                                 ELCDTERX
  2604     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2605     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2606        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2607         GO TO 0005-READ--CARD.                                   ELCDTERX
  2608                                                                  ELCDTERX
  2609     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2610     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2611     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2612                                                                  ELCDTERX
  2613 0030-READ--MORT.                                                 ELCDTERX
  2614     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2615     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2616        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2617         GO TO 0005-READ--CARD.                                   ELCDTERX
  2618                                                                  ELCDTERX
  2619     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2620     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2621     GO TO 0030-READ--MORT.                                       ELCDTERX
  2622                                                                  ELCDTERX
  2623 0035-READ--CLXX.                                                 ELCDTERX
  2624     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2625          GO TO 0005-READ--CARD.                                  ELCDTERX
  2626                                                                  ELCDTERX
  2627     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2628         DISPLAY '***********************************************'ELCDTERX
  2629         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2630         DISPLAY '***********************************************'ELCDTERX
  2631         GO TO 0055-READ--STOP.                                   ELCDTERX
  2632                                                                  ELCDTERX
  2633     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2634        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2635         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2636                                                                  ELCDTERX
  2637     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2638        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2639         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2640                                                                  ELCDTERX
  2641*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2642     GO TO 0005-READ--CARD.                                       ELCDTERX
  2643                                                                  ELCDTERX
  2644 0040-READ--CLAI.                                                 ELCDTERX
  2645     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2646     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2647        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2648         GO TO 0005-READ--CARD.                                   ELCDTERX
  2649                                                                  ELCDTERX
  2650     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2651     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2652     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2653                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2654 0045-READ--DUMP.                                                 ELCDTERX
  2655     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2656     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2657                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2658     PERFORM ABEND-PGM.                                           ELCDTERX
  2659                                                                  ELCDTERX
  2660 0050-READ--POXX.                                                 ELCDTERX
  2661     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2662         GO TO 0005-READ--CARD.                                   ELCDTERX
  2663                                                                  ELCDTERX
  2664     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2665         DISPLAY '***********************************************'ELCDTERX
  2666         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2667         DISPLAY '***********************************************'ELCDTERX
  2668         GO TO 0055-READ--STOP.                                   ELCDTERX
  2669                                                                  ELCDTERX
  2670     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2671     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2672     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2673     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2674                                                                  ELCDTERX
  2675     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2676         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2677     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2678         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2679                                                                  ELCDTERX
  2680     GO TO 0005-READ--CARD.                                       ELCDTERX
  2681                                                                  ELCDTERX
  2682 0055-READ--STOP.                                                 ELCDTERX
  2683     GOBACK.                                                      ELCDTERX
  2684                                                                  ELCDTERX
  2685 0060-READ--TEST.                                                 ELCDTERX
  2686     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2687        CLAX-ID         = SPACE  OR                               ELCDTERX
  2688        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2689         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2690                                                                  ELCDTERX
  2691     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2692     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2693                                                                  ELCDTERX
  2694 0065-READ--COLC.                                                 ELCDTERX
  2695     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2696     GO TO 0005-READ--CARD.                                       ELCDTERX
  2697                                                                  ELCDTERX
  2698 0070-READ--OPCA.                                                 ELCDTERX
  2699                                                                  ELCDTERX
  2700     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2701                                                                  ELCDTERX
  2702     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2703             OR                                                   ELCDTERX
  2704         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2705         GO TO 0005-READ--CARD.                                   ELCDTERX
  2706                                                                  ELCDTERX
  2707     ADD 1                       TO INDEXCA.                      ELCDTERX
  2708     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2709                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2710     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2711                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL547.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2712 0072-READ--OPST.                                                 ELCDTERX
  2713                                                                  ELCDTERX
  2714     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2715                                                                  ELCDTERX
  2716     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2717             OR                                                   ELCDTERX
  2718         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2719         GO TO 0005-READ--CARD.                                   ELCDTERX
  2720                                                                  ELCDTERX
  2721     ADD 1                       TO INDEXST.                      ELCDTERX
  2722     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2723                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2724     GO TO 0072-READ--OPST.                                       ELCDTERX
  2725                                                                  ELCDTERX
  2726 0074-READ--OPBS.                                                 ELCDTERX
  2727                                                                  ELCDTERX
  2728     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2729                                                                  ELCDTERX
  2730     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2731             OR                                                   ELCDTERX
  2732         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2733         GO TO 0005-READ--CARD.                                   ELCDTERX
  2734                                                                  ELCDTERX
  2735     ADD 1                       TO INDEXBS.                      ELCDTERX
  2736     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2737     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2738                                                                  ELCDTERX
  2739 0079-READ--EXIT.                                                 ELCDTERX
  2740*    EXIT.                                                        ELCDTERX
  2741******************************************************************ELCDTERX
  2742
  2743     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2744     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  2745     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  2746
  2747
  2748     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2749
  2750     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2751
  2752     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2753
  2754     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2755
  2756
  2757     GOBACK
  2758     .
  2759
  2760 0010-INITIALIZE.
  2761
  2762*    DISPLAY ' MADE IT TO 0010 '
  2763     MOVE RUN-DATE               TO WS-WORK-DATE
  2764
  2765     MOVE 198601                 TO WS-LO-ISSUE-CCYYMM
  2766                                    WS-LO-VALUATION-CCYYMM
  2767*    MOVE 1990                   TO WS-LO-ISSUE-CCYYMM
  2768*                                   WS-LO-VALUATION-CCYYMM
  2769     MOVE WS-WORK-CCYYMM         TO WS-HI-ISSUE-CCYYMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL547.cbl
  2770     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2771            (IYR > +600) OR
  2772            (WS-ISSUE-CCYYMM (IYR) > WS-HI-ISSUE-CCYYMM)
  2773        MOVE WS-LO-VALUATION-CCYYMM TO WS-ISSUE-CCYYMM (IYR)
  2774        ADD +1 TO WS-LO-VALUATION-CCYYMM
  2775        IF WS-LO-VAL-MM > 12
  2776           MOVE 01               TO WS-LO-VAL-MM
  2777           ADD 1                 TO WS-LO-VAL-CCYY
  2778        END-IF
  2779     END-PERFORM
  2780
  2781     MOVE WS-LO-ISSUE-CCYYMM     TO WS-LO-VALUATION-CCYYMM
  2782                                    WS-WORK-CCYYMM
  2783
  2784     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2785            VYR > +600
  2786          PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2787             IYR > +600
  2788             MOVE WS-WORK-CCYYMM TO WS-VALUATION-CCYYMM (IYR VYR)
  2789          END-PERFORM
  2790        MOVE WS-WORK-CCYYMM      TO WS-CCYYMM
  2791        IF WS-MM = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12
  2792           MOVE 31               TO WS-DD
  2793        ELSE
  2794           IF WS-MM = 04 OR 06 OR 09 OR 11
  2795              MOVE 30            TO WS-DD
  2796           ELSE
  2797              MOVE 28            TO WS-DD
  2798           END-IF
  2799        END-IF
  2800
  2801        MOVE WS-END-YEAR         TO DC-GREG-DATE-CYMD
  2802        MOVE 'L'                 TO DC-OPTION-CODE
  2803        PERFORM 8510-DATE-CONVERSION
  2804                                 THRU 8590-EXIT
  2805        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DATES (VYR)
  2806        ADD 1                    TO WS-WORK-CCYYMM
  2807        IF WS-WORK-MM > 12
  2808           MOVE 01               TO WS-WORK-MM
  2809           ADD 1                 TO WS-WORK-CCYY
  2810        END-IF
  2811     END-PERFORM
  2812
  2813     SUBTRACT +1 FROM WS-WORK-CCYYMM
  2814     IF WS-WORK-MM = ZEROS
  2815        MOVE 12                  TO WS-WORK-MM
  2816        SUBTRACT 1               FROM WS-WORK-CCYY
  2817     END-IF
  2818     MOVE WS-WORK-CCYYMM         TO WS-HI-VALUATION-CCYYMM
  2819
  2820     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2821         IYR > +600
  2822         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2823            VYR > +600
  2824            MOVE +0              TO WS-LF-INFORCE (IYR VYR)
  2825                                    WS-LF-WRITTEN (IYR VYR)
  2826                                    WS-AH-WRITTEN (IYR VYR)
  2827                                    WS-LF-REFUNDS (IYR VYR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL547.cbl
  2828                                    WS-AH-REFUNDS (IYR VYR)
  2829                                    WS-LF-R78     (IYR VYR)
  2830                                    WS-LF-PRO     (IYR VYR)
  2831                                    WS-LF-ST      (IYR VYR)
  2832                                    WS-AH-R78     (IYR VYR)
  2833                                    WS-AH-PRO     (IYR VYR)
  2834                                    WS-AH-ST      (IYR VYR)
  2835                                    WS-LF-CLAIM   (IYR VYR)
  2836                                    WS-AH-CLAIM   (IYR VYR)
  2837         END-PERFORM
  2838     END-PERFORM
  2839
  2840     DISPLAY '  LO ISSUE  ' WS-LO-ISSUE-CCYYMM
  2841           '    HI ISSUE  ' WS-HI-ISSUE-CCYYMM
  2842     DISPLAY '  LO VALUE  ' WS-LO-VALUATION-CCYYMM
  2843           '    HI VALUE  ' WS-HI-VALUATION-CCYYMM
  2844
  2845     .
  2846
  2847 0010-EXIT.
  2848     EXIT.
  2849
  2850 0020-OPEN-FILES.
  2851
  2852     DISPLAY ' MADE IT TO 0020 '
  2853     OPEN INPUT CERTS CLMS-HIST
  2854         OUTPUT EXTRACT
  2855
  2856     .
  2857
  2858 0020-EXIT.
  2859     EXIT.
  2860
  2861 0030-CLOSE-FILES.
  2862     DISPLAY ' MADE IT TO 0030 '
  2863
  2864     CLOSE CERTS CLMS-HIST
  2865         EXTRACT
  2866
  2867     .
  2868
  2869 0030-EXIT.
  2870     EXIT.
  2871
  2872 0050-PROCESS-FILE.
  2873
  2874*    DISPLAY ' MADE IT TO 0050 '
  2875     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  2876     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  2877           THERE-ARE-NO-MORE-RECORDS
  2878
  2879     DISPLAY ' FINISHED CERTS '
  2880
  2881     SET THERE-ARE-MORE-RECORDS TO TRUE
  2882
  2883     PERFORM 0070-READ-CLMS      THRU 0070-EXIT UNTIL
  2884         (THERE-ARE-NO-MORE-RECORDS) OR
  2885         ((DE-REIN = SPACES) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL547.cbl
  2886         (DE-CLAIM))
  2887
  2888     DISPLAY ' POSITIONED CLAIMS '
  2889
  2890     IF NOT THERE-ARE-NO-MORE-RECORDS
  2891        PERFORM 0090-PROCESS-CLMS
  2892                                 THRU 0090-EXIT UNTIL
  2893           THERE-ARE-NO-MORE-RECORDS
  2894     END-IF
  2895
  2896     DISPLAY ' FINISHED CLMS  '
  2897
  2898     PERFORM 0500-EMPTY-TABLE    THRU 0500-EXIT
  2899
  2900     .
  2901
  2902 0050-EXIT.
  2903     EXIT.
  2904
  2905 0060-READ-CERT.
  2906
  2907*    DISPLAY ' MADE IT TO 0060 '
  2908     READ CERTS AT END
  2909         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  2910     END-READ
  2911
  2912     IF NOT THERE-ARE-NO-MORE-RECORDS
  2913        ADD +1                   TO WS-CRT-CNT
  2914                                    WS-CRT-CNT-TOT
  2915        IF WS-CRT-CNT = +10000
  2916           DISPLAY ' CERTS READ ' WS-CRT-CNT-TOT
  2917           MOVE +0               TO WS-CRT-CNT
  2918        END-IF
  2919        IF CR-CERT-NO = '0000109489 '
  2920           DISPLAY ' FOUND BAD CERT '
  2921        END-IF
  2922     END-IF
  2923
  2924     .
  2925
  2926 0060-EXIT.
  2927     EXIT.
  2928
  2929 0070-READ-CLMS.
  2930
  2931*    DISPLAY ' MADE IT TO 0070 '
  2932     READ CLMS-HIST AT END
  2933         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  2934     END-READ
  2935
  2936     IF NOT THERE-ARE-NO-MORE-RECORDS
  2937        ADD +1                   TO WS-CLM-CNT
  2938                                    WS-CLM-CNT-TOT
  2939        IF WS-CLM-CNT = +10000
  2940           DISPLAY ' CLMS  READ ' WS-CLM-CNT-TOT
  2941           MOVE +0               TO WS-CLM-CNT
  2942        END-IF
  2943     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL547.cbl
  2944
  2945     .
  2946
  2947 0070-EXIT.
  2948     EXIT.
  2949
  2950 0080-PROCESS-CERT.
  2951
  2952*    DISPLAY ' MADE IT TO 0080 '
  2953     MOVE CR-DT                  TO WS-EFFECT-DATE
  2954
  2955     IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  2956        (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM) OR
  2957        (CR-ENTRY-STATUS = '9' OR 'D' OR 'V' OR 'M')
  2958        CONTINUE
  2959     ELSE
  2960        PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2961           WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  2962        END-PERFORM
  2963        PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2964           WS-EFFECT-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  2965        END-PERFORM
  2966        IF CR-ENTRY-STATUS = '5'
  2967           CONTINUE
  2968        ELSE
  2969           IF CR-LFTYP NOT = '00' AND '  '
  2970             COMPUTE WS-LF-WRITTEN (IYR VYR) =
  2971               WS-LF-WRITTEN (IYR VYR) +
  2972               CR-LFPRM + CR-LFPRM-ALT
  2973           END-IF
  2974           COMPUTE WS-AH-WRITTEN (IYR VYR) =
  2975               WS-AH-WRITTEN (IYR VYR) + CR-AHPRM
  2976        END-IF
  2977*       IF (CR-LF-CANC-DT NOT = ZEROS)
  2978        IF (CR-LF-CANC-DT > 19851231)
  2979           MOVE CR-LF-CANC-DT    TO WS-CANCEL-DATE
  2980           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2981              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  2982           END-PERFORM
  2983           COMPUTE WS-LF-REFUNDS (IYR VYR) =
  2984                 WS-LF-REFUNDS (IYR VYR) + CR-LFRFND
  2985        END-IF
  2986*       IF (CR-AH-CANC-DT NOT = ZEROS)
  2987        IF (CR-AH-CANC-DT > 19851231)
  2988           MOVE CR-AH-CANC-DT    TO WS-CANCEL-DATE
  2989           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2990              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  2991           END-PERFORM
  2992           COMPUTE WS-AH-REFUNDS (IYR VYR) =
  2993                 WS-AH-REFUNDS (IYR VYR) + CR-AHRFND
  2994        END-IF
  2995        IF CR-ENTRY-STATUS NOT = '5'
  2996           PERFORM 0200-CALC-UEP    THRU 0200-EXIT
  2997        END-IF
  2998     END-IF
  2999
  3000     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3001
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL547.cbl
  3002     .
  3003
  3004 0080-EXIT.
  3005     EXIT.
  3006
  3007 0090-PROCESS-CLMS.
  3008
  3009*    DISPLAY ' MADE IT TO 0090 '
  3010     MOVE DE-EFF                 TO WS-EFFECT-DATE
  3011*    MOVE DE-CLM-PROC-DT         TO WS-CLAIM-DATE
  3012*    MOVE DE-PAY                 TO WS-CLAIM-DATE
  3013     MOVE DE-INCUR               TO WS-CLAIM-DATE
  3014
  3015     IF (DE-REIN = ' ') AND
  3016        (DE-TRANS = 'X')
  3017     IF (DE-CLM-PROC-DT > RUN-DATE)
  3018        CONTINUE
  3019     ELSE
  3020        IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  3021           (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM)
  3022           CONTINUE
  3023        ELSE
  3024           PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3025              WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  3026           END-PERFORM
  3027           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3028              WS-CLAIM-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3029           END-PERFORM
  3030           IF DE-DEATH
  3031              COMPUTE WS-LF-CLAIM (IYR VYR) =
  3032                     WS-LF-CLAIM (IYR VYR) +
  3033                     DE-CLAIM-AMT
  3034           ELSE
  3035              COMPUTE WS-AH-CLAIM (IYR VYR) =
  3036                     WS-AH-CLAIM (IYR VYR) +
  3037                     DE-CLAIM-AMT
  3038           END-IF
  3039        END-IF
  3040     END-IF
  3041     END-IF
  3042
  3043     PERFORM 0070-READ-CLMS      THRU 0070-EXIT
  3044
  3045     .
  3046
  3047 0090-EXIT.
  3048     EXIT.
  3049
  3050 0200-CALC-UEP.
  3051
  3052*    DISPLAY ' MADE IT TO 0200 '
  3053     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3054        CONTINUE
  3055     ELSE
  3056        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3057            (CLAS-INDEXS > CLAS-MAXS) OR
  3058            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3059        END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL547.cbl
  3060        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3061           CONTINUE
  3062        ELSE
  3063           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3064           MOVE 0302 TO WS-RETURN-CODE
  3065           PERFORM ABEND-PGM
  3066        END-IF
  3067     END-IF
  3068
  3069     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3070     MOVE 'L'                    TO DC-OPTION-CODE
  3071     PERFORM 8510-DATE-CONVERSION
  3072                                 THRU 8590-EXIT
  3073     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3074                                    WS-BIN-CR-DT
  3075
  3076     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3077        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3078     END-IF
  3079
  3080     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3081
  3082     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3083        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3084        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3085                                    DC-ELAPSED-DAYS
  3086        MOVE '3'                 TO DC-OPTION-CODE
  3087        PERFORM 8510-DATE-CONVERSION
  3088                                 THRU 8590-EXIT
  3089        IF NO-CONVERSION-ERROR
  3090           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3091        ELSE
  3092           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3093        END-IF
  3094      END-IF
  3095
  3096     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3097        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3098     END-IF
  3099
  3100     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3101        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3102        MOVE +1                  TO DC-ELAPSED-MONTHS
  3103        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3104        MOVE '6'                 TO DC-OPTION-CODE
  3105        PERFORM 8510-DATE-CONVERSION
  3106                                 THRU 8590-EXIT
  3107        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3108        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3109     END-IF
  3110
  3111     MOVE CR-LF-EXPIRE-DATE          TO WS-WORK-DATE
  3112
  3113     IF (CR-LF-CANC-DT NOT = ZEROS) AND
  3114        (CR-LF-CANC-DT < WS-WORK-DATE)
  3115        MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  3116     END-IF
  3117
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL547.cbl
  3118     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3119        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3120        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3121     END-IF
  3122
  3123     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3124     MOVE 'L'                    TO DC-OPTION-CODE
  3125     PERFORM 8510-DATE-CONVERSION
  3126                                 THRU 8590-EXIT
  3127     MOVE DC-BIN-DATE-1          TO WS-BIN-LF-END-DATE
  3128
  3129     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3130
  3131     IF (CR-AH-CANC-DT NOT = ZEROS) AND
  3132        (CR-AH-CANC-DT < WS-WORK-DATE)
  3133        MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  3134     END-IF
  3135
  3136     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3137        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3138        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3139                                     TO WS-WORK-DATE
  3140     END-IF
  3141
  3142     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3143     MOVE 'L'                    TO DC-OPTION-CODE
  3144     PERFORM 8510-DATE-CONVERSION
  3145                                 THRU 8590-EXIT
  3146     MOVE DC-BIN-DATE-1          TO WS-BIN-AH-END-DATE
  3147
  3148
  3149     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3150     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3151     MOVE '3'                        TO CP-PROCESS-TYPE
  3152     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3153     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3154     MOVE SPACES                     TO CP-ACCT-FLD-5
  3155     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  3156
  3157     IF CR-LFTYP = '00' OR '  '
  3158        CONTINUE
  3159     ELSE
  3160        PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
  3161     END-IF
  3162
  3163     IF CR-AHTYP = '00' OR '  '
  3164        CONTINUE
  3165     ELSE
  3166        PERFORM 0410-CALC-AH-UEP   THRU 0410-EXIT
  3167     END-IF
  3168
  3169     .
  3170
  3171 0200-EXIT.
  3172     EXIT.
  3173
  3174 0210-CALC-LIFE-UEP.
  3175
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL547.cbl
  3176*    DISPLAY ' MADE IT TO 0210 '
  3177     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3178        CONTINUE
  3179     ELSE
  3180        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3181            (CLAS-INDEXL = CLAS-MAXL) OR
  3182            (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
  3183        END-PERFORM
  3184        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3185           CONTINUE
  3186        ELSE
  3187           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3188           DISPLAY 'RETURN CODE - 0401'
  3189           MOVE 0401 TO WS-RETURN-CODE
  3190           PERFORM ABEND-PGM
  3191        END-IF
  3192     END-IF
  3193
  3194     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3195         (VYR > +600) OR
  3196         (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3197     END-PERFORM
  3198
  3199     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3200        CONTINUE
  3201     ELSE
  3202       PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3203         (VYR > +600) OR
  3204         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-LF-END-DATE)
  3205
  3206        PERFORM 0220-CALC-LF-REM-TERM
  3207                                 THRU 0220-EXIT
  3208        MOVE ZEROS               TO WS-REM-AMT
  3209        IF LF-REM-TRM2 > ZERO
  3210           PERFORM 2000-CALC-REM-AMT
  3211                                 THRU 2999-CALC-REM-AMT-X
  3212        END-IF
  3213        COMPUTE WS-LF-INFORCE (IYR VYR) =
  3214            WS-LF-INFORCE (IYR VYR) + WS-REM-AMT
  3215        PERFORM 0230-CALC-LF-UEP THRU 0230-EXIT
  3216       END-PERFORM
  3217     END-IF
  3218
  3219     .
  3220
  3221 0210-EXIT.
  3222     EXIT.
  3223
  3224 0220-CALC-LF-REM-TERM.
  3225
  3226*    DISPLAY ' MADE IT TO 0220 '
  3227     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3228
  3229     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3230                                 TO CP-BENEFIT-TYPE
  3231     MOVE CLAS-I-BAL (CLAS-INDEXL)
  3232                                 TO CP-SPECIAL-CALC-CD
  3233     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL547.cbl
  3234                                    CP-LOAN-TERM
  3235
  3236     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3237        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3238        ADD +1                   TO CP-ORIGINAL-TERM
  3239                                    CP-LOAN-TERM
  3240     END-IF
  3241
  3242     IF CP-TERM-IS-DAYS
  3243        MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3244     ELSE
  3245        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3246     END-IF
  3247
  3248     MOVE DTE-REM-TRM-CALC-OPTION
  3249                                 TO CP-REM-TRM-CALC-OPTION
  3250
  3251     PERFORM 0510-GET-REMAINING-TERM
  3252                                 THRU 0510-EXIT
  3253
  3254     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3255          CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3256*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3257        COMPUTE CP-REMAINING-TERM-1 =
  3258                       CP-REMAINING-TERM-1 - 1
  3259        COMPUTE CP-REMAINING-TERM-2 =
  3260                       CP-REMAINING-TERM-2 - 1
  3261     END-IF
  3262
  3263     IF CP-REMAINING-TERM-1 NEGATIVE
  3264         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3265     END-IF
  3266
  3267     IF CP-REMAINING-TERM-2 NEGATIVE
  3268         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3269     END-IF
  3270
  3271     MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  3272     MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  3273
  3274     .
  3275
  3276 0220-EXIT.
  3277     EXIT.
  3278
  3279 0230-CALC-LF-UEP.
  3280
  3281*    DISPLAY ' MADE IT TO 0230 '
  3282     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  3283     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3284     MOVE LF-REM-TRM1            TO CP-REMAINING-TERM
  3285     MOVE CLAS-I-EP (CLAS-INDEXL)
  3286                                 TO CP-EARNING-METHOD
  3287     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  3288     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3289                                 TO CP-BENEFIT-TYPE
  3290     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3291                                 TO CP-SPECIAL-CALC-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL547.cbl
  3292     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  3293     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  3294
  3295     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3296
  3297     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3298
  3299     MOVE DTE-R78                TO CP-R78-OPTION
  3300     MOVE SPACES                 TO CP-ACCT-FLD-5
  3301     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3302     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3303     MOVE CR-APR                 TO CP-LOAN-APR
  3304     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3305     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3306     MOVE CR-CARRIER             TO CP-CARRIER
  3307
  3308     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  3309        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  3310     END-IF
  3311
  3312     MOVE STATE-SUB (CLAS-INDEXS)
  3313                                 TO CP-STATE
  3314     MOVE STATE-ABBR (CLAS-INDEXS)
  3315                                 TO CP-STATE-STD-ABBRV
  3316     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3317     MOVE CR-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS
  3318
  3319     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3320
  3321     COMPUTE WS-LF-ST  (IYR VYR) =
  3322             WS-LF-ST  (IYR VYR) + CP-STATE-U-PRM
  3323     COMPUTE WS-LF-R78 (IYR VYR) =
  3324             WS-LF-R78 (IYR VYR) + CP-R78-U-PRM
  3325     COMPUTE WS-LF-PRO (IYR VYR) =
  3326             WS-LF-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3327
  3328*    IF (CR-DT > 19921231) AND
  3329*       (CR-DT < 19940101) AND
  3330*       (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3331*       MOVE CR-DT TO WS-DISPLAY-DATE
  3332*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3333*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3334*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3335*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3336*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3337*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3338*        WS-DISPLAY-PRM '   ' WS-DISPLAY-RAMT
  3339*    END-IF
  3340
  3341     .
  3342
  3343 0230-EXIT.
  3344     EXIT.
  3345
  3346 0410-CALC-AH-UEP.
  3347
  3348*    DISPLAY ' MADE IT TO 0410 '
  3349     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL547.cbl
  3350        CONTINUE
  3351     ELSE
  3352        PERFORM VARYING CLAS-INDEXA FROM CLAS-STARTA BY +1 UNTIL
  3353            (CLAS-INDEXA = CLAS-MAXA) OR
  3354            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3355        END-PERFORM
  3356        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3357           CONTINUE
  3358        ELSE
  3359           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3360           DISPLAY 'RETURN CODE - 0402'
  3361           MOVE 0402 TO WS-RETURN-CODE
  3362           PERFORM ABEND-PGM
  3363        END-IF
  3364     END-IF
  3365
  3366     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3367         (VYR > +600) OR
  3368         (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3369     END-PERFORM
  3370
  3371     PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3372         (VYR > +600) OR
  3373         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-AH-END-DATE)
  3374
  3375        PERFORM 0420-CALC-AH-REM-TERM THRU 0420-EXIT
  3376        PERFORM 0430-CALC-AH-UEP THRU 0430-EXIT
  3377
  3378     END-PERFORM
  3379
  3380     .
  3381
  3382 0410-EXIT.
  3383     EXIT.
  3384
  3385 0420-CALC-AH-REM-TERM.
  3386
  3387*    DISPLAY ' MADE IT TO 0420 '
  3388     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3389
  3390     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3391                                 TO CP-BENEFIT-TYPE
  3392     MOVE CLAS-I-BAL (CLAS-INDEXA)
  3393                                 TO CP-SPECIAL-CALC-CD
  3394     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3395                                    CP-LOAN-TERM
  3396
  3397     MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
  3398
  3399     MOVE DTE-REM-TRM-CALC-OPTION
  3400                                 TO CP-REM-TRM-CALC-OPTION
  3401
  3402     PERFORM 0510-GET-REMAINING-TERM
  3403                                 THRU 0510-EXIT
  3404
  3405     IF CP-REMAINING-TERM-1 NEGATIVE
  3406         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3407     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL547.cbl
  3408
  3409     IF CP-REMAINING-TERM-2 NEGATIVE
  3410         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3411     END-IF
  3412
  3413     MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  3414     MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  3415
  3416     .
  3417
  3418 0420-EXIT.
  3419     EXIT.
  3420
  3421 0430-CALC-AH-UEP.
  3422
  3423*    DISPLAY ' MADE IT TO 0430 '
  3424     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
  3425     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3426     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  3427                                    CP-RATING-BENEFIT-AMT
  3428     MOVE AH-REM-TRM1            TO CP-REMAINING-TERM
  3429     MOVE CLAS-I-EP (CLAS-INDEXA)
  3430                                 TO CP-EARNING-METHOD
  3431     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  3432     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3433                                 TO CP-BENEFIT-TYPE
  3434     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  3435                                 TO CP-SPECIAL-CALC-CD
  3436     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  3437     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  3438
  3439     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3440
  3441     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3442
  3443     MOVE DTE-R78                TO CP-R78-OPTION
  3444     MOVE SPACES                 TO CP-ACCT-FLD-5
  3445     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3446     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3447     MOVE CR-APR                 TO CP-LOAN-APR
  3448     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3449     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3450     MOVE CR-CARRIER             TO CP-CARRIER
  3451
  3452     MOVE STATE-SUB (CLAS-INDEXS)
  3453                                 TO CP-STATE
  3454     MOVE STATE-ABBR (CLAS-INDEXS)
  3455                                 TO CP-STATE-STD-ABBRV
  3456     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3457
  3458     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3459
  3460     COMPUTE WS-AH-R78 (IYR VYR) =
  3461             WS-AH-R78 (IYR VYR) + CP-R78-U-PRM
  3462     COMPUTE WS-AH-PRO (IYR VYR) =
  3463             WS-AH-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3464
  3465     IF CR-STATE = 'CA' OR 'OR' OR 'WA'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL547.cbl
  3466        COMPUTE WS-AH-ST (IYR VYR) =
  3467             WS-AH-ST (IYR VYR) + CP-PRORATA-U-PRM
  3468     ELSE
  3469        IF (CR-STATE = 'OH' OR 'TX')
  3470                    OR
  3471           ((CR-STATE = 'CO') AND
  3472           (CR-DT > + 19961231))
  3473           COMPUTE WS-AH-ST (IYR VYR) =
  3474             WS-AH-ST (IYR VYR) + ((CP-PRORATA-U-PRM +
  3475               CP-R78-U-PRM) * .5)
  3476        ELSE
  3477           COMPUTE WS-AH-ST (IYR VYR) =
  3478             WS-AH-ST  (IYR VYR) + CP-R78-U-PRM
  3479        END-IF
  3480     END-IF
  3481
  3482*    IF (CR-DT > 19971231) AND
  3483*       (CR-DT < 19990101) AND
  3484*       (WS-BIN-VAL-DATES (VYR) = X'947F')
  3485*       MOVE CR-DT TO WS-DISPLAY-DATE
  3486*       MOVE CR-AH-TERM TO WS-DISPLAY-TERM
  3487*       MOVE AH-REM-TRM1 TO WS-DISPLAY-RTERM
  3488*       MOVE CR-AHPRM TO WS-DISPLAY-PRM
  3489*       MOVE CP-R78-U-PRM TO WS-DISPLAY-UEP
  3490*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3491*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3492*        WS-DISPLAY-PRM '   ' WS-DISPLAY-UEP
  3493*    END-IF
  3494
  3495     .
  3496
  3497 0430-EXIT.
  3498     EXIT.
  3499
  3500 0500-EMPTY-TABLE.
  3501
  3502     DISPLAY ' MADE IT TO 0500 '
  3503     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3504             IYR > +600
  3505         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3506                VYR > +600
  3507             MOVE WS-ISSUE-CCYYMM (IYR)
  3508                                 TO EXT-ISSUE-CCYYMM
  3509             MOVE WS-VALUATION-CCYYMM (IYR VYR)
  3510                                 TO EXT-VALUE-CCYYMM
  3511             MOVE WS-LF-INFORCE (IYR VYR)
  3512                                 TO EXT-LF-INFORCE
  3513             MOVE WS-LF-WRITTEN (IYR VYR)
  3514                                 TO EXT-LF-WRITTEN
  3515             MOVE WS-AH-WRITTEN (IYR VYR)
  3516                                 TO EXT-AH-WRITTEN
  3517             MOVE WS-LF-REFUNDS (IYR VYR)
  3518                                 TO EXT-LF-REFUNDS
  3519             MOVE WS-AH-REFUNDS (IYR VYR)
  3520                                 TO EXT-AH-REFUNDS
  3521             MOVE WS-LF-R78     (IYR VYR)
  3522                                 TO EXT-LF-R78
  3523             MOVE WS-LF-PRO     (IYR VYR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL547.cbl
  3524                                 TO EXT-LF-PRO
  3525             MOVE WS-LF-ST      (IYR VYR)
  3526                                 TO EXT-LF-ST
  3527             MOVE WS-AH-R78     (IYR VYR)
  3528                                 TO EXT-AH-R78
  3529             MOVE WS-AH-PRO     (IYR VYR)
  3530                                 TO EXT-AH-PRO
  3531             MOVE WS-AH-ST      (IYR VYR)
  3532                                 TO EXT-AH-ST
  3533             MOVE WS-LF-CLAIM   (IYR VYR)
  3534                                 TO EXT-LF-CLAIM
  3535             MOVE WS-AH-CLAIM   (IYR VYR)
  3536                                 TO EXT-AH-CLAIM
  3537             IF (EXT-ISSUE-CCYYMM > EXT-VALUE-CCYYMM) OR
  3538                (ZERO = WS-LF-INFORCE (IYR VYR) AND
  3539                        WS-LF-ST      (IYR VYR) AND
  3540                        WS-AH-ST      (IYR VYR) AND
  3541                        WS-LF-CLAIM   (IYR VYR) AND
  3542                        WS-AH-CLAIM   (IYR VYR) AND
  3543                        WS-LF-REFUNDS (IYR VYR) AND
  3544                        WS-AH-REFUNDS (IYR VYR))
  3545                CONTINUE
  3546             ELSE
  3547                WRITE EXTRACT-RECORD
  3548             END-IF
  3549         END-PERFORM
  3550     END-PERFORM
  3551
  3552     .
  3553
  3554 0500-EXIT.
  3555     EXIT.
  3556
  3557 0510-GET-REMAINING-TERM.
  3558
  3559*    DISPLAY ' MADE IT TO 0510 '
  3560     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  3561
  3562     .
  3563
  3564 0510-EXIT.
  3565     EXIT.
  3566
  3567
  3568 2000-CALC-REM-AMT.
  3569
  3570*    DISPLAY ' MADE IT TO 2000 '
  3571     IF CR-LFTYP = 'QD'
  3572        MOVE +15.0               TO CR-APR
  3573     END-IF
  3574
  3575     MOVE +0                     TO WS-REM-AMT
  3576     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  3577        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3578           COMPUTE WS-REM-AMT =
  3579             CR-LFAMT + CR-LFAMT-ALT
  3580        ELSE
  3581           MOVE CR-LFAMT         TO WS-REM-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL547.cbl
  3582        END-IF
  3583        GO TO 2900-DISPLAY-AMTS
  3584     END-IF
  3585
  3586     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
  3587
  3588     IF LF-REM-TRM2 = CR-LF-TERM
  3589        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3590           COMPUTE WS-REM-AMT =
  3591             CR-LFAMT + CR-LFAMT-ALT
  3592        ELSE
  3593           MOVE CR-LFAMT         TO WS-REM-AMT
  3594        END-IF
  3595        GO TO 2900-DISPLAY-AMTS
  3596     END-IF
  3597
  3598     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3599        GO TO 2010-ORDINARY-REM
  3600     END-IF
  3601
  3602     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  3603        GO TO 2020-CALC-TEXAS-REM
  3604     END-IF
  3605
  3606     IF CR-LFTYP = 'QD'
  3607        MOVE +15.0               TO CR-APR
  3608        MOVE 'N'                 TO
  3609                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3610        GO TO 2030-CALC-NET-PAY-REM
  3611     END-IF
  3612
  3613     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  3614        GO TO 2030-CALC-NET-PAY-REM
  3615     END-IF
  3616
  3617     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  3618        (CR-RATING-CLASS NOT = 'L ')
  3619         IF (CR-LF-TERM GREATER THAN +60) AND
  3620            (CR-DT GREATER THAN 19831031) AND
  3621            (CR-APR GREATER THAN ZERO)
  3622             GO TO 2030-CALC-NET-PAY-REM
  3623        END-IF
  3624     END-IF
  3625
  3626     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  3627         IF (CR-LF-TERM GREATER THAN +61) AND
  3628            (CR-DT  GREATER THAN 19830318) AND
  3629            (CR-APR GREATER THAN ZERO)
  3630             GO TO 2030-CALC-NET-PAY-REM
  3631        END-IF
  3632     END-IF
  3633
  3634     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  3635         IF (CR-LF-TERM GREATER THAN +62) AND
  3636            (CR-DT  GREATER THAN 19810831) AND
  3637            (CR-DT  LESS THAN 19830901) AND
  3638            (CR-APR GREATER THAN ZERO)
  3639             GO TO 2030-CALC-NET-PAY-REM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL547.cbl
  3640        END-IF
  3641     END-IF
  3642
  3643     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  3644         IF (CR-LF-TERM GREATER THAN +60) AND
  3645            (CR-DT  GREATER THAN 19831231) AND
  3646            (CR-APR GREATER THAN ZERO)
  3647             GO TO 2030-CALC-NET-PAY-REM
  3648        END-IF
  3649     END-IF
  3650
  3651     .
  3652 2010-ORDINARY-REM.
  3653
  3654*    DISPLAY ' MADE IT TO 2010 '
  3655     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3656         COMPUTE WS-REM-AMT ROUNDED =
  3657                  (INTERMED * LF-REM-TRM2) + CR-LFAMT-ALT
  3658     ELSE
  3659         COMPUTE WS-REM-AMT ROUNDED = INTERMED * LF-REM-TRM2
  3660     END-IF
  3661
  3662     GO TO 2900-DISPLAY-AMTS
  3663
  3664     .
  3665 2020-CALC-TEXAS-REM.
  3666
  3667*    DISPLAY ' MADE IT TO 2020 '
  3668
  3669     IF (CR-LF-TERM = ZEROS)
  3670        OR (CR-PMT-FREQ = ZEROS)
  3671        DISPLAY ' ZEROS KEY = ' CR-FULL-CONTROL
  3672        '  PMT FREQ = ' CR-PMT-FREQ
  3673        '  LF TERM  = ' CR-LF-TERM
  3674        MOVE ZEROS               TO WS-REM-AMT
  3675        GO TO 2900-DISPLAY-AMTS
  3676     END-IF
  3677
  3678     IF (CR-LF-TERM NOT = ZEROS)
  3679        AND (CR-PMT-FREQ) NOT = ZEROS
  3680     DIVIDE CR-LFAMT BY CR-LF-TERM
  3681         GIVING TEX-FACT-1.
  3682     DIVIDE LF-REM-TRM2 BY CR-PMT-FREQ
  3683         GIVING TEX-FACT-2
  3684         REMAINDER TEX-FACT-3.
  3685
  3686     IF TEX-FACT-3 NOT = ZERO
  3687         ADD +1                  TO TEX-FACT-2
  3688     END-IF
  3689
  3690     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  3691         MOVE CR-LFAMT           TO WS-REM-AMT
  3692     ELSE
  3693         COMPUTE WS-REM-AMT ROUNDED =
  3694             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
  3695     END-IF
  3696
  3697     GO TO 2900-DISPLAY-AMTS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL547.cbl
  3698
  3699     .
  3700 2030-CALC-NET-PAY-REM.
  3701
  3702*    DISPLAY ' MADE IT TO 2030 '
  3703     MOVE WS-BIN-CR-DT           TO  CP-CERT-EFF-DT
  3704
  3705     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  3706        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  3707        MOVE '3'                 TO  DC-OPTION-CODE
  3708        PERFORM 8510-DATE-CONVERSION
  3709                                 THRU 8590-EXIT
  3710        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  3711     ELSE
  3712        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  3713        MOVE +1                  TO  DC-ELAPSED-MONTHS
  3714        MOVE +0                  TO  DC-ELAPSED-DAYS
  3715        MOVE '6'                 TO  DC-OPTION-CODE
  3716        PERFORM 8510-DATE-CONVERSION
  3717                                 THRU 8590-EXIT
  3718        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  3719     END-IF
  3720
  3721     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3722        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
  3723     ELSE
  3724        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
  3725     END-IF
  3726     MOVE CR-APR                 TO  CP-LOAN-APR
  3727     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
  3728     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
  3729     MOVE LF-REM-TRM2            TO  CP-REMAINING-TERM
  3730     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3731                                 TO CP-SPECIAL-CALC-CD
  3732     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3733                                 TO  CP-BENEFIT-TYPE
  3734     MOVE CLAS-I-EP (CLAS-INDEXL)
  3735                                 TO  CP-EARNING-METHOD
  3736
  3737     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
  3738
  3739     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
  3740
  3741     .
  3742 2900-DISPLAY-AMTS.
  3743
  3744*    DISPLAY ' MADE IT TO 2900 '
  3745*    IF (CR-DT > 19921231) AND
  3746*       (CR-DT < 19940101) AND
  3747*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3748*       MOVE CR-DT TO WS-DISPLAY-DATE
  3749*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3750*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3751*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3752*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  3753*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  3754*       ELSE
  3755*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL547.cbl
  3756*       END-IF
  3757*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3758*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3759*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3760*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  3761*    END-IF
  3762
  3763     .
  3764 2999-CALC-REM-AMT-X.
  3765     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* EL547.cbl
  3767 8510-DATE-CONVERSION.
  3768
  3769*    DISPLAY ' MADE IT TO 8510 '
  3770     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  3771
  3772     .
  3773
  3774 8590-EXIT.
  3775     EXIT.
  3776
  3777
  3778
  3779
  3780 ABEND-PGM.
* 3781                                 COPY ELCABEND.
  3782***************************************************************** 04/14/98
  3783*                                                               * ELCABEND
  3784*                            ELCABEND.                          *    LV003
  3785*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3786*                            VMOD 2.002                              CL**2
  3787*                                                               * ELCABEND
  3788*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  3789*            AND THEN ABENDS.                                   * ELCABEND
  3790*                                                               * ELCABEND
  3791*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  3792*                                                               * ELCABEND
  3793***************************************************************** ELCABEND
  3794*APS-010.                                                         ELCABEND
  3795     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  3796     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  3797                                                                  ELCABEND
  3798     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  3799         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3800         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  3801                                 UPON CONSOLE.                    ELCABEND
  3802                                                                  ELCABEND
  3803     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  3804         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3805         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  3806                                 UPON CONSOLE.                    ELCABEND
  3807                                                                  ELCABEND
  3808     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3809     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  3810                                 UPON CONSOLE.                    ELCABEND
  3811                                                                  ELCABEND
  3812     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  3813     CALL 'ABORTME'.
  3814                                                                  ELCABEND
  3815 APS-EXIT.                                                        ELCABEND
  3816     EXIT.                                                        ELCABEND
  3817
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:    31017088     Code:       10918
