* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB183.cbl
* Options: int("FNB183.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB183.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB183.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB183.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   2
* FNB183.cbl
     2                                                                  00020000
     3 IDENTIFICATION DIVISION.                                         00030000
     4 PROGRAM-ID.    FNB183.                                           00040000
     5 AUTHOR.        DAN DRYDEN.                                       00050000
     6 DATE-WRITTEN.  NOVEMBER, 1998.                                   00060000
     7                                                                  00070000
     8******************************************************************00080000
     9*                                                                *00090000
    10*    TRANSFER CSO FREEDOM/AP CHECK RECORDS TO MICR DRAFT FILE    *00100000
    11*                                                                *00110000
    12******************************************************************00120000
    13*                        H I S T O R Y                           *00130000
    14******************************************************************00140000
    15*    DATE    NAME DESCRIPTION                                    *00150005
    16* ---------- ---- ---------------------------------------------- *00160005
    17* 03/12/1999 DANA FLAG NEGATIVE INVOICE AMOUNTS AS "CR"          *00170005
    18* 03/12/1999 DANA FIX MULITPLE INVOICE PROBLEM  IR#1999031000010 *00180005
    19* 03/10/2000 DANA CR#2000022300004 - FORM NUMBER FROM PARM       *00190005
    20* 04/01/2000 DJNA CR#2000030100009 - DRAFT NUMBER EXPANSION      *00200005
    21* 03/02/2001 DANA IR#2001022300005 - SKIP BAD RECORDS            *00201007
    22* 06/14/2002 SMVA CR#2002031800003 - ADD CENSTAT LIFE (FORM CEN3)
    23*                          CHANGE MICR0031 COPYBOOK TO FNMICR
    24*                          ADD SYS008 IN PLACE OF DISPLAY COMMANDS
    25*                          FOR SUMMARY INFORMATION
    26*                          MOVE PROGRAM FROM MAINFRAME TO LAN
    27* 09/20/2002 SMVA                  - MOVE TO UNIX
    28*                                  - HANDLE FILE STATUS '35'
    29* 09/23/2002 SMVA                  - REMOVE MICR-STATUS CODE
    30* 09/24/2002 SMVA CR#2002082600004 - ADD FORMS CEN4,CEN5,LPA1,LMB1
    31* 10/07/2002 SMVA CR#2002100700003 - ADD VOIDS TO PROCESS
    32* 08/01/2003 SMVA CR#2003052100011 - REPLACE FORM 0031 WITH CSO1
    33* 11/21/2005 AJRA CR#2005111400002 - ADD FORM CSO2
    34* 05/23/2006 AJRA CR#2006051800001 - ADD FORM CSO3
    35******************************************************************00210000
    36                                                                  00220000
    37 ENVIRONMENT DIVISION.                                            00230000
    38 INPUT-OUTPUT SECTION.                                            00240000
    39 FILE-CONTROL.                                                    00250000
    40                                                                  00260000
    41     SELECT CSO-CHECK-FILE                                        00270000
    42         ASSIGN TO SYS010
    43         ORGANIZATION IS LINE SEQUENTIAL                          00280000
    44         FILE STATUS IS SYS010-STATUS.                            00290000
    45                                                                  00300000
    46     SELECT MICR-DRAFT-FILE                                       00310000
    47         ASSIGN TO MICRDRFT
    48         ORGANIZATION IS LINE SEQUENTIAL.
    49
    50     SELECT MICR-TRNSFR-FILE                                      00310000
    51         ASSIGN TO TRNSFR
    52         ORGANIZATION IS LINE SEQUENTIAL.
    53
    54     SELECT PRINTER-OUTPUT
    55         ASSIGN TO SYS008.                                        00350000
    56                                                                  00370000
    57                                                                  00380000
    58 DATA DIVISION.                                                   00390000
    59 FILE SECTION.                                                    00400000
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   3
* FNB183.cbl
    60                                                                  00410000
    61 FD  CSO-CHECK-FILE                                               00420000
    62     LABEL RECORDS ARE STANDARD                                   00430000
    63     RECORDING MODE IS F                                          00440000
    64     BLOCK CONTAINS 0 RECORDS.                                    00460000
*   65                          COPY FNC030.                            00471011
    66*****************************************************************
    67*                                                               *
    68*             CSO ACCOUNTS PAYABLE CHECK RECORD                 *
    69*                                                               *
    70*****************************************************************
    71*
    72 01  AP-CHECK-RECORD.
    73*
    74     05  AP-NAME               PIC X(50).
    75     05  AP-ADDRESS-1          PIC X(50).
    76     05  AP-ADDRESS-2          PIC X(50).
    77     05  AP-ADDRESS-3          PIC X(50).
    78     05  AP-ADDRESS-4          PIC X(50).
    79     05  AP-CHECK-NO           PIC X(10).
    80     05  AP-CHECK-DATE.
    81         10  AP-CHECK-YR       PIC X(4).
    82         10  AP-CHECK-MO       PIC XX.
    83         10  AP-CHECK-DA       PIC XX.
    84     05  AP-CHECK-AMT          PIC 9(9)V99.
    85     05  AP-CHECK-SGN          PIC X.
    86     05  AP-INVOICE-DATA.
    87         10  AP-INVOICE-NO     PIC X(12).
    88         10  AP-INVOICE-AMT    PIC 9(9)V99.
    89         10  AP-INVOICE-SGN    PIC X.
    90         10  AP-PO-NO          PIC X(24).
    91         10  AP-REF            PIC X(30).
    92     05  AP-VENDOR-ID          PIC X(10).
    93     05  AP-VOID-DATE          PIC 9(08).
    94     05  FILLER                PIC X(137).
    95
    96                                                                  00480000
    97 FD  MICR-DRAFT-FILE                                              00490000
    98*    RECORD IS VARYING FROM 1836 TO 3000 CHARACTERS.              00500005
    99     RECORD IS VARYING FROM 430 TO 1858 CHARACTERS.
   100 01  MICR-DRAFT-RECORD    PIC X(1858).                            00510000
   101*    05  MICR-KEY         PIC X(0019).                            00520005
   102*    05  FILLER           PIC X(1817).                            00530000
   103*01  FILLER               PIC X(3000).                            00540000
   104                                                                  00550000
   105 FD  MICR-TRNSFR-FILE                                             00490000
   106     RECORD IS VARYING FROM 430 TO 1858 CHARACTERS.
   107 01  MICR-TRNSFR-RECORD   PIC X(1858).
   108
   109 FD  PRINTER-OUTPUT
*  110                          COPY ELCPRTFD.
   111******************************************************************04/15/98
   112*                                                                *ELCPRTFD
   113*                                                                *ELCPRTFD
   114*                            ELCPRTFD.                           *   LV003
   115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   116*                            VMOD=2.006                          *ELCPRTFD
   117******************************************************************ELCPRTFD
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   4
* FNB183.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
   118     RECORDING MODE F                                             ELCPRTFD
   119     LABEL RECORDS OMITTED                                        ELCPRTFD
   120     BLOCK CONTAINS 0 RECORDS
   121     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   122 01  PRT.                                                         ELCPRTFD
   123     12  P-CTL               PIC  X.                                 CL**2
   124     12  P-DATA              PIC  X(132).                         ELCPRTFD
   125******************************************************************ELCPRTFD
   126                                                                  00570000
   127 WORKING-STORAGE SECTION.                                         00580000
   128                                                                  00590000
   129 01  FILLER                  BINARY.                              00600000
   130     05  SUB                 PIC S9(4)     VALUE +0.              00610000
   131                                                                  00620000
   132 01  FILLER                  COMP-3.                              00630000
   133     05  INPUT-COUNT         PIC S9(7)     VALUE +0.              00640000
   134         88  FIRST-RECORD                  VALUE +1.              00650000
   135     05  INPUT-AMT           PIC S9(9)V99  VALUE +0.              00660000
   136     05  PRINT-COUNT         PIC S9(7)     VALUE +0.              00670000
   137     05  PRINT-AMT           PIC S9(9)V99  VALUE +0.              00680000
   138     05  VOID-COUNT          PIC S9(7)     VALUE +0.              00690000
   139     05  SEQ-NO              PIC S9(5)     VALUE +0.              00700000
   140     05  WS-AMOUNT-PAID      PIC S9(9)V99  VALUE +0.
   141     05  WS-NO-OF-INVOICES   PIC S9(3)     VALUE +0.
   142
   143 01  FILLER.                                                      00720000
   144*    05  S0C7                PIC X      VALUE ' '.                00730000
   145     05  SYS010-STATUS       PIC XX     VALUE '00'.               00750000
   146         88  EOF                        VALUE '10' '47'.          00760000
   147*    05  MICR-STATUS         PIC XX     VALUE '00'.               00770000
   148     05  WS-FIRST-VOID-SW    PIC X(01)  VALUE 'Y'.
   149         88  FIRST-VOID                 VALUE 'Y'.
   150         88  VOIDS-PROCESSED            VALUE 'N'.
   151     05  PREV-CHECK-NO       PIC X(10)  VALUE SPACE.              00780001
   152     05  FIRST-CHECK         PIC X(10)  JUSTIFIED RIGHT.          00790005
   153     05  PRT-DATE            PIC X(10).                           00800000
   154     05  PRT-TIME            PIC X(8).                            00810000
   155     05  ED-AMT              PIC ZZZ,ZZZ,ZZZ.99-.                 00820000
   156     05  ED-CNT              PIC ZZ,ZZZ,ZZZ,ZZ9-.                 00830000
   157     05  VOID-NAME           PIC X(46)  VALUE                     00840000
   158         'VOID   VOID   VOID   VOID   VOID   VOID   VOID'.        00850000
   159     05  WS-CHECK-DATE.                                           00860000
   160*        10  SAVE-CHECK-MO   PIC XX.                              00870001
   161         10  WS-CHECK-MO     PIC XX.                              00870001
   162         10  FILLER          PIC X       VALUE '/'.               00880000
   163*        10  SAVE-CHECK-DA   PIC XX.                              00890001
   164         10  WS-CHECK-DA     PIC XX.                              00890001
   165         10  FILLER          PIC X       VALUE '/'.               00900000
   166*        10  SAVE-CHECK-YR   PIC XXXX.                            00910001
   167         10  WS-CHECK-YR     PIC XXXX.                            00910001
   168     05  WS-TIME             PIC 9(8).                            00920000
   169     05  REDEFINES WS-TIME.                                       00930000
   170         10  WS-HH           PIC XX.                              00940000
   171         10  WS-MI           PIC XX.                              00950000
   172         10  WS-SE           PIC XX.                              00960000
   173         10  WS-MS           PIC XX.                              00970000
   174     05  WS-DATE             PIC 9(06).                           00980000
   175                                                                  00980000
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   5
* FNB183.cbl
   176     05  REDEFINES WS-DATE.
   177         10  WS-YR           PIC XX.                              01000000
   178         10  WS-MO           PIC XX.                              01010000
   179         10  WS-DAY          PIC XX.                              01020000
   180                                                                  01030000
   181                                                                  01040000
   182 01  WS-WORK-RECORD.                                              01050000
*  183     COPY FNMICR.                                                 01060004
   184       10 FNMICR-FORM               PIC X(04).
   185       10 FNMICR-DRAFT-ORDER        PIC 9(05).
   186       10 FNMICR-DRAFT-NO           PIC 9(10).
   187       10 FNMICR-AMOUNT-PAID        PIC ZZZ,ZZZ,ZZ9.99.
   188       10 FNMICR-CHECK-DATE         PIC X(10).
   189       10 FNMICR-PAYEE-NAME         PIC X(50).
   190       10 FNMICR-PAYEE-ADDRESS1     PIC X(50).
   191       10 FNMICR-PAYEE-ADDRESS2     PIC X(50).
   192       10 FNMICR-PAYEE-ADDRESS3     PIC X(50).
   193       10 FNMICR-PAYEE-ADDRESS4     PIC X(50).
   194       10 FILLER                    PIC X(04).
   195       10 FNMICR-VENDOR-NO          PIC X(10).
   196       10 FNMICR-VOID-SW            PIC X(01).
   197       10 FNMICR-NO-OF-INVOICES     PIC 9(03).
   198       10 FNMICR-INVOICE-DATA       OCCURS 15 TIMES.
   199          15  FNMICR-INV-DATE       PIC X(10).
   200          15  FNMICR-INV-NO         PIC X(16).
   201          15  FNMICR-INV-TYPE       PIC X(02).
   202          15  FNMICR-INV-AMT        PIC ZZZ,ZZZ,ZZZ.99.
   203          15  FNMICR-INV-MSG        PIC X(60).
   204                                                                  01070000
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   6
* FNB183.cbl
   205/                                                                 01080000
   206 01  SAVE-DATA                 VALUE SPACES.                      01090001
   207     05  SAVE-NAME             PIC X(50).                         01100001
   208     05  SAVE-ADDRESS-1        PIC X(50).                         01110001
   209     05  SAVE-ADDRESS-2        PIC X(50).                         01120001
   210     05  SAVE-ADDRESS-3        PIC X(50).                         01130001
   211     05  SAVE-ADDRESS-4        PIC X(50).                         01140001
   212     05  SAVE-CHECK-NO         PIC X(10).                         01150001
   213     05  SAVE-CHECK-DATE.                                         01160001
   214         10  SAVE-CHECK-YR     PIC X(4).                          01170001
   215         10  SAVE-CHECK-MO     PIC X(2).                          01180001
   216         10  SAVE-CHECK-DA     PIC X(2).                          01190001
   217     05  SAVE-CHECK-AMT        PIC S9(8)V99                       01200001
   218                               SIGN TRAILING SEPARATE.
   219
   220
   221 01  WS-PRTCHK-SUMMARY-LINE1.
   222     05  FILLER                PIC X(01)      VALUE '1'.
   223     05  WS-PRTCHK-HEADER      PIC X(60)      VALUE SPACES.
   224
   225 01  WS-PRTCHK-SUMMARY-LINE2.
   226     05  FILLER                PIC X(01)      VALUE ' '.
   227     05  FILLER                PIC X(23)      VALUE
   228         'TOTAL CHECKS PRINTED:  '.
   229     05  FILLER                PIC X(15)      VALUE SPACES.
   230     05  WS-PRTCHK-CNT         PIC ZZ,ZZZ,ZZZ,ZZ9-.
   231
   232 01  WS-PRTCHK-SUMMARY-LINE3.
   233     05  FILLER                PIC X(01)      VALUE ' '.
   234     05  FILLER                PIC X(22)      VALUE
   235         'TOTAL DOLLAR AMOUNT:  '.
   236     05  FILLER                PIC X(16)      VALUE SPACES.
   237     05  WS-PRTCHK-TOTAL-AMT   PIC $$Z,ZZZ,ZZZ.99-.
   238
   239 01  WS-PRTCHK-SUMMARY-LINE4.
   240     05  FILLER                PIC X(01)      VALUE ' '.
   241     05  FILLER                PIC X(16)      VALUE
   242         'CHECKS VOIDED:  '.
   243     05  FILLER                PIC X(22)      VALUE SPACES.
   244     05  WS-PRTCHK-VOID-CNT    PIC ZZ,ZZZ,ZZZ,ZZ9-.
   245
   246 01  WS-PRTCHK-SUMMARY-LINE5.
   247     05  FILLER                PIC X(01)      VALUE ' '.
   248     05  FILLER                PIC X(17)      VALUE
   249         'FIRST CHECK NO:  '.
   250     05  FILLER                PIC X(21)      VALUE SPACES.
   251     05  WS-PRTCHK-FIRST-NO    PIC X(10).
   252
   253 01  WS-PRTCHK-SUMMARY-LINE6.
   254     05  FILLER                PIC X(01)      VALUE ' '.
   255     05  FILLER                PIC X(16)      VALUE
   256         'LAST CHECK NO:  '.
   257     05  FILLER                PIC X(22)      VALUE SPACES.
   258     05  WS-PRTCHK-LAST-NO     PIC X(10).
   259
   260 01  WS-PRTCHK-SUMMARY-LINE7.
   261     05  FILLER                PIC X(01)      VALUE ' '.
   262     05  FILLER                PIC X(20)      VALUE
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   7
* FNB183.cbl
   263         'CHECKS PRINTED ON:  '.
   264     05  FILLER                PIC X(18)      VALUE SPACES.
   265     05  WS-PRTCHK-DATE        PIC X(10).
   266     05  FILLER                PIC X(04)      VALUE
   267         ' AT '.
   268     05  WS-PRTCHK-TIME        PIC X(08).
   269                                                                  01240000
   270                                                                  01250004
   271 LINKAGE SECTION.                                                 01260004
   272                                                                  01270004
   273 01  PARM.                                                        01280004
   274     05  PARM-LENGTH    PIC S9(4) BINARY.                         01290004
   275     05  PARM-FORM      PIC X(4).                                 01300004
   276                                                                  01310004
   277                                                                  01340004
   278*                                                                 01350004
   279 PROCEDURE DIVISION USING PARM.                                   01360004
   280*                                                                 01370000
   281     PERFORM 0000-INIT THRU 0000-EXIT                             01380000
   282
   283***** Status 35 is file not present
   284     IF SYS010-STATUS NOT = '35'
   285         PERFORM 1000-PROCESS-FILE THRU 1000-EXIT UNTIL EOF
   286         PERFORM 9000-END THRU 9000-EXIT
   287     END-IF
   288                                                                  01430000
   289     GOBACK.                                                      01440000
   290                                                                  01450000
   291                                                                  01470000
   292 1000-PROCESS-FILE.                                               01480000
   293
   294     INITIALIZE AP-CHECK-RECORD
   295
   296***** End of file is set when SYS010-STATUS is 10 or 47
   297*****   47 occurs when void file is not present
   298     READ CSO-CHECK-FILE                                          01500000
   299        AT END GO TO 1000-EXIT
   300     END-READ
   301
   302     IF SYS010-STATUS = '47'
   303        MOVE SAVE-CHECK-NO            TO WS-PRTCHK-LAST-NO
   304        GO TO 1000-EXIT
   305     END-IF
   306
   307     IF AP-CHECK-AMT NOT NUMERIC                                  01510109
   308        DISPLAY 'CHECK-AMT IS ' AP-CHECK-AMT
   309        GO TO 1000-EXIT
   310     END-IF
   311
   312     IF AP-VOID-DATE = SPACES  OR
   313        AP-VOID-DATE = ZEROS   OR
   314        AP-VOID-DATE = LOW-VALUES
   315        CONTINUE
   316     ELSE
   317        IF FIRST-VOID
   318            MOVE SAVE-CHECK-NO        TO WS-PRTCHK-LAST-NO
   319            PERFORM 2000-BUILD-CHECK  THRU 2000-EXIT
   320            PERFORM 4000-WRITE-MICR   THRU 4000-EXIT
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   8
* FNB183.cbl
   321            WRITE MICR-TRNSFR-RECORD  FROM WS-WORK-RECORD
   322            SET VOIDS-PROCESSED       TO TRUE
   323        END-IF
   324
   325        ADD +1                      TO VOID-COUNT
   326        MOVE 'V'                    TO FNMICR-VOID-SW
   327        MOVE PARM-FORM              TO FNMICR-FORM
   328        MOVE AP-CHECK-NO            TO FNMICR-DRAFT-NO
   329        MOVE AP-CHECK-AMT           TO FNMICR-AMOUNT-PAID
   330        MOVE AP-CHECK-YR            TO WS-CHECK-YR
   331        MOVE AP-CHECK-MO            TO WS-CHECK-MO
   332        MOVE AP-CHECK-DA            TO WS-CHECK-DA
   333        MOVE WS-CHECK-DATE          TO FNMICR-CHECK-DATE
   334        MOVE AP-NAME                TO FNMICR-PAYEE-NAME
   335        MOVE AP-ADDRESS-1           TO FNMICR-PAYEE-ADDRESS1
   336        MOVE AP-ADDRESS-2           TO FNMICR-PAYEE-ADDRESS2
   337        MOVE AP-ADDRESS-3           TO FNMICR-PAYEE-ADDRESS3
   338        MOVE AP-ADDRESS-4           TO FNMICR-PAYEE-ADDRESS4
   339        PERFORM 2100-ADJUST-ADDRESS THRU 2100-EXIT
   340        WRITE MICR-TRNSFR-RECORD    FROM WS-WORK-RECORD
   341        MOVE SPACE                  TO FNMICR-VOID-SW
   342        GO TO 1000-EXIT
   343     END-IF
   344
   345     ADD +1 TO INPUT-COUNT                                        01520000
   346     IF AP-CHECK-SGN = '-'                                        01521009
   347        SUBTRACT AP-CHECK-AMT FROM INPUT-AMT                      01522011
   348        DISPLAY 'NEGATIVE AMT: '                                  01523009
   349                 AP-CHECK-NO '   ' AP-CHECK-AMT ' ' AP-CHECK-SGN  01524009
   350     ELSE                                                         01531009
   351        ADD AP-CHECK-AMT TO INPUT-AMT                             01531109
   352     END-IF                                                       01533009
   353                                                                  01540000
   354     IF FIRST-RECORD                                              01550000
   355        MOVE AP-CHECK-NO TO PREV-CHECK-NO                         01560000
   356        MOVE AP-CHECK-NO TO FIRST-CHECK                           01570000
   357        MOVE AP-CHECK-RECORD TO SAVE-DATA                         01580002
   358        MOVE +0 TO SAVE-CHECK-AMT                                 01590002
   359        PERFORM 3100-INIT-INVOICE THRU 3100-EXIT                  01600003
   360     END-IF                                                       01610000
   361
   362     IF AP-CHECK-NO NOT = PREV-CHECK-NO                           01630000
   363        PERFORM 2000-BUILD-CHECK  THRU 2000-EXIT
   364        PERFORM 4000-WRITE-MICR   THRU 4000-EXIT                  01650003
   365        WRITE MICR-TRNSFR-RECORD  FROM WS-WORK-RECORD
   366        PERFORM 3100-INIT-INVOICE THRU 3100-EXIT                  01660003
   367        MOVE AP-CHECK-RECORD TO SAVE-DATA                         01670003
   368        MOVE +0 TO SAVE-CHECK-AMT                                 01680003
   369     END-IF                                                       01690000
   370                                                                  01700000
   371     PERFORM 3000-BUILD-INVOICE THRU 3000-EXIT                    01710000
   372
   373     MOVE AP-CHECK-NO TO PREV-CHECK-NO                            01730000
   374
   375     .                                                            01740000
   376 1000-EXIT.                                                       01750000
   377     EXIT.                                                        01760000
   378                                                                  01770001
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page   9
* FNB183.cbl
   379                                                                  01800000
   380 2000-BUILD-CHECK.                                                01810000
   381*                                                                 01820000
   382     MOVE PARM-FORM              TO FNMICR-FORM                   01840004
   383
   384     ADD +1                      TO SEQ-NO                        01850001
   385     MOVE SEQ-NO                 TO FNMICR-DRAFT-ORDER            01860001
   386     MOVE SAVE-CHECK-NO          TO FNMICR-DRAFT-NO               01880001
   387     MOVE SAVE-CHECK-AMT         TO FNMICR-AMOUNT-PAID
   388     MOVE SAVE-CHECK-AMT         TO WS-AMOUNT-PAID                01900001
   389     MOVE +0                     TO SAVE-CHECK-AMT                01910001
   390     MOVE SAVE-CHECK-YR          TO WS-CHECK-YR
   391     MOVE SAVE-CHECK-MO          TO WS-CHECK-MO
   392     MOVE SAVE-CHECK-DA          TO WS-CHECK-DA
   393     MOVE WS-CHECK-DATE          TO FNMICR-CHECK-DATE             01930001
   394     MOVE SAVE-NAME              TO FNMICR-PAYEE-NAME             01960001
   395     MOVE SAVE-ADDRESS-1         TO FNMICR-PAYEE-ADDRESS1         01970001
   396     MOVE SAVE-ADDRESS-2         TO FNMICR-PAYEE-ADDRESS2         01980001
   397     MOVE SAVE-ADDRESS-3         TO FNMICR-PAYEE-ADDRESS3         01990001
   398     MOVE SAVE-ADDRESS-4         TO FNMICR-PAYEE-ADDRESS4         02000001
   399     PERFORM 2100-ADJUST-ADDRESS THRU 2100-EXIT                   02010000
   400     .                                                            02020000
   401 2000-EXIT.                                                       02030000
   402     EXIT.                                                        02040000
   403                                                                  02050000
   404                                                                  02060000
   405                                                                  02070000
   406 2100-ADJUST-ADDRESS.                                             02080000
   407*                                                                 02090000
   408*  THIS ROUTINE SHIFTS THE ADDRESS LINES SO THAT THERE ARE NO
   409*  BLANK LINES BETWEEN ADDRESS LINES.
   410*
   411     IF FNMICR-PAYEE-ADDRESS1 = SPACE
   412         IF FNMICR-PAYEE-ADDRESS2 NOT = SPACE
   413             MOVE FNMICR-PAYEE-ADDRESS2
   414                                         TO FNMICR-PAYEE-ADDRESS1
   415             MOVE SPACES                 TO FNMICR-PAYEE-ADDRESS2
   416         ELSE
   417             IF FNMICR-PAYEE-ADDRESS3 NOT = SPACE
   418                 MOVE FNMICR-PAYEE-ADDRESS3
   419                                         TO FNMICR-PAYEE-ADDRESS1
   420                 MOVE SPACES             TO FNMICR-PAYEE-ADDRESS3
   421             ELSE
   422                 IF FNMICR-PAYEE-ADDRESS4 NOT = SPACE
   423                     MOVE FNMICR-PAYEE-ADDRESS4
   424                                         TO FNMICR-PAYEE-ADDRESS1
   425                     MOVE SPACES         TO FNMICR-PAYEE-ADDRESS4
   426                 ELSE
   427                     GO TO 2100-EXIT
   428                 END-IF
   429             END-IF
   430         END-IF
   431     END-IF
   432
   433     IF FNMICR-PAYEE-ADDRESS2 = SPACE
   434         IF FNMICR-PAYEE-ADDRESS3 NOT = SPACE
   435             MOVE FNMICR-PAYEE-ADDRESS3
   436                                         TO FNMICR-PAYEE-ADDRESS2
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page  10
* FNB183.cbl
   437             MOVE SPACES                 TO FNMICR-PAYEE-ADDRESS3
   438         ELSE
   439             IF FNMICR-PAYEE-ADDRESS4 NOT = SPACE
   440                 MOVE FNMICR-PAYEE-ADDRESS4
   441                                         TO FNMICR-PAYEE-ADDRESS2
   442                 MOVE SPACES             TO FNMICR-PAYEE-ADDRESS4
   443             END-IF
   444         END-IF
   445     END-IF
   446
   447     IF FNMICR-PAYEE-ADDRESS3 = SPACE
   448         IF FNMICR-PAYEE-ADDRESS4 NOT = SPACE
   449             MOVE FNMICR-PAYEE-ADDRESS4
   450                                         TO FNMICR-PAYEE-ADDRESS3
   451             MOVE SPACES                 TO FNMICR-PAYEE-ADDRESS4
   452         END-IF
   453     END-IF
   454
   455     .
   456 2100-EXIT.
   457     EXIT.
   458
   459                                                                  02450000
   460                                                                  02460000
   461 3000-BUILD-INVOICE.                                              02470000
   462*                                                                 02480000
   463     ADD +1 TO SUB                                                02490000
   464     IF SUB > +15                                                 02500000
   465        PERFORM 3200-VOID THRU 3200-EXIT                          02510001
   466        PERFORM 4000-WRITE-MICR THRU 4000-EXIT                    02520000
   467        PERFORM 3100-INIT-INVOICE THRU 3100-EXIT                  02530003
   468        MOVE +1 TO SUB                                            02540000
   469     END-IF                                                       02550000
   470                                                                  02560000
   471     IF AP-CHECK-SGN = '-'                                        02561011
   472        SUBTRACT AP-CHECK-AMT FROM SAVE-CHECK-AMT                 02562009
   473     ELSE                                                         02563009
   474        ADD AP-CHECK-AMT TO SAVE-CHECK-AMT                        02564109
   475     END-IF
   476
   477     ADD +1 TO WS-NO-OF-INVOICES
   478     MOVE WS-NO-OF-INVOICES TO FNMICR-NO-OF-INVOICES              02565009
   479                                                                  02590000
   480     MOVE AP-INVOICE-NO  TO FNMICR-INV-NO  (SUB)                  02600000
   481     MOVE AP-INVOICE-AMT TO FNMICR-INV-AMT (SUB)
   482                                                                  02610000
   483     IF AP-INVOICE-SGN = '-'                                      02620009
   484        MOVE 'CR'        TO FNMICR-INV-TYPE (SUB)                 02630000
   485     ELSE                                                         02640000
   486        MOVE '  '        TO FNMICR-INV-TYPE (SUB)                 02650000
   487     END-IF
   488                                                                  02660000
   489     MOVE AP-REF         TO FNMICR-INV-MSG (SUB) (1:30)           02670000
   490     MOVE AP-PO-NO       TO FNMICR-INV-MSG (SUB) (33:24)          02680000
   491     MOVE AP-VENDOR-ID   TO FNMICR-VENDOR-NO                      02690000
   492
   493     .                                                            02700000
   494 3000-EXIT.                                                       02710000
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page  11
* FNB183.cbl
   495     EXIT.                                                        02720000
   496                                                                  02730000
   497                                                                  02740000
   498                                                                  02750000
   499 3100-INIT-INVOICE.                                               02760000
   500                                                                  02770000
   501     MOVE +0 TO WS-NO-OF-INVOICES                                 02780000
   502     PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > +15              02790000
   503        MOVE SPACE TO FNMICR-INVOICE-DATA (SUB)                   02800000
   504     END-PERFORM                                                  02810000
   505     MOVE +0 TO SUB                                               02820000
   506     .                                                            02830000
   507 3100-EXIT.                                                       02840000
   508     EXIT.                                                        02850000
   509                                                                  02860001
   510                                                                  02870001
   511                                                                  02880001
   512 3200-VOID.                                                       02890001
   513*                                                                 02900001
   514*  THIS ROUTINE VOIDS THE CHECK IF THERE ARE MORE THAN            02910001
   515*  15 INVOICES.  THIS IS NECESSARY SO THAT THE REMAINING          02920001
   516*  INVOICE LINES CAN PRINT ON THE NEXT CHECK.                     02930001
   517*                                                                 02940001
   518     ADD +1              TO SEQ-NO                                02960003
   519     MOVE SEQ-NO         TO FNMICR-DRAFT-ORDER                    02970003
   520     MOVE SAVE-CHECK-NO  TO FNMICR-DRAFT-NO                       02990003
   521     MOVE +0             TO FNMICR-AMOUNT-PAID                    03010003
   522     MOVE CORR SAVE-CHECK-DATE TO WS-CHECK-DATE                   03020003
   523     MOVE WS-CHECK-DATE  TO FNMICR-CHECK-DATE                     03030003
   524     MOVE VOID-NAME      TO FNMICR-PAYEE-NAME                     03040003
   525     MOVE ALL '*'        TO FNMICR-PAYEE-ADDRESS1                 03050003
   526     MOVE ALL '*'        TO FNMICR-PAYEE-ADDRESS2                 03060003
   527     MOVE ALL '*'        TO FNMICR-PAYEE-ADDRESS3                 03070003
   528     ADD +1 TO VOID-COUNT                                         03080001
   529     .                                                            03090001
   530 3200-EXIT.                                                       03100001
   531     EXIT.                                                        03110001
   532                                                                  03120000
   533                                                                  03130000
   534                                                                  03140000
   535 4000-WRITE-MICR.                                                 03150000
   536*                                                                 03160000
   537     WRITE MICR-DRAFT-RECORD FROM WS-WORK-RECORD                  03170000
   538                                                                  03230000
   539     IF SUB NOT > +15
   540         ADD +1 TO PRINT-COUNT
   541         ADD WS-AMOUNT-PAID    TO PRINT-AMT
   542     END-IF
   543
   544     .                                                            03300000
   545 4000-EXIT.                                                       03310000
   546     EXIT.                                                        03320000
   547                                                                  03330000
   548                                                                  03350000
   549 0000-INIT.                                                       03360000
   550                                                                  03370000
   551     IF PARM-FORM = 'CSO1' OR 'CEN1' OR 'CEN2' OR 'CEN3' OR       03371012
   552         'CEN4' OR 'CEN5' OR 'LPA1' OR 'LMB1' OR 'CSO2'
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page  12
* FNB183.cbl
   553         OR 'CSO3'
   554        CONTINUE                                                  03372012
   555     ELSE                                                         03372112
   556        DISPLAY 'INVALID PARAMETER IN JCL: ' PARM-FORM
   557     END-IF
   558                                                                  03372212
   559     OPEN INPUT CSO-CHECK-FILE                                    03380000
   560     IF SYS010-STATUS NOT = '00' AND '35'                         03390000
   561        DISPLAY 'OPEN ERROR ' SYS010-STATUS ' ON SYS010'
   562     END-IF
   563                                                                  03420000
   564     OPEN OUTPUT MICR-DRAFT-FILE
   565                 MICR-TRNSFR-FILE
   566                 PRINTER-OUTPUT
   567                                                                  03430000
   568     .                                                            03530000
   569 0000-EXIT.                                                       03540000
   570     EXIT.                                                        03550000
   571                                                                  03560000
   572                                                                  03570000
   573                                                                  03580000
   574 9000-END.                                                        03590000
   575                                                                  03600000
   576     IF VOIDS-PROCESSED
   577        CONTINUE
   578     ELSE
   579         IF INPUT-COUNT > ZERO
   580            PERFORM 2000-BUILD-CHECK THRU 2000-EXIT
   581            PERFORM 4000-WRITE-MICR  THRU 4000-EXIT
   582            WRITE MICR-TRNSFR-RECORD FROM WS-WORK-RECORD
   583         END-IF
   584     END-IF
   585
   586     ACCEPT WS-DATE FROM DATE
   587     STRING WS-MO '/' WS-DAY '/' WS-YR                            03650000
   588       DELIMITED BY SIZE INTO PRT-DATE                            03660000
   589     END-STRING                                                   03670000
   590
   591                                                                  03680000
   592     ACCEPT WS-TIME FROM TIME                                     03690000
   593     STRING WS-HH ':' WS-MI ':' WS-SE                             03700000
   594       DELIMITED BY SIZE INTO PRT-TIME                            03710000
   595     END-STRING                                                   03720000
   596                                                                  03730000
   597     EVALUATE TRUE                                                03740004
   598         WHEN PARM-FORM = 'CSO1'
   599            MOVE 'CSO AP CHECKS PRINTED - FORM CSO1'
   600                                          TO WS-PRTCHK-HEADER     03750004
   601            DISPLAY 'CSO FREEDOM/AP CHECKS PRINTED'
   602                                                                  03760004
   603         WHEN PARM-FORM = 'CEN1'
   604            MOVE 'CENSTAT SERVICES CHECKS PRINTED - FORM CEN1'
   605                                          TO WS-PRTCHK-HEADER     03770004
   606            DISPLAY 'CENSTAT SERVICES, INC CHECKS PRINTED'
   607                                                                  03780004
   608         WHEN PARM-FORM = 'CEN2'
   609            MOVE
   610            'CENSTAT DEALER SERVICES CHECKS PRINTED - FORM CEN2'
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page  13
* FNB183.cbl
   611                                          TO WS-PRTCHK-HEADER     03790004
   612            DISPLAY 'CENSTAT DEALER SERVICES, INC CHECKS PRINTED'
   613
   614         WHEN PARM-FORM = 'CEN3'
   615            MOVE
   616            'CENSTAT LIFE ASSURANCE CHECKS PRINTED - FORM CEN3'
   617                                          TO WS-PRTCHK-HEADER     03790004
   618            DISPLAY 'CENSTAT LIFE, INC CHECKS PRINTED'
   619
   620         WHEN PARM-FORM = 'CEN4'
   621            MOVE
   622            'CENSTAT FINANCIAL CHECKS PRINTED - FORM CEN4'
   623                                          TO WS-PRTCHK-HEADER     03790004
   624            DISPLAY 'CENSTAT FINANCIAL INC. CHECKS PRINTED'
   625
   626         WHEN PARM-FORM = 'CEN5'
   627            MOVE
   628            'CENSTAT CASUALTY COMPANY CHECKS PRINTED - FORM CEN5'
   629                                          TO WS-PRTCHK-HEADER     03790004
   630            DISPLAY 'CENSTAT CASUALTY COMPANY CHECKS PRINTED'
   631
   632         WHEN PARM-FORM = 'LPA1'
   633            MOVE
   634         'LENDERS PROTECTION ASSURANCE CHECKS PRINTED - FORM LPA1'
   635                                          TO WS-PRTCHK-HEADER     03790004
   636            DISPLAY 'LENDERS PROTECTION ASSURANCE CHECKS PRINTED'
   637                                                                  03800004
   638         WHEN PARM-FORM = 'LMB1'
   639            MOVE
   640         'LENDERS MUTUAL BENEFIT ASSN. CHECKS PRINTED - FORM LMB1'
   641                                          TO WS-PRTCHK-HEADER     03790004
   642            DISPLAY 'LENDERS MUTUAL BENEFIT ASSN. CHECKS PRINTED'
   643
   644         WHEN PARM-FORM = 'CSO2'
   645            MOVE 'CSI DCC AP CHECKS PRINTED - FORM CSO2'
   646                                          TO WS-PRTCHK-HEADER
   647            DISPLAY 'CSI DCC/AP CHECKS PRINTED'
   648
   649         WHEN PARM-FORM = 'CSO3'
   650            MOVE 'DCC LPAC AP CHECKS PRINTED - FORM CSO3'
   651                                          TO WS-PRTCHK-HEADER
   652            DISPLAY 'DCC LPAC/AP CHECKS PRINTED'
   653
   654         WHEN OTHER
   655            DISPLAY 'INVALID FORM NUMBER IN JCL: ' PARM-FORM
   656     END-EVALUATE                                                 03830004
   657                                                                  03840004
   658     DISPLAY ' '                                                  03860000
   659     MOVE PRINT-COUNT TO ED-CNT                                   03870000
   660     DISPLAY 'CHECKS PRINTED: ' ED-CNT                            03880000
   661     MOVE PRINT-AMT   TO ED-AMT                                   03890000
   662     DISPLAY 'AMOUNT PRINTED: ' ED-AMT                            03900000
   663     MOVE VOID-COUNT TO ED-CNT                                    03910000
   664     DISPLAY '   VOID CHECKS: ' ED-CNT                            03920000
   665     DISPLAY 'FIRST CHECK NO:       ' FIRST-CHECK                 03930000
   666     DISPLAY ' LAST CHECK NO:       ' WS-PRTCHK-LAST-NO           03940000
   667     DISPLAY '    PRINT DATE: ' PRT-DATE '  ' PRT-TIME            03950000
   668
* FREEDOM/AP MICR DRAFT FILE UPDATE                    06-Oct-15 17:19 Page  14
* FNB183.cbl
   669     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE1
   670     MOVE PRINT-COUNT     TO WS-PRTCHK-CNT
   671     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE2
   672     MOVE PRINT-AMT       TO WS-PRTCHK-TOTAL-AMT
   673     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE3
   674     MOVE VOID-COUNT      TO WS-PRTCHK-VOID-CNT
   675     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE4
   676     MOVE FIRST-CHECK     TO WS-PRTCHK-FIRST-NO
   677     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE5
   678     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE6
   679     MOVE PRT-DATE        TO WS-PRTCHK-DATE
   680     MOVE PRT-TIME        TO WS-PRTCHK-TIME
   681     WRITE PRT            FROM WS-PRTCHK-SUMMARY-LINE7
   682
   683
   684     CLOSE CSO-CHECK-FILE                                         03970000
   685           MICR-DRAFT-FILE
   686           MICR-TRNSFR-FILE
   687           PRINTER-OUTPUT                                         03980000
   688     .                                                            03990000
   689 9000-EXIT.                                                       04000000
   690     EXIT.                                                        04010000
   691                                                                  04020000
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9324     Code:        4316
