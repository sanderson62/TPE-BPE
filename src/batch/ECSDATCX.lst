* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECSDATCX.cbl
* Options: int("ECSDATCX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECSDATCX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECSDATCX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECSDATCX.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         00000010
     2                                                                  00000020
     3 PROGRAM-ID.                 ECSDATCX.                            00000030
     4*                            VMOD=2.001                           00000031
     5                                                                  00000050
     6 AUTHOR.     LOGIC, INC.                                          00000060
     7             DALLAS, TEXAS.                                       00000070
     8                                                                  00000080
     9 DATE-COMPILED. 06-Oct-15 17:18.
    11 SECURITY.   *****************************************************00000110
    12             *                                                   *00000120
    13             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *00000130
    14             *                                                   *00000140
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECSDATCX.cbl
    15             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *00000150
    16             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *00000160
    17             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *00000170
    18             *                                                   *00000180
    19             *****************************************************00000190
    20                                                                  00000200
    21 REMARKS.    *****************************************************00000210
    22             *                                                   *00000220
    23             *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *00000230
    24             *    OPTION SPECIFIED, CONVERT A GIVEN DATE INTO    *00000240
    25             *    THE FOLLOWING:  I. EDITED GREGORIAN (MM/DD/YY) *00000250
    26             *                   II. Y-M-D GREGORIAN  (YYMMDD)   *00000260
    27             *                  III. M-D-Y GREGORIAN  (MMDDYY)   *00000270
    28             *                   IV. ALPHA GREG  (MMM DD, YYYY)  *00000280
    29             *                    V. JULIAN  (YYDDD)             *00000290
    30             *                   VI. TOTAL DAYS SINCE 1900.      *00000300
    31             *    ADDITIONALLY, IF TWO DATES (EXPRESSED AS DAYS) *00000310
    32             *    ARE GIVEN, THE ELAPSED MONTHS AND DAYS CAN BE  *00000320
    33             *    CALCULATED.                                    *00000330
    34             *                                                   *00000340
    35             *****************************************************00000350
    36 ENVIRONMENT DIVISION.                                            00000360
    37                                                                  00000370
    38 DATA DIVISION.                                                   00000380
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECSDATCX.cbl
    40 WORKING-STORAGE SECTION.                                         00000400
    41 77  FILLER   PIC X(32) VALUE '********************************'. 00000410
    42 77  FILLER   PIC X(32) VALUE '** ECSDATCX WORKING STORAGE   **'. 00000420
    43 77  FILLER  PIC X(32)   VALUE '*********** VMOD=2.001 *********'.00000430
    44                                                                  00000440
*   45                             COPY ECSDATW1.                       00000441
    46******************************************************************00000010
    47*                                                                *00000020
    48*                            ECSDATW1.                           *00000030
    49*                            VMOD=2.001                         * 00000040
    50*                                                                *00000050
    51*   DESCRIPTION:  WORKING STORAGE AREA FOR DATE CONVERSION RTN.  *00000060
    52*                                                                 00000070
    53******************************************************************00000080
    54 01  FILLER                          COMP-3.                      00000090
    55     05  WS-BINARY-DATE-1            PIC S9(9)       VALUE ZERO.  00000100
    56     05  WS-BINARY-DATE-2            PIC S9(9)       VALUE ZERO.  00000110
    57     05  WS-ELAPSED-DAYS             PIC S9(5)       VALUE ZERO.  00000120
    58     05  WS-ELAPSED-MONTHS           PIC S9(5)       VALUE ZERO.  00000130
    59     05  DIVIDE-RESULT               PIC S999        VALUE ZERO.  00000140
    60     05  DIVIDE-REMAINDER            PIC S9          VALUE ZERO.  00000150
    61       88  A-LEAP-YEAR                               VALUE ZERO.  00000160
    62     05  DAYS-REMAINING              PIC S999        VALUE ZERO.  00000170
    63     05  CHECK-YEAR                  PIC S999        VALUE ZERO.  00000180
    64     05  DAYS-ELAPSED                PIC S9(5)       VALUE ZERO.  00000190
    65     05  DAYS-NEEDED                 PIC S9(5)       VALUE ZERO.  00000200
    66                                                                  00000210
    67     05  WS-DAY-OF-CENTURY           PIC S9(5)       VALUE ZERO.  00000220
    68                                                                  00000230
    69     05  WORK-DATE-1.                                             00000240
    70         10  YEAR1                   PIC S9(3)       VALUE ZERO.  00000250
    71         10  MONTH1                  PIC S9(3)       VALUE ZERO.  00000260
    72         10  DAY1                    PIC S9(3)       VALUE ZERO.  00000270
    73                                                                  00000280
    74     05  WORK-DATE-2.                                             00000290
    75         10  YEAR2                   PIC S9(3)       VALUE ZERO.  00000300
    76         10  MONTH2                  PIC S9(3)       VALUE ZERO.  00000310
    77         10  DAY2                    PIC S9(3)       VALUE ZERO.  00000320
    78                                                                  00000330
    79     05  WORK-JULIAN-1.                                           00000340
    80         10  JULIAN-YEAR1            PIC S9(3).                   00000350
    81         10  JULIAN-DAY1             PIC S9(3).                   00000360
    82                                                                  00000370
    83     05  WORK-JULIAN-2.                                           00000380
    84         10  JULIAN-YEAR2            PIC S9(3).                   00000390
    85         10  JULIAN-DAY2             PIC S9(3).                   00000400
    86                                                                  00000410
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATW1)
    88 01  FILLER.                                                      00000430
    89     05  BIN-DATE            COMP    PIC S9(9)       VALUE ZERO.  00000440
    90                                                                  00000450
    91     05  FILLER                      REDEFINES                    00000460
    92         BIN-DATE.                                                00000470
    93         10  FILLER                  PIC XX.                      00000480
    94         10  BIN-DATE-WORK           PIC XX.                      00000490
    95                                                                  00000500
    96      05  GREG-ALPHA-MASK         PIC X(18)                       00000510
    97                                       VALUE '            ,     '.00000520
    98                                                                  00000530
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATW1)
   100 01  MONTH-AND-DAYS-TABLE.                                        00000550
   101     05  FILLER             PIC X(10)  VALUE ' JANUARY  '.        00000560
   102     05  FILLER  COMP-3     PIC S9(3)  VALUE ZERO.                00000570
   103     05  FILLER  COMP-3     PIC S9(3)  VALUE ZERO.                00000580
   104     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000590
   105     05  FILLER             PIC X(10)  VALUE 'FEBRUARY  '.        00000600
   106     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000610
   107     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000620
   108     05  FILLER  COMP-3     PIC S9(3)  VALUE +28.                 00000630
   109     05  FILLER             PIC X(10)  VALUE '  MARCH   '.        00000640
   110     05  FILLER  COMP-3     PIC S9(3)  VALUE +59.                 00000650
   111     05  FILLER  COMP-3     PIC S9(3)  VALUE +60.                 00000660
   112     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000670
   113     05  FILLER             PIC X(10)  VALUE '  APRIL   '.        00000680
   114     05  FILLER  COMP-3     PIC S9(3)  VALUE +90.                 00000690
   115     05  FILLER  COMP-3     PIC S9(3)  VALUE +91.                 00000700
   116     05  FILLER  COMP-3     PIC S9(3)  VALUE +30.                 00000710
   117     05  FILLER             PIC X(10)  VALUE '   MAY    '.        00000720
   118     05  FILLER  COMP-3     PIC S9(3)  VALUE +120.                00000730
   119     05  FILLER  COMP-3     PIC S9(3)  VALUE +121.                00000740
   120     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000750
   121     05  FILLER             PIC X(10)  VALUE '  JUNE    '.        00000760
   122     05  FILLER  COMP-3     PIC S9(3)  VALUE +151.                00000770
   123     05  FILLER  COMP-3     PIC S9(3)  VALUE +152.                00000780
   124     05  FILLER  COMP-3     PIC S9(3)  VALUE +30.                 00000790
   125     05  FILLER             PIC X(10)  VALUE '  JULY    '.        00000800
   126     05  FILLER  COMP-3     PIC S9(3)  VALUE +181.                00000810
   127     05  FILLER  COMP-3     PIC S9(3)  VALUE +182.                00000820
   128     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000830
   129     05  FILLER             PIC X(10)  VALUE ' AUGUST   '.        00000840
   130     05  FILLER  COMP-3     PIC S9(3)  VALUE +212.                00000850
   131     05  FILLER  COMP-3     PIC S9(3)  VALUE +213.                00000860
   132     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000870
   133     05  FILLER             PIC X(10)  VALUE 'SEPTEMBER '.        00000880
   134     05  FILLER  COMP-3     PIC S9(3)  VALUE +243.                00000890
   135     05  FILLER  COMP-3     PIC S9(3)  VALUE +244.                00000900
   136     05  FILLER  COMP-3     PIC S9(3)  VALUE +30.                 00000910
   137     05  FILLER             PIC X(10)  VALUE ' OCTOBER  '.        00000920
   138     05  FILLER  COMP-3     PIC S9(3)  VALUE +273.                00000930
   139     05  FILLER  COMP-3     PIC S9(3)  VALUE +274.                00000940
   140     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00000950
   141     05  FILLER             PIC X(10)  VALUE 'NOVEMBER  '.        00000960
   142     05  FILLER  COMP-3     PIC S9(3)  VALUE +304.                00000970
   143     05  FILLER  COMP-3     PIC S9(3)  VALUE +305.                00000980
   144     05  FILLER  COMP-3     PIC S9(3)  VALUE +30.                 00000990
   145     05  FILLER             PIC X(10)  VALUE 'DECEMBER  '.        00001000
   146     05  FILLER  COMP-3     PIC S9(3)  VALUE +334.                00001010
   147     05  FILLER  COMP-3     PIC S9(3)  VALUE +335.                00001020
   148     05  FILLER  COMP-3     PIC S9(3)  VALUE +31.                 00001030
   149     05  FILLER             PIC X(10)  VALUE 'XXXXXXXX  '.        00001040
   150     05  FILLER  COMP-3     PIC S9(3)  VALUE +365.                00001050
   151     05  FILLER  COMP-3     PIC S9(3)  VALUE +366.                00001060
   152     05  FILLER  COMP-3     PIC S9(3)  VALUE ZERO.                00001070
   153                                                                  00001080
   154 01  TABLE-OF-MONTHS-AND-DAYS  REDEFINES  MONTH-AND-DAYS-TABLE.   00001090
   155     05  MONTHS-AND-DAYS                                          00001100
   156         OCCURS 13 TIMES             INDEXED BY MTHX              00001110
   157                                                SUB1.             00001120
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATW1)
   158         10  NAME-OF-MONTH           PIC X(10).                   00001130
   159         10  REGULAR-DAYS            PIC S999        COMP-3.      00001140
   160         10  LEAP-YR-DAYS            PIC S999        COMP-3.      00001150
   161         10  DAYS-IN-MONTH           PIC S999        COMP-3.      00001160
   162                                                                  00001170
   163                                                                  00000460
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECSDATCX.cbl
   165 LINKAGE SECTION.                                                 00000480
   166                                                                  00000490
*  167                             COPY ECSDATL1.                       00000491
   168******************************************************************00000010
   169*                                                                *00000020
   170*                            ECSDATL1.                           *00000030
   171*                            VMOD=2.001                         * 00000040
   172*                                                                *00000050
   173*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *00000060
   174*                 LENGTH = 100                                   *00000070
   175******************************************************************00000080
   176                                                                  00000090
   177 01  DATE-CONVERSION-DATA.                                        00000100
   178     05  FILLER                      PIC XX.                      00000110
   179     05  DC-OPTION-CODE              PIC X.                       00000120
   180         88  BIN-TO-GREG                VALUE ' '.                00000130
   181         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                00000140
   182         88  EDIT-GREG-TO-BIN           VALUE '2'.                00000150
   183         88  YMD-GREG-TO-BIN            VALUE '3'.                00000160
   184         88  MDY-GREG-TO-BIN            VALUE '4'.                00000170
   185         88  JULIAN-TO-BIN              VALUE '5'.                00000180
   186         88  BIN-PLUS-ELAPSED           VALUE '6'.                00000190
   187     05  DC-ERROR-CODE               PIC X.                       00000200
   188         88  NO-CONVERSION-ERROR        VALUE ' '.                00000210
   189         88  DATE-CONVERSION-ERROR      VALUE '1' '2' '3' '4' '5' 00000220
   190                                              '9'.                00000230
   191         88  DATE-IS-ZERO               VALUE '1'.                00000240
   192         88  DATE-IS-NON-NUMERIC        VALUE '2'.                00000250
   193         88  DATE-IS-INVALID            VALUE '3'.                00000260
   194         88  DATE1-GREATER-DATE2        VALUE '4'.                00000270
   195         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                00000280
   196         88  DATE-INVALID-OPTION        VALUE '9'.                00000290
   197     05  DC-END-OF-MONTH             PIC X.                       00000300
   198         88  CALCULATE-END-OF-MONTH     VALUE '1'.                00000310
   199     05  FILLER                      PIC X(2).                    00000320
   200     05  DC-CONVERSION-DATES.                                     00000330
   201         10  DC-BIN-DATE-1           PIC XX.                      00000340
   202         10  DC-BIN-DATE-2           PIC XX.                      00000350
   203         10  DC-GREG-DATE-1-EDIT.                                 00000360
   204             15  DC-EDIT1-MONTH      PIC 99.                      00000370
   205             15  SLASH1-1            PIC X.                       00000380
   206             15  DC-EDIT1-DAY        PIC 99.                      00000390
   207             15  SLASH1-2            PIC X.                       00000400
   208             15  DC-EDIT1-YEAR       PIC 99.                      00000410
   209         10  DC-GREG-DATE-2-EDIT.                                 00000420
   210             15  DC-EDIT2-MONTH      PIC 99.                      00000430
   211             15  SLASH2-1            PIC X.                       00000440
   212             15  DC-EDIT2-DAY        PIC 99.                      00000450
   213             15  SLASH2-2            PIC X.                       00000460
   214             15  DC-EDIT2-YEAR       PIC 99.                      00000470
   215         10  DC-GREG-DATE-1-YMD.                                  00000480
   216             15  DC-YMD-YEAR         PIC 99.                      00000490
   217             15  DC-YMD-MONTH        PIC 99.                      00000500
   218             15  DC-YMD-DAY          PIC 99.                      00000510
   219         10  DC-GREG-DATE-1-MDY.                                  00000520
   220             15  DC-MDY-MONTH        PIC 99.                      00000530
   221             15  DC-MDY-DAY          PIC 99.                      00000540
   222             15  DC-MDY-YEAR         PIC 99.                      00000550
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATL1)
   223         10  DC-GREG-DATE-1-ALPHA.                                00000560
   224             15  DC-ALPHA-MONTH      PIC X(10).                   00000570
   225             15  DC-ALPHA-DAY        PIC 99.                      00000580
   226             15  FILLER              PIC XX.                      00000590
   227             15  DC-ALPHA-CENTURY    PIC XX.                      00000600
   228             15  DC-ALPHA-YEAR       PIC 99.                      00000610
   229         10  DC-ELAPSED-MONTHS       PIC S9(4)     COMP.          00000620
   230         10  DC-ODD-DAYS-OVER        PIC S9(4)     COMP.          00000630
   231         10  DC-ELAPSED-DAYS         PIC S9(4)     COMP.          00000640
   232         10  DC-JULIAN-DATE.                                      00000650
   233             15  DC-JULIAN-YEAR      PIC 99.                      00000660
   234             15  DC-JULIAN-DAYS      PIC 999.                     00000670
   235                                                                  00000680
   236         10  DC-DAYS-IN-MONTH        PIC S9(3)       COMP-3.      00000690
   237                                                                  00000700
   238         10  DC-DAY-OF-WEEK          PIC S9    VALUE ZERO COMP-3. 00000710
   239         10  DC-DAY-OF-WEEK2         PIC S9    VALUE ZERO COMP-3. 00000720
   240                                                                  00000730
   241                                                                  00000510
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECSDATCX.cbl
   243 PROCEDURE DIVISION USING DATE-CONVERSION-DATA.                   00000530
   244                                                                  00000540
   245 0100-PROGRAM-PROCESSING SECTION.
*                                       COPY ECSDATP1.                  00000550
   246******************************************************************00000010
   247*                                                                *00000020
   248*                            ECSDATP1                            *00000030
   249*                            VMOD=2.001                         * 00000040
   250*                                                                *00000050
   251******************************************************************00000060
   252     MOVE SPACES                 TO DC-ERROR-CODE.                00000070
   253                                                                  00000080
   254     MOVE ZERO                   TO  BIN-DATE.                    00000090
   255     MOVE DC-BIN-DATE-1          TO  BIN-DATE-WORK.               00000100
   256     MOVE BIN-DATE               TO  WS-BINARY-DATE-1.            00000110
   257                                                                  00000120
   258     MOVE ZERO                   TO  BIN-DATE.                    00000130
   259     MOVE DC-BIN-DATE-2          TO  BIN-DATE-WORK.               00000140
   260     MOVE BIN-DATE               TO  WS-BINARY-DATE-2.            00000150
   261                                                                  00000160
   262     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.           00000170
   263     MOVE DC-ELAPSED-DAYS        TO  WS-ELAPSED-DAYS.             00000180
   264                                                                  00000190
   265     MOVE DC-JULIAN-YEAR         TO  JULIAN-YEAR1.                00000200
   266     MOVE DC-JULIAN-DAYS         TO  JULIAN-DAY1.                 00000210
   267                                                                  00000220
   268     IF BIN-PLUS-ELAPSED                                          00000230
   269         PERFORM 0700-CALCULATE-END-DATE                          00000240
   270       ELSE                                                       00000250
   271         IF BIN-TO-GREG                                           00000260
   272           OR ELAPSED-BETWEEN-BIN                                 00000270
   273             PERFORM 0300-REFORMAT-BINARY-DAYS                    00000280
   274           ELSE                                                   00000290
   275             IF EDIT-GREG-TO-BIN                                  00000300
   276               OR YMD-GREG-TO-BIN                                 00000310
   277               OR MDY-GREG-TO-BIN                                 00000320
   278                 PERFORM 0400-REFORMAT-GREGORIAN-DATE             00000330
   279               ELSE                                               00000340
   280                 IF JULIAN-TO-BIN                                 00000350
   281                     PERFORM 0500-REFORMAT-JULIAN-DATE            00000360
   282                   ELSE                                           00000370
   283                     MOVE '9' TO DC-ERROR-CODE.                   00000380
   284                                                                  00000390
   285     IF NO-CONVERSION-ERROR                                       00000400
   286         PERFORM 0200-DATE-CONVERSION-ROUTINES.                   00000410
   287                                                                  00000420
   288                                                                  00000560
   289 0100-EXIT.                                                       00000570
   290                                                                  00000580
   291     GOBACK.                                                      00000590
   292                                                                  00000600
   294 0200-DATE-CONVERSION-ROUTINES SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECSDATCX.cbl
*                                             COPY ECSDATP2.            00000620
   295******************************************************************00000010
   296*                                                                *00000020
   297*                            ECSDATP2                            *00000030
   298*                            VMOD=2.001                         * 00000040
   299*                                                                *00000050
   300*                       DATE CONVERSION ROUTINE                  *00000060
   301*                                                                *00000070
   302******************************************************************00000080
   303                                                                  00000090
   304     IF BIN-PLUS-ELAPSED                                          00000100
   305         COMPUTE WS-BINARY-DATE-2 = (((YEAR1 * 12) +              00000110
   306                                    (MONTH1 - 1)) * 32) + DAY1    00000120
   307         MOVE WS-BINARY-DATE-2   TO  BIN-DATE                     00000130
   308         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-2                00000140
   309       ELSE                                                       00000150
   310         COMPUTE WS-BINARY-DATE-1 = (((YEAR1 * 12) +              00000160
   311                                    (MONTH1 - 1)) * 32) + DAY1    00000170
   312         MOVE WS-BINARY-DATE-1   TO  BIN-DATE                     00000180
   313         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-1.               00000190
   314                                                                  00000200
   315     SET MTHX TO MONTH1.                                          00000210
   316                                                                  00000220
   317     MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.        00000230
   318                                                                  00000240
   319     MOVE '/'                    TO  SLASH1-1  SLASH1-2           00000250
   320                                     SLASH2-1  SLASH2-2.          00000260
   321                                                                  00000270
   322     IF YEAR1 LESS THAN +100                                      00000280
   323         MOVE '19' TO DC-ALPHA-CENTURY                            00000290
   324       ELSE                                                       00000300
   325         MOVE '20' TO DC-ALPHA-CENTURY.                           00000310
   326                                                                  00000320
   327     MOVE MONTH1 TO DC-EDIT1-MONTH                                00000330
   328                    DC-YMD-MONTH                                  00000340
   329                    DC-MDY-MONTH.                                 00000350
   330                                                                  00000360
   331     MOVE NAME-OF-MONTH (MTHX) TO DC-ALPHA-MONTH.                 00000370
   332                                                                  00000380
   333     MOVE DAYS-IN-MONTH (MTHX)  TO  DC-DAYS-IN-MONTH.             00000390
   334                                                                  00000400
   335     MOVE DAY1 TO DC-EDIT1-DAY                                    00000410
   336                  DC-YMD-DAY                                      00000420
   337                  DC-MDY-DAY                                      00000430
   338                  DC-ALPHA-DAY.                                   00000440
   339                                                                  00000450
   340     MOVE YEAR1 TO DC-EDIT1-YEAR                                  00000460
   341                   DC-YMD-YEAR                                    00000470
   342                   DC-MDY-YEAR                                    00000480
   343                   DC-ALPHA-YEAR.                                 00000490
   344                                                                  00000500
   345     IF JULIAN-TO-BIN                                             00000510
   346         COMPUTE WS-DAY-OF-CENTURY =                              00000520
   347             (JULIAN-YEAR1 * +365.25) + JULIAN-DAY1               00000530
   348         DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT      00000540
   349             REMAINDER DC-DAY-OF-WEEK                             00000550
   350         ADD +1  TO  DC-DAY-OF-WEEK                               00000560
   351         GO TO 0200-EXIT.                                         00000570
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   352                                                                  00000580
   353     MOVE YEAR1 TO JULIAN-YEAR1.                                  00000590
   354                                                                  00000600
   355     IF A-LEAP-YEAR                                               00000610
   356         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY1                  00000620
   357       ELSE                                                       00000630
   358         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY1.                 00000640
   359                                                                  00000650
   360     ADD DAY1 TO JULIAN-DAY1.                                     00000660
   361                                                                  00000670
   362     MOVE JULIAN-YEAR1           TO  DC-JULIAN-YEAR.              00000680
   363     MOVE JULIAN-DAY1            TO  DC-JULIAN-DAYS.              00000690
   364                                                                  00000700
   365     COMPUTE WS-DAY-OF-CENTURY =                                  00000710
   366         (JULIAN-YEAR1 * +365.25) + JULIAN-DAY1.                  00000720
   367                                                                  00000730
   368     DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT          00000740
   369         REMAINDER DC-DAY-OF-WEEK.                                00000750
   370                                                                  00000760
   371     ADD +1  TO  DC-DAY-OF-WEEK.                                  00000770
   372                                                                  00000780
   373     IF ELAPSED-BETWEEN-BIN                                       00000790
   374         MOVE MONTH2 TO DC-EDIT2-MONTH                            00000800
   375         MOVE DAY2 TO DC-EDIT2-DAY                                00000810
   376         MOVE YEAR2 TO DC-EDIT2-YEAR                              00000820
   377         PERFORM 0600-ELAPSED-TIME-CALCULATIONS.                  00000830
   378                                                                  00000840
   379     IF ELAPSED-BETWEEN-BIN                                       00000850
   380       OR BIN-PLUS-ELAPSED                                        00000860
   381         COMPUTE WS-DAY-OF-CENTURY =                              00000870
   382             (JULIAN-YEAR2 * +365.25) + JULIAN-DAY2               00000880
   383         DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT      00000890
   384             REMAINDER DC-DAY-OF-WEEK2                            00000900
   385         ADD +1  TO  DC-DAY-OF-WEEK2                              00000910
   386       ELSE                                                       00000920
   387         MOVE ZERO               TO  DC-DAY-OF-WEEK2.             00000930
   388                                                                  00000940
   389 0200-EXIT.                                                       00000950
   390     EXIT.                                                        00000960
   391                                                                  00000970
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   393 0300-REFORMAT-BINARY-DAYS SECTION.                               00000990
   394                                                                  00001000
   395     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          00001010
   396                                     DC-GREG-DATE-2-EDIT.         00001020
   397     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           00001030
   398                                     DC-GREG-DATE-1-MDY           00001040
   399                                     DC-JULIAN-DATE               00001050
   400                                     DC-ELAPSED-MONTHS            00001060
   401                                     DC-ODD-DAYS-OVER             00001070
   402                                     DC-ELAPSED-DAYS              00001080
   403                                     DC-DAY-OF-WEEK               00001090
   404                                     DC-DAY-OF-WEEK2.             00001100
   405                                                                  00001110
   406     IF ELAPSED-BETWEEN-BIN                                       00001120
   407       AND WS-BINARY-DATE-1 GREATER THAN WS-BINARY-DATE-2         00001130
   408         MOVE '4' TO DC-ERROR-CODE                                00001140
   409         GO TO 0300-EXIT.                                         00001150
   410                                                                  00001160
   411     IF WS-BINARY-DATE-1 = ZERO                                   00001170
   412         MOVE '1' TO DC-ERROR-CODE                                00001180
   413         MOVE ZERO               TO  DC-GREG-DATE-1-EDIT          00001190
   414         GO TO 0300-EXIT.                                         00001200
   415                                                                  00001210
   416                                                                  00001220
   417     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 00001230
   418               REMAINDER DAYS-REMAINING.                          00001240
   419                                                                  00001250
   420     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   00001260
   421               REMAINDER DAY1.                                    00001270
   422                                                                  00001280
   423     ADD +1 TO MONTH1.                                            00001290
   424                                                                  00001300
   425     MOVE YEAR1 TO CHECK-YEAR.                                    00001310
   426     PERFORM 0900-CHECK-FOR-LEAP-YEAR                             00001320
   427                                                                  00001330
   428     IF NOT ELAPSED-BETWEEN-BIN                                   00001340
   429         GO TO 0300-EXIT.                                         00001350
   430                                                                  00001360
   431     IF WS-BINARY-DATE-2 = ZERO                                   00001370
   432         MOVE '1' TO DC-ERROR-CODE                                00001380
   433         GO TO 0300-EXIT.                                         00001390
   434                                                                  00001400
   435     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 00001410
   436                                 REMAINDER DAYS-REMAINING.        00001420
   437                                                                  00001430
   438     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   00001440
   439                                 REMAINDER DAY2.                  00001450
   440                                                                  00001460
   441     ADD +1 TO MONTH2.                                            00001470
   442                                                                  00001480
   443 0300-EXIT.                                                       00001490
   444     EXIT.                                                        00001500
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   446 0400-REFORMAT-GREGORIAN-DATE SECTION.                            00001520
   447                                                                  00001530
   448     MOVE LOW-VALUES             TO  DC-BIN-DATE-1                00001540
   449                                     DC-BIN-DATE-2.               00001550
   450                                                                  00001560
   451     IF EDIT-GREG-TO-BIN                                          00001570
   452         IF (DC-EDIT1-MONTH NOT NUMERIC) OR                       00001580
   453            (DC-EDIT1-DAY   NOT NUMERIC) OR                       00001590
   454            (DC-EDIT1-YEAR  NOT NUMERIC)                          00001600
   455               MOVE '2' TO DC-ERROR-CODE                          00001610
   456               GO TO 0400-EXIT.                                   00001620
   457                                                                  00001630
   458     IF YMD-GREG-TO-BIN                                           00001640
   459         IF DC-GREG-DATE-1-YMD NOT NUMERIC                        00001650
   460             MOVE '2' TO DC-ERROR-CODE                            00001660
   461             GO TO 0400-EXIT.                                     00001670
   462                                                                  00001680
   463     IF MDY-GREG-TO-BIN                                           00001690
   464         IF DC-GREG-DATE-1-MDY NOT NUMERIC                        00001700
   465             MOVE '2' TO DC-ERROR-CODE                            00001710
   466             GO TO 0400-EXIT.                                     00001720
   467                                                                  00001730
   468     IF EDIT-GREG-TO-BIN                                          00001740
   469         MOVE DC-EDIT1-MONTH TO MONTH1                            00001750
   470         MOVE DC-EDIT1-DAY TO DAY1                                00001760
   471         MOVE DC-EDIT1-YEAR TO YEAR1.                             00001770
   472                                                                  00001780
   473     IF YMD-GREG-TO-BIN                                           00001790
   474         MOVE DC-YMD-YEAR TO YEAR1                                00001800
   475         MOVE DC-YMD-MONTH TO MONTH1                              00001810
   476         MOVE DC-YMD-DAY TO DAY1.                                 00001820
   477                                                                  00001830
   478     IF MDY-GREG-TO-BIN                                           00001840
   479         MOVE DC-MDY-MONTH TO MONTH1                              00001850
   480         MOVE DC-MDY-DAY   TO DAY1                                00001860
   481         MOVE DC-MDY-YEAR  TO YEAR1.                              00001870
   482                                                                  00001880
   483     IF MONTH1 = ZERO  AND                                        00001890
   484        DAY1   = ZERO  AND                                        00001900
   485        YEAR1  = ZERO                                             00001910
   486         MOVE '1' TO DC-ERROR-CODE                                00001920
   487         GO TO 0400-EXIT.                                         00001930
   488                                                                  00001940
   489     IF MONTH1 LESS 1 OR GREATER 12                               00001950
   490         MOVE '3' TO DC-ERROR-CODE                                00001960
   491         GO TO 0400-EXIT.                                         00001970
   492                                                                  00001980
   493     IF DAY1 LESS 1 OR GREATER 31                                 00001990
   494         MOVE '3' TO DC-ERROR-CODE                                00002000
   495         GO TO 0400-EXIT.                                         00002010
   496                                                                  00002020
   497     MOVE YEAR1 TO CHECK-YEAR.                                    00002030
   498     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             00002040
   499                                                                  00002050
   500     IF DAY1 GREATER DAYS-IN-MONTH (MONTH1)                       00002060
   501         MOVE '3' TO DC-ERROR-CODE                                00002070
   502         GO TO 0400-EXIT.                                         00002080
   503                                                                  00002090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   504 0400-EXIT.                                                       00002100
   505     EXIT.                                                        00002110
   506                                                                  00002120
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   508 0500-REFORMAT-JULIAN-DATE SECTION.                               00002140
   509                                                                  00002150
   510     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          00002160
   511                                     DC-GREG-DATE-2-EDIT.         00002170
   512                                                                  00002180
   513     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           00002190
   514                                     DC-GREG-DATE-1-MDY           00002200
   515                                     DC-ELAPSED-MONTHS            00002210
   516                                     DC-ODD-DAYS-OVER             00002220
   517                                     DC-ELAPSED-DAYS.             00002230
   518                                                                  00002240
   519     MOVE LOW-VALUES             TO  DC-BIN-DATE-1                00002250
   520                                     DC-BIN-DATE-2.               00002260
   521                                                                  00002270
   522     IF DC-JULIAN-DATE = ZEROS                                    00002280
   523         MOVE '1' TO DC-ERROR-CODE                                00002290
   524         GO TO 0500-EXIT.                                         00002300
   525                                                                  00002310
   526     IF DC-JULIAN-DAYS = ZERO                                     00002320
   527         MOVE '3' TO DC-ERROR-CODE                                00002330
   528         GO TO 0500-EXIT.                                         00002340
   529                                                                  00002350
   530     MOVE JULIAN-YEAR1 TO YEAR1  CHECK-YEAR.                      00002360
   531                                                                  00002370
   532     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             00002380
   533                                                                  00002390
   534     IF (A-LEAP-YEAR AND JULIAN-DAY1 GREATER THAN                 00002400
   535                             LEAP-YR-DAYS (13))                   00002410
   536       OR                                                         00002420
   537        (NOT A-LEAP-YEAR AND DC-JULIAN-DAYS GREATER               00002430
   538                             REGULAR-DAYS (13))                   00002440
   539           MOVE '3' TO DC-ERROR-CODE                              00002450
   540           GO TO 0500-EXIT.                                       00002460
   541                                                                  00002470
   542     SET MTHX TO +1.                                              00002480
   543                                                                  00002490
   544     IF A-LEAP-YEAR                                               00002500
   545         PERFORM 0550-JULIAN-LEAP-YEAR                            00002510
   546       ELSE                                                       00002520
   547         PERFORM 0575-JULIAN-REGULAR-YEAR.                        00002530
   548                                                                  00002540
   549 0500-EXIT.                                                       00002550
   550     EXIT.                                                        00002560
   551                                                                  00002570
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   553 0550-JULIAN-LEAP-YEAR SECTION.                                   00002590
   554                                                                  00002600
   555     IF JULIAN-DAY1 NOT GREATER THAN LEAP-YR-DAYS (MTHX)          00002610
   556         SET MTHX DOWN BY +1                                      00002620
   557         SET MONTH1 TO MTHX                                       00002630
   558         SUBTRACT LEAP-YR-DAYS (MTHX) FROM JULIAN-DAY1 GIVING DAY100002640
   559         MOVE JULIAN-YEAR1       TO  YEAR1                        00002650
   560       ELSE                                                       00002660
   561         SET MTHX UP BY +1                                        00002670
   562         GO TO 0550-JULIAN-LEAP-YEAR.                             00002680
   563                                                                  00002690
   564 0550-EXIT.                                                       00002700
   565     EXIT.                                                        00002710
   566                                                                  00002720
   567 0575-JULIAN-REGULAR-YEAR SECTION.                                00002730
   568                                                                  00002740
   569     IF JULIAN-DAY1 NOT GREATER THAN REGULAR-DAYS (MTHX)          00002750
   570         SET MTHX DOWN BY +1                                      00002760
   571         SET MONTH1 TO MTHX                                       00002770
   572         SUBTRACT REGULAR-DAYS (MTHX) FROM JULIAN-DAY1 GIVING DAY100002780
   573         MOVE JULIAN-YEAR1       TO  YEAR1                        00002790
   574       ELSE                                                       00002800
   575         SET MTHX UP BY +1                                        00002810
   576         GO TO 0575-JULIAN-REGULAR-YEAR.                          00002820
   577                                                                  00002830
   578 0575-EXIT.                                                       00002840
   579     EXIT.                                                        00002850
   580                                                                  00002860
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   582 0600-ELAPSED-TIME-CALCULATIONS SECTION.                          00002880
   583                                                                  00002890
   584     MOVE YEAR2 TO JULIAN-YEAR2  CHECK-YEAR.                      00002900
   585     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            00002910
   586                                                                  00002920
   587     SET MTHX TO MONTH2.                                          00002930
   588                                                                  00002940
   589     IF A-LEAP-YEAR                                               00002950
   590         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  00002960
   591       ELSE                                                       00002970
   592         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 00002980
   593                                                                  00002990
   594     ADD DAY2 TO JULIAN-DAY2                                      00003000
   595                                                                  00003010
   596     MOVE ZERO                   TO WS-ELAPSED-DAYS.              00003020
   597     MOVE YEAR1                  TO CHECK-YEAR.                   00003030
   598                                                                  00003040
   599 0600-LOOP.                                                       00003050
   600     IF CHECK-YEAR = JULIAN-YEAR2                                 00003060
   601         GO TO 0600-COMPUTE.                                      00003070
   602                                                                  00003080
   603     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            00003090
   604                                                                  00003100
   605     IF A-LEAP-YEAR                                               00003110
   606         ADD +366 TO WS-ELAPSED-DAYS                              00003120
   607       ELSE                                                       00003130
   608         ADD +365 TO WS-ELAPSED-DAYS.                             00003140
   609                                                                  00003150
   610     ADD +1  TO  CHECK-YEAR.                                      00003160
   611                                                                  00003170
   612     GO TO 0600-LOOP.                                             00003180
   613                                                                  00003190
   614 0600-COMPUTE.                                                    00003200
   615     ADD JULIAN-DAY2 TO WS-ELAPSED-DAYS.                          00003210
   616     SUBTRACT JULIAN-DAY1 FROM WS-ELAPSED-DAYS.                   00003220
   617                                                                  00003230
   618     COMPUTE WS-ELAPSED-MONTHS =                                  00003240
   619         ((YEAR2 - YEAR1) * 12) + (MONTH2 - MONTH1).              00003250
   620                                                                  00003260
   621     IF DAY2 IS = DAY1                                            00003270
   622         MOVE ZERO               TO  DC-ODD-DAYS-OVER             00003280
   623                                                                  00003290
   624       ELSE                                                       00003300
   625                                                                  00003310
   626     IF DAY1 IS NOT LESS THAN DAYS-IN-MONTH (MONTH1)              00003320
   627         MOVE DAY2               TO  DC-ODD-DAYS-OVER             00003330
   628         SUBTRACT +1 FROM WS-ELAPSED-MONTHS                       00003340
   629                                                                  00003350
   630       ELSE                                                       00003360
   631                                                                  00003370
   632     IF DAY2 IS GREATER THAN DAY1                                 00003380
   633         SUBTRACT DAY1 FROM DAY2 GIVING DC-ODD-DAYS-OVER          00003390
   634                                                                  00003400
   635       ELSE                                                       00003410
   636                                                                  00003420
   637         COMPUTE DC-ODD-DAYS-OVER =                               00003430
   638              (DAYS-IN-MONTH (MONTH1) - DAY1) + DAY2              00003440
   639         SUBTRACT +1 FROM WS-ELAPSED-MONTHS.                      00003450
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   640                                                                  00003460
   641     IF DC-ODD-DAYS-OVER IS NOT LESS THAN DAYS-IN-MONTH (MONTH2)  00003470
   642         MOVE ZERO               TO  DC-ODD-DAYS-OVER             00003480
   643         ADD +1 TO WS-ELAPSED-MONTHS.                             00003490
   644                                                                  00003500
   645 0600-MOVE.                                                       00003510
   646     MOVE WS-ELAPSED-MONTHS      TO  DC-ELAPSED-MONTHS.           00003520
   647     MOVE WS-ELAPSED-DAYS        TO  DC-ELAPSED-DAYS.             00003530
   648                                                                  00003540
   649 0600-EXIT.                                                       00003550
   650     EXIT.                                                        00003560
   651                                                                  00003570
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   653 0700-CALCULATE-END-DATE SECTION.                                 00003590
   654                                                                  00003600
   655     IF NOT CALCULATE-END-OF-MONTH                                00003610
   656         GO TO 0700-CONTINUE.                                     00003620
   657                                                                  00003630
   658     IF WS-ELAPSED-MONTHS = ZERO  OR                              00003640
   659        WS-ELAPSED-DAYS NOT = ZERO                                00003650
   660         MOVE '2'                TO  DC-END-OF-MONTH              00003660
   661         GO TO 0700-CONTINUE.                                     00003670
   662                                                                  00003680
   663     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 00003690
   664             REMAINDER DAYS-REMAINING.                            00003700
   665                                                                  00003710
   666     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   00003720
   667             REMAINDER DAY1.                                      00003730
   668                                                                  00003740
   669     ADD +1  TO  MONTH1.                                          00003750
   670                                                                  00003760
   671     SET MTHX TO MONTH1.                                          00003770
   672                                                                  00003780
   673     IF DAY1 LESS THAN DAYS-IN-MONTH (MTHX)                       00003790
   674         MOVE '3'            TO  DC-END-OF-MONTH.                 00003800
   675                                                                  00003810
   676 0700-CONTINUE.                                                   00003820
   677     COMPUTE WS-BINARY-DATE-2 = WS-BINARY-DATE-1 +                00003830
   678             (WS-ELAPSED-MONTHS * 32).                            00003840
   679                                                                  00003850
   680     IF WS-BINARY-DATE-2 NOT GREATER THAN ZERO                    00003860
   681         MOVE '5'                TO  DC-ERROR-CODE                00003870
   682         GO TO 0700-EXIT.                                         00003880
   683                                                                  00003890
   684     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 00003900
   685             REMAINDER DAYS-REMAINING.                            00003910
   686                                                                  00003920
   687     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   00003930
   688             REMAINDER DAY2.                                      00003940
   689                                                                  00003950
   690     ADD +1 TO MONTH2.                                            00003960
   691                                                                  00003970
   692     SET MTHX TO MONTH2.                                          00003980
   693                                                                  00003990
   694     MOVE YEAR2 TO YEAR1                                          00004000
   695                   CHECK-YEAR                                     00004010
   696                   JULIAN-YEAR2.                                  00004020
   697                                                                  00004030
   698     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            00004040
   699                                                                  00004050
   700     IF A-LEAP-YEAR                                               00004060
   701         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  00004070
   702       ELSE                                                       00004080
   703         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 00004090
   704                                                                  00004100
   705     IF DAY2 NOT LESS THAN DAYS-IN-MONTH (MTHX)                   00004110
   706         MOVE DAYS-IN-MONTH (MTHX) TO DAY2.                       00004120
   707                                                                  00004130
   708     ADD DAY2 TO JULIAN-DAY2.                                     00004140
   709                                                                  00004150
   710 0700-ADD-DAYS.                                                   00004160
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   711     IF WS-ELAPSED-DAYS = ZERO                                    00004170
   712         GO TO 0700-CONVERT-NEW-DATE.                             00004180
   713                                                                  00004190
   714     MOVE WS-ELAPSED-DAYS TO DAYS-ELAPSED.                        00004200
   715                                                                  00004210
   716     IF WS-ELAPSED-DAYS LESS THAN ZERO                            00004220
   717         MULTIPLY -1  BY  WS-ELAPSED-DAYS                         00004230
   718         GO TO 0700-SUBTRACT-DAYS.                                00004240
   719                                                                  00004250
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   721 0700-ADD-DAYS-LOOP.                                              00004270
   722     IF A-LEAP-YEAR                                               00004280
   723         MOVE 366 TO DAYS-NEEDED                                  00004290
   724       ELSE                                                       00004300
   725         MOVE 365 TO DAYS-NEEDED.                                 00004310
   726                                                                  00004320
   727     SUBTRACT JULIAN-DAY2 FROM DAYS-NEEDED.                       00004330
   728                                                                  00004340
   729     IF DAYS-ELAPSED NOT GREATER THAN DAYS-NEEDED                 00004350
   730         GO TO 0700-ADD-REMAINING-DAYS.                           00004360
   731                                                                  00004370
   732     IF DAYS-ELAPSED GREATER THAN ZERO                            00004380
   733         SUBTRACT +1  FROM DAYS-ELAPSED.                          00004390
   734                                                                  00004400
   735     SUBTRACT DAYS-NEEDED FROM DAYS-ELAPSED.                      00004410
   736                                                                  00004420
   737     ADD +1 TO JULIAN-YEAR2.                                      00004430
   738                                                                  00004440
   739     MOVE +1 TO JULIAN-DAY2.                                      00004450
   740                                                                  00004460
   741     MOVE JULIAN-YEAR2 TO CHECK-YEAR.                             00004470
   742     PERFORM 0900-CHECK-FOR-LEAP-YEAR                             00004480
   743                                                                  00004490
   744     GO TO 0700-ADD-DAYS-LOOP.                                    00004500
   745                                                                  00004510
   746 0700-ADD-REMAINING-DAYS.                                         00004520
   747     ADD DAYS-ELAPSED TO JULIAN-DAY2.                             00004530
   748                                                                  00004540
   749     GO TO 0700-CALCULATE-JULIAN-DATE.                            00004550
   750                                                                  00004560
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   752 0700-SUBTRACT-DAYS.                                              00004580
   753     IF WS-ELAPSED-DAYS LESS THAN JULIAN-DAY2                     00004590
   754         SUBTRACT WS-ELAPSED-DAYS FROM JULIAN-DAY2                00004600
   755         GO TO 0700-CALCULATE-JULIAN-DATE.                        00004610
   756                                                                  00004620
   757     SUBTRACT JULIAN-DAY2 FROM WS-ELAPSED-DAYS.                   00004630
   758                                                                  00004640
   759     SUBTRACT +1  FROM JULIAN-YEAR2.                              00004650
   760                                                                  00004660
   761     MOVE JULIAN-YEAR2           TO  CHECK-YEAR.                  00004670
   762     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            00004680
   763                                                                  00004690
   764     IF A-LEAP-YEAR                                               00004700
   765         MOVE +366               TO  JULIAN-DAY2                  00004710
   766       ELSE                                                       00004720
   767         MOVE +365               TO  JULIAN-DAY2.                 00004730
   768                                                                  00004740
   769     GO TO 0700-SUBTRACT-DAYS.                                    00004750
   770                                                                  00004760
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   772 0700-CALCULATE-JULIAN-DATE.                                      00004780
   773     MOVE WORK-JULIAN-2          TO  WORK-JULIAN-1.               00004790
   774     SET MTHX TO +1.                                              00004800
   775                                                                  00004810
   776     IF A-LEAP-YEAR                                               00004820
   777         PERFORM 0550-JULIAN-LEAP-YEAR                            00004830
   778       ELSE                                                       00004840
   779         PERFORM 0575-JULIAN-REGULAR-YEAR.                        00004850
   780                                                                  00004860
   781     MOVE WORK-DATE-1 TO WORK-DATE-2.                             00004870
   782                                                                  00004880
   783 0700-CONVERT-NEW-DATE.                                           00004890
   784     IF CALCULATE-END-OF-MONTH                                    00004900
   785         SET MTHX TO MONTH2                                       00004910
   786         IF DAY2 LESS THAN DAYS-IN-MONTH (MTHX)                   00004920
   787             MOVE DAYS-IN-MONTH (MTHX) TO  DAY2.                  00004930
   788                                                                  00004940
   789     MOVE WORK-DATE-2 TO WORK-DATE-1.                             00004950
   790                                                                  00004960
   791 0700-EXIT.                                                       00004970
   792     EXIT.                                                        00004980
   793                                                                  00004990
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECSDATCX.cbl (/apps/prod/cid1p/copy/ECSDATP2)
   795 0900-CHECK-FOR-LEAP-YEAR SECTION.                                00005010
   796                                                                  00005020
   797     DIVIDE CHECK-YEAR BY +4 GIVING DIVIDE-RESULT                 00005030
   798               REMAINDER DIVIDE-REMAINDER.                        00005040
   799                                                                  00005050
   800     IF CHECK-YEAR = ZERO                                         00005060
   801         MOVE +9 TO DIVIDE-REMAINDER.                             00005070
   802                                                                  00005080
   803     IF A-LEAP-YEAR                                               00005090
   804         MOVE +29                TO  DAYS-IN-MONTH (2)            00005100
   805       ELSE                                                       00005110
   806         MOVE +28                TO  DAYS-IN-MONTH (2).           00005120
   807                                                                  00005130
   808 0900-EXIT.                                                       00005140
   809     EXIT.                                                        00005150
   810                                                                  00005160
   811                                                                  00000630
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:         968     Code:        3315
