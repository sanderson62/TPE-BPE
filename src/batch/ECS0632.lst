* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS0632.cbl
* Options: int("ECS0632.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS0632.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS0632.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS0632.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS0632.
     3 AUTHOR.        PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5******************************************************************
     6*                   C H A N G E   L O G
     7*
     8* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     9*-----------------------------------------------------------------
    10*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    11* EFFECTIVE    NUMBER
    12*-----------------------------------------------------------------
    13* 010505  2004110300005    PEMA  NEW PROGRAM FOR SECURE PAY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS0632.cbl
    14* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    15******************************************************************
    16 ENVIRONMENT DIVISION.
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19
    20     SELECT EXTR-FILE-IN     ASSIGN TO EXTRIN.
    21
    22     SELECT ERCOMP           ASSIGN TO ERCOMP
    23                             ORGANIZATION INDEXED
    24                             ACCESS DYNAMIC
    25                             RECORD KEY CO-CONTROL-PRIMARY
    26                             FILE STATUS ERCOMP-STATUS.
    27
    28     SELECT DISK-DATE        ASSIGN TO SYS019.
    29
    30     SELECT SORT-WORK        ASSIGN TO SYS001.
    31
    32     SELECT PRNTR            ASSIGN TO SYS008.
    33     SELECT FICH             ASSIGN TO SYS020.
    34
    35 DATA DIVISION.
    36 FILE SECTION.
    37
    38 FD  EXTR-FILE-IN
    39     RECORDING MODE F
    40     LABEL RECORDS STANDARD
    41     BLOCK CONTAINS 0 RECORDS.
    42
*   43     COPY ECSEXT01.
    44******************************************************************04/29/98
    45*                                                                *ECSEXT01
    46*                            ECSEXT01                            *   LV015
    47*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    48*                            VMOD=2.015                          *ECSEXT01
    49*                                                                *ECSEXT01
    50*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    51*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    52*                                                                *ECSEXT01
    53*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    54*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    55*                                                                *ECSEXT01
    56*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    57*                                                                *ECSEXT01
    58******************************************************************ECSEXT01
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    68* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    69* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    70* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    71* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
    72* 032612  CR2011110200001  PEMA  AHL CHANGES
    73******************************************************************
    74                                                                  ECSEXT01
    75 01  DETAIL-EXTRACT.                                              ECSEXT01
    76     02 DETAIL-FILE.                                              ECSEXT01
    77     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
    78         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
    79                                                                  ECSEXT01
    80     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
    81                                                                  ECSEXT01
    82     12  DE-REIN                           PIC X.                 ECSEXT01
    83                                                                  ECSEXT01
    84     12  DE-CONTROL.                                              ECSEXT01
    85         16  DE-CNTRL1.                                           ECSEXT01
    86             20  DE-CARRIER                PIC X.                 ECSEXT01
    87             20  DE-GROUPING.                                     ECSEXT01
    88                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
    89                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
    90             20  DE-STATE                  PIC XX.                ECSEXT01
    91             20  DE-ACCOUNT.                                      ECSEXT01
    92                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
    93                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
    94         16  DE-CNTRL2.                                           ECSEXT01
    95             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
    96             20  DE-CERT.                                         ECSEXT01
    97                 24 DE-CERT-NO.                                   ECSEXT01
    98                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
    99                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   100                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   101                                                                  ECSEXT01
   102     12  DE-TRANS                          PIC X.                 ECSEXT01
   103         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   104         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   105         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   106         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   107         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   108         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   109         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   110         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   111         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   112         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   113                                                                  ECSEXT01
   114     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   115     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   116                                                                  ECSEXT01
   117     12  DE-NAME.                                                 ECSEXT01
   118         16  DE-LNAME                      PIC X(15).             ECSEXT01
   119         16  DE-FNAME.                                            ECSEXT01
   120             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   121             20  FILLER                    PIC X(9).              ECSEXT01
   122         16  DE-INIT                       PIC X.                 ECSEXT01
   123     12  DE-AGE                            PIC 99.                ECSEXT01
   124     12  DE-SEX                            PIC X.                 ECSEXT01
   125     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   126                                                                  ECSEXT01
   127     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   128     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   129     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   130     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   131     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   132     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   133     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   134     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   135     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   136                                                                  ECSEXT01
   137     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   138     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   139     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   140     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   141                                                                  ECSEXT01
   142     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   143     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   144     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   145     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   146     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   147                                                                  ECSEXT01
   148     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   149     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   150     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   151     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   152                                                                  ECSEXT01
   153     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   154     12  DE-ADDL-CLP REDEFINES DE-LIVES
   155                                           PIC S9(5)V99   COMP-3.
   156     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   157     12  FILLER REDEFINES DE-NUM-BILLED.
   158         16  DE-CLP-STATE                  PIC XX.
   159         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   160     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   161     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   162                                                                  ECSEXT01
   163     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   164     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   165     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   166     12  DE-IG                             PIC X.                 ECSEXT01
   167     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   168*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   169     12  DE-MEMBER-NO.                                            ECSEXT01
   170         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   171         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   172         16  FILLER                        PIC X(03).             ECSEXT01
   173     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   174                                                                  ECSEXT01
   175     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   176         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   177                                                                  ECSEXT01
   178     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   179     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   180                                                                  ECSEXT01
   181     12  DE-REI-AREA.                                             ECSEXT01
   182         16  DE-REI-COMP.                                         ECSEXT01
   183             20  DE-REINCO                 PIC XXX.               ECSEXT01
   184             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   185         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   186         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   187         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   188         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   189         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   190         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   191         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   192                                                                  ECSEXT01
   193     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   194     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   195         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   196         16  F                             PIC X.
   197*    12  FILLER                            PIC X(5).              ECSEXT01
   198                                                                  ECSEXT01
   199     12  DE-BILLED-AREA.                                          ECSEXT01
   200         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   201             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   202                                                                  ECSEXT01
   203         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   204             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   205             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   206             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   207             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   208             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
   209             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   210                                                                  ECSEXT01
   211         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   212             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   213                                                                  ECSEXT01
   214         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   215         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   216         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   217         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   218                                                                  ECSEXT01
   219         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   220*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   221*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   222                                                                  ECSEXT01
   223     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   224         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   225         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   226         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   227                                                                  ECSEXT01
   228     12  DE-REVERSE-REASONS.                                      ECSEXT01
   229         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   230         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   231     12  DE-CANCEL-REASON                  PIC X.
   232                                                                  ECSEXT01
   233     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   234     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   235                                                                  ECSEXT01
   236     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   237         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   238             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   239         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   240             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   241                                                                  ECSEXT01
   242     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   243         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   244                                                                  ECSEXT01
   245     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   246     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   247         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   248         16  FILLER                        PIC X.
   249                                                                  ECSEXT01
   250****************************************************************  ECSEXT01
   251**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   252****************************************************************  ECSEXT01
   253     12  DE-COMM-LEVELS.                                          ECSEXT01
   254         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   255             20  DE-AGT.                                          ECSEXT01
   256                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   257                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   258             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   259             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   260             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   261                                                                  ECSEXT01
   262     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   263****************************************************************  ECSEXT01
   264*******                 CLAIM EXTRACT                      *****  ECSEXT01
   265****************************************************************  ECSEXT01
   266     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
   267     12  FILLER                            PIC X(334).            ECSEXT01
   268     12  DE-TYPE                           PIC X.                 ECSEXT01
   269         88  DE-DTH                           VALUE '1'.          ECSEXT01
   270         88  DE-AH                            VALUE '2'.          ECSEXT01
   271         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   272         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   273         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   274         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   275                                                                  ECSEXT01
   276     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   277     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   278                                                                  ECSEXT01
   279     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   280     12  DE-REPORTED.                                             ECSEXT01
   281         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   282         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   283         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   284     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   285     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   286                                                                  ECSEXT01
   287     12  DE-CNUM                           PIC X(7).              ECSEXT01
   288     12  DE-CHECK                          PIC X(7).              ECSEXT01
   289     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   290     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   291     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   292     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   293         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   294         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   295         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   296         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   297         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   298         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   299         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   302                                                                  ECSEXT01
   303     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   304     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   305     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   306     12  FILLER                            PIC XX.                ECSEXT01
   307     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   308                                                                  ECSEXT01
   309     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   310     12  DE-BENEFICIARY                    PIC X(10).
   311     12  filler redefines de-beneficiary.
   312         16  de-birth-date                 pic 9(11)  comp-3.
   313         16  f                             pic x(4).
   314     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   315     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   316     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   317     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   318     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   319     12  DE-CLM-CLASS                      PIC XX.
   320     12  DE-CLM-DEV                        PIC XXX.
   321     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   322     12  de-xycor-cert-seq                 pic x(3).
   323     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   324     12  DE-XYCOR-ACTION-CD                PIC XXX.
   325     12  DE-XYCOR-STATUS                   PIC X.
   326     12  FILLER                            PIC X(4).              ECSEXT01
   327                                                                  ECSEXT01
   328     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   329                                                                  ECSEXT01
   330****************************************************************  ECSEXT01
   331*******               RESERVE EXTRACT                      *****  ECSEXT01
   332****************************************************************  ECSEXT01
   333     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   334     12  FILLER                            PIC X(334).            ECSEXT01
   335                                                                  ECSEXT01
   336     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   337         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   338         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   339                                                                  ECSEXT01
   340     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   341     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   342     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   343                                                                  ECSEXT01
   344     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   345                                                                  ECSEXT01
   346     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   347     12  DE-RSV-REPORTED.                                         ECSEXT01
   348         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   349         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   350         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   351     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   352                                                                  ECSEXT01
   353     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   354     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   355     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   356                                                                  ECSEXT01
   357     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   358     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   359     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   360                                                                  ECSEXT01
   361     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS0632.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   362                                                                  ECSEXT01
   363     12  DE-RATE-CLASS                     PIC XX.
   364     12  DE-DEV-CODE                       PIC XXX.
   365     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   366     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   367     12  FILLER                            PIC X(58).             ECSEXT01
   368                                                                  ECSEXT01
   369     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   370******************************************************************ECSEXT01
   371
   372 FD  ERCOMP.
*  373     COPY ERCCOMP.
   374******************************************************************
   375*                                                                *
   376*                                                                *
   377*                            ERCCOMP                             *
   378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   379*                            VMOD=2.019                          *
   380*                                                                *
   381*   ONLINE CREDIT SYSTEM                                         *
   382*                                                                *
   383*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   384*                                                                *
   385*   FILE TYPE = VSAM,KSDS                                        *
   386*   RECORD SIZE = 700   RECFORM = FIXED                          *
   387*                                                                *
   388*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   389*       ALTERNATE PATH = NONE                                    *
   390*                                                                *
   391*   LOG = NO                                                     *
   392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   393*                                                                *
   394******************************************************************
   395*                   C H A N G E   L O G
   396*
   397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   398*-----------------------------------------------------------------
   399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   400* EFFECTIVE    NUMBER
   401*-----------------------------------------------------------------
   402* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   403* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   404* 092205    2005050300006  PEMA  ADD LEASE FEE
   405* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   406* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   407* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   408* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   409* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   410* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   411******************************************************************
   412
   413 01  COMPENSATION-MASTER.
   414     12  CO-RECORD-ID                          PIC XX.
   415         88  VALID-CO-ID                          VALUE 'CO'.
   416
   417     12  CO-CONTROL-PRIMARY.
   418         16  CO-COMPANY-CD                     PIC X.
   419         16  CO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS0632.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   420             20  CO-CTL-1.
   421                 24  CO-CARR-GROUP.
   422                     28  CO-CARRIER            PIC X.
   423                     28  CO-GROUPING.
   424                         32  CO-GROUP-PREFIX   PIC XXX.
   425                         32  CO-GROUP-PRIME    PIC XXX.
   426                 24  CO-RESP-NO.
   427                     28  CO-RESP-PREFIX        PIC X(4).
   428                     28  CO-RESP-PRIME         PIC X(6).
   429             20  CO-CTL-2.
   430                 24  CO-ACCOUNT.
   431                     28  CO-ACCT-PREFIX        PIC X(4).
   432                     28  CO-ACCT-PRIME         PIC X(6).
   433         16  CO-TYPE                           PIC X.
   434             88  CO-COMPANY-TYPE                  VALUE 'C'.
   435             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   436             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   437
   438     12  CO-MAINT-INFORMATION.
   439         16  CO-LAST-MAINT-DT                  PIC XX.
   440         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   441         16  CO-LAST-MAINT-USER                PIC X(4).
   442     12  FILLER                                PIC XX.
   443     12  CO-STMT-TYPE                          PIC XXX.
   444     12  CO-COMP-TYPE                          PIC X.
   445         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   446     12  CO-STMT-OWNER                         PIC X(4).
   447     12  CO-BALANCE-CONTROL                    PIC X.
   448         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   449         88  CO-NO-BALANCE                        VALUE 'N'.
   450
   451     12  CO-INTERNAL-CONTROL-1                 PIC X.
   452         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   453         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   454         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   455
   456     12  CO-INTERNAL-CONTROL-2                 PIC X.
   457         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   458         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   459
   460     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   461     12  CO-GA-DIRECT-DEP                      PIC X.
   462     12  CO-FUTURE-SPACE                       PIC X.
   463         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   464
   465     12  CO-ACCT-NAME                          PIC X(30).
   466     12  CO-MAIL-NAME                          PIC X(30).
   467     12  CO-ADDR-1                             PIC X(30).
   468     12  CO-ADDR-2                             PIC X(30).
   469     12  CO-ADDR-3.
   470         16  CO-ADDR-CITY                      PIC X(27).
   471         16  CO-ADDR-STATE                     PIC XX.
   472     12  CO-CSO-1099                           PIC X.
   473     12  CO-ZIP.
   474         16  CO-ZIP-PRIME.
   475             20  CO-ZIP-PRI-1ST                PIC X.
   476                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   477             20  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS0632.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   478         16  CO-ZIP-PLUS4                      PIC X(4).
   479     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   480         16  CO-CAN-POSTAL-1                   PIC XXX.
   481         16  CO-CAN-POSTAL-2                   PIC XXX.
   482         16  FILLER                            PIC XXX.
   483     12  CO-SOC-SEC                            PIC X(13).
   484     12  CO-TELEPHONE.
   485         16  CO-AREA-CODE                      PIC XXX.
   486         16  CO-PREFIX                         PIC XXX.
   487         16  CO-PHONE                          PIC X(4).
   488
   489     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   490
   491     12  CO-AR-BAL-LEVEL                       PIC X.
   492         88  CO-AR-REF-LVL                        VALUE '1'.
   493         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   494         88  CO-AR-BILL-LVL                       VALUE '2'.
   495         88  CO-AR-AGT-LVL                        VALUE '3'.
   496         88  CO-AR-FR-LVL                         VALUE '4'.
   497
   498     12  CO-AR-NORMAL-PRINT                    PIC X.
   499         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   500         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   501
   502     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   503
   504     12  CO-AR-REPORTING                       PIC X.
   505         88  CO-AR-NET-REPORT                     VALUE 'N'.
   506         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   507
   508     12  CO-AR-PULL-CHECK                      PIC X.
   509         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   510         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   511
   512     12  CO-AR-BALANCE-PRINT                   PIC X.
   513         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   514
   515     12  CO-AR-LAST-RUN-CODE                   PIC X.
   516         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   517         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   518         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   519
   520     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   521
   522     12  CO-USER-CODE                          PIC X.
   523     12  CO-REPORT-GROUP-ID                    PIC X(12).
   524
   525******************************************************************
   526*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   527*    THE LAST MONTH END RUN.
   528******************************************************************
   529
   530     12  CO-LAST-ACTIVITY-DATE.
   531         16  CO-ACT-YEAR                       PIC 99.
   532         16  CO-ACT-MONTH                      PIC 99.
   533         16  CO-ACT-DAY                        PIC 99.
   534
   535     12  CO-LAST-STMT-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS0632.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   536         16  CO-LAST-STMT-YEAR                 PIC 99.
   537         16  CO-LAST-STMT-MONTH                PIC 99.
   538         16  CO-LAST-STMT-DAY                  PIC 99.
   539
   540     12  CO-MO-END-TOTALS.
   541         16  CO-MONTHLY-TOTALS.
   542             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   543             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   544             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   545             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   546             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   547
   548         16  CO-AGING-TOTALS.
   549             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   550             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   551             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   552             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   553
   554         16  CO-YTD-TOTALS.
   555             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   556             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   557
   558         16  CO-OVER-UNDER-TOTALS.
   559             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   560             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   561
   562     12  CO-MISCELLANEOUS-TOTALS.
   563         16  CO-FICA-TOTALS.
   564             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   565             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   566
   567         16  CO-CLAIM-TOTALS.
   568             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   569             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   570
   571******************************************************************
   572*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   573*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   574******************************************************************
   575
   576     12  CO-CURRENT-TOTALS.
   577         16  CO-CURRENT-LAST-STMT-DT.
   578             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   579             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   580             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   581
   582         16  CO-CURRENT-MONTHLY-TOTALS.
   583             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   584             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   585             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   586             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   587             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   588
   589         16  CO-CURRENT-AGING-TOTALS.
   590             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   591             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   592             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   593             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS0632.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   594
   595         16  CO-CURRENT-YTD-TOTALS.
   596             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   597             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   598
   599     12  CO-PAID-COMM-TOTALS.
   600         16  CO-YTD-PAID-COMMS.
   601             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   602             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   603
   604     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   605         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   606         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   607
   608     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   609         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   610         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   611         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   612         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   613         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   614         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   615         88  CO-FINAL-LETTER                  VALUE 'F'.
   616         88  CO-RECONCILING                   VALUE 'R'.
   617         88  CO-PHONE-CALL                    VALUE 'P'.
   618         88  CO-LEGAL                         VALUE 'L'.
   619         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   620         88  CO-WRITE-OFF                     VALUE 'W'.
   621         88  CO-NO-ACTION                     VALUE 'N' ' '.
   622
   623     12  CO-CSR-CODE                       PIC X(4).
   624
   625     12  CO-GA-STATUS-INFO.
   626         16  CO-GA-EFFECTIVE-DT            PIC XX.
   627         16  CO-GA-TERMINATION-DT          PIC XX.
   628         16  CO-GA-STATUS-CODE             PIC X.
   629             88  CO-GA-ACTIVE                 VALUE 'A'.
   630             88  CO-GA-INACTIVE               VALUE 'I'.
   631             88  CO-GA-PENDING                VALUE 'P'.
   632         16  CO-GA-COMMENTS.
   633             20  CO-GA-COMMENT-1           PIC X(40).
   634             20  CO-GA-COMMENT-2           PIC X(40).
   635             20  CO-GA-COMMENT-3           PIC X(40).
   636             20  CO-GA-COMMENT-4           PIC X(40).
   637
   638     12  CO-RPTCD2                         PIC X(10).
   639     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   640         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   641         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   642
   643     12  CO-TYPE-AGENT                     PIC X(01).
   644         88  CO-CORPORATION                   VALUE 'C'.
   645         88  CO-PARTNERSHIP                   VALUE 'P'.
   646         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   647         88  CO-TRUST                         VALUE 'T'.
   648         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   649
   650     12  CO-FAXNO.
   651         16  CO-FAX-AREA-CODE                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS0632.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   652         16  CO-FAX-PREFIX                     PIC XXX.
   653         16  CO-FAX-PHONE                      PIC X(4).
   654
   655     12  CO-BANK-INFORMATION.
   656         16  CO-BANK-TRANSIT-NO                PIC X(8).
   657         16  CO-BANK-TRANSIT-NON REDEFINES
   658             CO-BANK-TRANSIT-NO                PIC 9(8).
   659
   660         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   661     12  CO-MISC-DEDUCT-INFO REDEFINES
   662                  CO-BANK-INFORMATION.
   663         16  CO-MD-GL-ACCT                     PIC X(10).
   664         16  CO-MD-DIV                         PIC XX.
   665         16  CO-MD-CENTER                      PIC X(4).
   666         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   667         16  CO-CREATE-AP-CHECK                PIC X.
   668         16  CO-DELIVER-CK-TO-MEL              PIC X.
   669         16  FILLER                            PIC XXX.
   670     12  CO-ACH-STATUS                         PIC X.
   671         88  CO-ACH-ACTIVE                         VALUE 'A'.
   672         88  CO-ACH-PENDING                        VALUE 'P'.
   673
   674     12  CO-BILL-SW                            PIC X.
   675     12  CO-CONTROL-NAME                       PIC X(30).
   676     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   677     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   678     12  CO-CLP-STATE                          PIC XX.
   679     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   680     12  CO-SPP-REFUND-EDIT                    PIC X.
   681
   682******************************************************************
   683
   684 FD  DISK-DATE
*  685     COPY ELCDTEFD.
   686******************************************************************04/15/98
   687*                                                                *ELCDTEFD
   688*                                                                *ELCDTEFD
   689*                            ELCDTEFD.                           *   LV002
   690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   691*                            VMOD=2.007                          *   CL**2
   692*                                                                *ELCDTEFD
   693******************************************************************ELCDTEFD
   694     BLOCK CONTAINS 0 RECORDS
   695     RECORDING MODE F.                                            ELCDTEFD
   696                                                                  ELCDTEFD
   697 01  DATE-DISK.                                                   ELCDTEFD
   698     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   699     12  FILLER                      PIC  X(14).                  ELCDTEFD
   700     12  DD-CR1                      PIC  9.                      ELCDTEFD
   701     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   702     12  DD-CR2                      PIC  9.                      ELCDTEFD
   703     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   704     12  FILLER                      PIC  X(20).                  ELCDTEFD
   705                                                                  ELCDTEFD
   706 01  DATE-DISK-R.                                                 ELCDTEFD
   707     12  FILLER                      PIC  X(4).                   ELCDTEFD
   708     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   709                                     PIC  X(32).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   710                                                                  ELCDTEFD
   711 01  DATE-DISK-T.                                                 ELCDTEFD
   712     12  FILLER                      PIC  X(4).                   ELCDTEFD
   713     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   714                                     PIC  X(48).                  ELCDTEFD
   715                                                                  ELCDTEFD
   716 01  DATE-DISK-M.                                                 ELCDTEFD
   717     12  FILLER                      PIC  X(4).                   ELCDTEFD
   718     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   719                                     PIC  X(48).                  ELCDTEFD
   720                                                                  ELCDTEFD
   721 01  DATE-DISK-P.                                                 ELCDTEFD
   722     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   723     12  DD-IDX                      PIC  99.                     ELCDTEFD
   724     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   725     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   726         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   727                                     PIC  X.                      ELCDTEFD
   728         16  FILLER                  PIC  X(46).                  ELCDTEFD
   729     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   730         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   731             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   732             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   733             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   734             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   735         16  FILLER                  PIC  X(16).                  ELCDTEFD
   736                                                                  ELCDTEFD
   737 01  DATE-DISK-E.                                                 ELCDTEFD
   738     12  FILLER                      PIC  X(4).                   ELCDTEFD
   739     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   740                                     PIC  X(4).                   ELCDTEFD
   741                                                                  ELCDTEFD
   742 01  DATE-DISK-C.                                                 ELCDTEFD
   743     12  FILLER                      PIC  X(7).                   ELCDTEFD
   744     12  DD-CARR1-SECPAY-SW          PIC  X.
   745     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   746     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   747     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   748     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   749     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   750     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   751     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   752     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   753     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   754     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   755     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   756     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   757     12  DD-CARR2-SECPAY-SW          PIC  X.
   758     12  FILLER                      PIC  X(7).                   ELCDTEFD
   759                                                                  ELCDTEFD
   760 01  DATE-DISK-OPT.                                               ELCDTEFD
   761     12  FILLER                      PIC  X(04).                  ELCDTEFD
   762     12  DD-TLR-DATA.                                             ELCDTEFD
   763         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   764                                     PIC  X(03).                  ELCDTEFD
   765     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   766         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   767                                     PIC  X(06).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   768     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   769         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   770                                     PIC  X(07).                  ELCDTEFD
   771         16  FILLER                  PIC  X(05).                  ELCDTEFD
   772     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   773                                     PIC  X(96).                  ELCDTEFD
   774******************************************************************ELCDTEFD
   775
   776 SD  SORT-WORK.
   777 01  SORT-REC.
   778     12  SORT-KEY             PIC  X(41).
   779     12  SORT-DETAIL          PIC  X(73).
   780
   781 FD  PRNTR
*  782                                 COPY ELCPRTFD.
   783******************************************************************04/15/98
   784*                                                                *ELCPRTFD
   785*                                                                *ELCPRTFD
   786*                            ELCPRTFD.                           *   LV003
   787*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   788*                            VMOD=2.006                          *ELCPRTFD
   789******************************************************************ELCPRTFD
   790     RECORDING MODE F                                             ELCPRTFD
   791     LABEL RECORDS OMITTED                                        ELCPRTFD
   792     BLOCK CONTAINS 0 RECORDS
   793     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   794 01  PRT.                                                         ELCPRTFD
   795     12  P-CTL               PIC  X.                                 CL**2
   796     12  P-DATA              PIC  X(132).                         ELCPRTFD
   797******************************************************************ELCPRTFD
   798
   799 FD  FICH
*  800                                 COPY ELCFCHFD.
   801******************************************************************04/15/98
   802*                                                                *ELCFCHFD
   803*                            ELCFCHFD.                           *   LV003
   804*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   805*                            VMOD=2.004                          *   CL**3
   806*                                                                *ELCFCHFD
   807******************************************************************ELCFCHFD
   808     BLOCK CONTAINS 0 RECORDS
   809     RECORDING MODE F.                                            ELCFCHFD
   810                                                                  ELCFCHFD
   811 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   812******************************************************************ELCFCHFD
   813
   814 WORKING-STORAGE SECTION.
   815 77  FILLER  PIC X(32) VALUE '********************************'.
   816 77  FILLER  PIC X(32) VALUE '   ECS0632  WORKING STORAGE     '.
   817 77  FILLER  PIC X(32) VALUE '********************************'.
   818 77  X1                          PIC S999 VALUE +0 COMP-3.
   819 77  Y1                          PIC S999 VALUE +0 COMP-3.
   820 77  X                           PIC X   VALUE SPACES.
   821 77  WS-SAVE-PRT                 PIC X(133)  VALUE SPACES.
   822 77  WS-BANK-CNT                 PIC S999 VALUE +0 COMP-3.
   823 01  WS-LINE-COUNT            COMP-3  PIC S9(03) VALUE +56.
   824 01  WS-LINE-COUNT-MAX        COMP-3  PIC S9(03) VALUE +55.
   825 01  WS-PAGE                  COMP-3  PIC S9(05) VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS0632.cbl
   826 01  WS-RELEASE-SORT-COUNT    COMP-3  PIC S9(05) VALUE +0.
   827 01  WS-RETURN-SORT-COUNT     COMP-3  PIC S9(05) VALUE +0.
   828 01  WS-BANK-ISSUE-COUNT      COMP-3  PIC S9(05) VALUE +0.
   829 01  WS-AGENT-ISSUE-COUNT     COMP-3  PIC S9(05) VALUE +0.
   830 01  WS-ALL-ISSUE-COUNT       COMP-3  PIC S9(05) VALUE +0.
   831 01  WS-BANK-CANCEL-COUNT     COMP-3  PIC S9(05) VALUE +0.
   832 01  WS-AGENT-CANCEL-COUNT    COMP-3  PIC S9(05) VALUE +0.
   833 01  WS-ALL-CANCEL-COUNT      COMP-3  PIC S9(05) VALUE +0.
   834 01  WS-BANK-BANK-FEE-TOTAL   COMP-3  PIC S9(07)V99 VALUE +0.
   835 01  WS-AGENT-BANK-FEE-TOTAL  COMP-3  PIC S9(07)V99 VALUE +0.
   836 01  WS-ALL-BANK-FEE-TOTAL    COMP-3  PIC S9(07)V99 VALUE +0.
   837 01  WS-CNC-FACT              COMP-3  PIC S9(03)V9(07) VALUE +0.
   838
   839 01  WS-EOF-SW                        PIC  X(01) VALUE SPACE.
   840     88  END-OF-EXTR                             VALUE 'Y'.
   841
   842 01  WS-EOF-SW2                       PIC  X(01) VALUE SPACE.
   843     88  END-OF-SORT-FILE                        VALUE 'Y'.
   844
   845 01  EXTR-RECS-IN                     PIC  9(09) VALUE ZEROS.
   846 01  SUB1                             PIC S9(05) VALUE +0 COMP-3.
   847 01  PGM-SUB                   COMP-3 PIC S9(03) VALUE +0.
   848 01  ERCOMP-STATUS                    PIC  X(02) VALUE SPACES.
   849
   850 01  WS-ALL-SUB-BANKS.
   851     05  FILLER OCCURS 8.
   852         10  WS-SUB-BANK         PIC X(10).
   853         10  WS-SUB-BANK-LVL     PIC 99.
   854 01  WS-MAIN-BANK                PIC X(10).
   855 01  WS-BENEFIT-CODE-SW          PIC  X(01) VALUE SPACE.
   856     88  AH-BEN-CODE-FOUND                  VALUE 'Y'.
   857
   858 01  WS-RECORD-FOUND-SW               PIC  X(01) VALUE SPACE.
   859     88  GOT-MOST-CURRENT                        VALUE 'Y'.
   860
   861 01  WS-FIRST-TIME-SW                 PIC  X(01) VALUE 'Y'.
   862     88  FIRST-TIME                              VALUE 'Y'.
   863     88  NOT-FIRST-TIME                          VALUE 'N'.
   864
   865 01  WS-CHNG-IN-BANK-SW               PIC  X(01) VALUE 'Y'.
   866     88  NEW-BANK                                VALUE 'Y'.
   867     88  SAME-BANK                               VALUE 'N'.
   868
   869 01  WS-ABEND-FIELDS.
   870     05  WS-RETURN-CODE               PIC S9(04) VALUE ZERO.
   871     05  WS-ZERO                      PIC S9(01) VALUE ZERO.
   872     05  WS-ABEND-MESSAGE             PIC  X(80) VALUE SPACES.
   873     05  WS-ABEND-FILE-STATUS         PIC  X(02) VALUE ZERO.
   874
   875***** SAVE AREA  *****
   876 01  WS-SAVE-SORT-KEY-27              PIC  X(27).
   877 01  WS-PREV-AGENT                    PIC  X(10).
   878 01  WS-PREV-BANK                     PIC  X(10).
   879 01  WS-PREV-REC-TYPE                 PIC  X(02).
   880 01  WS-PREV-REFUND-OPT-FLG           PIC  X(01).
   881 01  WS-SAVE-AM-CONTROL-A             PIC  X(19).
   882 01  WS-SAVE-AM-NAME                  PIC  X(30).
   883
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS0632.cbl
   884
   885***** SORT WORK AREA  *****
   886 01  WS-SORT-REC.
   887     05  WS-SORT-KEY.
   888         10  WS-SORT-CARRIER          PIC  X(01) VALUE SPACE.
   889         10  WS-SORT-GROUP            PIC  X(06) VALUE SPACES.
   890         10  WS-SORT-AGENT            PIC  X(10) VALUE SPACES.
   891         10  WS-SORT-BANK             PIC  X(10) VALUE SPACES.
   892         10  WS-SORT-REC-TYPE         PIC  X(02) VALUE SPACES.
   893             88  REC-ISSUE                       VALUE '01'.
   894             88  REC-CANCEL                      VALUE '02'.
   895         10  WS-SORT-REFUND-OPT-FLG   PIC  X(01) VALUE SPACE.
   896             88  NOT-REFUNDABLE-SECTION          VALUE ' '.
   897             88  REFUNDABLE-SECTION              VALUE '*'.
   898         10  WS-SORT-CERT             PIC  X(11) VALUE SPACES.
   899     05  WS-SORT-INSURED-NAME.
   900         10  WS-SORT-LNAME            PIC  X(15) VALUE SPACES.
   901         10  WS-SORT-FNAME            PIC  X(10) VALUE SPACES.
   902         10  WS-SORT-INIT             PIC  X(01) VALUE SPACES.
   903     05  WS-SORT-CERT-EFF-DT          PIC  9(11) VALUE 0.
   904     05  WS-SORT-AGE                  PIC  9(02) VALUE 0.
   905     05  WS-SORT-AH-TERM              PIC S9(03) VALUE +0.
   906     05  WS-SORT-AH-TYPE              PIC  X(03) VALUE SPACES.
   907     05  WS-SORT-PRM-AMT       COMP-3 PIC S9(9)V99 VALUE +0.
   908     05  WS-SORT-AH-CAN-DT            PIC  9(11) VALUE 0.
   909     05  WS-SORT-AH-REFUND     COMP-3 PIC S9(07)V99 VALUE +0.
   910     05  WS-SORT-BANK-FEE      COMP-3 PIC S9(05)V99 VALUE +0.
   911     05  WS-SORT-STATE                PIC  X(02) VALUE SPACES.
   912
   913***** REPORT LAYOUT AREA  *****
   914 01  WS-DETAIL1A.
   915     05 FILLER                       PIC  X(01)  VALUE ' '.
   916     05 FILLER                       PIC  X(02)  VALUE SPACES.
   917     05 WS-D1A-INSURED-NAME          PIC  X(26)  VALUE SPACES.
   918     05 FILLER                       PIC  X(04)  VALUE SPACES.
   919     05 WS-D1A-CERT                  PIC  X(10)  VALUE SPACES.
   920     05 FILLER                       PIC  X(03)  VALUE SPACES.
   921     05 WS-D1A-CERT-EFF-DT.
   922        10  WS-D1A-CERT-EFF-MM       PIC  X(02)  VALUE SPACES.
   923        10  FILLER                   PIC  X(01)  VALUE '/'.
   924        10  WS-D1A-CERT-EFF-DD       PIC  X(02)  VALUE SPACES.
   925        10  FILLER                   PIC  X(01)  VALUE '/'.
   926        10  WS-D1A-CERT-EFF-CCYY     PIC  X(04)  VALUE SPACES.
   927     05 FILLER                       PIC  X(03)  VALUE SPACES.
   928     05 WS-D1A-AGE                   PIC  X(02)  VALUE SPACES.
   929     05 FILLER                       PIC  X(04)  VALUE SPACES.
   930     05 WS-D1A-AH-TERM               PIC  ZZ9.
   931     05 FILLER                       PIC  X(06)  VALUE SPACES.
   932     05 WS-D1A-AH-TYPE               PIC  X(03)  VALUE SPACES.
   933     05 FILLER                       PIC  X(02)  VALUE SPACES.
   934     05 WS-D1A-PRM-AMT               PIC  Z,ZZZ,ZZZ.99-.
   935     05 FILLER                       PIC  X(08)  VALUE SPACES.
   936     05 WS-D1A-BANK-FEE              PIC  Z,ZZZ.99-.
   937     05 FILLER                       PIC  X(24)  VALUE SPACES.
   938
   939 01  WS-DETAIL1B.
   940     05 FILLER                       PIC  X(01)  VALUE ' '.
   941     05 FILLER                       PIC  X(02)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS0632.cbl
   942     05 WS-D1B-INSURED-NAME          PIC  X(26)  VALUE SPACES.
   943     05 FILLER                       PIC  X(04)  VALUE SPACES.
   944     05 WS-D1B-CERT                  PIC  X(10)  VALUE SPACES.
   945     05 FILLER                       PIC  X(03)  VALUE SPACES.
   946     05 WS-D1B-CERT-EFF-DT.
   947        10  WS-D1B-CERT-EFF-MM       PIC  X(02)  VALUE SPACES.
   948        10  FILLER                   PIC  X(01)  VALUE '/'.
   949        10  WS-D1B-CERT-EFF-DD       PIC  X(02)  VALUE SPACES.
   950        10  FILLER                   PIC  X(01)  VALUE '/'.
   951        10  WS-D1B-CERT-EFF-CCYY     PIC  X(04)  VALUE SPACES.
   952     05 FILLER                       PIC  X(03)  VALUE SPACES.
   953     05 WS-D1B-CERT-CANCEL-DT.
   954        10  WS-D1B-CERT-CAN-MM       PIC  X(02)  VALUE SPACES.
   955        10  FILLER                   PIC  X(01)  VALUE '/'.
   956        10  WS-D1B-CERT-CAN-DD       PIC  X(02)  VALUE SPACES.
   957        10  FILLER                   PIC  X(01)  VALUE '/'.
   958        10  WS-D1B-CERT-CAN-CCYY     PIC  X(04)  VALUE SPACES.
   959     05 FILLER                       PIC  X(03)  VALUE SPACES.
   960     05 WS-D1B-AH-TYPE               PIC  X(03)  VALUE SPACES.
   961     05 FILLER                       PIC  X(04)  VALUE SPACES.
   962     05 WS-D1B-PRM-AMT               PIC  Z,ZZZ,ZZZ.99-.
   963     05 FILLER                       PIC  X(04).
   964     05 WS-D1B-REFUND-AMT            PIC  Z,ZZZ,ZZZ.99-.
   965     05 FILLER                       PIC  X(04)  VALUE SPACES.
   966     05 WS-D1B-REFUND-BKFEE          PIC  Z,ZZZ.99-.
   967     05 FILLER                       PIC  X(28)  VALUE SPACES.
   968
   969 01  WS-HD1.
   970     05  FILLER                      PIC  X(01)  VALUE '1'.
   971     05  FILLER                      PIC  X(50)  VALUE SPACES.
   972     05  WS-HD1-TITLE                PIC  X(68)  VALUE
   973         'BANK FEE RECONCILIATION DETAIL'.
   974     05  FILLER                      PIC  X(07)  VALUE 'ECS0632'.
   975     05  FILLER                      PIC  X(07)  VALUE SPACES.
   976
   977 01  WS-HD2.
   978     05  FILLER                      PIC  X(01)  VALUE ' '.
   979     05  FILLER                      PIC  X(50)  VALUE SPACES.
   980     05  WS-HD2-CO                   PIC  X(30)  VALUE SPACES.
   981     05  FILLER                      PIC  X(38)  VALUE SPACES.
   982     05  WS-HD2-RUN-DT               PIC  X(08)  VALUE SPACES.
   983     05  FILLER                      PIC  X(06)  VALUE SPACES.
   984
   985 01  WS-HD3.
   986     05  FILLER                      PIC  X(01)  VALUE ' '.
   987     05  FILLER                      PIC  X(56)  VALUE SPACES.
   988     05  WS-HD3-ALPHA-DT             PIC  X(18)  VALUE SPACES.
   989     05  FILLER                      PIC  X(44)  VALUE SPACES.
   990     05  FILLER                      PIC  X(05)  VALUE 'PAGE'.
   991     05  WS-HD3-PAGE                 PIC  ZZ,ZZ9.
   992     05  FILLER                      PIC  X(03)  VALUE SPACES.
   993
   994 01  WS-HD4-1.
   995     05  FILLER                      PIC  X(01)  VALUE '0'.
   996     05  FILLER                      PIC  X(24)  VALUE
   997         '       REPRESENTATIVE - '.
   998     05  FILLER                      PIC  X(02)  VALUE SPACES.
   999     05  WS-HD4-1-AGENT-NAME         PIC  X(30)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS0632.cbl
  1000     05  FILLER                      PIC  XX     VALUE SPACES.
  1001     05  WS-HD4-1-CARRIER            PIC  X(01)  VALUE SPACES.
  1002     05  WS-HD4-1-GROUP              PIC  X(06)  VALUE SPACES.
  1003     05  FILLER                      PIC  X(01)  VALUE '-'.
  1004     05  WS-HD4-1-AGENT              PIC  X(10)  VALUE SPACES.
  1005     05  FILLER                      PIC  X(50)  VALUE SPACES.
  1006
  1007 01  WS-HD4-2.
  1008     05  FILLER                      PIC  X(01)  VALUE ' '.
  1009     05  FILLER                      PIC  X(26)  VALUE SPACES.
  1010     05  WS-HD4-2-AGENT-ADDRESS1     PIC  X(30)  VALUE SPACES.
  1011     05  FILLER                      PIC  X(71)  VALUE SPACES.
  1012
  1013 01  WS-HD4-3.
  1014     05  FILLER                      PIC  X(01)  VALUE ' '.
  1015     05  FILLER                      PIC  X(26)  VALUE SPACES.
  1016     05  WS-HD4-3-AGENT-ADDRESS2     PIC  X(30)  VALUE SPACES.
  1017     05  FILLER                      PIC  X(71)  VALUE SPACES.
  1018
  1019 01  WS-HD4-4.
  1020     05  FILLER                      PIC  X(01)  VALUE ' '.
  1021     05  FILLER                      PIC  X(26)  VALUE SPACES.
  1022     05  WS-HD4-4-AGENT-ADDRESS3     PIC  X(30)  VALUE SPACES.
  1023     05  FILLER                      PIC  X(71)  VALUE SPACES.
  1024
  1025 01  WS-HD4-5.
  1026     05  FILLER                      PIC  X(01)  VALUE ' '.
  1027     05  FILLER                      PIC  X(26)  VALUE SPACES.
  1028     05  WS-HD4-5-AGENT-ADDRESS4     PIC  X(30)  VALUE SPACES.
  1029     05  FILLER                      PIC  X(71)  VALUE SPACES.
  1030
  1031 01  WS-HD5.
  1032     05  FILLER                      PIC  X(01)  VALUE '0'.
  1033     05  FILLER                      PIC  X(03)  VALUE SPACES.
  1034     05  FILLER                      PIC  X(25)  VALUE
  1035         'FINANCIAL INSTITUTION  - '.
  1036     05  WS-HD5-BANK-NO              PIC  X(10)  VALUE SPACES.
  1037     05  FILLER                      PIC  X(02)  VALUE SPACES.
  1038     05  WS-HD5-BANK-NAME            PIC  X(30)  VALUE SPACES.
  1039     05  FILLER                      PIC  X(74)  VALUE SPACES.
  1040
  1041 01  WS-HD7A.
  1042     05  FILLER                      PIC  X(01)  VALUE ' '.
  1043     05  FILLER                      PIC  X(33)  VALUE SPACES.
  1044     05  FILLER                      PIC  X(08)  VALUE
  1045         'CONTRACT'.
  1046     05  FILLER                      PIC  X(04)  VALUE SPACES.
  1047     05  FILLER                      PIC  X(09)  VALUE
  1048         'EFFECTIVE'.
  1049     05  FILLER                      PIC  X(78)  VALUE SPACES.
  1050
  1051 01  WS-HD8A.
  1052     05  FILLER                      PIC  X(01)  VALUE ' '.
  1053     05  FILLER                      PIC  X(07)  VALUE SPACES.
  1054     05  FILLER                      PIC  X(04)  VALUE
  1055         'NAME'.
  1056     05  FILLER                      PIC  X(23)  VALUE SPACES.
  1057     05  FILLER                      PIC  X(06)  VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS0632.cbl
  1058         'NUMBER'.
  1059     05  FILLER                      PIC  X(08)  VALUE SPACES.
  1060     05  FILLER                      PIC  X(04)  VALUE
  1061         'DATE'.
  1062     05  FILLER                      PIC  X(06)  VALUE SPACES.
  1063     05  FILLER                      PIC  X(03)  VALUE
  1064         'AGE'.
  1065     05  FILLER                      PIC  X(03)  VALUE SPACES.
  1066     05  FILLER                      PIC  X(04)  VALUE
  1067         'TERM'.
  1068     05  FILLER                      PIC  X(04)  VALUE SPACES.
  1069     05  FILLER                      PIC  X(04)  VALUE
  1070         'TYPE'.
  1071     05  FILLER                      PIC  X(04)  VALUE SPACES.
  1072     05  FILLER                      PIC  X(12)  VALUE
  1073*        'FACE AMOUNT'.
  1074         'LUMP SUM FEE'.
  1075     05  FILLER                      PIC  X(06)  VALUE SPACES.
  1076     05  FILLER                      PIC  X(12)  VALUE
  1077         'ADDENDUM FEE'.
  1078     05  FILLER                      PIC  X(22)  VALUE SPACES.
  1079
  1080 01  WS-AGENT-TOTAL-LINE.
  1081     05  FILLER                      PIC  X(01)  VALUE '-'.
  1082     05  FILLER                      PIC  X(28)  VALUE
  1083         '** REPRESENTATIVE TOTALS ** '.
  1084     05  FILLER                      PIC  X(13)  VALUE
  1085         'ISSUE COUNT: '.
  1086     05  WS-BTOT-ISSUE-COUNT         PIC  ZZZ,ZZ9.
  1087     05  FILLER                      PIC  X(03)  VALUE SPACES.
  1088     05  FILLER                      PIC  X(14)  VALUE
  1089         'CANCEL COUNT: '.
  1090     05  WS-BTOT-CANCEL-COUNT        PIC  ZZZ,ZZ9.
  1091     05  FILLER                      PIC  X(02)  VALUE SPACES.
  1092     05  FILLER                      PIC  X(25)  VALUE
  1093         'NET REPRESENTATIVE FEES: '.
  1094     05  WS-BTOT-NET-BANK-FEES       PIC  Z,ZZZ,ZZ9.99-.
  1095*    05  FILLER                      PIC  X(8)  VALUE SPACES.
  1096
  1097 01  WS-FIN-INST-TOTAL-LINE.
  1098     05  FILLER                      PIC  X(01)  VALUE '-'.
  1099     05  FILLER                      PIC  X(21)  VALUE
  1100         '**     TOTALS    **  '.
  1101     05  FILLER                      PIC  X(13)  VALUE
  1102         'ISSUE COUNT: '.
  1103     05  WS-DTOT-ISSUE-COUNT         PIC  ZZZ,ZZ9.
  1104     05  FILLER                      PIC  X(03)  VALUE SPACES.
  1105     05  FILLER                      PIC  X(14)  VALUE
  1106         'CANCEL COUNT: '.
  1107     05  WS-DTOT-CANCEL-COUNT        PIC  ZZZ,ZZ9.
  1108     05  FILLER                      PIC  X(03)  VALUE SPACES.
  1109     05  FILLER                      PIC  X(32)  VALUE
  1110         'NET FINANCIAL INSTITUTION FEES: '.
  1111     05  WS-DTOT-NET-BANK-FEES       PIC  Z,ZZZ,ZZ9.99-.
  1112     05  FILLER                      PIC  X(8)  VALUE SPACES.
  1113
  1114
  1115 01  WS-GRAND-TOTAL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS0632.cbl
  1116     05  FILLER                      PIC  X(01)  VALUE '-'.
  1117     05  FILLER                      PIC  X(21)  VALUE
  1118         '*** GRAND  TOTALS ***'.
  1119     05  FILLER                      PIC  X(07)  VALUE SPACES.
  1120     05  FILLER                      PIC  X(13)  VALUE
  1121         'ISSUE COUNT: '.
  1122     05  WS-GTOT-ISSUE-COUNT         PIC  ZZZ,ZZ9.
  1123     05  FILLER                      PIC  X(05)  VALUE SPACES.
  1124     05  FILLER                      PIC  X(14)  VALUE
  1125         'CANCEL COUNT: '.
  1126     05  WS-GTOT-CANCEL-COUNT        PIC  ZZZ,ZZ9.
  1127     05  FILLER                      PIC  X(05)  VALUE SPACES.
  1128     05  FILLER                      PIC  X(32)  VALUE
  1129         'NET FINANCIAL INSTITUTION FEES: '.
  1130     05  WS-GTOT-NET-BANK-FEES       PIC  Z,ZZZ,ZZ9.99-.
  1131     05  FILLER                      PIC  X(8)  VALUE SPACES.
  1132
  1133
  1134 01  WS-HDR-DASH-LINE.
  1135     05  FILLER                      PIC  X(01)  VALUE ' '.
  1136     05  FILLER                      PIC  X(44)  VALUE
  1137         '--------------------------------------------'.
  1138     05  FILLER                      PIC  X(44)  VALUE
  1139         '--------------------------------------------'.
  1140     05  FILLER                      PIC  X(44)  VALUE
  1141         '--------------------------------------------'.
  1142
  1143
* 1144 COPY ELCDATE.
  1145******************************************************************06/11/98
  1146*                                                                *ELCDATE
  1147*                                                                *ELCDATE
  1148*                            ELCDATE.                            *   LV023
  1149*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1150*                            VMOD=2.003                           ELCDATE
  1151*                                                                *ELCDATE
  1152*                                                                *ELCDATE
  1153*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1154*                 LENGTH = 200                                   *   CL*19
  1155******************************************************************ELCDATE
  1156                                                                  ELCDATE
  1157 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1158     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1159     12  DC-OPTION-CODE                PIC X.                        CL*15
  1160         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1161         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1162         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1163         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1164         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1165         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1166         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1167         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1168         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1169         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1170         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1171         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1172         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1173         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1174         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1175         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1176         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1177         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1178         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1179         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1180         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1181         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1182         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1183         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1184         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1185         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1186         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1187         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1188         88  THREE-CHARACTER-BIN                                  ELCDATE
  1189                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1190         88  GREGORIAN-TO-BIN                                        CL**2
  1191                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1192         88  BIN-TO-GREGORIAN                                        CL**2
  1193                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1194         88  JULIAN-TO-BINARY                                        CL**2
  1195                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1196     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1197         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1198         88  DATE-CONVERSION-ERROR                                ELCDATE
  1199                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1200         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1201         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1202         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1203         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1204         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1205         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1206         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1207         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1208         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1209         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1210     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1211         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1212     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1213         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1214         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1215         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1216     12  FILLER                        PIC X.                        CL*15
  1217     12  DC-CONVERSION-DATES.                                        CL*15
  1218         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1219         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1220         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1221         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1222                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1223             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1224             20  SLASH1-1              PIC X.                        CL*15
  1225             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1226             20  SLASH1-2              PIC X.                        CL*15
  1227             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1228         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1229         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1230                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1231             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232             20  SLASH2-1              PIC X.                        CL*15
  1233             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1234             20  SLASH2-2              PIC X.                        CL*15
  1235             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1236         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1237         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1238                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1239             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1240             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1241             20  DC-YMD-DAY            PIC 99.                       CL*15
  1242         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1243         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1244                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1245             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1246             20  DC-MDY-DAY            PIC 99.                       CL*15
  1247             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1248         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1249             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1250             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1251             20  FILLER                PIC XX.                       CL*15
  1252             20  DC-ALPHA-CENTURY.                                   CL*15
  1253                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1254             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1255         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1256         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1257         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1258         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1259         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1260                                       PIC 9(05).                    CL*20
  1261         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1262             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1263             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1264         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1265         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1266         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1267     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1268         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1269         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1270             20  FILLER                PIC 9(3).                     CL*15
  1271             20  HOLD-CEN-1-CCYY.                                    CL*15
  1272                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1273                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1274             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1275             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1276         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1277             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1278             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1279             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1280                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1281                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1282             20  FILLER                PIC 9(3).                     CL*15
  1283         16  HOLD-CENTURY-1-X.                                       CL*15
  1284             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1285             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1286                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1287                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1288             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1289             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1290         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1291             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1292             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1293             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1294                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1295                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1296             20  FILLER                PIC XXX.                      CL*23
  1297         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1298         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1299         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1300         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1301             20  DC-JULIAN-1-CCYY.                                   CL*15
  1302                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1303                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1304             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1305         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1306         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1307             20  DC-JULIAN-2-CCYY.                                   CL*15
  1308                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1309                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1310             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1311         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1312             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1313             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1314             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1315             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1316             20  DC-EDITA-CCYY.                                      CL*15
  1317                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1318                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1319         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1320             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1321             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1322             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1323             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1324             20  DC-EDITB-CCYY.                                      CL*15
  1325                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1326                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1327         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1328         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1329                              DC-GREG-DATE-CYMD.                  ELCDATE
  1330             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1331             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1332             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1333             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1334         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1335         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1336                              DC-GREG-DATE-MDCY.                  ELCDATE
  1337             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1338             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1339             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1340             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1341    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1342        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1343    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1344    12  FILLER                         PIC X(28).                    CL*26
* 1345 COPY ELCDTECX.
  1346******************************************************************06/05/98
  1347*                                                                *ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348*                            ELCDTECX.                           *   LV005
  1349*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1350*                            VMOD=2.015                          *ELCDTECX
  1351*                                                                *ELCDTECX
  1352*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1353*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1354*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1355*                                                                *ELCDTECX
  1356******************************************************************ELCDTECX
  1357******************************************************************
  1358*                   C H A N G E   L O G
  1359*
  1360* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1361*-----------------------------------------------------------------
  1362*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1363* EFFECTIVE    NUMBER
  1364*-----------------------------------------------------------------
  1365* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1366*                                  BENEFIT CODES FROM 300 TO 900
  1367* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1368* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1369* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1370******************************************************************
  1371 01  DATE-CARD.                                                   ELCDTECX
  1372     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1373     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1374     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1375     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1376     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1377     12  EP-SW                       PIC  X.                      ELCDTECX
  1378         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1379     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1380         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1381     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1382     12  RUN-CENTURY.                                             ELCDTECX
  1383         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1384     12  FILLER                      PIC  X.                         CL**4
  1385     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1386     12  FILLER                      PIC  XXX.                    ELCDTECX
  1387     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1388                                                                  ELCDTECX
  1389 01  FILLER                          PIC  X(7)                       CL**6
  1390                                          VALUE 'OPTIONS'.        ELCDTECX
  1391 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1392     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1393     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1394     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1395         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1396         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1397     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1398     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1399     12  FILLER                      PIC  X.                      ELCDTECX
  1400     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1401     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1402     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1403     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1404     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1405     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1407     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1408     12  FILLER                      PIC  X.                      ELCDTECX
  1409     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1410     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1411     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1412     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1413     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1414     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1415     12  FILLER                      PIC  X.                      ELCDTECX
  1416     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1417     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1418     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1419     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1420     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1421     12  DTE-R78                     PIC  X.                      ELCDTECX
  1422     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1423     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1424     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1425     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1426     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1427     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1428     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1429                                     PIC  X.                      ELCDTECX
  1430         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1431                                                 ' '.             ELCDTECX
  1432         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1433         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1434     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1435         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1436         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1437     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1438     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1439                                     PIC  9.                         CL**4
  1440     12  DTE-SYSTEM.                                              ELCDTECX
  1441         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1442         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1443         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1444         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1445         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1446         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1447         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1448         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1449         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1450         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1451         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1452         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1453         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1454         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1455         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1456         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1457         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1458         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1459         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1460         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1461         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1462         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1463         16  DTE-SYS-W               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1465         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1466         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1467     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1468         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1469                                     PIC  X.                      ELCDTECX
  1470     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1471                                                                  ELCDTECX
  1472 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1473     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1474     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1475     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1476*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1477     12  FILLER                      PIC  X.                      ELCDTECX
  1478     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1479     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1480     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1481     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1482     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1483     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1484     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1485                                                                  ELCDTECX
  1486     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1487     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1488     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1489     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1490                                                                  ELCDTECX
  1491     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1492     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1493     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1494     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1495                                                                  ELCDTECX
  1496     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1497     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1498                                                                  ELCDTECX
  1499     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1500     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1501                                                                  ELCDTECX
  1502     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1503                                                                  ELCDTECX
  1504 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1505     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1506     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1507     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1508     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1509     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1510     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1511     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1512                                                                  ELCDTECX
  1513 01  FILLER                          PIC  X(12)                   ELCDTECX
  1514                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1515 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1516     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1517         16  CNT-ID                  PIC  X.                      ELCDTECX
  1518         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1519                                                                  ELCDTECX
  1520 01  FILLER                          PIC  X(11)                   ELCDTECX
  1521                                          VALUE 'STATE NAMES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1522 01  STATE-NAMES.                                                 ELCDTECX
  1523     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1524         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1525         16  STATE-PIC1.                                          ELCDTECX
  1526             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1527             20  FILLER              PIC  XXX.                    ELCDTECX
  1528             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1529             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1530             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1531             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1532                                                                  ELCDTECX
  1533 01  FILLER                          PIC  X(13)                   ELCDTECX
  1534                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1535 01  CARRIER-NAMES.                                               ELCDTECX
  1536     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1537         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1538         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1539         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1540         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1541         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1542         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1543*        16  FILLER                  PIC  X.                      ELCDTECX
  1544         16  CARRIER-SEC-PAY         PIC  X.
  1545             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1546                                                                  ELCDTECX
  1547 01  FILLER                          PIC  X(9)                       CL**6
  1548                                          VALUE 'INS TYPES'.      ELCDTECX
  1549 01  CLAS-INS-TYPES.                                              ELCDTECX
  1550*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1551     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1552         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1553         16  CLAS-I-AB3.                                          ELCDTECX
  1554             20  FILLER              PIC  X.                      ELCDTECX
  1555             20  CLAS-I-AB2.                                      ELCDTECX
  1556                 24  FILLER          PIC  X.                      ELCDTECX
  1557                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1558         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1559             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1560             20  FILLER              PIC  X.                         CL**4
  1561         16  CLAS-I-AB10.                                         ELCDTECX
  1562             20  FILLER              PIC  X(9).                   ELCDTECX
  1563             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1564         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1565         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1566         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1567         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1568             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1569         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1570         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1571         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1572         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1573         16  CLAS-I-REFUND-METHOD    PIC  X.
  1574         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1575         16  FILLER                  PIC  XXX.
  1576                                                                  ELCDTECX
  1577 01  FILLER                          PIC  X(16)                   ELCDTECX
  1578                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1579 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1580     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1581                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1582         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1583         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1584         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1585         16  CLAS-MORT-DESC.                                      ELCDTECX
  1586             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1587             20  FILLER              PIC  XX.                        CL**5
  1588             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1589             20  FILLER              PIC  X.                         CL**5
  1590             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1591             20  FILLER              PIC  X.                         CL**5
  1592             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1593             20  FILLER              PIC  X.                         CL**5
  1594             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1595             20  FILLER              PIC  X(5).                      CL**6
  1596                                                                  ELCDTECX
  1597 01  FILLER                          PIC  X(15)                   ELCDTECX
  1598                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1599 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1600     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1601         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1602         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1603         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1604         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1605         16  FILLER                  PIC  X(4).                      CL**6
  1606                                                                  ELCDTECX
  1607 01  FILLER                          PIC  X(7)                       CL**6
  1608                                     VALUE 'INDEXES'.             ELCDTECX
  1609 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1610     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1611     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1612     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1613     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1614     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1615     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1616     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1617     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1618     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1619     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1620     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1621     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1622     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1623     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1624     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1625     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1626     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1627                                                                  ELCDTECX
  1628 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1629     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1630     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1631     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1632     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1633     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1634     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1635     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1636     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1637     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1638     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1639     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1640                                                                  ELCDTECX
  1641 01  FILLER                          PIC  X(13)                   ELCDTECX
  1642                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1643 01  CLAS-MISC.                                                   ELCDTECX
  1644     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1645         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1646         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1647         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1648     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1649     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1650     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1651     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1652     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1653     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1654     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1655     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1656     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1657     12  STATE-L                     PIC  XX.                     ELCDTECX
  1658     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1659     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1660     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1661         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1662         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1663     12  DTE-ABEND-WORK.                                          ELCDTECX
  1664         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1665         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1666                                                                  ELCDTECX
  1667 01  FILLER                          PIC  X(12)                   ELCDTECX
  1668                                     VALUE 'WORKING DATE'.        ELCDTECX
  1669 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1670     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1671         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1672         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1673         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1674     12  WS-CURRENT-DATE.                                         ELCDTECX
  1675         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1676         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1677         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1678         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1679         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1680     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1681         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1682         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1683                                                                  ELCDTECX
  1684 01  FILLER                          PIC  X(12)                   ELCDTECX
  1685                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1686 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1687     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1688         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1689         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1690         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1691                                                                  ELCDTECX
  1692 01  FILLER                          PIC  X(10)                   ELCDTECX
  1693                                     VALUE 'STATE TLRS'.          ELCDTECX
  1694 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1695     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1696         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1697         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1698                                                                  ELCDTECX
  1699 01  FILLER                          PIC  X(13)                   ELCDTECX
  1700                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1701 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1702     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1703         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1704                                                                  ELCDTECX
  1705 01  FILLER                          PIC  X(13)                   ELCDTECX
  1706                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1707 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1708     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1709     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1710     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1711                                     PIC  X.                         CL**5
  1712     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1713     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1714     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1715     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1716     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1717     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1718     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1719     12  FILLER                      PIC  X(75).                  ELCDTECX
  1720******************************************************************ELCDTECX
  1721*01  MISC-CARR-PCT-DATA.                                          00001521
  1722*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1723*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1724*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1725*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1726*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1727*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1728******************************************************************ELCDTECX
* 1729 COPY ELCDTEVR.
  1730***************************************************************** 04/15/98
  1731*                                                                *ELCDTEVR
  1732*                                                                *ELCDTEVR
  1733*                            ELCDTEVR.                           *   LV003
  1734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1735*                            VMOD=2.001                          *   CL**2
  1736*                                                                *ELCDTEVR
  1737*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1738*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1739*                                                                *ELCDTEVR
  1740******************************************************************ELCDTEVR
  1741 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1742     05  WS-RUN-DATE.                                             ELCDTEVR
  1743         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1744         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1745         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1746             15  RUN-CC              PIC  99.                     ELCDTEVR
  1747             15  RUN-YR              PIC  99.                     ELCDTEVR
  1748         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1749         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1750     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1751            WS-RUN-DATE              PIC 9(11).                      CL**2
  1752     05  WS-EP-DT.                                                ELCDTEVR
  1753         10  FILLER                  PIC  9(03).                  ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1754         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1755         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1756             15  EP-CC               PIC  99.                     ELCDTEVR
  1757             15  EP-YR               PIC  99.                     ELCDTEVR
  1758         10  EP-MO                   PIC  99.                     ELCDTEVR
  1759         10  EP-DA                   PIC  99.                     ELCDTEVR
  1760     05  WS-EP-DT-N REDEFINES                                        CL**2
  1761            WS-EP-DT                 PIC 9(11).                      CL**2
  1762     05  WS-DTE-CONV-DT.                                             CL**4
  1763         10  FILLER                  PIC  9(03).                     CL**4
  1764         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1765         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1766             15  DTE-CONV-CC         PIC  99.                        CL**4
  1767             15  DTE-CONV-YR         PIC  99.                        CL**4
  1768         10  DTE-CONV-MO             PIC  99.                        CL**4
  1769         10  DTE-CONV-DA             PIC  99.                        CL**4
  1770     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1771            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1772 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1773     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1774         10  FILLER                            PIC 999.           ELCDTEVR
  1775         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1776         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1777             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1778             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1779         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1780         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1781     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1782            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1783     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1784         10  FILLER                            PIC 999.           ELCDTEVR
  1785         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1786         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1787         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1788         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1789     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1790            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1791 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1792     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1793         10  FILLER                            PIC 999.           ELCDTEVR
  1794         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1795         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1796             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1797             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1798         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1799         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1800     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1801            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1802     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1803         10  FILLER                            PIC 999.           ELCDTEVR
  1804         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1805         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1806             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1807             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1808         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1809         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1810     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1811            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1812     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1813         10  FILLER                            PIC 999.           ELCDTEVR
  1814         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1815         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1816             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1817             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1818         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1819         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1820     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1821            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1822 01  WS-RATE-RECORD.                                              ELCDTEVR
  1823         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1824             10  FILLER                        PIC 999.           ELCDTEVR
  1825             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1826             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1827                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1828                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1829             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1830             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1831         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1832                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1833
  1834 PROCEDURE DIVISION.
  1835
  1836******************************************************************
  1837***        D A T E   C A R D   L O A D   R O U T I N E         ***
  1838******************************************************************
  1839
* 1840     COPY ELCDTERX.
  1841******************************************************************04/15/98
  1842*                                                                *ELCDTERX
  1843*                                                                *ELCDTERX
  1844*                            ELCDTERX.                           *   LV002
  1845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1846*                            VMOD=2.007                          *ELCDTERX
  1847*                                                                *ELCDTERX
  1848*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1849*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1850*      = ELCDTEFD)                                               *ELCDTERX
  1851*                                                                *ELCDTERX
  1852******************************************************************ELCDTERX
  1853                                                                  ELCDTERX
  1854     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1855                                                                  ELCDTERX
  1856     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1857     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1858     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1859                                                                  ELCDTERX
  1860     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1861                                                                  ELCDTERX
  1862******************************************************************ELCDTERX
  1863*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1864*          WARNING MESSAGES.                                      ELCDTERX
  1865******************************************************************ELCDTERX
  1866     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1867         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1868                                                                  ELCDTERX
  1869     OPEN INPUT DISK-DATE.                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1870                                                                  ELCDTERX
  1871     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1872                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1873                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1874                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1875                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1876                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1877                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1878                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1879                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1880                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1881                                                                  ELCDTERX
  1882     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1883                                                                  ELCDTERX
  1884     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1885                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1886                                                                  ELCDTERX
  1887     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1888     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1889     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1890     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1891                                                                  ELCDTERX
  1892     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1893         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1894     ELSE                                                         ELCDTERX
  1895         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1896                                                                  ELCDTERX
  1897     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1898         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1899     ELSE                                                         ELCDTERX
  1900         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1901                                                                  ELCDTERX
  1902 0005-READ--CARD.                                                 ELCDTERX
  1903     READ DISK-DATE                                               ELCDTERX
  1904         AT END CLOSE DISK-DATE                                   ELCDTERX
  1905             GO TO 0060-READ--TEST.                               ELCDTERX
  1906                                                                  ELCDTERX
  1907     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1908                                                                  ELCDTERX
  1909     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1910         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1911         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1912         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1913         GO TO 0005-READ--CARD.                                   ELCDTERX
  1914                                                                  ELCDTERX
  1915     IF DD-ID = 'CLAD'                                            ELCDTERX
  1916         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1917         GO TO 0005-READ--CARD.                                   ELCDTERX
  1918                                                                  ELCDTERX
  1919     IF DD-ID = 'CLAX'                                            ELCDTERX
  1920         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1921         GO TO 0005-READ--CARD.                                   ELCDTERX
  1922                                                                  ELCDTERX
  1923     IF DD-ID = 'CLAF'                                            ELCDTERX
  1924         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1925         GO TO 0005-READ--CARD.                                   ELCDTERX
  1926                                                                  ELCDTERX
  1927     IF DD-ID = 'CLAC'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1928         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1929                                                                  ELCDTERX
  1930     IF DD-ID = 'CARR'                                            ELCDTERX
  1931         GO TO 0015-READ--CARR.                                   ELCDTERX
  1932                                                                  ELCDTERX
  1933     IF DD-ID = 'STAT'                                            ELCDTERX
  1934         GO TO 0020-READ--STAT.                                   ELCDTERX
  1935                                                                  ELCDTERX
  1936     IF DD-ID = 'BUSC'                                            ELCDTERX
  1937         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1938                                                                  ELCDTERX
  1939     IF DD-ID = 'MORT'                                            ELCDTERX
  1940         GO TO 0030-READ--MORT.                                   ELCDTERX
  1941                                                                  ELCDTERX
  1942     IF DD-ID = 'CLAI'                                            ELCDTERX
  1943         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1944                                                                  ELCDTERX
  1945     IF DD-ID = 'COLC'                                            ELCDTERX
  1946         GO TO 0065-READ--COLC.                                   ELCDTERX
  1947                                                                  ELCDTERX
  1948     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1949        DD-IDA = 'CL'                                             ELCDTERX
  1950         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1951                                                                  ELCDTERX
  1952     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1953        DD-IDA = 'PO'                                             ELCDTERX
  1954         GO TO 0050-READ--POXX.                                   ELCDTERX
  1955                                                                  ELCDTERX
  1956     IF DD-ID = 'OPCA'                                            ELCDTERX
  1957         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1958                                                                  ELCDTERX
  1959     IF DD-ID = 'OPST'                                            ELCDTERX
  1960         GO TO 0072-READ--OPST.                                   ELCDTERX
  1961                                                                  ELCDTERX
  1962     IF DD-ID = 'OPBS'                                            ELCDTERX
  1963         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1964                                                                  ELCDTERX
  1965     IF DD-ID = 'OPMS'                                            ELCDTERX
  1966         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1967                                                                  ELCDTERX
  1968     GO TO 0005-READ--CARD.                                       ELCDTERX
  1969                                                                  ELCDTERX
  1970 0010-READ--CLAC.                                                 ELCDTERX
  1971     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1972     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1973     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1974     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1975     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1976     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1977     GO TO 0005-READ--CARD.                                       ELCDTERX
  1978                                                                  ELCDTERX
  1979 0015-READ--CARR.                                                 ELCDTERX
  1980     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1981     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1982        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1983        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1984        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1985        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1986        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1987        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1988        MOVE DD-CARR1-SECPAY-SW
  1989                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1990     END-IF
  1991                                                                  ELCDTERX
  1992     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1993     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1994        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1995        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1996        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1997        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1998        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1999        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2000        MOVE DD-CARR2-SECPAY-SW
  2001                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2002     END-IF
  2003                                                                  ELCDTERX
  2004                                                                  ELCDTERX
  2005     GO TO 0005-READ--CARD.                                       ELCDTERX
  2006                                                                  ELCDTERX
  2007 0020-READ--STAT.                                                 ELCDTERX
  2008     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2009     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2010        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2011         GO TO 0005-READ--CARD.                                   ELCDTERX
  2012                                                                  ELCDTERX
  2013     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2014     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2015     GO TO 0020-READ--STAT.                                       ELCDTERX
  2016                                                                  ELCDTERX
  2017 0025-READ--BUSC.                                                 ELCDTERX
  2018     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2019     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2020        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2021         GO TO 0005-READ--CARD.                                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2024     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2025     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2026                                                                  ELCDTERX
  2027 0030-READ--MORT.                                                 ELCDTERX
  2028     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2029     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2030        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2031         GO TO 0005-READ--CARD.                                   ELCDTERX
  2032                                                                  ELCDTERX
  2033     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2034     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2035     GO TO 0030-READ--MORT.                                       ELCDTERX
  2036                                                                  ELCDTERX
  2037 0035-READ--CLXX.                                                 ELCDTERX
  2038     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2039          GO TO 0005-READ--CARD.                                  ELCDTERX
  2040                                                                  ELCDTERX
  2041     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2042         DISPLAY '***********************************************'ELCDTERX
  2043         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2044         DISPLAY '***********************************************'ELCDTERX
  2045         GO TO 0055-READ--STOP.                                   ELCDTERX
  2046                                                                  ELCDTERX
  2047     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2048        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2049         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2050                                                                  ELCDTERX
  2051     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2052        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2053         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2054                                                                  ELCDTERX
  2055*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2056     GO TO 0005-READ--CARD.                                       ELCDTERX
  2057                                                                  ELCDTERX
  2058 0040-READ--CLAI.                                                 ELCDTERX
  2059     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2060     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2061        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2062         GO TO 0005-READ--CARD.                                   ELCDTERX
  2063                                                                  ELCDTERX
  2064     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2065     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2066     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2067                                                                  ELCDTERX
  2068 0045-READ--DUMP.                                                 ELCDTERX
  2069     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2070     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2071                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2072     PERFORM ABEND-PGM.                                           ELCDTERX
  2073                                                                  ELCDTERX
  2074 0050-READ--POXX.                                                 ELCDTERX
  2075     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2076         GO TO 0005-READ--CARD.                                   ELCDTERX
  2077                                                                  ELCDTERX
  2078     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2079         DISPLAY '***********************************************'ELCDTERX
  2080         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2081         DISPLAY '***********************************************'ELCDTERX
  2082         GO TO 0055-READ--STOP.                                   ELCDTERX
  2083                                                                  ELCDTERX
  2084     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2085     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2086     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2087     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2088                                                                  ELCDTERX
  2089     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2090         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2091     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2092         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2093                                                                  ELCDTERX
  2094     GO TO 0005-READ--CARD.                                       ELCDTERX
  2095                                                                  ELCDTERX
  2096 0055-READ--STOP.                                                 ELCDTERX
  2097     GOBACK.                                                      ELCDTERX
  2098                                                                  ELCDTERX
  2099 0060-READ--TEST.                                                 ELCDTERX
  2100     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2101        CLAX-ID         = SPACE  OR                               ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS0632.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2102        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2103         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2104                                                                  ELCDTERX
  2105     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2106     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2107                                                                  ELCDTERX
  2108 0065-READ--COLC.                                                 ELCDTERX
  2109     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2110     GO TO 0005-READ--CARD.                                       ELCDTERX
  2111                                                                  ELCDTERX
  2112 0070-READ--OPCA.                                                 ELCDTERX
  2113                                                                  ELCDTERX
  2114     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2115                                                                  ELCDTERX
  2116     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2117             OR                                                   ELCDTERX
  2118         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2119         GO TO 0005-READ--CARD.                                   ELCDTERX
  2120                                                                  ELCDTERX
  2121     ADD 1                       TO INDEXCA.                      ELCDTERX
  2122     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2123                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2124     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2125                                                                  ELCDTERX
  2126 0072-READ--OPST.                                                 ELCDTERX
  2127                                                                  ELCDTERX
  2128     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2129                                                                  ELCDTERX
  2130     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2131             OR                                                   ELCDTERX
  2132         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2133         GO TO 0005-READ--CARD.                                   ELCDTERX
  2134                                                                  ELCDTERX
  2135     ADD 1                       TO INDEXST.                      ELCDTERX
  2136     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2137                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2138     GO TO 0072-READ--OPST.                                       ELCDTERX
  2139                                                                  ELCDTERX
  2140 0074-READ--OPBS.                                                 ELCDTERX
  2141                                                                  ELCDTERX
  2142     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2143                                                                  ELCDTERX
  2144     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2145             OR                                                   ELCDTERX
  2146         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2147         GO TO 0005-READ--CARD.                                   ELCDTERX
  2148                                                                  ELCDTERX
  2149     ADD 1                       TO INDEXBS.                      ELCDTERX
  2150     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2151     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2152                                                                  ELCDTERX
  2153 0079-READ--EXIT.                                                 ELCDTERX
  2154*    EXIT.                                                        ELCDTERX
  2155******************************************************************ELCDTERX
  2156******************************************************************
  2157
  2158     PERFORM 0400-OPEN-FILES       THRU 0400-EXIT
  2159     PERFORM 0600-INITIALIZE       THRU 0600-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS0632.cbl
  2160
  2161     SORT SORT-WORK ASCENDING KEY  SORT-KEY
  2162         INPUT PROCEDURE
  2163             0100-INPUT-ROUTINE    THRU 0100-EXIT
  2164         OUTPUT PROCEDURE
  2165             0200-OUTPUT-ROUTINE   THRU 0200-EXIT
  2166
  2167     IF SORT-RETURN NOT = ZERO
  2168         MOVE 'SORT FAILED'        TO WS-ABEND-MESSAGE
  2169         MOVE SORT-RETURN          TO WS-RETURN-CODE
  2170         PERFORM ABEND-PGM         THRU APS-EXIT
  2171     END-IF
  2172
  2173     PERFORM 0500-CLOSE-FILES      THRU 0500-EXIT
  2174
  2175     DISPLAY ' EXTR RECORDS READ    '  EXTR-RECS-IN
  2176     DISPLAY ' SORT RECORDS RELEASED '  WS-RELEASE-SORT-COUNT
  2177     DISPLAY ' SORT RECORDS RETURNED '  WS-RETURN-SORT-COUNT
  2178     DISPLAY ' WS LINE COUNT '  WS-LINE-COUNT
  2179
  2180     GOBACK
  2181
  2182     .
  2183 0100-INPUT-ROUTINE.
  2184
  2185     PERFORM 0110-PROCESS-EXTR     THRU 0110-EXIT
  2186         UNTIL END-OF-EXTR
  2187
  2188     .
  2189 0100-EXIT.
  2190     EXIT.
  2191
  2192
  2193 0110-PROCESS-EXTR.
  2194
  2195     IF (DE-REIN NOT = 'R')
  2196        AND (DE-ISSUE OR DE-CANCEL)
  2197        AND (DE-AH-TYPE NOT = '  ' AND '00')
  2198        MOVE DE-AH-TYPE          TO CLAS-LOOK
  2199        MOVE SPACE               TO WS-BENEFIT-CODE-SW
  2200        MOVE CLAS-STARTA         TO CLAS-INDEXA
  2201        PERFORM 0150-FIND-AH-BEN-CODE
  2202                                 THRU 0150-EXIT UNTIL
  2203           AH-BEN-CODE-FOUND
  2204        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  2205           MOVE +0               TO WS-BANK-CNT
  2206           PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2207              X1 > +10
  2208              IF DE-AGT-TYPE (X1) = 'B'
  2209                 ADD +1          TO WS-BANK-CNT
  2210              END-IF
  2211           END-PERFORM
  2212           IF WS-BANK-CNT > +1
  2213              PERFORM 0111-BUILD-SORT-RECS
  2214                                 THRU 0111-EXIT
  2215           END-IF
  2216        END-IF
  2217     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS0632.cbl
  2218
  2219     PERFORM 0120-READ-EXTR      THRU 0120-EXIT
  2220     .
  2221 0110-EXIT.
  2222     EXIT.
  2223
  2224 0111-BUILD-SORT-RECS.
  2225
  2226     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2227        DE-AGT-TYPE (X1) = 'B'
  2228     END-PERFORM
  2229
  2230     MOVE DE-AGT (X1)            TO WS-MAIN-BANK
  2231     ADD +1                      TO X1
  2232     MOVE +1                     TO Y1
  2233     MOVE SPACES                 TO WS-ALL-SUB-BANKS
  2234
  2235     PERFORM VARYING X1 FROM X1 BY +1 UNTIL
  2236        X1 > +10
  2237        IF DE-AGT-TYPE (X1) = 'B'
  2238           MOVE DE-AGT (X1)      TO WS-SUB-BANK (Y1)
  2239           MOVE X1               TO WS-SUB-BANK-LVL (Y1)
  2240           ADD +1                TO Y1
  2241        END-IF
  2242     END-PERFORM
  2243
  2244     INITIALIZE                  WS-SORT-REC
  2245     MOVE DE-CARRIER             TO WS-SORT-CARRIER
  2246     MOVE DE-GROUPING            TO WS-SORT-GROUP
  2247     MOVE WS-MAIN-BANK           TO WS-SORT-BANK
  2248     MOVE DE-CERT                TO WS-SORT-CERT
  2249
  2250     MOVE DE-EFF                 TO WS-SORT-CERT-EFF-DT
  2251     MOVE DE-LNAME               TO WS-SORT-LNAME
  2252     MOVE DE-FNAME               TO WS-SORT-FNAME
  2253     MOVE DE-INIT                TO WS-SORT-INIT
  2254     MOVE DE-AGE                 TO WS-SORT-AGE
  2255     MOVE DE-AH-TERM             TO WS-SORT-AH-TERM
  2256     MOVE DE-AH-TYPE             TO WS-SORT-AH-TYPE
  2257     MOVE DE-STATE               TO WS-SORT-STATE
  2258
  2259     IF DE-ISSUE
  2260        MOVE '01'                TO WS-SORT-REC-TYPE
  2261        MOVE DE-AH-PRM           TO WS-SORT-PRM-AMT
  2262     ELSE
  2263        MOVE '02'                TO WS-SORT-REC-TYPE
  2264        MOVE DE-AH-PRM           TO WS-SORT-PRM-AMT
  2265        MOVE DE-AH-CANC-DTE      TO WS-SORT-AH-CAN-DT
  2266        MOVE DE-AH-RFND          TO WS-SORT-AH-REFUND
  2267     END-IF
  2268
  2269     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  2270        (X1 > +8)
  2271        OR (WS-SUB-BANK (X1) = SPACES)
  2272        MOVE WS-SUB-BANK-LVL (X1) TO Y1
  2273
  2274        MOVE WS-SUB-BANK (X1)    TO WS-SORT-AGENT
  2275        IF DE-ISSUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS0632.cbl
  2276           COMPUTE WS-SORT-BANK-FEE = DE-A-PC (Y1) * 1000
  2277        ELSE
  2278           COMPUTE WS-CNC-FACT = DE-AH-RFND / DE-AH-PRM
  2279           COMPUTE WS-SORT-BANK-FEE = DE-A-PC (Y1) *
  2280              WS-CNC-FACT * 1000
  2281        END-IF
  2282
  2283        MOVE SPACES              TO WS-SORT-REFUND-OPT-FLG
  2284        RELEASE SORT-REC         FROM WS-SORT-REC
  2285        ADD +1                   TO WS-RELEASE-SORT-COUNT
  2286     END-PERFORM
  2287
  2288     .
  2289 0111-EXIT.
  2290     EXIT.
  2291
  2292
  2293 0120-READ-EXTR.
  2294
  2295     READ EXTR-FILE-IN AT END
  2296        SET END-OF-EXTR          TO TRUE
  2297     END-READ
  2298
  2299     IF NOT END-OF-EXTR
  2300        ADD +1                   TO EXTR-RECS-IN
  2301     END-IF
  2302
  2303     .
  2304 0120-EXIT.
  2305     EXIT.
  2306
  2307 0150-FIND-AH-BEN-CODE.
  2308
  2309     IF CLAS-INDEXA GREATER CLAS-MAXA
  2310         DISPLAY 'AH BENEFIT ' CLAS-LOOK ' NOT ON FILE'
  2311         PERFORM ABEND-PGM          THRU APS-EXIT
  2312     END-IF
  2313
  2314     IF CLAS-I-BEN (CLAS-INDEXA) = CLAS-LOOK
  2315         SET AH-BEN-CODE-FOUND   TO TRUE
  2316     ELSE
  2317         ADD +1                  TO  CLAS-INDEXA
  2318     END-IF
  2319
  2320     .
  2321 0150-EXIT.
  2322     EXIT.
  2323
  2324
  2325 0200-OUTPUT-ROUTINE.
  2326
  2327*    PERFORM 0300-HDR1-TO-HDR5   THRU 0300-EXIT
  2328
  2329     PERFORM 0215-RETURN-SORT    THRU 0215-EXIT
  2330
  2331     IF WS-RETURN-SORT-COUNT NOT = ZEROS
  2332        MOVE WS-SORT-AGENT       TO WS-PREV-AGENT
  2333        MOVE WS-SORT-BANK        TO WS-PREV-BANK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS0632.cbl
  2334        MOVE DTE-CLASIC-COMPANY-CD
  2335                                 TO CO-COMPANY-CD
  2336        MOVE WS-SORT-CARRIER     TO CO-CARRIER
  2337        MOVE WS-SORT-GROUP       TO CO-GROUPING
  2338        MOVE WS-SORT-BANK        TO CO-RESP-NO
  2339        MOVE LOW-VALUES          TO CO-ACCOUNT
  2340        MOVE 'B'                 TO CO-TYPE
  2341        PERFORM 0295-GET-BANK-NAMES
  2342                                 THRU 0295-EXIT
  2343        MOVE DTE-CLASIC-COMPANY-CD
  2344                                 TO CO-COMPANY-CD
  2345        MOVE WS-SORT-CARRIER     TO CO-CARRIER
  2346        MOVE WS-SORT-GROUP       TO CO-GROUPING
  2347        MOVE WS-SORT-AGENT       TO CO-RESP-NO
  2348        MOVE LOW-VALUES          TO CO-ACCOUNT
  2349        MOVE 'G'                 TO CO-TYPE
  2350        PERFORM 0290-GET-AGENT-NAMES
  2351                                 THRU 0290-EXIT
  2352        MOVE WS-SORT-CARRIER     TO WS-HD4-1-CARRIER
  2353        MOVE WS-SORT-GROUP       TO WS-HD4-1-GROUP
  2354        MOVE WS-SORT-AGENT       TO WS-HD4-1-AGENT
  2355
  2356        PERFORM 0210-PROCESS-SORT THRU 0210-EXIT UNTIL
  2357           END-OF-SORT-FILE
  2358*       MOVE +0                  TO WS-LINE-COUNT
  2359        PERFORM 0220-BANK-BREAK  THRU 0220-EXIT
  2360        PERFORM 0230-AGENT-BREAK THRU 0230-EXIT
  2361        PERFORM 0240-FINAL-BREAK THRU 0240-EXIT
  2362     ELSE
  2363        DISPLAY ' NO RECORDS TO PROCESS '
  2364     END-IF
  2365
  2366     .
  2367 0200-EXIT.
  2368     EXIT.
  2369
  2370
  2371 0210-PROCESS-SORT.
  2372
  2373     IF WS-SORT-AGENT NOT = WS-PREV-AGENT
  2374        PERFORM 0220-BANK-BREAK  THRU 0220-EXIT
  2375        PERFORM 0230-AGENT-BREAK THRU 0230-EXIT
  2376     ELSE
  2377        IF WS-SORT-BANK NOT = WS-PREV-BANK
  2378           PERFORM 0220-BANK-BREAK
  2379                                 THRU 0220-EXIT
  2380           MOVE WS-HD5           TO PRT
  2381           PERFORM 8800-PRINT-RTN
  2382                                 THRU 8800-EXIT
  2383        END-IF
  2384     END-IF
  2385
  2386     IF REC-ISSUE
  2387        ADD WS-SORT-BANK-FEE     TO WS-BANK-BANK-FEE-TOTAL
  2388        ADD +1                   TO WS-BANK-ISSUE-COUNT
  2389
  2390        MOVE WS-SORT-INSURED-NAME
  2391                                 TO WS-D1A-INSURED-NAME
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS0632.cbl
  2392        MOVE WS-SORT-CERT        TO WS-D1A-CERT
  2393        MOVE WS-SORT-CERT-EFF-DT (4:4)
  2394                                 TO WS-D1A-CERT-EFF-CCYY
  2395        MOVE WS-SORT-CERT-EFF-DT (8:2)
  2396                                 TO WS-D1A-CERT-EFF-MM
  2397        MOVE WS-SORT-CERT-EFF-DT (10:2)
  2398                                 TO WS-D1A-CERT-EFF-DD
  2399        MOVE WS-SORT-AGE         TO WS-D1A-AGE
  2400        MOVE WS-SORT-AH-TERM     TO WS-D1A-AH-TERM
  2401        MOVE WS-SORT-AH-TYPE     TO WS-D1A-AH-TYPE
  2402        MOVE WS-SORT-PRM-AMT     TO WS-D1A-PRM-AMT
  2403        MOVE WS-SORT-BANK-FEE    TO WS-D1A-BANK-FEE
  2404     ELSE
  2405        SUBTRACT WS-SORT-BANK-FEE
  2406                                 FROM WS-BANK-BANK-FEE-TOTAL
  2407        ADD +1                   TO WS-BANK-CANCEL-COUNT
  2408
  2409        MOVE WS-SORT-INSURED-NAME
  2410                                 TO WS-D1B-INSURED-NAME
  2411        MOVE WS-SORT-CERT        TO WS-D1B-CERT
  2412        MOVE WS-SORT-CERT-EFF-DT (4:4)
  2413                                 TO WS-D1B-CERT-EFF-CCYY
  2414        MOVE WS-SORT-CERT-EFF-DT (8:2)
  2415                                 TO WS-D1B-CERT-EFF-MM
  2416        MOVE WS-SORT-CERT-EFF-DT (10:2)
  2417                                 TO WS-D1B-CERT-EFF-DD
  2418        MOVE WS-SORT-AH-CAN-DT (4:4)
  2419                                 TO WS-D1B-CERT-CAN-CCYY
  2420        MOVE WS-SORT-AH-CAN-DT (8:2)
  2421                                 TO WS-D1B-CERT-CAN-MM
  2422        MOVE WS-SORT-AH-CAN-DT (10:2)
  2423                                 TO WS-D1B-CERT-CAN-DD
  2424        MOVE WS-SORT-AH-TYPE     TO WS-D1B-AH-TYPE
  2425        MOVE WS-SORT-AH-REFUND   TO WS-D1B-REFUND-AMT
  2426        MOVE WS-SORT-BANK-FEE    TO WS-D1B-REFUND-BKFEE
  2427        MOVE WS-SORT-PRM-AMT     TO WS-D1B-PRM-AMT
  2428     END-IF
  2429
  2430*    IF REC-ISSUE
  2431*       MOVE WS-DETAIL1A         TO PRT
  2432*    ELSE
  2433*       MOVE WS-DETAIL1B         TO PRT
  2434*    END-IF
  2435
  2436*    PERFORM 8800-PRINT-RTN      THRU 8800-EXIT
  2437
  2438     PERFORM 0215-RETURN-SORT    THRU 0215-EXIT
  2439
  2440     .
  2441 0210-EXIT.
  2442     EXIT.
  2443
  2444 0215-RETURN-SORT.
  2445
  2446     RETURN SORT-WORK            INTO WS-SORT-REC AT END
  2447        SET END-OF-SORT-FILE     TO TRUE
  2448     END-RETURN
  2449
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS0632.cbl
  2450     IF NOT END-OF-SORT-FILE
  2451        ADD +1                   TO WS-RETURN-SORT-COUNT
  2452     END-IF
  2453
  2454     .
  2455 0215-EXIT.
  2456     EXIT.
  2457
  2458 0220-BANK-BREAK.
  2459
  2460     MOVE WS-BANK-ISSUE-COUNT  TO WS-DTOT-ISSUE-COUNT
  2461     MOVE WS-BANK-CANCEL-COUNT TO WS-DTOT-CANCEL-COUNT
  2462     MOVE WS-BANK-BANK-FEE-TOTAL
  2463                                 TO WS-DTOT-NET-BANK-FEES
  2464
  2465     MOVE WS-FIN-INST-TOTAL-LINE TO PRT
  2466     PERFORM 8800-PRINT-RTN      THRU 8800-EXIT
  2467
  2468     ADD WS-BANK-ISSUE-COUNT   TO WS-AGENT-ISSUE-COUNT
  2469     ADD WS-BANK-CANCEL-COUNT  TO WS-AGENT-CANCEL-COUNT
  2470     ADD WS-BANK-BANK-FEE-TOTAL
  2471                                 TO WS-AGENT-BANK-FEE-TOTAL
  2472     MOVE ZEROS                  TO WS-BANK-ISSUE-COUNT
  2473     MOVE ZEROS                  TO WS-BANK-CANCEL-COUNT
  2474     MOVE ZEROS                  TO WS-BANK-BANK-FEE-TOTAL
  2475     MOVE WS-SORT-BANK           TO WS-PREV-BANK
  2476     MOVE WS-SORT-BANK           TO WS-HD5-BANK-NO
  2477
  2478     MOVE DTE-CLASIC-COMPANY-CD  TO CO-COMPANY-CD
  2479     MOVE WS-SORT-CARRIER        TO CO-CARRIER
  2480     MOVE WS-SORT-GROUP          TO CO-GROUPING
  2481     MOVE WS-SORT-BANK           TO CO-RESP-NO
  2482     MOVE LOW-VALUES             TO CO-ACCOUNT
  2483     MOVE 'B'                    TO CO-TYPE
  2484     PERFORM 0295-GET-BANK-NAMES THRU 0295-EXIT
  2485
  2486     .
  2487 0220-EXIT.
  2488     EXIT.
  2489
  2490
  2491 0230-AGENT-BREAK.
  2492
  2493     MOVE WS-AGENT-ISSUE-COUNT   TO WS-BTOT-ISSUE-COUNT
  2494     MOVE WS-AGENT-CANCEL-COUNT  TO WS-BTOT-CANCEL-COUNT
  2495     MOVE WS-AGENT-BANK-FEE-TOTAL
  2496                                 TO WS-BTOT-NET-BANK-FEES
  2497
  2498     MOVE WS-AGENT-TOTAL-LINE    TO PRT
  2499     PERFORM 8800-PRINT-RTN      THRU 8800-EXIT
  2500
  2501     ADD WS-AGENT-ISSUE-COUNT    TO WS-ALL-ISSUE-COUNT
  2502     ADD WS-AGENT-CANCEL-COUNT   TO WS-ALL-CANCEL-COUNT
  2503     ADD WS-AGENT-BANK-FEE-TOTAL TO WS-ALL-BANK-FEE-TOTAL
  2504     MOVE ZEROS                  TO WS-AGENT-ISSUE-COUNT
  2505     MOVE ZEROS                  TO WS-AGENT-CANCEL-COUNT
  2506     MOVE ZEROS                  TO WS-AGENT-BANK-FEE-TOTAL
  2507
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS0632.cbl
  2508     MOVE WS-SORT-CARRIER        TO WS-HD4-1-CARRIER
  2509     MOVE WS-SORT-GROUP          TO WS-HD4-1-GROUP
  2510     MOVE WS-SORT-AGENT          TO WS-HD4-1-AGENT
  2511                                    WS-PREV-AGENT
  2512     MOVE WS-SORT-CARRIER        TO CO-CARRIER
  2513     MOVE WS-SORT-GROUP          TO CO-GROUPING
  2514     MOVE WS-SORT-AGENT          TO CO-RESP-NO
  2515     MOVE LOW-VALUES             TO CO-ACCOUNT
  2516     MOVE 'G'                    TO CO-TYPE
  2517
  2518     READ ERCOMP
  2519
  2520     EVALUATE ERCOMP-STATUS
  2521        WHEN '00'
  2522           MOVE CO-ACCT-NAME       TO WS-HD4-1-AGENT-NAME
  2523           MOVE CO-ADDR-1          TO WS-HD4-2-AGENT-ADDRESS1
  2524           IF CO-ADDR-2 NOT = SPACES
  2525              MOVE CO-ADDR-2      TO WS-HD4-3-AGENT-ADDRESS2
  2526              MOVE SPACES         TO WS-HD4-4-AGENT-ADDRESS3
  2527              STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  2528                 DELIMITED BY '  ' INTO WS-HD4-4-AGENT-ADDRESS3
  2529              END-STRING
  2530              MOVE CO-ZIP         TO WS-HD4-5-AGENT-ADDRESS4
  2531           ELSE
  2532              MOVE SPACES         TO WS-HD4-3-AGENT-ADDRESS2
  2533              STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  2534                 DELIMITED BY '  ' INTO WS-HD4-3-AGENT-ADDRESS2
  2535              END-STRING
  2536              MOVE CO-ZIP         TO WS-HD4-4-AGENT-ADDRESS3
  2537              MOVE SPACES         TO WS-HD4-5-AGENT-ADDRESS4
  2538           END-IF
  2539
  2540        WHEN '23'
  2541           DISPLAY 'THIS AGENT NOT ON ERCOMP ' WS-SORT-AGENT
  2542
  2543        WHEN OTHER
  2544           DISPLAY 'ERROR ON ERCOMP READ ' ERCOMP-STATUS
  2545     END-EVALUATE
  2546
  2547     MOVE +56                    TO WS-LINE-COUNT
  2548
  2549     .
  2550 0230-EXIT.
  2551     EXIT.
  2552
  2553 0240-FINAL-BREAK.
  2554
  2555     MOVE +0                     TO WS-LINE-COUNT
  2556     ADD +1                      TO WS-PAGE
  2557     MOVE WS-PAGE                TO WS-HD3-PAGE
  2558     MOVE WS-HD1                 TO PRT
  2559     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2560     MOVE WS-HD2                 TO PRT
  2561     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2562     MOVE WS-HD3                 TO PRT
  2563     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2564     MOVE WS-ALL-ISSUE-COUNT     TO WS-GTOT-ISSUE-COUNT
  2565     MOVE WS-ALL-CANCEL-COUNT    TO WS-GTOT-CANCEL-COUNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS0632.cbl
  2566     MOVE WS-ALL-BANK-FEE-TOTAL  TO WS-GTOT-NET-BANK-FEES
  2567
  2568     MOVE WS-GRAND-TOTAL-LINE    TO PRT
  2569     PERFORM 8800-PRINT-RTN      THRU 8800-EXIT
  2570
  2571     .
  2572 0240-EXIT.
  2573     EXIT.
  2574
  2575 0290-GET-AGENT-NAMES.
  2576
  2577     READ ERCOMP
  2578
  2579     IF ERCOMP-STATUS = '00'
  2580        MOVE CO-ACCT-NAME       TO WS-HD4-1-AGENT-NAME
  2581        MOVE CO-ADDR-1          TO WS-HD4-2-AGENT-ADDRESS1
  2582        IF CO-ADDR-2 NOT = SPACES
  2583           MOVE CO-ADDR-2      TO WS-HD4-3-AGENT-ADDRESS2
  2584           MOVE SPACES         TO WS-HD4-4-AGENT-ADDRESS3
  2585           STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  2586              DELIMITED BY '  ' INTO WS-HD4-4-AGENT-ADDRESS3
  2587           END-STRING
  2588           MOVE CO-ZIP         TO WS-HD4-5-AGENT-ADDRESS4
  2589        ELSE
  2590           MOVE SPACES         TO WS-HD4-3-AGENT-ADDRESS2
  2591           STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  2592              DELIMITED BY '  ' INTO WS-HD4-3-AGENT-ADDRESS2
  2593           END-STRING
  2594           MOVE CO-ZIP         TO WS-HD4-4-AGENT-ADDRESS3
  2595           MOVE SPACES         TO WS-HD4-5-AGENT-ADDRESS4
  2596        END-IF
  2597     ELSE
  2598        IF ERCOMP-STATUS = '10' OR '23'
  2599           MOVE 'COMPUTER GENERATED '
  2600                                 TO WS-HD4-1-AGENT-NAME
  2601                                    WS-HD4-2-AGENT-ADDRESS1
  2602                                    WS-HD4-3-AGENT-ADDRESS2
  2603           MOVE SPACES           TO WS-HD4-4-AGENT-ADDRESS3
  2604                                    WS-HD4-5-AGENT-ADDRESS4
  2605        ELSE
  2606           DISPLAY 'ERROR ON ERCOMP GET BANK  ' ERCOMP-STATUS
  2607           DISPLAY 'CO CONTROL PRIMARY ' CO-CONTROL-PRIMARY
  2608           PERFORM ABEND-PGM        THRU APS-EXIT
  2609        END-IF
  2610     END-IF
  2611
  2612
  2613     .
  2614 0290-EXIT.
  2615     EXIT.
  2616
  2617 0295-GET-BANK-NAMES.
  2618
  2619     READ ERCOMP
  2620
  2621     IF ERCOMP-STATUS = '00'
  2622        MOVE CO-ACCT-NAME        TO WS-HD5-BANK-NAME
  2623        MOVE CO-RESP-NO          TO WS-HD5-BANK-NO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS0632.cbl
  2624     ELSE
  2625        IF ERCOMP-STATUS = '10' OR '23'
  2626           MOVE 'COMPUTER GENERATED '
  2627                                 TO WS-HD5-BANK-NAME
  2628           MOVE CO-RESP-NO       TO WS-HD5-BANK-NO
  2629        ELSE
  2630           DISPLAY 'ERROR ON ERCOMP READ BANK ' ERCOMP-STATUS
  2631           DISPLAY 'CO CONTROL PRIMARY ' CO-CONTROL-PRIMARY
  2632           PERFORM ABEND-PGM        THRU APS-EXIT
  2633        END-IF
  2634     END-IF
  2635
  2636
  2637
  2638     .
  2639 0295-EXIT.
  2640     EXIT.
  2641
  2642
  2643 0300-HDR1-TO-HDR5.
  2644
  2645     ADD +1                      TO WS-PAGE
  2646     MOVE WS-PAGE                TO WS-HD3-PAGE
  2647     MOVE WS-HD1                 TO PRT
  2648     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2649     MOVE WS-HD2                 TO PRT
  2650     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2651     MOVE WS-HD3                 TO PRT
  2652     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2653     MOVE WS-HD4-1               TO PRT
  2654     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2655     MOVE WS-HD4-2               TO PRT
  2656     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2657     MOVE WS-HD4-3               TO PRT
  2658     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2659     MOVE WS-HD4-4               TO PRT
  2660     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2661     MOVE WS-HD4-5               TO PRT
  2662     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2663     MOVE WS-HD5                 TO PRT
  2664     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2665
  2666     MOVE +12                    TO WS-LINE-COUNT
  2667
  2668     .
  2669 0300-EXIT.
  2670     EXIT.
  2671
  2672 0400-OPEN-FILES.
  2673
  2674     OPEN INPUT EXTR-FILE-IN
  2675                ERCOMP
  2676         OUTPUT PRNTR
  2677
  2678     IF ERCOMP-STATUS = '00' OR '97'
  2679         CONTINUE
  2680     ELSE
  2681         DISPLAY 'OPEN ERROR ' ERCOMP-STATUS ' ON ERCOMP'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS0632.cbl
  2682         DISPLAY '*** JOB ABORTED ***'
  2683         PERFORM ABEND-PGM     THRU APS-EXIT
  2684     END-IF
  2685
  2686     .
  2687 0400-EXIT.
  2688     EXIT.
  2689
  2690 0500-CLOSE-FILES.
  2691
  2692     CLOSE EXTR-FILE-IN
  2693           ERCOMP
  2694           PRNTR
  2695
  2696     IF ERCOMP-STATUS = '00' OR '97'
  2697        CONTINUE
  2698     ELSE
  2699        DISPLAY ' ERROR ON CLOSE - ERCOMP ' ERCOMP-STATUS
  2700        PERFORM ABEND-PGM      THRU APS-EXIT
  2701     END-IF
  2702
  2703     .
  2704 0500-EXIT.
  2705     EXIT.
  2706
  2707
  2708 0600-INITIALIZE.
  2709
  2710     MOVE COMPANY-NAME           TO WS-HD2-CO
  2711
  2712     ACCEPT WS-ACCEPT-DATE       FROM DATE
  2713     MOVE WS-AD-MM               TO WS-CD-MM
  2714     MOVE WS-AD-DD               TO WS-CD-DD
  2715     MOVE WS-AD-YY               TO WS-CD-YY
  2716     MOVE WS-CURRENT-DATE        TO WS-HD2-RUN-DT
  2717
  2718     MOVE ALPH-DATE              TO WS-HD3-ALPHA-DT
  2719
  2720     MOVE DTE-CLASIC-COMPANY-CD  TO CO-COMPANY-CD
  2721
  2722     MOVE ZEROS                  TO WS-DTOT-NET-BANK-FEES
  2723     MOVE ZEROS                  TO WS-BTOT-NET-BANK-FEES
  2724     MOVE ZEROS                  TO WS-GTOT-NET-BANK-FEES
  2725     MOVE +0                     TO WS-PAGE
  2726
  2727     PERFORM 0120-READ-EXTR      THRU 0120-EXIT
  2728     .
  2729 0600-EXIT.
  2730     EXIT.
  2731
  2732 8800-PRINT-RTN.
  2733
  2734     IF WS-LINE-COUNT > WS-LINE-COUNT-MAX
  2735        MOVE PRT                 TO WS-SAVE-PRT
  2736        PERFORM 0300-HDR1-TO-HDR5
  2737                                 THRU 0300-EXIT
  2738        MOVE WS-SAVE-PRT         TO PRT
  2739     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS0632.cbl
  2740
  2741     PERFORM 8900-PRINT-A-LINE   THRU 8900-EXIT
  2742     ADD +1                      TO WS-LINE-COUNT
  2743     MOVE SPACES                 TO PRT
  2744
  2745     .
  2746 8800-EXIT.
  2747     EXIT.
  2748
  2749 8900-PRINT-A-LINE.
  2750
  2751     MOVE P-CTL              TO X.
* 2752                             COPY ELCPRT2.
  2753******************************************************************04/15/98
  2754*                                                                *ELCPRT2
  2755*                                                                *ELCPRT2
  2756*                            ELCPRT2                             *   LV005
  2757*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  2758*                            VMOD=2.002                          *   CL**5
  2759*                                                                *   CL**4
  2760******************************************************************   CL**4
  2761                                                                     CL**4
  2762     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2763        FICH-OPEN    = SPACE                                         CL**4
  2764         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2765         OPEN OUTPUT FICH.                                           CL**4
  2766                                                                     CL**4
  2767     IF DTE-FICH NOT = SPACE                                         CL**4
  2768         MOVE X                  TO  P-CTL                           CL**4
  2769         WRITE FICH-REC FROM PRT.                                    CL**4
  2770                                                                     CL**4
  2771     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2772       MOVE X                    TO  P-CTL                           CL**4
  2773       IF P-CTL = ' '                                                CL**4
  2774         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2775       ELSE                                                          CL**4
  2776         IF P-CTL = '0'                                              CL**4
  2777           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2778         ELSE                                                        CL**4
  2779           IF P-CTL = '-'                                            CL**4
  2780             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2781           ELSE                                                      CL**4
  2782             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2783                                                                     CL**4
  2784******************************************************************   CL**4
  2785
  2786 8900-EXIT.
  2787     EXIT.
  2788
  2789*8510-DATE-CONVERSION.
  2790
  2791*    CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2792
  2793*    .
  2794
  2795*8590-EXIT.
  2796*    EXIT.
  2797
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS0632.cbl
  2798 ABEND-PGM SECTION.
* 2799                               COPY ELCABEND.
  2800***************************************************************** 04/14/98
  2801*                                                               * ELCABEND
  2802*                            ELCABEND.                          *    LV003
  2803*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2804*                            VMOD 2.002                              CL**2
  2805*                                                               * ELCABEND
  2806*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2807*            AND THEN ABENDS.                                   * ELCABEND
  2808*                                                               * ELCABEND
  2809*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2810*                                                               * ELCABEND
  2811***************************************************************** ELCABEND
  2812*APS-010.                                                         ELCABEND
  2813     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2814     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2815                                                                  ELCABEND
  2816     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2817         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2818         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2819                                 UPON CONSOLE.                    ELCABEND
  2820                                                                  ELCABEND
  2821     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2822         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2823         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2824                                 UPON CONSOLE.                    ELCABEND
  2825                                                                  ELCABEND
  2826     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2827     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2828                                 UPON CONSOLE.                    ELCABEND
  2829                                                                  ELCABEND
  2830     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2831     CALL 'ABORTME'.
  2832                                                                  ELCABEND
  2833 APS-EXIT.                                                        ELCABEND
  2834     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       53032     Code:        8640
