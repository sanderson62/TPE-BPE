* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* DCC043CMB.cbl
* Options: int("DCC043CMB.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("DCC043CMB.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"DCC043CMB.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "DCC043CMB.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    DCC043CMB.
     3 AUTHOR.        AJR.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5*REMARKS.
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* DCC043CMB.cbl
    14* 061614   2014050100002   AJRA  COMBINE DCC043RET EXTRACT FILES INTO
    15*                                ONE DELIMITED FILE.
    16******************************************************************
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT  FILECUR-IN      ASSIGN TO SYS011-UT-2400-S-SYS011
    23                             ORGANIZATION IS LINE SEQUENTIAL.
    24     SELECT  FILEYTD-IN      ASSIGN TO SYS012-UT-2400-S-SYS012
    25                             ORGANIZATION IS LINE SEQUENTIAL.
    26     SELECT  FILEL12-IN      ASSIGN TO SYS013-UT-2400-S-SYS013
    27                             ORGANIZATION IS LINE SEQUENTIAL.
    28     SELECT  FILE-OUT        ASSIGN TO SYS020-UT-FBA1-S-SYS020
    29                             ORGANIZATION IS LINE SEQUENTIAL.
    30
    31 DATA DIVISION.
    32 FILE SECTION.
    33
    34 FD  FILECUR-IN
    35     RECORDING MODE F
    36     BLOCK CONTAINS 0 RECORDS.
    37
    38 01  FILECUR-IN-REC               PIC X(1833).
    39
    40 FD  FILEYTD-IN
    41     RECORDING MODE F
    42     BLOCK CONTAINS 0 RECORDS.
    43
    44 01  FILEYTD-IN-REC               PIC X(1833).
    45
    46 FD  FILEL12-IN
    47     RECORDING MODE F
    48     BLOCK CONTAINS 0 RECORDS.
    49
    50 01  FILEL12-IN-REC               PIC X(1833).
    51
    52 FD  FILE-OUT
    53     RECORDING MODE F
    54     BLOCK CONTAINS 0 RECORDS.
    55
    56 01  FILE-OUT-REC                 PIC X(3456).
    57
    58
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* DCC043CMB.cbl
    60 WORKING-STORAGE SECTION.
    61 77  FILLER  PIC X(32) VALUE '********************************'.
    62 77  FILLER  PIC X(32) VALUE '     AJRCODT WORKING STORAGE    '.
    63 77  FILLER  PIC X(32) VALUE '********************************'.
    64
    65
    66 01  WS-MISC.
    67     05  WS-EOFCUR-SW            PIC X      VALUE SPACES.
    68         88  END-OF-CUR                     VALUE 'Y'.
    69     05  WS-EOFYTD-SW            PIC X      VALUE SPACES.
    70         88  END-OF-YTD                     VALUE 'Y'.
    71     05  WS-EOFL12-SW            PIC X      VALUE SPACES.
    72         88  END-OF-L12                     VALUE 'Y'.
    73     05  WS-SUB          COMP-3  PIC S9(3)  VALUE +0.
    74     05  WS-CUR-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    75     05  WS-YTD-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    76     05  WS-L12-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    77     05  WS-OUT-CNT      COMP-3  PIC S9(7)  VALUE +0.
    78
    79 01  WS-CUR-IN-RECORD.
    80     05  WS-CUR-KEY.
    81         10  WS-CUR-ME-DATE       PIC X(10).
    82         10  WS-CUR-CARRIER       PIC X(1).
    83         10  WS-CUR-COMP          PIC X(6).
    84         10  WS-CUR-STATE         PIC X(2).
    85         10  WS-CUR-ACCOUNT-NUM   PIC X(10).
    86         10  WS-CUR-GROUP         PIC X(10).
    87         10  WS-CUR-EXP-DATE      PIC X(10).
    88     05  WS-CUR-EFF-DATE          PIC X(10).
    89     05  WS-CUR-ACCOUNT-NAME      PIC X(30).
    90     05  WS-CUR-PERIOD            PIC X(3).
    91     05  WS-CUR-ACCUMULATORS OCCURS 12 TIMES.
    92         10  WS-CUR-DESCR         PIC X(28).
    93         10  WS-CUR-PERLFP        PIC X(14).
    94         10  WS-CUR-PERLFE        PIC X(14).
    95         10  WS-CUR-ITDLFP        PIC X(14).
    96         10  WS-CUR-ITDLFE        PIC X(14).
    97         10  WS-CUR-PERAHP        PIC X(14).
    98         10  WS-CUR-PERAHE        PIC X(14).
    99         10  WS-CUR-ITDAHP        PIC X(14).
   100         10  WS-CUR-ITDAHE        PIC X(14).
   101     05  WS-CUR-PREM-P-E          PIC X(1).
   102     05  WS-CUR-CLAIM-P-I         PIC X(1).
   103     05  WS-CUR-RETRO-Y-N         PIC X(1).
   104     05  WS-CUR-RETRO-P-E         PIC X(1).
   105     05  WS-CUR-TAX-P-E           PIC X(1).
   106     05  WS-CUR-PERLF-RETRO-PMT   PIC X(14).
   107     05  WS-CUR-ITDLF-RETRO-PMT   PIC X(14).
   108     05  WS-CUR-PERAH-RETRO-PMT   PIC X(14).
   109     05  WS-CUR-ITDAH-RETRO-PMT   PIC X(14).
   110
   111
   112 01  WS-YTD-IN-RECORD.
   113     05  WS-YTD-KEY.
   114         10  WS-YTD-ME-DATE       PIC X(10).
   115         10  WS-YTD-CARRIER       PIC X(1).
   116         10  WS-YTD-COMP          PIC X(6).
   117         10  WS-YTD-STATE         PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* DCC043CMB.cbl
   118         10  WS-YTD-ACCOUNT-NUM   PIC X(10).
   119         10  WS-YTD-GROUP         PIC X(10).
   120         10  WS-YTD-EXP-DATE      PIC X(10).
   121     05  WS-YTD-EFF-DATE          PIC X(10).
   122     05  WS-YTD-ACCOUNT-NAME      PIC X(30).
   123     05  WS-YTD-PERIOD            PIC X(3).
   124     05  WS-YTD-ACCUMULATORS OCCURS 12 TIMES.
   125         10  WS-YTD-DESCR         PIC X(28).
   126         10  WS-YTD-PERLFP        PIC X(14).
   127         10  WS-YTD-PERLFE        PIC X(14).
   128         10  WS-YTD-ITDLFP        PIC X(14).
   129         10  WS-YTD-ITDLFE        PIC X(14).
   130         10  WS-YTD-PERAHP        PIC X(14).
   131         10  WS-YTD-PERAHE        PIC X(14).
   132         10  WS-YTD-ITDAHP        PIC X(14).
   133         10  WS-YTD-ITDAHE        PIC X(14).
   134     05  WS-YTD-PREM-P-E          PIC X(1).
   135     05  WS-YTD-CLAIM-P-I         PIC X(1).
   136     05  WS-YTD-RETRO-Y-N         PIC X(1).
   137     05  WS-YTD-RETRO-P-E         PIC X(1).
   138     05  WS-YTD-TAX-P-E           PIC X(1).
   139     05  WS-YTD-PERLF-RETRO-PMT   PIC X(14).
   140     05  WS-YTD-ITDLF-RETRO-PMT   PIC X(14).
   141     05  WS-YTD-PERAH-RETRO-PMT   PIC X(14).
   142     05  WS-YTD-ITDAH-RETRO-PMT   PIC X(14).
   143
   144
   145 01  WS-L12-IN-RECORD.
   146     05  WS-L12-KEY.
   147         10  WS-L12-ME-DATE       PIC X(10).
   148         10  WS-L12-CARRIER       PIC X(1).
   149         10  WS-L12-COMP          PIC X(6).
   150         10  WS-L12-STATE         PIC X(2).
   151         10  WS-L12-ACCOUNT-NUM   PIC X(10).
   152         10  WS-L12-GROUP         PIC X(10).
   153         10  WS-L12-EXP-DATE      PIC X(10).
   154     05  WS-L12-EFF-DATE          PIC X(10).
   155     05  WS-L12-ACCOUNT-NAME      PIC X(30).
   156     05  WS-L12-PERIOD            PIC X(3).
   157     05  WS-L12-ACCUMULATORS OCCURS 12 TIMES.
   158         10  WS-L12-DESCR         PIC X(28).
   159         10  WS-L12-PERLFP        PIC X(14).
   160         10  WS-L12-PERLFE        PIC X(14).
   161         10  WS-L12-ITDLFP        PIC X(14).
   162         10  WS-L12-ITDLFE        PIC X(14).
   163         10  WS-L12-PERAHP        PIC X(14).
   164         10  WS-L12-PERAHE        PIC X(14).
   165         10  WS-L12-ITDAHP        PIC X(14).
   166         10  WS-L12-ITDAHE        PIC X(14).
   167     05  WS-L12-PREM-P-E          PIC X(1).
   168     05  WS-L12-CLAIM-P-I         PIC X(1).
   169     05  WS-L12-RETRO-Y-N         PIC X(1).
   170     05  WS-L12-RETRO-P-E         PIC X(1).
   171     05  WS-L12-TAX-P-E           PIC X(1).
   172     05  WS-L12-PERLF-RETRO-PMT   PIC X(14).
   173     05  WS-L12-ITDLF-RETRO-PMT   PIC X(14).
   174     05  WS-L12-PERAH-RETRO-PMT   PIC X(14).
   175     05  WS-L12-ITDAH-RETRO-PMT   PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* DCC043CMB.cbl
   176
   177
   178 01  WS-FILE-OUT-RECORD.
   179     05  WS-FO-KEY.
   180         10  WS-FO-ME-DATE       PIC X(10).
   181         10  FILLER              PIC X(1) VALUE ';'.
   182         10  WS-FO-CARRIER       PIC X(1).
   183         10  FILLER              PIC X(1) VALUE ';'.
   184         10  WS-FO-COMP          PIC X(6).
   185         10  FILLER              PIC X(1) VALUE ';'.
   186         10  WS-FO-STATE         PIC X(2).
   187         10  FILLER              PIC X(1) VALUE ';'.
   188         10  WS-FO-ACCOUNT-NUM   PIC X(10).
   189         10  FILLER              PIC X(1) VALUE ';'.
   190         10  WS-FO-GROUP         PIC X(10).
   191         10  FILLER              PIC X(1) VALUE ';'.
   192         10  WS-FO-EXP-DATE      PIC X(10).
   193         10  FILLER              PIC X(1) VALUE ';'.
   194     05  WS-FO-EFF-DATE          PIC X(10).
   195     05  FILLER                  PIC X(1) VALUE ';'.
   196     05  WS-FO-ACCOUNT-NAME      PIC X(30).
   197     05  FILLER                  PIC X(1) VALUE ';'.
   198     05  WS-FO-ACCUMULATORS OCCURS 12 TIMES.
   199         10  WS-FO-DESCR         PIC X(28).
   200         10  FILLER              PIC X(1) VALUE ';'.
   201         10  WS-FO-CURLFP        PIC X(14).
   202         10  FILLER              PIC X(1) VALUE ';'.
   203         10  WS-FO-CURLFE        PIC X(14).
   204         10  FILLER              PIC X(1) VALUE ';'.
   205         10  WS-FO-YTDLFP        PIC X(14).
   206         10  FILLER              PIC X(1) VALUE ';'.
   207         10  WS-FO-YTDLFE        PIC X(14).
   208         10  FILLER              PIC X(1) VALUE ';'.
   209         10  WS-FO-L12LFP        PIC X(14).
   210         10  FILLER              PIC X(1) VALUE ';'.
   211         10  WS-FO-L12LFE        PIC X(14).
   212         10  FILLER              PIC X(1) VALUE ';'.
   213         10  WS-FO-ITDLFP        PIC X(14).
   214         10  FILLER              PIC X(1) VALUE ';'.
   215         10  WS-FO-ITDLFE        PIC X(14).
   216         10  FILLER              PIC X(1) VALUE ';'.
   217         10  WS-FO-CURAHP        PIC X(14).
   218         10  FILLER              PIC X(1) VALUE ';'.
   219         10  WS-FO-CURAHE        PIC X(14).
   220         10  FILLER              PIC X(1) VALUE ';'.
   221         10  WS-FO-YTDAHP        PIC X(14).
   222         10  FILLER              PIC X(1) VALUE ';'.
   223         10  WS-FO-YTDAHE        PIC X(14).
   224         10  FILLER              PIC X(1) VALUE ';'.
   225         10  WS-FO-L12AHP        PIC X(14).
   226         10  FILLER              PIC X(1) VALUE ';'.
   227         10  WS-FO-L12AHE        PIC X(14).
   228         10  FILLER              PIC X(1) VALUE ';'.
   229         10  WS-FO-ITDAHP        PIC X(14).
   230         10  FILLER              PIC X(1) VALUE ';'.
   231         10  WS-FO-ITDAHE        PIC X(14).
   232         10  FILLER              PIC X(1) VALUE ';'.
   233     05  WS-FO-PREM-P-E          PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* DCC043CMB.cbl
   234     05  FILLER                  PIC X(1) VALUE ';'.
   235     05  WS-FO-CLAIM-P-I         PIC X(1).
   236     05  FILLER                  PIC X(1) VALUE ';'.
   237     05  WS-FO-RETRO-Y-N         PIC X(1).
   238     05  FILLER                  PIC X(1) VALUE ';'.
   239     05  WS-FO-RETRO-P-E         PIC X(1).
   240     05  FILLER                  PIC X(1) VALUE ';'.
   241     05  WS-FO-TAX-P-E           PIC X(1).
   242     05  FILLER                  PIC X(1) VALUE ';'.
   243     05  WS-FO-CURLFRETROPMT     PIC X(14).
   244     05  FILLER                  PIC X(1) VALUE ';'.
   245     05  WS-FO-YTDLFRETROPMT     PIC X(14).
   246     05  FILLER                  PIC X(1) VALUE ';'.
   247     05  WS-FO-L12LFRETROPMT     PIC X(14).
   248     05  FILLER                  PIC X(1) VALUE ';'.
   249     05  WS-FO-ITDLFRETROPMT     PIC X(14).
   250     05  FILLER                  PIC X(1) VALUE ';'.
   251     05  WS-FO-CURAHRETROPMT     PIC X(14).
   252     05  FILLER                  PIC X(1) VALUE ';'.
   253     05  WS-FO-YTDAHRETROPMT     PIC X(14).
   254     05  FILLER                  PIC X(1) VALUE ';'.
   255     05  WS-FO-L12AHRETROPMT     PIC X(14).
   256     05  FILLER                  PIC X(1) VALUE ';'.
   257     05  WS-FO-ITDAHRETROPMT     PIC X(14).
   258     05  FILLER                  PIC X(1) VALUE ';'.
   259
   260 01  WS-DUMMY-RECORD.
   261     05  WS-DMY-CARRIER           PIC X(1)    VALUE SPACES.
   262     05  WS-DMY-COMP              PIC X(6)    VALUE SPACES.
   263     05  WS-DMY-STATE             PIC X(2)    VALUE SPACES.
   264     05  WS-DMY-ACCOUNT-NUM       PIC X(10)   VALUE SPACES.
   265     05  WS-DMY-GROUP             PIC X(10)   VALUE SPACES.
   266     05  WS-DMY-ACCOUNT-NAME      PIC X(30)   VALUE SPACES.
   267     05  WS-DMY-PERIOD            PIC X(3)    VALUE SPACES.
   268     05  WS-DMY-ACCUMULATORS OCCURS 12 TIMES.
   269         10  WS-DMY-DESCR         PIC X(28).
   270         10  WS-DMY-PERLFP        PIC X(14).
   271         10  WS-DMY-PERLFE        PIC X(14).
   272         10  WS-DMY-ITDLFP        PIC X(14).
   273         10  WS-DMY-ITDLFE        PIC X(14).
   274         10  WS-DMY-PERAHP        PIC X(14).
   275         10  WS-DMY-PERAHE        PIC X(14).
   276         10  WS-DMY-ITDAHP        PIC X(14).
   277         10  WS-DMY-ITDAHE        PIC X(14).
   278     05  WS-DMY-PREM-P-E          PIC X(1)    VALUE SPACES.
   279     05  WS-DMY-CLAIM-P-I         PIC X(1)    VALUE SPACES.
   280     05  WS-DMY-RETRO-Y-N         PIC X(1).
   281     05  WS-DMY-RETRO-P-E         PIC X(1).
   282     05  WS-DMY-TAX-P-E           PIC X(1).
   283     05  WS-DMY-PERLF-RETRO-PMT   PIC X(14).
   284     05  WS-DMY-ITDLF-RETRO-PMT   PIC X(14).
   285     05  WS-DMY-PERAH-RETRO-PMT   PIC X(14).
   286     05  WS-DMY-ITDAH-RETRO-PMT   PIC X(14).
   287
   288 PROCEDURE DIVISION.
   289
   290 0000-BEGIN.
   291
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* DCC043CMB.cbl
   292     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
   293     PERFORM 0040-INIT           THRU 0040-EXIT
   294
   295     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT UNTIL
   296          (END-OF-CUR AND END-OF-YTD AND END-OF-L12)
   297
   298     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
   299
   300     DISPLAY ' CUR RECORDS IN ' WS-CUR-IN-CNT
   301     DISPLAY ' YTD RECORDS IN ' WS-YTD-IN-CNT
   302     DISPLAY ' L12 RECORDS IN ' WS-L12-IN-CNT
   303     DISPLAY ' RECORDS OUT    ' WS-OUT-CNT
   304     GOBACK
   305     .
   306 0002-EXIT.
   307     EXIT.
   308
   309 0020-OPEN-FILES.
   310
   311     OPEN INPUT FILECUR-IN
   312                FILEYTD-IN
   313                FILEL12-IN.
   314     OPEN OUTPUT FILE-OUT.
   315
   316 0020-EXIT.
   317     EXIT.
   318
   319 0030-CLOSE-FILES.
   320
   321     CLOSE FILECUR-IN
   322           FILEYTD-IN
   323           FILEL12-IN.
   324     CLOSE FILE-OUT.
   325
   326 0030-EXIT.
   327     EXIT.
   328
   329 0040-INIT.
   330
   331     MOVE +0 TO WS-SUB.
   332     PERFORM 12 TIMES
   333        ADD +1 TO WS-SUB
   334        MOVE SPACES TO WS-DMY-DESCR (WS-SUB)
   335        MOVE '           .00' TO WS-DMY-PERLFP (WS-SUB)
   336        MOVE '           .00' TO WS-DMY-PERLFE (WS-SUB)
   337        MOVE '           .00' TO WS-DMY-ITDLFP (WS-SUB)
   338        MOVE '           .00' TO WS-DMY-ITDLFE (WS-SUB)
   339        MOVE '           .00' TO WS-DMY-PERAHP (WS-SUB)
   340        MOVE '           .00' TO WS-DMY-PERAHE (WS-SUB)
   341        MOVE '           .00' TO WS-DMY-ITDAHP (WS-SUB)
   342        MOVE '           .00' TO WS-DMY-ITDAHE (WS-SUB)
   343     END-PERFORM.
   344     MOVE '           .00' TO WS-DMY-PERLF-RETRO-PMT.
   345     MOVE '           .00' TO WS-DMY-ITDLF-RETRO-PMT.
   346     MOVE '           .00' TO WS-DMY-PERAH-RETRO-PMT.
   347     MOVE '           .00' TO WS-DMY-ITDAH-RETRO-PMT.
   348
   349     PERFORM 0100-READ-FILECUR    THRU 0100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* DCC043CMB.cbl
   350     PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT.
   351     PERFORM 0120-READ-FILEL12    THRU 0120-EXIT.
   352
   353 0040-EXIT.
   354     EXIT.
   355
   356 0050-PROCESS-FILE.
   357
   358     IF WS-CUR-KEY EQUAL WS-YTD-KEY AND
   359        WS-CUR-KEY EQUAL WS-L12-KEY
   360           PERFORM 2000-MOVE-AMOUNTS THRU 2000-EXIT
   361           PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   362           PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   363           PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   364           GO TO 0050-EXIT
   365     END-IF.
   366
   367     IF WS-CUR-KEY EQUAL WS-YTD-KEY
   368         IF WS-CUR-KEY LESS THAN WS-L12-KEY
   369             PERFORM 2010-MOVE-CUR-YTD-AMTS THRU 2010-EXIT
   370             PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   371             PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   372             GO TO 0050-EXIT
   373         ELSE
   374             PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   375             PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   376             GO TO 0050-EXIT
   377         END-IF
   378     END-IF.
   379
   380     IF WS-CUR-KEY LESS THAN WS-YTD-KEY
   381         IF WS-CUR-KEY EQUAL WS-L12-KEY
   382             PERFORM 2030-MOVE-CUR-L12-AMTS THRU 2030-EXIT
   383             PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   384             PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   385             GO TO 0050-EXIT
   386         ELSE
   387             IF WS-CUR-KEY LESS THAN WS-L12-KEY
   388                 PERFORM 2040-MOVE-CUR-AMTS THRU 2040-EXIT
   389                 PERFORM 0100-READ-FILECUR  THRU 0100-EXIT
   390                 GO TO 0050-EXIT
   391             ELSE
   392                 PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   393                 PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   394                 GO TO 0050-EXIT
   395             END-IF
   396         END-IF
   397     END-IF.
   398
   399     IF WS-CUR-KEY GREATER THAN WS-YTD-KEY
   400         IF WS-YTD-KEY EQUAL WS-L12-KEY
   401             PERFORM 2050-MOVE-YTD-L12-AMTS THRU 2050-EXIT
   402             PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   403             PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   404             GO TO 0050-EXIT
   405         ELSE
   406             IF WS-YTD-KEY LESS THAN WS-L12-KEY
   407                 PERFORM 2060-MOVE-YTD-AMTS THRU 2060-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* DCC043CMB.cbl
   408                 PERFORM 0110-READ-FILEYTD  THRU 0110-EXIT
   409                 GO TO 0050-EXIT
   410             ELSE
   411                 PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   412                 PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   413                 GO TO 0050-EXIT
   414             END-IF
   415         END-IF
   416     END-IF.
   417
   418
   419 0050-EXIT.
   420     EXIT.
   421
   422
   423 0100-READ-FILECUR.
   424
   425     READ FILECUR-IN
   426        AT END
   427        SET END-OF-CUR        TO TRUE
   428     END-READ.
   429
   430     IF NOT END-OF-CUR
   431         ADD +1              TO WS-CUR-IN-CNT
   432         MOVE FILECUR-IN-REC TO WS-CUR-IN-RECORD
   433     ELSE
   434         MOVE WS-DUMMY-RECORD TO WS-CUR-IN-RECORD
   435     END-IF.
   436
   437 0100-EXIT.
   438     EXIT.
   439
   440
   441 0110-READ-FILEYTD.
   442
   443     READ FILEYTD-IN
   444        AT END
   445        SET END-OF-YTD        TO TRUE
   446     END-READ.
   447
   448     IF NOT END-OF-YTD
   449         ADD +1              TO WS-YTD-IN-CNT
   450         MOVE FILEYTD-IN-REC TO WS-YTD-IN-RECORD
   451     ELSE
   452         MOVE WS-DUMMY-RECORD TO WS-YTD-IN-RECORD
   453     END-IF.
   454
   455 0110-EXIT.
   456     EXIT.
   457
   458 0120-READ-FILEL12.
   459
   460     READ FILEL12-IN
   461        AT END
   462        SET END-OF-L12        TO TRUE
   463     END-READ.
   464
   465     IF NOT END-OF-L12
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* DCC043CMB.cbl
   466         ADD +1              TO WS-L12-IN-CNT
   467         MOVE FILEL12-IN-REC TO WS-L12-IN-RECORD
   468     ELSE
   469         MOVE WS-DUMMY-RECORD TO WS-L12-IN-RECORD
   470     END-IF.
   471
   472 0120-EXIT.
   473     EXIT.
   474
   475
   476 2000-MOVE-AMOUNTS.
   477
   478 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   479 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   480 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   481 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   482 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   483 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   484 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   485 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   486 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   487 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   488 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   489 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   490 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   491 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   492 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   493 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   494 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   495 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   496 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   497 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   498 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   499 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   500
   501 MOVE +0 TO WS-SUB.
   502 PERFORM 12 TIMES
   503     ADD +1 TO WS-SUB
   504     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   505     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   506     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   507     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   508     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   509     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   510     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   511     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   512     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   513     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   514     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   515     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   516     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   517     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   518     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   519     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   520     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   521 END-PERFORM.
   522
   523 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* DCC043CMB.cbl
   524 ADD +1 TO WS-OUT-CNT.
   525
   526 2000-EXIT.
   527     EXIT.
   528
   529
   530 2010-MOVE-CUR-YTD-AMTS.
   531
   532 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   533 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   534 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   535 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   536 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   537 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   538 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   539 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   540 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   541 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   542 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   543 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   544 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   545 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   546 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   547 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   548 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   549 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   550 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   551 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   552 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   553 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   554
   555 MOVE +0 TO WS-SUB.
   556 PERFORM 12 TIMES
   557     ADD +1 TO WS-SUB
   558     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   559     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   560     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   561     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   562     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   563     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   564     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   565     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   566     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   567     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   568     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   569     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   570     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   571     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   572     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   573     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   574     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   575 END-PERFORM.
   576
   577 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   578 ADD +1 TO WS-OUT-CNT.
   579
   580 2010-EXIT.
   581     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* DCC043CMB.cbl
   582
   583
   584 2020-MOVE-L12-AMTS.
   585
   586 MOVE WS-L12-ME-DATE      TO WS-FO-ME-DATE.
   587 MOVE WS-L12-CARRIER      TO WS-FO-CARRIER.
   588 MOVE WS-L12-COMP         TO WS-FO-COMP.
   589 MOVE WS-L12-STATE        TO WS-FO-STATE.
   590 MOVE WS-L12-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   591 MOVE WS-L12-GROUP        TO WS-FO-GROUP.
   592 MOVE WS-L12-EXP-DATE     TO WS-FO-EXP-DATE.
   593 MOVE WS-L12-EFF-DATE     TO WS-FO-EFF-DATE.
   594 MOVE WS-L12-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   595 MOVE WS-L12-PREM-P-E     TO WS-FO-PREM-P-E.
   596 MOVE WS-L12-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   597 MOVE WS-L12-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   598 MOVE WS-L12-RETRO-P-E    TO WS-FO-RETRO-P-E.
   599 MOVE WS-L12-TAX-P-E      TO WS-FO-TAX-P-E.
   600 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   601 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   602 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   603 MOVE WS-L12-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   604 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   605 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   606 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   607 MOVE WS-L12-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   608
   609 MOVE +0 TO WS-SUB.
   610 PERFORM 12 TIMES
   611     ADD +1 TO WS-SUB
   612     MOVE WS-L12-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   613     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   614     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   615     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   616     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   617     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   618     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   619     MOVE WS-L12-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   620     MOVE WS-L12-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   621     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   622     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   623     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   624     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   625     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   626     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   627     MOVE WS-L12-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   628     MOVE WS-L12-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   629 END-PERFORM.
   630
   631 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   632 ADD +1 TO WS-OUT-CNT.
   633
   634 2020-EXIT.
   635     EXIT.
   636
   637
   638 2030-MOVE-CUR-L12-AMTS.
   639
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* DCC043CMB.cbl
   640 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   641 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   642 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   643 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   644 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   645 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   646 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   647 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   648 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   649 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   650 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   651 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   652 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   653 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   654 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   655 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   656 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   657 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   658 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   659 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   660 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   661 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   662
   663 MOVE +0 TO WS-SUB.
   664 PERFORM 12 TIMES
   665     ADD +1 TO WS-SUB
   666     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   667     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   668     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   669     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   670     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   671     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   672     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   673     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   674     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   675     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   676     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   677     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   678     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   679     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   680     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   681     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   682     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   683 END-PERFORM.
   684
   685 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   686 ADD +1 TO WS-OUT-CNT.
   687
   688 2030-EXIT.
   689     EXIT.
   690
   691
   692 2040-MOVE-CUR-AMTS.
   693
   694 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   695 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   696 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   697 MOVE WS-CUR-STATE        TO WS-FO-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* DCC043CMB.cbl
   698 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   699 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   700 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   701 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   702 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   703 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   704 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   705 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   706 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   707 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   708 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   709 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   710 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   711 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   712 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   713 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   714 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   715 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   716
   717 MOVE +0 TO WS-SUB.
   718 PERFORM 12 TIMES
   719     ADD +1 TO WS-SUB
   720     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   721     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   722     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   723     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   724     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   725     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   726     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   727     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   728     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   729     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   730     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   731     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   732     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   733     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   734     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   735     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   736     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   737 END-PERFORM.
   738
   739 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   740 ADD +1 TO WS-OUT-CNT.
   741
   742 2040-EXIT.
   743     EXIT.
   744
   745
   746 2050-MOVE-YTD-L12-AMTS.
   747
   748 MOVE WS-YTD-ME-DATE      TO WS-FO-ME-DATE.
   749 MOVE WS-YTD-CARRIER      TO WS-FO-CARRIER.
   750 MOVE WS-YTD-COMP         TO WS-FO-COMP.
   751 MOVE WS-YTD-STATE        TO WS-FO-STATE.
   752 MOVE WS-YTD-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   753 MOVE WS-YTD-GROUP        TO WS-FO-GROUP.
   754 MOVE WS-YTD-EXP-DATE     TO WS-FO-EXP-DATE.
   755 MOVE WS-YTD-EFF-DATE     TO WS-FO-EFF-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* DCC043CMB.cbl
   756 MOVE WS-YTD-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   757 MOVE WS-YTD-PREM-P-E     TO WS-FO-PREM-P-E.
   758 MOVE WS-YTD-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   759 MOVE WS-YTD-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   760 MOVE WS-YTD-RETRO-P-E    TO WS-FO-RETRO-P-E.
   761 MOVE WS-YTD-TAX-P-E      TO WS-FO-TAX-P-E.
   762 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   763 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   764 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   765 MOVE WS-YTD-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   766 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   767 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   768 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   769 MOVE WS-YTD-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   770
   771 MOVE +0 TO WS-SUB.
   772 PERFORM 12 TIMES
   773     ADD +1 TO WS-SUB
   774     MOVE WS-YTD-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   775     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   776     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   777     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   778     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   779     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   780     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   781     MOVE WS-YTD-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   782     MOVE WS-YTD-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   783     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   784     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   785     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   786     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   787     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   788     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   789     MOVE WS-YTD-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   790     MOVE WS-YTD-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   791 END-PERFORM.
   792
   793 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   794 ADD +1 TO WS-OUT-CNT.
   795
   796 2050-EXIT.
   797     EXIT.
   798
   799
   800
   801 2060-MOVE-YTD-AMTS.
   802
   803 MOVE WS-YTD-ME-DATE      TO WS-FO-ME-DATE.
   804 MOVE WS-YTD-CARRIER      TO WS-FO-CARRIER.
   805 MOVE WS-YTD-COMP         TO WS-FO-COMP.
   806 MOVE WS-YTD-STATE        TO WS-FO-STATE.
   807 MOVE WS-YTD-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   808 MOVE WS-YTD-GROUP        TO WS-FO-GROUP.
   809 MOVE WS-YTD-EXP-DATE     TO WS-FO-EXP-DATE.
   810 MOVE WS-YTD-EFF-DATE     TO WS-FO-EFF-DATE.
   811 MOVE WS-YTD-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   812 MOVE WS-YTD-PREM-P-E     TO WS-FO-PREM-P-E.
   813 MOVE WS-YTD-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* DCC043CMB.cbl
   814 MOVE WS-YTD-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   815 MOVE WS-YTD-RETRO-P-E    TO WS-FO-RETRO-P-E.
   816 MOVE WS-YTD-TAX-P-E      TO WS-FO-TAX-P-E.
   817 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   818 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   819 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   820 MOVE WS-YTD-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   821 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   822 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   823 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   824 MOVE WS-YTD-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   825
   826 MOVE +0 TO WS-SUB.
   827 PERFORM 12 TIMES
   828     ADD +1 TO WS-SUB
   829     MOVE WS-YTD-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   830     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   831     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   832     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   833     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   834     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   835     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   836     MOVE WS-YTD-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   837     MOVE WS-YTD-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   838     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   839     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   840     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   841     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   842     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   843     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   844     MOVE WS-YTD-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   845     MOVE WS-YTD-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   846 END-PERFORM.
   847
   848 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   849 ADD +1 TO WS-OUT-CNT.
   850
   851 2060-EXIT.
   852     EXIT.
   853
   854
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       22112     Code:        6254
