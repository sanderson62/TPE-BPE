* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS091.cbl
* Options: int("ECS091.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS091.lst")
     1$SET ALTER
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS091.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS091.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.                                         03/19/98
     3                                                                  ECS091
     4 PROGRAM-ID.                 ECS091.                                 LV003
     5*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS091
     6*                            VMOD=2.006.                             CL**2
     7*AUTHOR.         LOGIC, INC.                                      ECS091
     8*                DALLAS, TEXAS.                                   ECS091
     9*                                                                 ECS091
    10*DATE-COMPILED.                                                   ECS091
    11                                                                  ECS091
    12*SECURITY.   *****************************************************ECS091
    13*            *                                                   *ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS091.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS091
    15*            *                                                   *ECS091
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS091
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS091
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *ECS091
    19*            *                                                   *ECS091
    20*            *****************************************************ECS091
    21*                                                                 ECS091
    22*REMARKS.                                                         ECS091
    23*        THIS PROGRAM RESTORES FILES FROM A BACKUP TAPE WITH      ECS091
    24*        MULTI FILES CREATED IN 090. THE FILES ARE  DATE-FILE,    ECS091
    25*        ACCOUNT MASTER, EPEC EXTRACT, DETAIL EXTRACT,REINSURANCE ECS091
    26*        TABLES, COMMISSION TABLES, CREDIT FILES, AND COMPENSATIONECS091
    27*        MASTER.                                                  ECS091
    28*                                                                 ECS091
    29*        THE DEFAULT OPTION RESTORES THE DATE, ACCOUNT MASTER,    ECS091
    30*        EPEC REXTRACT, DETAIL EXTRACT, REINSURANCE TABLES,       ECS091
    31*        COMMISSION TABLES, AND COMPENSATION MASTER.              ECS091
    32*        WHEN A CONTROL CARD IS ENTERED, ONLY FILES REQUESTED     ECS091
    33*        TO BE RESTORED WILL BE RESTORED.                         ECS091
    34*                                                                 ECS091
    35*        FORMAT IS   COL 1-6 ECS091                               ECS091
    36*                    COL  8  DATE FILE          X = RESTORE       ECS091
    37*                    COL 10  ACCOUNT MASTER     X = RESTORE       ECS091
    38*                    COL 12  EPEC EXTRACT       X = RESTORE       ECS091
    39*                    COL 14  DETAIL EXTRACT     X = RESTORE       ECS091
    40*                    COL 16  REINS TABLES       X = RESTORE       ECS091
    41*                    COL 18  COMM TABLES        X = RESTORE       ECS091
    42*                    COL 20  CLASIC CREDIT FILE X = RESTORE       ECS091
    43*                    COL 22  COMP MASTER        X = RESTORE       ECS091
    44*                                                                 ECS091
    45*        COLUMNS MUST CONTAIN EITHER AN X OR A SPACE.             ECS091
    46*                                                                 ECS091
    47*        FOR CLIENTS ON THE CLASIC CREDIT SYSTEM, THE EXTRACT     ECS091
    48*        FILE FROM EL521 WILL BE RESTORED INSTEAD OF THE          ECS091
    49*        PENDING FILE.                                            ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS091.cbl
    51 ENVIRONMENT DIVISION.                                            ECS091
    52 INPUT-OUTPUT SECTION.                                            ECS091
    53 FILE-CONTROL.                                                    ECS091
    54                                                                  ECS091
    55     SELECT CARD-FILE        ASSIGN TO SYS006-UR-2501-S-SYS006.   ECS091
    56     SELECT PRNT-FILE        ASSIGN TO SYS008-UR-1403-S-SYS008.   ECS091
    57                                                                  ECS091
    58     SELECT BKUP-DATE        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    59     SELECT BKUP-ACCT        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    60     SELECT BKUP-EPEC        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    61     SELECT BKUP-EXTR        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    62     SELECT BKUP-REIN        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    63     SELECT BKUP-CTBL        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    64     SELECT BKUP-CRED        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    65     SELECT BKUP-COMP        ASSIGN TO SYS013-UT-2400-S-SYS013.   ECS091
    66                                                                  ECS091
    67     SELECT DISK-DATE        ASSIGN TO SYS019-UT-FBA1-S-SYS019.   ECS091
    68     SELECT ACCT-FILE        ASSIGN TO SYS016-FBA1-ERACCTT        ECS091
    69                             ACCESS IS SEQUENTIAL                 ECS091
    70                             ORGANIZATION IS INDEXED              ECS091
    71                             FILE STATUS IS ERACCTT-FILE-STATUS   ECS091
    72                             RECORD KEY IS AM-CONTROL-KEY.        ECS091
    73     SELECT EPEC-FILE        ASSIGN TO SYS018-UT-2400-S-SYS018.   ECS091
    74     SELECT EXTR-FILE        ASSIGN TO SYS012-UT-2400-S-SYS012.   ECS091
    75     SELECT REIN-FILE        ASSIGN TO SYS014                     ECS091
    76                             ACCESS IS SEQUENTIAL                 ECS091
    77                             ORGANIZATION IS INDEXED              ECS091
    78                             FILE STATUS IS REIN-FILE-STATUS      ECS091
    79                             RECORD KEY IS REIN-KEY.              ECS091
    80     SELECT CTBL-FILE        ASSIGN TO SYS016                     ECS091
    81                             ACCESS IS SEQUENTIAL                 ECS091
    82                             ORGANIZATION IS INDEXED              ECS091
    83                             FILE STATUS IS COMM-FILE-STATUS      ECS091
    84                             RECORD KEY IS COMM-KEY.              ECS091
    85     SELECT CRED-FILE        ASSIGN TO SYS011-UT-2400-S-SYS011.   ECS091
    86     SELECT COMP-FILE        ASSIGN TO SYS018-UT-2400-S-SYS018.   ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS091.cbl
    88 DATA DIVISION.                                                   ECS091
    89 FILE SECTION.                                                    ECS091
    90                                                                  ECS091
    91 FD  CARD-FILE                                                    ECS091
    92     RECORDING MODE F                                             ECS091
    93     BLOCK CONTAINS 0 RECORDS
    94     LABEL RECORDS OMITTED.                                       ECS091
    95 01  C-REC.                                                       ECS091
    96     12  C-CODE              PIC X(6).                            ECS091
    97     12  FILLER              PIC X.                               ECS091
    98     12  C-DATE              PIC X.                               ECS091
    99     12  FILLER              PIC X.                               ECS091
   100     12  C-ACCT              PIC X.                               ECS091
   101     12  FILLER              PIC X.                               ECS091
   102     12  C-EPEC              PIC X.                               ECS091
   103     12  FILLER              PIC X.                               ECS091
   104     12  C-EXTR              PIC X.                               ECS091
   105     12  FILLER              PIC X.                               ECS091
   106     12  C-REIN              PIC X.                               ECS091
   107     12  FILLER              PIC X.                               ECS091
   108     12  C-CTBL              PIC X.                               ECS091
   109     12  FILLER              PIC X.                               ECS091
   110     12  C-CRED              PIC X.                               ECS091
   111     12  FILLER              PIC X.                               ECS091
   112     12  C-COMP              PIC X.                               ECS091
   113     12  FILLER              PIC X(58).                           ECS091
   114                                                                  ECS091
   115 FD  PRNT-FILE                                                    ECS091
   116     RECORDING MODE F                                             ECS091
   117     LABEL RECORDS OMITTED                                        ECS091
   118     RECORD CONTAINS 133 CHARACTERS.                              ECS091
   119 01  PRT-REC.                                                     ECS091
   120     12  PRT-LINE.                                                ECS091
   121         16  PRT-C           PIC X.                               ECS091
   122         16  PRT-RST         PIC X(132).                          ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS091.cbl
   124                                                                  ECS091
   125 FD  DISK-DATE                                                    ECS091
*  126                             COPY ELCDTEFD.                       ECS091
   127******************************************************************04/15/98
   128*                                                                *ELCDTEFD
   129*                                                                *ELCDTEFD
   130*                            ELCDTEFD.                           *   LV002
   131*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   132*                            VMOD=2.007                          *   CL**2
   133*                                                                *ELCDTEFD
   134******************************************************************ELCDTEFD
   135     BLOCK CONTAINS 0 RECORDS
   136     RECORDING MODE F.                                            ELCDTEFD
   137                                                                  ELCDTEFD
   138 01  DATE-DISK.                                                   ELCDTEFD
   139     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   140     12  FILLER                      PIC  X(14).                  ELCDTEFD
   141     12  DD-CR1                      PIC  9.                      ELCDTEFD
   142     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   143     12  DD-CR2                      PIC  9.                      ELCDTEFD
   144     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   145     12  FILLER                      PIC  X(20).                  ELCDTEFD
   146                                                                  ELCDTEFD
   147 01  DATE-DISK-R.                                                 ELCDTEFD
   148     12  FILLER                      PIC  X(4).                   ELCDTEFD
   149     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   150                                     PIC  X(32).                  ELCDTEFD
   151                                                                  ELCDTEFD
   152 01  DATE-DISK-T.                                                 ELCDTEFD
   153     12  FILLER                      PIC  X(4).                   ELCDTEFD
   154     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   155                                     PIC  X(48).                  ELCDTEFD
   156                                                                  ELCDTEFD
   157 01  DATE-DISK-M.                                                 ELCDTEFD
   158     12  FILLER                      PIC  X(4).                   ELCDTEFD
   159     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   160                                     PIC  X(48).                  ELCDTEFD
   161                                                                  ELCDTEFD
   162 01  DATE-DISK-P.                                                 ELCDTEFD
   163     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   164     12  DD-IDX                      PIC  99.                     ELCDTEFD
   165     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   166     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   167         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   168                                     PIC  X.                      ELCDTEFD
   169         16  FILLER                  PIC  X(46).                  ELCDTEFD
   170     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   171         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   172             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   173             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   174             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   175             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   176         16  FILLER                  PIC  X(16).                  ELCDTEFD
   177                                                                  ELCDTEFD
   178 01  DATE-DISK-E.                                                 ELCDTEFD
   179     12  FILLER                      PIC  X(4).                   ELCDTEFD
   180     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   181                                     PIC  X(4).                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   182                                                                  ELCDTEFD
   183 01  DATE-DISK-C.                                                 ELCDTEFD
   184     12  FILLER                      PIC  X(7).                   ELCDTEFD
   185     12  DD-CARR1-SECPAY-SW          PIC  X.
   186     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   187     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   188     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   189     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   190     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   191     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   192     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   193     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   194     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   195     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   196     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   197     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   198     12  DD-CARR2-SECPAY-SW          PIC  X.
   199     12  FILLER                      PIC  X(7).                   ELCDTEFD
   200                                                                  ELCDTEFD
   201 01  DATE-DISK-OPT.                                               ELCDTEFD
   202     12  FILLER                      PIC  X(04).                  ELCDTEFD
   203     12  DD-TLR-DATA.                                             ELCDTEFD
   204         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   205                                     PIC  X(03).                  ELCDTEFD
   206     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   207         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   208                                     PIC  X(06).                  ELCDTEFD
   209     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   210         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   211                                     PIC  X(07).                  ELCDTEFD
   212         16  FILLER                  PIC  X(05).                  ELCDTEFD
   213     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   214                                     PIC  X(96).                  ELCDTEFD
   215******************************************************************ELCDTEFD
   216                                                                  ECS091
   217 01  DATE-REC.                                                    ECS091
   218     12  FILLER              PIC X(100).                          ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS091.cbl
   220                                                                  ECS091
   221 FD  BKUP-DATE                                                    ECS091
   222     RECORDING MODE F                                             ECS091
   223     LABEL RECORDS STANDARD                                       ECS091
   224     BLOCK CONTAINS 0 RECORDS
   225     RECORD CONTAINS 100 CHARACTERS.                              ECS091
   226 01  BK-DATE.                                                     ECS091
   227     12  FILLER              PIC X(100).                          ECS091
   228                                                                  ECS091
   229 FD  BKUP-ACCT                                                    ECS091
   230     RECORDING MODE F                                             ECS091
   231     LABEL RECORDS STANDARD                                       ECS091
   232     BLOCK CONTAINS 0 RECORDS
   233     RECORD CONTAINS 2000 CHARACTERS.                             ECS091
   234 01  BK-ACCT.                                                     ECS091
   235     12  FILLER              PIC X(2000).                         ECS091
   236                                                                  ECS091
   237 FD  ACCT-FILE                                                    ECS091
   238     LABEL RECORDS ARE STANDARD                                   ECS091
   239     BLOCK CONTAINS 0 RECORDS
   240     RECORD CONTAINS 2000 CHARACTERS.                             ECS091
   241 01  ACCT-REC.                                                    ECS091
   242     12  FILLER              PIC XX.                              ECS091
   243     12  AM-CONTROL-KEY      PIC X(26).                           ECS091
   244     12  FILLER              PIC X(1972).                         ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS091.cbl
   246                                                                  ECS091
   247 FD  BKUP-EPEC
*                                     COPY ECSEPCFD.                    ECS091
   248******************************************************************07/10/97
   249*                                                                *ECSEPCFD
   250*                            ECSEPCFD                            *   LV001
   251*                            VMOD=2.002                          *ECSEPCFD
   252*                                                                *ECSEPCFD
   253*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   254*                                                                *ECSEPCFD
   255******************************************************************ECSEPCFD
   256     RECORDING MODE F                                             ECSEPCFD
   257     LABEL RECORDS STANDARD                                       ECSEPCFD
   258     BLOCK CONTAINS 0 RECORDS
   259     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   260******************************************************************ECSEPCFD
   261 01  BK-EPEC.                                                     ECS091
   262     12  FILLER              PIC X(325).                          ECS091
   263                                                                  ECS091
   264 FD  EPEC-FILE                                                    ECS091
   265     RECORDING MODE F                                             ECS091
   266     LABEL RECORDS STANDARD                                       ECS091
   267     BLOCK CONTAINS 0 RECORDS
   268     RECORD CONTAINS 325 CHARACTERS.                              ECS091
   269 01  EPEC-REC.                                                    ECS091
   270     12  FILLER              PIC X(325).                          ECS091
   271                                                                  ECS091
   272 FD  BKUP-EXTR
*                                     COPY ECSEXTFD.                    ECS091
   273******************************************************************07/10/97
   274*                                                                *ECSEXTFD
   275*                            ECSEXTFD                            *   LV001
   276*                            VMOD=2.001                          *ECSEXTFD
   277*                                                                *ECSEXTFD
   278*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
   279*                                                                *ECSEXTFD
   280******************************************************************ECSEXTFD
   281     RECORDING MODE F                                             ECSEXTFD
   282     LABEL RECORDS STANDARD                                       ECSEXTFD
   283     BLOCK CONTAINS 0 RECORDS
   284     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
   285******************************************************************ECSEXTFD
   286 01  BK-EXTR.                                                     ECS091
   287     12  FILLER              PIC X(510).                          ECS091
   288                                                                  ECS091
   289 FD  EXTR-FILE                                                    ECS091
   290     RECORDING MODE F                                             ECS091
   291     LABEL RECORDS STANDARD                                       ECS091
   292     BLOCK CONTAINS 0 RECORDS
   293     RECORD CONTAINS 510 CHARACTERS.                              ECS091
   294 01  EXTR-REC.                                                    ECS091
   295     12  FILLER              PIC X(510).                          ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS091.cbl
   297                                                                  ECS091
   298 FD  BKUP-REIN                                                    ECS091
   299     RECORDING MODE F                                             ECS091
   300     LABEL RECORDS STANDARD                                       ECS091
   301     BLOCK CONTAINS 0 RECORDS
   302     RECORD CONTAINS 4000 CHARACTERS.                             ECS091
   303 01  BK-REIN.                                                     ECS091
   304     12  FILLER              PIC X(4000).                         ECS091
   305                                                                  ECS091
   306 FD  REIN-FILE                                                    ECS091
   307     LABEL RECORDS STANDARD                                       ECS091
   308     RECORD CONTAINS 4000 CHARACTERS.                             ECS091
   309 01  REIN-REC.                                                    ECS091
   310     12  FILLER              PIC X(3).                            ECS091
   311     12  REIN-KEY            PIC X(7).                            ECS091
   312     12  FILLER              PIC X(3990).                         ECS091
   313                                                                  ECS091
   314 FD  BKUP-CTBL                                                    ECS091
   315     RECORDING MODE F                                             ECS091
   316     LABEL RECORDS STANDARD                                       ECS091
   317     BLOCK CONTAINS 0 RECORDS
   318     RECORD CONTAINS 200 CHARACTERS.                              ECS091
   319 01  BK-CTBL.                                                     ECS091
   320     12  FILLER              PIC X(200).                          ECS091
   321                                                                  ECS091
   322 FD  CTBL-FILE                                                    ECS091
   323     LABEL RECORDS STANDARD                                       ECS091
   324     RECORD CONTAINS 200 CHARACTERS.                              ECS091
   325 01  CTBL-REC.                                                    ECS091
   326     12  FILLER              PIC XX.                              ECS091
   327     12  COMM-KEY            PIC X(7).                            ECS091
   328     12  FILLER              PIC X(191).                          ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS091.cbl
   330 FD  BKUP-CRED                                                    ECS091
   331     RECORDING MODE F                                             ECS091
   332     LABEL RECORDS STANDARD                                       ECS091
   333     BLOCK CONTAINS 0 RECORDS
   334     RECORD CONTAINS 514 CHARACTERS.                              ECS091
   335 01  BK-CRED                 PIC X(514).                          ECS091
   336                                                                  ECS091
   337 FD  CRED-FILE                                                    ECS091
   338     RECORDING MODE F                                             ECS091
   339     LABEL RECORDS STANDARD                                       ECS091
   340     BLOCK CONTAINS 0 RECORDS
   341     RECORD CONTAINS 514 CHARACTERS.                              ECS091
   342 01  CRED-REC                PIC X(514).                          ECS091
   343                                                                  ECS091
   344 FD  BKUP-COMP                                                    ECS091
   345     LABEL RECORDS STANDARD.                                      ECS091
   346 01  BK-COMP                 PIC X(700).                          ECS091
   347                                                                  ECS091
   348 FD  COMP-FILE                                                    ECS091
*  349                             COPY ECSCOIFD.                       ECS091
   350******************************************************************07/10/97
   351*                                                                *ECSCOIFD
   352*                            ECSCOIFD                            *   LV001
   353*                            VMOD=2.005                          *ECSCOIFD
   354*                                                                *ECSCOIFD
   355* NO CID  MODS IN  COPYBOOK  ECSCOIFD.                           *ECSCOIFD
   356*                                                                *ECSCOIFD
   357******************************************************************ECSCOIFD
   358     BLOCK CONTAINS 0 RECORDS
   359     RECORDING MODE F.                                            ECSCOIFD
   360                                                                  ECSCOIFD
   361 01  COMP-IN-RECORD.                                              ECSCOIFD
   362     12  COI-ID                            PIC XX.                ECSCOIFD
   363                                                                  ECSCOIFD
   364     12  COI-CONTROL.                                             ECSCOIFD
   365         16  COI-COMPANY-CD                PIC X.                 ECSCOIFD
   366         16  COI-CTL-1.                                           ECSCOIFD
   367             20  COI-CARR-GROUP.                                  ECSCOIFD
   368                 24  COI-CARRIER           PIC X.                 ECSCOIFD
   369                 24  COI-GROUPING.                                ECSCOIFD
   370                     28  COI-GRP-PREFIX    PIC XXX.               ECSCOIFD
   371                     28  COI-GRP-PRIME     PIC XXX.               ECSCOIFD
   372             20  COI-RESP-NO.                                     ECSCOIFD
   373                 24  COI-RESP-PREFIX       PIC X(4).              ECSCOIFD
   374                 24  COI-RESP-PRIME        PIC X(6).              ECSCOIFD
   375         16  COI-CTL-2.                                           ECSCOIFD
   376             20  COI-ACCOUNT.                                     ECSCOIFD
   377                 24  COI-ACCT-PREFIX       PIC X(4).              ECSCOIFD
   378                 24  COI-ACCT-PRIME        PIC X(6).              ECSCOIFD
   379         16  COI-TYPE                      PIC X.                 ECSCOIFD
   380             88  COI-COMPANY-RECORD           VALUE 'C'.          ECSCOIFD
   381             88  COI-GENERAL-AGENT-RECORD     VALUE 'G'.          ECSCOIFD
   382             88  COI-ACCOUNT-RECORD           VALUE 'A'.          ECSCOIFD
   383                                                                  ECSCOIFD
   384     12  FILLER                            PIC X(20).             ECSCOIFD
   385                                                                  ECSCOIFD
   386     12  COI-BALANCE-CONTROL               PIC X.                 ECSCOIFD
   387         88  COI-CARRY-BALANCE                VALUE 'Y'.          ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS091.cbl (/apps/prod/cid1p/copy/ECSCOIFD)
   388         88  COI-NO-BALANCE                   VALUE 'N'.          ECSCOIFD
   389                                                                  ECSCOIFD
   390     12  COI-INTERNAL-CONTROL-1            PIC X.                 ECSCOIFD
   391         88  COI-AUTO-GENERATED-THIS-RUN      VALUE 'X'.          ECSCOIFD
   392         88  COI-AUTO-GENERATED               VALUE 'Y'.          ECSCOIFD
   393         88  COI-NOT-AUTO-GENERATED           VALUE 'N'.          ECSCOIFD
   394                                                                  ECSCOIFD
   395     12  COI-INTERNAL-CONTROL-2            PIC X.                 ECSCOIFD
   396         88  COI-STATEMENT-THIS-RUN           VALUE 'Y'.          ECSCOIFD
   397         88  COI-NO-STATEMENT-THIS-RUN        VALUE 'N'.          ECSCOIFD
   398                                                                  ECSCOIFD
   399     12  COI-FUTURE-SPACE                  PIC X(5).              ECSCOIFD
   400         88  COI-FUTURE-NOT-USED              VALUE '     '.      ECSCOIFD
   401                                                                  ECSCOIFD
   402     12  COI-DATA                          PIC X(641).            ECSCOIFD
   403                                                                  ECSCOIFD
   404******************************************************************ECSCOIFD
   405 01  COMP-MSTR-REC           PIC X(700).                          ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS091.cbl
   407 WORKING-STORAGE SECTION.                                         ECS091
   408 77  FILLER  PIC X(32) VALUE '********************************'.  ECS091
   409 77  FILLER  PIC X(32) VALUE '     ECS091 WORKING-STORAGE     '.  ECS091
   410 77  FILLER  PIC X(32) VALUE '*****V/M=2.006 *****************'.     CL**2
   411                                                                  ECS091
   412 77  LN-CTR                  PIC S999  COMP-3    VALUE +066.      ECS091
   413 77  SAV-NDX                 PIC S999  COMP-3    VALUE +0.        ECS091
   414 77  DATE-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   415 77  ACCT-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   416 77  EPEC-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   417 77  EXTR-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   418 77  REIN-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   419 77  CTBL-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   420 77  CRED-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   421 77  COMP-CTR                PIC S9(9) COMP-3    VALUE +0.        ECS091
   422 77  SPACE-NP                PIC X               VALUE '1'.       ECS091
   423 77  SPACE-1                 PIC X               VALUE ' '.       ECS091
   424 77  SPACE-2                 PIC X               VALUE '0'.       ECS091
   425 77  SPACE-3                 PIC X               VALUE '-'.       ECS091
   426 77  CCSW                    PIC 9               VALUE 0.         ECS091
   427 77  DATE-SW                 PIC X               VALUE 'X'.       ECS091
   428 77  ACCT-SW                 PIC X               VALUE 'X'.       ECS091
   429 77  EPEC-SW                 PIC X               VALUE 'X'.       ECS091
   430 77  EXTR-SW                 PIC X               VALUE 'X'.       ECS091
   431 77  REIN-SW                 PIC X               VALUE 'X'.       ECS091
   432 77  CTBL-SW                 PIC X               VALUE 'X'.       ECS091
   433 77  CRED-SW                 PIC X               VALUE ' '.       ECS091
   434 77  COMP-SW                 PIC X               VALUE 'X'.       ECS091
   435                                                                  ECS091
   436* DEFAULT SWITCHES                                                ECS091
   437*    RESTORE DATE FILE                                            ECS091
   438*    RESTORE ACCOUNT MASTER                                       ECS091
   439*    RESTORE EPEC EXTRACT FILE                                    ECS091
   440*    RESTORE EXTRACT FILE                                         ECS091
   441*    RESTORE REINSURANCE TABLES                                   ECS091
   442*    RESTORE COMMISSION TABLES                                    ECS091
   443*    RESTORE COMPENSATION MASTER                                  ECS091
   444*    DO NOT RESTORE CRED TRANS FILE UNLESS CONTROL CARD           ECS091
   445*           CONTAINS AN X IN COLUMN 20.                           ECS091
   446* IF A CONTROL CARD IS ENTERED ALL SWITCHES WILL BE ALTERED.      ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS091.cbl
   448 01  MISC-WORK.                                                   ECS091
   449     12  ABEND-CODE.                                              ECS091
   450         16  ABEND-FILE-ID   PIC XX              VALUE ZEROS.     ECS091
   451         16  ABEND-REASON    PIC XX              VALUE ZEROS.     ECS091
   452     12  ABEND-OPTION        PIC X               VALUE 'Y'.       ECS091
   453     12  PGM-SUB             PIC S999 COMP       VALUE +091.      ECS091
   454     12  FIRST-TIME-SW       PIC X               VALUE 'Y'.       ECS091
   455         88  FIRST-TIME                          VALUE 'Y'.       ECS091
   456     12  FIRST-PASS-SWITCH   PIC 9               VALUE 1.         ECS091
   457         88  FIRST-PASS  VALUE 1.                                 ECS091
   458                                                                  ECS091
   459 01  WS-ABEND-AREAS.                                              ECS091
   460     12  WS-ABEND-MESSAGE       PIC X(80).                        ECS091
   461     12  WS-ABEND-FILE-STATUS   PIC XX           VALUE ZERO.      ECS091
   462     12  WS-RETURN-CODE         PIC S9(4)        COMP.            ECS091
   463     12 WS-ZERO                 PIC S9           VALUE ZERO       ECS091
   464                                                 COMP-3.          ECS091
   465 01  FILE-STATUS.                                                 ECS091
   466     12  ERACCTT-FILE-STATUS    PIC XX              VALUE '00'.   ECS091
   467     12  REIN-FILE-STATUS       PIC XX              VALUE '00'.   ECS091
   468     12  COMM-FILE-STATUS       PIC XX              VALUE '00'.   ECS091
   469                                                                  ECS091
   470 01  SAVE-PRINT.                                                  ECS091
   471     12  SAV-PRT-LINE    OCCURS 10 TIMES.                         ECS091
   472        16  SAV-CCSW         PIC X.                               ECS091
   473        16  SAV-LINE         PIC X(132).                          ECS091
   474                                                                  ECS091
   475 01  HEADINGS.                                                    ECS091
   476     12  HEAD-1.                                                  ECS091
   477         16  FILLER          PIC X(46)           VALUE SPACES.    ECS091
   478         16  FILLER          PIC X(32)           VALUE            ECS091
   479                 'SYSTEM BACKUP FILE RESTORATATION'.              ECS091
   480         16  FILLER          PIC X(46)           VALUE SPACES.    ECS091
   481         16  FILLER          PIC X(8)            VALUE 'ECS-091'. ECS091
   482     12  HEAD-2.                                                  ECS091
   483         16  FILLER          PIC X(47)           VALUE SPACES.    ECS091
   484         16  HD-CLIENT       PIC X(30).                           ECS091
   485         16  FILLER          PIC X(47)           VALUE SPACES.    ECS091
   486         16  HD-IPL          PIC X(8)            VALUE SPACES.    ECS091
   487     12  HEAD-3.                                                  ECS091
   488         16  FILLER          PIC X(52)           VALUE SPACES.    ECS091
   489         16  HD-DATE         PIC X(18).                           ECS091
   490         16  FILLER          PIC X(42)           VALUE SPACES.    ECS091
   491         16  FILLER          PIC X(11)           VALUE            ECS091
   492                 'PAGE      1'.                                   ECS091
   493     12  HEAD-4.                                                  ECS091
   494         16  FILLER     PIC X(32)                VALUE            ECS091
   495                 '     FILE NAME                  '.              ECS091
   496         16  FILLER     PIC X(14)                VALUE            ECS091
   497                 '  RECORD COUNT'.                                ECS091
   498                                                                  ECS091
   499 01  P-REC.                                                       ECS091
   500     12  P-CCSW              PIC X.                               ECS091
   501     12  P-LINE.                                                  ECS091
   502         16  P-DESC          PIC X(32).                           ECS091
   503         16  P-CTR           PIC Z,ZZZ,ZZZ,ZZZ-.                  ECS091
   504         16  FILLER          PIC X(6).                            ECS091
   505         16  P-MSG           PIC X(40).                           ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS091.cbl
   506         16  FILLER          PIC X(40).                           ECS091
   507                                                                  ECS091
*  508                             COPY ELCDTECX.                       ECS091
   509******************************************************************06/05/98
   510*                                                                *ELCDTECX
   511*                            ELCDTECX.                           *   LV005
   512*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   513*                            VMOD=2.015                          *ELCDTECX
   514*                                                                *ELCDTECX
   515*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   516*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   517*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   518*                                                                *ELCDTECX
   519******************************************************************ELCDTECX
   520******************************************************************
   521*                   C H A N G E   L O G
   522*
   523* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   524*-----------------------------------------------------------------
   525*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   526* EFFECTIVE    NUMBER
   527*-----------------------------------------------------------------
   528* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   529*                                  BENEFIT CODES FROM 300 TO 900
   530* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   531* 051304    2003080800002  SMVA  ADD REFUND METHOD
   532* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   533******************************************************************
   534 01  DATE-CARD.                                                   ELCDTECX
   535     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   536     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   537     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   538     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   539     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   540     12  EP-SW                       PIC  X.                      ELCDTECX
   541         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   542     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   543         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   544     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   545     12  RUN-CENTURY.                                             ELCDTECX
   546         16 RUN-CENTURY-N            PIC  99.                        CL**4
   547     12  FILLER                      PIC  X.                         CL**4
   548     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   549     12  FILLER                      PIC  XXX.                    ELCDTECX
   550     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   551                                                                  ELCDTECX
   552 01  FILLER                          PIC  X(7)                       CL**6
   553                                          VALUE 'OPTIONS'.        ELCDTECX
   554 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   555     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   556     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   557     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   558         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   559         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   560     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   561     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   562     12  FILLER                      PIC  X.                      ELCDTECX
   563     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   564     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   565     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   566     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   567     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   568     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   569     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   570     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   571     12  FILLER                      PIC  X.                      ELCDTECX
   572     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   573     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   574     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   575     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   576     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   577     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   578     12  FILLER                      PIC  X.                      ELCDTECX
   579     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   580     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   581     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   582     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   583     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   584     12  DTE-R78                     PIC  X.                      ELCDTECX
   585     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   586     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   587     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   588     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   589     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   590     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   591     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   592                                     PIC  X.                      ELCDTECX
   593         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   594                                                 ' '.             ELCDTECX
   595         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   596         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   597     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   598         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   599         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   600     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   601     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   602                                     PIC  9.                         CL**4
   603     12  DTE-SYSTEM.                                              ELCDTECX
   604         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   605         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   606         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   607         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   608         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   609         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   610         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   611         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   612         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   613         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   614         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   615         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   616         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   617         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   618         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   619         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   620         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   621         16  DTE-SYS-R               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   622         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   623         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   624         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   625         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   626         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   627         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   628         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   629         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   630     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   631         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   632                                     PIC  X.                      ELCDTECX
   633     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   634                                                                  ELCDTECX
   635 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   636     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   637     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   638     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   639*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   640     12  FILLER                      PIC  X.                      ELCDTECX
   641     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   642     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   643     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   644     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   645     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   646     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   647     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   648                                                                  ELCDTECX
   649     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   650     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   651     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   652     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   653                                                                  ELCDTECX
   654     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   655     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   656     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   657     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   658                                                                  ELCDTECX
   659     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   660     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   661                                                                  ELCDTECX
   662     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   663     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   664                                                                  ELCDTECX
   665     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   666                                                                  ELCDTECX
   667 01  DATE-CARD-FACTORS.                                           ELCDTECX
   668     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   669     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   670     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   671     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   672     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   673     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   674     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   675                                                                  ELCDTECX
   676 01  FILLER                          PIC  X(12)                   ELCDTECX
   677                                          VALUE 'COMPANY NAME'.   ELCDTECX
   678 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   679     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   680         16  CNT-ID                  PIC  X.                      ELCDTECX
   681         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   682                                                                  ELCDTECX
   683 01  FILLER                          PIC  X(11)                   ELCDTECX
   684                                          VALUE 'STATE NAMES'.    ELCDTECX
   685 01  STATE-NAMES.                                                 ELCDTECX
   686     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   687         16  STATE-SUB               PIC  XX.                     ELCDTECX
   688         16  STATE-PIC1.                                          ELCDTECX
   689             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   690             20  FILLER              PIC  XXX.                    ELCDTECX
   691             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   692             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   693             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   694             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   695                                                                  ELCDTECX
   696 01  FILLER                          PIC  X(13)                   ELCDTECX
   697                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   698 01  CARRIER-NAMES.                                               ELCDTECX
   699     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   700         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   701         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   702         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   703         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   704         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   705         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   706*        16  FILLER                  PIC  X.                      ELCDTECX
   707         16  CARRIER-SEC-PAY         PIC  X.
   708             88  SEC-PAY-CARRIER          VALUE 'Y'.
   709                                                                  ELCDTECX
   710 01  FILLER                          PIC  X(9)                       CL**6
   711                                          VALUE 'INS TYPES'.      ELCDTECX
   712 01  CLAS-INS-TYPES.                                              ELCDTECX
   713*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   714     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   715         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   716         16  CLAS-I-AB3.                                          ELCDTECX
   717             20  FILLER              PIC  X.                      ELCDTECX
   718             20  CLAS-I-AB2.                                      ELCDTECX
   719                 24  FILLER          PIC  X.                      ELCDTECX
   720                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   721         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   722             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   723             20  FILLER              PIC  X.                         CL**4
   724         16  CLAS-I-AB10.                                         ELCDTECX
   725             20  FILLER              PIC  X(9).                   ELCDTECX
   726             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   727         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   728         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   729         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   730         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   731             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   732         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   733         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   734         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   735         16  CLAS-I-BEN-CATEGORY     PIC  X.
   736         16  CLAS-I-REFUND-METHOD    PIC  X.
   737         16  CLAS-I-MAX-BENEFITS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   738         16  FILLER                  PIC  XXX.
   739                                                                  ELCDTECX
   740 01  FILLER                          PIC  X(16)                   ELCDTECX
   741                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   742 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   743     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   744                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   745         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   746         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   747         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   748         16  CLAS-MORT-DESC.                                      ELCDTECX
   749             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   750             20  FILLER              PIC  XX.                        CL**5
   751             20  CLAS-YEAR           PIC  X(4).                      CL**6
   752             20  FILLER              PIC  X.                         CL**5
   753             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   754             20  FILLER              PIC  X.                         CL**5
   755             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   756             20  FILLER              PIC  X.                         CL**5
   757             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   758             20  FILLER              PIC  X(5).                      CL**6
   759                                                                  ELCDTECX
   760 01  FILLER                          PIC  X(15)                   ELCDTECX
   761                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   762 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   763     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   764         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   765         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   766         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   767         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   768         16  FILLER                  PIC  X(4).                      CL**6
   769                                                                  ELCDTECX
   770 01  FILLER                          PIC  X(7)                       CL**6
   771                                     VALUE 'INDEXES'.             ELCDTECX
   772 01  CLAS-INDEX-TBL.                                              ELCDTECX
   773     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   774     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   775     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   776     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   777     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   778     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   779     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   780     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   781     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   782     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   783     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   784     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   785     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   786     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   787     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   788     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   789     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   790                                                                  ELCDTECX
   791 01  CLAS-TYPE-MISC.                                              ELCDTECX
   792     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   793     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   794     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   795     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   796     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   797     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   798     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   799     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   800     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   801     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   802     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   803                                                                  ELCDTECX
   804 01  FILLER                          PIC  X(13)                   ELCDTECX
   805                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   806 01  CLAS-MISC.                                                   ELCDTECX
   807     12  DTE-FICH                    PIC  X.                      ELCDTECX
   808         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   809         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   810         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   811     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   812     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   813     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   814     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   815     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   816     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   817     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   818     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   819     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   820     12  STATE-L                     PIC  XX.                     ELCDTECX
   821     12  CLAS-CN                     PIC  99.                     ELCDTECX
   822     12  CLAS-CO                     PIC  99.                     ELCDTECX
   823     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   824         16  DTE-F-1                 PIC  X.                      ELCDTECX
   825         16  DTE-F-2                 PIC  X.                      ELCDTECX
   826     12  DTE-ABEND-WORK.                                          ELCDTECX
   827         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   828         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   829                                                                  ELCDTECX
   830 01  FILLER                          PIC  X(12)                   ELCDTECX
   831                                     VALUE 'WORKING DATE'.        ELCDTECX
   832 01  WS-DATE-AND-TIME.                                            ELCDTECX
   833     12  WS-ACCEPT-DATE.                                          ELCDTECX
   834         16  WS-AD-YY                PIC  99.                     ELCDTECX
   835         16  WS-AD-MM                PIC  99.                     ELCDTECX
   836         16  WS-AD-DD                PIC  99.                     ELCDTECX
   837     12  WS-CURRENT-DATE.                                         ELCDTECX
   838         16  WS-CD-MM                PIC  99.                     ELCDTECX
   839         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   840         16  WS-CD-DD                PIC  99.                     ELCDTECX
   841         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   842         16  WS-CD-YY                PIC  99.                     ELCDTECX
   843     12  WS-TIME-OF-DAY.                                          ELCDTECX
   844         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   845         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   846                                                                  ELCDTECX
   847 01  FILLER                          PIC  X(12)                   ELCDTECX
   848                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   849 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   850     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   851         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   852         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   853         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   854                                                                  ELCDTECX
   855 01  FILLER                          PIC  X(10)                   ELCDTECX
   856                                     VALUE 'STATE TLRS'.          ELCDTECX
   857 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   858     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   859         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   860         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   861                                                                  ELCDTECX
   862 01  FILLER                          PIC  X(13)                   ELCDTECX
   863                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   864 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   865     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   866         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   867                                                                  ELCDTECX
   868 01  FILLER                          PIC  X(13)                   ELCDTECX
   869                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   870 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   871     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   872     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   873     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   874                                     PIC  X.                         CL**5
   875     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   876     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   877     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   878     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   879     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   880     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   881     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   882     12  FILLER                      PIC  X(75).                  ELCDTECX
   883******************************************************************ELCDTECX
   884*01  MISC-CARR-PCT-DATA.                                          00001521
   885*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   886*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   887*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   888*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   889*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   890*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   891******************************************************************ELCDTECX
   892                                                                  ECS091
*  893                             COPY ELCDTEVR.                       ECS091
   894***************************************************************** 04/15/98
   895*                                                                *ELCDTEVR
   896*                                                                *ELCDTEVR
   897*                            ELCDTEVR.                           *   LV003
   898*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   899*                            VMOD=2.001                          *   CL**2
   900*                                                                *ELCDTEVR
   901*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   902*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   903*                                                                *ELCDTEVR
   904******************************************************************ELCDTEVR
   905 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   906     05  WS-RUN-DATE.                                             ELCDTEVR
   907         10  FILLER                  PIC  9(03).                  ELCDTEVR
   908         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   909         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   910             15  RUN-CC              PIC  99.                     ELCDTEVR
   911             15  RUN-YR              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   912         10  RUN-MO                  PIC  99.                     ELCDTEVR
   913         10  RUN-DA                  PIC  99.                     ELCDTEVR
   914     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   915            WS-RUN-DATE              PIC 9(11).                      CL**2
   916     05  WS-EP-DT.                                                ELCDTEVR
   917         10  FILLER                  PIC  9(03).                  ELCDTEVR
   918         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   919         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   920             15  EP-CC               PIC  99.                     ELCDTEVR
   921             15  EP-YR               PIC  99.                     ELCDTEVR
   922         10  EP-MO                   PIC  99.                     ELCDTEVR
   923         10  EP-DA                   PIC  99.                     ELCDTEVR
   924     05  WS-EP-DT-N REDEFINES                                        CL**2
   925            WS-EP-DT                 PIC 9(11).                      CL**2
   926     05  WS-DTE-CONV-DT.                                             CL**4
   927         10  FILLER                  PIC  9(03).                     CL**4
   928         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   929         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   930             15  DTE-CONV-CC         PIC  99.                        CL**4
   931             15  DTE-CONV-YR         PIC  99.                        CL**4
   932         10  DTE-CONV-MO             PIC  99.                        CL**4
   933         10  DTE-CONV-DA             PIC  99.                        CL**4
   934     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   935            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   936 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   937     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   938         10  FILLER                            PIC 999.           ELCDTEVR
   939         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   940         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   941             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   942             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   943         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   944         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   945     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   946            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   947     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   948         10  FILLER                            PIC 999.           ELCDTEVR
   949         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   950         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   951         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   952         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   953     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   954            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   955 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   956     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   957         10  FILLER                            PIC 999.           ELCDTEVR
   958         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   959         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   960             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   961             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   962         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   963         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   964     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   965            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   966     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   967         10  FILLER                            PIC 999.           ELCDTEVR
   968         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   969         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   970             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   971             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   972         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   973         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   974     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   975            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   976     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   977         10  FILLER                            PIC 999.           ELCDTEVR
   978         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   979         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   980             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   981             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   982         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   983         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   984     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   985            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   986 01  WS-RATE-RECORD.                                              ELCDTEVR
   987         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   988             10  FILLER                        PIC 999.           ELCDTEVR
   989             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   990             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   991                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   992                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   993             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   994             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   995         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   996                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS091.cbl
   998 PROCEDURE DIVISION.                                              ECS091
   999                                                                  ECS091
  1000 0100-INTIALIZE-RTN.                                              ECS091
  1001     OPEN INPUT  CARD-FILE                                        ECS091
  1002          OUTPUT PRNT-FILE.                                       ECS091
  1003                                                                  ECS091
  1004     MOVE HIGH-VALUE             TO SAVE-PRINT.                   ECS091
  1005     MOVE SPACES                 TO P-REC.                        ECS091
  1006     MOVE 0                      TO CCSW.                         ECS091
  1007                                                                  ECS091
  1008 0110-READ-CONTROL.                                               ECS091
  1009     READ CARD-FILE AT END                                        ECS091
  1010         GO TO 0140-DEFAULT-RTN.                                  ECS091
  1011                                                                  ECS091
  1012 0120-HAVE-CONTROL-CARD.                                          ECS091
  1013     IF FIRST-PASS                                                ECS091
  1014         MOVE 2                 TO FIRST-PASS-SWITCH              ECS091
  1015         ALTER 0140-DEFAULT-RTN TO PROCEED TO 0160-PROCESS-RTN.   ECS091
  1016                                                                  ECS091
  1017 0130-PROCESS-CONTROL-CARD.                                       ECS091
  1018     MOVE C-REC                  TO P-DESC.                       ECS091
  1019                                                                  ECS091
  1020     IF C-CODE NOT = 'ECS091'                                     ECS091
  1021         MOVE 'INVALID CODE'     TO P-MSG                         ECS091
  1022         GO TO 9000-ABEND.                                        ECS091
  1023                                                                  ECS091
  1024     IF C-DATE = ' ' OR 'X'                                       ECS091
  1025         MOVE C-DATE             TO DATE-SW                       ECS091
  1026     ELSE                                                         ECS091
  1027         MOVE 'DATE SWITCH ERROR' TO P-MSG                        ECS091
  1028         GO TO 9000-ABEND.                                        ECS091
  1029                                                                  ECS091
  1030     IF C-ACCT = ' ' OR 'X'                                       ECS091
  1031         MOVE C-ACCT             TO ACCT-SW                       ECS091
  1032     ELSE                                                         ECS091
  1033         MOVE 'ACCT MASTER SWITCH ERROR' TO P-MSG                 ECS091
  1034         GO TO 9000-ABEND.                                        ECS091
  1035                                                                  ECS091
  1036     IF C-EPEC = ' ' OR 'X'                                       ECS091
  1037         MOVE C-EXTR             TO EXTR-SW                       ECS091
  1038     ELSE                                                         ECS091
  1039         MOVE 'EPEC EXTRACT SWITCH ERROR' TO P-MSG                ECS091
  1040         GO TO 9000-ABEND.                                        ECS091
  1041                                                                  ECS091
  1042     IF C-EXTR = ' ' OR 'X'                                       ECS091
  1043         MOVE C-EXTR             TO EXTR-SW                       ECS091
  1044     ELSE                                                         ECS091
  1045         MOVE 'DETAIL EXTRACT SWITCH ERROR' TO P-MSG              ECS091
  1046         GO TO 9000-ABEND.                                        ECS091
  1047                                                                  ECS091
  1048     IF C-REIN = ' ' OR 'X'                                       ECS091
  1049         MOVE C-REIN             TO REIN-SW                       ECS091
  1050     ELSE                                                         ECS091
  1051         MOVE 'REIN TBL SWITCH ERROR' TO P-MSG                    ECS091
  1052         GO TO 9000-ABEND.                                        ECS091
  1053                                                                  ECS091
  1054     IF C-CTBL = ' ' OR 'X'                                       ECS091
  1055         MOVE C-CTBL             TO CTBL-SW                       ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS091.cbl
  1056     ELSE                                                         ECS091
  1057         MOVE 'COMM TBL SWITCH ERROR' TO P-MSG                    ECS091
  1058         GO TO 9000-ABEND.                                        ECS091
  1059                                                                  ECS091
  1060     IF C-CRED = ' ' OR 'X'                                       ECS091
  1061         MOVE C-CRED             TO CRED-SW                       ECS091
  1062     ELSE                                                         ECS091
  1063         MOVE 'CLASIC CREDIT SWITCH ERROR' TO P-MSG               ECS091
  1064         GO TO 9000-ABEND.                                        ECS091
  1065                                                                  ECS091
  1066     IF C-COMP = ' ' OR 'X'                                       ECS091
  1067         MOVE C-COMP             TO CTBL-SW                       ECS091
  1068     ELSE                                                         ECS091
  1069         MOVE 'COMP MASTER SWITCH ERROR' TO P-MSG                 ECS091
  1070         GO TO 9000-ABEND.                                        ECS091
  1071                                                                  ECS091
  1072     MOVE 'CONTROL CARD ENTERED - REQUESTED OPTIONS' TO P-MSG.    ECS091
  1073                                                                  ECS091
  1074     PERFORM 0200-SAV-RTN THRU 0299-EXIT.                         ECS091
  1075                                                                  ECS091
  1076     GO TO 0110-READ-CONTROL.                                     ECS091
  1077                                                                  ECS091
  1078 0140-DEFAULT-RTN.                                                ECS091
  1079     GO TO 0150-ACTUAL-DEFAULT.                                   ECS091
  1080                                                                  ECS091
  1081 0150-ACTUAL-DEFAULT.                                             ECS091
  1082     MOVE 'NO CONTROL CARD ENTERED - DEFAULT OPTIONS' TO P-LINE.  ECS091
  1083                                                                  ECS091
  1084     PERFORM 0200-SAV-RTN THRU 0299-EXIT.                         ECS091
  1085                                                                  ECS091
  1086 0160-PROCESS-RTN.                                                ECS091
  1087     CLOSE CARD-FILE.                                             ECS091
  1088                                                                  ECS091
  1089     PERFORM 0600-RESTORE-DATE THRU 0699-EXIT.                    ECS091
  1090     PERFORM 0500-SET-UP-DATE  THRU 0599-EXIT.                    ECS091
  1091     PERFORM 0700-RESTORE-ACCT THRU 0799-EXIT.                    ECS091
  1092     PERFORM 0800-RESTORE-EPEC THRU 0899-EXIT.                    ECS091
  1093     PERFORM 0900-RESTORE-EXTR THRU 0999-EXIT.                    ECS091
  1094     PERFORM 1000-RESTORE-REIN THRU 1099-EXIT.                    ECS091
  1095     PERFORM 1100-RESTORE-CTBL THRU 1199-EXIT.                    ECS091
  1096     PERFORM 1200-RESTORE-CRED THRU 1299-EXIT.                    ECS091
  1097     PERFORM 1300-RESTORE-COMP THRU 1399-EXIT.                    ECS091
  1098                                                                  ECS091
  1099     GO TO 1600-CLS-FILES.                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS091.cbl
  1101 0200-SAV-RTN.                                                    ECS091
  1102     ADD +1 TO SAV-NDX.                                           ECS091
  1103     MOVE P-REC                  TO SAV-PRT-LINE (SAV-NDX).       ECS091
  1104                                                                  ECS091
  1105 0299-EXIT.                                                       ECS091
  1106     EXIT.                                                        ECS091
  1107                                                                  ECS091
  1108 0300-PRT-RTN.                                                    ECS091
  1109     MOVE P-REC                  TO PRT-REC.                      ECS091
  1110     MOVE P-CCSW                 TO CCSW.                         ECS091
  1111                                                                  ECS091
  1112     WRITE PRT-REC AFTER ADVANCING CCSW.                          ECS091
  1113                                                                  ECS091
  1114     MOVE SPACES                 TO P-REC.                        ECS091
  1115     MOVE SPACE-2                TO P-CCSW.                       ECS091
  1116                                                                  ECS091
  1117     IF CCSW = SPACE-NP                                           ECS091
  1118         MOVE +1                 TO LN-CTR                        ECS091
  1119     ELSE                                                         ECS091
  1120         IF CCSW = SPACE-1                                        ECS091
  1121             ADD +1 TO LN-CTR                                     ECS091
  1122         ELSE                                                     ECS091
  1123             IF CCSW = SPACE-2                                    ECS091
  1124                 ADD +2 TO LN-CTR                                 ECS091
  1125             ELSE                                                 ECS091
  1126                 ADD +3 TO LN-CTR.                                ECS091
  1127                                                                  ECS091
  1128 0399-EXIT.                                                       ECS091
  1129     EXIT.                                                        ECS091
  1130                                                                  ECS091
  1131 0400-HEAD-RTN.                                                   ECS091
  1132     MOVE SPACE-NP              TO P-CCSW.                        ECS091
  1133     MOVE HEAD-1                TO P-LINE.                        ECS091
  1134     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1135                                                                  ECS091
  1136     MOVE SPACE-1               TO P-CCSW.                        ECS091
  1137     MOVE HEAD-2                TO P-LINE.                        ECS091
  1138     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1139                                                                  ECS091
  1140     MOVE HEAD-3                TO P-LINE.                        ECS091
  1141     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1142                                                                  ECS091
  1143     MOVE HEAD-4                TO P-LINE.                        ECS091
  1144     PERFORM 0300-PRT-RTN THRU 0399-EXIT 2 TIMES.                 ECS091
  1145                                                                  ECS091
  1146 0499-EXIT.                                                       ECS091
  1147     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS091.cbl
  1149 0500-SET-UP-DATE.                                                ECS091
* 1150                             COPY ELCDTERX.                       ECS091
  1151******************************************************************04/15/98
  1152*                                                                *ELCDTERX
  1153*                                                                *ELCDTERX
  1154*                            ELCDTERX.                           *   LV002
  1155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1156*                            VMOD=2.007                          *ELCDTERX
  1157*                                                                *ELCDTERX
  1158*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1159*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1160*      = ELCDTEFD)                                               *ELCDTERX
  1161*                                                                *ELCDTERX
  1162******************************************************************ELCDTERX
  1163                                                                  ELCDTERX
  1164     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1165                                                                  ELCDTERX
  1166     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1167     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1168     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1169                                                                  ELCDTERX
  1170     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1171                                                                  ELCDTERX
  1172******************************************************************ELCDTERX
  1173*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1174*          WARNING MESSAGES.                                      ELCDTERX
  1175******************************************************************ELCDTERX
  1176     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1177         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1178                                                                  ELCDTERX
  1179     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1180                                                                  ELCDTERX
  1181     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1182                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1183                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1184                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1185                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1186                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1187                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1188                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1189                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1190                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1191                                                                  ELCDTERX
  1192     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1193                                                                  ELCDTERX
  1194     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1195                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1196                                                                  ELCDTERX
  1197     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1198     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1199     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1200     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1201                                                                  ELCDTERX
  1202     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1203         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1204     ELSE                                                         ELCDTERX
  1205         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1206                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1207     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1208         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1209     ELSE                                                         ELCDTERX
  1210         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1211                                                                  ELCDTERX
  1212 0005-READ--CARD.                                                 ELCDTERX
  1213     READ DISK-DATE                                               ELCDTERX
  1214         AT END CLOSE DISK-DATE                                   ELCDTERX
  1215             GO TO 0060-READ--TEST.                               ELCDTERX
  1216                                                                  ELCDTERX
  1217     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1218                                                                  ELCDTERX
  1219     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1220         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1221         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1222         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1223         GO TO 0005-READ--CARD.                                   ELCDTERX
  1224                                                                  ELCDTERX
  1225     IF DD-ID = 'CLAD'                                            ELCDTERX
  1226         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1227         GO TO 0005-READ--CARD.                                   ELCDTERX
  1228                                                                  ELCDTERX
  1229     IF DD-ID = 'CLAX'                                            ELCDTERX
  1230         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1231         GO TO 0005-READ--CARD.                                   ELCDTERX
  1232                                                                  ELCDTERX
  1233     IF DD-ID = 'CLAF'                                            ELCDTERX
  1234         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1235         GO TO 0005-READ--CARD.                                   ELCDTERX
  1236                                                                  ELCDTERX
  1237     IF DD-ID = 'CLAC'                                            ELCDTERX
  1238         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1239                                                                  ELCDTERX
  1240     IF DD-ID = 'CARR'                                            ELCDTERX
  1241         GO TO 0015-READ--CARR.                                   ELCDTERX
  1242                                                                  ELCDTERX
  1243     IF DD-ID = 'STAT'                                            ELCDTERX
  1244         GO TO 0020-READ--STAT.                                   ELCDTERX
  1245                                                                  ELCDTERX
  1246     IF DD-ID = 'BUSC'                                            ELCDTERX
  1247         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1248                                                                  ELCDTERX
  1249     IF DD-ID = 'MORT'                                            ELCDTERX
  1250         GO TO 0030-READ--MORT.                                   ELCDTERX
  1251                                                                  ELCDTERX
  1252     IF DD-ID = 'CLAI'                                            ELCDTERX
  1253         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1254                                                                  ELCDTERX
  1255     IF DD-ID = 'COLC'                                            ELCDTERX
  1256         GO TO 0065-READ--COLC.                                   ELCDTERX
  1257                                                                  ELCDTERX
  1258     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1259        DD-IDA = 'CL'                                             ELCDTERX
  1260         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1261                                                                  ELCDTERX
  1262     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1263        DD-IDA = 'PO'                                             ELCDTERX
  1264         GO TO 0050-READ--POXX.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1265                                                                  ELCDTERX
  1266     IF DD-ID = 'OPCA'                                            ELCDTERX
  1267         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1268                                                                  ELCDTERX
  1269     IF DD-ID = 'OPST'                                            ELCDTERX
  1270         GO TO 0072-READ--OPST.                                   ELCDTERX
  1271                                                                  ELCDTERX
  1272     IF DD-ID = 'OPBS'                                            ELCDTERX
  1273         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1274                                                                  ELCDTERX
  1275     IF DD-ID = 'OPMS'                                            ELCDTERX
  1276         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1277                                                                  ELCDTERX
  1278     GO TO 0005-READ--CARD.                                       ELCDTERX
  1279                                                                  ELCDTERX
  1280 0010-READ--CLAC.                                                 ELCDTERX
  1281     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1282     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1283     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1284     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1285     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1286     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1287     GO TO 0005-READ--CARD.                                       ELCDTERX
  1288                                                                  ELCDTERX
  1289 0015-READ--CARR.                                                 ELCDTERX
  1290     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1291     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1292        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1293        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1294        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1295        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1296        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1297        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1298        MOVE DD-CARR1-SECPAY-SW
  1299                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1300     END-IF
  1301                                                                  ELCDTERX
  1302     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1303     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1304        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1305        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1306        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1307        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1308        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1309        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1310        MOVE DD-CARR2-SECPAY-SW
  1311                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1312     END-IF
  1313                                                                  ELCDTERX
  1314                                                                  ELCDTERX
  1315     GO TO 0005-READ--CARD.                                       ELCDTERX
  1316                                                                  ELCDTERX
  1317 0020-READ--STAT.                                                 ELCDTERX
  1318     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1319     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1320        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1321         GO TO 0005-READ--CARD.                                   ELCDTERX
  1322                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1323     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1324     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1325     GO TO 0020-READ--STAT.                                       ELCDTERX
  1326                                                                  ELCDTERX
  1327 0025-READ--BUSC.                                                 ELCDTERX
  1328     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1329     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1330        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1331         GO TO 0005-READ--CARD.                                   ELCDTERX
  1332                                                                  ELCDTERX
  1333     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1334     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1335     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1336                                                                  ELCDTERX
  1337 0030-READ--MORT.                                                 ELCDTERX
  1338     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1339     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1340        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1341         GO TO 0005-READ--CARD.                                   ELCDTERX
  1342                                                                  ELCDTERX
  1343     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1344     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1345     GO TO 0030-READ--MORT.                                       ELCDTERX
  1346                                                                  ELCDTERX
  1347 0035-READ--CLXX.                                                 ELCDTERX
  1348     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1349          GO TO 0005-READ--CARD.                                  ELCDTERX
  1350                                                                  ELCDTERX
  1351     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1352         DISPLAY '***********************************************'ELCDTERX
  1353         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1354         DISPLAY '***********************************************'ELCDTERX
  1355         GO TO 0055-READ--STOP.                                   ELCDTERX
  1356                                                                  ELCDTERX
  1357     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1358        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1359         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1360                                                                  ELCDTERX
  1361     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1362        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1363         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1364                                                                  ELCDTERX
  1365*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1366     GO TO 0005-READ--CARD.                                       ELCDTERX
  1367                                                                  ELCDTERX
  1368 0040-READ--CLAI.                                                 ELCDTERX
  1369     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1370     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1371        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1372         GO TO 0005-READ--CARD.                                   ELCDTERX
  1373                                                                  ELCDTERX
  1374     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1375     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1376     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1377                                                                  ELCDTERX
  1378 0045-READ--DUMP.                                                 ELCDTERX
  1379     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1380     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1381                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1382     PERFORM ABEND-PGM.                                           ELCDTERX
  1383                                                                  ELCDTERX
  1384 0050-READ--POXX.                                                 ELCDTERX
  1385     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1386         GO TO 0005-READ--CARD.                                   ELCDTERX
  1387                                                                  ELCDTERX
  1388     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1389         DISPLAY '***********************************************'ELCDTERX
  1390         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1391         DISPLAY '***********************************************'ELCDTERX
  1392         GO TO 0055-READ--STOP.                                   ELCDTERX
  1393                                                                  ELCDTERX
  1394     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1395     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1396     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1397     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1398                                                                  ELCDTERX
  1399     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1400         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1401     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1402         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1403                                                                  ELCDTERX
  1404     GO TO 0005-READ--CARD.                                       ELCDTERX
  1405                                                                  ELCDTERX
  1406 0055-READ--STOP.                                                 ELCDTERX
  1407     GOBACK.                                                      ELCDTERX
  1408                                                                  ELCDTERX
  1409 0060-READ--TEST.                                                 ELCDTERX
  1410     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1411        CLAX-ID         = SPACE  OR                               ELCDTERX
  1412        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1413         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1414                                                                  ELCDTERX
  1415     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1416     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1417                                                                  ELCDTERX
  1418 0065-READ--COLC.                                                 ELCDTERX
  1419     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1420     GO TO 0005-READ--CARD.                                       ELCDTERX
  1421                                                                  ELCDTERX
  1422 0070-READ--OPCA.                                                 ELCDTERX
  1423                                                                  ELCDTERX
  1424     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1425                                                                  ELCDTERX
  1426     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1427             OR                                                   ELCDTERX
  1428         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1429         GO TO 0005-READ--CARD.                                   ELCDTERX
  1430                                                                  ELCDTERX
  1431     ADD 1                       TO INDEXCA.                      ELCDTERX
  1432     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1433                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1434     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1435                                                                  ELCDTERX
  1436 0072-READ--OPST.                                                 ELCDTERX
  1437                                                                  ELCDTERX
  1438     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS091.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1439                                                                  ELCDTERX
  1440     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1441             OR                                                   ELCDTERX
  1442         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1443         GO TO 0005-READ--CARD.                                   ELCDTERX
  1444                                                                  ELCDTERX
  1445     ADD 1                       TO INDEXST.                      ELCDTERX
  1446     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1447                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1448     GO TO 0072-READ--OPST.                                       ELCDTERX
  1449                                                                  ELCDTERX
  1450 0074-READ--OPBS.                                                 ELCDTERX
  1451                                                                  ELCDTERX
  1452     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1453                                                                  ELCDTERX
  1454     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1455             OR                                                   ELCDTERX
  1456         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1457         GO TO 0005-READ--CARD.                                   ELCDTERX
  1458                                                                  ELCDTERX
  1459     ADD 1                       TO INDEXBS.                      ELCDTERX
  1460     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1461     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1462                                                                  ELCDTERX
  1463 0079-READ--EXIT.                                                 ELCDTERX
  1464*    EXIT.                                                        ELCDTERX
  1465******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS091.cbl
  1467     MOVE COMPANY-NAME          TO HD-CLIENT.                     ECS091
  1468     MOVE WS-CURRENT-DATE       TO HD-IPL.                        ECS091
  1469     MOVE ALPH-DATE             TO HD-DATE.                       ECS091
  1470                                                                  ECS091
  1471     PERFORM 0400-HEAD-RTN THRU 0499-EXIT.                        ECS091
  1472                                                                  ECS091
  1473     MOVE +0                    TO SAV-NDX.                       ECS091
  1474                                                                  ECS091
  1475 0510-LOOP-PRT.                                                   ECS091
  1476     ADD +1                     TO SAV-NDX.                       ECS091
  1477                                                                  ECS091
  1478     IF SAV-CCSW (SAV-NDX) = HIGH-VALUES                          ECS091
  1479         GO TO 0599-EXIT.                                         ECS091
  1480                                                                  ECS091
  1481     MOVE SAV-PRT-LINE (SAV-NDX) TO P-REC.                        ECS091
  1482                                                                  ECS091
  1483     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1484                                                                  ECS091
  1485     GO TO 0510-LOOP-PRT.                                         ECS091
  1486                                                                  ECS091
  1487 0599-EXIT.                                                       ECS091
  1488     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS091.cbl
  1490 0600-RESTORE-DATE.                                               ECS091
  1491     OPEN INPUT BKUP-DATE.                                        ECS091
  1492*  FIRST RESTORE - COMPLETE REWIND OF INPUT TAPE.                 ECS091
  1493                                                                  ECS091
  1494     IF DATE-SW = 'X'                                             ECS091
  1495         OPEN OUTPUT DISK-DATE.                                   ECS091
  1496                                                                  ECS091
  1497 0610-READ-DATE.                                                  ECS091
  1498     READ BKUP-DATE AT END                                        ECS091
  1499         GO TO 0620-END-DATE.                                     ECS091
  1500                                                                  ECS091
  1501     ADD +1 TO DATE-CTR.                                          ECS091
  1502                                                                  ECS091
  1503     IF DATE-SW NOT = 'X'                                         ECS091
  1504         GO TO 0610-READ-DATE.                                    ECS091
  1505                                                                  ECS091
  1506     MOVE BK-DATE                TO DATE-REC.                     ECS091
  1507                                                                  ECS091
  1508     WRITE DATE-REC.                                              ECS091
  1509                                                                  ECS091
  1510     GO TO 0610-READ-DATE.                                        ECS091
  1511                                                                  ECS091
  1512 0620-END-DATE.                                                   ECS091
  1513     IF DATE-SW = 'X'                                             ECS091
  1514         CLOSE DISK-DATE.                                         ECS091
  1515                                                                  ECS091
  1516     CLOSE BKUP-DATE WITH NO REWIND.                              ECS091
  1517                                                                  ECS091
  1518     MOVE 'DATE CARD'            TO P-DESC.                       ECS091
  1519     MOVE DATE-CTR               TO P-CTR.                        ECS091
  1520                                                                  ECS091
  1521     IF DATE-SW = 'X'                                             ECS091
  1522         MOVE 'FILE RESTORED'       TO P-MSG                      ECS091
  1523     ELSE                                                         ECS091
  1524         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1525                                                                  ECS091
  1526     PERFORM 0200-SAV-RTN THRU 0299-EXIT.                         ECS091
  1527                                                                  ECS091
  1528 0699-EXIT.                                                       ECS091
  1529     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS091.cbl
  1531 0700-RESTORE-ACCT.                                               ECS091
  1532     OPEN INPUT BKUP-ACCT WITH NO REWIND.                         ECS091
  1533                                                                  ECS091
  1534     IF ACCT-SW = 'X'                                             ECS091
  1535         OPEN OUTPUT ACCT-FILE.                                   ECS091
  1536                                                                  ECS091
  1537     IF ERACCTT-FILE-STATUS  = '00' OR '97'                       ECS091
  1538         NEXT SENTENCE                                            ECS091
  1539       ELSE                                                       ECS091
  1540         MOVE 'ERACCTT OPEN ERROR- ' TO WS-ABEND-MESSAGE          ECS091
  1541         MOVE ERACCTT-FILE-STATUS    TO WS-ABEND-FILE-STATUS      ECS091
  1542         PERFORM ABEND-PGM.                                       ECS091
  1543                                                                  ECS091
  1544 0710-READ-ACCT.                                                  ECS091
  1545     READ BKUP-ACCT AT END                                        ECS091
  1546         GO TO 0720-END-ACCT.                                     ECS091
  1547                                                                  ECS091
  1548     ADD +1 TO ACCT-CTR.                                          ECS091
  1549                                                                  ECS091
  1550     IF ACCT-SW NOT = 'X'                                         ECS091
  1551         GO TO 0710-READ-ACCT.                                    ECS091
  1552                                                                  ECS091
  1553     MOVE BK-ACCT                TO ACCT-REC.                     ECS091
  1554                                                                  ECS091
  1555     WRITE ACCT-REC.                                              ECS091
  1556                                                                  ECS091
  1557     IF ERACCTT-FILE-STATUS NOT = ZERO                               CL**3
  1558         MOVE 'ERACCTT WRITE ERROR-'   TO WS-ABEND-MESSAGE        ECS091
  1559         MOVE ERACCTT-FILE-STATUS      TO WS-ABEND-FILE-STATUS    ECS091
  1560         GO TO ABEND-PGM.                                         ECS091
  1561                                                                  ECS091
  1562     GO TO 0710-READ-ACCT.                                        ECS091
  1563                                                                  ECS091
  1564 0720-END-ACCT.                                                   ECS091
  1565     MOVE 'ACCOUNT MASTER'       TO P-DESC.                       ECS091
  1566     MOVE ACCT-CTR               TO P-CTR.                        ECS091
  1567                                                                  ECS091
  1568     IF ACCT-SW = 'X'                                             ECS091
  1569         MOVE 'FILE RESTORED'       TO P-MSG                      ECS091
  1570     ELSE                                                         ECS091
  1571         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1572                                                                  ECS091
  1573     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1574                                                                  ECS091
  1575     IF ACCT-SW = 'X'                                             ECS091
  1576         CLOSE ACCT-FILE.                                         ECS091
  1577                                                                  ECS091
  1578     CLOSE BKUP-ACCT WITH NO REWIND.                              ECS091
  1579                                                                  ECS091
  1580 0799-EXIT.                                                       ECS091
  1581     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS091.cbl
  1583 0800-RESTORE-EPEC.                                               ECS091
  1584     OPEN INPUT BKUP-EPEC WITH NO REWIND.                         ECS091
  1585                                                                  ECS091
  1586     IF EPEC-SW = 'X'                                             ECS091
  1587         OPEN OUTPUT EPEC-FILE.                                   ECS091
  1588                                                                  ECS091
  1589 0810-READ-EPEC.                                                  ECS091
  1590     READ BKUP-EPEC AT END                                        ECS091
  1591         GO TO 0820-END-EPEC.                                     ECS091
  1592                                                                  ECS091
  1593     ADD +1 TO EPEC-CTR.                                          ECS091
  1594                                                                  ECS091
  1595     IF EPEC-SW NOT = 'X'                                         ECS091
  1596         GO TO 0810-READ-EPEC.                                    ECS091
  1597                                                                  ECS091
  1598     MOVE BK-EPEC                TO EPEC-REC.                     ECS091
  1599                                                                  ECS091
  1600     WRITE EPEC-REC.                                              ECS091
  1601                                                                  ECS091
  1602     GO TO 0810-READ-EPEC.                                        ECS091
  1603                                                                  ECS091
  1604 0820-END-EPEC.                                                   ECS091
  1605     MOVE 'EPEC EXT FILE'        TO P-DESC.                       ECS091
  1606     MOVE EPEC-CTR               TO P-CTR.                        ECS091
  1607                                                                  ECS091
  1608     IF EPEC-SW = 'X'                                             ECS091
  1609         MOVE 'FILE RESTORED'    TO P-MSG                         ECS091
  1610     ELSE                                                         ECS091
  1611         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1612                                                                  ECS091
  1613     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1614                                                                  ECS091
  1615     IF EPEC-SW = 'X'                                             ECS091
  1616         CLOSE EPEC-FILE.                                         ECS091
  1617                                                                  ECS091
  1618     CLOSE BKUP-EPEC WITH NO REWIND.                              ECS091
  1619                                                                  ECS091
  1620 0899-EXIT.                                                       ECS091
  1621     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS091.cbl
  1623                                                                  ECS091
  1624 0900-RESTORE-EXTR.                                               ECS091
  1625     OPEN INPUT BKUP-EXTR WITH NO REWIND.                         ECS091
  1626                                                                  ECS091
  1627     IF EXTR-SW = 'X'                                             ECS091
  1628         OPEN OUTPUT EXTR-FILE.                                   ECS091
  1629                                                                  ECS091
  1630 0810-READ-EXTR.                                                  ECS091
  1631     READ BKUP-EXTR AT END                                        ECS091
  1632         GO TO 0820-END-EXTR.                                     ECS091
  1633                                                                  ECS091
  1634     ADD +1 TO EXTR-CTR.                                          ECS091
  1635                                                                  ECS091
  1636     IF EXTR-SW NOT = 'X'                                         ECS091
  1637         GO TO 0810-READ-EXTR.                                    ECS091
  1638                                                                  ECS091
  1639     MOVE BK-EXTR                TO EXTR-REC.                     ECS091
  1640                                                                  ECS091
  1641     WRITE EXTR-REC.                                              ECS091
  1642                                                                  ECS091
  1643     GO TO 0810-READ-EXTR.                                        ECS091
  1644                                                                  ECS091
  1645 0820-END-EXTR.                                                   ECS091
  1646     MOVE 'EXTRACT FILE'         TO P-DESC.                       ECS091
  1647     MOVE EXTR-CTR               TO P-CTR.                        ECS091
  1648                                                                  ECS091
  1649     IF EXTR-SW = 'X'                                             ECS091
  1650         MOVE 'FILE RESTORED'    TO P-MSG                         ECS091
  1651     ELSE                                                         ECS091
  1652         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1653                                                                  ECS091
  1654     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1655                                                                  ECS091
  1656     IF EXTR-SW = 'X'                                             ECS091
  1657         CLOSE EXTR-FILE.                                         ECS091
  1658                                                                  ECS091
  1659     CLOSE BKUP-EXTR WITH NO REWIND.                              ECS091
  1660                                                                  ECS091
  1661 0999-EXIT.                                                       ECS091
  1662     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS091.cbl
  1664 1000-RESTORE-REIN.                                               ECS091
  1665     OPEN INPUT BKUP-REIN WITH NO REWIND.                         ECS091
  1666                                                                  ECS091
  1667     IF REIN-SW = 'X'                                             ECS091
  1668         OPEN OUTPUT REIN-FILE                                    ECS091
  1669         IF REIN-FILE-STATUS  = '00' OR '97'                      ECS091
  1670            NEXT SENTENCE                                         ECS091
  1671         ELSE                                                     ECS091
  1672             MOVE 'REIN OPEN ERROR-' TO WS-ABEND-MESSAGE          ECS091
  1673             MOVE REIN-FILE-STATUS   TO WS-ABEND-FILE-STATUS      ECS091
  1674             GO TO ABEND-PGM.                                     ECS091
  1675                                                                  ECS091
  1676 1010-READ-REIN.                                                  ECS091
  1677     READ BKUP-REIN AT END                                        ECS091
  1678         GO TO 1020-END-REIN.                                     ECS091
  1679                                                                  ECS091
  1680     ADD +1 TO REIN-CTR.                                          ECS091
  1681                                                                  ECS091
  1682     IF REIN-SW NOT = 'X'                                         ECS091
  1683         GO TO 1010-READ-REIN.                                    ECS091
  1684                                                                  ECS091
  1685     MOVE BK-REIN                TO REIN-REC.                     ECS091
  1686                                                                  ECS091
  1687     WRITE REIN-REC.                                              ECS091
  1688                                                                  ECS091
  1689     IF REIN-FILE-STATUS NOT = '00'                               ECS091
  1690         MOVE 'REIN WRITE ERROR- '      TO WS-ABEND-MESSAGE       ECS091
  1691         MOVE REIN-FILE-STATUS          TO WS-ABEND-FILE-STATUS   ECS091
  1692         GO TO ABEND-PGM.                                         ECS091
  1693                                                                  ECS091
  1694     GO TO 1010-READ-REIN.                                        ECS091
  1695                                                                  ECS091
  1696 1020-END-REIN.                                                   ECS091
  1697     MOVE 'REINSURANCE TABLES'   TO P-DESC.                       ECS091
  1698     MOVE REIN-CTR               TO P-CTR.                        ECS091
  1699                                                                  ECS091
  1700     IF REIN-SW = 'X'                                             ECS091
  1701         MOVE 'FILE RESTORED'    TO P-MSG                         ECS091
  1702     ELSE                                                         ECS091
  1703         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1704                                                                  ECS091
  1705     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1706                                                                  ECS091
  1707     IF REIN-SW = 'X'                                             ECS091
  1708         CLOSE REIN-FILE.                                         ECS091
  1709                                                                  ECS091
  1710     CLOSE BKUP-REIN WITH NO REWIND.                              ECS091
  1711                                                                  ECS091
  1712 1099-EXIT.                                                       ECS091
  1713     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS091.cbl
  1715 1100-RESTORE-CTBL.                                               ECS091
  1716     OPEN INPUT BKUP-CTBL WITH NO REWIND.                         ECS091
  1717                                                                  ECS091
  1718     IF CTBL-SW = 'X'                                             ECS091
  1719         OPEN OUTPUT CTBL-FILE                                    ECS091
  1720         IF COMM-FILE-STATUS = '00' OR '97'                       ECS091
  1721            NEXT SENTENCE                                         ECS091
  1722         ELSE                                                     ECS091
  1723             MOVE 'CTBL OPEN ERROE- ' TO WS-ABEND-MESSAGE         ECS091
  1724             MOVE COMM-FILE-STATUS    TO WS-ABEND-FILE-STATUS     ECS091
  1725             GO TO ABEND-PGM.                                     ECS091
  1726                                                                  ECS091
  1727 1110-READ-CTBL.                                                  ECS091
  1728     READ BKUP-CTBL AT END                                        ECS091
  1729         GO TO 1120-END-CTBL.                                     ECS091
  1730                                                                  ECS091
  1731     ADD +1 TO CTBL-CTR.                                          ECS091
  1732                                                                  ECS091
  1733     IF CTBL-SW NOT = 'X'                                         ECS091
  1734         GO TO 1110-READ-CTBL.                                    ECS091
  1735                                                                  ECS091
  1736     MOVE BK-CTBL                TO CTBL-REC.                     ECS091
  1737                                                                  ECS091
  1738     WRITE CTBL-REC.                                              ECS091
  1739                                                                  ECS091
  1740     IF COMM-FILE-STATUS NOT = '00'                               ECS091
  1741         MOVE 'CTBL WRITE ERROR- '     TO WS-ABEND-MESSAGE        ECS091
  1742         MOVE COMM-FILE-STATUS         TO WS-ABEND-FILE-STATUS    ECS091
  1743         GO TO ABEND-PGM.                                         ECS091
  1744                                                                  ECS091
  1745     GO TO 1110-READ-CTBL.                                        ECS091
  1746                                                                  ECS091
  1747 1120-END-CTBL.                                                   ECS091
  1748     MOVE 'COMMISSION TABLES'    TO P-DESC.                       ECS091
  1749     MOVE CTBL-CTR               TO P-CTR.                        ECS091
  1750                                                                  ECS091
  1751     IF CTBL-SW = 'X'                                             ECS091
  1752         MOVE 'FILE RESTORED'    TO P-MSG                         ECS091
  1753     ELSE                                                         ECS091
  1754         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1755                                                                  ECS091
  1756     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1757                                                                  ECS091
  1758     IF CTBL-SW = 'X'                                             ECS091
  1759         CLOSE CTBL-FILE.                                         ECS091
  1760                                                                  ECS091
  1761     CLOSE BKUP-CTBL WITH NO REWIND.                              ECS091
  1762                                                                  ECS091
  1763 1199-EXIT.                                                       ECS091
  1764     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS091.cbl
  1766 1200-RESTORE-CRED.                                               ECS091
  1767     OPEN INPUT BKUP-CRED WITH NO REWIND.                         ECS091
  1768                                                                  ECS091
  1769     IF CRED-SW = 'X'                                             ECS091
  1770         OPEN OUTPUT CRED-FILE.                                   ECS091
  1771                                                                  ECS091
  1772 1210-READ-CRED.                                                  ECS091
  1773     READ BKUP-CRED AT END                                        ECS091
  1774         GO TO 1220-END-CRED.                                     ECS091
  1775                                                                  ECS091
  1776     ADD +1 TO CRED-CTR.                                          ECS091
  1777                                                                  ECS091
  1778     IF CRED-SW NOT = 'X'                                         ECS091
  1779         GO TO 1210-READ-CRED.                                    ECS091
  1780                                                                  ECS091
  1781     MOVE BK-CRED                TO CRED-REC.                     ECS091
  1782                                                                  ECS091
  1783     WRITE CRED-REC.                                              ECS091
  1784                                                                  ECS091
  1785     GO TO 1210-READ-CRED.                                        ECS091
  1786                                                                  ECS091
  1787 1220-END-CRED.                                                   ECS091
  1788     MOVE 'CREDING FILE'         TO P-DESC.                       ECS091
  1789     MOVE CRED-CTR               TO P-CTR.                        ECS091
  1790                                                                  ECS091
  1791     IF CRED-SW = 'X'                                             ECS091
  1792         MOVE 'FILE RESTORED'       TO P-MSG                      ECS091
  1793     ELSE                                                         ECS091
  1794         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1795                                                                  ECS091
  1796     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1797                                                                  ECS091
  1798     IF CRED-SW = 'X'                                             ECS091
  1799         CLOSE CRED-FILE.                                         ECS091
  1800                                                                  ECS091
  1801     CLOSE BKUP-CRED WITH LOCK.                                   ECS091
  1802                                                                  ECS091
  1803 1299-EXIT.                                                       ECS091
  1804     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS091.cbl
  1806                                                                  ECS091
  1807 1300-RESTORE-COMP.                                               ECS091
  1808     OPEN INPUT BKUP-COMP WITH NO REWIND.                         ECS091
  1809                                                                  ECS091
  1810     IF COMP-SW = 'X'                                             ECS091
  1811         OPEN OUTPUT COMP-FILE.                                   ECS091
  1812                                                                  ECS091
  1813 1210-READ-COMP.                                                  ECS091
  1814     READ BKUP-COMP AT END                                        ECS091
  1815         GO TO 1220-END-COMP.                                     ECS091
  1816                                                                  ECS091
  1817     ADD +1 TO COMP-CTR.                                          ECS091
  1818                                                                  ECS091
  1819     IF COMP-SW NOT = 'X'                                         ECS091
  1820         GO TO 1210-READ-COMP.                                    ECS091
  1821                                                                  ECS091
  1822     MOVE BK-COMP                TO COMP-MSTR-REC.                ECS091
  1823                                                                  ECS091
  1824     WRITE COMP-MSTR-REC.                                         ECS091
  1825                                                                  ECS091
  1826     GO TO 1210-READ-COMP.                                        ECS091
  1827                                                                  ECS091
  1828 1220-END-COMP.                                                   ECS091
  1829     MOVE 'COMPENSATION FILE'    TO P-DESC.                       ECS091
  1830     MOVE COMP-CTR               TO P-CTR.                        ECS091
  1831                                                                  ECS091
  1832     IF COMP-SW = 'X'                                             ECS091
  1833         MOVE 'FILE RESTORED'    TO P-MSG                         ECS091
  1834     ELSE                                                         ECS091
  1835         MOVE '* FILE NOT RESTORED' TO P-MSG.                     ECS091
  1836                                                                  ECS091
  1837     PERFORM 0300-PRT-RTN THRU 0399-EXIT.                         ECS091
  1838                                                                  ECS091
  1839     IF COMP-SW = 'X'                                             ECS091
  1840         CLOSE COMP-FILE.                                         ECS091
  1841                                                                  ECS091
  1842     CLOSE BKUP-COMP WITH LOCK.                                   ECS091
  1843                                                                  ECS091
  1844 1399-EXIT.                                                       ECS091
  1845     EXIT.                                                        ECS091
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS091.cbl
  1847 9000-ABEND.                                                      ECS091
  1848     DISPLAY P-MSG.                                               ECS091
  1849     DISPLAY ' JOB STEP ECS091 - ABORTED'.                        ECS091
  1850                                                                  ECS091
  1851     IF ABEND-CODE = ZEROS                                        ECS091
  1852         MOVE '0301'             TO ABEND-CODE.                   ECS091
  1853                                                                  ECS091
  1854     GO TO ABEND-PGM.                                             ECS091
  1855                                                                  ECS091
  1856                                                                  ECS091
  1857 1600-CLS-FILES.                                                  ECS091
  1858     CLOSE PRNT-FILE.                                             ECS091
  1859     GOBACK.                                                      ECS091
  1860                                                                  ECS091
  1861 ABEND-PGM SECTION.                                               ECS091
* 1862                               COPY ELCABEND.                     ECS091
  1863***************************************************************** 04/14/98
  1864*                                                               * ELCABEND
  1865*                            ELCABEND.                          *    LV003
  1866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1867*                            VMOD 2.002                              CL**2
  1868*                                                               * ELCABEND
  1869*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1870*            AND THEN ABENDS.                                   * ELCABEND
  1871*                                                               * ELCABEND
  1872*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1873*                                                               * ELCABEND
  1874***************************************************************** ELCABEND
  1875*APS-010.                                                         ELCABEND
  1876     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1877     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1878                                                                  ELCABEND
  1879     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1880         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1881         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1882                                 UPON CONSOLE.                    ELCABEND
  1883                                                                  ELCABEND
  1884     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1885         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1886         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1887                                 UPON CONSOLE.                    ELCABEND
  1888                                                                  ELCABEND
  1889     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1890     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1891                                 UPON CONSOLE.                    ELCABEND
  1892                                                                  ELCABEND
  1893     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  1894     CALL 'ABORTME'.
  1895                                                                  ELCABEND
  1896 APS-EXIT.                                                        ELCABEND
  1897     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       72128     Code:        8897
