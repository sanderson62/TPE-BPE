* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS261.cbl
* Options: int("ECS261.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS261.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS261.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS261.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         10/08/97
     2                                                                  ECS261
     3 PROGRAM-ID.                 ECS261.                                 LV002
     4*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE             ECS261
     5*                            VMOD=2.003.                             CL**2
     6*                                                                 ECS261
     7*AUTHOR.        LOGIC, INC.                                       ECS261
     8*               DALLAS, TEXAS.                                    ECS261
     9                                                                  ECS261
    10*DATE-COMPILED.                                                   ECS261
    11*                                                                 ECS261
    12*SECURITY.   *****************************************************ECS261
    13*            *                                                   *ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS261.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS261
    15*            *                                                   *ECS261
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS261
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS261
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *ECS261
    19*            *                                                   *ECS261
    20*            *****************************************************ECS261
    21*                                                                 ECS261
    22*REMARKS.                                                         ECS261
    23*        THIS PROGRAM SPLITS THE ECS YEAR END BACK-UP FILE BACK   ECS261
    24*        INTO THE INDIVIDUAL FILES. COMBINED FILE IS CREATED BY   ECS261
    25*        PROGRAM ECS260.                                          ECS261
    26                                                                  ECS261
    27 ENVIRONMENT DIVISION.                                            ECS261
    28 INPUT-OUTPUT SECTION.                                            ECS261
    29 FILE-CONTROL.                                                    ECS261
    30                                                                  ECS261
    31     SELECT ECS-YE-BACKUP    ASSIGN TO SYS010-UT-2400-S.          ECS261
    32     SELECT ACCOUNT-MSTR-TP  ASSIGN TO SYS011-UT-2400-S.          ECS261
    33     SELECT CERT-FILE-TP     ASSIGN TO SYS012-UT-2400-S.          ECS261
    34     SELECT REINS-TABLE-TP   ASSIGN TO SYS013-UT-2400-S.          ECS261
    35     SELECT EPEC-TP          ASSIGN TO SYS014-UT-2400-S.          ECS261
    36     SELECT COMP-TP          ASSIGN TO SYS015-UT-2400-S.          ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS261.cbl
    38 DATA DIVISION.                                                   ECS261
    39 FILE SECTION.                                                    ECS261
    40                                                                  ECS261
    41 FD  ECS-YE-BACKUP                                                ECS261
    42     RECORDING MODE F                                             ECS261
    43     LABEL RECORDS STANDARD                                       ECS261
    44     BLOCK CONTAINS 0 RECORDS
    45     RECORD CONTAINS 8206 CHARACTERS.                             ECS261
    46 01  DUMMY-REC.                                                   ECS261
    47     12  REC-ID              PIC  X(4).                           ECS261
    48     12  REC-CNT             PIC S999       COMP-3.               ECS261
    49     12  FILLER              PIC  X(8200).                        ECS261
    50                                                                  ECS261
    51 01  B-ACCT-REC.                                                  ECS261
    52     12  FILLER              PIC  X(6).                           ECS261
    53     12  ACCOUNT-ENTRY       PIC  X(2000)    OCCURS  4  TIMES.    ECS261
    54     12  FILLER              PIC  X(200).                         ECS261
    55                                                                  ECS261
    56 01  B-CERT-REC.                                                  ECS261
    57     12  FILLER              PIC  X(6).                           ECS261
    58     12  CERT-ENTRY          PIC  X(700)     OCCURS  11  TIMES.   ECS261
    59     12  FILLER              PIC  X(500).                         ECS261
    60                                                                  ECS261
    61 01  B-COMP.                                                      ECS261
    62     12  FILLER              PIC  X(6).                           ECS261
    63     12  COMP-ENTRY          PIC  X(450)     OCCURS  18  TIMES.   ECS261
    64     12  FILLER              PIC  X(100).                         ECS261
    65                                                                  ECS261
    66 01  B-EPECS.                                                     ECS261
    67     12  FILLER              PIC  X(6).                           ECS261
    68     12  EPEC-ENTRY          PIC  X(325)     OCCURS  25  TIMES.   ECS261
    69     12  FILLER              PIC  X(75).                          ECS261
    70                                                                  ECS261
    71 01  B-REINS.                                                     ECS261
    72     12  FILLER              PIC  X(6).                           ECS261
    73     12  REINS-ENTRY         PIC  X(4000)    OCCURS  2  TIMES.    ECS261
    74     12  FILLER              PIC  X(200).                         ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS261.cbl
    76 FD  ACCOUNT-MSTR-TP                                              ECS261
*   77                             COPY ECSFDAMD.                       ECS261
    78******************************************************************07/10/97
    79*                                                                *ECSFDAMD
    80*                            ECSFDAMD                            *   LV001
    81*                            VMOD=2.002                         * ECSFDAMD
    82*                                                                *ECSFDAMD
    83*  NO  CSO  MODS  IN  COPYBOOK  ECSFDAMD                         *ECSFDAMD
    84*                                                                *ECSFDAMD
    85******************************************************************ECSFDAMD
    86     RECORDING MODE IS F                                          ECSFDAMD
    87     LABEL RECORDS ARE STANDARD                                   ECSFDAMD
    88     RECORD CONTAINS 2000 CHARACTERS                              ECSFDAMD
    89     BLOCK CONTAINS 0 RECORDS
    90     DATA RECORD IS CLS-AM-DK.                                    ECSFDAMD
    91                                                                  ECSFDAMD
    92 01  CLS-AM-DK               PIC  X(2000).                        ECSFDAMD
    93******************************************************************ECSFDAMD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS261.cbl
    95 FD  CERT-FILE-TP                                                 ECS261
*   96                             COPY ECSCRIFD.                       ECS261
    97******************************************************************07/10/97
    98*                                                                *ECSCRIFD
    99*                            ECSCRIFD                            *   LV001
   100*                            VMOD 2.005                          *ECSCRIFD
   101*                                                                *ECSCRIFD
   102*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   103*                                                                *ECSCRIFD
   104******************************************************************ECSCRIFD
   105     BLOCK CONTAINS 0 RECORDS
   106     RECORDING MODE F.                                            ECSCRIFD
   107                                                                  ECSCRIFD
   108 01  CERT-IN-RECORD.                                              ECSCRIFD
   109                                                                  ECSCRIFD
   110     12  FILLER                            PIC XXX.               ECSCRIFD
   111     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   112     12  FILLER                            PIC X(66).             ECSCRIFD
   113     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   114     12  FILLER                            PIC X(20).             ECSCRIFD
   115     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   116     12  FILLER                            PIC X(14).             ECSCRIFD
   117     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   118     12  FILLER                            PIC X(39).             ECSCRIFD
   119     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   120     12  FILLER                            PIC X(45).             ECSCRIFD
   121     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   122     12  FILLER                            PIC X(35).             ECSCRIFD
   123     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   124     12  FILLER                            PIC X(41).             ECSCRIFD
   125     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   126     12  FILLER                            PIC X(48).             ECSCRIFD
   127     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   128     12  FILLER                            PIC X(9).              ECSCRIFD
   129     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   130     12  FILLER                            PIC X(120).            ECSCRIFD
   131     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   132     12  FILLER                            PIC X(73).             ECSCRIFD
   133     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   134     12  FILLER                            PIC X(464).            ECSCRIFD
   135                                                                  ECSCRIFD
   136******************************************************************ECSCRIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS261.cbl
   138 FD  REINS-TABLE-TP                                               ECS261
*  139                             COPY ECSRTFDD.                       ECS261
   140******************************************************************07/10/97
   141*                                                                *ECSRTFDD
   142*                            ECSRTFDD                            *   LV001
   143*                            VMOD=2.001                          *ECSRTFDD
   144*                                                                *ECSRTFDD
   145*  NO  CID  MODS  IN  COPYBOOK  ECSRTFDD                         *ECSRTFDD
   146*                                                                *ECSRTFDD
   147******************************************************************ECSRTFDD
   148     LABEL RECORDS STANDARD                                       ECSRTFDD
   149     RECORD CONTAINS 4000 CHARACTERS.                             ECSRTFDD
   150                                                                  ECSRTFDD
   151 01  RT-REC                  PIC  X(4000).                        ECSRTFDD
   152******************************************************************ECSRTFDD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS261.cbl
   154 FD  EPEC-TP                                                      ECS261
*  155                             COPY ECSEPCFD.                       ECS261
   156******************************************************************07/10/97
   157*                                                                *ECSEPCFD
   158*                            ECSEPCFD                            *   LV001
   159*                            VMOD=2.002                          *ECSEPCFD
   160*                                                                *ECSEPCFD
   161*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   162*                                                                *ECSEPCFD
   163******************************************************************ECSEPCFD
   164     RECORDING MODE F                                             ECSEPCFD
   165     LABEL RECORDS STANDARD                                       ECSEPCFD
   166     BLOCK CONTAINS 0 RECORDS
   167     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   168******************************************************************ECSEPCFD
   169                                                                  ECS261
   170 01  EP-RECORD               PIC  X(325).                         ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS261.cbl
   172 FD  COMP-TP                                                      ECS261
*  173                             COPY ECSCOIFD.                       ECS261
   174******************************************************************07/10/97
   175*                                                                *ECSCOIFD
   176*                            ECSCOIFD                            *   LV001
   177*                            VMOD=2.005                          *ECSCOIFD
   178*                                                                *ECSCOIFD
   179* NO CID  MODS IN  COPYBOOK  ECSCOIFD.                           *ECSCOIFD
   180*                                                                *ECSCOIFD
   181******************************************************************ECSCOIFD
   182     BLOCK CONTAINS 0 RECORDS
   183     RECORDING MODE F.                                            ECSCOIFD
   184                                                                  ECSCOIFD
   185 01  COMP-IN-RECORD.                                              ECSCOIFD
   186     12  COI-ID                            PIC XX.                ECSCOIFD
   187                                                                  ECSCOIFD
   188     12  COI-CONTROL.                                             ECSCOIFD
   189         16  COI-COMPANY-CD                PIC X.                 ECSCOIFD
   190         16  COI-CTL-1.                                           ECSCOIFD
   191             20  COI-CARR-GROUP.                                  ECSCOIFD
   192                 24  COI-CARRIER           PIC X.                 ECSCOIFD
   193                 24  COI-GROUPING.                                ECSCOIFD
   194                     28  COI-GRP-PREFIX    PIC XXX.               ECSCOIFD
   195                     28  COI-GRP-PRIME     PIC XXX.               ECSCOIFD
   196             20  COI-RESP-NO.                                     ECSCOIFD
   197                 24  COI-RESP-PREFIX       PIC X(4).              ECSCOIFD
   198                 24  COI-RESP-PRIME        PIC X(6).              ECSCOIFD
   199         16  COI-CTL-2.                                           ECSCOIFD
   200             20  COI-ACCOUNT.                                     ECSCOIFD
   201                 24  COI-ACCT-PREFIX       PIC X(4).              ECSCOIFD
   202                 24  COI-ACCT-PRIME        PIC X(6).              ECSCOIFD
   203         16  COI-TYPE                      PIC X.                 ECSCOIFD
   204             88  COI-COMPANY-RECORD           VALUE 'C'.          ECSCOIFD
   205             88  COI-GENERAL-AGENT-RECORD     VALUE 'G'.          ECSCOIFD
   206             88  COI-ACCOUNT-RECORD           VALUE 'A'.          ECSCOIFD
   207                                                                  ECSCOIFD
   208     12  FILLER                            PIC X(20).             ECSCOIFD
   209                                                                  ECSCOIFD
   210     12  COI-BALANCE-CONTROL               PIC X.                 ECSCOIFD
   211         88  COI-CARRY-BALANCE                VALUE 'Y'.          ECSCOIFD
   212         88  COI-NO-BALANCE                   VALUE 'N'.          ECSCOIFD
   213                                                                  ECSCOIFD
   214     12  COI-INTERNAL-CONTROL-1            PIC X.                 ECSCOIFD
   215         88  COI-AUTO-GENERATED-THIS-RUN      VALUE 'X'.          ECSCOIFD
   216         88  COI-AUTO-GENERATED               VALUE 'Y'.          ECSCOIFD
   217         88  COI-NOT-AUTO-GENERATED           VALUE 'N'.          ECSCOIFD
   218                                                                  ECSCOIFD
   219     12  COI-INTERNAL-CONTROL-2            PIC X.                 ECSCOIFD
   220         88  COI-STATEMENT-THIS-RUN           VALUE 'Y'.          ECSCOIFD
   221         88  COI-NO-STATEMENT-THIS-RUN        VALUE 'N'.          ECSCOIFD
   222                                                                  ECSCOIFD
   223     12  COI-FUTURE-SPACE                  PIC X(5).              ECSCOIFD
   224         88  COI-FUTURE-NOT-USED              VALUE '     '.      ECSCOIFD
   225                                                                  ECSCOIFD
   226     12  COI-DATA                          PIC X(641).            ECSCOIFD
   227                                                                  ECSCOIFD
   228******************************************************************ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS261.cbl
   230 WORKING-STORAGE SECTION.                                         ECS261
   231 77  FILLER  PIC X(32) VALUE '********************************'.  ECS261
   232 77  FILLER  PIC X(32) VALUE '     ECS261 WORKING-STORAGE     '.  ECS261
   233 77  FILLER  PIC X(32) VALUE '*********VMOD=2.003*************'.     CL**2
   234                                                                  ECS261
   235 77  SUB1                    PIC S9(4)   COMP    VALUE +0.        ECS261
   236 77  EOF-SW                  PIC  9              VALUE 0.         ECS261
   237     88  FILE-END                                VALUE 9.         ECS261
   238 77  C-ACCT                  PIC  9(7)           VALUE 0.         ECS261
   239 77  C-CERT                  PIC  9(7)           VALUE 0.         ECS261
   240 77  C-REIN                  PIC  9(7)           VALUE 0.         ECS261
   241 77  C-COMP                  PIC  9(7)           VALUE 0.         ECS261
   242 77  C-EPEC                  PIC  9(7)           VALUE 0.         ECS261
   243                                                                  ECS261
   244 01  WS.                                                          ECS261
   245    12  WS-RETURN-CODE       PIC S9(4)  COMP     VALUE +0.        ECS261
   246    12  WS-ABEND-MESSAGE     PIC X(80)           VALUE SPACES.    ECS261
   247    12  WS-ABEND-FILE-STATUS PIC XX              VALUE ZEROS.     ECS261
   248    12  WS-ZERO              PIC S9              VALUE +0.        ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS261.cbl
   250 PROCEDURE DIVISION.                                              ECS261
   251                                                                  ECS261
   252 0000-SELECT-LOAD-OPTIONS.                                        ECS261
   253     OPEN INPUT ECS-YE-BACKUP.                                    ECS261
   254                                                                  ECS261
   255     PERFORM 1000-ACCOUNT-RESTORE  THRU  1999-EXIT.               ECS261
   256                                                                  ECS261
   257     PERFORM 2000-CERT-RESTORE  THRU  2999-EXIT.                  ECS261
   258                                                                  ECS261
   259     PERFORM 3000-COMP-RESTORE  THRU  3999-EXIT.                  ECS261
   260                                                                  ECS261
   261     PERFORM 4000-EPEC-RESTORE  THRU  4999-EXIT.                  ECS261
   262                                                                  ECS261
   263     PERFORM 5000-REIN-RESTORE  THRU  5999-EXIT.                  ECS261
   264                                                                  ECS261
   265     DISPLAY 'FILE RESTORE COMPLETE'.                             ECS261
   266                                                                  ECS261
   267     CLOSE ECS-YE-BACKUP.                                         ECS261
   268                                                                  ECS261
   269 0999-JOB-END  SECTION.                                           ECS261
   270     GOBACK.                                                      ECS261
   271                                                                  ECS261
   272 1000-ACCOUNT-RESTORE  SECTION.                                   ECS261
   273     OPEN OUTPUT ACCOUNT-MSTR-TP.                                 ECS261
   274                                                                  ECS261
   275     READ ECS-YE-BACKUP                                           ECS261
   276         AT END                                                   ECS261
   277             MOVE +701                TO WS-RETURN-CODE           ECS261
   278             MOVE 'EOF ECS-YE-BACKUP' TO WS-ABEND-MESSAGE         ECS261
   279             GO TO ABEND-PGM.                                     ECS261
   280                                                                  ECS261
   281 1100-READ-ACCT-LOOP.                                             ECS261
   282     PERFORM 1500-WRITE-ACCT  THRU  1599-EXIT                     ECS261
   283         VARYING  SUB1  FROM  1  BY  1                            ECS261
   284             UNTIL  SUB1  IS GREATER THAN  REC-CNT.               ECS261
   285                                                                  ECS261
   286     READ ECS-YE-BACKUP                                           ECS261
   287         AT END                                                   ECS261
   288             MOVE +701                TO WS-RETURN-CODE           ECS261
   289             MOVE 'EOF ECS-YE-BACKUP' TO WS-ABEND-MESSAGE         ECS261
   290             GO TO ABEND-PGM.                                     ECS261
   291                                                                  ECS261
   292     IF REC-ID NOT = 'ACCT'                                       ECS261
   293         SUBTRACT 1               FROM  C-ACCT                    ECS261
   294         DISPLAY C-ACCT  ' ACCOUNT RECORDS PROCESSED'             ECS261
   295         CLOSE ACCOUNT-MSTR-TP                                    ECS261
   296         MOVE 0                   TO  EOF-SW                      ECS261
   297         GO TO 1999-EXIT                                          ECS261
   298     ELSE                                                         ECS261
   299         GO TO 1100-READ-ACCT-LOOP.                               ECS261
   300                                                                  ECS261
   301 1500-WRITE-ACCT.                                                 ECS261
   302     MOVE ACCOUNT-ENTRY (SUB1)    TO  CLS-AM-DK.                  ECS261
   303                                                                  ECS261
   304     IF CLS-AM-DK = SPACE                                         ECS261
   305         GO TO 1599-EXIT.                                         ECS261
   306                                                                  ECS261
   307     WRITE CLS-AM-DK.                                             ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS261.cbl
   308                                                                  ECS261
   309     ADD 1                       TO  C-ACCT.                      ECS261
   310                                                                  ECS261
   311 1599-EXIT.                                                       ECS261
   312     EXIT.                                                        ECS261
   313                                                                  ECS261
   314 1999-EXIT.                                                       ECS261
   315     EXIT.                                                        ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS261.cbl
   317 2000-CERT-RESTORE  SECTION.                                      ECS261
   318     OPEN OUTPUT CERT-FILE-TP.                                    ECS261
   319                                                                  ECS261
   320 2100-READ-CERT-LOOP.                                             ECS261
   321     PERFORM 2500-WRITE-CERT  THRU  2599-EXIT                     ECS261
   322         VARYING  SUB1  FROM  1  BY  1                            ECS261
   323             UNTIL  SUB1  IS GREATER THAN  REC-CNT.               ECS261
   324                                                                  ECS261
   325     READ ECS-YE-BACKUP                                           ECS261
   326         AT END                                                   ECS261
   327             MOVE +701                TO WS-RETURN-CODE           ECS261
   328             MOVE 'EOF ECS-YE-BACKUP' TO WS-ABEND-MESSAGE         ECS261
   329             GO TO ABEND-PGM.                                     ECS261
   330                                                                  ECS261
   331     IF REC-ID NOT = 'CERT'                                       ECS261
   332         SUBTRACT 1              FROM  C-CERT                     ECS261
   333         DISPLAY C-CERT  ' CERT RECORDS PROCESSED'                ECS261
   334         CLOSE CERT-FILE-TP                                       ECS261
   335         MOVE 0                  TO  EOF-SW                       ECS261
   336         GO TO 2999-EXIT                                          ECS261
   337     ELSE                                                         ECS261
   338         GO TO 2100-READ-CERT-LOOP.                               ECS261
   339                                                                  ECS261
   340 2500-WRITE-CERT.                                                 ECS261
   341     MOVE CERT-ENTRY (SUB1)      TO  CERT-IN-RECORD.              ECS261
   342                                                                  ECS261
   343     IF CERT-IN-RECORD = SPACE                                    ECS261
   344         GO TO 2599-EXIT.                                         ECS261
   345                                                                  ECS261
   346     WRITE CERT-IN-RECORD.                                        ECS261
   347                                                                  ECS261
   348     ADD 1                       TO  C-CERT.                      ECS261
   349                                                                  ECS261
   350 2599-EXIT.                                                       ECS261
   351     EXIT.                                                        ECS261
   352                                                                  ECS261
   353 2999-EXIT.                                                       ECS261
   354     EXIT.                                                        ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS261.cbl
   356 3000-COMP-RESTORE  SECTION.                                      ECS261
   357     OPEN OUTPUT COMP-TP.                                         ECS261
   358                                                                  ECS261
   359 3100-READ-COMP-LOOP.                                             ECS261
   360     PERFORM 3500-WRITE-COMP  THRU  3599-EXIT                     ECS261
   361         VARYING  SUB1  FROM  1  BY  1                            ECS261
   362             UNTIL  SUB1  IS GREATER THAN  REC-CNT.               ECS261
   363                                                                  ECS261
   364     READ ECS-YE-BACKUP                                           ECS261
   365         AT END                                                   ECS261
   366             MOVE +701                TO WS-RETURN-CODE           ECS261
   367             MOVE 'EOF ECS-YE-BACKUP' TO WS-ABEND-MESSAGE         ECS261
   368             GO TO ABEND-PGM.                                     ECS261
   369                                                                  ECS261
   370     IF REC-ID NOT = 'COMP'                                       ECS261
   371         SUBTRACT 1              FROM  C-COMP                     ECS261
   372         DISPLAY C-COMP  ' COMP RECORDS PROCESSED'                ECS261
   373         CLOSE COMP-TP                                            ECS261
   374         MOVE 0                  TO  EOF-SW                       ECS261
   375         GO TO 3999-EXIT                                          ECS261
   376     ELSE                                                         ECS261
   377         GO TO 3100-READ-COMP-LOOP.                               ECS261
   378                                                                  ECS261
   379 3500-WRITE-COMP.                                                 ECS261
   380     MOVE COMP-ENTRY (SUB1)      TO  COMP-IN-RECORD.              ECS261
   381                                                                  ECS261
   382     IF COMP-IN-RECORD = SPACE                                    ECS261
   383         GO TO 3599-EXIT.                                         ECS261
   384                                                                  ECS261
   385     WRITE COMP-IN-RECORD.                                        ECS261
   386                                                                  ECS261
   387     ADD 1                       TO  C-COMP.                      ECS261
   388                                                                  ECS261
   389 3599-EXIT.                                                       ECS261
   390     EXIT.                                                        ECS261
   391                                                                  ECS261
   392 3999-EXIT.                                                       ECS261
   393     EXIT.                                                        ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS261.cbl
   395 4000-EPEC-RESTORE  SECTION.                                      ECS261
   396     OPEN OUTPUT EPEC-TP.                                         ECS261
   397                                                                  ECS261
   398 4100-READ-EPEC-LOOP.                                             ECS261
   399     PERFORM 4500-WRITE-EPEC  THRU  4599-EXIT                     ECS261
   400         VARYING  SUB1  FROM  1  BY  1                            ECS261
   401             UNTIL  SUB1  IS GREATER THAN  REC-CNT.               ECS261
   402                                                                  ECS261
   403     READ ECS-YE-BACKUP                                           ECS261
   404         AT END                                                   ECS261
   405             MOVE +701                TO WS-RETURN-CODE           ECS261
   406             MOVE 'EOF ECS-YE-BACKUP' TO WS-ABEND-MESSAGE         ECS261
   407             GO TO ABEND-PGM.                                     ECS261
   408                                                                  ECS261
   409     IF REC-ID NOT = 'EPEC'                                       ECS261
   410         SUBTRACT 1              FROM  C-EPEC                     ECS261
   411         DISPLAY C-EPEC  ' EPEC RECORDS PROCESSED'                ECS261
   412         CLOSE EPEC-TP                                            ECS261
   413         MOVE 0                  TO  EOF-SW                       ECS261
   414         GO TO 4999-EXIT                                          ECS261
   415     ELSE                                                         ECS261
   416         GO TO 4100-READ-EPEC-LOOP.                               ECS261
   417                                                                  ECS261
   418 4500-WRITE-EPEC.                                                 ECS261
   419     MOVE EPEC-ENTRY (SUB1)      TO  EP-RECORD.                   ECS261
   420                                                                  ECS261
   421     IF EP-RECORD = SPACE                                         ECS261
   422         GO TO 4599-EXIT.                                         ECS261
   423                                                                  ECS261
   424     WRITE EP-RECORD.                                             ECS261
   425                                                                  ECS261
   426     ADD 1                       TO  C-EPEC.                      ECS261
   427                                                                  ECS261
   428 4599-EXIT.                                                       ECS261
   429     EXIT.                                                        ECS261
   430                                                                  ECS261
   431 4999-EXIT.                                                       ECS261
   432     EXIT.                                                        ECS261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS261.cbl
   434 5000-REIN-RESTORE  SECTION.                                      ECS261
   435     OPEN OUTPUT REINS-TABLE-TP.                                  ECS261
   436                                                                  ECS261
   437 5100-READ-REIN-LOOP.                                             ECS261
   438     PERFORM 5500-WRITE-REIN  THRU  5599-EXIT                     ECS261
   439         VARYING  SUB1  FROM  1  BY  1                            ECS261
   440             UNTIL  SUB1  IS GREATER THAN  REC-CNT.               ECS261
   441                                                                  ECS261
   442     READ ECS-YE-BACKUP                                           ECS261
   443         AT END                                                   ECS261
   444             SUBTRACT 1          FROM  C-REIN                     ECS261
   445             DISPLAY C-REIN  ' REINS RECORDS PROCESSED'           ECS261
   446             CLOSE REINS-TABLE-TP                                 ECS261
   447             MOVE 0              TO  EOF-SW                       ECS261
   448             GO TO 5999-EXIT.                                     ECS261
   449                                                                  ECS261
   450     GO TO 5100-READ-REIN-LOOP.                                   ECS261
   451                                                                  ECS261
   452 5500-WRITE-REIN.                                                 ECS261
   453     MOVE REINS-ENTRY (SUB1)     TO  RT-REC.                      ECS261
   454                                                                  ECS261
   455     IF RT-REC = SPACE                                            ECS261
   456         GO TO 5599-EXIT.                                         ECS261
   457                                                                  ECS261
   458     WRITE RT-REC.                                                ECS261
   459                                                                  ECS261
   460     ADD 1                       TO  C-REIN.                      ECS261
   461                                                                  ECS261
   462 5599-EXIT.                                                       ECS261
   463     EXIT.                                                        ECS261
   464                                                                  ECS261
   465 5999-EXIT.                                                       ECS261
   466     EXIT.                                                        ECS261
   467                                                                  ECS261
   468 ABEND-PGM   SECTION.                                             ECS261
*  469                          COPY ELCABEND.                          ECS261
   470***************************************************************** 04/14/98
   471*                                                               * ELCABEND
   472*                            ELCABEND.                          *    LV003
   473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   474*                            VMOD 2.002                              CL**2
   475*                                                               * ELCABEND
   476*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   477*            AND THEN ABENDS.                                   * ELCABEND
   478*                                                               * ELCABEND
   479*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   480*                                                               * ELCABEND
   481***************************************************************** ELCABEND
   482*APS-010.                                                         ELCABEND
   483     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   484     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   485                                                                  ELCABEND
   486     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   487         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   488         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   489                                 UPON CONSOLE.                    ELCABEND
   490                                                                  ELCABEND
   491     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS261.cbl (/apps/prod/cid1p/copy/ELCABEND)
   492         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   493         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   494                                 UPON CONSOLE.                    ELCABEND
   495                                                                  ELCABEND
   496     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   497     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   498                                 UPON CONSOLE.                    ELCABEND
   499                                                                  ELCABEND
   500     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   501     CALL 'ABORTME'.
   502                                                                  ELCABEND
   503 APS-EXIT.                                                        ELCABEND
   504     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19588     Code:        2736
