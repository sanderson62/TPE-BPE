* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   1
* ELRFNDX.cbl
* Options: int("ELRFNDX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK VERBOSE
*          directives(cobopt.bth) endp list("ELRFNDX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFNDX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELRFNDX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFNDX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:26:06.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   2
* ELRFNDX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  CAPPED TERM      - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  STATE CODE       - CP-STATE                                   *
    42*  STATE CODE       - CP-STATE-STD-ABBV                          *
    43*  CLASS CODE       - CP-CLASS-CODE                              *
    44*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    45*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    46*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    47*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    48*  A.P.R.           - CP-LOAN-APR                                *
    49*  METHOD           - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    52*  COMPANY I.D.     - CP-COMPANY-ID                              *
    53*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    54*  INSURED AGE      - CP-ISSUE-AGE                               *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   3
* ELRFNDX.cbl
    60 WORKING-STORAGE SECTION.
    61 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRFNDX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.011 *****************'.
    65 77  WS-UE-CLP                   PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-GFR3                     PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-MONTH                    PIC S999     COMP-3 VALUE +0.
    68
    69 01  WS-WORK-MISC.
    70     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    71     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    73     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    74     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    75     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    76     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    77     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    78     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    79     12  WS-SAVE-EARN-METHOD PIC X.
    80     12  ws-save-ext-days    pic s9(5)        comp-3.
    81     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    82     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    83     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    84     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    85     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    86     12  FACTOR-5            PIC S9(7)        COMP-3.
    87     12  FACTOR-6            PIC S9(7)        COMP-3.
    88     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    89     12  RATE-FACTOR-2       PIC S999         COMP-3.
    90     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    91     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    92     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    93     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    94
    95 01  TEXAS-REG-WORK-AREAS.
    96     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    97     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    99     12  TEX-FACT-4          PIC S9(7)       COMP-3.
   100     12  TEX-FACT-5          PIC S9(3)       COMP-3.
   101     12  TEX-FACT-6          PIC S9(3)       COMP-3.
   102     12  TEX-FACT-7          PIC S9(7)       COMP-3.
   103     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   104     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   105
   106 01  NET-PAY-INTERFACE.
   107     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   108     12  N-P-ORIG            PIC S9(3)       COMP-3.
   109     12  N-P-REM             PIC S9(3)       COMP-3.
   110     12  N-P-OPT             PIC X.
   111     12  N-P-LOAN            PIC S9(3)       COMP-3.
   112     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   113
*  114                         COPY ERCNETWS.
   115***************************************************************** 04/29/98
   116*                                                               * ERCNETWS
   117*                                                               * ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   4
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   118*                            ERCNETWS                           *    LV004
   119*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   120*                            VMOD=2.014                         *    CL**3
   121*                                                               * ERCNETWS
   122*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   123*                                                               * ERCNETWS
   124*****************************************************************.ERCNETWS
   125*                   C H A N G E   L O G
   126*
   127* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   128*-----------------------------------------------------------------
   129*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   130* EFFECTIVE    NUMBER
   131*-----------------------------------------------------------------
   132* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   133* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   134* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   135* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   136* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   137******************************************************************
   138                                                                  ERCNETWS
   139 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   140     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   141        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   142        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   143        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   144        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   145        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   146        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   147        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   148        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   149        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   150        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   151        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   152        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   153        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   154        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   155                                                                  ERCNETWS
   156     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   157        88  NET-STD             VALUE 'N'.                        ERCNETWS
   158        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   159                                                                  ERCNETWS
   160     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   161        88  NP-RATING           VALUE '1'.                        ERCNETWS
   162        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   163        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   164                                                                  ERCNETWS
   165     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   166         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   167         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   168         16  J               PIC SV9(9)        VALUE +0.
   169         16  K               PIC SV9(9)        VALUE +0.
   170         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   171         16  D               PIC S9(5)         VALUE +.0.
   172         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   173         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   174         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   175         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   5
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   176         16  pema            pic s9(2)v9(15)   value +0.
   177         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   178         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   179         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   180         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   181         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   182         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   183         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   184         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   185         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   186         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   187         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   188         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   189         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   190         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   191         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   192         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   193         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   194         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   195         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   196         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   197         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   198         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   199         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   200         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   201         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   202         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   203         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   204         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   205         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   206         16  K1              PIC S999          VALUE +1.          ERCNETWS
   207         16  K12             PIC S999          VALUE +12.         ERCNETWS
   208         16  K100            PIC S999          VALUE +100.        ERCNETWS
   209         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   210         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   211         16  Y REDEFINES NC-LR
   212                             PIC S99V9(5).
   213         16  TI              PIC S999V9(5)     VALUE +0.
   214         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   215         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   216         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   217         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   218         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   219         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   220         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   221         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   222                                                                  ERCNETWS
   223         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   224         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   225         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   226         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   227         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   228         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   229         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   230         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   231         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   232         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   233         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   6
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   234         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   235         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   236                                                                  ERCNETWS
   237         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
   238                                                                  ERCNETWS
   239         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   240         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   241                             PIC S999.                            ERCNETWS
   242                                                                  ERCNETWS
   243         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   244         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   245                             PIC S999.                            ERCNETWS
   246                                                                  ERCNETWS
   247         16  LOAN-TERM       PIC S999.                            ERCNETWS
   248         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   249                             PIC S999.                            ERCNETWS
   250                                                                  ERCNETWS
   251         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   252         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   253                             PIC S999.                            ERCNETWS
   254                                                                  ERCNETWS
   255         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   256                             PIC S9(7)V9(8).                      ERCNETWS
   257         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   258                             PIC S9(7)V9(8).                      ERCNETWS
   259                                                                  ERCNETWS
   260         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   261         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   262         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   263         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   264         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   265         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   266         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   267         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   268         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   269                                                                  ERCNETWS
   270     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   271         16  X1              PIC S999        VALUE +0.            ERCNETWS
   272         16  X2              PIC S999        VALUE +0.            ERCNETWS
   273         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   274         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   275         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   276         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   277                                                                  ERCNETWS
   278     12  CSO-RATE-WORK-AREAS.
   279         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   280         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   281         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   282
   283     12  WS-WORK-MISC.                                            ERCNETWS
   284         16  ws-extra-pmts       pic s999         comp-3.
   285         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   286         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   287*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   288         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   289         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   290         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   291         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   7
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   292         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   293         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   294         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   295         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   296         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   297         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   298         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   299         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   300******************************************************************ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   8
* ELRFNDX.cbl
   302
*  303                         COPY ELCDATE.
   304******************************************************************06/11/98
   305*                                                                *ELCDATE
   306*                                                                *ELCDATE
   307*                            ELCDATE.                            *   LV023
   308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   309*                            VMOD=2.003                           ELCDATE
   310*                                                                *ELCDATE
   311*                                                                *ELCDATE
   312*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   313*                 LENGTH = 200                                   *   CL*19
   314******************************************************************ELCDATE
   315                                                                  ELCDATE
   316 01  DATE-CONVERSION-DATA.                                        ELCDATE
   317     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   318     12  DC-OPTION-CODE                PIC X.                        CL*15
   319         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   320         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   321         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   322         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   323         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   324         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   325         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   326         88  FIND-CENTURY               VALUE '7'.                   CL*22
   327         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   328         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   329         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   330         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   331         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   332         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   333         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   334         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   335         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   336         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   337         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   338         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   339         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   340         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   341         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   342         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   343         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   344         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   345         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   346         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   347         88  THREE-CHARACTER-BIN                                  ELCDATE
   348                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   349         88  GREGORIAN-TO-BIN                                        CL**2
   350                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   351         88  BIN-TO-GREGORIAN                                        CL**2
   352                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   353         88  JULIAN-TO-BINARY                                        CL**2
   354                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   355     12  DC-ERROR-CODE                 PIC X.                        CL*15
   356         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   357         88  DATE-CONVERSION-ERROR                                ELCDATE
   358                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   359         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page   9
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   360         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   361         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   362         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   363         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   364         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   365         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   366         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   367         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   368         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   369     12  DC-END-OF-MONTH               PIC X.                        CL*15
   370         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   371     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   372         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   373         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   374         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   375     12  FILLER                        PIC X.                        CL*15
   376     12  DC-CONVERSION-DATES.                                        CL*15
   377         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   378         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   379         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   380         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   381                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   382             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   383             20  SLASH1-1              PIC X.                        CL*15
   384             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   385             20  SLASH1-2              PIC X.                        CL*15
   386             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   387         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   388         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   389                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   390             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   391             20  SLASH2-1              PIC X.                        CL*15
   392             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   393             20  SLASH2-2              PIC X.                        CL*15
   394             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   395         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   396         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   397                     DC-GREG-DATE-1-YMD.                          ELCDATE
   398             20  DC-YMD-YEAR           PIC 99.                       CL*15
   399             20  DC-YMD-MONTH          PIC 99.                       CL*15
   400             20  DC-YMD-DAY            PIC 99.                       CL*15
   401         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   402         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   403                      DC-GREG-DATE-1-MDY.                         ELCDATE
   404             20  DC-MDY-MONTH          PIC 99.                       CL*15
   405             20  DC-MDY-DAY            PIC 99.                       CL*15
   406             20  DC-MDY-YEAR           PIC 99.                       CL*15
   407         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   408             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   409             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   410             20  FILLER                PIC XX.                       CL*15
   411             20  DC-ALPHA-CENTURY.                                   CL*15
   412                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   413             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   414         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   415         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   416         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   417         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  10
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   418         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   419                                       PIC 9(05).                    CL*20
   420         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   421             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   422             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   423         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   424         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   425         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   426     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   427         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   428         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   429             20  FILLER                PIC 9(3).                     CL*15
   430             20  HOLD-CEN-1-CCYY.                                    CL*15
   431                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   432                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   433             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   434             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   435         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   436             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   437             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   438             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   439                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   440                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   441             20  FILLER                PIC 9(3).                     CL*15
   442         16  HOLD-CENTURY-1-X.                                       CL*15
   443             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   444             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   445                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   446                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   447             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   448             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   449         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   450             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   451             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   452             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   453                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   454                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   455             20  FILLER                PIC XXX.                      CL*23
   456         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   457         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   458         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   459         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   460             20  DC-JULIAN-1-CCYY.                                   CL*15
   461                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   462                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   463             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   464         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   465         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   466             20  DC-JULIAN-2-CCYY.                                   CL*15
   467                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   468                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   469             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   470         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   471             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   472             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   473             20  DC-EDITA-DAY          PIC 99.                       CL*15
   474             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   475             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  11
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   476                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   477                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   478         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   479             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   480             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   481             20  DC-EDITB-DAY          PIC 99.                       CL*15
   482             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   483             20  DC-EDITB-CCYY.                                      CL*15
   484                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   485                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   486         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   487         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   488                              DC-GREG-DATE-CYMD.                  ELCDATE
   489             20  DC-CYMD-CEN           PIC 99.                       CL*15
   490             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   491             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   492             20  DC-CYMD-DAY           PIC 99.                       CL*15
   493         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   494         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   495                              DC-GREG-DATE-MDCY.                  ELCDATE
   496             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   497             20  DC-MDCY-DAY           PIC 99.                       CL*15
   498             20  DC-MDCY-CEN           PIC 99.                       CL*15
   499             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   500    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   501        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   502    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   503    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  12
* ELRFNDX.cbl
   505 LINKAGE SECTION.
*  506                         COPY ELCCALC.
   507******************************************************************04/15/98
   508*                                                                *ELCCALC
   509*                           ELCCALC.                            *    LV003
   510*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   511*                            VMOD=2.025                          *   CL**3
   512*                                                                *   CL**2
   513*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   514*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   515*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   516*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   517*                                                                *   CL**2
   518*  PASSED TO ELRTRM                                              *   CL**2
   519*  -----------------                                             *   CL**2
   520*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   521*  ORIGINAL TERM                                                 *   CL**2
   522*  BEGINNING DATE                                                *   CL**2
   523*  ENDING DATE                                                   *   CL**2
   524*  COMPANY I.D.                                                  *   CL**2
   525*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   526*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   527*  FREE LOOK DAYS                                                *   CL**2
   528*                                                                *   CL**2
   529*  RETURNED FROM ELRTRM                                          *   CL**2
   530*  ---------------------                                         *   CL**2
   531*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   532*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   533*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   534*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   535*----------------------------------------------------------------*   CL**2
   536*  PASSED TO ELRAMT                                              *   CL**2
   537*  ----------------                                              *   CL**2
   538*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   539*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   540*  ORIGINAL AMOUNT                                               *   CL**2
   541*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   542*  A.P.R. - NET PAY ONLY                                         *   CL**2
   543*  METHOD                                                            CL**2
   544*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   545*  COMPANY I.D.                                                  *   CL**2
   546*  BENEFIT TYPE                                                  *   CL**2
   547*                                                                *   CL**2
   548*  RETURNED FROM ELRAMT                                          *   CL**2
   549*  --------------------                                          *   CL**2
   550*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   551*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   552*  REMAINING AMOUNT FACTOR                                           CL**2
   553*----------------------------------------------------------------*   CL**2
   554*  PASSED TO ELRESV                                              *   CL**2
   555*  -----------------                                             *   CL**2
   556*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   557*  VALUATION DATE                                                *   CL**2
   558*  PAID THRU DATE                                                *   CL**2
   559*  BENEFIT                                                       *   CL**2
   560*  INCURRED DATE                                                 *   CL**2
   561*  REPORTED DATE                                                 *   CL**2
   562*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  13
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   563*  TERM                                                          *   CL**2
   564*  CDT PERCENT                                                   *   CL**2
   565*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   566* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   567* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   568* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   569*                                                                *   CL**2
   570*  RETURNED FROM ELRESV                                          *   CL**2
   571*  --------------------                                          *   CL**2
   572*  CDT TABLE USED                                                *   CL**2
   573*  CDT FACTOR USED                                               *   CL**2
   574*  PAY TO CURRENT RESERVE                                        *   CL**2
   575*  I.B.N.R. - A/H ONLY                                           *   CL**2
   576*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   577*----------------------------------------------------------------*   CL**2
   578*  PASSED TO ELRATE                                              *   CL**2
   579*  ----------------                                              *   CL**2
   580*  CERT ISSUE DATE                                               *   CL**2
   581*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   582*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   583*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   584*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   585*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   586*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   587*  DEVIATION CODE                                                *   CL**2
   588*  ISSUE AGE                                                     *   CL**2
   589*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   590*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   591*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   592*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   593*  A.P.R.                                                        *   CL**2
   594*  METHOD                                                            CL**2
   595*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   596*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   597*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   598*  BENEFIT CODE                                                  *   CL**2
   599*  BENEFIT OVERRIDE CODE                                         *   CL**2
   600*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   601*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   602*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   603*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   604*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   605*                                                                *   CL**2
   606*  RETURNED FROM ELRATE                                          *   CL**2
   607*  --------------------                                          *   CL**2
   608*  CALCULATED PREMIUM                                            *   CL**2
   609*  PREMIUM RATE                                                  *   CL**2
   610*  MORTALITY CODE                                                *   CL**2
   611*  MAX ATTAINED AGE                                              *   CL**2
   612*  MAX AGE                                                       *   CL**2
   613*  MAX TERM                                                      *   CL**2
   614*  MAX MONTHLY BENEFIT                                           *   CL**2
   615*  MAX TOTAL BENIFIT                                             *   CL**2
   616*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   617*----------------------------------------------------------------*   CL**2
   618*  PASSED TO ELRFND                                              *   CL**2
   619*  ----------------                                              *   CL**2
   620*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  14
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   621*  REFUND DATE                                                   *   CL**2
   622*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   623*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   624*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   625*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   626*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   627*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   628*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   629*  DEVIATION CODE                                                *   CL**2
   630*  ISSUE AGE                                                     *   CL**2
   631*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   632*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   633*  PROCESS TYPE (CANCEL)                                         *   CL**2
   634*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   635*  A.P.R.                                                        *   CL**2
   636*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   637*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   638*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   639*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   640*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   641*  BENEFIT CODE                                                  *   CL**2
   642*  BENEFIT OVERRIDE CODE                                         *   CL**2
   643*                                                                *   CL**2
   644*  RETURNED FROM ELRFND                                          *   CL**2
   645*  --------------------                                          *   CL**2
   646*  CALCULATED REFUND                                             *   CL**2
   647*----------------------------------------------------------------*   CL**2
   648*  PASSED TO ELEARN                                              *   CL**2
   649*  ----------------                                              *   CL**2
   650*  CERT ISSUE DATE                                               *   CL**2
   651*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   652*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   653*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   654*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   655*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   656*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   657*  DEVIATION CODE                                                *   CL**2
   658*  ISSUE AGE                                                     *   CL**2
   659*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   660*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   661*  A.P.R.                                                        *   CL**2
   662*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   663*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   664*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   665*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   666*  BENEFIT CODE                                                  *   CL**2
   667*  BENEFIT OVERRIDE CODE                                         *   CL**2
   668*                                                                *   CL**2
   669*  RETURNED FROM ELEARN                                          *   CL**2
   670*  --------------------                                          *   CL**2
   671*  INDICATED  EARNINGS                                           *   CL**2
   672*----------------------------------------------------------------*   CL**2
   673*                 LENGTH = 450                                   *   CL**2
   674*                                                                *   CL**2
   675******************************************************************   CL**2
   676******************************************************************
   677*                   C H A N G E   L O G
   678*
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  15
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   679* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   680*-----------------------------------------------------------------
   681*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   682* EFFECTIVE    NUMBER
   683*-----------------------------------------------------------------
   684* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   685* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   686* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   687* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   688* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   689* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   690* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   691* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   692* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   693* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   694* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   695* 012820  CR2020012800001  PEMA ADD MIN LOAN TERM FOR EXT TERM.
   696******************************************************************
   697                                                                     CL**2
   698 01  CALCULATION-PASS-AREA.                                          CL**2
   699     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   700                                     COMP.                           CL**2
   701                                                                     CL**2
   702     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   703       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   704       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   705                                  '9' 'A' 'B' 'C' 'D' 'E' 'H' 'I'.
   706       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   707       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   708       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   709       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   710       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   711       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   712       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   713       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   714       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   715       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   716       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   717       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   718       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   719       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   720       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   721       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   722       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   723       88  CP-ERROR-TERM-BELOW-MINIMUM             VALUE 'I'.
   724                                                                     CL**2
   725     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   726       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   727***********************  INPUT AREAS ****************************    CL**2
   728                                                                     CL**2
   729     12  CP-CALCULATION-AREA.                                        CL**2
   730         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   731         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   732         16  CP-VALUATION-DT       PIC XX.                           CL**2
   733         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   734         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   735           88  CP-AH                               VALUE 'A' 'D'     CL**2
   736                                                   'I' 'U'.          CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  16
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   737           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   738           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   739         16  CP-INCURRED-DT        PIC XX.                           CL**2
   740         16  CP-REPORTED-DT        PIC XX.                           CL**2
   741         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   742         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   743         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   744                                     COMP-3.                         CL**2
   745         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   746                                     COMP-3.                         CL**2
   747         16  CP-CDT-METHOD         PIC X.                            CL**2
   748           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   749           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   750           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   751         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   752           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   753           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   754         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   755                                     COMP-3.                         CL**2
   756         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   757                                     COMP-3.                         CL**2
   758         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   759                                     COMP-3.                         CL**2
   760         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   761                                     COMP-3.                         CL**2
   762         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   763                                     COMP-3.                         CL**2
   764         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   765                                     COMP-3.                         CL**2
   766         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   767                                     COMP-3.                         CL**2
   768         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   769           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   770           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   771           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   772           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   773           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   774           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   775           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   776         16  CP-EARNING-METHOD     PIC X.                            CL**2
   777           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   778           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   779           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   780           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   781           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   782           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   783           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   784           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   785           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   786           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   787           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   788           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   789           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   790           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   791         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   792           88  CP-CLAIM                            VALUE '1'.        CL**2
   793           88  CP-CANCEL                           VALUE '2'.        CL**2
   794           88  CP-ISSUE                            VALUE '3'.        CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  17
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   795         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   796           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   797           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
   798           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   799           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   800           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   801           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   802           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   803           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   804           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   805           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   806           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   807           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   808           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   809           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   810           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   811           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   812           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   813           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   814                                                     'W' 'X'.        CL**2
   815           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   816           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   817           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   818           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   819           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   820           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   821           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   822           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   823           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   824           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   825           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   826           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   827           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   828                                                                     CL**2
   829         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   830                                     COMP-3.                         CL**2
   831         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   832         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   833         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   834         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   835         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   836           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   837               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   838         16  CP-R78-OPTION         PIC X.                            CL**2
   839           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   840           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   841                                                                     CL**2
   842         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   843         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   844         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   845         16  CP-RATE-FILE          PIC X.                            CL**2
   846         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   847                                     COMP-3.                         CL**2
   848                                                                     CL**2
   849         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   850         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   851                                                                     CL**2
   852         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  18
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   853                                     COMP-3.
   854         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   855                                   PIC S9(5)V99 COMP-3.
   856         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   857                                     COMP-3.                         CL**2
   858         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   859                                     COMP-3.                         CL**2
   860         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   861                                     COMP-3.
   862         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   863                                  PIC S9(7)V99 COMP-3.
   864                                                                     CL**2
   865         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   866         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   867         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   868           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   869           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   870           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   871           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   872         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   873         16  CP-CARRIER            PIC X.                            CL**2
   874         16  CP-REIN-FLAG          PIC X.                            CL**2
   875         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   876           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   877                      '2' '3' '4' '5'.                               CL**2
   878           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   879           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   880           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   881           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   882           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   883           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   884           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   885           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   886         16  CP-SIG-SWITCH         PIC X.                            CL**2
   887         16  CP-RATING-METHOD      PIC X.                            CL**2
   888           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   889           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   890           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   891           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   892           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   893           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   894           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   895           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   896           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   897         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   898                                     COMP-3.                         CL**2
   899         16  CP-BEN-CATEGORY       PIC X.
   900         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   901         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   902                                   PIC S99V9(5) COMP-3.
   903         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   904         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   905                                   PIC S99V9(5) COMP-3.
   906         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   907         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   908         16  CP-EXPIRE-DT          PIC XX.
   909         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   910         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  19
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   911         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   912         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   913         16  CP-DDF-SPEC-CALC      PIC X.
   914             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   915             88  CP-CALC-CLP              VALUE 'C'.
   916         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   917         16  CP-CANCEL-REASON      PIC X.
   918         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   919         16  CP-PMT-MODE           PIC X.
   920         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   921         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   922         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   923         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   924         16  FILLER                PIC X.
   925                                                                     CL**2
   926***************    OUTPUT FROM ELRESV   ************************     CL**2
   927                                                                     CL**2
   928         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   929                                                                     CL**2
   930         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   931                                     COMP-3.                         CL**2
   932         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   933                                     COMP-3.                         CL**2
   934         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   937                                     COMP-3.                         CL**2
   938         16  FILLER                PIC X(09).                        CL**2
   939***************    OUTPUT FROM ELRTRM   *************************    CL**2
   940                                                                     CL**2
   941         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   942                                     COMP-3.                         CL**2
   943         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   944                                     COMP-3.                         CL**2
   945         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   946                                     COMP-3.                         CL**2
   947         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   948                                     COMP-3.                         CL**2
   949         16  FILLER                PIC X(12).                        CL**2
   950                                                                     CL**2
   951***************    OUTPUT FROM ELRAMT   *************************    CL**2
   952                                                                     CL**2
   953         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   954                                     COMP-3.                         CL**2
   955         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   956                                     COMP-3.                         CL**2
   957         16  FILLER                PIC X(12).                        CL**2
   958                                                                     CL**2
   959***************    OUTPUT FROM ELRATE   *************************    CL**2
   960                                                                     CL**2
   961         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   962                                     COMP-3.                         CL**2
   963         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   964                                     COMP-3.                         CL**2
   965         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   966         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   967             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   968         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  20
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   969                                     COMP-3.                         CL**2
   970         16  CP-CANCEL-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   971         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
   972         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   973                                   PIC S9(7)V99 COMP-3.
   974         16  FILLER                PIC X(07).                        CL**2
   975                                                                     CL**2
   976***************    OUTPUT FROM ELRFND   *************************    CL**2
   977                                                                     CL**2
   978         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   979                                     COMP-3.                         CL**2
   980         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   981           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   982           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   983           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   984           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   985           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   986           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   987           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   988           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   989           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   990           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   991           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   992           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   993           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   994           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   995         16  FILLER                PIC X(12).                        CL**2
   996                                                                     CL**2
   997***************    OUTPUT FROM ELEARN   *************************    CL**2
   998                                                                     CL**2
   999         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1000                                     COMP-3.                         CL**2
  1001         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1002                                     COMP-3.                         CL**2
  1003         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1004                                     COMP-3.                         CL**2
  1005         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1006                                     COMP-3.                         CL**2
  1007         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1008                                     COMP-3.                         CL**2
  1009         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1010                                     COMP-3.                         CL**2
  1011         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1012           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1013           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1014           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1015           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1016           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1017           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1018           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1019           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1020           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1021         16  FILLER                PIC X(12).                        CL**2
  1022                                                                     CL**2
  1023***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1024                                                                     CL**2
  1025         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1026                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  21
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1027         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1028                                     COMP-3.                         CL**2
  1029         16  FILLER                PIC X(12).                        CL**2
  1030                                                                     CL**2
  1031***************   MISC WORK AREAS    *****************************   CL**2
  1032         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1033                                     COMP-3.                         CL**2
  1034         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1035                                     COMP-3.                         CL**2
  1036         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1037                                     COMP-3.                         CL**2
  1038         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1039                                     COMP-3.                         CL**2
  1040         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1041                                     COMP-3.                         CL**2
  1042         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1043                                     COMP-3.                         CL**2
  1044         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1045             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1046             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1047             88  IO-ERROR                         VALUE 'E'.         CL**2
  1048                                                                     CL**2
  1049         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1050                                                                     CL**2
  1051         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1052                                                                     CL**2
  1053         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1054                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1055                                     COMP-3.                         CL**2
  1056                                                                     CL**2
  1057         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1058                                                                     CL**2
  1059         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1060                                     COMP-3.                         CL**2
  1061                                                                     CL**2
  1062         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1063                                     COMP-3.                         CL**2
  1064                                                                     CL**2
  1065         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1066                                     COMP-3.                         CL**2
  1067                                                                     CL**2
  1068         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1069                                     COMP-3.                         CL**2
  1070                                                                     CL**2
  1071         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1072                                     COMP-3.                         CL**2
  1073                                                                     CL**2
  1074         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1075                                     COMP-3.                         CL**2
  1076                                                                     CL**2
  1077         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1078                                     COMP-3.                         CL**2
  1079                                                                     CL**2
  1080         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1081             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1082                                                                     CL**2
  1083         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1084                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  22
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1085         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1086                                     COMP-3.
  1087         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1088         16  cp-extra-periods      pic 9 value zeros.
  1089         16  cp-net-only-state     pic x value spaces.
  1090         16  FILLER                PIC X(13).                        CL**2
  1091******************************************************************   CL**2
  1092
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  23
* ELRFNDX.cbl
  1094 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
  1095
  1096 000-START-REFUND-CALC.
* 1097                       COPY ELCRFNDP.
  1098****************************************************************
  1099*                                                              *
  1100*                            ELCRFNDP.                         *
  1101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1102*                            VMOD=2.028                        *
  1103*                                                              *
  1104****************************************************************.
  1105*                   C H A N G E   L O G
  1106*
  1107* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1108*-----------------------------------------------------------------
  1109*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1110* EFFECTIVE    NUMBER
  1111*-----------------------------------------------------------------
  1112* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1113* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1114* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1115* 110609  CR2009092300002  PEMA CHANGE MN REFUNDS
  1116* 000000  CR2008042200001  PEMA ADD 0 APR PROCESSING
  1117* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  1118* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1119* 032612  CR2011110200001  PEMA AHL CHANGES
  1120* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR NET PAY
  1121* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  1122* 011317  IR2017011000002  PEMA  REMOVE 'CT' HARDCODING
  1123* 071222  IR2022071200001  PEMA  Ref Rea of "R" s/b DCC only
  1124******************************************************************
  1125
  1126     MOVE ZERO                   TO  CP-RETURN-CODE
  1127                                     CP-CALC-REFUND.
  1128     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1129
  1130 0001-GET-CANCEL-TYPE.
  1131     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1132        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1133        GO TO 1999-CALC-REF-AMT-X.
  1134
  1135     IF (CP-CANCEL-REASON = 'R')
  1136        and (cp-company-id = 'DCC')
  1137        IF CP-CALC-CLP
  1138           MOVE CP-ORIGINAL-PREMIUM
  1139                                 TO CP-CALC-REFUND
  1140        ELSE
  1141           COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM -
  1142              CP-DDF-ADMIN-FEES
  1143        END-IF
  1144        MOVE 'R'                 TO CP-REFUND-TYPE-USED
  1145        GO TO 1999-CALC-REF-AMT-X
  1146     END-IF
  1147
  1148     IF CP-REMAINING-TERM = ZERO   OR
  1149        CP-REMAINING-TERM NEGATIVE
  1150          MOVE ZERO TO CP-CALC-REFUND
  1151          GO TO 1999-CALC-REF-AMT-X.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  24
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1152
  1153     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1154     MOVE SPACE              TO DC-OPTION-CODE.
  1155     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1156
  1157     IF DATE-CONVERSION-ERROR
  1158         MOVE '2' TO CP-RETURN-CODE
  1159         GO TO 1999-CALC-REF-AMT-X.
  1160
  1161     IF CP-AH
  1162        GO TO 1030-GET-AH-REFUND.
  1163
  1164********************    LIFE REFUNDS    **************************
  1165
  1166     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1167         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1168
  1169     IF CP-LOAN-TERM NOT NUMERIC
  1170         MOVE +0                TO CP-LOAN-TERM.
  1171
  1172     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1173
  1174     COMPUTE R78-FACTOR =
  1175            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1176              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1177************************************************************
  1178***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1179***---------------------------------------------------------
  1180     IF CP-TRUNCATED-LIFE
  1181        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1182     ELSE
  1183        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1184***
  1185************************************************************
  1186**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1187**** FOLLOWING.
  1188****       FOR NC. LIFE..
  1189****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1190****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1191****                             TERM <= 60 USE SUM OF DIGITS.
  1192****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1193****                             TERM > 60 USE RULE OF ANTIC
  1194****                             OTHERWISE USE RULE OF 78.
  1195****
  1196****
  1197
  1198     IF (CP-COMPANY-ID = 'NCL') AND
  1199        (CP-STATE-STD-ABBRV = 'NC')
  1200        IF CP-LEVEL-LIFE
  1201           GO TO 1023-REF-PR
  1202        ELSE
  1203        IF CP-EARN-AS-NET-PAY AND
  1204           CP-TRUNCATED-LIFE
  1205           IF CP-ORIGINAL-TERM GREATER THAN 60
  1206              GO TO 1021-ANTICIPATION-REF
  1207           ELSE
  1208              GO TO 1026-REF-R78
  1209        ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  25
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1210        IF CP-REDUCING-LIFE
  1211           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1212              CP-ORIGINAL-TERM GREATER THAN 60)
  1213              GO TO 1021-ANTICIPATION-REF
  1214           ELSE
  1215              GO TO 1075-SUM-OF-DIGITS.
  1216
  1217****
  1218**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1219**** FOLLOWING.
  1220****       FOR OH. LIFE..
  1221****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1222****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1223****  GROSS DECREASING       --- RULE OF 78
  1224****
  1225****
  1226
  1227     IF (CP-COMPANY-ID = 'CID') AND
  1228        (CP-STATE-STD-ABBRV = 'OH') AND
  1229        (CP-CLASS-CODE NOT = 'L ')
  1230        IF CP-LEVEL-LIFE
  1231           GO TO 1023-REF-PR
  1232        ELSE
  1233           IF (CP-ORIGINAL-TERM > 60) OR
  1234              (CP-EARN-AS-NET-PAY)
  1235              GO TO 1028-NET-PAY-REFUND
  1236           ELSE
  1237              GO TO 1026-REF-R78
  1238           END-IF
  1239        END-IF
  1240     END-IF
  1241
  1242**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1243**** FOLLOWING.
  1244****       FOR VA. LIFE..
  1245****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1246****           NET COVERAGES --- USE RULE OF ANTIC.
  1247****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1248****                         --- EFF DATE > 123194 USE ANTIC.
  1249****                         --- EFF DATE BETWEEN 010193 AND 12319
  1250****                             WITH TERM > 61 USE RULE OF ANTIC
  1251****                             OTHERWISE USE RULE OF 78.
  1252****
  1253****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1254****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1255****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1256****            WILL FOLLOW.
  1257****
  1258****
  1259****
  1260
  1261     IF (CP-COMPANY-ID = 'NCL') AND
  1262        (CP-STATE-STD-ABBRV = 'VA')
  1263        IF CP-LEVEL-LIFE
  1264           GO TO 1023-REF-PR
  1265        ELSE
  1266        IF CP-EARN-AS-NET-PAY
  1267           GO TO 1021-ANTICIPATION-REF
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  26
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1268        ELSE
  1269        IF CP-REDUCING-LIFE
  1270           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1271              GO TO 1026-REF-R78
  1272           ELSE
  1273           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1274              GO TO 1021-ANTICIPATION-REF
  1275           ELSE
  1276           IF CP-ORIGINAL-TERM GREATER THAN 61
  1277              GO TO 1021-ANTICIPATION-REF
  1278           ELSE
  1279              GO TO 1026-REF-R78.
  1280
  1281     IF (CP-COMPANY-ID = 'CID')
  1282        AND (CP-STATE-STD-ABBRV = 'IN')
  1283        AND (DC-GREG-DATE-CYMD < 20030401)
  1284        IF CP-REDUCING-LIFE
  1285           GO TO 1026-REF-R78
  1286        ELSE
  1287           IF CP-LEVEL-LIFE
  1288              GO TO 1023-REF-PR
  1289           END-IF
  1290        END-IF
  1291     END-IF
  1292
  1293     IF (CP-COMPANY-ID = 'CID')
  1294        AND (CP-STATE-STD-ABBRV = 'FL')
  1295        AND (DC-GREG-DATE-CYMD > 20030630)
  1296        IF CP-RATE-AS-NET-PAY
  1297           GO TO 1028-NET-PAY-REFUND
  1298        END-IF
  1299     END-IF
  1300
  1301     IF (CP-COMPANY-ID = 'CID')
  1302        AND (CP-STATE-STD-ABBRV = 'MN')
  1303        AND (CP-EARN-AS-NET-PAY)
  1304        AND (CP-RATE-AS-REG-BALLOON)
  1305        AND (DC-GREG-DATE-CYMD > 20091231)
  1306        GO TO 1028-NET-PAY-REFUND
  1307     END-IF
  1308
  1309     IF (CP-COMPANY-ID = 'CID')
  1310        AND (CP-STATE-STD-ABBRV = 'MN')
  1311        AND (DC-GREG-DATE-CYMD > 20091231)
  1312        AND (CP-RATE-AS-NET-PAY)
  1313        GO TO 1021-ANTICIPATION-REF
  1314     END-IF
  1315
  1316     IF (CP-COMPANY-ID = 'CID')
  1317        AND (CP-STATE-STD-ABBRV = 'MO')
  1318        AND (DC-GREG-DATE-CYMD > 20030630)
  1319        AND (CP-LOAN-TERM < +121)
  1320        IF CP-RATE-AS-NET-PAY
  1321           GO TO 1028-NET-PAY-REFUND
  1322        END-IF
  1323     END-IF
  1324
  1325     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  27
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1326        AND (CP-STATE-STD-ABBRV = 'ND')
  1327        AND (DC-GREG-DATE-CYMD > 20011231)
  1328        AND (CP-REDUCING-LIFE)
  1329        GO TO 1021-ANTICIPATION-REF
  1330     END-IF
  1331
  1332     IF CP-CRITICAL-PERIOD
  1333        IF CP-COMPANY-ID = 'NCL'
  1334           NEXT SENTENCE
  1335        ELSE
  1336           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1337
  1338     IF CP-TERM-IS-DAYS  AND
  1339        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1340         GO TO 1024-REF-PR-DAYS.
  1341
  1342     IF CP-STATE-STD-ABBRV = 'NM'
  1343       IF CP-REDUCING-LIFE
  1344*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1345         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1346             GO TO 1026-REF-R78.
  1347
  1348     IF CP-EARN-ANTICIPATION
  1349         GO TO 1021-ANTICIPATION-REF.
  1350
  1351     IF CP-STATE-STD-ABBRV = 'ME'
  1352         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1353            NEXT SENTENCE
  1354         ELSE
  1355            IF CP-REDUCING-LIFE
  1356               GO TO 1021-ANTICIPATION-REF.
  1357
  1358     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1359        IF CP-STATE-STD-ABBRV = 'TX'
  1360            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1361        END-IF
  1362     END-IF.
  1363
  1364     IF CP-STATE-STD-ABBRV = 'TX'
  1365       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1366          NEXT SENTENCE
  1367       END-IF
  1368        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1369           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1370           GO TO 1021-ANTICIPATION-REF.
  1371
  1372 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1373
  1374     IF CP-EARN-BY-PRORATA
  1375         GO TO 1023-REF-PR.
  1376
  1377     IF CP-EARN-AS-MEAN
  1378         GO TO 1025-REF-MEAN.
  1379
  1380     IF CP-EARN-AS-TEXAS
  1381         GO TO 1027-TEXAS-REFUND.
  1382
  1383     IF CP-EARN-AS-NET-PAY
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  28
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1384         GO TO 1028-NET-PAY-REFUND.
  1385
  1386     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1387         GO TO 1000-NO-NET-PAY.
  1388
  1389     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1390       IF CP-STATE-STD-ABBRV = 'NC'
  1391         IF CP-REDUCING-LIFE
  1392           IF CP-ORIGINAL-TERM GREATER 60  AND
  1393              DC-GREG-DATE-CYMD GREATER 19810930
  1394                GO TO 1028-NET-PAY-REFUND
  1395           ELSE
  1396              GO TO 1026-REF-R78.
  1397
  1398
  1399     IF CP-STATE-STD-ABBRV = 'NC'
  1400       IF CP-COMPANY-ID EQUAL 'NCL'
  1401          NEXT SENTENCE
  1402       END-IF
  1403       IF CP-REDUCING-LIFE
  1404         IF CP-ORIGINAL-TERM GREATER 60  AND
  1405            DC-GREG-DATE-CYMD GREATER 19810930
  1406             GO TO 1021-ANTICIPATION-REF
  1407         ELSE
  1408             GO TO 1026-REF-R78.
  1409
  1410     IF CP-STATE-STD-ABBRV = 'UT'
  1411       IF CP-COMPANY-ID EQUAL 'NCL'
  1412          NEXT SENTENCE
  1413       END-IF
  1414         IF CP-ORIGINAL-TERM GREATER 62         AND
  1415            CP-LOAN-APR GREATER ZERO            AND
  1416            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1417            DC-GREG-DATE-CYMD LESS    19830901
  1418             GO TO 1028-NET-PAY-REFUND
  1419         ELSE
  1420             GO TO 1026-REF-R78.
  1421
  1422     IF CP-STATE-STD-ABBRV = 'OH'
  1423       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1424          NEXT SENTENCE
  1425       END-IF
  1426           IF CP-ORIGINAL-TERM GREATER 60         AND
  1427              CP-CLASS-CODE NOT = 'L '            AND
  1428              CP-LOAN-APR GREATER ZERO            AND
  1429              DC-GREG-DATE-CYMD GREATER 19831031
  1430              GO TO 1028-NET-PAY-REFUND
  1431           ELSE
  1432              GO TO 1026-REF-R78.
  1433
  1434     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1435       IF CP-STATE-STD-ABBRV = 'MT'
  1436         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1437
  1438
  1439     IF CP-STATE-STD-ABBRV = 'MT'
  1440       IF CP-COMPANY-ID EQUAL 'NCL'
  1441          NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  29
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1442       END-IF
  1443         IF CP-ORIGINAL-TERM GREATER 61         AND
  1444            CP-LOAN-APR GREATER ZERO            AND
  1445            DC-GREG-DATE-CYMD GREATER 19830318
  1446             GO TO 1028-NET-PAY-REFUND
  1447         ELSE
  1448             GO TO 1026-REF-R78.
  1449
  1450 SKIP-CSO-MT-LF-PROCESSING.
  1451
  1452     IF CP-STATE-STD-ABBRV = 'RI'
  1453       IF CP-COMPANY-ID EQUAL 'NCL'
  1454          NEXT SENTENCE
  1455       END-IF
  1456         IF CP-ORIGINAL-TERM GREATER 60         AND
  1457            CP-LOAN-APR GREATER ZERO            AND
  1458            DC-GREG-DATE-CYMD GREATER 19831231
  1459             GO TO 1028-NET-PAY-REFUND
  1460         ELSE
  1461             GO TO 1026-REF-R78.
  1462
  1463
  1464 1000-NO-NET-PAY.
  1465
  1466     IF CP-STATE-STD-ABBRV = 'WY'
  1467       IF CP-COMPANY-ID EQUAL 'NCL'
  1468          NEXT SENTENCE
  1469       END-IF
  1470        IF CP-COMPANY-ID = 'TMS'
  1471           GO TO 1026-REF-R78
  1472        ELSE
  1473           GO TO 1023-REF-PR.
  1474
  1475     IF CP-EARN-BY-R78
  1476         GO TO 1026-REF-R78.
  1477
  1478     IF CP-EARN-AS-SUM-OF-DIGITS
  1479         GO TO 1075-SUM-OF-DIGITS.
  1480
  1481     IF CP-LEVEL-LIFE
  1482         GO TO 1023-REF-PR
  1483     ELSE
  1484         GO TO 1026-REF-R78.
  1485
  1486*-----------------------------------------------------------------
  1487 1021-ANTICIPATION-REF.
  1488     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1489
  1490     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1491     IF CP-LOAN-TERM = ZEROS
  1492        MOVE CP-ORIGINAL-TERM TO CP-LOAN-TERM
  1493     END-IF
  1494
  1495     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1496                            CP-REMAINING-TERM.
  1497
  1498     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1499     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  30
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1500     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1501     move cp-term-or-ext-days  to ws-save-ext-days
  1502
  1503     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1504     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1505     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1506
  1507     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1508         MOVE 'N'              TO CP-ROA-REFUND
  1509     ELSE
  1510         MOVE 'Y'              TO CP-ROA-REFUND.
  1511
  1512******    TO COMPUTE PREMIUM AT REFUND DATE
  1513
  1514     PERFORM 2500-GET-RATE.
  1515
  1516     MOVE 'N'                  TO CP-ROA-REFUND.
  1517     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1518     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1519     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1520     move ws-save-ext-days     to cp-term-or-ext-days
  1521
  1522     IF CP-PREMIUM-RATE = ZEROS
  1523        MOVE '7'                 TO CP-RETURN-CODE
  1524        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1525        GO TO 1999-CALC-REF-AMT-X.
  1526
  1527     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1528
  1529******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1530
  1531     PERFORM 2500-GET-RATE.
  1532
  1533     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1534
  1535     IF CP-PREMIUM-RATE = ZEROS
  1536        MOVE '7'            TO CP-RETURN-CODE
  1537        GO TO 1999-CALC-REF-AMT-X.
  1538
  1539     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1540
  1541     IF  WS-ORIG-PREM = ZEROS
  1542         MOVE ZEROS TO WS-NP-REF-FACTOR
  1543        ELSE
  1544         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1545                                            WS-ORIG-PREM.
  1546
  1547     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1548                                        CP-ORIGINAL-PREMIUM.
  1549
  1550     GO TO 1999-CALC-REF-AMT-X.
  1551
  1552*---------------------------------------------------------------
  1553 1022-REF-CRITICAL-PERIOD-LF.
  1554     GO TO 1023-REF-PR.
  1555
  1556*---------------------------------------------------------------
  1557 1023-REF-PR.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  31
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1558     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1559     COMPUTE CP-CALC-REFUND ROUNDED =
  1560            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1561
  1562     GO TO 1999-CALC-REF-AMT-X.
  1563
  1564*---------------------------------------------------------------
  1565 1024-REF-PR-DAYS.
  1566     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1567     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1568     MOVE '1'                TO DC-OPTION-CODE.
  1569     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1570
  1571     IF DATE-CONVERSION-ERROR
  1572         MOVE '2' TO CP-RETURN-CODE
  1573         GO TO 1999-CALC-REF-AMT-X.
  1574
  1575     COMPUTE CP-CALC-REFUND ROUNDED =
  1576         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1577                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1578
  1579     GO TO 1999-CALC-REF-AMT-X.
  1580
  1581*---------------------------------------------------------------
  1582 1025-REF-MEAN.
  1583     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1584     COMPUTE CP-CALC-REFUND ROUNDED =
  1585          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1586           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1587
  1588     GO TO 1999-CALC-REF-AMT-X.
  1589
  1590*---------------------------------------------------------------
  1591 1026-REF-R78.
  1592     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1593*    IF CP-TERM-TIMES-TERM
  1594*        COMPUTE R78-FACTOR =
  1595*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1596*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1597*
  1598     COMPUTE CP-CALC-REFUND ROUNDED =
  1599        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1600
  1601     GO TO 1999-CALC-REF-AMT-X.
  1602
  1603*---------------------------------------------------------------
  1604 1027-TEXAS-REFUND.
  1605     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1606     IF CP-PAY-FREQUENCY = ZERO
  1607        MOVE ZERO TO CP-CALC-REFUND
  1608        MOVE '5'  TO CP-RETURN-CODE
  1609        GO TO 1999-CALC-REF-AMT-X.
  1610
  1611     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1612         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1613
  1614     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1615         GIVING TEX-FACT-5
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  32
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1616             REMAINDER TEX-FACT-6.
  1617
  1618     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1619
  1620     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1621         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1622         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1623
  1624     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1625
  1626     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1627                                        * TEX-FACT-8.
  1628
  1629     GO TO 1999-CALC-REF-AMT-X.
  1630
  1631*---------------------------------------------------------------
  1632 1028-NET-PAY-REFUND.
  1633
  1634     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1635     IF CP-LOAN-APR = ZERO
  1636        move '1'                 to cp-refund-type-used
  1637        compute cp-calc-refund rounded =
  1638           cp-original-premium * r78-factor
  1639        go to 1999-calc-ref-amt-x
  1640     end-if
  1641
  1642*       MOVE ZERO TO CP-CALC-REFUND
  1643*       MOVE '1'  TO CP-RETURN-CODE
  1644*       GO TO 1999-CALC-REF-AMT-X.
  1645
  1646     MOVE CP-LOAN-APR           TO N-P-APR.
  1647     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1648     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1649
  1650     IF CP-TRUNCATED-LIFE
  1651        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1652
  1653     MOVE 'R'                   TO N-P-OPT.
  1654
  1655     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1656
  1657     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1658                                        CP-ORIGINAL-PREMIUM.
  1659
  1660 1029-UTAH-REFUND.
  1661*
  1662*---------------------------------------------------------------
  1663* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1664*---------------------------------------------------------------
  1665*
  1666     GO TO 1999-CALC-REF-AMT-X.
  1667*
  1668*---------------------------------------------------------------
  1669     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1670                      OR
  1671        (CP-COMPANY-ID EQUAL 'NCL')
  1672         GO TO 1999-CALC-REF-AMT-X.
  1673     MOVE '3'               TO CP-REFUND-TYPE-USED.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  33
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1674
  1675     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1676        GREATER ZERO AND LESS 13
  1677         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1678                 (CP-CALC-REFUND * .05).
  1679
  1680     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1681        GREATER 12 AND LESS 25
  1682         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1683                 (CP-CALC-REFUND * .025).
  1684
  1685     GO TO 1999-CALC-REF-AMT-X.
  1686*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  34
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1688*---------------------------------------------------------------
  1689 1030-GET-AH-REFUND.
  1690     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1691
  1692     COMPUTE R78-FACTOR =
  1693            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1694                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1695
  1696*    IF CP-TERM-TIMES-TERM
  1697*        COMPUTE R78-FACTOR =
  1698*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1699*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1700*
  1701
  1702**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1703**** FOLLOWING.
  1704****       FOR VA. DISABILITY
  1705****                         --- EFF DATE > 123192 AND
  1706****                             TERM > 61 USE RULE OF ANTIC
  1707****                             OTHERWISE USE RULE OF 78.
  1708****
  1709****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1710****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1711****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1712****            WILL FOLLOW.
  1713****
  1714****
  1715****
  1716     IF CP-COMPANY-ID = 'NCL' or 'AHL'
  1717        IF CP-STATE-STD-ABBRV = 'VA'
  1718           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1719              (CP-ORIGINAL-TERM GREATER THAN 61)
  1720               MOVE '6'        TO CP-EARNING-METHOD
  1721               GO TO 1060-ANTICIPATION-REF
  1722            ELSE
  1723               MOVE '1'        TO CP-EARNING-METHOD
  1724               GO TO 1050-R78-REF.
  1725
  1726     IF CP-STATE-STD-ABBRV = 'WY'
  1727        IF CP-COMPANY-ID = 'TMS'
  1728           GO TO 1050-R78-REF.
  1729
  1730     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1731                     OR 'AHL' OR 'VPP'
  1732         NEXT SENTENCE
  1733     ELSE
  1734         IF CP-CRITICAL-PERIOD
  1735             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1736
  1737
  1738*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1739*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1740*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1741*    DAY FREE LOOK PERIOD. ALSO, 55 AND 56 ARE THE BIU CODES
  1742
  1743     IF (CP-GAP-NON-REFUNDABLE)
  1744        IF (CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM)
  1745           OR (CP-BENEFIT-CD = '55' OR '56')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  35
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1746           MOVE ZEROS            TO CP-CALC-REFUND
  1747           MOVE 'G'              TO CP-REFUND-TYPE-USED
  1748           GO TO 1999-CALC-REF-AMT-X
  1749        END-IF
  1750     END-IF
  1751
  1752     IF CP-GAP-ACTUARIAL
  1753         GO TO 1070-NET-PAY-REFUND
  1754     END-IF
  1755
  1756     IF (CP-COMPANY-ID = 'CID')
  1757        AND (CP-STATE-STD-ABBRV = 'MN')
  1758        AND (DC-GREG-DATE-CYMD > 20091231)
  1759        IF (CP-CRITICAL-PERIOD)
  1760           GO TO 1040-PR-REF
  1761        ELSE
  1762           GO TO 1055-MEAN-REF
  1763     END-IF
  1764
  1765     IF CP-COMPANY-ID EQUAL 'CID' OR 'DCC' OR 'VPP'
  1766        IF CP-STATE-STD-ABBRV = 'NC'
  1767           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1768
  1769     IF (CP-COMPANY-ID = 'CID')
  1770        AND (CP-STATE-STD-ABBRV = 'IN')
  1771        AND (DC-GREG-DATE-CYMD < 20030401)
  1772        GO TO 1026-REF-R78
  1773     END-IF
  1774
  1775     IF (CP-COMPANY-ID = 'CID')
  1776        AND (CP-STATE-STD-ABBRV = 'FL')
  1777        AND (DC-GREG-DATE-CYMD > 20030630)
  1778        AND (CP-CRITICAL-PERIOD)
  1779        GO TO 1040-PR-REF
  1780     END-IF
  1781
  1782     IF (CP-COMPANY-ID = 'CID')
  1783        AND (CP-STATE-STD-ABBRV = 'MO')
  1784        AND (DC-GREG-DATE-CYMD > 20030630)
  1785        AND (CP-CRITICAL-PERIOD)
  1786        GO TO 1040-PR-REF
  1787     END-IF
  1788
  1789     IF (CP-COMPANY-ID = 'CID')
  1790        AND (CP-STATE-STD-ABBRV = 'ND')
  1791        AND (CP-CRITICAL-PERIOD)
  1792        AND (DC-GREG-DATE-CYMD > 20011231)
  1793        GO TO 1040-PR-REF
  1794     END-IF
  1795
  1796     IF (CP-COMPANY-ID = 'CID')
  1797        AND (CP-STATE-STD-ABBRV = 'ND')
  1798        AND (DC-GREG-DATE-CYMD > 20011231)
  1799        GO TO 1060-ANTICIPATION-REF
  1800     END-IF
  1801
  1802     IF CP-STATE-STD-ABBRV = 'NC'
  1803       IF CP-COMPANY-ID = 'NCL' OR 'NCB'
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  36
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1804          NEXT SENTENCE
  1805       END-IF
  1806         IF DC-GREG-DATE-CYMD GREATER 19810930
  1807            IF CP-EARN-ANTICIPATION
  1808                GO TO 1060-ANTICIPATION-REF
  1809            ELSE
  1810                GO TO 1055-MEAN-REF.
  1811
  1812 SKIP-CSO-NC-AH-PROCESSING.
  1813
  1814     IF CP-STATE-STD-ABBRV = 'NM'
  1815       IF CP-COMPANY-ID = 'NCL' OR 'DCC' OR 'AHL' OR 'VPP'
  1816          NEXT SENTENCE
  1817       END-IF
  1818         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1819            IF CP-COMPANY-ID = 'MON'
  1820              MOVE '6'             TO CP-EARNING-METHOD
  1821              GO TO 1060-ANTICIPATION-REF
  1822             ELSE
  1823              GO TO 1055-MEAN-REF.
  1824
  1825*    IF CP-STATE-STD-ABBRV = 'CT'
  1826*      IF CP-COMPANY-ID EQUAL 'NCL' OR 'DCC' OR 'VPP'
  1827*         NEXT SENTENCE
  1828*      END-IF
  1829*         MOVE '6'              TO CP-EARNING-METHOD
  1830*         GO TO 1060-ANTICIPATION-REF.
  1831
  1832     IF CP-STATE-STD-ABBRV = 'ME'
  1833       IF CP-COMPANY-ID = 'NCL' OR 'CVL' OR 'DCC' OR 'VPP'
  1834          NEXT SENTENCE
  1835       END-IF
  1836           IF CP-EARN-BY-PRORATA
  1837              GO TO 1040-PR-REF
  1838           ELSE
  1839              MOVE '6'           TO CP-EARNING-METHOD
  1840              GO TO 1060-ANTICIPATION-REF.
  1841
  1842
  1843     IF CP-COMPANY-ID = 'CID' OR 'DCC' OR 'VPP'
  1844        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1845            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1846
  1847     IF CP-STATE-STD-ABBRV = 'TX'
  1848       IF CP-COMPANY-ID = 'NCL' OR 'HER'
  1849          NEXT SENTENCE
  1850       END-IF
  1851        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1852           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1853           MOVE '6'              TO CP-EARNING-METHOD
  1854           GO TO 1060-ANTICIPATION-REF.
  1855
  1856     IF CP-STATE-STD-ABBRV = 'VA'
  1857       IF CP-COMPANY-ID EQUAL 'NCL'
  1858          NEXT SENTENCE
  1859       END-IF
  1860       IF CP-COMPANY-ID = 'NCB'
  1861           MOVE '6'                TO CP-EARNING-METHOD
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  37
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1862           GO TO 1060-ANTICIPATION-REF
  1863       ELSE
  1864           IF DC-GREG-DATE-CYMD GREATER 19921231
  1865               IF CP-ORIGINAL-TERM GREATER THAN 61
  1866                   MOVE '6'        TO CP-EARNING-METHOD
  1867                   GO TO 1060-ANTICIPATION-REF
  1868               ELSE
  1869                   MOVE '1'        TO CP-EARNING-METHOD
  1870                   GO TO 1050-R78-REF.
  1871
  1872 SKIP-CSO-TX-VA-AH-PROCESSING.
  1873
  1874     IF CP-EARN-BY-PRORATA
  1875         GO TO 1040-PR-REF.
  1876
  1877     IF CP-EARN-BY-R78
  1878         GO TO 1050-R78-REF.
  1879
  1880     IF CP-EARN-AS-MEAN
  1881        GO TO 1055-MEAN-REF.
  1882
  1883     IF CP-EARN-AS-SUM-OF-DIGITS
  1884         GO TO 1075-SUM-OF-DIGITS.
  1885
  1886     IF CP-DCC-SPP-DDF
  1887        GO TO 1080-DCC-DDF-SPECIAL
  1888     END-IF
  1889
  1890     IF CP-EARN-AS-CALIF
  1891         GO TO 1060-ANTICIPATION-REF.
  1892
  1893     IF CP-EARN-ANTICIPATION
  1894         GO TO 1060-ANTICIPATION-REF.
  1895
  1896     IF CP-EARN-AS-NET-PAY
  1897         GO TO 1070-NET-PAY-REFUND.
  1898
  1899     GO TO 1050-R78-REF.
  1900
  1901*---------------------------------------------------------------
  1902 1035-REF-AH-CRITICAL-PERIOD.
  1903     IF CP-REMAINING-TERM GREATER +6
  1904        COMPUTE CP-CALC-REFUND ROUNDED =
  1905          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1906                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1907      ELSE
  1908        COMPUTE CP-CALC-REFUND ROUNDED =
  1909          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1910                                           CP-REMAINING-TERM + 1)
  1911                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1912
  1913     IF CP-CALC-REFUND LESS ZERO
  1914         MOVE ZERO TO CP-CALC-REFUND.
  1915
  1916     GO TO 1999-CALC-REF-AMT-X.
  1917
  1918*---------------------------------------------------------------
  1919 1040-PR-REF.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  38
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1920     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1921     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1922
  1923     GO TO 1999-CALC-REF-AMT-X.
  1924
  1925*---------------------------------------------------------------
  1926 1050-R78-REF.
  1927     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1928     COMPUTE CP-CALC-REFUND ROUNDED =
  1929           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1930
  1931     GO TO 1999-CALC-REF-AMT-X.
  1932
  1933*---------------------------------------------------------------
  1934 1055-MEAN-REF.
  1935     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1936     COMPUTE CP-CALC-REFUND ROUNDED =
  1937         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1938          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1939
  1940     GO TO 1999-CALC-REF-AMT-X.
  1941
  1942*---------------------------------------------------------------
  1943 1060-ANTICIPATION-REF.
  1944     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1945
  1946     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1947     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1948     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1949
  1950     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1951                               CP-LOAN-TERM.
  1952     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1953
  1954     PERFORM 2500-GET-RATE.
  1955
  1956     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1957     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1958
  1959     IF CP-PREMIUM-RATE = ZEROS
  1960        MOVE '7'                 TO CP-RETURN-CODE
  1961        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1962        GO TO 1999-CALC-REF-AMT-X.
  1963
  1964     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1965
  1966     PERFORM 2500-GET-RATE.
  1967
  1968     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1969
  1970     IF CP-PREMIUM-RATE = ZEROS
  1971        MOVE '7'            TO CP-RETURN-CODE
  1972        GO TO 1999-CALC-REF-AMT-X.
  1973
  1974     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1975
  1976     IF  WS-ORIG-PREM = ZERO
  1977         MOVE ZERO                TO WS-NP-REF-FACTOR
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  39
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  1978        ELSE
  1979         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1980                                            WS-ORIG-PREM.
  1981
  1982     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1983                                        CP-ORIGINAL-PREMIUM.
  1984
  1985     IF NOT CP-EARN-AS-CALIF
  1986         GO TO 1999-CALC-REF-AMT-X.
  1987
  1988*---------------------------------------------------------------
  1989 1065-CALIF-REGS.
  1990     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1991     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1992         GIVING FACTOR-5.
  1993
  1994     IF FACTOR-5 NOT GREATER +6  AND
  1995        CP-CLASS-CODE = 'A '
  1996         GO TO 1050-R78-REF.
  1997
  1998     IF FACTOR-5 = ZERO
  1999         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  2000         GO TO 1999-CALC-REF-AMT-X.
  2001
  2002     IF CP-ORIGINAL-TERM LESS +014
  2003         GO TO 1999-CALC-REF-AMT-X.
  2004
  2005     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  2006                                   GIVING FACTOR-5 ROUNDED.
  2007
  2008     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  2009
  2010     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  2011                                   GIVING FACTOR-2 ROUNDED.
  2012
  2013     SUBTRACT FACTOR-2 FROM FACTOR-1.
  2014     ADD +0.099375 TO FACTOR-1.
  2015
  2016     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  2017                                   GIVING FACTOR-5 ROUNDED.
  2018
  2019     SUBTRACT +1.00 FROM FACTOR-5.
  2020
  2021     IF CP-ORIGINAL-TERM LESS +049
  2022         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  2023                                   GIVING FACTOR-6 ROUNDED
  2024     ELSE
  2025         MOVE +035 TO FACTOR-6.
  2026
  2027     MOVE +001 TO FACTOR-2.
  2028
  2029     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  2030     SUBTRACT FACTOR-4 FROM FACTOR-2.
  2031     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  2032     MOVE +001 TO FACTOR-2.
  2033     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  2034
  2035     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  40
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2036         GIVING CAL-RFND ROUNDED.
  2037
  2038     IF CAL-RFND LESS +0.01
  2039         MOVE ZEROS TO CAL-RFND.
  2040
  2041     IF CAL-RFND LESS CP-CALC-REFUND
  2042         MOVE CAL-RFND TO CP-CALC-REFUND.
  2043
  2044     GO TO 1999-CALC-REF-AMT-X.
  2045
  2046*-----------------------------------------------------------------
  2047 1070-NET-PAY-REFUND.
  2048     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  2049     IF CP-LOAN-APR = ZERO
  2050         MOVE ZEROS              TO  CP-CALC-REFUND
  2051         MOVE '1'                TO  CP-RETURN-CODE
  2052         GO TO 1999-CALC-REF-AMT-X.
  2053
  2054     MOVE CP-LOAN-APR            TO  N-P-APR.
  2055     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  2056     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  2057
  2058     MOVE 'R'                    TO  N-P-OPT.
  2059
  2060     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  2061
  2062     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  2063                                        CP-ORIGINAL-PREMIUM.
  2064
  2065     GO TO 1999-CALC-REF-AMT-X.
  2066*---------------------------------------------------------------
  2067
  2068 1075-SUM-OF-DIGITS.
  2069
  2070     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2071
  2072     COMPUTE RSUM-REMAINING-TERM =
  2073             CP-LOAN-TERM -
  2074                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2075
  2076     COMPUTE RSUM-FACTOR =
  2077        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2078               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2079                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2080            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2081               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2082                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2083
  2084     COMPUTE CP-CALC-REFUND ROUNDED =
  2085           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2086
  2087     GO TO 1999-CALC-REF-AMT-X
  2088
  2089     .
  2090 1080-DCC-DDF-SPECIAL.
  2091
  2092     COMPUTE CP-MONTH =
  2093        FUNCTION REM(CP-ORIGINAL-TERM - CP-REMAINING-TERM, 12)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  41
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2094*    DISPLAY ' BEGIN ELCRFNDP ************** '
  2095*    DISPLAY ' SPEC       ' CP-DDF-SPEC-CALC
  2096*    DISPLAY ' MONTH      ' CP-MONTH
  2097*    DISPLAY ' ORIG TERM  ' CP-ORIGINAL-TERM
  2098*    DISPLAY ' REM TERM   ' CP-REMAINING-TERM
  2099*    DISPLAY ' ORIG PREM  ' CP-ORIGINAL-PREMIUM
  2100*    DISPLAY ' 1YR EXP AL ' CP-1ST-YR-ALLOW
  2101*    DISPLAY ' HI FACT    ' CP-DDF-HI-FACT
  2102*    DISPLAY ' LO FACT    ' CP-DDF-LO-FACT
  2103*    DISPLAY ' RATE UP    ' CP-IU-RATE-UP
  2104*    DISPLAY ' CLP RAT UP ' CP-CLP-RATE-UP
  2105*    DISPLAY ' EARM METH  ' CP-EARNING-METHOD
  2106*    DISPLAY '   END ELCRFNDP ************** '
  2107
  2108     IF CP-MONTH = 0
  2109        MOVE 12                  TO CP-MONTH
  2110     END-IF
  2111     MOVE CP-MONTH               TO WS-MONTH
  2112
  2113     MOVE 'D'                    TO CP-REFUND-TYPE-USED
  2114
  2115     IF CP-DCC-SPP-DDF-IU
  2116        GO TO 1090-DCC-DDF-IU
  2117     END-IF
  2118
  2119     IF CP-CALC-CLP
  2120        GO TO 1085-DCC-DDF-SPECIAL-CLP
  2121     END-IF
  2122
  2123     EVALUATE TRUE
  2124        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2125           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2126           MOVE CP-ORIGINAL-PREMIUM
  2127                                 TO CP-CALC-REFUND
  2128
  2129        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2130           MOVE CP-MONTH         TO WS-MONTH
  2131           PERFORM 1150-UE-GROSS-LT-4
  2132           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2133
  2134        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2135           MOVE CP-MONTH         TO WS-MONTH
  2136           PERFORM 1160-UE-GROSS-LT-13
  2137           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2138
  2139        WHEN OTHER
  2140           MOVE CP-MONTH         TO WS-MONTH
  2141           PERFORM 1170-UE-GROSS-GT-12
  2142           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2143     END-EVALUATE
  2144
  2145     GO TO 1999-CALC-REF-AMT-X
  2146
  2147     .
  2148 1085-DCC-DDF-SPECIAL-CLP.
  2149
  2150     EVALUATE TRUE
  2151        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  42
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2152           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2153           MOVE CP-ORIGINAL-PREMIUM
  2154                                 TO CP-CALC-REFUND
  2155
  2156        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2157           MOVE CP-MONTH         TO WS-MONTH
  2158           PERFORM 1100-UE-CLP-LT-4
  2159           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2160
  2161        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2162           MOVE CP-MONTH         TO WS-MONTH
  2163           PERFORM 1110-UE-CLP-LT-13
  2164           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2165
  2166        WHEN OTHER
  2167           MOVE CP-MONTH         TO WS-MONTH
  2168           PERFORM 1120-UE-CLP-GT-12
  2169           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2170     END-EVALUATE
  2171
  2172     GO TO 1999-CALC-REF-AMT-X
  2173
  2174     .
  2175 1090-DCC-DDF-IU.
  2176
  2177     MOVE 'I'                    TO CP-REFUND-TYPE-USED
  2178
  2179     IF CP-CALC-CLP
  2180        GO TO 1095-DCC-DDF-IU-SPECIAL-CLP
  2181     END-IF
  2182
  2183     EVALUATE TRUE
  2184        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2185           OR (CP-ORIGINAL-PREMIUM = ZEROS)
  2186           MOVE CP-ORIGINAL-PREMIUM
  2187                                 TO CP-CALC-REFUND
  2188
  2189        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2190           MOVE CP-MONTH         TO WS-MONTH
  2191           PERFORM 1250-IU-UE-GROSS-LT-4
  2192           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2193
  2194        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2195           MOVE CP-MONTH         TO WS-MONTH
  2196           PERFORM 1260-IU-UE-GROSS-LT-13
  2197           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2198
  2199        WHEN OTHER
  2200           MOVE CP-MONTH         TO WS-MONTH
  2201           PERFORM 1270-IU-UE-GROSS-GT-12
  2202           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2203
  2204     END-EVALUATE
  2205
  2206     GO TO 1999-CALC-REF-AMT-X
  2207
  2208     .
  2209 1095-DCC-DDF-IU-SPECIAL-CLP.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  43
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2210
  2211     EVALUATE TRUE
  2212        WHEN ((CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 1)
  2213           OR (CP-DDF-CLP = ZEROS)
  2214           MOVE CP-DDF-CLP       TO CP-CALC-REFUND
  2215
  2216        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 4
  2217           MOVE CP-MONTH         TO WS-MONTH
  2218           PERFORM 1200-IU-UE-CLP-LT-4
  2219           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2220
  2221        WHEN (CP-ORIGINAL-TERM - CP-REMAINING-TERM) < 13
  2222           MOVE CP-MONTH         TO WS-MONTH
  2223           PERFORM 1210-IU-UE-CLP-LT-13
  2224           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2225
  2226        WHEN OTHER
  2227           MOVE CP-MONTH         TO WS-MONTH
  2228           PERFORM 1220-IU-UE-CLP-GT-12
  2229           COMPUTE CP-CALC-REFUND ROUNDED = WS-TEMP-RESULT * 1
  2230
  2231     END-EVALUATE
  2232
  2233     GO TO 1999-CALC-REF-AMT-X
  2234
  2235     .
  2236 1100-UE-CLP-LT-4.
  2237
  2238*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*mo/12}
  2239
  2240     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2241        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2242        / CP-DDF-CLP - CP-DDF-HI-FACT)
  2243        * WS-MONTH / 12)
  2244
  2245     .
  2246 1110-UE-CLP-LT-13.
  2247
  2248*****  (CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12}
  2249*****  -[(CLP-Yr1 Exp)-CLP*{((CLP-Yr1 Exp)/CLP - UEF1)*3/12
  2250*****  -CLP*UEF1}*(mo-3)/9]
  2251
  2252     COMPUTE WS-TEMP-RESULT ROUNDED = (CP-DDF-CLP - 0)
  2253        - CP-DDF-CLP * (((CP-DDF-CLP - 0)
  2254        / CP-DDF-CLP - CP-DDF-HI-FACT) * 3 / 12)
  2255        -  ((CP-DDF-CLP - 0) - CP-DDF-CLP
  2256        * (((CP-DDF-CLP - 0) / CP-DDF-CLP
  2257        - CP-DDF-HI-FACT) * 3 / 12) - CP-DDF-CLP
  2258        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2259
  2260     .
  2261 1120-UE-CLP-GT-12.
  2262
  2263*****  CLP * {UEF1 - (UEF1 -UEF2)*mo/12}
  2264
  2265     COMPUTE WS-TEMP-RESULT ROUNDED = CP-DDF-CLP *
  2266        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2267        * WS-MONTH / 12)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  44
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2268
  2269     .
  2270 1150-UE-GROSS-LT-4.
  2271
  2272     COMPUTE CP-1ST-YR-ALLOW = CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2273     COMPUTE WS-TEMP-RESULT ROUNDED =
  2274        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF
  2275        * WS-MONTH / 3) - (CP-ORIGINAL-PREMIUM -
  2276        CP-1ST-YR-ALLOW - CP-DDF-YR1AF) * (1 - CP-DDF-HI-FACT)
  2277        * WS-MONTH / 12
  2278
  2279     .
  2280 1160-UE-GROSS-LT-13.
  2281
  2282     MOVE 3                      TO WS-MONTH
  2283     PERFORM 1150-UE-GROSS-LT-4
  2284     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2285     MOVE CP-MONTH               TO WS-MONTH
  2286     COMPUTE WS-TEMP-RESULT ROUNDED = WS-GFR3 - (WS-GFR3
  2287        - (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW - CP-DDF-YR1AF)
  2288        * (CP-DDF-HI-FACT)) * ((WS-MONTH - 3) / 9)
  2289
  2290     .
  2291 1170-UE-GROSS-GT-12.
  2292
  2293*****  (GF-Yr1 Texp) * {UEF1 - (UEF1 -UEF2)*mo/12}
  2294
  2295     COMPUTE WS-TEMP-RESULT ROUNDED =
  2296        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW)
  2297        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2298        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2299
  2300     .
  2301 1200-IU-UE-CLP-LT-4.
  2302
  2303*****  no changes with < 4  pema 08/03/11
  2304*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*mo/12)
  2305
  2306     COMPUTE WS-TEMP-RESULT ROUNDED =
  2307        (CP-DDF-CLP - 0)
  2308        - (CP-DDF-CLP - CP-CLP-RATE-UP)
  2309        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2310        * WS-MONTH / 12
  2311
  2312     .
  2313 1210-IU-UE-CLP-LT-13.
  2314
  2315
  2316*****  (CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2317*****  -[(CLPCounty-Yr1 Exp)-(CLP*(UEF1 - UEF2)*3/12)
  2318*****  - CLP*UEF1]*(mo-3)/9
  2319
  2320     MOVE 3                      TO WS-MONTH
  2321     PERFORM 1200-IU-UE-CLP-LT-4
  2322     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2323     MOVE CP-MONTH               TO WS-MONTH
  2324     COMPUTE WS-TEMP-RESULT ROUNDED =
  2325        WS-UE-CLP - (WS-UE-CLP - (CP-DDF-CLP - CP-CLP-RATE-UP)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  45
* ELRFNDX.cbl (/apps/test/cid1s/copy/ELCRFNDP)
  2326          * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2327
  2328     .
  2329 1220-IU-UE-CLP-GT-12.
  2330
  2331*****  CLP*{UEF1 - (UEF1 -UEF2)*mo/12}
  2332
  2333     COMPUTE WS-TEMP-RESULT ROUNDED =
  2334        (CP-DDF-CLP - CP-CLP-RATE-UP)
  2335        * (CP-DDF-HI-FACT - (CP-DDF-HI-FACT
  2336        - CP-DDF-LO-FACT) * WS-MONTH / 12)
  2337
  2338     .
  2339 1250-IU-UE-GROSS-LT-4.
  2340
  2341*****  (Comm+MngtFee)*UECLPmo/CLPCounty+CLPCounty+AdminFee-
  2342*****  Yr1 AF*(mo/3)-[CLP*(UEF1-UEF2)+(AdminFee-Yr1AF)*
  2343*****  (1-UEF1)]*mo/12
  2344
  2345     PERFORM 1200-IU-UE-CLP-LT-4
  2346     COMPUTE WS-UE-CLP ROUNDED = WS-TEMP-RESULT * 1
  2347
  2348     COMPUTE WS-TEMP-RESULT = CP-DDF-COMM-AND-MFEE *
  2349        WS-UE-CLP / CP-DDF-CLP + CP-DDF-CLP +
  2350        CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF *
  2351        WS-MONTH / 3 - ((CP-DDF-CLP - CP-CLP-RATE-UP)
  2352        * (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2353        + (CP-DDF-CSO-ADMIN-FEE - CP-DDF-YR1AF)
  2354        * (1 - CP-DDF-HI-FACT)) * WS-MONTH / 12
  2355
  2356     .
  2357 1260-IU-UE-GROSS-LT-13.
  2358
  2359***** uegf3-(uegf3-(gf - 1st yr - clprateu)*hi))*(mo-3)/9
  2360
  2361     MOVE 3                      TO WS-MONTH
  2362     PERFORM 1250-IU-UE-GROSS-LT-4
  2363     move cp-month               to ws-month
  2364     COMPUTE WS-GFR3 ROUNDED = WS-TEMP-RESULT * 1
  2365     COMPUTE WS-TEMP-RESULT ROUNDED =
  2366        WS-GFR3 - (WS-GFR3 - ((CP-ORIGINAL-PREMIUM
  2367        - CP-1ST-YR-ALLOW - cp-clp-rate-up))
  2368        * CP-DDF-HI-FACT) * (WS-MONTH - 3) / 9
  2369
  2370     .
  2371 1270-IU-UE-GROSS-GT-12.
  2372
  2373***** (gf - 1st yr - clprateu)*(hi-(hi-lo)*mo/12)
  2374
  2375     COMPUTE WS-TEMP-RESULT ROUNDED =
  2376        (CP-ORIGINAL-PREMIUM - CP-1ST-YR-ALLOW
  2377        - CP-CLP-RATE-UP) *
  2378        (CP-DDF-HI-FACT - (CP-DDF-HI-FACT - CP-DDF-LO-FACT)
  2379        * WS-MONTH / 12)
  2380
  2381     .
  2382 1299-END-DDF-CALCS.
  2383     .
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  46
* ELRFNDX.cbl
  2384 1999-CALC-REF-AMT-X.
  2385     GOBACK.
  2386
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  47
* ELRFNDX.cbl
  2388 2500-GET-RATE.
  2389     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  2390
  2391 2500-EXIT.
  2392      EXIT.
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  48
* ELRFNDX.cbl
  2394
  2395 9100-CONVERT-DATE.
  2396     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  2397
  2398 9100-EXIT.
  2399      EXIT.
  2400
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  49
* ELRFNDX.cbl
  2402 10000-NET-TERM SECTION.
* 2403                             COPY ERCNETP.
  2404***************************************************************** 04/29/98
  2405*                                                               * ERCNETP
  2406*                            ERCNETP                            *    LV006
  2407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  2408*                            VMOD=2.029                         *    CL**3
  2409*                                                               * ERCNETP
  2410*****************************************************************.ERCNETP
  2411*                                                                 ERCNETP
  2412*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  2413*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  2414*                                   ORIGINAL TERM (S999)          ERCNETP
  2415*                                   REMAINING TERM (S999)         ERCNETP
  2416*                                   NET PAY OPTION (X)            ERCNETP
  2417*                                   LOAN TERM (S999)              ERCNETP
  2418*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  2419*                                                                 ERCNETP
  2420*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  2421*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  2422*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  2423*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  2424*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  2425*    CHARGED.                                                     ERCNETP
  2426*                                                                 ERCNETP
  2427*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  2428*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  2429*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  2430*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  2431*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  2432*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  2433*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  2434*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  2435*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  2436*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  2437*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  2438*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  2439******************************************************************
  2440*                   C H A N G E   L O G
  2441*
  2442* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2443*-----------------------------------------------------------------
  2444*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2445* EFFECTIVE    NUMBER
  2446*-----------------------------------------------------------------
  2447* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2448* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2449* 120403                   PEMA  ADD SPECIAL TX CALC
  2450* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2451* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2452* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2453* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2454* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2455* 021207                   PEMA  ADD PA NP
  2456* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2457* 032807                   PEMA  ADD VT NP PLUS 2
  2458* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2459* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  50
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2460* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2461* 110207      TO 'AL' NET PAY CALC
  2462* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2463* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2464* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2465* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2466* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2467* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2468* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2469* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2470* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2471* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2472* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2473* 032612  CR2011110200001  PEMA  AHL CHANGES
  2474* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2475* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2476* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2477* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  2478* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOONS
  2479* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  2480* 021519  CR2019021100001  PEMA  non-monthly AL calcs
  2481* 012820  CR2020010600001  PEMA  MOD TX NP FORMULA TO HANDLE TRUNC
  2482* 012820    CONTINUED   AND TO ADJ AF FOR EXTRA DAYS.
  2483******************************************************************
  2484                                                                  ERCNETP
  2485     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  2486     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  2487     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  2488     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  2489     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  2490                                                                  ERCNETP
  2491     MOVE +0 TO FACTOR.                                           ERCNETP
  2492
  2493     if cp-company-id = 'CID'
  2494        if annual-int-rate = +99.9999
  2495           go to 99000-error
  2496        end-if
  2497     else
  2498        if annual-int-rate = zero
  2499           go to 99000-error
  2500        end-if
  2501     end-if
  2502
  2503     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  2504         GO TO 99999-RETURN.                                      ERCNETP
  2505     IF REMAINING-TERM = ZERO                                     ERCNETP
  2506         GO TO 99999-RETURN.                                      ERCNETP
  2507     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  2508         GO TO 99000-ERROR.                                       ERCNETP
  2509     IF LOAN-TERM = ZERO                                          ERCNETP
  2510         GO TO 99999-RETURN.                                      ERCNETP
  2511     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  2512         GO TO 99000-ERROR.                                       ERCNETP
  2513                                                                  ERCNETP
  2514*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2515*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2516*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2517*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  51
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2518*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2519*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2520                                                                  ERCNETP
  2521     IF NPO-REFUND                                                ERCNETP
  2522         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  2523       ELSE                                                       ERCNETP
  2524         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  2525            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  2526           ELSE                                                   ERCNETP
  2527            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  2528                                                                  ERCNETP
  2529     IF NPO-SIMPLE                                                ERCNETP
  2530         MOVE 'S' TO TYPE-SW                                      ERCNETP
  2531     ELSE                                                         ERCNETP
  2532         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  2533                                                                  ERCNETP
  2534     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  2535     if i = zeros
  2536        move .0000000001         to i
  2537     end-if
  2538                                                                  ERCNETP
  2539     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  2540                                                                  ERCNETP
  2541     MOVE V     TO VX                                             ERCNETP
  2542                   SV.                                            ERCNETP
  2543                                                                  ERCNETP
  2544     MOVE +1    TO X1                                             ERCNETP
  2545                   SX.                                            ERCNETP
  2546                                                                  ERCNETP
  2547     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  2548                                                                  ERCNETP
  2549     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  2550                                                                  ERCNETP
  2551     IF MAX-X = +1                                                ERCNETP
  2552        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  2553                                                                  ERCNETP
  2554     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  2555                                                                  ERCNETP
  2556     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  2557         OR 'DCC' or 'VPP' OR 'NCL') AND
  2558        (NOT NP-REFUND)                                           ERCNETP
  2559        NEXT SENTENCE                                             ERCNETP
  2560     ELSE                                                         ERCNETP
  2561     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  2562        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  2563                                                                  ERCNETP
  2564     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  2565                                                                  ERCNETP
  2566 10500-VX-LOOP.                                                   ERCNETP
  2567                                                                  ERCNETP
  2568***  VX = AMORT. LOAN TERM.                                       ERCNETP
  2569***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  2570***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  2571***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  2572***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  2573                                                                  ERCNETP
  2574     IF X2 = 1
  2575        MOVE V         TO SX
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  52
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2576     END-IF
  2577     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  2578                                                                  ERCNETP
  2579     ADD B1 TO X1.                                                ERCNETP
  2580                                                                  ERCNETP
  2581     IF X1 = REMAINING-TERM                                       ERCNETP
  2582          MOVE VX    TO SV.                                       ERCNETP
  2583                                                                  ERCNETP
  2584     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  2585        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  2586                                                                  ERCNETP
  2587     IF X1 = X2                                                   ERCNETP
  2588          MOVE VX    TO SX.                                       ERCNETP
  2589                                                                  ERCNETP
  2590     IF X1 NOT = MAX-X                                            ERCNETP
  2591          GO TO 10500-VX-LOOP.                                    ERCNETP
  2592                                                                  ERCNETP
  2593 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  2594*****  WK1 = LOAN TERM AMORT
  2595     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  2596*****  WK2 = INS TERM AMORT
  2597     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  2598*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2599     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  2600*****  WK6 = INS TERM - 1
  2601     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  2602                                                                  ERCNETP
  2603     IF NP-RATING                                                 ERCNETP
  2604         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  2605                                                                  ERCNETP
  2606     IF NP-REFUND                                                 ERCNETP
  2607         GO TO 11000-REFUND-CALC.                                 ERCNETP
  2608                                                                  ERCNETP
  2609     IF NET-STD                                                   ERCNETP
  2610         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  2611                                                                  ERCNETP
  2612     IF NET-SMP                                                   ERCNETP
  2613         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  2614         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  2615         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  2616         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  2617                                                                  ERCNETP
  2618     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  2619         MOVE +0 TO WK3.                                          ERCNETP
  2620                                                                  ERCNETP
  2621     MOVE WK3 TO FACTOR.                                          ERCNETP
  2622                                                                  ERCNETP
  2623     GO TO 99999-RETURN.                                          ERCNETP
  2624                                                                  ERCNETP
  2625 11000-REFUND-CALC.                                               ERCNETP
  2626     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  2627        MOVE +1 TO FACTOR                                         ERCNETP
  2628        GO TO 99999-RETURN.                                       ERCNETP
  2629                                                                  ERCNETP
  2630     IF REMAINING-TERM LESS +1                                    ERCNETP
  2631        MOVE 0 TO FACTOR                                          ERCNETP
  2632        GO TO 99999-RETURN.                                       ERCNETP
  2633                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  53
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2634     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  2635     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  2636     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  2637                                                                  ERCNETP
  2638     IF (CP-COMPANY-ID EQUAL 'CID')
  2639        AND (CP-STATE-STD-ABBRV = 'MN')
  2640        AND (CP-CERT-EFF-DT > X'A4FF')
  2641        AND (CP-RATE-AS-REG-BALLOON)
  2642        AND (CP-EARN-AS-NET-PAY)
  2643        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2644        CONTINUE
  2645     ELSE
  2646        GO TO 11000-CHECK-MN-LEV-BALLOON
  2647     END-IF
  2648
  2649     COMPUTE R = M - E
  2650     COMPUTE FACTOR = (R - WK2 + WK5) /
  2651        (M - WK1 + WK5)
  2652
  2653     GO TO 99999-RETURN
  2654
  2655      .
  2656 11000-CHECK-MN-LEV-BALLOON.
  2657
  2658     IF (CP-COMPANY-ID EQUAL 'CID')
  2659        AND (CP-STATE-STD-ABBRV = 'MN')
  2660        AND (CP-CERT-EFF-DT > X'A4FF')
  2661        AND (CP-RATE-AS-REG-BALLOON)
  2662        AND (CP-EARN-AS-NET-PAY)
  2663        AND (CP-DEVIATION-CODE = 'LEV')
  2664        CONTINUE
  2665     ELSE
  2666        GO TO 11000-CONTINUE-REFUND
  2667     END-IF
  2668
  2669     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2670     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2671        ** (M - E)) / I
  2672
  2673     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2674
  2675     GO TO 99999-RETURN
  2676
  2677     .
  2678 11000-CONTINUE-REFUND.
  2679
  2680*    IF CP-GAP-ACTUARIAL
  2681*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2682*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2683*       COMPUTE WK3 = WK2 / ANGLEN
  2684*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2685
  2686     IF CP-GAP-ACTUARIAL
  2687        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2688           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2689        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2690     ELSE
  2691        COMPUTE WK3 ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  54
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2692          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2693     END-IF
  2694                                                                  ERCNETP
  2695     MOVE WK3  TO FACTOR.                                         ERCNETP
  2696                                                                  ERCNETP
  2697     GO TO 99999-RETURN.                                          ERCNETP
  2698                                                                  ERCNETP
  2699 12000-PREMIUM-RATE.                                              ERCNETP
  2700*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  2701*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  2702*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  2703*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  2704*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  2705*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  2706                                                                  ERCNETP
  2707     COMPUTE K-I = K1 + I.                                        ERCNETP
  2708     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  2709                                                                  ERCNETP
  2710     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  2711         MOVE K1 TO K-I.                                          ERCNETP
  2712                                                                  ERCNETP
  2713     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  2714         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  2715                                                                  ERCNETP
  2716     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  2717         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  2718                                                                  ERCNETP
  2719     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  2720         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  2721                                                                  ERCNETP
  2722     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  2723             ((X2 * (X2 + 1)) /                                   ERCNETP
  2724              (N *  (N  + 1))).                                   ERCNETP
  2725                                                                  ERCNETP
  2726     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  2727        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  2728        NEXT SENTENCE                                             ERCNETP
  2729     ELSE                                                         ERCNETP
  2730        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  2731                                                                  ERCNETP
  2732     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  2733     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  2734     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2735                                                                  ERCNETP
  2736     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2737        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2738        MOVE ZEROS               TO FACTOR                        ERCNETP
  2739                                    CP-CALC-PREMIUM               ERCNETP
  2740         GO TO 99999-RETURN.                                      ERCNETP
  2741                                                                  ERCNETP
  2742     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  2743     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  2744     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  2745     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2746                                                                  ERCNETP
  2747     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2748        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2749        MOVE ZEROS               TO FACTOR                        ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  55
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2750                                    CP-CALC-PREMIUM               ERCNETP
  2751         GO TO 99999-RETURN.                                      ERCNETP
  2752                                                                  ERCNETP
  2753     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
  2754                                                                  ERCNETP
  2755     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  2756                                                                  ERCNETP
  2757     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  2758        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2759        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  2760     ELSE                                                         ERCNETP
  2761        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2762        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  2763                                                                  ERCNETP
  2764     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  2765     13).                                                         ERCNETP
  2766                                                                  ERCNETP
  2767     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  2768     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  2769                                                                  ERCNETP
  2770     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  2771                                                                  ERCNETP
  2772     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  2773       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  2774                                                                  ERCNETP
  2775     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  2776       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  2777       WS-CALC-FREQ-RATE).                                        ERCNETP
  2778                                                                  ERCNETP
  2779     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  2780       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  2781                                                                  ERCNETP
  2782     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  2783       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  2784                                                                  ERCNETP
  2785     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  2786       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  2787       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  2788                                                                  ERCNETP
  2789     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  2790                                                                  ERCNETP
  2791     GO TO 99999-RETURN.                                          ERCNETP
  2792                                                                  ERCNETP
  2793 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  2794                                                                  ERCNETP
  2795     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  2796        NEXT SENTENCE                                             ERCNETP
  2797     ELSE                                                         ERCNETP
  2798        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  2799                                                                  ERCNETP
  2800      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2801                                                                  ERCNETP
  2802      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2803                                                                  ERCNETP
  2804      COMPUTE WK3 EQUAL                                           ERCNETP
  2805        (12 *                                                     ERCNETP
  2806        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  2807        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  56
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2808        APR100.                                                   ERCNETP
  2809                                                                  ERCNETP
  2810     COMPUTE WK3 EQUAL                                            ERCNETP
  2811        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
  2812                                                                  ERCNETP
  2813     COMPUTE WK3 EQUAL                                            ERCNETP
  2814        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  2815                                                                  ERCNETP
  2816      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2817                                                                  ERCNETP
  2818     GO TO 99999-RETURN.                                          ERCNETP
  2819                                                                  ERCNETP
  2820 12000-CHECK-CLIENT.                                              ERCNETP
  2821                                                                  ERCNETP
  2822     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  2823        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2824        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2825        NEXT SENTENCE                                             ERCNETP
  2826     ELSE                                                         ERCNETP
  2827        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  2828                                                                  ERCNETP
  2829     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2830                                                                  ERCNETP
  2831     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2832     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2833                                                                  ERCNETP
  2834     COMPUTE FM EQUAL                                             ERCNETP
  2835                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  2836                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  2837                    - 1.                                          ERCNETP
  2838                                                                  ERCNETP
  2839     COMPUTE FN EQUAL                                             ERCNETP
  2840                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  2841                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  2842                    - 1.                                          ERCNETP
  2843                                                                  ERCNETP
  2844     COMPUTE FNM EQUAL                                            ERCNETP
  2845                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  2846                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  2847                    - 1.                                          ERCNETP
  2848                                                                  ERCNETP
  2849     COMPUTE GR EQUAL                                             ERCNETP
  2850                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  2851                    (M - ANGLEM).                                 ERCNETP
  2852                                                                  ERCNETP
  2853     COMPUTE ODF EQUAL                                            ERCNETP
  2854                     (1 +                                         ERCNETP
  2855                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  2856                     360)) /                                      ERCNETP
  2857                     ONE-PLUS-I.                                  ERCNETP
  2858                                                                  ERCNETP
  2859     COMPUTE OD EQUAL                                             ERCNETP
  2860                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  2861                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  2862                                                                  ERCNETP
  2863     COMPUTE WK3 EQUAL                                            ERCNETP
  2864*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  2865                    ((1 + FN) * ODF *                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  57
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2866                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  2867                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  2868                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  2869                                                                  ERCNETP
  2870     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  2871     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  2872                                                                  ERCNETP
  2873     COMPUTE WK3 EQUAL                                            ERCNETP
  2874                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  2875*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  2876                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  2877                                                                  ERCNETP
  2878      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2879                                                                  ERCNETP
  2880     GO TO 99999-RETURN.                                          ERCNETP
  2881                                                                  ERCNETP
  2882 12000-CHECK-NEXT.                                                ERCNETP
  2883                                                                  ERCNETP
  2884     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  2885        NEXT SENTENCE                                             ERCNETP
  2886     ELSE                                                         ERCNETP
  2887        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  2888                                                                  ERCNETP
  2889      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  2890         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  2891         MOVE ZEROS              TO FACTOR                        ERCNETP
  2892                                    CP-CALC-PREMIUM               ERCNETP
  2893         GO TO 99999-RETURN.                                      ERCNETP
  2894                                                                  ERCNETP
  2895      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2896                                                                  ERCNETP
  2897      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2898                                                                  ERCNETP
  2899      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  2900         ADD .00001 TO APR100.                                    ERCNETP
  2901                                                                  ERCNETP
  2902      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  2903      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  2904                                                                  ERCNETP
  2905
  2906
  2907     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2908        / (1 + I)
  2909     COMPUTE ANGLEN-1 = ANGLEN / Y
  2910
  2911      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  2912         COMPUTE WK3 EQUAL                                        ERCNETP
  2913                                                                  ERCNETP
  2914          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  2915          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  2916                                                                  ERCNETP
  2917          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2918                                                                  ERCNETP
  2919          ((WK8 ** N) /                                           ERCNETP
  2920          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2921                                                                  ERCNETP
  2922          ((WK9 ** N) /                                           ERCNETP
  2923          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  58
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2924                                                                  ERCNETP
  2925      ELSE                                                        ERCNETP
  2926         COMPUTE WK3 EQUAL                                        ERCNETP
  2927                                                                  ERCNETP
  2928          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2929          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  2930                                                                  ERCNETP
  2931          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2932                                                                  ERCNETP
  2933          ((WK8 ** N) /                                           ERCNETP
  2934          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2935                                                                  ERCNETP
  2936          ((WK9 ** N) /                                           ERCNETP
  2937          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  2938                                                                  ERCNETP
  2939      COMPUTE WK3 EQUAL                                           ERCNETP
  2940          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  2941                                                                  ERCNETP
  2942      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2943                                                                  ERCNETP
  2944     GO TO 99999-RETURN.                                          ERCNETP
  2945                                                                  ERCNETP
  2946 12000-CHECK-PA-TRUNC.                                            ERCNETP
  2947                                                                  ERCNETP
  2948     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2949        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  2950        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2951        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2952        NEXT SENTENCE                                             ERCNETP
  2953     ELSE                                                         ERCNETP
  2954        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  2955                                                                  ERCNETP
  2956     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2957                                                                  ERCNETP
  2958     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2959     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2960                                                                  ERCNETP
  2961     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2962                                                                  ERCNETP
  2963     COMPUTE WK3 EQUAL                                            ERCNETP
  2964        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  2965        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  2966                                                                  ERCNETP
  2967     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2968                                                                  ERCNETP
  2969     GO TO 99999-RETURN.                                          ERCNETP
  2970                                                                  ERCNETP
  2971 12000-CHECK-MD-TRUNC.                                            ERCNETP
  2972                                                                  ERCNETP
  2973     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2974        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2975        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2976        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2977        NEXT SENTENCE                                             ERCNETP
  2978     ELSE                                                         ERCNETP
  2979        GO TO 12000-CHECK-MD.                                     ERCNETP
  2980                                                                  ERCNETP
  2981     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  59
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2982                                                                  ERCNETP
  2983     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2984     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2985     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2986                                                                  ERCNETP
  2987     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2988                                                                  ERCNETP
  2989     COMPUTE WK3 EQUAL                                            ERCNETP
  2990        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  2991        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  2992        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  2993                                                                  ERCNETP
  2994     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2995                                                                  ERCNETP
  2996     GO TO 99999-RETURN.                                          ERCNETP
  2997                                                                  ERCNETP
  2998 12000-CHECK-MD.                                                  ERCNETP
  2999                                                                  ERCNETP
  3000     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3001        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  3002        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3003        NEXT SENTENCE                                             ERCNETP
  3004     ELSE                                                         ERCNETP
  3005        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  3006                                                                  ERCNETP
  3007     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  3008                                                                  ERCNETP
  3009     COMPUTE WK3 EQUAL                                            ERCNETP
  3010        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  3011                                                                  ERCNETP
  3012     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3013                                                                  ERCNETP
  3014     GO TO 99999-RETURN.                                          ERCNETP
  3015                                                                  ERCNETP
  3016 12000-CHECK-ME-TRUNC.                                            ERCNETP
  3017                                                                  ERCNETP
  3018     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  3019        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3020        AND (CP-EARN-AS-NET-PAY)
  3021        AND (CP-TRUNCATED-LIFE)
  3022        CONTINUE
  3023     ELSE
  3024        GO TO 12000-CHECK-CID-WA-FARMPLAN
  3025     END-IF
  3026                                                                  ERCNETP
  3027     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3028
  3029     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3030
  3031     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3032
  3033     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3034
  3035     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3036     COMPUTE ANGLEN-1 = ANGLEN / Y
  3037
  3038     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3039
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  60
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3040     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3041
  3042     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  3043
  3044     COMPUTE WK3
  3045        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  3046        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  3047            * (1 / (1.0635 ** (M / 12))))
  3048
  3049*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  3050*    COMPUTE WK9 EQUAL                                            ERCNETP
  3051*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  3052*    COMPUTE WK7 EQUAL                                            ERCNETP
  3053*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  3054*    COMPUTE WK3 EQUAL                                            ERCNETP
  3055*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  3056*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  3057*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  3058*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  3059*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  3060*                                                                 ERCNETP
  3061     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3062                                                                  ERCNETP
  3063     GO TO 99999-RETURN
  3064
  3065      .
  3066 12000-CHECK-CID-WA-FARMPLAN.
  3067
  3068     IF (CP-COMPANY-ID EQUAL 'CID')
  3069        AND (CP-STATE-STD-ABBRV = 'WA')
  3070        AND (CP-FARM-PLAN)
  3071        CONTINUE
  3072     ELSE
  3073        GO TO 12000-CHECK-CID-FARMPLAN
  3074     END-IF
  3075
  3076**  This was removed due to IR 2015022300001
  3077    GO TO 12000-CHECK-CID-FARMPLAN
  3078
  3079     move cp-original-term       to n
  3080     move cp-no-of-pmts          TO C-TOT-PMTS
  3081     compute c-pmts-per-year = 12 / cp-pay-frequency
  3082     move cp-pay-frequency       to m
  3083     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  3084     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3085     if i = zeros
  3086        move .0000000001         to i
  3087     end-if
  3088     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3089
  3090     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3091        (m * 30))) / (1 + I)
  3092     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3093        ** CP-PAY-FREQUENCY) - 1
  3094     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  3095     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3096        ** TI) / WS-WORK-DIS-RATE
  3097     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  61
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3098     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  3099     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3100        ** m) / WS-WORK-DIS-RATE
  3101     COMPUTE WK2 = WK2 * (1 + J)
  3102     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3103     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3104     COMPUTE WK3 = WK3 * (1 + J)
  3105     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  3106        ** (c-tot-pmts - 1))) / J
  3107     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3108        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  3109        (CP-PREMIUM-RATE / 1000)
  3110     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  3111     COMPUTE WK6 = (WK7 * GR)
  3112
  3113     MOVE WK6 TO CP-CALC-PREMIUM
  3114
  3115     GO TO 99999-RETURN
  3116
  3117     .
  3118 12000-CHECK-CID-FARMPLAN.
  3119
  3120     IF (CP-COMPANY-ID EQUAL 'CID')
  3121        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  3122           OR 'IN' OR 'AZ')
  3123        AND (CP-FARM-PLAN)
  3124        CONTINUE
  3125     ELSE
  3126        GO TO 12000-CHECK-CID-AL-FARMPLAN
  3127     END-IF
  3128
  3129     COMPUTE N = M / CP-PAY-FREQUENCY
  3130     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3131     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  3132        ** CP-PAY-FREQUENCY) - 1
  3133     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  3134     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3135        ** TI) / WS-WORK-DIS-RATE
  3136     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  3137     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  3138     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  3139        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  3140     COMPUTE WK2 = WK2 * (1 + J)
  3141     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  3142     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  3143     COMPUTE WK3 = WK3 * (1 + J)
  3144     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  3145        ** (N - 1))) / J
  3146     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  3147        ((N * WK2) - WK5)) + (N * WK1)) *
  3148        (CP-PREMIUM-RATE / 1000)
  3149     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  3150     COMPUTE WK6 = (WK7 * GR)
  3151
  3152     MOVE WK6 TO CP-CALC-PREMIUM
  3153
  3154     GO TO 99999-RETURN
  3155
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  62
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3156     .
  3157 12000-CHECK-CID-AL-FARMPLAN.
  3158
  3159     IF (CP-COMPANY-ID EQUAL 'CID')
  3160        AND (CP-STATE-STD-ABBRV = 'AL')
  3161        AND (CP-FARM-PLAN)
  3162        CONTINUE
  3163     ELSE
  3164        GO TO 12000-CHECK-SC-CID
  3165     END-IF
  3166
  3167     display ' made AL Farm Plan calc '
  3168
  3169     evaluate true
  3170        when cp-pmt-mode = 'B'
  3171           move 26               to c-pmts-per-year
  3172           move 14               to c-days-in-pmt-per
  3173        when cp-pmt-mode = 'W'
  3174           move 52               to c-pmts-per-year
  3175           move 07               to c-days-in-pmt-per
  3176        when cp-pmt-mode = 'S'
  3177           move 24               to c-pmts-per-year
  3178           move 15               to c-days-in-pmt-per
  3179        when cp-pmt-mode = 'A'
  3180           move 1                to c-pmts-per-year
  3181           move 360              to c-days-in-pmt-per
  3182        when cp-pmt-mode = 'T'
  3183           move 2                to c-pmts-per-year
  3184           move 180              to c-days-in-pmt-per
  3185        when cp-pmt-mode = 'Q'
  3186           move 4                to c-pmts-per-year
  3187           move 90               to c-days-in-pmt-per
  3188        when cp-pmt-mode = 'N' *> Bi-Monthly ??
  3189           move 6                to c-pmts-per-year
  3190           move 60               to c-days-in-pmt-per
  3191        when other
  3192           move 12               to c-pmts-per-year
  3193           move 30               to c-days-in-pmt-per
  3194     end-evaluate
  3195
  3196     compute c-tot-pmts = n / 12 * c-pmts-per-year
  3197     compute i = cp-loan-apr / c-pmts-per-year / 100
  3198     if i = zeros
  3199        move .0000000001         to i
  3200     end-if
  3201     compute anglen  =
  3202        (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  3203
  3204     compute y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  3205        c-days-in-pmt-per)) / (1 + I)
  3206
  3207     compute angleny = anglen / y
  3208
  3209     compute wk3 rounded =   *> tv1
  3210        ((c-tot-pmts - anglen + (i * c-tot-pmts))) / i
  3211
  3212     compute wk6 =           *> tv2
  3213        cp-premium-rate / 10 * 12 / c-pmts-per-year / 100
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  63
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3214
  3215     compute wk7 =    *> tv3
  3216        (cp-original-benefit / anglen)
  3217
  3218     compute wk5 rounded = wk7 *wk3 * wk6
  3219
  3220     move wk5                    to cp-calc-premium
  3221     GO TO 99999-RETURN
  3222
  3223     .
  3224 12000-CHECK-SC-CID.
  3225
  3226     IF (CP-COMPANY-ID = 'CID')
  3227        AND (CP-STATE-STD-ABBRV = 'SC')
  3228        AND (CP-EARN-AS-NET-PAY)
  3229        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  3230        move 6                   to ws-extra-pmts
  3231     ELSE
  3232        GO TO 12000-CHECK-AL-CID
  3233     END-IF
  3234
  3235     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3236     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3237     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3238        / 12)) / ((M + 1) / 2)
  3239
  3240     if i = .0000000001
  3241        compute wk4 = cp-original-benefit / n
  3242        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  3243            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  3244        display ' hit sc wo apr - wk2 ' wk2
  3245     else
  3246        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  3247        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3248        COMPUTE ANGLEN-1 = ANGLEN / Y
  3249        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3250        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3251           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3252     end-if
  3253
  3254*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3255*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3256*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3257*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3258*    COMPUTE ANGLEN-1 = ANGLEN / Y
  3259*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  3260*       / 12)) / ((M + 1) / 2)
  3261*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3262*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  3263*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  3264
  3265     MOVE WK3 TO CP-CALC-PREMIUM
  3266
  3267     GO TO 99999-RETURN
  3268
  3269     .
  3270 12000-CHECK-AL-CID.
  3271
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  64
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3272     IF (CP-COMPANY-ID EQUAL 'CID')
  3273        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  3274        AND (CP-EARN-AS-NET-PAY)
  3275        CONTINUE
  3276     ELSE
  3277        GO TO 12000-CHECK-NH-CID
  3278     END-IF
  3279
  3280     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3281     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3282     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3283
  3284     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3285                   / (1 + I)
  3286
  3287     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3288
  3289     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3290
  3291     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  3292        (CP-PREMIUM-RATE / 1000)
  3293
  3294     MOVE WK3 TO CP-CALC-PREMIUM
  3295
  3296     GO TO 99999-RETURN
  3297
  3298     .
  3299 12000-CHECK-NH-CID.
  3300
  3301     IF (CP-COMPANY-ID EQUAL 'CID')
  3302        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  3303        AND (CP-EARN-AS-NET-PAY)
  3304        CONTINUE
  3305     ELSE
  3306        GO TO 12000-CHECK-PA-CID
  3307     END-IF
  3308
  3309     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3310     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3311
  3312     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  3313                   / (1 + I)
  3314
  3315     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3316
  3317     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3318
  3319     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3320        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  3321
  3322     MOVE WK3 TO CP-CALC-PREMIUM
  3323
  3324     GO TO 99999-RETURN
  3325
  3326     .
  3327 12000-CHECK-PA-CID.
  3328
  3329     IF (CP-COMPANY-ID EQUAL 'CID')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  65
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3330        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  3331        AND (CP-EARN-AS-NET-PAY)
  3332        CONTINUE
  3333     ELSE
  3334        GO TO 12000-CHECK-ME-CID
  3335     END-IF
  3336
  3337
  3338     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3339     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3340     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3341     COMPUTE ANGLEN-1 = ANGLEN / Y
  3342     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
  3343     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3344     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  3345     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3346        * WK5
  3347
  3348     MOVE WK3 TO CP-CALC-PREMIUM
  3349
  3350     GO TO 99999-RETURN
  3351
  3352     .
  3353 12000-CHECK-ME-CID.
  3354
  3355     IF (CP-COMPANY-ID EQUAL 'CID')
  3356        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  3357        AND (CP-EARN-AS-NET-PAY)
  3358        CONTINUE
  3359     ELSE
  3360        GO TO 12000-CHECK-VT-TRUNC
  3361     END-IF
  3362
  3363     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  3364
  3365     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3366
  3367     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3368     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  3369     COMPUTE ANGLEN-1 = ANGLEN / Y
  3370
  3371     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3372
  3373     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  3374
  3375     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  3376        * WK5
  3377
  3378     MOVE WK3 TO CP-CALC-PREMIUM
  3379
  3380     GO TO 99999-RETURN
  3381
  3382     .
  3383 12000-CHECK-VT-TRUNC.                                            ERCNETP
  3384                                                                  ERCNETP
  3385     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3386        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3387        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  66
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3388        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3389        NEXT SENTENCE                                             ERCNETP
  3390     ELSE                                                         ERCNETP
  3391        GO TO 12000-CHECK-VT.                                     ERCNETP
  3392                                                                  ERCNETP
  3393      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3394                                                                  ERCNETP
  3395      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3396                                                                  ERCNETP
  3397      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3398                                                                  ERCNETP
  3399      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  3400      COMPUTE WK9 EQUAL                                           ERCNETP
  3401        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  3402        ((.0054 - I) / (1 + I)).                                  ERCNETP
  3403      COMPUTE WK7 EQUAL                                           ERCNETP
  3404        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  3405      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  3406        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  3407                                                                  ERCNETP
  3408      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3409                                                                  ERCNETP
  3410     GO TO 99999-RETURN.                                          ERCNETP
  3411                                                                  ERCNETP
  3412 12000-CHECK-VT.                                                  ERCNETP
  3413                                                                  ERCNETP
  3414     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3415        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  3416        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3417        NEXT SENTENCE                                             ERCNETP
  3418     ELSE                                                         ERCNETP
  3419        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  3420                                                                  ERCNETP
  3421      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  3422                                                                  ERCNETP
  3423      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3424                                                                  ERCNETP
  3425      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3426                                                                  ERCNETP
  3427      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  3428                        (ANGLEN-1 * I)) *                         ERCNETP
  3429                                                                  ERCNETP
  3430                        (((1.0054 ** N - 1) /                     ERCNETP
  3431                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  3432                                                                  ERCNETP
  3433                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  3434                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  3435                                                                  ERCNETP
  3436      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3437                                                                  ERCNETP
  3438     GO TO 99999-RETURN.                                          ERCNETP
  3439                                                                  ERCNETP
  3440 12000-CHECK-MINN-WDS.                                            ERCNETP
  3441                                                                  ERCNETP
  3442     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3443        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3444        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3445        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  67
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3446     ELSE                                                         ERCNETP
  3447        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  3448                                                                  ERCNETP
  3449     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3450     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  3451              (N / +12) * (2 / (N + 1)).                          ERCNETP
  3452     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  3453         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  3454                                                                  ERCNETP
  3455      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3456                                                                  ERCNETP
  3457     GO TO 99999-RETURN.                                          ERCNETP
  3458                                                                  ERCNETP
  3459 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  3460                                                                  ERCNETP
  3461     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3462        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3463        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3464        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3465        NEXT SENTENCE                                             ERCNETP
  3466     ELSE                                                         ERCNETP
  3467        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  3468                                                                  ERCNETP
  3469     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3470                                                                  ERCNETP
  3471     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  3472                                                                  ERCNETP
  3473     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3474        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  3475                                                                  ERCNETP
  3476     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3477                                                                  ERCNETP
  3478     GO TO 99999-RETURN.                                          ERCNETP
  3479                                                                  ERCNETP
  3480 12000-CHECK-MINN-BALL.                                           ERCNETP
  3481                                                                  ERCNETP
  3482     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3483        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3484        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3485        NEXT SENTENCE                                             ERCNETP
  3486     ELSE                                                         ERCNETP
  3487        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  3488                                                                  ERCNETP
  3489     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3490     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3491                                                                  ERCNETP
  3492     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3493     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3494     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  3495                                                                  ERCNETP
  3496      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3497                                                                  ERCNETP
  3498     GO TO 99999-RETURN.                                          ERCNETP
  3499                                                                  ERCNETP
  3500 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  3501                                                                  ERCNETP
  3502     IF (CP-COMPANY-ID EQUAL 'CID')
  3503        AND (CP-STATE-STD-ABBRV = 'MN')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  68
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3504        AND (CP-CERT-EFF-DT > X'A4FF')
  3505        AND (CP-EARN-AS-REG-BALLOON)
  3506        CONTINUE
  3507     ELSE
  3508        GO TO 12000-CHECK-CID-MN-FARM
  3509     END-IF
  3510                                                                  ERCNETP
  3511     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3512     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3513     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3514     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3515     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3516     COMPUTE V = 1 / (1 + I)
  3517     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3518     COMPUTE Y = (1 + (D * I) / +30)
  3519        / (1 + I)
  3520
  3521
  3522     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3523        * CP-PREMIUM-RATE / 1000
  3524
  3525*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3526*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3527*    ELSE
  3528*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3529*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3530*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3531*       DISPLAY ' BALLOON TOP ' WK6
  3532*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3533*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3534*          / 100
  3535*       DISPLAY ' BALLOON BOTTOM ' WK7
  3536*       COMPUTE GR = WK6 / WK7
  3537*       DISPLAY ' BALLOON PAYMENT ' GR
  3538*    END-IF
  3539
  3540     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3541     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3542        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3543     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3544
  3545     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3546        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3547           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3548           * CP-PREMIUM-RATE / 1000
  3549
  3550     MOVE WK3                    TO CP-CALC-PREMIUM
  3551                                                                  ERCNETP
  3552     GO TO 99999-RETURN.                                          ERCNETP
  3553
  3554     .
  3555 12000-CHECK-CID-MN-FARM.
  3556
  3557     IF (CP-COMPANY-ID EQUAL 'CID')
  3558        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  3559        AND (CP-CERT-EFF-DT > X'A4FF')
  3560        AND (CP-EARN-AS-FARM-PLAN)
  3561        CONTINUE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  69
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3562     ELSE
  3563        GO TO 12000-CHECK-CID-NET-BALLoons
  3564     END-IF
  3565
  3566     EVALUATE CP-PMT-MODE
  3567        WHEN 'B'
  3568           MOVE +14              TO C-DAYS-IN-PMT-PER
  3569           MOVE +26              TO C-PMTS-PER-YEAR
  3570           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3571        WHEN 'S'
  3572           MOVE +15              TO C-DAYS-IN-PMT-PER
  3573           MOVE +24              TO C-PMTS-PER-YEAR
  3574           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3575        WHEN 'T'
  3576           MOVE +360             TO C-DAYS-IN-PMT-PER
  3577           MOVE +1               TO C-PMTS-PER-YEAR
  3578           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3579        WHEN 'W'
  3580           MOVE +7               TO C-DAYS-IN-PMT-PER
  3581           MOVE +52              TO C-PMTS-PER-YEAR
  3582           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3583        WHEN OTHER
  3584           move cp-no-of-pmts    to c-tot-pmts
  3585           if cp-pay-frequency > zeros
  3586              compute c-pmts-per-year =
  3587                 12 / cp-pay-frequency
  3588              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3589           else
  3590              MOVE +30           TO C-DAYS-IN-PMT-PER
  3591              MOVE +12           TO C-PMTS-PER-YEAR
  3592              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3593           end-if
  3594     END-EVALUATE
  3595
  3596     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3597     if i = zeros
  3598        move .0000000001         to i
  3599     end-if
  3600
  3601     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3602        C-DAYS-IN-PMT-PER)) / (1 + I)
  3603
  3604     compute cp-premium-rate =
  3605        cp-premium-rate * 12 / c-pmts-per-year / 10
  3606     move c-tot-pmts to n m
  3607     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3608     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3609     COMPUTE ANGLEN-1 = ANGLEN / Y
  3610     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3611
  3612     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3613        (cp-premium-rate / 100)
  3614
  3615
  3616     MOVE WK3                    TO CP-CALC-PREMIUM
  3617
  3618     GO TO 99999-RETURN.
  3619
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  70
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3620     .
  3621 12000-check-cid-net-balloons.
  3622
  3623     IF (CP-COMPANY-ID EQUAL 'CID')
  3624        AND (CP-EARN-AS-REG-BALLOON)
  3625        and (CP-NET-ONLY-STATE not = 'Y')
  3626        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3627        CONTINUE
  3628     ELSE
  3629        GO TO 12000-check-cid-net-only-balls
  3630     END-IF
  3631
  3632     display ' *** NOT NET ONLY STATE BALLOONS *** '
  3633     COMPUTE Y =
  3634        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3635
  3636     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3637     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3638     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3639     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3640     COMPUTE ANGLEMY = ANGLEM / Y
  3641     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3642     COMPUTE ANGLENY = ANGLEN / Y
  3643     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3644
  3645     compute cp-original-benefit =
  3646        cp-original-benefit + cp-alternate-benefit
  3647     COMPUTE PVBALLOON rounded =
  3648        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3649     compute wk4 rounded =
  3650        cp-original-benefit - pvballoon
  3651     compute wk6 rounded =
  3652        (cp-original-benefit - cp-alternate-benefit)
  3653
  3654***  compute ra = wk4 / anglem-1y
  3655     compute ra = wk4 / anglemy
  3656     compute wk6 rounded = wk6 / anglemy
  3657     display ' rate before ' cp-premium-rate
  3658
  3659
  3660     compute cp-premium-rate =
  3661        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  3662            / 30) / 12))     /
  3663           ((m + 1) / 2)
  3664
  3665     display '************************************'
  3666     display ' orign ben    ' cp-original-benefit
  3667     display ' balloon      ' cp-alternate-benefit
  3668     display ' ra           ' ra
  3669     display ' wk6          ' wk6
  3670     display ' m            ' m
  3671     display ' anglemy      ' anglemy
  3672     display ' anglem-1     ' anglem-1y
  3673     display ' i            ' i
  3674     display ' extra per    ' cp-extra-periods
  3675     display ' prem rate    ' cp-premium-rate
  3676
  3677
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  71
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3678***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3679***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3680
  3681     compute wk3 = wk6 * (m - anglem) / i * (1 +
  3682        (cp-extra-periods * i)) * cp-premium-rate / 100
  3683
  3684     move wk3                    to cp-calc-premium
  3685     display ' wk3          ' wk3
  3686     display '************************************'
  3687*    compute wk3 rounded =
  3688*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3689*    move wk3                    to cp-lf-balloon-prem
  3690
  3691     GO TO 99999-RETURN.
  3692
  3693     .
  3694 12000-check-cid-net-only-balls.
  3695
  3696     IF (CP-COMPANY-ID EQUAL 'CID')
  3697        AND (CP-EARN-AS-REG-BALLOON)
  3698        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3699        CONTINUE
  3700     ELSE
  3701        GO TO 12000-CHECK-NC-WDS
  3702     END-IF
  3703
  3704     display ' *** NET ONLY STATE BALLOONS *** '
  3705
  3706     COMPUTE Y =
  3707        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3708
  3709     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3710     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3711     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3712     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3713     COMPUTE ANGLEMY = ANGLEM / Y
  3714     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3715     COMPUTE ANGLENY = ANGLEN / Y
  3716     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3717
  3718
  3719     COMPUTE PVBALLOON rounded =
  3720        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3721     compute wk4 rounded =
  3722        cp-original-benefit - pvballoon
  3723
  3724
  3725*    compute cp-premium-rate =
  3726*       (cp-premium-rate * (m + 1) / 12)  /
  3727*          ((m + 2) / 2)
  3728
  3729
  3730***  compute ra = wk4 / anglem-1y
  3731     compute ra = (cp-original-benefit + cp-alternate-benefit -
  3732        pvballoon) / anglemy
  3733
  3734     display '************************************'
  3735     display ' ra           ' ra
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  72
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3736     display ' m            ' m
  3737     display ' anglemy      ' anglemy
  3738     display ' anglem-1     ' anglem-1y
  3739     display ' i            ' i
  3740     display ' extra per    ' cp-extra-periods
  3741     display ' prem rate    ' cp-premium-rate
  3742     display '************************************'
  3743
  3744***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3745***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3746
  3747     compute wk3 = ra * (m - anglemy) / i * (1 +
  3748        (cp-extra-periods * i)) * cp-premium-rate / 100
  3749
  3750     move wk3                    to cp-calc-premium
  3751     compute wk3 rounded =
  3752        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3753     move wk3                    to cp-lf-balloon-prem
  3754
  3755     GO TO 99999-RETURN.
  3756
  3757     .
  3758 12000-CHECK-NC-WDS.                                              ERCNETP
  3759                                                                  ERCNETP
  3760     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3761        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3762        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3763        NEXT SENTENCE                                             ERCNETP
  3764     ELSE                                                         ERCNETP
  3765        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  3766                                                                  ERCNETP
  3767     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  3768     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3769     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  3770              CP-PREMIUM-RATE / +100 *                            ERCNETP
  3771              N / +12 * 2 / (N + 1) *                             ERCNETP
  3772              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  3773                                                                  ERCNETP
  3774      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3775                                                                  ERCNETP
  3776     GO TO 99999-RETURN.                                          ERCNETP
  3777                                                                  ERCNETP
  3778 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  3779                                                                  ERCNETP
  3780     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3781        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3782        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3783        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3784        NEXT SENTENCE                                             ERCNETP
  3785     ELSE                                                         ERCNETP
  3786        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  3787                                                                  ERCNETP
  3788     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3789                                                                  ERCNETP
  3790**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3791                                                                  ERCNETP
  3792     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3793        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  73
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3794                                                                  ERCNETP
  3795     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3796                                                                  ERCNETP
  3797     GO TO 99999-RETURN.                                          ERCNETP
  3798                                                                  ERCNETP
  3799 12000-CHECK-NC-BALL.                                             ERCNETP
  3800                                                                  ERCNETP
  3801     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3802        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3803        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3804        NEXT SENTENCE                                             ERCNETP
  3805     ELSE                                                         ERCNETP
  3806        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
  3807                                                                  ERCNETP
  3808     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  3809     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3810     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3811**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3812                                                                  ERCNETP
  3813     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3814     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3815     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  3816                                                                  ERCNETP
  3817      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3818                                                                  ERCNETP
  3819     GO TO 99999-RETURN.                                          ERCNETP
  3820                                                                  ERCNETP
  3821 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  3822                                                                  ERCNETP
  3823     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3824        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3825        (M GREATER THAN +63) AND                                  ERCNETP
  3826        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3827        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3828        NEXT SENTENCE                                             ERCNETP
  3829     ELSE                                                         ERCNETP
  3830        GO TO 12000-CHECK-MINN.                                   ERCNETP
  3831                                                                  ERCNETP
  3832      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3833      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3834                                                                  ERCNETP
  3835      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3836                                                                  ERCNETP
  3837      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3838       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3839       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  3840                                                                  ERCNETP
  3841      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3842                                                                  ERCNETP
  3843     GO TO 99999-RETURN.                                          ERCNETP
  3844                                                                  ERCNETP
  3845 12000-CHECK-MINN.                                                ERCNETP
  3846                                                                  ERCNETP
  3847     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3848        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3849        (M GREATER THAN +63) AND                                  ERCNETP
  3850        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3851        NEXT SENTENCE                                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  74
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3852     ELSE                                                         ERCNETP
  3853        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  3854                                                                  ERCNETP
  3855      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3856                                                                  ERCNETP
  3857      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3858                                                                  ERCNETP
  3859      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3860       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3861       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  3862                                                                  ERCNETP
  3863      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3864                                                                  ERCNETP
  3865     GO TO 99999-RETURN.                                          ERCNETP
  3866                                                                  ERCNETP
  3867 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  3868                                                                  ERCNETP
  3869     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3870        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3871        (M GREATER THAN +63) AND                                  ERCNETP
  3872        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3873        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3874        NEXT SENTENCE                                             ERCNETP
  3875     ELSE                                                         ERCNETP
  3876        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  3877                                                                  ERCNETP
  3878      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3879      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3880                                                                  ERCNETP
  3881      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3882                                                                  ERCNETP
  3883      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  3884      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3885       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  3886                                                                  ERCNETP
  3887      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3888                                                                  ERCNETP
  3889     GO TO 99999-RETURN.                                          ERCNETP
  3890                                                                  ERCNETP
  3891 12000-CHECK-MONTANA.                                             ERCNETP
  3892                                                                  ERCNETP
  3893     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3894        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3895        (M GREATER THAN +63) AND                                  ERCNETP
  3896        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3897        NEXT SENTENCE                                             ERCNETP
  3898     ELSE                                                         ERCNETP
  3899        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  3900                                                                  ERCNETP
  3901      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3902                                                                  ERCNETP
  3903      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3904                                                                  ERCNETP
  3905      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3906       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3907       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  3908                                                                  ERCNETP
  3909      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  75
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3910                                                                  ERCNETP
  3911     GO TO 99999-RETURN.                                          ERCNETP
  3912                                                                  ERCNETP
  3913 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  3914                                                                  ERCNETP
  3915     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3916        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3917        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3918        NEXT SENTENCE                                             ERCNETP
  3919     ELSE                                                         ERCNETP
  3920        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  3921                                                                  ERCNETP
  3922      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3923      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3924                                                                  ERCNETP
  3925      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3926                                                                  ERCNETP
  3927      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  3928      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  3929      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  3930                                                                  ERCNETP
  3931      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3932                                                                  ERCNETP
  3933     GO TO 99999-RETURN.                                          ERCNETP
  3934                                                                  ERCNETP
  3935 12001-CONTINUE-NCL.                                              ERCNETP
  3936                                                                  ERCNETP
  3937     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3938        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3939        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3940        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3941                                                                  ERCNETP
  3942     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3943        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3944        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3945        GO TO 12001-CHECK-CA.                                     ERCNETP
  3946                                                                  ERCNETP
  3947     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3948        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3949        NEXT SENTENCE                                             ERCNETP
  3950     ELSE                                                         ERCNETP
  3951        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  3952                                                                  ERCNETP
  3953      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3954      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  3955                                                                  ERCNETP
  3956      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3957                                                                  ERCNETP
  3958      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3959       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3960       ((N - ANGLEN) / I).                                        ERCNETP
  3961                                                                  ERCNETP
  3962      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3963                                                                  ERCNETP
  3964     GO TO 99999-RETURN.                                          ERCNETP
  3965                                                                  ERCNETP
  3966 12000-CONTINUE-NET.                                              ERCNETP
  3967                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  76
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3968     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  3969        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  3970        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3971        NEXT SENTENCE                                             ERCNETP
  3972     ELSE                                                         ERCNETP
  3973        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  3974                                                                  ERCNETP
  3975      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  3976      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  3977                                                                  ERCNETP
  3978      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  3979      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  3980      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
  3981       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  3982                                                                  ERCNETP
  3983      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  3984         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  3985                                                                  ERCNETP
  3986      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  3987                                                                  ERCNETP
  3988      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  3989         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  3990         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  3991                                                                  ERCNETP
  3992      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3993                                                                  ERCNETP
  3994     GO TO 99999-RETURN.                                          ERCNETP
  3995                                                                  ERCNETP
  3996 12001-CONTINUE-MINN.                                             ERCNETP
  3997                                                                  ERCNETP
  3998     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3999        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  4000        (CP-TRUNCATED-LIFE)                                       ERCNETP
  4001        NEXT SENTENCE                                             ERCNETP
  4002     ELSE                                                         ERCNETP
  4003        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  4004                                                                  ERCNETP
  4005      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4006      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4007                                                                  ERCNETP
  4008      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  4009       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  4010       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  4011                                                                  ERCNETP
  4012      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  4013       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  4014                                                                  ERCNETP
  4015     GO TO 99999-RETURN.                                          ERCNETP
  4016                                                                  ERCNETP
  4017 12001-CHECK-RI-GTL.                                              ERCNETP
  4018                                                                  ERCNETP
  4019     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4020        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4021        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4022        NEXT SENTENCE                                             ERCNETP
  4023     ELSE                                                         ERCNETP
  4024        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  4025                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  77
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4026      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4027*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  4028                                                                  ERCNETP
  4029      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  4030               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  4031      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  4032         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  4033                                                                  ERCNETP
  4034                                                                  ERCNETP
  4035     GO TO 99999-RETURN.                                          ERCNETP
  4036                                                                  ERCNETP
  4037 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  4038                                                                  ERCNETP
  4039     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4040        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  4041        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4042        NEXT SENTENCE                                             ERCNETP
  4043     ELSE                                                         ERCNETP
  4044        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  4045                                                                  ERCNETP
  4046     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4047                                                                  ERCNETP
  4048     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  4049        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  4050                        /                                         ERCNETP
  4051        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  4052     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  4053       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  4054                            /                                     ERCNETP
  4055       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  4056                                                                  ERCNETP
  4057     GO TO 99999-RETURN.                                          ERCNETP
  4058                                                                  ERCNETP
  4059 12001-CHECK-OR-GTL.                                              ERCNETP
  4060                                                                  ERCNETP
  4061     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  4062        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  4063        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4064        NEXT SENTENCE                                             ERCNETP
  4065     ELSE                                                         ERCNETP
  4066        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  4067                                                                  ERCNETP
  4068     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4069     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4070                                                                  ERCNETP
  4071     IF M LESS THAN +64                                           ERCNETP
  4072        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4073         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  4074                   /                                              ERCNETP
  4075         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  4076        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  4077     ELSE                                                         ERCNETP
  4078        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  4079        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  4080                  /                                               ERCNETP
  4081        (+1000 * I * ANGLEN)                                      ERCNETP
  4082        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  4083*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  78
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4084     GO TO 99999-RETURN.                                          ERCNETP
  4085                                                                  ERCNETP
  4086 12001-CHECK-GA-GTL.                                              ERCNETP
  4087                                                                  ERCNETP
  4088     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4089        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  4090        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4091*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  4092        NEXT SENTENCE                                             ERCNETP
  4093     ELSE                                                         ERCNETP
  4094        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  4095                                                                  ERCNETP
  4096     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4097     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4098                                                                  ERCNETP
  4099     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  4100     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  4101      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  4102     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4103                                                                  ERCNETP
  4104     GO TO 99999-RETURN.                                          ERCNETP
  4105                                                                  ERCNETP
  4106 12001-CHECK-MA-GTL.                                              ERCNETP
  4107                                                                  ERCNETP
  4108     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  4109        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  4110        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4111        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  4112        NEXT SENTENCE                                             ERCNETP
  4113     ELSE                                                         ERCNETP
  4114        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  4115                                                                  ERCNETP
  4116     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4117                                                                  ERCNETP
  4118     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  4119      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  4120                                                                  ERCNETP
  4121     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  4122     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  4123                                                                  ERCNETP
  4124     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  4125     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  4126     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4127                                                                  ERCNETP
  4128     GO TO 99999-RETURN.                                          ERCNETP
  4129                                                                  ERCNETP
  4130 12001-CHECK-NV-NET.                                              ERCNETP
  4131
  4132     IF (CP-COMPANY-ID EQUAL 'CID')
  4133        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  4134        AND (CP-EARN-AS-NET-PAY)
  4135        CONTINUE
  4136     ELSE
  4137        GO TO 12001-CHECK-MN-NET
  4138     END-IF
  4139
  4140     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4141     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  79
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4142
  4143     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4144                   / (1 + I)
  4145
  4146     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4147
  4148     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4149
  4150     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4151        (CP-PREMIUM-RATE * K-I / 1000)
  4152
  4153     MOVE WK3                    TO CP-CALC-PREMIUM
  4154
  4155     GO TO 99999-RETURN
  4156
  4157      .
  4158 12001-CHECK-MN-NET.
  4159
  4160     IF (CP-COMPANY-ID EQUAL 'CID')
  4161        AND (CP-STATE-STD-ABBRV = 'MN')
  4162        AND (CP-EARN-AS-NET-PAY)
  4163        AND (NOT CP-LEVEL-LIFE)
  4164        AND (WS-DISCOUNT-OPTION = '1')
  4165        CONTINUE
  4166     ELSE
  4167        GO TO 12001-CHECK-NC-NET
  4168     END-IF
  4169
  4170     if i = .0000000001
  4171        compute wk4 = cp-original-benefit / n
  4172        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  4173           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  4174        move wk3 to cp-calc-premium
  4175        go to 99999-return
  4176     end-if
  4177
  4178     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  4179     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  4180
  4181     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  4182                   / (1 + I)
  4183
  4184     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4185
  4186     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4187
  4188     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4189        (CP-PREMIUM-RATE / 1000) * (1 + I)
  4190
  4191     MOVE WK3                    TO CP-CALC-PREMIUM
  4192
  4193     GO TO 99999-RETURN
  4194
  4195      .
  4196 12001-CHECK-NC-NET.                                              ERCNETP
  4197                                                                  ERCNETP
  4198     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  4199        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  80
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4200        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4201        NEXT SENTENCE                                             ERCNETP
  4202     ELSE                                                         ERCNETP
  4203        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  4204                                                                  ERCNETP
  4205      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  4206      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  4207                                                                  ERCNETP
  4208      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  4209          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  4210          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  4211          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  4212                                                                  ERCNETP
  4213      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  4214          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  4215                                                                  ERCNETP
  4216      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  4217          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  4218          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  4219          (ANGLEN * 2))                                           ERCNETP
  4220                                                                  ERCNETP
  4221      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  4222                                                                  ERCNETP
  4223      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  4224          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  4225              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  4226          COMPUTE WK3 ROUNDED =                                   ERCNETP
  4227              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  4228                                                                  ERCNETP
  4229     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  4230                                                                  ERCNETP
  4231     GO TO 99999-RETURN.                                          ERCNETP
  4232                                                                  ERCNETP
  4233 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  4234                                                                  ERCNETP
  4235     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND
  4236        (CP-EARN-AS-NET-PAY) AND
  4237        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL' AND 'VPP')
  4238        NEXT SENTENCE
  4239     ELSE
  4240        GO TO 12001-CHECK-CA.
  4241                                                                  ERCNETP
  4242     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  4243     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  4244     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  4245                                                                  ERCNETP
  4246     IF DATE-CONVERSION-ERROR                                     ERCNETP
  4247        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  4248        MOVE ZEROS               TO FACTOR                        ERCNETP
  4249                                    CP-CALC-PREMIUM               ERCNETP
  4250         GO TO 99999-RETURN.                                      ERCNETP
  4251                                                                  ERCNETP
  4252     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  4253        NEXT SENTENCE                                             ERCNETP
  4254     ELSE                                                         ERCNETP
  4255        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  4256                                                                  ERCNETP
  4257     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  81
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4258     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4259                                                                  ERCNETP
  4260     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  4261                                                                  ERCNETP
  4262     COMPUTE NC-R = 20 *                                          ERCNETP
  4263                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  4264                          / (ORIGINAL-TERM + 1).                  ERCNETP
  4265                                                                  ERCNETP
  4266     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  4267                                                                  ERCNETP
  4268     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  4269                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  4270                                                                  ERCNETP
  4271     IF CP-EXT-CHG-LF                                             ERCNETP
  4272         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  4273     ELSE                                                         ERCNETP
  4274         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  4275                                                                  ERCNETP
  4276     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  4277             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  4278                                                                  ERCNETP
  4279     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  4280             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  4281                                                                  ERCNETP
  4282     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  4283                                                                  ERCNETP
  4284     GO TO 99999-RETURN.                                          ERCNETP
  4285                                                                  ERCNETP
  4286 12001-CHECK-CA.                                                  ERCNETP
  4287                                                                  ERCNETP
  4288     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4289        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  4290        NEXT SENTENCE                                             ERCNETP
  4291     ELSE                                                         ERCNETP
  4292        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  4293                                                                  ERCNETP
  4294     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  4295     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4296     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  4297     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  4298     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  4299     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  4300     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4301         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  4302         ((1 + CA-J) / I) *                                       ERCNETP
  4303         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  4304         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  4305         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  4306                                                                  ERCNETP
  4307     GO TO 99999-RETURN.                                          ERCNETP
  4308                                                                  ERCNETP
  4309 12001-CHECK-GTL-IA.                                              ERCNETP
  4310                                                                  ERCNETP
  4311     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  4312        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  4313        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  4314        NEXT SENTENCE                                             ERCNETP
  4315     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  82
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4316        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  4317                                                                  ERCNETP
  4318***************************************************************   ERCNETP
  4319                                                                  ERCNETP
  4320     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  4321                                                                  ERCNETP
  4322     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  4323         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  4324     ELSE                                                         ERCNETP
  4325         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  4326             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  4327         ELSE                                                     ERCNETP
  4328             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
  4329                                                                  ERCNETP
  4330     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  4331     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  4332                                                                  ERCNETP
  4333     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  4334                          GTL-IA-SGN.                             ERCNETP
  4335                                                                  ERCNETP
  4336     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4337     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  4338                                                                  ERCNETP
  4339     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  4340         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  4341         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  4342                                                                  ERCNETP
  4343     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  4344           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  4345                             (ANGLEN - ANGLEN-M))) *                 CL**3
  4346           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  4347                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  4348                                                                     CL**3
  4349     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  4350      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  4351                                                                     CL**3
  4352     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  4353                                                                     CL**3
  4354     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  4355                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  4356     GO TO 99999-RETURN.                                          ERCNETP
  4357                                                                  ERCNETP
  4358                                                                  ERCNETP
  4359 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  4360                                                                  ERCNETP
  4361     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4362        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  4363        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4364        (CP-TRUNCATED-LIFE) AND
  4365        (CP-STATE-STD-ABBRV = CP-STATE)
  4366        CONTINUE                                                  ERCNETP
  4367     ELSE                                                         ERCNETP
  4368        GO TO 12001-CHECK-CID-TX
  4369     END-IF
  4370
  4371     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4372     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4373     IF WS-WORK-DIS-RATE = ZEROS
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  83
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4374        CONTINUE
  4375     ELSE
  4376        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4377        COMPUTE WK7 = (1 / I) *
  4378              (((WK4 ** M - 1) / (WK4 - 1)) -
  4379              ((WK4 ** M * SX - VX) /
  4380              (WK4 * (1 + I) - 1))) *
  4381              (CP-PREMIUM-RATE / 1000)
  4382        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4383        COMPUTE WK8 = WK7 * 100 / ANGLEN
  4384        COMPUTE CP-CALC-PREMIUM =
  4385           WK8 *  ((WK4 * ANGLEN) / 100)
  4386     END-IF
  4387
  4388     GO TO 99999-RETURN                                           ERCNETP
  4389
  4390     .                                                            ERCNETP
  4391                                                                  ERCNETP
  4392 12001-CHECK-CID-TX.
  4393
  4394     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  4395        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  4396        (CP-EARN-AS-NET-PAY) AND
  4397        (WS-WORK-DIS-RATE > ZEROS) AND
  4398        (CP-STATE-STD-ABBRV = CP-STATE)
  4399        CONTINUE
  4400     ELSE
  4401        GO TO 12001-CHECK-CID-LEV-MN-NEW
  4402     END-IF
  4403* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  4404     COMPUTE K-I = 1 + (1 * I)
  4405     COMPUTE ANGLEm EQUAL WK1 / I   *>   Loan term
  4406     COMPUTE ANGLEn EQUAL WK2 / I   *>   Ins  term
  4407
  4408     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  4409
  4410     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  4411     COMPUTE ANGLEmy = ANGLEm / Y
  4412
  4413     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4414     IF WS-WORK-DIS-RATE = ZEROS
  4415        CONTINUE
  4416     ELSE
  4417        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4418        COMPUTE WK7 = (K-I / I) *
  4419              (((WK4 ** M - 1) / (WK4 - 1)) -
  4420*             ((WK4 ** M * SX - VX) /
  4421              ((WK4 ** M * SX) - VX) /
  4422*             (WK4 * (1 + I) - 1))) *
  4423              (WK4 * (1 + I) - 1)) *
  4424              (CP-PREMIUM-RATE / 1000)
  4425        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEmy
  4426        COMPUTE WK8 = (WK7 * 100) / (ANGLEmy * K-I)
  4427        COMPUTE CP-CALC-PREMIUM =
  4428           WK8 *  ((WK4 * ANGLEmy * K-I) / 100)
  4429     END-IF
  4430
  4431     GO TO 99999-RETURN
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  84
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4432
  4433     .
  4434 12001-CHECK-CID-LEV-MN-NEW.
  4435
  4436*    IF (CP-COMPANY-ID EQUAL 'CID')
  4437*       AND (CP-STATE-STD-ABBRV = 'MN')
  4438*       AND (CP-EARN-AS-NET-PAY)
  4439*       AND (CP-LEVEL-LIFE)
  4440*       AND (CP-CERT-EFF-DT > X'A4FF')
  4441*       CONTINUE
  4442*    ELSE
  4443*       GO TO 12001-CHECK-CID-LEV-MN
  4444*    END-IF
  4445*
  4446*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4447*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4448*    MOVE '1'                    TO DC-OPTION-CODE
  4449*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4450*
  4451*    IF DATE-CONVERSION-ERROR
  4452*       MOVE '2'                 TO CP-RETURN-CODE
  4453*       MOVE ZEROS               TO FACTOR
  4454*                                   CP-CALC-PREMIUM
  4455*       GO TO 99999-RETURN
  4456*    END-IF
  4457*
  4458*    COMPUTE I = CP-LOAN-APR / 100
  4459*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4460*
  4461*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4462*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4463*      * 12 / 360 * D)
  4464*
  4465*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4466*       * 12 / 360 * D
  4467*
  4468*    GO TO 99999-RETURN
  4469
  4470      .
  4471 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4472                                                                  ERCNETP
  4473     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4474        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4475        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4476        (CP-LEVEL-LIFE) AND
  4477        (CP-STATE-STD-ABBRV = CP-STATE)
  4478        CONTINUE                                                  ERCNETP
  4479     ELSE                                                         ERCNETP
  4480        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4481     END-IF
  4482
  4483     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4484         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4485         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4486
  4487     GO TO 99999-RETURN                                           ERCNETP
  4488
  4489      .
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  85
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4490 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4491                                                                  ERCNETP
  4492     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4493        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4494        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4495        (CP-LEVEL-LIFE) AND
  4496        (CP-STATE-STD-ABBRV = CP-STATE)
  4497        CONTINUE                                                  ERCNETP
  4498     ELSE                                                         ERCNETP
  4499        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4500     END-IF
  4501
  4502     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4503     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4504     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4505     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4506     COMPUTE CP-CALC-PREMIUM =
  4507          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4508          (CP-PREMIUM-RATE / 1000)) /
  4509          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4510
  4511     GO TO 99999-RETURN                                           ERCNETP
  4512
  4513      .
  4514 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  4515                                                                  ERCNETP
  4516     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4517        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4518        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4519        (CP-TRUNCATED-LIFE) AND
  4520        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4521        (WS-DISCOUNT-OPTION NOT = ' ')
  4522        CONTINUE                                                  ERCNETP
  4523     ELSE                                                         ERCNETP
  4524        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  4525     END-IF
  4526
  4527     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4528     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4529     IF WS-WORK-DIS-RATE = ZEROS
  4530        CONTINUE
  4531     ELSE
  4532        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4533        COMPUTE WK7 = (1 / I) *
  4534              (((WK4 ** M - 1) / (WK4 - 1)) -
  4535              ((WK4 ** M * SX - VX) /
  4536              (WK4 * (1 + I) - 1))) *
  4537              (CP-PREMIUM-RATE / 1000)
  4538        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4539        COMPUTE CP-CALC-PREMIUM =
  4540           WK4 *  WK7
  4541     END-IF
  4542
  4543     GO TO 99999-RETURN                                           ERCNETP
  4544
  4545      .
  4546 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  4547                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  86
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4548     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4549        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4550                   OR
  4551        ((CP-STATE-STD-ABBRV = 'IN') AND
  4552        (CP-CERT-EFF-DT > X'9A7F'))
  4553                   OR
  4554        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4555        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4556        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4557        (CP-TRUNCATED-LIFE) AND
  4558        (CP-STATE-STD-ABBRV = CP-STATE)
  4559        CONTINUE                                                  ERCNETP
  4560     ELSE                                                         ERCNETP
  4561        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  4562     END-IF
  4563
  4564* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4565     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4566        MOVE 0                   TO K-I
  4567     ELSE
  4568        MOVE 2                   TO K-I
  4569     END-IF
  4570     COMPUTE CP-TERM-OR-EXT-DAYS =
  4571           CP-TERM-OR-EXT-DAYS + 30
  4572
  4573     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4574     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4575     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4576                   / (1 + I)
  4577     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4578     IF WS-WORK-DIS-RATE = ZEROS
  4579        CONTINUE
  4580     ELSE
  4581        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4582*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4583        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4584              (((WK4 ** M - 1) / (WK4 - 1)) -
  4585              ((WK4 ** M * SX - VX) /
  4586              (WK4 * (1 + I) - 1))) *
  4587              (CP-PREMIUM-RATE / 1000)
  4588        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4589*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4590        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4591        COMPUTE CP-CALC-PREMIUM =
  4592           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4593*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4594     END-IF
  4595
  4596     GO TO 99999-RETURN                                           ERCNETP
  4597
  4598     .                                                            ERCNETP
  4599 12001-CHECK-CID-MT.                                              ERCNETP
  4600                                                                  ERCNETP
  4601     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4602        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4603                                OR 'VT')
  4604                   OR
  4605        ((CP-STATE-STD-ABBRV = 'IN') AND
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  87
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4606        (CP-CERT-EFF-DT > X'9A7F'))
  4607                   OR
  4608        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4609        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4610        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4611        (CP-STATE-STD-ABBRV = CP-STATE)
  4612        CONTINUE                                                  ERCNETP
  4613     ELSE                                                         ERCNETP
  4614        GO TO 12001-CHECK-DCC-DD
  4615     END-IF
  4616
  4617     COMPUTE CP-TERM-OR-EXT-DAYS =
  4618           CP-TERM-OR-EXT-DAYS + 30
  4619
  4620* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4621     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4622        MOVE 0                   TO K-I
  4623     ELSE
  4624        IF CP-STATE-STD-ABBRV = 'NJ'
  4625           MOVE 1                TO K-I
  4626        ELSE
  4627           MOVE 2                TO K-I
  4628        END-IF
  4629     END-IF
  4630     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4631     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4632     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4633                   / (1 + I)
  4634     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4635     IF WS-WORK-DIS-RATE = ZEROS
  4636        CONTINUE
  4637     ELSE
  4638        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4639*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4640        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4641              (((WK4 ** N - 1) / (WK4 - 1)) -
  4642              ((WK4 ** N - SV) /
  4643              (WK4 * (1 + I) - 1))) *
  4644              (CP-PREMIUM-RATE / 1000)
  4645        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4646*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4647        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4648        COMPUTE CP-CALC-PREMIUM =
  4649           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4650*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4651     END-IF
  4652
  4653     GO TO 99999-RETURN                                           ERCNETP
  4654
  4655     .                                                            ERCNETP
  4656
  4657 12001-CHECK-DCC-DD.
  4658
  4659     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4660        AND (CP-EARN-AS-NET-PAY)
  4661        AND (CP-BEN-CATEGORY = 'D')
  4662        CONTINUE
  4663     ELSE
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  88
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4664        GO TO 12001-CHECK-DCC-NET
  4665     END-IF
  4666
  4667     COMPUTE CP-TERM-OR-EXT-DAYS =
  4668           CP-TERM-OR-EXT-DAYS + 30
  4669
  4670     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4671     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4672     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4673                                                                  ERCNETP
  4674     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4675           / (1 + I)
  4676
  4677     COMPUTE GR     = ANGLEN / ODF
  4678*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4679*      CP-RATE-DEV-PCT
  4680
  4681     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4682
  4683     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4684       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4685     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4686     MOVE WK3                    TO CP-CALC-PREMIUM
  4687
  4688     GO TO 99999-RETURN                                           ERCNETP
  4689
  4690     .                                                            ERCNETP
  4691
  4692 12001-CHECK-DCC-NET.                                             ERCNETP
  4693                                                                  ERCNETP
  4694     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4695        AND (CP-EARN-AS-NET-PAY)
  4696        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4697             AND 'H' AND 'S' AND 'P')
  4698        CONTINUE                                                  ERCNETP
  4699     ELSE                                                         ERCNETP
  4700        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  4701     END-IF
  4702
  4703     COMPUTE CP-TERM-OR-EXT-DAYS =
  4704           CP-TERM-OR-EXT-DAYS + 30
  4705
  4706     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4707     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4708     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4709                                                                  ERCNETP
  4710     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4711           / (1 + I)
  4712
  4713     COMPUTE GR     = ANGLEN / ODF
  4714     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4715     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4716       CP-RATE-DEV-PCT
  4717     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4718*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4719
  4720     COMPUTE WK8 = CP-PREMIUM-RATE *
  4721        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  89
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4722     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4723     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4724     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4725       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4726     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4727     MOVE WK3                    TO CP-CALC-PREMIUM
  4728
  4729     GO TO 99999-RETURN                                           ERCNETP
  4730
  4731     .                                                            ERCNETP
  4732 12001-CHECK-DCC-PNET.                                            ERCNETP
  4733
  4734     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4735        AND (CP-EARN-AS-NET-PAY)
  4736        AND (CP-BENEFIT-CD (1:1) = 'P')
  4737        CONTINUE                                                  ERCNETP
  4738     ELSE                                                         ERCNETP
  4739        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  4740     END-IF
  4741
  4742     IF CP-NO-OF-PMTS NOT NUMERIC
  4743        MOVE +0                  TO CP-NO-OF-PMTS
  4744     END-IF
  4745     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4746        AND ' ' AND 'M'
  4747        MOVE ' '                 TO CP-PMT-MODE
  4748     END-IF
  4749
  4750******************************************************************
  4751***   Default is monthly, use loan term for rate and amort     ***
  4752******************************************************************
  4753     move cp-loan-term         to c-tot-pmts
  4754     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4755     MOVE +12                  TO C-PMTS-PER-YEAR
  4756******************************************************************
  4757
  4758     evaluate true
  4759        when cp-pmt-mode = 'W'
  4760           MOVE +52              TO C-PMTS-PER-YEAR
  4761           compute c-tot-pmts = cp-loan-term /
  4762              12 * c-pmts-per-year
  4763           MOVE +7               TO C-DAYS-IN-PMT-PER
  4764        when cp-pmt-mode = 'B'
  4765           MOVE +26              TO C-PMTS-PER-YEAR
  4766           compute c-tot-pmts = cp-loan-term /
  4767              12 * c-pmts-per-year
  4768           MOVE +14              TO C-DAYS-IN-PMT-PER
  4769     end-evaluate
  4770
  4771     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4772
  4773     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4774        C-DAYS-IN-PMT-PER)) / (1 + I)
  4775
  4776     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4777*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4778     COMPUTE ANGLEN-1 = ANGLEN / Y
  4779
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  90
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4780     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4781
  4782     IF CP-RATE-DEV-PCT NOT = ZEROS
  4783        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4784           CP-PREMIUM-RATE
  4785     END-IF
  4786
  4787     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4788
  4789     GO TO 99999-RETURN
  4790
  4791     .                                                            ERCNETP
  4792 12001-CHECK-DCC-MNET.                                            ERCNETP
  4793                                                                  ERCNETP
  4794     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4795        AND (CP-EARN-AS-NET-PAY)
  4796        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4797        CONTINUE                                                  ERCNETP
  4798     ELSE                                                         ERCNETP
  4799        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4800     END-IF
  4801
  4802*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4803*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4804*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4805                                                                  ERCNETP
  4806     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4807     MOVE WK3                    TO CP-CALC-PREMIUM
  4808
  4809     GO TO 99999-RETURN                                           ERCNETP
  4810
  4811     .                                                            ERCNETP
  4812 12001-CHECK-DCC-MNET-LF-BAL.
  4813                                                                  ERCNETP
  4814     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4815        AND (CP-EARN-AS-NET-PAY)
  4816        AND (CP-BENEFIT-CD (1:1) = 'N')
  4817        AND (CP-BEN-CATEGORY NOT = 'N')
  4818        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4819        CONTINUE                                                  ERCNETP
  4820     ELSE                                                         ERCNETP
  4821        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4822     END-IF
  4823
  4824     IF CP-RATE-DEV-PCT NOT = ZEROS
  4825        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4826           CP-PREMIUM-RATE
  4827     END-IF
  4828
  4829*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4830     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4831        / (1 + I)
  4832     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4833     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4834     COMPUTE WK2 = (1 + J) ** (M * -1)
  4835     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4836
  4837     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  91
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4838          ** ((M - 1) * -1))) / J)
  4839
  4840     COMPUTE ANGLEM = ((1 - ((1 + J)
  4841          ** (M * -1))) / J) / OD
  4842
  4843     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4844        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4845        / ANGLEM-1
  4846
  4847     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4848          ** ((N - M) * -1))) / I)
  4849
  4850     MOVE +0                     TO WK3
  4851     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4852        (WS-COUNTER > M)
  4853        COMPUTE ANGLEM = (1 - ((1 + J)
  4854          ** ((M - WS-COUNTER) * -1))) / J
  4855        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4856        COMPUTE WK5-CSL = (RA * ANGLEM)
  4857        + (CP-ALTERNATE-BENEFIT * WK2)
  4858        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4859     END-PERFORM
  4860
  4861     MOVE WK3                    TO CP-CALC-PREMIUM
  4862
  4863     GO TO 99999-RETURN                                           ERCNETP
  4864
  4865     .                                                            ERCNETP
  4866 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4867                                                                  ERCNETP
  4868     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4869        AND (CP-EARN-AS-NET-PAY)
  4870        AND (CP-BENEFIT-CD (1:1) = 'S')
  4871        AND (CP-BEN-CATEGORY NOT = 'N')
  4872        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4873        CONTINUE                                                  ERCNETP
  4874     ELSE                                                         ERCNETP
  4875        GO TO 12001-CHECK-DCC-MNET-LF
  4876     END-IF
  4877
  4878     IF CP-RATE-DEV-PCT NOT = ZEROS
  4879        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4880           CP-PREMIUM-RATE
  4881     END-IF
  4882
  4883     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4884
  4885     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4886          ** ((M - 1) * -1))) / K)
  4887
  4888     COMPUTE ANGLEM = ((1 - ((1 + K)
  4889          ** (M * -1))) / K)
  4890
  4891     MOVE CP-MONTHLY-PAYMENT     TO RA
  4892
  4893     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4894        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4895        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  92
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4896        CP-PREMIUM-RATE / 1000
  4897
  4898     MOVE WK3                    TO CP-CALC-PREMIUM
  4899
  4900
  4901     GO TO 99999-RETURN                                           ERCNETP
  4902
  4903     .                                                            ERCNETP
  4904 12001-CHECK-DCC-MNET-LF.
  4905                                                                  ERCNETP
  4906     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  4907        AND (CP-EARN-AS-NET-PAY)
  4908        AND (CP-BENEFIT-CD (1:1) = 'N')
  4909        AND (CP-BEN-CATEGORY NOT = 'N')
  4910        CONTINUE                                                  ERCNETP
  4911     ELSE                                                         ERCNETP
  4912        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4913     END-IF
  4914
  4915     IF CP-RATE-DEV-PCT NOT = ZEROS
  4916        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4917           CP-PREMIUM-RATE
  4918     END-IF
  4919
  4920*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4921     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4922        / (1 + I)
  4923     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4924     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4925     COMPUTE WK2 = (1 + J) ** (M * -1)
  4926     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4927
  4928
  4929     COMPUTE ANGLEM = ((1 - ((1 + J)
  4930          ** (M * -1))) / J) / OD
  4931     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4932
  4933     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4934          ** ((N - M) * -1))) / I)
  4935
  4936     MOVE +0                     TO WK3
  4937     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4938        (WS-COUNTER > M)
  4939        COMPUTE ANGLEM = (1 - ((1 + J)
  4940          ** ((M - WS-COUNTER + 1) * -1))) / J
  4941        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4942        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4943        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4944     END-PERFORM
  4945
  4946     MOVE WK3                    TO CP-CALC-PREMIUM
  4947
  4948     GO TO 99999-RETURN                                           ERCNETP
  4949
  4950     .                                                            ERCNETP
  4951 12001-CHECK-DCC-MNET-SUMLF.
  4952                                                                  ERCNETP
  4953     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  93
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4954        AND (CP-EARN-AS-NET-PAY)
  4955        AND (CP-BENEFIT-CD (1:1) = 'S')
  4956        AND (CP-BEN-CATEGORY NOT = 'N')
  4957        CONTINUE                                                  ERCNETP
  4958     ELSE                                                         ERCNETP
  4959        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4960     END-IF
  4961
  4962     IF CP-RATE-DEV-PCT NOT = ZEROS
  4963        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4964           CP-PREMIUM-RATE
  4965     END-IF
  4966
  4967     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4968     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4969        / (1 + K)
  4970
  4971     COMPUTE ANGLEN-M = (WK5 / I)
  4972     COMPUTE WK2 = (1 + K) ** (M * -1)
  4973     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4974     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4975
  4976
  4977     COMPUTE ANGLEM = ((1 - ((1 + K)
  4978          ** (M * -1))) / K) / Y
  4979     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4980
  4981     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4982        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4983        - 1)) / K) * RA
  4984     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4985        + (CP-DAYS-TO-1ST-PMT - +30)
  4986        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4987        +0 / 1000 * 12 / 12)
  4988     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4989        * (12 / 12)
  4990
  4991
  4992     MOVE WK3                    TO CP-CALC-PREMIUM
  4993
  4994     GO TO 99999-RETURN                                           ERCNETP
  4995
  4996     .                                                            ERCNETP
  4997 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4998                                                                  ERCNETP
  4999     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5000        AND (CP-EARN-AS-NET-PAY)
  5001        AND (CP-BENEFIT-CD (1:1) = 'N')
  5002        AND (CP-BEN-CATEGORY = 'N')
  5003        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5004        CONTINUE                                                  ERCNETP
  5005     ELSE                                                         ERCNETP
  5006        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  5007     END-IF
  5008
  5009*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5010     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5011        / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  94
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5012     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5013     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  5014     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5015     COMPUTE WK2 = (1 + J) ** (M * -1)
  5016     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5017
  5018     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  5019          ** ((M - 1) * -1))) / J)
  5020
  5021     COMPUTE ANGLEM = ((1 - ((1 + J)
  5022          ** (M * -1))) / J) / OD
  5023
  5024     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  5025        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  5026        / ANGLEM-1
  5027
  5028     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5029          ** ((N - M) * -1))) / I)
  5030
  5031     MOVE +0                     TO WK3
  5032     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5033        (WS-COUNTER > M)
  5034        COMPUTE ANGLEM = (1 - ((1 + J)
  5035          ** ((M - WS-COUNTER) * -1))) / J
  5036        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  5037        COMPUTE WK5-CSL = (RA * ANGLEM)
  5038        + (CP-ALTERNATE-BENEFIT * WK2)
  5039        COMPUTE WK3 = WK3 +
  5040         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  5041        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  5042          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  5043          (CP-DCC-AH-RATE / 1000)
  5044     END-PERFORM
  5045
  5046     MOVE WK3                    TO CP-CALC-PREMIUM
  5047
  5048     GO TO 99999-RETURN                                           ERCNETP
  5049
  5050     .                                                            ERCNETP
  5051 12001-CHECK-DCC-MNET-TOT-BAL-S.
  5052                                                                  ERCNETP
  5053     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5054        AND (CP-EARN-AS-NET-PAY)
  5055        AND (CP-BENEFIT-CD (1:1) = 'S')
  5056        AND (CP-BEN-CATEGORY = 'N')
  5057        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  5058        CONTINUE                                                  ERCNETP
  5059     ELSE                                                         ERCNETP
  5060        GO TO 12001-CHECK-DCC-MNET-TOT-N
  5061     END-IF
  5062
  5063
  5064     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5065
  5066     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  5067          ** ((M - 1) * -1))) / K)
  5068
  5069     COMPUTE ANGLEM = ((1 - ((1 + K)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  95
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5070          ** (M * -1))) / K)
  5071
  5072     MOVE CP-MONTHLY-PAYMENT     TO RA
  5073
  5074     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  5075        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  5076        * CP-DCC-AH-RATE / 1000))
  5077        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  5078        CP-DCC-LF-RATE / 1000
  5079
  5080     MOVE WK3                    TO CP-LF-PREM
  5081
  5082     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  5083        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  5084        * CP-DCC-AH-RATE / 1000
  5085
  5086     COMPUTE WK3 = WK3 + WK5-CSL
  5087
  5088
  5089     MOVE WK3                    TO CP-CALC-PREMIUM
  5090
  5091     GO TO 99999-RETURN                                           ERCNETP
  5092
  5093      .
  5094 12001-CHECK-DCC-MNET-TOT-N.
  5095                                                                  ERCNETP
  5096     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5097        AND (CP-EARN-AS-NET-PAY)
  5098        AND (CP-BENEFIT-CD (1:1) = 'N')
  5099        AND (CP-BEN-CATEGORY = 'N')
  5100        CONTINUE                                                  ERCNETP
  5101     ELSE                                                         ERCNETP
  5102        GO TO 12001-CHECK-DCC-MNET-TOT-S
  5103     END-IF
  5104
  5105*    I = APR/1200
  5106*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  5107*    RA = PAYMENT AMOUNT
  5108*    WK5-CSL = THE BALANCE (PAY OFF )
  5109*    WK3 = THE ACCUMULATED PREMIUM
  5110*    WK2 = (1 + I) ^ (m * -1)
  5111*    OD  = GAMMA
  5112*
  5113*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  5114     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  5115        / (1 + I)
  5116     COMPUTE ANGLEN-M = (WK5 / I) / OD
  5117     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  5118        (CP-DCC-AH-RATE / +1000)
  5119     COMPUTE WK2 = (1 + J) ** (M * -1)
  5120     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5121
  5122
  5123     COMPUTE ANGLEM = ((1 - ((1 + J)
  5124          ** (M * -1))) / J) / OD
  5125     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5126
  5127     COMPUTE ANGLEN-M = ((1 - ((1 + I)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  96
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5128          ** ((N - M) * -1))) / I)
  5129
  5130     MOVE +0                     TO WK3
  5131     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  5132        (WS-COUNTER > M)
  5133        COMPUTE ANGLEM = (1 - ((1 + J)
  5134          ** ((M - WS-COUNTER + 1) * -1))) / J
  5135        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  5136        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  5137        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  5138           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  5139     END-PERFORM
  5140
  5141     MOVE WK3                    TO CP-CALC-PREMIUM
  5142
  5143     GO TO 99999-RETURN                                           ERCNETP
  5144
  5145     .                                                            ERCNETP
  5146 12001-CHECK-DCC-MNET-TOT-S.
  5147                                                                  ERCNETP
  5148     IF (CP-COMPANY-ID EQUAL 'DCC' OR 'VPP')
  5149        AND (CP-EARN-AS-NET-PAY)
  5150        AND (CP-BENEFIT-CD (1:1) = 'S')
  5151        AND (CP-BEN-CATEGORY = 'N')
  5152        CONTINUE                                                  ERCNETP
  5153     ELSE                                                         ERCNETP
  5154        GO TO 12001-CONTINUE-NET
  5155     END-IF
  5156
  5157*    I = APR/1200
  5158*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  5159*    RA = PAYMENT AMOUNT
  5160*    WK5-CSL = THE BALANCE (PAY OFF )
  5161*    WK3 = THE ACCUMULATED PREMIUM
  5162*    WK2 = (1 + I) ^ (m * -1)
  5163*    OD  = GAMMA
  5164*
  5165     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  5166
  5167     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  5168        / (1 + J)
  5169
  5170     COMPUTE ANGLEM = ((1 - ((1 + J)
  5171          ** (M * -1))) / J) / OD
  5172
  5173     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5174          ** ((N - M) * -1))) / I)
  5175          * (1 + J) ** (-1 * M)
  5176
  5177     COMPUTE ANGLEN-M = ANGLEN-M / OD
  5178
  5179     MOVE CP-MONTHLY-PAYMENT     TO RA
  5180
  5181     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  5182        / +30)
  5183     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  5184        ** (WK1) - 1)) / J) * RA
  5185
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  97
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5186     COMPUTE WK5 = (((((M * (M + 1) / 2)
  5187        + (CP-DAYS-TO-1ST-PMT - +30)
  5188        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  5189        CP-DCC-AH-RATE / +1000 * 12 / 12)
  5190
  5191     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  5192        (12 / 12)
  5193
  5194     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  5195        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  5196        (CP-DCC-AH-RATE / +1000) * 12 / 12
  5197
  5198     COMPUTE WK3 = WK3 + WK5-CSL
  5199     MOVE WK3                    TO CP-CALC-PREMIUM
  5200
  5201     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  5202     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  5203        / (1 + K)
  5204
  5205     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  5206          ** ((N - M) * -1))) / I)
  5207     COMPUTE WK2 = (1 + K) ** (M * -1)
  5208     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  5209     COMPUTE ANGLEN-M = ANGLEN-M / Y
  5210
  5211
  5212     COMPUTE ANGLEM = ((1 - ((1 + K)
  5213          ** (M * -1))) / K) / Y
  5214
  5215*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  5216
  5217     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  5218        ((1 + K) ** (M + 1 / Y
  5219        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  5220        - 1)) / K) * RA
  5221     COMPUTE WK7 = (((((M * (M + 1) / 2)
  5222        + (CP-DAYS-TO-1ST-PMT - +30)
  5223        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  5224        CP-DCC-AH-RATE / 1000 * 12 / 12)
  5225     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  5226        * (12 / 12)
  5227
  5228
  5229     MOVE WK3                    TO CP-LF-PREM
  5230
  5231
  5232
  5233     GO TO 99999-RETURN                                           ERCNETP
  5234
  5235     .                                                            ERCNETP
  5236 12001-CONTINUE-NET.                                              ERCNETP
  5237                                                                  ERCNETP
  5238     IF NET-STD                                                   ERCNETP
  5239        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  5240*          OR 'DCC'
  5241         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  5242         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  5243         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  98
* ELRFNDX.cbl (/apps/prod/cid1p/copy/ERCNETP)
  5244         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  5245                               * ((1 + N) / (1 + M))
  5246         if (i = .0000000001)
  5247            and (wk3 = zeros)
  5248            move 1               to wk3
  5249         end-if
  5250        ELSE                                                      ERCNETP
  5251         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  5252         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  5253         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  5254         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  5255                                                                  ERCNETP
  5256     IF NET-SMP                                                   ERCNETP
  5257         COMPUTE N2 = N * N                                       ERCNETP
  5258         COMPUTE N3 = N2 * N                                      ERCNETP
  5259         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  5260         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  5261         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  5262         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
  5263         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  5264                                                                  ERCNETP
  5265     IF NPO-PRUDENTIAL                                            ERCNETP
  5266       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  5267           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  5268               UNTIL WS-COUNTER = N                               ERCNETP
  5269       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  5270       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  5271                                                                  ERCNETP
  5272     MOVE WK3 TO FACTOR.                                          ERCNETP
  5273
  5274                                                                  ERCNETP
  5275     GO TO 99999-RETURN.                                          ERCNETP
  5276                                                                  ERCNETP
  5277 12100-PRU-CALC.                                                  ERCNETP
  5278     IF WS-COUNTER = 1                                            ERCNETP
  5279         COMPUTE PWK = (I + 1)                                    ERCNETP
  5280     ELSE                                                         ERCNETP
  5281         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  5282                                                                  ERCNETP
  5283 12199-EXIT.                                                      ERCNETP
  5284      EXIT.                                                       ERCNETP
  5285                                                                  ERCNETP
  5286 99000-ERROR.                                                     ERCNETP
  5287     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  5288     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  5289                                                                  ERCNETP
  5290     GO TO 99999-EXIT.                                            ERCNETP
  5291                                                                  ERCNETP
  5292 99999-RETURN.                                                    ERCNETP
  5293     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  5294                                                                  ERCNETP
  5295 99999-EXIT.                                                      ERCNETP
  5296      EXIT.                                                       ERCNETP
  5297
*
* Program-Id : ELRFNDX
* Line   Data Name                       Address    Size      Attributes
* 000061 LCP-ABND-CODE . . . . . . . . . 0000000352 00000002  WS E    Comp
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page  99
* ELRFNDX.cbl
* 000062 Filler. . . . . . . . . . . . . 0000000360 00000032  WS E    AlphNum
* 000063 Filler. . . . . . . . . . . . . 0000000392 00000032  WS E    AlphNum
* 000064 Filler. . . . . . . . . . . . . 0000000424 00000032  WS E    AlphNum
* 000065 WS-UE-CLP . . . . . . . . . . . 0000000456 00000004  WS E    Comp-3
* 000066 WS-GFR3 . . . . . . . . . . . . 0000000464 00000004  WS E    Comp-3
* 000067 WS-MONTH. . . . . . . . . . . . 0000000472 00000002  WS E    Comp-3
* 000069 WS-WORK-MISC. . . . . . . . . . 0000000480 00000128  WS G    AlphNum
* 000070 WS-REMAINING-TERM . . . . . . . 0000000480 00000003  WS E    Comp-3
* 000071 WS-TEMP-RESULT. . . . . . . . . 0000000483 00000007  WS E    Comp-3
* 000072 WS-REMAINING-AMT. . . . . . . . 0000000490 00000007  WS E    Comp-3
* 000073 WS-ORIG-PREM. . . . . . . . . . 0000000497 00000007  WS E    Comp-3
* 000074 WS-REMAIN-PREM. . . . . . . . . 0000000504 00000007  WS E    Comp-3
* 000075 WS-NP-REF-FACTOR. . . . . . . . 0000000511 00000008  WS E    Comp-3
* 000076 WS-SAVE-TERM. . . . . . . . . . 0000000519 00000002  WS E    Comp-3
* 000077 WS-SAVE-LOAN-TERM . . . . . . . 0000000521 00000002  WS E    Comp-3
* 000078 WS-SAVE-BENEFIT . . . . . . . . 0000000523 00000006  WS E    Comp-3
* 000079 WS-SAVE-EARN-METHOD . . . . . . 0000000529 00000001  WS E    AlphNum
* 000080 WS-SAVE-EXT-DAYS. . . . . . . . 0000000530 00000003  WS E    Comp-3
* 000081 CAL-RFND. . . . . . . . . . . . 0000000533 00000004  WS E    Comp-3
* 000082 FACTOR-1. . . . . . . . . . . . 0000000537 00000008  WS E    Comp-3
* 000083 FACTOR-2. . . . . . . . . . . . 0000000545 00000008  WS E    Comp-3
* 000084 FACTOR-3. . . . . . . . . . . . 0000000553 00000008  WS E    Comp-3
* 000085 FACTOR-4. . . . . . . . . . . . 0000000561 00000008  WS E    Comp-3
* 000086 FACTOR-5. . . . . . . . . . . . 0000000569 00000004  WS E    Comp-3
* 000087 FACTOR-6. . . . . . . . . . . . 0000000573 00000004  WS E    Comp-3
* 000088 RATE-FACTOR-1 . . . . . . . . . 0000000577 00000002  WS E    Comp-3
* 000089 RATE-FACTOR-2 . . . . . . . . . 0000000579 00000002  WS E    Comp-3
* 000090 R78-FACTOR. . . . . . . . . . . 0000000581 00000008  WS E    Comp-3
* 000091 PR-FACTOR . . . . . . . . . . . 0000000589 00000008  WS E    Comp-3
* 000092 RSUM-FACTOR . . . . . . . . . . 0000000597 00000008  WS E    Comp-3
* 000093 RSUM-REMAINING-TERM . . . . . . 0000000605 00000003  WS E    Comp-3
* 000095 TEXAS-REG-WORK-AREAS. . . . . . 0000000608 00000033  WS G    AlphNum
* 000096 TEX-FACT-1. . . . . . . . . . . 0000000608 00000005  WS E    Comp-3
* 000097 TEX-FACT-2. . . . . . . . . . . 0000000613 00000002  WS E    Comp-3
* 000098 TEX-FACT-3. . . . . . . . . . . 0000000615 00000002  WS E    Comp-3
* 000099 TEX-FACT-4. . . . . . . . . . . 0000000617 00000004  WS E    Comp-3
* 000100 TEX-FACT-5. . . . . . . . . . . 0000000621 00000002  WS E    Comp-3
* 000101 TEX-FACT-6. . . . . . . . . . . 0000000623 00000002  WS E    Comp-3
* 000102 TEX-FACT-7. . . . . . . . . . . 0000000625 00000004  WS E    Comp-3
* 000103 TEX-FACT-8. . . . . . . . . . . 0000000629 00000004  WS E    Comp-3
* 000104 TEX-FACT-9. . . . . . . . . . . 0000000633 00000008  WS E    Comp-3
* 000106 NET-PAY-INTERFACE . . . . . . . 0000000648 00000018  WS G    AlphNum
* 000107 N-P-APR . . . . . . . . . . . . 0000000648 00000004  WS E    Comp-3
* 000108 N-P-ORIG. . . . . . . . . . . . 0000000652 00000002  WS E    Comp-3
* 000109 N-P-REM . . . . . . . . . . . . 0000000654 00000002  WS E    Comp-3
* 000110 N-P-OPT . . . . . . . . . . . . 0000000656 00000001  WS E    AlphNum
* 000111 N-P-LOAN. . . . . . . . . . . . 0000000657 00000002  WS E    Comp-3
* 000112 N-P-FACTOR. . . . . . . . . . . 0000000659 00000007  WS E    Comp-3
* 000139 NET-PAY-WORK-AREA . . . . . . . 0000000672 00000638  WS G    AlphNum
* 000140 OPTION-SW . . . . . . . . . . . 0000000672 00000001  WS E    AlphNum
* 000156 TYPE-SW . . . . . . . . . . . . 0000000673 00000001  WS E    AlphNum
* 000160 NP-PROCESS-SW . . . . . . . . . 0000000674 00000001  WS E    AlphNum
* 000165 COMP-3-WORK-AREA. . . . . . . . 0000000675 00000530  WS G    AlphNum
* 000166 WS-WORK-DIS-RATE. . . . . . . . 0000000675 00000005  WS E    Comp-3
* 000167 V . . . . . . . . . . . . . . . 0000000680 00000007  WS E    Comp-3
* 000168 J . . . . . . . . . . . . . . . 0000000687 00000005  WS E    Comp-3
* 000169 K . . . . . . . . . . . . . . . 0000000692 00000005  WS E    Comp-3
* 000170 I . . . . . . . . . . . . . . . 0000000697 00000006  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 100
* ELRFNDX.cbl
* 000171 D . . . . . . . . . . . . . . . 0000000703 00000003  WS E    Comp-3
* 000172 APR100. . . . . . . . . . . . . 0000000706 00000005  WS E    Comp-3
* 000173 RA. . . . . . . . . . . . . . . 0000000711 00000008  WS E    Comp-3
* 000174 WK1 . . . . . . . . . . . . . . 0000000719 00000009  WS E    Comp-3
* 000175 WK2 . . . . . . . . . . . . . . 0000000728 00000009  WS E    Comp-3
* 000176 PEMA. . . . . . . . . . . . . . 0000000737 00000009  WS E    Comp-3
* 000177 WK3 . . . . . . . . . . . . . . 0000000746 00000009  WS E    Comp-3
* 000178 WK4 . . . . . . . . . . . . . . 0000000755 00000008  WS E    Comp-3
* 000179 WK5 . . . . . . . . . . . . . . 0000000763 00000010  WS E    Comp-3
* 000180 WK5-CSL . . . . . . . . . . . . 0000000773 00000008  WS E    Comp-3
* 000181 WK6 . . . . . . . . . . . . . . 0000000781 00000009  WS E    Comp-3
* 000182 WK7 . . . . . . . . . . . . . . 0000000790 00000009  WS E    Comp-3
* 000183 WK8 . . . . . . . . . . . . . . 0000000799 00000007  WS E    Comp-3
* 000184 WK9 . . . . . . . . . . . . . . 0000000806 00000007  WS E    Comp-3
* 000185 GR. . . . . . . . . . . . . . . 0000000813 00000009  WS E    Comp-3
* 000186 ONE-PLUS-I. . . . . . . . . . . 0000000822 00000007  WS E    Comp-3
* 000187 ODF . . . . . . . . . . . . . . 0000000829 00000007  WS E    Comp-3
* 000188 OD. . . . . . . . . . . . . . . 0000000836 00000007  WS E    Comp-3
* 000189 FM. . . . . . . . . . . . . . . 0000000843 00000007  WS E    Comp-3
* 000190 FN. . . . . . . . . . . . . . . 0000000850 00000007  WS E    Comp-3
* 000191 FNM . . . . . . . . . . . . . . 0000000857 00000007  WS E    Comp-3
* 000192 ANGLEM. . . . . . . . . . . . . 0000000864 00000010  WS E    Comp-3
* 000193 ANGLEMY . . . . . . . . . . . . 0000000874 00000010  WS E    Comp-3
* 000194 ANGLEMP1. . . . . . . . . . . . 0000000884 00000010  WS E    Comp-3
* 000195 ANGLEN. . . . . . . . . . . . . 0000000894 00000010  WS E    Comp-3
* 000196 ANGLENY . . . . . . . . . . . . 0000000904 00000010  WS E    Comp-3
* 000197 ANGLEN-M. . . . . . . . . . . . 0000000914 00000010  WS E    Comp-3
* 000198 ANGLEN-MP1. . . . . . . . . . . 0000000924 00000010  WS E    Comp-3
* 000199 ANGLEN-MP1Y . . . . . . . . . . 0000000934 00000010  WS E    Comp-3
* 000200 ANGLEN-1. . . . . . . . . . . . 0000000944 00000009  WS E    Comp-3
* 000201 ANGLEM-1. . . . . . . . . . . . 0000000953 00000009  WS E    Comp-3
* 000202 ANGLEM-1Y . . . . . . . . . . . 0000000962 00000009  WS E    Comp-3
* 000203 ANGLEM-T. . . . . . . . . . . . 0000000971 00000010  WS E    Comp-3
* 000204 PVBALLOON . . . . . . . . . . . 0000000981 00000005  WS E    Comp-3
* 000205 TRUNC-PMT . . . . . . . . . . . 0000000986 00000005  WS E    Comp-3
* 000206 K1. . . . . . . . . . . . . . . 0000000991 00000002  WS E    Comp-3
* 000207 K12 . . . . . . . . . . . . . . 0000000993 00000002  WS E    Comp-3
* 000208 K100. . . . . . . . . . . . . . 0000000995 00000002  WS E    Comp-3
* 000209 K1000 . . . . . . . . . . . . . 0000000997 00000004  WS E    Comp-3
* 000210 NC-LR . . . . . . . . . . . . . 0000001001 00000004  WS E    Comp-3
* 000211 Y . . . . . . . . . . . . . . . 0000001001 00000004  WS E    Comp-3     R
* 000213 TI. . . . . . . . . . . . . . . 0000001005 00000005  WS E    Comp-3
* 000214 NC-R. . . . . . . . . . . . . . 0000001010 00000009  WS E    Comp-3
* 000215 NC-OB . . . . . . . . . . . . . 0000001019 00000009  WS E    Comp-3
* 000216 NC-P. . . . . . . . . . . . . . 0000001028 00000009  WS E    Comp-3
* 000217 NC-D. . . . . . . . . . . . . . 0000001037 00000009  WS E    Comp-3
* 000218 NC-BIG-D. . . . . . . . . . . . 0000001046 00000002  WS E    Comp-3
* 000219 NC-LITTLE-D . . . . . . . . . . 0000001048 00000005  WS E    Comp-3
* 000220 NC-MP . . . . . . . . . . . . . 0000001053 00000004  WS E    Comp-3
* 000221 NC-LP . . . . . . . . . . . . . 0000001057 00000004  WS E    Comp-3
* 000223 CA-MP . . . . . . . . . . . . . 0000001061 00000004  WS E    Comp-3
* 000224 CA-API. . . . . . . . . . . . . 0000001065 00000006  WS E    Comp-3
* 000225 CA-APJ. . . . . . . . . . . . . 0000001071 00000006  WS E    Comp-3
* 000226 CA-VI . . . . . . . . . . . . . 0000001077 00000006  WS E    Comp-3
* 000227 CA-J. . . . . . . . . . . . . . 0000001083 00000006  WS E    Comp-3
* 000228 CA-DISCOUNT . . . . . . . . . . 0000001089 00000006  WS E    Comp-3
* 000229 GTL-IA-DIVIDEND . . . . . . . . 0000001095 00000007  WS E    Comp-3
* 000230 GTL-IA-DIVISOR. . . . . . . . . 0000001102 00000007  WS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 101
* ELRFNDX.cbl
* 000231 GTL-IA-FACTOR . . . . . . . . . 0000001109 00000007  WS E    Comp-3
* 000232 GTL-IA-ODF. . . . . . . . . . . 0000001116 00000007  WS E    Comp-3
* 000233 GTL-IA-ODD-DAYS . . . . . . . . 0000001123 00000002  WS E    Comp-3
* 000234 GTL-IA-SGN. . . . . . . . . . . 0000001125 00000001  WS E    Comp-3
* 000235 GTL-IA-ABS. . . . . . . . . . . 0000001126 00000002  WS E    Comp-3
* 000237 ANNUAL-INT-RATE . . . . . . . . 0000001128 00000004  WS E    Comp-3
* 000239 ORIGINAL-TERM . . . . . . . . . 0000001132 00000002  WS E    Comp-3
* 000240 M . . . . . . . . . . . . . . . 0000001132 00000002  WS E    Comp-3     R
* 000243 REMAINING-TERM. . . . . . . . . 0000001134 00000002  WS E    Comp-3
* 000244 R . . . . . . . . . . . . . . . 0000001134 00000002  WS E    Comp-3     R
* 000247 LOAN-TERM . . . . . . . . . . . 0000001136 00000002  WS E    Comp-3
* 000248 N . . . . . . . . . . . . . . . 0000001136 00000002  WS E    Comp-3     R
* 000251 EXPIRED-TERM. . . . . . . . . . 0000001138 00000002  WS E    Comp-3
* 000252 E . . . . . . . . . . . . . . . 0000001138 00000002  WS E    Comp-3     R
* 000255 PRUDENTIAL-WORK-AMT . . . . . . 0000001140 00000008  WS E    Comp-3
* 000257 PWK . . . . . . . . . . . . . . 0000001140 00000008  WS E    Comp-3     R
* 000260 FACTOR. . . . . . . . . . . . . 0000001148 00000007  WS E    Comp-3
* 000261 VX. . . . . . . . . . . . . . . 0000001155 00000008  WS E    Comp-3
* 000262 SV. . . . . . . . . . . . . . . 0000001163 00000008  WS E    Comp-3
* 000263 SV-MINUS-ONE. . . . . . . . . . 0000001171 00000007  WS E    Comp-3
* 000264 SX. . . . . . . . . . . . . . . 0000001178 00000008  WS E    Comp-3
* 000265 SE. . . . . . . . . . . . . . . 0000001186 00000006  WS E    Comp-3
* 000266 N2. . . . . . . . . . . . . . . 0000001192 00000004  WS E    Comp-3
* 000267 N3. . . . . . . . . . . . . . . 0000001196 00000004  WS E    Comp-3
* 000268 K-I . . . . . . . . . . . . . . 0000001200 00000005  WS E    Comp-3
* 000270 BINARY-WORK-AREA. . . . . . . . 0000001205 00000016  WS G    AlphNum
* 000271 X1. . . . . . . . . . . . . . . 0000001205 00000002  WS E    Comp
* 000272 X2. . . . . . . . . . . . . . . 0000001207 00000002  WS E    Comp
* 000273 MAX-X . . . . . . . . . . . . . 0000001209 00000004  WS E    Comp
* 000274 B1. . . . . . . . . . . . . . . 0000001213 00000004  WS E    Comp
* 000275 LINDX . . . . . . . . . . . . . 0000001217 00000002  WS E    Comp
* 000276 AHNDX . . . . . . . . . . . . . 0000001219 00000002  WS E    Comp
* 000278 CSO-RATE-WORK-AREAS . . . . . . 0000001221 00000007  WS G    AlphNum
* 000279 C-PMTS-PER-YEAR . . . . . . . . 0000001221 00000003  WS E    Comp-3
* 000280 C-DAYS-IN-PMT-PER . . . . . . . 0000001224 00000002  WS E    Comp-3
* 000281 C-TOT-PMTS. . . . . . . . . . . 0000001226 00000002  WS E    Comp-3
* 000283 WS-WORK-MISC. . . . . . . . . . 0000001228 00000082  WS G    AlphNum
* 000284 WS-EXTRA-PMTS . . . . . . . . . 0000001228 00000002  WS E    Comp-3
* 000285 NET-BEN . . . . . . . . . . . . 0000001230 00000007  WS E    Comp-3
* 000286 WS-RATE-TERM. . . . . . . . . . 0000001237 00000002  WS E    Comp-3
* 000288 WS-AGE. . . . . . . . . . . . . 0000001239 00000003  WS E    Comp-3
* 000289 WS-AH-FACE-BENEFIT. . . . . . . 0000001242 00000004  WS E    Comp-3
* 000290 WS-COUNTER. . . . . . . . . . . 0000001246 00000002  WS E    Comp-3
* 000291 WS-WORK-RATE. . . . . . . . . . 0000001248 00000006  WS E    Comp-3
* 000292 WS-DISCOUNT-OPTION. . . . . . . 0000001254 00000001  WS E    AlphNum
* 000293 WS-DUE-DATE . . . . . . . . . . 0000001255 00000004  WS E    Comp-3
* 000294 WS-INT-BEGIN-DATE . . . . . . . 0000001259 00000004  WS E    Comp-3
* 000295 WS-X-Y-FACTOR . . . . . . . . . 0000001263 00000010  WS E    Comp-3
* 000296 WS-Y-X-FACTOR . . . . . . . . . 0000001273 00000010  WS E    Comp-3
* 000297 WS-ODD-DAY-UNITS. . . . . . . . 0000001283 00000010  WS E    Comp-3
* 000298 WS-CALC-FREQ-RATE . . . . . . . 0000001293 00000009  WS E    Comp-3
* 000299 WS-NP-FACTOR. . . . . . . . . . 0000001302 00000008  WS E    Comp-3
* 000316 DATE-CONVERSION-DATA. . . . . . 0000001312 00000200  WS G    AlphNum
* 000317 DC-COMM-LENGTH. . . . . . . . . 0000001312 00000002  WS E    Comp
* 000318 DC-OPTION-CODE. . . . . . . . . 0000001314 00000001  WS E    AlphNum
* 000355 DC-ERROR-CODE . . . . . . . . . 0000001315 00000001  WS E    AlphNum
* 000369 DC-END-OF-MONTH . . . . . . . . 0000001316 00000001  WS E    AlphNum
* 000371 DC-CENTURY-ADJUSTMENT . . . . . 0000001317 00000001  WS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 102
* ELRFNDX.cbl
* 000375 Filler. . . . . . . . . . . . . 0000001318 00000001  WS E    AlphNum
* 000376 DC-CONVERSION-DATES . . . . . . 0000001319 00000065  WS G    AlphNum
* 000377 DC-BIN-DATE-1 . . . . . . . . . 0000001319 00000002  WS E    AlphNum
* 000378 DC-BIN-DATE-2 . . . . . . . . . 0000001321 00000002  WS E    AlphNum
* 000379 DC-GREG-DATE-1-EDIT . . . . . . 0000001323 00000008  WS E    AlphNum
* 000380 DC-GREG-DATE-1-EDIT-R . . . . . 0000001323 00000008  WS G    AlphNum    R
* 000382 DC-EDIT1-MONTH. . . . . . . . . 0000001323 00000002  WS E    Display
* 000383 SLASH1-1. . . . . . . . . . . . 0000001325 00000001  WS E    AlphNum
* 000384 DC-EDIT1-DAY. . . . . . . . . . 0000001326 00000002  WS E    Display
* 000385 SLASH1-2. . . . . . . . . . . . 0000001328 00000001  WS E    AlphNum
* 000386 DC-EDIT1-YEAR . . . . . . . . . 0000001329 00000002  WS E    Display
* 000387 DC-GREG-DATE-2-EDIT . . . . . . 0000001331 00000008  WS E    AlphNum
* 000388 DC-GREG-DATE-2-EDIT-R . . . . . 0000001331 00000008  WS G    AlphNum    R
* 000390 DC-EDIT2-MONTH. . . . . . . . . 0000001331 00000002  WS E    Display
* 000391 SLASH2-1. . . . . . . . . . . . 0000001333 00000001  WS E    AlphNum
* 000392 DC-EDIT2-DAY. . . . . . . . . . 0000001334 00000002  WS E    Display
* 000393 SLASH2-2. . . . . . . . . . . . 0000001336 00000001  WS E    AlphNum
* 000394 DC-EDIT2-YEAR . . . . . . . . . 0000001337 00000002  WS E    Display
* 000395 DC-GREG-DATE-1-YMD. . . . . . . 0000001339 00000006  WS E    Display
* 000396 DC-GREG-DATE-1-YMD-R. . . . . . 0000001339 00000006  WS G    AlphNum    R
* 000398 DC-YMD-YEAR . . . . . . . . . . 0000001339 00000002  WS E    Display
* 000399 DC-YMD-MONTH. . . . . . . . . . 0000001341 00000002  WS E    Display
* 000400 DC-YMD-DAY. . . . . . . . . . . 0000001343 00000002  WS E    Display
* 000401 DC-GREG-DATE-1-MDY. . . . . . . 0000001345 00000006  WS E    Display
* 000402 DC-GREG-DATE-1-MDY-R. . . . . . 0000001345 00000006  WS G    AlphNum    R
* 000404 DC-MDY-MONTH. . . . . . . . . . 0000001345 00000002  WS E    Display
* 000405 DC-MDY-DAY. . . . . . . . . . . 0000001347 00000002  WS E    Display
* 000406 DC-MDY-YEAR . . . . . . . . . . 0000001349 00000002  WS E    Display
* 000407 DC-GREG-DATE-1-ALPHA. . . . . . 0000001351 00000018  WS G    AlphNum
* 000408 DC-ALPHA-MONTH. . . . . . . . . 0000001351 00000010  WS E    AlphNum
* 000409 DC-ALPHA-DAY. . . . . . . . . . 0000001361 00000002  WS E    Display
* 000410 Filler. . . . . . . . . . . . . 0000001363 00000002  WS E    AlphNum
* 000411 DC-ALPHA-CENTURY. . . . . . . . 0000001365 00000002  WS G    AlphNum
* 000412 DC-ALPHA-CEN-N. . . . . . . . . 0000001365 00000002  WS E    Display
* 000413 DC-ALPHA-YEAR . . . . . . . . . 0000001367 00000002  WS E    Display
* 000414 DC-ELAPSED-MONTHS . . . . . . . 0000001369 00000002  WS E    Comp
* 000415 DC-ODD-DAYS-OVER. . . . . . . . 0000001371 00000002  WS E    Comp
* 000416 DC-ELAPSED-DAYS . . . . . . . . 0000001373 00000002  WS E    Comp
* 000417 DC-JULIAN-DATE. . . . . . . . . 0000001375 00000005  WS E    Display
* 000418 DC-JULIAN-YYDDD . . . . . . . . 0000001375 00000005  WS E    Display    R
* 000420 DC-JULIAN-DT. . . . . . . . . . 0000001375 00000005  WS G    AlphNum    R
* 000421 DC-JULIAN-YEAR. . . . . . . . . 0000001375 00000002  WS E    Display
* 000422 DC-JULIAN-DAYS. . . . . . . . . 0000001377 00000003  WS E    Display
* 000423 DC-DAYS-IN-MONTH. . . . . . . . 0000001380 00000002  WS E    Comp-3
* 000424 DC-DAY-OF-WEEK. . . . . . . . . 0000001382 00000001  WS E    Comp-3
* 000425 DC-DAY-OF-WEEK2 . . . . . . . . 0000001383 00000001  WS E    Comp-3
* 000426 DATE-CONVERSION-VARIBLES. . . . 0000001384 00000078  WS G    AlphNum
* 000427 HOLD-CENTURY-1. . . . . . . . . 0000001384 00000011  WS E    Display
* 000428 HOLD-CENTURY-1-SPLIT. . . . . . 0000001384 00000011  WS G    AlphNum    R
* 000429 Filler. . . . . . . . . . . . . 0000001384 00000003  WS E    Display
* 000430 HOLD-CEN-1-CCYY . . . . . . . . 0000001387 00000004  WS G    AlphNum
* 000431 HOLD-CEN-1-CC . . . . . . . . . 0000001387 00000002  WS E    Display
* 000432 HOLD-CEN-1-YY . . . . . . . . . 0000001389 00000002  WS E    Display
* 000433 HOLD-CEN-1-MO . . . . . . . . . 0000001391 00000002  WS E    Display
* 000434 HOLD-CEN-1-DA . . . . . . . . . 0000001393 00000002  WS E    Display
* 000435 HOLD-CENTURY-1-R. . . . . . . . 0000001384 00000011  WS G    AlphNum    R
* 000436 HOLD-CEN-1-R-MO . . . . . . . . 0000001384 00000002  WS E    Display
* 000437 HOLD-CEN-1-R-DA . . . . . . . . 0000001386 00000002  WS E    Display
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 103
* ELRFNDX.cbl
* 000438 HOLD-CEN-1-R-CCYY . . . . . . . 0000001388 00000004  WS G    AlphNum
* 000439 HOLD-CEN-1-R-CC . . . . . . . . 0000001388 00000002  WS E    Display
* 000440 HOLD-CEN-1-R-YY . . . . . . . . 0000001390 00000002  WS E    Display
* 000441 Filler. . . . . . . . . . . . . 0000001392 00000003  WS E    Display
* 000442 HOLD-CENTURY-1-X. . . . . . . . 0000001395 00000011  WS G    AlphNum
* 000443 Filler. . . . . . . . . . . . . 0000001395 00000003  WS E    AlphNum
* 000444 HOLD-CEN-1-X-CCYY . . . . . . . 0000001398 00000004  WS G    AlphNum
* 000445 HOLD-CEN-1-X-CC . . . . . . . . 0000001398 00000002  WS E    AlphNum
* 000446 HOLD-CEN-1-X-YY . . . . . . . . 0000001400 00000002  WS E    AlphNum
* 000447 HOLD-CEN-1-X-MO . . . . . . . . 0000001402 00000002  WS E    AlphNum
* 000448 HOLD-CEN-1-X-DA . . . . . . . . 0000001404 00000002  WS E    AlphNum
* 000449 HOLD-CENTURY-1-R-X. . . . . . . 0000001395 00000011  WS G    AlphNum    R
* 000450 HOLD-CEN-1-R-X-MO . . . . . . . 0000001395 00000002  WS E    AlphNum
* 000451 HOLD-CEN-1-R-X-DA . . . . . . . 0000001397 00000002  WS E    AlphNum
* 000452 HOLD-CEN-1-R-X-CCYY . . . . . . 0000001399 00000004  WS G    AlphNum
* 000453 HOLD-CEN-1-R-X-CC . . . . . . . 0000001399 00000002  WS E    AlphNum
* 000454 HOLD-CEN-1-R-X-YY . . . . . . . 0000001401 00000002  WS E    AlphNum
* 000455 Filler. . . . . . . . . . . . . 0000001403 00000003  WS E    AlphNum
* 000456 DC-BIN-DATE-EXPAND-1. . . . . . 0000001406 00000003  WS E    AlphNum
* 000457 DC-BIN-DATE-EXPAND-2. . . . . . 0000001409 00000003  WS E    AlphNum
* 000458 DC-JULIAN-DATE-1. . . . . . . . 0000001412 00000007  WS E    Display
* 000459 DC-JULIAN-DATE-1-R. . . . . . . 0000001412 00000007  WS G    AlphNum    R
* 000460 DC-JULIAN-1-CCYY. . . . . . . . 0000001412 00000004  WS G    AlphNum
* 000461 DC-JULIAN-1-CC. . . . . . . . . 0000001412 00000002  WS E    Display
* 000462 DC-JULIAN-1-YR. . . . . . . . . 0000001414 00000002  WS E    Display
* 000463 DC-JULIAN-DA-1. . . . . . . . . 0000001416 00000003  WS E    Display
* 000464 DC-JULIAN-DATE-2. . . . . . . . 0000001419 00000007  WS E    Display
* 000465 DC-JULIAN-DATE-2-R. . . . . . . 0000001419 00000007  WS G    AlphNum    R
* 000466 DC-JULIAN-2-CCYY. . . . . . . . 0000001419 00000004  WS G    AlphNum
* 000467 DC-JULIAN-2-CC. . . . . . . . . 0000001419 00000002  WS E    Display
* 000468 DC-JULIAN-2-YR. . . . . . . . . 0000001421 00000002  WS E    Display
* 000469 DC-JULIAN-DA-2. . . . . . . . . 0000001423 00000003  WS E    Display
* 000470 DC-GREG-DATE-A-EDIT . . . . . . 0000001426 00000010  WS G    AlphNum
* 000471 DC-EDITA-MONTH. . . . . . . . . 0000001426 00000002  WS E    Display
* 000472 SLASHA-1. . . . . . . . . . . . 0000001428 00000001  WS E    AlphNum
* 000473 DC-EDITA-DAY. . . . . . . . . . 0000001429 00000002  WS E    Display
* 000474 SLASHA-2. . . . . . . . . . . . 0000001431 00000001  WS E    AlphNum
* 000475 DC-EDITA-CCYY . . . . . . . . . 0000001432 00000004  WS G    AlphNum
* 000476 DC-EDITA-CENT . . . . . . . . . 0000001432 00000002  WS E    Display
* 000477 DC-EDITA-YEAR . . . . . . . . . 0000001434 00000002  WS E    Display
* 000478 DC-GREG-DATE-B-EDIT . . . . . . 0000001436 00000010  WS G    AlphNum
* 000479 DC-EDITB-MONTH. . . . . . . . . 0000001436 00000002  WS E    Display
* 000480 SLASHB-1. . . . . . . . . . . . 0000001438 00000001  WS E    AlphNum
* 000481 DC-EDITB-DAY. . . . . . . . . . 0000001439 00000002  WS E    Display
* 000482 SLASHB-2. . . . . . . . . . . . 0000001441 00000001  WS E    AlphNum
* 000483 DC-EDITB-CCYY . . . . . . . . . 0000001442 00000004  WS G    AlphNum
* 000484 DC-EDITB-CENT . . . . . . . . . 0000001442 00000002  WS E    Display
* 000485 DC-EDITB-YEAR . . . . . . . . . 0000001444 00000002  WS E    Display
* 000486 DC-GREG-DATE-CYMD . . . . . . . 0000001446 00000008  WS E    Display
* 000487 DC-GREG-DATE-CYMD-R . . . . . . 0000001446 00000008  WS G    AlphNum    R
* 000489 DC-CYMD-CEN . . . . . . . . . . 0000001446 00000002  WS E    Display
* 000490 DC-CYMD-YEAR. . . . . . . . . . 0000001448 00000002  WS E    Display
* 000491 DC-CYMD-MONTH . . . . . . . . . 0000001450 00000002  WS E    Display
* 000492 DC-CYMD-DAY . . . . . . . . . . 0000001452 00000002  WS E    Display
* 000493 DC-GREG-DATE-MDCY . . . . . . . 0000001454 00000008  WS E    Display
* 000494 DC-GREG-DATE-MDCY-R . . . . . . 0000001454 00000008  WS G    AlphNum    R
* 000496 DC-MDCY-MONTH . . . . . . . . . 0000001454 00000002  WS E    Display
* 000497 DC-MDCY-DAY . . . . . . . . . . 0000001456 00000002  WS E    Display
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 104
* ELRFNDX.cbl
* 000498 DC-MDCY-CEN . . . . . . . . . . 0000001458 00000002  WS E    Display
* 000499 DC-MDCY-YEAR. . . . . . . . . . 0000001460 00000002  WS E    Display
* 000500 DC-FORCE-EL310-DATE-SW. . . . . 0000001462 00000001  WS E    AlphNum
* 000502 DC-EL310-DATE . . . . . . . . . 0000001463 00000021  WS E    AlphNum
* 000503 Filler. . . . . . . . . . . . . 0000001484 00000028  WS E    AlphNum
* 000698 CALCULATION-PASS-AREA . . . . . 0000000000 00000450  LS G    AlphNum
* 000699 CP-COMM-LENGTH. . . . . . . . . 0000000000 00000002  LS E    Comp
* 000702 CP-RETURN-CODE. . . . . . . . . 0000000002 00000001  LS E    AlphNum
* 000725 CP-RETURN-CODE-2. . . . . . . . 0000000003 00000001  LS E    AlphNum
* 000729 CP-CALCULATION-AREA . . . . . . 0000000004 00000446  LS G    AlphNum
* 000730 CP-ACCOUNT-NUMBER . . . . . . . 0000000004 00000010  LS E    AlphNum
* 000731 CP-CERT-EFF-DT. . . . . . . . . 0000000014 00000002  LS E    AlphNum
* 000732 CP-VALUATION-DT . . . . . . . . 0000000016 00000002  LS E    AlphNum
* 000733 CP-PAID-THRU-DT . . . . . . . . 0000000018 00000002  LS E    AlphNum
* 000734 CP-BENEFIT-TYPE . . . . . . . . 0000000020 00000001  LS E    AlphNum
* 000739 CP-INCURRED-DT. . . . . . . . . 0000000021 00000002  LS E    AlphNum
* 000740 CP-REPORTED-DT. . . . . . . . . 0000000023 00000002  LS E    AlphNum
* 000741 CP-ACCT-FLD-5 . . . . . . . . . 0000000025 00000002  LS E    AlphNum
* 000742 CP-COMPANY-ID . . . . . . . . . 0000000027 00000003  LS E    AlphNum
* 000743 CP-ISSUE-AGE. . . . . . . . . . 0000000030 00000002  LS E    Comp-3
* 000745 CP-CDT-PERCENT. . . . . . . . . 0000000032 00000003  LS E    Comp-3
* 000747 CP-CDT-METHOD . . . . . . . . . 0000000035 00000001  LS E    AlphNum
* 000751 CP-CLAIM-TYPE . . . . . . . . . 0000000036 00000001  LS E    AlphNum
* 000754 CP-ORIGINAL-TERM. . . . . . . . 0000000037 00000002  LS E    Comp-3
* 000756 CP-ORIGINAL-BENEFIT . . . . . . 0000000039 00000006  LS E    Comp-3
* 000758 CP-ORIGINAL-PREMIUM . . . . . . 0000000045 00000005  LS E    Comp-3
* 000760 CP-REMAINING-TERM . . . . . . . 0000000050 00000003  LS E    Comp-3
* 000762 CP-REMAINING-BENEFIT. . . . . . 0000000053 00000006  LS E    Comp-3
* 000764 CP-LOAN-APR . . . . . . . . . . 0000000059 00000004  LS E    Comp-3
* 000766 CP-PAY-FREQUENCY. . . . . . . . 0000000063 00000002  LS E    Comp-3
* 000768 CP-REM-TERM-METHOD. . . . . . . 0000000065 00000001  LS E    AlphNum
* 000776 CP-EARNING-METHOD . . . . . . . 0000000066 00000001  LS E    AlphNum
* 000791 CP-PROCESS-TYPE . . . . . . . . 0000000067 00000001  LS E    AlphNum
* 000795 CP-SPECIAL-CALC-CD. . . . . . . 0000000068 00000001  LS E    AlphNum
* 000829 CP-LOAN-TERM. . . . . . . . . . 0000000069 00000002  LS E    Comp-3
* 000831 CP-CLASS-CODE . . . . . . . . . 0000000071 00000002  LS E    AlphNum
* 000832 CP-DEVIATION-CODE . . . . . . . 0000000073 00000003  LS E    AlphNum
* 000833 CP-STATE. . . . . . . . . . . . 0000000076 00000002  LS E    AlphNum
* 000834 CP-STATE-STD-ABBRV. . . . . . . 0000000078 00000002  LS E    AlphNum
* 000835 CP-BENEFIT-CD . . . . . . . . . 0000000080 00000002  LS E    AlphNum
* 000838 CP-R78-OPTION . . . . . . . . . 0000000082 00000001  LS E    AlphNum
* 000842 CP-COMPANY-CD . . . . . . . . . 0000000083 00000001  LS E    AlphNum
* 000843 CP-IBNR-RESERVE-SW. . . . . . . 0000000084 00000001  LS E    AlphNum
* 000844 CP-CLAIM-STATUS . . . . . . . . 0000000085 00000001  LS E    AlphNum
* 000845 CP-RATE-FILE. . . . . . . . . . 0000000086 00000001  LS E    AlphNum
* 000846 CP-TERM-OR-EXT-DAYS . . . . . . 0000000087 00000003  LS E    Comp-3
* 000849 CP-LIFE-OVERRIDE-CODE . . . . . 0000000090 00000001  LS E    AlphNum
* 000850 CP-AH-OVERRIDE-CODE . . . . . . 0000000091 00000001  LS E    AlphNum
* 000852 CP-RATE-DEV-PCT . . . . . . . . 0000000092 00000004  LS E    Comp-3
* 000854 CP-CLP-RATE-UP. . . . . . . . . 0000000092 00000004  LS E    Comp-3     R
* 000856 CP-CRITICAL-MONTHS. . . . . . . 0000000096 00000002  LS E    Comp-3
* 000858 CP-ALTERNATE-BENEFIT. . . . . . 0000000098 00000006  LS E    Comp-3
* 000860 CP-ALTERNATE-PREMIUM. . . . . . 0000000104 00000005  LS E    Comp-3
* 000862 CP-DDF-CSO-ADMIN-FEE. . . . . . 0000000104 00000005  LS E    Comp-3     R
* 000865 CP-PAID-FROM-DATE . . . . . . . 0000000109 00000002  LS E    AlphNum
* 000866 CP-CLAIM-CALC-METHOD. . . . . . 0000000111 00000001  LS E    AlphNum
* 000867 CP-EXT-DAYS-CALC. . . . . . . . 0000000112 00000001  LS E    AlphNum
* 000872 CP-DOMICILE-STATE . . . . . . . 0000000113 00000002  LS E    AlphNum
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 105
* ELRFNDX.cbl
* 000873 CP-CARRIER. . . . . . . . . . . 0000000115 00000001  LS E    AlphNum
* 000874 CP-REIN-FLAG. . . . . . . . . . 0000000116 00000001  LS E    AlphNum
* 000875 CP-REM-TRM-CALC-OPTION. . . . . 0000000117 00000001  LS E    AlphNum
* 000886 CP-SIG-SWITCH . . . . . . . . . 0000000118 00000001  LS E    AlphNum
* 000887 CP-RATING-METHOD. . . . . . . . 0000000119 00000001  LS E    AlphNum
* 000897 CP-SALES-TAX. . . . . . . . . . 0000000120 00000003  LS E    Comp-3
* 000899 CP-BEN-CATEGORY . . . . . . . . 0000000123 00000001  LS E    AlphNum
* 000900 CP-DCC-LF-RATE. . . . . . . . . 0000000124 00000004  LS E    Comp-3
* 000901 CP-DCC-ACT-COMM . . . . . . . . 0000000124 00000004  LS E    Comp-3     R
* 000903 CP-DCC-AH-RATE. . . . . . . . . 0000000128 00000004  LS E    Comp-3
* 000904 CP-DCC-PMF-COMM . . . . . . . . 0000000128 00000004  LS E    Comp-3     R
* 000906 CP-DAYS-TO-1ST-PMT. . . . . . . 0000000132 00000002  LS E    Comp-3
* 000907 CP-AH-BALLOON-SW. . . . . . . . 0000000134 00000001  LS E    AlphNum
* 000908 CP-EXPIRE-DT. . . . . . . . . . 0000000135 00000002  LS E    AlphNum
* 000909 CP-LF-CLAIM-CALC-SW . . . . . . 0000000137 00000001  LS E    AlphNum
* 000910 CP-DDF-HI-FACT. . . . . . . . . 0000000138 00000003  LS E    Comp-3
* 000911 CP-DDF-LO-FACT. . . . . . . . . 0000000141 00000003  LS E    Comp-3
* 000912 CP-DDF-CLP. . . . . . . . . . . 0000000144 00000004  LS E    Comp-3
* 000913 CP-DDF-SPEC-CALC. . . . . . . . 0000000148 00000001  LS E    AlphNum
* 000916 CP-IU-RATE-UP . . . . . . . . . 0000000149 00000004  LS E    Comp-3
* 000917 CP-CANCEL-REASON. . . . . . . . 0000000153 00000001  LS E    AlphNum
* 000918 CP-DDF-ADMIN-FEES . . . . . . . 0000000154 00000004  LS E    Comp-3
* 000919 CP-PMT-MODE . . . . . . . . . . 0000000158 00000001  LS E    AlphNum
* 000920 CP-NO-OF-PMTS . . . . . . . . . 0000000159 00000002  LS E    Comp-3
* 000921 CP-1ST-YR-ALLOW . . . . . . . . 0000000161 00000003  LS E    Comp-3
* 000922 CP-DDF-COMM-AND-MFEE. . . . . . 0000000164 00000004  LS E    Comp-3
* 000923 CP-DDF-YR1AF. . . . . . . . . . 0000000168 00000004  LS E    Comp-3
* 000924 Filler. . . . . . . . . . . . . 0000000172 00000001  LS E    AlphNum
* 000928 CP-CDT-TABLE. . . . . . . . . . 0000000173 00000001  LS E    Display
* 000930 CP-CDT-FACTOR . . . . . . . . . 0000000174 00000006  LS E    Comp-3
* 000932 CP-PTC-RESERVE. . . . . . . . . 0000000180 00000005  LS E    Comp-3
* 000934 CP-IBNR-RESERVE . . . . . . . . 0000000185 00000005  LS E    Comp-3
* 000936 CP-FUTURE-RESERVE . . . . . . . 0000000190 00000005  LS E    Comp-3
* 000938 Filler. . . . . . . . . . . . . 0000000195 00000009  LS E    AlphNum
* 000941 CP-REMAINING-TERM-1 . . . . . . 0000000204 00000003  LS E    Comp-3
* 000943 CP-REMAINING-TERM-2 . . . . . . 0000000207 00000003  LS E    Comp-3
* 000945 CP-REMAINING-TERM-3 . . . . . . 0000000210 00000003  LS E    Comp-3
* 000947 CP-ODD-DAYS . . . . . . . . . . 0000000213 00000002  LS E    Comp-3
* 000949 Filler. . . . . . . . . . . . . 0000000215 00000012  LS E    AlphNum
* 000953 CP-REMAINING-AMT. . . . . . . . 0000000227 00000006  LS E    Comp-3
* 000955 CP-REMAINING-AMT-PRV. . . . . . 0000000233 00000006  LS E    Comp-3
* 000957 Filler. . . . . . . . . . . . . 0000000239 00000012  LS E    AlphNum
* 000961 CP-CALC-PREMIUM . . . . . . . . 0000000251 00000005  LS E    Comp-3
* 000963 CP-PREMIUM-RATE . . . . . . . . 0000000256 00000004  LS E    Comp-3
* 000965 CP-MORTALITY-CODE . . . . . . . 0000000260 00000004  LS E    AlphNum
* 000966 CP-RATE-EDIT-FLAG . . . . . . . 0000000264 00000001  LS E    AlphNum
* 000968 CP-COMPOSITE-RATE . . . . . . . 0000000265 00000003  LS E    Comp-3
* 000970 CP-CANCEL-FEE . . . . . . . . . 0000000268 00000003  LS E    Comp-3
* 000971 CP-LF-PREM. . . . . . . . . . . 0000000271 00000005  LS E    Comp-3
* 000972 CP-LF-BALLOON-PREM. . . . . . . 0000000271 00000005  LS E    Comp-3     R
* 000974 Filler. . . . . . . . . . . . . 0000000276 00000007  LS E    AlphNum
* 000978 CP-CALC-REFUND. . . . . . . . . 0000000283 00000005  LS E    Comp-3
* 000980 CP-REFUND-TYPE-USED . . . . . . 0000000288 00000001  LS E    AlphNum
* 000995 Filler. . . . . . . . . . . . . 0000000289 00000012  LS E    AlphNum
* 000999 CP-R78-U-PRM. . . . . . . . . . 0000000301 00000005  LS E    Comp-3
* 001001 CP-R78-U-PRM-ALT. . . . . . . . 0000000306 00000005  LS E    Comp-3
* 001003 CP-PRORATA-U-PRM. . . . . . . . 0000000311 00000005  LS E    Comp-3
* 001005 CP-PRORATA-U-PRM-ALT. . . . . . 0000000316 00000005  LS E    Comp-3
* Micro Focus Server Express         V5.1 revision 000 13-Jul-22 11:35 Page 106
* ELRFNDX.cbl
* 001007 CP-STATE-U-PRM. . . . . . . . . 0000000321 00000005  LS E    Comp-3
* 001009 CP-DOMICILE-U-PRM . . . . . . . 0000000326 00000005  LS E    Comp-3
* 001011 CP-EARNING-TYPE-USED. . . . . . 0000000331 00000001  LS E    AlphNum
* 001021 Filler. . . . . . . . . . . . . 0000000332 00000012  LS E    AlphNum
* 001025 CP-ACTUAL-DAYS. . . . . . . . . 0000000344 00000003  LS E    Comp-3
* 001027 CP-CLAIM-PAYMENT. . . . . . . . 0000000347 00000005  LS E    Comp-3
* 001029 Filler. . . . . . . . . . . . . 0000000352 00000012  LS E    AlphNum
* 001032 CP-TOTAL-PAID . . . . . . . . . 0000000364 00000005  LS E    Comp-3
* 001034 CP-R-MAX-ATT-AGE. . . . . . . . 0000000369 00000002  LS E    Comp-3
* 001036 CP-R-MAX-AGE. . . . . . . . . . 0000000371 00000002  LS E    Comp-3
* 001038 CP-R-MAX-TERM . . . . . . . . . 0000000373 00000003  LS E    Comp-3
* 001040 CP-R-MAX-TOT-BEN. . . . . . . . 0000000376 00000005  LS E    Comp-3
* 001042 CP-R-MAX-MON-BEN. . . . . . . . 0000000381 00000005  LS E    Comp-3
* 001044 CP-IO-FUNCTION. . . . . . . . . 0000000386 00000001  LS E    AlphNum
* 001049 CP-FIRST-PAY-DATE . . . . . . . 0000000387 00000002  LS E    AlphNum
* 001051 CP-JOINT-INDICATOR. . . . . . . 0000000389 00000001  LS E    AlphNum
* 001053 CP-RESERVE-REMAINING-TERM . . . 0000000390 00000003  LS E    Comp-3
* 001057 CP-INSURED-BIRTH-DT . . . . . . 0000000393 00000002  LS E    AlphNum
* 001059 CP-INCURRED-AGE . . . . . . . . 0000000395 00000002  LS E    Comp-3
* 001062 CP-MONTHLY-PAYMENT. . . . . . . 0000000397 00000004  LS E    Comp-3
* 001065 CP-RATING-BENEFIT-AMT . . . . . 0000000401 00000006  LS E    Comp-3
* 001068 CP-ODD-DAYS-TO-PMT. . . . . . . 0000000407 00000002  LS E    Comp-3
* 001071 CP-MNTHS-TO-FIRST-PMT . . . . . 0000000409 00000002  LS E    Comp-3
* 001074 CP-REMAMT-FACTOR. . . . . . . . 0000000411 00000007  LS E    Comp-3
* 001077 CP-FREE-LOOK. . . . . . . . . . 0000000418 00000002  LS E    Comp-3
* 001080 CP-ROA-REFUND . . . . . . . . . 0000000420 00000001  LS E    AlphNum
* 001083 CP-NET-BENEFIT-AMT. . . . . . . 0000000421 00000006  LS E    Comp-3
* 001085 CP-SCNP-6MO-AMT . . . . . . . . 0000000427 00000006  LS E    Comp-3
* 001087 CP-MONTH. . . . . . . . . . . . 0000000433 00000002  LS E    Comp-3
* 001088 CP-EXTRA-PERIODS. . . . . . . . 0000000435 00000001  LS E    Display
* 001089 CP-NET-ONLY-STATE . . . . . . . 0000000436 00000001  LS E    AlphNum
* 001090 Filler. . . . . . . . . . . . . 0000000437 00000013  LS E    AlphNum
* 000000 XML-TEXT. . . . . . . . . . . . 0000000000 00000001  LS E    AlphNum      G
* 000000 XML-NTEXT . . . . . . . . . . . 0000000000 00000002  LS E    AlphNum      G
* 000000 XML-CODE. . . . . . . . . . . . 0000001520 00000004  PG E    Comp         G
* 000000 XML-EVENT . . . . . . . . . . . 0000001524 00000030  PG E    AlphNum      G
* 000000 RETURN-CODE . . . . . . . . . . 0000001556 00000004  PG E    Comp         G
* 000000 SORT-RETURN . . . . . . . . . . 0000001560 00000002  PG E    Comp         G
* 000000 TALLY . . . . . . . . . . . . . 0000001564 00000004  PG E    Comp         G
* 000000 SORT-MESSAGE. . . . . . . . . . 0000001568 00000008  PG E    AlphNum      G
* 000000 SORT-FILE-SIZE. . . . . . . . . 0000001576 00000004  PG E    Comp         G
* 000000 SORT-MODE-SIZE. . . . . . . . . 0000001580 00000004  PG E    Comp         G
* 000000 SORT-CORE-SIZE. . . . . . . . . 0000001584 00000004  PG E    Comp         G
* 000000 SORT-CONTROL. . . . . . . . . . 0000001588 00000008  PG E    AlphNum      G
* 000000 SHIFT-OUT . . . . . . . . . . . 0000001596 00000001  PG E    AlphNum      G
* 000000 SHIFT-IN. . . . . . . . . . . . 0000001600 00000001  PG E    AlphNum      G
*
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1724     Code:       44728
