* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL301.cbl
* Options: int("EL301.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL301.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL301.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL301.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         04/18/98
     2                                                                  EL301
     3 PROGRAM-ID.                 EL301 .                                 LV004
     4*              PROGRAM CONVERTED BY                               EL301
     5*              COBOL CONVERSION AID PO 5785-ABJ                   EL301
     6*              CONVERSION DATE 02/13/96 07:44:39.                 EL301
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE            EL301
     8*                            VMOD=2.003                           EL301
     9                                                                  EL301
    10                                                                  EL301
    11*AUTHOR.     LOGIC, INC.                                          EL301
    12*            DALLAS, TEXAS.                                       EL301
    13                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL301.cbl
    14*DATE-COMPILED.                                                   EL301
    15                                                                  EL301
    16*SECURITY.   *****************************************************EL301
    17*            *                                                   *EL301
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *EL301
    19*            *                                                   *EL301
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *EL301
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *EL301
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *EL301
    23*            *                                                   *EL301
    24*            *****************************************************EL301
    25                                                                  EL301
    26*REMARKS.    *****************************************************EL301
    27*            *                                                   *EL301
    28*            *    THIS PROGRAM GENERATES A CONVERSION CALENDAR   *EL301
    29*            *    FOR A 100 YEAR PERIOD FROM 1916 TO 2015.  THE  *EL301
    30*            *    DATES FOR EACH DAY OF THE SPECIFIED YEAR WILL  *EL301
    31*            *    APPEAR AS FOLLOWS:  I. GREGORIAN   (MM/DD/YY)  *EL301
    32*            *                       II. NUMBER OF DAYS SINCE    *EL301
    33*            *                           1900 IN HEX FORMAT.     *EL301
    34*            *                      III. JULIAN   (YY/DDD)       *EL301
    35*            *                                                   *EL301
    36*            *****************************************************EL301
    37                                                                  EL301
    38 ENVIRONMENT DIVISION.                                            EL301
    39 INPUT-OUTPUT SECTION.                                            EL301
    40 FILE-CONTROL.                                                    EL301
    41                                                                  EL301
    42     SELECT PRINTER ASSIGN TO SYS008-UR-1403-S-SYS008.            EL301
    43                                                                  EL301
    44 DATA DIVISION.                                                   EL301
    45 FILE SECTION.                                                    EL301
    46                                                                  EL301
    47 FD  PRINTER                                                      EL301
    48     RECORDING MODE IS F.                                         EL301
    49 01  PRINT-RECORD                    PIC X(133).                  EL301
    50                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL301.cbl
    52 WORKING-STORAGE SECTION.                                         EL301
    53 77  FILLER   PIC X(32) VALUE '********************************'. EL301
    54 77  FILLER   PIC X(32) VALUE '**  EL301   WORKING STORAGE   **'. EL301
    55 77  FILLER   PIC X(32) VALUE '**** V/M 2.003 *****************'. EL301
    56                                                                  EL301
    57 77  DAYS-IN-YEAR                    PIC 999.                     EL301
    58 77  DIVIDE-RESULT                   PIC 99.                      EL301
    59 77  DIVIDE-REMAINDER                PIC 9.                       EL301
    60         88  A-LEAP-YEAR                VALUE ZERO.               EL301
    61                                                                  EL301
    62 77  BLANK-ONE                       PIC X(133)  VALUE SPACES.    EL301
    63 77  BEGINNING-YEAR-DAY              PIC 9(5)    VALUE 16001.     EL301
    64                                                                  EL301
    65 01  WS-ABEND-STORAGE.                                            EL301
    66     12  WS-RETURN-CODE          PIC S9(4)  VALUE ZERO COMP.      EL301
    67     12  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.         EL301
    68     12  WS-ABEND-FILE-STATUS    PIC XX     VALUE ZERO.           EL301
    69     12  WS-ZERO                 PIC S9     VALUE ZERO COMP-3.    EL301
    70                                                                  EL301
    71 01  BINARY-WORK                     PIC 9(8)   COMP.             EL301
    72 01  WORK-BINARY  REDEFINES  BINARY-WORK.                         EL301
    73     05  FILLER                      PIC XX.                      EL301
    74     05  BINARY-DTE                  PIC XX.                      EL301
    75                                                                  EL301
    76 01  CALENDAR-DATE.                                               EL301
    77     05  CALENDAR-YEAR               PIC 99.                      EL301
    78     05  CALENDAR-DAY                PIC 999.                     EL301
    79                                                                  EL301
*   80                                     COPY ELCDATE.                   CL**4
    81******************************************************************06/11/98
    82*                                                                *ELCDATE
    83*                                                                *ELCDATE
    84*                            ELCDATE.                            *   LV023
    85*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
    86*                            VMOD=2.003                           ELCDATE
    87*                                                                *ELCDATE
    88*                                                                *ELCDATE
    89*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
    90*                 LENGTH = 200                                   *   CL*19
    91******************************************************************ELCDATE
    92                                                                  ELCDATE
    93 01  DATE-CONVERSION-DATA.                                        ELCDATE
    94     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
    95     12  DC-OPTION-CODE                PIC X.                        CL*15
    96         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
    97         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
    98         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
    99         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   100         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   101         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   102         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   103         88  FIND-CENTURY               VALUE '7'.                   CL*22
   104         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   105         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   106         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   107         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   108         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   109         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL301.cbl (/apps/prod/cid1p/copy/ELCDATE)
   110         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   111         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   112         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   113         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   114         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   115         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   116         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   117         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   118         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   119         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   120         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   121         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   122         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   123         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   124         88  THREE-CHARACTER-BIN                                  ELCDATE
   125                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   126         88  GREGORIAN-TO-BIN                                        CL**2
   127                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   128         88  BIN-TO-GREGORIAN                                        CL**2
   129                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   130         88  JULIAN-TO-BINARY                                        CL**2
   131                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   132     12  DC-ERROR-CODE                 PIC X.                        CL*15
   133         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   134         88  DATE-CONVERSION-ERROR                                ELCDATE
   135                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   136         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   137         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   138         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   139         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   140         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   141         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   142         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   143         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   144         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   145         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   146     12  DC-END-OF-MONTH               PIC X.                        CL*15
   147         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   148     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   149         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   150         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   151         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   152     12  FILLER                        PIC X.                        CL*15
   153     12  DC-CONVERSION-DATES.                                        CL*15
   154         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   155         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   156         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   157         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   158                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   159             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   160             20  SLASH1-1              PIC X.                        CL*15
   161             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   162             20  SLASH1-2              PIC X.                        CL*15
   163             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   164         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   165         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   166                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   167             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL301.cbl (/apps/prod/cid1p/copy/ELCDATE)
   168             20  SLASH2-1              PIC X.                        CL*15
   169             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   170             20  SLASH2-2              PIC X.                        CL*15
   171             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   172         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   173         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   174                     DC-GREG-DATE-1-YMD.                          ELCDATE
   175             20  DC-YMD-YEAR           PIC 99.                       CL*15
   176             20  DC-YMD-MONTH          PIC 99.                       CL*15
   177             20  DC-YMD-DAY            PIC 99.                       CL*15
   178         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   179         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   180                      DC-GREG-DATE-1-MDY.                         ELCDATE
   181             20  DC-MDY-MONTH          PIC 99.                       CL*15
   182             20  DC-MDY-DAY            PIC 99.                       CL*15
   183             20  DC-MDY-YEAR           PIC 99.                       CL*15
   184         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   185             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   186             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   187             20  FILLER                PIC XX.                       CL*15
   188             20  DC-ALPHA-CENTURY.                                   CL*15
   189                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   190             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   191         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   192         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   193         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   194         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   195         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   196                                       PIC 9(05).                    CL*20
   197         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   198             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   199             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   200         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   201         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   202         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   203     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   204         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   205         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   206             20  FILLER                PIC 9(3).                     CL*15
   207             20  HOLD-CEN-1-CCYY.                                    CL*15
   208                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   209                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   210             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   211             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   212         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   213             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   214             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   215             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   216                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   217                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   218             20  FILLER                PIC 9(3).                     CL*15
   219         16  HOLD-CENTURY-1-X.                                       CL*15
   220             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   221             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   222                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   223                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   224             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   225             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL301.cbl (/apps/prod/cid1p/copy/ELCDATE)
   226         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   227             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   228             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   229             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   230                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   231                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   232             20  FILLER                PIC XXX.                      CL*23
   233         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   234         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   235         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   236         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   237             20  DC-JULIAN-1-CCYY.                                   CL*15
   238                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   239                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   240             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   241         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   242         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   243             20  DC-JULIAN-2-CCYY.                                   CL*15
   244                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   245                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   246             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   247         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   248             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   249             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   250             20  DC-EDITA-DAY          PIC 99.                       CL*15
   251             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   252             20  DC-EDITA-CCYY.                                      CL*15
   253                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   254                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   255         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   256             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   257             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   258             20  DC-EDITB-DAY          PIC 99.                       CL*15
   259             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   260             20  DC-EDITB-CCYY.                                      CL*15
   261                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   262                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   263         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   264         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   265                              DC-GREG-DATE-CYMD.                  ELCDATE
   266             20  DC-CYMD-CEN           PIC 99.                       CL*15
   267             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   268             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   269             20  DC-CYMD-DAY           PIC 99.                       CL*15
   270         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   271         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   272                              DC-GREG-DATE-MDCY.                  ELCDATE
   273             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   274             20  DC-MDCY-DAY           PIC 99.                       CL*15
   275             20  DC-MDCY-CEN           PIC 99.                       CL*15
   276             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   277    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   278        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   279    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   280    12  FILLER                         PIC X(28).                    CL*26
   281                                                                  EL301
   282 01  JULIAN-EDITED.                                               EL301
   283     05  JULIAN-YEAR                 PIC 99.                      EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL301.cbl
   284     05  FILLER                      PIC X       VALUE '/'.       EL301
   285     05  JULIAN-DAY                  PIC 999.                     EL301
   286                                                                  EL301
   287 01  HEXADECIMAL-DAYS.                                            EL301
   288     05  HEX-CHARACTER               PIC X                        EL301
   289                       OCCURS 4 TIMES  INDEXED BY U.              EL301
   290                                                                  EL301
   291 01  CONVERSION-TABLE.                                            EL301
   292     05  FILLER          PIC X(21)  VALUE '104096002560001600001'.EL301
   293     05  FILLER          PIC X(21)  VALUE '208192005120003200002'.EL301
   294     05  FILLER          PIC X(21)  VALUE '312288007680004800003'.EL301
   295     05  FILLER          PIC X(21)  VALUE '416384010240006400004'.EL301
   296     05  FILLER          PIC X(21)  VALUE '520480012800008000005'.EL301
   297     05  FILLER          PIC X(21)  VALUE '624576015360009600006'.EL301
   298     05  FILLER          PIC X(21)  VALUE '728672017920011200007'.EL301
   299     05  FILLER          PIC X(21)  VALUE '832768020480012800008'.EL301
   300     05  FILLER          PIC X(21)  VALUE '936864023040014400009'.EL301
   301     05  FILLER          PIC X(21)  VALUE 'A40960025600016000010'.EL301
   302     05  FILLER          PIC X(21)  VALUE 'B45056028160017600011'.EL301
   303     05  FILLER          PIC X(21)  VALUE 'C49152030720019200012'.EL301
   304     05  FILLER          PIC X(21)  VALUE 'D53248033280020800013'.EL301
   305     05  FILLER          PIC X(21)  VALUE 'E57344035840022400014'.EL301
   306     05  FILLER          PIC X(21)  VALUE 'F61440038400024000015'.EL301
   307                                                                  EL301
   308 01  HEXADECIMAL-TABLE  REDEFINES  CONVERSION-TABLE.              EL301
   309     05  HEXADECIMAL-VALUES  OCCURS 15 TIMES  INDEXED BY V.       EL301
   310         10  HEX-VALUE               PIC X.                       EL301
   311         10  DECIMAL-NUMBERS  OCCURS 4 TIMES  INDEXED BY W.       EL301
   312             15  DECIMAL-VALUE       PIC 9(5).                    EL301
   313                                                                  EL301
   314 01  CALENDAR-TABLE.                                              EL301
   315     05  CALENDAR-ROWS  OCCURS 61 TIMES  INDEXED BY X.            EL301
   316         10  CALENDAR-COLUMNS  OCCURS 6 TIMES  INDEXED BY Y.      EL301
   317             15  GREGORIAN           PIC X(8).                    EL301
   318             15  BINARY-74 PIC X(4).                              EL301
   319             15  JULIAN              PIC 9(6).                    EL301
   320                                                                  EL301
   321 01  CALENDAR-LINE.                                               EL301
   322     05  FILLER                      PIC X       VALUE SPACE.     EL301
   323     05  CALENDAR-DATES  OCCURS 6 TIMES  INDEXED BY Z.            EL301
   324         10  GREGORIAN-DATE          PIC X(8).                    EL301
   325         10  FILLER                  PIC X.                       EL301
   326         10  BINARY-DATE             PIC X(4).                    EL301
   327         10  FILLER                  PIC X.                       EL301
   328         10  JULIAN-DATE             PIC X(6).                    EL301
   329         10  FILLER                  PIC XX.                      EL301
   330                                                                  EL301
   331 01  HEADING-1.                                                   EL301
   332     05  FILLER            PIC X(56) VALUE SPACES.                EL301
   333     05  FILLER            PIC X(19) VALUE 'CONVERSION CALENDER'. EL301
   334     05  FILLER            PIC X(57) VALUE SPACES.                EL301
   335                                                                  EL301
   336 01  HEADING-2.                                                   EL301
   337     05  FILLER            PIC X(59) VALUE SPACES.                EL301
   338     05  FILLER            PIC X(9)  VALUE 'FOR YEAR '.           EL301
   339     05  HDG-CENTURY       PIC XX    VALUE '19'.                  EL301
   340     05  HDG-YEAR          PIC XX.                                EL301
   341     05  FILLER            PIC X(60) VALUE SPACES.                EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL301.cbl
   342                                                                  EL301
   343 01  HEADING-3.                                                   EL301
   344     05  FILLER        PIC X(23) VALUE '   GREG    HEX   JUL   '. EL301
   345     05  FILLER        PIC X(22) VALUE  '  GREG    HEX   JUL   '. EL301
   346     05  FILLER        PIC X(22) VALUE  '  GREG    HEX   JUL   '. EL301
   347     05  FILLER        PIC X(22) VALUE  '  GREG    HEX   JUL   '. EL301
   348     05  FILLER        PIC X(22) VALUE  '  GREG    HEX   JUL   '. EL301
   349     05  FILLER        PIC X(22) VALUE  '  GREG    HEX   JUL   '. EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL301.cbl
   351 PROCEDURE DIVISION.                                              EL301
   352                                                                  EL301
   353 0100-PROGRAM-PROCESSING.                                         EL301
   354     OPEN OUTPUT PRINTER.                                         EL301
   355                                                                  EL301
   356     MOVE '5'                TO DC-OPTION-CODE.                   EL301
   357     MOVE BEGINNING-YEAR-DAY TO CALENDAR-DATE.                    EL301
   358                                                                  EL301
   359     PERFORM 0200-GENERATE-CALENDAR THRU 0200-EXIT 100 TIMES.     EL301
   360                                                                  EL301
   361     CLOSE PRINTER.                                               EL301
   362                                                                  EL301
   363     GOBACK.                                                      EL301
   364                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL301.cbl
   366 0200-GENERATE-CALENDAR.                                          EL301
   367     PERFORM 0300-INITIALIZE-CALENDAR       THRU 0300-EXIT.       EL301
   368                                                                  EL301
   369     PERFORM 0400-DATE-CONVERSION-ROUTINE   THRU 0400-EXIT.       EL301
   370                                                                  EL301
   371     PERFORM 0500-PRINT-CONVERSION-CALENDAR THRU 0500-EXIT.       EL301
   372                                                                  EL301
   373     IF CALENDAR-YEAR = 99                                        EL301
   374         MOVE 00 TO CALENDAR-YEAR                                 EL301
   375     ELSE                                                         EL301
   376         ADD  1  TO CALENDAR-YEAR.                                EL301
   377                                                                  EL301
   378     MOVE 001    TO CALENDAR-DAY.                                 EL301
   379                                                                  EL301
   380 0200-EXIT.                                                       EL301
   381     EXIT.                                                        EL301
   382                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL301.cbl
   384 0300-INITIALIZE-CALENDAR.                                        EL301
   385     MOVE SPACES TO CALENDAR-TABLE  CALENDAR-LINE.                EL301
   386                                                                  EL301
   387     MOVE CALENDAR-YEAR                  TO DC-ALPHA-YEAR.           CL**3
   388     MOVE 7                              TO DC-OPTION-CODE.       EL301
   389     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0400-EXIT.         EL301
   390     IF DATE-CONVERSION-ERROR                                        CL**2
   391        IF ONLY-CENTURY                                              CL**2
   392           CONTINUE                                                  CL**2
   393        ELSE                                                         CL**2
   394           MOVE 'CENTURY NOT FOUND'  TO WS-ABEND-MESSAGE             CL**2
   395           MOVE DC-ERROR-CODE        TO WS-ABEND-FILE-STATUS         CL**2
   396           GO TO ABEND-PGM                                           CL**3
   397        END-IF                                                       CL**2
   398     ELSE                                                            CL**2
   399        MOVE 'ERROR FINDING CENTURY'  TO WS-ABEND-MESSAGE         EL301
   400        MOVE DC-ERROR-CODE            TO WS-ABEND-FILE-STATUS     EL301
   401        GO TO ABEND-PGM.                                             CL**3
   402                                                                  EL301
   403     MOVE 'H'  TO  DC-OPTION-CODE.                                   CL**3
   404     MOVE DC-GREG-DATE-CYMD TO HOLD-CENTURY-1.                       CL**2
   405     PERFORM 0400-DATE-CONVERSION-ROUTINE.                           CL**3
   406                                                                  EL301
   407     IF DATE-CONVERSION-ERROR                                     EL301
   408        IF ONLY-LEAP-YEAR                                         EL301
   409           IF HOLD-CEN-1-DA = 28                                     CL**2
   410              MOVE 365 TO DAYS-IN-YEAR                               CL**2
   411           ELSE                                                   EL301
   412              MOVE 366 TO DAYS-IN-YEAR                               CL**2
   413           END-IF                                                 EL301
   414        ELSE                                                      EL301
   415           MOVE 'LEAP YEAR ERROR'  TO  WS-ABEND-MESSAGE           EL301
   416           MOVE DC-ERROR-CODE      TO  WS-ABEND-FILE-STATUS       EL301
   417           GO TO ABEND-PGM.                                          CL**3
   418                                                                  EL301
   419     SET X Y  TO  1.                                              EL301
   420                                                                  EL301
   421 0300-EXIT.                                                       EL301
   422     EXIT.                                                        EL301
   423                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL301.cbl
   425 0400-DATE-CONVERSION-ROUTINE.                                    EL301
   426     MOVE CALENDAR-DATE       TO DC-JULIAN-DATE.                  EL301
   427                                                                  EL301
   428     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   EL301
   429                                                                  EL301
   430     MOVE DC-GREG-DATE-1-EDIT TO GREGORIAN (X, Y).                EL301
   431                                                                  EL301
   432     MOVE ZEROS TO HEXADECIMAL-DAYS  BINARY-WORK.                 EL301
   433     MOVE DC-BIN-DATE-1 TO BINARY-DTE.                            EL301
   434     SET V W  TO  1.                                              EL301
   435                                                                  EL301
   436     PERFORM 0900-GENERATE-HEX-CHARACTERS THRU 0999-EXIT.         EL301
   437                                                                  EL301
   438     MOVE HEXADECIMAL-DAYS TO BINARY-74 (X, Y).                   EL301
   439                                                                  EL301
   440     MOVE CALENDAR-YEAR    TO JULIAN-YEAR.                        EL301
   441     MOVE CALENDAR-DAY     TO JULIAN-DAY.                         EL301
   442     MOVE JULIAN-EDITED    TO JULIAN (X, Y).                      EL301
   443                                                                  EL301
   444     IF X = 61                                                    EL301
   445         SET X TO 1                                               EL301
   446         SET Y UP BY 1                                            EL301
   447     ELSE                                                         EL301
   448         SET X UP BY 1.                                           EL301
   449                                                                  EL301
   450     ADD 1 TO CALENDAR-DAY.                                       EL301
   451                                                                  EL301
   452     IF CALENDAR-DAY NOT GREATER THAN DAYS-IN-YEAR                EL301
   453         GO TO 0400-DATE-CONVERSION-ROUTINE.                      EL301
   454                                                                  EL301
   455 0400-EXIT.                                                       EL301
   456     EXIT.                                                        EL301
   457                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL301.cbl
   459 0500-PRINT-CONVERSION-CALENDAR.                                  EL301
   460     MOVE CALENDAR-YEAR TO HDG-YEAR                               EL301
   461                           DC-ALPHA-YEAR.                            CL**3
   462     MOVE '7'           TO DC-OPTION-CODE.                           CL**3
   463     PERFORM 0400-DATE-CONVERSION-ROUTINE THRU 0400-EXIT.            CL**3
   464     IF ONLY-CENTURY                                              EL301
   465        MOVE  DC-ALPHA-CEN-N  TO  HDG-CENTURY                     EL301
   466     ELSE                                                         EL301
   467        MOVE  'ERROR FINDING HDG-CENTURY'  TO WS-ABEND-MESSAGE    EL301
   468        MOVE  DC-ERROR-CODE            TO WS-ABEND-FILE-STATUS    EL301
   469        GO TO ABEND-PGM.                                             CL**3
   470                                                                  EL301
   471     WRITE PRINT-RECORD FROM HEADING-1 AFTER ADVANCING PAGE.      EL301
   472     WRITE PRINT-RECORD FROM HEADING-2 AFTER ADVANCING 1 LINES.   EL301
   473     WRITE PRINT-RECORD FROM HEADING-3 AFTER ADVANCING 2 LINES.   EL301
   474     WRITE PRINT-RECORD FROM BLANK-ONE AFTER ADVANCING 1 LINES.   EL301
   475                                                                  EL301
   476     SET X Y Z  TO  1.                                            EL301
   477     PERFORM 0550-PRINT-CALENDAR-LINES THRU 0550-EXIT.            EL301
   478                                                                  EL301
   479 0500-EXIT.                                                       EL301
   480     EXIT.                                                        EL301
   481                                                                  EL301
   482 0550-PRINT-CALENDAR-LINES.                                       EL301
   483     PERFORM 0575-GET-CALENDAR-DATES THRU 0575-EXIT  6 TIMES.     EL301
   484                                                                  EL301
   485     WRITE PRINT-RECORD FROM CALENDAR-LINE AFTER ADVANCING 1.     EL301
   486                                                                  EL301
   487     IF X LESS THAN 61                                            EL301
   488         SET X UP BY 1                                            EL301
   489         SET Y Z TO 1                                             EL301
   490           GO TO 0550-PRINT-CALENDAR-LINES.                       EL301
   491                                                                  EL301
   492 0550-EXIT.                                                       EL301
   493     EXIT.                                                        EL301
   494                                                                  EL301
   495 0575-GET-CALENDAR-DATES.                                         EL301
   496     MOVE GREGORIAN (X, Y) TO GREGORIAN-DATE (Z).                 EL301
   497     MOVE BINARY-74 (X, Y) TO BINARY-DATE (Z).                    EL301
   498     MOVE JULIAN    (X, Y) TO JULIAN-DATE    (Z).                 EL301
   499                                                                  EL301
   500     SET Y Z UP BY 1.                                             EL301
   501                                                                  EL301
   502 0575-EXIT.                                                       EL301
   503     EXIT.                                                        EL301
   504                                                                  EL301
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL301.cbl
   506 0900-GENERATE-HEX-CHARACTERS.                                    EL301
   507     IF BINARY-WORK LESS THAN DECIMAL-VALUE (V, W)                EL301
   508         IF W LESS THAN 4                                         EL301
   509             SET W UP BY 1                                        EL301
   510             GO TO 0900-GENERATE-HEX-CHARACTERS                   EL301
   511         ELSE                                                     EL301
   512             GO TO 0999-EXIT.                                     EL301
   513                                                                  EL301
   514     SET V TO 15.                                                 EL301
   515                                                                  EL301
   516 0950-GET-HEXADECIMAL-DIGIT.                                      EL301
   517     IF BINARY-WORK NOT LESS THAN DECIMAL-VALUE (V, W)            EL301
   518         SET U TO W                                               EL301
   519         MOVE HEX-VALUE (V) TO HEX-CHARACTER (U)                  EL301
   520         COMPUTE BINARY-WORK =                                    EL301
   521                       BINARY-WORK - DECIMAL-VALUE (V, W)         EL301
   522         SET V TO 1                                               EL301
   523         GO TO 0900-GENERATE-HEX-CHARACTERS.                      EL301
   524                                                                  EL301
   525     SET V DOWN BY 1.                                             EL301
   526     GO TO 0950-GET-HEXADECIMAL-DIGIT.                            EL301
   527                                                                  EL301
   528 0999-EXIT.                                                       EL301
   529     EXIT.                                                        EL301
   530 ABEND-PGM.                                                       EL301
*  531 COPY ELCABEND.                                                   EL301
   532***************************************************************** 04/14/98
   533*                                                               * ELCABEND
   534*                            ELCABEND.                          *    LV003
   535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   536*                            VMOD 2.002                              CL**2
   537*                                                               * ELCABEND
   538*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   539*            AND THEN ABENDS.                                   * ELCABEND
   540*                                                               * ELCABEND
   541*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   542*                                                               * ELCABEND
   543***************************************************************** ELCABEND
   544*APS-010.                                                         ELCABEND
   545     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   546     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   547                                                                  ELCABEND
   548     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   549         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   550         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   551                                 UPON CONSOLE.                    ELCABEND
   552                                                                  ELCABEND
   553     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   554         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   555         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   556                                 UPON CONSOLE.                    ELCABEND
   557                                                                  ELCABEND
   558     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   559     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   560                                 UPON CONSOLE.                    ELCABEND
   561                                                                  ELCABEND
   562     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   563     CALL 'ABORTME'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL301.cbl (/apps/prod/cid1p/copy/ELCABEND)
   564                                                                  ELCABEND
   565 APS-EXIT.                                                        ELCABEND
   566     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        9208     Code:        1873
