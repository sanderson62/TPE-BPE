* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIDSNCPY.cbl
* Options: int("CIDSNCPY.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIDSNCPY.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIDSNCPY.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CIDSNCPY.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    CIDSNCPY.
     3 AUTHOR.        PABLO.
     4******************************************************************
     5*                   C H A N G E   L O G
     6*
     7* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     8*-----------------------------------------------------------------
     9*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    10* EFFECTIVE    NUMBER
    11*-----------------------------------------------------------------
    12* 062905  2005062700005    PEMA  CHANGE LOCATION OF BRANCH
    13* 081712  IR2012081700001  PEMA  CHANGE ST AND ACCT ASSIGNMENT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIDSNCPY.cbl
    14******************************************************************
    15 ENVIRONMENT DIVISION.
    16 INPUT-OUTPUT SECTION.
    17 FILE-CONTROL.
    18*
    19     SELECT CID-FILE-IN
    20         ASSIGN TO SYS010
    21         FILE STATUS IS SYS010-STATUS
    22         ORGANIZATION IS LINE SEQUENTIAL.
    23
    24
    25     SELECT CID-FILE-OUT
    26         ASSIGN TO SYS011.
    27
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD  CID-FILE-IN
    33     LABEL RECORDS ARE STANDARD
    34     RECORDING MODE IS F
    35     BLOCK CONTAINS 0 RECORDS.
    36 01  CID-RECORD-IN               PIC X(400).
    37
    38 FD  CID-FILE-OUT
    39     LABEL RECORDS ARE STANDARD
    40     RECORDING MODE IS F
    41     BLOCK CONTAINS 0 RECORDS.
    42 01  CID-RECORD-OUT              PIC X(400).
    43
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIDSNCPY.cbl
    45
    46 WORKING-STORAGE SECTION.
    47
    48 01  FILLER                  BINARY.
    49     05  SUB                 PIC S9(4)    VALUE +0.
    50
    51 01  SUN-RECORD.
    52     05  SUN-INS-ST.
    53         10  SUN-INS         PIC X.
    54         10  SUN-ST          PIC XX.
    55     05  SUN-ACCOUNT         PIC X(10).
    56     05  SUN-TYPE            PIC X.
    57     05  SUN-EFF-DATE.
    58         10  SUN-EFF-MO      PIC XX.
    59         10  SUN-EFF-DA      PIC XX.
    60         10  SUN-EFF-YR      PIC XX.
    61     05  FILLER              PIC X(166).
    62     05  SUN-CERT            PIC X(10).
    63     05  FILLER              PIC X(30).
    64     05  SUN-FIN-INST.
    65         10  SUN-FILL        PIC XX.
    66         10  SUN-BRANCH      PIC XXX.
    67     05  FILLER              PIC X(169).
    68
    69
    70 01  FILLER.
    71     05  CID-IN-CNT          PIC 9(5) VALUE ZEROS.
    72     05  CID-OUT-CNT         PIC 9(5) VALUE ZEROS.
    73     05  S0C7                PIC X        VALUE ' '.
    74     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
    75     05  SYS010-STATUS       PIC XX       VALUE '00'.
    76         88  EOF                          VALUE '10'.
    77     05  WS-WORK-CCYYMMDD      PIC 9(8).
    78     05  FILLER REDEFINES WS-WORK-CCYYMMDD.
    79         10  WS-WORK-CC      PIC XX.
    80         10  WS-WORK-YR      PIC XX.
    81         10  WS-WORK-MO      PIC XX.
    82         10  WS-WORK-DA      PIC XX.
    83
    84 01  AGENT-TABLE.
    85     05  AGENT-VALUES.
    86         10  FILLER         PIC X(13)  VALUE '0100000542800'.
    87         10  FILLER         PIC X(13)  VALUE '0110000542900'.
    88         10  FILLER         PIC X(13)  VALUE '0120000425100'.
    89         10  FILLER         PIC X(13)  VALUE '0130000521700'.
    90         10  FILLER         PIC X(13)  VALUE '0200000644400'.
    91         10  FILLER         PIC X(13)  VALUE '0300000447700'.
    92         10  FILLER         PIC X(13)  VALUE '0500000522100'.
    93         10  FILLER         PIC X(13)  VALUE '0510000522100'.
    94         10  FILLER         PIC X(13)  VALUE '0600000850200'.
    95         10  FILLER         PIC X(13)  VALUE '0610000513000'.
    96         10  FILLER         PIC X(13)  VALUE '0620000848500'.
    97         10  FILLER         PIC X(13)  VALUE '0630000850000'.
    98         10  FILLER         PIC X(13)  VALUE '0800000543800'.
    99         10  FILLER         PIC X(13)  VALUE '0900000542800'.
   100         10  FILLER         PIC X(13)  VALUE '1300000447700'.
   101         10  FILLER         PIC X(13)  VALUE '1400000531800'.
   102         10  FILLER         PIC X(13)  VALUE '1410000531800'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIDSNCPY.cbl
   103         10  FILLER         PIC X(13)  VALUE '1420000531800'.
   104         10  FILLER         PIC X(13)  VALUE '1700000542700'.
   105         10  FILLER         PIC X(13)  VALUE '1800000543800'.
   106         10  FILLER         PIC X(13)  VALUE '1900000644300'.
   107         10  FILLER         PIC X(13)  VALUE '2100000459200'.
   108         10  FILLER         PIC X(13)  VALUE '2110000787900'.
   109         10  FILLER         PIC X(13)  VALUE '2200000635600'.
   110         10  FILLER         PIC X(13)  VALUE '2210000635600'.
   111         10  FILLER         PIC X(13)  VALUE '2300000963900'.
   112         10  FILLER         PIC X(13)  VALUE '2400000531800'.
   113         10  FILLER         PIC X(13)  VALUE '2700000542700'.
   114         10  FILLER         PIC X(13)  VALUE '4000000796500'.
   115         10  FILLER         PIC X(13)  VALUE '4010000796501'.
   116         10  FILLER         PIC X(13)  VALUE '4020000796502'.
   117         10  FILLER         PIC X(13)  VALUE '4300000923700'.
   118         10  FILLER         PIC X(13)  VALUE '4310000923701'.
   119         10  FILLER         PIC X(13)  VALUE '4500000691600'.
   120         10  FILLER         PIC X(13)  VALUE '4510000691601'.
   121         10  FILLER         PIC X(13)  VALUE '4520000691601'.
   122         10  FILLER         PIC X(13)  VALUE '4600000691600'.
   123     05  AGENT-DATA REDEFINES AGENT-VALUES OCCURS 37
   124                             INDEXED BY AGT-INDEX.
   125         10  AGENT-CERT     PIC XXX.
   126         10  AGENT-ACCT     PIC X(10).
   127
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIDSNCPY.cbl
   129*
   130 PROCEDURE DIVISION.
   131*
   132     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT
   133
   134     PERFORM 1000-PROCESS THRU 1000-EXIT UNTIL EOF
   135     DISPLAY ' RECORDS IN   ' CID-IN-CNT
   136     DISPLAY ' RECORDS OUT  ' CID-OUT-CNT
   137     CLOSE CID-FILE-IN  CID-FILE-OUT
   138     GOBACK
   139
   140
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIDSNCPY.cbl
   142     .
   143 1000-PROCESS.
   144*
   145     READ CID-FILE-IN INTO SUN-RECORD
   146        AT END GO TO 1000-EXIT.
   147     ADD 1 TO CID-IN-CNT
   148
   149     MOVE SUN-EFF-YR             TO WS-WORK-YR
   150     MOVE SUN-EFF-MO             TO WS-WORK-MO
   151     MOVE SUN-EFF-DA             TO WS-WORK-DA
   152     IF WS-WORK-YR > '60'
   153        MOVE '19'                TO WS-WORK-CC
   154     ELSE
   155        MOVE '20'                TO WS-WORK-CC
   156     END-IF
   157
   158     IF (WS-WORK-CCYYMMDD < 20050701)
   159               OR
   160         ((SUN-TYPE NOT = '2')
   161         AND (WS-WORK-CCYYMMDD < 20050819)
   162         AND (SUN-BRANCH = '450' OR '460' OR '451' OR '452'))
   163        SET AGT-INDEX TO +1
   164        SEARCH AGENT-DATA VARYING AGT-INDEX
   165          AT END MOVE '9999999999' TO SUN-ACCOUNT
   166*         WHEN SUN-CERT (1:3) = AGENT-CERT (AGT-INDEX)
   167          WHEN SUN-BRANCH = AGENT-CERT (AGT-INDEX)
   168             MOVE AGENT-ACCT (AGT-INDEX) TO SUN-ACCOUNT
   169        END-SEARCH
   170        IF SUN-BRANCH (1:1) = '4'
   171           MOVE 'CO'             TO SUN-INS-ST (2:2)
   172        END-IF
   173     ELSE
   174        evaluate true
   175           when sun-branch (1:1) = '1'
   176              move 'MO'          to sun-ins-st (2:2)
   177              move '0001172001'  to sun-account
   178           when sun-branch (1:1) = '5'
   179              move 'CO'          to sun-ins-st (2:2)
   180              move '0001172000'  to sun-account
   181           when other
   182              move 'KS'          to sun-ins-st (2:2)
   183              move '0001171000'  to sun-account
   184        end-evaluate
   185     END-IF
   186
   187     WRITE CID-RECORD-OUT FROM SUN-RECORD
   188     ADD 1 TO CID-OUT-CNT
   189     .
   190 1000-EXIT.
   191     EXIT.
   192
   193
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIDSNCPY.cbl
   195*
   196*
   197 0000-HOUSEKEEPING.
   198*
   199
   200     OPEN INPUT CID-FILE-IN
   201     IF SYS010-STATUS NOT = '00'
   202        DISPLAY 'OPEN ERROR ' SYS010-STATUS ' ON SYS010'
   203        ADD +1 TO FORCE-DUMP.
   204
   205
   206     OPEN OUTPUT CID-FILE-OUT
   207     .
   208 0000-EXIT.
   209     EXIT.
   210
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3120     Code:         885
