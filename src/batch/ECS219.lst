* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS219.cbl
* Options: int("ECS219.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS219.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS219.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS219.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                ECS219.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5******************************************************************
     6*                   C H A N G E   L O G
     7*
     8* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     9*-----------------------------------------------------------------
    10*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    11* EFFECTIVE    NUMBER
    12*-----------------------------------------------------------------
    13* 021610                   PEMA  REMOVE 30 AND 31 FROM LIFE TBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS219.cbl
    14******************************************************************
    16 ENVIRONMENT DIVISION.
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19
    20     SELECT CREDIT         ASSIGN TO SYS004.
    21     SELECT NON-CREDIT     ASSIGN TO SYS005.
    22     SELECT PRNTR          ASSIGN TO SYS008.
    23     SELECT GAAP-EXTR      ASSIGN TO SYS011.
    24     SELECT DISK-DATE      ASSIGN TO SYS019.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS219.cbl
    26 DATA DIVISION.
    27 FILE SECTION.
    28
    29 FD  CREDIT
    30     BLOCK CONTAINS 0 RECORDS
    31     RECORDING MODE F.
    32
    33 01  CREDIT-REC              PIC X(365).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS219.cbl
    35 FD  NON-CREDIT
    36     BLOCK CONTAINS 0 RECORDS
    37     RECORDING MODE F.
    38
    39 01  NON-CREDIT-REC          PIC X(365).
    40
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS219.cbl
    42 FD  PRNTR
*   43                             COPY ELCPRTFD.
    44******************************************************************04/15/98
    45*                                                                *ELCPRTFD
    46*                                                                *ELCPRTFD
    47*                            ELCPRTFD.                           *   LV003
    48*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    49*                            VMOD=2.006                          *ELCPRTFD
    50******************************************************************ELCPRTFD
    51     RECORDING MODE F                                             ELCPRTFD
    52     LABEL RECORDS OMITTED                                        ELCPRTFD
    53     BLOCK CONTAINS 0 RECORDS
    54     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    55 01  PRT.                                                         ELCPRTFD
    56     12  P-CTL               PIC  X.                                 CL**2
    57     12  P-DATA              PIC  X(132).                         ELCPRTFD
    58******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS219.cbl
    60 FD  GAAP-EXTR
*   61                             COPY ECSGAPFD.
    62******************************************************************07/10/97
    63*                                                                *ECSGAPFD
    64*                            ECSGAPFD                            *   LV001
    65*                            VMOD=2.001                          *ECSGAPFD
    66*                                                                *ECSGAPFD
    67*  NO  CSO  MODS  IN  COPYBOOK  ECSGAPFD                         *ECSGAPFD
    68*                                                                *ECSGAPFD
    69******************************************************************ECSGAPFD
    70     RECORDING MODE F                                             ECSGAPFD
    71     LABEL RECORDS STANDARD                                       ECSGAPFD
    72     BLOCK CONTAINS 0 RECORDS
    73     RECORD CONTAINS 365 CHARACTERS.                              ECSGAPFD
    74                                                                  ECSGAPFD
    75 01  GAAP-EXTRACT-RECORD                   PIC X(365).            ECSGAPFD
    76                                                                  ECSGAPFD
    77******************************************************************ECSGAPFD
    78
*   79                             COPY ECSGAP01.
    80******************************************************************04/29/98
    81*                                                                *ECSGAP01
    82*                            ECSGAP01                            *   LV009
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**9
    84*                            VMOD=2.009                          *ECSGAP01
    85*                                                                *ECSGAP01
    86*   FILE DESCRIPTION = G.A.A.P. EXTRACT RECORD                   *ECSGAP01
    87*                                                                *ECSGAP01
    88*   FILE TYPE = SEQUENTIAL                                        ECSGAP01
    89*   RECORD SIZE = 365  RECFORM = FIXED                           *ECSGAP01
    90*                                                                *ECSGAP01
    91*   KEY DATA =                         START=5, LEN=36           *ECSGAP01
    92*                                                                *ECSGAP01
    93*  NO  CSO  MODS  IN  COPYBOOK  ECSGAP01                         *ECSGAP01
    94*                                                                *ECSGAP01
    95******************************************************************ECSGAP01
    96*                   C H A N G E   L O G
    97*
    98* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    99*-----------------------------------------------------------------
   100*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   101* EFFECTIVE    NUMBER
   102*-----------------------------------------------------------------
   103* 020305    2005020000000  PEMA  ADD CLP STATE TO GAAP RECORD
   104******************************************************************
   105                                                                  ECSGAP01
   106 01  GAAP-RECORD.                                                 ECSGAP01
   107     12  GR-RECORD-ID                      PIC XX.                ECSGAP01
   108         88  VALID-GR-ID                      VALUE 'GR'.         ECSGAP01
   109                                                                  ECSGAP01
   110     12  GR-COMPANY-CD                     PIC X.                 ECSGAP01
   111                                                                  ECSGAP01
   112     12  GR-REIN                           PIC X.                 ECSGAP01
   113                                                                  ECSGAP01
   114     12  GR-CONTROL.                                              ECSGAP01
   115         16  GR-CARRIER                    PIC X.                 ECSGAP01
   116         16  GR-GROUPING.                                         ECSGAP01
   117             20  GR-GROUP-PREFIX           PIC XXX.               ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS219.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   118             20  GR-GROUP-PRIME            PIC XXX.               ECSGAP01
   119         16  GR-STATE                      PIC XX.                ECSGAP01
   120         16  GR-ACCOUNT.                                          ECSGAP01
   121             20  GR-ACCT-PREFIX            PIC X(4).              ECSGAP01
   122             20  GR-ACCT-PRIME             PIC X(6).              ECSGAP01
   123         16  GR-EFF                        PIC 9(11)  COMP-3.     ECSGAP01
   124         16  GR-CERT-NO.                                          ECSGAP01
   125             20  GR-CERT.                                         ECSGAP01
   126                 24  GR-CERT-PREFIX        PIC XXX.               ECSGAP01
   127                 24  GR-CERT-PRIME         PIC X(7).              ECSGAP01
   128             20  GR-CERT-SUFFIX            PIC X.                 ECSGAP01
   129                                                                  ECSGAP01
   130     12  GR-REIN-COMP.                                            ECSGAP01
   131         16  GR-REINCO                     PIC XXX.               ECSGAP01
   132         16  GR-REINCO-SUB                 PIC XXX.               ECSGAP01
   133                                                                  ECSGAP01
   134     12  GR-IG                             PIC X.                 ECSGAP01
   135     12  GR-APR                            PIC S999V9(4)  COMP-3. ECSGAP01
   136     12  GR-PMT-FREQ                       PIC 99.                ECSGAP01
   137     12  GR-LOAN-TERM                      PIC S999       COMP-3. ECSGAP01
   138     12  GR-AGE                            PIC 99.                ECSGAP01
   139     12  GR-ACC-EXPIRES                    PIC 9(11)      COMP-3.    CL**2
   140                                                                  ECSGAP01
   141     12  GR-BASIC.                                                ECSGAP01
   142         16  GR-LFTYP                      PIC XX.                ECSGAP01
   143         16  GR-LF-TERM                    PIC S999       COMP-3. ECSGAP01
   144         16  GR-LF-REMTERM                 PIC S999V99    COMP-3. ECSGAP01
   145         16  GR-LF-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
   146         16  GR-LFBEN                      PIC S9(9)V99   COMP-3. ECSGAP01
   147         16  GR-LFPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
   148         16  GR-LFCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
   149         16  GR-LFEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
   150         16  GR-LFTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
   151                                                                  ECSGAP01
   152         16  GR-AHTYP                      PIC XX.                ECSGAP01
   153         16  GR-AH-TERM                    PIC S999       COMP-3. ECSGAP01
   154         16  GR-AH-REMTERM                 PIC S999V9     COMP-3. ECSGAP01
   155         16  GR-AH-UP-REMTERM              PIC S999V99    COMP-3. ECSGAP01
   156         16  GR-AHBEN                      PIC S9(7)V99   COMP-3. ECSGAP01
   157         16  GR-AHPRM                      PIC S9(7)V99   COMP-3. ECSGAP01
   158         16  GR-AHCOM                      PIC S9(7)V99   COMP-3. ECSGAP01
   159         16  GR-AHEXP                      PIC S9(7)V99   COMP-3. ECSGAP01
   160         16  GR-AHTAX                      PIC S9(7)V99   COMP-3. ECSGAP01
   161                                                                  ECSGAP01
   162     12  GR-PRORATA.                                              ECSGAP01
   163         16  GRP-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   164         16  GRP-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   165         16  GRP-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   166         16  GRP-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   167         16  GRP-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   168         16  GRP-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   169         16  GRP-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   170         16  GRP-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   171                                                                  ECSGAP01
   172     12  GR-R78.                                                  ECSGAP01
   173         16  GRR-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   174         16  GRR-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   175         16  GRR-LFEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS219.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   176         16  GRR-LFTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   177         16  GRR-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   178         16  GRR-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   179         16  GRR-AHEXP                     PIC S9(7)V99   COMP-3. ECSGAP01
   180         16  GRR-AHTAX                     PIC S9(7)V99   COMP-3. ECSGAP01
   181                                                                  ECSGAP01
   182     12  GR-DOMICILE-STAT.                                        ECSGAP01
   183         16  GRD-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   184         16  GRD-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   185         16  GRD-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   186         16  GRD-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   187                                                                  ECSGAP01
   188     12  GR-STATE-STAT.                                           ECSGAP01
   189         16  GRS-LFPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   190         16  GRS-LFCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   191         16  GRS-AHPRM                     PIC S9(7)V99   COMP-3. ECSGAP01
   192         16  GRS-AHCOM                     PIC S9(7)V99   COMP-3. ECSGAP01
   193                                                                  ECSGAP01
   194     12  GR-MORTALITY-DATA.                                       ECSGAP01
   195         16  GR-MORT-CONTROL.                                     ECSGAP01
   196             20  GR-MORT-CODE.                                    ECSGAP01
   197                 24  GR-MORT-BASE.                                ECSGAP01
   198                     28  GR-MORT-TBL       PIC X.                 ECSGAP01
   199                     28  GR-MORT-INT       PIC XX.                ECSGAP01
   200                 24  GR-MORT-TYP           PIC X.                 ECSGAP01
   201             20  GR-MORT-AGE               PIC 99.                ECSGAP01
   202         16  GR-MORT-DATA.                                        ECSGAP01
   203             20  GR-REM-AMT                PIC S9(9)V99   COMP-3. ECSGAP01
   204             20  GR-MO-DEC                 PIC S9(9)V99   COMP-3. ECSGAP01
   205             20  GR-MORT-FACT              PIC S9(5)V9(4) COMP-3. ECSGAP01
   206             20  GR-RESV                   PIC S9(7)V99   COMP-3. ECSGAP01
   207         16  GR-FLAG                       PIC X.                 ECSGAP01
   208                                                                  ECSGAP01
   209     12  GR-ALT-MORTALITY-DATA.                                   ECSGAP01
   210         16  GR-ALT-MORT-CODE.                                    ECSGAP01
   211             20  GR-ALT-MORT-BASE.                                ECSGAP01
   212                 24  GR-ALT-MORT-TBL       PIC X.                 ECSGAP01
   213                 24  GR-ALT-MORT-INT       PIC XX.                ECSGAP01
   214             20  GR-ALT-MORT-TYP           PIC X.                 ECSGAP01
   215         16  GR-ALT-MORT-DATA.                                    ECSGAP01
   216             20  GR-ALT-RESV               PIC S9(7)V99   COMP-3. ECSGAP01
   217                                                                  ECSGAP01
   218     12  GR-CNT                            PIC S999       COMP-3. ECSGAP01
   219     12  GR-CNT-LF                         PIC S999       COMP-3. ECSGAP01
   220     12  GR-CNT-AH                         PIC S999       COMP-3. ECSGAP01
   221     12  GR-AH-REM-BEN                     PIC S9(9)V99   COMP-3. ECSGAP01
   222                                                                  ECSGAP01
   223     12  GR-ENT-DT                         PIC 9(11)      COMP-3. ECSGAP01
   224                                                                  ECSGAP01
   225     12  GR-SUMMARY-FLAG                   PIC X.                 ECSGAP01
   226         88  GR-SUMMARY-REC                   VALUE 'Z'.          ECSGAP01
   227                                                                  ECSGAP01
   228     12  GR-2ND-LFTYP-FLAG                 PIC X.                 ECSGAP01
   229         88  GR-2ND-LIFE-REC                  VALUE 'S'.          ECSGAP01
   230                                                                  ECSGAP01
   231     12  GR-CERT-STATUS                    PIC  X.                ECSGAP01
   232     12  GR-DIR-CERT-LFBEN                 PIC  S9(7)V99  COMP-3. ECSGAP01
   233                                                                  ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS219.cbl (/apps/prod/cid1p/copy/ECSGAP01)
   234     12  GR-LF-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
   235                                                                  ECSGAP01
   236     12  GR-AH-EXPIRE-DATE                 PIC  9(11)     COMP-3. ECSGAP01
   237                                                                  ECSGAP01
   238     12  GR-REGION                         PIC X(6).              ECSGAP01
   239     12  GR-POOL-PRIME                     PIC XXX.               ECSGAP01
   240                                                                  ECSGAP01
   241     12  GR-UNDERWRITING-CODE              PIC X.                 ECSGAP01
   242         88  GR-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSGAP01
   243                                                                  ECSGAP01
   244     12  GR-OB-IND                         PIC X.                 ECSGAP01
   245                                                                  ECSGAP01
   246     12  GR-SEX-CODE                       PIC X.                 ECSGAP01
   247         88  GR-SEX-MALE                      VALUE 'M'.          ECSGAP01
   248         88  GR-SEX-FEMALE                    VALUE 'F'.          ECSGAP01
   249                                                                  ECSGAP01
   250*    12  GR-SERVICE-FEE.                                          ECSGAP01
   251*        16  GR-LFSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
   252*        16  GR-AHSRV                      PIC S9(7)V99   COMP-3. ECSGAP01
   253     12  GR-UNLD-STAT-MORT-RESV            PIC S9(7)V99   COMP-3.
   254     12  FILLER                            PIC X(5).
   255                                                                  ECSGAP01
   256     12  GR-INS-NAME.
   257         16  GR-DCC-CLP-STATE              PIC XX.
   258         16  GR-GRPTYP                     PIC XX.
   259         16  FILLER                        PIC X(9).
   260*    12  FILLER                            PIC X(13).             ECSGAP01
   261                                                                  ECSGAP01
   262******************************************************************ECSGAP01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS219.cbl
   264 FD  DISK-DATE
*  265                             COPY ELCDTEFD.
   266******************************************************************04/15/98
   267*                                                                *ELCDTEFD
   268*                                                                *ELCDTEFD
   269*                            ELCDTEFD.                           *   LV002
   270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   271*                            VMOD=2.007                          *   CL**2
   272*                                                                *ELCDTEFD
   273******************************************************************ELCDTEFD
   274     BLOCK CONTAINS 0 RECORDS
   275     RECORDING MODE F.                                            ELCDTEFD
   276                                                                  ELCDTEFD
   277 01  DATE-DISK.                                                   ELCDTEFD
   278     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   279     12  FILLER                      PIC  X(14).                  ELCDTEFD
   280     12  DD-CR1                      PIC  9.                      ELCDTEFD
   281     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   282     12  DD-CR2                      PIC  9.                      ELCDTEFD
   283     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   284     12  FILLER                      PIC  X(20).                  ELCDTEFD
   285                                                                  ELCDTEFD
   286 01  DATE-DISK-R.                                                 ELCDTEFD
   287     12  FILLER                      PIC  X(4).                   ELCDTEFD
   288     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   289                                     PIC  X(32).                  ELCDTEFD
   290                                                                  ELCDTEFD
   291 01  DATE-DISK-T.                                                 ELCDTEFD
   292     12  FILLER                      PIC  X(4).                   ELCDTEFD
   293     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   294                                     PIC  X(48).                  ELCDTEFD
   295                                                                  ELCDTEFD
   296 01  DATE-DISK-M.                                                 ELCDTEFD
   297     12  FILLER                      PIC  X(4).                   ELCDTEFD
   298     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   299                                     PIC  X(48).                  ELCDTEFD
   300                                                                  ELCDTEFD
   301 01  DATE-DISK-P.                                                 ELCDTEFD
   302     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   303     12  DD-IDX                      PIC  99.                     ELCDTEFD
   304     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   305     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   306         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   307                                     PIC  X.                      ELCDTEFD
   308         16  FILLER                  PIC  X(46).                  ELCDTEFD
   309     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   310         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   311             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   312             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   313             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   314             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   315         16  FILLER                  PIC  X(16).                  ELCDTEFD
   316                                                                  ELCDTEFD
   317 01  DATE-DISK-E.                                                 ELCDTEFD
   318     12  FILLER                      PIC  X(4).                   ELCDTEFD
   319     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   320                                     PIC  X(4).                   ELCDTEFD
   321                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   322 01  DATE-DISK-C.                                                 ELCDTEFD
   323     12  FILLER                      PIC  X(7).                   ELCDTEFD
   324     12  DD-CARR1-SECPAY-SW          PIC  X.
   325     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   326     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   327     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   328     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   329     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   330     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   331     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   332     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   333     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   334     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   335     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   336     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   337     12  DD-CARR2-SECPAY-SW          PIC  X.
   338     12  FILLER                      PIC  X(7).                   ELCDTEFD
   339                                                                  ELCDTEFD
   340 01  DATE-DISK-OPT.                                               ELCDTEFD
   341     12  FILLER                      PIC  X(04).                  ELCDTEFD
   342     12  DD-TLR-DATA.                                             ELCDTEFD
   343         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   344                                     PIC  X(03).                  ELCDTEFD
   345     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   346         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   347                                     PIC  X(06).                  ELCDTEFD
   348     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   349         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   350                                     PIC  X(07).                  ELCDTEFD
   351         16  FILLER                  PIC  X(05).                  ELCDTEFD
   352     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   353                                     PIC  X(96).                  ELCDTEFD
   354******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS219.cbl
   356 WORKING-STORAGE SECTION.
   357 77  FILLER  PIC X(32) VALUE '********************************'.
   358 77  FILLER  PIC X(32) VALUE '    ECS219 WORKING STORAGE      '.
   359 77  FILLER  PIC X(32) VALUE '********************************'.
   360
   361 77  PGM-SUB                 PIC S999    COMP    VALUE +083.
   362


   364
   365 01  WS-NON-CREDIT-TABLES.
   366     12  WS-LIFE-TABLE.
   367         16  FILLER         PIC XX  VALUE 'QD'.
   368         16  FILLER         PIC XX  VALUE 'QL'.
   369         16  FILLER         PIC XX  VALUE '29'.
   370         16  FILLER         PIC XX  VALUE '32'.
   371         16  FILLER         PIC XX  VALUE '33'.
   372         16  FILLER         PIC XX  VALUE '38'.
   373         16  FILLER         PIC XX  VALUE '45'.
   374         16  FILLER         PIC XX  VALUE '46'.
   375         16  FILLER         PIC XX  VALUE '76'.
   376         16  FILLER         PIC XX  VALUE '77'.
   377         16  FILLER         PIC XX  VALUE '80'.
   378         16  FILLER         PIC XX  VALUE '81'.
   379     12  WS-LIFE REDEFINES WS-LIFE-TABLE OCCURS 12
   380                      INDEXED BY WS-LF-NDX.
   381         16  WS-LIFE-BEN   PIC XX.
   382     12  WS-AH-TABLE.
   383         16  FILLER         PIC XX  VALUE '38'.
   384         16  FILLER         PIC XX  VALUE '39'.
   385         16  FILLER         PIC XX  VALUE '40'.
   386         16  FILLER         PIC XX  VALUE '41'.
   387         16  FILLER         PIC XX  VALUE '42'.
   388         16  FILLER         PIC XX  VALUE '63'.
   389         16  FILLER         PIC XX  VALUE '64'.
   390         16  FILLER         PIC XX  VALUE '65'.
   391         16  FILLER         PIC XX  VALUE '66'.
   392         16  FILLER         PIC XX  VALUE '67'.
   393         16  FILLER         PIC XX  VALUE '2C'.
   394         16  FILLER         PIC XX  VALUE '2D'.
   395         16  FILLER         PIC XX  VALUE '2E'.
   396         16  FILLER         PIC XX  VALUE '2F'.
   397         16  FILLER         PIC XX  VALUE '2G'.
   398         16  FILLER         PIC XX  VALUE '2H'.
   399         16  FILLER         PIC XX  VALUE '2I'.
   400         16  FILLER         PIC XX  VALUE '2J'.
   401         16  FILLER         PIC XX  VALUE '2K'.
   402         16  FILLER         PIC XX  VALUE '2L'.
   403         16  FILLER         PIC XX  VALUE '2Q'.
   404         16  FILLER         PIC XX  VALUE '2R'.
   405         16  FILLER         PIC XX  VALUE '2S'.
   406         16  FILLER         PIC XX  VALUE '2T'.
   407         16  FILLER         PIC XX  VALUE '2U'.
   408         16  FILLER         PIC XX  VALUE '5U'.
   409         16  FILLER         PIC XX  VALUE '5V'.
   410         16  FILLER         PIC XX  VALUE '5W'.
   411         16  FILLER         PIC XX  VALUE '5X'.
   412         16  FILLER         PIC XX  VALUE '5Y'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS219.cbl
   413         16  FILLER         PIC XX  VALUE '5Z'.
   414         16  FILLER         PIC XX  VALUE '6A'.
   415         16  FILLER         PIC XX  VALUE '6B'.
   416         16  FILLER         PIC XX  VALUE '6C'.
   417         16  FILLER         PIC XX  VALUE '6D'.
   418         16  FILLER         PIC XX  VALUE '6E'.
   419         16  FILLER         PIC XX  VALUE '6F'.
   420         16  FILLER         PIC XX  VALUE '6G'.
   421         16  FILLER         PIC XX  VALUE '6H'.
   422         16  FILLER         PIC XX  VALUE '6I'.
   423     12  WS-AH REDEFINES WS-AH-TABLE OCCURS 40
   424                      INDEXED BY WS-AH-NDX.
   425         16  WS-AH-BEN     PIC XX.
   426
   427 01  MISC-WS.
   428     12  X                   PIC X   VALUE ' '.
   429     12  WS-EOF-SW           PIC X   VALUE ' '.
   430         88  THERE-ARE-NO-MORE-RECORDS  VALUE 'Y'.
   431     12  WS-NON-CREDIT       PIC X   VALUE 'N'.
   432         88  RECORD-NON-CREDIT       VALUE 'Y'.
   433     12  WS-RETURN-CODE      PIC S9(4)   COMP.
   434     12  WS-ABEND-MESSAGE    PIC X(80).
   435     12  WS-ABEND-FILE-STATUS PIC XX     VALUE ZEROS.
   436     12  WS-ZERO             PIC S9       VALUE +0 COMP-3.
   437
   438 01  HEAD-1.
   439     12  FILLER              PIC X(42)           VALUE SPACES.
   440     12  FILLER              PIC X(39)           VALUE
   441             'UNEARNED PREMIUM AND COMMISSION SPLIT  '.
   442     12  FILLER              PIC X(37)           VALUE SPACES.
   443     12  FILLER              PIC X(8)         VALUE 'ECS-219 '.
   444
   445 01  HEAD-2.
   446     12  FILLER              PIC X(47)           VALUE SPACES.
   447     12  HD-CLIENT           PIC X(30)           VALUE SPACES.
   448     12  FILLER              PIC X(42)           VALUE SPACES.
   449     12  HD-DATE             PIC X(8)            VALUE SPACES.
   450
   451 01  HEAD-3.
   452     12  FILLER              PIC X(53)           VALUE SPACES.
   453     12  HD-ALF-DTE          PIC X(18)           VALUE SPACES.
   454     12  FILLER              PIC X(48)           VALUE SPACES.
   455     12  FILLER              PIC X(5)            VALUE 'PAGE'.
   456     12  HD-PAGE             PIC ZZ,ZZZ.
   457
*  458                             COPY ELCDTECX.
   459******************************************************************06/05/98
   460*                                                                *ELCDTECX
   461*                            ELCDTECX.                           *   LV005
   462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   463*                            VMOD=2.015                          *ELCDTECX
   464*                                                                *ELCDTECX
   465*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   466*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   467*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   468*                                                                *ELCDTECX
   469******************************************************************ELCDTECX
   470******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   471*                   C H A N G E   L O G
   472*
   473* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   474*-----------------------------------------------------------------
   475*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   476* EFFECTIVE    NUMBER
   477*-----------------------------------------------------------------
   478* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   479*                                  BENEFIT CODES FROM 300 TO 900
   480* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   481* 051304    2003080800002  SMVA  ADD REFUND METHOD
   482* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   483******************************************************************
   484 01  DATE-CARD.                                                   ELCDTECX
   485     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   486     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   487     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   488     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   489     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   490     12  EP-SW                       PIC  X.                      ELCDTECX
   491         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   492     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   493         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   494     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   495     12  RUN-CENTURY.                                             ELCDTECX
   496         16 RUN-CENTURY-N            PIC  99.                        CL**4
   497     12  FILLER                      PIC  X.                         CL**4
   498     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   499     12  FILLER                      PIC  XXX.                    ELCDTECX
   500     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   501                                                                  ELCDTECX
   502 01  FILLER                          PIC  X(7)                       CL**6
   503                                          VALUE 'OPTIONS'.        ELCDTECX
   504 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   505     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   506     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   507     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   508         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   509         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   510     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   511     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   512     12  FILLER                      PIC  X.                      ELCDTECX
   513     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   514     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   515     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   516     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   517     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   518     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   519     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   520     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   521     12  FILLER                      PIC  X.                      ELCDTECX
   522     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   523     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   524     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   525     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   526     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   527     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   528     12  FILLER                      PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   529     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   530     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   531     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   532     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   533     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   534     12  DTE-R78                     PIC  X.                      ELCDTECX
   535     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   536     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   537     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   538     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   539     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   540     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   541     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   542                                     PIC  X.                      ELCDTECX
   543         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   544                                                 ' '.             ELCDTECX
   545         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   546         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   547     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   548         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   549         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   550     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   551     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   552                                     PIC  9.                         CL**4
   553     12  DTE-SYSTEM.                                              ELCDTECX
   554         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   555         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   556         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   557         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   558         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   559         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   560         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   561         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   562         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   563         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   564         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   565         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   566         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   567         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   568         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   569         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   570         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   571         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   572         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   573         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   574         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   575         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   576         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   577         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   578         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   579         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   580     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   581         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   582                                     PIC  X.                      ELCDTECX
   583     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   584                                                                  ELCDTECX
   585 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   586     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   587     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   588     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   589*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   590     12  FILLER                      PIC  X.                      ELCDTECX
   591     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   592     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   593     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   594     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   595     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   596     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   597     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   598                                                                  ELCDTECX
   599     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   600     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   601     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   602     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   603                                                                  ELCDTECX
   604     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   605     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   606     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   607     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   608                                                                  ELCDTECX
   609     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   610     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   611                                                                  ELCDTECX
   612     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   613     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   614                                                                  ELCDTECX
   615     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   616                                                                  ELCDTECX
   617 01  DATE-CARD-FACTORS.                                           ELCDTECX
   618     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   619     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   620     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   621     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   622     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   623     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   624     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   625                                                                  ELCDTECX
   626 01  FILLER                          PIC  X(12)                   ELCDTECX
   627                                          VALUE 'COMPANY NAME'.   ELCDTECX
   628 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   629     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   630         16  CNT-ID                  PIC  X.                      ELCDTECX
   631         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   632                                                                  ELCDTECX
   633 01  FILLER                          PIC  X(11)                   ELCDTECX
   634                                          VALUE 'STATE NAMES'.    ELCDTECX
   635 01  STATE-NAMES.                                                 ELCDTECX
   636     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   637         16  STATE-SUB               PIC  XX.                     ELCDTECX
   638         16  STATE-PIC1.                                          ELCDTECX
   639             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   640             20  FILLER              PIC  XXX.                    ELCDTECX
   641             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   642             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   643             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   644             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   645                                                                  ELCDTECX
   646 01  FILLER                          PIC  X(13)                   ELCDTECX
   647                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   648 01  CARRIER-NAMES.                                               ELCDTECX
   649     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   650         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   651         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   652         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   653         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   654         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   655         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   656*        16  FILLER                  PIC  X.                      ELCDTECX
   657         16  CARRIER-SEC-PAY         PIC  X.
   658             88  SEC-PAY-CARRIER          VALUE 'Y'.
   659                                                                  ELCDTECX
   660 01  FILLER                          PIC  X(9)                       CL**6
   661                                          VALUE 'INS TYPES'.      ELCDTECX
   662 01  CLAS-INS-TYPES.                                              ELCDTECX
   663*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   664     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   665         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   666         16  CLAS-I-AB3.                                          ELCDTECX
   667             20  FILLER              PIC  X.                      ELCDTECX
   668             20  CLAS-I-AB2.                                      ELCDTECX
   669                 24  FILLER          PIC  X.                      ELCDTECX
   670                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   671         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   672             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   673             20  FILLER              PIC  X.                         CL**4
   674         16  CLAS-I-AB10.                                         ELCDTECX
   675             20  FILLER              PIC  X(9).                   ELCDTECX
   676             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   677         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   678         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   679         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   680         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   681             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   682         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   683         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   684         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   685         16  CLAS-I-BEN-CATEGORY     PIC  X.
   686         16  CLAS-I-REFUND-METHOD    PIC  X.
   687         16  CLAS-I-MAX-BENEFITS     PIC 99.
   688         16  FILLER                  PIC  XXX.
   689                                                                  ELCDTECX
   690 01  FILLER                          PIC  X(16)                   ELCDTECX
   691                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   692 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   693     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   694                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   695         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   696         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   697         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   698         16  CLAS-MORT-DESC.                                      ELCDTECX
   699             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   700             20  FILLER              PIC  XX.                        CL**5
   701             20  CLAS-YEAR           PIC  X(4).                      CL**6
   702             20  FILLER              PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   703             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   704             20  FILLER              PIC  X.                         CL**5
   705             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   706             20  FILLER              PIC  X.                         CL**5
   707             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   708             20  FILLER              PIC  X(5).                      CL**6
   709                                                                  ELCDTECX
   710 01  FILLER                          PIC  X(15)                   ELCDTECX
   711                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   712 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   713     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   714         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   715         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   716         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   717         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   718         16  FILLER                  PIC  X(4).                      CL**6
   719                                                                  ELCDTECX
   720 01  FILLER                          PIC  X(7)                       CL**6
   721                                     VALUE 'INDEXES'.             ELCDTECX
   722 01  CLAS-INDEX-TBL.                                              ELCDTECX
   723     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   724     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   725     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   726     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   727     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   728     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   729     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   730     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   731     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   732     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   733     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   734     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   735     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   736     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   737     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   738     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   739     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   740                                                                  ELCDTECX
   741 01  CLAS-TYPE-MISC.                                              ELCDTECX
   742     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   743     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   744     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   745     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   746     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   747     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   748     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   749     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   750     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   751     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   752     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   753                                                                  ELCDTECX
   754 01  FILLER                          PIC  X(13)                   ELCDTECX
   755                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   756 01  CLAS-MISC.                                                   ELCDTECX
   757     12  DTE-FICH                    PIC  X.                      ELCDTECX
   758         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   759         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   760         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   761     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   762     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   763     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   764     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   765     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   766     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   767     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   768     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   769     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   770     12  STATE-L                     PIC  XX.                     ELCDTECX
   771     12  CLAS-CN                     PIC  99.                     ELCDTECX
   772     12  CLAS-CO                     PIC  99.                     ELCDTECX
   773     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   774         16  DTE-F-1                 PIC  X.                      ELCDTECX
   775         16  DTE-F-2                 PIC  X.                      ELCDTECX
   776     12  DTE-ABEND-WORK.                                          ELCDTECX
   777         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   778         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   779                                                                  ELCDTECX
   780 01  FILLER                          PIC  X(12)                   ELCDTECX
   781                                     VALUE 'WORKING DATE'.        ELCDTECX
   782 01  WS-DATE-AND-TIME.                                            ELCDTECX
   783     12  WS-ACCEPT-DATE.                                          ELCDTECX
   784         16  WS-AD-YY                PIC  99.                     ELCDTECX
   785         16  WS-AD-MM                PIC  99.                     ELCDTECX
   786         16  WS-AD-DD                PIC  99.                     ELCDTECX
   787     12  WS-CURRENT-DATE.                                         ELCDTECX
   788         16  WS-CD-MM                PIC  99.                     ELCDTECX
   789         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   790         16  WS-CD-DD                PIC  99.                     ELCDTECX
   791         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   792         16  WS-CD-YY                PIC  99.                     ELCDTECX
   793     12  WS-TIME-OF-DAY.                                          ELCDTECX
   794         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   795         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   796                                                                  ELCDTECX
   797 01  FILLER                          PIC  X(12)                   ELCDTECX
   798                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   799 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   800     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   801         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   802         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   803         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   804                                                                  ELCDTECX
   805 01  FILLER                          PIC  X(10)                   ELCDTECX
   806                                     VALUE 'STATE TLRS'.          ELCDTECX
   807 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   808     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   809         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   810         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   811                                                                  ELCDTECX
   812 01  FILLER                          PIC  X(13)                   ELCDTECX
   813                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   814 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   815     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   816         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   817                                                                  ELCDTECX
   818 01  FILLER                          PIC  X(13)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   819                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   820 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   821     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   822     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   823     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   824                                     PIC  X.                         CL**5
   825     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   826     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   827     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   828     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   829     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   830     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   831     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   832     12  FILLER                      PIC  X(75).                  ELCDTECX
   833******************************************************************ELCDTECX
   834*01  MISC-CARR-PCT-DATA.                                          00001521
   835*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   836*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   837*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   838*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   839*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   840*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   841******************************************************************ELCDTECX
   842
*  843                             COPY ELCDTEVR.
   844***************************************************************** 04/15/98
   845*                                                                *ELCDTEVR
   846*                                                                *ELCDTEVR
   847*                            ELCDTEVR.                           *   LV003
   848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   849*                            VMOD=2.001                          *   CL**2
   850*                                                                *ELCDTEVR
   851*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   852*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   853*                                                                *ELCDTEVR
   854******************************************************************ELCDTEVR
   855 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   856     05  WS-RUN-DATE.                                             ELCDTEVR
   857         10  FILLER                  PIC  9(03).                  ELCDTEVR
   858         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   859         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   860             15  RUN-CC              PIC  99.                     ELCDTEVR
   861             15  RUN-YR              PIC  99.                     ELCDTEVR
   862         10  RUN-MO                  PIC  99.                     ELCDTEVR
   863         10  RUN-DA                  PIC  99.                     ELCDTEVR
   864     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   865            WS-RUN-DATE              PIC 9(11).                      CL**2
   866     05  WS-EP-DT.                                                ELCDTEVR
   867         10  FILLER                  PIC  9(03).                  ELCDTEVR
   868         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   869         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   870             15  EP-CC               PIC  99.                     ELCDTEVR
   871             15  EP-YR               PIC  99.                     ELCDTEVR
   872         10  EP-MO                   PIC  99.                     ELCDTEVR
   873         10  EP-DA                   PIC  99.                     ELCDTEVR
   874     05  WS-EP-DT-N REDEFINES                                        CL**2
   875            WS-EP-DT                 PIC 9(11).                      CL**2
   876     05  WS-DTE-CONV-DT.                                             CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   877         10  FILLER                  PIC  9(03).                     CL**4
   878         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   879         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   880             15  DTE-CONV-CC         PIC  99.                        CL**4
   881             15  DTE-CONV-YR         PIC  99.                        CL**4
   882         10  DTE-CONV-MO             PIC  99.                        CL**4
   883         10  DTE-CONV-DA             PIC  99.                        CL**4
   884     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   885            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   886 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   887     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   888         10  FILLER                            PIC 999.           ELCDTEVR
   889         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   890         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   891             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   892             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   893         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   894         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   895     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   896            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   897     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   898         10  FILLER                            PIC 999.           ELCDTEVR
   899         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   900         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   901         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   902         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   903     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   904            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   905 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   906     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   907         10  FILLER                            PIC 999.           ELCDTEVR
   908         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   909         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   910             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   911             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   912         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   913         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   914     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   915            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   916     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   917         10  FILLER                            PIC 999.           ELCDTEVR
   918         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   919         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   920             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   921             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   922         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   923         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   924     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   925            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   926     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   927         10  FILLER                            PIC 999.           ELCDTEVR
   928         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   929         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   930             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   931             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   932         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   933         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   934     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   935            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   936 01  WS-RATE-RECORD.                                              ELCDTEVR
   937         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   938             10  FILLER                        PIC 999.           ELCDTEVR
   939             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   940             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   941                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   942                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   943             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   944             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   945         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   946                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   947
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS219.cbl
   949 PROCEDURE DIVISION.
   950
   951 0100-SET-START.
*  952                             COPY ELCDTERX.
   953******************************************************************04/15/98
   954*                                                                *ELCDTERX
   955*                                                                *ELCDTERX
   956*                            ELCDTERX.                           *   LV002
   957*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   958*                            VMOD=2.007                          *ELCDTERX
   959*                                                                *ELCDTERX
   960*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   961*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   962*      = ELCDTEFD)                                               *ELCDTERX
   963*                                                                *ELCDTERX
   964******************************************************************ELCDTERX
   965                                                                  ELCDTERX
   966     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   967                                                                  ELCDTERX
   968     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   969     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   970     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   971                                                                  ELCDTERX
   972     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   973                                                                  ELCDTERX
   974******************************************************************ELCDTERX
   975*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   976*          WARNING MESSAGES.                                      ELCDTERX
   977******************************************************************ELCDTERX
   978     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   979         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   980                                                                  ELCDTERX
   981     OPEN INPUT DISK-DATE.                                        ELCDTERX
   982                                                                  ELCDTERX
   983     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   984                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   985                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   986                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   987                   CLAX-ID           CLAS-MISC                    ELCDTERX
   988                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   989                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   990                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   991                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   992                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   993                                                                  ELCDTERX
   994     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   995                                                                  ELCDTERX
   996     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   997                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   998                                                                  ELCDTERX
   999     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1000     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1001     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1002     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1003                                                                  ELCDTERX
  1004     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1005         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1006     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1007         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1008                                                                  ELCDTERX
  1009     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1010         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1011     ELSE                                                         ELCDTERX
  1012         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1013                                                                  ELCDTERX
  1014 0005-READ--CARD.                                                 ELCDTERX
  1015     READ DISK-DATE                                               ELCDTERX
  1016         AT END CLOSE DISK-DATE                                   ELCDTERX
  1017             GO TO 0060-READ--TEST.                               ELCDTERX
  1018                                                                  ELCDTERX
  1019     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1020                                                                  ELCDTERX
  1021     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1022         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1023         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1024         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1025         GO TO 0005-READ--CARD.                                   ELCDTERX
  1026                                                                  ELCDTERX
  1027     IF DD-ID = 'CLAD'                                            ELCDTERX
  1028         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1029         GO TO 0005-READ--CARD.                                   ELCDTERX
  1030                                                                  ELCDTERX
  1031     IF DD-ID = 'CLAX'                                            ELCDTERX
  1032         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1033         GO TO 0005-READ--CARD.                                   ELCDTERX
  1034                                                                  ELCDTERX
  1035     IF DD-ID = 'CLAF'                                            ELCDTERX
  1036         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1037         GO TO 0005-READ--CARD.                                   ELCDTERX
  1038                                                                  ELCDTERX
  1039     IF DD-ID = 'CLAC'                                            ELCDTERX
  1040         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1041                                                                  ELCDTERX
  1042     IF DD-ID = 'CARR'                                            ELCDTERX
  1043         GO TO 0015-READ--CARR.                                   ELCDTERX
  1044                                                                  ELCDTERX
  1045     IF DD-ID = 'STAT'                                            ELCDTERX
  1046         GO TO 0020-READ--STAT.                                   ELCDTERX
  1047                                                                  ELCDTERX
  1048     IF DD-ID = 'BUSC'                                            ELCDTERX
  1049         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1050                                                                  ELCDTERX
  1051     IF DD-ID = 'MORT'                                            ELCDTERX
  1052         GO TO 0030-READ--MORT.                                   ELCDTERX
  1053                                                                  ELCDTERX
  1054     IF DD-ID = 'CLAI'                                            ELCDTERX
  1055         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1056                                                                  ELCDTERX
  1057     IF DD-ID = 'COLC'                                            ELCDTERX
  1058         GO TO 0065-READ--COLC.                                   ELCDTERX
  1059                                                                  ELCDTERX
  1060     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1061        DD-IDA = 'CL'                                             ELCDTERX
  1062         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1063                                                                  ELCDTERX
  1064     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1065        DD-IDA = 'PO'                                             ELCDTERX
  1066         GO TO 0050-READ--POXX.                                   ELCDTERX
  1067                                                                  ELCDTERX
  1068     IF DD-ID = 'OPCA'                                            ELCDTERX
  1069         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1070                                                                  ELCDTERX
  1071     IF DD-ID = 'OPST'                                            ELCDTERX
  1072         GO TO 0072-READ--OPST.                                   ELCDTERX
  1073                                                                  ELCDTERX
  1074     IF DD-ID = 'OPBS'                                            ELCDTERX
  1075         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1076                                                                  ELCDTERX
  1077     IF DD-ID = 'OPMS'                                            ELCDTERX
  1078         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1079                                                                  ELCDTERX
  1080     GO TO 0005-READ--CARD.                                       ELCDTERX
  1081                                                                  ELCDTERX
  1082 0010-READ--CLAC.                                                 ELCDTERX
  1083     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1084     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1085     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1086     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1087     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1088     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1089     GO TO 0005-READ--CARD.                                       ELCDTERX
  1090                                                                  ELCDTERX
  1091 0015-READ--CARR.                                                 ELCDTERX
  1092     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1093     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1094        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1095        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1096        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1097        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1098        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1099        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1100        MOVE DD-CARR1-SECPAY-SW
  1101                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1102     END-IF
  1103                                                                  ELCDTERX
  1104     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1105     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1106        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1107        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1108        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1109        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1110        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1111        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1112        MOVE DD-CARR2-SECPAY-SW
  1113                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1114     END-IF
  1115                                                                  ELCDTERX
  1116                                                                  ELCDTERX
  1117     GO TO 0005-READ--CARD.                                       ELCDTERX
  1118                                                                  ELCDTERX
  1119 0020-READ--STAT.                                                 ELCDTERX
  1120     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1121     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1122        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1123         GO TO 0005-READ--CARD.                                   ELCDTERX
  1124                                                                  ELCDTERX
  1125     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1126     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1127     GO TO 0020-READ--STAT.                                       ELCDTERX
  1128                                                                  ELCDTERX
  1129 0025-READ--BUSC.                                                 ELCDTERX
  1130     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1131     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1132        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1133         GO TO 0005-READ--CARD.                                   ELCDTERX
  1134                                                                  ELCDTERX
  1135     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1136     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1137     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1138                                                                  ELCDTERX
  1139 0030-READ--MORT.                                                 ELCDTERX
  1140     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1141     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1142        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1143         GO TO 0005-READ--CARD.                                   ELCDTERX
  1144                                                                  ELCDTERX
  1145     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1146     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1147     GO TO 0030-READ--MORT.                                       ELCDTERX
  1148                                                                  ELCDTERX
  1149 0035-READ--CLXX.                                                 ELCDTERX
  1150     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1151          GO TO 0005-READ--CARD.                                  ELCDTERX
  1152                                                                  ELCDTERX
  1153     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1154         DISPLAY '***********************************************'ELCDTERX
  1155         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1156         DISPLAY '***********************************************'ELCDTERX
  1157         GO TO 0055-READ--STOP.                                   ELCDTERX
  1158                                                                  ELCDTERX
  1159     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1160        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1161         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1162                                                                  ELCDTERX
  1163     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1164        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1165         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1166                                                                  ELCDTERX
  1167*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1168     GO TO 0005-READ--CARD.                                       ELCDTERX
  1169                                                                  ELCDTERX
  1170 0040-READ--CLAI.                                                 ELCDTERX
  1171     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1172     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1173        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1174         GO TO 0005-READ--CARD.                                   ELCDTERX
  1175                                                                  ELCDTERX
  1176     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1177     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1178     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1179                                                                  ELCDTERX
  1180 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1181     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1182     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1183                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1184     PERFORM ABEND-PGM.                                           ELCDTERX
  1185                                                                  ELCDTERX
  1186 0050-READ--POXX.                                                 ELCDTERX
  1187     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1188         GO TO 0005-READ--CARD.                                   ELCDTERX
  1189                                                                  ELCDTERX
  1190     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1191         DISPLAY '***********************************************'ELCDTERX
  1192         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1193         DISPLAY '***********************************************'ELCDTERX
  1194         GO TO 0055-READ--STOP.                                   ELCDTERX
  1195                                                                  ELCDTERX
  1196     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1197     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1198     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1199     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1200                                                                  ELCDTERX
  1201     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1202         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1203     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1204         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1205                                                                  ELCDTERX
  1206     GO TO 0005-READ--CARD.                                       ELCDTERX
  1207                                                                  ELCDTERX
  1208 0055-READ--STOP.                                                 ELCDTERX
  1209     GOBACK.                                                      ELCDTERX
  1210                                                                  ELCDTERX
  1211 0060-READ--TEST.                                                 ELCDTERX
  1212     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1213        CLAX-ID         = SPACE  OR                               ELCDTERX
  1214        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1215         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1216                                                                  ELCDTERX
  1217     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1218     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1219                                                                  ELCDTERX
  1220 0065-READ--COLC.                                                 ELCDTERX
  1221     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1222     GO TO 0005-READ--CARD.                                       ELCDTERX
  1223                                                                  ELCDTERX
  1224 0070-READ--OPCA.                                                 ELCDTERX
  1225                                                                  ELCDTERX
  1226     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1227                                                                  ELCDTERX
  1228     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1229             OR                                                   ELCDTERX
  1230         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1231         GO TO 0005-READ--CARD.                                   ELCDTERX
  1232                                                                  ELCDTERX
  1233     ADD 1                       TO INDEXCA.                      ELCDTERX
  1234     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1235                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1236     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1237                                                                  ELCDTERX
  1238 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS219.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1239                                                                  ELCDTERX
  1240     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1241                                                                  ELCDTERX
  1242     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1243             OR                                                   ELCDTERX
  1244         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1245         GO TO 0005-READ--CARD.                                   ELCDTERX
  1246                                                                  ELCDTERX
  1247     ADD 1                       TO INDEXST.                      ELCDTERX
  1248     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1249                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1250     GO TO 0072-READ--OPST.                                       ELCDTERX
  1251                                                                  ELCDTERX
  1252 0074-READ--OPBS.                                                 ELCDTERX
  1253                                                                  ELCDTERX
  1254     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1255                                                                  ELCDTERX
  1256     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1257             OR                                                   ELCDTERX
  1258         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1259         GO TO 0005-READ--CARD.                                   ELCDTERX
  1260                                                                  ELCDTERX
  1261     ADD 1                       TO INDEXBS.                      ELCDTERX
  1262     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1263     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1264                                                                  ELCDTERX
  1265 0079-READ--EXIT.                                                 ELCDTERX
  1266*    EXIT.                                                        ELCDTERX
  1267******************************************************************ELCDTERX
  1268
  1269 0110-OPEN-RTN.
  1270
  1271     OPEN INPUT  GAAP-EXTR
  1272          OUTPUT CREDIT NON-CREDIT
  1273                 PRNTR
  1274
  1275     PERFORM 0500-PRINT-HEADINGS THRU 0510-HEADING-EXIT
  1276
  1277     PERFORM 0130-READ-GAAP  THRU 0130-EXIT
  1278     PERFORM 0120-PROCESS-GAAP THRU 0120-EXIT UNTIL
  1279          THERE-ARE-NO-MORE-RECORDS
  1280     PERFORM 0600-CLOSE-FILES THRU 0600-EXIT
  1281
  1282     GOBACK
  1283
  1284     .
  1285
  1286 0120-PROCESS-GAAP.
  1287
  1288     IF GR-REIN = 'P' OR 'R'
  1289        CONTINUE
  1290     ELSE
  1291        MOVE 0301 TO WS-RETURN-CODE
  1292        MOVE ' INVALID GAAP RECORD ' TO WS-ABEND-MESSAGE
  1293        PERFORM ABEND-PGM
  1294     END-IF
  1295
  1296     MOVE 'N'           TO WS-NON-CREDIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS219.cbl
  1297
  1298     SET WS-LF-NDX TO +1
  1299
  1300     SEARCH WS-LIFE VARYING WS-LF-NDX AT END
  1301          CONTINUE
  1302       WHEN WS-LIFE-BEN (WS-LF-NDX) = GR-LFTYP
  1303          SET RECORD-NON-CREDIT TO TRUE
  1304     END-SEARCH
  1305
  1306     SET WS-AH-NDX TO +1
  1307
  1308     SEARCH WS-AH VARYING WS-AH-NDX AT END
  1309          CONTINUE
  1310       WHEN WS-AH-BEN (WS-AH-NDX) = GR-AHTYP
  1311          SET RECORD-NON-CREDIT TO TRUE
  1312     END-SEARCH
  1313
  1314     IF ((GR-LF-TERM = 0) OR
  1315        (GR-LF-TERM > 120))
  1316             AND
  1317        ((GR-AH-TERM = 0) OR
  1318        (GR-AH-TERM > 120))
  1319          SET RECORD-NON-CREDIT TO TRUE
  1320     END-IF
  1321
  1322*    IF (GR-LF-TERM > 120)  OR
  1323*       (GR-AH-TERM > 120)
  1324*         SET RECORD-NON-CREDIT TO TRUE
  1325*    END-IF
  1326
  1327     IF RECORD-NON-CREDIT
  1328        WRITE NON-CREDIT-REC FROM GAAP-RECORD
  1329     ELSE
  1330        WRITE CREDIT-REC FROM GAAP-RECORD
  1331     END-IF
  1332
  1333     PERFORM 0130-READ-GAAP THRU 0130-EXIT
  1334
  1335     .
  1336
  1337 0120-EXIT.
  1338     EXIT.
  1339
  1340 0130-READ-GAAP.
  1341
  1342     READ GAAP-EXTR AT END
  1343         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  1344     END-READ
  1345
  1346     .
  1347
  1348 0130-EXIT.
  1349     EXIT.
  1350
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS219.cbl
  1352 0480-PRT-RTN.
  1353
  1354     IF DTE-FICH = SPACE OR '2'
  1355       MOVE X                    TO  P-CTL
  1356       IF P-CTL = ' '
  1357         WRITE PRT AFTER ADVANCING 1 LINE
  1358       ELSE
  1359         IF P-CTL = '0'
  1360           WRITE PRT AFTER ADVANCING 2 LINES
  1361         ELSE
  1362           IF P-CTL = '-'
  1363             WRITE PRT AFTER ADVANCING 3 LINES
  1364           ELSE
  1365             WRITE PRT AFTER ADVANCING PAGE.
  1366
  1367******************************************************************
  1368
  1369 0490-E-PRT-RTN.
  1370     EXIT.
  1371
  1372 0500-PRINT-HEADINGS.
  1373     MOVE '1'    TO X.
  1374     MOVE HEAD-1 TO P-DATA.
  1375     PERFORM 0480-PRT-RTN THRU 0490-E-PRT-RTN.
  1376
  1377     MOVE ' '             TO X.
  1378     MOVE WS-CURRENT-DATE TO HD-DATE.
  1379     MOVE COMPANY-NAME    TO HD-CLIENT.
  1380     MOVE HEAD-2          TO P-DATA.
  1381     PERFORM 0480-PRT-RTN THRU 0490-E-PRT-RTN.
  1382
  1383     MOVE 1         TO HD-PAGE.
  1384     MOVE ALPH-DATE TO HD-ALF-DTE.
  1385     MOVE HEAD-3    TO P-DATA.
  1386     PERFORM 0480-PRT-RTN THRU 0490-E-PRT-RTN.
  1387
  1388 0510-HEADING-EXIT.
  1389     EXIT.
  1390
  1391 0600-CLOSE-FILES.
  1392
  1393     CLOSE GAAP-EXTR CREDIT NON-CREDIT PRNTR
  1394
  1395     .
  1396
  1397 0600-EXIT.
  1398     EXIT.
  1399
  1400 ABEND-PGM.
* 1401                     COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       49424     Code:        4255
