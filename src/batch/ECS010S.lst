* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010S.cbl
* Options: int("ECS010S.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010S.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010S.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010S.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010S.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010S.cbl
    55 ENVIRONMENT DIVISION.
    56 CONFIGURATION SECTION.
    57 SPECIAL-NAMES.
    58     C02 IS LCP-CH2
    59     C03 IS LCP-CH3
    60     C04 IS LCP-CH4
    61     C05 IS LCP-CH5
    62     C06 IS LCP-CH6
    63     C07 IS LCP-CH7
    64     C08 IS LCP-CH8
    65     C09 IS LCP-CH9
    66     C10 IS LCP-CH10
    67     C11 IS LCP-CH11
    68     C12 IS LCP-CH12
    69     S01 IS LCP-P01
    70     S02 IS LCP-P02.
    71
    72 INPUT-OUTPUT SECTION.
    73 FILE-CONTROL.
    74
    75     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    76
    77     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    78
    79     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    80                             ACCESS IS SEQUENTIAL
    81                             ORGANIZATION IS INDEXED
    82                             FILE STATUS IS ERACCTT-FILE-STATUS
    83                             RECORD KEY IS AM-CONTROL-PRIMARY.
    84
    85     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    86                             ACCESS IS DYNAMIC
    87                             ORGANIZATION IS INDEXED
    88                             FILE STATUS IS ERRTBL-FILE-STATUS
    89                             RECORD KEY IS RE-CONTROL-PRIMARY.
    90
    91     SELECT ERCTBL           ASSIGN TO ERCTBLT
    92                             ACCESS IS DYNAMIC
    93                             ORGANIZATION IS INDEXED
    94                             FILE STATUS IS ERCTBL-FILE-STATUS
    95                             RECORD KEY IS CT-CONTROL-PRIMARY.
    96
    97     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
    98                             ORGANIZATION INDEXED
    99                             ACCESS DYNAMIC
   100                             RECORD KEY ME-CONTROL-PRIMARY
   101                             FILE STATUS ERMEBL-FILE-STATUS.
   102
   103     SELECT ERRESC-IN        ASSIGN TO ERRESC
   104                             ORGANIZATION IS INDEXED
   105                             ACCESS IS DYNAMIC
   106                             RECORD KEY IS ERRESC-RECORD-KEY
   107                             FILE STATUS IS ERRESC-FILE-STATUS.
   108
   109     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   110
   111     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   112
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010S.cbl
   113     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   114
   115
   116     SELECT ME-ECS010-BALANCE
   117                             ASSIGN TO SYS012
   118                             ORGANIZATION IS LINE SEQUENTIAL.
   119
   120     SELECT ME50-ECS010-BALANCE
   121                             ASSIGN TO SYS013
   122                             ORGANIZATION IS LINE SEQUENTIAL.
   123
   124     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   125
   126     SELECT DISK-DATE        ASSIGN TO SYS019.
   127
   128     SELECT PRINT-COPY       ASSIGN TO SYS008.
   129
   130     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   131
   132     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010S.cbl
   134 DATA DIVISION.
   135 FILE SECTION.
   136
   137 FD  PENDING-EXTRACT
   138     BLOCK CONTAINS 0 RECORDS
   139     RECORDING MODE F.
   140
*  141                             COPY ERCEXTD.
   142******************************************************************04/29/98
   143*                                                                *ERCEXTD
   144*                                                                *ERCEXTD
   145*                            ERCEXTD                             *   LV002
   146*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   147*                            VMOD=2.002                          *   CL**2
   148*                                                                *ERCEXTD
   149*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   150*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   151*                                                                *ERCEXTD
   152*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   153*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   154*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   155*                                                                *ERCEXTD
   156*         RECORD                                                 *ERCEXTD
   157*          TYPE          PROGRAM USING                           *ERCEXTD
   158*        --------        --------------------------------        *ERCEXTD
   159*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   160*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   161*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   162*                                                                *ERCEXTD
   163* -------------------------------------------------------------- *ERCEXTD
   164*                                                                *ERCEXTD
   165*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   166*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   167*                                                                *ERCEXTD
   168*   FILENAME = EREXTD                                            *ERCEXTD
   169*                                                                *ERCEXTD
   170******************************************************************ERCEXTD
   171                                                                  ERCEXTD
   172 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   173     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   174         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   175                                                                  ERCEXTD
   176     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   177         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   178         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   179         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   180                                                                  ERCEXTD
   181     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   182                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010S.cbl
   184 FD  CERT-MASTER-IN
*  185                             COPY ECSCRIFD.
   186******************************************************************07/10/97
   187*                                                                *ECSCRIFD
   188*                            ECSCRIFD                            *   LV001
   189*                            VMOD 2.005                          *ECSCRIFD
   190*                                                                *ECSCRIFD
   191*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   192*                                                                *ECSCRIFD
   193******************************************************************ECSCRIFD
   194     BLOCK CONTAINS 0 RECORDS
   195     RECORDING MODE F.                                            ECSCRIFD
   196                                                                  ECSCRIFD
   197 01  CERT-IN-RECORD.                                              ECSCRIFD
   198                                                                  ECSCRIFD
   199     12  FILLER                            PIC XXX.               ECSCRIFD
   200     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   201     12  FILLER                            PIC X(66).             ECSCRIFD
   202     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   203     12  FILLER                            PIC X(20).             ECSCRIFD
   204     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   205     12  FILLER                            PIC X(14).             ECSCRIFD
   206     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   207     12  FILLER                            PIC X(39).             ECSCRIFD
   208     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   209     12  FILLER                            PIC X(45).             ECSCRIFD
   210     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   211     12  FILLER                            PIC X(35).             ECSCRIFD
   212     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   213     12  FILLER                            PIC X(41).             ECSCRIFD
   214     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   215     12  FILLER                            PIC X(48).             ECSCRIFD
   216     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   217     12  FILLER                            PIC X(9).              ECSCRIFD
   218     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   219     12  FILLER                            PIC X(120).            ECSCRIFD
   220     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   221     12  FILLER                            PIC X(73).             ECSCRIFD
   222     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   223     12  FILLER                            PIC X(464).            ECSCRIFD
   224                                                                  ECSCRIFD
   225******************************************************************ECSCRIFD
   226
   227 01  CI-RECORD.
   228     12  FILLER          PIC  X(03).
   229     12  CI-ACCOUNT-CONTROL.
   230         16  CI-CARRIER      PIC  X(01).
   231         16  CI-GROUPING     PIC  X(06).
   232         16  CI-STATE        PIC  X(02).
   233         16  CI-ACCOUNT      PIC  X(10).
   234     12  FILLER          PIC  X(06).
   235     12  CI-CERT-NO.
   236         16  CI-CERT     PIC X(10).
   237         16  CI-CERT-SFX PIC X.
   238     12  FILLER          PIC  X(1017).
   239
   240******************************************************
   241*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010S.cbl
   242*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   243*   COMMERCIAL FEDERAL BANK
   244******************************************************
   245 01  CF-RECORD.
   246     12  FILLER          PIC X(759).
   247     12  CF-THIRD-AGENT  PIC X(10).
   248     12  FILLER          PIC X(7).
   249     12  CF-FOURTH-AGENT PIC X(10).
   250     12  FILLER          PIC X(270).
   251
   252******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010S.cbl
   254 FD  ERACCTT-IN.
   255
*  256                             COPY ERCACCT.
   257******************************************************************04/19/98
   258*                                                                *ERCACCT
   259*                                                                *ERCACCT
   260*                            ERCACCT                             *   LV031
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   262*                            VMOD=2.031                          *ERCACCT
   263*                                                                *ERCACCT
   264*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   265*                                                                *ERCACCT
   266*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   267*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   268*                                                                *ERCACCT
   269*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   270*                                                                *ERCACCT
   271*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   272*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   273*                                                                *ERCACCT
   274*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   275*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   276*                                                                *ERCACCT
   277*   LOG = NO                                                     *ERCACCT
   278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   279*                                                                *ERCACCT
   280*                                                                *ERCACCT
   281******************************************************************ERCACCT
   282*                   C H A N G E   L O G
   283*
   284* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   285*-----------------------------------------------------------------
   286*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   287* EFFECTIVE    NUMBER
   288*-----------------------------------------------------------------
   289* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   290* 092705    2005050300006  PEMA  ADD SPP LEASES
   291* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   292* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   293* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   294* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   295* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   296******************************************************************
   297                                                                  ERCACCT
   298 01  ACCOUNT-MASTER.                                              ERCACCT
   299     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   300         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   301                                                                  ERCACCT
   302     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   303         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   304         16  AM-MSTR-CNTRL.                                       ERCACCT
   305             20  AM-CONTROL-A.                                    ERCACCT
   306                 24  AM-CARRIER            PIC X.                 ERCACCT
   307                 24  AM-GROUPING.                                 ERCACCT
   308                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   309                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   310                 24  AM-STATE              PIC XX.                ERCACCT
   311                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   312                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   313                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   314             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   315                                           PIC X(19).             ERCACCT
   316             20  AM-CNTRL-B.                                      ERCACCT
   317                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   318                 24  FILLER                PIC X(4).              ERCACCT
   319             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   320                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   321                                                                  ERCACCT
   322     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   323         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   324         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   325         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   326         16  AM-VG-STATE                   PIC XX.                ERCACCT
   327         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   328         16  AM-VG-DATE.                                          ERCACCT
   329             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   330             20  FILLER                    PIC X(4).              ERCACCT
   331         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   332                                           PIC 9(11)      COMP-3. ERCACCT
   333     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   334         16  FILLER                        PIC X(10).
   335         16  AM-VG-KEY3.
   336             20  AM-VG3-ACCOUNT            PIC X(10).
   337             20  AM-VG3-EXP-DT             PIC XX.
   338         16  FILLER                        PIC X(4).
   339     12  AM-MAINT-INFORMATION.                                    ERCACCT
   340         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   341         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   342         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   343         16  FILLER                        PIC XX.                ERCACCT
   344                                                                  ERCACCT
   345     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   346     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   347                                                                  ERCACCT
   348     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   349         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   350         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   351                                                                  ERCACCT
   352     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   353     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   354                                                                  ERCACCT
   355     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   356     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   357                                                                  ERCACCT
   358     12  AM-NAME                           PIC X(30).             ERCACCT
   359     12  AM-PERSON                         PIC X(30).             ERCACCT
   360     12  AM-ADDRS                          PIC X(30).             ERCACCT
   361     12  AM-CITY.
   362         16  AM-ADDR-CITY                  PIC X(28).
   363         16  AM-ADDR-STATE                 PIC XX.
   364     12  AM-ZIP.                                                  ERCACCT
   365         16  AM-ZIP-PRIME.                                        ERCACCT
   366             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   367                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   368             20  FILLER                    PIC X(4).              ERCACCT
   369         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   370     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   371         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   372         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   373         16  FILLER                        PIC XXX.               ERCACCT
   374     12  AM-TEL-NO.                                               ERCACCT
   375         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   376         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   377         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   378     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   379         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   380         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   381                                                                  ERCACCT
   382     12  AM-COMM-STRUCTURE.                                       ERCACCT
   383         16  AM-DEFN-1.                                           ERCACCT
   384             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   385                 24  AM-AGT.                                      ERCACCT
   386                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   387                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   388                 24  AM-COM-TYP            PIC X.                 ERCACCT
   389                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   390                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   391                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   392                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   393                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   394                 24  AM-GL-CODES           PIC X.                 ERCACCT
   395                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   396                 24  FILLER                PIC X(01).             ERCACCT
   397         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   398             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   399                 24  FILLER                PIC X(11).             ERCACCT
   400                 24  AM-L-COMA             PIC XXX.               ERCACCT
   401                 24  AM-J-COMA             PIC XXX.               ERCACCT
   402                 24  AM-A-COMA             PIC XXX.               ERCACCT
   403                 24  FILLER                PIC X(6).              ERCACCT
   404                                                                  ERCACCT
   405     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   406         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   407                                                                  ERCACCT
   408     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   409                                                                  ERCACCT
   410     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   411         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   412         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   413     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   414         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   415         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   416     12  AM-GPCD                           PIC 99.                ERCACCT
   417     12  AM-IG                             PIC X.                 ERCACCT
   418         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   419         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   420     12  AM-STATUS                         PIC X.                 ERCACCT
   421         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   422         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   423         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   424         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   425         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   426         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   427     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   428     12  AM-ID-NO                          PIC X(11).             ERCACCT
   429                                                                  ERCACCT
   430     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   431     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   432     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   433     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   434     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   435     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   436     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   437     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   438     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   439                                                                  ERCACCT
   440     12  AM-USER-FIELDS.                                          ERCACCT
   441         16  AM-FLD-1                      PIC XX.                ERCACCT
   442         16  AM-FLD-2                      PIC XX.                ERCACCT
   443         16  AM-FLD-3                      PIC XX.                ERCACCT
   444         16  AM-FLD-4                      PIC XX.                ERCACCT
   445         16  AM-FLD-5                      PIC XX.                ERCACCT
   446                                                                  ERCACCT
   447     12  AM-1ST-PROD-DATE.                                        ERCACCT
   448         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   449         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   450         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   451     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   452     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   453         16  AM-PUR-YR                     PIC XX.                ERCACCT
   454         16  AM-PUR-MO                     PIC XX.                ERCACCT
   455         16  AM-PUR-DA                     PIC XX.                ERCACCT
   456     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   457     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   458     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   459     12  AM-INACTIVE-DATE.                                        ERCACCT
   460         16  AM-INA-MO                     PIC 99.                ERCACCT
   461         16  AM-INA-DA                     PIC 99.                ERCACCT
   462         16  AM-INA-YR                     PIC 99.                ERCACCT
   463     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   464                                                                  ERCACCT
   465     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   466     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   467                                                                  ERCACCT
   468     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   469         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   470         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   471         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   472         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   473                                                                  ERCACCT
   474     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   475         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   476         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   477                                                                  ERCACCT
   478     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   479                                                                  ERCACCT
   480     12  AM-OVER-SHORT.                                           ERCACCT
   481         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   482         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   483                                                                  ERCACCT
   484     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   485     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   486                                                                  ERCACCT
   487     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   488     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   489                                                                  ERCACCT
   490     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   491     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   492     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   493     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   494     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   495     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   496     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   497     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   498     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   499     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   500     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   501     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   502     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   503     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   504     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   505     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   506                                                                  ERCACCT
   507     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   508                                                                  ERCACCT
   509     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   510     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   511                                                                  ERCACCT
   512     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   513     12  AM-EARN-METHODS.                                         ERCACCT
   514         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   515             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   516             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   517             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   518             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   519         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   520             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   521             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   522             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   523             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   524         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   525             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   526             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   527             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   528             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   529             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   530             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   531                                                                  ERCACCT
   532     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   533     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   534     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   535                                                                  ERCACCT
   536     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   537     12  AM-RET-P-E                        PIC X.                 ERCACCT
   538     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   539     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   540     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   541     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   542         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   543         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   544     12  AM-RETRO-EARNINGS.                                       ERCACCT
   545         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   546         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   547         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   548     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   549         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   550         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   551     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   552         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   553         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   554         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   555     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   556     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   557                                                                  ERCACCT
   558     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   559         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   560         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   561         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   562         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   563         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   564                                                                  ERCACCT
   565     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   566                                                                  ERCACCT
   567     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   568                                                                  ERCACCT
   569     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   570         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   571                                                                  ERCACCT
   572     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   573         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   574         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   575                                                                  ERCACCT
   576     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   577         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   578                                                                  ERCACCT
   579     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   580         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   581         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   582                                                                  ERCACCT
   583     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   584                                                                  ERCACCT
   585     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   586     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   587     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   588     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   589     12  AM-DCC-UEF-STATE                  PIC XX.
   590     12  FILLER                            PIC XXX.
   591     12  AM-REPORT-CODE-3                  PIC X(10).
   592*    12  FILLER                            PIC X(22).             ERCACCT
   593                                                                  ERCACCT
   594     12  AM-RESERVE-DATE.                                         ERCACCT
   595         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   596         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   597         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   598                                                                  ERCACCT
   599     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   600     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   601         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   602         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   603         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   604         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   605                                                                  ERCACCT
   606     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   607         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   608         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   609         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   610         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   611                                                                  ERCACCT
   612     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   613         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   614             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   615             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   616             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   617             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   618             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   619             20  FILLER                    PIC XX.                ERCACCT
   620         16  FILLER                        PIC X(80).             ERCACCT
   621                                                                  ERCACCT
   622     12  AM-TRANSFER-DATA.                                        ERCACCT
   623         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   624             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   625             20  AM-TRNFROM-GROUPING.                             ERCACCT
   626                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   627                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   628             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   629             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   630                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   631                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   632             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   633         16  AM-TRANSFERRED-TO.                                   ERCACCT
   634             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   635             20  AM-TRNTO-GROUPING.                               ERCACCT
   636                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   637                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   638             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   639             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   640                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   641                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   642             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   643         16  FILLER                        PIC X(10).             ERCACCT
   644                                                                  ERCACCT
   645     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   646                                                                  ERCACCT
   647     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   648         16  AM-DEFN-1-SAVED.                                     ERCACCT
   649             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   650                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   651                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   652                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   653                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   654                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   655                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   656                 24  FILLER                PIC X.                 ERCACCT
   657                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   658                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   659                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   660         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   661             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   662                 24  FILLER                PIC X(11).             ERCACCT
   663                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   664                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   665                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   666                 24  FILLER                PIC X(6).              ERCACCT
   667                                                                  ERCACCT
   668     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   669         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   670            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   671            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   672            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   673                                                                  ERCACCT
   674     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   675     12  FILLER                            PIC X(120).            ERCACCT
   676                                                                  ERCACCT
   677     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   678         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   679         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   680             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   681             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   682                                                          COMP-3. ERCACCT
   683             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   684                                                          COMP-3. ERCACCT
   685         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   686             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   687             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   688                                                          COMP-3. ERCACCT
   689             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   690                                                          COMP-3. ERCACCT
   691                                                                  ERCACCT
   692     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   693         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   694         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   695         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   696         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   697             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   698                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   699                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   700             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   701                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   702                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   703             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   704                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   705                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   706         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   707             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   708                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   709                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   710                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   711             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   712                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   713                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   714             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   715                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   716                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   717                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCACCT)
   718     12  AM-COMMENTS.                                             ERCACCT
   719         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   720                                                                  ERCACCT
   721     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   722         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   723         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   724         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   725         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   726         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   727             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   728             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   729             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   730             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   731         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   732             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   733             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   734             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   735         16  FILLER                        PIC X(102).            ERCACCT
   736                                                                  ERCACCT
   737     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   738         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   739             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   740             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   741             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   742             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   743             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   744         16  FILLER                          PIC X(10).           ERCACCT
   745******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010S.cbl
   747 FD  ERRTBL-IN.
   748
*  749                             COPY ERCREIN.
   750******************************************************************07/27/93
   751*                                                                *ERCREIN
   752*                            ERCREIN                             *   LV009
   753*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   754*                            VMOD=2.010                          *   CL**9
   755*                                                                *ERCREIN
   756*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   757*                                                                *ERCREIN
   758*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   759*                                                                *ERCREIN
   760*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   761*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   762*                                                                *ERCREIN
   763*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   764*       ALTERNATE PATH = NONE                                    *ERCREIN
   765*                                                                *ERCREIN
   766*   LOG = NO                                                     *ERCREIN
   767*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   768*                                                                *ERCREIN
   769******************************************************************ERCREIN
   770*                   C H A N G E   L O G
   771*
   772* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   773*-----------------------------------------------------------------
   774*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   775* EFFECTIVE    NUMBER
   776*-----------------------------------------------------------------
   777* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   778* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   779******************************************************************
   780 01  REINSURANCE-RECORD.                                          ERCREIN
   781     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   782         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   783                                                                  ERCREIN
   784     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   785         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   786         16  RE-KEY.                                              ERCREIN
   787             20  RE-CODE                   PIC X.                 ERCREIN
   788                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   789                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   790             20  RE-TABLE                  PIC XXX.               ERCREIN
   791             20  FILLER                    PIC XXX.               ERCREIN
   792         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   793             20  FILLER                    PIC X.                 ERCREIN
   794             20  RE-COMPANY.                                      ERCREIN
   795                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   796                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   797                                                                  ERCREIN
   798     12  RE-MAINT-INFORMATION.                                    ERCREIN
   799         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   800         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   801         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   802         16  FILLER                        PIC X(10).             ERCREIN
   803                                                                  ERCREIN
   804     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCREIN)
   805         16  RE-100-COMP                   PIC 99.                ERCREIN
   806                                                                  ERCREIN
   807         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   808             20  RE-REI-COMP-NO.                                  ERCREIN
   809                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   810                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   811             20  RE-LF-QC                  PIC X.                 ERCREIN
   812             20  RE-AH-QC                  PIC X.                 ERCREIN
   813             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   814             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   815             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   816             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   817             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   818             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   819             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   820             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   821             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   822             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   823             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   824             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   825             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   826             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   827             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   828             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   829             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   830             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   831             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   832             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   833             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   834             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   835             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   836             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   837             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   838             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   839             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   840             20  RE-REMAINING              PIC X.                 ERCREIN
   841             20  RE-LF-RUNOFF-SW           PIC X.                      000
   842             20  RE-AH-RUNOFF-SW           PIC X.                      000
   843             20  FILLER                    PIC X(19).                  000
   844                                                                  ERCREIN
   845         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   846         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   847         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   848         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   849             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   850                                                                  ERCREIN
   851         16  FILLER                        PIC X(27).             ERCREIN
   852                                                                  ERCREIN
   853     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   854         16  RE-NAME                       PIC X(30).             ERCREIN
   855         16  RE-LF-PE                      PIC X.                 ERCREIN
   856         16  RE-AH-PE                      PIC X.                 ERCREIN
   857         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   858         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   859         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   860         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   861         16  RE-PRT-ST                     PIC X.                 ERCREIN
   862         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCREIN)
   863         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   864         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   865         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   866         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   867         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   868         16  RE-LF-COMM                    PIC X.                 ERCREIN
   869         16  RE-AH-COMM                    PIC X.                 ERCREIN
   870         16  RE-LF-TAX                     PIC X.                 ERCREIN
   871         16  RE-AH-TAX                     PIC X.                 ERCREIN
   872         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   873         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   874         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   875                                                                  ERCREIN
   876         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   877             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   878                                                                  ERCREIN
   879         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   880             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   881                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   882                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   883                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   884                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   885             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   886                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   887                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   888                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   889                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   890                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   891                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   892                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   893                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   894             20  FILLER                    PIC XXX.               ERCREIN
   895             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   896                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   897                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   898                                                                  ERCREIN
   899         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   900             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   901                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   902                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   903                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   904                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   905             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   906                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   907                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   908                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   909                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   910                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   911                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   912                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   913                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   914             20  FILLER                    PIC XXX.               ERCREIN
   915             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   916                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   917                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   918                                                                  ERCREIN
   919         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   920                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCREIN)
   921         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   922                                                                  ERCREIN
   923         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   924         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   925         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   926         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   927         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   928         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   929         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   930         16  RE-MORT-SW                    PIC X.                 ERCREIN
   931         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   932             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   933             88  RE-CEDED                          VALUE 'C'.        CL**2
   934             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   935             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   936                                                                  ERCREIN
   937         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   938             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   939         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   940             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   941         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   942             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   943         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   944             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   945         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   946             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   947                                                                     CL**3
   948         16  RE-PRT-CRSV                   PIC X.                    CL**5
   949                                                                     CL**5
   950         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   951                                                                     CL**8
   952         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   953                                                                     CL**8
   954         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   955                                                                     CL**9
   956         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   957             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   958             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   959
   960         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   961             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   962                                                                     CL**9
   963         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   964         16  FILLER                        PIC X(2281).              CL**9
   965                                                                  ERCREIN
   966         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   967                                                                  ERCREIN
   968******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010S.cbl
   970 FD  ERCTBL.
   971
*  972                             COPY ERCCTBL.
   973******************************************************************04/29/98
   974*                                                                *ERCCTBL
   975*                                                                *ERCCTBL
   976*                            ERCCTBL                             *   LV002
   977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   978*                            VMOD=2.003                              CL**2
   979*                                                                *ERCCTBL
   980*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
   981*                                                                *ERCCTBL
   982*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
   983*                                                                *ERCCTBL
   984*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
   985*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
   986*                                                                *ERCCTBL
   987*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
   988*       ALTERNATE PATH = NONE                                    *ERCCTBL
   989*                                                                *ERCCTBL
   990*   LOG = NO                                                     *ERCCTBL
   991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
   992*                                                                *ERCCTBL
   993*                                                                *ERCCTBL
   994******************************************************************ERCCTBL
   995                                                                  ERCCTBL
   996 01  COMM-TABLE-RECORD.                                           ERCCTBL
   997     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
   998         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
   999                                                                  ERCCTBL
  1000     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1001         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1002         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1003         16  CT-CNTRL-2.                                          ERCCTBL
  1004             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1005             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1006                                                                  ERCCTBL
  1007     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1008         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1009         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1010         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1011         16  FILLER                        PIC X(31).             ERCCTBL
  1012                                                                  ERCCTBL
  1013     12  CT-LIMITS.                                               ERCCTBL
  1014         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1015                                                                  ERCCTBL
  1016         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1017                                                                  ERCCTBL
  1018         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1019                                                                  ERCCTBL
  1020     12  CT-RATES.                                                ERCCTBL
  1021         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1022             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1023             20  CT-RT-R   REDEFINES                              ERCCTBL
  1024                 CT-RT                     PIC XXX.               ERCCTBL
  1025                                                                  ERCCTBL
  1026     12  FILLER                            PIC  X(42).            ERCCTBL
  1027                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010S.cbl
  1028******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010S.cbl
  1030 FD  ERMEBL-INOUT.
  1031
* 1032                             COPY ERCMEBL.
  1033******************************************************************
  1034*
  1035*
  1036*                            ERCMEBL                             *
  1037*                                                                *
  1038*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1039*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1040*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1041*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1042*                                                                *
  1043*    FILE TYPE = VSAM, KSDS                                      *
  1044*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1045*                                                                *
  1046*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1047*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1048*                                                                *
  1049******************************************************************
  1050
  1051******************************************************************
  1052*                   C H A N G E   L O G
  1053*
  1054* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1055*-----------------------------------------------------------------
  1056*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1057* EFFECTIVE    NUMBER
  1058*-----------------------------------------------------------------
  1059* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1060******************************************************************
  1061 01  MONTH-END-BALANCES.
  1062     12  ME-RECORD-ID            PIC  XX.
  1063     12  ME-CONTROL-PRIMARY.
  1064         16  ME-COMPANY          PIC  XXX.
  1065         16  ME-MOYR             PIC  9999       COMP.
  1066     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1067     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1068     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1069     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1070     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1071     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1072     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1073     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1074     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1075     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1076     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1077     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1078     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1079     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1080*    12  ME-010-START            PIC  9(6)       COMP-3.
  1081*    12  ME-010-END              PIC  9(6)       COMP-3.
  1082     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1083     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1084     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1085     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1086     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1087     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1088*    12  ME-018-START            PIC  9(6)       COMP-3.
  1089*    12  ME-018-END              PIC  9(6)       COMP-3.
  1090     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1091     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1092     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1093     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1094     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1095     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1096     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1097     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1098     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1099     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1100*    12  ME-019-START            PIC  9(6)       COMP-3.
  1101*    12  ME-019-END              PIC  9(6)       COMP-3.
  1102     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1103     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1104     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1105     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1106*    12  ME-030-START            PIC  9(6)       COMP-3.
  1107*    12  ME-030-END              PIC  9(6)       COMP-3.
  1108     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1109     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1110     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1111     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1112*    12  ME-032-START            PIC  9(6)       COMP-3.
  1113*    12  ME-032-END              PIC  9(6)       COMP-3.
  1114     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1115     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1116     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1117     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1118*    12  ME-035-START            PIC S9(6)       COMP-3.
  1119*    12  ME-035-END              PIC S9(6)       COMP-3.
  1120     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1121     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1122     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1123     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1124*    12  ME-038-START            PIC  9(6)       COMP-3.
  1125*    12  ME-038-END              PIC  9(6)       COMP-3.
  1126     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1127     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1128     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1129*    12  ME-041-START            PIC  9(6)       COMP-3.
  1130*    12  ME-041-END              PIC  9(6)       COMP-3.
  1131     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1132     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1133     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1134*    12  ME-050-START            PIC  9(6)       COMP-3.
  1135     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1136*    12  ME-050-END              PIC  9(6)       COMP-3.
  1137     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1138     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1139     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1140     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1141     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1142     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1143     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1144     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1145     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1146*    12  ME-061-START            PIC  9(6)       COMP-3.
  1147*    12  ME-061-END              PIC  9(6)       COMP-3.
  1148     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1149     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1150     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1151*    12  ME-080-START            PIC  9(6)       COMP-3.
  1152*    12  ME-080-END              PIC  9(6)       COMP-3.
  1153     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1154     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1155     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1156     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1157*    12  ME-315-START            PIC  9(6)       COMP-3.
  1158*    12  ME-315-END              PIC  9(6)       COMP-3.
  1159     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1160     12  ME-331-FLAG             PIC  9.
  1161     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1162*    12  ME-331-START            PIC  9(6)       COMP-3.
  1163*    12  ME-331-END              PIC  9(6)       COMP-3.
  1164     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1165     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1166     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1167*    12  ME-341-START            PIC  9(6)       COMP-3.
  1168*    12  ME-341-END              PIC  9(6)       COMP-3.
  1169     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1170     12  ME-501-FLAG             PIC  9.
  1171     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1172     12  ME-501-START            PIC  9(6)       COMP-3.
  1173     12  ME-501-END              PIC  9(6)       COMP-3.
  1174     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1175     12  ME-509-FLAG             PIC  9.
  1176     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1177     12  ME-509-START            PIC  9(6)       COMP-3.
  1178     12  ME-509-END              PIC  9(6)       COMP-3.
  1179     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1180     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1181     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1182     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1183     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1184     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1185     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1186     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1187     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1188     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1189     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1190     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1191     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1192     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1193     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1194     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1195     12  ME-522-START            PIC  9(6)       COMP-3.
  1196     12  ME-522-END              PIC  9(6)       COMP-3.
  1197     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1198     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1199     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1200     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1201     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1202     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1203     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1204     12  ME-524-END              PIC  9(6)       COMP-3.
  1205     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1206     12  ME-525-FLAG             PIC  9.
  1207     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1208     12  ME-525-START            PIC  9(6)       COMP-3.
  1209     12  ME-525-END              PIC  9(6)       COMP-3.
  1210     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1211     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1212     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1213     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1214     12  ME-048-START            PIC  9(6)       COMP-3.
  1215     12  ME-048-END              PIC  9(6)       COMP-3.
  1216     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1217     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1218
  1219     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1220     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1221     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1222     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1223     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1224     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1225     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1226     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1227     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1228     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1229     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1230     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1231     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1232     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1233     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1234     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1235     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1236     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1237     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1238     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1239     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1240     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1241     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1242     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1243     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1244     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1245     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1246     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1247     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1248     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1249     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1250     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1251     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1252     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1253
  1254     12  FILLER                  PIC  X(09).
  1255*    12  FILLER                  PIC  X(88).
  1256******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010S.cbl
  1258 FD  CERT-MASTER-OUT
* 1259                             COPY ECSCROFD.
  1260******************************************************************07/10/97
  1261*                                                                *ECSCROFD
  1262*                            ECSCROFD                            *   LV001
  1263*                            VMOD=2.002                          *ECSCROFD
  1264*                                                                *ECSCROFD
  1265*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1266*                                                                *ECSCROFD
  1267******************************************************************ECSCROFD
  1268     RECORDING MODE F                                             ECSCROFD
  1269     LABEL RECORDS STANDARD                                       ECSCROFD
  1270     BLOCK CONTAINS 0 RECORDS
  1271     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1272 01  CERT-OUT-RECORD.                                             ECSCROFD
  1273     12  FILLER                            PIC  XXX.              ECSCROFD
  1274     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1275     12  FILLER                            PIC  X(1017).          ECSCROFD
  1276                                                                  ECSCROFD
  1277******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010S.cbl
  1279 FD  DETAIL-EXTR
  1280     BLOCK CONTAINS 0 RECORDS
  1281     RECORDING MODE F.
  1282
* 1283                             COPY ECSEXT01.
  1284******************************************************************04/29/98
  1285*                                                                *ECSEXT01
  1286*                            ECSEXT01                            *   LV015
  1287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1288*                            VMOD=2.015                          *ECSEXT01
  1289*                                                                *ECSEXT01
  1290*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1291*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1292*                                                                *ECSEXT01
  1293*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1294*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1295*                                                                *ECSEXT01
  1296*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1297*                                                                *ECSEXT01
  1298******************************************************************ECSEXT01
  1299******************************************************************
  1300*                   C H A N G E   L O G
  1301*
  1302* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1303*-----------------------------------------------------------------
  1304*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1305* EFFECTIVE    NUMBER
  1306*-----------------------------------------------------------------
  1307* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1308* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1309* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1310* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1311* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1312* 032612  CR2011110200001  PEMA  AHL CHANGES
  1313******************************************************************
  1314                                                                  ECSEXT01
  1315 01  DETAIL-EXTRACT.                                              ECSEXT01
  1316     02 DETAIL-FILE.                                              ECSEXT01
  1317     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1318         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1319                                                                  ECSEXT01
  1320     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1321                                                                  ECSEXT01
  1322     12  DE-REIN                           PIC X.                 ECSEXT01
  1323                                                                  ECSEXT01
  1324     12  DE-CONTROL.                                              ECSEXT01
  1325         16  DE-CNTRL1.                                           ECSEXT01
  1326             20  DE-CARRIER                PIC X.                 ECSEXT01
  1327             20  DE-GROUPING.                                     ECSEXT01
  1328                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1329                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1330             20  DE-STATE                  PIC XX.                ECSEXT01
  1331             20  DE-ACCOUNT.                                      ECSEXT01
  1332                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1333                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1334         16  DE-CNTRL2.                                           ECSEXT01
  1335             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1336             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1337                 24 DE-CERT-NO.                                   ECSEXT01
  1338                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1339                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1340                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1341                                                                  ECSEXT01
  1342     12  DE-TRANS                          PIC X.                 ECSEXT01
  1343         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1344         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1345         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1346         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1347         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1348         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1349         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1350         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1351         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1352         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1353                                                                  ECSEXT01
  1354     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1355     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1356                                                                  ECSEXT01
  1357     12  DE-NAME.                                                 ECSEXT01
  1358         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1359         16  DE-FNAME.                                            ECSEXT01
  1360             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1361             20  FILLER                    PIC X(9).              ECSEXT01
  1362         16  DE-INIT                       PIC X.                 ECSEXT01
  1363     12  DE-AGE                            PIC 99.                ECSEXT01
  1364     12  DE-SEX                            PIC X.                 ECSEXT01
  1365     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1366                                                                  ECSEXT01
  1367     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1368     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1369     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1370     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1371     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1372     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1373     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1374     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1375     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1376                                                                  ECSEXT01
  1377     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1378     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1379     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1380     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1381                                                                  ECSEXT01
  1382     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1383     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1384     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1385     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1386     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1387                                                                  ECSEXT01
  1388     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1389     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1390     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1391     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1392                                                                  ECSEXT01
  1393     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1394     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1395                                           PIC S9(5)V99   COMP-3.
  1396     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1397     12  FILLER REDEFINES DE-NUM-BILLED.
  1398         16  DE-CLP-STATE                  PIC XX.
  1399         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1400     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1401     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1402                                                                  ECSEXT01
  1403     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1404     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1405     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1406     12  DE-IG                             PIC X.                 ECSEXT01
  1407     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1408*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1409     12  DE-MEMBER-NO.                                            ECSEXT01
  1410         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1411         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1412         16  FILLER                        PIC X(03).             ECSEXT01
  1413     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1414                                                                  ECSEXT01
  1415     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1416         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1417                                                                  ECSEXT01
  1418     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1419     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1420                                                                  ECSEXT01
  1421     12  DE-REI-AREA.                                             ECSEXT01
  1422         16  DE-REI-COMP.                                         ECSEXT01
  1423             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1424             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1425         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1426         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1427         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1428         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1429         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1430         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1431         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1432                                                                  ECSEXT01
  1433     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1434     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1435         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1436         16  F                             PIC X.
  1437*    12  FILLER                            PIC X(5).              ECSEXT01
  1438                                                                  ECSEXT01
  1439     12  DE-BILLED-AREA.                                          ECSEXT01
  1440         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1441             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1442                                                                  ECSEXT01
  1443         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1444             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1445             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1446             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1447             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1448             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1449             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1450                                                                  ECSEXT01
  1451         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1452             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1453                                                                  ECSEXT01
  1454         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1455         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1456         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1457         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1458                                                                  ECSEXT01
  1459         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1460*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1461*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1462                                                                  ECSEXT01
  1463     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1464         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1465         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1466         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1467                                                                  ECSEXT01
  1468     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1469         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1470         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1471     12  DE-CANCEL-REASON                  PIC X.
  1472                                                                  ECSEXT01
  1473     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1474     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1475                                                                  ECSEXT01
  1476     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1477         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1478             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1479         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1480             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1481                                                                  ECSEXT01
  1482     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1483         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1484                                                                  ECSEXT01
  1485     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1486     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1487         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1488         16  FILLER                        PIC X.
  1489                                                                  ECSEXT01
  1490****************************************************************  ECSEXT01
  1491**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1492****************************************************************  ECSEXT01
  1493     12  DE-COMM-LEVELS.                                          ECSEXT01
  1494         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1495             20  DE-AGT.                                          ECSEXT01
  1496                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1497                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1498             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1499             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1500             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1501                                                                  ECSEXT01
  1502     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1503****************************************************************  ECSEXT01
  1504*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1505****************************************************************  ECSEXT01
  1506     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1507     12  FILLER                            PIC X(334).            ECSEXT01
  1508     12  DE-TYPE                           PIC X.                 ECSEXT01
  1509         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1510         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1511         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1512         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1513         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1514         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1515                                                                  ECSEXT01
  1516     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1517     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1518                                                                  ECSEXT01
  1519     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1520     12  DE-REPORTED.                                             ECSEXT01
  1521         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1522         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1523         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1524     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1525     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1526                                                                  ECSEXT01
  1527     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1528     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1529     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1530     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1531     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1532     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1533         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1534         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1535         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1536         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1537         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1538         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1539         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1540                                                                  ECSEXT01
  1541     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1542                                                                  ECSEXT01
  1543     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1544     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1545     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1546     12  FILLER                            PIC XX.                ECSEXT01
  1547     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1548                                                                  ECSEXT01
  1549     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1550     12  DE-BENEFICIARY                    PIC X(10).
  1551     12  filler redefines de-beneficiary.
  1552         16  de-birth-date                 pic 9(11)  comp-3.
  1553         16  f                             pic x(4).
  1554     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1555     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1556     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1557     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1558     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1559     12  DE-CLM-CLASS                      PIC XX.
  1560     12  DE-CLM-DEV                        PIC XXX.
  1561     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1562     12  de-xycor-cert-seq                 pic x(3).
  1563     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1564     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1565     12  DE-XYCOR-STATUS                   PIC X.
  1566     12  FILLER                            PIC X(4).              ECSEXT01
  1567                                                                  ECSEXT01
  1568     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1569                                                                  ECSEXT01
  1570****************************************************************  ECSEXT01
  1571*******               RESERVE EXTRACT                      *****  ECSEXT01
  1572****************************************************************  ECSEXT01
  1573     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1574     12  FILLER                            PIC X(334).            ECSEXT01
  1575                                                                  ECSEXT01
  1576     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1577         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1578         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1579                                                                  ECSEXT01
  1580     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1581     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1582     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1583                                                                  ECSEXT01
  1584     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1585                                                                  ECSEXT01
  1586     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1587     12  DE-RSV-REPORTED.                                         ECSEXT01
  1588         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1589         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1590         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1591     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1592                                                                  ECSEXT01
  1593     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1594     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1595     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1596                                                                  ECSEXT01
  1597     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1598     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1599     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1600                                                                  ECSEXT01
  1601     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1602                                                                  ECSEXT01
  1603     12  DE-RATE-CLASS                     PIC XX.
  1604     12  DE-DEV-CODE                       PIC XXX.
  1605     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1606     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1607     12  FILLER                            PIC X(58).             ECSEXT01
  1608                                                                  ECSEXT01
  1609     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1610******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010S.cbl
  1612 FD  SUMMARY-EXTR
  1613     BLOCK CONTAINS 0 RECORDS
  1614     RECORDING MODE F.
  1615
* 1616                             COPY ECSEPC01.
  1617******************************************************************
  1618*                                                                *
  1619*                            ECSEPC01                            *
  1620*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1621*                            VMOD=2.008                          *
  1622*                                                                *
  1623*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1624*                                                                *
  1625*   FILE TYPE = SEQUENTIAL                                       *
  1626*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1627*                                                                *
  1628*   KEY DATA =                                  START=5, LEN=31  *
  1629*                                                                *
  1630*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1631*                                                                *
  1632******************************************************************
  1633
  1634 01  EP-RECORD.
  1635     02 EP-FILE.
  1636     12  EP-RECORD-ID                      PIC XX.
  1637         88  VALID-EP-ID                      VALUE 'EP'.
  1638
  1639     12  EP-COMPANY-CD                     PIC X.
  1640
  1641     12  EP-REIN                           PIC X.
  1642         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1643
  1644     12  EP-CONTROL.
  1645         16  EP-CNTRL-1.
  1646             20  EP-COMPANY.
  1647                 24  EP-CARRIER            PIC X.
  1648                 24  EP-GROUPING.
  1649                     28  EP-GROUP-PREFIX   PIC XXX.
  1650                     28  EP-GROUP-PRIME    PIC XXX.
  1651             20  EP-STATE                  PIC XX.
  1652             20  EP-ACCOUNT.
  1653                 24  EP-ACCT-PREFIX        PIC X(4).
  1654                 24  EP-ACCT-PRIME         PIC X(6).
  1655         16  EP-CNTRL-2.
  1656             20  EP-DATES.
  1657                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1658                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1659
  1660     12  EP-REI-CO.
  1661         16  EP-REINCO                     PIC XXX.
  1662         16  EP-REINCO-SUB                 PIC XXX.
  1663
  1664     12  EP-RCD-TYPE                       PIC X.
  1665         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1666         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1667         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1668         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1669         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1670         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1671     12  EP-BEN-CODE                       PIC XX.
  1672     12  FILLER                            PIC X.
  1673
  1674     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1675     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1676     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1677
  1678     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1679     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1680     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1681
  1682     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1683     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1684     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1685     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1686
  1687     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1688     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1689     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1690
  1691     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1692     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1693     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1694
  1695     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1696     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1697     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1698     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1699     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1700
  1701     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1702     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1703     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1704
  1705     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1706     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1707     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1708
  1709     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1710         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1711         16  EP-NEW-DATA-IND               PIC X(01).
  1712             88  EP-NEW-DATA                   VALUE 'Y'.
  1713         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1714         16  FILLER                        PIC X(19).
  1715
  1716     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1717     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1718     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1719
  1720     12  FILLER                            PIC XXX.
  1721
  1722     12  EP-UNDERWRITING-CODE              PIC X.
  1723         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1724
  1725     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1726
  1727     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1728*    12  FILLER                            PIC X(34).
  1729
  1730     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1731     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1732     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1733     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1734     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1735     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1736
  1737     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1738
  1739     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1740     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1741
  1742     12  EP-PURGE                          PIC X.
  1743         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1744
  1745     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1746
  1747     02 EC-RECORD     REDEFINES     EP-FILE.
  1748     12  EC-RECORD-ID                      PIC XX.
  1749         88  VALID-EC-ID                      VALUE 'EC'.
  1750
  1751     12  EC-COMPANY-CD                     PIC X.
  1752
  1753     12  EC-REIN                           PIC X.
  1754         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1755
  1756     12  EC-CONTROL.
  1757         16  EC-CARRIER                    PIC X.
  1758         16  EC-GROUPING.
  1759             20  EC-GROUP-PREFIX           PIC XXX.
  1760             20  EC-GROUP-PRIME            PIC XXX.
  1761         16  EC-STATE                      PIC XX.
  1762         16  EC-ACCOUNT.
  1763             20  EC-ACCT-PREFIX            PIC X(4).
  1764             20  EC-ACCT-PRIME             PIC X(6).
  1765         16  EC-DATES.
  1766             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1767             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1768
  1769     12  EC-REI-CO.
  1770         16  EC-REINCO                     PIC XXX.
  1771         16  EC-REINCO-SUB                 PIC XXX.
  1772
  1773     12  EC-RCD-TYPE                       PIC X.
  1774         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1775         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1776         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1777         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1778         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1779     12  EC-BEN-CODE                       PIC XX.
  1780     12  EC-SEQ-NBR                        PIC X.
  1781         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1782         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1783
  1784     12  EC-AGENTS-DATA.
  1785         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1786             20  EC-AGT-NO.
  1787                 24  EC-AGT-PREFIX         PIC X(4).
  1788                 24  EC-AGT-PRIME          PIC X(6).
  1789             20  EC-AGT-TYPE               PIC X.
  1790             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1791             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1792             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1793             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1794             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1795
  1796     12  EC-UNDERWRITING-CODE              PIC X.
  1797         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1798
  1799     12  EC-AGENTS-DATA-II.
  1800         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1801             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1802             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1803
  1804     12  FILLER                            PIC X(7).
  1805
  1806     12  EC-PURGE                          PIC X.
  1807         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1808
  1809     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1810
  1811******************************************************************
  1812
  1813 FD  ERRESC-IN.
* 1814                             COPY ERCRESC.
  1815******************************************************************04/29/98
  1816*                                                                *ERCRESC
  1817*                            ERCRESC                             *   LV002
  1818*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1819*                            VMOD=2.003                          *   CL**2
  1820*                                                                *ERCRESC
  1821*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1822*                                                                *ERCRESC
  1823*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1824*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1825*                                                                *ERCRESC
  1826*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1827*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1828*                                                                *ERCRESC
  1829*   LOG = NO                                                     *ERCRESC
  1830*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1831*                                                                *ERCRESC
  1832******************************************************************ERCRESC
  1833                                                                  ERCRESC
  1834 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1835                                                                  ERCRESC
  1836     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1837         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1838         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1839         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1840         15  RESC-STATE                PIC   XX.                  ERCRESC
  1841         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1842         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1843         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1844         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1845*                                           YYYYMMDD              ERCRESC
  1846     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1847                                                                  ERCRESC
  1848     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1849         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1850             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1851             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1852             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1853                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1854                                                                  ERCRESC
  1855     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1856     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1857     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1858*                                          YYYYMMDD               ERCRESC
  1859
  1860 FD  ME-ECS010-BALANCE
  1861     RECORDING MODE IS F
  1862     BLOCK CONTAINS 0 RECORDS.
  1863 01  ME-ECS010-BALANCE-REC    PIC X(83).
  1864
  1865 FD  ME50-ECS010-BALANCE
  1866     RECORDING MODE IS F
  1867     BLOCK CONTAINS 0 RECORDS.
  1868 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  1869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010S.cbl
  1871 FD  DISK-DATE
* 1872                             COPY ELCDTEFD.
  1873******************************************************************04/15/98
  1874*                                                                *ELCDTEFD
  1875*                                                                *ELCDTEFD
  1876*                            ELCDTEFD.                           *   LV002
  1877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1878*                            VMOD=2.007                          *   CL**2
  1879*                                                                *ELCDTEFD
  1880******************************************************************ELCDTEFD
  1881     BLOCK CONTAINS 0 RECORDS
  1882     RECORDING MODE F.                                            ELCDTEFD
  1883                                                                  ELCDTEFD
  1884 01  DATE-DISK.                                                   ELCDTEFD
  1885     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1886     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1887     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1888     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1889     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1890     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1891     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1892                                                                  ELCDTEFD
  1893 01  DATE-DISK-R.                                                 ELCDTEFD
  1894     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1895     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1896                                     PIC  X(32).                  ELCDTEFD
  1897                                                                  ELCDTEFD
  1898 01  DATE-DISK-T.                                                 ELCDTEFD
  1899     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1900     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1901                                     PIC  X(48).                  ELCDTEFD
  1902                                                                  ELCDTEFD
  1903 01  DATE-DISK-M.                                                 ELCDTEFD
  1904     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1905     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1906                                     PIC  X(48).                  ELCDTEFD
  1907                                                                  ELCDTEFD
  1908 01  DATE-DISK-P.                                                 ELCDTEFD
  1909     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1910     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1911     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1912     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1913         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1914                                     PIC  X.                      ELCDTEFD
  1915         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1916     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1917         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1918             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1919             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1920             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1921             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1922         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1923                                                                  ELCDTEFD
  1924 01  DATE-DISK-E.                                                 ELCDTEFD
  1925     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1926     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1927                                     PIC  X(4).                   ELCDTEFD
  1928                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1929 01  DATE-DISK-C.                                                 ELCDTEFD
  1930     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1931     12  DD-CARR1-SECPAY-SW          PIC  X.
  1932     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1933     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1934     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1935     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1936     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1937     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1938     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1939     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1940     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1941     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1942     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1943     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1944     12  DD-CARR2-SECPAY-SW          PIC  X.
  1945     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1946                                                                  ELCDTEFD
  1947 01  DATE-DISK-OPT.                                               ELCDTEFD
  1948     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1949     12  DD-TLR-DATA.                                             ELCDTEFD
  1950         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1951                                     PIC  X(03).                  ELCDTEFD
  1952     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1953         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1954                                     PIC  X(06).                  ELCDTEFD
  1955     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1956         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1957                                     PIC  X(07).                  ELCDTEFD
  1958         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1959     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1960                                     PIC  X(96).                  ELCDTEFD
  1961******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010S.cbl
  1963 FD  PRINT-COPY
* 1964                             COPY ELCPRTFD.
  1965******************************************************************04/15/98
  1966*                                                                *ELCPRTFD
  1967*                                                                *ELCPRTFD
  1968*                            ELCPRTFD.                           *   LV003
  1969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1970*                            VMOD=2.006                          *ELCPRTFD
  1971******************************************************************ELCPRTFD
  1972     RECORDING MODE F                                             ELCPRTFD
  1973     LABEL RECORDS OMITTED                                        ELCPRTFD
  1974     BLOCK CONTAINS 0 RECORDS
  1975     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  1976 01  PRT.                                                         ELCPRTFD
  1977     12  P-CTL               PIC  X.                                 CL**2
  1978     12  P-DATA              PIC  X(132).                         ELCPRTFD
  1979******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010S.cbl
  1981 FD  MISMATCH-REPORT
  1982     RECORDING MODE F.
  1983
  1984 01  MISMATCH-RPT.
  1985     12  MR-CTL              PIC X.
  1986     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010S.cbl
  1988 FD  FICH
* 1989                             COPY ELCFCHFD.
  1990******************************************************************04/15/98
  1991*                                                                *ELCFCHFD
  1992*                            ELCFCHFD.                           *   LV003
  1993*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1994*                            VMOD=2.004                          *   CL**3
  1995*                                                                *ELCFCHFD
  1996******************************************************************ELCFCHFD
  1997     BLOCK CONTAINS 0 RECORDS
  1998     RECORDING MODE F.                                            ELCFCHFD
  1999                                                                  ELCFCHFD
  2000 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2001******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010S.cbl
  2003 FD  DISPLAY-PRT
  2004     RECORDING MODE IS F
  2005     LABEL RECORDS ARE STANDARD
  2006     BLOCK CONTAINS 0 RECORDS
  2007     RECORD CONTAINS 133 CHARACTERS.
  2008
  2009 01  DISPLAY-REC.
  2010     05  DISPLAY-CC           PIC X.
  2011     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010S.cbl
  2013 WORKING-STORAGE SECTION.
  2014 77  LCP-ASA                       PIC X.
  2015 77  FILLER  PIC X(32)  VALUE '********************************'.
  2016 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2017 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2018
  2019 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2020 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2021 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2022 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2023 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2024 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2025 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2026 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2027 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2028 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2029 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2030 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2031 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2032 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2033 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2034 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2035 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2036 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2037 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2038 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2039 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2040 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2041 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2042 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2043 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2044 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2045 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2046 77  X                       PIC X.
  2047 77  DD-FLG                  PIC X               VALUE SPACE.
  2048 77  AGT-SW                  PIC X               VALUE SPACE.
  2049 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2050 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2051 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2052 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2053 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2054 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2055 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2056 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2057 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2058 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2059 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2060 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2061 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2062 77  SV-TRD-CERT             PIC X(11).
  2063 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2064 77  SV-TRD-ISDT             PIC X(10).
  2065 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2066*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2067*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
  2068 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2069 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2070 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010S.cbl
  2071 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2072 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2073 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2074 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2075 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2076 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2077 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2078 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2079 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2080 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2081 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2082 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2083 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2084 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2085 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2086 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2087 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2088 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2089 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2090 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2091 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2092 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2093 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2094 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2095 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2096 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2097 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2098 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2099 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2100 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2101 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2102 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2103 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2104 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2105 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2106 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2107 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2108 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2109 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2110 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2111 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2112 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2113 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2114 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2115 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2116 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2117 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2118 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2119 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2120 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2121 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2122 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2123 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2124 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2125 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
  2126 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2127 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2128 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010S.cbl
  2129 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2130 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2131
  2132 01  MONTH-END-DATA.
  2133     12  ME-START-DATE.
  2134         16  ME-START-MO         PIC 99.
  2135         16  FILLER              PIC X.
  2136         16  ME-START-DA         PIC 99.
  2137         16  FILLER              PIC X.
  2138         16  ME-START-YR         PIC 99.
  2139     12  ME-CNDS-DATE            PIC 9(6).
  2140     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2141         16  ME-CNDS-MO          PIC 99.
  2142         16  ME-CNDS-DA          PIC 99.
  2143         16  ME-CNDS-YR          PIC 99.
  2144     12  ME-START-TIME           PIC 9(6).
  2145     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2146         88  ME-DO-UPDATE        VALUE 'Y'.
  2147         88  ME-NO-UPDATE        VALUE 'N'.
  2148     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2149
  2150 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2151     'Life Claims Paid'.
  2152
  2153 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2154     'A&H Claims Paid'.
  2155
  2156 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2157     'Output Certificate Master Records Prior Month'.
  2158
  2159 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2160     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2161
  2162 01  WS-ME-BALANCE-REC.
  2163     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2164     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2165     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2166     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2167     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2168     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2169     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2170
  2171 01  WS-ME50-BALANCE-REC.
  2172     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2173     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2174     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2175     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2176     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2177     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2178     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2179     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2180     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2181
  2182 01  PENDING-MATCH-CONTROL.
  2183     12  PENDING-ACCOUNT-CONTROL.
  2184         16  PEND-MATCH-CARRIER    PIC X.
  2185         16  PEND-MATCH-GROUPING   PIC X(6).
  2186         16  PEND-MATCH-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010S.cbl
  2187         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2188     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2189     12  PEND-MATCH-CERT-NO.
  2190         16  PEND-MATCH-CERT       PIC X(10).
  2191         16  PEND-MATCH-CERT-SFX   PIC X.
  2192 01  PENDING-RECORD-TYPE           PIC X.
  2193     88  ISSUE-TRANSACTION            VALUE '1'.
  2194     88  CANCEL-TRANSACTION           VALUE '2'.
  2195     88  CLAIM-TRANSACTION            VALUE '3'.
  2196     88  RESERVE-TRANSACTION          VALUE '4'.
  2197     88  UPDATE-TRANSACTION           VALUE '5'.
  2198
  2199 01  CLM-INCUR-REIN-DATE.
  2200     12  CIRD-CCYY.
  2201         16  CIRD-CC         PIC 99.
  2202         16  CIRD-YR         PIC 99.
  2203     12  CIRD-MO             PIC 99.
  2204
  2205 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2206
  2207 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2208
  2209 01  REIN-BILLING-TABLE.
  2210     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2211         16  RB-COMPANY      PIC X(6).
  2212         16  RB-COUNT        PIC S9(5)   COMP-3.
  2213
  2214 01  B-SUB                   PIC S9(4)   COMP.
  2215
  2216 01  BINARY-COUNTERS     COMP      SYNC.
  2217     12  IA                  PIC S999            VALUE +0.
  2218     12  IB                  PIC S999            VALUE +0.
  2219     12  SUB                 PIC S999            VALUE +0.
  2220     12  SUBM                PIC S999            VALUE +0.
  2221     12  SUB3                PIC S999            VALUE +0.
  2222     12  SUB4                PIC S999            VALUE +0.
  2223     12  SUB5                PIC S999            VALUE +0.
  2224     12  SUB6                PIC S999            VALUE +0.
  2225     12  SUB7                PIC S999            VALUE +0.
  2226     12  SUB8                PIC S999            VALUE +0.
  2227     12  SUB9                PIC S999            VALUE +0.
  2228     12  SUB10               PIC S999            VALUE +0.
  2229     12  SUB11               PIC S999            VALUE +0.
  2230     12  SUB12               PIC S999            VALUE +0.
  2231     12  SUB13               PIC S999            VALUE +0.
  2232     12  SUB14               PIC S999            VALUE +0.
  2233     12  SUB15               PIC S999            VALUE +0.
  2234     12  SUB16               PIC S999            VALUE +0.
  2235     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2236 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2237
  2238 01  WS.
  2239     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2240     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2241     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2242     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2243
  2244     12  WS-ABEND-CODE         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010S.cbl
  2245     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2246         16  ABEND-CODE-1    PIC XX.
  2247         16  ABEND-CODE-2.
  2248             20  AC2-ONE     PIC X.
  2249             20  AC2-TWO     PIC X.
  2250
  2251     12  CTBL-SEARCH.
  2252         16  CTBL-COMP-CD    PIC X.
  2253         16  CTBL-TABLE-CD   PIC XXX.
  2254         16  CTBL-BEN-TYPE   PIC X.
  2255         16  CTBL-BEN-CODE   PIC XX.
  2256     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2257     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2258     12  WS-COMM-TERM        PIC S999            COMP-3.
  2259     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2260         88  CTBL-ERROR         VALUE '*'.
  2261
  2262     12  REIN-SPEC.
  2263         16  REIN-SPEC-A     PIC X.
  2264         16  REIN-SPEC-B     PIC X.
  2265         16  REIN-SPEC-C     PIC X.
  2266
  2267     12  WS-CHECK-NUMBER.
  2268         16  WS-CHECK-NO     PIC X(4).
  2269         16  FILLER          PIC XXX.
  2270
  2271     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2272         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
  2273         88  AH-EARN-NET                         VALUE 'N'.
  2274
  2275 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2276 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2277 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2278 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2279 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2280
  2281 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2282 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2283 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2284 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2285
  2286 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2287     12  WS-LF-CHARGEBACK-LEVELS.
  2288         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2289     12  WS-AH-CHARGEBACK-LEVELS.
  2290         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2291*****************************************************************
  2292*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2293*****************************************************************
  2294*RESIDENT STATE TAXES MASTER(ERRESC)
  2295*
  2296 01  WORK-AREAS.
  2297     12  WS-ERRESC-KEY.
  2298         16 WS-ERRESC-SEARCH-KEY.
  2299             20  WS-ERRESC-COMPANY-CD PIC  X.
  2300             20  WS-ERRESC-CARRIER    PIC  X.
  2301             20  WS-ERRESC-GROUP      PIC X(6).
  2302             20  WS-ERRESC-STATE      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010S.cbl
  2303             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2304         16 WS-ERRESC-RESIDUAL-KEY.
  2305             20  WS-ERRESC-AGENT      PIC X(10).
  2306             20  WS-ERRESC-RES-STATE  PIC XX.
  2307             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2308*                                          YYYYMMDD
  2309     12  WS-YYYYMMDD-DT               PIC 9(8).
  2310     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2311     12  WS-SUB                       PIC    99  COMP-3.
  2312     12  WS-SUB1                      PIC    99  COMP-3.
  2313*****************************************************************
  2314*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2315*****************************************************************
  2316
  2317 01  COMM-WORK-AREAS.
  2318     12  FILLER              PIC  X(17)
  2319         VALUE 'COMMON WORK AREAS'.
  2320     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2321     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2322     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2323     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2324     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2325     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2326     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2327     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2328     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2329     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2330     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2331     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2332     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2333     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2334     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2335     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2336     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2337     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2338     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2339
  2340     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2341                                         COMP-3 VALUE ZEROS.
  2342     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2343                                         COMP-3 VALUE ZEROS.
  2344     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2345                                         COMP-3 VALUE ZEROS.
  2346     12  W-EDIT-FIELD        PIC ----------9.
  2347     12  W-EDIT-FIELD2       PIC ----------9.99.
  2348     12  W-EDIT-7            PIC Z(06)9.
  2349     12  W-FACTOR            PIC S9(09)V9(08)
  2350                                         COMP-3 VALUE ZEROS.
  2351     12  W-IBNR-1            PIC S9(07)V9(02)
  2352                                         COMP-3 VALUE ZEROS.
  2353     12  W-IBNR-2            PIC S9(07)V9(02)
  2354                                         COMP-3 VALUE ZEROS.
  2355     12  W-ISS-BEN           PIC S9(11)V9(02)
  2356                                         COMP-3 VALUE ZEROS.
  2357     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2358                                         COMP-3 VALUE ZEROS.
  2359     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2360     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010S.cbl
  2361     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2362     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2363     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2364     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2365     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2366     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2367     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2368     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2369     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2370     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2371     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2372     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2373     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2374     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2375                                         COMP-3 VALUE ZEROS.
  2376     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2377     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2378     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2379     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2380     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2381     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2382     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  2383     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2384     12  W-POLICY-INACTIVE-CTR
  2385                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2386     12  W-POLICY-REISSUE-CTR
  2387                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2388     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2389     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2390     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2391                                         COMP-3 VALUE ZEROS.
  2392     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2393     12  W-WK-IBNR           PIC S9(07)V9(02)
  2394                                         COMP-3 VALUE ZEROS.
  2395
  2396     12  W-CLAIM-TYPE        PIC  X(01).
  2397         88  W-A-H                              VALUE 'A'.
  2398         88  W-LIFE                             VALUE 'L'.
  2399     12  W-CUTOFF-DATE       PIC  9(08).
  2400     12  W-DIS-DT            PIC  XX.
  2401     12  W-DIS-PTO-DT        PIC  XX.
  2402     12  WK-LEVEL.
  2403         16  WK-AGT          PIC X(10).
  2404         16  WK-A-TYPE       PIC X.
  2405         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2406         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2407         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2408         16  FILLER          PIC X(6).
  2409     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2410         16  FILLER          PIC X(11).
  2411         16  WK-L-RTX        PIC X(3).
  2412         16  WK-J-RTX        PIC X(3).
  2413         16  WK-A-RTX        PIC X(3).
  2414         16  FILLER          PIC X(6).
  2415     12  WK-NEW-RATES.
  2416         16  WK-N-R      OCCURS 10.
  2417             20  WK-N-AGT    PIC X(10).
  2418             20  WK-N-TYPE   PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010S.cbl
  2419             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2420             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2421     12  W-LIFE-YEARS-ZERO.
  2422         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2423         16  FILLER          PIC  X(01)         VALUE SPACES.
  2424         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2425         16  FILLER          PIC  X(01)         VALUE SPACES.
  2426         16  FILLER          PIC  X(01)         VALUE SPACES.
  2427         16  FILLER          PIC  X(01)         VALUE SPACES.
  2428         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2429         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2430         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2431         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2432         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2433         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2434         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2435         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2436         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2437         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2438         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2439         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2440         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2441         16  FILLER          PIC S9(09)V9(02) COMP-3
  2442                                                VALUE ZEROS.
  2443         16  FILLER          PIC S9(09)V9(02) COMP-3
  2444                                                VALUE ZEROS.
  2445         16  FILLER          PIC S9(09)V9(02) COMP-3
  2446                                                VALUE ZEROS.
  2447         16  FILLER          PIC S9(09)V9(02) COMP-3
  2448                                                VALUE ZEROS.
  2449         16  FILLER          PIC S9(11)V9(02) COMP-3
  2450                                                VALUE ZEROS.
  2451
  2452     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2453         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2454     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2455         88  W-REIN-PROCESS                     VALUE 'Y'.
  2456         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2457     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2458         88  W-SELECTION-ON                     VALUE 'Y'.
  2459         88  W-SELECTION-OFF                    VALUE SPACES.
  2460     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2461         88  W-RTRM-0                           VALUE 'Y'.
  2462         88  W-RTRM-NOT-0                       VALUE SPACES.
  2463     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2464     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2465         88  W-TABLE-USED                       VALUE 'Y'.
  2466         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2467     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2468         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2469
  2470     12  W-VAL-ERRORS.
  2471         16  FILLER          PIC  X(40)
  2472             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2473         16  FILLER          PIC  X(40)
  2474             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2475         16  FILLER          PIC  X(40)
  2476             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010S.cbl
  2477         16  FILLER          PIC  X(40)
  2478             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2479         16  FILLER          PIC  X(40)
  2480             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2481         16  FILLER          PIC  X(40)
  2482             VALUE 'RUN DATE EPEC - A&H - '.
  2483         16  FILLER          PIC  X(40)
  2484             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2485         16  FILLER          PIC  X(40)
  2486             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2487         16  FILLER          PIC  X(40)
  2488             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2489     12  FILLER REDEFINES W-VAL-ERRORS.
  2490         16  W-VAL-ERROR OCCURS 9 TIMES
  2491                             PIC  X(40).
  2492
  2493     12  W-WORK-DATE         PIC  X(02).
  2494     12  SAVE-WK-NEW-RATES.
  2495         16  FILLER          PIC X(170).
  2496
  2497***   The following data area is for NCL only
  2498*    12  W-WORK-OB-DATA OCCURS 300.
  2499*    12  W-WORK-OB-DATA OCCURS 220.
  2500     12  W-WORK-OB-DATA OCCURS 900.
  2501         16  WS-OB-REIN-CO       PIC X(06).
  2502         16  WS-OB-LF-AH         PIC X.
  2503         16  WS-OB-BENEFIT-CODE  PIC XX.
  2504         16  WS-OB-EARNED OCCURS 3.
  2505             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2506
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010S.cbl
  2508 01  EPEC-WORK-AREAS.
  2509     12  WE-REIN-CO          PIC X(6).
  2510     12  WE-LF-AH            PIC X.
  2511     12  WE-BEN-TYPE         PIC XX.
  2512     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2513     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2514     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2515     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2516     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2517     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2518     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2519     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2520     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2521     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2522     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2523     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2524     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2525     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2526     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2527     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2528     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2529     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2530     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2531     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2532     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2533     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2534     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2535     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2536     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2537     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2538     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2539     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2540     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2541     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2542     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2543     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2544     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2545     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2546     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2547     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2548     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2549     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2550     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2551     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2552     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2553     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2554     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2555     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2556     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2557     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2558     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2559     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2560     12  WX-SETTLEMENT-EXIT-DATE
  2561                             PIC  9(11)      COMP-3.
  2562     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2563     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2564     12  WX-STATUS-AT-SETTLEMENT
  2565                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010S.cbl
  2566     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2567
  2568 01  EPEC-WORK.
  2569     12  EW-REIN-CO          PIC X(6).
  2570     12  EW-SUB-KEY.
  2571         16  EW-LF-AH        PIC X.
  2572         16  EW-BEN-TYPE     PIC XX.
  2573     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2574     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2575     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2576     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2577     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2578     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2579     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2580     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2581     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2582     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2583     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2584     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2585     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2586     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2587     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2588     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2589     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2590     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2591     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2592     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2593     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2594     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2595     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2596     12  EW-AGENTS       OCCURS 10.
  2597         16  EW-AGT-NO       PIC X(10).
  2598         16  EW-AGT-TYPE     PIC X.
  2599         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2600         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2601         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2602         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2603         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2604         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2605         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2606     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2607     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2608     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2609     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2610     12  EW-AGE              PIC S9(9)       COMP-3.
  2611     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2612     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2613     12  EW-LEVEL-USED       PIC X.
  2614
  2615 01  EPEC-TOTALS.
  2616     12  EPEC-LEVELS     OCCURS 900.
  2617*    12  EPEC-LEVELS     OCCURS 220.
  2618*    12  EPEC-LEVELS     OCCURS 300.
  2619         16  EPEC-REIN-CO          PIC X(6).
  2620         16  EPEC-SUB-KEY.
  2621             24  EPEC-LF-AH        PIC X.
  2622             24  EPEC-BEN-TYPE     PIC XX.
  2623*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010S.cbl
  2624         16  FILLER                PIC X(699).
  2625     12  EPEC-LEVELS-END           PIC X(6).
  2626
  2627 01  EPEC-UNDERWRITTEN-TOTALS.
  2628     12  EPEC-LEVELS-II  OCCURS 900.
  2629*    12  EPEC-LEVELS-II  OCCURS 220.
  2630*    12  EPEC-LEVELS-II  OCCURS 300.
  2631         16  EPEC-REIN-CO-II       PIC X(6).
  2632         16  EPEC-SUB-KEY-II.
  2633             24  EPEC-LF-AH-II     PIC X.
  2634             24  EPEC-BEN-TYPE-II  PIC XX.
  2635*        16  FILLER                PIC X(694).
  2636         16  FILLER                PIC X(699).
  2637     12  EPEC-LEVELS-END-II        PIC X(6).
  2638
  2639
  2640 01  FILLER                      PIC  X(11)
  2641                                 VALUE 'OPT RSV TBL'.
  2642*
  2643* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2644*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2645*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2646*      EPEC-OPT-GRP  (108)
  2647*
  2648*      300 X 108 = 32400.
  2649*
  2650 01  EPEC-OPT-DATA-TABLE.
  2651*    12  FILLER                  PIC X(32400).
  2652*    12  FILLER                  PIC X(23760).
  2653     12  FILLER                  PIC X(97200).
  2654
  2655 01  FILLER                      PIC  X(16)
  2656                                 VALUE 'OPT RSV TBL UNDW'.
  2657 01  EPEC-UNDW-OPT-DATA-TABLE.
  2658*    12  FILLER                  PIC X(32400).
  2659*    12  FILLER                  PIC X(23760).
  2660     12  FILLER                  PIC X(97200).
  2661
  2662 01  FILLER                      PIC  X(16)
  2663                                 VALUE 'OPT RSV TBL WORK'.
  2664 01  EPEC-OPT-WORK-TABLE.
  2665*    12  EPEC-OPT-GRP        OCCURS 300.
  2666*    12  EPEC-OPT-GRP        OCCURS 220.
  2667     12  EPEC-OPT-GRP        OCCURS 900.
  2668         16  EPEC-REIN-CO-OPT
  2669                             PIC  X(06).
  2670         16  EPEC-SUB-KEY-OPT.
  2671             24  EPEC-LF-AH-OPT
  2672                             PIC  X(01).
  2673             24  EPEC-BEN-TYPE-OPT
  2674                             PIC  X(02).
  2675         16  EPEC-OPT-DATA.
  2676             20  EPEC-REIN-ONLY-IND
  2677                             PIC  X(01).
  2678                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2679             20  EPEC-LINE-NOT-USED-IND
  2680                             PIC  X(01).
  2681                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010S.cbl
  2682             20  EPEC-LIFE-CTR-USED-IND
  2683                             PIC  X(01).
  2684                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2685                 88  EPEC-LIFE-CTR-NOT-USED
  2686                                           VALUE ' '.
  2687             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2688                             PIC S9(09)       COMP-3.
  2689             20  EPEC-EARNED-PREMIUM-AH
  2690                             PIC S9(09)V9(02) COMP-3.
  2691             20  EPEC-CLAIMS-MADE-PAID
  2692                             PIC S9(09)V9(02) COMP-3.
  2693             20  EPEC-CLM-EXP
  2694                             PIC S9(09)V9(02) COMP-3.
  2695             20  EPEC-LIFE-IBNR
  2696                             PIC S9(09)V9(02) COMP-3.
  2697             20  EPEC-REIN-ISS-BEN
  2698                             PIC S9(11)V9(02) COMP-3.
  2699
  2700 01  FILLER                  PIC X(09)
  2701                                 VALUE 'EOM TABLE'.
  2702
  2703 01  EOM-DATE-TABLE.
  2704     12  EOM-DATE            OCCURS 13
  2705                             PIC 9(08).
  2706
  2707 01  EPEC-SUBS.
  2708     12  EPEC-SUB-LEVELS OCCURS 31.
  2709         16  EPEC-SUB-REIN   PIC X(6).
  2710         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2711         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2712     12  EPEC-SUBS-END       PIC X(6).
  2713
  2714 01  SAVE-REIN-WORK.
  2715     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2716     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2717     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2718     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2719     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2720
  2721 01  SAVE-REIN-TABLE.
  2722     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2723         16  SR-TIME         PIC 9(6).
  2724         16  SR-ENTRY.
  2725             20  FILLER      PIC XX.
  2726             20  SR-CONTROL  PIC X(8).
  2727             20  FILLER      PIC X(3990).
  2728
  2729
* 2730                             COPY ECSRITAB.
  2731******************************************************************04/29/98
  2732*                                                                *ECSRITAB
  2733*                            ECSRITAB                            *   LV015
  2734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2735*                            VMOD=2.015                          *ECSRITAB
  2736*                                                                *ECSRITAB
  2737*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2738*                                                                *ECSRITAB
  2739******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2740 01  REIN-WORK-AREAS.                                             ECSRITAB
  2741     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2742     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2743     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2744     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2745     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2746     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2747     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2748     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2749     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2750     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2751     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2752         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2753             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2754             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2755             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2756     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2757     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2758     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2759     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2760     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2761     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2762     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2763     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2764     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2765     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2766     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2767     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2768     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2769     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2770     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2771     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2772     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2773     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2774     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2775     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2776     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2777     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2778     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2779                                                                  ECSRITAB
  2780 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2781     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2782         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2783         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2784             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2785             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2786         16  REIN-WORK-FLDS.                                      ECSRITAB
  2787             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  2788             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2789             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2790             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2791             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2792             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2793             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2794             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2795             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2796             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2797             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2798             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2799             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2800             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2801             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2802             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2803             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2804             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2805             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2806             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2807             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2808             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2809             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2810             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2811             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2812             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2813             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2814             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2815     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2816                                                                  ECSRITAB
  2817     12  RWF-FIELDS.                                              ECSRITAB
  2818         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2819         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2820         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  2821         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2822         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2823         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2824         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2825         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2826         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2827         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2828         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2829         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2830         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2831         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2832         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2833         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2834         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2835         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2836         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2837         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2838         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2839         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2840         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2841         16  RWF-REM-SW              PIC X.                       ECSRITAB
  2842         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  2843         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  2844         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  2845         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  2846                                                                  ECSRITAB
  2847     12  WT-COMP-INFO.                                            ECSRITAB
  2848         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  2849         16  WT-LF-QC                PIC X.                       ECSRITAB
  2850         16  WT-AH-QC                PIC X.                       ECSRITAB
  2851         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  2852         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  2853         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  2854         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  2855         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2856         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  2857         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2858         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2859         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2860         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2861         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2862         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2863         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  2864         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  2865         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  2866         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  2867         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2868         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2869         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2870         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2871         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2872         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2873         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2874         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2875         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  2876         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  2877         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  2878         16  WT-REMAINING            PIC X.                       ECSRITAB
  2879         16  FILLER                  PIC X(21).                   ECSRITAB
  2880                                                                  ECSRITAB
  2881 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  2882     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  2883     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  2884     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  2885     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  2886     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  2887     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  2888     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2889     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2890     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2891     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2892     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  2893     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  2894     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2895     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2896     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2897     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2898     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2899     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2900     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2901     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2902     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2903     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2904     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2905     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2906                                                                  ECSRITAB
  2907     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2908         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  2909     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2910         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  2911     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2912         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  2913     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2914         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  2915     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  2916         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  2917     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  2918         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  2919                                                                  ECSRITAB
  2920     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  2921         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  2922         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  2923         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  2924         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  2925         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  2926         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  2927         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  2928         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  2929         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  2930         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  2931         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  2932         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  2933         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  2934         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  2935         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  2936         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  2937         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  2938         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  2939         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  2940         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  2941         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  2942         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  2943         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  2944     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  2945     12  REIN-SEARCH.                                             ECSRITAB
  2946         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  2947         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  2948         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  2949         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  2950     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  2951     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  2952     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2953     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2954     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2955     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2956     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2957     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2958     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2959     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2960     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2961     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2962     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2963     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2964     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2965     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2966     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2967     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  2968     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  2969     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2970     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2971     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2972     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2973     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2974     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2975                                                                  ECSRITAB
  2976 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  2977* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  2978     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2979         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  2980         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  2981         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  2982         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  2983         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  2984         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2985         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2986         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2987         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2988                                                                  ECSRITAB
  2989 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  2990     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  2991         16  RC2-REIN-CO.                                         ECSRITAB
  2992             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  2993             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  2994         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2995         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2996         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2997         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2998         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  2999         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3000                                                                  ECSRITAB
  3001 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3002     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3003         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3004         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3005     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3006                                                                  ECSRITAB
  3007 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3008     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3009         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3010         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3011         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3012 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3013     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3014         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3015                                                                  ECSRITAB
  3016 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3017******************************************************************ECSRITAB
  3018
* 3019                             COPY ELCPSEVR.
  3020******************************************************************04/16/98
  3021*                                                                *ELCPSEVR
  3022*                                                                *ELCPSEVR
  3023*                            ELCPSEVR                            *   LV003
  3024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3025*                            VMOD=2.001                          *ELCPSEVR
  3026*                                                                *ELCPSEVR
  3027*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3028*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3029*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3030******************************************************************ELCPSEVR
  3031                                                                  ELCPSEVR
  3032 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3033     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3034         10  FILLER               PIC 999.                        ELCPSEVR
  3035         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3036         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3037             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3038             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3039         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3040         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3041     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3042            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3043     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3044         10  FILLER              PIC 999.                         ELCPSEVR
  3045         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3046         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3047             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3048             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3049         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3050         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3051     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3052            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3053 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3054     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3055                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3056         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3057             15  FILLER              PIC 999.                     ELCPSEVR
  3058             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3059             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3060                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3061                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3062             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3063             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3064         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3065                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3066         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3067             15  FILLER              PIC 999.                     ELCPSEVR
  3068             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3069             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3070                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3071                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3072             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3073             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3074         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3075                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3076         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3077             15  FILLER              PIC 999.                     ELCPSEVR
  3078             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3079             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3080                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3081                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3082             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3083             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3084         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3085                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3086     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3087         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3088         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3089         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3090             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3091             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3092         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3093         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3094     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3095            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3096
* 3097                             COPY ELCEPCVR.
  3098******************************************************************05/15/98
  3099*                                                                *ELCEPCVR
  3100*                                                                *ELCEPCVR
  3101*                            ELCEPCVR                            *   LV003
  3102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3103*                            VMOD=2.001                          *ELCEPCVR
  3104*                                                                *ELCEPCVR
  3105*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3106*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3107*                                                                *ELCEPCVR
  3108******************************************************************ELCEPCVR
  3109 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3110     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3111         10  FILLER            PIC 999.                           ELCEPCVR
  3112         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3113         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3114             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3115             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3116         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3117         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3118     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3119            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3120     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3121         10  FILLER            PIC 999.                              CL**5
  3122         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3123         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3124             15  EC-EXP-CC     PIC 99.                               CL**5
  3125             15  EC-EXP-YR     PIC 99.                               CL**5
  3126         10  EC-EXP-MO         PIC 99.                               CL**5
  3127         10  EC-EXP-DA         PIC 99.                               CL**5
  3128     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3129            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3130     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3131         10  FILLER            PIC 999.                           ELCEPCVR
  3132         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3133         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3134             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3135             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3136         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3137         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3138     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3139            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3140     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3141         10  FILLER            PIC 999.                              CL**5
  3142         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3143         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3144             15  EC-EFF-CC     PIC 99.                               CL**5
  3145             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3146         10  EC-EFF-MO         PIC 99.                               CL**5
  3147         10  EC-EFF-DA         PIC 99.                               CL**5
  3148     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3149            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3150     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3151         10  FILLER            PIC 999.                           ELCEPCVR
  3152         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3153         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3154             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3155             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3156         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3157         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3158     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3159            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3160     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3161         10  FILLER            PIC 999.                           ELCEPCVR
  3162         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3163         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3164             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3165             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3166         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3167         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3168     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3169            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3170     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3171         10  FILLER            PIC 999.                           ELCEPCVR
  3172         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3173         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3174             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3175             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3176         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3177         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3178     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3179            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3180     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3181         10  FILLER            PIC 999.                           ELCEPCVR
  3182         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3183         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3184             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3185             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3186         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3187         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3188     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3189            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3190     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3191         10  FILLER            PIC 999.                           ELCEPCVR
  3192         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3193         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3194             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3195             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3196         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3197         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3198     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3199            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3200
* 3201                             COPY ELCREINV.
  3202******************************************************************04/18/98
  3203*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3204*                                                                *ELCREINV
  3205*                            ELCREINV                            *   LV003
  3206*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3207*                            VMOD=2.001                          *ELCREINV
  3208*                                                                *ELCREINV
  3209*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3210*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3211*                                                                *ELCREINV
  3212******************************************************************ELCREINV
  3213                                                                  ELCREINV
  3214 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3215     05  WS-RE-LO-DATE.                                              CL**3
  3216         10 FILLER                     PIC 999.                      CL**3
  3217         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3218         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3219            15 RE-LO-CC                PIC 99.                       CL**3
  3220            15 RE-LO-YR                PIC 99.                       CL**3
  3221         10 RE-LO-MO                   PIC 99.                       CL**3
  3222         10 RE-LO-DA                   PIC 99.                       CL**3
  3223     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3224            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3225     05  WS-RE-HI-DATE.                                              CL**3
  3226         10 FILLER                     PIC 999.                      CL**3
  3227         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3228         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3229            15 RE-HI-CC                PIC 99.                       CL**3
  3230            15 RE-HI-YR                PIC 99.                       CL**3
  3231         10 RE-HI-MO                   PIC 99.                       CL**3
  3232         10 RE-HI-DA                   PIC 99.                       CL**3
  3233     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3234            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3235     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3236         10 FILLER                     PIC 999.                   ELCREINV
  3237         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3238         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3239            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3240            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3241         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3242         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3243     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3244            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3245     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3246         10  FILLER                    PIC 999.                   ELCREINV
  3247         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3248         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3249             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3250             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3251         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3252         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3253     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3254            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3255     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3256         10  FILLER                    PIC 999.                   ELCREINV
  3257         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3258         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3259             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3260             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3261         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3262         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3263     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3264            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3265
  3266 01  RC-REIN-HOLD-AREAS.
  3267     12  RC-REIN-LEVELS  OCCURS 30.
  3268         16  RC-REIN-COMP    PIC X(6).
  3269         16  RC-OLD-ISS      PIC X.
  3270         16  RC-NEW-ISS      PIC X.
  3271         16  RC-OLD-CNC      PIC X.
  3272         16  RC-NEW-CNC      PIC X.
  3273         16  RC-OLD-LF-CLM   PIC X.
  3274         16  RC-OLD-AH-CLM   PIC X.
  3275         16  RC-NEW-LF-CLM   PIC X.
  3276         16  RC-NEW-AH-CLM   PIC X.
  3277         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3278         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3279         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3280         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3281         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3282         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3283         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3284         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3285         16  RC-REIN-REM-SW  PIC X.
  3286     12  RC-REIN-LEVELS-END  PIC X(6).
  3287
  3288 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3289     12  TPC-COUNTERS    OCCURS 6.
  3290         16  TPL-ISS-PRM     PIC S9(9)V99.
  3291         16  TPA-ISS-PRM     PIC S9(9)V99.
  3292         16  TPL-CNC-PRM     PIC S9(9)V99.
  3293         16  TPA-CNC-PRM     PIC S9(9)V99.
  3294         16  TPL-ACCT-COM    PIC S9(9)V99.
  3295         16  TPA-ACCT-COM    PIC S9(9)V99.
  3296         16  TPL-CLAIMS      PIC S9(9)V99.
  3297         16  TPA-CLAIMS      PIC S9(9)V99.
  3298
  3299 01  HLD-DTS SYNC.
  3300     12  EOM-RUN-DATE        PIC 9(08).
  3301     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3302         16  EOM-CCYY.
  3303             20  EOM-CC      PIC 99.
  3304             20  EOM-YR      PIC 99.
  3305         16  EOM-MO          PIC 99.
  3306         16  EOM-DA          PIC 99.
  3307
  3308****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3309****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3310     12  OB-RUN-DATES OCCURS 2.
  3311         16  OB-CCYY         PIC 9(4).
  3312         16  OB-MO           PIC 99.
  3313         16  OB-DA           PIC 99.
  3314
  3315     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3316         88  OB-DATE-1-USED     VALUE '*'.
  3317     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3318         88  OB-DATE-2-USED     VALUE '*'.
  3319     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010S.cbl
  3320         88  OB-DATE-3-USED     VALUE '*'.
  3321     12  EARNING-START-DATE  PIC 9(08).
  3322     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3323         16  E-ERN-START-CC  PIC 99.
  3324         16  E-ERN-START-YR  PIC 99.
  3325         16  E-ERN-START-MO  PIC 99.
  3326         16  E-ERN-START-DA  PIC 99.
  3327     12  EARNING-STOP-DATE   PIC 9(08).
  3328     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3329         16  E-ERN-STOP-CC   PIC 99.
  3330         16  E-ERN-STOP-YR   PIC 99.
  3331         16  E-ERN-STOP-MO   PIC 99.
  3332         16  E-ERN-STOP-DA   PIC 99.
  3333     12  STOP-LF-DATE        PIC 9(08).
  3334     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3335         16  STOP-LF-CC      PIC 99.
  3336         16  STOP-LF-YR      PIC 99.
  3337         16  STOP-LF-MO      PIC 99.
  3338         16  STOP-LF-DA      PIC 99.
  3339     12  STOP-AH-DATE        PIC 9(08).
  3340     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3341         16  STOP-AH-CC      PIC 99.
  3342         16  STOP-AH-YR      PIC 99.
  3343         16  STOP-AH-MO      PIC 99.
  3344         16  STOP-AH-DA      PIC 99.
  3345     12  BIN-VALUATION-DT    PIC XX.
  3346     12  BIN-EOM-RUN-DATE    PIC XX.
  3347     12  LAST-YRS-DATE       PIC 9(08).
  3348     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3349         16  LYD-CCYY        PIC 9(04).
  3350         16  LYD-CCYR REDEFINES LYD-CCYY.
  3351             20  LYD-CC      PIC 99.
  3352             20  LYD-YR      PIC 99.
  3353         16  LYD-MO          PIC 99.
  3354         16  LYD-DA          PIC 99.
  3355     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3356     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3357         16  VAL-CC          PIC 99.
  3358         16  VAL-YR          PIC 99.
  3359         16  VAL-MO          PIC 99.
  3360         16  VAL-DA          PIC 99.
  3361     12  INCURRED-DATE       PIC 9(08).
  3362     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3363         16  DTO-CC          PIC 99.
  3364         16  DTO-YR          PIC 99.
  3365         16  DTO-MO          PIC 99.
  3366         16  DTO-DA          PIC 99.
  3367     12  REPORTED-DATE.
  3368         16  RPT-YR          PIC 99.
  3369         16  RPT-MO          PIC 99.
  3370         16  RPT-DA          PIC 99.
  3371     12  PAYMENT-DATE        PIC 9(08).
  3372     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3373         16  PAY-CC          PIC 99.
  3374         16  PAY-YR          PIC 99.
  3375         16  PAY-MO          PIC 99.
  3376         16  PAY-DA          PIC 99.
  3377     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010S.cbl
  3378     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3379         16  PAYTO-CC        PIC 99.
  3380         16  PAYTO-YR        PIC 99.
  3381         16  PAYTO-MO        PIC 99.
  3382         16  PAYTO-DA        PIC 99.
  3383
  3384 01  AH-RES-STATE-TABLE.
  3385     12  FILLER              PIC X(42)       VALUE
  3386             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3387     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3388
  3389 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3390     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3391
  3392 01  BILLING-COUNTERS    COMP-3.
  3393     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3394     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3395     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3396     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3397     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3398     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3399     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3400     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3401     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3402     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3403     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3404     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3405     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3406     12  BC-COMM             PIC S9(5)           VALUE +0.
  3407     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3408     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3409     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3410     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3411     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3412     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3413     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3414     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3415     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3416     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3417
  3418 01  FLAGS SYNC.
  3419     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3420         88  CHECK-BILLED                        VALUE 'Y'.
  3421     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3422         88  EOF-ON-TRANS                        VALUE '*'.
  3423     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3424         88  EOF-ON-CERT                         VALUE '*'.
  3425     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3426         88  PROCESSING-COMPLETED                VALUE '*'.
  3427     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3428         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3429     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3430         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3431     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3432         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3433     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3434         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3435     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010S.cbl
  3436         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3437     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3438         88  A-H-FULLY-EARNED                    VALUE '*'.
  3439     12  CNCL-FLG            PIC X               VALUE SPACE.
  3440     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3441         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3442         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3443     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3444         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3445     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3446         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3447     12  EP-FLG              PIC X               VALUE SPACE.
  3448     12  END-FLG             PIC X               VALUE SPACE.
  3449     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3450     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3451     12  ACCT-FLG            PIC X               VALUE SPACE.
  3452     12  STATE-FLG           PIC X               VALUE SPACE.
  3453     12  COMP-FLG            PIC X               VALUE SPACE.
  3454     12  CARR-FLG            PIC X               VALUE SPACE.
  3455     12  FINAL-FLG           PIC X               VALUE SPACE.
  3456     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3457     12  REIN-FLG            PIC X               VALUE SPACE.
  3458     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3459     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3460
  3461 01  TEXAS-REG-WORK-AREAS   SYNC.
  3462     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3463     12  TEX-FACT-2          PIC S999        COMP-3.
  3464     12  TEX-FACT-3          PIC S999        COMP-3.
  3465     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3466     12  TEX-FACT-5          PIC S999        COMP-3.
  3467     12  TEX-FACT-6          PIC S999        COMP-3.
  3468     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3469     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3470     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3471
  3472 01  NET-PAY-INTERFACE.
  3473     12  NP-APR              PIC S999V9(4)   COMP-3.
  3474     12  NP-ORIG             PIC S999        COMP-3.
  3475     12  NP-REM              PIC S999        COMP-3.
  3476     12  NP-OPT              PIC X.
  3477     12  NP-CAP              PIC S999        COMP-3.
  3478     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3479     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3480     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3481     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3482     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3483     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3484     12  NP-ACCOUNT          PIC X(10).
  3485
  3486 01  HOLDERS SYNC.
  3487     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3488     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3489     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3490     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3491     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3492     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3493     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010S.cbl
  3494     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3495     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3496     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3497     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3498     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  3499     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3500     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  3501     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3502     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3503     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3504     12  REM-TRM1            PIC S999V99  COMP-3.
  3505     12  REM-TRM2            PIC S999V99  COMP-3.
  3506     12  REM-TRM3            PIC S999V99  COMP-3.
  3507     12  TEM-TRM1            PIC S999V99  COMP-3.
  3508     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3509     12  ORIG-TERM           PIC S999V99  COMP-3.
  3510     12  HLD-CONTROL.
  3511         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3512         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3513         16  HLD-STATE       PIC XX              VALUE SPACES.
  3514         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3515     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3516
  3517 01  DISPLAY-HD-1.
  3518     05  FILLER      PIC X       VALUE SPACES.
  3519     05  FILLER      PIC X(50)   VALUE SPACES.
  3520     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPOR'.
  3521     05  FILLER      PIC X(51)   VALUE SPACES.
  3522     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3523
  3524 01  DISPLAY-HD-2.
  3525     05  FILLER                 PIC X       VALUE SPACE.
  3526     05  FILLER                 PIC X(57)   VALUE SPACES.
  3527     05  DIS-DATE               PIC X(8).
  3528     05  FILLER                 PIC X(66)   VALUE SPACES.
  3529
  3530 01  DISPLAY-LINE.
  3531     05  DL-FULL.
  3532         10  FILLER           PIC X       VALUE SPACE.
  3533         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3534         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3535
  3536 01  PRT-HDNGS SYNC.
  3537     12  TR-HD-1.
  3538         16  FILLER      PIC X       VALUE '1'.
  3539         16  FILLER      PIC X(53)   VALUE SPACES.
  3540         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3541         16  FILLER      PIC X(48)   VALUE SPACES.
  3542         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3543     12  TR-HD-2.
  3544         16  FILLER      PIC X       VALUE SPACE.
  3545         16  FILLER      PIC X(47)   VALUE SPACES.
  3546         16  TRHDNM      PIC X(30).
  3547         16  FILLER      PIC X(42)   VALUE SPACES.
  3548         16  TR-RN-DT    PIC X(8).
  3549     12  TR-HD-3.
  3550         16  FILLER      PIC X       VALUE SPACE.
  3551         16  FILLER      PIC X(53)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010S.cbl
  3552         16  TR-MODAYR   PIC X(18).
  3553         16  FILLER      PIC X       VALUE SPACE.
  3554         16  TR-YRASK    PIC X       VALUE SPACE.
  3555         16  FILLER      PIC X(46)   VALUE SPACES.
  3556         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3557         16  TR-PG       PIC ZZ,ZZ9.
  3558     12  TR-HD-4.
  3559         16  FILLER      PIC X       VALUE SPACE.
  3560         16  TR-AGCY     PIC X(30).
  3561     12  TR-HD-5.
  3562         16  FILLER      PIC X       VALUE SPACE.
  3563         16  TR-CARR     PIC X.
  3564         16  FILLER      PIC X       VALUE '-'.
  3565         16  TR-GROUP    PIC X(6).
  3566         16  FILLER      PIC X       VALUE '-'.
  3567         16  TR-ST-NO    PIC X(2).
  3568         16  FILLER      PIC X       VALUE '-'.
  3569         16  TR-AG-NO    PIC X(10).
  3570         16  FILLER      PIC X(23)   VALUE SPACES.
  3571         16  TR5-RP-TYP.
  3572             20  FILLER  PIC X(20)   VALUE
  3573                     '* * * * TRANSACTION '.
  3574             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3575     12  TR-HD-6.
  3576         16  FILLER      PIC X       VALUE SPACE.
  3577         16  TR-CE-MO    PIC XX.
  3578         16  FILLER      PIC X       VALUE '-'.
  3579         16  TR-CE-DA    PIC XX.
  3580         16  FILLER      PIC X       VALUE '-'.
  3581         16  TR-CE-YR    PIC XX.
  3582         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3583         16  TR-CX.
  3584             20  TR-CX-MO PIC XX.
  3585             20  HSHR1    PIC X.
  3586             20  TR-CX-DA PIC XX.
  3587             20  HSHR2    PIC X.
  3588             20  TR-CX-YR PIC XX.
  3589     12  TR-HD-7.
  3590         16  FILLER  PIC X      VALUE '0'.
  3591         16  FILLER  PIC X(24)  VALUE SPACES.
  3592         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3593         16  TR-7-LF PIC X(6).
  3594         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3595         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3596         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3597         16  TR-7-AH PIC X(6).
  3598         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3599         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3600     12  TR-HD-8.
  3601         16  FILLER  PIC X      VALUE SPACE.
  3602         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3603         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3604         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3605         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3606         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3607     12  TR-HD-9.
  3608         16  FILLER  PIC X      VALUE SPACE.
  3609         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010S.cbl
  3610         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3611         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3612         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3613         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3614         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3615     12  TR-TTL-HD.
  3616         16  FILLER      PIC X       VALUE '0'.
  3617         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3618         16  FILLER      PIC XX      VALUE SPACES.
  3619         16  TTL-HD-DS   PIC X(60)   VALUE
  3620             'ECS010 CONTROL TOTALS'.
  3621
  3622 01  TR-DTL.
  3623     12  FILLER                  PIC X           VALUE SPACE.
  3624     12  TR-DTL1.
  3625         16  TRD-CERT            PIC X(11).
  3626         16  TRD-ISDT.
  3627             20  FILLER          PIC X           VALUE SPACE.
  3628             20  TRD-ISMO        PIC XX.
  3629             20  TRD-IS-S1       PIC X           VALUE '/'.
  3630             20  TRD-ISDA        PIC XX.
  3631             20  TRD-IS-S2       PIC X           VALUE '/'.
  3632             20  TRD-ISYR        PIC XX.
  3633             20  FILLER          PIC X           VALUE SPACE.
  3634         16  TRD-AGE             PIC XX.
  3635     12  TR-DTL2.
  3636         16  FILLER              PIC X           VALUE SPACE.
  3637         16  TRD-LFTYP           PIC XXX.
  3638         16  FILLER              PIC X           VALUE SPACE.
  3639         16  TRD-LFTRM           PIC ZZ9.
  3640         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3641         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3642         16  TRD-LFACTDT.
  3643             20  FILLER          PIC X           VALUE SPACE.
  3644             20  TRD-LFACTMO     PIC XX.
  3645             20  TRD-LF-S1       PIC X           VALUE '/'.
  3646             20  TRD-LFACTDA     PIC XX.
  3647             20  TRD-LF-S2       PIC X           VALUE '/'.
  3648             20  TRD-LFACTYR     PIC XX.
  3649             20  FILLER          PIC X           VALUE SPACE.
  3650         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3651         16  FILLER              PIC X           VALUE SPACE.
  3652         16  TRD-LF-STATUS       PIC X.
  3653         16  FILLER              PIC X(4)        VALUE SPACE.
  3654         16  TRD-AHTYP           PIC XXX.
  3655         16  FILLER              PIC X           VALUE SPACE.
  3656         16  TRD-AHTRM           PIC ZZ9.
  3657         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3658         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3659         16  TRD-AHACTDT.
  3660             20  FILLER          PIC X           VALUE SPACE.
  3661             20  TRD-AHACTMO     PIC XX.
  3662             20  TRD-AH-S1       PIC X           VALUE '/'.
  3663             20  TRD-AHACTDA     PIC XX.
  3664             20  TRD-AH-S2       PIC X           VALUE '/'.
  3665             20  TRD-AHACTYR     PIC XX.
  3666             20  FILLER          PIC X           VALUE SPACE.
  3667         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010S.cbl
  3668         16  FILLER              PIC X           VALUE SPACE.
  3669         16  TRD-AH-STATUS       PIC X.
  3670     12  TR-DTL3 REDEFINES TR-DTL2.
  3671         16  FILLER              PIC X(20).
  3672         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3673         16  FILLER              PIC X.
  3674         16  TRD-IBNRX           PIC X(4).
  3675         16  FILLER              PIC X(2).
  3676         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3677         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3678                                 PIC X(11).
  3679         16  FILLER              PIC X.
  3680         16  TRD-PAYCURX         PIC X(8).
  3681         16  FILLER              PIC X(2).
  3682         16  TRD-FUTRSV-DATA.
  3683             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3684             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3685                                 PIC X(11).
  3686             20  FILLER          PIC X.
  3687             20  TRD-FUTRSVX     PIC X(6).
  3688         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3689             20  TRD-BENEFIT-X   PIC X(10).
  3690             20  TRD-BENEFIT-CODE
  3691                                 PIC X(02).
  3692             20  FILLER          PIC X(06).
  3693         16  FILLER              PIC X(4).
  3694         16  TRD-RSV-DESC        PIC X(6).
  3695         16  TRD-RSV-ACTION      PIC X(21).
  3696
  3697 01  DET-PR-UREC.
  3698     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3699     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3700     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3701     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3702     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3703     12  DET-SEX             PIC X.
  3704     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3705     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3706     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3707     12  DET-PR-MEM          PIC X(12).
  3708     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3709     12  DET-PR-SS           PIC X(11).
  3710     12  FILLER              PIC XXX      VALUE SPACES.
  3711     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3712
  3713 01  DET-PR-UREC-2.
  3714     12  FILLER              PIC X        VALUE SPACE.
  3715     12  DET-LF-DESC         PIC XX.
  3716     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3717     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3718     12  FILLER              PIC X(4)     VALUE ' TO '.
  3719     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3720     12  FILLER              PIC X        VALUE SPACE.
  3721     12  DET-AH-DESC         PIC XX.
  3722     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3723     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3724     12  FILLER              PIC X(4)     VALUE ' TO '.
  3725     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010S.cbl
  3726     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3727     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3728     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3729     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3730     12  FILLER              PIC X(5)     VALUE SPACES.
  3731     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3732
  3733 01  DET-PR-UREC-3.
  3734     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3735     12  DET-IND-GRP         PIC X.
  3736     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3737     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3738     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3739     12  DET-POL-FORM        PIC X(12).
  3740     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3741     12  DET-LOAN-OFFICER    PIC XXX.
  3742     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3743     12  DET-USER-CODE       PIC X.
  3744     12  FILLER              PIC X(8)     VALUE SPACES.
  3745     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3746
  3747 01  DET-PR-UREC-4.
  3748     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  3749     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3750     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  3751     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3752     12  FILLER              PIC X(37)    VALUE SPACES.
  3753     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3754
  3755 01  DET-PR-UREC-5.
  3756     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  3757     12  DET-LF-BEN-CD       PIC XX.
  3758     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  3759     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  3760     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  3761     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  3762     12  FILLER              PIC X(30)    VALUE SPACES.
  3763     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3764
  3765 01  DET-PR-UREC-6.
  3766     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  3767     12  DET-AH-BEN-CD       PIC XX.
  3768     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  3769     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  3770     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  3771     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  3772     12  FILLER              PIC X(30)    VALUE SPACES.
  3773     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3774
  3775 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  3776     88  WS-CHANGE-REC              VALUE 'Y'.
  3777
  3778 01  TOTAL-PAGE-HD1.
  3779     12  FILLER              PIC X               VALUE SPACE.
  3780     12  TPH1-TYPE           PIC X(8).
  3781     12  TPH1-DESC.
  3782         16  TPH1-ST-CODE    PIC XX.
  3783         16  FILLER          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010S.cbl
  3784         16  TPH1-ST-DESC    PIC X(20).
  3785
  3786 01  TOTAL-PAGE-HD2.
  3787     12  FILLER              PIC X           VALUE SPACE.
  3788     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  3789     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  3790     12  FILLER              PIC X(9)        VALUE SPACES.
  3791     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  3792     12  FILLER              PIC X(11)       VALUE SPACES.
  3793     12  FILLER              PIC X(3)        VALUE 'NET'.
  3794     12  FILLER              PIC X(11)       VALUE SPACES.
  3795     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  3796     12  FILLER              PIC X(10)       VALUE SPACES.
  3797     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  3798
  3799 01  TOTAL-PAGE-HD3.
  3800     12  FILLER              PIC X           VALUE SPACE.
  3801     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  3802     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3803     12  FILLER              PIC X(10)       VALUE SPACES.
  3804     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3805     12  FILLER              PIC X(10)       VALUE SPACES.
  3806     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  3807     12  FILLER              PIC X(7)        VALUE SPACES.
  3808     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  3809     12  FILLER              PIC X(08)       VALUE SPACES.
  3810     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  3811     12  FILLER              PIC X(11)       VALUE SPACES.
  3812     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  3813
  3814 01  TOTAL-PAGE-DETAIL.
  3815     12  FILLER              PIC X(5).
  3816     12  TPD-DESC            PIC X(6).
  3817     12  FILLER              PIC X(3).
  3818     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3819     12  FILLER              PIC X(2).
  3820     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3821     12  FILLER              PIC X(2).
  3822     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  3823     12  FILLER              PIC X(2).
  3824     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  3825     12  FILLER              PIC X(2).
  3826     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  3827     12  FILLER              PIC X(2).
  3828     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  3829     12  FILLER              PIC X(4).
  3830     12  TPD-LO-CERT         PIC X(6).
  3831     12  FILLER              PIC X(2).
  3832     12  TPD-HI-CERT         PIC X(6).
  3833*    12  FILLER              PIC X.
  3834*    12  TPD-LO-CERT         PIC X(8).
  3835*    12  FILLER              PIC X.
  3836*    12  TPD-HI-CERT         PIC X(8).
  3837
  3838 01  DUPE-CERT-TABLE.
  3839     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  3840         16  DUPE-ENTRY      PIC X(36).
  3841         16  DUPE-STATUS     PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010S.cbl
  3842         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  3843         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  3844
  3845 01  MISMATCH-HEADING-1.
  3846     12  FILLER              PIC X           VALUE '1'.
  3847     12  FILLER              PIC X(45)       VALUE SPACES.
  3848     12  FILLER              PIC X(42)       VALUE
  3849             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  3850     12  FILLER              PIC X(35)       VALUE SPACES.
  3851     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  3852
  3853 01  MISMATCH-HEADING-2.
  3854     12  FILLER              PIC X           VALUE '0'.
  3855     12  FILLER              PIC X(44)       VALUE
  3856             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  3857     12  FILLER              PIC X(44)       VALUE
  3858             'YPE      CERT IN CONTROL                    '.
  3859     12  FILLER              PIC X(44)       VALUE
  3860             '        CERT OUT CONTROL           STATUS   '.
  3861
  3862 01  MISMATCH-DETAIL.
  3863     12  FILLER              PIC X           VALUE '0'.
  3864     12  FILLER              PIC X           VALUE SPACES.
  3865     12  DTL-MATCH-CONTROL   PIC X(36).
  3866     12  FILLER              PIC X(3)        VALUE SPACES.
  3867     12  DTL-REC-TYPE        PIC X.
  3868     12  FILLER              PIC X(2)        VALUE SPACES.
  3869     12  DTL-REC-TYPE-DESC   PIC X(3).
  3870     12  FILLER              PIC X(3)        VALUE SPACES.
  3871     12  DTL-CERT-IN-CONTROL
  3872                             PIC X(36).
  3873     12  FILLER              PIC X           VALUE SPACES.
  3874     12  DTL-CERT-OUT-CONTROL
  3875                             PIC X(36).
  3876     12  FILLER              PIC X           VALUE SPACES.
  3877     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  3878     12  FILLER              PIC X(2)        VALUE SPACES.
  3879
  3880 01  MISMATCH-DETAIL-2.
  3881     12  FILLER              PIC X           VALUE ' '.
  3882     12  FILLER              PIC X           VALUE SPACES.
  3883     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  3884             ' LIFE PREMIUM = '.
  3885     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  3886     12  FILLER              PIC X           VALUE SPACES.
  3887     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  3888             'LIFE ALT PREM = '.
  3889     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
  3890     12  FILLER              PIC XX          VALUE SPACES.
  3891     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  3892             'A/H PREMIUM = '.
  3893     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  3894     12  FILLER              PIC X(39)       VALUE SPACES.
  3895
  3896 01  MISMATCH-DETAIL-3.
  3897     12  FILLER              PIC X           VALUE ' '.
  3898     12  FILLER              PIC X           VALUE SPACES.
  3899     12  FILLER              PIC X(16)       VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010S.cbl
  3900             ' LIFE  REFUND = '.
  3901     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  3902     12  FILLER              PIC X           VALUE SPACES.
  3903     12  FILLER              PIC X(16)       VALUE
  3904             'A & H  REFUND = '.
  3905     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  3906     12  FILLER              PIC X(72)       VALUE SPACES.
  3907
  3908 01  MISMATCH-DETAIL-4.
  3909     12  FILLER              PIC X           VALUE ' '.
  3910     12  FILLER              PIC X           VALUE SPACES.
  3911     12  FILLER              PIC X(16)       VALUE
  3912             ' LIFE  CLAIM  = '.
  3913     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  3914     12  FILLER              PIC X           VALUE SPACES.
  3915     12  FILLER              PIC X(16)       VALUE
  3916             'A & H  CLAIM  = '.
  3917     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  3918     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010S.cbl
  3920*
  3921*
  3922* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010S.cbl
  3924 01  PB-STARTS-HERE              PIC X(48)
  3925       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  3926
* 3927                             COPY ERCPNDB.
  3928******************************************************************
  3929*                                                                *
  3930*                                                                *
  3931*                            ERCPNDB.                            *
  3932*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3933*                            VMOD=2.025                          *
  3934*                                                                *
  3935*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3936*                                                                *
  3937******************************************************************
  3938*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3939*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3940******************************************************************
  3941*                                                                *
  3942*                                                                *
  3943*   FILE TYPE = VSAM,KSDS                                        *
  3944*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3945*                                                                *
  3946*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3947*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3948*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3949*                                                 RKP=13,LEN=36  *
  3950*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3951*                                      AND CHG-SEQ.)             *
  3952*                                                RKP=49,LEN=11   *
  3953*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3954*                                      AND CHG-SEQ.)             *
  3955*                                                RKP=60,LEN=15   *
  3956*                                                                *
  3957*   LOG = NO                                                     *
  3958*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3959******************************************************************
  3960******************************************************************
  3961*                   C H A N G E   L O G
  3962*
  3963* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3964*-----------------------------------------------------------------
  3965*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3966* EFFECTIVE    NUMBER
  3967*-----------------------------------------------------------------
  3968* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3969* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3970* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3971* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3972* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3973* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3974* 032306                   PEMA  ADD BOW LOAN NUMBER
  3975* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3976* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3977* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3978* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3979* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3980* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  3981* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  3982* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3983* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3984******************************************************************
  3985
  3986 01  PENDING-BUSINESS.
  3987     12  PB-RECORD-ID                     PIC XX.
  3988         88  VALID-PB-ID                        VALUE 'PB'.
  3989
  3990     12  PB-CONTROL-PRIMARY.
  3991         16  PB-COMPANY-CD                PIC X.
  3992         16  PB-ENTRY-BATCH               PIC X(6).
  3993         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3994         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3995
  3996     12  PB-CONTROL-BY-ACCOUNT.
  3997         16  PB-COMPANY-CD-A1             PIC X.
  3998         16  PB-CARRIER                   PIC X.
  3999         16  PB-GROUPING.
  4000             20  PB-GROUPING-PREFIX       PIC XXX.
  4001             20  PB-GROUPING-PRIME        PIC XXX.
  4002         16  PB-STATE                     PIC XX.
  4003         16  PB-ACCOUNT.
  4004             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4005             20  PB-ACCOUNT-PRIME         PIC X(6).
  4006         16  PB-CERT-EFF-DT               PIC XX.
  4007         16  PB-CERT-NO.
  4008             20  PB-CERT-PRIME            PIC X(10).
  4009             20  PB-CERT-SFX              PIC X.
  4010         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4011
  4012         16  PB-RECORD-TYPE               PIC X.
  4013             88  PB-MAILING-DATA                VALUE '0'.
  4014             88  PB-ISSUE                       VALUE '1'.
  4015             88  PB-CANCELLATION                VALUE '2'.
  4016             88  PB-BATCH-TRAILER               VALUE '9'.
  4017
  4018     12  PB-CONTROL-BY-ORIG-BATCH.
  4019         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4020         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4021         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4022         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4023
  4024     12  PB-CONTROL-BY-CSR.
  4025         16  PB-CSR-COMPANY-CD            PIC X.
  4026         16  PB-CSR-ID                    PIC X(4).
  4027         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4028         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4029         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4030******************************************************************
  4031*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4032******************************************************************
  4033
  4034     12  PB-LAST-MAINT-DT                 PIC XX.
  4035     12  PB-LAST-MAINT-BY                 PIC X(4).
  4036     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4037
  4038     12  PB-RECORD-BODY                   PIC X(375).
  4039
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4040     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4041         16  PB-CERT-ORIGIN               PIC X.
  4042             88  CLASIC-CREATED-CERT         VALUE '1'.
  4043         16  PB-I-NAME.
  4044             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4045             20  PB-I-INSURED-FIRST-NAME.
  4046                 24  PB-I-INSURED-1ST-INIT PIC X.
  4047                 24  FILLER                PIC X(9).
  4048             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4049         16  PB-I-AGE                     PIC S99   COMP-3.
  4050         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4051         16  PB-I-BIRTHDAY                PIC XX.
  4052         16  PB-I-INSURED-SEX             PIC X.
  4053             88  PB-SEX-MALE     VALUE 'M'.
  4054             88  PB-SEX-FEMALE   VALUE 'F'.
  4055
  4056         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4057         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4058         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4059         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4060         16  PB-I-SKIP-CODE               PIC X.
  4061             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4062             88  PB-SKIP-JULY              VALUE '1'.
  4063             88  PB-SKIP-AUGUST            VALUE '2'.
  4064             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4065             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4066             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4067             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4068             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4069             88  PB-SKIP-JUNE              VALUE '8'.
  4070             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4071             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4072             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4073         16  PB-I-TERM-TYPE               PIC X.
  4074             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4075             88  PB-PAID-WEEKLY            VALUE 'W'.
  4076             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4077             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4078             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4079         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4080         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4081         16  PB-I-DATA-ENTRY-SW           PIC X.
  4082             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4083             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4084             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4085             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4086         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4087         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4088*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4089         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4090         16  FILLER                       PIC X.
  4091
  4092         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4093             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4094             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4095                                                   '90' THRU '99'.
  4096         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4097                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4098         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4099         16  PB-I-AMOUNT-FINANCED REDEFINES
  4100                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4101         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4102         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4103                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4104         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4105         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4106         16  PB-I-CLP-AMOUNT REDEFINES
  4107                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4108         16  PB-I-LF-CALC-FLAG            PIC X.
  4109             88 PB-COMP-LF-PREM               VALUE '?'.
  4110         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4111         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4112         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4113         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4114         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4115         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4116         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4117         16  PB-I-LF-ABBR                 PIC XXX.
  4118         16  PB-I-LF-INPUT-CD             PIC XX.
  4119
  4120         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4121             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4122             88  PB-INVALID-AH               VALUE '  ' '00'
  4123                                                   '90' THRU '99'.
  4124         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4125         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4126         16  PB-I-AH-CALC-FLAG            PIC X.
  4127             88 PB-COMP-AH-PREM                  VALUE '?'.
  4128         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4129         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4130         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4131         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4132         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4133         16  PB-I-AH-ABBR                 PIC XXX.
  4134         16  PB-I-AH-INPUT-CD             PIC XXX.
  4135
  4136         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4137         16  PB-I-REIN-TABLE              PIC XXX.
  4138         16  PB-I-BUSINESS-TYPE           PIC 99.
  4139         16  PB-I-INDV-GRP-CD             PIC X.
  4140         16  PB-I-MORT-CODE.
  4141             20  PB-I-TABLE               PIC X.
  4142             20  PB-I-INTEREST            PIC XX.
  4143             20  PB-I-MORT-TYP            PIC X.
  4144         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4145         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4146         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4147         16  PB-I-INDV-GRP-OVRD           PIC X.
  4148         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4149         16  PB-I-SIG-SW                  PIC X.
  4150             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4151         16  PB-I-RATE-CLASS              PIC XX.
  4152         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4153         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4154         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4155         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4156         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4157         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4158         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4159         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4160         16  PB-I-OB-FLAG                 PIC X.
  4161             88  PB-I-OB                      VALUE 'B'.
  4162             88  PB-I-SUMMARY                 VALUE 'Z'.
  4163         16  PB-I-ENTRY-STATUS            PIC X.
  4164             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4165                                              'M' '5' '9' '2'.
  4166             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4167             88  PB-I-POLICY-PENDING          VALUE '2'.
  4168             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4169             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4170             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4171             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4172             88  PB-I-REIN-ONLY               VALUE '9'.
  4173             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4174             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4175             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4176             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4177         16  PB-I-INT-CODE                PIC X.
  4178             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4179             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4180         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4181         16  PB-I-SOC-SEC-NO              PIC X(11).
  4182         16  PB-I-MEMBER-NO               PIC X(12).
  4183         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4184*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4185         16  PB-I-OLD-LOF                 PIC XXX.
  4186         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4187         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4188         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4189         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4190         16  PB-I-LIFE-INDICATOR          PIC X.
  4191             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4192         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4193         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4194                                          PIC S9(5)V99    COMP-3.
  4195         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4196             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4197             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4198         16  PB-I-1ST-PMT-DT              PIC XX.
  4199         16  PB-I-JOINT-INSURED.
  4200             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4201             20 PB-I-JOINT-FIRST-NAME.
  4202                24  PB-I-JOINT-FIRST-INIT PIC X.
  4203                24  FILLER                PIC X(9).
  4204             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4205*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4206         16  PB-I-BENEFICIARY-NAME.
  4207             20  PB-I-BANK-NUMBER         PIC X(10).
  4208             20  FILLER                   PIC X(15).
  4209         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4210         16  PB-I-REFERENCE               PIC X(12).
  4211         16  FILLER REDEFINES PB-I-REFERENCE.
  4212             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4213             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4214             20  PB-I-CLP-STATE           PIC XX.
  4215         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4216             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4217             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4218             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4219         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4220         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4221         16  PB-I-RESIDENT-STATE          PIC XX.
  4222         16  PB-I-RATE-CODE               PIC X(4).
  4223         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4224         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4225         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4226         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4227         16  PB-I-BANK-NOCHRGB            PIC 99.
  4228         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4229         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4230
  4231     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4232         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4233             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4234         16  PB-C-CANCEL-ORIGIN           PIC X.
  4235             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4236         16  PB-C-LF-CANCEL-DT            PIC XX.
  4237         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4238         16  PB-C-LF-CALC-REQ             PIC X.
  4239             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4240         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4241         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4242         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4243             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4244         16  PB-C-AH-CANCEL-DT            PIC XX.
  4245         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4246         16  PB-C-AH-CALC-REQ             PIC X.
  4247             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4248         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4249         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4250         16  PB-C-LAST-NAME               PIC X(15).
  4251         16  PB-C-REFUND-SW               PIC X.
  4252             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4253             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4254         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4255         16  PB-C-PAYEE-CODE              PIC X(6).
  4256         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4257         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4258         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4259         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4260         16  PB-C-REFERENCE               PIC X(12).
  4261         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4262         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4263         16  PB-C-POST-CARD-IND           PIC X.
  4264         16  PB-C-CANCEL-REASON           PIC X.
  4265         16  PB-C-REF-INTERFACE-SW        PIC X.
  4266         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4267         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4268         16  FILLER                       PIC X(01).
  4269*        16  FILLER                       PIC X(18).
  4270         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4271*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4272         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4273         16  PB-CANCELED-CERT-DATA.
  4274             20  PB-CI-INSURED-NAME.
  4275                 24  PB-CI-LAST-NAME      PIC X(15).
  4276                 24  PB-CI-INITIALS       PIC XX.
  4277             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4278             20  PB-CI-INSURED-SEX        PIC X.
  4279             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4280             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4281             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4282             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4283             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4284             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4285             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4286             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4287             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4288             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4289             20  PB-CI-RATE-CLASS         PIC XX.
  4290             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4291             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4292             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4293             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4294             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4295             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4296             20  PB-CI-LF-ABBR            PIC X(3).
  4297             20  PB-CI-AH-ABBR            PIC X(3).
  4298             20  PB-CI-OB-FLAG            PIC X.
  4299                 88  PB-CI-OB                VALUE 'B'.
  4300             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4301                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4302                                           'M' '4' '5' '9' '2'.
  4303                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4304                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4305                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4306                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4307                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4308                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4309                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4310                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4311                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4312                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4313                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4314                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4315                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4316             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4317                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4318                                           'M' '4' '5' '9' '2'.
  4319                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4320                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4321                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4322                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4323                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4324                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4325                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4326                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4327                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4328                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4329                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4330                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4331                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4332             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4333             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4334             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4335             20  PB-CI-MEMBER-NO          PIC X(12).
  4336             20  PB-CI-INT-CODE           PIC X.
  4337                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4338                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4339             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4340             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4341             20  PB-CI-COMP-EXCP-SW       PIC X.
  4342                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4343                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4344             20  PB-CI-ENTRY-STATUS       PIC X.
  4345             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4346             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4347             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4348             20  PB-CI-DEATH-DT           PIC XX.
  4349             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4350             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4351             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4352             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4353             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4354             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4355             20  PB-CI-ENTRY-DT              PIC XX.
  4356             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4357             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4358             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4359             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4360             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4361             20  PB-CI-OLD-LOF               PIC XXX.
  4362*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4363             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4364             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4365             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4366             20  PB-CI-INDV-GRP-CD           PIC X.
  4367             20  PB-CI-BENEFICIARY-NAME.
  4368                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4369                 24  FILLER                  PIC X(15).
  4370             20  PB-CI-NOTE-SW               PIC X.
  4371             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4372             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4373             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4374             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4375             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4376             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4377             20  PB-CI-FIRST-NAME            PIC X(10).
  4378             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4379
  4380         16  FILLER                       PIC X(13).
  4381*032306  16  FILLER                       PIC X(27).
  4382*        16  FILLER                       PIC X(46).
  4383
  4384     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4385         16  FILLER                       PIC X(10).
  4386         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4387         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4388         16  PB-M-INSURED-MID-INIT        PIC X.
  4389         16  PB-M-INSURED-AGE             PIC 99.
  4390         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4391         16  PB-M-INSURED-SEX             PIC X.
  4392         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4393         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4394         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4395         16  PB-M-INSURED-CITY-STATE.
  4396             20  PB-M-INSURED-CITY        PIC X(28).
  4397             20  PB-M-INSURED-STATE       PIC XX.
  4398         16  PB-M-INSURED-ZIP-CODE.
  4399             20  PB-M-INSURED-ZIP-PRIME.
  4400                 24  PB-M-INSURED-ZIP-1   PIC X.
  4401                     88  PB-M-CANADIAN-POST-CODE
  4402                                             VALUE 'A' THRU 'Z'.
  4403                 24  FILLER               PIC X(4).
  4404             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4405         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4406                                        PB-M-INSURED-ZIP-CODE.
  4407             20  PM-M-INS-CAN-POST1       PIC XXX.
  4408             20  PM-M-INS-CAN-POST2       PIC XXX.
  4409             20  FILLER                   PIC XXX.
  4410         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4411         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4412         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4413         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4414         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4415         16  PB-M-CRED-BENE-CITYST.
  4416             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4417             20  PB-M-CRED-BENE-STATE     PIC XX.
  4418
  4419         16  FILLER                       PIC X(92).
  4420
  4421     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4422         16  FILLER                       PIC X(10).
  4423         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4424         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4425         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4426         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4427         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4428         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4429         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4430         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4431         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4432         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4433         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4434         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4435         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4436         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4437         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4438         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4439         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4440         16  PB-ACCOUNT-NAME              PIC X(30).
  4441         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4442         16  PB-REFERENCE                 PIC X(12).
  4443         16  PB-B-RECEIVED-DT             PIC XX.
  4444         16  FILLER                       PIC X(234).
  4445
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4446     12  PB-RECORD-STATUS.
  4447         16  PB-CREDIT-SELECT-DT          PIC XX.
  4448         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4449         16  PB-BILLED-DT                 PIC XX.
  4450         16  PB-BILLING-STATUS            PIC X.
  4451             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4452             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4453             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4454         16  PB-RECORD-BILL               PIC X.
  4455             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4456             88  PB-RECORD-RETURNED           VALUE 'R'.
  4457             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4458             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4459             88  PB-OVERRIDE-AH               VALUE 'A'.
  4460             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4461         16  PB-BATCH-ENTRY               PIC X.
  4462             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4463             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4464             88  PB-REISSUED-CERT             VALUE 'E'.
  4465             88  PB-CASH-CERT                 VALUE 'C'.
  4466             88  PB-MONTHLY-CERT              VALUE 'M'.
  4467             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4468             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4469             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4470         16  PB-FORCE-CODE                PIC X.
  4471             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4472             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4473             88  PB-CANCEL-FORCE              VALUE '8'.
  4474             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4475             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4476             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4477             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4478             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4479             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4480             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4481         16  PB-FATAL-FLAG                PIC X.
  4482             88  PB-FATAL-ERRORS              VALUE 'X'.
  4483         16  PB-FORCE-ER-CD               PIC X.
  4484             88  PB-FORCE-ERRORS              VALUE 'F'.
  4485             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4486         16  PB-WARN-ER-CD                PIC X.
  4487             88  PB-WARNING-ERRORS            VALUE 'W'.
  4488         16  FILLER                       PIC X.
  4489         16  PB-OUT-BAL-CD                PIC X.
  4490             88  PB-OUT-OF-BAL                VALUE 'O'.
  4491         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4492         16  PB-AH-OVERRIDE-L1            PIC X.
  4493         16  PB-INPUT-DT                  PIC XX.
  4494         16  PB-INPUT-BY                  PIC X(4).
  4495         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4496         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4497         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4498         16  PB-LF-EARNING-METHOD         PIC X.
  4499         16  PB-AH-EARNING-METHOD         PIC X.
  4500         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4501         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4502         16  PB-REIN-CD                   PIC XXX.
  4503         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4504         16  PB-AH-REFUND-TYPE            PIC X.
  4505         16  PB-ACCT-EFF-DT               PIC XX.
  4506         16  PB-ACCT-EXP-DT               PIC XX.
  4507         16  PB-COMPANY-ID                PIC X(3).
  4508         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4509         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4510         16  PB-SV-CARRIER                PIC X.
  4511         16  PB-SV-GROUPING               PIC X(6).
  4512         16  PB-SV-STATE                  PIC XX.
  4513         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4514         16  PB-GA-BILLING-INFO.
  4515             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4516                                          PIC XX.
  4517         16  PB-SV-REMIT-TO  REDEFINES
  4518             PB-GA-BILLING-INFO           PIC X(10).
  4519         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4520         16  PB-I-LOAN-OFFICER            PIC X(5).
  4521         16  PB-I-VIN                     PIC X(17).
  4522
  4523         16  FILLER                       PIC X(04).
  4524         16  IMNET-BYPASS-SW              PIC X.
  4525
  4526******************************************************************
  4527*                COMMON EDIT ERRORS                              *
  4528******************************************************************
  4529
  4530     12  PB-COMMON-ERRORS.
  4531         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4532                                           PIC S9(4)     COMP.
  4533
  4534******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010S.cbl
  4536 01  PC-STARTS-HERE              PIC X(48)
  4537       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4538
* 4539                             COPY ERCPNDC.
  4540******************************************************************04/29/98
  4541*                                                                *ERCPNDC
  4542*                                                                *ERCPNDC
  4543*                            ERCPNDC                             *   LV003
  4544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4545*                            VMOD=2.004                          *   CL**2
  4546*                                                                *ERCPNDC
  4547*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4548*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4549*                                                                *ERCPNDC
  4550*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4551*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4552*                                                                *ERCPNDC
  4553*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4554*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4555*                                                                *ERCPNDC
  4556*   LOG = YES                                                    *ERCPNDC
  4557*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4558******************************************************************ERCPNDC
  4559                                                                  ERCPNDC
  4560 01  PENDING-CLAIMS.                                              ERCPNDC
  4561     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4562         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4563                                                                  ERCPNDC
  4564     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4565         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4566         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4567         16  PC-GROUPING.                                         ERCPNDC
  4568             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4569             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4570         16  PC-STATE                     PIC XX.                 ERCPNDC
  4571         16  PC-ACCOUNT.                                          ERCPNDC
  4572             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4573             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4574         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4575         16  PC-CERT-NO.                                          ERCPNDC
  4576             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4577             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4578         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4579         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4580                                                                  ERCPNDC
  4581         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4582             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4583             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4584         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4585                                                                  ERCPNDC
  4586     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4587     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4588     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4589                                                                  ERCPNDC
  4590     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4591         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4592             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4593             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4594             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4595             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4596         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4597         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4598         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4599         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4600         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4601         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4602         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4603         16  FILLER                       PIC XX.                 ERCPNDC
  4604         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4605             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4606             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4607             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4608             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4609             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4610             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4611             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4612                                                                  ERCPNDC
  4613         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4614         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4615         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4616         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4617                                                                  ERCPNDC
  4618         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4619         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4620         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4621                                                                  ERCPNDC
  4622         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4623             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4624                                                                  ERCPNDC
  4625         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4626         16  FILLER                       PIC X(48).              ERCPNDC
  4627                                                                  ERCPNDC
  4628         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4629             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4630                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4631                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4632             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4633             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4634             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4635             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4636             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4637             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4638             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4639             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4640             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4641             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4642             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4643             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4644             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4645                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4646             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4647                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4648                                               '4' '5' '9' '2'.   ERCPNDC
  4649                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4650                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4651                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4652                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4653                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4654                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4655                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4656                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4657                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4658             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4659                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4660                                               '4' '5' '9' '2'.   ERCPNDC
  4661                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4662                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4663                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4664                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4665                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4666                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4667                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4668                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4669                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4670             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4671             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4672             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4673             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4674             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4675                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4676                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4677             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4678             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4679             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4680             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4681             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4682             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4683             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4684             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4685         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4686         16  PC-CC-CLP-STATE              PIC XX.
  4687         16  FILLER                       PIC X(14).              ERCPNDC
  4688         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4689         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4690         16  FILLER                       PIC X(34).              ERCPNDC
  4691                                                                  ERCPNDC
  4692     12  PC-RECORD-STATUS.                                        ERCPNDC
  4693         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4694         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4695         16  FILLER                       PIC XX.                 ERCPNDC
  4696         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4697             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4698         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4699             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4700             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4701                                                     '8'.         ERCPNDC
  4702         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4703             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4704             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4705         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4706             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4707         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4708         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4709         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4710         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4711             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4712         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4713         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4714                                                                  ERCPNDC
  4715     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4716         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4717             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4718         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4719             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4720                                                                  ERCPNDC
  4721     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4722         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4723                                                                  ERCPNDC
  4724     12  FILLER                           PIC X(25).              ERCPNDC
  4725                                                                  ERCPNDC
  4726******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010S.cbl
  4728 01  CC-STARTS-HERE              PIC X(48)
  4729       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4730
* 4731                             COPY ERCCRTC.
  4732******************************************************************04/29/98
  4733*                                                                *ERCCRTC
  4734*                                                                *ERCCRTC
  4735*                            ERCCRTC                             *   LV003
  4736*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4737*                            VMOD=2.005                          *   CL**3
  4738*                                                                *ERCCRTC
  4739*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4740*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4741*                       ISSUES AND CANCELS)                      *ERCCRTC
  4742*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4743*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  4744*                                                                *ERCCRTC
  4745*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  4746*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  4747*                                                                *ERCCRTC
  4748*   LOG = YES                                                    *ERCCRTC
  4749*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  4750******************************************************************ERCCRTC
  4751*                   C H A N G E   L O G
  4752*
  4753* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4754*-----------------------------------------------------------------
  4755*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4756* EFFECTIVE    NUMBER
  4757*-----------------------------------------------------------------
  4758* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4759******************************************************************
  4760 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  4761     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  4762         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  4763                                                                  ERCCRTC
  4764     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  4765         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  4766         16  CC-CARRIER                   PIC X.                  ERCCRTC
  4767         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  4768         16  CC-STATE                     PIC XX.                 ERCCRTC
  4769         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  4770         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  4771         16  CC-CERT-NO.                                          ERCCRTC
  4772             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  4773             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  4774                                                                  ERCCRTC
  4775         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  4776                                                                  ERCCRTC
  4777     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  4778     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  4779     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  4780                                                                  ERCCRTC
  4781     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  4782                                                                  ERCCRTC
  4783     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  4784         16  FILLER                       PIC X(10).              ERCCRTC
  4785         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  4786             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  4787             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  4788                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  4789                 24  FILLER               PIC X(9).               ERCCRTC
  4790             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  4791         16  CC-AGE                       PIC S99.                ERCCRTC
  4792         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  4793         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  4794         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  4795             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  4796             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  4797         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  4798             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  4799             20  CC-JT-FIRST-NAME.                                ERCCRTC
  4800                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  4801                 24  FILLER               PIC X(9).               ERCCRTC
  4802             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  4803         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  4804         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  4805         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  4806         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  4807         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  4808         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  4809         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  4810         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  4811         16  CC-OLD-LOF                   PIC XXX.
  4812*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  4813         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  4814         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  4815         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  4816         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  4817         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  4818         16  FILLER                       PIC X(3).               ERCCRTC
  4819         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  4820         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  4821         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  4822         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  4823         16  CC-LOAN-OFFICER              PIC X(5).
  4824         16  FILLER                       PIC XXX.                ERCCRTC
  4825     12  CC-RECORD-STATUS.                                        ERCCRTC
  4826         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  4827         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  4828     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  4829         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  4830         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4831         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  4832         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  4833     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  4834     12  CC-ERROR-FLAGS.                                          ERCCRTC
  4835         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  4836             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  4837         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  4838             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  4839     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  4840         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  4841         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4842         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  4843         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010S.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  4844                                                                  ERCCRTC
  4845     12  FILLER                           PIC X(05).              ERCCRTC
  4846******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010S.cbl
  4848 01  CR-STARTS-HERE              PIC X(48)
  4849       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  4850
* 4851                             COPY ECSCRT01.
  4852******************************************************************
  4853*                                                                *
  4854*                            ECSCRT01                            *
  4855*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4856*                            VMOD=2.016                          *
  4857*                                                                *
  4858*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  4859*                                                                *
  4860*   FILE TYPE = SEQUENTIAL
  4861*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  4862*                                                                *
  4863*   KEY DATA =                         START=4, LEN=36           *
  4864*                                                                *
  4865*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  4866*                                                                *
  4867******************************************************************
  4868******************************************************************
  4869*                   C H A N G E   L O G
  4870*
  4871* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4872*-----------------------------------------------------------------
  4873*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4874* EFFECTIVE    NUMBER
  4875*-----------------------------------------------------------------
  4876* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4877* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  4878* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4879* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  4880* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4881* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  4882* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4883* 032612  CR2011110200001  PEMA  AHL CHANGES
  4884* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  4885* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4886******************************************************************
  4887
  4888 01  CERTIFICATE-RECORD.
  4889     12  CR-RECORD-ID                      PIC XX.
  4890         88  VALID-CR-ID                      VALUE 'CR'.
  4891
  4892     12  CR-COMPANY-CD                     PIC X.
  4893
  4894     12  CR-FULL-CONTROL.
  4895         16  CR-CONTROL-1.
  4896             20  CR-ACCT-CONTROL.
  4897                 24  CR-CARRIER            PIC X.
  4898                 24  CR-GROUPING.
  4899                     28  CR-GROUP-PREFIX   PIC XXX.
  4900                     28  CR-GROUP-PRIME    PIC XXX.
  4901                 24  CR-STATE              PIC XX.
  4902                 24  CR-ACCOUNT.
  4903                     28  CR-ACCT-PREFIX    PIC X(4).
  4904                     28  CR-ACCT-PRIME     PIC X(6).
  4905             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  4906         16  CR-CERT-NO.
  4907             20  CR-CERT.
  4908                 24  CR-CERT-PREFIX        PIC X(3).
  4909                 24  CR-CERT-PRIME         PIC X(7).
  4910             20  CR-CERT-SFX               PIC X.
  4911
  4912     12  CR-INSUREDS-PROFILE.
  4913         16  CR-NAME.
  4914             20  CR-LNAME                  PIC X(15).
  4915             20  CR-FNAME.
  4916                 24  CR-1ST-INITIAL        PIC X.
  4917                 24  FILLER                PIC X(9).
  4918             20  CR-INIT                   PIC X.
  4919         16  CR-AGE                        PIC 99.
  4920         16  CR-SEX                        PIC X.
  4921             88  CR-SEX-MALE                  VALUE 'M'.
  4922             88  CR-SEX-FEMALE                VALUE 'F'.
  4923         16  CR-SOC-SEC                    PIC X(11).
  4924         16  CR-JOINT-NAME.
  4925             20  CR-JT-LNAME               PIC X(15).
  4926             20  CR-JT-FNAME.
  4927                 24  CR-JT-1ST-INIT        PIC X.
  4928                 24  FILLER                PIC X(9).
  4929             20  CR-JT-INIT                PIC X.
  4930         16  CR-JOINT-AGE                  PIC 99.
  4931
  4932         16  cr-ahl-ah-claim-no            pic x(9).
  4933         16  cr-ahl-ah-cert-seq            pic x(3).
  4934         16  cr-hst-proc-lf                pic x.
  4935         16  f                             pic x(7).
  4936
  4937     12  CR-LF-COVERAGE-DATA.
  4938         16  CR-LFTYP                      PIC XX.
  4939         16  CR-LF-TERM                    PIC S999       COMP-3.
  4940         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  4941         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  4942         16  CR-LF-DEV-CODE                PIC XXX.
  4943         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  4944
  4945         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  4946         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  4947         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  4948         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  4949
  4950         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  4951         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  4952         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  4953         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  4954
  4955         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  4956         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  4957
  4958         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  4959         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  4960
  4961         16  CR-LF-REFUND-TYPE             PIC X.
  4962         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  4963
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  4964         16  CR-LF-COMM-CHARGEBACK         PIC X.
  4965             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  4966
  4967         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  4968
  4969         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  4970         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  4971         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  4972
  4973         16  cr-ahl-lf-claim-no            pic x(9).
  4974         16  cr-ahl-lf-cert-seq            pic x(3).
  4975         16  FILLER                        PIC XX.
  4976
  4977     12  CR-AH-COVERAGE-DATA.
  4978         16  CR-AHTYP                      PIC XX.
  4979         16  CR-AH-TERM                    PIC S999       COMP-3.
  4980         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  4981         16  CR-AH-DEV-CODE                PIC XXX.
  4982         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  4983
  4984         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  4985         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  4986         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  4987         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  4988
  4989         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  4990         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  4991
  4992         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  4993         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  4994
  4995         16  CR-AH-REFUND-TYPE             PIC X.
  4996         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  4997
  4998         16  CR-AH-COMM-CHARGEBACK         PIC X.
  4999             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5000
  5001         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5002
  5003         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5004         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5005         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5006
  5007         16  FILLER                        PIC XX.
  5008*        16  FILLER                        PIC X(8).
  5009
  5010     12  CR-LOAN-DATA.
  5011         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5012         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5013                                           PIC S9(5)V99   COMP-3.
  5014         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5015         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5016         16  CR-PMT-FREQ                   PIC 99.
  5017         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5018         16  CR-RATING-CLASS               PIC XX.
  5019         16  CR-POLICY-FORM-NO             PIC X(12).
  5020         16  CR-GRPTYP                     PIC XX.
  5021         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5022             88  CR-INDIVIDUAL                VALUE '1'.
  5023             88  CR-GROUP                     VALUE '2'.
  5024         16  CR-SKIP                       PIC 99.
  5025             88  NO-MONTHS-SKIPPED            VALUE 00.
  5026             88  SKIP-JULY                    VALUE 01.
  5027             88  SKIP-AUGUST                  VALUE 02.
  5028             88  SKIP-SEPTEMBER               VALUE 03.
  5029             88  SKIP-JULY-AUG                VALUE 04.
  5030             88  SKIP-AUG-SEPT                VALUE 05.
  5031             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5032             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5033             88  SKIP-JUNE                    VALUE 08.
  5034             88  SKIP-JUNE-JULY               VALUE 09.
  5035             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5036             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5037         16  CR-RESIDENT-STATE             PIC XX.
  5038         16  CR-RATE-CODE.
  5039             20  CR-LF-CLASS-CD            PIC XX.
  5040             20  CR-AH-CLASS-CD            PIC XX.
  5041         16  CR-MORT.
  5042             20  CR-TAB                    PIC X.
  5043             20  CR-INT                    PIC 99.
  5044             20  CR-GRP                    PIC X.
  5045         16  CR-MEMBER-NO                  PIC X(12).
  5046         16  CR-OLD-LOF                    PIC XXX.
  5047*        16  CR-LOAN-OFFICER               PIC XXX.
  5048         16  CR-REIN-TABLE                 PIC XXX.
  5049         16  CR-REIN-SPEC                  PIC X.
  5050         16  CR-LOAN-1ST-PMT-DT.
  5051             20  CR-1ST-PMT-YR             PIC 99.
  5052             20  CR-1ST-PMT-MO             PIC 99.
  5053             20  CR-1ST-PMT-DA             PIC 99.
  5054         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5055         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5056         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5057         16  CR-LAST-ADD-ON-DT             PIC XX.
  5058
  5059         16  CR-UNDERWRITING-CODE          PIC X.
  5060             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5061
  5062         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5063         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5064         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5065         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5066
  5067     12  CR-STATUS-INFORMATION.
  5068         16  CR-ENTRY-STATUS               PIC X.
  5069             88  CR-NORMAL-ENTRY              VALUE '1'.
  5070             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5071             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5072             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5073             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5074             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5075             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5076             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5077             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5078             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5079             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5080                                                'C' '5' '9' 'P'.
  5081         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5082
  5083         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5084         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5085         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5086
  5087         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5088         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5089
  5090         16  CR-LF-CURRENT-STATUS          PIC X.
  5091             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5092             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5093             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5094             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5095             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5096             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5097             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5098             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5099             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5100             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5101             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5102             88  CR-LF-IS-VOID                VALUE 'V'.
  5103             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5104                                                    '4' '5' '9'.
  5105
  5106         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5107
  5108         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5109         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5110
  5111         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5112         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5113
  5114         16  CR-AH-CURRENT-STATUS          PIC X.
  5115             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5116             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5117             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5118             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5119             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5120             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5121             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5122             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5123             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5124             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5125             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5126             88  CR-AH-IS-VOID                VALUE 'V'.
  5127             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5128                                                    '4' '5' '9'.
  5129         16  CR-LOAN-OFFICER               PIC X(5).
  5130         16  CR-CANCEL-REASON              PIC X.
  5131         16  cr-xycor-lf-cov-code          pic x(4).
  5132         16  cr-xycor-ah-cov-code          pic x(4).
  5133         16  cr-temp-epiq                  pic x(4).
  5134         16  FILLER                        PIC XX.
  5135
  5136     12  CR-DEATH-CLAIM-DATA.
  5137         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5138
  5139         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5140         16  CR-DTH-RPT-DT.
  5141             20  CR-DTH-RPT-YR             PIC 99.
  5142             20  CR-DTH-RPT-MO             PIC 99.
  5143             20  CR-DTH-RPT-DA             PIC 99.
  5144         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5145
  5146         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5147         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5148         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5149         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5150         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5151
  5152         16  CR-DTH-AGE                    PIC 99.
  5153         16  CR-DTH-PAY-CD                 PIC X.
  5154         16  CR-DEATH-CAUSE                PIC X(6).
  5155
  5156         16  FILLER                        PIC X(16).
  5157
  5158     12  CR-DISAB-CLAIM-DATA.
  5159         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5160
  5161         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5162         16  CR-DIS-RPT-DT.
  5163             20  CR-DIS-RPT-YR             PIC 99.
  5164             20  CR-DIS-RPT-MO             PIC 99.
  5165             20  CR-DIS-RPT-DA             PIC 99.
  5166         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5167         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5168
  5169         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5170         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5171         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5172         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5173         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5174
  5175         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5176         16  CR-DIS-PAY-CD                 PIC X.
  5177         16  FILLER                        PIC XX.
  5178
  5179         16  CR-DISAB-INCURRED-DETAIL.
  5180             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5181**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5182                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5183                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5184                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5185
  5186         16  CR-DISAB-CAUSE                PIC X(6).
  5187         16  FILLER                        PIC X(14).
  5188
  5189     12  CR-REMIT-TO                       PIC 99.
  5190
  5191     12  CR-COMPENSATION-LEVELS.
  5192         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5193             20  CR-COM-AGT.
  5194                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5195                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5196             20  CR-AGT-TYPE               PIC X.
  5197             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5198             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5199
  5200     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5201     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5202     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5203     12  CR-CLP-STATE                      PIC XX.
  5204     12  CR-POST-CARD-IND                  PIC X.
  5205     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5206     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5207     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5208     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5209     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5210     12  FILLER                            PIC X(07).
  5211
  5212     12  CR-CSR-CODE                       PIC XXX.
  5213
  5214     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5215     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5216
  5217     12  CR-MICROFILM-NUMBERS.
  5218*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5219         16  FILLER                        PIC X(5).
  5220     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5221
  5222     12  CR-USER-CODE                      PIC X.
  5223     12  CR-USER-FUTURE                    PIC X(9).
  5224
  5225     12  CR-BENEFICIARY.
  5226         16  CR-BANK-NO                    PIC X(10).
  5227         16  FILLER                        PIC X(15).
  5228
  5229     12  CR-ENTRY-BATCH                    PIC X(6).
  5230     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5231     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5232
  5233     12  CR-NOTE-SW                        PIC X.
  5234
  5235     12  CR-ORIGIN-INDICATOR               PIC X.
  5236         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5237         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5238
  5239     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5240     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5241     12  FILLER                            PIC X(33).
  5242
  5243******************************************************************
* 5244                             COPY ELCCRTVR.
  5245***************************************************************** 04/24/98
  5246*                                                                *ELCCRTVR
  5247*                                                                *ELCCRTVR
  5248*                            ELCCRTVR                            *   LV003
  5249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5250*                            VMOD=2.001                          *ELCCRTVR
  5251*                                                                *ELCCRTVR
  5252*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5253*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5254*                                                                *ELCCRTVR
  5255******************************************************************ELCCRTVR
  5256                                                                  ELCCRTVR
  5257 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5258     05  WS-CR-DT.                                                ELCCRTVR
  5259         10  FILLER                PIC 999.                       ELCCRTVR
  5260         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5261         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5262             15  CR-CC             PIC 99.                        ELCCRTVR
  5263             15  CR-YR             PIC 99.                        ELCCRTVR
  5264         10  CR-MO                 PIC 99.                        ELCCRTVR
  5265         10  CR-DA                 PIC 99.                        ELCCRTVR
  5266     05  WS-CR-DT-N REDEFINES                                        CL**2
  5267            WS-CR-DT               PIC 9(11).                        CL**2
  5268     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5269         10  FILLER                    PIC 999.                   ELCCRTVR
  5270         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5271         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5272             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5273             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5274         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5275         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5276     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5277            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5278     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5279         10  FILLER                    PIC 999.                   ELCCRTVR
  5280         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5281         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5282             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5283             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5284         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5285         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5286     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5287            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5288     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5289         10  FILLER                    PIC 999.                   ELCCRTVR
  5290         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5291         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5292             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5293             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5294         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5295         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5296     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5297            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5298     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5299         10  FILLER                    PIC 999.                   ELCCRTVR
  5300         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5301         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5302             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5303             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5304         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5305         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5306     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5307            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5308     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5309         10  FILLER                    PIC 999.                   ELCCRTVR
  5310         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5311         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5312             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5313             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5314         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5315         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5316     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5317            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5318     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5319         10  FILLER                    PIC 999.                   ELCCRTVR
  5320         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5321         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5322             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5323             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5324         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5325         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5326     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5327            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5328     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5329         10  FILLER                    PIC 999.                   ELCCRTVR
  5330         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5331         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5332             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5333             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5334         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5335         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5336     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5337            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5338     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5339         10  FILLER                    PIC 999.                   ELCCRTVR
  5340         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5341         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5342             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5343             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5344         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5345         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5346     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5347            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5348     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5349         10  FILLER                    PIC 999.                   ELCCRTVR
  5350         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5351         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5352             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5353             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5354         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5355         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5356     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5357          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5358     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5359         10  FILLER                    PIC 999.                   ELCCRTVR
  5360         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5361         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5362             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5363             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5364         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5365         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5366     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5367            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5368     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5369         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5370         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5371         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5372             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5373             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5374         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5375         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5376     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5377            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5378     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5379         10  FILLER                    PIC 999.                   ELCCRTVR
  5380         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5381         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5382             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5383             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5384         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5385         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5386     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5387            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5388     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5389         10  FILLER                    PIC 999.                   ELCCRTVR
  5390         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5391         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5392             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5393             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5394         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5395         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5396     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5397            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5398     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5399         10  FILLER                    PIC 999.                   ELCCRTVR
  5400         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5401         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5402             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5403             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5404         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5405         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5406     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5407            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5408     05  COPY-NDX                      PIC 9.                        CL**6
  5409     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5410         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5411             15  FILLER                PIC 999.                   ELCCRTVR
  5412             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5413             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5414                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5415                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5416             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5417             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5418         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5419                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5420
  5421 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010S.cbl
* 5423                             COPY ELCDATE.
  5424******************************************************************06/11/98
  5425*                                                                *ELCDATE
  5426*                                                                *ELCDATE
  5427*                            ELCDATE.                            *   LV023
  5428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5429*                            VMOD=2.003                           ELCDATE
  5430*                                                                *ELCDATE
  5431*                                                                *ELCDATE
  5432*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5433*                 LENGTH = 200                                   *   CL*19
  5434******************************************************************ELCDATE
  5435                                                                  ELCDATE
  5436 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5437     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5438     12  DC-OPTION-CODE                PIC X.                        CL*15
  5439         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5440         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5441         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5442         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5443         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5444         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5445         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5446         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5447         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5448         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5449         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5450         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5451         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5452         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5453         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5454         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5455         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5456         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5457         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5458         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5459         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5460         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5461         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5462         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5463         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5464         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5465         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5466         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5467         88  THREE-CHARACTER-BIN                                  ELCDATE
  5468                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5469         88  GREGORIAN-TO-BIN                                        CL**2
  5470                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5471         88  BIN-TO-GREGORIAN                                        CL**2
  5472                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5473         88  JULIAN-TO-BINARY                                        CL**2
  5474                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5475     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5476         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5477         88  DATE-CONVERSION-ERROR                                ELCDATE
  5478                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5479         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5480         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5481         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5482         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5483         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5484         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5485         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5486         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5487         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5488         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5489     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5490         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5491     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5492         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5493         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5494         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5495     12  FILLER                        PIC X.                        CL*15
  5496     12  DC-CONVERSION-DATES.                                        CL*15
  5497         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5498         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5499         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5500         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5501                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5502             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5503             20  SLASH1-1              PIC X.                        CL*15
  5504             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5505             20  SLASH1-2              PIC X.                        CL*15
  5506             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5507         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5508         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5509                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5510             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5511             20  SLASH2-1              PIC X.                        CL*15
  5512             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5513             20  SLASH2-2              PIC X.                        CL*15
  5514             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5515         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5516         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5517                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5518             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5519             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5520             20  DC-YMD-DAY            PIC 99.                       CL*15
  5521         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5522         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5523                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5524             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5525             20  DC-MDY-DAY            PIC 99.                       CL*15
  5526             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5527         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5528             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5529             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5530             20  FILLER                PIC XX.                       CL*15
  5531             20  DC-ALPHA-CENTURY.                                   CL*15
  5532                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5533             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5534         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5535         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5536         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5537         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5538         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5539                                       PIC 9(05).                    CL*20
  5540         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5541             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5542             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5543         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5544         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5545         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5546     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5547         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5548         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5549             20  FILLER                PIC 9(3).                     CL*15
  5550             20  HOLD-CEN-1-CCYY.                                    CL*15
  5551                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5552                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5553             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5554             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5555         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5556             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5557             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5558             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5559                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5560                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5561             20  FILLER                PIC 9(3).                     CL*15
  5562         16  HOLD-CENTURY-1-X.                                       CL*15
  5563             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5564             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5565                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5566                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5567             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5568             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5569         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5570             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5571             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5572             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5573                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5574                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5575             20  FILLER                PIC XXX.                      CL*23
  5576         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5577         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5578         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5579         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5580             20  DC-JULIAN-1-CCYY.                                   CL*15
  5581                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5582                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5583             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5584         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5585         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5586             20  DC-JULIAN-2-CCYY.                                   CL*15
  5587                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5588                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5589             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5590         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5591             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5592             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5593             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5594             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5595             20  DC-EDITA-CCYY.                                      CL*15
  5596                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5597                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5598         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5599             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5600             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5601             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5602             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5603             20  DC-EDITB-CCYY.                                      CL*15
  5604                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5605                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5606         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5607         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5608                              DC-GREG-DATE-CYMD.                  ELCDATE
  5609             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5610             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5611             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5612             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5613         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5614         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5615                              DC-GREG-DATE-MDCY.                  ELCDATE
  5616             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5617             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5618             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5619             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5620    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5621        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5622    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5623    12  FILLER                         PIC X(28).                    CL*26
* 5624                             COPY ELCFUNDT.
  5625***************************************************************** 12/03/98
  5626*                                                               * ELCFUNDT
  5627*                            ELCFUNDT.                          *    LV004
  5628*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5629*                            VMOD=2.001                         * ELCFUNDT
  5630*                                                               * ELCFUNDT
  5631*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5632*                                                               * ELCFUNDT
  5633***************************************************************** ELCFUNDT
  5634                                                                  ELCFUNDT
  5635                                                                  ELCFUNDT
  5636 01  FUNCTION-DATE.                                                  CL**2
  5637     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5638     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5639         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5640         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5641             15  WS-FN-CC          PIC 99.                           CL**3
  5642             15  WS-FN-YR          PIC 99.                           CL**3
  5643         10  WS-FN-MO              PIC 99.                           CL**3
  5644         10  WS-FN-DA              PIC 99.                           CL**3
  5645     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5646     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5647     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5648     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5649     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5650         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5651         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5652         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5653     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5654     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010S.cbl
  5655
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010S.cbl
  5657 01  CPA-STARTS-HERE             PIC X(48)
  5658       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5659                             COPY ELCCALC.
  5660******************************************************************04/15/98
  5661*                                                                *ELCCALC
  5662*                           ELCCALC.                            *    LV003
  5663*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5664*                            VMOD=2.025                          *   CL**3
  5665*                                                                *   CL**2
  5666*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5667*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5668*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5669*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5670*                                                                *   CL**2
  5671*  PASSED TO ELRTRM                                              *   CL**2
  5672*  -----------------                                             *   CL**2
  5673*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5674*  ORIGINAL TERM                                                 *   CL**2
  5675*  BEGINNING DATE                                                *   CL**2
  5676*  ENDING DATE                                                   *   CL**2
  5677*  COMPANY I.D.                                                  *   CL**2
  5678*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5679*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5680*  FREE LOOK DAYS                                                *   CL**2
  5681*                                                                *   CL**2
  5682*  RETURNED FROM ELRTRM                                          *   CL**2
  5683*  ---------------------                                         *   CL**2
  5684*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5685*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5686*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5687*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5688*----------------------------------------------------------------*   CL**2
  5689*  PASSED TO ELRAMT                                              *   CL**2
  5690*  ----------------                                              *   CL**2
  5691*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5692*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5693*  ORIGINAL AMOUNT                                               *   CL**2
  5694*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5695*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5696*  METHOD                                                            CL**2
  5697*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5698*  COMPANY I.D.                                                  *   CL**2
  5699*  BENEFIT TYPE                                                  *   CL**2
  5700*                                                                *   CL**2
  5701*  RETURNED FROM ELRAMT                                          *   CL**2
  5702*  --------------------                                          *   CL**2
  5703*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5704*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5705*  REMAINING AMOUNT FACTOR                                           CL**2
  5706*----------------------------------------------------------------*   CL**2
  5707*  PASSED TO ELRESV                                              *   CL**2
  5708*  -----------------                                             *   CL**2
  5709*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5710*  VALUATION DATE                                                *   CL**2
  5711*  PAID THRU DATE                                                *   CL**2
  5712*  BENEFIT                                                       *   CL**2
  5713*  INCURRED DATE                                                 *   CL**2
  5714*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5715*  ISSUE AGE                                                     *   CL**2
  5716*  TERM                                                          *   CL**2
  5717*  CDT PERCENT                                                   *   CL**2
  5718*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5719* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5720* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5721* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5722*                                                                *   CL**2
  5723*  RETURNED FROM ELRESV                                          *   CL**2
  5724*  --------------------                                          *   CL**2
  5725*  CDT TABLE USED                                                *   CL**2
  5726*  CDT FACTOR USED                                               *   CL**2
  5727*  PAY TO CURRENT RESERVE                                        *   CL**2
  5728*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5729*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5730*----------------------------------------------------------------*   CL**2
  5731*  PASSED TO ELRATE                                              *   CL**2
  5732*  ----------------                                              *   CL**2
  5733*  CERT ISSUE DATE                                               *   CL**2
  5734*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5735*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5736*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5737*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5738*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5739*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5740*  DEVIATION CODE                                                *   CL**2
  5741*  ISSUE AGE                                                     *   CL**2
  5742*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5743*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5744*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  5745*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5746*  A.P.R.                                                        *   CL**2
  5747*  METHOD                                                            CL**2
  5748*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5749*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5750*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5751*  BENEFIT CODE                                                  *   CL**2
  5752*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5753*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  5754*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  5755*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  5756*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  5757*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  5758*                                                                *   CL**2
  5759*  RETURNED FROM ELRATE                                          *   CL**2
  5760*  --------------------                                          *   CL**2
  5761*  CALCULATED PREMIUM                                            *   CL**2
  5762*  PREMIUM RATE                                                  *   CL**2
  5763*  MORTALITY CODE                                                *   CL**2
  5764*  MAX ATTAINED AGE                                              *   CL**2
  5765*  MAX AGE                                                       *   CL**2
  5766*  MAX TERM                                                      *   CL**2
  5767*  MAX MONTHLY BENEFIT                                           *   CL**2
  5768*  MAX TOTAL BENIFIT                                             *   CL**2
  5769*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  5770*----------------------------------------------------------------*   CL**2
  5771*  PASSED TO ELRFND                                              *   CL**2
  5772*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5773*  CERT ISSUE DATE                                               *   CL**2
  5774*  REFUND DATE                                                   *   CL**2
  5775*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  5776*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5777*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5778*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  5779*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5780*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5781*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5782*  DEVIATION CODE                                                *   CL**2
  5783*  ISSUE AGE                                                     *   CL**2
  5784*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5785*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5786*  PROCESS TYPE (CANCEL)                                         *   CL**2
  5787*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5788*  A.P.R.                                                        *   CL**2
  5789*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  5790*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  5791*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5792*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5793*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5794*  BENEFIT CODE                                                  *   CL**2
  5795*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5796*                                                                *   CL**2
  5797*  RETURNED FROM ELRFND                                          *   CL**2
  5798*  --------------------                                          *   CL**2
  5799*  CALCULATED REFUND                                             *   CL**2
  5800*----------------------------------------------------------------*   CL**2
  5801*  PASSED TO ELEARN                                              *   CL**2
  5802*  ----------------                                              *   CL**2
  5803*  CERT ISSUE DATE                                               *   CL**2
  5804*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5805*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  5806*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  5807*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5808*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5809*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5810*  DEVIATION CODE                                                *   CL**2
  5811*  ISSUE AGE                                                     *   CL**2
  5812*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5813*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5814*  A.P.R.                                                        *   CL**2
  5815*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  5816*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5817*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5818*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5819*  BENEFIT CODE                                                  *   CL**2
  5820*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5821*                                                                *   CL**2
  5822*  RETURNED FROM ELEARN                                          *   CL**2
  5823*  --------------------                                          *   CL**2
  5824*  INDICATED  EARNINGS                                           *   CL**2
  5825*----------------------------------------------------------------*   CL**2
  5826*                 LENGTH = 450                                   *   CL**2
  5827*                                                                *   CL**2
  5828******************************************************************   CL**2
  5829******************************************************************
  5830*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5831*
  5832* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5833*-----------------------------------------------------------------
  5834*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5835* EFFECTIVE    NUMBER
  5836*-----------------------------------------------------------------
  5837* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  5838* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5839* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  5840* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  5841* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  5842* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  5843* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  5844* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  5845* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5846* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  5847******************************************************************
  5848                                                                     CL**2
  5849 01  CALCULATION-PASS-AREA.                                          CL**2
  5850     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  5851                                     COMP.                           CL**2
  5852                                                                     CL**2
  5853     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  5854       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  5855       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  5856                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  5857       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  5858       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  5859       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  5860       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  5861       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  5862       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  5863       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  5864       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  5865       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  5866       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  5867       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  5868       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  5869       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  5870       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  5871       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  5872       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  5873       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  5874                                                                     CL**2
  5875     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  5876       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  5877***********************  INPUT AREAS ****************************    CL**2
  5878                                                                     CL**2
  5879     12  CP-CALCULATION-AREA.                                        CL**2
  5880         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  5881         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  5882         16  CP-VALUATION-DT       PIC XX.                           CL**2
  5883         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  5884         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  5885           88  CP-AH                               VALUE 'A' 'D'     CL**2
  5886                                                   'I' 'U'.          CL**2
  5887           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  5888           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5889         16  CP-INCURRED-DT        PIC XX.                           CL**2
  5890         16  CP-REPORTED-DT        PIC XX.                           CL**2
  5891         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  5892         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  5893         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  5894                                     COMP-3.                         CL**2
  5895         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  5896                                     COMP-3.                         CL**2
  5897         16  CP-CDT-METHOD         PIC X.                            CL**2
  5898           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  5899           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  5900           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  5901         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  5902           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  5903           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  5904         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  5905                                     COMP-3.                         CL**2
  5906         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  5907                                     COMP-3.                         CL**2
  5908         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  5909                                     COMP-3.                         CL**2
  5910         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  5911                                     COMP-3.                         CL**2
  5912         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  5913                                     COMP-3.                         CL**2
  5914         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  5915                                     COMP-3.                         CL**2
  5916         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  5917                                     COMP-3.                         CL**2
  5918         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  5919           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  5920           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  5921           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  5922           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  5923           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  5924           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  5925           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  5926         16  CP-EARNING-METHOD     PIC X.                            CL**2
  5927           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  5928           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  5929           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  5930           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  5931           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  5932           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  5933           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  5934           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  5935           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  5936           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  5937           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  5938           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  5939           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  5940           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  5941         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  5942           88  CP-CLAIM                            VALUE '1'.        CL**2
  5943           88  CP-CANCEL                           VALUE '2'.        CL**2
  5944           88  CP-ISSUE                            VALUE '3'.        CL**2
  5945         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  5946           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5947           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  5948           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  5949           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  5950           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  5951           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  5952           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  5953           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  5954           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  5955           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  5956           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  5957           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  5958           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  5959           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  5960           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  5961           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  5962           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  5963           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  5964                                                     'W' 'X'.        CL**2
  5965           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  5966           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  5967           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  5968           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  5969           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  5970           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  5971           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  5972           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  5973           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  5974           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  5975           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  5976           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  5977           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  5978                                                                     CL**2
  5979         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  5980                                     COMP-3.                         CL**2
  5981         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  5982         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  5983         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  5984         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  5985         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  5986           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  5987               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  5988         16  CP-R78-OPTION         PIC X.                            CL**2
  5989           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  5990           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  5991                                                                     CL**2
  5992         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  5993         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  5994         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  5995         16  CP-RATE-FILE          PIC X.                            CL**2
  5996         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  5997                                     COMP-3.                         CL**2
  5998                                                                     CL**2
  5999         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6000         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6001                                                                     CL**2
  6002         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6003                                     COMP-3.
  6004         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6005                                   PIC S9(5)V99 COMP-3.
  6006         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6007                                     COMP-3.                         CL**2
  6008         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6009                                     COMP-3.                         CL**2
  6010         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6011                                     COMP-3.
  6012         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6013                                  PIC S9(7)V99 COMP-3.
  6014                                                                     CL**2
  6015         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6016         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6017         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6018           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6019           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6020           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6021           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6022         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6023         16  CP-CARRIER            PIC X.                            CL**2
  6024         16  CP-REIN-FLAG          PIC X.                            CL**2
  6025         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6026           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6027                      '2' '3' '4' '5'.                               CL**2
  6028           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6029           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6030           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6031           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6032           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6033           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6034           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6035           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6036         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6037         16  CP-RATING-METHOD      PIC X.                            CL**2
  6038           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6039           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6040           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6041           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6042           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6043           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6044           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6045           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6046           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6047         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6048                                     COMP-3.                         CL**2
  6049         16  CP-BEN-CATEGORY       PIC X.
  6050         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6051         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6052                                   PIC S99V9(5) COMP-3.
  6053         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6054         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6055                                   PIC S99V9(5) COMP-3.
  6056         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6057         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6058         16  CP-EXPIRE-DT          PIC XX.
  6059         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6060         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6061         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6062         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6063         16  CP-DDF-SPEC-CALC      PIC X.
  6064             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6065             88  CP-CALC-CLP              VALUE 'C'.
  6066         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6067         16  CP-CANCEL-REASON      PIC X.
  6068         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6069         16  CP-PMT-MODE           PIC X.
  6070         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6071         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6072         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6073         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6074         16  FILLER                PIC X.
  6075                                                                     CL**2
  6076***************    OUTPUT FROM ELRESV   ************************     CL**2
  6077                                                                     CL**2
  6078         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6079                                                                     CL**2
  6080         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6081                                     COMP-3.                         CL**2
  6082         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6083                                     COMP-3.                         CL**2
  6084         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6085                                     COMP-3.                         CL**2
  6086         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6087                                     COMP-3.                         CL**2
  6088         16  FILLER                PIC X(09).                        CL**2
  6089***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6090                                                                     CL**2
  6091         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6092                                     COMP-3.                         CL**2
  6093         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6094                                     COMP-3.                         CL**2
  6095         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6096                                     COMP-3.                         CL**2
  6097         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6098                                     COMP-3.                         CL**2
  6099         16  FILLER                PIC X(12).                        CL**2
  6100                                                                     CL**2
  6101***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6102                                                                     CL**2
  6103         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6104                                     COMP-3.                         CL**2
  6105         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6106                                     COMP-3.                         CL**2
  6107         16  FILLER                PIC X(12).                        CL**2
  6108                                                                     CL**2
  6109***************    OUTPUT FROM ELRATE   *************************    CL**2
  6110                                                                     CL**2
  6111         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6112                                     COMP-3.                         CL**2
  6113         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6114                                     COMP-3.                         CL**2
  6115         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6116         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6117             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6118         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6119                                     COMP-3.                         CL**2
  6120         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6121         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6122         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6123                                   PIC S9(7)V99 COMP-3.
  6124         16  FILLER                PIC X(07).                        CL**2
  6125                                                                     CL**2
  6126***************    OUTPUT FROM ELRFND   *************************    CL**2
  6127                                                                     CL**2
  6128         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6129                                     COMP-3.                         CL**2
  6130         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6131           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6132           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6133           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6134           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6135           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6136           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6137           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6138           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6139           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6140           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6141           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6142           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6143           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6144           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6145         16  FILLER                PIC X(12).                        CL**2
  6146                                                                     CL**2
  6147***************    OUTPUT FROM ELEARN   *************************    CL**2
  6148                                                                     CL**2
  6149         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6150                                     COMP-3.                         CL**2
  6151         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6152                                     COMP-3.                         CL**2
  6153         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6154                                     COMP-3.                         CL**2
  6155         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6156                                     COMP-3.                         CL**2
  6157         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6158                                     COMP-3.                         CL**2
  6159         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6160                                     COMP-3.                         CL**2
  6161         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6162           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6163           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6164           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6165           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6166           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6167           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6168           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6169           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6170           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6171         16  FILLER                PIC X(12).                        CL**2
  6172                                                                     CL**2
  6173***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6174                                                                     CL**2
  6175         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6176                                     COMP-3.                         CL**2
  6177         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6178                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6179         16  FILLER                PIC X(12).                        CL**2
  6180                                                                     CL**2
  6181***************   MISC WORK AREAS    *****************************   CL**2
  6182         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6183                                     COMP-3.                         CL**2
  6184         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6185                                     COMP-3.                         CL**2
  6186         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6187                                     COMP-3.                         CL**2
  6188         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6189                                     COMP-3.                         CL**2
  6190         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6191                                     COMP-3.                         CL**2
  6192         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6193                                     COMP-3.                         CL**2
  6194         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6195             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6196             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6197             88  IO-ERROR                         VALUE 'E'.         CL**2
  6198                                                                     CL**2
  6199         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6200                                                                     CL**2
  6201         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6202                                                                     CL**2
  6203         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6204                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6205                                     COMP-3.                         CL**2
  6206                                                                     CL**2
  6207         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6208                                                                     CL**2
  6209         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6210                                     COMP-3.                         CL**2
  6211                                                                     CL**2
  6212         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6213                                     COMP-3.                         CL**2
  6214                                                                     CL**2
  6215         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6216                                     COMP-3.                         CL**2
  6217                                                                     CL**2
  6218         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6219                                     COMP-3.                         CL**2
  6220                                                                     CL**2
  6221         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6222                                     COMP-3.                         CL**2
  6223                                                                     CL**2
  6224         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6225                                     COMP-3.                         CL**2
  6226                                                                     CL**2
  6227         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6228                                     COMP-3.                         CL**2
  6229                                                                     CL**2
  6230         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6231             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6232                                                                     CL**2
  6233         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6234                                     COMP-3.                         CL**2
  6235         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6236                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6237         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6238         16  cp-extra-periods      pic 9 value zeros.
  6239         16  cp-net-only-state     pic x value spaces.
  6240         16  FILLER                PIC X(13).                        CL**2
  6241******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010S.cbl
* 6243                             COPY ELCDTECX.
  6244******************************************************************06/05/98
  6245*                                                                *ELCDTECX
  6246*                            ELCDTECX.                           *   LV005
  6247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6248*                            VMOD=2.015                          *ELCDTECX
  6249*                                                                *ELCDTECX
  6250*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6251*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6252*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6253*                                                                *ELCDTECX
  6254******************************************************************ELCDTECX
  6255******************************************************************
  6256*                   C H A N G E   L O G
  6257*
  6258* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6259*-----------------------------------------------------------------
  6260*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6261* EFFECTIVE    NUMBER
  6262*-----------------------------------------------------------------
  6263* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6264*                                  BENEFIT CODES FROM 300 TO 900
  6265* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6266* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6267* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6268******************************************************************
  6269 01  DATE-CARD.                                                   ELCDTECX
  6270     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6271     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6272     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6273     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6274     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6275     12  EP-SW                       PIC  X.                      ELCDTECX
  6276         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6277     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6278         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6279     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6280     12  RUN-CENTURY.                                             ELCDTECX
  6281         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6282     12  FILLER                      PIC  X.                         CL**4
  6283     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6284     12  FILLER                      PIC  XXX.                    ELCDTECX
  6285     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6286                                                                  ELCDTECX
  6287 01  FILLER                          PIC  X(7)                       CL**6
  6288                                          VALUE 'OPTIONS'.        ELCDTECX
  6289 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6290     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6291     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6292     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6293         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6294         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6295     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6296     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6297     12  FILLER                      PIC  X.                      ELCDTECX
  6298     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6299     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6300     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6301     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6302     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6303     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6304     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6305     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6306     12  FILLER                      PIC  X.                      ELCDTECX
  6307     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6308     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6309     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6310     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6311     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6312     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6313     12  FILLER                      PIC  X.                      ELCDTECX
  6314     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6315     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6316     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6317     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6318     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6319     12  DTE-R78                     PIC  X.                      ELCDTECX
  6320     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6321     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6322     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6323     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6324     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6325     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6326     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6327                                     PIC  X.                      ELCDTECX
  6328         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6329                                                 ' '.             ELCDTECX
  6330         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6331         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6332     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6333         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6334         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6335     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6336     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6337                                     PIC  9.                         CL**4
  6338     12  DTE-SYSTEM.                                              ELCDTECX
  6339         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6340         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6341         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6342         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6343         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6344         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6345         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6346         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6347         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6348         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6349         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6350         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6351         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6352         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6353         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6354         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6355         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6356         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6357         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6358         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6359         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6360         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6361         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6362         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6363         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6364         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6365     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6366         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6367                                     PIC  X.                      ELCDTECX
  6368     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6369                                                                  ELCDTECX
  6370 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6371     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6372     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6373     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6374*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6375     12  FILLER                      PIC  X.                      ELCDTECX
  6376     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6377     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6378     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6379     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6380     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6381     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6382     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6383                                                                  ELCDTECX
  6384     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6385     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6386     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6387     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6388                                                                  ELCDTECX
  6389     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6390     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6391     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6392     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6393                                                                  ELCDTECX
  6394     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6395     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6396                                                                  ELCDTECX
  6397     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6398     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6399                                                                  ELCDTECX
  6400     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6401                                                                  ELCDTECX
  6402 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6403     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6404     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6405     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6406     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6407     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6408     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6409     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6410                                                                  ELCDTECX
  6411 01  FILLER                          PIC  X(12)                   ELCDTECX
  6412                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6413 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6414     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6415         16  CNT-ID                  PIC  X.                      ELCDTECX
  6416         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6417                                                                  ELCDTECX
  6418 01  FILLER                          PIC  X(11)                   ELCDTECX
  6419                                          VALUE 'STATE NAMES'.    ELCDTECX
  6420 01  STATE-NAMES.                                                 ELCDTECX
  6421     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6422         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6423         16  STATE-PIC1.                                          ELCDTECX
  6424             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6425             20  FILLER              PIC  XXX.                    ELCDTECX
  6426             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6427             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6428             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6429             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6430                                                                  ELCDTECX
  6431 01  FILLER                          PIC  X(13)                   ELCDTECX
  6432                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6433 01  CARRIER-NAMES.                                               ELCDTECX
  6434     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6435         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6436         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6437         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6438         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6439         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6440         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6441*        16  FILLER                  PIC  X.                      ELCDTECX
  6442         16  CARRIER-SEC-PAY         PIC  X.
  6443             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6444                                                                  ELCDTECX
  6445 01  FILLER                          PIC  X(9)                       CL**6
  6446                                          VALUE 'INS TYPES'.      ELCDTECX
  6447 01  CLAS-INS-TYPES.                                              ELCDTECX
  6448*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6449     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6450         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6451         16  CLAS-I-AB3.                                          ELCDTECX
  6452             20  FILLER              PIC  X.                      ELCDTECX
  6453             20  CLAS-I-AB2.                                      ELCDTECX
  6454                 24  FILLER          PIC  X.                      ELCDTECX
  6455                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6456         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6457             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6458             20  FILLER              PIC  X.                         CL**4
  6459         16  CLAS-I-AB10.                                         ELCDTECX
  6460             20  FILLER              PIC  X(9).                   ELCDTECX
  6461             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6462         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6463         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6464         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6465         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6466             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6467         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6468         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6469         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6470         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6471         16  CLAS-I-REFUND-METHOD    PIC  X.
  6472         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6473         16  FILLER                  PIC  XXX.
  6474                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6475 01  FILLER                          PIC  X(16)                   ELCDTECX
  6476                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6477 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6478     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6479                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6480         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6481         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6482         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6483         16  CLAS-MORT-DESC.                                      ELCDTECX
  6484             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6485             20  FILLER              PIC  XX.                        CL**5
  6486             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6487             20  FILLER              PIC  X.                         CL**5
  6488             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6489             20  FILLER              PIC  X.                         CL**5
  6490             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6491             20  FILLER              PIC  X.                         CL**5
  6492             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6493             20  FILLER              PIC  X(5).                      CL**6
  6494                                                                  ELCDTECX
  6495 01  FILLER                          PIC  X(15)                   ELCDTECX
  6496                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6497 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6498     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6499         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6500         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6501         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6502         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6503         16  FILLER                  PIC  X(4).                      CL**6
  6504                                                                  ELCDTECX
  6505 01  FILLER                          PIC  X(7)                       CL**6
  6506                                     VALUE 'INDEXES'.             ELCDTECX
  6507 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6508     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6509     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6510     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6511     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6512     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6513     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6514     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6515     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6516     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6517     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6518     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6519     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6520     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6521     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6522     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6523     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6524     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6525                                                                  ELCDTECX
  6526 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6527     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6528     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6529     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6530     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6531     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6532     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6533     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6534     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6535     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6536     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6537     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6538                                                                  ELCDTECX
  6539 01  FILLER                          PIC  X(13)                   ELCDTECX
  6540                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6541 01  CLAS-MISC.                                                   ELCDTECX
  6542     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6543         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6544         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6545         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6546     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6547     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6548     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6549     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6550     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6551     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6552     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6553     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6554     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6555     12  STATE-L                     PIC  XX.                     ELCDTECX
  6556     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6557     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6558     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6559         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6560         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6561     12  DTE-ABEND-WORK.                                          ELCDTECX
  6562         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6563         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6564                                                                  ELCDTECX
  6565 01  FILLER                          PIC  X(12)                   ELCDTECX
  6566                                     VALUE 'WORKING DATE'.        ELCDTECX
  6567 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6568     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6569         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6570         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6571         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6572     12  WS-CURRENT-DATE.                                         ELCDTECX
  6573         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6574         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6575         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6576         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6577         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6578     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6579         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6580         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6581                                                                  ELCDTECX
  6582 01  FILLER                          PIC  X(12)                   ELCDTECX
  6583                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6584 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6585     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6586         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6587         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6588         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6589                                                                  ELCDTECX
  6590 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6591                                     VALUE 'STATE TLRS'.          ELCDTECX
  6592 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6593     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6594         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6595         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6596                                                                  ELCDTECX
  6597 01  FILLER                          PIC  X(13)                   ELCDTECX
  6598                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6599 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6600     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6601         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6602                                                                  ELCDTECX
  6603 01  FILLER                          PIC  X(13)                   ELCDTECX
  6604                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6605 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6606     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6607     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6608     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6609                                     PIC  X.                         CL**5
  6610     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6611     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6612     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6613     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6614     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6615     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6616     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6617     12  FILLER                      PIC  X(75).                  ELCDTECX
  6618******************************************************************ELCDTECX
  6619*01  MISC-CARR-PCT-DATA.                                          00001521
  6620*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6621*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6622*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6623*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6624*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6625*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6626******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010S.cbl
* 6628                             COPY ELCDTEVR.
  6629***************************************************************** 04/15/98
  6630*                                                                *ELCDTEVR
  6631*                                                                *ELCDTEVR
  6632*                            ELCDTEVR.                           *   LV003
  6633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6634*                            VMOD=2.001                          *   CL**2
  6635*                                                                *ELCDTEVR
  6636*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6637*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6638*                                                                *ELCDTEVR
  6639******************************************************************ELCDTEVR
  6640 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6641     05  WS-RUN-DATE.                                             ELCDTEVR
  6642         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6643         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6644         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6645             15  RUN-CC              PIC  99.                     ELCDTEVR
  6646             15  RUN-YR              PIC  99.                     ELCDTEVR
  6647         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6648         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6649     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6650            WS-RUN-DATE              PIC 9(11).                      CL**2
  6651     05  WS-EP-DT.                                                ELCDTEVR
  6652         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6653         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6654         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6655             15  EP-CC               PIC  99.                     ELCDTEVR
  6656             15  EP-YR               PIC  99.                     ELCDTEVR
  6657         10  EP-MO                   PIC  99.                     ELCDTEVR
  6658         10  EP-DA                   PIC  99.                     ELCDTEVR
  6659     05  WS-EP-DT-N REDEFINES                                        CL**2
  6660            WS-EP-DT                 PIC 9(11).                      CL**2
  6661     05  WS-DTE-CONV-DT.                                             CL**4
  6662         10  FILLER                  PIC  9(03).                     CL**4
  6663         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6664         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6665             15  DTE-CONV-CC         PIC  99.                        CL**4
  6666             15  DTE-CONV-YR         PIC  99.                        CL**4
  6667         10  DTE-CONV-MO             PIC  99.                        CL**4
  6668         10  DTE-CONV-DA             PIC  99.                        CL**4
  6669     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6670            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6671 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6672     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6673         10  FILLER                            PIC 999.           ELCDTEVR
  6674         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6675         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6676             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6677             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6678         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6679         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6680     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6681            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6682     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6683         10  FILLER                            PIC 999.           ELCDTEVR
  6684         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6685         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6686         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6687         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6688     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6689            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6690 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6691     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6692         10  FILLER                            PIC 999.           ELCDTEVR
  6693         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6694         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6695             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6696             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6697         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6698         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6699     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6700            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6701     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6702         10  FILLER                            PIC 999.           ELCDTEVR
  6703         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6704         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6705             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6706             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6707         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6708         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6709     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6710            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6711     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6712         10  FILLER                            PIC 999.           ELCDTEVR
  6713         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6714         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6715             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6716             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6717         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6718         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6719     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6720            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6721 01  WS-RATE-RECORD.                                              ELCDTEVR
  6722         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6723             10  FILLER                        PIC 999.           ELCDTEVR
  6724             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6725             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6726                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6727                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6728             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6729             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6730         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6731                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010S.cbl
* 6733                             COPY ELCACCTV.
  6734******************************************************************04/14/98
  6735*                                                                *ELCACCTV
  6736*                            ELCACCTV                            *   LV002
  6737*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6738*                            VMOD=2.001                          *ELCACCTV
  6739*                                                                *ELCACCTV
  6740*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6741*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6742*                                                                *ELCACCTV
  6743*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  6744*                                                                *ELCACCTV
  6745******************************************************************ELCACCTV
  6746                                                                  ELCACCTV
  6747 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  6748                                                                  ELCACCTV
  6749     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  6750         10  FILLER            PIC 999.                           ELCACCTV
  6751         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  6752         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  6753             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  6754             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  6755         10  AM-EXP-MO         PIC 99.                               CL**5
  6756         10  AM-EXP-DA         PIC 99.                               CL**5
  6757     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  6758            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  6759     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  6760         10  FILLER                    PIC 999.                   ELCACCTV
  6761         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  6762         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  6763             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  6764             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  6765         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  6766         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  6767     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  6768            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  6769     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  6770         10  FILLER                    PIC 999.                   ELCACCTV
  6771         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  6772         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  6773             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  6774             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  6775         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  6776         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  6777     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  6778            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  6779     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  6780         10 FILLER                     PIC 999.                   ELCACCTV
  6781         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  6782         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  6783            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  6784            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  6785         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  6786         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  6787     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  6788            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  6789     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  6790         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  6791         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  6792         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  6793            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  6794            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  6795         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  6796         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  6797     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  6798            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  6799     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  6800         10  FILLER                    PIC 999.                   ELCACCTV
  6801         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  6802         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  6803             15  AM-AN-CC              PIC 99.                    ELCACCTV
  6804             15  AM-AN-YR              PIC 99.                    ELCACCTV
  6805         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  6806         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  6807     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  6808            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  6809     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  6810         10  FILLER                    PIC 999.                   ELCACCTV
  6811         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  6812         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  6813             15  AM-HI-CC              PIC 99.                    ELCACCTV
  6814             15  AM-HI-YR              PIC 99.                    ELCACCTV
  6815         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  6816         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  6817     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  6818            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  6819     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  6820         10  FILLER                    PIC 999.                   ELCACCTV
  6821         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  6822         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  6823             15  AM-LO-CC              PIC 99.                    ELCACCTV
  6824             15  AM-LO-YR              PIC 99.                    ELCACCTV
  6825         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  6826         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  6827     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  6828            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  6829     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  6830         10  FILLER                    PIC 999.                   ELCACCTV
  6831         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  6832         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  6833             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  6834             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  6835         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  6836         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  6837     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  6838            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010S.cbl
* 6840                             COPY ELCEXTVR.
  6841******************************************************************04/15/98
  6842*                                                                *ELCEXTVR
  6843*                                                                *ELCEXTVR
  6844*                             ELCEXTVR                           *   LV002
  6845*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6846*                            VMOD=2.001                          *ELCEXTVR
  6847*                                                                *ELCEXTVR
  6848*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  6849*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  6850*                                                                *ELCEXTVR
  6851******************************************************************ELCEXTVR
  6852 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  6853     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  6854         10  FILLER              PIC 999.                         ELCEXTVR
  6855         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  6856         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  6857             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  6858             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  6859         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  6860         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  6861     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  6862            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  6863 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  6864     05  WS-DE-EFF.                                               ELCEXTVR
  6865         10  FILLER              PIC 999.                         ELCEXTVR
  6866         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  6867         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  6868             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  6869             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  6870         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  6871         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  6872     05  WS-DE-EFF-N REDEFINES                                       CL**2
  6873            WS-DE-EFF            PIC 9(11).                          CL**2
  6874     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  6875         10  FILLER              PIC 999.                         ELCEXTVR
  6876         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  6877         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  6878             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  6879             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  6880         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  6881         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  6882     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  6883            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  6884     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  6885         10  FILLER                 PIC 999.                      ELCEXTVR
  6886         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  6887         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  6888             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  6889             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  6890         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  6891         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  6892     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  6893            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  6894     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  6895         10  FILLER                 PIC 999.                      ELCEXTVR
  6896         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  6897         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  6898             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  6899             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  6900         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  6901         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  6902     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  6903            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  6904     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  6905         10  FILLER                 PIC 999.                      ELCEXTVR
  6906         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  6907         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  6908             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  6909             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  6910         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  6911         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  6912     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  6913            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  6914     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  6915         10  FILLER                 PIC 999.                      ELCEXTVR
  6916         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  6917         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  6918             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  6919             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  6920         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  6921         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  6922     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  6923            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  6924     05  WS-DE-PROC-DT.                                           ELCEXTVR
  6925         10  FILLER                 PIC 999.                      ELCEXTVR
  6926         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  6927         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  6928             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  6929             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  6930         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  6931         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  6932     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  6933            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  6934     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  6935         10  FILLER                 PIC 999.                         CL**5
  6936         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  6937         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  6938             15  DE-CP-CC           PIC 99.                          CL**5
  6939             15  DE-CP-YR           PIC 99.                          CL**5
  6940         10  DE-CP-MO               PIC 99.                          CL**5
  6941         10  DE-CP-DA               PIC 99.                          CL**5
  6942     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  6943            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  6944     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  6945         10  FILLER                 PIC 999.                         CL**5
  6946         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  6947         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  6948             15  DE-RP-CC           PIC 99.                          CL**5
  6949             15  DE-RP-YR           PIC 99.                          CL**5
  6950         10  DE-RP-MO                      PIC 99.                   CL**5
  6951         10  DE-RP-DA                      PIC 99.                   CL**5
  6952     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  6953            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  6954     05  WS-DE-INCUR.                                             ELCEXTVR
  6955         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  6956         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  6957         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  6958             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  6959             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  6960         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  6961         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  6962     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  6963            WS-DE-INCUR             PIC 9(11).                       CL**2
  6964     05  WS-DE-PAY.                                               ELCEXTVR
  6965         10  FILLER                 PIC 999.                      ELCEXTVR
  6966         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  6967         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  6968             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  6969             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  6970         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  6971         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  6972     05  WS-DE-PAY-N REDEFINES                                       CL**2
  6973            WS-DE-PAY               PIC 9(11).                       CL**2
  6974     05  WS-DE-PAID-TO.                                           ELCEXTVR
  6975         10  FILLER                 PIC 999.                      ELCEXTVR
  6976         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  6977         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  6978             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  6979             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  6980         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  6981         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  6982     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  6983            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  6984     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  6985         10 FILLER                  PIC 999.                      ELCEXTVR
  6986         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  6987         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  6988            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  6989            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  6990         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  6991         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  6992     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  6993            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  6994     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  6995         10 FILLER                  PIC 999.                      ELCEXTVR
  6996         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  6997         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  6998            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  6999            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7000         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7001         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7002     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7003            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7004     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7005         10  FILLER                 PIC 999.                      ELCEXTVR
  7006         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7007         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7008             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7009             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7010         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7011         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7012     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7013            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7014     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7015         10  FILLER                 PIC 999.                      ELCEXTVR
  7016         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7017         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7018             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7019             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7020         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7021         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7022     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7023            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7024     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7025         10  FILLER                        PIC 999.               ELCEXTVR
  7026         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7027         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7028                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7029             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7030             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7031         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7032         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7033     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7034            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7035     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7036         10  FILLER                        PIC 999.               ELCEXTVR
  7037         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7038         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7039                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7040             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7041             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7042         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7043         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7044     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7045            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7046                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010S.cbl
  7048 PROCEDURE DIVISION.
  7049
  7050 0000-START.
  7051
  7052******************************************************************
  7053***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7054******************************************************************
  7055
  7056*0003-LOAD-DATE-CARD.
* 7057                             COPY ELCDTERX.
  7058******************************************************************04/15/98
  7059*                                                                *ELCDTERX
  7060*                                                                *ELCDTERX
  7061*                            ELCDTERX.                           *   LV002
  7062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7063*                            VMOD=2.007                          *ELCDTERX
  7064*                                                                *ELCDTERX
  7065*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7066*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7067*      = ELCDTEFD)                                               *ELCDTERX
  7068*                                                                *ELCDTERX
  7069******************************************************************ELCDTERX
  7070                                                                  ELCDTERX
  7071     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7072                                                                  ELCDTERX
  7073     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7074     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7075     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7076                                                                  ELCDTERX
  7077     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7078                                                                  ELCDTERX
  7079******************************************************************ELCDTERX
  7080*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7081*          WARNING MESSAGES.                                      ELCDTERX
  7082******************************************************************ELCDTERX
  7083     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7084         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7085                                                                  ELCDTERX
  7086     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7087                                                                  ELCDTERX
  7088     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7089                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7090                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7091                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7092                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7093                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7094                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7095                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7096                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7097                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7098                                                                  ELCDTERX
  7099     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7100                                                                  ELCDTERX
  7101     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7102                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7103                                                                  ELCDTERX
  7104     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7105     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7106     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7107     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7108                                                                  ELCDTERX
  7109     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7110         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7111     ELSE                                                         ELCDTERX
  7112         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7113                                                                  ELCDTERX
  7114     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7115         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7116     ELSE                                                         ELCDTERX
  7117         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7118                                                                  ELCDTERX
  7119 0005-READ--CARD.                                                 ELCDTERX
  7120     READ DISK-DATE                                               ELCDTERX
  7121         AT END CLOSE DISK-DATE                                   ELCDTERX
  7122             GO TO 0060-READ--TEST.                               ELCDTERX
  7123                                                                  ELCDTERX
  7124     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7125                                                                  ELCDTERX
  7126     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7127         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7128         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7129         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7130         GO TO 0005-READ--CARD.                                   ELCDTERX
  7131                                                                  ELCDTERX
  7132     IF DD-ID = 'CLAD'                                            ELCDTERX
  7133         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7134         GO TO 0005-READ--CARD.                                   ELCDTERX
  7135                                                                  ELCDTERX
  7136     IF DD-ID = 'CLAX'                                            ELCDTERX
  7137         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7138         GO TO 0005-READ--CARD.                                   ELCDTERX
  7139                                                                  ELCDTERX
  7140     IF DD-ID = 'CLAF'                                            ELCDTERX
  7141         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7142         GO TO 0005-READ--CARD.                                   ELCDTERX
  7143                                                                  ELCDTERX
  7144     IF DD-ID = 'CLAC'                                            ELCDTERX
  7145         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7146                                                                  ELCDTERX
  7147     IF DD-ID = 'CARR'                                            ELCDTERX
  7148         GO TO 0015-READ--CARR.                                   ELCDTERX
  7149                                                                  ELCDTERX
  7150     IF DD-ID = 'STAT'                                            ELCDTERX
  7151         GO TO 0020-READ--STAT.                                   ELCDTERX
  7152                                                                  ELCDTERX
  7153     IF DD-ID = 'BUSC'                                            ELCDTERX
  7154         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7155                                                                  ELCDTERX
  7156     IF DD-ID = 'MORT'                                            ELCDTERX
  7157         GO TO 0030-READ--MORT.                                   ELCDTERX
  7158                                                                  ELCDTERX
  7159     IF DD-ID = 'CLAI'                                            ELCDTERX
  7160         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7161                                                                  ELCDTERX
  7162     IF DD-ID = 'COLC'                                            ELCDTERX
  7163         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7164                                                                  ELCDTERX
  7165     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7166        DD-IDA = 'CL'                                             ELCDTERX
  7167         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7168                                                                  ELCDTERX
  7169     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7170        DD-IDA = 'PO'                                             ELCDTERX
  7171         GO TO 0050-READ--POXX.                                   ELCDTERX
  7172                                                                  ELCDTERX
  7173     IF DD-ID = 'OPCA'                                            ELCDTERX
  7174         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7175                                                                  ELCDTERX
  7176     IF DD-ID = 'OPST'                                            ELCDTERX
  7177         GO TO 0072-READ--OPST.                                   ELCDTERX
  7178                                                                  ELCDTERX
  7179     IF DD-ID = 'OPBS'                                            ELCDTERX
  7180         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7181                                                                  ELCDTERX
  7182     IF DD-ID = 'OPMS'                                            ELCDTERX
  7183         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7184                                                                  ELCDTERX
  7185     GO TO 0005-READ--CARD.                                       ELCDTERX
  7186                                                                  ELCDTERX
  7187 0010-READ--CLAC.                                                 ELCDTERX
  7188     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7189     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7190     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7191     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7192     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7193     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7194     GO TO 0005-READ--CARD.                                       ELCDTERX
  7195                                                                  ELCDTERX
  7196 0015-READ--CARR.                                                 ELCDTERX
  7197     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7198     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7199        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7200        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7201        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7202        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7203        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7204        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7205        MOVE DD-CARR1-SECPAY-SW
  7206                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7207     END-IF
  7208                                                                  ELCDTERX
  7209     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7210     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7211        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7212        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7213        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7214        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7215        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7216        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7217        MOVE DD-CARR2-SECPAY-SW
  7218                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7219     END-IF
  7220                                                                  ELCDTERX
  7221                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7222     GO TO 0005-READ--CARD.                                       ELCDTERX
  7223                                                                  ELCDTERX
  7224 0020-READ--STAT.                                                 ELCDTERX
  7225     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7226     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7227        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7228         GO TO 0005-READ--CARD.                                   ELCDTERX
  7229                                                                  ELCDTERX
  7230     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7231     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7232     GO TO 0020-READ--STAT.                                       ELCDTERX
  7233                                                                  ELCDTERX
  7234 0025-READ--BUSC.                                                 ELCDTERX
  7235     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7236     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7237        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7238         GO TO 0005-READ--CARD.                                   ELCDTERX
  7239                                                                  ELCDTERX
  7240     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7241     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7242     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7243                                                                  ELCDTERX
  7244 0030-READ--MORT.                                                 ELCDTERX
  7245     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7246     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7247        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7248         GO TO 0005-READ--CARD.                                   ELCDTERX
  7249                                                                  ELCDTERX
  7250     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7251     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7252     GO TO 0030-READ--MORT.                                       ELCDTERX
  7253                                                                  ELCDTERX
  7254 0035-READ--CLXX.                                                 ELCDTERX
  7255     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7256          GO TO 0005-READ--CARD.                                  ELCDTERX
  7257                                                                  ELCDTERX
  7258     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7259         DISPLAY '***********************************************'ELCDTERX
  7260         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7261         DISPLAY '***********************************************'ELCDTERX
  7262         GO TO 0055-READ--STOP.                                   ELCDTERX
  7263                                                                  ELCDTERX
  7264     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7265        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7266         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7267                                                                  ELCDTERX
  7268     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7269        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7270         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7271                                                                  ELCDTERX
  7272*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7273     GO TO 0005-READ--CARD.                                       ELCDTERX
  7274                                                                  ELCDTERX
  7275 0040-READ--CLAI.                                                 ELCDTERX
  7276     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7277     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7278        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7279         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7280                                                                  ELCDTERX
  7281     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7282     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7283     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7284                                                                  ELCDTERX
  7285 0045-READ--DUMP.                                                 ELCDTERX
  7286     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7287     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7288                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7289     PERFORM ABEND-PGM.                                           ELCDTERX
  7290                                                                  ELCDTERX
  7291 0050-READ--POXX.                                                 ELCDTERX
  7292     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7293         GO TO 0005-READ--CARD.                                   ELCDTERX
  7294                                                                  ELCDTERX
  7295     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7296         DISPLAY '***********************************************'ELCDTERX
  7297         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7298         DISPLAY '***********************************************'ELCDTERX
  7299         GO TO 0055-READ--STOP.                                   ELCDTERX
  7300                                                                  ELCDTERX
  7301     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7302     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7303     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7304     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7305                                                                  ELCDTERX
  7306     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7307         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7308     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7309         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7310                                                                  ELCDTERX
  7311     GO TO 0005-READ--CARD.                                       ELCDTERX
  7312                                                                  ELCDTERX
  7313 0055-READ--STOP.                                                 ELCDTERX
  7314     GOBACK.                                                      ELCDTERX
  7315                                                                  ELCDTERX
  7316 0060-READ--TEST.                                                 ELCDTERX
  7317     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7318        CLAX-ID         = SPACE  OR                               ELCDTERX
  7319        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7320         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7321                                                                  ELCDTERX
  7322     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7323     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7324                                                                  ELCDTERX
  7325 0065-READ--COLC.                                                 ELCDTERX
  7326     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7327     GO TO 0005-READ--CARD.                                       ELCDTERX
  7328                                                                  ELCDTERX
  7329 0070-READ--OPCA.                                                 ELCDTERX
  7330                                                                  ELCDTERX
  7331     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7332                                                                  ELCDTERX
  7333     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7334             OR                                                   ELCDTERX
  7335         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7336         GO TO 0005-READ--CARD.                                   ELCDTERX
  7337                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7338     ADD 1                       TO INDEXCA.                      ELCDTERX
  7339     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7340                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7341     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7342                                                                  ELCDTERX
  7343 0072-READ--OPST.                                                 ELCDTERX
  7344                                                                  ELCDTERX
  7345     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7346                                                                  ELCDTERX
  7347     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7348             OR                                                   ELCDTERX
  7349         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7350         GO TO 0005-READ--CARD.                                   ELCDTERX
  7351                                                                  ELCDTERX
  7352     ADD 1                       TO INDEXST.                      ELCDTERX
  7353     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7354                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7355     GO TO 0072-READ--OPST.                                       ELCDTERX
  7356                                                                  ELCDTERX
  7357 0074-READ--OPBS.                                                 ELCDTERX
  7358                                                                  ELCDTERX
  7359     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7360                                                                  ELCDTERX
  7361     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7362             OR                                                   ELCDTERX
  7363         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7364         GO TO 0005-READ--CARD.                                   ELCDTERX
  7365                                                                  ELCDTERX
  7366     ADD 1                       TO INDEXBS.                      ELCDTERX
  7367     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7368     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7369                                                                  ELCDTERX
  7370 0079-READ--EXIT.                                                 ELCDTERX
  7371*    EXIT.                                                        ELCDTERX
  7372******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010S.cbl
  7374******************************************************************
  7375***           O P E N   F I L E S   R O U T I N E              ***
  7376******************************************************************
  7377
  7378     DISPLAY ' '.
  7379     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7380         'ECS010 ******'
  7381     DISPLAY ' '.
  7382
  7383     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7384     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7385     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7386     .
  7387 0080-OPEN-FILES.
  7388*    IF DTE-PGM-OPT = '1'
  7389*       open output detail-extr
  7390*    end-if
  7391     OPEN INPUT  PENDING-EXTRACT
  7392                 CERT-MASTER-IN
  7393                 ERACCTT-IN
  7394
  7395          I-O    ERMEBL-INOUT
  7396
  7397          OUTPUT SUMMARY-EXTR
  7398                 ME-ECS010-BALANCE
  7399                 ME50-ECS010-BALANCE
  7400                 DISPLAY-PRT
  7401                 MISMATCH-REPORT
  7402                 PRINT-COPY.
  7403
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010S.cbl
  7405*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7406     IF DTE-CLIENT NOT = 'DMD'
  7407         NEXT SENTENCE
  7408     ELSE
  7409         OPEN INPUT ERRESC-IN
  7410            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7411                NEXT SENTENCE
  7412            ELSE
  7413                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7414                MOVE 'ERROR OPENING ERRESC FILE'
  7415                                        TO WS-ABEND-MESSAGE
  7416                GO TO ABEND-PGM.
  7417*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7418
  7419     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7420         NEXT SENTENCE
  7421       ELSE
  7422         MOVE '11'                    TO ABEND-CODE-1
  7423         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7424         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7425         GO TO ABEND-PGM.
  7426
  7427     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7428         NEXT SENTENCE
  7429       ELSE
  7430         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7431
  7432     IF DTE-PGM-OPT = '1'
  7433         OPEN OUTPUT  CERT-MASTER-OUT
  7434                      DETAIL-EXTR
  7435     ELSE
  7436         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7437         MOVE '*'                     TO TRANS-EOF-FLAG.
  7438
  7439     MOVE 'R'                         TO CP-RATE-FILE.
  7440     MOVE 'O'                         TO CP-IO-FUNCTION.
  7441     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7442     IF IO-ERROR
  7443         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7444                                      TO WS-ABEND-MESSAGE
  7445         MOVE 0302                    TO WS-RETURN-CODE
  7446         GO TO ABEND-PGM.
  7447
  7448******************************************************************
  7449***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7450******************************************************************
  7451
  7452 0090-INITIALIZATION-ROUTINE.
  7453
  7454     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7455     MOVE WS-TIME                     TO ME-START-TIME.
  7456     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7457                                         TR-RN-DT.
  7458     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7459     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7460     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7461     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7462     MOVE COMPANY-NAME                TO TRHDNM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010S.cbl
  7463     MOVE ALPH-DATE                   TO TR-MODAYR.
  7464     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7465     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7466
  7467     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7468     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7469     COMPUTE LYD-MO = LYD-MO - 1.
  7470     IF LYD-MO = ZERO
  7471         MOVE 12                      TO LYD-MO
  7472         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7473
  7474     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7475
  7476
  7477     IF DTE-CLIENT = 'CID'
  7478         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7479         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7480     ELSE
  7481         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7482         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7483     END-IF.
  7484
  7485     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7486         GO TO 0090-CONTINUE.
  7487
  7488     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7489     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7490     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7491     MOVE '6'                    TO DC-OPTION-CODE.
  7492     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7493
  7494     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7495         MOVE '**** WORK DATE CALC ERROR ****'
  7496                                 TO WS-ABEND-MESSAGE
  7497         MOVE '90'               TO ABEND-CODE-1
  7498         MOVE '0'                TO AC2-ONE
  7499         MOVE DC-ERROR-CODE      TO AC2-TWO
  7500         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7501         GO TO ABEND-PGM.
  7502
  7503     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7504
  7505     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7506     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7507
  7508     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7509             VARYING
  7510         SUBM FROM +2 BY +1
  7511             UNTIL
  7512         SUBM GREATER THAN +12.
  7513
  7514     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7515
  7516     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7517             VARYING
  7518         SUBM FROM +1 BY +1
  7519             UNTIL
  7520         SUBM GREATER THAN +13.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010S.cbl
  7521
  7522     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7523*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7524     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7525                                    DC-ELAPSED-MONTHS.
  7526     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7527     MOVE 1                      TO DC-END-OF-MONTH.
  7528     MOVE '6'                    TO DC-OPTION-CODE.
  7529     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7530
  7531     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7532         MOVE '**** CUT OFF DATE ERROR ****'
  7533                                 TO WS-ABEND-MESSAGE
  7534         MOVE '90'               TO ABEND-CODE-1
  7535         MOVE '0'                TO AC2-ONE
  7536         MOVE DC-ERROR-CODE      TO AC2-TWO
  7537         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7538         GO TO ABEND-PGM.
  7539
  7540     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7541     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7542
  7543 0090-CONTINUE.
  7544
  7545     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7546     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7547     MOVE +0                     TO DC-ELAPSED-DAYS.
  7548     MOVE '6'                    TO DC-OPTION-CODE.
  7549     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7550
  7551     IF NO-CONVERSION-ERROR
  7552        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7553
  7554     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7555     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7556     MOVE +0                     TO DC-ELAPSED-DAYS.
  7557     MOVE '6'                    TO DC-OPTION-CODE.
  7558     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7559
  7560     IF NO-CONVERSION-ERROR
  7561        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7562
  7563     MOVE +0                     TO DC-ELAPSED-MONTHS
  7564                                    DC-ELAPSED-DAYS.
  7565
  7566     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7567     MOVE 'CR'                   TO CR-RECORD-ID.
  7568     MOVE ZEROS                  TO
  7569               CR-AGE                  CR-JOINT-AGE
  7570               CR-LFTYP                CR-AHTYP
  7571               CR-LF-TERM              CR-AH-TERM
  7572               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7573               CR-LF-TERM-IN-DAYS
  7574               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7575               CR-LFAMT                CR-AHAMT
  7576               CR-LFPRM                CR-AHPRM
  7577               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7578               CR-LFPRM-CALC           CR-AHPRM-CALC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010S.cbl
  7579               CR-LFPRM-RATE           CR-AHPRM-RATE
  7580               CR-LFAMT-ALT
  7581               CR-LFPRM-ALT            CR-ISS-MICROFILM-NO
*  12-S*********************************************************       (   0)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  7582               CR-LFPRM-CALC-ALT       CR-CAN-MICROFILM-NO
  7583               CR-LFPRM-RATE-ALT
  7584               CR-LFRFND               CR-AHRFND
  7585               CR-LFRFND-CALC          CR-AHRFND-CALC
  7586               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7587               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7588               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7589               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7590               CR-LIVES                CR-APR
  7591               CR-BILLED
  7592               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7593               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7594               CR-PMT-FREQ             CR-LOAN-TERM
  7595               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7596               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7597               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7598               CR-LF-CANC-DT           CR-AH-CANC-DT
  7599               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7600               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7601               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7602               CR-DTH-DT               CR-DIS-DT
  7603               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7604               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7605                                       CR-DIS-PTO-DT
  7606               CR-DTHAMT               CR-DISAMT
  7607               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7608               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7609               CR-DTHEXP               CR-DISEXP
  7610               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7611               CR-DTH-AGE              CR-DAYS-DISAB
  7612               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7613               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7614               CR-INCUR-DISEXP (1)     CR-REMIT-TO
  7615               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7616               CR-MOB-NET-TOT-FEES
  7617               CR-ADDL-CLP.
  7618
  7619     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7620                                       CR-DISAB-DETAIL-DATA (3)
  7621                                       CR-DISAB-DETAIL-DATA (4)
  7622                                       CR-DISAB-DETAIL-DATA (5).
  7623
  7624     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7625
  7626     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7627
  7628     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7629                          EPEC-TOTALS      EPEC-SUBS
  7630                          EPEC-UNDERWRITTEN-TOTALS.
  7631
  7632     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7633                          EPEC-LEVELS-END-II.
  7634     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010S.cbl
  7635                          DUPE-CERT-TABLE.
  7636
  7637     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7638     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7639     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7640                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7641     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7642                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7643
  7644     IF RUN-DATE NOT = EP-DT
  7645         MOVE '*'                     TO TR-YRASK.
  7646     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7647     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7648     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7649     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7650
  7651     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7652         MOVE +1000                   TO DUP-MAX.
  7653
  7654     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7655     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7656     IF ME-DO-UPDATE
  7657         READ ERMEBL-INOUT INVALID KEY
  7658                       CLOSE ERMEBL-INOUT
  7659                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7660
  7661     GO TO 0150-READ-ACCOUNT-MASTER.
  7662
  7663 0090-EXIT.
  7664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010S.cbl
  7666 0095-GET-EOM-DATES.
  7667
  7668     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7669     MOVE '6'                    TO DC-OPTION-CODE.
  7670     MOVE 1                      TO DC-ELAPSED-MONTHS
  7671                                    DC-END-OF-MONTH.
  7672     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7673     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7674
  7675     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7676         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7677                                 TO WS-ABEND-MESSAGE
  7678         MOVE '90'               TO ABEND-CODE-1
  7679         MOVE '0'                TO AC2-ONE
  7680         MOVE DC-ERROR-CODE      TO AC2-TWO
  7681         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7682         GO TO ABEND-PGM.
  7683
  7684     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7685                                     DC-BIN-DATE-1.
  7686     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7687     MOVE ' '                    TO  DC-OPTION-CODE.
  7688     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7689
  7690     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7691         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7692                                 TO WS-ABEND-MESSAGE
  7693         MOVE '90'               TO ABEND-CODE-1
  7694         MOVE '0'                TO AC2-ONE
  7695         MOVE DC-ERROR-CODE      TO AC2-TWO
  7696         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7697         GO TO ABEND-PGM.
  7698
  7699     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7700
  7701 0095-EXIT.
  7702     EXIT.
  7703
  7704 0096-DISPLAY-EOM-DATES.
  7705
  7706     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7707
  7708 0096-EXIT.
  7709     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010S.cbl
  7711******************************************************************
  7712***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7713******************************************************************
  7714
  7715 0100-ACCT-MASTER-READ-ROUTINE.
  7716
  7717     IF EP-FLG = '1'
  7718         ADD +1 TO BC-ACT-ACCTS
  7719         IF  DTE-OPT-RESERVE-METHOD-AUTH
  7720             PERFORM 4700-CALC-OPT-IBNR THRU 4700-EXIT
  7721             PERFORM 4500-BUILD-EPEC-EXTRACT
  7722                                  THRU 4599-BUILD-EPEC-EXTRACT-X
  7723         ELSE
  7724             PERFORM 4500-BUILD-EPEC-EXTRACT
  7725                                  THRU 4599-BUILD-EPEC-EXTRACT-X.
  7726
  7727     IF TRANSACTION-WAS-PROCESSED
  7728         MOVE '1'                     TO ACCT-FLG
  7729                                         STATE-FLG
  7730                                         COMP-FLG
  7731                                         CARR-FLG
  7732                                         FINAL-FLG.
  7733
  7734 0150-READ-ACCOUNT-MASTER.
  7735
  7736     READ ERACCTT-IN AT END
  7737         GO TO 9930-EOJ-3.
  7738
  7739     ADD +1                            TO ERACCTT-READS.
  7740
* 7741     COPY ELCACCTI.
  7742******************************************************************04/14/98
  7743*                                                                *ELCACCTI
  7744*                            ELCACCTI                            *   LV003
  7745*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  7746*                            VMOD=2.001                          *ELCACCTI
  7747*                                                                *ELCACCTI
  7748*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  7749*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  7750*                                                                *ELCACCTI
  7751*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  7752*                                                                *ELCACCTI
  7753******************************************************************ELCACCTI
  7754     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  7755     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  7756     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  7757     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  7758     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  7759     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  7760     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  7761     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  7762     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  7763
  7764     IF FIRST-ACCOUNT EQUAL +1
  7765        MOVE +0                  TO FIRST-ACCOUNT
  7766        GO TO 0190-PROCESS-NEW-ACCOUNT.
  7767
  7768     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010S.cbl
  7769         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  7770     ELSE
  7771     IF AM-GROUPING NOT = HLD-GROUPING
  7772         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  7773     ELSE
  7774     IF AM-STATE NOT = HLD-STATE
  7775         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  7776     ELSE
  7777     IF AM-ACCOUNT NOT = HLD-ACCT
  7778         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  7779     ELSE
  7780     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  7781
  7782     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  7783        (AM-GROUPING NOT = HLD-GROUPING)
  7784         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  7785
  7786 0190-PROCESS-NEW-ACCOUNT.
  7787
  7788     IF AM-CARRIER NOT = HLD-CARRIER
  7789         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  7790
  7791     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  7792     MOVE AM-CARRIER            TO TR-CARR.
  7793     MOVE AM-GROUPING           TO TR-GROUP.
  7794     MOVE AM-ACCOUNT            TO TR-AG-NO.
  7795     MOVE AM-NAME               TO TR-AGCY.
  7796     MOVE AM-EFF-MO             TO TR-CE-MO.
  7797     MOVE AM-EFF-DA             TO TR-CE-DA.
  7798     MOVE AM-EFF-YR             TO TR-CE-YR.
  7799     MOVE AM-STATE              TO TR-ST-NO.
  7800     IF AM-EXPIRE-DT =  99999999999
  7801         MOVE 'CURRENT '        TO TR-CX
  7802     ELSE
  7803         MOVE AM-EXP-MO         TO TR-CX-MO
  7804         MOVE AM-EXP-DA         TO TR-CX-DA
  7805         MOVE AM-EXP-YR         TO TR-CX-YR
  7806         MOVE '-'               TO HSHR1  HSHR2.
  7807
  7808     ADD +1 TO BC-ACCTS.
  7809
  7810     IF AM-RECORD-ID = '**'
  7811         ADD +1 TO BC-NEW-ACCTS.
  7812     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  7813         ADD +1 TO BC-ER-ACCTS.
  7814
  7815     MOVE ZEROS                 TO SV-LO-CERT
  7816                                   SV-HI-CERT.
  7817     MOVE SPACE                 TO TRANSACTION-FLAG
  7818                                   LST-TRD-CERT
  7819                                   LST-TRD-ISDT
  7820                                   OB-DATE-1-SWITCH
  7821                                   OB-DATE-2-SWITCH
  7822                                   OB-DATE-3-SWITCH.
  7823     MOVE +81                   TO LN-CNT.
  7824
  7825 0199-READ-ACCOUNT-X.
  7826     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010S.cbl
  7827
  7828 0199A-CARRIER-TABLE-LOOKUP.
  7829
  7830     PERFORM 0199B-SEARCH-CARRIER-TABLE
  7831            VARYING CLAS-INDEXCN FROM 1 BY 1
  7832         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  7833               CLAS-INDEXCN GREATER CLAS-MAXCN.
  7834
  7835     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  7836         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  7837         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  7838                                 TO WS-ABEND-MESSAGE
  7839         MOVE 4004               TO WS-ABEND-CODE
  7840         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7841         GO TO ABEND-PGM.
  7842
  7843 0199A-LOOKUP-XIT.
  7844     EXIT.
  7845 0199B-SEARCH-CARRIER-TABLE.
  7846     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010S.cbl
  7848******************************************************************
  7849***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  7850******************************************************************
  7851
  7852 0200-CERT-MASTER-READ-ROUTINE.
  7853
  7854     IF EOF-ON-CERT
  7855         GO TO 0299-READ-CERT-X.
  7856
  7857     IF FIRST-CERT EQUAL +1
  7858        MOVE +0                  TO FIRST-CERT
  7859        GO TO 0250-READ-CERT-MASTER.
  7860
  7861     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  7862
  7863     PERFORM CERT-DATE-LOAD.
  7864
  7865     IF CR-IND-GRP = 'I'  OR  '1'
  7866         MOVE '1'                    TO CR-IND-GRP
  7867     ELSE
  7868         MOVE '2'                    TO CR-IND-GRP.
  7869
  7870     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  7871         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  7872     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  7873         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  7874
  7875************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  7876     IF DTE-CLIENT NOT = 'NSL'
  7877         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  7878                                      CR-AH-REI-RISK-PRM.
  7879******************************************************************
  7880
  7881     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  7882         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  7883     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  7884         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  7885
  7886     MOVE CR-STATE                   TO STATE-L.
  7887     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  7888
  7889     IF CR-LFTYP NOT = ZERO
  7890         MOVE CR-LFTYP               TO CLAS-LOOK
  7891         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  7892
  7893     IF CR-AHTYP NOT = ZERO
  7894         MOVE CR-AHTYP               TO CLAS-LOOK
  7895         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  7896
  7897     IF RUN-MO NOT = 01
  7898         GO TO 0250-READ-CERT-MASTER.
  7899
  7900     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  7901                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  7902
  7903     IF ((CR-LFTYP NOT = ZERO)  AND
  7904         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  7905        ((CR-AHTYP NOT = ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010S.cbl
  7906         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  7907           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  7908
  7909 0250-READ-CERT-MASTER.
  7910
  7911     READ CERT-MASTER-IN
  7912               AT END GO TO 9920-EOJ-2.
  7913
  7914     ADD +1 TO CMIN-CNT.
  7915
  7916     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  7917         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  7918         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  7919         DISPLAY 'SECOND - '  CIR-CONTROL
  7920         MOVE 0612                    TO WS-ABEND-CODE
  7921         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7922         GO TO ABEND-PGM.
  7923
  7924     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  7925         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  7926         IF DTE-CLIENT EQUAL 'SEN'
  7927            GO TO 0250-READ-CERT-MASTER
  7928         ELSE
  7929            MOVE 'DUPLICATE CERT ON FILE'
  7930                                      TO WS-ABEND-MESSAGE
  7931            MOVE 0302                 TO WS-ABEND-CODE
  7932            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7933            GO TO ABEND-PGM.
  7934
  7935******************************************************
  7936*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  7937*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  7938*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  7939******************************************************
  7940     IF DTE-CLIENT = 'CID'
  7941        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  7942           IF (CF-THIRD-AGENT  = '0000713100') OR
  7943              (CF-FOURTH-AGENT = '0000713100')
  7944              CONTINUE
  7945           ELSE
  7946              GO TO 0250-READ-CERT-MASTER
  7947           END-IF
  7948        ELSE
  7949           IF COMPANY-NAME = '        PEOPLES TRUST'
  7950              IF CI-ACCOUNT = '0000845800'
  7951                 CONTINUE
  7952              ELSE
  7953                 GO TO 0250-READ-CERT-MASTER
  7954              END-IF
  7955           ELSE
  7956              IF COMPANY-NAME = '        SUNFLOWER BANK'
  7957                 IF (CF-THIRD-AGENT  = '0000681700') OR
  7958                    (CF-FOURTH-AGENT = '0000681700')
  7959                    CONTINUE
  7960                 ELSE
  7961                    GO TO 0250-READ-CERT-MASTER
  7962                 END-IF
  7963              END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010S.cbl
  7964           END-IF
  7965        END-IF
  7966     END-IF
  7967
  7968******************************************************
  7969     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  7970
  7971 0299-READ-CERT-X.
  7972     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010S.cbl
  7974******************************************************************
  7975***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  7976******************************************************************
  7977
  7978 0300-READ-PENDING-TRANSACTIONS.
  7979
  7980     READ PENDING-EXTRACT
  7981                   AT END GO TO 9910-EOJ-1.
  7982
  7983     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  7984
  7985     IF NOT ED-PENDING-BUSINESS  AND
  7986        NOT ED-PENDING-CLAIMS  AND
  7987        NOT ED-CERT-CHANGES
  7988           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  7989                                               ED-RECORD-TYPE
  7990           MOVE 0301                        TO WS-ABEND-CODE
  7991           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  7992           GO TO ABEND-PGM.
  7993
  7994     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  7995
  7996     IF DTE-CLIENT = 'NCL'
  7997         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  7998             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  7999                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8000             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8001
  8002     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8003         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8004         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8005         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8006         MOVE 0603                    TO WS-ABEND-CODE
  8007         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8008         GO TO ABEND-PGM.
  8009
  8010     ADD +1 TO TR-CNT.
  8011
  8012     IF ISSUE-TRANSACTION   OR
  8013        CANCEL-TRANSACTION  OR
  8014        CLAIM-TRANSACTION   OR
  8015        RESERVE-TRANSACTION OR
  8016        UPDATE-TRANSACTION
  8017         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8018         GO TO 0330-MATCH-PENDING-TO-CERT.
  8019
  8020     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8021
  8022     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8023     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8024             PENDING-RECORD-TYPE ')'.
  8025
  8026     MOVE 0301                   TO WS-ABEND-CODE.
  8027     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8028     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010S.cbl
  8030 0310-SET-UP-MATCHING-KEY.
  8031
  8032     IF ED-PENDING-BUSINESS
  8033         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8034         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8035         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8036         MOVE PB-STATE           TO PEND-MATCH-STATE
  8037         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8038         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8039         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8040         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8041
  8042     IF ED-PENDING-CLAIMS
  8043         ADD +1                  TO W-PENDING-CLMS
  8044         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8045         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8046         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8047         MOVE PC-STATE           TO PEND-MATCH-STATE
  8048         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8049         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8050         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8051         IF PC-CLAIMS
  8052             MOVE '3'            TO PENDING-RECORD-TYPE
  8053         ELSE
  8054             IF PC-RESERVES
  8055                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8056
  8057     IF ED-CERT-CHANGES
  8058         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8059         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8060         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8061         MOVE CC-STATE           TO PEND-MATCH-STATE
  8062         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8063         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8064         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8065         MOVE '5'                TO PENDING-RECORD-TYPE.
  8066
  8067     MOVE ' '                    TO DC-OPTION-CODE.
  8068     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8069     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8070
  8071 0310-EXIT.
  8072     EXIT.
  8073
  8074******************************************************************
  8075***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8076******************************************************************
  8077
  8078 0330-MATCH-PENDING-TO-CERT.
  8079
  8080     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8081         GO TO 0390-CERT-MISMATCH-ERROR.
  8082
  8083     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8084       IF CLAIM-TRANSACTION
  8085         IF NOT PC-CHARGEBLE-EXPENSE  AND
  8086            NOT PC-NON-CHARGEBLE-EXPENSE
  8087             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010S.cbl
  8088                                      OR
  8089                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8090                  GO TO 0390-CERT-MISMATCH-ERROR.
  8091
  8092     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8093       IF RESERVE-TRANSACTION
  8094         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8095                                  OR
  8096            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8097              GO TO 0390-CERT-MISMATCH-ERROR.
  8098
  8099     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8100         IF ISSUE-TRANSACTION
  8101             GO TO 0380-DUPLICATE-CERT-ERROR
  8102         ELSE
  8103             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8104
  8105     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8106         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8107         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8108                                               0299-READ-CERT-X
  8109         GO TO 0330-MATCH-PENDING-TO-CERT.
  8110
  8111     IF ISSUE-TRANSACTION
  8112         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8113     ELSE
  8114         GO TO 0390-CERT-MISMATCH-ERROR.
  8115
  8116 0350-MATCH-PENDING-TO-ACCOUNT.
  8117
  8118     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8119       ADD +1  TO ERROR-COUNT
  8120         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8121           TO  DL-FULL
  8122             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8123         MOVE    ' PENDING CONTROL = '
  8124           TO  DIS-LINE-REASON
  8125         MOVE  PENDING-MATCH-CONTROL
  8126           TO  DIS-LINE-REC
  8127             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8128         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8129           TO  DIS-LINE-REASON
  8130         MOVE  PENDING-MATCH-CONTROL
  8131           TO  DIS-LINE-REC
  8132             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8133         MOVE  SPACES
  8134           TO  DISPLAY-LINE
  8135             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8137         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8138         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8139         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8140         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8141         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8142         DISPLAY '    ACCOUNT CONTROL = '
  8143         AM-MSTR-CNTRL AM-EFFECT-DT
  8144         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8145            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8146            GO TO 0300-READ-PENDING-TRANSACTIONS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010S.cbl
  8147         ELSE
  8148            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8149                                      TO WS-ABEND-MESSAGE
  8150            MOVE 0302 TO WS-ABEND-CODE
  8151            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8152            GO TO ABEND-PGM.
  8153
  8154     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8155         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8156                                              0199-READ-ACCOUNT-X
  8157         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8158
  8159     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8160        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8161         GO TO 0500-APPLY-PENDING-BUSINESS.
  8162
  8163     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8164                                       0199-READ-ACCOUNT-X.
  8165     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8166
  8167
  8168 0370-ACCOUNT-MISMATCH-ERROR.
  8169
  8170     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8171     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8172     MOVE 'MISMATCH ACCOUNT ERROR'
  8173                               TO WS-ABEND-MESSAGE.
  8174     MOVE 0302 TO WS-ABEND-CODE.
  8175         DISPLAY '******************************'
  8176         DISPLAY '***** ERROR LOCATION 009 *****'
  8177         DISPLAY '******************************'
  8178     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8179     GO TO ABEND-PGM.
  8180
  8181
  8182 0380-DUPLICATE-CERT-ERROR.
  8183
  8184     IF PB-I-OB  OR  PB-I-SUMMARY
  8185         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8186
  8187     ADD +1 TO DUP-CNT.
  8188
  8189     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8190         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8191         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8192                                         PB-I-LF-ALT-PREMIUM-AMT
  8193         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8194         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8195         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8196
  8197     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8198     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8199
  8200*    MOVE 0301 TO WS-ABEND-CODE.
  8201*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8202*    GO TO ABEND-PGM.
  8203
  8204
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010S.cbl
  8205 0390-CERT-MISMATCH-ERROR.
  8206
  8207     IF ISSUE-TRANSACTION  OR
  8208        CANCEL-TRANSACTION  OR
  8209        CLAIM-TRANSACTION
  8210         ADD +1                  TO  MISMATCH-COUNT.
  8211
  8212     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8213       ADD  +1  TO  ERROR-COUNT
  8214         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8215           TO  DL-FULL
  8216             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8217         MOVE    ' TRANS CONTROL = '
  8218           TO  DIS-LINE-REASON
  8219         MOVE  PENDING-MATCH-CONTROL
  8220           TO  DIS-LINE-REC
  8221             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8222         MOVE    ' TRANS TYPE    = '
  8223           TO  DIS-LINE-REASON
  8224         MOVE  PENDING-RECORD-TYPE
  8225           TO  DIS-LINE-REC
  8226             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8227         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8228           TO  DL-FULL
  8229             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8230         MOVE    ' CERT IN CTL   = '
  8231           TO  DIS-LINE-REASON
  8232         MOVE  CIR-CONTROL
  8233           TO  DIS-LINE-REC
  8234             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8235         MOVE    ' BYPASSED TRANS  = '
  8236           TO  DIS-LINE-REASON
  8237         MOVE  PENDING-MATCH-CONTROL
  8238           TO  DIS-LINE-REC
  8239             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8240         MOVE  SPACES
  8241           TO  DISPLAY-LINE
  8242             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8243         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8244
  8245     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8246     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8247
  8248     IF ISSUE-TRANSACTION
  8249         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8250     ELSE
  8251         IF CANCEL-TRANSACTION
  8252             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8253         ELSE
  8254             IF CLAIM-TRANSACTION
  8255                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8256             ELSE
  8257                 IF RESERVE-TRANSACTION
  8258                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
  8259                 ELSE
  8260                     IF UPDATE-TRANSACTION
  8261                         MOVE 'CHG'
  8262                                 TO  DTL-REC-TYPE-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010S.cbl
  8263
  8264     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8265     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8266     MOVE 'DROPPED'              TO  DTL-STATUS.
  8267
  8268     IF ISSUE-TRANSACTION
  8269         MOVE PB-I-LF-PREMIUM-AMT
  8270                                 TO  MD2-LF-PREM
  8271         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8272                                 TO  MD2-LF-ALT-PREM
  8273         MOVE PB-I-AH-PREMIUM-AMT
  8274                                 TO  MD2-AH-PREM
  8275         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8276         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8277         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8278     ELSE
  8279         IF CANCEL-TRANSACTION
  8280             MOVE PB-C-LF-CANCEL-AMT
  8281                                 TO  MD3-LF-REFUND
  8282             MOVE PB-C-AH-CANCEL-AMT
  8283                                 TO  MD3-AH-REFUND
  8284             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8285             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8286         ELSE
  8287             IF CLAIM-TRANSACTION
  8288                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8289                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8290                     MOVE ZEROS             TO MD4-AH-CLAIM
  8291                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8292                 ELSE
  8293                     MOVE ZEROS             TO MD4-LF-CLAIM
  8294                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8295                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8296
  8297     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8298         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8299         MOVE MISMATCH-PAGE-NUMBER
  8300                                 TO  TR-PG
  8301         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8302         MOVE MR-CTL             TO  X
  8303         MOVE X TO LCP-ASA
  8304         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8305             THRU LCP-WRITE-END-MISMATCH-RPT
  8306         MOVE TR-HD-2            TO  MISMATCH-RPT
  8307         MOVE MR-CTL             TO  X
  8308         MOVE X TO LCP-ASA
  8309         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8310             THRU LCP-WRITE-END-MISMATCH-RPT
  8311         MOVE TR-HD-3            TO  MISMATCH-RPT
  8312         MOVE MR-CTL             TO  X
  8313         MOVE X TO LCP-ASA
  8314         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8315             THRU LCP-WRITE-END-MISMATCH-RPT
  8316         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
  8317         MOVE MR-CTL             TO  X
  8318         MOVE X TO LCP-ASA
  8319         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8320             THRU LCP-WRITE-END-MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010S.cbl
  8321         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8322
  8323     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8324     MOVE MR-CTL                 TO  X.
  8325     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8326
  8327     MOVE X TO LCP-ASA
  8328     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8329         THRU LCP-WRITE-END-MISMATCH-RPT.
  8330
  8331     IF ISSUE-TRANSACTION
  8332         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8333         MOVE MR-CTL             TO  X
  8334         ADD +1                  TO  MISMATCH-LINE-COUNT
  8335         MOVE X TO LCP-ASA
  8336         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8337             THRU LCP-WRITE-END-MISMATCH-RPT.
  8338
  8339     IF CANCEL-TRANSACTION
  8340         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8341         MOVE MR-CTL             TO  X
  8342         ADD +1                  TO  MISMATCH-LINE-COUNT
  8343         MOVE X TO LCP-ASA
  8344         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8345             THRU LCP-WRITE-END-MISMATCH-RPT.
  8346
  8347     IF CLAIM-TRANSACTION
  8348         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8349         MOVE MR-CTL             TO  X
  8350         ADD +1                  TO  MISMATCH-LINE-COUNT
  8351         MOVE X TO LCP-ASA
  8352         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8353             THRU LCP-WRITE-END-MISMATCH-RPT.
  8354
  8355     MOVE SPACES                 TO  MISMATCH-RPT.
  8356
  8357     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8358
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010S.cbl
  8360******************************************************************
  8361***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8362******************************************************************
  8363
  8364 0400-WRITE-CERT-RECORD.
  8365
  8366     IF CERTIFICATE-RECORD = LOW-VALUES
  8367         GO TO 0499-WRITE-CERT-X.
  8368
  8369     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8370         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8371         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8372         ADD  +1  TO  ERROR-COUNT
  8373         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8374           TO  DL-FULL
  8375             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8376         MOVE    ' CERT. CONTROL = '
  8377           TO  DIS-LINE-REASON
  8378         MOVE  CR-FULL-CONTROL
  8379           TO  DIS-LINE-REC
  8380             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8381         MOVE  SPACES
  8382           TO  DISPLAY-LINE
  8383             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8384            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8385            ADD +1 TO CMOT-CNT
  8386            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8387               GO TO 0400-WRITE-CERT-RECORD.
  8388
  8389*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8390
  8391     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8392         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8393                                              0199-READ-ACCOUNT-X
  8394         GO TO 0400-WRITE-CERT-RECORD.
  8395
  8396     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8397        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8398         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8399                                              0199-READ-ACCOUNT-X
  8400         GO TO 0400-WRITE-CERT-RECORD.
  8401
  8402     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8403
  8404     IF CR-LFTYP = ZEROS  AND
  8405        CR-DTHEXP NOT = ZEROS
  8406         ADD +1                     TO W-LFTYP-99
  8407         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8408         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8409
  8410     IF CR-AHTYP = ZEROS  AND
  8411        CR-DISEXP NOT = ZEROS
  8412         ADD +1                     TO W-AHTYP-99
  8413         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8414         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8415
  8416     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8417
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010S.cbl
  8418     IF CR-LFTYP = '99'
  8419         MOVE '00'                  TO CR-LFTYP.
  8420     IF CR-AHTYP = '99'
  8421         MOVE '00'                  TO CR-AHTYP.
  8422
  8423     IF CR-ISS-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 149)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8424         MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
*  12-S*********************************************************       ( 166)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8425
  8426     IF CR-CAN-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 166)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8427         MOVE ZEROS                 TO CR-CAN-MICROFILM-NO.
*  12-S*********************************************************       ( 166)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8428
  8429     IF  CR-POLICY-IS-ACTIVE
  8430         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8431         IF  CR-POLICY-IS-REISSUE
  8432             OR CR-POLICY-IS-MONTHLY
  8433             ADD +1              TO W-POLICY-REISSUE-CTR
  8434         ELSE
  8435             IF  CR-POLICY-IS-REIN-ONLY
  8436                 ADD +1          TO W-POLICY-REIN-CTR
  8437             ELSE
  8438                 NEXT SENTENCE
  8439     ELSE
  8440         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8441
  8442     IF DTE-PGM-OPT = '1'
  8443       IF REIN-IS-RISK-PREMIUM  AND
  8444          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8445         IF NOT CR-POLICY-IS-REISSUE  AND
  8446            NOT CR-POLICY-IS-DECLINED  AND
  8447            NOT CR-POLICY-IS-VOID
  8448            AND NOT CR-POLICY-IS-MONTHLY
  8449             MOVE '*'            TO RISK-PREM-FLAG
  8450             PERFORM 3100-REINSURE-ISSUE THRU
  8451                     3199-REINSURE-ISSUE-X.
  8452
* 8453     COPY ELCCRTM2.
  8454******************************************************************04/16/98
  8455*                                                                *ELCCRTM2
  8456*                                                                *ELCCRTM2
  8457*                            ELCCRTM2                            *   LV004
  8458*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8459*                            VMOD=2.001                          *ELCCRTM2
  8460*                                                                *ELCCRTM2
  8461*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8462*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8463*                                                                *ELCCRTM2
  8464******************************************************************ELCCRTM2
  8465     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8466     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8467     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8468     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8469     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8470     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8471                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8472     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8473     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8474     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8475     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8476                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8477     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8478     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8479     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8480     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8481     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8482                                                                     CL**4
  8483     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8484                UNTIL COPY-NDX > 5                                   CL**4
  8485           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8486                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8487     END-PERFORM.                                                 ELCCRTM2
  8488                                                                  ELCCRTM2
  8489
  8490     IF DTE-PGM-OPT = '1'
  8491         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8492         ADD +1 TO CMOT-CNT.
  8493
  8494     MOVE SPACE                  TO REIN-FLG
  8495                                    RISK-REIN-FLAG
  8496                                    RISK-PREM-FLAG
  8497                                    RC-COMM-FLG.
  8498
  8499 0499-WRITE-CERT-X.
  8500     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010S.cbl
  8502******************************************************************
  8503***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8504******************************************************************
  8505
  8506 0500-APPLY-PENDING-BUSINESS.
  8507
  8508     IF CANCEL-TRANSACTION
  8509         GO TO 0600-PROCESS-CANCELLATIONS.
  8510
  8511     IF CLAIM-TRANSACTION
  8512         GO TO 0700-PROCESS-CLAIMS.
  8513
  8514     IF RESERVE-TRANSACTION
  8515         GO TO 0800-PROCESS-RESERVES.
  8516
  8517     IF UPDATE-TRANSACTION
  8518         GO TO 0900-PROCESS-CERT-CHANGES.
  8519
  8520******************************************************************
  8521***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8522******************************************************************
  8523
  8524 0505-PROCESS-ISSUES.
  8525
  8526     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8527     PERFORM CERT-DATE-LOAD.
  8528
  8529     ADD +1                      TO  W-POL-ISSUES.
  8530
  8531     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8532     MOVE PB-CARRIER             TO  CR-CARRIER.
  8533     MOVE PB-GROUPING            TO  CR-GROUPING.
  8534     MOVE PB-STATE               TO  CR-STATE.
  8535     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8536     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  8537     MOVE ' '                    TO  DC-OPTION-CODE.
  8538     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8539     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8540                                     WS-CR-DT-N.
  8541     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8542
  8543     MOVE PB-I-NAME              TO  CR-NAME.
  8544     MOVE PB-I-AGE               TO  CR-AGE.
  8545     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8546     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8547
  8548     IF PB-I-JOINT-COVERAGE
  8549         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8550         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8551     ELSE
  8552        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8553           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
  8554             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8555
  8556     IF PB-I-SUMMARY  OR
  8557        DTE-CLIENT = 'DMD'
  8558         MOVE PB-I-LIVES         TO  CR-LIVES.
  8559
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010S.cbl
  8560     IF PB-I-NUM-BILLED NOT NUMERIC
  8561        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8562
  8563     IF PB-I-STATE-TAX NOT NUMERIC
  8564        MOVE ZEROS               TO PB-I-STATE-TAX.
  8565
  8566     IF PB-I-MUNI-TAX NOT NUMERIC
  8567        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8568     IF PB-I-TOT-FEES NOT NUMERIC
  8569        MOVE ZEROS               TO PB-I-TOT-FEES
  8570     END-IF
  8571     IF PB-I-ADDL-CLP NOT NUMERIC
  8572        MOVE ZEROS               TO PB-I-ADDL-CLP
  8573     END-IF
  8574
  8575     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8576     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8577     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8578     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8579     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8580     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8581     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8582     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8583     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8584     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8585
  8586     IF PB-I-RATE-CLASS-OVRD = SPACES
  8587         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8588     ELSE
  8589         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8590
  8591     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8592     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8593
  8594     IF PB-I-INDV-GRP-OVRD = SPACES
  8595         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8596     ELSE
  8597         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8598
  8599     IF CR-IND-GRP = 'I'  OR  '1'
  8600         MOVE '1'                TO  CR-IND-GRP
  8601     ELSE
  8602         MOVE '2'                TO  CR-IND-GRP.
  8603
  8604     IF PB-I-SKIP-CODE = '1'
  8605         MOVE 01                 TO  CR-SKIP.
  8606     IF PB-I-SKIP-CODE = '2'
  8607         MOVE 02                 TO  CR-SKIP.
  8608     IF PB-I-SKIP-CODE = '3'
  8609         MOVE 03                 TO  CR-SKIP.
  8610     IF PB-I-SKIP-CODE = '4'
  8611         MOVE 04                 TO  CR-SKIP.
  8612     IF PB-I-SKIP-CODE = '5'
  8613         MOVE 05                 TO  CR-SKIP.
  8614     IF PB-I-SKIP-CODE = '6'
  8615         MOVE 06                 TO  CR-SKIP.
  8616     IF PB-I-SKIP-CODE = '7'
  8617         MOVE 07                 TO  CR-SKIP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010S.cbl
  8618     IF PB-I-SKIP-CODE = '8'
  8619         MOVE 08                 TO  CR-SKIP.
  8620     IF PB-I-SKIP-CODE = '9'
  8621         MOVE 09                 TO  CR-SKIP.
  8622     IF PB-I-SKIP-CODE = 'A'
  8623         MOVE 10                 TO  CR-SKIP.
  8624     IF PB-I-SKIP-CODE = 'X'
  8625         MOVE 11                 TO  CR-SKIP.
  8626
  8627     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8628     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8629     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8630
  8631     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8632         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8633                                        REIN-SPEC-A
  8634                                        REIN-SPEC-B
  8635                                        REIN-SPEC-C
  8636         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8637     ELSE
  8638         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8639
  8640     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8641     MOVE ' '                    TO  DC-OPTION-CODE.
  8642     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8643     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  8644
  8645     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  8646
  8647     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  8648         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  8649     ELSE
  8650         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  8651
  8652     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  8653         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  8654
  8655     IF PB-BATCH-ENTRY = SPACE  OR
  8656        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  8657         MOVE '1'                TO  CR-ENTRY-STATUS
  8658     ELSE
  8659         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  8660
  8661     IF PB-POLICY-IS-DECLINED
  8662         MOVE 'D'                TO  CR-ENTRY-STATUS.
  8663
  8664     IF PB-POLICY-IS-VOIDED
  8665         MOVE 'V'                TO  CR-ENTRY-STATUS.
  8666
  8667***  IF DTE-CLIENT NOT = 'CRI'
  8668***      IF PB-I-PREM-ACCTNG-ONLY
  8669***          MOVE '1'            TO  CR-ENTRY-STATUS.
  8670
  8671     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  8672                                     WS-CR-ENTRY-DATE-N.
  8673
  8674     IF PB-I-MICROFILM-NO NUMERIC
*  12-S************************                                        ( 166)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010S.cbl
**    Operand PB-I-MICROFILM-NO is not declared
  8675         MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
*  12-S******************************                                  ( 170)**
**    Operand PB-I-MICROFILM-NO is not declared
  8676
  8677     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  8678                     'TMS' OR 'NCL' OR 'HER'
  8679         MOVE PB-I-SIG-SW        TO  CR-USER-CODE.
  8680
  8681*************************************************
  8682***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  8683***  WAS CONVERTED TO 1056 BYTES.             ***
  8684*************************************************
  8685     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  8686     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  8687
  8688     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  8689
  8690     MOVE CR-STATE               TO STATE-L.
  8691
  8692     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8693
  8694     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  8695
  8696***************************************************
  8697***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  8698***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  8699***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  8700***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  8701***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  8702***************************************************
  8703     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  8704         IF CR-LF-POLICY-IS-RESTORE
  8705             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  8706             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8707         ELSE
  8708         IF CR-LF-POLICY-IS-REISSUE
  8709             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  8710             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8711         ELSE
  8712         IF CR-LF-IS-REIN-ONLY
  8713             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  8714             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8715         ELSE
  8716         IF CR-LF-IS-DECLINED
  8717             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  8718             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8719         ELSE
  8720         IF CR-LF-IS-VOID
  8721             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  8722             GO TO 0530-PROCESS-ISSUE-CONTINUED
  8723         ELSE
  8724         IF CR-LF-POLICY-IS-MONTHLY
  8725            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  8726            GO TO 0530-PROCESS-ISSUE-CONTINUED.
  8727
  8728
  8729 0510-PROCESS-LIFE-ISSUE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010S.cbl
  8730
  8731     IF PB-INVALID-LIFE
  8732         GO TO 0520-PROCESS-A-H-ISSUE.
  8733
  8734     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  8735     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8736     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  8737
  8738     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  8739     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  8740     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  8741     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  8742     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  8743     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  8744
  8745     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  8746     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  8747     IF PB-I-LF-POLICY-FEE  NUMERIC
  8748         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  8749     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  8750     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  8751
  8752     IF PB-I-LF-PREM-TAX NUMERIC
  8753        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  8754     END-IF
  8755
  8756
  8757     IF PB-I-LF-REI-RATE NOT = ZEROS
  8758        IF DTE-CLIENT = 'DCC'
  8759           CONTINUE
  8760*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  8761        ELSE
  8762           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  8763           COMPUTE CR-LF-NSP-PRM ROUNDED =
  8764                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  8765        END-IF
  8766     END-IF
  8767
  8768     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  8769         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  8770         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  8771         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  8772         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  8773         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  8774             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  8775                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  8776
  8777     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  8778     MOVE ' '                    TO  DC-OPTION-CODE.
  8779     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8780     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  8781                                     WS-CR-LF-EXPIRE-DATE-N.
  8782
  8783     IF CR-ENTRY-STATUS = 'P'
  8784         MOVE '1'                TO  CR-LF-CURRENT-STATUS
  8785     ELSE
  8786         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  8787
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010S.cbl
  8788     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  8789     MOVE CR-LF-TERM                TO TRD-LFTRM.
  8790     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  8791     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  8792     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  8793
  8794     IF CR-LF-POLICY-IS-RESTORE
  8795         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  8796     IF CR-LF-POLICY-IS-REISSUE
  8797         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  8798     IF CR-LF-IS-REIN-ONLY
  8799         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  8800
  8801     IF CR-LF-IS-DECLINED
  8802         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  8803
  8804     IF CR-LF-IS-VOID
  8805         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  8806     IF CR-LF-POLICY-IS-MONTHLY
  8807         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  8808
  8809     ADD +1                      TO  W-LF-ISSUES.
  8810
  8811 0520-PROCESS-A-H-ISSUE.
  8812
  8813     IF PB-INVALID-AH
  8814         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  8815
  8816     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  8817     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8818     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  8819
  8820     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  8821     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  8822     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  8823     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  8824     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  8825
  8826     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  8827     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  8828     IF PB-I-AH-POLICY-FEE  NUMERIC
  8829         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  8830     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  8831     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  8832
  8833     IF PB-I-AH-PREM-TAX NUMERIC
  8834        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  8835     END-IF
  8836
  8837     IF PB-I-AH-REI-RATE NOT = ZEROS
  8838        IF DTE-CLIENT = 'DCC'
  8839           CONTINUE
  8840        ELSE
  8841           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  8842           COMPUTE CR-AH-NSP-PRM ROUNDED =
  8843             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  8844        END-IF
  8845     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010S.cbl
  8846
  8847     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G'
  8848        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  8849        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  8850        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  8851     END-IF
  8852     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  8853     MOVE ' '                    TO  DC-OPTION-CODE.
  8854     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8855     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  8856                                     WS-CR-AH-EXPIRE-DATE-N.
  8857
  8858     IF CR-ENTRY-STATUS = 'P'
  8859         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  8860     ELSE
  8861         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  8862
  8863     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  8864     MOVE CR-AH-TERM                TO TRD-AHTRM.
  8865     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  8866     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  8867     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  8868
  8869     IF CR-AH-POLICY-IS-RESTORE
  8870         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  8871     IF CR-AH-POLICY-IS-REISSUE
  8872         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  8873     IF CR-AH-IS-REIN-ONLY
  8874         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  8875
  8876     IF CR-AH-IS-DECLINED
  8877         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  8878
  8879     IF CR-AH-IS-VOID
  8880         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  8881     IF CR-AH-POLICY-IS-MONTHLY
  8882         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  8883
  8884     ADD +1                      TO  W-AH-ISSUES.
  8885
  8886 0530-PROCESS-ISSUE-CONTINUED.
  8887
  8888     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  8889     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  8890     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  8891     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  8892
  8893     IF (CR-LFTYP NOT = '00' AND '  ')
  8894                   OR
  8895        (CR-AHTYP NOT = '00' AND '  ')
  8896        IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXL) = 'G')
  8897                      OR
  8898           (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
  8899           IF (CR-BANK-NO NOT = SPACES AND ZEROS)
  8900              AND (PB-I-BANK-FEE NOT = ZEROS)
  8901              MOVE CR-BANK-NO    TO CR-COM-AGT (5)
  8902              MOVE 'B'           TO CR-AGT-TYPE (5)
  8903              COMPUTE CR-LCOM-AH (5) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010S.cbl
  8904                 PB-I-BANK-FEE / +1000
  8905              MOVE PB-I-BANK-NOCHRGB
  8906                                 TO CR-BANK-NOCHRGB-MONTHS
  8907           END-IF
  8908        END-IF
  8909     END-IF
  8910
  8911     IF DTE-CLIENT = 'DCC'
  8912        IF CR-LF-DEV-PCT NOT = +0 AND +1
  8913           COMPUTE CR-LF-NSP-PRM ROUNDED =
  8914              (CR-LFPRM + CR-LFPRM-ALT) -
  8915              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  8916*             ((CR-LFPRM + CR-LFPRM-ALT) * WK-L-RT1 (1))
  8917        END-IF
  8918     END-IF
  8919
  8920     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G'
  8921        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  8922     ELSE
  8923        IF DTE-CLIENT = 'DCC'
  8924           IF CR-AH-DEV-PCT NOT = +0 AND +1
  8925              COMPUTE CR-AH-NSP-PRM ROUNDED =
  8926              CR-AHPRM -
  8927              (CR-AHPRM * CR-LCOM-AH (1))
  8928*             (CR-AHPRM * WK-A-RT1 (1))
  8929           END-IF
  8930        END-IF
  8931     END-IF
  8932
  8933     IF CR-ENTRY-STATUS = 'P'
  8934         MOVE '1'                   TO CR-ENTRY-STATUS.
  8935
  8936     IF CR-POLICY-IS-REISSUE  OR
  8937        CR-POLICY-IS-REIN-ONLY OR
  8938        CR-POLICY-IS-DECLINED OR
  8939        CR-POLICY-IS-VOID
  8940        OR CR-POLICY-IS-MONTHLY
  8941         GO TO 0590-END-ISSUE-PROCESSING.
  8942
  8943     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  8944     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G'
  8945        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  8946     END-IF
  8947     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  8948
  8949     IF NOT PB-INVALID-LIFE
  8950         COMPUTE H-LFCM ROUNDED =
  8951                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  8952         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  8953         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  8954
  8955     IF NOT PB-INVALID-AH
  8956        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G'
  8957           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  8958           + CR-ADDL-CLP)
  8959        ELSE
  8960           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  8961        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010S.cbl
  8962        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  8963        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  8964     END-IF
  8965
  8966     ADD +1 TO BC-G-ISS.
  8967     ADD +1 TO BC-COMM.
  8968     ADD CR-LFPRM TO BC-NET-WRIT.
  8969     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G'
  8970        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  8971     END-IF
  8972     ADD CR-AHPRM TO BC-NET-WRIT.
  8973
  8974     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  8975        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  8976        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  8977     ELSE
  8978        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  8979        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G'
  8980           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  8981        END-IF
  8982     END-IF
  8983
  8984     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  8985         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  8986     ELSE
  8987         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  8988
  8989 0590-END-ISSUE-PROCESSING.
  8990
  8991     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  8992
  8993     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8994
  8995     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  8996        NOT CR-POLICY-IS-DECLINED  AND
  8997        NOT CR-POLICY-IS-VOID
  8998         MOVE 'Y' TO BILLED-SWITCH
  8999         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9000
  9001     IF NOT CR-POLICY-IS-REISSUE  AND
  9002        NOT CR-POLICY-IS-DECLINED  AND
  9003        NOT CR-POLICY-IS-VOID
  9004        AND NOT CR-POLICY-IS-MONTHLY
  9005         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9006
  9007     MOVE '*'                   TO TRANSACTION-FLAG.
  9008     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010S.cbl
  9010******************************************************************
  9011***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9012******************************************************************
  9013
  9014 0600-PROCESS-CANCELLATIONS.
  9015
  9016     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9017
  9018     IF AM-RECALC-COMM = ('Y' OR '1')
  9019         PERFORM 1600-RECALC-COMM-EXTR
  9020             THRU 1899-RECALC-COMM-EXTR-X.
  9021
  9022     MOVE CR-LFRFND               TO LIFE-REFUND.
  9023     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9024     MOVE CR-AHRFND               TO A-H-REFUND.
  9025     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9026     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9027
  9028     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9029     IF CR-LFRFND-CALC = ZEROS
  9030         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9031                                     LIFE-REFUND-CALC
  9032     ELSE
  9033         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9034
  9035     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9036     IF CR-AHRFND-CALC = ZEROS
  9037         MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9038                                     A-H-REFUND-CALC
  9039     ELSE
  9040         MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC.
  9041
  9042     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9043     MOVE 'L'                   TO  DC-OPTION-CODE.
  9044     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9045     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9046
  9047     IF PB-C-MICROFILM-NO NUMERIC  AND
*  12-S************************                                        ( 171)**
**    Operand PB-C-MICROFILM-NO is not declared
  9048        PB-C-MICROFILM-NO NOT = ZEROS
  9049         MOVE PB-C-MICROFILM-NO  TO CR-CAN-MICROFILM-NO.
*  12-S******************************                                  ( 177)**
**    Operand PB-C-MICROFILM-NO is not declared
  9050
  9051     IF PB-CI-STATE-TAX NOT NUMERIC
  9052        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9053
  9054     IF PB-CI-MUNI-TAX NOT NUMERIC
  9055        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9056
  9057     IF CR-CANCEL-STATE-TAX NUMERIC
  9058         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9059       ELSE
  9060         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9061
  9062     IF CR-CANCEL-MUNI-TAX NUMERIC
  9063         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010S.cbl
  9064       ELSE
  9065         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9066
  9067     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9068                                    MONTHS-DIFF-AH.
  9069
  9070     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9071
  9072 0630-PROCESS-LIFE-CANCEL.
  9073
  9074     IF CR-LFTYP = ZERO  OR
  9075        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9076         MOVE ZEROS               TO H-LFCM
  9077         GO TO 0650-PROCESS-A-H-CANCEL.
  9078
  9079     IF PB-C-LF-PREM-TAX NUMERIC
  9080        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9081     END-IF
  9082     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9083     MOVE ' '                     TO  DC-OPTION-CODE.
  9084     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9085     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9086                                      WS-CR-LF-CANC-DT-N.
  9087
  9088     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9089     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9090     MOVE '1'                     TO  DC-OPTION-CODE.
  9091     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9092     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9093                                      DC-ODD-DAYS-OVER
  9094                                      DC-ELAPSED-DAYS.
  9095     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9096     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9097
  9098     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9099         ADD  +1                  TO  MONTHS-DIFF-LF.
  9100
  9101     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9102
  9103     MOVE  ZEROS                  TO  SUB.
  9104
  9105 0635-LIFE-CHARGEBACK-LOOP.
  9106
  9107     ADD    +1                    TO  SUB.
  9108
  9109     IF  SUB  GREATER THAN  +10
  9110         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9111
  9112     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9113         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9114         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9115
  9116     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9117         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9118
  9119     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
  9120         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9121
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010S.cbl
  9122     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9123
  9124
  9125 0640-CONTINUE-LIFE-CANCEL.
  9126
  9127     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9128        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9129
  9130     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9131
  9132     IF DTE-CLIENT = 'GIC'
  9133         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9134             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9135                                     LIFE-REFUND-CALC.
  9136
  9137*    IF DTE-CLIENT = 'TMS'
  9138     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9139
  9140     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9141         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9142     ELSE
  9143         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9144             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9145             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9146             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9147             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9148                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9149         ELSE
  9150             IF CR-LF-CURRENT-STATUS = '6'
  9151                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9152                 MOVE PB-C-LF-COMM-CHARGEBACK
  9153                                       TO CR-LF-COMM-CHARGEBACK
  9154                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9155                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9156
  9157*************************************************
  9158***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9159***  WAS CONVERTED TO 1056 BYTES.             ***
  9160*************************************************
  9161     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9162
  9163     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9164     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9165     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9166
  9167     COMPUTE H-LFCM ROUNDED =
  9168                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9169     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9170
  9171     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9172     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9173     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9174     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9175
  9176     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9177     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9178
  9179 0650-PROCESS-A-H-CANCEL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010S.cbl
  9180
  9181     IF CR-AHTYP = ZERO  OR
  9182        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9183         MOVE ZEROS               TO H-AHCM
  9184         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9185
  9186     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9187     MOVE 'L'                   TO  DC-OPTION-CODE.
  9188     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9189     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9190
  9191     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9192     MOVE ' '                     TO  DC-OPTION-CODE.
  9193     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9194     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9195                                      WS-CR-AH-CANC-DT-N.
  9196
  9197     IF PB-C-AH-PREM-TAX NUMERIC
  9198        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9199     END-IF
  9200     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9201     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9202     MOVE '1'                     TO  DC-OPTION-CODE.
  9203     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9204     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9205                                      DC-ODD-DAYS-OVER
  9206                                      DC-ELAPSED-DAYS.
  9207     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9208     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9209
  9210     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9211          ADD  +1                 TO  MONTHS-DIFF-AH.
  9212
  9213     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9214     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9215        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9216     END-IF
  9217*    IF DTE-CLIENT = 'DCC'
  9218*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
  9219*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9220*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9221*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9222*             OR (SUB > +10)
  9223*          END-PERFORM
  9224*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9225*             MOVE CR-BANK-NOCHRGB-MONTHS
  9226*                                TO AM-COMM-CHARGEBACK (SUB)
  9227*          END-IF
  9228*       END-IF
  9229*    END-IF
  9230
  9231
  9232     MOVE 'Y'                     TO WS-FIRST-K
  9233     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9234     MOVE  ZEROS                  TO  SUB.
  9235
  9236 0653-A-H-CHARGEBACK-LOOP.
  9237
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010S.cbl
  9238     ADD    +1                    TO  SUB.
  9239
  9240     IF  SUB  GREATER THAN  +10
  9241         GO TO  0655-CONTINUE-A-H-CANCEL.
  9242
  9243     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9244         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9245         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9246
  9247     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9248         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9249
  9250     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9251         OR ((DTE-CLIENT = 'DCC')
  9252             AND (CR-AHRFND = ZEROS))
  9253         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9254
  9255     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9256
  9257
  9258 0655-CONTINUE-A-H-CANCEL.
  9259
  9260     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9261        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9262
  9263     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9264
  9265     IF DTE-CLIENT = 'GIC'
  9266         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9267             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9268                                     A-H-REFUND-CALC.
  9269
  9270*    IF DTE-CLIENT = 'TMS'
  9271     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9272*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9273
  9274
  9275     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9276         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9277     ELSE
  9278         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9279             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9280             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9281             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9282             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9283                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9284         ELSE
  9285             IF CR-AH-CURRENT-STATUS = '7'
  9286                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9287                 MOVE PB-C-AH-COMM-CHARGEBACK
  9288                                       TO CR-AH-COMM-CHARGEBACK
  9289                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9290                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9291
  9292*************************************************
  9293***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9294***  WAS CONVERTED TO 1056 BYTES.             ***
  9295*************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010S.cbl
  9296     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9297
  9298     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9299     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9300     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9301
  9302     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G'
  9303        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9304        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9305           (CR-AHPRM - (CR-LFPRM-ALT
  9306           + CR-ADDL-CLP)) * -1
  9307     ELSE
  9308        COMPUTE H-AHCM ROUNDED =
  9309          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9310     END-IF
  9311
  9312     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9313
  9314     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9315     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9316     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9317     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9318
  9319     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9320     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9321
  9322 0660-PROCESS-CANCEL-CONTINUE.
  9323
  9324     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9325
  9326     IF CR-POLICY-IS-REIN-ONLY
  9327        GO TO 0660-CONT.
  9328
  9329     MOVE 'Y'                    TO BILLED-SWITCH.
  9330     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9331
  9332*    IF CR-POLICY-IS-MONTHLY
  9333*       GO TO 0660-CONT.
  9334
  9335     ADD +1                      TO BC-G-CNC.
  9336     ADD +1                      TO BC-COMM.
  9337     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9338     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9339     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9340     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9341     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9342     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9343
  9344     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9345         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9346     ELSE
  9347         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9348
  9349     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9350         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
  9351     ELSE
  9352         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9353
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010S.cbl
  9354
  9355 0660-CONT.
  9356
  9357     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9358     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9359
  9360     IF CR-LFRFND NEGATIVE
  9361       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9362           MOVE '*'                 TO REIN-VOID-LF-SW.
  9363     IF CR-AHRFND NEGATIVE
  9364       IF CR-AHRFND + A-H-REFUND = ZEROS
  9365           MOVE '*'                 TO REIN-VOID-AH-SW.
  9366
  9367     IF CR-LFRFND NOT = ZEROS
  9368       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9369           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9370     IF CR-AHRFND NOT = ZEROS
  9371       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9372           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9373
  9374     IF CR-DT = CR-LF-CANC-DT
  9375       MOVE '*'                     TO REIN-CANCEL-LF-SW.
  9376     IF CR-DT = CR-AH-CANC-DT
  9377       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9378
  9379     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9380
  9381     MOVE SPACES                    TO REIN-VOID-LF-SW
  9382                                       REIN-VOID-AH-SW
  9383                                       REIN-ADDL-LF-SW
  9384                                       REIN-ADDL-AH-SW.
  9385
  9386     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9387     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9388
  9389     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9390     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9391
  9392     IF (CR-LFTYP NOT = ZERO  AND
  9393        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9394        (CR-AHTYP NOT = ZERO  AND
  9395        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9396         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9397         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9398
  9399 0670-LIFE-CANCEL-VOID.
  9400
  9401     IF CR-LFTYP NOT = ZERO  AND
  9402        CR-LFRFND = ZERO  AND
  9403        PB-C-LF-CANCEL-AMT NEGATIVE
  9404         NEXT SENTENCE
  9405     ELSE
  9406         GO TO 0680-A-H-CANCEL-VOID.
  9407
  9408     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
  9409                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9410                                          CR-LF-CANC-DT
  9411                                          WS-CR-LF-CANC-DT-N
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010S.cbl
  9412                                          CR-LFRFND-CALC.
  9413
  9414     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9415
  9416     IF CR-LF-CANCEL-APPLIED
  9417         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9418         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9419     ELSE
  9420         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9421         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9422
  9423     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9424
  9425     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9426     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9427
  9428     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9429
  9430 0680-A-H-CANCEL-VOID.
  9431
  9432     IF CR-AHTYP NOT = ZERO  AND
  9433        CR-AHRFND = ZERO  AND
  9434        PB-C-AH-CANCEL-AMT NEGATIVE
  9435         NEXT SENTENCE
  9436     ELSE
  9437         GO TO 0690-END-CANCEL-PROCESSING.
  9438
  9439     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9440                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9441                                        CR-AH-CANC-DT
  9442                                        WS-CR-AH-CANC-DT-N
  9443                                        CR-AHRFND-CALC.
  9444
  9445     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9446
  9447     IF CR-AH-CANCEL-APPLIED
  9448         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9449         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9450     ELSE
  9451         MOVE CR-AH-STATUS-AT-CANCEL
  9452                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9453         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9454
  9455     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9456
  9457     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9458     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9459
  9460     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9461
  9462 0690-END-CANCEL-PROCESSING.
  9463
  9464     IF CR-LF-CANC-DT = ZEROS  AND
  9465        CR-AH-CANC-DT = ZEROS
  9466         MOVE ZEROS             TO CR-CAN-MICROFILM-NO.
*  12-S*****************************************************           ( 177)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  9467
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010S.cbl
  9468     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9469         NEXT SENTENCE
  9470     ELSE
  9471         MOVE 'X'               TO REIN-RT-SW
  9472         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9473         MOVE ' '               TO REIN-RT-SW.
  9474
  9475     MOVE '*'                   TO TRANSACTION-FLAG.
  9476     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9477
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010S.cbl
  9479******************************************************************
  9480***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9481******************************************************************
  9482
  9483 0700-PROCESS-CLAIMS.
  9484
  9485     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9486        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9487         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9488             PENDING-MATCH-CONTROL
  9489         MOVE 0301 TO WS-ABEND-CODE
  9490         DISPLAY '******************************'
  9491         DISPLAY '***** ERROR LOCATION 011 *****'
  9492         DISPLAY '******************************'
  9493         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9494         GO TO ABEND-PGM.
  9495
  9496     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9497
  9498     ADD +1                       TO  W-LF-CLAIMS.
  9499
  9500     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9501     MOVE ' '                     TO  DC-OPTION-CODE.
  9502     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9503     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9504
  9505     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9506     MOVE ' '                     TO  DC-OPTION-CODE.
  9507     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9508     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9509
  9510     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9511     MOVE ' '                     TO  DC-OPTION-CODE.
  9512     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9513     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9514
  9515     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9516     MOVE ' '                     TO  DC-OPTION-CODE.
  9517     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9518     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9519
  9520     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9521
  9522     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9523       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9524       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9525         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9526             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9527         ELSE
  9528             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9529
  9530     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9531         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9532
  9533******************************************************************
  9534***           P R O C E S S   D E A T H   C L A I M            ***
  9535******************************************************************
  9536
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010S.cbl
  9537     IF REIN-IS-RISK-PREMIUM
  9538       IF CR-DTH-DT = ZEROS
  9539           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9540           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9541           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9542
  9543     MOVE INCURRED-DATE            TO CR-DTH-DT
  9544                                      WS-CR-DTH-DT-N.
  9545
  9546     IF PC-CHARGEBLE-EXPENSE  OR
  9547        PC-NON-CHARGEBLE-EXPENSE
  9548         IF CR-LFTYP = '00'
  9549             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9550             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9551                     8399-LIFE-LOOKUP-X.
  9552
  9553     IF PC-CHARGEBLE-EXPENSE  OR
  9554        PC-NON-CHARGEBLE-EXPENSE
  9555         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9556         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9557         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9558         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9559         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9560         GO TO 0780-END-CLAIMS-PROCESSING.
  9561
  9562     ADD +1                       TO  CR-NUM-DTH-CLM.
  9563     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9564     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9565                                      WS-CR-DTH-PAY-DT-N.
  9566
  9567     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9568     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9569     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9570     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9571     IF CR-DTH-PAY-CD NOT = 'F'
  9572         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9573     INSPECT CR-DTH-PAY-CD
  9574         CONVERTING '12349' TO 'PFSXV'.
  9575     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9576
  9577     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9578         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9579       AND
  9580       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9581       OR
  9582        DTE-CLIENT = 'ACC' OR 'FDL')
  9583        NEXT SENTENCE
  9584     ELSE
  9585     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9586         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9587             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9588             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9589             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9590                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9591
  9592     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9593     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9594     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010S.cbl
  9595     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9596         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9597     ELSE
  9598         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
  9599     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
  9600
  9601     IF NOT CR-POLICY-IS-REIN-ONLY
  9602         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
  9603
  9604 0720-CANCEL-AH-COVERAGE.
  9605
  9606     IF CR-AHTYP = ZEROS  OR
  9607        NOT CR-AH-POLICY-IS-ACTIVE
  9608         GO TO 0740-DEATH-CLAIM-VOID.
  9609
  9610     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
  9611     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
  9612     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
  9613                                           WS-CR-AH-CANC-DT-N.
  9614     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
  9615                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
  9616
  9617     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
  9618     MOVE CR-AH-TERM                    TO TRD-AHTRM.
  9619     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
  9620     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
  9621     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
  9622     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
  9623     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
  9624     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9625
  9626 0740-DEATH-CLAIM-VOID.
  9627
  9628     IF CR-DTHAMT = ZERO  AND
  9629        PC-CLAIM-PAYMENT NEGATIVE
  9630         NEXT SENTENCE
  9631     ELSE
  9632         GO TO 0780-END-CLAIMS-PROCESSING.
  9633
  9634     MOVE '*'                           TO DEATH-VOID-FLAG.
  9635
  9636     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
  9637                                        WS-CR-LF-CLAIM-EXIT-DATE-N
  9638                                           CR-NUM-DTH-CLM
  9639                                           CR-DTH-RPT-DT
  9640                                           CR-DTH-PAY-DT
  9641                                           WS-CR-DTH-PAY-DT-N
  9642*                                          CR-DTHAMT-YTD
  9643*                                          CR-DTHAMT-LAST
  9644                                           CR-DTH-AGE.
  9645     MOVE ' '                           TO CR-DTH-PAY-CD.
  9646
  9647     IF CR-LF-DEATH-CLAIM-APPLIED
  9648         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
  9649         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
  9650     ELSE
  9651         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
  9652         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010S.cbl
  9653
  9654     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
  9655     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9656
  9657     IF CR-AH-DEATH-CLAIM-APPLIED
  9658         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9659         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9660         MOVE ZEROS                     TO CR-AH-CANC-DT
  9661                                           WS-CR-AH-CANC-DT-N
  9662                                           CR-AH-CANCEL-EXIT-DATE
  9663                                       WS-CR-AH-CANCEL-EXIT-DATE-N
  9664         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
  9665         MOVE CR-AH-TERM                TO TRD-AHTRM
  9666         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
  9667         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9668
  9669     GO TO 0780-END-CLAIMS-PROCESSING.
  9670
  9671******************************************************************
  9672***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
  9673******************************************************************
  9674
  9675 0750-PROCESS-DISABILITY-CLAIM.
  9676
  9677     ADD +1                       TO W-AH-CLAIMS.
  9678
  9679     MOVE INCURRED-DATE           TO CR-DIS-DT
  9680                                     WS-CR-DIS-DT-N.
  9681
  9682     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
  9683
  9684     IF REIN-AH-CLM-MONTHS = +1
  9685         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
  9686     ELSE
  9687       IF REIN-AH-CLM-MONTHS = +2
  9688           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
  9689       ELSE
  9690         IF REIN-AH-CLM-MONTHS = +3
  9691             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
  9692         ELSE
  9693           IF REIN-AH-CLM-MONTHS = +4
  9694               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
  9695           ELSE
  9696               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
  9697
  9698     IF PC-CHARGEBLE-EXPENSE  OR
  9699        PC-NON-CHARGEBLE-EXPENSE
  9700         IF CR-AHTYP = '00'
  9701             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
  9702             PERFORM 8400-A-H-TYPE-LOOKUP THRU
  9703                     8499-A-H-LOOKUP-X.
  9704
  9705     IF PC-CHARGEBLE-EXPENSE  OR
  9706        PC-NON-CHARGEBLE-EXPENSE
  9707         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
  9708         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
  9709         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
  9710         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010S.cbl
  9711         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
  9712         GO TO 0780-END-CLAIMS-PROCESSING.
  9713
  9714     ADD +1                       TO CR-NUM-DIS-CLM.
  9715
  9716     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
  9717     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
  9718                                      WS-CR-DIS-PAY-DT-N.
  9719     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
  9720                                      WS-CR-DIS-PTO-DT-N.
  9721
  9722     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
  9723     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
  9724     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
  9725
  9726     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
  9727     IF CR-DIS-PAY-CD NOT = 'S'
  9728         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
  9729     INSPECT CR-DIS-PAY-CD
  9730         CONVERTING '12349' TO 'PFSXV'.
  9731     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
  9732
  9733     IF PC-LUMP-SUM-PAYMENT
  9734         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
  9735           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
  9736           MOVE '6'                  TO CR-AH-CURRENT-STATUS
  9737           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
  9738                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
  9739
  9740     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
  9741     MOVE CR-AH-TERM               TO TRD-AHTRM.
  9742     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
  9743     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
  9744     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
  9745
  9746     IF NOT CR-POLICY-IS-REIN-ONLY
  9747         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
  9748
  9749     IF NOT PC-LUMP-SUM-PAYMENT
  9750         GO TO 0780-END-CLAIMS-PROCESSING.
  9751
  9752 0770-CANCEL-LF-COVERAGE.
  9753
  9754     IF CR-LFTYP = ZEROS  OR
  9755        NOT CR-LF-POLICY-IS-ACTIVE
  9756         GO TO 0780-END-CLAIMS-PROCESSING.
  9757
  9758     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
  9759     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
  9760     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
  9761                                           WS-CR-LF-CANC-DT-N.
  9762     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
  9763                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
  9764
  9765     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
  9766     MOVE CR-LF-TERM                    TO TRD-LFTRM.
  9767     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
  9768     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010S.cbl
  9769     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
  9770     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
  9771     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
  9772     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9773
  9774 0780-END-CLAIMS-PROCESSING.
  9775
  9776     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  9777         MOVE DTO-MO               TO TRD-LFACTMO
  9778         MOVE DTO-DA               TO TRD-LFACTDA
  9779         MOVE DTO-YR               TO TRD-LFACTYR
  9780         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
  9781     ELSE
  9782         MOVE PAY-MO               TO TRD-AHACTMO
  9783         MOVE PAY-DA               TO TRD-AHACTDA
  9784         MOVE PAY-YR               TO TRD-AHACTYR
  9785         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
  9786
  9787     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9788
  9789     IF NOT CR-POLICY-IS-REIN-ONLY
  9790         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
  9791         ADD +1                    TO BC-G-CLM.
  9792
  9793     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
  9794
  9795     IF DEATH-CLAIM-VOIDED
  9796         MOVE ZEROS                TO CR-DTH-DT
  9797                                      WS-CR-DTH-DT-N.
  9798     MOVE SPACE                    TO DEATH-VOID-FLAG.
  9799
  9800     MOVE '*'                      TO TRANSACTION-FLAG.
  9801     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9802
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010S.cbl
  9804 0790-TABLE-DISAB-PERIODS.
  9805
  9806     MOVE +1                       TO SUB14.
  9807     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
  9808
  9809     MOVE +1                       TO SUB14.
  9810
  9811**************************************************************
  9812**                                                          **
  9813**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
  9814**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
  9815**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
  9816**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
  9817**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
  9818**                                                          **
  9819**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
  9820**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
  9821**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
  9822**                                                          **
  9823**************************************************************
  9824
  9825 0791-TABLE-AH-AMOUNT.
  9826
  9827     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
  9828         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
  9829
  9830     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
  9831         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
  9832                                      WS-CR-DIS-INCUR-DT-N (SUB14)
  9833         IF REIN-IS-RISK-PREMIUM
  9834             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
  9835             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9836             IF SUB14 = +1
  9837               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
  9838             ELSE
  9839             IF SUB14 = +2
  9840               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
  9841             ELSE
  9842             IF SUB14 = +3
  9843               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
  9844             ELSE
  9845             IF SUB14 = +4
  9846               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
  9847             ELSE
  9848               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
  9849
  9850
  9851     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
  9852         MOVE SUB14                TO REIN-AH-CLM-MONTHS
  9853         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
  9854                                        +  CR-INCUR-DISEXP (SUB14)
  9855         IF PC-CHARGEBLE-EXPENSE  OR
  9856            PC-NON-CHARGEBLE-EXPENSE
  9857             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
  9858             GO TO 0791-TABLE-AH-EXIT
  9859         ELSE
  9860             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
  9861             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010S.cbl
  9862
  9863     ADD +1                       TO SUB14.
  9864
  9865     GO TO 0791-TABLE-AH-AMOUNT.
  9866
  9867 0791-TABLE-AH-EXIT.
  9868     EXIT.
  9869
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010S.cbl
  9871**************************************************************
  9872**                                                          **
  9873** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
  9874** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
  9875**                                                          **
  9876** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
  9877** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
  9878** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
  9879** OCCURRENCE.                                              **
  9880**************************************************************
  9881 0792-MOVE-TABLE.
  9882
  9883     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
  9884                                  WS-CR-DIS-INCUR-DT-N (1).
  9885     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
  9886     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
  9887
  9888     MOVE +2                   TO SUB14.
  9889     MOVE +3                   TO SUB15.
  9890     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
  9891
  9892     MOVE DISABILITY-TBL-MAX   TO SUB14.
  9893
  9894     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
  9895                                  WS-CR-DIS-INCUR-DT-N (SUB14).
  9896
  9897 0792-MOVE-TABLE-EXIT.
  9898     EXIT.
  9899
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010S.cbl
  9901**************************************************************
  9902**                                                          **
  9903**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
  9904** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
  9905** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
  9906** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
  9907** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
  9908**************************************************************
  9909
  9910 0794-REVIEW-TABLE.
  9911
  9912     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
  9913         GO TO 0794-REVIEW-TABLE-EXIT.
  9914
  9915     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
  9916         GO TO 0794-REVIEW-TABLE-EXIT.
  9917
  9918     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
  9919        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
  9920         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
  9921         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
  9922                                  WS-CR-DIS-INCUR-DT-N (SUB14)
  9923         MOVE SUB14            TO SUB15
  9924         ADD +1                TO SUB15
  9925         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
  9926         MOVE +1               TO SUB14
  9927         GO TO 0794-REVIEW-TABLE.
  9928
  9929     ADD +1                    TO SUB14.
  9930
  9931     GO TO 0794-REVIEW-TABLE.
  9932
  9933 0794-REVIEW-TABLE-EXIT.
  9934     EXIT.
  9935
  9936 0794A-BUMP-TBL.
  9937
  9938     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
  9939         GO TO 0794A-BUMP-TBL-EXIT.
  9940
  9941     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
  9942                             CR-DISAB-DETAIL-DATA (SUB14).
  9943
  9944     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
  9945                                  WS-CR-DIS-INCUR-DT-N (SUB15)
  9946                                  CR-INCUR-DISAMT (SUB15)
  9947                                  CR-INCUR-DISEXP (SUB15).
  9948
  9949     ADD +1                    TO SUB14
  9950                                  SUB15.
  9951     GO TO 0794A-BUMP-TBL.
  9952
  9953 0794A-BUMP-TBL-EXIT.
  9954     EXIT.
  9955
  9956 0795-DCC-NSP-LF.
  9957
  9958     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010S.cbl
  9959     MOVE 'L'                        TO DC-OPTION-CODE.
  9960     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9961     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  9962     MOVE SPACES                     TO CP-ACCT-FLD-5.
  9963     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  9964     MOVE CR-AGE                     TO CP-ISSUE-AGE.
  9965     MOVE CR-APR                     TO CP-LOAN-APR.
  9966     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
  9967     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
  9968     MOVE ZEROS                      TO CP-DEVIATION-CODE.
  9969     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
  9970
  9971     MOVE '3'                        TO CP-PROCESS-TYPE.
  9972     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  9973     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
  9974
  9975     IF CR-LFTYP = ZERO
  9976         GO TO 0795-EXIT
  9977     END-IF
  9978
  9979     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
  9980         GO TO 0795-EXIT
  9981     END-IF
  9982     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
  9983     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
  9984     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
  9985     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
  9986                                        CP-RATING-BENEFIT-AMT.
  9987     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
  9988     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
  9989     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
  9990     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
  9991     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
  9992     MOVE CR-STATE                   TO CP-STATE.
  9993     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
  9994
  9995     IF CP-STATE-STD-ABBRV = 'OR'
  9996         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
  9997
  9998     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  9999
 10000     IF CP-ERROR-RATE-NOT-FOUND  OR
 10001        CP-ERROR-RATE-IS-ZERO
 10002         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10003                                     TO WS-ABEND-MESSAGE
 10004         MOVE 0302                   TO WS-ABEND-CODE
 10005         DISPLAY '******************************'
 10006         DISPLAY '***** ERROR LOCATION 018 *****'
 10007         DISPLAY '******************************'
 10008         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10009         GO TO ABEND-PGM.
 10010
 10011     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10012
 10013*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10014*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10015
 10016     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010S.cbl
 10017                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10018
 10019     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10020
 10021 0795-exit.
 10022     exit.
 10023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010S.cbl
 10025******************************************************************
 10026***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10027******************************************************************
 10028
 10029 0800-PROCESS-RESERVES.
 10030
 10031     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10032       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10033           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10034
 10035     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10036
 10037     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10038     MOVE ' '                     TO  DC-OPTION-CODE.
 10039     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10040     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10041
 10042     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10043     MOVE ' '                     TO  DC-OPTION-CODE.
 10044     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10045     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10046
 10047     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10048     MOVE ' '                     TO  DC-OPTION-CODE.
 10049     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10050     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10051
 10052     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10053
 10054     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10055         ADD +1                     TO W-LF-RESERVES
 10056         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10057         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10058         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10059         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10060         MOVE INCURRED-DATE         TO CR-DTH-DT
 10061                                       WS-CR-DTH-DT-N
 10062         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10063
 10064     ELSE
 10065         ADD +1                     TO W-AH-RESERVES
 10066         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10067         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10068         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10069         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10070         MOVE INCURRED-DATE         TO CR-DIS-DT
 10071                                       WS-CR-DIS-DT-N
 10072         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10073
 10074     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10075     MOVE 'IBNR'                    TO TRD-IBNRX.
 10076     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10077     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10078     COMPUTE TRD-FUTRSV EQUAL
 10079            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10080     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10081     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10082
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010S.cbl
 10083 0820-END-RESERVE-PROCESSING.
 10084
 10085     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10086
 10087     IF NOT CR-POLICY-IS-REIN-ONLY
 10088         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10089                                            2499-BLD-RESERVE-X
 10090         ADD +1 TO BC-G-CRS.
 10091
 10092     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10093
 10094     MOVE '*'                    TO TRANSACTION-FLAG.
 10095     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10096
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010S.cbl
 10098******************************************************************
 10099***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10100******************************************************************
 10101
 10102 0900-PROCESS-CERT-CHANGES.
 10103
 10104     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10105
 10106     IF CC-AGE NOT NUMERIC  OR
 10107        CC-AGE = CR-AGE
 10108         MOVE ZEROS TO CC-AGE.
 10109
 10110     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10111        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10112         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10113
 10114     IF CC-INSURED-SEX NOT = 'M'  AND
 10115        CC-INSURED-SEX NOT = 'F'
 10116         MOVE SPACES TO CC-INSURED-SEX.
 10117
 10118     IF CC-LOAN-APR NOT NUMERIC  OR
 10119        CC-LOAN-APR = CR-APR
 10120         MOVE ZEROS TO CC-LOAN-APR.
 10121
 10122     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10123        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10124         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10125
 10126     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10127        CC-IND-GRP-TYPE NOT = '2'
 10128         MOVE SPACES TO CC-IND-GRP-TYPE.
 10129
 10130     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10131        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10132         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10133
 10134     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10135        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10136         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10137
 10138     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10139        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10140        CR-LFTYP = ZEROS
 10141         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10142
 10143     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10144        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10145        CR-AHTYP = ZEROS
 10146         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10147
 10148     IF CR-BILLED NOT NUMERIC
 10149         MOVE ZEROS TO CR-BILLED.
 10150
 10151     IF CR-LIVES NOT NUMERIC
 10152         MOVE ZEROS TO CR-LIVES.
 10153
 10154     IF CC-LIVES NOT NUMERIC  OR
 10155        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010S.cbl
 10156         MOVE ZEROS TO CC-LIVES.
 10157
 10158     IF CC-BILLED NOT NUMERIC  OR
 10159        CC-BILLED = CR-BILLED
 10160         MOVE ZEROS TO CC-BILLED.
 10161
 10162     IF CC-INSURED-LAST-NAME NOT = SPACES
 10163         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10164     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10165         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10166     IF CC-INSURED-INITIAL2 NOT = SPACES
 10167         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10168     IF CC-JT-LAST-NAME NOT = SPACES
 10169         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10170     IF CC-JT-FIRST-NAME NOT = SPACES
 10171         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10172     IF CC-JT-INITIAL NOT = SPACES
 10173         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10174
 10175     IF CC-AGE NOT = ZEROS
 10176         MOVE CC-AGE                 TO CR-AGE
 10177                                        DET-AGE
 10178     ELSE
 10179         MOVE ZEROS                  TO DET-AGE.
 10180
 10181     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10182         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10183                                        DET-JT-AGE
 10184     ELSE
 10185         MOVE ZEROS                  TO DET-JT-AGE.
 10186
 10187     IF CC-INSURED-SEX NOT = SPACES
 10188         MOVE CC-INSURED-SEX         TO CR-SEX
 10189                                        DET-SEX
 10190     ELSE
 10191         MOVE SPACE                  TO DET-SEX.
 10192
 10193     IF CC-MEMBER-NO NOT = SPACES
 10194         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10195                                        DET-PR-MEM
 10196     ELSE
 10197         MOVE SPACES                 TO DET-PR-MEM.
 10198
 10199     IF CC-SOC-SEC-NO NOT = SPACES
 10200         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10201                                        DET-PR-SS
 10202     ELSE
 10203         MOVE SPACES                 TO DET-PR-SS.
 10204
 10205     IF CC-LOAN-APR NOT = ZEROS
 10206         MOVE CC-LOAN-APR            TO CR-APR
 10207                                        DET-PR-APR
 10208     ELSE
 10209         MOVE ZEROS                  TO DET-PR-APR.
 10210
 10211     IF CC-AGE NOT = ZERO  OR
 10212        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10213        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010S.cbl
 10214        CC-MEMBER-NO NOT = SPACES  OR
 10215        CC-SOC-SEC-NO NOT = SPACES  OR
 10216        CC-LOAN-APR NOT = ZERO
 10217         MOVE DET-PR-UREC            TO TR-DTL2
 10218         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10219         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10220
 10221     IF CC-LF-ORIG-TERM NOT = ZEROS
 10222         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10223         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10224                                        DET-N-LF-TERM
 10225     ELSE
 10226         MOVE ZEROS                  TO DET-O-LF-TERM
 10227                                        DET-N-LF-TERM.
 10228
 10229     IF CC-AH-ORIG-TERM NOT = ZEROS
 10230         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10231         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10232                                        DET-N-AH-TERM
 10233     ELSE
 10234         MOVE ZEROS                  TO DET-O-AH-TERM
 10235                                        DET-N-AH-TERM.
 10236
 10237     IF CC-LIVES NOT = ZEROS
 10238         MOVE CR-LIVES               TO DET-O-LIVES
 10239         MOVE CC-LIVES               TO CR-LIVES
 10240                                        DET-N-LIVES
 10241     ELSE
 10242         MOVE ZEROS                  TO DET-O-LIVES
 10243                                        DET-N-LIVES.
 10244
 10245     IF CC-BILLED NOT  = ZEROES
 10246         MOVE CC-BILLED              TO CR-BILLED.
 10247
 10248     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10249        CC-AH-ORIG-TERM NOT = ZERO  OR
 10250        CC-LIVES NOT = ZERO
 10251         MOVE DET-PR-UREC-2          TO TR-DTL2
 10252         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10253         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10254
 10255     IF CC-IND-GRP-TYPE NOT = SPACES
 10256         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10257                                        DET-IND-GRP
 10258     ELSE
 10259         MOVE SPACE                  TO DET-IND-GRP.
 10260
 10261     IF CC-PAY-FREQUENCY NOT = ZEROS
 10262         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10263                                        DET-PMT-FREQ
 10264     ELSE
 10265         MOVE ZEROS                  TO DET-PMT-FREQ.
 10266
 10267     IF CC-POLICY-FORM-NO NOT = SPACES
 10268         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10269                                        DET-POL-FORM
 10270     ELSE
 10271         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010S.cbl
 10272
 10273     IF CC-LOAN-OFFICER NOT = SPACES
 10274         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10275                                        DET-LOAN-OFFICER
 10276     ELSE
 10277         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10278
 10279     IF CC-USER-FIELD NOT = SPACES
 10280         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10281                                        DET-USER-CODE
 10282     ELSE
 10283         MOVE SPACE                  TO DET-USER-CODE.
 10284
 10285     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10286        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10287        CC-POLICY-FORM-NO NOT = SPACES  OR
 10288        CC-LOAN-OFFICER NOT = SPACES  OR
 10289        CC-USER-FIELD NOT = SPACES
 10290         MOVE DET-PR-UREC-3          TO TR-DTL2
 10291         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10292         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10293
 10294     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10295         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10296                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10297                                        DET-CLM-DEDUCT
 10298     ELSE
 10299         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10300
 10301     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10302         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10303                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10304                                        DET-CAN-DEDUCT
 10305     ELSE
 10306         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10307
 10308     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10309        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10310         MOVE DET-PR-UREC-4          TO TR-DTL2
 10311         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10312         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10313
 10314     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10315         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10316
 10317     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10318         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10319
 10320     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10321         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10322
 10323     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10324         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10325
 10326     IF CC-LF-BENEFIT-CD NOT = SPACES
 10327         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10328                                     DET-LF-BEN-CD
 10329     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010S.cbl
 10330         MOVE SPACES             TO DET-LF-BEN-CD.
 10331
 10332     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10333         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10334                                     DET-LF-PREM
 10335     ELSE
 10336         MOVE ZEROS              TO DET-LF-PREM.
 10337
 10338     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10339         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10340                                     DET-LF-BEN
 10341     ELSE
 10342         MOVE ZEROS              TO DET-LF-BEN.
 10343
 10344     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10345        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10346        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10347         MOVE DET-PR-UREC-5          TO TR-DTL2
 10348         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10349         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10350
 10351     IF CC-AH-BENEFIT-CD NOT = SPACES
 10352         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10353                                     DET-AH-BEN-CD
 10354     ELSE
 10355         MOVE SPACES             TO DET-AH-BEN-CD.
 10356
 10357     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10358         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10359                                     DET-AH-PREM
 10360     ELSE
 10361         MOVE ZEROS              TO DET-AH-PREM.
 10362
 10363     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10364         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10365                                     DET-AH-BEN
 10366     ELSE
 10367         MOVE ZEROS              TO DET-AH-BEN.
 10368
 10369     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10370        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10371        CC-AH-BENEFIT-AMT NOT = ZEROS
 10372         MOVE DET-PR-UREC-6          TO TR-DTL2
 10373         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10374         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10375
 10376 0990-END-CHANGE-PROCESSING.
 10377
 10378     IF CR-LNAME = ALL '*'
 10379         MOVE SPACES                 TO CR-LNAME.
 10380     IF CR-FNAME = ALL '*'
 10381         MOVE SPACES                 TO CR-FNAME.
 10382     IF CR-INIT = '*'
 10383         MOVE SPACES                 TO CR-INIT.
 10384     IF CR-SOC-SEC = ALL '*'
 10385         MOVE SPACES                 TO CR-SOC-SEC.
 10386     IF CR-JT-LNAME = ALL '*'
 10387         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010S.cbl
 10388     IF CR-JT-FNAME = ALL '*'
 10389         MOVE SPACES                 TO CR-JT-FNAME.
 10390     IF CR-JT-INIT = '*'
 10391         MOVE SPACES                 TO CR-JT-INIT.
 10392     IF CR-POLICY-FORM-NO = ALL '*'
 10393         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10394     IF CR-MEMBER-NO = ALL '*'
 10395         MOVE SPACES                 TO CR-MEMBER-NO.
 10396     IF CR-LOAN-OFFICER = ALL '*'
 10397         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10398     IF CR-USER-CODE = ALL '*'
 10399         MOVE SPACES                 TO CR-USER-CODE.
 10400
 10401     ADD +1 TO BC-G-CTN.
 10402     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010S.cbl
 10404******************************************************************
 10405***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 10406******************************************************************
 10407
 10408 1000-SET-COMMISSION-STRUCTURE.
 10409
 10410     MOVE +1                     TO IA
 10411                                    IB.
 10412
 10413 1100-GET-COMMISSION-LEVEL.
 10414
 10415     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 10416
 10417     IF WK-AGT = '0000000000' OR SPACES
 10418         MOVE +0                 TO WK-L-RT
 10419                                    WK-J-RT
 10420                                    WK-A-RT
 10421         GO TO 1200-SET-COMMISSION-LEVEL.
 10422
 10423 1110-LIFE-COMMISSION.
 10424
 10425     IF CR-LFTYP = ZERO  OR
 10426       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10427         MOVE +0 TO WK-L-RT
 10428                    WK-J-RT
 10429         GO TO 1130-A-H-COMMISSION.
 10430
 10431     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10432         GO TO 1120-JOINT-LIFE-COMMISSION.
 10433
 10434     IF WK-L-RT NUMERIC
 10435        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 10436         MOVE WK-L-RT                TO WS-COMMISSION
 10437         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10438         MOVE WS-COMMISSION          TO WK-L-RT
 10439         GO TO 1130-A-H-COMMISSION.
 10440
 10441     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10442     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10443     MOVE ZEROS                      TO WS-SUB1.
 10444     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10445
 10446     IF WS-SUB1 = ZEROS
 10447         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 10448     ELSE
 10449         MOVE WK-RATE                TO WK-L-RT
 10450         GO TO 1130-A-H-COMMISSION.
 10451
 10452     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10453
 10454     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10455     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10456     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10457     MOVE WK-RATE                    TO WK-L-RT.
 10458
 10459     GO TO 1130-A-H-COMMISSION.
 10460
 10461 1120-JOINT-LIFE-COMMISSION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010S.cbl
 10462
 10463     IF WK-J-RT NUMERIC
 10464        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 10465         MOVE WK-J-RT                TO WS-COMMISSION
 10466         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10467         MOVE WS-COMMISSION          TO WK-J-RT
 10468         GO TO 1130-A-H-COMMISSION.
 10469
 10470     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10471     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10472     MOVE ZEROS                      TO WS-SUB1.
 10473     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10474
 10475     IF WS-SUB1 = ZEROS
 10476         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 10477     ELSE
 10478         MOVE WK-RATE                TO WK-J-RT
 10479         GO TO 1130-A-H-COMMISSION.
 10480
 10481     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10482
 10483     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10484     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10485     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10486     MOVE WK-RATE                    TO WK-J-RT.
 10487
 10488 1130-A-H-COMMISSION.
 10489
 10490     IF CR-AHTYP = ZERO  OR
 10491       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10492         MOVE +0 TO WK-A-RT
 10493         GO TO 1200-SET-COMMISSION-LEVEL.
 10494
 10495     IF WK-A-RT NUMERIC
 10496        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 10497         MOVE WK-A-RT                TO WS-COMMISSION
 10498         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10499         MOVE WS-COMMISSION          TO WK-A-RT
 10500         GO TO 1200-SET-COMMISSION-LEVEL.
 10501
 10502     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 10503     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 10504     MOVE ZEROS                      TO WS-SUB1.
 10505     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10506
 10507     IF WS-SUB1 = ZEROS
 10508         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 10509     ELSE
 10510         MOVE WK-RATE                TO WK-A-RT
 10511         GO TO 1200-SET-COMMISSION-LEVEL.
 10512
 10513     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10514
 10515     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 10516     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 10517     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10518     MOVE WK-RATE                    TO WK-A-RT.
 10519
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010S.cbl
 10520 1200-SET-COMMISSION-LEVEL.
 10521
 10522     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 10523     IF WK-AGT = '0000000000' OR SPACES
 10524         MOVE SPACE                   TO WK-N-TYPE (IA)
 10525     ELSE
 10526         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 10527
 10528     IF CR-LFTYP = ZERO
 10529         MOVE +0                      TO WK-L-RT1  (IA)
 10530     ELSE
 10531         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10532             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 10533         ELSE
 10534             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 10535
 10536     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 10537
 10538     IF RC-COMM-FLG = 'X'
 10539        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 10540           OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 10541              AND (IA = +5))
 10542            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 10543            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 10544            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 10545            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 10546
 10547     IF IA LESS THAN +10
 10548         ADD +1 TO IA
 10549         GO TO 1100-GET-COMMISSION-LEVEL.
 10550
 10551     GO TO 1499-SET-COMM-X.
 10552
 10553 1300-READ-ERCTBL-FILE.
 10554
 10555     IF CTBL-SEARCH = LAST-CTBL
 10556         GO TO 1399-READ-ERCTBL-X.
 10557
 10558     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 10559
 10560     IF COMM-OPEN-SW = ' '
 10561         MOVE 'X'                        TO COMM-OPEN-SW
 10562         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 10563         OPEN INPUT ERCTBL
 10564         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 10565             NEXT SENTENCE
 10566            ELSE
 10567             MOVE '41'                   TO ABEND-CODE-1
 10568             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 10569             DISPLAY '******************************'
 10570             DISPLAY '***** ERROR LOCATION 012 *****'
 10571             DISPLAY '******************************'
 10572             DISPLAY '******************************'
 10573             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 10574             GO TO ABEND-PGM.
 10575
 10576     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 10577                                            LAST-CTBL.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010S.cbl
 10578     READ ERCTBL.
 10579
 10580     IF ERCTBL-FILE-STATUS = '23'
 10581         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 10582                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 10583                 ' CTBL: ' CTBL-SEARCH
 10584         MOVE '*'                TO CTBL-ERROR-SWITCH
 10585         MOVE '44'               TO ABEND-CODE-1
 10586         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 10587         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 10588         DISPLAY '******************************'
 10589         DISPLAY '***** ERROR LOCATION 013 *****'
 10590         DISPLAY '******************************'
 10591         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 10592*        IF DTE-CLIENT NOT = 'NCL'
 10593         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
 10594             GO TO ABEND-PGM
 10595         ELSE
 10596             NEXT SENTENCE
 10597     ELSE
 10598         IF ERCTBL-FILE-STATUS NOT = '00'
 10599             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 10600             MOVE '44'               TO ABEND-CODE-1
 10601             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 10602             DISPLAY '******************************'
 10603             DISPLAY '***** ERROR LOCATION 014 *****'
 10604             DISPLAY '******************************'
 10605             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 10606             GO TO ABEND-PGM.
 10607
 10608     ADD +1                            TO ERCTBL-READS.
 10609
 10610 1399-READ-ERCTBL-X.
 10611     EXIT.
 10612
 10613 1400-GET-COMM-PERCENT.
 10614
 10615     IF CTBL-ERROR
 10616         MOVE ZEROS                      TO WK-RATE
 10617         GO TO 1489-GET-PERCENT-X.
 10618
 10619     MOVE +1 TO IB.
 10620     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 10621        (CT-TBF (1) NOT EQUAL +9999999.99)
 10622         ADD +9 TO IB
 10623         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 10624            (CT-TBF (2) NOT EQUAL +9999999.99)
 10625             ADD +9 TO IB.
 10626
 10627     IF CR-AGE GREATER CT-AGE (1)
 10628         ADD +3 TO IB
 10629         IF CR-AGE GREATER CT-AGE (2)
 10630             ADD +3 TO IB.
 10631
 10632     IF WS-COMM-TERM GREATER CT-TRM (1)
 10633         ADD +1 TO IB
 10634         IF WS-COMM-TERM GREATER CT-TRM (2)
 10635             ADD +1 TO IB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010S.cbl
 10636
 10637     IF CT-RT (IB) NOT NUMERIC
 10638         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 10639         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 10640         GO TO 1300-READ-ERCTBL-FILE.
 10641
 10642     MOVE CT-RT (IB) TO WK-RATE.
 10643
 10644 1489-GET-PERCENT-X.
 10645     EXIT.
 10646
 10647 1499-SET-COMM-X.
 10648     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010S.cbl
 10650******************************************************************
 10651***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 10652******************************************************************
 10653
 10654 1500-GET-ACCT-LEVEL-LF-COMM.
 10655
 10656     MOVE ZEROS                      TO ACCT-COMM-LF
 10657                                        ACCT-COMM-AH.
 10658
 10659     MOVE +1                         TO IA.
 10660
 10661 1510-ACCT-LEVEL-LOOP.
 10662
 10663     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 10664         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 10665             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 10666             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 10667         ELSE
 10668             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 10669                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 10670
 10671     IF IA LESS THAN +10
 10672         ADD +1 TO IA
 10673         GO TO 1510-ACCT-LEVEL-LOOP.
 10674
 10675 1519-ACCT-LF-COMM-X.
 10676     EXIT.
 10677
 10678
 10679 1550-GET-ACCT-LEVEL-AH-COMM.
 10680
 10681     MOVE ZEROS                      TO ACCT-COMM-AH.
 10682
 10683     MOVE +1                         TO IA.
 10684
 10685 1555-ACCT-LEVEL-LOOP.
 10686
 10687     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 10688         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 10689             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 10690
 10691     IF IA LESS THAN +10
 10692         ADD +1 TO IA
 10693         GO TO 1555-ACCT-LEVEL-LOOP.
 10694
 10695 1599-ACCT-AH-COMM-X.
 10696     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010S.cbl
 10698******************************************************************
 10699***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 10700******************************************************************
 10701
 10702 1600-RECALC-COMM-EXTR.
 10703
 10704     IF RC-COMM-FLG = 'X'  OR
 10705        (DTE-PGM-OPT = '2'  OR  '3')  OR
 10706        CR-POLICY-IS-DECLINED  OR
 10707        CR-POLICY-IS-VOID
 10708         GO TO 1899-RECALC-COMM-EXTR-X.
 10709
 10710     MOVE 'X'                           TO RC-COMM-FLG.
 10711
 10712     IF CR-ENTRY-DATE = EOM-RUN-DATE
 10713         GO TO 1899-RECALC-COMM-EXTR-X.
 10714
 10715     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 10716
 10717     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 10718         GO TO 1899-RECALC-COMM-EXTR-X.
 10719
 10720     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 10721
 10722     PERFORM 1610-CK-DUPLICATE-ENTRIES
 10723         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 10724             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 10725
 10726     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 10727         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 10728                                           WK-NEW-RATES
 10729         GO TO 1899-RECALC-COMM-EXTR-X.
 10730
 10731     MOVE +1                            TO SUB8.
 10732     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 10733
 10734 1610-CK-DUPLICATE-ENTRIES.
 10735     PERFORM 1620-CK-DUPL-ENTR-NEW
 10736         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 10737             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 10738
 10739 1619-CK-DUPLICATE-ENTRIES-XIT.
 10740     EXIT.
 10741
 10742 1620-CK-DUPL-ENTR-NEW.
 10743     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 10744         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 10745         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 10746         MOVE +0                        TO CR-LCOM-L (SUB11)
 10747                                           CR-LCOM-AH (SUB11)
 10748         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 10749         MOVE 11                        TO SUB12.
 10750
 10751 1629-CK-DUPL-ENTR-NEW-XIT.
 10752     EXIT.
 10753
 10754 1700-REVERSE-OLD-COMM-LOOP.
 10755     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010S.cbl
 10756     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 10757
 10758     IF SUB8 LESS THAN +10
 10759         ADD +1 TO SUB8
 10760         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 10761
 10762     MOVE 'O' TO RECALC-TYPE.
 10763
 10764     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 10765
 10766     GO TO 1800-MOVE-NEW-COMM-RATES.
 10767
 10768 1710-DO-R-C-EXTRACTS.
 10769
 10770     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 10771
 10772     PERFORM 1720-CHECK-COMM-LEVELS
 10773         THRU 1729-CHECK-COMM-LEVELS-EXIT
 10774             VARYING SUB13 FROM +1 BY +1
 10775                 UNTIL SUB13 GREATER THAN 10.
 10776
 10777     MOVE '8'                           TO DE-TRANS.
 10778     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 10779*****PERFORM EXTRACT-DATE-RELOAD.
 10780     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 10781     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 10782     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 10783     PERFORM EXTRACT-DATE-LOAD.
 10784     MOVE 'R'                           TO DE-REIN.
 10785     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 10786     MOVE +1                            TO SUB1.
 10787     PERFORM 3110-REINSURE-ISSUE-LOOP
 10788         THRU 3119-REINSURE-ISSUE-LOOP-END.
 10789
 10790     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 10791         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 10792                                       2259-END-CANCEL-BUILD
 10793         PERFORM 1720-CHECK-COMM-LEVELS
 10794             THRU 1729-CHECK-COMM-LEVELS-EXIT
 10795                 VARYING SUB13 FROM +1 BY +1
 10796                     UNTIL SUB13 GREATER THAN 10
 10797         MOVE '7'                       TO DE-TRANS
 10798         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 10799*********PERFORM EXTRACT-DATE-RELOAD
 10800         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 10801         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 10802         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 10803         PERFORM EXTRACT-DATE-LOAD
 10804         MOVE 'R'                       TO DE-REIN
 10805         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 10806         MOVE +1                        TO SUB1
 10807         PERFORM 3210-REINSURE-CANCEL-LOOP
 10808             THRU 3219-REINSURE-CANCEL-LOOP-END.
 10809
 10810 1719-DO-R-C-EXTRACTS-X.
 10811     EXIT.
 10812
 10813 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010S.cbl
 10814
 10815     IF  DE-AGT (SUB13)       =  SPACES  AND
 10816         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 10817         DE-L-PC (SUB13)      =  ZEROS   AND
 10818         DE-A-PC (SUB13)      =  ZEROS
 10819         MOVE '0000000000'        TO  DE-AGT (SUB13).
 10820
 10821 1729-CHECK-COMM-LEVELS-EXIT.
 10822     EXIT.
 10823
 10824 1800-MOVE-NEW-COMM-RATES.
 10825     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 10826     MOVE 'N'                           TO RECALC-TYPE.
 10827     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 10828     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 10829                                           CR-COMPENSATION-LEVELS.
 10830     IF DTE-CLIENT = 'DCC'
 10831        IF CR-LF-NSP-PRM NOT = ZEROS
 10832           COMPUTE CR-LF-NSP-PRM ROUNDED =
 10833              (CR-LFPRM + CR-LFPRM-ALT) -
 10834              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 10835        END-IF
 10836        IF CR-AH-NSP-PRM NOT = ZEROS
 10837           COMPUTE CR-AH-NSP-PRM ROUNDED =
 10838           CR-AHPRM -
 10839           (CR-AHPRM * CR-LCOM-AH (1))
 10840        END-IF
 10841     END-IF
 10842     .
 10843
 10844 1899-RECALC-COMM-EXTR-X.
 10845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010S.cbl
 10847******************************************************************
 10848***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 10849******************************************************************
 10850
 10851 2000-INITIALIZE-DETAIL-EXTRACT.
 10852
 10853     MOVE SPACES                   TO DETAIL-EXTRACT.
 10854
 10855     MOVE 'DE'                     TO DE-RECORD-ID.
 10856     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 10857     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 10858
 10859     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 10860     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 10861
 10862     MOVE CR-NAME                  TO DE-NAME.
 10863     MOVE CR-AGE                   TO DE-AGE.
 10864     MOVE CR-SEX                   TO DE-SEX.
 10865     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 10866
 10867     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 10868     MOVE CR-LF-TERM               TO DE-LF-TERM.
 10869     MOVE CR-LFAMT                 TO DE-LF-BEN.
 10870     MOVE ZEROS                    TO DE-LF-CNBEN.
 10871     MOVE CR-LFPRM                 TO DE-LF-PRM.
 10872     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 10873     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 10874     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 10875     MOVE ZEROS                    TO DE-LF-RFND.
 10876
 10877     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 10878     MOVE ZEROS                    TO DE-LF-CANC-DTE
 10879                                      DE-LF-CANC-EXIT-DT.
 10880
 10881     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 10882     MOVE CR-AH-TERM               TO DE-AH-TERM.
 10883     MOVE CR-AHAMT                 TO DE-AH-BEN.
 10884     MOVE CR-AHPRM                 TO DE-AH-PRM.
 10885     MOVE ZEROS                    TO DE-AH-RFND.
 10886
 10887     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 10888     MOVE ZEROS                    TO DE-AH-CANC-DTE
 10889                                      DE-AH-CANC-EXIT-DT.
 10890     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 10891
 10892     IF DTE-CLIENT = 'DCC'
 10893        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 10894     ELSE
 10895        IF (CR-LFTYP NOT = ZERO   AND
 10896           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 10897           (CR-AHTYP NOT = ZERO  AND
 10898           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 10899           MOVE CR-LIVES           TO DE-LIVES
 10900           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 10901                                      DE-CANCEL-CNT-YTD
 10902        END-IF
 10903     END-IF
 10904
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010S.cbl
 10905     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 10906     IF AM-ZIP-PRIME NUMERIC
 10907        MOVE AM-ZIP-PRIME          TO DE-ZIP
 10908      ELSE
 10909        MOVE ZEROS                 TO DE-ZIP.
 10910     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 10911
 10912     MOVE CR-APR                   TO DE-APR.
 10913     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 10914     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 10915     MOVE CR-IND-GRP               TO DE-IG.
 10916     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 10917     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 10918
 10919     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 10920     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 10921
 10922     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 10923     IF (CR-ENTRY-BATCH (1:2) = 'BL')
 10924        OR (CR-LF-EXIT-BATCH (1:2) = 'BL')
 10925        OR (CR-AH-EXIT-BATCH (1:2) = 'BL')
 10926        MOVE 'BLL'                 TO DE-NCL-POOL-CODE
 10927     END-IF
 10928*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 10929
 10930     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 10931                                      DE-REI-AHAMT  DE-REI-AHPRM
 10932                                      DE-REI-LFRFND DE-REI-AHRFND
 10933                                      DE-REI-CNAMT.
 10934
 10935     MOVE +1                       TO SUB1.
 10936
 10937     PERFORM EXTRACT-DATE-LOAD.
 10938
 10939     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 10940                                      WS-DE-INCUR-N
 10941                                      WS-DE-PAY-N
 10942                                      WS-DE-PAID-TO-N
 10943                                      WS-DE-ACC-EXP-DTE-N
 10944                                      WS-DE-ACC-EFF-DTE-N
 10945                                      WS-DE-RSV-INCUR-N
 10946                                      WS-DE-RSV-PAYTO-N
 10947                                      WS-DE-ACC-EXP-DTE-RSV-N
 10948                                      WS-DE-ACC-EFF-DTE-RSV-N.
 10949
 10950 2090-GL-CODE-LOOP.
 10951
 10952     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 10953
 10954     IF SUB1 LESS THAN +10
 10955         ADD +1 TO SUB1
 10956         GO TO 2090-GL-CODE-LOOP.
 10957
 10958     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 10959
 10960     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
 10961
 10962 2099-INIT-DTL-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010S.cbl
 10963     EXIT.
 10964
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010S.cbl
 10966******************************************************************
 10967***            B U I L D   I S S U E   E X T R A C T           ***
 10968******************************************************************
 10969
 10970 2100-BUILD-ISSUE-EXTRACT.
 10971
 10972     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 10973
 10974     MOVE 'I'                      TO DE-TRANS.
 10975
 10976     IF CHECK-BILLED
 10977         MOVE 'N' TO BILLED-SWITCH
 10978     ELSE
 10979         GO TO 2190-WRITE-ISSUE-EXTRACT.
 10980
 10981     MOVE +1                        TO SUB1.
 10982 2150-GA-BILL-LOOP.
 10983
 10984     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 10985         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 10986
 10987     IF SUB1 LESS THAN +5
 10988         ADD +1 TO SUB1
 10989         GO TO 2150-GA-BILL-LOOP.
 10990
 10991     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 10992     MOVE ZEROS                     TO DE-BILLED-LFPRM
 10993                                       DE-BILLED-LFRFND
 10994                                       DE-BILLED-AHPRM
 10995                                       DE-BILLED-AHRFND.
 10996
 10997     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 10998         IF PB-LF-BILLED-AMTS = ZERO  AND
 10999            PB-AH-BILLED-AMTS = ZERO
 11000             MOVE ' '                    TO DE-BILL-STATUS
 11001         ELSE
 11002             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11003                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11004                 MOVE 'B'                TO DE-BILL-STATUS
 11005             ELSE
 11006                 MOVE 'R'                TO DE-BILL-STATUS
 11007                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11008                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11009     ELSE
 11010         MOVE 'B'                        TO DE-BILL-STATUS.
 11011
 11012 2190-WRITE-ISSUE-EXTRACT.
 11013
 11014     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11015
 11016 2199-BLD-ISSUE-X.
 11017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010S.cbl
 11019******************************************************************
 11020***           B U I L D   C A N C E L   E X T R A C T          ***
 11021******************************************************************
 11022
 11023 2200-BUILD-CANCEL-EXTRACT.
 11024
 11025     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11026
 11027     MOVE 'C'                           TO DE-TRANS.
 11028
 11029     IF CR-LFTYP = ZERO
 11030         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11031
 11032     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11033         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11034             CR-LFRFND = +0
 11035              MOVE +0                   TO TEMP-5
 11036              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11037
 11038     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11039          IF CR-LFRFND = +0
 11040              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11041
 11042     MOVE +1 TO TEMP-5.
 11043     MOVE CR-LF-TERM             TO ORIG-TERM.
 11044     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11045     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11046     MOVE '1'                    TO W-VAL-SOURCE.
 11047     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11048
 11049     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11050         MOVE CR-LFAMT TO DE-LF-CNBEN
 11051         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11052
 11053     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11054         GO TO 2220-BLD-DE-CANCEL-SUM.
 11055
 11056     IF REM-TRM3 = CR-LF-TERM
 11057         MOVE CR-LFAMT TO DE-LF-CNBEN
 11058         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11059
 11060     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11061         GO TO 2210-BLD-DE-CANCEL-TEX.
 11062
 11063     IF DTE-CLIENT = 'NCL'
 11064         IF CR-DT LESS THAN 19910101
 11065             GO TO 2205-BLD-DE-CANCEL-BEN.
 11066
 11067     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11068         GO TO 2230-BLD-DE-CANCEL-NP.
 11069
 11070     IF DTE-CLIENT = 'FUL'
 11071         GO TO 2240-BLD-DE-CANCEL-FUL.
 11072
 11073*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11074     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11075        (CR-RATING-CLASS NOT = 'L ')
 11076         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010S.cbl
 11077            (CR-LF-TERM GREATER THAN 060)  AND
 11078            (CR-DT GREATER THAN 19831031)
 11079              GO TO 2230-BLD-DE-CANCEL-NP.
 11080
 11081     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11082         IF (CR-APR GREATER THAN ZERO)  AND
 11083            (CR-LF-TERM GREATER THAN 061)  AND
 11084            (CR-DT GREATER THAN 19830318)
 11085              GO TO 2230-BLD-DE-CANCEL-NP.
 11086
 11087     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11088         IF (CR-APR GREATER THAN ZERO)  AND
 11089            (CR-LF-TERM GREATER THAN 062)  AND
 11090            (CR-DT GREATER THAN 19810831)  AND
 11091            (CR-DT LESS THAN 19830901)
 11092              GO TO 2230-BLD-DE-CANCEL-NP.
 11093
 11094     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11095         IF (CR-APR GREATER THAN ZERO)  AND
 11096            (CR-LF-TERM GREATER THAN 060)  AND
 11097            (CR-DT GREATER THAN 19831231)
 11098              GO TO 2230-BLD-DE-CANCEL-NP.
 11099
 11100 2205-BLD-DE-CANCEL-BEN.
 11101
 11102     IF CR-LF-TERM EQUAL +0
 11103         MOVE +0          TO TEMP-5
 11104     ELSE
 11105         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11106
 11107     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11108
 11109     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11110
 11111 2210-BLD-DE-CANCEL-TEX.
 11112
 11113     DIVIDE CR-LFAMT BY CR-LF-TERM
 11114         GIVING TEX-FACT-1.
 11115     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11116         GIVING TEX-FACT-2
 11117             REMAINDER TEX-FACT-3.
 11118     IF TEX-FACT-3 NOT = ZERO
 11119         ADD +1 TO TEX-FACT-2.
 11120     COMPUTE DE-LF-CNBEN =
 11121         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11122
 11123     IF CR-LFAMT EQUAL +0
 11124         MOVE +0                  TO TEMP-5
 11125     ELSE
 11126         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11127
 11128     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11129
 11130 2220-BLD-DE-CANCEL-SUM.
 11131
 11132     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11133     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11134
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010S.cbl
 11135     IF CR-LFRFND NOT LESS CR-LFPRM
 11136         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11137          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11138
 11139     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11140     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11141     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11142         MOVE TEMP-7             TO DE-LF-CNBEN
 11143       ELSE
 11144         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11145         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11146
 11147     IF CR-LFAMT EQUAL +0
 11148         MOVE +0                  TO TEMP-5
 11149     ELSE
 11150         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11151
 11152     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11153         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11154
 11155 2230-BLD-DE-CANCEL-NP.
 11156
 11157     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11158     MOVE 'L'                        TO  DC-OPTION-CODE.
 11159     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11160     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11161
 11162     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11163       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11164       MOVE '3'                      TO  DC-OPTION-CODE
 11165       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11166       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11167     ELSE
 11168       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11169       MOVE '6'                      TO  DC-OPTION-CODE
 11170       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11171       MOVE +0                       TO  DC-ELAPSED-DAYS
 11172       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11173       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11174
 11175     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11176     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11177     MOVE CR-APR                     TO  CP-LOAN-APR.
 11178     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11179     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11180     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11181     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11182     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11183     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11184
 11185     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11186
 11187     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11188         COMPUTE DE-LF-CNBEN =
 11189                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11190      ELSE
 11191          COMPUTE DE-LF-CNBEN =
 11192                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010S.cbl
 11193
 11194     IF CR-LFAMT EQUAL +0
 11195         MOVE +0                  TO TEMP-5
 11196     ELSE
 11197         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11198
 11199     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11200
 11201 2240-BLD-DE-CANCEL-FUL.
 11202
 11203     MOVE CR-APR                  TO NP-APR.
 11204     MOVE CR-LF-TERM              TO NP-ORIG.
 11205     MOVE REM-TRM3                TO NP-REM.
 11206     MOVE '2'                     TO NP-OPT.
 11207     MOVE CR-AHPRM                TO NP-AHPRM.
 11208     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11209     MOVE CR-LFAMT                TO NP-BENEFIT.
 11210
 11211*    CALL 'FULNETRM'
 11212*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11213*              NP-ACCOUNT NP-REMAINING.
 11214
 11215     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11216
 11217     IF CR-LFAMT EQUAL +0
 11218         MOVE +0                  TO TEMP-5
 11219     ELSE
 11220         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11221
 11222 2250-CONTINUE-CANCEL-BUILD.
 11223
 11224     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11225     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11226     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11227                                         WS-DE-LF-CANC-DTE-N.
 11228     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11229                                         WS-DE-LF-CANC-EXIT-DT-N.
 11230     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11231
 11232     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11233
 11234     IF DTE-CLIENT = 'DCC'
 11235        IF DE-AH-RFND = ZEROS
 11236           MOVE ZEROS                 TO DE-ADDL-CLP
 11237        END-IF
 11238     END-IF
 11239
 11240     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11241     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11242                                         WS-DE-AH-CANC-DTE-N.
 11243     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11244                                         WS-DE-AH-CANC-EXIT-DT-N.
 11245     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11246
 11247     IF PB-LAST-MAINT-BY = 'E570'
 11248         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11249
 11250     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010S.cbl
 11251         MOVE 'N' TO BILLED-SWITCH
 11252     ELSE
 11253         GO TO 2259-END-CANCEL-BUILD.
 11254
 11255     MOVE +1                        TO SUB1.
 11256 2255-GA-BILL-LOOP.
 11257
 11258     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11259         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11260
 11261     IF SUB1 LESS THAN +5
 11262         ADD +1 TO SUB1
 11263         GO TO 2255-GA-BILL-LOOP.
 11264
 11265     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11266     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11267     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11268                                       DE-BILLED-LFRFND
 11269                                       DE-BILLED-AHPRM
 11270                                       DE-BILLED-AHRFND.
 11271
 11272     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11273         IF PB-LF-BILLED-AMTS = ZERO  AND
 11274            PB-AH-BILLED-AMTS = ZERO
 11275             MOVE ' '                    TO DE-BILL-STATUS
 11276         ELSE
 11277             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11278                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11279                 MOVE 'B'                TO DE-BILL-STATUS
 11280             ELSE
 11281                 MOVE 'R'                TO DE-BILL-STATUS
 11282                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11283                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11284     ELSE
 11285         MOVE 'B'                        TO DE-BILL-STATUS.
 11286
 11287 2259-END-CANCEL-BUILD.
 11288     EXIT.
 11289
 11290 2290-WRITE-CANCEL-EXTRACT.
 11291
 11292     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11293
 11294 2299-BLD-CANCEL-X.
 11295     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010S.cbl
 11297******************************************************************
 11298***            B U I L D   C L A I M   E X T R A C T           ***
 11299******************************************************************
 11300
 11301 2300-BUILD-CLAIM-EXTRACT.
 11302
 11303     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11304
 11305     MOVE 'X'                       TO DE-TRANS.
 11306
 11307     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11308
 11309     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 11310     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 11311
 11312     MOVE INCURRED-DATE             TO DE-INCUR
 11313                                       WS-DE-INCUR-N.
 11314     MOVE REPORTED-DATE             TO DE-REPORTED.
 11315     MOVE PAYMENT-DATE              TO DE-PAY
 11316                                       WS-DE-PAY-N.
 11317     MOVE PAY-TO-DATE               TO DE-PAID-TO
 11318                                       WS-DE-PAID-TO-N.
 11319
 11320     MOVE PC-CLAIM-NO               TO DE-CNUM.
 11321     MOVE PC-CHECK-NO               TO DE-CHECK.
 11322     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 11323     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 11324     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 11325     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 11326     INSPECT DE-PAY-CODE
 11327         CONVERTING '1234569' TO 'PFSXEEV'.
 11328
 11329     MOVE AM-NAME                   TO DE-ACC-NAME.
 11330     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 11331                                       WS-DE-ACC-EXP-DTE-N.
 11332     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 11333                                       WS-DE-ACC-EFF-DTE-N.
 11334     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 11335     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 11336
 11337     IF DE-DTH  OR  DE-OB-DTH
 11338         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 11339     ELSE
 11340         IF CR-AH-LUMP-SUM-DISAB
 11341             MOVE CR-AH-STATUS-AT-SETTLEMENT
 11342                                    TO DE-AH-PREV-STAT.
 11343
 11344     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11345         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11346
 11347 2390-WRITE-CLAIM-EXTRACT.
 11348
 11349     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11350
 11351 2399-BLD-CLAIM-X.
 11352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010S.cbl
 11354******************************************************************
 11355***          B U I L D   R E S E R V E   E X T R A C T         ***
 11356******************************************************************
 11357
 11358 2400-BUILD-RESERVE-EXTRACT.
 11359
 11360     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11361
 11362     MOVE 'Y'                         TO DE-TRANS.
 11363     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 11364
 11365     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 11366     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 11367     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 11368     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 11369
 11370     IF DTE-CLIENT  =  'NCL'
 11371        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 11372            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 11373
 11374     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 11375
 11376     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 11377                                         WS-DE-ACC-EXP-DTE-RSV-N.
 11378
 11379     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 11380                                         WS-DE-ACC-EFF-DTE-RSV-N.
 11381
 11382     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 11383                                         WS-DE-RSV-INCUR-N.
 11384     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 11385     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 11386                                         WS-DE-RSV-PAYTO-N.
 11387
 11388     MOVE ZEROS                       TO DE-REI-IBNR
 11389                                         DE-REI-PAYCUR
 11390                                         DE-REI-FUTRSV.
 11391
 11392     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 11393
 11394     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11395         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11396
 11397 2490-WRITE-RESERVE-EXTRACT.
 11398
 11399     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11400
 11401 2499-BLD-RESERVE-X.
 11402     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010S.cbl
 11404******************************************************************
 11405***          W R I T E   D E T A I L   E X T R A C T S         ***
 11406******************************************************************
 11407
 11408 2500-WRITE-DETAIL-EXTRACTS.
 11409
 11410
 11411     MOVE  ZEROS            TO  SUB.
 11412
 11413     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 11414         GO TO 2520-WRITE-CONTINUE.
 11415
 11416 2510-ZERO-CHARGEBACK-LOOP.
 11417
 11418     ADD  +1                TO  SUB.
 11419
 11420     IF  SUB    GREATER  THAN     +10
 11421         GO TO  2520-WRITE-CONTINUE.
 11422
 11423*    DISPLAY ' CERT NO ' CR-CERT-NO
 11424*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 11425*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 11426
 11427
 11428     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 11429         MOVE  ZEROS            TO  DE-L-PC (SUB).
 11430
 11431     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 11432         OR (CR-AH-REFUND-TYPE = 'G')
 11433         MOVE  ZEROS             TO DE-A-PC (SUB)
 11434     END-IF
 11435
 11436     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 11437
 11438 2520-WRITE-CONTINUE.
 11439
 11440     IF DTE-CLIENT NOT = 'HER'
 11441         GO TO 2590-WRITE-EXTRACTS.
 11442
 11443     IF DE-REINCO NOT = 'LNL'
 11444         GO TO 2590-WRITE-EXTRACTS.
 11445
 11446     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 11447         GO TO 2590-WRITE-EXTRACTS.
 11448
 11449     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 11450     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 11451     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 11452     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 11453     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 11454     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 11455     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 11456     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 11457     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 11458     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 11459
 11460     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 11461     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010S.cbl
 11462     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 11463     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 11464     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 11465     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 11466     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 11467     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 11468     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 11469     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 11470
 11471
 11472 2590-WRITE-EXTRACTS.
 11473
 11474     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 11475                                     WS-DE-PROC-DT-N.
 11476
 11477     IF DTE-PGM-OPT = '1'
 11478         ADD +1                   TO DE-CNT
 11479*********PERFORM EXTRACT-DATE-RELOAD
 11480         WRITE DETAIL-EXTRACT.
 11481
 11482
 11483 2599-WRT-DETAIL-X.
 11484     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010S.cbl
 11486******************************************************************
 11487***         R E I N S U R A N C E   P R O C E S S I N G        ***
 11488******************************************************************
 11489
 11490 3000-REINSURE-ROUTINE.
 11491
 11492     IF (CR-POLICY-IS-DECLINED) OR
 11493        (CR-POLICY-IS-VOID)
 11494        GO TO 3099-REINSURE-ROUTINE-X.
 11495
 11496     IF REIN-FLG = 'X'
 11497         GO TO 3099-REINSURE-ROUTINE-X.
 11498
 11499     MOVE 'X' TO REIN-FLG.
 11500
 11501     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 11502
 11503     IF CR-REIN-TABLE = SPACES OR ZEROS
 11504         GO TO 3030-RE-CALCULATE-REINSURANCE.
 11505
 11506******************************************************************
 11507***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 11508******************************************************************
 11509
 11510 3010-RR-READ-REIN.
 11511
 11512     IF REIN-OPEN-SW = ' '
 11513         MOVE 'X'                       TO REIN-OPEN-SW
 11514         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 11515         MOVE 'A'                       TO REIN-SRCH-CODE
 11516         OPEN INPUT ERRTBL-IN
 11517         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 11518             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 11519          ELSE
 11520             MOVE '21'                  TO ABEND-CODE-1
 11521             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 11522             DISPLAY '******************************'
 11523             DISPLAY '***** ERROR LOCATION 015 *****'
 11524             DISPLAY '******************************'
 11525             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11526             GO TO ABEND-PGM.
 11527
 11528     IF CR-REIN-TABLE = REIN-SRCH
 11529         GO TO 3019-RR-READ-REIN-X.
 11530
 11531     MOVE +0                            TO REIN-SUB-1.
 11532     MOVE 999999                        TO REIN-LOW-TIME.
 11533     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 11534
 11535 3011-RR-CHECK-REIN-SAVE-TABLE.
 11536
 11537     ADD +1                             TO REIN-SUB-1.
 11538     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 11539        REIN-SUB-1 GREATER THAN REIN-SUB-2
 11540         GO TO 3015-RR-READ-ERRTBL.
 11541
 11542     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 11543         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010S.cbl
 11544         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11545         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 11546         GO TO 3019-RR-READ-REIN-X.
 11547
 11548     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 11549         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 11550         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 11551
 11552     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 11553
 11554 3015-RR-READ-ERRTBL.
 11555
 11556     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 11557
 11558     READ ERRTBL-IN.
 11559
 11560     IF ERRTBL-FILE-STATUS  = '23'
 11561         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 11562                                           ' ' CR-FULL-CONTROL
 11563         MOVE '24'                      TO ABEND-CODE-1
 11564         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 11565         DISPLAY '******************************'
 11566         DISPLAY '***** ERROR LOCATION 016 *****'
 11567         DISPLAY '******************************'
 11568         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11569         GO TO ABEND-PGM.
 11570
 11571     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 11572         NEXT SENTENCE
 11573       ELSE
 11574         MOVE '24'                      TO ABEND-CODE-1
 11575         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 11576         DISPLAY '******************************'
 11577         DISPLAY '***** ERROR LOCATION 017 *****'
 11578         DISPLAY '******************************'
 11579         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 11580         GO TO ABEND-PGM.
 11581
 11582     ADD +1                            TO ERRTBL-READS.
 11583
 11584     IF REIN-SUB-1 GREATER THAN REIN-MAX
 11585         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 11586         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11587         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 11588     ELSE
 11589         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 11590         ACCEPT WS-TIME-OF-DAY   FROM TIME
 11591         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 11592         MOVE REIN-SUB-1               TO REIN-SUB-2.
 11593
 11594 3019-RR-READ-REIN-X.
 11595     EXIT.
 11596
 11597 3020-CALCULATE-REINSURANCE.
 11598
 11599*    IF DTE-CLIENT = '???'  AND
 11600*       (CR-REIN-TABLE = 'SE1')
 11601*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010S.cbl
 11602*        IF CR-STATE NOT = STATE-L
 11603*            MOVE CR-STATE             TO STATE-L
 11604*            PERFORM 8200-STATE-CODE-LOOKUP
 11605*                         THRU 8299-STATE-LOOKUP-X.
 11606
 11607
 11608*    IF DTE-CLIENT = 'DCC'
 11609*       IF CR-LF-NSP-PRM NOT = ZEROS
 11610*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 11611*             (CR-LFPRM + CR-LFPRM-ALT) -
 11612*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11613*       END-IF
 11614*       IF CR-AH-NSP-PRM NOT = ZEROS
 11615*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 11616*          CR-AHPRM -
 11617*          (CR-AHPRM * CR-LCOM-AH (1))
 11618*       END-IF
 11619*    END-IF
 11620
 11621
 11622     IF RE-REMAINING (1) = 'I'
 11623         MOVE '*'                      TO RISK-REIN-FLAG
 11624     ELSE
 11625         GO TO 3029-CONTINUE-REIN-CALC.
 11626
 11627     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 11628                                          REIN-CANCEL-AH-SW.
 11629     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 11630                                          REIN-LCNC-EARN-TERM
 11631                                          REIN-LF-CLM-MONTHS
 11632                                          REIN-EARN-AH-TERM
 11633                                          REIN-ACNC-EARN-TERM
 11634                                          REIN-AH-PRIOR-CLMS-PAID
 11635                                          REIN-AH-CLM-MONTHS
 11636                                          REIN-AH-CLM-MTH-1
 11637                                          REIN-AH-CLM-MTH-2
 11638                                          REIN-AH-CLM-MTH-3
 11639                                          REIN-AH-CLM-MTH-4
 11640                                          REIN-AH-CLM-MTH-5.
 11641
 11642     MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 11643     MOVE 'L'                          TO DC-OPTION-CODE.
 11644     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11645     MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 11646
 11647     IF CR-LFTYP = ZEROS  OR  SPACES
 11648         GO TO 3023-CONTINUE.
 11649
 11650     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 11651
 11652     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 11653       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 11654           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 11655
 11656     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 11657       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 11658           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 11659
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010S.cbl
 11660     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 11661     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 11662
 11663     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 11664         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 11665     ELSE
 11666         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 11667
 11668     IF CR-LF-CANC-DT NOT = ZEROS
 11669         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 11670         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11671         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 11672         IF CR-DT = CR-LF-CANC-DT
 11673             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 11674
 11675     IF CR-DTH-DT NOT = ZEROS
 11676         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 11677         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11678         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 11679
 11680     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 11681
 11682
 11683 3023-CONTINUE.
 11684
 11685     IF CR-AHTYP = ZEROS  OR  SPACES
 11686        GO TO 3029-CONTINUE-REIN-CALC.
 11687
 11688     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 11689
 11690     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 11691       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 11692           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 11693
 11694     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 11695       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 11696           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 11697
 11698     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 11699     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 11700
 11701     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 11702         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 11703     ELSE
 11704         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 11705
 11706     IF CR-AH-CANC-DT NOT = ZEROS
 11707         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 11708         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11709         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 11710         IF CR-DT = CR-AH-CANC-DT
 11711             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 11712
 11713     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 11714         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 11715         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11716         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 11717
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010S.cbl
 11718     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 11719         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 11720         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11721         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 11722
 11723     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 11724         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 11725         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11726         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 11727
 11728     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 11729         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 11730         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11731         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 11732
 11733     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 11734         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 11735         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 11736         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 11737
 11738     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 11739
 11740
 11741     GO TO 3029-CONTINUE-REIN-CALC.
 11742
 11743
 11744 3025-CALC-ELAPSED-MONTHS.
 11745
 11746     MOVE 'L'                          TO DC-OPTION-CODE.
 11747     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11748     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 11749     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 11750     MOVE '1'                          TO DC-OPTION-CODE.
 11751     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 11752     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 11753                                          DC-ODD-DAYS-OVER
 11754                                          DC-ELAPSED-DAYS.
 11755     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11756
 11757 3026-CALC-EXIT.
 11758     EXIT.
 11759
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010S.cbl
 11761 3029-CONTINUE-REIN-CALC.
 11762
*11763                             COPY ECSRTPFM.
 11764******************************************************************07/10/97
 11765*                                                                *ECSRTPFM
 11766*                            ECSRTPFM                            *   LV001
 11767*                            VMOD=2.002                          *ECSRTPFM
 11768*                                                                *ECSRTPFM
 11769******************************************************************ECSRTPFM
 11770                                                                  ECSRTPFM
 11771     IF    CR-LFAMT  NUMERIC                                      00000072
 11772           NEXT SENTENCE                                          00000073
 11773        ELSE                                                      00000074
 11774           MOVE ZEROS TO CR-LFAMT.                                00000075
 11775                                                                  00000076
 11776     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 11777           NEXT SENTENCE                                          00000078
 11778        ELSE                                                      00000079
 11779           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 11780                                                                  00000081
 11781                                                                  00000082
 11782     IF    CR-LFPRM  NUMERIC                                      00000083
 11783           NEXT SENTENCE                                          00000084
 11784        ELSE                                                      00000085
 11785           MOVE ZEROS TO CR-LFPRM.                                00000086
 11786                                                                  00000087
 11787     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 11788           NEXT SENTENCE                                          00000089
 11789        ELSE                                                      00000090
 11790           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 11791                                                                  00000092
 11792                                                                  00000093
 11793     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 11794           NEXT SENTENCE                                          00000095
 11795        ELSE                                                      00000096
 11796           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 11797                                                                  00000098
 11798     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 11799           NEXT SENTENCE                                          00000100
 11800        ELSE                                                      00000101
 11801           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 11802                                                                  00000103
 11803     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 11804           NEXT SENTENCE                                          00000105
 11805        ELSE                                                      00000106
 11806           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 11807                                                                  00000108
 11808     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 11809     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 11810     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 11811         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 11812     ELSE                                                         ECSRTPFM
 11813         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 11814     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 11815                                                                  ECSRTPFM
 11816     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 11817     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 11818     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 11819         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 11820     ELSE                                                         ECSRTPFM
 11821         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 11822     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 11823                                                                  ECSRTPFM
 11824     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 11825         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 11826             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 11827                                                                  ECSRTPFM
 11828
 11829     MOVE 'X'                  TO REIN-RT-SW.
 11830     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 11831     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 11832     MOVE ' '                  TO REIN-RT-SW.
 11833
 11834 3030-RE-CALCULATE-REINSURANCE.
 11835
 11836     IF AM-RECALC-REIN = 'Y'
 11837         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 11838            CR-REIN-SPEC = SPACE  AND
 11839            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 11840             PERFORM 3600-RC-REINSURANCE
 11841                 THRU 3799-RC-REINSURANCE-X.
 11842
 11843     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 11844         VARYING SUB1 FROM 1 BY 1
 11845             UNTIL REIN-COMP (SUB1) = SPACES.
 11846
 11847     GO TO 3099-REINSURE-ROUTINE-X.
 11848
 11849 3040-REIN-REC-CNT.
 11850
 11851     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 11852         GO TO 3049-RRC-XIT.
 11853
 11854     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 11855         VARYING B-SUB FROM 1 BY 1
 11856             UNTIL B-SUB GREATER THAN 50.
 11857
 11858 3049-RRC-XIT.
 11859     EXIT.
 11860
 11861 3050-REIN-COMP-ADD.
 11862
 11863     IF RB-COMPANY (B-SUB) = SPACES
 11864         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 11865     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 11866         MOVE 1   TO RB-COUNT (B-SUB)
 11867         MOVE +50 TO B-SUB.
 11868
 11869 3059-RCA-XIT.
 11870     EXIT.
 11871
 11872 3099-REINSURE-ROUTINE-X.
 11873     EXIT.
 11874
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010S.cbl
 11876******************************************************************
 11877***                R E I N S U R E   I S S U E S               ***
 11878******************************************************************
 11879
 11880 3100-REINSURE-ISSUE.
 11881
 11882     IF  REIN-COMP (1) = SPACES
 11883         GO TO 3199-REINSURE-ISSUE-X.
 11884
 11885     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11886     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 11887     MOVE 'I'      TO DE-TRANS.
 11888     MOVE 'R'      TO DE-REIN.
 11889*****PERFORM EXTRACT-DATE-RELOAD.
 11890     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 11891     MOVE +1       TO SUB1.
 11892
 11893 3110-REINSURE-ISSUE-LOOP.
 11894
 11895     IF REIN-COMP (SUB1) = SPACES
 11896         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 11897
 11898     IF UPDATING-RISK-PREMIUMS
 11899       IF REIN-REM-SW (SUB1) NOT = 'I'
 11900         ADD +1 TO SUB1
 11901         GO TO 3110-REINSURE-ISSUE-LOOP.
 11902
 11903     IF REIN-REM-SW (SUB1) = 'Z'
 11904         ADD +1 TO SUB1
 11905         GO TO 3110-REINSURE-ISSUE-LOOP.
 11906
 11907     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 11908     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 11909     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 11910     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 11911     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 11912     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 11913
 11914     IF REIN-REM-SW (SUB1) NOT = 'I'
 11915         GO TO 3115-CONTINUE-ISSUE-LOOP.
 11916
 11917     IF RWF-LFPRM = ZEROS  AND
 11918        RWF-AHPRM = ZEROS
 11919         GO TO 3115-CONTINUE-ISSUE-LOOP.
 11920
 11921     IF RWF-LFPRM NOT = ZEROS
 11922         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 11923         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 11924
 11925     IF RWF-AHPRM NOT = ZEROS
 11926         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 11927         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 11928
 11929 3115-CONTINUE-ISSUE-LOOP.
 11930
 11931     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 11932     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 11933
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010S.cbl
 11934     IF DE-REI-LFAMT NOT = ZERO
 11935        OR DE-REI-LFPRM NOT = ZERO
 11936        OR DE-REI-AHAMT NOT = ZERO
 11937        OR DE-REI-AHPRM NOT = ZERO
 11938         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 11939                 2599-WRT-DETAIL-X
 11940         ADD +1 TO BC-R-ISS.
 11941
 11942     ADD +1 TO SUB1.
 11943     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 11944     PERFORM EXTRACT-DATE-LOAD.
 11945
 11946     GO TO 3110-REINSURE-ISSUE-LOOP.
 11947
 11948 3119-REINSURE-ISSUE-LOOP-END.
 11949     EXIT.
 11950
 11951 3190-REINSURE-ISSUE-PRINT.
 11952
 11953     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 11954     IF RW-ACCUM-LF NOT = ZERO
 11955         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 11956         MOVE CR-LF-TERM               TO TRD-LFTRM
 11957         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 11958         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 11959     IF RW-ACCUM-AH NOT = ZERO
 11960         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 11961         MOVE CR-AH-TERM               TO TRD-AHTRM
 11962         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 11963         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 11964     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 11965         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 11966
 11967 3199-REINSURE-ISSUE-X.
 11968     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010S.cbl
 11970******************************************************************
 11971***               R E I N S U R E   C A N C E L S              ***
 11972******************************************************************
 11973
 11974 3200-REINSURE-CANCEL.
 11975
 11976     IF REIN-COMP (1) = SPACES
 11977         GO TO 3299-REINSURE-CANCEL-X.
 11978
 11979     IF CR-LFRFND = ZERO
 11980        AND CR-AHRFND = ZERO
 11981         GO TO 3299-REINSURE-CANCEL-X.
 11982
 11983     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 11984             VARYING SUB1 FROM +1 BY +1 UNTIL
 11985                       REIN-COMP (SUB1) = SPACES.
 11986
 11987     IF REIN-RT-SW = 'X'
 11988         GO TO 3299-REINSURE-CANCEL-X.
 11989
 11990     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 11991     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 11992     MOVE 'R'      TO DE-REIN.
 11993*****PERFORM EXTRACT-DATE-RELOAD.
 11994     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 11995     MOVE +1       TO SUB1.
 11996
 11997 3210-REINSURE-CANCEL-LOOP.
 11998
 11999     IF REIN-COMP (SUB1) = SPACES
 12000         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12001
 12002     IF REIN-REM-SW (SUB1) = 'Z'
 12003         ADD +1        TO SUB1
 12004         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12005         PERFORM EXTRACT-DATE-LOAD
 12006         GO TO 3210-REINSURE-CANCEL-LOOP.
 12007
 12008     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12009     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12010
 12011     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12012     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12013     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12014     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12015     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12016     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12017     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12018     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12019     COMPUTE DE-REI-CNAMT = RWF-LFAMT * TEMP-5.
 12020
 12021     IF REIN-REM-SW (SUB1) NOT = 'I'
 12022         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12023
 12024     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12025        VOIDING-LF-CANCEL
 12026         NEXT SENTENCE
 12027     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010S.cbl
 12028         MOVE ZEROS             TO DE-REI-LFRFND.
 12029
 12030     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12031        VOIDING-AH-CANCEL
 12032         NEXT SENTENCE
 12033     ELSE
 12034         MOVE ZEROS             TO DE-REI-AHRFND.
 12035
 12036 3215-CONTINUE-CANCEL-LOOP.
 12037
 12038     IF RWF-LF-RUNOFF-SW = 'N'
 12039         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12040             MOVE ZEROS         TO DE-LF-TYPE
 12041                                   DE-REI-LFAMT
 12042                                   DE-REI-LFPRM
 12043                                   DE-REI-LFRFND
 12044                                   DE-REI-CNAMT.
 12045
 12046     IF RWF-AH-RUNOFF-SW = 'N'
 12047         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12048             MOVE ZEROS         TO DE-AH-TYPE
 12049                                   DE-REI-AHAMT
 12050                                   DE-REI-AHPRM
 12051                                   DE-REI-AHRFND.
 12052
 12053     IF DE-REI-LFAMT NOT = ZERO
 12054        OR DE-REI-LFPRM NOT = ZERO
 12055        OR DE-REI-AHAMT NOT = ZERO
 12056        OR DE-REI-AHPRM NOT = ZERO
 12057        OR DE-REI-LFRFND NOT = ZERO
 12058        OR DE-REI-AHRFND NOT = ZERO
 12059        OR DE-REI-CNAMT NOT = ZERO
 12060         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12061                                            2599-WRT-DETAIL-X
 12062         ADD +1 TO BC-R-CNC.
 12063
 12064     ADD +1 TO SUB1.
 12065     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12066     PERFORM EXTRACT-DATE-LOAD.
 12067     GO TO 3210-REINSURE-CANCEL-LOOP.
 12068
 12069 3219-REINSURE-CANCEL-LOOP-END.
 12070     EXIT.
 12071
 12072 3290-REINSURE-CANCEL-PRINT.
 12073
 12074     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12075     IF RW-ACCUM-LF NOT = ZERO
 12076         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12077         MOVE CR-LF-TERM               TO TRD-LFTRM
 12078         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12079         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12080     IF RW-ACCUM-AH NOT = ZERO
 12081         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12082         MOVE CR-AH-TERM               TO TRD-AHTRM
 12083         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12084         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12085     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010S.cbl
 12086         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12087
 12088 3299-REINSURE-CANCEL-X.
 12089     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010S.cbl
 12091******************************************************************
 12092***                R E I N S U R E   C L A I M S               ***
 12093******************************************************************
 12094
 12095 3300-REINSURE-CLAIM.
 12096
 12097*    IF DTE-CLIENT = '???'
 12098*       IF (REIN-RT-SW NOT = 'X')  AND
 12099*          (PC-PAYMENT-TYPE = '5' OR '6')
 12100*        GO TO 3399-REINSURE-CLAIM-X.
 12101
 12102     IF REIN-COMP (1) = SPACES
 12103         GO TO 3399-REINSURE-CLAIM-X.
 12104
 12105     IF REIN-RT-SW = 'X'
 12106         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12107         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12108         MOVE CR-DISAMT   TO RW-AHCLMWK
 12109         ADD  CR-DISEXP   TO RW-AHCLMWK
 12110     ELSE
 12111         IF PC-CLAIM-TYPE  = 1 OR 3
 12112             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12113             MOVE +0                  TO RW-AHCLMWK
 12114         ELSE
 12115             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12116             MOVE +0                  TO RW-LFCLMWK.
 12117
 12118     MOVE +0                          TO RW-LFCLM
 12119                                         RW-AHCLM.
 12120     IF RW-LFCLMWK = ZERO
 12121        AND RW-AHCLMWK = ZERO
 12122         GO TO 3399-REINSURE-CLAIM-X.
 12123
 12124     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12125         VARYING SUB1 FROM +1 BY +1
 12126             UNTIL REIN-COMP (SUB1) = SPACES.
 12127
 12128     IF REIN-RT-SW = 'X'
 12129         GO TO 3399-REINSURE-CLAIM-X.
 12130
 12131     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12132     MOVE ZEROS                TO RW-ACCUM-CLM.
 12133     MOVE 'R'                  TO DE-REIN.
 12134*****PERFORM EXTRACT-DATE-RELOAD.
 12135     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12136     MOVE +1                   TO SUB1.
 12137
 12138 3310-REINSURE-CLAIM-LOOP.
 12139
 12140     IF REIN-COMP (SUB1) = SPACES
 12141         GO TO 3390-REINSURE-CLAIM-PRINT.
 12142
 12143     IF REIN-REM-SW (SUB1) = 'Z'
 12144         ADD +1        TO SUB1
 12145         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12146         PERFORM EXTRACT-DATE-LOAD
 12147         GO TO 3310-REINSURE-CLAIM-LOOP.
 12148
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010S.cbl
 12149     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12150     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12151
 12152     IF PC-CLAIM-TYPE  = 1 OR 3
 12153         IF RWF-LF-RUNOFF-SW = 'N'
 12154           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12155               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12156
 12157     IF PC-CLAIM-TYPE  = 2 OR 4
 12158         IF RWF-AH-RUNOFF-SW = 'N'
 12159           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12160               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12161
 12162     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12163     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12164     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12165     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12166
 12167     IF PC-CLAIM-TYPE  = 1 OR 3
 12168         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12169         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12170     ELSE
 12171         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12172         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12173
 12174     IF PC-CLAIM-TYPE = 1 OR 3
 12175         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12176            AND DE-REI-CLAIM-AMT
 12177             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12178         ELSE
 12179             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12180     ELSE
 12181         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12182            AND DE-REI-CLAIM-AMT
 12183             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12184         ELSE
 12185             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12186
 12187 3320-REINSURE-CLAIM-LOOP-GO.
 12188
 12189     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12190     ADD +1                     TO BC-R-CLM.
 12191
 12192 3330-REINSURE-CLAIM-LOOP-ADD.
 12193
 12194     ADD +1                     TO SUB1.
 12195     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12196     PERFORM EXTRACT-DATE-LOAD.
 12197     GO TO 3310-REINSURE-CLAIM-LOOP.
 12198
 12199 3390-REINSURE-CLAIM-PRINT.
 12200
 12201     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12202     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12203         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12204         MOVE CR-LF-TERM               TO TRD-LFTRM
 12205         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12206         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010S.cbl
 12207     ELSE
 12208         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12209         MOVE CR-AH-TERM               TO TRD-AHTRM
 12210         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12211         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12212         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12213         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12214         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12215         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12216     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12217
 12218 3399-REINSURE-CLAIM-X.
 12219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010S.cbl
 12221******************************************************************
 12222***              R E I N S U R E   R E S E R V E S             ***
 12223******************************************************************
 12224
 12225 3400-REINSURE-RESERVE.
 12226
 12227     IF REIN-COMP (1) = SPACES
 12228         GO TO 3499-REINSURE-RESERVE-X.
 12229
 12230     IF PC-CLAIM-TYPE = '1' OR '3'
 12231         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12232         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12233         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12234         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12235         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12236     ELSE
 12237         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12238         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12239         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12240         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12241         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12242
 12243     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12244                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12245     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12246         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12247          GO TO 3499-REINSURE-RESERVE-X.
 12248
 12249     IF DTE-CLIENT NOT = 'MIC'
 12250         GO TO 3405-REINSURE-RESERVE-CONT.
 12251
 12252     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12253         GO TO 3405-REINSURE-RESERVE-CONT.
 12254
 12255     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12256     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12257     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12258     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12259                                        CP-CLAIM-TYPE.
 12260     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12261     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12262     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12263     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12264     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12265     MOVE '3'                        TO CP-CDT-METHOD.
 12266     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12267     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12268                                        CP-RATING-BENEFIT-AMT.
 12269     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12270     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12271
 12272 3405-REINSURE-RESERVE-CONT.
 12273
 12274     PERFORM 3500-REINSURE-CALC-RESERVE
 12275         THRU 3599-REINSURE-CALC-RESERVE-X
 12276             VARYING SUB1 FROM +1 BY +1
 12277                 UNTIL REIN-COMP (SUB1) = SPACES.
 12278
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010S.cbl
 12279     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12280     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12281     MOVE 'R'            TO DE-REIN.
 12282*****PERFORM EXTRACT-DATE-RELOAD.
 12283     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12284     MOVE +1             TO SUB1.
 12285
 12286 3410-REINSURE-RESERVE-LOOP.
 12287
 12288     IF REIN-COMP (SUB1) = SPACES
 12289         GO TO 3490-REINSURE-RESERVE-PRINT.
 12290
 12291     IF REIN-REM-SW (SUB1) = 'Z'
 12292         ADD +1 TO SUB1
 12293         GO TO 3410-REINSURE-RESERVE-LOOP.
 12294
 12295     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12296     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12297
 12298     IF PC-CLAIM-TYPE  = 1 OR 3
 12299         IF RWF-LF-RUNOFF-SW = 'N'
 12300           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12301               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12302
 12303     IF PC-CLAIM-TYPE  = 2 OR 4
 12304         IF RWF-AH-RUNOFF-SW = 'N'
 12305           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12306               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12307
 12308     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12309     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12310     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12311     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12312
 12313     IF PC-CLAIM-TYPE = 1 OR 3
 12314         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 12315         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 12316         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 12317     ELSE
 12318         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 12319         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 12320         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 12321
 12322     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 12323     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 12324     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 12325
 12326     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 12327        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 12328        OR DE-REI-FUTRSV
 12329         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12330                                            2599-WRT-DETAIL-X
 12331         ADD +1 TO BC-R-CRS.
 12332
 12333 3415-REINSURE-RESERVE-LOOP-ADD.
 12334
 12335     ADD +1 TO SUB1.
 12336     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010S.cbl
 12337     PERFORM EXTRACT-DATE-LOAD.
 12338     GO TO 3410-REINSURE-RESERVE-LOOP.
 12339
 12340 3490-REINSURE-RESERVE-PRINT.
 12341
 12342     IF RW-ACCUM-IBNR   = ZERO  AND
 12343        RW-ACCUM-PAYCUR = ZERO  AND
 12344        RW-ACCUM-FUTRSV = ZERO
 12345         GO TO 3499-REINSURE-RESERVE-X.
 12346
 12347     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12348     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 12349     MOVE 'IBNR'                    TO TRD-IBNRX.
 12350     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 12351     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 12352     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 12353     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 12354
 12355     IF PC-CLAIM-TYPE = 1
 12356         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 12357     ELSE
 12358         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 12359     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 12360
 12361     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12362
 12363 3499-REINSURE-RESERVE-X.
 12364     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010S.cbl
 12366******************************************************************
 12367***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 12368******************************************************************
 12369
 12370 3500-REINSURE-CALC-RESERVE.
 12371
 12372     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12373     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 12374                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 12375
 12376     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 12377        VARYING CO-SUB FROM 1 BY 1 UNTIL
 12378          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 12379       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 12380
 12381     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 12382        MOVE ZERO TO CO-SUB.
 12383
 12384     IF CO-SUB NOT = ZERO
 12385        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12386           IF PC-CLAIM-TYPE = '1' OR '3'
 12387             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12388                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12389
 12390     IF PC-CLAIM-TYPE  = 1 OR 3
 12391         IF RWF-LF-RUNOFF-SW = 'N'
 12392           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12393               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12394
 12395     IF CO-SUB NOT = ZERO
 12396        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12397           IF PC-CLAIM-TYPE = '2' OR '4'
 12398             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12399                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12400
 12401     IF PC-CLAIM-TYPE  = 2 OR 4
 12402         IF RWF-AH-RUNOFF-SW = 'N'
 12403           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12404               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12405
 12406     IF DTE-CLIENT NOT = 'MIC'
 12407         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12408
 12409     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12410         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12411
 12412     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 12413
 12414     IF CR-AHTYP = ZERO  OR
 12415        CO-SUB = ZERO
 12416         GO TO 3505-REIN-CALC-RESERVE-CONT
 12417     ELSE
 12418         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12419             GO TO 3505-REIN-CALC-RESERVE-CONT.
 12420
 12421     COMPUTE MAX-REM-TERM ROUNDED =
 12422                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 12423
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010S.cbl
 12424     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 12425         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12426
 12427     COMPUTE CP-ORIGINAL-TERM =
 12428                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 12429
 12430     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 12431
 12432     IF  CP-RETURN-CODE = ZERO
 12433         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 12434
 12435 3505-REIN-CALC-RESERVE-CONT.
 12436
 12437     IF SUB1 = RE-100-COMP
 12438         GO TO 3520-REIN-REMAINDER-RSRV.
 12439
 12440     IF CR-LFAMT NOT = ZERO  AND
 12441        RWF-LFAMT NOT = ZERO
 12442         IF DTE-CLIENT NOT = 'MIC'
 12443             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 12444                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12445             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 12446                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12447             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 12448                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12449         ELSE
 12450             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 12451             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 12452             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 12453
 12454     IF CR-AHAMT NOT = ZERO  AND
 12455        RWF-AHAMT NOT = ZERO
 12456         IF DTE-CLIENT NOT = 'MIC'
 12457             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 12458                         RWF-AHAMT) / CR-AHAMT
 12459             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 12460                         RWF-AHAMT) / CR-AHAMT
 12461             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 12462                         RWF-AHAMT) / CR-AHAMT
 12463         ELSE
 12464             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 12465             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 12466             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 12467
 12468 3510-REINSURE-CALC-RESERVE-ADD.
 12469
 12470     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 12471     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 12472     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 12473     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 12474     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 12475     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 12476
 12477     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 12478         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12479
 12480     IF CO-SUB = ZERO
 12481         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010S.cbl
 12482
 12483 3513-REIN-CHK-LF-RSRV-LIMIT.
 12484     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 12485         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 12486
 12487     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 12488         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 12489
 12490     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 12491                                      (RWF-LFCLM +
 12492                                       RWF-DTH-PAYCUR +
 12493                                       RWF-DTH-FUTRSV).
 12494
 12495     IF EXCESS-RESERVE NOT LESS THAN ZERO
 12496         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 12497
 12498     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 12499
 12500     IF RWF-DTH-PAYCURL LESS THAN ZERO
 12501         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 12502         MOVE ZEROS TO RWF-DTH-PAYCURL.
 12503     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 12504         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 12505
 12506     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 12507
 12508     IF RWF-DTH-PAYCUR LESS THAN ZERO
 12509         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 12510         MOVE ZEROS TO RWF-DTH-PAYCUR.
 12511     IF RWF-DTH-FUTRSV LESS THAN ZERO
 12512         MOVE ZEROS TO RWF-DTH-FUTRSV.
 12513
 12514 3515-REIN-CHK-AH-RSRV-LIMIT.
 12515     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12516         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12517
 12518     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 12519         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 12520
 12521     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 12522                                      (RWF-AHCLM +
 12523                                       RWF-DIS-PAYCUR +
 12524                                       RWF-DIS-FUTRSV).
 12525
 12526     IF EXCESS-RESERVE NOT LESS THAN ZERO
 12527         GO TO 3519-REINSURE-CALC-RESERVE-END.
 12528
 12529     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 12530
 12531     IF RWF-DIS-PAYCURL LESS THAN ZERO
 12532         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 12533         MOVE ZEROS TO RWF-DIS-PAYCURL.
 12534     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 12535         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 12536
 12537     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 12538
 12539     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010S.cbl
 12540         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 12541         MOVE ZEROS TO RWF-DIS-PAYCUR.
 12542     IF RWF-DIS-FUTRSV LESS THAN ZERO
 12543         MOVE ZEROS TO RWF-DIS-FUTRSV.
 12544
 12545 3519-REINSURE-CALC-RESERVE-END.
 12546
 12547     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 12548        OR RWF-DTH-FUTRSV
 12549         MOVE 'X' TO REIN-LF-FLG (SUB1).
 12550
 12551     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 12552        OR RWF-DIS-FUTRSV
 12553         MOVE 'X' TO REIN-AH-FLG (SUB1).
 12554
 12555     GO TO 3540-CONT-REIN-CALC-RESERVE.
 12556
 12557 3520-REIN-REMAINDER-RSRV.
 12558
 12559     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 12560     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 12561     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 12562     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 12563     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 12564     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 12565
 12566     PERFORM 3530-REIN-SUB-RSRV
 12567         THRU 3539-REIN-SUB-RSRV-X
 12568             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 12569
 12570     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 12571
 12572 3530-REIN-SUB-RSRV.
 12573
 12574     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 12575     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 12576     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 12577     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 12578     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 12579     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 12580
 12581 3539-REIN-SUB-RSRV-X.
 12582     EXIT.
 12583
 12584 3540-CONT-REIN-CALC-RESERVE.
 12585
 12586     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 12587         MOVE 'X' TO REIN-BUS-FLAG.
 12588     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 12589
 12590 3599-REINSURE-CALC-RESERVE-X.
 12591     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010S.cbl
 12593******************************************************************
 12594***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 12595******************************************************************
 12596
 12597*REINSURANCE-CALCULATIONS.
*12598                             COPY ECSRIRTN.
 12599******************************************************************04/30/98
 12600*                                                                *ECSRIRTN
 12601*                            ECSRIRTN                            *   LV012
 12602*                            VMOD=2.025.                         *ECSRIRTN
 12603*                                                                *ECSRIRTN
 12604******************************************************************ECSRIRTN
 12605******************************************************************
 12606*                   C H A N G E   L O G
 12607*
 12608* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 12609*-----------------------------------------------------------------
 12610*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 12611* EFFECTIVE    NUMBER
 12612*-----------------------------------------------------------------
 12613* 062703                   PEMA  ADD DCC CLIENT ID TO
 12614*                                SPECIAL CEDED CLAIM CALC
 12615* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 12616* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 12617                                                                  ECSRIRTN
 12618 REINSURE-CALC.                                                   ECSRIRTN
 12619                                                                  ECSRIRTN
 12620     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 12621     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 12622     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 12623     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 12624                                   REIN-REM-SW (SUB1).            ECSRIRTN
 12625                                                                  ECSRIRTN
 12626     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 12627                                   WS-RWF-EP-STOP-DATE-N             CL*12
 12628                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 12629                                                                  ECSRIRTN
 12630     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 12631                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 12632                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 12633                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 12634                                                                  ECSRIRTN
 12635     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 12636        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 12637          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 12638          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 12639          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 12640                                                                  ECSRIRTN
 12641     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 12642        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 12643         GO TO CALC-CONTINUED.                                    ECSRIRTN
 12644                                                                  ECSRIRTN
 12645     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 12646                                          WS-RWF-EP-STOP-DATE-N      CL*12
 12647                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 12648                                                                  ECSRIRTN
 12649     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 12650         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12651                                                                  ECSRIRTN
 12652     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 12653         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 12654                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 12655                                                                  ECSRIRTN
 12656     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 12657         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 12658                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 12659                                                                  ECSRIRTN
 12660 CALC-CONTINUED.                                                  ECSRIRTN
 12661                                                                  ECSRIRTN
 12662     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 12663     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 12664                                                                  ECSRIRTN
 12665     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 12666         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 12667     ELSE                                                         ECSRIRTN
 12668         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 12669     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 12670                                                                  ECSRIRTN
 12671     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 12672     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 12673     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 12674         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 12675     ELSE                                                         ECSRIRTN
 12676         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 12677     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 12678                                                                  ECSRIRTN
 12679     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 12680         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 12681         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 12682         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 12683         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 12684         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 12685         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 12686                                                                  ECSRIRTN
 12687     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 12688         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 12689                                                                  ECSRIRTN
 12690     IF CR-DT LESS WT-LO-DATE                                        CL**2
 12691         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 12692                                                                  ECSRIRTN
 12693     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 12694         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 12695                                                                  ECSRIRTN
 12696     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 12697     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 12698                                                                  ECSRIRTN
 12699     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 12700         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 12701                                                                  ECSRIRTN
 12702     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 12703       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 12704        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 12705        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 12706           NEXT SENTENCE                                          ECSRIRTN
 12707       ELSE                                                       ECSRIRTN
 12708           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12709                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 12710                                                                  ECSRIRTN
 12711     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 12712         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 12713            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 12714             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 12715                                                                  ECSRIRTN
 12716     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 12717         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 12718            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 12719             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 12720                                                                  ECSRIRTN
 12721     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 12722         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 12723             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 12724                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 12725             ELSE                                                 ECSRIRTN
 12726                 NEXT SENTENCE                                    ECSRIRTN
 12727         ELSE                                                     ECSRIRTN
 12728             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 12729                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 12730                                                                  ECSRIRTN
 12731     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 12732         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 12733             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 12734                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 12735             ELSE                                                 ECSRIRTN
 12736                 NEXT SENTENCE                                    ECSRIRTN
 12737         ELSE                                                     ECSRIRTN
 12738             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 12739                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 12740                                                                  ECSRIRTN
 12741     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 12742         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 12743                                                                  ECSRIRTN
 12744     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 12745         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 12746         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 12747                                                                  ECSRIRTN
 12748     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 12749         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 12750                                                                  ECSRIRTN
 12751     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 12752         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 12753         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 12754                                                                  ECSRIRTN
 12755     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 12756         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 12757                                                                  ECSRIRTN
 12758     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 12759         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 12760                                                                  ECSRIRTN
 12761     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 12762                                                                  ECSRIRTN
 12763 REINSURE-CK-LIFE.                                                ECSRIRTN
 12764                                                                  ECSRIRTN
 12765     IF CR-LFTYP = ZERO                                           ECSRIRTN
 12766         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12767                                                                  ECSRIRTN
 12768     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 12769         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12770                                                                  ECSRIRTN
 12771     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 12772         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 12773             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12774                                                                  ECSRIRTN
 12775     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 12776                                                                  ECSRIRTN
 12777     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 12778         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 12779             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 12780         ELSE                                                     ECSRIRTN
 12781             NEXT SENTENCE                                        ECSRIRTN
 12782     ELSE                                                         ECSRIRTN
 12783         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 12784             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12785                                                                  ECSRIRTN
 12786     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 12787         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 12788             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 12789         ELSE                                                     ECSRIRTN
 12790             NEXT SENTENCE                                        ECSRIRTN
 12791     ELSE                                                         ECSRIRTN
 12792         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 12793             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12794                                                                  ECSRIRTN
 12795     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 12796         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 12797             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12798                                                                  ECSRIRTN
 12799     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 12800         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 12801            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12802                                                                  ECSRIRTN
 12803     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 12804         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 12805             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12806                                                                  ECSRIRTN
 12807     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 12808         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 12809            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12810                                                                  ECSRIRTN
 12811     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 12812         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 12813             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12814                                                                  ECSRIRTN
 12815     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 12816         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 12817            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 12818            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 12819             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12820                                                                  ECSRIRTN
 12821     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 12822         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 12823            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 12824             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12825                                                                  ECSRIRTN
 12826     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 12827         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 12828             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12829                                                                  ECSRIRTN
 12830     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 12831         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 12832             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12833                                                                  ECSRIRTN
 12834     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 12835        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 12836           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 12837            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12838                                                                  ECSRIRTN
 12839     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 12840         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12841            CR-IND-GRP = '1'                                      ECSRIRTN
 12842             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12843                                                                  ECSRIRTN
 12844     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 12845         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 12846            CR-IND-GRP = '1'                                      ECSRIRTN
 12847             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12848                                                                  ECSRIRTN
 12849     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 12850         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12851            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 12852            CR-IND-GRP = '1'                                      ECSRIRTN
 12853             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12854                                                                  ECSRIRTN
 12855     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 12856         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 12857            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 12858            CR-IND-GRP = '1'                                      ECSRIRTN
 12859             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 12860                                                                  ECSRIRTN
 12861     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 12862         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 12863            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 12864                                                                  ECSRIRTN
 12865     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 12866        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 12867                                                                  ECSRIRTN
 12868     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 12869         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12870                                                                  ECSRIRTN
 12871     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 12872         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12873                                                                  ECSRIRTN
 12874     IF CR-LF-TERM  NUMERIC                                       00002331
 12875        NEXT SENTENCE                                             00002332
 12876     ELSE                                                         00002333
 12877        MOVE ZEROS               TO CR-LF-TERM                    00002334
 12878     END-IF
 12879                                                                  00002335
 12880     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 12881         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12882                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12883     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 12884         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12885                                                                  ECSRIRTN
 12886     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 12887                                                                  ECSRIRTN
 12888     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 12889         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12890                                                                  ECSRIRTN
 12891     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 12892         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 12893                                                                  ECSRIRTN
 12894     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 12895                                                                  ECSRIRTN
 12896 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 12897     EXIT.                                                        ECSRIRTN
 12898                                                                  ECSRIRTN
 12899 REINSURE-CK-AH.                                                  ECSRIRTN
 12900                                                                  ECSRIRTN
 12901     IF CR-AHTYP = ZERO                                           ECSRIRTN
 12902         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12903                                                                  ECSRIRTN
 12904     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 12905         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12906                                                                  ECSRIRTN
 12907     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 12908         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 12909             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12910                                                                  ECSRIRTN
 12911     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 12912                                                                  ECSRIRTN
 12913     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 12914         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 12915             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 12916         ELSE                                                     ECSRIRTN
 12917             NEXT SENTENCE                                        ECSRIRTN
 12918     ELSE                                                         ECSRIRTN
 12919         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 12920             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12921                                                                  ECSRIRTN
 12922     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 12923         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 12924             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12925                                                                  ECSRIRTN
 12926     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 12927         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 12928             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12929                                                                  ECSRIRTN
 12930     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 12931         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 12932             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12933                                                                  ECSRIRTN
 12934     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 12935         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 12936             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12937                                                                  ECSRIRTN
 12938     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 12939         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 12940            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12941             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12942                                                                  ECSRIRTN
 12943     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 12944         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 12945             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12946                                                                  ECSRIRTN
 12947     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 12948         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 12949            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 12950                                                                  ECSRIRTN
 12951     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 12952         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 12953            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 12954                                                                  ECSRIRTN
 12955     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 12956         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 12957             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 12958                                                                  ECSRIRTN
 12959     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 12960        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 12961                                                                  ECSRIRTN
 12962     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 12963         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12964                                                                  ECSRIRTN
 12965     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 12966         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12967                                                                  ECSRIRTN
 12968     IF CR-AH-TERM  NUMERIC                                       00002331
 12969        NEXT SENTENCE                                             00002332
 12970     ELSE                                                         00002333
 12971        MOVE ZEROS               TO CR-AH-TERM                    00002334
 12972     END-IF
 12973                                                                  00002335
 12974     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 12975         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12976                                                                  ECSRIRTN
 12977     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 12978         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 12979                                                                  ECSRIRTN
 12980     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 12981                                                                  ECSRIRTN
 12982     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 12983         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 12984             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 12985                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 12986                                                                  ECSRIRTN
 12987     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 12988         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 12989             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 12990                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 12991                                                                  ECSRIRTN
 12992     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 12993     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 12994                                                                  ECSRIRTN
 12995     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 12996         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 12997                                                                  ECSRIRTN
 12998     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 12999         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13000                                                                  ECSRIRTN
 13001     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13002                                                                  ECSRIRTN
 13003     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13004                                                                  ECSRIRTN
 13005     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13006         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13007                                                                  ECSRIRTN
 13008     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13009         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13010                                                                  ECSRIRTN
 13011     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13012                                                                  ECSRIRTN
 13013 REINSURE-CK-AH-X.                                                ECSRIRTN
 13014     EXIT.                                                        ECSRIRTN
 13015                                                                  ECSRIRTN
 13016 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13017                                                                  ECSRIRTN
 13018     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13019        RS-AH-BEN = ZERO                                          ECSRIRTN
 13020         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13021                                                                  ECSRIRTN
 13022     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13023        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13024         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13025                                                                  ECSRIRTN
 13026     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13027                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13028                                                                  ECSRIRTN
 13029     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13030         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13031             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13032                                     WT-AHBEN-HI.                 ECSRIRTN
 13033     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13034         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13035             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13036                                     WT-AHMOA-HI.                 ECSRIRTN
 13037                                                                  ECSRIRTN
 13038     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13039     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13040                                                                  ECSRIRTN
 13041     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13042         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13043                                                                  ECSRIRTN
 13044     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13045         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13046                                                                  ECSRIRTN
 13047     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13048                                                                  ECSRIRTN
 13049     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13050         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13051                                                                  ECSRIRTN
 13052     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13053         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13054                                       / RW-AHWRK                 ECSRIRTN
 13055       ELSE                                                       ECSRIRTN
 13056         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13057                                                                  ECSRIRTN
 13058     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13059         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13060                                       / RS-LIFE-BEN              ECSRIRTN
 13061       ELSE                                                       ECSRIRTN
 13062         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13063                                                                  ECSRIRTN
 13064     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13065        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13066          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13067          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13068                                      / CR-AH-TERM.               ECSRIRTN
 13069                                                                  ECSRIRTN
 13070     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13071        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13072          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13073          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13074               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13075            ELSE                                                  ECSRIRTN
 13076                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13077                                                                  ECSRIRTN
 13078     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13079        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13080        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13081          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13082          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13083                                      / CR-AH-TERM                ECSRIRTN
 13084         ELSE                                                     ECSRIRTN
 13085          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13086          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13087               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13088            ELSE                                                  ECSRIRTN
 13089                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13090                                                                  ECSRIRTN
 13091 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13092     EXIT.                                                        ECSRIRTN
 13093                                                                  ECSRIRTN
 13094                                                                  ECSRIRTN
 13095 REIN-CALC-LIFE.                                                  ECSRIRTN
 13096                                                                  ECSRIRTN
 13097     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13098         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13099     ELSE                                                         ECSRIRTN
 13100         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13101                                                                  ECSRIRTN
 13102     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13103         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13104     ELSE                                                         ECSRIRTN
 13105         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13106           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13107               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13108           ELSE                                                   ECSRIRTN
 13109               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13110                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13111                                                                  ECSRIRTN
 13112 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13113                                                                  ECSRIRTN
 13114     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13115                                                                  ECSRIRTN
 13116     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13117         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13118                                                                  ECSRIRTN
 13119     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13120         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13121         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13122                                                                  ECSRIRTN
 13123     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13124         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13125                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13126         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13127                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13128     ELSE                                                         ECSRIRTN
 13129         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13130             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13131             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13132                                                                  ECSRIRTN
 13133     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13134         (WT-LF-QC = '2' AND                                         CL**8
 13135          PGM-SUB = +50  AND                                         CL**8
 13136          DTE-CLIENT = 'LAP'))                                       CL**8
 13137          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13138     ELSE                                                         ECSRIRTN
 13139         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13140                                                                  ECSRIRTN
 13141     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13142         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13143         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13144         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13145                                                                  ECSRIRTN
 13146     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13147                                                                  ECSRIRTN
 13148 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13149                                                                  ECSRIRTN
 13150     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13151         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13152         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13153                                                                  ECSRIRTN
 13154     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13155     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13156     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13157                                       RW-LFPRM.                  ECSRIRTN
 13158                                                                  ECSRIRTN
 13159 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13160                                                                  ECSRIRTN
 13161     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13162                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13163                                                                  ECSRIRTN
 13164     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13165        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13166                                                                  ECSRIRTN
 13167     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13168        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13169         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13170     ELSE                                                         ECSRIRTN
 13171         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13172         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13173                                                                  ECSRIRTN
 13174                                                                  ECSRIRTN
 13175 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13176     EXIT.                                                        ECSRIRTN
 13177                                                                  ECSRIRTN
 13178 REIN-CALC-AH.                                                    ECSRIRTN
 13179                                                                  ECSRIRTN
 13180     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13181         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13182             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13183                                 WT-AHBEN-HI.                     ECSRIRTN
 13184                                                                  ECSRIRTN
 13185     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13186         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13187             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13188                                 WT-AHMOA-HI.                     ECSRIRTN
 13189                                                                  ECSRIRTN
 13190     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13191     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13192                                                                  ECSRIRTN
 13193     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13194         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13195                                                                  ECSRIRTN
 13196     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13197         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13198                                                                  ECSRIRTN
 13199     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13200         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13201                                                                  ECSRIRTN
 13202     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13203         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13204     ELSE                                                         ECSRIRTN
 13205         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13206             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13207         ELSE                                                     ECSRIRTN
 13208             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13209             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13210                                                                  ECSRIRTN
 13211 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13212                                                                  ECSRIRTN
 13213     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13214         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13215                                                                  ECSRIRTN
 13216     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13217         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13218         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13219                                                                  ECSRIRTN
 13220     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13221         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13222                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13223         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13224                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13225     ELSE                                                         ECSRIRTN
 13226         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13227             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13228             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13229                                                                  ECSRIRTN
 13230     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13231         (WT-AH-QC = '2' AND                                         CL**8
 13232          PGM-SUB = +50  AND                                         CL**8
 13233          DTE-CLIENT = 'LAP'))                                       CL**8
 13234         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13235     ELSE                                                         ECSRIRTN
 13236         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13237                                                                  ECSRIRTN
 13238     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13239         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13240            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13241                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13242                                                                  ECSRIRTN
 13243     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13244         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13245         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13246         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13247                                                                  ECSRIRTN
 13248     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13249                                                                  ECSRIRTN
 13250 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13251                                                                  ECSRIRTN
 13252     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13253         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13254         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13255                                                                  ECSRIRTN
 13256     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13257     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13258     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13259                                    RW-AHPRM.                     ECSRIRTN
 13260                                                                  ECSRIRTN
 13261 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13262                                                                  ECSRIRTN
 13263     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13264                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13265                                                                  ECSRIRTN
 13266     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13267                                                                  ECSRIRTN
 13268     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13269        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13270         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13271     ELSE                                                         ECSRIRTN
 13272         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13273         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13274                                                                  ECSRIRTN
 13275                                                                  ECSRIRTN
 13276 REIN-CALC-AH-X.                                                  ECSRIRTN
 13277     EXIT.                                                        ECSRIRTN
 13278                                                                  ECSRIRTN
 13279 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13280                                                                  ECSRIRTN
 13281     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13282     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13283     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13284     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13285                                                                  ECSRIRTN
 13286     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13287         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13288                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13289     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13290        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13291           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13292                                                                  ECSRIRTN
 13293     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13294        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13295           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13296                                                                  ECSRIRTN
 13297 REINSURE-CALC-X.                                                 ECSRIRTN
 13298                                                                  ECSRIRTN
 13299     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13300         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13301                                                                  ECSRIRTN
 13302     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13303                                                                  ECSRIRTN
 13304 REINSURE-SUBTRACT.                                               ECSRIRTN
 13305                                                                  ECSRIRTN
 13306     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 13307     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 13308     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 13309     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 13310                                                                  ECSRIRTN
 13311 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 13312     EXIT.                                                        ECSRIRTN
 13313                                                                  ECSRIRTN
 13314 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 13315                                                                  ECSRIRTN
 13316     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13317     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13318                                                                  ECSRIRTN
 13319     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13320         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 13321                                                                  ECSRIRTN
 13322     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13323         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13324                                                                  ECSRIRTN
 13325     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13326         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 13327             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 13328                                                                  ECSRIRTN
 13329     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13330         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 13331                                                                  ECSRIRTN
 13332     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13333         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 13334         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13335                                                                  ECSRIRTN
 13336     IF CR-LFPRM = ZERO                                           ECSRIRTN
 13337        MOVE ZERO                TO REIN-FACTOR
 13338     ELSE                                                         ECSRIRTN
 13339        IF DTE-CLIENT = 'GIC'  AND
 13340           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 13341           MOVE +1.0             TO REIN-FACTOR
 13342        ELSE
 13343           IF DTE-CLIENT = 'DCC'
 13344              COMPUTE REIN-FACTOR = CR-LFRFND /
 13345                 (CR-LFPRM + CR-LFPRM-ALT)
 13346           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13347              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 13348                 (CR-LFPRM + CR-LFPRM-ALT)
 13349            END-IF
 13350         END-IF
 13351     END-IF
 13352                                                                  ECSRIRTN
 13353     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13354         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13355             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13356                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 13357                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13358             ELSE                                                 ECSRIRTN
 13359                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13360                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13361                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 13362                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13363         ELSE                                                     ECSRIRTN
 13364             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13365                 compute rein-factor rounded =
 13366                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 13367                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 13368                    rein-factor
 13369             ELSE                                                 ECSRIRTN
 13370*                COMPUTE RWF-LFRFND = REIN-FACTOR
 13371*                   * REIN-CALCED-LIFE *
 13372*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 13373                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13374                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13375                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 13376                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 13377                                                                  ECSRIRTN
 13378     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13379         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13380             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13381                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13382                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 13383             ELSE                                                 ECSRIRTN
 13384                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13385                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13386                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13387                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 13388                                                                  ECSRIRTN
 13389     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 13390                                                                  ECSRIRTN
 13391                                                                  ECSRIRTN
 13392 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 13393                                                                  ECSRIRTN
 13394     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13395       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 13396         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13397         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13398                                                                  ECSRIRTN
 13399     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13400       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 13401           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 13402           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 13403       ELSE                                                       ECSRIRTN
 13404           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13405               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 13406                                                                  ECSRIRTN
 13407     IF FLAT-CANCEL-LF                                            ECSRIRTN
 13408         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 13409         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13410                                                                  ECSRIRTN
 13411     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 13412         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13413         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13414                                                                  ECSRIRTN
 13415     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 13416     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13417     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 13418                                         RW-LFRFND.               ECSRIRTN
 13419                                                                  ECSRIRTN
 13420 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13421                                                                  ECSRIRTN
 13422     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 13423                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13424                                                                  ECSRIRTN
 13425     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13426        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13427                                                                  ECSRIRTN
 13428     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 13429        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13430         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 13431     ELSE                                                         ECSRIRTN
 13432         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13433         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 13434                                                                  ECSRIRTN
 13435                                                                  ECSRIRTN
 13436 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 13437                                                                  ECSRIRTN
 13438     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13439         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13440                                                                  ECSRIRTN
 13441     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13442         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 13443             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 13444                                                                  ECSRIRTN
 13445     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13446         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 13447         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 13448             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 13449                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13450         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13451                                                                  ECSRIRTN
 13452     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13453         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 13454                                                                  ECSRIRTN
 13455     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13456         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 13457         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13458                                                                  ECSRIRTN
 13459     IF CR-AHPRM = ZERO                                           ECSRIRTN
 13460        MOVE ZERO                TO REIN-FACTOR
 13461     ELSE
 13462        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13463           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 13464            MOVE +1.0            TO REIN-FACTOR
 13465        ELSE
 13466           IF DTE-CLIENT = 'DCC'
 13467              COMPUTE REIN-FACTOR =
 13468                 CR-AHRFND / CR-AHPRM
 13469           ELSE
 13470              COMPUTE REIN-FACTOR ROUNDED =
 13471                                CR-AHRFND-CALC / CR-AHPRM
 13472           END-IF
 13473        END-IF
 13474     END-IF
 13475
 13476     IF CR-AHAMT NOT = ZERO
 13477        IF (DTE-CLIENT = 'DCC')
 13478           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 13479           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 13480        ELSE
 13481           IF WT-AH-QC = ('1' OR '4')
 13482              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 13483              compute rwf-ahrfnd rounded =
 13484                 cr-ahrfnd * rein-factor
 13485           ELSE
 13486              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 13487              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 13488                       RWF-AHAMT) / CR-AHAMT
 13489           END-IF
 13490        END-IF
 13491     ELSE
 13492        IF RWF-AH-LIMIT = ZERO
 13493           IF WT-AH-QC = ('1' OR '4')
 13494              COMPUTE RWF-AHRFND ROUNDED =
 13495                       CR-AHRFND * WT-AH-PCT
 13496           ELSE
 13497              COMPUTE RWF-AHRFND =
 13498                            REIN-FACTOR * REIN-CALCED-AH
 13499              COMPUTE RWF-AHRFND ROUNDED =
 13500                       RWF-AHRFND * WT-AH-PCT
 13501           END-IF
 13502        END-IF
 13503     END-IF
 13504
 13505     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 13506                                                                  ECSRIRTN
 13507                                                                  ECSRIRTN
 13508 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 13509                                                                  ECSRIRTN
 13510     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13511       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 13512         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 13513         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13514                                                                  ECSRIRTN
 13515     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13516       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 13517           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 13518           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 13519       ELSE                                                       ECSRIRTN
 13520           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13521               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 13522                                                                  ECSRIRTN
 13523     IF FLAT-CANCEL-AH                                            ECSRIRTN
 13524         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 13525         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13526                                                                  ECSRIRTN
 13527     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 13528         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 13529         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13530                                                                  ECSRIRTN
 13531     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13532     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13533     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13534                                    RW-AHRFND.                    ECSRIRTN
 13535                                                                  ECSRIRTN
 13536 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13537                                                                  ECSRIRTN
 13538     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 13539                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13540                                                                  ECSRIRTN
 13541     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13542                                                                  ECSRIRTN
 13543     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 13544        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13545         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 13546     ELSE                                                         ECSRIRTN
 13547         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13548         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 13549                                                                  ECSRIRTN
 13550                                                                  ECSRIRTN
 13551 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 13552                                                                  ECSRIRTN
 13553     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 13554         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13555                                                                  ECSRIRTN
 13556     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 13557         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13558                                                                  ECSRIRTN
 13559     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 13560                                                                  ECSRIRTN
 13561 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 13562                                                                  ECSRIRTN
 13563     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 13564     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 13565                                                                  ECSRIRTN
 13566     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 13567         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 13568             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 13569                                                                  ECSRIRTN
 13570     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 13571         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13572                                                                  ECSRIRTN
 13573     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 13574         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13575                                                                  ECSRIRTN
 13576 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 13577                                                                  ECSRIRTN
 13578     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13579         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13580                                                                  ECSRIRTN
 13581     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13582                                                                  ECSRIRTN
 13583 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 13584                                                                  ECSRIRTN
 13585     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 13586     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 13587                                                                  ECSRIRTN
 13588 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 13589     EXIT.                                                        ECSRIRTN
 13590                                                                  ECSRIRTN
 13591 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 13592                                                                  ECSRIRTN
 13593     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 13594         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 13595                                                                  ECSRIRTN
 13596 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 13597     EXIT.                                                        ECSRIRTN
 13598                                                                  ECSRIRTN
 13599 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 13600                                                                  ECSRIRTN
 13601     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13602     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13603                                                                  ECSRIRTN
 13604     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13605         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 13606                                                                  ECSRIRTN
 13607     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13608        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13609          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13610          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13611          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13612                                                                  ECSRIRTN
 13613     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13614        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13615          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 13616                                                                  ECSRIRTN
 13617     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 13618                                  RWF-AHCLML.                     ECSRIRTN
 13619                                                                  ECSRIRTN
 13620     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13621         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13622                                                                  ECSRIRTN
 13623     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 13624         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13625                                                                  ECSRIRTN
 13626     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13627         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 13628             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 13629                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 13630                                                                  ECSRIRTN
 13631     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13632         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 13633                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 13634                                                                  ECSRIRTN
 13635     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13636         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13637                                                                  ECSRIRTN
 13638     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13639         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 13640             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 13641                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 13642             ELSE                                                 ECSRIRTN
 13643                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 13644         ELSE                                                     ECSRIRTN
 13645             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 13646                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 13647                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 13648             ELSE                                                 ECSRIRTN
 13649                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 13650                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 13651                                                                  ECSRIRTN
 13652     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13653         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13654                                                                  ECSRIRTN
 13655     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13656         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13657            OR 'DCC'
 13658             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 13659                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13660         ELSE                                                     ECSRIRTN
 13661             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 13662                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 13663                                                                  ECSRIRTN
 13664     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13665         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13666             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 13667                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 13668                                                                  ECSRIRTN
 13669     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13670         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 13671             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 13672                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 13673                                                                  ECSRIRTN
 13674     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13675         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 13676             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 13677               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 13678                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 13679                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 13680                  ELSE                                            ECSRIRTN
 13681                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 13682                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 13683              ELSE                                                ECSRIRTN
 13684                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 13685                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 13686                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 13687                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 13688                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 13689                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 13690                                                                  ECSRIRTN
 13691     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 13692                                                                  ECSRIRTN
 13693     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 13694                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13695                                                                  ECSRIRTN
 13696 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 13697                                                                  ECSRIRTN
 13698     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13699         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13700                                                                  ECSRIRTN
 13701     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 13702         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 13703     ELSE                                                         ECSRIRTN
 13704         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 13705                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 13706                                                                  ECSRIRTN
 13707     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13708         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 13709                                                                  ECSRIRTN
 13710     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 13711         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 13712             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 13713         ELSE                                                     ECSRIRTN
 13714             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 13715     ELSE                                                         ECSRIRTN
 13716         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 13717             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 13718             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 13719         ELSE                                                     ECSRIRTN
 13720             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 13721             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 13722                                                                  ECSRIRTN
 13723                                                                  ECSRIRTN
 13724 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 13725                                                                  ECSRIRTN
 13726     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13727         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 13728                                                                  ECSRIRTN
 13729     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13730         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13731                                                                  ECSRIRTN
 13732     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13733         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 13734                                                                  ECSRIRTN
 13735     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 13736     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 13737                                                                  ECSRIRTN
 13738     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 13739             VARYING                                              ECSRIRTN
 13740         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 13741             UNTIL                                                ECSRIRTN
 13742         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 13743                                                                  ECSRIRTN
 13744     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13745         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 13746     ELSE                                                         ECSRIRTN
 13747         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 13748                                                                  ECSRIRTN
 13749 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 13750                                                                  ECSRIRTN
 13751     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 13752         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13753                                                                  ECSRIRTN
 13754     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13755       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 13756           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 13757                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 13758               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 13759                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 13760               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 13761                                                                  ECSRIRTN
 13762     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13763       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 13764           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 13765                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 13766           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 13767                                                                  ECSRIRTN
 13768     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 13769         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 13770                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 13771                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 13772         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13773                                                                  ECSRIRTN
 13774     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13775         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13776                                                                  ECSRIRTN
 13777     IF INC-SUB = +1                                              ECSRIRTN
 13778         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13779     IF INC-SUB = +2                                              ECSRIRTN
 13780         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13781     IF INC-SUB = +3                                              ECSRIRTN
 13782         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13783     IF INC-SUB = +4                                              ECSRIRTN
 13784         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13785     IF INC-SUB = +5                                              ECSRIRTN
 13786         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 13787                                                                  ECSRIRTN
 13788     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 13789                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 13790                                                                  ECSRIRTN
 13791     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13792         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 13793                                                                  ECSRIRTN
 13794     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 13795              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 13796         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 13797     ELSE                                                         ECSRIRTN
 13798         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 13799                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 13800                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 13801                                                                  ECSRIRTN
 13802 CHECK-DISABS-EXIT.                                               ECSRIRTN
 13803      EXIT.                                                       ECSRIRTN
 13804                                                                  ECSRIRTN
 13805 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 13806                                                                  ECSRIRTN
 13807     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 13808         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13809                                                                  ECSRIRTN
 13810     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13811         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 13812             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 13813                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 13814                                                                  ECSRIRTN
 13815     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13816         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 13817             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 13818                                                                  ECSRIRTN
 13819 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 13820                                                                  ECSRIRTN
 13821     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13822         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 13823         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 13824             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 13825                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13826         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 13827         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13828                                                                  ECSRIRTN
 13829     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13830         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 13831                                                                  ECSRIRTN
 13832     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13833         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 13834             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 13835                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 13836             ELSE                                                 ECSRIRTN
 13837                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 13838         ELSE                                                     ECSRIRTN
 13839             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 13840                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 13841                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 13842             ELSE                                                 ECSRIRTN
 13843                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 13844                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 13845                                                                  ECSRIRTN
 13846     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13847         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13848                                                                  ECSRIRTN
 13849     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 13850         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 13851                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 13852     ELSE                                                         ECSRIRTN
 13853         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 13854             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 13855                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 13856                                                                  ECSRIRTN
 13857     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13858         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 13859             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 13860                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 13861                                                                  ECSRIRTN
 13862     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 13863         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 13864             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 13865               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 13866                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 13867                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 13868                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13869                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 13870                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 13871              ELSE                                                ECSRIRTN
 13872                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 13873                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 13874                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 13875                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 13876                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 13877                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 13878                                                                  ECSRIRTN
 13879                                                                  ECSRIRTN
 13880     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 13881        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 13882                               '220000' OR '230000')              ECSRIRTN
 13883           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 13884               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 13885                                                                  ECSRIRTN
 13886     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 13887                                                                  ECSRIRTN
 13888     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 13889                                                                  ECSRIRTN
 13890                                                                  ECSRIRTN
 13891 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 13892                                                                  ECSRIRTN
 13893     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13894         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13895                                                                  ECSRIRTN
 13896     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 13897         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 13898         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13899                                                                  ECSRIRTN
 13900     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 13901                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 13902                                                                  ECSRIRTN
 13903     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 13904         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13905                                                                  ECSRIRTN
 13906     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 13907         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 13908                                                                  ECSRIRTN
 13909     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 13910                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 13911         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 13912                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 13913         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 13914     ELSE                                                         ECSRIRTN
 13915         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 13916         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 13917                                                                  ECSRIRTN
 13918                                                                  ECSRIRTN
 13919 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 13920                                                                  ECSRIRTN
 13921     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 13922         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13923                                                                  ECSRIRTN
 13924     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 13925         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13926                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13927     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 13928                                                                  ECSRIRTN
 13929 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 13930                                                                  ECSRIRTN
 13931     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 13932     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 13933                                                                  ECSRIRTN
 13934     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 13935         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 13936             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 13937                                                                  ECSRIRTN
 13938     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 13939     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 13940                                                                  ECSRIRTN
 13941     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 13942         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13943                                                                  ECSRIRTN
 13944     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 13945         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 13946                                                                  ECSRIRTN
 13947 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 13948                                                                  ECSRIRTN
 13949     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13950         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13951                                                                  ECSRIRTN
 13952     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13953                                                                  ECSRIRTN
 13954 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 13955                                                                  ECSRIRTN
 13956     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 13957     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 13958                                                                  ECSRIRTN
 13959 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 13960     EXIT.                                                        ECSRIRTN
 13961                                                                  ECSRIRTN
 13962 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 13963                                                                  ECSRIRTN
 13964     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 13965         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 13966                                                                  ECSRIRTN
 13967 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 13968     EXIT.                                                        ECSRIRTN
 13969                                                                  ECSRIRTN
 13970                                                                  ECSRIRTN
 13971 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 13972                                                                  ECSRIRTN
 13973     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 13974     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 13975     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 13976     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 13977                                                                  ECSRIRTN
 13978     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 13979         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 13980         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 13981         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 13982         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 13983         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 13984         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13985         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 13986         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 13987         REIN-AH-LIMIT (1).                                       ECSRIRTN
 13988                                                                  ECSRIRTN
 13989     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 13990         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 13991                                                                  ECSRIRTN
 13992     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 13993                                                                  ECSRIRTN
 13994 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 13997                                                                  ECSRIRTN
 13998 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 13999     EXIT.                                                        ECSRIRTN
 14000                                                                  ECSRIRTN
 14001 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14002                                                                  ECSRIRTN
 14003     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14004                                                                  ECSRIRTN
 14005     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14006         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14007                                                                  ECSRIRTN
 14008     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14009         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14010             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14011                                                                  ECSRIRTN
 14012     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14013         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14014         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14015         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14016     ELSE                                                         ECSRIRTN
 14017         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14018         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14019         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14020                                                                  ECSRIRTN
 14021     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14022                                                                  ECSRIRTN
 14023     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14024        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14025         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14026                                                                  ECSRIRTN
 14027     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14028         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14029                                                                  ECSRIRTN
 14030 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14031     EXIT.                                                        ECSRIRTN
 14032                                                                  ECSRIRTN
 14033 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14034                                                                  ECSRIRTN
 14035     CONTINUE.                                                    ECSRIRTN
 14036*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14037 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14038     EXIT.                                                        ECSRIRTN
 14039                                                                  ECSRIRTN
 14040 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14041                                                                  ECSRIRTN
 14042     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14043         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14044                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14045                                                                  ECSRIRTN
 14046     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14047         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14048                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14049                                                                  ECSRIRTN
 14050     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14051                                                                  ECSRIRTN
 14052     START ERRTBL-IN                                              ECSRIRTN
 14053           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14054             INVALID KEY                                          ECSRIRTN
 14055               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14056                                                                  ECSRIRTN
 14057     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14058     MOVE 0 TO SUB1.                                              ECSRIRTN
 14059 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14060                                                                  ECSRIRTN
 14061     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14062                                                                  ECSRIRTN
 14063     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14064        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14065                                                                  ECSRIRTN
 14066     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14067        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14068        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14069                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14070        GO TO ABEND-PGM.                                          ECSRIRTN
 14071                                                                  ECSRIRTN
 14072     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14073        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14074                                                                  ECSRIRTN
 14075     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14076        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14077                                                                  ECSRIRTN
 14078     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14079        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14080                                                                  ECSRIRTN
 14081     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14082        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14083                                                                  ECSRIRTN
 14084     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14085        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         ( 184)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14086                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14087        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 275)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14088                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14089        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 275)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14090                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14091     END-PERFORM.                                                 ECSRIRTN
 14092     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14093                                                                  ECSRIRTN
 14094     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14095        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14096                                                                  ECSRIRTN
 14097     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14098        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14099                                                                  ECSRIRTN
 14100     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14101        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14102                                                                  ECSRIRTN
 14103     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14104        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14105                                                                  ECSRIRTN
 14106     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14107        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14108        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14109        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14110        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14111        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14112        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14113          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14114                                                                  ECSRIRTN
 14115     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14116                                                                  ECSRIRTN
 14117     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14118        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14119        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14120        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14121        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14122                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14123        GO TO ABEND-PGM.                                          ECSRIRTN
 14124                                                                  ECSRIRTN
 14125     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14126                                                                  ECSRIRTN
 14127     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14128                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14129     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14130                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14131     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14132                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14133                                                                  ECSRIRTN
 14134     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14135         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14136     ELSE                                                         ECSRIRTN
 14137         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14138                                                                  ECSRIRTN
 14139     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14140     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14141     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14142     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14143                                                                  ECSRIRTN
 14144 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14145                                                                  ECSRIRTN
 14146     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14147        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14148                                                                  ECSRIRTN
 14149     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14150        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14151                                                                  ECSRIRTN
 14152     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14153        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14154                                                                  ECSRIRTN
 14155     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14156        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14157                                                                  ECSRIRTN
 14158     ADD +1 TO SUB1.                                              ECSRIRTN
 14159                                                                  ECSRIRTN
 14160     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14161        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14162        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14163                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14164        GO TO ABEND-PGM.                                          ECSRIRTN
 14165                                                                  ECSRIRTN
 14166     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14167     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14168     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14169     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14170     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14171     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14172     if re-state-exhibit-opt-f = 'Y'
 14173        move 'Y'         to rc2-ecs152-rpt (sub1)
 14174     else
 14175        move 'N'         to rc2-ecs152-rpt (sub1)
 14176     end-if
 14177                                                                  ECSRIRTN
 14178     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14179                                                                  ECSRIRTN
 14180 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14181     EXIT.                                                        ECSRIRTN
 14182                                                                  ECSRIRTN
 14183 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14184                                                                  ECSRIRTN
 14185     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14186                                                                  ECSRIRTN
 14187     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14188                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14189                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14190                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14191                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14192                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14193                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14194                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14195                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14196                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14197                                                                  ECSRIRTN
 14198 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14199     EXIT.                                                        ECSRIRTN
 14200                                                                  ECSRIRTN
 14201 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14202                                                                  ECSRIRTN
 14203     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14204                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14205     move spaces      to rc2-ecs152-rpt (co-sub)
 14206                                                                  ECSRIRTN
 14207     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14208                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14209                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14210                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14211                                                                  ECSRIRTN
 14212 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14213     EXIT.                                                        ECSRIRTN
 14214******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010S.cbl
 14216******************************************************************
 14217***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14218******************************************************************
 14219
 14220 3600-RC-REINSURANCE.
 14221
 14222     IF DTE-PGM-OPT NOT = '1'
 14223         GO TO 3799-RC-REINSURANCE-X.
 14224
 14225     IF DTE-CLIENT = 'WSL'
 14226         IF CR-REIN-TABLE = '00A'
 14227             GO TO 3799-RC-REINSURANCE-X.
 14228
 14229     IF CR-REIN-TABLE = SPACES OR ZEROS
 14230         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14231
 14232 3610-CLEAR-RC-REIN.
 14233
 14234     MOVE SPACES TO RC-REIN-LEVELS (1).
 14235     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14236                    RC-REIN-LFPRM (1)
 14237                    RC-REIN-AHAMT (1)
 14238                    RC-REIN-AHPRM (1)
 14239                    RC-REIN-LFRFND (1)
 14240                    RC-REIN-AHRFND (1)
 14241                    RC-REIN-LFCLM (1)
 14242                    RC-REIN-AHCLM (1).
 14243
 14244     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14245         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14246
 14247     MOVE +1 TO SUB1.
 14248     MOVE +0 TO SUB2.
 14249
 14250     GO TO 3630-RC-REIN-LOOP-1.
 14251
 14252 3620-CLEAR-RC-LEVELS.
 14253
 14254     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14255
 14256
 14257 3630-RC-REIN-LOOP-1.
 14258
 14259     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14260         ADD +1 TO SUB2
 14261         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14262         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14263         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14264         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14265         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14266         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14267         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14268         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14269         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14270         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14271
 14272     ADD +1 TO SUB1.
 14273     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010S.cbl
 14274         GO TO 3630-RC-REIN-LOOP-1.
 14275
 14276     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14277
 14278     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14279     IF CR-REIN-TABLE = SPACES OR ZEROS
 14280         MOVE +1                     TO SUB1
 14281         GO TO 3710-RC-REIN-LOOP-2.
 14282
 14283     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14284
 14285 3640-NSP-REIN-RATING-ROUTINE.
 14286
 14287     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14288     MOVE 'L'                        TO DC-OPTION-CODE.
 14289     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14290     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14291     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14292     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14293     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14294     MOVE CR-APR                     TO CP-LOAN-APR.
 14295     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14296     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14297     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14298     MOVE ZEROS                      TO CP-CLASS-CODE.
 14299
 14300     IF DTE-CLIENT = 'TIC'
 14301        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14302            MOVE ZERO                TO CP-CLASS-CODE
 14303        ELSE
 14304            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14305
 14306     MOVE '3'                        TO CP-PROCESS-TYPE.
 14307     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 14308     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 14309
 14310 3650-NSP-REIN-LIFE.
 14311
 14312     IF CR-LFTYP = ZERO
 14313         GO TO 3660-NSP-REIN-AH.
 14314     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 14315        OR (DTE-CLIENT = 'DCC')
 14316         GO TO 3660-NSP-REIN-AH.
 14317     IF DTE-CLIENT NOT = 'LBL'
 14318         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 14319             GO TO 3660-NSP-REIN-AH.
 14320
 14321     IF RE-NSP-ST-CD-LF NOT = STATE-L
 14322         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 14323         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14324
 14325     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 14326     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 14327     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 14328                                        CP-RATING-BENEFIT-AMT.
 14329     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 14330     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 14331     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010S.cbl
 14332     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 14333     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14334     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 14335     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14336
 14337     IF CP-STATE-STD-ABBRV = 'OR'
 14338         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 14339
 14340     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14341
 14342     IF CP-ERROR-RATE-NOT-FOUND  OR
 14343        CP-ERROR-RATE-IS-ZERO
 14344         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 14345                                     TO WS-ABEND-MESSAGE
 14346         MOVE 0302                   TO WS-ABEND-CODE
 14347         DISPLAY '******************************'
 14348         DISPLAY '***** ERROR LOCATION 018 *****'
 14349         DISPLAY '******************************'
 14350         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14351         GO TO ABEND-PGM.
 14352
 14353     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 14354
 14355*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 14356*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 14357
 14358     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 14359                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 14360
 14361     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 14362
 14363 3660-NSP-REIN-AH.
 14364
 14365     IF CR-AHTYP = ZERO
 14366         GO TO 3669-NSP-REIN-X.
 14367     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 14368        OR (DTE-CLIENT = 'DCC')
 14369         GO TO 3669-NSP-REIN-X.
 14370     IF DTE-CLIENT NOT = 'LBL'
 14371         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 14372             GO TO 3669-NSP-REIN-X.
 14373
 14374     IF RE-NSP-ST-CD-AH NOT = STATE-L
 14375         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 14376         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14377
 14378     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 14379     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 14380     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 14381                                        CP-RATING-BENEFIT-AMT.
 14382     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 14383     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 14384     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 14385     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 14386     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14387     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 14388     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14389
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010S.cbl
 14390     IF CP-STATE-STD-ABBRV = 'OR'
 14391         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 14392
 14393     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14394
 14395     IF CP-ERROR-RATE-NOT-FOUND  OR
 14396        CP-ERROR-RATE-IS-ZERO
 14397         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 14398                                     TO WS-ABEND-MESSAGE
 14399         MOVE 0302                   TO WS-ABEND-CODE
 14400         DISPLAY '******************************'
 14401         DISPLAY '***** ERROR LOCATION 019 *****'
 14402         DISPLAY '******************************'
 14403         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14404         GO TO ABEND-PGM.
 14405
 14406     COMPUTE CR-AH-NSP-PRM ROUNDED =
 14407             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 14408
 14409     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 14410
 14411 3669-NSP-REIN-X.
 14412     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010S.cbl
 14414******************************************************************
 14415***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 14416******************************************************************
 14417
 14418 3700-RC-REIN-PERF-CALC.
 14419
*14420                             COPY ECSRTPFM.
 14421******************************************************************07/10/97
 14422*                                                                *ECSRTPFM
 14423*                            ECSRTPFM                            *   LV001
 14424*                            VMOD=2.002                          *ECSRTPFM
 14425*                                                                *ECSRTPFM
 14426******************************************************************ECSRTPFM
 14427                                                                  ECSRTPFM
 14428     IF    CR-LFAMT  NUMERIC                                      00000072
 14429           NEXT SENTENCE                                          00000073
 14430        ELSE                                                      00000074
 14431           MOVE ZEROS TO CR-LFAMT.                                00000075
 14432                                                                  00000076
 14433     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 14434           NEXT SENTENCE                                          00000078
 14435        ELSE                                                      00000079
 14436           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 14437                                                                  00000081
 14438                                                                  00000082
 14439     IF    CR-LFPRM  NUMERIC                                      00000083
 14440           NEXT SENTENCE                                          00000084
 14441        ELSE                                                      00000085
 14442           MOVE ZEROS TO CR-LFPRM.                                00000086
 14443                                                                  00000087
 14444     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 14445           NEXT SENTENCE                                          00000089
 14446        ELSE                                                      00000090
 14447           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 14448                                                                  00000092
 14449                                                                  00000093
 14450     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 14451           NEXT SENTENCE                                          00000095
 14452        ELSE                                                      00000096
 14453           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 14454                                                                  00000098
 14455     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 14456           NEXT SENTENCE                                          00000100
 14457        ELSE                                                      00000101
 14458           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 14459                                                                  00000103
 14460     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 14461           NEXT SENTENCE                                          00000105
 14462        ELSE                                                      00000106
 14463           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 14464                                                                  00000108
 14465     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 14466     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 14467     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 14468         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 14469     ELSE                                                         ECSRTPFM
 14470         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 14471     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010S.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 14472                                                                  ECSRTPFM
 14473     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 14474     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 14475     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 14476         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 14477     ELSE                                                         ECSRTPFM
 14478         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 14479     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 14480                                                                  ECSRTPFM
 14481     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 14482         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 14483             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 14484                                                                  ECSRTPFM
 14485
 14486     IF CR-STATE NOT = STATE-L
 14487         MOVE CR-STATE               TO STATE-L
 14488         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14489
 14490     MOVE 'X'                     TO REIN-RT-SW.
 14491     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 14492     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 14493     MOVE ' '                     TO REIN-RT-SW.
 14494
 14495 3710-RC-REIN-LOOP-2.
 14496
 14497     IF REIN-COMP (SUB1) = SPACES
 14498         GO TO 3730-RC-REIN-EXTRACTS.
 14499
 14500     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 14501        ADD +1 TO SUB1
 14502         GO TO 3710-RC-REIN-LOOP-2.
 14503
 14504     MOVE +1 TO SUB2.
 14505
 14506 3720-RC-REIN-LOOP-3.
 14507
 14508     IF RC-REIN-COMP (SUB2) = SPACES
 14509         ADD +1 TO SUB1
 14510         GO TO 3710-RC-REIN-LOOP-2.
 14511
 14512     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 14513         ADD +1 TO SUB2
 14514         GO TO 3720-RC-REIN-LOOP-3.
 14515
 14516     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 14517        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 14518        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 14519        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 14520         MOVE 'X' TO RC-OLD-ISS (SUB2)
 14521         MOVE 'X' TO RC-NEW-ISS (SUB1).
 14522
 14523     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 14524        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 14525         MOVE 'X' TO RC-OLD-CNC (SUB2)
 14526         MOVE 'X' TO RC-NEW-CNC (SUB1).
 14527
 14528     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 14529         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010S.cbl
 14530         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 14531
 14532     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 14533         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 14534         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 14535
 14536     ADD +1 TO SUB2.
 14537     GO TO 3720-RC-REIN-LOOP-3.
 14538
 14539 3730-RC-REIN-EXTRACTS.
 14540
 14541     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 14542     MOVE 'R' TO DE-REIN.
 14543     MOVE 'J' TO DE-TRANS.
 14544*****PERFORM EXTRACT-DATE-RELOAD.
 14545     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 14546     MOVE +1 TO SUB1.
 14547
 14548 3740-RC-REIN-OLD-ISSUE.
 14549
 14550     IF RC-REIN-COMP (SUB1) = SPACES
 14551         MOVE +1 TO SUB1
 14552         GO TO 3745-RC-REIN-NEW-ISSUE.
 14553
 14554     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14555         ADD +1 TO SUB1
 14556         GO TO 3740-RC-REIN-OLD-ISSUE.
 14557
 14558     IF RC-OLD-ISS (SUB1) = 'X'
 14559         ADD +1 TO SUB1
 14560         GO TO 3740-RC-REIN-OLD-ISSUE.
 14561
 14562     IF RC-REIN-LFAMT (SUB1) = ZERO
 14563        AND RC-REIN-LFPRM (SUB1) = ZERO
 14564        AND RC-REIN-AHAMT (SUB1) = ZERO
 14565        AND RC-REIN-AHPRM (SUB1) = ZERO
 14566         ADD +1 TO SUB1
 14567         GO TO 3740-RC-REIN-OLD-ISSUE.
 14568
 14569     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 14570     PERFORM EXTRACT-DATE-LOAD.
 14571     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 14572     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 14573     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 14574     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 14575     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 14576     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14577
 14578     ADD +1 TO BC-R-ISS.
 14579     ADD +1 TO SUB1.
 14580     GO TO 3740-RC-REIN-OLD-ISSUE.
 14581
 14582 3745-RC-REIN-NEW-ISSUE.
 14583
 14584     IF REIN-COMP (SUB1) = SPACES
 14585         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 14586                                         2259-END-CANCEL-BUILD
 14587         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010S.cbl
 14588         MOVE 'K'      TO DE-TRANS
 14589*********PERFORM EXTRACT-DATE-RELOAD
 14590         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 14591         MOVE +1       TO SUB1
 14592         GO TO 3750-RC-REIN-OLD-CANCEL.
 14593
 14594     IF REIN-REM-SW (SUB1) = 'Z'
 14595         ADD +1 TO SUB1
 14596         GO TO 3745-RC-REIN-NEW-ISSUE.
 14597
 14598     IF RC-NEW-ISS (SUB1) = 'X'
 14599         ADD +1 TO SUB1
 14600         GO TO 3745-RC-REIN-NEW-ISSUE.
 14601
 14602     IF REIN-LFAMT (SUB1) = ZERO
 14603        AND REIN-LFPRM (SUB1) = ZERO
 14604        AND REIN-AHAMT (SUB1) = ZERO
 14605        AND REIN-AHPRM (SUB1) = ZERO
 14606         ADD +1 TO SUB1
 14607         GO TO 3745-RC-REIN-NEW-ISSUE.
 14608
 14609     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14610     PERFORM EXTRACT-DATE-LOAD.
 14611     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14612     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14613     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14614     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14615     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14616     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14617
 14618     ADD +1 TO BC-R-ISS.
 14619     ADD +1 TO SUB1.
 14620     GO TO 3745-RC-REIN-NEW-ISSUE.
 14621
 14622 3750-RC-REIN-OLD-CANCEL.
 14623
 14624     IF RC-REIN-COMP (SUB1) = SPACES
 14625         MOVE +1 TO SUB1
 14626         GO TO 3755-RC-REIN-NEW-CANCEL.
 14627
 14628     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14629         ADD +1 TO SUB1
 14630         GO TO 3750-RC-REIN-OLD-CANCEL.
 14631
 14632     IF RC-OLD-CNC (SUB1) = 'X'
 14633         ADD +1 TO SUB1
 14634         GO TO 3750-RC-REIN-OLD-CANCEL.
 14635
 14636     IF RC-REIN-LFRFND (SUB1) = ZERO
 14637        AND RC-REIN-AHRFND (SUB1) = ZERO
 14638         ADD +1 TO SUB1
 14639         GO TO 3750-RC-REIN-OLD-CANCEL.
 14640
 14641     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 14642     PERFORM EXTRACT-DATE-LOAD.
 14643     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 14644     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 14645     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010S.cbl
 14646     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14647
 14648     ADD +1 TO BC-R-CNC.
 14649     ADD +1 TO SUB1.
 14650     GO TO 3750-RC-REIN-OLD-CANCEL.
 14651
 14652 3755-RC-REIN-NEW-CANCEL.
 14653
 14654     IF REIN-COMP (SUB1) = SPACES
 14655         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 14656         MOVE 'R' TO DE-REIN
 14657         MOVE 'L' TO DE-TRANS
 14658*********PERFORM EXTRACT-DATE-RELOAD
 14659         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 14660         MOVE +1 TO SUB1
 14661         GO TO 3760-RC-REIN-OLD-CLAIM.
 14662
 14663     IF REIN-REM-SW (SUB1) = 'Z'
 14664         ADD +1 TO SUB1
 14665         GO TO 3755-RC-REIN-NEW-CANCEL.
 14666
 14667     IF RC-NEW-CNC (SUB1) = 'X'
 14668         ADD +1 TO SUB1
 14669         GO TO 3755-RC-REIN-NEW-CANCEL.
 14670
 14671     IF REIN-LFRFND (SUB1) = ZERO
 14672        AND REIN-AHRFND (SUB1) = ZERO
 14673         ADD +1 TO SUB1
 14674         GO TO 3755-RC-REIN-NEW-CANCEL.
 14675
 14676     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 14677     PERFORM EXTRACT-DATE-LOAD.
 14678     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 14679     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 14680     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 14681     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14682
 14683     ADD +1 TO BC-R-CNC.
 14684     ADD +1 TO SUB1.
 14685     GO TO 3755-RC-REIN-NEW-CANCEL.
 14686
 14687 3760-RC-REIN-OLD-CLAIM.
 14688
 14689     IF RC-REIN-COMP (SUB1) = SPACES
 14690         MOVE +1 TO SUB1
 14691         GO TO 3780-RC-REIN-NEW-CLAIM.
 14692
 14693     IF RC-REIN-REM-SW (SUB1) = 'Z'
 14694         ADD +1 TO SUB1
 14695         GO TO 3760-RC-REIN-OLD-CLAIM.
 14696
 14697     IF RC-OLD-LF-CLM (SUB1) = 'X'
 14698         GO TO 3770-RC-REIN-OLD-AH-CLM.
 14699
 14700     IF RC-REIN-LFCLM (SUB1) = ZERO
 14701         GO TO 3770-RC-REIN-OLD-AH-CLM.
 14702
 14703     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010S.cbl
 14704     PERFORM EXTRACT-DATE-LOAD.
 14705     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 14706     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14707     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14708     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14709     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14710     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 14711     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 14712     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 14713     MOVE CR-DTH-PAY-DT TO DE-PAY
 14714                           WS-DE-PAY-N.
 14715
 14716     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14717         MOVE '3' TO DE-TYPE
 14718     ELSE
 14719         MOVE '1' TO DE-TYPE.
 14720
 14721     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14722
 14723     ADD +1 TO BC-R-CLM.
 14724
 14725 3770-RC-REIN-OLD-AH-CLM.
 14726
 14727     IF RC-OLD-AH-CLM (SUB1) = 'X'
 14728         ADD +1 TO SUB1
 14729         GO TO 3760-RC-REIN-OLD-CLAIM.
 14730
 14731     IF RC-REIN-AHCLM (SUB1) = ZERO
 14732         ADD +1 TO SUB1
 14733         GO TO 3760-RC-REIN-OLD-CLAIM.
 14734
 14735     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 14736     PERFORM EXTRACT-DATE-LOAD.
 14737     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 14738     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14739     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14740     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14741     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14742     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 14743     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 14744     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 14745     MOVE CR-DIS-PAY-DT TO DE-PAY
 14746                           WS-DE-PAY-N.
 14747
 14748     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14749         MOVE '4' TO DE-TYPE
 14750     ELSE
 14751         MOVE '2' TO DE-TYPE.
 14752
 14753     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14754
 14755     ADD +1 TO BC-R-CLM.
 14756     ADD +1 TO SUB1.
 14757
 14758     GO TO 3760-RC-REIN-OLD-CLAIM.
 14759
 14760 3780-RC-REIN-NEW-CLAIM.
 14761
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010S.cbl
 14762     IF REIN-COMP (SUB1) = SPACES
 14763         GO TO 3799-RC-REINSURANCE-X.
 14764
 14765     IF REIN-REM-SW (SUB1) = 'Z'
 14766         ADD +1 TO SUB1
 14767         GO TO 3780-RC-REIN-NEW-CLAIM.
 14768
 14769     IF RC-NEW-LF-CLM (SUB1) = 'X'
 14770         GO TO 3790-RC-REIN-NEW-AH-CLM.
 14771
 14772     IF REIN-LFCLM (SUB1) = ZERO
 14773         GO TO 3790-RC-REIN-NEW-AH-CLM.
 14774
 14775     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14776     PERFORM EXTRACT-DATE-LOAD.
 14777     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14778     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14779     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14780     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14781     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14782     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 14783     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 14784     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 14785     MOVE CR-DTH-PAY-DT     TO DE-PAY
 14786                               WS-DE-PAY-N.
 14787
 14788     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 14789         MOVE '3' TO DE-TYPE
 14790     ELSE
 14791         MOVE '1' TO DE-TYPE.
 14792
 14793     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14794
 14795     ADD +1 TO BC-R-CLM.
 14796
 14797 3790-RC-REIN-NEW-AH-CLM.
 14798
 14799     IF RC-NEW-AH-CLM (SUB1) = 'X'
 14800         ADD +1 TO SUB1
 14801         GO TO 3780-RC-REIN-NEW-CLAIM.
 14802
 14803     IF REIN-AHCLM (SUB1) = ZERO
 14804         ADD +1 TO SUB1
 14805         GO TO 3780-RC-REIN-NEW-CLAIM.
 14806
 14807     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 14808     PERFORM EXTRACT-DATE-LOAD.
 14809     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 14810     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 14811     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 14812     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 14813     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 14814     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 14815     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 14816     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 14817     MOVE CR-DIS-PAY-DT     TO DE-PAY
 14818                               WS-DE-PAY-N.
 14819
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010S.cbl
 14820     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14821         MOVE '4' TO DE-TYPE
 14822     ELSE
 14823         MOVE '2' TO DE-TYPE.
 14824
 14825     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 14826
 14827     ADD +1 TO BC-R-CLM.
 14828     ADD +1 TO SUB1.
 14829
 14830     GO TO 3780-RC-REIN-NEW-CLAIM.
 14831
 14832 3799-RC-REINSURANCE-X.
 14833     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010S.cbl
 14835******************************************************************
 14836***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 14837******************************************************************
 14838
 14839 4000-EP-BUMP-RTN.
 14840
 14841     IF AM-RECALC-COMM = ('Y' OR '1')
 14842         PERFORM 1600-RECALC-COMM-EXTR
 14843             THRU 1899-RECALC-COMM-EXTR-X.
 14844
 14845     MOVE '1'    TO EP-FLG.
 14846     ADD +1      TO BC-G-CERTS.
 14847
 14848     MOVE CR-DT               TO HIGH-CERT.
 14849     IF CR-ACCT-CONTROL NOT = LOW-CTL
 14850         MOVE CR-DT           TO LOW-CERT
 14851         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 14852
 14853     IF CR-POLICY-IS-REIN-ONLY
 14854         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 14855                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 14856                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 14857                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 14858                              DTH-IBNR           DIS-IBNR
 14859                              DTH-PAYCUR         DIS-PAYCUR
 14860                              DTH-FUTRSV         DIS-FUTRSV
 14861         GO TO 4050-EP-DO-REINSURE.
 14862
 14863     MOVE CR-LFAMT       TO WE-LFAMT.
 14864     MOVE CR-LFPRM       TO WE-LFPRM.
 14865     IF CR-LFTYP NOT = ZEROS
 14866         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 14867             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 14868             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 14869         ELSE
 14870             MOVE ZEROS               TO WE-LFAMT-ALT
 14871                                         WE-LFPRM-ALT.
 14872
 14873     MOVE SPACES         TO REIN-EP-FLG
 14874                            WE-REIN-CO.
 14875     MOVE CR-LFRFND      TO WE-LFRFND.
 14876     MOVE CR-DTHAMT      TO WE-DTHAMT.
 14877     ADD  CR-DTHEXP      TO WE-DTHAMT.
 14878     MOVE CR-DTHEXP      TO WE-DTHEXP.
 14879     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 14880     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 14881     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 14882     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 14883
 14884     MOVE CR-AHPRM       TO WE-AHPRM.
 14885     MOVE CR-AHAMT       TO WE-AHAMT.
 14886     MOVE CR-AHRFND      TO WE-AHRFND.
 14887     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 14888     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 14889     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 14890     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
 14891     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 14892     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010S.cbl
 14893     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 14894
 14895     IF CR-POLICY-IS-RESTORE  OR
 14896        CR-POLICY-IS-REISSUE
 14897        OR CR-POLICY-IS-MONTHLY
 14898         MOVE ZEROS      TO WE-LFPRM
 14899                            WE-LFPRM-ALT
 14900                            WE-AHPRM.
 14901
 14902     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 14903                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 14904                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 14905                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 14906                              DTH-IBNR           DIS-IBNR
 14907                              DTH-PAYCUR         DIS-PAYCUR
 14908                              DTH-FUTRSV         DIS-FUTRSV.
 14909
 14910     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 14911
 14912     IF CR-POLICY-IS-DECLINED  OR
 14913        CR-POLICY-IS-VOID
 14914         GO TO 4099-EP-BUMP-RTN-X.
 14915
 14916 4050-EP-DO-REINSURE.
 14917
 14918     MOVE 'R' TO REIN-EP-FLG.
 14919     MOVE +1  TO SUB5.
 14920
 14921 4090-EP-DO-REINSURE-LOOP.
 14922
 14923     IF REIN-COMP (SUB5) = SPACES
 14924         MOVE SPACE TO REIN-EP-FLG
 14925         GO TO 4099-EP-BUMP-RTN-X.
 14926
 14927     IF REIN-REM-SW (SUB5) = 'Z'  OR
 14928        REIN-LF-AH-FLGS (SUB5) = SPACES
 14929         ADD +1 TO SUB5
 14930         GO TO 4090-EP-DO-REINSURE-LOOP.
 14931
 14932     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 14933        VARYING CO-SUB FROM 1 BY 1 UNTIL
 14934          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 14935          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 14936          (RCT-REIN-CO (CO-SUB) = SPACES).
 14937
 14938     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 14939        (RCT-REIN-CO (CO-SUB) = SPACES)
 14940        MOVE ZERO TO CO-SUB.
 14941
 14942     ADD +1 TO BC-R-CERTS.
 14943     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
 14944     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 14945     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 14946
 14947     IF DTE-CLIENT = 'DCC'
 14948        COMPUTE WS-CEDE-FACT =
 14949           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14950        IF AM-RECALC-COMM = ('Y' OR '1')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010S.cbl
 14951           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 14952*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 14953*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 14954           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 14955           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 14956        END-IF
 14957     END-IF
 14958
 14959     MOVE RWF-LFPRM      TO WE-LFPRM.
 14960     MOVE RWF-LFAMT      TO WE-LFAMT.
 14961     MOVE RWF-LFRFND     TO WE-LFRFND.
 14962     MOVE RWF-LFCLM      TO WE-DTHAMT.
 14963     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 14964     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 14965     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 14966     MOVE +0             TO WE-LFAMT-ALT
 14967                            WE-LFPRM-ALT
 14968                            WE-DTHEXP
 14969                            WE-NUM-DTH-CLM.
 14970
 14971     IF (DTE-CLIENT EQUAL 'NSL') AND
 14972        (CR-REIN-TABLE EQUAL 'NAR')
 14973        CONTINUE
 14974     ELSE
 14975      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 14976       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 14977        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 14978            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 14979        COMPUTE WE-LFAMT ROUNDED EQUAL
 14980                           CR-LFAMT * WS-CEDE-FACT
 14981        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 14982                           CR-LFAMT-ALT * WS-CEDE-FACT
 14983        IF (DTE-CLIENT = 'CID')
 14984           AND (CR-LF-NSP-PRM > +0)
 14985           AND (CR-ENTRY-DATE > 20031130)
 14986           AND (WT-LF-QC NOT = '1' AND '3')
 14987           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 14988              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 14989           MOVE +0            TO WE-LFPRM-ALT
 14990        ELSE
 14991          IF (DTE-CLIENT = 'CID')
 14992             AND (CR-LF-NSP-PRM > +0)
 14993             AND (CR-ENTRY-DATE > 20030430)
 14994             AND (WT-LF-QC NOT = '1' AND '3')
 14995             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 14996             MOVE +0            TO WE-LFPRM-ALT
 14997          ELSE
 14998             COMPUTE WE-LFPRM ROUNDED EQUAL
 14999                           CR-LFPRM * WS-CEDE-FACT
 15000             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15001                           CR-LFPRM-ALT * WS-CEDE-FACT
 15002          END-IF
 15003        END-IF
 15004        IF (DTE-CLIENT = 'CID')
 15005           AND (CR-LF-NSP-PRM > +0)
 15006           AND (CR-LFRFND-CALC > +0)
 15007           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15008           AND (WT-LF-QC NOT = '1' AND '4')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010S.cbl
 15009           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15010              (CR-LFPRM + CR-LFPRM-ALT)
 15011           COMPUTE WE-LFRFND =
 15012              REIN-FACTOR * REIN-CALCED-LIFE
 15013           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15014              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15015*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15016*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15017*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15018        ELSE
 15019
 15020          IF (DTE-CLIENT = 'CID')
 15021           AND (CR-LF-NSP-PRM > +0)
 15022           AND (CR-LFRFND-CALC > +0)
 15023           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15024           AND (WT-LF-QC NOT = '1' AND '4')
 15025           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15026           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15027              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15028
 15029          END-IF
 15030        END-IF
 15031       ELSE
 15032         MOVE +0 TO WS-CEDE-FACT
 15033       END-IF
 15034      END-IF
 15035     END-IF
 15036
 15037     IF DTE-CLIENT = 'DCC'
 15038        IF AM-RECALC-COMM = ('Y' OR '1')
 15039           COMPUTE WS-CEDE-FACT =
 15040               RWF-AHAMT / CR-AHAMT
 15041           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15042           COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15043           / CR-AHPRM * CR-AHRFND
 15044        END-IF
 15045     END-IF
 15046
 15047     MOVE RWF-AHPRM      TO WE-AHPRM.
 15048
 15049     MOVE RWF-AHAMT      TO WE-AHAMT
 15050     MOVE RWF-AHRFND     TO WE-AHRFND.
 15051     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15052     MOVE +0             TO WE-DSPY-EXP
 15053                            WE-NUM-DIS-CLM.
 15054     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15055     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15056     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15057
 15058     IF  RWF-LF-RUNOFF-SW = 'N'
 15059             OR
 15060         RWF-AH-RUNOFF-SW = 'N'
 15061         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15062
 15063     IF  RWF-LF-RUNOFF-SW = 'N'
 15064         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15065     ELSE
 15066         MOVE 99999999             TO STOP-LF-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010S.cbl
 15067
 15068     IF  RWF-AH-RUNOFF-SW = 'N'
 15069         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15070     ELSE
 15071         MOVE 99999999             TO STOP-AH-DATE.
 15072
 15073     IF CR-POLICY-IS-RESTORE  OR
 15074        CR-POLICY-IS-REISSUE
 15075        OR CR-POLICY-IS-MONTHLY
 15076         MOVE ZEROS      TO WE-LFPRM
 15077                            WE-LFPRM-ALT
 15078                            WE-AHPRM.
 15079
 15080     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15081
 15082     IF CO-SUB NOT = ZERO
 15083       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15084         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15085             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15086
 15087     ADD +1 TO SUB5.
 15088     GO TO 4090-EP-DO-REINSURE-LOOP.
 15089
 15090 4099-EP-BUMP-RTN-X.
 15091     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010S.cbl
 15093******************************************************************
 15094***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15095******************************************************************
 15096
 15097 4100-EP-DO-LF.
 15098
 15099     MOVE +0                         TO ISS-BEN  EPR-R78
 15100                                        CNC-BEN  EPR-PRO
 15101                                        ISS-PRM  EPR-ST
 15102                                        ISS-PRMTAX
 15103                                        CNC-PRM  ACTIVE-COUNT.
 15104     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15105
 15106     IF CR-LFTYP = ZERO
 15107         GO TO 4200-EP-DO-AH.
 15108
 15109     IF REIN-EP-FLG = 'R'
 15110         IF REIN-LF-FLG (SUB5) = SPACE
 15111             GO TO 4200-EP-DO-AH.
 15112
 15113     IF CR-APR NOT NUMERIC
 15114         MOVE ZERO TO CR-APR.
 15115
 15116     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15117     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15118     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15119
 15120     IF CR-POLICY-IS-DECLINED  OR
 15121        CR-POLICY-IS-VOID
 15122         GO TO 4191-CONTINUE.
 15123
 15124     MOVE CR-LF-TERM             TO ORIG-TERM.
 15125     MOVE CLAS-INDEXL            TO W-NDX.
 15126
 15127     IF CR-DT GREATER EW-COV-DTE
 15128         MOVE CR-DT              TO EW-COV-DTE.
 15129
 15130     IF (NOT CR-POLICY-IS-RESTORE) AND
 15131        (NOT CR-POLICY-IS-REISSUE)
 15132        AND (NOT CR-POLICY-IS-MONTHLY)
 15133         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15134         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15135             ADD CR-LIVES TO EW-ISS-CNT
 15136             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15137                                    (ORIG-TERM * CR-LIVES)
 15138             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15139             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15140             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15141                                   (ORIG-TERM * ISS-BEN)
 15142         ELSE
 15143             ADD +1 TO EW-ISS-CNT
 15144             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15145             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15146             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15147             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15148                                   (ORIG-TERM * ISS-BEN).
 15149
 15150     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010S.cbl
 15151     MOVE '2'             TO W-VAL-SOURCE.
 15152
 15153     IF REIN-EP-FLG = 'R'
 15154         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15155            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15156             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15157             MOVE '10'              TO W-VAL-SOURCE.
 15158
 15159     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15160
 15161     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15162        (REM-TRM3 GREATER ZERO)
 15163        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15164            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15165                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15166            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15167                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15168          ELSE
 15169            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15170            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15171
 15172     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15173
 15174     IF DTE-CLIENT = 'GIC'
 15175         IF REIN-EP-FLG NOT = 'R'  AND
 15176            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15177            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15178            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15179
 15180     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15181         GO TO 4105-EP-DO-LF-REIN-CHK.
 15182
 15183     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15184             AND
 15185         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15186             AND
 15187         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15188                 OR
 15189             CR-LF-CANC-DT EQUAL ZEROS)
 15190             AND
 15191         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15192                 OR
 15193             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15194         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15195         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15196                 VARYING
 15197             SUBM FROM +1 BY +1
 15198                 UNTIL
 15199             SUBM GREATER THAN +13.
 15200
 15201     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15202     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15203
 15204 4105-EP-DO-LF-REIN-CHK.
 15205
 15206     IF REIN-EP-FLG = 'R'  AND
 15207        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15208         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010S.cbl
 15209     ELSE
 15210         GO TO 4110-EP-DO-LF-CLM.
 15211
 15212     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15213         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15214             GO TO 4130-EP-DO-LF-EP.
 15215
 15216     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15217         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15218             GO TO 4130-EP-DO-LF-EP.
 15219
 15220 4110-EP-DO-LF-CLM.
 15221
 15222     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15223         NEXT  SENTENCE
 15224       ELSE
 15225         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15226
 15227     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15228     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15229
 15230     IF CR-LF-STATUS-AT-DEATH = ' '
 15231         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15232             GO TO 4115-EP-DO-LF-CLM-EPR.
 15233
 15234     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15235     ADD +1             TO EW-CLM-CRT.
 15236
 15237 4115-EP-DO-LF-CLM-EPR.
 15238
 15239     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15240         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15241         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15242     END-IF
 15243     .
 15244 4120-EP-DO-LF-CNCL.
 15245
 15246     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15247        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15248         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15249             GO TO 4190-EP-DO-LF-COMM
 15250         ELSE
 15251             GO TO 4130-EP-DO-LF-EP.
 15252
 15253     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15254         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15255         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15256
 15257     ADD +1                       TO EW-CNC-CNT.
 15258
 15259     MOVE WE-LFRFND               TO CNC-PRM.
 15260
 15261     IF DTE-CLIENT = 'GIC'
 15262         IF REIN-EP-FLG NOT = 'R'  AND
 15263            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15264             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15265
 15266     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010S.cbl
 15267     MOVE 'L'                   TO  DC-OPTION-CODE.
 15268     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15269     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15270
 15271     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15272     MOVE 'L'                   TO  DC-OPTION-CODE.
 15273     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15274     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15275
 15276     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15277     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15278     MOVE '1'                     TO  DC-OPTION-CODE.
 15279     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15280     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 15281     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 15282                                      DC-ODD-DAYS-OVER
 15283                                      DC-ELAPSED-DAYS.
 15284     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15285     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 15286
 15287     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 15288         ADD  +1                  TO  MONTHS-DIFF-LF.
 15289
 15290     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15291
 15292     IF DTE-CLIENT = 'ACE'
 15293         GO TO 4120-CONTINUE-LIFE-CANCEL.
 15294
 15295     MOVE  ZEROS                  TO  SUB.
 15296
 15297 4120-LIFE-CHARGEBACK-LOOP.
 15298
 15299     ADD    +1                    TO  SUB.
 15300
 15301     IF  SUB  GREATER THAN  +10
 15302         GO TO  4120-CONTINUE-LIFE-CANCEL.
 15303
 15304     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 15305         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 15306         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15307
 15308     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 15309         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 15310
 15311     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 15312         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 15313
 15314     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15315
 15316
 15317 4120-CONTINUE-LIFE-CANCEL.
 15318
 15319     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 15320     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 15321
 15322     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 15323         GO TO 4190-EP-DO-LF-COMM.
 15324
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010S.cbl
 15325     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15326         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15327         GO TO 4190-EP-DO-LF-COMM.
 15328
 15329     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15330     MOVE '3'           TO W-VAL-SOURCE.
 15331     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15332
 15333     IF REM-TRM3 = CR-LF-TERM
 15334         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15335         GO TO 4190-EP-DO-LF-COMM.
 15336
 15337     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15338         GO TO 4122-EP-DO-LF-CNCL-TEX.
 15339
 15340     IF DTE-CLIENT = 'NCL'
 15341         IF CR-DT LESS THAN 19910101
 15342             GO TO 4121-EP-DO-LF-CNC-BEN.
 15343
 15344     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15345         GO TO 4126-EP-DO-LF-CNCL-NP.
 15346
 15347     IF DTE-CLIENT = 'FUL'
 15348         GO TO 4128-EP-DO-LF-CNCL-FUL.
 15349
 15350*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15351     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 15352        (CR-RATING-CLASS NOT = 'L ')
 15353         IF (CR-APR GREATER THAN ZERO)  AND
 15354            (CR-LF-TERM GREATER THAN 060)  AND
 15355            (CR-DT GREATER THAN 19831031)
 15356              GO TO 4126-EP-DO-LF-CNCL-NP.
 15357
 15358     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15359         IF (CR-APR GREATER THAN ZERO)  AND
 15360            (CR-LF-TERM GREATER THAN 061)  AND
 15361            (CR-DT GREATER THAN 19830318)
 15362              GO TO 4126-EP-DO-LF-CNCL-NP.
 15363
 15364     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15365         IF (CR-APR GREATER THAN ZERO)  AND
 15366            (CR-LF-TERM GREATER THAN 062)  AND
 15367            (CR-DT GREATER THAN 19810831)  AND
 15368            (CR-DT LESS THAN 19830901)
 15369              GO TO 4126-EP-DO-LF-CNCL-NP.
 15370
 15371     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15372         IF (CR-APR GREATER THAN ZERO)  AND
 15373            (CR-LF-TERM GREATER THAN 060)  AND
 15374            (CR-DT GREATER THAN 19831231)
 15375              GO TO 4126-EP-DO-LF-CNCL-NP.
 15376
 15377 4121-EP-DO-LF-CNC-BEN.
 15378
 15379     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 15380
 15381     COMPUTE TEMP-3 ROUNDED EQUAL
 15382         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010S.cbl
 15383
 15384     MOVE TEMP-3                 TO CNC-BEN.
 15385
 15386     GO TO 4190-EP-DO-LF-COMM.
 15387
 15388 4122-EP-DO-LF-CNCL-TEX.
 15389
 15390     DIVIDE WE-LFAMT BY CR-LF-TERM
 15391         GIVING TEX-FACT-1.
 15392     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 15393         GIVING TEX-FACT-2
 15394             REMAINDER TEX-FACT-3.
 15395     IF TEX-FACT-3 NOT = ZERO
 15396         ADD +1 TO TEX-FACT-2.
 15397
 15398     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 15399
 15400     GO TO 4190-EP-DO-LF-COMM.
 15401
 15402 4124-EP-DO-LF-CNCL-SUM.
 15403
 15404     IF WE-LFRFND = ZERO
 15405         GO TO 4130-EP-DO-LF-EP.
 15406
 15407     MOVE WE-LFRFND TO CNC-PRM.
 15408
 15409     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15410
 15411     IF WE-LFRFND NOT LESS WE-LFPRM
 15412         MOVE WE-LFAMT TO CNC-BEN
 15413          GO TO 4130-EP-DO-LF-EP.
 15414
 15415
 15416     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 15417
 15418     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15419         MOVE TEMP-7 TO CNC-BEN
 15420          GO TO 4130-EP-DO-LF-EP.
 15421
 15422     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15423     MOVE '4'           TO W-VAL-SOURCE.
 15424     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15425
 15426     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 15427         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 15428         GO TO 4130-EP-DO-LF-EP.
 15429
 15430 4126-EP-DO-LF-CNCL-NP.
 15431
 15432     IF WE-LFAMT = ZERO
 15433        GO TO 4190-EP-DO-LF-COMM.
 15434
 15435     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 15436     MOVE 'L'                        TO  DC-OPTION-CODE.
 15437     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15438     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 15439
 15440     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010S.cbl
 15441       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 15442       MOVE '3'                      TO  DC-OPTION-CODE
 15443       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15444       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 15445     ELSE
 15446       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 15447       MOVE '6'                      TO  DC-OPTION-CODE
 15448       MOVE +1                       TO  DC-ELAPSED-MONTHS
 15449       MOVE +0                       TO  DC-ELAPSED-DAYS
 15450       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15451       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 15452
 15453     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 15454     MOVE CR-APR                     TO  CP-LOAN-APR.
 15455     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 15456     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 15457     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 15458     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 15459     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 15460     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 15461
 15462     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 15463
 15464     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15465       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 15466       GO TO 4130-EP-DO-LF-EP
 15467     ELSE
 15468       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 15469
 15470     GO TO 4190-EP-DO-LF-COMM.
 15471
 15472 4128-EP-DO-LF-CNCL-FUL.
 15473
 15474     IF WE-LFAMT = ZERO
 15475        GO TO 4190-EP-DO-LF-COMM.
 15476
 15477     MOVE CR-APR              TO NP-APR.
 15478     MOVE CR-LF-TERM          TO NP-ORIG.
 15479     MOVE REM-TRM3            TO NP-REM.
 15480     MOVE '2'                 TO NP-OPT.
 15481     MOVE CR-AHPRM            TO NP-AHPRM.
 15482     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 15483     MOVE CR-LFAMT            TO NP-BENEFIT.
 15484
 15485*    CALL 'FULNETRM'
 15486*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 15487*              NP-ACCOUNT NP-REMAINING.
 15488
 15489     MOVE NP-REMAINING TO CNC-BEN.
 15490
 15491     GO TO 4190-EP-DO-LF-COMM.
 15492
 15493 4130-EP-DO-LF-EP.
 15494
 15495     MOVE SPACE                  TO STATUTORY-SWITCH.
 15496
 15497     MOVE EOM-RUN-DATE TO VALUATION-DT.
 15498     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010S.cbl
 15499
 15500     IF REIN-EP-FLG = 'R'
 15501       IF REIN-REM-SW (SUB5) = 'I'
 15502           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15503           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 15504           GO TO 4190-EP-DO-LF-COMM.
 15505
 15506     IF REIN-EP-FLG = 'R'
 15507         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 15508            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15509             MOVE '*'               TO LIFE-EARNED-SWITCH
 15510             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15511             MOVE '10'              TO W-VAL-SOURCE.
 15512
 15513     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15514
 15515     IF REM-TRM2 GREATER CR-LF-TERM
 15516         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 15517         GO TO 4190-EP-DO-LF-COMM.
 15518
 15519     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15520         GO TO 4180-EP-DO-LF-EP-SUM.
 15521
 15522     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15523         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 15524             IF REM-TRM2 NOT GREATER THAN +0
 15525                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15526                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15527                 GO TO 4190-EP-DO-LF-COMM
 15528             ELSE
 15529                 NEXT SENTENCE
 15530         ELSE
 15531             IF W-BAL-REMTRM NOT GREATER +0
 15532                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15533                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15534                 GO TO 4190-EP-DO-LF-COMM
 15535             ELSE
 15536                 NEXT SENTENCE
 15537     ELSE
 15538        IF DTE-CLIENT = 'NCL'  AND
 15539           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15540            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 15541        ELSE
 15542         IF REM-TRM2 NOT GREATER +0  OR
 15543            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15544             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 15545             GO TO 4190-EP-DO-LF-COMM.
 15546
 15547     MOVE +1 TO ACTIVE-COUNT.
 15548
 15549     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15550         GO TO 4140-EP-DO-LF-EP-TEX.
 15551
 15552     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15553         GO TO 4150-EP-DO-LF-EP-NP.
 15554
 15555*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15556     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010S.cbl
 15557        (CR-RATING-CLASS NOT = 'L ')
 15558         IF (CR-APR GREATER THAN ZERO)  AND
 15559            (CR-LF-TERM GREATER THAN 060)  AND
 15560            (CR-DT GREATER THAN 19831031)
 15561             MOVE '*'             TO STATUTORY-SWITCH
 15562              GO TO 4150-EP-DO-LF-EP-NP.
 15563
 15564     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15565         IF (CR-APR GREATER THAN ZERO)  AND
 15566            (CR-LF-TERM GREATER THAN 061)  AND
 15567            (CR-DT GREATER THAN 19830318)
 15568             MOVE '*'             TO STATUTORY-SWITCH
 15569              GO TO 4150-EP-DO-LF-EP-NP.
 15570
 15571     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15572         IF (CR-APR GREATER THAN ZERO)  AND
 15573            (CR-LF-TERM GREATER THAN 062)  AND
 15574            (CR-DT GREATER THAN 19810831)  AND
 15575            (CR-DT LESS THAN 19830901)
 15576             MOVE '*'             TO STATUTORY-SWITCH
 15577              GO TO 4150-EP-DO-LF-EP-NP.
 15578
 15579     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15580         IF (CR-APR GREATER THAN ZERO)  AND
 15581            (CR-LF-TERM GREATER THAN 060)  AND
 15582            (CR-DT GREATER THAN 19831231)
 15583             MOVE '*'             TO STATUTORY-SWITCH
 15584              GO TO 4150-EP-DO-LF-EP-NP.
 15585
 15586     GO TO 4160-EP-DO-LF-EP-R78.
 15587
 15588 4140-EP-DO-LF-EP-TEX.
 15589
 15590     IF CR-PMT-FREQ = 0
 15591       DISPLAY '*************************************'
 15592       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 15593       DISPLAY '*************************************'
 15594       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 15595       DISPLAY '*************************************'
 15596       COMPUTE TEX-FACT-4 =
 15597          (CR-LF-TERM * CR-LF-TERM) +
 15598                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 15599     ELSE
 15600        COMPUTE TEX-FACT-4 =
 15601         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 15602
 15603     IF CR-PMT-FREQ = 0
 15604       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 15605           GIVING TEX-FACT-5
 15606               REMAINDER TEX-FACT-6
 15607     ELSE
 15608        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 15609            GIVING TEX-FACT-5
 15610                REMAINDER TEX-FACT-6.
 15611
 15612     IF CR-PMT-FREQ > 0
 15613        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 15614
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010S.cbl
 15615     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 15616     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 15617         (TEX-FACT-5 * CR-PMT-FREQ) +
 15618         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 15619     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 15620
 15621     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 15622
 15623     GO TO 4170-EP-DO-LF-EP-PRO.
 15624
 15625 4150-EP-DO-LF-EP-NP.
 15626
 15627     IF WE-LFPRM = ZERO
 15628         GO TO 4160-EP-DO-LF-EP-R78.
 15629
 15630     IF DTE-CLIENT = 'CRI'
 15631       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 15632             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 15633           GO TO 4160-EP-DO-LF-EP-R78.
 15634
 15635     IF DTE-CLIENT = 'NCL'
 15636       IF CR-DT LESS THAN 19910101
 15637           GO TO 4160-EP-DO-LF-EP-R78.
 15638
 15639     IF REM-TRM1 = CR-LF-TERM
 15640         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 15641         GO TO 4190-EP-DO-LF-COMM.
 15642
 15643     MOVE CR-APR TO NP-APR.
 15644     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 15645     MOVE REM-TRM1 TO NP-REM.
 15646     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 15647     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 15648         MOVE CR-LOAN-TERM TO NP-ORIG.
 15649
 15650     MOVE 'R' TO NP-OPT.
 15651     CALL 'ECSNETRM'
 15652         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 15653
 15654     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 15655
 15656     IF STATUTORY-REQUIREMENT
 15657         MOVE EPR-R78                TO EPR-ST.
 15658
 15659 4160-EP-DO-LF-EP-R78.
 15660
 15661     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 15662        (DTE-CLIENT EQUAL 'NCL')
 15663        IF (CR-CCYY EQUAL EOM-CCYY) AND
 15664           (CR-MO EQUAL EOM-MO)
 15665           MOVE '*'            TO OB-DATE-1-SWITCH
 15666           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15667           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15668           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15669           COMPUTE WS-EPR-R78 (SUB3 1) =
 15670                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 15671           GO TO 4190-EP-DO-LF-COMM
 15672        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010S.cbl
 15673        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 15674           (CR-MO EQUAL OB-MO (1))
 15675           MOVE '*'            TO OB-DATE-2-SWITCH
 15676           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15677           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15678           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15679           COMPUTE WS-EPR-R78 (SUB3 2) =
 15680                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 15681           GO TO 4190-EP-DO-LF-COMM
 15682        ELSE
 15683        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 15684           (CR-MO EQUAL OB-MO (2))
 15685           MOVE '*'            TO OB-DATE-3-SWITCH
 15686           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 15687           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 15688           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 15689           COMPUTE WS-EPR-R78 (SUB3 3) =
 15690                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 15691           GO TO 4190-EP-DO-LF-COMM
 15692        ELSE
 15693           GO TO 4190-EP-DO-LF-COMM.
 15694
 15695     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 15696
 15697     IF DTE-R78 = '1'
 15698         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 15699     ELSE
 15700         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 15701
 15702     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 15703
 15704     IF REM-TRM1 GREATER THAN +0
 15705         COMPUTE TEMP-7 ROUNDED EQUAL
 15706             WE-LFPRM - (WE-LFPRM * TEMP-4)
 15707     ELSE
 15708         MOVE WE-LFPRM                TO TEMP-7.
 15709
 15710     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15711         MOVE ZEROS                  TO TEMP-8
 15712         GO TO 4165-END-LF-EP-R78.
 15713
 15714     IF EPR-ST = ZEROS
 15715         MOVE TEMP-7                 TO EPR-ST.
 15716
 15717     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 15718         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 15719         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 15720         IF DTE-R78 = '1'
 15721             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 15722
 15723     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 15724
 15725     COMPUTE TEMP-8 ROUNDED =
 15726               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 15727
 15728 4165-END-LF-EP-R78.
 15729
 15730     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010S.cbl
 15731         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 15732     ELSE
 15733         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 15734
 15735 4170-EP-DO-LF-EP-PRO.
 15736
 15737     IF DTE-CLIENT = 'MIC' OR 'MCC'
 15738         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 15739     ELSE
 15740         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 15741
 15742     IF REM-TRM1 GREATER THAN +0
 15743         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 15744     ELSE
 15745         MOVE WE-LFPRM                  TO TEMP-7.
 15746
 15747     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15748         MOVE ZEROS                     TO TEMP-8
 15749         GO TO 4175-END-LF-EP-PRO.
 15750
 15751     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 15752         IF DTE-CLIENT = 'MIC' OR 'MCC'
 15753             COMPUTE TEMP-5 ROUNDED =
 15754                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 15755         ELSE
 15756             COMPUTE TEMP-5 ROUNDED =
 15757                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 15758
 15759     COMPUTE TEMP-8 ROUNDED =
 15760                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 15761
 15762     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 15763
 15764 4175-END-LF-EP-PRO.
 15765
 15766     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 15767
 15768     GO TO 4185-EP-DO-LF-STATUTORY.
 15769
 15770 4180-EP-DO-LF-EP-SUM.
 15771
 15772     IF REM-TRM1 NOT GREATER +0
 15773         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 15774         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15775         GO TO 4190-EP-DO-LF-COMM.
 15776
 15777     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 15778
 15779     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 15780         MOVE ZEROS                 TO TEMP-7
 15781     ELSE
 15782         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 15783                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 15784
 15785     IF TEMP-7 NOT GREATER ZERO
 15786         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15787             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 15788             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010S.cbl
 15789         ELSE
 15790             MOVE ZEROS             TO TEMP-7.
 15791
 15792     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 15793     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 15794     IF DTE-R78 = '1'
 15795         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 15796
 15797     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 15798     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 15799
 15800     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 15801
 15802     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 15803
 15804     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 15805         GO TO 4185-EP-DO-LF-STATUTORY.
 15806
 15807     MOVE EPR-R78                  TO EPR-ST.
 15808
 15809     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 15810         MOVE ZEROS                 TO TEMP-8
 15811     ELSE
 15812         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 15813                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 15814
 15815     IF TEMP-8 NOT GREATER ZERO
 15816         GO TO 4185-EP-DO-LF-STATUTORY.
 15817
 15818     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 15819                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 15820
 15821     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 15822                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 15823
 15824     COMPUTE EPR-ST ROUNDED = EPR-ST +
 15825                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 15826
 15827 4185-EP-DO-LF-STATUTORY.
 15828
 15829     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 15830         MOVE EPR-R78                TO EPR-ST.
 15831     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 15832         MOVE EPR-PRO                TO EPR-ST.
 15833
 15834     IF EPR-ST NOT = ZEROS
 15835         GO TO 4190-EP-DO-LF-COMM.
 15836
 15837     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 15838         MOVE EPR-R78                TO EPR-ST
 15839     ELSE
 15840         MOVE EPR-PRO                TO EPR-ST.
 15841
 15842 4190-EP-DO-LF-COMM.
 15843
 15844     MOVE +0 TO SUB1.
 15845     PERFORM 4300-EP-COMM-LOOP THRU 4399-EP-COMM-LOOP-X
 15846         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010S.cbl
 15847
 15848     IF REIN-EP-FLG NOT = 'R'  OR
 15849        CR-POLICY-IS-REIN-ONLY
 15850         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 15851         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 15852         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 15853         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 15854
 15855     ADD ISS-BEN TO EW-ISS-BEN.
 15856     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 15857     ADD CNC-BEN TO EW-CNC-BEN.
 15858     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 15859     ADD ISS-PRM TO EW-ISS-PRM.
 15860     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 15861     ADD CNC-PRM TO EW-CNC-PRM.
 15862     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 15863
 15864     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 15865     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 15866     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 15867
 15868     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 15869        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 15870     END-IF
 15871     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 15872        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 15873     END-IF
 15874
 15875     COMPUTE ISS-PRMTAX =
 15876        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 15877        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 15878
 15879     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 15880
 15881     IF LIFE-FULLY-EARNED
 15882         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 15883                                            (ISS-PRM - EPR-R78)
 15884         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 15885                                            (ISS-PRM - EPR-PRO)
 15886         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 15887                                            (ISS-PRM - EPR-ST).
 15888
 15889     IF  DTE-OPT-RESERVE-METHOD-AUTH
 15890         IF  REIN-EP-FLG NOT = 'R'
 15891                 OR
 15892             CR-POLICY-IS-REIN-ONLY
 15893             MOVE 'L'      TO W-CLAIM-TYPE
 15894             MOVE EPR-R78  TO W-OPT-R78
 15895             MOVE EPR-PRO  TO W-OPT-PRO
 15896             MOVE EPR-ST   TO W-OPT-ST
 15897             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 15898             MOVE ZEROS    TO EW-CLM-IBNR
 15899         ELSE
 15900             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 15901                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 15902                 MOVE ZEROS      TO EW-CLM-IBNR
 15903             ELSE
 15904                 MOVE ZEROS      TO EW-CLM-IBNR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010S.cbl
 15905     ELSE
 15906         IF  DTE-CLIENT NOT EQUAL 'ITG'
 15907             ADD WE-DTH-IBNR
 15908                       TO EW-CLM-IBNR
 15909         ELSE
 15910             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15911                     AND
 15912                 CR-DT GREATER THAN LAST-YRS-DATE
 15913                 COMPUTE  EW-CLM-IBNR
 15914                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 15915
 15916     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 15917     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 15918
 15919 4191-CONTINUE.
 15920
 15921     MOVE 'Y'          TO EW-LEVEL-USED.
 15922
 15923     IF CR-POLICY-UNDERWRITTEN
 15924         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 15925         MOVE EPEC-OPT-WORK-TABLE
 15926                              TO EPEC-UNDW-OPT-DATA-TABLE
 15927     ELSE
 15928         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 15929         MOVE EPEC-OPT-WORK-TABLE
 15930                              TO EPEC-OPT-DATA-TABLE.
 15931
 15932     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010S.cbl
 15934 4194-SLOT-INTO-EFFECTED-MONTHS.
 15935
 15936     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 15937             AND
 15938         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 15939             AND
 15940         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 15941                 OR
 15942          CR-LF-CANC-DT EQUAL ZEROS)
 15943             AND
 15944         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 15945                 OR
 15946          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15947         MOVE 'Y'                 TO W-TABLE-USED-SW
 15948         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15949             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 15950                 = EPEC-LIFE-CTR (SUB3 SUBM)
 15951                 + CR-LIVES
 15952         ELSE
 15953             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 15954                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 15955
 15956 4194-EXIT.
 15957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010S.cbl
 15959******************************************************************
 15960***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 15961******************************************************************
 15962
 15963 4200-EP-DO-AH.
 15964
 15965     MOVE +0                         TO ISS-BEN  EPR-R78
 15966                                        CNC-BEN  EPR-PRO
 15967                                        ISS-PRM  EPR-ST
 15968                                        CNC-PRM
 15969                                        WX-CLM-AMT
 15970                                        WX-CLM-EXP
 15971                                        WX-CLM-CNT
 15972                                        WX-CLM-CRT
 15973                                        WX-ACTIVE-COUNT
 15974                                        ISS-PRMTAX
 15975                                        WX-CNC-CNT.
 15976     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 15977
 15978     IF CR-AHTYP = ZERO
 15979         GO TO 4295-EP-DO-COUNT.
 15980
 15981     IF REIN-EP-FLG = 'R'
 15982         IF REIN-AH-FLG (SUB5) = SPACE
 15983             GO TO 4295-EP-DO-COUNT.
 15984
 15985     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 15986     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 15987     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15988
 15989     IF CR-POLICY-IS-DECLINED  OR
 15990        CR-POLICY-IS-VOID
 15991         GO TO 4290-CONTINUE.
 15992
 15993     MOVE CR-AH-TERM           TO ORIG-TERM.
 15994
 15995     IF CR-DT GREATER EW-COV-DTE
 15996         MOVE CR-DT            TO EW-COV-DTE.
 15997
 15998     IF NOT CR-POLICY-IS-RESTORE  AND
 15999        NOT CR-POLICY-IS-REISSUE
 16000        AND NOT CR-POLICY-IS-MONTHLY
 16001         MOVE WE-AHAMT         TO ISS-BEN
 16002         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16003         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16004         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16005         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16006                                   (ORIG-TERM * ISS-BEN).
 16007
 16008     MOVE CLAS-INDEXA     TO W-NDX.
 16009     MOVE RUN-DATE        TO VALUATION-DT
 16010     MOVE '6'             TO W-VAL-SOURCE.
 16011
 16012     IF REIN-EP-FLG = 'R'
 16013         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 16014            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16015             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16016             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010S.cbl
 16017
 16018     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16019
 16020     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 16021        (REM-TRM3 GREATER ZERO)
 16022        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16023            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16024                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16025            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16026                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16027          ELSE
 16028            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16029            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16030
 16031     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16032         GO TO 4210-BY-OPT-LOGIC.
 16033
 16034     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16035             AND
 16036         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16037             AND
 16038         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 16039                 OR
 16040          CR-AH-CANC-DT EQUAL ZEROS)
 16041         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 16042         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 16043                 VARYING
 16044             SUBM FROM +1 BY +1
 16045                 UNTIL
 16046             SUBM GREATER THAN +13.
 16047
 16048     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16049     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16050
 16051 4210-BY-OPT-LOGIC.
 16052
 16053     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16054         ADD CR-LIVES TO EW-ISS-CNT
 16055         MOVE WE-AHPRM TO ISS-PRM
 16056         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16057                                (ORIG-TERM * CR-LIVES)
 16058         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16059         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16060         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16061                                   (ORIG-TERM * ISS-BEN)
 16062         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 16063         GO TO 4225-CONTINUE.
 16064
 16065     IF (NOT CR-POLICY-IS-RESTORE) AND
 16066        (NOT CR-POLICY-IS-REISSUE)
 16067        AND (NOT CR-POLICY-IS-MONTHLY)
 16068        ADD +1 TO EW-ISS-CNT.
 16069
 16070     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 16071
 16072 4225-CONTINUE.
 16073
 16074     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010S.cbl
 16075         NEXT  SENTENCE
 16076       ELSE
 16077         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16078
 16079     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 16080     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 16081     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 16082     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 16083     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 16084     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 16085
 16086     MOVE +0           TO SUB1.
 16087     PERFORM 4300-EP-COMM-LOOP THRU 4399-EP-COMM-LOOP-X
 16088         10 TIMES.
 16089
 16090     IF REIN-EP-FLG NOT = 'R'  OR
 16091        CR-POLICY-IS-REIN-ONLY
 16092         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 16093         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 16094         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 16095         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 16096
 16097     ADD ISS-BEN TO EW-ISS-BEN.
 16098     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 16099     ADD CNC-BEN TO EW-CNC-BEN.
 16100     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 16101     ADD ISS-PRM TO EW-ISS-PRM.
 16102     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 16103     ADD CNC-PRM TO EW-CNC-PRM.
 16104     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 16105
 16106     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16107     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16108     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16109
 16110     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 16111        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 16112     END-IF
 16113     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 16114        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 16115     END-IF
 16116     COMPUTE ISS-PRMTAX =
 16117        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 16118        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 16119     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16120
 16121     IF A-H-FULLY-EARNED
 16122         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16123                                            (ISS-PRM - EPR-R78)
 16124         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16125                                            (ISS-PRM - EPR-PRO)
 16126         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16127                                            (ISS-PRM - EPR-ST).
 16128
 16129     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16130         IF  REIN-EP-FLG NOT = 'R'
 16131                 OR
 16132             CR-POLICY-IS-REIN-ONLY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010S.cbl
 16133             MOVE 'A'      TO W-CLAIM-TYPE
 16134             MOVE EPR-R78  TO W-OPT-R78
 16135             MOVE EPR-PRO  TO W-OPT-PRO
 16136             MOVE EPR-ST   TO W-OPT-ST
 16137             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16138             MOVE ZEROS    TO EW-CLM-IBNR
 16139         ELSE
 16140             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 16141                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 16142                 MOVE ZEROS TO EW-CLM-IBNR
 16143             ELSE
 16144                 MOVE ZEROS TO EW-CLM-IBNR
 16145     ELSE
 16146         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16147             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 16148         ELSE
 16149             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 16150                 IF  CR-AH-POLICY-IS-ACTIVE
 16151                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 16152                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 16153                 ELSE
 16154                     NEXT SENTENCE
 16155             ELSE
 16156                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 16157                     COMPUTE  EW-CLM-IBNR
 16158                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 16159
 16160     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 16161     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 16162
 16163 4290-CONTINUE.
 16164
 16165     MOVE 'Y'          TO EW-LEVEL-USED.
 16166
 16167     IF CR-POLICY-UNDERWRITTEN
 16168         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16169         MOVE EPEC-OPT-WORK-TABLE
 16170                              TO EPEC-UNDW-OPT-DATA-TABLE
 16171     ELSE
 16172         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16173         MOVE EPEC-OPT-WORK-TABLE
 16174                              TO EPEC-OPT-DATA-TABLE.
 16175
 16176
 16177 4295-EP-DO-COUNT.
 16178
 16179     IF REIN-EP-FLG = 'R'
 16180         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 16181     ELSE
 16182         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 16183
 16184     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010S.cbl
 16186 4296-SLOT-INTO-EFFECTED-MONTHS.
 16187
 16188     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16189             AND
 16190         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16191             AND
 16192         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16193                 OR
 16194          CR-AH-CANC-DT EQUAL ZEROS)
 16195         MOVE 'Y'                 TO W-TABLE-USED-SW
 16196         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16197             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16198                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16199                 + CR-LIVES
 16200         ELSE
 16201             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16202                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16203
 16204 4296-EXIT.
 16205     EXIT.
 16206
 16207 4299-EPBX.
 16208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010S.cbl
 16210******************************************************************
 16211***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 16212******************************************************************
 16213
 16214 4300-EP-COMM-LOOP.
 16215     IF DTE-CLIENT = 'DMD'
 16216         GO TO 4399-EP-COMM-LOOP-X.
 16217
 16218     ADD +1                         TO SUB1.
 16219     MOVE ZEROS                     TO SUB16.
 16220
 16221     IF CR-ADDL-CLP NOT NUMERIC
 16222        MOVE ZEROS               TO CR-ADDL-CLP
 16223     END-IF
 16224     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 16225         GO TO 4399-EP-COMM-LOOP-X.
 16226
 16227 4300-AGENT-LOOP.
 16228
 16229     ADD +1                         TO SUB16.
 16230
 16231     IF SUB16 GREATER THAN WS-LOOP-MAX
 16232         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16233         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 16234         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16235                                     TO WS-ABEND-MESSAGE
 16236         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16237         MOVE 4001                   TO WS-ABEND-CODE
 16238         GO TO ABEND-PGM.
 16239
 16240     IF EW-AGT-NO (SUB16) = SPACES
 16241         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 16242         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 16243     ELSE
 16244         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 16245            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 16246             NEXT SENTENCE
 16247         ELSE
 16248             GO TO 4300-AGENT-LOOP.
 16249
 16250     IF EW-LF-AH = AH-OVERRIDE-L1
 16251         GO TO 4350-EP-COMM-LOOP-A.
 16252
 16253     IF (DTE-CLIENT = 'DCC')
 16254        AND (REIN-EP-FLG = 'R')
 16255        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16256        AND (WE-LFPRM NOT = ZEROS)
 16257        COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 16258            (CR-LFAMT + CR-LFAMT-ALT)
 16259*       COMPUTE ISS-WK ROUNDED = ((WE-LFPRM + WE-LFPRM-ALT)
 16260        COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 16261           * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 16262     ELSE
 16263        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 16264           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 16265        ELSE
 16266           COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-L (SUB1)
 16267        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010S.cbl
 16268     END-IF
 16269
 16270     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 16271
 16272     MOVE ZEROS                  TO CNC-WK
 16273                                    CNC-FACT
 16274     IF DTE-CLIENT EQUAL 'XXX'
 16275         IF NOT CR-NO-LF-CHARGEBACK
 16276            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16277            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 16278                                + CNC-WK
 16279            GO TO 4300-CONTINUE-LOOP.
 16280
 16281
 16282     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16283        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16284        IF (CR-AGT-TYPE (SUB1) = 'K')
 16285           AND (CNC-PRM > +0)
 16286           COMPUTE CNC-WK = CR-LCOM-L (SUB1) * +1000
 16287        ELSE
 16288           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L')
 16289              AND (CNC-PRM > +0)
 16290              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16291              COMPUTE CNC-WK = CNC-FACT *
 16292                 (CR-LCOM-L (SUB1) * +1000)
 16293           ELSE
 16294             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 16295                AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 16296                COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16297                COMPUTE CNC-WK = CNC-FACT *
 16298                   (CR-AHPRM - (CR-LFPRM-ALT
 16299                   + CR-ADDL-CLP))
 16300             ELSE
 16301                COMPUTE CNC-WK  ROUNDED =
 16302                   CNC-PRM * CR-LCOM-L (SUB1)
 16303             END-IF
 16304           END-IF
 16305        END-IF
 16306        COMPUTE EW-CNC-COM (SUB16) =
 16307                                  EW-CNC-COM (SUB16) + CNC-WK
 16308     END-IF
 16309     .
 16310 4300-CONTINUE-LOOP.
 16311
 16312     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16313               OR
 16314        ((ISS-WK - CNC-WK) = ZEROS)
 16315        MOVE ZEROS              TO COMM-WK
 16316     ELSE
 16317        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16318        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16319     END-IF
 16320
 16321     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16322
 16323     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16324               OR
 16325        ((ISS-WK - CNC-WK) = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010S.cbl
 16326        MOVE ZEROS              TO COMM-WK
 16327     ELSE
 16328        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16329        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16330     END-IF
 16331     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16332
 16333     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16334               OR
 16335        ((ISS-WK - CNC-WK) = ZEROS)
 16336        MOVE ZEROS              TO COMM-WK
 16337     ELSE
 16338        COMPUTE COMM-WK ROUNDED = EPR-ST /
 16339        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16340     END-IF
 16341
 16342     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16343
 16344     IF LIFE-FULLY-EARNED
 16345         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16346                                                CR-LCOM-L (SUB1)
 16347         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16348                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16349         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16350                                                CR-LCOM-L (SUB1)
 16351         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16352                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16353
 16354     GO TO 4399-EP-COMM-LOOP-X.
 16355
 16356 4350-EP-COMM-LOOP-A.
 16357
 16358     IF (DTE-CLIENT = 'DCC')
 16359        AND (REIN-EP-FLG = 'R')
 16360        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16361        AND (WE-AHPRM NOT = ZEROS)
 16362        COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16363        COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 16364*       COMPUTE ISS-WK ROUNDED = (WE-AHPRM * WS-CEDE-FACT)
 16365           * CR-LCOM-AH (SUB1)
 16366     ELSE
 16367        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 16368           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 16369        ELSE
 16370           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 16371              AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G'
 16372              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 16373              + CR-ADDL-CLP)
 16374           ELSE
 16375              COMPUTE ISS-WK  ROUNDED =
 16376                    ISS-PRM * CR-LCOM-AH (SUB1)
 16377           END-IF
 16378        END-IF
 16379     END-IF
 16380
 16381     COMPUTE EW-ISS-COM (SUB16) =
 16382             EW-ISS-COM (SUB16) + ISS-WK.
 16383
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010S.cbl
 16384     MOVE ZEROS                  TO CNC-WK
 16385     IF DTE-CLIENT EQUAL 'XXX'
 16386         IF NOT CR-NO-LF-CHARGEBACK
 16387           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 16388           COMPUTE EW-CNC-COM (SUB16) =
 16389                   EW-CNC-COM (SUB16) + CNC-WK
 16390           GO TO 4300-CONTINUE-LOOP-AH.
 16391
 16392
 16393     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16394        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16395        IF (CR-AGT-TYPE (SUB1) = 'K')
 16396           AND (CNC-PRM > +0)
 16397           COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 16398        ELSE
 16399           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L')
 16400              AND (CNC-PRM > +0)
 16401              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16402              COMPUTE CNC-WK = CNC-FACT *
 16403                 (CR-LCOM-AH (SUB1) * +1000)
 16404           ELSE
 16405              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G'
 16406                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 16407                 COMPUTE CNC-WK = CNC-FACT *
 16408                    (CR-AHPRM - (CR-LFPRM-ALT
 16409                    + CR-ADDL-CLP))
 16410              ELSE
 16411                 COMPUTE CNC-WK  ROUNDED =
 16412                    CNC-PRM * CR-LCOM-AH (SUB1)
 16413              END-IF
 16414           END-IF
 16415        END-IF
 16416        COMPUTE EW-CNC-COM (SUB16) =
 16417                   EW-CNC-COM (SUB16) + CNC-WK
 16418     END-IF
 16419
 16420     .
 16421 4300-CONTINUE-LOOP-AH.
 16422
 16423     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16424                OR
 16425        ((ISS-WK - CNC-WK) = ZEROS)
 16426        MOVE ZEROS          TO COMM-WK
 16427     ELSE
 16428        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16429        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16430     END-IF
 16431
 16432     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16433
 16434     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16435                OR
 16436        ((ISS-WK - CNC-WK) = ZEROS)
 16437        MOVE ZEROS          TO COMM-WK
 16438     ELSE
 16439        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16440        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16441     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010S.cbl
 16442
 16443     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16444
 16445     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16446                OR
 16447        ((ISS-WK - CNC-WK) = ZEROS)
 16448        MOVE ZEROS          TO COMM-WK
 16449     ELSE
 16450        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 16451        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16452     END-IF
 16453
 16454     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16455
 16456     IF A-H-FULLY-EARNED
 16457         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16458                                                CR-LCOM-AH (SUB1)
 16459         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16460                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16461         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16462                                                CR-LCOM-AH (SUB1)
 16463         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16464                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16465
 16466 4399-EP-COMM-LOOP-X.
 16467     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010S.cbl
 16469******************************************************************
 16470******************************************************************
 16471******************************************************************
 16472******************************************************************
 16473******************************************************************
 16474******************************************************************
 16475******************************************************************
 16476******************************************************************
 16477******************************************************************
 16478******************************************************************
 16479***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 16480******************************************************************
 16481
 16482 S-4100-EP-DO-LF.
 16483
 16484     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 16485                                        EPR-PRO
 16486                                        EPR-ST.
 16487
 16488     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 16489     MOVE 'L'                    TO DC-OPTION-CODE.
 16490     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16491
 16492     MOVE +0                     TO DC-ELAPSED-MONTHS.
 16493     MOVE -1                     TO DC-ELAPSED-DAYS.
 16494     MOVE '6'                    TO DC-OPTION-CODE.
 16495     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16496
 16497     MOVE +0                     TO DC-ELAPSED-MONTHS
 16498                                    DC-ELAPSED-DAYS.
 16499
 16500     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 16501     MOVE ' '                    TO DC-OPTION-CODE.
 16502     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 16503
 16504     IF NO-CONVERSION-ERROR
 16505        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 16506     ELSE
 16507         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 16508                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 16509                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 16510         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 16511                                     TO WS-ABEND-MESSAGE
 16512         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16513         MOVE 4001                   TO WS-ABEND-CODE
 16514         GO TO ABEND-PGM.
 16515
 16516     IF CR-LFTYP = ZERO
 16517         GO TO S-4200-EP-DO-AH.
 16518
 16519     IF REIN-LF-FLG (SUB5) = SPACE
 16520         GO TO S-4200-EP-DO-AH.
 16521
 16522     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 16523     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 16524     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16525
 16526     MOVE CR-LF-TERM             TO ORIG-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010S.cbl
 16527     MOVE CLAS-INDEXL            TO W-NDX.
 16528
 16529 S-4120-EP-DO-LF-CNCL.
 16530
 16531     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 16532        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 16533         GO TO S-4130-EP-DO-LF-EP.
 16534
 16535     COMPUTE EARNED-BY-CANCEL =
 16536                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 16537
 16538 S-4130-EP-DO-LF-EP.
 16539
 16540     MOVE SPACE                  TO STATUTORY-SWITCH.
 16541
 16542     MOVE EARNING-START-DATE     TO VALUATION-DT.
 16543     MOVE '9'                    TO W-VAL-SOURCE.
 16544     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16545
 16546     IF REM-TRM2 GREATER CR-LF-TERM
 16547         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16548         GO TO S-4190-EP-DO-LF-COMM.
 16549
 16550     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16551         GO TO S-4180-EP-DO-LF-EP-SUM.
 16552
 16553     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16554         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16555             IF REM-TRM2 NOT GREATER THAN +0
 16556                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16557                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16558                 GO TO S-4190-EP-DO-LF-COMM
 16559             ELSE
 16560                 NEXT SENTENCE
 16561         ELSE
 16562             IF W-BAL-REMTRM NOT GREATER +0
 16563                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16564                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16565                 GO TO S-4190-EP-DO-LF-COMM
 16566             ELSE
 16567                 NEXT SENTENCE
 16568     ELSE
 16569        IF (DTE-CLIENT EQUAL 'NCL') AND
 16570           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 16571             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16572        ELSE
 16573         IF REM-TRM2 NOT GREATER +0  OR
 16574            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16575             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16576             GO TO S-4190-EP-DO-LF-COMM.
 16577
 16578     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16579         GO TO S-4140-EP-DO-LF-EP-TEX.
 16580
 16581     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16582         GO TO S-4150-EP-DO-LF-EP-NP.
 16583
 16584*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010S.cbl
 16585     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 16586        (CR-RATING-CLASS NOT = 'L ')
 16587         IF (CR-APR GREATER THAN ZERO)  AND
 16588            (CR-LF-TERM GREATER THAN 060)  AND
 16589            (CR-DT GREATER THAN 19831031)
 16590             MOVE '*'             TO STATUTORY-SWITCH
 16591              GO TO S-4150-EP-DO-LF-EP-NP.
 16592
 16593     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16594         IF (CR-APR GREATER THAN ZERO)  AND
 16595            (CR-LF-TERM GREATER THAN 061)  AND
 16596            (CR-DT GREATER THAN 19830318)
 16597             MOVE '*'             TO STATUTORY-SWITCH
 16598              GO TO S-4150-EP-DO-LF-EP-NP.
 16599
 16600     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16601         IF (CR-APR GREATER THAN ZERO)  AND
 16602            (CR-LF-TERM GREATER THAN 062)  AND
 16603            (CR-DT GREATER THAN 19810831)  AND
 16604            (CR-DT LESS THAN 19830901)
 16605             MOVE '*'             TO STATUTORY-SWITCH
 16606              GO TO S-4150-EP-DO-LF-EP-NP.
 16607
 16608     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16609         IF (CR-APR GREATER THAN ZERO)  AND
 16610            (CR-LF-TERM GREATER THAN 060)  AND
 16611            (CR-DT GREATER THAN 19831231)
 16612             MOVE '*'             TO STATUTORY-SWITCH
 16613              GO TO S-4150-EP-DO-LF-EP-NP.
 16614
 16615     GO TO S-4160-EP-DO-LF-EP-R78.
 16616
 16617 S-4140-EP-DO-LF-EP-TEX.
 16618
 16619     COMPUTE TEX-FACT-4 =
 16620         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16621     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16622         GIVING TEX-FACT-5
 16623             REMAINDER TEX-FACT-6.
 16624     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16625     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16626         (TEX-FACT-5 * CR-PMT-FREQ) +
 16627         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16628     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16629
 16630     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16631
 16632     GO TO S-4170-EP-DO-LF-EP-PRO.
 16633
 16634 S-4150-EP-DO-LF-EP-NP.
 16635
 16636     IF WE-LFPRM = ZERO
 16637         GO TO S-4160-EP-DO-LF-EP-R78.
 16638
 16639     IF DTE-CLIENT = 'CRI'
 16640       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16641             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16642           GO TO S-4160-EP-DO-LF-EP-R78.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010S.cbl
 16643
 16644     IF DTE-CLIENT = 'NCL'
 16645       IF CR-DT LESS THAN 19910101
 16646           GO TO S-4160-EP-DO-LF-EP-R78.
 16647
 16648     IF REM-TRM1 = CR-LF-TERM
 16649         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16650         GO TO S-4190-EP-DO-LF-COMM.
 16651
 16652     MOVE CR-APR TO NP-APR.
 16653     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16654     MOVE REM-TRM1 TO NP-REM.
 16655     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16656     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16657         MOVE CR-LOAN-TERM TO NP-ORIG.
 16658     MOVE 'R' TO NP-OPT.
 16659     CALL 'ECSNETRM'
 16660         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16661
 16662     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16663
 16664     IF STATUTORY-REQUIREMENT
 16665         MOVE EPR-R78                TO EPR-ST.
 16666
 16667 S-4160-EP-DO-LF-EP-R78.
 16668
 16669     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16670        (DTE-CLIENT EQUAL 'NCL')
 16671        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16672           (CR-MO EQUAL EOM-MO)
 16673           MOVE '*'            TO OB-DATE-1-SWITCH
 16674           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16675           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16676           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16677           COMPUTE WS-EPR-R78 (SUB3 1) =
 16678                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 16679           GO TO S-4190-EP-DO-LF-COMM
 16680        ELSE
 16681        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16682           (CR-MO EQUAL OB-MO (1))
 16683           MOVE '*'            TO OB-DATE-2-SWITCH
 16684           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16685           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16686           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16687           COMPUTE WS-EPR-R78 (SUB3 2) =
 16688                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 16689           GO TO S-4190-EP-DO-LF-COMM
 16690        ELSE
 16691        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16692           (CR-MO EQUAL OB-MO (2))
 16693           MOVE '*'            TO OB-DATE-3-SWITCH
 16694           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16695           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16696           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16697           COMPUTE WS-EPR-R78 (SUB3 3) =
 16698                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 16699           GO TO S-4190-EP-DO-LF-COMM
 16700        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010S.cbl
 16701           GO TO S-4190-EP-DO-LF-COMM.
 16702
 16703     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16704
 16705     IF DTE-R78 = '1'
 16706         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16707     ELSE
 16708         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16709
 16710     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16711
 16712     IF REM-TRM1 GREATER THAN +0
 16713         COMPUTE TEMP-7 ROUNDED EQUAL
 16714             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16715     ELSE
 16716         MOVE WE-LFPRM                TO TEMP-7.
 16717
 16718     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16719         MOVE ZEROS                  TO TEMP-8
 16720         GO TO S-4165-END-LF-EP-R78.
 16721
 16722     IF EPR-ST NOT = ZEROS
 16723         MOVE TEMP-7                 TO EPR-ST.
 16724
 16725     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16726         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16727         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16728         IF DTE-R78 = '1'
 16729             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16730
 16731     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16732
 16733     COMPUTE TEMP-8 ROUNDED =
 16734               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16735
 16736 S-4165-END-LF-EP-R78.
 16737
 16738     IF EPR-R78 = ZEROS
 16739         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16740     ELSE
 16741         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16742
 16743 S-4170-EP-DO-LF-EP-PRO.
 16744
 16745     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16746         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16747     ELSE
 16748         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16749
 16750     IF REM-TRM1 GREATER THAN +0
 16751         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16752     ELSE
 16753         MOVE WE-LFPRM                  TO TEMP-7.
 16754
 16755     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16756         MOVE ZEROS                     TO TEMP-8
 16757         GO TO S-4175-END-LF-EP-PRO.
 16758
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010S.cbl
 16759     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16760         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16761             COMPUTE TEMP-5 ROUNDED =
 16762                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16763         ELSE
 16764             COMPUTE TEMP-5 ROUNDED =
 16765                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16766
 16767     COMPUTE TEMP-8 ROUNDED =
 16768                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16769
 16770     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16771
 16772 S-4175-END-LF-EP-PRO.
 16773
 16774     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16775
 16776     GO TO S-4185-EP-DO-LF-STATUTORY.
 16777
 16778 S-4180-EP-DO-LF-EP-SUM.
 16779
 16780     IF REM-TRM1 NOT GREATER +0
 16781         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16782         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16783         GO TO S-4190-EP-DO-LF-COMM.
 16784
 16785     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16786         MOVE ZEROS                 TO TEMP-7
 16787     ELSE
 16788         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16789                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16790
 16791     IF TEMP-7 NOT GREATER ZERO
 16792         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16793             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16794             GO TO S-4190-EP-DO-LF-COMM
 16795         ELSE
 16796             MOVE ZEROS             TO TEMP-7.
 16797
 16798     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16799     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16800     IF DTE-R78 = '1'
 16801         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16802
 16803     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16804     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16805
 16806     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16807
 16808     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16809
 16810     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16811         GO TO S-4185-EP-DO-LF-STATUTORY.
 16812
 16813     MOVE EPR-R78                  TO EPR-ST.
 16814
 16815     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16816         MOVE ZEROS                 TO TEMP-8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010S.cbl
 16817     ELSE
 16818         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16819                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16820
 16821     IF TEMP-8 NOT GREATER ZERO
 16822         GO TO S-4185-EP-DO-LF-STATUTORY.
 16823
 16824     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16825                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16826
 16827     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16828                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16829
 16830     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16831                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16832
 16833 S-4185-EP-DO-LF-STATUTORY.
 16834
 16835     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16836         MOVE EPR-R78                TO EPR-ST.
 16837
 16838     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16839         MOVE EPR-PRO                TO EPR-ST.
 16840
 16841     IF EPR-ST NOT = ZEROS
 16842         GO TO S-4190-EP-DO-LF-COMM.
 16843
 16844     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16845         MOVE EPR-R78                TO EPR-ST
 16846     ELSE
 16847         MOVE EPR-PRO                TO EPR-ST.
 16848
 16849 S-4190-EP-DO-LF-COMM.
 16850
 16851     IF EARNED-BY-CANCEL = ZEROS
 16852         GO TO S-4195-LF-COMM-CONTINUE.
 16853
 16854     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 16855         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 16856
 16857     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 16858         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 16859
 16860     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 16861         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 16862
 16863 S-4195-LF-COMM-CONTINUE.
 16864
 16865     MOVE +0 TO SUB1.
 16866     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 16867         10 TIMES.
 16868
 16869     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 16870     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 16871     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 16872
 16873     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 16874     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010S.cbl
 16875     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 16876
 16877     MOVE 'Y'          TO EW-LEVEL-USED.
 16878
 16879     IF CR-POLICY-UNDERWRITTEN
 16880         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16881
 16882     ELSE
 16883         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 16884
 16885     GO TO S-4200-EP-DO-AH.
 16886
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010S.cbl
 16888******************************************************************
 16889***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 16890******************************************************************
 16891
 16892 S-4200-EP-DO-AH.
 16893
 16894     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 16895                                        EPR-PRO
 16896                                        EPR-ST.
 16897
 16898     IF CR-AHTYP = ZERO
 16899         GO TO S-4299-EPBX.
 16900
 16901     IF REIN-AH-FLG (SUB5) = SPACE
 16902         GO TO S-4299-EPBX.
 16903
 16904     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16905     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16906     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16907
 16908     MOVE CR-AH-TERM           TO ORIG-TERM.
 16909     MOVE CLAS-INDEXA          TO W-NDX.
 16910
 16911     MOVE EARNING-START-DATE     TO VALUATION-DT.
 16912     MOVE '9'                    TO W-VAL-SOURCE.
 16913     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16914
 16915 S-4220-EP-DO-AH-CNCL.
 16916
 16917     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 16918         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 16919
 16920 S-4230-EP-DO-AH-EP.
 16921
 16922     IF REM-TRM2 GREATER CR-AH-TERM
 16923         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16924         GO TO S-4290-EP-DO-AH-COMM.
 16925
 16926     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16927         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 16928
 16929 S-4235-CHECK-OB-AH-NCL.
 16930
 16931     IF (DTE-CLIENT EQUAL 'NCL') AND
 16932        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 16933           MOVE WE-AHPRM         TO EPR-R78
 16934                                    EPR-PRO
 16935                                    EPR-ST
 16936        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16937           (CR-MO EQUAL EOM-MO)
 16938           MOVE '*'            TO OB-DATE-1-SWITCH
 16939           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16940           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16941           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16942           COMPUTE WS-EPR-R78 (SUB3 1) =
 16943                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 16944            GO TO S-4290-EP-DO-AH-COMM
 16945        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010S.cbl
 16946        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16947           (CR-MO EQUAL OB-MO (1))
 16948           MOVE '*'            TO OB-DATE-2-SWITCH
 16949           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16950           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16951           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16952           COMPUTE WS-EPR-R78 (SUB3 2) =
 16953                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 16954            GO TO S-4290-EP-DO-AH-COMM
 16955        ELSE
 16956        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16957           (CR-MO EQUAL OB-MO (2))
 16958           MOVE '*'            TO OB-DATE-3-SWITCH
 16959           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16960           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16961           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16962           COMPUTE WS-EPR-R78 (SUB3 3) =
 16963                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 16964            GO TO S-4290-EP-DO-AH-COMM
 16965        ELSE
 16966            GO TO S-4290-EP-DO-AH-COMM.
 16967
 16968     IF REM-TRM2 NOT GREATER +0
 16969         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 16970         GO TO S-4290-EP-DO-AH-COMM.
 16971
 16972     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 16973         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 16974         GO TO S-4290-EP-DO-AH-COMM.
 16975
 16976     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 16977     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16978     IF DTE-R78 = '1'
 16979         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16980     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16981
 16982     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16983         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 16984     ELSE
 16985         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 16986
 16987     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 16988     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 16989
 16990     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 16991     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 16992
 16993     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 16994
 16995*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 16996*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 16997
 16998     MOVE SPACES TO STATUTORY-SWITCH-AH.
 16999
 17000     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 17001        (CR-DT GREATER THAN  19921231)
 17002         IF CR-AH-TERM GREATER THAN  +61
 17003             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010S.cbl
 17004             MOVE '*' TO STATUTORY-SWITCH-AH
 17005             GO TO S-4245-EP-DO-AH-EP-AN
 17006         ELSE
 17007             GO TO S-4250-EP-DO-AH-STATUTORY.
 17008
 17009     IF AH-EARN-METHOD EQUAL 'N'
 17010         GO TO S-4240-EP-DO-AH-EP-NP.
 17011
 17012     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 17013         MOVE 'A' TO AH-EARN-METHOD
 17014         GO TO S-4245-EP-DO-AH-EP-AN.
 17015
 17016     GO TO S-4250-EP-DO-AH-STATUTORY.
 17017
 17018 S-4240-EP-DO-AH-EP-NP.
 17019
 17020     IF WE-AHPRM = ZERO
 17021         GO TO S-4250-EP-DO-AH-STATUTORY.
 17022
 17023     IF CR-APR GREATER THAN +0
 17024         NEXT SENTENCE
 17025     ELSE
 17026         GO TO S-4250-EP-DO-AH-STATUTORY.
 17027
 17028     IF DTE-CLIENT = 'NCL'
 17029       IF CR-DT LESS THAN 19910101
 17030           GO TO S-4250-EP-DO-AH-STATUTORY.
 17031
 17032     IF REM-TRM1 = CR-AH-TERM
 17033         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17034         GO TO S-4290-EP-DO-AH-COMM.
 17035
 17036     MOVE CR-APR TO NP-APR.
 17037     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 17038     MOVE REM-TRM1 TO NP-REM.
 17039     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 17040     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17041         MOVE CR-LOAN-TERM TO NP-ORIG.
 17042     MOVE 'R' TO NP-OPT.
 17043     CALL 'ECSNETRM'
 17044         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17045
 17046     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 17047
 17048     GO TO S-4250-EP-DO-AH-STATUTORY.
 17049
 17050 S-4245-EP-DO-AH-EP-AN.
 17051     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17052     MOVE 'L'                        TO DC-OPTION-CODE.
 17053     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17054     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17055     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 17056     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17057     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17058     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17059     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17060     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17061     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010S.cbl
 17062     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 17063                                        CP-RATING-BENEFIT-AMT.
 17064     IF CP-STATE-STD-ABBRV = 'OR'
 17065         COMPUTE CP-RATING-BENEFIT-AMT =
 17066                                  CR-AHAMT * REM-TRM1.
 17067     MOVE CR-APR                     TO CP-LOAN-APR.
 17068     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17069     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 17070     MOVE '3'                        TO CP-PROCESS-TYPE.
 17071     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 17072     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 17073
 17074     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17075         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17076     ELSE
 17077         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17078
 17079     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 17080     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 17081     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17082     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17083     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 17084     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 17085
 17086     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 17087
 17088     IF CP-ERROR-RATE-NOT-FOUND  OR
 17089        CP-ERROR-RATE-IS-ZERO  OR
 17090        CP-ERROR-IN-DATES
 17091         GO TO S-4250-EP-DO-AH-STATUTORY.
 17092
 17093     COMPUTE EPR-R78 ROUNDED =
 17094             ((REM-TRM1 * WE-AHAMT) / +100) *
 17095               CP-PREMIUM-RATE.
 17096
 17097     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17098
 17099     IF STATUTORY-REQUIREMENT-AH
 17100         MOVE EPR-R78                TO EPR-ST
 17101         GO TO S-4290-EP-DO-AH-COMM.
 17102
 17103 S-4250-EP-DO-AH-STATUTORY.
 17104     MOVE EPR-R78                    TO EPR-ST.
 17105
 17106     MOVE +0                         TO SUB1.
 17107
 17108 S-4255-EP-AH-STAT-LOOP.
 17109     ADD +1 TO SUB1.
 17110
 17111     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 17112         MOVE EPR-PRO                TO EPR-ST
 17113     ELSE
 17114         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 17115             GO TO S-4255-EP-AH-STAT-LOOP.
 17116
 17117     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 17118         CR-DT GREATER THAN 19831031)
 17119                    OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010S.cbl
 17120        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 17121         CR-DT GREATER THAN 19820629)
 17122                    OR
 17123        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 17124         CR-DT GREATER THAN 19830831)
 17125             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17126
 17127     IF DTE-CLIENT = 'CSO'  OR  'CID'
 17128       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 17129         IF CR-DT LESS THAN 19970101
 17130             MOVE EPR-R78            TO EPR-ST
 17131         ELSE
 17132             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17133
 17134 S-4290-EP-DO-AH-COMM.
 17135
 17136     IF EARNED-BY-CANCEL = ZEROS
 17137         GO TO S-4295-AH-COMM-CONTINUE.
 17138
 17139     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17140         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17141
 17142     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17143         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17144
 17145     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17146         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17147
 17148 S-4295-AH-COMM-CONTINUE.
 17149
 17150     MOVE +0           TO SUB1.
 17151     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17152         10 TIMES.
 17153
 17154     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17155     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17156     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17157
 17158     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17159     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17160     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17161
 17162     MOVE 'Y'          TO EW-LEVEL-USED.
 17163
 17164     IF CR-POLICY-UNDERWRITTEN
 17165         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17166     ELSE
 17167         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17168
 17169
 17170 S-4299-EPBX.
 17171     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010S.cbl
 17173******************************************************************
 17174***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 17175******************************************************************
 17176
 17177 S-4300-EP-COMM-LOOP.
 17178
 17179     ADD +1 TO SUB1.
 17180     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17181         GO TO S-4399-EP-COMM-LOOP-X.
 17182
 17183     IF EW-LF-AH = AH-OVERRIDE-L1
 17184         GO TO S-4350-EP-COMM-LOOP-A.
 17185
 17186*    IF CR-AGT-TYPE (SUB1) = 'K'
 17187*       COMPUTE COMM-WK =
 17188     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 17189     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17190     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17191                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17192
 17193     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 17194     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17195     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17196                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17197
 17198     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 17199     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17200
 17201     GO TO S-4399-EP-COMM-LOOP-X.
 17202
 17203 S-4350-EP-COMM-LOOP-A.
 17204
 17205     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 17206     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17207     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17208                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17209
 17210     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 17211     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17212     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17213                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17214
 17215     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 17216     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17217
 17218 S-4399-EP-COMM-LOOP-X.
 17219     EXIT.
 17220
 17221******************************************************************
 17222******************************************************************
 17223******************************************************************
 17224******************************************************************
 17225******************************************************************
 17226******************************************************************
 17227******************************************************************
 17228******************************************************************
 17229******************************************************************
 17230******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010S.cbl
 17232******************************************************************
 17233***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 17234******************************************************************
 17235
 17236 4400-EP-FIND-TAB-ENT.
 17237
 17238     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17239         GO TO 4490-EP-FIND-TAB-SUB.
 17240     MOVE +1 TO SUB9.
 17241
 17242 4450-EP-FIND-TAB-LOOP.
 17243
 17244     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17245         GO TO 4490-EP-FIND-TAB-SUB.
 17246     IF EPEC-SUB-REIN (SUB9) = ZEROS
 17247         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 17248         GO TO 4490-EP-FIND-TAB-SUB.
 17249
 17250     ADD +1 TO SUB9.
 17251     IF SUB9 GREATER THAN +31
 17252         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 17253         MOVE 0201 TO WS-ABEND-CODE
 17254         DISPLAY '******************************'
 17255         DISPLAY '***** ERROR LOCATION 020 *****'
 17256         DISPLAY '******************************'
 17257         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 17258         GO TO ABEND-PGM.
 17259
 17260     GO TO 4450-EP-FIND-TAB-LOOP.
 17261
 17262 4490-EP-FIND-TAB-SUB.
 17263
 17264     IF WE-LF-AH = LIFE-OVERRIDE-L1
 17265         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 17266             ADD +1 TO SUB10
 17267             MOVE SUB10 TO SUB3
 17268             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 17269         ELSE
 17270             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 17271
 17272     IF WE-LF-AH = AH-OVERRIDE-L1
 17273         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 17274             ADD +1 TO SUB10
 17275             MOVE SUB10 TO SUB3
 17276             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 17277         ELSE
 17278             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 17279
 17280*    IF SUB3 GREATER THAN +220
 17281*    IF SUB3 GREATER THAN +300
 17282     IF SUB3 GREATER THAN +900
 17283         DISPLAY 'SUB3 VALUE IS - ' SUB3
 17284         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 17285         MOVE 0202 TO WS-ABEND-CODE
 17286         DISPLAY '******************************'
 17287         DISPLAY '***** ERROR LOCATION 021 *****'
 17288         DISPLAY '******************************'
 17289         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010S.cbl
 17290         GO TO ABEND-PGM.
 17291
 17292     IF CR-POLICY-UNDERWRITTEN
 17293         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 17294         MOVE EPEC-UNDW-OPT-DATA-TABLE
 17295                                     TO EPEC-OPT-WORK-TABLE
 17296     ELSE
 17297         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 17298         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 17299
 17300     MOVE WE-REIN-CO         TO EW-REIN-CO
 17301                                EPEC-REIN-CO (SUB3)
 17302                                EPEC-REIN-CO-II (SUB3).
 17303     MOVE WE-LF-AH           TO EW-LF-AH
 17304                                EPEC-LF-AH (SUB3)
 17305                                EPEC-LF-AH-II (SUB3).
 17306     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 17307                                EPEC-BEN-TYPE (SUB3)
 17308                                EPEC-BEN-TYPE-II (SUB3).
 17309
 17310 4499-EP-FIND-TAB-ENT-X.
 17311     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010S.cbl
 17313******************************************************************
 17314***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 17315******************************************************************
 17316
 17317 4500-BUILD-EPEC-EXTRACT.
 17318
 17319     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 17320         VARYING SUB2 FROM +1 BY +1
 17321             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 17322
 17323     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 17324
 17325     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 17326
 17327
 17328 4510-BUILD-EPEC-EXT.
 17329
 17330     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 17331     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 17332     IF EW-LEVEL-USED = 'Y'
 17333         MOVE SPACE                     TO W-UNDERWRITING-SW
 17334         PERFORM 4511-BUILD-EPEC-RECORD THRU
 17335                 4518-BUILD-EPEC-RCD-X.
 17336
 17337     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 17338     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 17339     IF EW-LEVEL-USED = 'Y'
 17340         MOVE '*'                       TO W-UNDERWRITING-SW
 17341         PERFORM 4511-BUILD-EPEC-RECORD THRU
 17342                 4518-BUILD-EPEC-RCD-X.
 17343
 17344     GO TO 4519-BUILD-EPEC-EXT-X.
 17345
 17346 4511-BUILD-EPEC-RECORD.
 17347
 17348     MOVE SPACES                        TO EP-RECORD.
 17349     MOVE 'EP'                          TO EP-RECORD-ID.
 17350     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 17351     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 17352     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 17353     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 17354                                           WS-EP-EFF-DTE-N.
 17355     MOVE EW-REIN-CO                    TO EP-REI-CO.
 17356     IF EP-REI-CO NOT = SPACES
 17357         MOVE 'R'                       TO EP-REIN.
 17358     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 17359     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 17360
 17361     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 17362     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 17363     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 17364
 17365     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 17366     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
 17367     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 17368
 17369     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 17370     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010S.cbl
 17371     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 17372     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 17373
 17374     IF DTE-CLIENT NOT = 'NCL'
 17375         GO TO 4512-BUILD-EPEC-CONTINUE.
 17376
 17377     IF W-UNDERWRITTEN-DATA
 17378         GO TO 4512-BUILD-EPEC-CONTINUE.
 17379
 17380     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 17381         GO TO 4512-BUILD-EPEC-CONTINUE.
 17382
 17383     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 17384        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 17385        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 17386         NEXT SENTENCE
 17387     ELSE
 17388         GO TO 4512-BUILD-EPEC-CONTINUE.
 17389
 17390     IF OB-DATE-1-USED  OR
 17391        OB-DATE-2-USED  OR
 17392        OB-DATE-3-USED
 17393         NEXT SENTENCE
 17394     ELSE
 17395         GO TO 4512-BUILD-EPEC-CONTINUE.
 17396
 17397     IF OB-DATE-1-USED
 17398         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 17399             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17400                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 17401             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17402                                   EW-EPR-ST
 17403             GO TO 4512-BUILD-EPEC-CONTINUE
 17404         ELSE
 17405             GO TO 4512-BUILD-EPEC-CONTINUE.
 17406
 17407     IF OB-DATE-2-USED
 17408         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 17409             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17410                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 17411             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17412                                   EW-EPR-ST
 17413             GO TO 4512-BUILD-EPEC-CONTINUE
 17414         ELSE
 17415             GO TO 4512-BUILD-EPEC-CONTINUE.
 17416
 17417     IF OB-DATE-3-USED
 17418         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 17419             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 17420                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 17421             MOVE EW-EPR-R78    TO EW-EPR-PRO
 17422                                   EW-EPR-ST
 17423             GO TO 4512-BUILD-EPEC-CONTINUE
 17424         ELSE
 17425             GO TO 4512-BUILD-EPEC-CONTINUE.
 17426
 17427 4512-BUILD-EPEC-CONTINUE.
 17428
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010S.cbl
 17429     MOVE EW-EPR-R78                    TO EP-PRM-78.
 17430     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 17431     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 17432
 17433     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 17434     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 17435     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 17436
 17437     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 17438
 17439     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 17440     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 17441     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 17442
 17443     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 17444     MOVE ZEROS                         TO EP-CLM-PV.
 17445
 17446     IF EP-RCD-TYPE = 'A' OR 'U'
 17447         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 17448             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 17449
 17450     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 17451
 17452     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 17453     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 17454
 17455     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 17456
 17457     IF EW-ISS-CNT = ZERO
 17458         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 17459                                           EP-AVG-AGE
 17460       ELSE
 17461         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 17462                                EW-ORIG-TERM / EW-ISS-CNT
 17463         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 17464
 17465     IF EW-INFORCE-CNT = ZERO
 17466         MOVE ZERO                      TO EP-AVG-REM-TERM
 17467       ELSE
 17468         COMPUTE EP-AVG-REM-TERM ROUNDED =
 17469                             EW-REM-TERM / EW-INFORCE-CNT.
 17470
 17471     IF EW-ISS-BEN = ZERO
 17472         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 17473                                           EP-WEIGHTED-AGE
 17474       ELSE
 17475         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 17476                                  EW-TERM-BEN / EW-ISS-BEN
 17477         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 17478                                   EW-AGE-BEN / EW-ISS-BEN.
 17479
 17480     MOVE ZEROS                         TO
 17481         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 17482         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
 17483
 17484     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 17485                                           WS-EP-HI-COV-DT-N.
 17486     MOVE HIGH-CERT                     TO EP-HI-CERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010S.cbl
 17487                                           WS-EP-HI-CERT-N.
 17488     MOVE LOW-CERT                      TO EP-LO-CERT
 17489                                           WS-EP-LO-CERT-N.
 17490     IF DTE-PGM-OPT = '3'
 17491         MOVE 'P'                       TO EP-PURGE.
 17492
 17493     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 17494         GO TO 4514-CONTINUE.
 17495
 17496     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 17497
 17498     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 17499         MOVE +1                 TO EP-LIFE-YEARS
 17500     ELSE
 17501         MOVE ZEROS              TO W-LIFE-YEARS
 17502         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 17503                 VARYING
 17504             SUBM FROM +1 BY +1
 17505                 UNTIL
 17506             SUBM GREATER THAN +13
 17507         COMPUTE W-LIFE-YEARS-INT ROUNDED
 17508             = W-LIFE-YEARS / 12
 17509             - (EPEC-LIFE-CTR (SUB2 1)
 17510             + EPEC-LIFE-CTR (SUB2 13)) / 24
 17511         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 17512         IF  EP-LIFE-YEARS LESS THAN +1
 17513             MOVE +1             TO EP-LIFE-YEARS.
 17514
 17515 4514-CONTINUE.
 17516
 17517     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 17518
 17519     MOVE SPACES                        TO EC-RECORD.
 17520     MOVE '1'                           TO WS-SEQ-NBR.
 17521     MOVE +0                            TO SUB3.
 17522     MOVE +0                            TO SUB4.
 17523     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 17524         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 17525         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 17526
 17527     GO TO 4518-BUILD-EPEC-RCD-X.
 17528
 17529 4515-DETERMINE-LIFE-YEARS.
 17530
 17531     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 17532
 17533 4515-EXIT.
 17534     EXIT.
 17535
 17536 4518-BUILD-EPEC-RCD-X.
 17537     EXIT.
 17538
 17539 4519-BUILD-EPEC-EXT-X.
 17540     EXIT.
 17541
 17542 4520-BUILD-EPEC-LOAD-COMM.
 17543
 17544     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010S.cbl
 17545
 17546     ADD +1 TO SUB3  SUB4.
 17547     MOVE ZEROS                  TO LEVELS-BUILT.
 17548
 17549 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17550
 17551     IF SUB4 GREATER THAN WS-LOOP-MAX
 17552         IF AGT-SW = 'X'
 17553             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17554                 THRU 4999-WRT-SUMMARY-X
 17555             MOVE ' '            TO AGT-SW
 17556             MOVE WS-LOOP-MAX    TO  SUB4
 17557             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 17558         ELSE
 17559             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 17560
 17561     IF LEVELS-BUILT EQUAL +5
 17562         IF AGT-SW = 'X'
 17563             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17564                 THRU 4999-WRT-SUMMARY-X
 17565             MOVE ' '            TO AGT-SW
 17566             MOVE ZEROS          TO LEVELS-BUILT
 17567             ADD 1 TO WS-SEQ-NBR
 17568             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 17569             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 17570                     4540-BUILD-CLEAR-X
 17571                 VARYING SUB3 FROM +1 BY +1
 17572                 UNTIL SUB3 GREATER THAN +5
 17573             MOVE +1             TO SUB3
 17574             GO TO 4531-BUILD-EPEC-LOAD-COMM
 17575         ELSE
 17576             MOVE +1             TO SUB3
 17577             MOVE ZEROS          TO LEVELS-BUILT
 17578             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 17579
 17580     IF SUB4 GREATER THAN WS-LOOP-MAX
 17581         IF AGT-SW = 'X'
 17582             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 17583                 THRU 4999-WRT-SUMMARY-X
 17584             MOVE ' '                   TO AGT-SW
 17585             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 17586         ELSE
 17587             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 17588
 17589 4531-BUILD-EPEC-LOAD-COMM.
 17590
 17591     IF (EW-AGT-NO (SUB4) = SPACES)
 17592                  OR
 17593        ((EW-ISS-COM (SUB4) = ZEROS) AND
 17594         (EW-CNC-COM (SUB4) = ZEROS) AND
 17595         (EW-ECR-R78 (SUB4) = ZEROS) AND
 17596         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 17597         (EW-ECR-PRO (SUB4) = ZEROS) AND
 17598         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
 17599         (EW-ECR-ST (SUB4) = ZEROS))
 17600         PERFORM 4540-BUILD-EPEC-CLEAR
 17601             THRU 4540-BUILD-CLEAR-X
 17602         ADD +1 TO SUB4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010S.cbl
 17603         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17604
 17605     MOVE 'X'                           TO AGT-SW.
 17606     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 17607     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 17608     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 17609     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 17610     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 17611     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 17612     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 17613     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 17614     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 17615
 17616     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 17617
 17618     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 17619
 17620 4539-BUILD-EPEC-LOAD-COMM-X.
 17621     EXIT.
 17622
 17623 4540-BUILD-EPEC-CLEAR.
 17624
 17625     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 17626     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 17627     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 17628                                           EC-CNC-COMM (SUB3)
 17629                                           EC-COMM-78 (SUB3)
 17630                                           EC-COMM-PR (SUB3)
 17631                                           EC-COMM-ST (SUB3)
 17632                                           EC-COMM-78-ADJ (SUB3)
 17633                                           EC-COMM-PR-ADJ (SUB3).
 17634
 17635 4540-BUILD-CLEAR-X.
 17636     EXIT.
 17637
 17638 4545-BUILD-BASE.
 17639
 17640     MOVE 'EC'                   TO EC-RECORD-ID.
 17641     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 17642     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 17643     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 17644     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 17645                                    WS-EC-EFF-DTE.
 17646     MOVE EW-REIN-CO             TO EC-REI-CO.
 17647     IF EC-REI-CO NOT = SPACES
 17648         MOVE 'R'                TO EC-REIN.
 17649     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 17650     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 17651     IF DTE-PGM-OPT = '3'
 17652         MOVE 'P'                TO EC-PURGE.
 17653     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 17654
 17655 4545-BUILD-BASE-X.
 17656     EXIT.
 17657
 17658******************************************************************
 17659***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 17660******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010S.cbl
 17661
 17662 4550-CLEAR-EPEC-TOTALS.
 17663
 17664     MOVE LOW-CERT             TO SV-LO-CERT.
 17665     MOVE HIGH-CERT            TO SV-HI-CERT.
 17666     MOVE SPACES               TO LOW-CTL.
 17667     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 17668
 17669     MOVE +1                   TO SUB9.
 17670     MOVE +0                   TO SUB10.
 17671     MOVE ZERO                 TO EW-REIN-CO
 17672                                  EW-BEN-TYPE.
 17673     MOVE SPACE                TO EP-FLG
 17674                                  EW-LF-AH
 17675                                  EW-LEVEL-USED
 17676                                  W-TABLE-USED-SW.
 17677
 17678     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 17679                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 17680                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 17681                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 17682                                  EW-EPR-R78     EW-EPR-R78-ADJ
 17683                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 17684                                  EW-EPR-ST      EW-EPR-ST-ADJ
 17685                                  EW-CLM-AMT     EW-COV-DTE
 17686                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 17687                                  EW-CLM-FUTRSV  EW-CLM-CNT
 17688                                  EW-CLM-CRT     EW-ISS-CNT
 17689                                  EW-CNC-CNT     EW-AGE
 17690                                  EW-ORIG-TERM   EW-INFORCE-CNT
 17691                                  EW-AGE-BEN     EW-TERM-BEN
 17692                                  EW-ISS-PRM-TAX
 17693                                  EW-REM-TERM.
 17694
 17695     MOVE +1 TO SUB1.
 17696     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
 17697     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 17698         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 17699     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 17700                                    EPEC-UNDW-OPT-DATA-TABLE.
 17701     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 17702         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 17703
 17704     PERFORM 4590-INIT-OB THRU 4590-EXIT
 17705         VARYING SUB3 FROM +1 BY +1
 17706*        UNTIL SUB3 GREATER THAN +300.
 17707*        UNTIL SUB3 GREATER THAN +220.
 17708         UNTIL SUB3 GREATER THAN +900.
 17709
 17710     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 17711
 17712 4555-CLEAR-EPEC-COMM.
 17713
 17714     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 17715                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 17716                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 17717                EW-ECR-ST  (SUB1).
 17718     MOVE SPACES                 TO EW-AGT-NO (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010S.cbl
 17719                                    EW-AGT-TYPE (SUB1).
 17720
 17721     ADD +1 TO SUB1.
 17722
 17723 4560-CLEAR-EPEC-ALL.
 17724
 17725     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 17726                                    EPEC-LEVELS-II (SUB1).
 17727     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 17728
 17729 4570-CLEAR-EPEC-SUB-A.
 17730
 17731     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 17732     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 17733*        UNTIL SUB2 GREATER +300.
 17734         UNTIL SUB2 GREATER +900.
 17735
 17736 4580-CLEAR-EPEC-SUB-B.
 17737
 17738     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 17739     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 17740
 17741 4589-CLEAR-EPEC-TOTALS-X.
 17742     EXIT.
 17743
 17744 4590-INIT-OB.
 17745
 17746     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 17747     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 17748     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 17749
 17750 4590-EXIT.
 17751     EXIT.
 17752
 17753 4599-BUILD-EPEC-EXTRACT-X.
 17754     EXIT.
 17755
 17756*********************************************************
 17757*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 17758*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 17759*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 17760*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 17761*  IN THE DATE CARD.                                    *
 17762*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 17763*********************************************************
 17764
 17765 4599A-CALC-IBNR.
 17766
 17767     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 17768        (((EP-PRM-78 + EP-PRM-78-ADJ)
 17769                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 17770         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 17771                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 17772                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 17773
 17774     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 17775         MOVE ZEROS                 TO EW-CLM-IBNR
 17776         GO TO 4599A-CALC-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010S.cbl
 17777
 17778     IF EP-REIN = 'R'
 17779         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 17780
 17781     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 17782
 17783 4599A-CALC-EXIT.
 17784      EXIT.
 17785 4599B-SEARCH.
 17786      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010S.cbl
 17788******************************************************************
 17789***         CALCULATE OPTIONAL METHOD I B N R                  ***
 17790******************************************************************
 17791
 17792 4600-GET-OPT-IBNR.
 17793
 17794     IF  CR-POLICY-IS-ACTIVE
 17795         IF  CR-POLICY-IS-REISSUE
 17796             OR CR-POLICY-IS-MONTHLY
 17797             IF  W-LIFE
 17798                 GO TO 4600-EXIT
 17799             ELSE
 17800                 NEXT SENTENCE
 17801         ELSE
 17802             NEXT SENTENCE
 17803     ELSE
 17804         IF  W-LIFE
 17805             GO TO 4600-EXIT.
 17806
 17807     IF  W-LIFE
 17808         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 17809     ELSE
 17810         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 17811
 17812 4600-EXIT.
 17813     EXIT.
 17814
 17815 4620-DETERMINE-LIFE-IBNR.
 17816
 17817     IF  CR-LF-POLICY-IS-ACTIVE
 17818         ADD +1                  TO W-LF-ACTIVE
 17819         IF  CR-LF-POLICY-IS-REISSUE
 17820             OR CR-LF-POLICY-IS-MONTHLY
 17821             MOVE ZEROS          TO W-WK-IBNR
 17822             ADD +1              TO W-LF-REISSUE
 17823             GO TO 4620-EXIT
 17824         ELSE
 17825             NEXT SENTENCE
 17826     ELSE
 17827         ADD +1                  TO W-LF-INACTIVE
 17828         MOVE ZEROS              TO W-WK-IBNR
 17829         GO TO 4620-EXIT.
 17830
 17831     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17832         MOVE ZEROS              TO W-WK-IBNR
 17833         ADD +1                  TO W-LF-CALC-B
 17834         GO TO 4620-EXIT.
 17835
 17836     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 17837                 AND
 17838             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17839                 AND
 17840             W-BAL-REMTRM NOT GREATER THAN ZERO)
 17841             OR
 17842         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 17843                 AND
 17844             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 17845                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010S.cbl
 17846             REM-TRM2 NOT GREATER THAN ZERO)
 17847         MOVE ZEROS              TO W-WK-IBNR
 17848         ADD +1                  TO W-LF-BALLOON
 17849         GO TO 4620-EXIT
 17850     ELSE
 17851         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17852                 AND
 17853             REM-TRM2 NOT GREATER THAN ZERO)
 17854             ADD +1              TO W-LF-REMTERM-0
 17855             MOVE ZEROS          TO W-WK-IBNR
 17856             GO TO 4620-EXIT.
 17857
 17858     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 17859
 17860     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 17861         ADD +1                  TO W-LF-REMAMT-0
 17862         MOVE ZEROS              TO W-WK-IBNR
 17863         GO TO 4620-EXIT.
 17864
 17865     IF  AM-LIFE-IBNR-PCT NUMERIC
 17866             AND
 17867         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 17868         COMPUTE W-WK-IBNR ROUNDED
 17869             = CP-REMAINING-AMT
 17870             / 1000
 17871             * AM-LIFE-IBNR-PCT
 17872     ELSE
 17873         COMPUTE W-WK-IBNR ROUNDED
 17874             = CP-REMAINING-AMT
 17875             / 1000
 17876             * COMPANY-IBNR-LIFE-FACTOR.
 17877
 17878     IF  CR-LF-IS-REIN-ONLY
 17879         ADD +1                  TO W-LF-REIN
 17880     ELSE
 17881         ADD +1                  TO W-LF-DATA-USED
 17882         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 17883         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 17884         IF  CR-LFTYP = '01'
 17885             ADD CP-REMAINING-AMT
 17886                                 TO W-01-REMAMT
 17887             ADD +1              TO W-01-DATA-USED
 17888         ELSE
 17889         IF  CR-LFTYP = '02'
 17890             ADD CP-REMAINING-AMT
 17891                                 TO W-02-REMAMT
 17892             ADD +1              TO W-02-DATA-USED
 17893         ELSE
 17894         IF  CR-LFTYP = '03'
 17895             ADD CP-REMAINING-AMT
 17896                                 TO W-03-REMAMT
 17897             ADD +1              TO W-03-DATA-USED
 17898         ELSE
 17899         IF  CR-LFTYP = '04'
 17900             ADD CP-REMAINING-AMT
 17901                                 TO W-04-REMAMT
 17902             ADD +1              TO W-04-DATA-USED
 17903         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010S.cbl
 17904         IF  CR-LFTYP = '05'
 17905             ADD CP-REMAINING-AMT
 17906                                 TO W-05-REMAMT
 17907             ADD +1              TO W-05-DATA-USED
 17908         ELSE
 17909         IF  CR-LFTYP = '06'
 17910             ADD CP-REMAINING-AMT
 17911                                 TO W-06-REMAMT
 17912             ADD +1              TO W-06-DATA-USED
 17913         ELSE
 17914         IF  CR-LFTYP = '30'
 17915             ADD CP-REMAINING-AMT
 17916                                 TO W-30-REMAMT
 17917             ADD +1              TO W-30-DATA-USED
 17918         ELSE
 17919         IF  CR-LFTYP = '31'
 17920             ADD CP-REMAINING-AMT
 17921                                 TO W-31-REMAMT
 17922             ADD +1              TO W-31-DATA-USED
 17923         ELSE
 17924             ADD CP-REMAINING-AMT
 17925                                 TO W-XX-REMAMT
 17926             ADD +1              TO W-XX-DATA-USED.
 17927
 17928     IF  CR-POLICY-IS-REIN-ONLY
 17929             OR
 17930         CR-LF-IS-REIN-ONLY
 17931         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 17932         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 17933         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 17934     ELSE
 17935         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 17936
 17937 4620-EXIT.
 17938     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010S.cbl
 17940 4640-GET-A-H-EARNED-PREMIUM.
 17941
 17942     IF  CR-AH-POLICY-IS-ACTIVE
 17943         ADD +1                  TO W-AH-ACTIVE
 17944         IF  CR-AH-POLICY-IS-REISSUE
 17945             OR CR-AH-POLICY-IS-MONTHLY
 17946             ADD +1              TO W-AH-REISSUE
 17947         ELSE
 17948             NEXT SENTENCE
 17949     ELSE
 17950         ADD +1                  TO W-AH-INACTIVE.
 17951
 17952     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 17953         ADD +1                  TO W-AH-CALC-B
 17954         GO TO 4640-EXIT.
 17955
 17956     IF  REM-TRM2 NOT GREATER THAN ZEROS
 17957         MOVE 'Y'                TO W-RTRM-0-SW
 17958     ELSE
 17959         MOVE SPACES             TO W-RTRM-0-SW.
 17960
 17961     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 17962
 17963****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 17964******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 17965******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 17966******        THAT CLAIM.
 17967
 17968     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 17969
 17970     IF  CR-POLICY-IS-REIN-ONLY
 17971              OR
 17972         CR-AH-IS-REIN-ONLY
 17973         ADD +1                  TO W-AH-REIN
 17974         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 17975         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 17976         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 17977         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 17978         GO TO 4640-EXIT.
 17979
 17980     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 17981                                    W-EPEC-EP-IN.
 17982     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 17983                                    W-CLAIMS-MADE-PAID-IN.
 17984     ADD +1                      TO W-AH-DATA-USED.
 17985     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 17986     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 17987
 17988     IF  W-CLMAMT GREATER THAN ZEROS
 17989         ADD +1                  TO W-AH-CLAIM-CTR
 17990         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 17991
 17992     IF  W-RTRM-0
 17993             AND
 17994         NOT CR-POLICY-IS-REIN-ONLY
 17995             AND
 17996         NOT CR-AH-IS-REIN-ONLY
 17997         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010S.cbl
 17998         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 17999         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 18000         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 18001         ADD +1                  TO W-AH-REMTERM-0.
 18002
 18003 4640-EXIT.
 18004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010S.cbl
 18006 4650-DETERMINE-CLM-AMT-AH.
 18007
 18008     MOVE ZEROS                  TO W-CLMAMT.
 18009
 18010     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 18011             OR
 18012         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 18013         GO TO 4650-EXIT.
 18014
 18015     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 18016             AND
 18017         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 18018         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 18019         MOVE 'L'                    TO DC-OPTION-CODE
 18020         PERFORM 8000-DATE-CONVERT-ROUTINE
 18021             THRU 8099-DATE-CONVERT-X
 18022         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 18023         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 18024         MOVE 'L'                    TO DC-OPTION-CODE
 18025         PERFORM 8000-DATE-CONVERT-ROUTINE
 18026             THRU 8099-DATE-CONVERT-X
 18027         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 18028         IF  DATE-CONVERSION-ERROR
 18029             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 18030             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 18031             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 18032             MOVE 0303               TO WS-ABEND-CODE
 18033             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 18034             GO TO ABEND-PGM
 18035         ELSE
 18036             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 18037             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 18038             MOVE '1'                TO DC-OPTION-CODE
 18039             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 18040                                        DC-ELAPSED-DAYS
 18041             PERFORM 8000-DATE-CONVERT-ROUTINE
 18042                 THRU 8099-DATE-CONVERT-X
 18043             IF  DATE-CONVERSION-ERROR
 18044                 DISPLAY 'DIS TO PTO DATE ERROR '
 18045                     CR-FULL-CONTROL
 18046                 MOVE 'DIS TO PTO DATE ERROR '
 18047                                     TO WS-ABEND-MESSAGE
 18048                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 18049                 MOVE 0303           TO WS-ABEND-CODE
 18050                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 18051                 GO TO ABEND-PGM
 18052             ELSE
 18053                 COMPUTE W-CLMAMT ROUNDED
 18054                     = CR-AHAMT
 18055                     * (DC-ELAPSED-DAYS / 30)
 18056                 GO TO 4650-EXIT.
 18057
 18058     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 18059             OR
 18060         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 18061         GO TO 4650-EXIT.
 18062
 18063     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010S.cbl
 18064         = CR-AHAMT * 3.
 18065
 18066     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 18067         MOVE CR-DISAMT          TO W-CLMAMT
 18068     ELSE
 18069         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 18070
 18071     IF  NOT CR-POLICY-IS-REIN-ONLY
 18072              AND
 18073         NOT CR-AH-IS-REIN-ONLY
 18074         ADD +1          TO W-CLM-EXCEPT-CNT
 18075         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 18076
 18077 4650-EXIT.
 18078     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010S.cbl
 18080 4660-DETERMINE-EARNED-PREMIUM.
 18081
 18082     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 18083
 18084     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 18085
 18086     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 18087
 18088     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 18089         MOVE ZEROS              TO W-EARNED-PREMIUM
 18090         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 18091         MOVE '7'                TO W-VAL-SOURCE
 18092         PERFORM 8500-REMAINING-TERM-ROUTINE
 18093             THRU 8599-REM-TERM-X
 18094         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 18095         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 18096         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 18097         MOVE EPR-R78            TO W-OPT-R78
 18098         MOVE EPR-PRO            TO W-OPT-PRO
 18099         MOVE EPR-ST             TO W-OPT-ST
 18100         PERFORM 4670-CALC-EP THRU 4670-EXIT
 18101         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 18102     ELSE
 18103         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 18104
 18105     COMPUTE W-EARNED-PREMIUM ROUNDED
 18106         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 18107
 18108     IF  W-EARNED-PREMIUM LESS THAN ZERO
 18109         ADD +1                  TO W-EP-LESS-THAN-0
 18110         MOVE ZERO               TO W-EARNED-PREMIUM.
 18111
 18112 4660-EXIT.
 18113     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010S.cbl
 18115 4666-SAVE-AHCR-DATA.
 18116
 18117     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 18118                                    WX-STATUS-AT-SETTLEMENT.
 18119
 18120     MOVE ZEROS                  TO WX-CANC-DT
 18121                                    WX-EOM-RUN-DATE
 18122                                    WX-SETTLEMENT-EXIT-DATE.
 18123
 18124     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 18125         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 18126         MOVE CR-AH-STATUS-AT-CANCEL
 18127                                 TO WX-STATUS-AT-CANCEL
 18128         MOVE ZEROS              TO CR-AH-CANC-DT
 18129                                    WS-CR-AH-CANC-DT-N
 18130         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 18131
 18132     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18133         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 18134                                 TO WX-SETTLEMENT-EXIT-DATE
 18135         MOVE CR-AH-STATUS-AT-SETTLEMENT
 18136                                 TO WX-STATUS-AT-SETTLEMENT
 18137         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 18138                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18139         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 18140
 18141     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 18142     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 18143
 18144 4666-EXIT.
 18145     EXIT.
 18146
 18147 4668-RESTORE-AHCR-DATA.
 18148
 18149     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 18150         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 18151                                    WS-CR-AH-CANC-DT-N
 18152         MOVE WX-STATUS-AT-CANCEL
 18153                                 TO CR-AH-STATUS-AT-CANCEL.
 18154
 18155     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18156         MOVE WX-SETTLEMENT-EXIT-DATE
 18157                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 18158                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18159         MOVE WX-STATUS-AT-SETTLEMENT
 18160                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 18161
 18162     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 18163
 18164 4668-EXIT.
 18165     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010S.cbl
 18167 4670-CALC-EP.
 18168
 18169     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 18170         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 18171         ADD W-EARNED-PREMIUM    TO W-WY-EP
 18172         GO TO 4670-EXIT.
 18173
 18174     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 18175         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 18176         ADD W-EARNED-PREMIUM    TO W-VA-EP
 18177         GO TO 4670-EXIT.
 18178
 18179***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 18180
 18181     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 18182         COMPUTE W-EARNED-PREMIUM
 18183             = (W-OPT-PRO + W-OPT-R78) / +2
 18184         ADD W-EARNED-PREMIUM    TO W-M-EP
 18185     ELSE
 18186         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 18187             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 18188             ADD W-EARNED-PREMIUM
 18189                                 TO W-R-EP
 18190         ELSE
 18191             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 18192                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 18193                 ADD W-EARNED-PREMIUM
 18194                                 TO W-P-EP
 18195             ELSE
 18196                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 18197                     COMPUTE W-EARNED-PREMIUM ROUNDED
 18198                         = (W-OPT-PRO * +.6667)
 18199                         + (W-OPT-R78 * +.3333)
 18200                     ADD W-EARNED-PREMIUM
 18201                                 TO W-1-EP
 18202                 ELSE
 18203                     ADD +1      TO W-OTHERS-COUNT
 18204                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 18205
 18206 4670-EXIT.
 18207     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010S.cbl
 18209 4680-CALC-REMAINING-AMT-LF.
 18210
 18211     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 18212     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 18213     MOVE CR-APR                 TO CP-LOAN-APR.
 18214     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 18215
 18216     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 18217         MOVE +1                 TO CR-PMT-FREQ.
 18218
 18219     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 18220
 18221     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 18222     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 18223                                    CP-RATING-BENEFIT-AMT.
 18224     IF CP-STATE-STD-ABBRV = 'OR'
 18225         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 18226     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 18227     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 18228     MOVE ZEROS                  TO CP-REMAINING-AMT
 18229                                    CP-REMAINING-AMT-PRV
 18230                                    CP-RETURN-CODE
 18231                                    CP-RETURN-CODE-2.
 18232
 18233
 18234     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 18235
 18236     IF  CP-RETURN-CODE NOT = ZERO
 18237         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 18238                             TO WS-ABEND-MESSAGE
 18239         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 18240         MOVE 2001           TO WS-ABEND-CODE
 18241         GO TO ABEND-PGM.
 18242
 18243 4680-EXIT.
 18244     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010S.cbl
 18246******************************************************************
 18247***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 18248******************************************************************
 18249
 18250 4700-CALC-OPT-IBNR.
 18251
 18252     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 18253     MOVE SPACE                  TO W-UNDERWRITING-SW.
 18254
 18255     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 18256             VARYING
 18257         SUB2 FROM +1 BY +1
 18258             UNTIL
 18259*        SUB2 GREATER THAN 300.
 18260*        SUB2 GREATER THAN 220.
 18261         SUB2 GREATER THAN 900.
 18262
 18263     MOVE EPEC-UNDW-OPT-DATA-TABLE
 18264                                 TO EPEC-OPT-WORK-TABLE.
 18265     MOVE '*'                    TO W-UNDERWRITING-SW.
 18266
 18267     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 18268             VARYING
 18269         SUB2 FROM +1 BY +1
 18270             UNTIL
 18271*        SUB2 GREATER THAN 300.
 18272*        SUB2 GREATER THAN 220.
 18273         SUB2 GREATER THAN 900.
 18274
 18275 4700-EXIT.
 18276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010S.cbl
 18278 4710-PROCESS-THRU-EPEC-TABLE.
 18279
 18280     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 18281         GO TO 4710-EXIT.
 18282
 18283     IF  W-UNDERWRITTEN-DATA
 18284         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 18285     ELSE
 18286         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 18287
 18288     IF EW-LEVEL-USED NOT = 'Y'
 18289         GO TO 4710-EXIT.
 18290
 18291     IF  EW-REIN-CO GREATER THAN SPACES
 18292         MOVE 'Y'                TO W-REIN-PROCESS-SW
 18293         IF  EPEC-REIN-ONLY-DATA (SUB2)
 18294             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 18295             IF  W-WK-IBNR GREATER THAN ZEROS
 18296                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 18297                 GO TO 4710-EXIT
 18298             ELSE
 18299                 GO TO 4710-EXIT
 18300         ELSE
 18301             IF  EW-CLM-IBNR GREATER THAN ZEROS
 18302                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 18303                 GO TO 4710-EXIT
 18304             ELSE
 18305                 GO TO 4710-EXIT.
 18306
 18307     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 18308
 18309     IF  EW-LF-AH EQUAL 'L'
 18310         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 18311             GO TO 4710-EXIT
 18312         ELSE
 18313             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 18314             ADD W-WK-IBNR       TO W-LIFE-IBNR
 18315     ELSE
 18316         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 18317                 GREATER THAN ZEROS
 18318             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 18319             ADD W-WK-IBNR       TO W-AH-IBNR
 18320         ELSE
 18321             GO TO 4710-EXIT.
 18322
 18323     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 18324     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 18325     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 18326
 18327     IF  W-UNDERWRITTEN-DATA
 18328         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 18329     ELSE
 18330         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 18331
 18332
 18333     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18334     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 18335
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010S.cbl
 18336 4710-EXIT.
 18337     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010S.cbl
 18339 4720-PROCESS-LIFE.
 18340
 18341     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 18342
 18343 4720-EXIT.
 18344     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010S.cbl
 18346 4730-PROCESS-A-H.
 18347
 18348     IF  AM-TARGET-LOSS-RATIO NUMERIC
 18349             AND
 18350         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 18351         MOVE AM-TARGET-LOSS-RATIO
 18352                                 TO W-TARGET-LOSS-RATIO
 18353     ELSE
 18354         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 18355             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 18356                                 TO W-TARGET-LOSS-RATIO
 18357             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 18358
 18359     IF  W-NOT-REIN-PROCESS
 18360         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 18361         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 18362
 18363     COMPUTE W-IBNR-1 ROUNDED
 18364         = EPEC-EARNED-PREMIUM-AH (SUB2)
 18365         * COMPANY-IBNR-AH-FACTOR
 18366         * W-TARGET-LOSS-RATIO.
 18367
 18368     COMPUTE W-IBNR-2 ROUNDED
 18369         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 18370         * W-TARGET-LOSS-RATIO)
 18371         - EPEC-CLAIMS-MADE-PAID (SUB2).
 18372
 18373     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 18374         MOVE W-IBNR-1           TO W-WK-IBNR
 18375         IF  W-NOT-REIN-PROCESS
 18376             ADD +1              TO W-AH-IBNR-1-CNT
 18377             ADD W-IBNR-1        TO W-AH-IBNR-1
 18378         ELSE
 18379             NEXT SENTENCE
 18380     ELSE
 18381         MOVE W-IBNR-2           TO W-WK-IBNR
 18382         IF  W-NOT-REIN-PROCESS
 18383             ADD +1              TO W-AH-IBNR-2-CNT
 18384             ADD W-IBNR-2        TO W-AH-IBNR-2.
 18385
 18386 4730-EXIT.
 18387     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010S.cbl
 18389 4735-GET-BUSINESS-ADJUSTMENT.
 18390
 18391     IF  CR-GRPTYP NOT NUMERIC
 18392         MOVE '99'               TO INDEXBS
 18393     ELSE
 18394         MOVE CR-GRPTYP          TO INDEXBS.
 18395
 18396     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 18397             AND
 18398         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 18399             NOT EQUAL ZEROS
 18400             AND
 18401         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 18402             NOT EQUAL +1.0000
 18403         MOVE INDEXBS           TO W-EDIT-7
 18404         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 18405             = W-TARGET-LOSS-RATIO
 18406             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 18407
 18408 4735-EXIT.
 18409     EXIT.
 18410
 18411 4740-CREATE-DETAIL-EXTR.
 18412
 18413     IF DTE-PGM-OPT NOT = '1'
 18414         GO TO 4740-EXIT.
 18415
 18416     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 18417         GO TO 4740-EXIT.
 18418
 18419     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 18420     MOVE ZEROS                  TO REPORTED-DATE
 18421                                    PAY-TO-DATE.
 18422
 18423     MOVE SPACES                 TO TR-DTL2.
 18424     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 18425
 18426     MOVE EOM-YR                 TO TRD-ISYR.
 18427     MOVE EOM-MO                 TO TRD-ISMO.
 18428     MOVE EOM-DA                 TO TRD-ISDA.
 18429     MOVE ZERO                   TO TRD-AGE.
 18430
 18431     IF  EW-LF-AH EQUAL 'L'
 18432         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 18433     ELSE
 18434         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 18435
 18436     MOVE SPACES                 TO TRD-PAYCURX
 18437                                    TRD-PAYCUR-SPACE
 18438                                    TRD-FUTRSV-SPACE
 18439                                    TRD-FUTRSVX.
 18440
 18441     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 18442     MOVE 'IBNR'                 TO TRD-IBNRX.
 18443     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 18444     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 18445
 18446     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010S.cbl
 18447         IF  W-REIN-IN-PROCESS
 18448             MOVE ' ACCT/BEN REIN RSV UW'
 18449                                 TO TRD-RSV-ACTION
 18450         ELSE
 18451             MOVE ' ACCT/BEN RESERVES UW'
 18452                                 TO TRD-RSV-ACTION
 18453     ELSE
 18454         IF  W-REIN-IN-PROCESS
 18455             MOVE ' ACCT/BEN REIN RSV'
 18456                                 TO TRD-RSV-ACTION
 18457         ELSE
 18458             MOVE ' ACCT/BEN RESERVES'
 18459                                 TO TRD-RSV-ACTION.
 18460
 18461     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 18462
 18463     MOVE SPACES                 TO DETAIL-EXTRACT.
 18464
 18465     IF  W-REIN-IN-PROCESS
 18466         MOVE EW-REIN-CO         TO DE-REI-COMP
 18467         MOVE 'R'                TO DE-REIN
 18468         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 18469         MOVE ZEROS              TO DE-IBNR
 18470     ELSE
 18471         MOVE EW-CLM-IBNR        TO DE-IBNR
 18472         MOVE ZEROS              TO DE-REI-IBNR.
 18473
 18474     MOVE 'DE'                   TO DE-RECORD-ID.
 18475     MOVE 'Y'                    TO DE-TRANS.
 18476     MOVE 'IBNRRSV'              TO DE-CLMNO.
 18477     MOVE '1'                    TO DE-ENTRY-STATUS.
 18478     MOVE 'ACTBENIBNR'           TO DE-CERT.
 18479
 18480     MOVE EOM-RUN-DATE           TO DE-EFF
 18481                                    WS-DE-EFF-N
 18482                                    DE-ENTRY-DTE
 18483                                    WS-DE-ENTRY-DTE-N.
 18484     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 18485                                    WS-DE-RSV-INCUR-N.
 18486
 18487     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 18488     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 18489     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 18490                                    WS-DE-ACC-EXP-DTE-RSV-N.
 18491     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 18492                                    WS-DE-ACC-EFF-DTE-RSV-N.
 18493
 18494     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 18495     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 18496     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 18497     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 18498     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 18499     IF (CR-ENTRY-BATCH (1:2) = 'BL')
 18500        OR (CR-LF-EXIT-BATCH (1:2) = 'BL')
 18501        OR (CR-AH-EXIT-BATCH (1:2) = 'BL')
 18502        MOVE 'BLL'                 TO DE-NCL-POOL-CODE
 18503     END-IF
 18504*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010S.cbl
 18505     MOVE AM-IG                  TO DE-IG.
 18506
 18507     IF W-UNDERWRITTEN-DATA
 18508         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 18509     ELSE
 18510         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 18511
 18512     IF  EW-LF-AH EQUAL 'L'
 18513         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 18514         MOVE '1'                TO DE-RESERVE-TYPE
 18515         MOVE ZEROS              TO DE-AH-TYPE
 18516     ELSE
 18517         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 18518         MOVE '2'                TO DE-RESERVE-TYPE
 18519         MOVE ZEROS              TO DE-LF-TYPE.
 18520
 18521     MOVE SPACES                 TO DE-NAME
 18522                                    DE-ACC-GPCD
 18523                                    DE-AH-STAT-CDE
 18524                                    DE-LF-STAT-CDE
 18525                                    DE-MEMBER-NO
 18526                                    DE-NAME
 18527                                    DE-SEX.
 18528     MOVE ZEROS                  TO DE-AGE
 18529                                    DE-AH-BEN
 18530                                    DE-AH-CANC-DTE
 18531                                    WS-DE-AH-CANC-DTE-N
 18532                                    DE-AH-CANC-EXIT-DT
 18533                                    WS-DE-AH-CANC-EXIT-DT-N
 18534                                    DE-AH-PRM
 18535                                    DE-AH-RFND
 18536                                    DE-AH-TERM
 18537                                    DE-APR
 18538                                    DE-CANCEL-CNT-ITD
 18539                                    DE-CANCEL-CNT-YTD
 18540                                    DE-FUTRSV
 18541                                    DE-LF-BEN
 18542                                    DE-LF-BEN-ALT
 18543                                    DE-LF-CANC-DTE
 18544                                    WS-DE-LF-CANC-DTE-N
 18545                                    DE-LF-CANC-EXIT-DT
 18546                                    WS-DE-LF-CANC-EXIT-DT-N
 18547                                    DE-LF-CNBEN
 18548                                    DE-LF-CNBEN-ALT
 18549                                    DE-LF-PRM
 18550                                    DE-LF-PRM-ALT
 18551                                    DE-LF-RFND
 18552                                    DE-LF-TERM
 18553                                    DE-LIVES
 18554                                    DE-PAYCUR
 18555                                    DE-PMT-FREQ
 18556                                    DE-REI-AHAMT
 18557                                    DE-REI-AHPRM
 18558                                    DE-REI-AHRFND
 18559                                    DE-REI-CNAMT
 18560                                    DE-REI-FUTRSV
 18561                                    DE-REI-LFAMT
 18562                                    DE-REI-LFPRM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010S.cbl
 18563                                    DE-REI-LFRFND
 18564                                    DE-REI-PAYCUR
 18565                                    DE-RSV-REPORTED
 18566                                    DE-RSV-PAYTO
 18567                                    WS-DE-RSV-PAYTO-N
 18568                                    DE-MOB-NET-TOT-FEES
 18569                                    DE-SOC-SEC-NO.
 18570
 18571     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 18572
 18573     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 18574         THRU 2599-WRT-DETAIL-X.
 18575     ADD +1                      TO BC-G-CRS.
 18576
 18577 4740-EXIT.
 18578     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010S.cbl
 18580 4750-UPDATE-REIN.
 18581
 18582     COMPUTE SUB3 = SUB2 + 1.
 18583
 18584     IF  W-UNDERWRITTEN-DATA
 18585         MOVE EPEC-SUB-KEY-II (SUB2)
 18586                                 TO W-SUB-KEY
 18587     ELSE
 18588         MOVE EPEC-SUB-KEY (SUB2)
 18589                                 TO W-SUB-KEY.
 18590
 18591     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 18592             VARYING
 18593         SUB3 FROM SUB3 BY +1
 18594             UNTIL
 18595         SUB3 GREATER THAN +900
 18596*        SUB3 GREATER THAN +220
 18597*        SUB3 GREATER THAN +300
 18598             OR
 18599         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 18600
 18601 4750-EXIT.
 18602     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010S.cbl
 18604 4755-MATCH-REIN-EPEC.
 18605
 18606     IF  W-UNDERWRITTEN-DATA
 18607         MOVE EPEC-LEVELS-II (SUB3)
 18608                                 TO EPEC-WORK
 18609     ELSE
 18610         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 18611
 18612     IF  EPEC-LINE-NOT-USED (SUB3)
 18613         GO TO 4755-EXIT.
 18614
 18615     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 18616             OR
 18617         EW-REIN-CO EQUAL SPACES
 18618         GO TO 4755-EXIT.
 18619
 18620     IF  W-ISS-BEN GREATER THAN ZEROS
 18621         IF  EPEC-REIN-ONLY-DATA (SUB3)
 18622             COMPUTE W-FACTOR ROUNDED
 18623                 = (EW-ISS-BEN
 18624                 - EPEC-REIN-ISS-BEN (SUB3))
 18625                 / W-ISS-BEN
 18626         ELSE
 18627             COMPUTE W-FACTOR ROUNDED
 18628                 = EW-ISS-BEN
 18629                 / W-ISS-BEN.
 18630
 18631     COMPUTE EW-CLM-IBNR ROUNDED
 18632         = EW-CLM-IBNR
 18633         + (W-WK-IBNR * W-FACTOR).
 18634
 18635     IF  W-UNDERWRITTEN-DATA
 18636         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 18637     ELSE
 18638         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 18639
 18640 4755-EXIT.
 18641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010S.cbl
 18643 4760-PROCESS-REIN-ONLY.
 18644
 18645     MOVE ZEROS                  TO W-WK-IBNR.
 18646
 18647     IF  EPEC-LINE-NOT-USED (SUB2)
 18648         GO TO 4760-EXIT.
 18649
 18650     IF  EW-LF-AH EQUAL 'L'
 18651         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 18652             GO TO 4760-EXIT
 18653         ELSE
 18654             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 18655             ADD W-WK-IBNR       TO EW-CLM-IBNR
 18656     ELSE
 18657         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 18658             GO TO 4760-EXIT
 18659         ELSE
 18660             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 18661             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 18662
 18663 4760-EXIT.
 18664     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010S.cbl
 18666 4770-CREATE-REIN-DETAIL.
 18667
 18668     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 18669     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18670
 18671 4770-EXIT.
 18672     EXIT.
 18673
 18674 4799-EXIT.
 18675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010S.cbl
 18677 4800-CALC-EARNED-PREMIUM-AH.
 18678
 18679     MOVE +0                         TO CNC-BEN  EPR-R78
 18680                                        ISS-PRM  EPR-PRO
 18681                                        CNC-PRM  EPR-ST
 18682                                        WX-CLM-AMT
 18683                                        WX-CLM-EXP
 18684                                        WX-CLM-CNT
 18685                                        WX-CLM-CRT
 18686                                        WX-CNC-CNT
 18687                                        ISS-PRMTAX
 18688                                        WX-ACTIVE-COUNT.
 18689     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 18690
 18691     MOVE WE-AHPRM TO ISS-PRM.
 18692
 18693     IF DTE-CLIENT = 'GIC'
 18694         IF REIN-EP-FLG NOT = 'R'  AND
 18695            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 18696            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 18697            MOVE CR-AHPRM-CALC TO ISS-PRM.
 18698
 18699     IF REIN-EP-FLG = 'R'  AND
 18700        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 18701         NEXT SENTENCE
 18702     ELSE
 18703         GO TO 4810-EP-DO-AH-CLM.
 18704
 18705     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 18706         IF WE-DSPY-AMT NOT = +0
 18707             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18708             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18709             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18710             ADD +1             TO WX-CLM-CNT.
 18711
 18712     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 18713         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 18714             GO TO 4830-EP-DO-AH-EP.
 18715
 18716     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 18717         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 18718             GO TO 4830-EP-DO-AH-EP.
 18719
 18720     GO TO 4815-EP-DO-AH-CLM-EPR.
 18721
 18722 4810-EP-DO-AH-CLM.
 18723
 18724     IF WE-DSPY-AMT NOT = +0
 18725         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18726         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18727         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18728         ADD +1             TO WX-CLM-CNT.
 18729
 18730 4815-EP-DO-AH-CLM-EPR.
 18731
 18732     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 18733         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 18734
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010S.cbl
 18735 4820-EP-DO-AH-CNCL.
 18736
 18737     IF CR-AH-STATUS-AT-CANCEL = ' '
 18738         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 18739            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 18740             GO TO 4899-EXIT
 18741         ELSE
 18742             GO TO 4830-EP-DO-AH-EP.
 18743
 18744     IF (DTE-CLIENT = 'DCC')
 18745        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 18746        IF CR-AHRFND NOT = ZEROS
 18747           ADD +1                TO WX-CNC-CNT
 18748        END-IF
 18749     ELSE
 18750        ADD +1                   TO WX-CNC-CNT
 18751     END-IF
 18752
 18753     MOVE WE-AHRFND TO CNC-PRM.
 18754
 18755     MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 18756     MOVE 'L'                   TO  DC-OPTION-CODE.
 18757     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18758     MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 18759
 18760     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 18761     MOVE 'L'                   TO  DC-OPTION-CODE.
 18762     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18763     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 18764
 18765     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 18766     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 18767     MOVE '1'                     TO  DC-OPTION-CODE.
 18768     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 18769     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 18770                                      DC-ODD-DAYS-OVER
 18771                                      DC-ELAPSED-DAYS.
 18772     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 18773     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 18774
 18775     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 18776         ADD  +1                  TO  MONTHS-DIFF-AH.
 18777
 18778     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 18779
 18780     IF DTE-CLIENT = 'ACE'
 18781         GO TO 4820-CONTINUE-AH-CANCEL.
 18782
 18783     MOVE  ZEROS                  TO  SUB.
 18784
 18785 4820-AH-CHARGEBACK-LOOP.
 18786
 18787     ADD    +1                    TO  SUB.
 18788
 18789     IF  SUB  GREATER THAN  +10
 18790         GO TO  4820-CONTINUE-AH-CANCEL.
 18791
 18792     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010S.cbl
 18793         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 18794         GO TO  4820-AH-CHARGEBACK-LOOP.
 18795
 18796     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 18797         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 18798
 18799     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 18800         OR (CR-AH-REFUND-TYPE = 'G')
 18801         OR (CR-AHRFND = ZEROS)
 18802         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 18803     END-IF
 18804
 18805     GO TO  4820-AH-CHARGEBACK-LOOP.
 18806
 18807
 18808 4820-CONTINUE-AH-CANCEL.
 18809
 18810     IF DTE-CLIENT = 'GIC'
 18811         IF REIN-EP-FLG NOT = 'R'  AND
 18812            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18813            MOVE CR-AHRFND-CALC TO CNC-PRM.
 18814
 18815     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 18816     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 18817
 18818     IF CR-AH-LUMP-SUM-DISAB
 18819         GO TO 4899-EXIT.
 18820
 18821     MOVE WE-AHAMT TO CNC-BEN.
 18822
 18823     GO TO 4899-EXIT.
 18824
 18825 4825-EP-DO-AH-CNCL-SUM.
 18826
 18827     IF WE-DSPY-AMT NOT = +0
 18828         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 18829         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 18830         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 18831         ADD +1             TO WX-CLM-CNT.
 18832
 18833     IF WE-AHRFND = ZERO
 18834        GO TO 4830-EP-DO-AH-EP.
 18835
 18836     MOVE WE-AHRFND TO CNC-PRM.
 18837
 18838     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 18839
 18840     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 18841
 18842     IF WE-AHRFND NOT LESS WE-AHPRM
 18843         MOVE WE-AHAMT TO CNC-BEN
 18844          GO TO 4830-EP-DO-AH-EP.
 18845
 18846     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 18847     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 18848     MOVE TEMP-7 TO CNC-BEN.
 18849
 18850 4830-EP-DO-AH-EP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010S.cbl
 18851
 18852     MOVE EOM-RUN-DATE TO VALUATION-DT.
 18853     MOVE '8'           TO W-VAL-SOURCE.
 18854
 18855     IF REIN-EP-FLG = 'R'
 18856       IF REIN-REM-SW (SUB5) = 'I'
 18857           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 18858           GO TO 4899-EXIT.
 18859
 18860     IF REIN-EP-FLG = 'R'
 18861         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 18862            EARNING-STOP-DATE LESS THAN VALUATION-DT
 18863             MOVE '*'               TO A-H-EARNED-SWITCH
 18864             MOVE EARNING-STOP-DATE TO VALUATION-DT
 18865             MOVE '10'              TO W-VAL-SOURCE.
 18866
 18867     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 18868
 18869     IF REM-TRM2 GREATER CR-AH-TERM
 18870         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18871         GO TO 4899-EXIT.
 18872
 18873     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 18874         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 18875*
 18876 4835-CHECK-OB-AH-NCL.
 18877
 18878     IF (DTE-CLIENT EQUAL 'NCL') AND
 18879        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 18880           MOVE WE-AHPRM         TO EPR-R78
 18881                                    EPR-PRO
 18882                                    EPR-ST
 18883        IF (CR-CCYY EQUAL EOM-CCYY) AND
 18884           (CR-MO EQUAL EOM-MO)
 18885           MOVE '*'            TO OB-DATE-1-SWITCH
 18886           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18887           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18888           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18889           COMPUTE WS-EPR-R78 (SUB3 1) =
 18890                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 18891           GO TO 4899-EXIT
 18892        ELSE
 18893        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 18894           (CR-MO EQUAL OB-MO (1))
 18895           MOVE '*'            TO OB-DATE-2-SWITCH
 18896           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18897           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18898           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 18899           COMPUTE WS-EPR-R78 (SUB3 2) =
 18900                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 18901           GO TO 4899-EXIT
 18902        ELSE
 18903        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 18904           (CR-MO EQUAL OB-MO (2))
 18905           MOVE '*'            TO OB-DATE-3-SWITCH
 18906           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 18907           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 18908           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010S.cbl
 18909           COMPUTE WS-EPR-R78 (SUB3 3) =
 18910                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 18911           GO TO 4899-EXIT
 18912        ELSE
 18913           GO TO 4899-EXIT.
 18914
 18915     IF REM-TRM2 NOT GREATER +0
 18916         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18917         GO TO 4899-EXIT.
 18918
 18919     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18920         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 18921         GO TO 4899-EXIT.
 18922
 18923     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 18924         MOVE +1 TO WX-ACTIVE-COUNT
 18925     ELSE
 18926         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 18927
 18928     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 18929     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 18930     IF DTE-R78 = '1'
 18931         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 18932     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 18933
 18934     IF DTE-CLIENT = 'MIC' OR 'MCC'
 18935         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 18936     ELSE
 18937         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 18938
 18939     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 18940     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 18941
 18942     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 18943     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 18944
 18945     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 18946
 18947*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 18948*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 18949
 18950     MOVE SPACES TO STATUTORY-SWITCH-AH.
 18951
 18952     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 18953        (CR-DT GREATER THAN  19921231)
 18954        AND (DTE-CLIENT NOT = 'DCC')
 18955         IF CR-AH-TERM GREATER THAN  +61
 18956             MOVE 'A' TO AH-EARN-METHOD
 18957             MOVE '*' TO STATUTORY-SWITCH-AH
 18958             GO TO 4845-EP-DO-AH-EP-AN
 18959         ELSE
 18960             GO TO 4860-EP-DO-AH-STATUTORY.
 18961
 18962     IF (AH-EARN-METHOD EQUAL 'N')
 18963                  OR
 18964        ((DTE-CLIENT = 'DCC')
 18965         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 18966         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010S.cbl
 18967         GO TO 4840-EP-DO-AH-EP-NP
 18968     END-IF
 18969
 18970     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 18971         MOVE 'A' TO AH-EARN-METHOD
 18972         GO TO 4845-EP-DO-AH-EP-AN.
 18973
 18974     GO TO 4860-EP-DO-AH-STATUTORY.
 18975
 18976 4840-EP-DO-AH-EP-NP.
 18977
 18978     IF WE-AHPRM = ZERO
 18979         GO TO 4860-EP-DO-AH-STATUTORY.
 18980
 18981     IF CR-APR GREATER THAN +0
 18982         NEXT SENTENCE
 18983     ELSE
 18984         GO TO 4860-EP-DO-AH-STATUTORY.
 18985
 18986     IF DTE-CLIENT = 'NCL'
 18987       IF CR-DT LESS THAN 19910101
 18988           GO TO 4860-EP-DO-AH-STATUTORY.
 18989
 18990     IF REM-TRM1 = CR-AH-TERM
 18991         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 18992         GO TO 4899-EXIT.
 18993
 18994     MOVE CR-APR TO NP-APR.
 18995     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 18996     MOVE REM-TRM1 TO NP-REM.
 18997     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 18998     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 18999         MOVE CR-LOAN-TERM TO NP-ORIG.
 19000
 19001     IF (DTE-CLIENT = 'DCC')
 19002        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 19003        MOVE 'S'                 TO NP-OPT
 19004*       DISPLAY ' MOVE S TO NPOPT '
 19005     ELSE
 19006        MOVE 'R'                 TO NP-OPT
 19007     END-IF
 19008
 19009
 19010*    MOVE 'R' TO NP-OPT.
 19011     CALL 'ECSNETRM'
 19012         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19013
 19014     IF (DTE-CLIENT = 'DCC')
 19015        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 19016        COMPUTE EPR-ST ROUNDED =
 19017           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19018*       DISPLAY ' COMPUTE EPRST  '
 19019        GO TO 4899-EXIT
 19020     ELSE
 19021        COMPUTE EPR-R78 ROUNDED =
 19022           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19023     END-IF
 19024
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010S.cbl
 19025     GO TO 4860-EP-DO-AH-STATUTORY.
 19026
 19027 4845-EP-DO-AH-EP-AN.
 19028     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19029     MOVE 'L'                        TO DC-OPTION-CODE.
 19030     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19031     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19032     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19033     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19034     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19035     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19036     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19037     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19038     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19039     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19040                                        CP-RATING-BENEFIT-AMT.
 19041     IF CP-STATE-STD-ABBRV = 'OR'
 19042         COMPUTE CP-RATING-BENEFIT-AMT =
 19043                                  CR-AHAMT * REM-TRM1.
 19044     MOVE CR-APR                     TO CP-LOAN-APR.
 19045     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19046     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19047     MOVE '3'                        TO CP-PROCESS-TYPE.
 19048     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19049     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19050     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19051         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19052     ELSE
 19053         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19054     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19055     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19056     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19057     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19058     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19059     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19060
 19061     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19062
 19063     IF CP-ERROR-RATE-NOT-FOUND  OR
 19064        CP-ERROR-RATE-IS-ZERO  OR
 19065        CP-ERROR-IN-DATES
 19066         GO TO 4860-EP-DO-AH-STATUTORY.
 19067
 19068     COMPUTE EPR-R78 ROUNDED =
 19069             ((REM-TRM1 * WE-AHAMT) / +100) *
 19070               CP-PREMIUM-RATE.
 19071
 19072     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19073
 19074     IF STATUTORY-REQUIREMENT-AH
 19075         MOVE EPR-R78                TO EPR-ST
 19076         GO TO 4899-EXIT.
 19077
 19078 4860-EP-DO-AH-STATUTORY.
 19079
 19080     IF (DTE-CLIENT = 'DCC')
 19081        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G')
 19082        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010S.cbl
 19083        MOVE EPR-R78             TO EPR-ST
 19084        GO TO 4899-EXIT
 19085     END-IF
 19086
 19087     MOVE EPR-R78                    TO EPR-ST.
 19088
 19089     MOVE +0                         TO SUB1.
 19090
 19091 4865-EP-AH-STAT-LOOP.
 19092     ADD +1 TO SUB1.
 19093
 19094     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 19095         MOVE EPR-PRO                TO EPR-ST
 19096     ELSE
 19097         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19098             GO TO 4865-EP-AH-STAT-LOOP.
 19099
 19100     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19101         CR-DT GREATER THAN 19831031)  OR
 19102
 19103        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19104         CR-DT GREATER THAN 19820629)  OR
 19105
 19106        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19107         CR-DT GREATER THAN 19830831)
 19108
 19109         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19110
 19111     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19112       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19113         IF CR-DT LESS THAN 19970101
 19114             MOVE EPR-R78            TO EPR-ST
 19115         ELSE
 19116             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19117
 19118     IF DTE-CLIENT = 'DCC'
 19119        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 19120           MOVE EPR-PRO          TO EPR-ST
 19121        ELSE
 19122           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 19123        END-IF
 19124     END-IF
 19125     .
 19126 4899-EXIT.
 19127     EXIT.
 19128******************************************************************
 19129***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 19130******************************************************************
 19131
 19132 4900-WRITE-SUMMARY-EXTRACTS.
 19133
 19134     IF DTE-CLIENT = 'HER'
 19135         IF EP-RECORD-ID = 'EC'  AND
 19136            EP-REINCO = 'LNL'
 19137             GO TO 4999-WRT-SUMMARY-X.
 19138
 19139     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 19140                                     WS-EP-RUN-DTE-N.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010S.cbl
 19141
 19142     IF W-UNDERWRITTEN-DATA
 19143         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
 19144     ELSE
 19145         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 19146
 19147     IF  DTE-OPT-RESERVE-METHOD-AUTH
 19148         IF VALID-EP-ID
 19149             MOVE 'Y'             TO EP-NEW-DATA-IND.
 19150
 19151     WRITE EP-RECORD.
 19152
 19153     ADD +1                       TO EP-CNT.
 19154
 19155 4999-WRT-SUMMARY-X.
 19156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010S.cbl
 19158******************************************************************
 19159***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 19160******************************************************************
 19161
 19162 5000-DATE-RANGE-BREAK.
 19163
 19164     IF NO-TRANSACTION-WAS-PROCESSED
 19165         GO TO 5099-DATE-RANGE-BREAK-X.
 19166
 19167     ADD +1  TO RANGE-CNT.
 19168     MOVE +1 TO SUB6.
 19169     MOVE +2 TO SUB7.
 19170     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19171     IF LN-CNT GREATER +50
 19172         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 19173                 8750-PRT-RANGE-HEADING.
 19174
 19175     MOVE SPACES                     TO PRT.
 19176     PERFORM 8800-PRINT-ROUTINE.
 19177     MOVE 'DATE RANGE'               TO TPH2-DESC.
 19178     MOVE '  TOTALS'                 TO TPH3-DESC.
 19179     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19180     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19181     PERFORM 5900-CLEAR-TOTAL-PAGES
 19182         THRU 5999-CLEAR-TOTAL-PAGES-X
 19183             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 19184
 19185 5099-DATE-RANGE-BREAK-X.
 19186     EXIT.
 19187
 19188 5100-ACCOUNT-BREAK.
 19189
 19190     IF RANGE-CNT NOT = +0
 19191         PERFORM 5000-DATE-RANGE-BREAK
 19192             THRU 5099-DATE-RANGE-BREAK-X
 19193     ELSE
 19194         MOVE +1 TO SUB6
 19195         MOVE +2 TO SUB7
 19196         PERFORM 5800-ADD-PAGES-LEVELS
 19197             THRU 5899-ADD-PAGES-LEVELS-X
 19198         PERFORM 5900-CLEAR-TOTAL-PAGES
 19199             THRU 5999-CLEAR-TOTAL-PAGES-X
 19200                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 19201
 19202     MOVE +0 TO RANGE-CNT.
 19203     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 19204         VARYING B-SUB FROM 1 BY 1
 19205             UNTIL B-SUB GREATER THAN 50  OR
 19206                   RB-COMPANY (B-SUB) = SPACES.
 19207     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 19208         VARYING B-SUB FROM 1 BY 1
 19209             UNTIL B-SUB GREATER THAN 50.
 19210
 19211     IF ACCT-FLG = SPACE
 19212         GO TO 5199-ACCOUNT-BREAK-X.
 19213
 19214     MOVE SPACE TO ACCT-FLG.
 19215     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010S.cbl
 19216     MOVE +3 TO SUB7.
 19217     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19218     IF LN-CNT GREATER +50
 19219         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 19220                 8725-PRT-ACCT-HEADING.
 19221
 19222     MOVE SPACES                     TO PRT.
 19223     PERFORM 8800-PRINT-ROUTINE.
 19224     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 19225     MOVE ' TOTALS'                  TO TPH3-DESC.
 19226     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19227     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19228     PERFORM 5900-CLEAR-TOTAL-PAGES
 19229         THRU 5999-CLEAR-TOTAL-PAGES-X
 19230             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 19231
 19232 5199-ACCOUNT-BREAK-X.
 19233     EXIT.
 19234
 19235 5200-STATE-BREAK.
 19236
 19237     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 19238     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 19239     MOVE +3 TO SUB6.
 19240     MOVE +4 TO SUB7.
 19241     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19242
 19243     IF STATE-FLG = SPACE
 19244         GO TO 5299-STATE-BREAK-X.
 19245
 19246     MOVE SPACE         TO STATE-FLG.
 19247     PERFORM 8700-PRINT-REPORT-HEADINGS.
 19248     MOVE 'STATE'       TO TPH1-TYPE.
 19249     MOVE HLD-STATE     TO STATE-L.
 19250
 19251     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 19252
 19253     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 19254         MOVE SPACES          TO TPH1-DESC
 19255         MOVE HLD-STATE       TO TPH1-ST-CODE
 19256         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 19257     ELSE
 19258         MOVE SPACES TO TPH1-DESC
 19259         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 19260         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 19261
 19262     MOVE 'STATE'  TO TPH2-DESC.
 19263     MOVE 'TOTALS' TO TPH3-DESC.
 19264     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19265     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19266     PERFORM 5900-CLEAR-TOTAL-PAGES
 19267         THRU 5999-CLEAR-TOTAL-PAGES-X
 19268             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 19269
 19270 5299-STATE-BREAK-X.
 19271     EXIT.
 19272
 19273 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010S.cbl
 19274
 19275     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 19276     MOVE +4 TO SUB6.
 19277     MOVE +5 TO SUB7.
 19278     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19279
 19280     IF COMP-FLG = SPACE
 19281         GO TO 5399-COMP-BREAK-X.
 19282
 19283     MOVE ' ' TO COMP-FLG.
 19284     PERFORM 8700-PRINT-REPORT-HEADINGS.
 19285     MOVE 'COMPANY'                   TO TPH1-TYPE.
 19286     MOVE HLD-GROUPING                TO TPH1-DESC.
 19287     MOVE 'COMPANY'                   TO TPH2-DESC.
 19288     MOVE ' TOTALS'                   TO TPH3-DESC.
 19289     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19290     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19291     PERFORM 5900-CLEAR-TOTAL-PAGES
 19292         THRU 5999-CLEAR-TOTAL-PAGES-X
 19293             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 19294
 19295 5399-COMP-BREAK-X.
 19296     EXIT.
 19297
 19298 5400-CARR-BREAK.
 19299
 19300     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 19301     MOVE +5 TO SUB6.
 19302     MOVE +6 TO SUB7.
 19303     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19304
 19305     IF CARR-FLG = SPACE
 19306         GO TO 5499-CARR-BREAK-X.
 19307
 19308     MOVE ' ' TO CARR-FLG.
 19309     PERFORM 8700-PRINT-REPORT-HEADINGS.
 19310     MOVE 'CARRIER'               TO TPH1-TYPE.
 19311     MOVE HLD-CARRIER             TO TPH1-DESC.
 19312     MOVE 'CARRIER'               TO TPH2-DESC.
 19313     MOVE ' TOTALS'               TO TPH3-DESC.
 19314     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19315     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19316     PERFORM 5900-CLEAR-TOTAL-PAGES
 19317         THRU 5999-CLEAR-TOTAL-PAGES-X
 19318             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 19319
 19320 5499-CARR-BREAK-X.
 19321     EXIT.
 19322
 19323 5500-FINAL-BREAK.
 19324
 19325     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 19326
 19327     IF FINAL-FLG = SPACE
 19328         GO TO 5599-FINAL-BREAK-X.
 19329
 19330     IF DTE-FICH = '1'
 19331         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010S.cbl
 19332     MOVE +6 TO SUB6.
 19333     PERFORM 8700-PRINT-REPORT-HEADINGS.
 19334     MOVE SPACES   TO TPH1-TYPE.
 19335     MOVE SPACES   TO TPH1-DESC.
 19336     MOVE 'FINAL'  TO TPH2-DESC.
 19337     MOVE 'TOTALS' TO TPH3-DESC.
 19338     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19339     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19340
 19341 5599-FINAL-BREAK-X.
 19342     EXIT.
 19343
 19344 5800-ADD-PAGES-LEVELS.
 19345
 19346     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 19347     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 19348     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 19349     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 19350     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 19351     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 19352     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 19353     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 19354
 19355 5899-ADD-PAGES-LEVELS-X.
 19356     EXIT.
 19357
 19358 5900-CLEAR-TOTAL-PAGES.
 19359
 19360     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 19361             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 19362             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 19363             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 19364
 19365 5999-CLEAR-TOTAL-PAGES-X.
 19366     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010S.cbl
 19368******************************************************************
 19369***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 19370******************************************************************
 19371
 19372 6000-TOTAL-PAGE-HEADINGS.
 19373
 19374     MOVE TOTAL-PAGE-HD1 TO PRT.
 19375     PERFORM 8800-PRINT-ROUTINE.
 19376
 19377 6100-ACCT-TOTAL-HEADINGS.
 19378
 19379     MOVE TOTAL-PAGE-HD2 TO PRT.
 19380     MOVE '0' TO P-CTL.
 19381     PERFORM 8800-PRINT-ROUTINE.
 19382     MOVE TOTAL-PAGE-HD3 TO PRT.
 19383     MOVE ' ' TO P-CTL.
 19384     PERFORM 8800-PRINT-ROUTINE.
 19385     PERFORM 8800-PRINT-ROUTINE.
 19386     MOVE +81 TO LN-CNT.
 19387
 19388 6199-PAGE-HEADINGS-X.
 19389     EXIT.
 19390
 19391 6500-PRINT-TOTAL-PAGE.
 19392
 19393     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 19394     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 19395     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 19396
 19397     IF SUB6 = 6 AND ME-DO-UPDATE
 19398         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 19399
 19400     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 19401
 19402     IF SUB6 = 6 AND ME-DO-UPDATE
 19403         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 19404
 19405     COMPUTE TPD-NET-PRM =
 19406         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 19407
 19408     IF SUB6 = 6 AND ME-DO-UPDATE
 19409         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 19410         GIVING ME-010-NET-L.
 19411
 19412     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 19413
 19414     IF SUB6 = 6 AND ME-DO-UPDATE
 19415         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 19416
 19417     COMPUTE TPD-PREM-COMP =
 19418         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 19419                            - TPL-ACCT-COM (SUB6).
 19420     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 19421
 19422     IF SUB6 = 6 AND ME-DO-UPDATE
 19423         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 19424
 19425     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010S.cbl
 19426         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 19427         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 19428         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 19429     END-IF.
 19430
 19431     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 19432     PERFORM 8800-PRINT-ROUTINE.
 19433     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 19434     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 19435     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 19436     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 19437
 19438     IF SUB6 = 6 AND ME-DO-UPDATE
 19439         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 19440         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 19441
 19442     COMPUTE TPD-NET-PRM =
 19443         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 19444
 19445     IF SUB6 = 6 AND ME-DO-UPDATE
 19446         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 19447         GIVING ME-010-NET-AH.
 19448
 19449     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 19450
 19451     IF SUB6 = 6 AND ME-DO-UPDATE
 19452         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 19453
 19454     COMPUTE TPD-PREM-COMP =
 19455         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 19456                            - TPA-ACCT-COM (SUB6).
 19457     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 19458
 19459     IF SUB6 = 6 AND ME-DO-UPDATE
 19460         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 19461
 19462     IF SUB6 = 6
 19463         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 19464         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 19465         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 19466     END-IF.
 19467
 19468     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 19469     PERFORM 8800-PRINT-ROUTINE.
 19470
 19471     MOVE 'TOTAL' TO TPD-DESC.
 19472
 19473     COMPUTE TPD-ISS-PRM =
 19474         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 19475
 19476     COMPUTE TPD-CNC-PRM =
 19477         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 19478
 19479     COMPUTE TPD-NET-PRM =
 19480         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 19481         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 19482
 19483     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010S.cbl
 19484         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 19485
 19486     COMPUTE TPD-PREM-COMP =
 19487         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 19488         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 19489         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 19490
 19491     COMPUTE TPD-CLAIMS =
 19492         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 19493
 19494     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 19495         NEXT SENTENCE
 19496     ELSE
 19497         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 19498         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 19499         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 19500*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 19501*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 19502*        MOVE ZEROS               TO SV-LO-CERT
 19503*                                    SV-HI-CERT.
 19504
 19505     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 19506     MOVE '0'                     TO P-CTL.
 19507     PERFORM 8800-PRINT-ROUTINE.
 19508     PERFORM 8800-PRINT-ROUTINE.
 19509
 19510 6599-TOTAL-PAGE-PRINT-X.
 19511     EXIT.
 19512*
 19513*
 19514*
 19515**START***********************************************************
 19516*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 19517*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 19518******************************************************************
 19519*
 19520 6650-GET-RES-STATE-COMM.
 19521*6650-BROWSE-FORWARD.
 19522
 19523     IF DTE-CLIENT NOT = 'DMD'
 19524         GO TO 6700-COMM-EXIT.
 19525
 19526     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 19527     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 19528     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 19529     MOVE CR-STATE            TO WS-ERRESC-STATE.
 19530     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 19531     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 19532     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 19533     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 19534
 19535     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 19536
 19537*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 19538*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 19539*VALUE OF PB-CERT-EFF-DT
 19540*
 19541     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010S.cbl
 19542
 19543     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 19544
 19545     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 19546         GO TO 6700-COMM-EXIT.
 19547
 19548*GET RECORD WHERE POSITIONED
 19549
 19550 6650-READ-ERRESC-NEXT.
 19551     READ ERRESC-IN NEXT RECORD.
 19552
 19553     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 19554         GO TO 6700-COMM-EXIT.
 19555
 19556*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 19557
 19558     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 19559        NEXT SENTENCE
 19560     ELSE
 19561         GO TO 6700-COMM-EXIT.
 19562
 19563     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 19564         NEXT SENTENCE
 19565     ELSE
 19566         GO TO 6650-READ-ERRESC-NEXT.
 19567
 19568*  CR-DT  = WS-YYYYMMDD-DT
 19569*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 19570*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 19571
 19572     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 19573         GO TO 6700-COMM-EXIT.
 19574
 19575* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 19576
 19577     MOVE ZEROS               TO WS-SUB WS-SUB1.
 19578
 19579     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 19580
 19581     IF WS-SUB1 IS GREATER THAN ZERO
 19582         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 19583             PERFORM 6680-SET-TABLE-CODE
 19584         ELSE
 19585             PERFORM 6680-SET-COMMISSION.
 19586
 19587     GO TO 6700-COMM-EXIT.
 19588
 19589 6680-SET-TABLE-CODE.
 19590     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 19591        MOVE ZEROS             TO WS-SUB1
 19592     ELSE
 19593* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 19594* TO COMPUTE AH COMMISSION.
 19595        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 19596        MOVE CR-AH-TERM        TO WS-COMM-TERM
 19597        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 19598        MOVE RESC-COMMISSION-TAB (WS-SUB)
 19599                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010S.cbl
 19600        PERFORM 6680-READ-CTBL-TABLE
 19601        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 19602           MOVE ZEROS          TO WS-SUB1.
 19603
 19604 6680-READ-CTBL-TABLE.
 19605*
 19606* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 19607* TO COMPUTE LIFE COMMISSION
 19608
 19609     IF CR-AHTYP = ZERO
 19610        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 19611        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 19612        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 19613
 19614     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 19615
 19616     IF ERCTBL-FILE-STATUS EQUAL '00'
 19617* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 19618        IF CR-AHTYP NOT = ZERO
 19619             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 19620             MOVE CR-AH-TERM        TO WS-COMM-TERM
 19621             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 19622             MOVE WK-RATE           TO WS-COMMISSION
 19623                                       PB-I-AH-COMMISSION
 19624        ELSE
 19625* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 19626             MOVE CR-LFAMT    TO COMM-CK-AMT
 19627             MOVE CR-LF-TERM  TO WS-COMM-TERM
 19628             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 19629             MOVE WK-RATE     TO WS-COMMISSION
 19630                                 PB-I-LIFE-COMMISSION.
 19631
 19632 6680-SET-COMMISSION.
 19633     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 19634           MOVE ZEROS         TO WS-SUB1
 19635       ELSE
 19636           MOVE RESC-COMMISSION-PER (WS-SUB)
 19637                              TO WS-COMMISSION WK-RATE
 19638           IF CR-AHTYP NOT = ZERO
 19639                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 19640           ELSE
 19641                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 19642
 19643 6680-SEARCH-CATEGORY.
 19644     ADD +1 TO WS-SUB.
 19645
 19646     IF WS-SUB IS GREATER THAN +12
 19647         GO TO 6680-EXIT.
 19648
 19649     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 19650          MOVE WS-SUB         TO WS-SUB1
 19651          GO TO 6680-EXIT.
 19652
 19653     GO TO 6680-SEARCH-CATEGORY.
 19654
 19655 6680-EXIT.
 19656     EXIT.
 19657
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010S.cbl
 19658 6700-COMM-EXIT.
 19659     EXIT.
 19660*
 19661*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 19662
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010S.cbl
 19664******************************************************************
 19665***         C L I E N T   B I L L I N G   R O U T I N E        ***
 19666******************************************************************
 19667
 19668 7000-CLIENT-BILLING-ROUTINE.
 19669*
 19670*
 19671* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 19672
 19673     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 19674                BC-G-ISS      BC-G-CNC   BC-G-CLM
 19675                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 19676                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 19677                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 19678                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 19679                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 19680
 19681 7099-BILL-X.
 19682     EXIT.
 19683
 19684
 19685 7500-ADD-UP-REIN-CO.
 19686
 19687     IF RB-COMPANY (B-SUB) NOT = SPACES
 19688         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 19689
 19690 7599-ADD-UP-REIN-X.
 19691     EXIT.
 19692
 19693 7900-CLEAR-BILLING-TABLE.
 19694
 19695     MOVE SPACES TO RB-COMPANY (B-SUB).
 19696     MOVE 0      TO RB-COUNT (B-SUB).
 19697
 19698 7999-CLEAR-BILLING-X.
 19699     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010S.cbl
 19701******************************************************************
 19702***         M I S C E L L A N E O U S   R O U T I N E S        ***
 19703******************************************************************
 19704
 19705 8000-DATE-CONVERT-ROUTINE.
 19706
 19707     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 19708
 19709 8099-DATE-CONVERT-X.
 19710     EXIT.
 19711
 19712 8000R-CONVERT-STOP-DATE.
 19713
 19714     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 19715     MOVE 'L'                     TO DC-OPTION-CODE.
 19716     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19717     MOVE +0                      TO DC-ELAPSED-MONTHS.
 19718     MOVE -1                      TO DC-ELAPSED-DAYS.
 19719     MOVE '6'                     TO DC-OPTION-CODE.
 19720     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19721     MOVE +0                      TO DC-ELAPSED-MONTHS
 19722                                     DC-ELAPSED-DAYS.
 19723     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 19724     MOVE ' '                     TO DC-OPTION-CODE.
 19725     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19726
 19727     IF NO-CONVERSION-ERROR
 19728         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 19729     ELSE
 19730         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 19731                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 19732                 '  STOP DATE: ' RWF-EP-STOP-DATE
 19733         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 19734                                  TO WS-ABEND-MESSAGE
 19735         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 19736         MOVE 4002                TO WS-ABEND-CODE
 19737         GO TO ABEND-PGM.
 19738
 19739 8099R-STOP-DATE-X.
 19740     EXIT.
 19741
 19742
 19743 8100-GET-RATE.
 19744
 19745     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 19746
 19747 8199-GET-RATE-X.
 19748     EXIT.
 19749
 19750
 19751 8200-STATE-CODE-LOOKUP.
 19752
 19753     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 19754        CLAS-INDEXS NOT = ZERO
 19755         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 19756             GO TO 8299-STATE-LOOKUP-X.
 19757
 19758     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010S.cbl
 19759
 19760 8250-STATE-LOOKUP-LOOP.
 19761
 19762     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 19763         MOVE 0302 TO WS-ABEND-CODE
 19764         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 19765         DISPLAY '******************************'
 19766         DISPLAY '***** ERROR LOCATION 022 *****'
 19767         DISPLAY '******************************'
 19768         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19769         GO TO ABEND-PGM.
 19770
 19771     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 19772         ADD +1 TO CLAS-INDEXS
 19773         GO TO 8250-STATE-LOOKUP-LOOP.
 19774
 19775 8299-STATE-LOOKUP-X.
 19776     EXIT.
 19777
 19778
 19779 8300-LIFE-TYPE-LOOKUP.
 19780
 19781     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 19782        CLAS-INDEXL NOT = ZERO
 19783         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 19784             GO TO 8399-LIFE-LOOKUP-X.
 19785
 19786     MOVE CLAS-STARTL TO CLAS-INDEXL.
 19787
 19788 8350-LIFE-LOOKUP-LOOP.
 19789
 19790     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 19791         MOVE 0401 TO WS-ABEND-CODE
 19792         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 19793         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 19794         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 19795         DISPLAY '******************************'
 19796         DISPLAY '***** ERROR LOCATION 023 *****'
 19797         DISPLAY '******************************'
 19798         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19799         IF DTE-CLIENT = 'NCL'
 19800                      OR 'CID'
 19801             MOVE CLAS-STARTL      TO CLAS-INDEXL
 19802             MOVE '05'             TO CLAS-LOOK
 19803             GO TO 8350-LIFE-LOOKUP-LOOP
 19804         ELSE
 19805             GO TO ABEND-PGM.
 19806
 19807     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 19808         ADD +1 TO CLAS-INDEXL
 19809         GO TO 8350-LIFE-LOOKUP-LOOP.
 19810
 19811     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 19812         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 19813
 19814 8399-LIFE-LOOKUP-X.
 19815     EXIT.
 19816
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010S.cbl
 19817
 19818 8400-A-H-TYPE-LOOKUP.
 19819
 19820     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 19821        CLAS-INDEXA NOT = ZERO
 19822         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 19823             GO TO 8499-A-H-LOOKUP-X.
 19824
 19825     MOVE CLAS-STARTA TO CLAS-INDEXA.
 19826
 19827 8450-A-H-LOOKUP-LOOP.
 19828
 19829     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 19830         MOVE 0402 TO WS-ABEND-CODE
 19831         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 19832         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 19833         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 19834         DISPLAY '******************************'
 19835         DISPLAY '***** ERROR LOCATION 024 *****'
 19836         DISPLAY '******************************'
 19837         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 19838         IF DTE-CLIENT = 'NCL'
 19839             MOVE CLAS-STARTA      TO CLAS-INDEXA
 19840             MOVE '05'             TO CLAS-LOOK
 19841             GO TO 8450-A-H-LOOKUP-LOOP
 19842         ELSE
 19843             GO TO ABEND-PGM.
 19844
 19845     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 19846         ADD +1 TO CLAS-INDEXA
 19847         GO TO 8450-A-H-LOOKUP-LOOP.
 19848
 19849 8499-A-H-LOOKUP-X.
 19850     EXIT.
 19851
 19852 8500-REMAINING-TERM-ROUTINE.
 19853
 19854     MOVE ZEROS                      TO CP-REMAINING-TERM
 19855                                        CP-REMAINING-TERM-1
 19856                                        CP-REMAINING-TERM-2
 19857                                        CP-REMAINING-TERM-3
 19858                                        CP-RETURN-CODE
 19859                                        CP-RETURN-CODE-2
 19860                                        REM-TRM1
 19861                                        REM-TRM2
 19862                                        REM-TRM3
 19863                                        TEM-TRM1.
 19864     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 19865
 19866     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19867     MOVE 'L'                        TO DC-OPTION-CODE.
 19868     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19869
 19870     IF  NO-CONVERSION-ERROR
 19871         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 19872     ELSE
 19873         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 19874                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010S.cbl
 19875         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 19876         MOVE 3001                   TO WS-ABEND-CODE
 19877         GO TO ABEND-PGM.
 19878
 19879     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 19880
 19881     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 19882         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 19883
 19884     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 19885         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 19886         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 19887                                        DC-ELAPSED-DAYS
 19888         MOVE '3'                    TO DC-OPTION-CODE
 19889         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19890                 8099-DATE-CONVERT-X
 19891         IF  NO-CONVERSION-ERROR
 19892             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 19893         ELSE
 19894             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 19895
 19896     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 19897         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 19898
 19899     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 19900         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 19901         MOVE +1                     TO DC-ELAPSED-MONTHS
 19902         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 19903         MOVE '6'                    TO DC-OPTION-CODE
 19904         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 19905                 8099-DATE-CONVERT-X
 19906         IF  NO-CONVERSION-ERROR
 19907             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 19908             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 19909         ELSE
 19910             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 19911                                     TO WS-ABEND-MESSAGE
 19912             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 19913             MOVE 3002               TO WS-ABEND-CODE
 19914             GO TO ABEND-PGM.
 19915
 19916     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 19917     MOVE 'L'                        TO DC-OPTION-CODE.
 19918     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19919
 19920     IF  NO-CONVERSION-ERROR
 19921         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 19922     ELSE
 19923         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 19924             W-VAL-ERROR (W-VAL-SOURCE)
 19925         DISPLAY '   KEY - ' CR-FULL-CONTROL
 19926             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 19927             DC-ERROR-CODE
 19928         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 19929         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 19930             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 19931             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 19932             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010S.cbl
 19933*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 19934*                                    TO WS-ABEND-MESSAGE
 19935*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 19936*        MOVE 3003                   TO WS-ABEND-CODE
 19937*        GO TO ABEND-PGM.
 19938
 19939     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19940     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19941     MOVE '3'                        TO CP-PROCESS-TYPE.
 19942     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19943     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19944     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19945
 19946*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 19947*                                    TO CP-REM-TERM-METHOD.
 19948
 19949     IF  DTE-CLIENT = 'FIM'
 19950         MOVE '5'                    TO CP-REM-TERM-METHOD.
 19951
 19952     IF DTE-CLIENT = 'FLI' OR 'FLU'
 19953         IF WE-LF-AH = AH-OVERRIDE-L1
 19954             MOVE '2'                TO CP-REM-TERM-METHOD
 19955         ELSE
 19956             IF CR-LFTYP = '01' OR '03'
 19957                 MOVE '4'            TO CP-REM-TERM-METHOD
 19958             ELSE
 19959                 IF CR-LFTYP = '02' OR '04'
 19960                     MOVE '2'        TO CP-REM-TERM-METHOD.
 19961
 19962     IF  DTE-CLIENT = 'CSL'
 19963         IF  CR-CARRIER = '2'
 19964             IF  CR-LFTYP = '07' OR  '08'
 19965                 MOVE '4'            TO CP-REM-TERM-METHOD.
 19966
 19967     IF  DTE-CLIENT = 'POS'
 19968         IF  CR-CARRIER = '1'
 19969             MOVE '1'                TO CP-REM-TERM-METHOD
 19970         ELSE
 19971             MOVE '2'                TO CP-REM-TERM-METHOD.
 19972
 19973     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 19974         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 19975
 19976     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 19977         GO TO 8540-CALC-REM-TERM-AH.
 19978
 19979 8520-CALC-REM-TERM-LIFE.
 19980
 19981     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 19982     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 19983     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 19984*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 19985     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 19986                                        CP-LOAN-TERM.
 19987
 19988     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 19989             AND
 19990         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010S.cbl
 19991         ADD +1                      TO CP-ORIGINAL-TERM
 19992                                        CP-LOAN-TERM.
 19993
 19994     IF  CP-TERM-IS-DAYS
 19995         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 19996     ELSE
 19997         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 19998
 19999     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20000
 20001     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20002         ADD +1                      TO W-ORGTRM-0-LF
 20003         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 20004             CR-FULL-CONTROL
 20005         GO TO 8599-REM-TERM-X.
 20006
 20007     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20008
 20009     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20010         ADD +1                      TO W-RET-CODE-LF
 20011         GO TO 8599-REM-TERM-X.
 20012*
 20013*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 20014*                                    TO WS-ABEND-MESSAGE
 20015*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20016*        MOVE 2002                   TO WS-ABEND-CODE
 20017*        GO TO ABEND-PGM.
 20018
 20019     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20020             AND
 20021         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 20022         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 20023         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 20024         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 20025
 20026     IF  CP-REMAINING-TERM-1 NEGATIVE
 20027         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 20028
 20029     IF  CP-REMAINING-TERM-2 NEGATIVE
 20030         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 20031
 20032     IF DTE-CLIENT = 'NCL'
 20033         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20034                                        CP-REMAINING-TERM-3.
 20035
 20036     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20037     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20038     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20039     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20040
 20041     GO TO 8599-REM-TERM-X.
 20042
 20043 8520-EXIT.
 20044     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010S.cbl
 20046 8540-CALC-REM-TERM-AH.
 20047
 20048     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 20049     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20050     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20051     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 20052                                        CP-LOAN-TERM.
 20053     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 20054
 20055     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20056
 20057     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20058         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 20059             CR-FULL-CONTROL
 20060         ADD +1                      TO W-ORGTRM-0-AH
 20061         GO TO 8599-REM-TERM-X.
 20062
 20063     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20064
 20065     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20066         ADD +1                      TO W-RET-CODE-AH
 20067         GO TO 8599-REM-TERM-X.
 20068*
 20069*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 20070*                                    TO WS-ABEND-MESSAGE
 20071*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20072*        MOVE 2001                   TO WS-ABEND-CODE
 20073*        GO TO ABEND-PGM.
 20074
 20075     IF DTE-CLIENT = 'NCL'
 20076         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20077                                        CP-REMAINING-TERM-3.
 20078
 20079     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20080     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20081     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20082     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20083
 20084 8599-REM-TERM-X.
 20085     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010S.cbl
 20087
 20088******************************************************************
 20089***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 20090******************************************************************
 20091
 20092 8600-DISPLAY-PRT.
 20093
 20094     IF  DIS-LINE-CNT GREATER THAN 59
 20095         PERFORM 8600-DISPLAY-HD THRU
 20096             8600-HD-EXIT.
 20097
 20098     ADD  1  TO DIS-LINE-CNT.
 20099     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 20100     MOVE  SPACES TO DISPLAY-REC
 20101                     DISPLAY-LINE.
 20102
 20103 8600-DISPLAY-EXIT.
 20104     EXIT.
 20105
 20106
 20107 8600-DISPLAY-HD.
 20108
 20109     MOVE '1'  TO  DISPLAY-CC.
 20110     MOVE ZEROS TO DIS-LINE-CNT.
 20111     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 20112     ADD +1 TO DIS-LINE-CNT.
 20113     MOVE ' '  TO  DISPLAY-CC.
 20114     MOVE SPACES TO DISPLAY-REC.
 20115     WRITE DISPLAY-REC.
 20116     ADD +1 TO DIS-LINE-CNT.
 20117     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 20118     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 20119     ADD +1 TO DIS-LINE-CNT.
 20120     MOVE SPACES TO DISPLAY-REC.
 20121     ADD +1 TO DIS-LINE-CNT.
 20122     WRITE DISPLAY-REC.
 20123
 20124 8600-HD-EXIT.
 20125     EXIT.
 20126
 20127******************************************************************
 20128***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 20129******************************************************************
 20130
 20131 8600-SETUP-DETAIL-LINE.
 20132
 20133     MOVE SPACES                TO TR-DTL2.
 20134
 20135     MOVE CR-CERT-NO            TO TRD-CERT.
 20136     MOVE CR-YR                 TO TRD-ISYR.
 20137     MOVE CR-MO                 TO TRD-ISMO.
 20138     MOVE CR-DA                 TO TRD-ISDA.
 20139     MOVE CR-AGE                TO TRD-AGE.
 20140
 20141 8689-SETUP-DETAIL-X.
 20142     EXIT.
 20143
 20144 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010S.cbl
 20145
 20146     IF LN-CNT GREATER THAN LN-MX
 20147         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20148                 8799-PRT-HEADINGS-X.
 20149     MOVE TRD-CERT TO SV-TRD-CERT.
 20150     MOVE TRD-ISDT TO SV-TRD-ISDT.
 20151
 20152     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 20153         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 20154
 20155     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 20156     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 20157     MOVE TR-DTL TO PRT.
 20158
 20159     IF NOT WS-CHANGE-REC
 20160         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 20161     ELSE
 20162         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 20163
 20164     PERFORM 8800-PRINT-ROUTINE.
 20165
 20166 8699-PRT-DETAIL-X.
 20167     EXIT.
 20168
 20169 8700-PRINT-REPORT-HEADINGS.
 20170     ADD +1 TO PG-CNT.
 20171     MOVE PG-CNT TO TR-PG.
 20172     MOVE +0 TO LN-CNT.
 20173     MOVE TR-HD-1 TO PRT.
 20174     PERFORM 8800-PRINT-ROUTINE.
 20175     MOVE TR-HD-2 TO PRT.
 20176     PERFORM 8800-PRINT-ROUTINE.
 20177     MOVE TR-HD-3 TO PRT.
 20178     PERFORM 8800-PRINT-ROUTINE.
 20179     ADD +1 TO LN-CNT.
 20180
 20181 8725-PRT-ACCT-HEADING.
 20182     MOVE TR-HD-4 TO PRT.
 20183     PERFORM 8800-PRINT-ROUTINE.
 20184     MOVE TR-HD-5 TO PRT.
 20185     PERFORM 8800-PRINT-ROUTINE.
 20186
 20187 8750-PRT-RANGE-HEADING.
 20188     MOVE TR-HD-6 TO PRT.
 20189     PERFORM 8800-PRINT-ROUTINE.
 20190
 20191 8775-PRT-COLUMN-HEADINGS.
 20192     MOVE TR-HD-7 TO PRT.
 20193     PERFORM 8800-PRINT-ROUTINE.
 20194     MOVE TR-HD-8 TO PRT.
 20195     PERFORM 8800-PRINT-ROUTINE.
 20196     MOVE TR-HD-9 TO PRT.
 20197     PERFORM 8800-PRINT-ROUTINE.
 20198     PERFORM 8800-PRINT-ROUTINE.
 20199
 20200 8799-PRT-HEADINGS-X.
 20201     EXIT.
 20202
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010S.cbl
 20203 8800-PRINT-ROUTINE.
 20204     MOVE P-CTL TO X.
 20205     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 20206     ADD +1 TO LN-CNT.
 20207     MOVE SPACES TO PRT.
 20208
 20209 8900-PRINT-A-LINE.
*20210                             COPY ELCPRT2.
 20211******************************************************************04/15/98
 20212*                                                                *ELCPRT2
 20213*                                                                *ELCPRT2
 20214*                            ELCPRT2                             *   LV005
 20215*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 20216*                            VMOD=2.002                          *   CL**5
 20217*                                                                *   CL**4
 20218******************************************************************   CL**4
 20219                                                                     CL**4
 20220     IF DTE-FICH NOT = SPACE AND                                     CL**4
 20221        FICH-OPEN    = SPACE                                         CL**4
 20222         MOVE 'X'                TO  FICH-OPEN                       CL**4
 20223         OPEN OUTPUT FICH.                                           CL**4
 20224                                                                     CL**4
 20225     IF DTE-FICH NOT = SPACE                                         CL**4
 20226         MOVE X                  TO  P-CTL                           CL**4
 20227         WRITE FICH-REC FROM PRT.                                    CL**4
 20228                                                                     CL**4
 20229     IF DTE-FICH = SPACE OR '2'                                      CL**4
 20230       MOVE X                    TO  P-CTL                           CL**4
 20231       IF P-CTL = ' '                                                CL**4
 20232         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 20233       ELSE                                                          CL**4
 20234         IF P-CTL = '0'                                              CL**4
 20235           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 20236         ELSE                                                        CL**4
 20237           IF P-CTL = '-'                                            CL**4
 20238             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 20239           ELSE                                                      CL**4
 20240             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 20241                                                                     CL**4
 20242******************************************************************   CL**4
 20243
 20244 8999-PRT-LINE-X.
 20245     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010S.cbl
 20247******************************************************************
 20248***          E N D   O F   J O B   P R O C E S S I N G         ***
 20249******************************************************************
 20250
 20251 9910-EOJ-1.
 20252     IF TR-CNT = ZERO
 20253         IF (DTE-PGM-OPT = '2' OR '3') OR
 20254            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 20255                          'ITY' OR 'DAC' OR 'FLC')
 20256             NEXT SENTENCE
 20257         ELSE
 20258             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 20259             MOVE 0703                    TO WS-ABEND-CODE
 20260             DISPLAY '******************************'
 20261             DISPLAY '***** ERROR LOCATION 025 *****'
 20262             DISPLAY '******************************'
 20263             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 20264             GO TO ABEND-PGM.
 20265
 20266     MOVE '*'         TO TRANS-EOF-FLAG.
 20267     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 20268
 20269     IF EOF-ON-CERT
 20270         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 20271         GO TO 9940-EOJ-FIN.
 20272
 20273     GO TO 0330-MATCH-PENDING-TO-CERT.
 20274
 20275 9920-EOJ-2.
 20276     MOVE '*'         TO CERT-EOF-FLAG.
 20277     MOVE HIGH-VALUES TO CIR-CONTROL.
 20278
 20279     IF EOF-ON-TRANS
 20280         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 20281         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 20282         GO TO 9940-EOJ-FIN.
 20283
 20284     GO TO 0299-READ-CERT-X.
 20285
 20286 9930-EOJ-3.
 20287     IF PROCESSING-COMPLETED
 20288         GO TO 9950-EOJ-FIN-GO.
 20289
 20290     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 20291     MOVE 'MISSING ACCOUNT MASTER'
 20292                               TO WS-ABEND-MESSAGE.
 20293     MOVE 0302                 TO WS-ABEND-CODE.
 20294     DISPLAY '******************************'
 20295     DISPLAY '***** ERROR LOCATION 026 *****'
 20296     DISPLAY '******************************'
 20297     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 20298     GO TO ABEND-PGM.
 20299
 20300 9940-EOJ-FIN.
 20301     MOVE '*'        TO PROCESSING-FLAG.
 20302     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 20303
 20304     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010S.cbl
 20305             0199-READ-ACCOUNT-X.
 20306     GO TO 9940-EOJ-FIN.
 20307
 20308 9950-EOJ-FIN-GO.
 20309     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 20310     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 20311*
 20312*
 20313* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 20314     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 20315
 20316 9960-NO-TOTS.
 20317
 20318     MOVE +15                    TO LN-CNT.
 20319     MOVE CMIN-CNT               TO TTL-PT-CNT.
 20320     IF ME-DO-UPDATE
 20321         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 20322
 20323     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 20324     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 20325     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 20326
 20327
 20328     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 20329     MOVE TR-TTL-HD              TO PRT.
 20330     PERFORM 8800-PRINT-ROUTINE.
 20331     ADD +1 TO LN-CNT.
 20332     MOVE TR-CNT                TO TTL-PT-CNT.
 20333     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 20334     MOVE TR-TTL-HD             TO PRT.
 20335     PERFORM 8800-PRINT-ROUTINE.
 20336     ADD +1 TO LN-CNT.
 20337
 20338     IF DUP-CNT = ZERO
 20339         GO TO 9969-CHECK-MISMATCHED-TOTS.
 20340
 20341     MOVE DUP-CNT                 TO TTL-PT-CNT.
 20342
 20343     IF ME-DO-UPDATE
 20344         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 20345
 20346     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 20347     MOVE TR-TTL-HD               TO PRT.
 20348     PERFORM 8800-PRINT-ROUTINE.
 20349     PERFORM 8800-PRINT-ROUTINE.
 20350     ADD +1 TO LN-CNT.
 20351
 20352     MOVE '1'                           TO  DTL-REC-TYPE.
 20353     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 20354     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 20355     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 20356                                        TO  DTL-CERT-OUT-CONTROL.
 20357     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 20358     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 20359     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 20360
 20361     MOVE +1 TO SUB3.
 20362 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010S.cbl
 20363
 20364     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 20365         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 20366         MOVE MISMATCH-PAGE-NUMBER
 20367                                 TO  TR-PG
 20368         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 20369         MOVE MR-CTL             TO  X
 20370         MOVE X TO LCP-ASA
 20371         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20372             THRU LCP-WRITE-END-MISMATCH-RPT
 20373         MOVE TR-HD-2            TO  MISMATCH-RPT
 20374         MOVE MR-CTL             TO  X
 20375         MOVE X TO LCP-ASA
 20376         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20377             THRU LCP-WRITE-END-MISMATCH-RPT
 20378         MOVE TR-HD-3            TO  MISMATCH-RPT
 20379         MOVE MR-CTL             TO  X
 20380         MOVE X TO LCP-ASA
 20381         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20382             THRU LCP-WRITE-END-MISMATCH-RPT
 20383         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 20384         MOVE MR-CTL             TO  X
 20385         MOVE X TO LCP-ASA
 20386         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20387             THRU LCP-WRITE-END-MISMATCH-RPT
 20388         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 20389
 20390     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 20391
 20392     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 20393     MOVE MR-CTL                        TO  X.
 20394     ADD +2                             TO  MISMATCH-LINE-COUNT.
 20395
 20396     MOVE X TO LCP-ASA
 20397     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20398         THRU LCP-WRITE-END-MISMATCH-RPT.
 20399
 20400     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 20401     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 20402
 20403     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 20404     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 20405
 20406     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 20407     IF  DUPE-STATUS (SUB3)  =  '2'
 20408         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 20409     IF  DUPE-STATUS (SUB3)  =  '5'
 20410         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 20411     IF  DUPE-STATUS (SUB3)  =  'M'
 20412         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 20413     IF  DUPE-STATUS (SUB3)  =  '9'
 20414         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 20415     IF  DUPE-STATUS (SUB3)  =  'D'
 20416         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 20417     IF  DUPE-STATUS (SUB3)  =  'V'
 20418         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 20419     IF  DUPE-STATUS (SUB3)  =  'P'
 20420         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010S.cbl
 20421
 20422     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20423     MOVE MR-CTL                        TO  X.
 20424     ADD +1                             TO  MISMATCH-LINE-COUNT.
 20425
 20426     MOVE X TO LCP-ASA
 20427     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20428         THRU LCP-WRITE-END-MISMATCH-RPT.
 20429
 20430     IF SUB3 LESS THAN DUP-CNT
 20431         ADD +1 TO SUB3
 20432         GO TO 9965-PRT-DUPES.
 20433
 20434 9969-CHECK-MISMATCHED-TOTS.
 20435
 20436     IF W-MM-LF-PRM = ZEROS  AND
 20437        W-MM-AH-PRM = ZEROS  AND
 20438        W-MM-LF-RFD = ZEROS  AND
 20439        W-MM-AH-RFD = ZEROS  AND
 20440        W-MM-LF-CLM = ZEROS  AND
 20441        W-MM-AH-CLM = ZEROS
 20442         GO TO 9970-FIN-TOTS.
 20443
 20444     MOVE SPACES                        TO  MISMATCH-RPT.
 20445     MOVE '0'                           TO  MR-CTL  X.
 20446     MOVE X TO LCP-ASA
 20447     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20448         THRU LCP-WRITE-END-MISMATCH-RPT.
 20449
 20450     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 20451     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 20452     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 20453
 20454     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 20455     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 20456     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 20457
 20458     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20459     MOVE '0'                           TO  MR-CTL  X.
 20460     MOVE X TO LCP-ASA
 20461     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20462         THRU LCP-WRITE-END-MISMATCH-RPT.
 20463
 20464     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 20465     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 20466     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 20467
 20468     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 20469     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 20470     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 20471
 20472     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20473     MOVE '0'                           TO  MR-CTL  X.
 20474     MOVE X TO LCP-ASA
 20475     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20476         THRU LCP-WRITE-END-MISMATCH-RPT.
 20477
 20478     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010S.cbl
 20479     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 20480     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 20481
 20482     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 20483     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 20484     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 20485
 20486     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 20487     MOVE '0'                           TO  MR-CTL  X.
 20488     MOVE X TO LCP-ASA
 20489     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 20490         THRU LCP-WRITE-END-MISMATCH-RPT.
 20491
 20492 9970-FIN-TOTS.
 20493
 20494     MOVE CMOT-CNT                TO TTL-PT-CNT.
 20495
 20496     IF ME-DO-UPDATE
 20497         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 20498
 20499     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 20500     MOVE TR-TTL-HD               TO PRT.
 20501     PERFORM 8800-PRINT-ROUTINE.
 20502
 20503     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 20504     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 20505     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 20506     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 20507
 20508     MOVE DE-CNT                  TO TTL-PT-CNT.
 20509     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 20510     MOVE TR-TTL-HD               TO PRT.
 20511     PERFORM 8800-PRINT-ROUTINE.
 20512
 20513     MOVE EP-CNT                  TO TTL-PT-CNT.
 20514     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 20515     MOVE TR-TTL-HD               TO PRT.
 20516     PERFORM 8800-PRINT-ROUTINE.
 20517     PERFORM 8800-PRINT-ROUTINE.
 20518
 20519     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 20520     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 20521     MOVE TR-TTL-HD               TO PRT.
 20522     PERFORM 8800-PRINT-ROUTINE.
 20523
 20524     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 20525     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 20526     MOVE TR-TTL-HD               TO PRT.
 20527     PERFORM 8800-PRINT-ROUTINE.
 20528
 20529     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 20530     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 20531     MOVE TR-TTL-HD               TO PRT.
 20532     PERFORM 8800-PRINT-ROUTINE.
 20533
 20534     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 20535         GO TO 9990-FINAL-CLOSE.
 20536
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010S.cbl
 20537**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 20538**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 20539**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 20540**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 20541
 20542     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 20543     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 20544     MOVE TR-TTL-HD               TO PRT.
 20545     PERFORM 8800-PRINT-ROUTINE.
 20546
 20547     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 20548     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 20549     MOVE TR-TTL-HD               TO PRT.
 20550     PERFORM 8800-PRINT-ROUTINE.
 20551
 20552     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 20553     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 20554     MOVE TR-TTL-HD               TO PRT.
 20555     PERFORM 8800-PRINT-ROUTINE.
 20556
 20557     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 20558     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 20559     MOVE TR-TTL-HD               TO PRT.
 20560     PERFORM 8800-PRINT-ROUTINE.
 20561
 20562     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 20563     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 20564     MOVE TR-TTL-HD               TO PRT.
 20565     PERFORM 8800-PRINT-ROUTINE.
 20566
 20567     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 20568     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 20569     MOVE TR-TTL-HD               TO PRT.
 20570     PERFORM 8800-PRINT-ROUTINE.
 20571
 20572     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 20573     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 20574     MOVE TR-TTL-HD               TO PRT.
 20575     PERFORM 8800-PRINT-ROUTINE.
 20576
 20577     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 20578     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 20579     MOVE TR-TTL-HD               TO PRT.
 20580     PERFORM 8800-PRINT-ROUTINE.
 20581
 20582     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 20583     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 20584     MOVE TR-TTL-HD               TO PRT.
 20585     PERFORM 8800-PRINT-ROUTINE.
 20586
 20587     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 20588     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 20589     MOVE TR-TTL-HD               TO PRT.
 20590     PERFORM 8800-PRINT-ROUTINE.
 20591
 20592     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 20593     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 20594     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010S.cbl
 20595     PERFORM 8800-PRINT-ROUTINE.
 20596
 20597     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 20598     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 20599     MOVE TR-TTL-HD               TO PRT.
 20600     PERFORM 8800-PRINT-ROUTINE.
 20601
 20602     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 20603     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 20604     MOVE TR-TTL-HD               TO PRT.
 20605     PERFORM 8800-PRINT-ROUTINE.
 20606
 20607     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 20608     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 20609     MOVE TR-TTL-HD               TO PRT.
 20610     PERFORM 8800-PRINT-ROUTINE.
 20611
 20612     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 20613     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 20614     MOVE TR-TTL-HD               TO PRT.
 20615     PERFORM 8800-PRINT-ROUTINE.
 20616
 20617     MOVE W-AH-REIN               TO TTL-PT-CNT.
 20618     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 20619     MOVE TR-TTL-HD               TO PRT.
 20620     PERFORM 8800-PRINT-ROUTINE.
 20621
 20622     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 20623     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 20624     MOVE TR-TTL-HD               TO PRT.
 20625     PERFORM 8800-PRINT-ROUTINE.
 20626
 20627     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 20628     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 20629     MOVE TR-TTL-HD               TO PRT.
 20630     PERFORM 8800-PRINT-ROUTINE.
 20631
 20632     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 20633     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 20634     MOVE TR-TTL-HD               TO PRT.
 20635     PERFORM 8800-PRINT-ROUTINE.
 20636
 20637     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 20638     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 20639     MOVE TR-TTL-HD               TO PRT.
 20640     PERFORM 8800-PRINT-ROUTINE.
 20641
 20642     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 20643     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 20644     MOVE TR-TTL-HD               TO PRT.
 20645     PERFORM 8800-PRINT-ROUTINE.
 20646
 20647     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 20648     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 20649     MOVE TR-TTL-HD               TO PRT.
 20650     PERFORM 8800-PRINT-ROUTINE.
 20651
 20652     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010S.cbl
 20653     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 20654     MOVE TR-TTL-HD               TO PRT.
 20655     PERFORM 8800-PRINT-ROUTINE.
 20656
 20657     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 20658     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 20659     MOVE TR-TTL-HD               TO PRT.
 20660     PERFORM 8800-PRINT-ROUTINE.
 20661
 20662     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 20663     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 20664     MOVE TR-TTL-HD               TO PRT.
 20665     PERFORM 8800-PRINT-ROUTINE.
 20666
 20667     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 20668     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 20669     MOVE TR-TTL-HD               TO PRT.
 20670     PERFORM 8800-PRINT-ROUTINE.
 20671
 20672     MOVE W-LF-REIN               TO TTL-PT-CNT.
 20673     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 20674     MOVE TR-TTL-HD               TO PRT.
 20675     PERFORM 8800-PRINT-ROUTINE.
 20676
 20677     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 20678     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 20679     MOVE TR-TTL-HD               TO PRT.
 20680     PERFORM 8800-PRINT-ROUTINE.
 20681
 20682     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 20683     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 20684     MOVE TR-TTL-HD               TO PRT.
 20685     PERFORM 8800-PRINT-ROUTINE.
 20686
 20687     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 20688     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 20689     MOVE TR-TTL-HD               TO PRT.
 20690     PERFORM 8800-PRINT-ROUTINE.
 20691
 20692     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 20693     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 20694     MOVE TR-TTL-HD               TO PRT.
 20695     PERFORM 8800-PRINT-ROUTINE.
 20696
 20697     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 20698     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 20699     MOVE TR-TTL-HD               TO PRT.
 20700     PERFORM 8800-PRINT-ROUTINE.
 20701
 20702     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 20703     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 20704     MOVE TR-TTL-HD               TO PRT.
 20705     PERFORM 8800-PRINT-ROUTINE.
 20706
 20707     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 20708     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 20709     MOVE TR-TTL-HD               TO PRT.
 20710     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010S.cbl
 20711
 20712     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 20713     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 20714     MOVE TR-TTL-HD               TO PRT.
 20715     PERFORM 8800-PRINT-ROUTINE.
 20716
 20717     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 20718     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 20719     MOVE TR-TTL-HD               TO PRT.
 20720     PERFORM 8800-PRINT-ROUTINE.
 20721
 20722     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 20723     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 20724     MOVE TR-TTL-HD               TO PRT.
 20725     PERFORM 8800-PRINT-ROUTINE.
 20726
 20727     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 20728     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 20729     MOVE TR-TTL-HD               TO PRT.
 20730     PERFORM 8800-PRINT-ROUTINE.
 20731
 20732     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 20733     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 20734     MOVE TR-TTL-HD               TO PRT.
 20735     PERFORM 8800-PRINT-ROUTINE.
 20736
 20737     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 20738     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 20739                                  TO TTL-HD-DS.
 20740     MOVE TR-TTL-HD               TO PRT.
 20741     PERFORM 8800-PRINT-ROUTINE.
 20742
 20743     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 20744     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 20745                                  TO TTL-HD-DS.
 20746     MOVE TR-TTL-HD               TO PRT.
 20747     PERFORM 8800-PRINT-ROUTINE.
 20748
 20749     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 20750     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 20751                                  TO TTL-HD-DS.
 20752     MOVE TR-TTL-HD               TO PRT.
 20753     PERFORM 8800-PRINT-ROUTINE.
 20754
 20755     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 20756     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 20757                                  TO TTL-HD-DS.
 20758     MOVE TR-TTL-HD               TO PRT.
 20759     PERFORM 8800-PRINT-ROUTINE.
 20760
 20761     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 20762     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 20763                                  TO TTL-HD-DS.
 20764     MOVE TR-TTL-HD               TO PRT.
 20765     PERFORM 8800-PRINT-ROUTINE.
 20766
 20767     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 20768     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010S.cbl
 20769                                  TO TTL-HD-DS.
 20770     MOVE TR-TTL-HD               TO PRT.
 20771     PERFORM 8800-PRINT-ROUTINE.
 20772
 20773     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 20774     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 20775     MOVE TR-TTL-HD               TO PRT.
 20776     PERFORM 8800-PRINT-ROUTINE.
 20777
 20778     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 20779     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 20780     MOVE TR-TTL-HD               TO PRT.
 20781     PERFORM 8800-PRINT-ROUTINE.
 20782
 20783     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 20784     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 20785     MOVE TR-TTL-HD               TO PRT.
 20786     PERFORM 8800-PRINT-ROUTINE.
 20787
 20788     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 20789     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 20790     MOVE TR-TTL-HD               TO PRT.
 20791     PERFORM 8800-PRINT-ROUTINE.
 20792
 20793     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 20794     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 20795     MOVE TR-TTL-HD               TO PRT.
 20796     PERFORM 8800-PRINT-ROUTINE.
 20797
 20798     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 20799     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 20800     MOVE TR-TTL-HD               TO PRT.
 20801     PERFORM 8800-PRINT-ROUTINE.
 20802
 20803     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 20804     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 20805     MOVE TR-TTL-HD               TO PRT.
 20806     PERFORM 8800-PRINT-ROUTINE.
 20807
 20808     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 20809     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 20810     MOVE TR-TTL-HD               TO PRT.
 20811     PERFORM 8800-PRINT-ROUTINE.
 20812
 20813     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 20814     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 20815     MOVE TR-TTL-HD               TO PRT.
 20816     PERFORM 8800-PRINT-ROUTINE.
 20817
 20818     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 20819     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 20820     MOVE TR-TTL-HD               TO PRT.
 20821     PERFORM 8800-PRINT-ROUTINE.
 20822
 20823     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 20824     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 20825     MOVE TR-TTL-HD               TO PRT.
 20826     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010S.cbl
 20827
 20828     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 20829     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 20830     MOVE TR-TTL-HD               TO PRT.
 20831     PERFORM 8800-PRINT-ROUTINE.
 20832
 20833     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 20834     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 20835     MOVE TR-TTL-HD               TO PRT.
 20836     PERFORM 8800-PRINT-ROUTINE.
 20837
 20838     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 20839     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 20840     MOVE TR-TTL-HD               TO PRT.
 20841     PERFORM 8800-PRINT-ROUTINE.
 20842
 20843     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 20844     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 20845     MOVE TR-TTL-HD               TO PRT.
 20846     PERFORM 8800-PRINT-ROUTINE.
 20847
 20848     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 20849     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 20850     MOVE TR-TTL-HD               TO PRT.
 20851     PERFORM 8800-PRINT-ROUTINE.
 20852
 20853     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 20854     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 20855     MOVE TR-TTL-HD               TO PRT.
 20856     PERFORM 8800-PRINT-ROUTINE.
 20857
 20858     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 20859     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 20860     MOVE TR-TTL-HD               TO PRT.
 20861     PERFORM 8800-PRINT-ROUTINE.
 20862
 20863     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 20864     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 20865     MOVE TR-TTL-HD               TO PRT.
 20866     PERFORM 8800-PRINT-ROUTINE.
 20867
 20868     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 20869     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 20870     MOVE TR-TTL-HD               TO PRT.
 20871     PERFORM 8800-PRINT-ROUTINE.
 20872
 20873     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 20874     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 20875     MOVE TR-TTL-HD               TO PRT.
 20876     PERFORM 8800-PRINT-ROUTINE.
 20877
 20878     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 20879     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 20880     MOVE TR-TTL-HD               TO PRT.
 20881     PERFORM 8800-PRINT-ROUTINE.
 20882
 20883     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 20884     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010S.cbl
 20885     MOVE TR-TTL-HD               TO PRT.
 20886     PERFORM 8800-PRINT-ROUTINE.
 20887
 20888     MOVE W-1-EP                  TO TTL-PT-CNT.
 20889     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 20890     MOVE TR-TTL-HD               TO PRT.
 20891     PERFORM 8800-PRINT-ROUTINE.
 20892
 20893     MOVE W-P-EP                  TO TTL-PT-CNT.
 20894     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 20895     MOVE TR-TTL-HD               TO PRT.
 20896     PERFORM 8800-PRINT-ROUTINE.
 20897
 20898     MOVE W-M-EP                  TO TTL-PT-CNT.
 20899     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 20900     MOVE TR-TTL-HD               TO PRT.
 20901     PERFORM 8800-PRINT-ROUTINE.
 20902
 20903     MOVE W-R-EP                  TO TTL-PT-CNT.
 20904     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 20905     MOVE TR-TTL-HD               TO PRT.
 20906     PERFORM 8800-PRINT-ROUTINE.
 20907
 20908     MOVE W-WY-EP                 TO TTL-PT-CNT.
 20909     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 20910     MOVE TR-TTL-HD               TO PRT.
 20911     PERFORM 8800-PRINT-ROUTINE.
 20912
 20913     MOVE W-VA-EP                 TO TTL-PT-CNT.
 20914     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 20915     MOVE TR-TTL-HD               TO PRT.
 20916     PERFORM 8800-PRINT-ROUTINE.
 20917
 20918     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 20919     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 20920     MOVE TR-TTL-HD               TO PRT.
 20921     PERFORM 8800-PRINT-ROUTINE.
 20922
 20923     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 20924     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20925     MOVE TR-TTL-HD               TO PRT.
 20926     PERFORM 8800-PRINT-ROUTINE.
 20927
 20928     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 20929     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20930     MOVE TR-TTL-HD               TO PRT.
 20931     PERFORM 8800-PRINT-ROUTINE.
 20932
 20933     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 20934     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20935     MOVE TR-TTL-HD               TO PRT.
 20936     PERFORM 8800-PRINT-ROUTINE.
 20937
 20938     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 20939     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 20940     MOVE TR-TTL-HD               TO PRT.
 20941     PERFORM 8800-PRINT-ROUTINE.
 20942
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010S.cbl
 20943     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 20944     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 20945     MOVE TR-TTL-HD               TO PRT.
 20946     PERFORM 8800-PRINT-ROUTINE.
 20947
 20948     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 20949     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 20950     MOVE TR-TTL-HD               TO PRT.
 20951     PERFORM 8800-PRINT-ROUTINE.
 20952
 20953     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 20954     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 20955     MOVE TR-TTL-HD               TO PRT.
 20956     PERFORM 8800-PRINT-ROUTINE.
 20957
 20958     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 20959     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 20960     MOVE TR-TTL-HD               TO PRT.
 20961     PERFORM 8800-PRINT-ROUTINE.
 20962
 20963 9990-FINAL-CLOSE.
*20964                             COPY ELCPRTC.
 20965******************************************************************04/15/98
 20966*                                                                *ELCPRTC
 20967*                                                                *ELCPRTC
 20968*                            ELCPRTC.                            *   LV003
 20969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 20970*                            VMOD=2.002                          *   CL**2
 20971*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 20972*                                                                *ELCPRTC
 20973* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 20974******************************************************************ELCPRTC
 20975                                                                  ELCPRTC
 20976      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 20977          CLOSE FICH.                                             ELCPRTC
 20978                                                                  ELCPRTC
 20979******************************************************************ELCPRTC
 20980
 20981     IF DTE-CLIENT = 'DMD'
 20982         CLOSE ERRESC-IN.
 20983
 20984     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 20985
 20986     DISPLAY ' '.
 20987     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 20988     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 20989     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 20990     DISPLAY ' '.
 20991
 20992     MOVE    ' DISPLAY ERROR COUNT = '
 20993       TO  DIS-LINE-REASON.
 20994     MOVE  ERROR-COUNT
 20995       TO  DIS-LINE-REC.
 20996         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 20997
 20998     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 20999           DISPLAY-PRT
 21000           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010S.cbl
 21001           ME50-ECS010-BALANCE
 21002           PENDING-EXTRACT  SUMMARY-EXTR.
 21003
 21004     IF DTE-PGM-OPT = '1'
 21005         CLOSE CERT-MASTER-OUT
 21006               DETAIL-EXTR.
 21007
 21008     IF ERACCTT-FILE-STATUS NOT = '00'
 21009         MOVE '12'                TO ABEND-CODE-1
 21010         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 21011         DISPLAY '******************************'
 21012         DISPLAY '***** ERROR LOCATION 027 *****'
 21013         DISPLAY '******************************'
 21014         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21015           GO TO ABEND-PGM.
 21016
 21017     IF COMM-OPEN-SW = 'X'
 21018         CLOSE ERCTBL
 21019         IF ERCTBL-FILE-STATUS NOT = '00'
 21020             MOVE '42'               TO ABEND-CODE-1
 21021             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 21022             DISPLAY '******************************'
 21023             DISPLAY '***** ERROR LOCATION 028 *****'
 21024             DISPLAY '******************************'
 21025             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21026             GO TO ABEND-PGM.
 21027
 21028     IF REIN-OPEN-SW = 'X'
 21029         CLOSE ERRTBL-IN
 21030         IF ERRTBL-FILE-STATUS NOT = '00'
 21031             MOVE '22'               TO ABEND-CODE-1
 21032             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 21033             DISPLAY '******************************'
 21034             DISPLAY '***** ERROR LOCATION 029 *****'
 21035             DISPLAY '******************************'
 21036             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21037             GO TO ABEND-PGM.
 21038
 21039     MOVE 'C'                         TO CP-IO-FUNCTION.
 21040     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21041     IF IO-ERROR
 21042         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 21043                                      TO WS-ABEND-MESSAGE
 21044         MOVE 0302                    TO WS-RETURN-CODE
 21045         DISPLAY '******************************'
 21046         DISPLAY '***** ERROR LOCATION 030 *****'
 21047         DISPLAY '******************************'
 21048         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21049         GO TO ABEND-PGM.
 21050
 21051     IF ME-DO-UPDATE
 21052           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 275)**
**    Operand ME-010-START is not declared
 21053           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 21054           ACCEPT WS-TIME-OF-DAY   FROM TIME
 21055           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 414)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010S.cbl
**    Operand ME-010-END is not declared
 21056           ADD 1 TO ME-010-RUN-CT
 21057           REWRITE MONTH-END-BALANCES
 21058           DISPLAY 'MONTH-END BALANCES POSTED'
 21059           CLOSE ERMEBL-INOUT
 21060     ELSE
 21061         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 21062
 21063     GO TO 9999-END-THE-JOB.
 21064
 21065 CERT-DATE-LOAD.
*21066     COPY ELCCRTM1.
 21067******************************************************************04/15/98
 21068*                                                                *ELCCRTM1
 21069*                                                                *ELCCRTM1
 21070*                            ELCCRTM1                            *   LV003
 21071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21072*                            VMOD=2.001                          *ELCCRTM1
 21073*                                                                *ELCCRTM1
 21074*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 21075*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 21076*                                                                *ELCCRTM1
 21077******************************************************************ELCCRTM1
 21078     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 21079     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 21080     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 21081     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 21082     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 21083     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 21084     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 21085     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 21086     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 21087                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 21088     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 21089                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 21090     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 21091     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 21092     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 21093     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 21094     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 21095     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 21096           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 21097                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 21098     END-PERFORM.                                                 ELCCRTM1
 21099                                                                  ELCCRTM1
 21100
 21101 EXTRACT-DATE-LOAD.
*21102     COPY ELCEXTM1.
 21103******************************************************************04/15/98
 21104*                                                                *ELCEXTM1
 21105*                                                                *ELCEXTM1
 21106*                            ELCEXTM1                            *   LV010
 21107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 21108*                            VMOD=2.001                          *ELCEXTM1
 21109*                                                                *ELCEXTM1
 21110*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 21111*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 21112*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 21113******************************************************************ELCEXTM1
 21114                                                                  ELCEXTM1
 21115     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 21116     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 21117     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 21118     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 21119     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 21120     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 21121                                                                     CL**9
 21122     EVALUATE TRUE                                                   CL**5
 21123        WHEN DE-ISSUE      OR                                        CL**8
 21124             DE-RC-ISSUE   OR                                        CL**8
 21125             DE-RR-RC-ISS  OR                                        CL**8
 21126             DE-CANCEL     OR                                        CL**8
 21127             DE-RC-CANCEL  OR                                        CL**8
 21128             DE-RR-RC-CNC                                            CL**8
 21129           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 21130                                                                     CL**9
 21131        WHEN DE-CLAIM      OR                                        CL**8
 21132             DE-RR-RC-CLM                                            CL**6
 21133           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 21134           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 21135           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 21136           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 21137           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 21138           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 21139                                                                     CL**9
 21140        WHEN DE-RESERVE                                              CL**9
 21141           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 21142           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 21143           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 21144                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 21145           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 21146                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 21147           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 21148     END-EVALUATE.                                                   CL**9
 21149                                                                     CL**9
 21150
 21151 EXTRACT-DATE-RELOAD.
*21152     COPY ELCEXTM2.
 21153******************************************************************04/15/98
 21154*                                                                *ELCEXTM2
 21155*                                                                *ELCEXTM2
 21156*                            ELCEXTM2                            *   LV011
 21157*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 21158*                            VMOD=2.001                          *ELCEXTM2
 21159*                                                                *ELCEXTM2
 21160*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 21161*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 21162*                                                                *   CL**9
 21163******************************************************************ELCEXTM2
 21164                                                                  ELCEXTM2
 21165     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 21166     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 21167     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 21168     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 21169     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 21170     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010S.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 21171                                                                     CL*10
 21172     EVALUATE TRUE                                                   CL*10
 21173        WHEN DE-ISSUE      OR                                        CL*10
 21174             DE-RC-ISSUE   OR                                        CL*10
 21175             DE-RR-RC-ISS  OR                                        CL*10
 21176             DE-CANCEL     OR                                        CL*10
 21177             DE-RC-CANCEL  OR                                        CL*10
 21178             DE-RR-RC-CNC                                            CL*10
 21179           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 21180                                                                     CL*10
 21181        WHEN DE-CLAIM      OR                                        CL*10
 21182             DE-RR-RC-CLM                                            CL**7
 21183           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 21184           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 21185           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 21186           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 21187           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 21188           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 21189                                                                     CL*10
 21190        WHEN DE-RESERVE                                              CL**7
 21191            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 21192            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 21193            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 21194                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 21195            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 21196                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 21197            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 21198     END-EVALUATE.                                                   CL**5
 21199                                                                  ELCEXTM2
 21200
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010S.cbl
 21202 ABEND-PGM.
 21203     DISPLAY '******************************'
 21204     DISPLAY '***** ABEND PGM **************'
 21205     DISPLAY '******************************'
*21206                             COPY ELCABEND.
 21207***************************************************************** 04/14/98
 21208*                                                               * ELCABEND
 21209*                            ELCABEND.                          *    LV003
 21210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21211*                            VMOD 2.002                              CL**2
 21212*                                                               * ELCABEND
 21213*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 21214*            AND THEN ABENDS.                                   * ELCABEND
 21215*                                                               * ELCABEND
 21216*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 21217*                                                               * ELCABEND
 21218***************************************************************** ELCABEND
 21219*APS-010.                                                         ELCABEND
 21220     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 21221     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 21222                                                                  ELCABEND
 21223     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 21224         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 21225         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 21226                                 UPON CONSOLE.                    ELCABEND
 21227                                                                  ELCABEND
 21228     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 21229         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 21230         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 21231                                 UPON CONSOLE.                    ELCABEND
 21232                                                                  ELCABEND
 21233     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 21234     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 21235                                 UPON CONSOLE.                    ELCABEND
 21236                                                                  ELCABEND
 21237     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 21238     CALL 'ABORTME'.
 21239                                                                  ELCABEND
 21240 APS-EXIT.                                                        ELCABEND
 21241     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010S.cbl
 21243 9999-END-THE-JOB.
 21244
 21245     DISPLAY ' '.
 21246     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 21247         'ECS010 ******'
 21248     DISPLAY ' '.
 21249     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010S.cbl
 21250/
 21251 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 21252     IF LCP-ASA = '+'
 21253         WRITE MISMATCH-RPT AFTER 0 LINE
 21254     ELSE
 21255     IF LCP-ASA = ' '
 21256         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 21257     ELSE
 21258     IF LCP-ASA = '0'
 21259         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 21260     ELSE
 21261     IF LCP-ASA = '-'
 21262         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 21263     ELSE
 21264     IF LCP-ASA = '1'
 21265         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 21266     ELSE
 21267     IF LCP-ASA = '2'
 21268         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 21269     ELSE
 21270     IF LCP-ASA = '3'
 21271         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 21272     ELSE
 21273     IF LCP-ASA = '4'
 21274         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 21275     ELSE
 21276     IF LCP-ASA = '5'
 21277         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 21278     ELSE
 21279     IF LCP-ASA = '6'
 21280         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 21281     ELSE
 21282     IF LCP-ASA = '7'
 21283         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 21284     ELSE
 21285     IF LCP-ASA = '8'
 21286         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 21287     ELSE
 21288     IF LCP-ASA = '9'
 21289         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 21290     ELSE
 21291     IF LCP-ASA = 'A'
 21292         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 21293     ELSE
 21294     IF LCP-ASA = 'B'
 21295         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 21296     ELSE
 21297     IF LCP-ASA = 'C'
 21298         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 21299     ELSE
 21300     IF LCP-ASA = 'V'
 21301         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 21302     ELSE
 21303     IF LCP-ASA = 'W'
 21304         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 21305     ELSE
 21306     DISPLAY 'ASA CODE ERROR'.
 21307 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010S.cbl
 21308     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  414
* Total Messages:    15
* Unrecoverable :     0                    Severe  :    12
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2174053     Code:           0
