* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS070.cbl
* Options: int("ECS070.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS070.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS070.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS070.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         01/09/98
     2                                                                  ECS070
     3 PROGRAM-ID.                ECS070.                                  LV002
     4*              PROGRAM CONVERTED BY                               ECS070
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ECS070
     6*              CONVERSION DATE 02/08/96 18:26:19.                 ECS070
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS070
     8*                           VMOD=2.005.                           ECS070
     9                                                                  ECS070
    10*AUTHOR.     LOGIC, INC.                                          ECS070
    11*            DALLAS, TEXAS.                                       ECS070
    12                                                                  ECS070
    13*DATE-COMPILED.                                                   ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS070.cbl
    14                                                                  ECS070
    15*SECURITY.   *****************************************************ECS070
    16*            *                                                   *ECS070
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS070
    18*            *                                                   *ECS070
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS070
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS070
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ECS070
    22*            *                                                   *ECS070
    23*            *****************************************************ECS070
    24                                                                  ECS070
    25*REMARKS.                                                         ECS070
    26                                                                  ECS070
    27*    THIS PROGRAM PRINTS THE COMMISSION TABLE FILE CREATED AND    ECS070
    28*        AND MAINTAINED BY EL653.                                 ECS070
    29                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS070.cbl
    31 ENVIRONMENT DIVISION.                                            ECS070
    32 INPUT-OUTPUT SECTION.                                            ECS070
    33 FILE-CONTROL.                                                    ECS070
    34                                                                  ECS070
    35     SELECT COMM-IN        ASSIGN TO SYS010-FBA1-ERCTBL           ECS070
    36             ORGANIZATION IS INDEXED                              ECS070
    37             ACCESS IS SEQUENTIAL                                 ECS070
    38             RECORD KEY IS CT-CONTROL-PRIMARY                     ECS070
    39             FILE STATUS IS COMMISSION-FILE-STATUS.               ECS070
    40                                                                  ECS070
    41     SELECT  PRNTR       ASSIGN TO SYS008-UR-1403-S-SYS008.       ECS070
    42     SELECT  DISK-DATE   ASSIGN TO SYS019-UT-FBA1-S-SYS019.       ECS070
    43     SELECT  FICH        ASSIGN TO SYS020-UT-2400-S-SYS020.       ECS070
    44                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS070.cbl
    46 DATA DIVISION.                                                   ECS070
    47 FILE SECTION.                                                    ECS070
    48                                                                  ECS070
    49 FD  COMM-IN.                                                     ECS070
    50                                                                  ECS070
*   51                         COPY ERCCTBL.                            ECS070
    52******************************************************************04/29/98
    53*                                                                *ERCCTBL
    54*                                                                *ERCCTBL
    55*                            ERCCTBL                             *   LV002
    56*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    57*                            VMOD=2.003                              CL**2
    58*                                                                *ERCCTBL
    59*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
    60*                                                                *ERCCTBL
    61*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
    62*                                                                *ERCCTBL
    63*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
    64*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
    65*                                                                *ERCCTBL
    66*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
    67*       ALTERNATE PATH = NONE                                    *ERCCTBL
    68*                                                                *ERCCTBL
    69*   LOG = NO                                                     *ERCCTBL
    70*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
    71*                                                                *ERCCTBL
    72*                                                                *ERCCTBL
    73******************************************************************ERCCTBL
    74                                                                  ERCCTBL
    75 01  COMM-TABLE-RECORD.                                           ERCCTBL
    76     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
    77         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
    78                                                                  ERCCTBL
    79     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
    80         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
    81         16  CT-TABLE                      PIC XXX.               ERCCTBL
    82         16  CT-CNTRL-2.                                          ERCCTBL
    83             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
    84             20  CT-BEN-CODE               PIC XX.                ERCCTBL
    85                                                                  ERCCTBL
    86     12  CT-MAINT-INFORMATION.                                    ERCCTBL
    87         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
    88         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
    89         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
    90         16  FILLER                        PIC X(31).             ERCCTBL
    91                                                                  ERCCTBL
    92     12  CT-LIMITS.                                               ERCCTBL
    93         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
    94                                                                  ERCCTBL
    95         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
    96                                                                  ERCCTBL
    97         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
    98                                                                  ERCCTBL
    99     12  CT-RATES.                                                ERCCTBL
   100         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
   101             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
   102             20  CT-RT-R   REDEFINES                              ERCCTBL
   103                 CT-RT                     PIC XXX.               ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS070.cbl (/apps/prod/cid1p/copy/ERCCTBL)
   104                                                                  ERCCTBL
   105     12  FILLER                            PIC  X(42).            ERCCTBL
   106                                                                  ERCCTBL
   107******************************************************************ERCCTBL
   108                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS070.cbl
   110 FD  DISK-DATE                                                    ECS070
*  111                                 COPY ELCDTEFD.                   ECS070
   112******************************************************************04/15/98
   113*                                                                *ELCDTEFD
   114*                                                                *ELCDTEFD
   115*                            ELCDTEFD.                           *   LV002
   116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   117*                            VMOD=2.007                          *   CL**2
   118*                                                                *ELCDTEFD
   119******************************************************************ELCDTEFD
   120     BLOCK CONTAINS 0 RECORDS
   121     RECORDING MODE F.                                            ELCDTEFD
   122                                                                  ELCDTEFD
   123 01  DATE-DISK.                                                   ELCDTEFD
   124     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   125     12  FILLER                      PIC  X(14).                  ELCDTEFD
   126     12  DD-CR1                      PIC  9.                      ELCDTEFD
   127     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   128     12  DD-CR2                      PIC  9.                      ELCDTEFD
   129     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   130     12  FILLER                      PIC  X(20).                  ELCDTEFD
   131                                                                  ELCDTEFD
   132 01  DATE-DISK-R.                                                 ELCDTEFD
   133     12  FILLER                      PIC  X(4).                   ELCDTEFD
   134     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   135                                     PIC  X(32).                  ELCDTEFD
   136                                                                  ELCDTEFD
   137 01  DATE-DISK-T.                                                 ELCDTEFD
   138     12  FILLER                      PIC  X(4).                   ELCDTEFD
   139     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   140                                     PIC  X(48).                  ELCDTEFD
   141                                                                  ELCDTEFD
   142 01  DATE-DISK-M.                                                 ELCDTEFD
   143     12  FILLER                      PIC  X(4).                   ELCDTEFD
   144     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   145                                     PIC  X(48).                  ELCDTEFD
   146                                                                  ELCDTEFD
   147 01  DATE-DISK-P.                                                 ELCDTEFD
   148     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   149     12  DD-IDX                      PIC  99.                     ELCDTEFD
   150     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   151     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   152         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   153                                     PIC  X.                      ELCDTEFD
   154         16  FILLER                  PIC  X(46).                  ELCDTEFD
   155     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   156         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   157             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   158             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   159             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   160             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   161         16  FILLER                  PIC  X(16).                  ELCDTEFD
   162                                                                  ELCDTEFD
   163 01  DATE-DISK-E.                                                 ELCDTEFD
   164     12  FILLER                      PIC  X(4).                   ELCDTEFD
   165     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   166                                     PIC  X(4).                   ELCDTEFD
   167                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   168 01  DATE-DISK-C.                                                 ELCDTEFD
   169     12  FILLER                      PIC  X(7).                   ELCDTEFD
   170     12  DD-CARR1-SECPAY-SW          PIC  X.
   171     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   172     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   173     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   174     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   175     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   176     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   177     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   178     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   179     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   180     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   181     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   182     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   183     12  DD-CARR2-SECPAY-SW          PIC  X.
   184     12  FILLER                      PIC  X(7).                   ELCDTEFD
   185                                                                  ELCDTEFD
   186 01  DATE-DISK-OPT.                                               ELCDTEFD
   187     12  FILLER                      PIC  X(04).                  ELCDTEFD
   188     12  DD-TLR-DATA.                                             ELCDTEFD
   189         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   190                                     PIC  X(03).                  ELCDTEFD
   191     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   192         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   193                                     PIC  X(06).                  ELCDTEFD
   194     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   195         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   196                                     PIC  X(07).                  ELCDTEFD
   197         16  FILLER                  PIC  X(05).                  ELCDTEFD
   198     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   199                                     PIC  X(96).                  ELCDTEFD
   200******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS070.cbl
   202 FD  PRNTR                                                        ECS070
*  203                                 COPY ELCPRTFD.                   ECS070
   204******************************************************************04/15/98
   205*                                                                *ELCPRTFD
   206*                                                                *ELCPRTFD
   207*                            ELCPRTFD.                           *   LV003
   208*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   209*                            VMOD=2.006                          *ELCPRTFD
   210******************************************************************ELCPRTFD
   211     RECORDING MODE F                                             ELCPRTFD
   212     LABEL RECORDS OMITTED                                        ELCPRTFD
   213     BLOCK CONTAINS 0 RECORDS
   214     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   215 01  PRT.                                                         ELCPRTFD
   216     12  P-CTL               PIC  X.                                 CL**2
   217     12  P-DATA              PIC  X(132).                         ELCPRTFD
   218******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS070.cbl
   220 FD  FICH                                                         ECS070
*  221                                 COPY ELCFCHFD.                   ECS070
   222******************************************************************04/15/98
   223*                                                                *ELCFCHFD
   224*                            ELCFCHFD.                           *   LV003
   225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   226*                            VMOD=2.004                          *   CL**3
   227*                                                                *ELCFCHFD
   228******************************************************************ELCFCHFD
   229     BLOCK CONTAINS 0 RECORDS
   230     RECORDING MODE F.                                            ELCFCHFD
   231                                                                  ELCFCHFD
   232 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   233******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS070.cbl
   235 WORKING-STORAGE SECTION.                                         ECS070
   236 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      ECS070
   237 77  FILLER  PIC X(32) VALUE '********************************'.  ECS070
   238 77  FILLER  PIC X(32) VALUE '     ECS070 WORKING STORAGE     '.  ECS070
   239 77  FILLER  PIC X(32) VALUE '*****VMOD=2.005*****************'.  ECS070
   240                                                                  ECS070
   241 01  WS-ABEND.                                                    ECS070
   242     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.      ECS070
   243     12  WS-ZERO                 PIC S9          VALUE ZERO.      ECS070
   244     12  WS-ABEND-MESSAGE        PIC X(80)       VALUE SPACES.    ECS070
   245     12  WS-ABEND-FILE-STATUS    PIC XX          VALUE ZERO.      ECS070
   246                                                                  ECS070
   247 01  COMMISSION-FILE-STATUS      PIC XX          VALUE ZERO.      ECS070
   248                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS070.cbl
   250 01  HEAD-1.                                                      ECS070
   251     03  FILLER      PIC X(53)   VALUE SPACES.                    ECS070
   252     03  FILLER      PIC X(17)   VALUE 'COMMISSION TABLES'.       ECS070
   253     03  FILLER      PIC X(49)   VALUE SPACES.                    ECS070
   254     03  FILLER      PIC X(8)    VALUE 'ECS070'.                  ECS070
   255                                                                  ECS070
   256 01  HEAD-2.                                                      ECS070
   257     03  FILLER      PIC X(47)   VALUE SPACES.                    ECS070
   258     03  HD-CO       PIC X(30).                                   ECS070
   259     03  FILLER      PIC X(42)   VALUE SPACES.                    ECS070
   260     03  HD-DT       PIC X(8).                                    ECS070
   261                                                                  ECS070
   262 01  HEAD-3.                                                      ECS070
   263     03  FILLER      PIC X(53)   VALUE SPACES.                    ECS070
   264     03  HD-ADT      PIC X(18).                                   ECS070
   265     03  FILLER      PIC X(48)   VALUE SPACES.                    ECS070
   266     03  FILLER      PIC X(5)    VALUE 'PAGE'.                    ECS070
   267     03  HD-PG       PIC ZZ,ZZ9.                                  ECS070
   268                                                                  ECS070
   269 01  HEAD-4.                                                      ECS070
   270     03  FILLER      PIC X(20)   VALUE ' COMMISSION TABLE -'.     ECS070
   271     03  H4-TAB      PIC X(3).                                    ECS070
   272     03  FILLER      PIC X(7)    VALUE SPACE.                     ECS070
   273     03  FILLER      PIC X(15)   VALUE 'BENEFIT TYPE -'.          ECS070
   274     03  H5-TYPE     PIC X(6).                                    ECS070
   275     03  FILLER      PIC X(6)    VALUE SPACE.                     ECS070
   276     03  FILLER      PIC X(15)   VALUE 'BENEFIT CODE -'.          ECS070
   277     03  H6-CODE     PIC XX.                                      ECS070
   278     03  FILLER      PIC X(7)    VALUE SPACE.                     ECS070
   279     03  FILLER      PIC X(22)   VALUE 'BENEFIT DESCRIPTION -'.   ECS070
   280     03  H7-DESC     PIC X(10).                                   ECS070
   281                                                                  ECS070
   282 01  HEAD-8.                                                      ECS070
   283     03  FILLER      PIC X(40)   VALUE                            ECS070
   284       '   BENEFIT    ****** TERMS ******       '.                ECS070
   285     03  FILLER      PIC X(40)   VALUE                            ECS070
   286       '   BENEFIT    ****** TERMS ******       '.                ECS070
   287     03  FILLER      PIC X(40)   VALUE                            ECS070
   288       '   BENEFIT    ****** TERMS ******       '.                ECS070
   289                                                                  ECS070
   290 01  HEAD-9.                                                      ECS070
   291     03  FILLER                  PIC X.                           ECS070
   292     03  H9-X                    OCCURS 3 TIMES.                  ECS070
   293         05  H9-BEN              PIC ZZZZ,ZZZ.ZZ-.                ECS070
   294         05  FILLER              PIC X.                           ECS070
   295         05  H9-TRM1             PIC ZZZ.                         ECS070
   296         05  FILLER              PIC X(5).                        ECS070
   297         05  H9-TRM2             PIC ZZZ.                         ECS070
   298         05  FILLER              PIC X(5).                        ECS070
   299         05  H9-TRM3             PIC ZZZ.                         ECS070
   300         05  FILLER              PIC X(8).                        ECS070
   301                                                                  ECS070
   302 01  HEAD-10.                                                     ECS070
   303     03  FILLER                  PIC X.                           ECS070
   304     03  H10-X                   OCCURS 3 TIMES.                  ECS070
   305         05  H10-CD              PIC X.                           ECS070
   306         05  FILLER              PIC XX.                          ECS070
   307         05  H10-AGE             PIC ZZ.                          ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS070.cbl
   308         05  FILLER              PIC X(6).                        ECS070
   309         05  H10-PC1A.                                            ECS070
   310             07  H10-PC1         PIC .ZZZZZ-.                     ECS070
   311         05  FILLER              PIC X.                           ECS070
   312         05  H10-PC2A.                                            ECS070
   313             07  H10-PC2         PIC .ZZZZZ-.                     ECS070
   314         05  FILLER              PIC X.                           ECS070
   315         05  H10-PC3A.                                            ECS070
   316             07  H10-PC3         PIC .ZZZZZ-.                     ECS070
   317         05  FILLER              PIC X(6).                        ECS070
   318                                                                  ECS070
   319 01  MISC.                                                        ECS070
   320     03  X                       PIC X       VALUE SPACE.         ECS070
   321     03  SUB                     PIC S9(3)   VALUE +0   COMP.     ECS070
   322     03  CT-LINE-COUNT           PIC S9(3)   VALUE +99  COMP-3.   ECS070
   323     03  CT-PAGE-COUNT           PIC S9(5)   VALUE +0   COMP-3.   ECS070
   324     03  PGM-SUB                 PIC S999    VALUE +070 COMP.     ECS070
   325     03  X1                      PIC S999    VALUE +0   COMP.     ECS070
   326     03  X2                      PIC S999    VALUE +0   COMP.     ECS070
   327     03  B1                      PIC S999    VALUE +1   COMP.     ECS070
   328                                                                  ECS070
*  329                                 COPY ELCDTECX.                   ECS070
   330******************************************************************06/05/98
   331*                                                                *ELCDTECX
   332*                            ELCDTECX.                           *   LV005
   333*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   334*                            VMOD=2.015                          *ELCDTECX
   335*                                                                *ELCDTECX
   336*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   337*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   338*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   339*                                                                *ELCDTECX
   340******************************************************************ELCDTECX
   341******************************************************************
   342*                   C H A N G E   L O G
   343*
   344* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   345*-----------------------------------------------------------------
   346*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   347* EFFECTIVE    NUMBER
   348*-----------------------------------------------------------------
   349* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   350*                                  BENEFIT CODES FROM 300 TO 900
   351* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   352* 051304    2003080800002  SMVA  ADD REFUND METHOD
   353* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   354******************************************************************
   355 01  DATE-CARD.                                                   ELCDTECX
   356     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   357     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   358     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   359     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   360     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   361     12  EP-SW                       PIC  X.                      ELCDTECX
   362         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   363     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   364         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   365     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   366     12  RUN-CENTURY.                                             ELCDTECX
   367         16 RUN-CENTURY-N            PIC  99.                        CL**4
   368     12  FILLER                      PIC  X.                         CL**4
   369     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   370     12  FILLER                      PIC  XXX.                    ELCDTECX
   371     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   372                                                                  ELCDTECX
   373 01  FILLER                          PIC  X(7)                       CL**6
   374                                          VALUE 'OPTIONS'.        ELCDTECX
   375 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   376     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   377     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   378     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   379         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   380         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   381     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   382     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   383     12  FILLER                      PIC  X.                      ELCDTECX
   384     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   385     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   386     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   387     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   388     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   389     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   390     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   391     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   392     12  FILLER                      PIC  X.                      ELCDTECX
   393     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   394     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   395     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   396     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   397     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   398     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   399     12  FILLER                      PIC  X.                      ELCDTECX
   400     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   401     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   402     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   403     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   404     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   405     12  DTE-R78                     PIC  X.                      ELCDTECX
   406     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   407     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   408     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   409     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   410     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   411     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   412     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   413                                     PIC  X.                      ELCDTECX
   414         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   415                                                 ' '.             ELCDTECX
   416         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   417         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   418     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   419         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   420         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   421     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   422     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   423                                     PIC  9.                         CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   424     12  DTE-SYSTEM.                                              ELCDTECX
   425         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   426         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   427         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   428         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   429         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   430         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   431         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   432         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   433         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   434         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   435         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   436         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   437         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   438         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   439         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   440         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   441         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   442         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   443         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   444         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   445         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   446         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   447         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   448         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   449         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   450         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   451     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   452         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   453                                     PIC  X.                      ELCDTECX
   454     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   455                                                                  ELCDTECX
   456 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   457     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   458     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   459     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   460*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   461     12  FILLER                      PIC  X.                      ELCDTECX
   462     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   463     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   464     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   465     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   466     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   467     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   468     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   469                                                                  ELCDTECX
   470     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   471     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   472     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   473     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   474                                                                  ELCDTECX
   475     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   476     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   477     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   478     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   479                                                                  ELCDTECX
   480     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   481     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   482                                                                  ELCDTECX
   483     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   484     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   485                                                                  ELCDTECX
   486     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   487                                                                  ELCDTECX
   488 01  DATE-CARD-FACTORS.                                           ELCDTECX
   489     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   490     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   491     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   492     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   493     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   494     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   495     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   496                                                                  ELCDTECX
   497 01  FILLER                          PIC  X(12)                   ELCDTECX
   498                                          VALUE 'COMPANY NAME'.   ELCDTECX
   499 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   500     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   501         16  CNT-ID                  PIC  X.                      ELCDTECX
   502         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   503                                                                  ELCDTECX
   504 01  FILLER                          PIC  X(11)                   ELCDTECX
   505                                          VALUE 'STATE NAMES'.    ELCDTECX
   506 01  STATE-NAMES.                                                 ELCDTECX
   507     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   508         16  STATE-SUB               PIC  XX.                     ELCDTECX
   509         16  STATE-PIC1.                                          ELCDTECX
   510             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   511             20  FILLER              PIC  XXX.                    ELCDTECX
   512             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   513             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   514             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   515             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   516                                                                  ELCDTECX
   517 01  FILLER                          PIC  X(13)                   ELCDTECX
   518                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   519 01  CARRIER-NAMES.                                               ELCDTECX
   520     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   521         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   522         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   523         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   524         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   525         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   526         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   527*        16  FILLER                  PIC  X.                      ELCDTECX
   528         16  CARRIER-SEC-PAY         PIC  X.
   529             88  SEC-PAY-CARRIER          VALUE 'Y'.
   530                                                                  ELCDTECX
   531 01  FILLER                          PIC  X(9)                       CL**6
   532                                          VALUE 'INS TYPES'.      ELCDTECX
   533 01  CLAS-INS-TYPES.                                              ELCDTECX
   534*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   535     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   536         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   537         16  CLAS-I-AB3.                                          ELCDTECX
   538             20  FILLER              PIC  X.                      ELCDTECX
   539             20  CLAS-I-AB2.                                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   540                 24  FILLER          PIC  X.                      ELCDTECX
   541                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   542         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   543             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   544             20  FILLER              PIC  X.                         CL**4
   545         16  CLAS-I-AB10.                                         ELCDTECX
   546             20  FILLER              PIC  X(9).                   ELCDTECX
   547             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   548         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   549         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   550         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   551         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   552             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   553         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   554         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   555         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   556         16  CLAS-I-BEN-CATEGORY     PIC  X.
   557         16  CLAS-I-REFUND-METHOD    PIC  X.
   558         16  CLAS-I-MAX-BENEFITS     PIC 99.
   559         16  FILLER                  PIC  XXX.
   560                                                                  ELCDTECX
   561 01  FILLER                          PIC  X(16)                   ELCDTECX
   562                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   563 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   564     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   565                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   566         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   567         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   568         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   569         16  CLAS-MORT-DESC.                                      ELCDTECX
   570             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   571             20  FILLER              PIC  XX.                        CL**5
   572             20  CLAS-YEAR           PIC  X(4).                      CL**6
   573             20  FILLER              PIC  X.                         CL**5
   574             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   575             20  FILLER              PIC  X.                         CL**5
   576             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   577             20  FILLER              PIC  X.                         CL**5
   578             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   579             20  FILLER              PIC  X(5).                      CL**6
   580                                                                  ELCDTECX
   581 01  FILLER                          PIC  X(15)                   ELCDTECX
   582                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   583 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   584     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   585         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   586         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   587         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   588         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   589         16  FILLER                  PIC  X(4).                      CL**6
   590                                                                  ELCDTECX
   591 01  FILLER                          PIC  X(7)                       CL**6
   592                                     VALUE 'INDEXES'.             ELCDTECX
   593 01  CLAS-INDEX-TBL.                                              ELCDTECX
   594     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   595     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   596     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   597     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   598     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   599     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   600     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   601     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   602     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   603     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   604     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   605     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   606     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   607     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   608     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   609     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   610     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   611                                                                  ELCDTECX
   612 01  CLAS-TYPE-MISC.                                              ELCDTECX
   613     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   614     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   615     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   616     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   617     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   618     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   619     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   620     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   621     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   622     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   623     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   624                                                                  ELCDTECX
   625 01  FILLER                          PIC  X(13)                   ELCDTECX
   626                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   627 01  CLAS-MISC.                                                   ELCDTECX
   628     12  DTE-FICH                    PIC  X.                      ELCDTECX
   629         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   630         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   631         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   632     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   633     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   634     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   635     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   636     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   637     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   638     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   639     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   640     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   641     12  STATE-L                     PIC  XX.                     ELCDTECX
   642     12  CLAS-CN                     PIC  99.                     ELCDTECX
   643     12  CLAS-CO                     PIC  99.                     ELCDTECX
   644     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   645         16  DTE-F-1                 PIC  X.                      ELCDTECX
   646         16  DTE-F-2                 PIC  X.                      ELCDTECX
   647     12  DTE-ABEND-WORK.                                          ELCDTECX
   648         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   649         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   650                                                                  ELCDTECX
   651 01  FILLER                          PIC  X(12)                   ELCDTECX
   652                                     VALUE 'WORKING DATE'.        ELCDTECX
   653 01  WS-DATE-AND-TIME.                                            ELCDTECX
   654     12  WS-ACCEPT-DATE.                                          ELCDTECX
   655         16  WS-AD-YY                PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   656         16  WS-AD-MM                PIC  99.                     ELCDTECX
   657         16  WS-AD-DD                PIC  99.                     ELCDTECX
   658     12  WS-CURRENT-DATE.                                         ELCDTECX
   659         16  WS-CD-MM                PIC  99.                     ELCDTECX
   660         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   661         16  WS-CD-DD                PIC  99.                     ELCDTECX
   662         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   663         16  WS-CD-YY                PIC  99.                     ELCDTECX
   664     12  WS-TIME-OF-DAY.                                          ELCDTECX
   665         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   666         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   667                                                                  ELCDTECX
   668 01  FILLER                          PIC  X(12)                   ELCDTECX
   669                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   670 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   671     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   672         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   673         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   674         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   675                                                                  ELCDTECX
   676 01  FILLER                          PIC  X(10)                   ELCDTECX
   677                                     VALUE 'STATE TLRS'.          ELCDTECX
   678 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   679     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   680         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   681         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   682                                                                  ELCDTECX
   683 01  FILLER                          PIC  X(13)                   ELCDTECX
   684                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   685 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   686     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   687         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   688                                                                  ELCDTECX
   689 01  FILLER                          PIC  X(13)                   ELCDTECX
   690                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   691 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   692     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   693     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   694     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   695                                     PIC  X.                         CL**5
   696     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   697     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   698     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   699     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   700     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   701     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   702     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   703     12  FILLER                      PIC  X(75).                  ELCDTECX
   704******************************************************************ELCDTECX
   705*01  MISC-CARR-PCT-DATA.                                          00001521
   706*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   707*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   708*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   709*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   710*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   711*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   712******************************************************************ELCDTECX
   713                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS070.cbl
*  714                                 COPY ELCDTEVR.                   ECS070
   715***************************************************************** 04/15/98
   716*                                                                *ELCDTEVR
   717*                                                                *ELCDTEVR
   718*                            ELCDTEVR.                           *   LV003
   719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   720*                            VMOD=2.001                          *   CL**2
   721*                                                                *ELCDTEVR
   722*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   723*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   724*                                                                *ELCDTEVR
   725******************************************************************ELCDTEVR
   726 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   727     05  WS-RUN-DATE.                                             ELCDTEVR
   728         10  FILLER                  PIC  9(03).                  ELCDTEVR
   729         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   730         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   731             15  RUN-CC              PIC  99.                     ELCDTEVR
   732             15  RUN-YR              PIC  99.                     ELCDTEVR
   733         10  RUN-MO                  PIC  99.                     ELCDTEVR
   734         10  RUN-DA                  PIC  99.                     ELCDTEVR
   735     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   736            WS-RUN-DATE              PIC 9(11).                      CL**2
   737     05  WS-EP-DT.                                                ELCDTEVR
   738         10  FILLER                  PIC  9(03).                  ELCDTEVR
   739         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   740         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   741             15  EP-CC               PIC  99.                     ELCDTEVR
   742             15  EP-YR               PIC  99.                     ELCDTEVR
   743         10  EP-MO                   PIC  99.                     ELCDTEVR
   744         10  EP-DA                   PIC  99.                     ELCDTEVR
   745     05  WS-EP-DT-N REDEFINES                                        CL**2
   746            WS-EP-DT                 PIC 9(11).                      CL**2
   747     05  WS-DTE-CONV-DT.                                             CL**4
   748         10  FILLER                  PIC  9(03).                     CL**4
   749         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   750         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   751             15  DTE-CONV-CC         PIC  99.                        CL**4
   752             15  DTE-CONV-YR         PIC  99.                        CL**4
   753         10  DTE-CONV-MO             PIC  99.                        CL**4
   754         10  DTE-CONV-DA             PIC  99.                        CL**4
   755     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   756            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   757 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   758     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   759         10  FILLER                            PIC 999.           ELCDTEVR
   760         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   761         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   762             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   763             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   764         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   765         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   766     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   767            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   768     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   769         10  FILLER                            PIC 999.           ELCDTEVR
   770         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   771         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   772         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   773         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   774     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   775            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   776 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   777     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   778         10  FILLER                            PIC 999.           ELCDTEVR
   779         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   780         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   781             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   782             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   783         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   784         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   785     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   786            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   787     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   788         10  FILLER                            PIC 999.           ELCDTEVR
   789         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   790         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   791             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   792             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   793         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   794         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   795     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   796            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   797     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   798         10  FILLER                            PIC 999.           ELCDTEVR
   799         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   800         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   801             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   802             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   803         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   804         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   805     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   806            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   807 01  WS-RATE-RECORD.                                              ELCDTEVR
   808         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   809             10  FILLER                        PIC 999.           ELCDTEVR
   810             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   811             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   812                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   813                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   814             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   815             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   816         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   817                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   818                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS070.cbl
   820 PROCEDURE DIVISION.                                              ECS070
   821                                                                  ECS070
   822 0100-SET-START.                                                  ECS070
*  823                                 COPY ELCDTERX.                   ECS070
   824******************************************************************04/15/98
   825*                                                                *ELCDTERX
   826*                                                                *ELCDTERX
   827*                            ELCDTERX.                           *   LV002
   828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   829*                            VMOD=2.007                          *ELCDTERX
   830*                                                                *ELCDTERX
   831*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   832*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   833*      = ELCDTEFD)                                               *ELCDTERX
   834*                                                                *ELCDTERX
   835******************************************************************ELCDTERX
   836                                                                  ELCDTERX
   837     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   838                                                                  ELCDTERX
   839     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   840     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   841     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   842                                                                  ELCDTERX
   843     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   844                                                                  ELCDTERX
   845******************************************************************ELCDTERX
   846*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   847*          WARNING MESSAGES.                                      ELCDTERX
   848******************************************************************ELCDTERX
   849     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   850         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   851                                                                  ELCDTERX
   852     OPEN INPUT DISK-DATE.                                        ELCDTERX
   853                                                                  ELCDTERX
   854     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   855                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   856                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   857                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   858                   CLAX-ID           CLAS-MISC                    ELCDTERX
   859                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   860                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   861                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   862                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   863                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   864                                                                  ELCDTERX
   865     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   866                                                                  ELCDTERX
   867     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   868                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   869                                                                  ELCDTERX
   870     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   871     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   872     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   873     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   874                                                                  ELCDTERX
   875     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   876         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   877     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   878         ADD +1                 TO CLAS-CN.                       ELCDTERX
   879                                                                  ELCDTERX
   880     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   881         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   882     ELSE                                                         ELCDTERX
   883         ADD +1                 TO CLAS-CO.                       ELCDTERX
   884                                                                  ELCDTERX
   885 0005-READ--CARD.                                                 ELCDTERX
   886     READ DISK-DATE                                               ELCDTERX
   887         AT END CLOSE DISK-DATE                                   ELCDTERX
   888             GO TO 0060-READ--TEST.                               ELCDTERX
   889                                                                  ELCDTERX
   890     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   891                                                                  ELCDTERX
   892     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   893         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   894         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   895         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   896         GO TO 0005-READ--CARD.                                   ELCDTERX
   897                                                                  ELCDTERX
   898     IF DD-ID = 'CLAD'                                            ELCDTERX
   899         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   900         GO TO 0005-READ--CARD.                                   ELCDTERX
   901                                                                  ELCDTERX
   902     IF DD-ID = 'CLAX'                                            ELCDTERX
   903         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   904         GO TO 0005-READ--CARD.                                   ELCDTERX
   905                                                                  ELCDTERX
   906     IF DD-ID = 'CLAF'                                            ELCDTERX
   907         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   908         GO TO 0005-READ--CARD.                                   ELCDTERX
   909                                                                  ELCDTERX
   910     IF DD-ID = 'CLAC'                                            ELCDTERX
   911         GO TO 0010-READ--CLAC.                                   ELCDTERX
   912                                                                  ELCDTERX
   913     IF DD-ID = 'CARR'                                            ELCDTERX
   914         GO TO 0015-READ--CARR.                                   ELCDTERX
   915                                                                  ELCDTERX
   916     IF DD-ID = 'STAT'                                            ELCDTERX
   917         GO TO 0020-READ--STAT.                                   ELCDTERX
   918                                                                  ELCDTERX
   919     IF DD-ID = 'BUSC'                                            ELCDTERX
   920         GO TO 0025-READ--BUSC.                                   ELCDTERX
   921                                                                  ELCDTERX
   922     IF DD-ID = 'MORT'                                            ELCDTERX
   923         GO TO 0030-READ--MORT.                                   ELCDTERX
   924                                                                  ELCDTERX
   925     IF DD-ID = 'CLAI'                                            ELCDTERX
   926         GO TO 0040-READ--CLAI.                                   ELCDTERX
   927                                                                  ELCDTERX
   928     IF DD-ID = 'COLC'                                            ELCDTERX
   929         GO TO 0065-READ--COLC.                                   ELCDTERX
   930                                                                  ELCDTERX
   931     IF DD-IDX NUMERIC AND                                        ELCDTERX
   932        DD-IDA = 'CL'                                             ELCDTERX
   933         GO TO 0035-READ--CLXX.                                   ELCDTERX
   934                                                                  ELCDTERX
   935     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   936        DD-IDA = 'PO'                                             ELCDTERX
   937         GO TO 0050-READ--POXX.                                   ELCDTERX
   938                                                                  ELCDTERX
   939     IF DD-ID = 'OPCA'                                            ELCDTERX
   940         GO TO 0070-READ--OPCA.                                   ELCDTERX
   941                                                                  ELCDTERX
   942     IF DD-ID = 'OPST'                                            ELCDTERX
   943         GO TO 0072-READ--OPST.                                   ELCDTERX
   944                                                                  ELCDTERX
   945     IF DD-ID = 'OPBS'                                            ELCDTERX
   946         GO TO 0074-READ--OPBS.                                   ELCDTERX
   947                                                                  ELCDTERX
   948     IF DD-ID = 'OPMS'                                            ELCDTERX
   949         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   950                                                                  ELCDTERX
   951     GO TO 0005-READ--CARD.                                       ELCDTERX
   952                                                                  ELCDTERX
   953 0010-READ--CLAC.                                                 ELCDTERX
   954     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   955     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   956     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   957     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   958     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   959     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   960     GO TO 0005-READ--CARD.                                       ELCDTERX
   961                                                                  ELCDTERX
   962 0015-READ--CARR.                                                 ELCDTERX
   963     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   964     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   965        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   966        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   967        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   968        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   969        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   970        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   971        MOVE DD-CARR1-SECPAY-SW
   972                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   973     END-IF
   974                                                                  ELCDTERX
   975     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   976     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   977        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
   978        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   979        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
   980        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   981        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   982        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   983        MOVE DD-CARR2-SECPAY-SW
   984                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   985     END-IF
   986                                                                  ELCDTERX
   987                                                                  ELCDTERX
   988     GO TO 0005-READ--CARD.                                       ELCDTERX
   989                                                                  ELCDTERX
   990 0020-READ--STAT.                                                 ELCDTERX
   991     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   992     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   993        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   994         GO TO 0005-READ--CARD.                                   ELCDTERX
   995                                                                  ELCDTERX
   996     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
   997     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
   998     GO TO 0020-READ--STAT.                                       ELCDTERX
   999                                                                  ELCDTERX
  1000 0025-READ--BUSC.                                                 ELCDTERX
  1001     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1002     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1003        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1004         GO TO 0005-READ--CARD.                                   ELCDTERX
  1005                                                                  ELCDTERX
  1006     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1007     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1008     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1009                                                                  ELCDTERX
  1010 0030-READ--MORT.                                                 ELCDTERX
  1011     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1012     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1013        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1014         GO TO 0005-READ--CARD.                                   ELCDTERX
  1015                                                                  ELCDTERX
  1016     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1017     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1018     GO TO 0030-READ--MORT.                                       ELCDTERX
  1019                                                                  ELCDTERX
  1020 0035-READ--CLXX.                                                 ELCDTERX
  1021     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1022          GO TO 0005-READ--CARD.                                  ELCDTERX
  1023                                                                  ELCDTERX
  1024     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1025         DISPLAY '***********************************************'ELCDTERX
  1026         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1027         DISPLAY '***********************************************'ELCDTERX
  1028         GO TO 0055-READ--STOP.                                   ELCDTERX
  1029                                                                  ELCDTERX
  1030     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1031        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1032         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1033                                                                  ELCDTERX
  1034     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1035        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1036         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1037                                                                  ELCDTERX
  1038*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1039     GO TO 0005-READ--CARD.                                       ELCDTERX
  1040                                                                  ELCDTERX
  1041 0040-READ--CLAI.                                                 ELCDTERX
  1042     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1043     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1044        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1045         GO TO 0005-READ--CARD.                                   ELCDTERX
  1046                                                                  ELCDTERX
  1047     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1048     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1049     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1050                                                                  ELCDTERX
  1051 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1052     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1053     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1054                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1055     PERFORM ABEND-PGM.                                           ELCDTERX
  1056                                                                  ELCDTERX
  1057 0050-READ--POXX.                                                 ELCDTERX
  1058     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1059         GO TO 0005-READ--CARD.                                   ELCDTERX
  1060                                                                  ELCDTERX
  1061     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1062         DISPLAY '***********************************************'ELCDTERX
  1063         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1064         DISPLAY '***********************************************'ELCDTERX
  1065         GO TO 0055-READ--STOP.                                   ELCDTERX
  1066                                                                  ELCDTERX
  1067     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1068     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1069     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1070     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1071                                                                  ELCDTERX
  1072     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1073         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1074     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1075         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1076                                                                  ELCDTERX
  1077     GO TO 0005-READ--CARD.                                       ELCDTERX
  1078                                                                  ELCDTERX
  1079 0055-READ--STOP.                                                 ELCDTERX
  1080     GOBACK.                                                      ELCDTERX
  1081                                                                  ELCDTERX
  1082 0060-READ--TEST.                                                 ELCDTERX
  1083     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1084        CLAX-ID         = SPACE  OR                               ELCDTERX
  1085        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1086         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1087                                                                  ELCDTERX
  1088     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1089     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1090                                                                  ELCDTERX
  1091 0065-READ--COLC.                                                 ELCDTERX
  1092     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1093     GO TO 0005-READ--CARD.                                       ELCDTERX
  1094                                                                  ELCDTERX
  1095 0070-READ--OPCA.                                                 ELCDTERX
  1096                                                                  ELCDTERX
  1097     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1098                                                                  ELCDTERX
  1099     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1100             OR                                                   ELCDTERX
  1101         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1102         GO TO 0005-READ--CARD.                                   ELCDTERX
  1103                                                                  ELCDTERX
  1104     ADD 1                       TO INDEXCA.                      ELCDTERX
  1105     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1106                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1107     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1108                                                                  ELCDTERX
  1109 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS070.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1110                                                                  ELCDTERX
  1111     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1112                                                                  ELCDTERX
  1113     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1114             OR                                                   ELCDTERX
  1115         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1116         GO TO 0005-READ--CARD.                                   ELCDTERX
  1117                                                                  ELCDTERX
  1118     ADD 1                       TO INDEXST.                      ELCDTERX
  1119     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1120                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1121     GO TO 0072-READ--OPST.                                       ELCDTERX
  1122                                                                  ELCDTERX
  1123 0074-READ--OPBS.                                                 ELCDTERX
  1124                                                                  ELCDTERX
  1125     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1126                                                                  ELCDTERX
  1127     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1128             OR                                                   ELCDTERX
  1129         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1130         GO TO 0005-READ--CARD.                                   ELCDTERX
  1131                                                                  ELCDTERX
  1132     ADD 1                       TO INDEXBS.                      ELCDTERX
  1133     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1134     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1135                                                                  ELCDTERX
  1136 0079-READ--EXIT.                                                 ELCDTERX
  1137*    EXIT.                                                        ELCDTERX
  1138******************************************************************ELCDTERX
  1139                                                                  ECS070
  1140     MOVE COMPANY-NAME           TO HD-CO.                        ECS070
  1141     MOVE ALPH-DATE              TO HD-ADT.                       ECS070
  1142     MOVE WS-CURRENT-DATE        TO HD-DT.                        ECS070
  1143                                                                  ECS070
  1144     OPEN INPUT COMM-IN                                           ECS070
  1145          OUTPUT PRNTR.                                           ECS070
  1146                                                                  ECS070
  1147     IF COMMISSION-FILE-STATUS  = '00' OR '97'                    ECS070
  1148         NEXT SENTENCE                                            ECS070
  1149       ELSE                                                       ECS070
  1150         MOVE COMMISSION-FILE-STATUS TO WS-ABEND-FILE-STATUS      ECS070
  1151         MOVE 'OPEN ERROR - ERCTBL ' TO WS-ABEND-MESSAGE          ECS070
  1152         GO TO ABEND-PGM.                                         ECS070
  1153                                                                  ECS070
  1154     MOVE LOW-VALUES                 TO CT-CONTROL-PRIMARY.       ECS070
  1155     MOVE DTE-CLASIC-COMPANY-CD      TO CT-COMPANY-CD.            ECS070
  1156                                                                  ECS070
  1157     START COMM-IN KEY IS NOT LESS THAN CT-CONTROL-PRIMARY.       ECS070
  1158                                                                  ECS070
  1159     IF COMMISSION-FILE-STATUS  = '23'                            ECS070
  1160         GO TO 0350-END-OF-JOB.                                   ECS070
  1161                                                                  ECS070
  1162     IF COMMISSION-FILE-STATUS NOT = ZERO                         ECS070
  1163         MOVE COMMISSION-FILE-STATUS TO WS-ABEND-FILE-STATUS      ECS070
  1164         MOVE 'START ERROR - ERCTBL ' TO WS-ABEND-MESSAGE         ECS070
  1165         GO TO ABEND-PGM.                                         ECS070
  1166                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS070.cbl
  1168 0120-READ-COMM-IN.                                               ECS070
  1169                                                                  ECS070
  1170     READ COMM-IN.                                                ECS070
  1171                                                                  ECS070
  1172     IF COMMISSION-FILE-STATUS = '10'                             ECS070
  1173         GO TO 0350-END-OF-JOB.                                   ECS070
  1174                                                                  ECS070
  1175     IF CT-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD                 ECS070
  1176         GO TO 0350-END-OF-JOB.                                   ECS070
  1177                                                                  ECS070
  1178     IF COMMISSION-FILE-STATUS NOT = ZERO                         ECS070
  1179         MOVE COMMISSION-FILE-STATUS TO WS-ABEND-FILE-STATUS      ECS070
  1180         MOVE 'READ ERROR - ERCTBL ' TO WS-ABEND-MESSAGE          ECS070
  1181         GO TO ABEND-PGM.                                         ECS070
  1182                                                                  ECS070
  1183 0130-PRINT-COMM-TBL.                                             ECS070
  1184                                                                  ECS070
  1185     PERFORM 0240-OVERFLOW-CHECK THRU 0250-O-C-X.                 ECS070
  1186                                                                  ECS070
  1187     MOVE SPACE                  TO HEAD-9                        ECS070
  1188                                    HEAD-10.                      ECS070
  1189                                                                  ECS070
  1190     MOVE CT-TABLE               TO H4-TAB.                       ECS070
  1191                                                                  ECS070
  1192     IF CT-BEN-TYPE = LIFE-OVERRIDE-L1                            ECS070
  1193         MOVE LIFE-OVERRIDE-L6   TO H5-TYPE                       ECS070
  1194     ELSE                                                         ECS070
  1195         MOVE AH-OVERRIDE-L6     TO H5-TYPE.                      ECS070
  1196                                                                  ECS070
  1197     MOVE CT-BEN-CODE            TO H6-CODE.                      ECS070
  1198                                                                  ECS070
  1199     PERFORM 0190-GET-DESC THRU 0230-G-D-X.                       ECS070
  1200                                                                  ECS070
  1201     IF CT-TBF (1) NOT = ZERO                                     ECS070
  1202         MOVE CT-TRM (1)         TO H9-TRM1 (1)                   ECS070
  1203         MOVE CT-TRM (2)         TO H9-TRM2 (1)                   ECS070
  1204         MOVE CT-TRM (3)         TO H9-TRM3 (1)                   ECS070
  1205         MOVE CT-TBF (1)         TO H9-BEN (1).                   ECS070
  1206                                                                  ECS070
  1207     IF CT-TBF (2) NOT = ZERO                                     ECS070
  1208         MOVE CT-TRM (1)         TO H9-TRM1 (2)                   ECS070
  1209         MOVE CT-TRM (2)         TO H9-TRM2 (2)                   ECS070
  1210         MOVE CT-TRM (3)         TO H9-TRM3 (2)                   ECS070
  1211         MOVE CT-TBF (2)         TO H9-BEN (2).                   ECS070
  1212                                                                  ECS070
  1213     IF CT-TBF (3) NOT = ZERO                                     ECS070
  1214         MOVE CT-TRM (1)         TO H9-TRM1 (3)                   ECS070
  1215         MOVE CT-TRM (2)         TO H9-TRM2 (3)                   ECS070
  1216         MOVE CT-TRM (3)         TO H9-TRM3 (3)                   ECS070
  1217         MOVE CT-TBF (3)         TO H9-BEN (3).                   ECS070
  1218                                                                  ECS070
  1219 0140-PARTIAL-PRINT.                                              ECS070
  1220     MOVE HEAD-4                 TO P-DATA.                       ECS070
  1221     MOVE '0'                    TO P-CTL.                           CL**2
  1222     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1223                                                                  ECS070
  1224     MOVE HEAD-8                 TO P-DATA.                       ECS070
  1225     MOVE '0'                    TO P-CTL                            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS070.cbl
  1226     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1227                                                                  ECS070
  1228     MOVE HEAD-9                 TO P-DATA.                       ECS070
  1229     MOVE '-'                    TO P-CTL.                           CL**2
  1230     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1231                                                                  ECS070
  1232 0150-BUILD-HEAD-10.                                              ECS070
  1233     IF CT-TBF (1) NOT = ZERO                                     ECS070
  1234         MOVE 'A'                TO H10-CD (1)                    ECS070
  1235         MOVE CT-AGE (1)         TO H10-AGE (1)                   ECS070
  1236         MOVE 1                  TO X1                            ECS070
  1237         MOVE 1                  TO X2                            ECS070
  1238         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1239                                                                  ECS070
  1240     IF CT-TBF (2) NOT = ZERO                                     ECS070
  1241         MOVE 'A'                TO H10-CD (2)                    ECS070
  1242         MOVE CT-AGE (1)         TO H10-AGE (2)                   ECS070
  1243         MOVE 10                 TO X1                            ECS070
  1244         MOVE 2                  TO X2                            ECS070
  1245         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1246                                                                  ECS070
  1247     IF CT-TBF (3) NOT = ZERO                                     ECS070
  1248         MOVE 'A'                TO H10-CD (3)                    ECS070
  1249         MOVE CT-AGE (1)         TO H10-AGE (3)                   ECS070
  1250         MOVE 19                 TO X1                            ECS070
  1251         MOVE 3                  TO X2                            ECS070
  1252         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1253                                                                  ECS070
  1254     MOVE HEAD-10                TO P-DATA.                       ECS070
  1255     MOVE '0'                    TO P-CTL.                           CL**2
  1256     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1257                                                                  ECS070
  1258     MOVE SPACE                  TO HEAD-10.                      ECS070
  1259                                                                  ECS070
  1260     IF CT-TBF (1) NOT = ZERO                                     ECS070
  1261         MOVE 'G'                TO H10-CD (1)                    ECS070
  1262         MOVE CT-AGE (2)         TO H10-AGE (1)                   ECS070
  1263         MOVE 4                  TO X1                            ECS070
  1264         MOVE 1                  TO X2                            ECS070
  1265         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1266                                                                  ECS070
  1267     IF CT-TBF (2) NOT = ZERO                                     ECS070
  1268         MOVE 'G'                TO H10-CD (2)                    ECS070
  1269         MOVE CT-AGE (2)         TO H10-AGE (2)                   ECS070
  1270         MOVE 13                 TO X1                            ECS070
  1271         MOVE 2                  TO X2                            ECS070
  1272         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1273                                                                  ECS070
  1274     IF CT-TBF (3) NOT = ZERO                                     ECS070
  1275         MOVE 'G'                TO H10-CD (3)                    ECS070
  1276         MOVE CT-AGE (2)         TO H10-AGE (3)                   ECS070
  1277         MOVE 22                 TO X1                            ECS070
  1278         MOVE 3                  TO X2                            ECS070
  1279         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1280                                                                  ECS070
  1281     MOVE HEAD-10                TO P-DATA.                       ECS070
  1282     MOVE '-'                    TO P-CTL.                           CL**2
  1283     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS070.cbl
  1284                                                                  ECS070
  1285     MOVE SPACE                  TO HEAD-10.                      ECS070
  1286                                                                  ECS070
  1287     IF CT-TBF (1) NOT = ZERO                                     ECS070
  1288         MOVE 'E'                TO H10-CD (1)                    ECS070
  1289         MOVE CT-AGE (3)         TO H10-AGE (1)                   ECS070
  1290         MOVE 7                  TO X1                            ECS070
  1291         MOVE 1                  TO X2                            ECS070
  1292         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1293                                                                  ECS070
  1294     IF CT-TBF (2) NOT = ZERO                                     ECS070
  1295         MOVE 'E'                TO H10-CD (2)                    ECS070
  1296         MOVE CT-AGE (3)         TO H10-AGE (2)                   ECS070
  1297         MOVE 16                 TO X1                            ECS070
  1298         MOVE 2                  TO X2                            ECS070
  1299         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1300                                                                  ECS070
  1301     IF CT-TBF (3) NOT = ZERO                                     ECS070
  1302         MOVE 'E'                TO H10-CD (3)                    ECS070
  1303         MOVE CT-AGE (3)         TO H10-AGE (3)                   ECS070
  1304         MOVE 25                 TO X1                            ECS070
  1305         MOVE 3                  TO X2                            ECS070
  1306         PERFORM 0160-MOVE-RATE THRU 0170-MOVE-RATE-EXIT.         ECS070
  1307                                                                  ECS070
  1308     MOVE HEAD-10                TO P-DATA.                       ECS070
  1309     MOVE '-'                    TO P-CTL.                           CL**2
  1310     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1311                                                                  ECS070
  1312     PERFORM 0290-ADD-TO-LINE-COUNT THRU 0300-A-T-L-C-X.          ECS070
  1313     GO TO 0120-READ-COMM-IN.                                     ECS070
  1314                                                                  ECS070
  1315 0160-MOVE-RATE.                                                  ECS070
  1316     IF CT-RT (X1) NUMERIC                                        ECS070
  1317         MOVE CT-RT (X1)         TO H10-PC1 (X2)                  ECS070
  1318     ELSE                                                         ECS070
  1319         MOVE CT-RTX (X1)        TO H10-PC1A (X2).                ECS070
  1320                                                                  ECS070
  1321     ADD B1 TO X1.                                                ECS070
  1322                                                                  ECS070
  1323     IF CT-RT (X1) NUMERIC                                        ECS070
  1324         MOVE CT-RT (X1)         TO H10-PC2 (X2)                  ECS070
  1325     ELSE                                                         ECS070
  1326         MOVE CT-RTX (X1)        TO H10-PC2A (X2).                ECS070
  1327                                                                  ECS070
  1328     ADD B1 TO X1.                                                ECS070
  1329                                                                  ECS070
  1330     IF CT-RT (X1) NUMERIC                                        ECS070
  1331         MOVE CT-RT (X1)         TO H10-PC3 (X2)                  ECS070
  1332     ELSE                                                         ECS070
  1333         MOVE CT-RTX (X1)        TO H10-PC3A (X2).                ECS070
  1334                                                                  ECS070
  1335 0170-MOVE-RATE-EXIT.                                             ECS070
  1336     EXIT.                                                        ECS070
  1337                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS070.cbl
  1339 0190-GET-DESC.                                                   ECS070
  1340     MOVE CLAS-STARTL            TO CLAS-INDEXL.                  ECS070
  1341     MOVE CLAS-STARTA            TO CLAS-INDEXA.                  ECS070
  1342                                                                  ECS070
  1343     IF CT-BEN-CODE = 'AA'                                        ECS070
  1344             MOVE 'ALL'          TO H7-DESC                       ECS070
  1345             GO TO 0230-G-D-X.                                    ECS070
  1346                                                                  ECS070
  1347     IF CT-BEN-TYPE = AH-OVERRIDE-L1                              ECS070
  1348        GO TO 0210-GET-AH-DESC.                                   ECS070
  1349                                                                  ECS070
  1350     IF CLAS-MAXL = ZEROES                                        ECS070
  1351        MOVE 'UNKNOWN'           TO H7-DESC                       ECS070
  1352        GO TO 0230-G-D-X.                                         ECS070
  1353                                                                  ECS070
  1354 0200-GET-LIFE-DESC.                                              ECS070
  1355     IF CLAS-INDEXL GREATER THAN CLAS-MAXL                        ECS070
  1356        MOVE 'UNKNOWN'           TO H7-DESC                       ECS070
  1357        GO TO 0230-G-D-X.                                         ECS070
  1358                                                                  ECS070
  1359     IF CT-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)                ECS070
  1360        ADD 1                    TO CLAS-INDEXL                   ECS070
  1361        GO TO 0200-GET-LIFE-DESC.                                 ECS070
  1362                                                                  ECS070
  1363     MOVE CLAS-I-AB10 (CLAS-INDEXL) TO H7-DESC.                   ECS070
  1364     MOVE CLAS-INDEXL            TO SUB.                          ECS070
  1365     GO TO 0230-G-D-X.                                            ECS070
  1366                                                                  ECS070
  1367 0210-GET-AH-DESC.                                                ECS070
  1368     IF CLAS-MAXA = ZEROES                                        ECS070
  1369        MOVE 'UNKNOWN'           TO H7-DESC                       ECS070
  1370        GO TO 0230-G-D-X.                                         ECS070
  1371                                                                  ECS070
  1372 0220-GET-AH-LOOP.                                                ECS070
  1373     IF CLAS-INDEXA GREATER THAN CLAS-MAXA                        ECS070
  1374        MOVE 'UNKNOWN'           TO H7-DESC                       ECS070
  1375        GO TO 0230-G-D-X.                                         ECS070
  1376                                                                  ECS070
  1377     IF CT-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)                ECS070
  1378        ADD 1                    TO CLAS-INDEXA                   ECS070
  1379        GO TO 0220-GET-AH-LOOP.                                   ECS070
  1380                                                                  ECS070
  1381     MOVE CLAS-I-AB10 (CLAS-INDEXA) TO H7-DESC.                   ECS070
  1382     MOVE CLAS-INDEXA            TO SUB.                          ECS070
  1383                                                                  ECS070
  1384 0230-G-D-X.                                                      ECS070
  1385     EXIT.                                                        ECS070
  1386                                                                  ECS070
  1387 0240-OVERFLOW-CHECK.                                             ECS070
  1388     IF CT-LINE-COUNT GREATER +43                                 ECS070
  1389         PERFORM 0270-HEADING-ROUTINE THRU 0280-H-R-X.            ECS070
  1390                                                                  ECS070
  1391 0250-O-C-X.                                                      ECS070
  1392     EXIT.                                                        ECS070
  1393                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS070.cbl
  1395 0270-HEADING-ROUTINE.                                            ECS070
  1396     MOVE 0                      TO CT-LINE-COUNT.                ECS070
  1397     ADD 1                       TO CT-PAGE-COUNT.                ECS070
  1398     MOVE CT-PAGE-COUNT          TO HD-PG.                        ECS070
  1399     MOVE HEAD-1                 TO P-DATA.                       ECS070
  1400     MOVE '1'                    TO P-CTL.                           CL**2
  1401     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1402     MOVE HEAD-2                 TO P-DATA.                       ECS070
  1403     MOVE ' '                    TO P-CTL.                           CL**2
  1404     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1405     MOVE HEAD-3                 TO P-DATA.                       ECS070
  1406     MOVE ' '                    TO P-CTL.                           CL**2
  1407     PERFORM 0310-WT-LINE THRU 0330-W-L-X.                        ECS070
  1408                                                                  ECS070
  1409 0280-H-R-X.                                                      ECS070
  1410     EXIT.                                                        ECS070
  1411                                                                  ECS070
  1412 0290-ADD-TO-LINE-COUNT.                                          ECS070
  1413     ADD 8                       TO CT-LINE-COUNT.                ECS070
  1414                                                                  ECS070
  1415 0300-A-T-L-C-X.                                                  ECS070
  1416     EXIT.                                                        ECS070
  1417                                                                  ECS070
  1418 0310-WT-LINE.                                                    ECS070
  1419                                                                  ECS070
  1420     MOVE P-CTL                  TO X.                            ECS070
  1421                                                                  ECS070
  1422 0320-WT-LINE-Y.                                                  ECS070
* 1423                                 COPY ELCPRT2.                    ECS070
  1424******************************************************************04/15/98
  1425*                                                                *ELCPRT2
  1426*                                                                *ELCPRT2
  1427*                            ELCPRT2                             *   LV005
  1428*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  1429*                            VMOD=2.002                          *   CL**5
  1430*                                                                *   CL**4
  1431******************************************************************   CL**4
  1432                                                                     CL**4
  1433     IF DTE-FICH NOT = SPACE AND                                     CL**4
  1434        FICH-OPEN    = SPACE                                         CL**4
  1435         MOVE 'X'                TO  FICH-OPEN                       CL**4
  1436         OPEN OUTPUT FICH.                                           CL**4
  1437                                                                     CL**4
  1438     IF DTE-FICH NOT = SPACE                                         CL**4
  1439         MOVE X                  TO  P-CTL                           CL**4
  1440         WRITE FICH-REC FROM PRT.                                    CL**4
  1441                                                                     CL**4
  1442     IF DTE-FICH = SPACE OR '2'                                      CL**4
  1443       MOVE X                    TO  P-CTL                           CL**4
  1444       IF P-CTL = ' '                                                CL**4
  1445         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  1446       ELSE                                                          CL**4
  1447         IF P-CTL = '0'                                              CL**4
  1448           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  1449         ELSE                                                        CL**4
  1450           IF P-CTL = '-'                                            CL**4
  1451             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  1452           ELSE                                                      CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS070.cbl
  1453             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  1454                                                                     CL**4
  1455******************************************************************   CL**4
  1456 0330-W-L-X.                                                      ECS070
  1457     EXIT.                                                        ECS070
  1458                                                                  ECS070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS070.cbl
  1460 0350-END-OF-JOB.                                                 ECS070
  1461                                                                  ECS070
  1462     CLOSE COMM-IN                                                ECS070
  1463           PRNTR.                                                 ECS070
  1464                                                                  ECS070
  1465 0360-END-OF-JOB-1.                                               ECS070
* 1466                                 COPY ELCPRTC.                    ECS070
  1467******************************************************************04/15/98
  1468*                                                                *ELCPRTC
  1469*                                                                *ELCPRTC
  1470*                            ELCPRTC.                            *   LV003
  1471*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1472*                            VMOD=2.002                          *   CL**2
  1473*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  1474*                                                                *ELCPRTC
  1475* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  1476******************************************************************ELCPRTC
  1477                                                                  ELCPRTC
  1478      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  1479          CLOSE FICH.                                             ELCPRTC
  1480                                                                  ELCPRTC
  1481******************************************************************ELCPRTC
  1482                                                                  ECS070
  1483     GOBACK.                                                      ECS070
  1484                                                                  ECS070
  1485 ABEND-PGM SECTION.
*                                      COPY ELCABEND.                   ECS070
  1486***************************************************************** 04/14/98
  1487*                                                               * ELCABEND
  1488*                            ELCABEND.                          *    LV003
  1489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1490*                            VMOD 2.002                              CL**2
  1491*                                                               * ELCABEND
  1492*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1493*            AND THEN ABENDS.                                   * ELCABEND
  1494*                                                               * ELCABEND
  1495*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1496*                                                               * ELCABEND
  1497***************************************************************** ELCABEND
  1498*APS-010.                                                         ELCABEND
  1499     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1500     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1501                                                                  ELCABEND
  1502     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1503         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1504         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1505                                 UPON CONSOLE.                    ELCABEND
  1506                                                                  ELCABEND
  1507     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1508         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1509         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1510                                 UPON CONSOLE.                    ELCABEND
  1511                                                                  ELCABEND
  1512     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1513     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1514                                 UPON CONSOLE.                    ELCABEND
  1515                                                                  ELCABEND
  1516     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS070.cbl (/apps/prod/cid1p/copy/ELCABEND)
  1517     CALL 'ABORTME'.
  1518                                                                  ELCABEND
  1519 APS-EXIT.                                                        ELCABEND
  1520     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       48680     Code:        5451
