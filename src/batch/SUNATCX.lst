* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SUNATCX.cbl
* Options: int("SUNATCX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SUNATCX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SUNATCX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SUNATCX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         06/11/98
     2                                                                  ELDATCX
     3 PROGRAM-ID.                 SUNATCX.                                LV014
     4*              PROGRAM CONVERTED BY                               ELDATCX
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ELDATCX
     6*              CONVERSION DATE 11/22/95 08:57:08.                 ELDATCX
     7*           PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE             ELDATCX
     8*                            VMOD=2.006                              CL**2
     9                                                                  ELDATCX
    10*AUTHOR.     LOGIC, INC.                                          ELDATCX
    11*            DALLAS, TEXAS.                                       ELDATCX
    12                                                                  ELDATCX
    13*DATE-COMPILED.                                                   ELDATCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SUNATCX.cbl
    14                                                                  ELDATCX
    15*SECURITY.   *****************************************************ELDATCX
    16*            *                                                   *ELDATCX
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ELDATCX
    18*            *                                                   *ELDATCX
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ELDATCX
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ELDATCX
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ELDATCX
    22*            *                                                   *ELDATCX
    23*            *****************************************************ELDATCX
    24                                                                  ELDATCX
    25*REMARKS.    *****************************************************ELDATCX
    26*            *                                                   *ELDATCX
    27*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *ELDATCX
    28*            *    OPTION SPECIFIED, CONVERT A GIVEN DATE INTO    *ELDATCX
    29*            *    THE FOLLOWING:  I. EDITED GREGORIAN (MM/DD/YY) *ELDATCX
    30*            *                   II. Y-M-D GREGORIAN  (YYMMDD)   *ELDATCX
    31*            *                  III. M-D-Y GREGORIAN  (MMDDYY)   *ELDATCX
    32*            *                   IV. ALPHA GREG  (MMM DD, YYYY)  *ELDATCX
    33*            *                    V. JULIAN  (YYDDD)             *ELDATCX
    34*            *                   VI. TOTAL DAYS SINCE 1900.      *ELDATCX
    35*            *    ADDITIONALLY, IF TWO DATES (EXPRESSED AS DAYS) *ELDATCX
    36*            *    ARE GIVEN, THE ELAPSED MONTHS AND DAYS CAN BE  *ELDATCX
    37*            *    CALCULATED.                                    *ELDATCX
    38*            *                                                   *ELDATCX
    39*            *****************************************************ELDATCX
    40 ENVIRONMENT DIVISION.                                            ELDATCX
    41                                                                  ELDATCX
    42 DATA DIVISION.                                                   ELDATCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SUNATCX.cbl
    44 WORKING-STORAGE SECTION.                                         ELDATCX
    45 77  FILLER   PIC X(32) VALUE '********************************'. ELDATCX
    46 77  FILLER   PIC X(32) VALUE '**  ELDATCX WORKING STORAGE   **'. ELDATCX
    47 77  FILLER   PIC X(32) VALUE '********* VMOD 2.006 ***********'.    CL**2
    48                                                                  ELDATCX
    49 01  W-PROGRAM-WORK-AREA.                                         ELDATCX
    50     12  W-CURRENT-DATE.                                          ELDATCX
    51         16  W-CD-CCYY               PIC  999     VALUE ZERO.        CL*14
    52         16  W-CD-CCYY-R  REDEFINES W-CD-CCYY.                       CL**6
    53             20  W-CD-YEAR-CD        PIC  9.                      ELDATCX
    54             20  W-CURRENT-YEAR-YY   PIC  99.                     ELDATCX
    55         16  W-CURRENT-MONTH         PIC  99      VALUE ZERO.     ELDATCX
    56         16  W-CURRENT-DAY           PIC  99      VALUE ZERO.     ELDATCX
    57     12  W-FLOAT-YEAR                PIC  999     VALUE ZERO.        CL**2
    58     12  W-FLOAT-YY REDEFINES W-FLOAT-YEAR.                       ELDATCX
    59         16  W-FLOAT-YEAR-CD         PIC  9.                         CL**2
    60         16  W-FLOAT-YEAR-YY         PIC  99.                        CL**2
    61*    12  FUNCTION-DATE               PIC  X(21).
    62                                                                  ELDATCX
    63 01  SYSTEM-DATE.
    64     05  SYS-MO         PIC 9(2).
    65     05  SYS-DA         PIC 9(2).
    66     05  SYS-CCYY       PIC 9(4).
    67
*   68                               COPY ELCFUNDT.                     ELDATCX
    69***************************************************************** 12/03/98
    70*                                                               * ELCFUNDT
    71*                            ELCFUNDT.                          *    LV004
    72*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
    73*                            VMOD=2.001                         * ELCFUNDT
    74*                                                               * ELCFUNDT
    75*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
    76*                                                               * ELCFUNDT
    77***************************************************************** ELCFUNDT
    78                                                                  ELCFUNDT
    79                                                                  ELCFUNDT
    80 01  FUNCTION-DATE.                                                  CL**2
    81     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
    82     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
    83         10  WS-FN-CCYR            PIC 9(4).                         CL**3
    84         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
    85             15  WS-FN-CC          PIC 99.                           CL**3
    86             15  WS-FN-YR          PIC 99.                           CL**3
    87         10  WS-FN-MO              PIC 99.                           CL**3
    88         10  WS-FN-DA              PIC 99.                           CL**3
    89     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
    90     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
    91     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
    92     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
    93     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
    94         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
    95         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
    96         88  WS-NO-GMT                         VALUE ZERO.           CL**2
    97     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
    98     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
    99
   100                                                                  ELDATCX
*  101     COPY ELCDATW1.                                               ELDATCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATW1)
   102******************************************************************06/04/98
   103*                                                                *ELCDATW1
   104*                                                                *ELCDATW1
   105*                            ELCDATW1.                           *   LV029
   106*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
   107*                            VMOD=2.003                          *ELCDATW1
   108*                                                                *ELCDATW1
   109*   DESCRIPTION:  WORKING STORAGE AREA FOR DATE CONVERSION RTN.  *ELCDATW1
   110*                                                                 ELCDATW1
   111******************************************************************ELCDATW1
   112                                                                  ELCDATW1
   113 01  WS-DATE-WORK-AREA.                                              CL*26
   114     05  WS-BINARY-DATE-1             PIC S9(9)      VALUE ZERO.     CL*26
   115     05  WS-BINARY-DATE-2             PIC S9(9)      VALUE ZERO.     CL*26
   116     05  WS-ELAPSED-DAYS              PIC S9(5)      VALUE ZERO.     CL*26
   117     05  WS-ELAPSED-MONTHS            PIC S9(5)      VALUE ZERO.     CL*26
   118     05  DAYS-REMAINING               PIC S999       VALUE ZERO.     CL*26
   119     05  CHECK-YEAR                   PIC S999       VALUE ZERO.     CL*26
   120     05  DAYS-ELAPSED                 PIC S9(5)      VALUE ZERO.     CL*26
   121     05  DAYS-NEEDED                  PIC S9(5)      VALUE ZERO.     CL*26
   122     05  WS-DAY-OF-CENTURY            PIC S9(5)      VALUE ZERO.     CL*26
   123     05  DAY-OF-WEEK-X                PIC S9         VALUE ZERO.     CL*26
   124     05  WORK-JULIAN.                                             ELCDATW1
   125         10  JULIAN-YEAR              PIC S9(3)      VALUE ZERO.     CL*27
   126         10  JULIAN-DAY               PIC S9(3)      VALUE ZERO.     CL*27
   127     05  WORK-JULIAN-1.                                           ELCDATW1
   128         10  JULIAN-YEAR1             PIC S9(3)      VALUE ZERO.     CL*26
   129         10  JULIAN-DAY1              PIC S9(3)      VALUE ZERO.     CL*26
   130     05  WORK-JULIAN-2.                                           ELCDATW1
   131         10  JULIAN-YEAR2             PIC S9(3)      VALUE ZERO.     CL*26
   132         10  JULIAN-DAY2              PIC S9(3)      VALUE ZERO.     CL*26
   133                                                                  ELCDATW1
   134 01  LEAP-YEAR-FIELDS.                                               CL*14
   135     05  DIVIDE-LEAP-YEAR             PIC 999V99     VALUE ZERO.     CL*26
   136     05  DIVIDE-LEAP-YEAR-R REDEFINES DIVIDE-LEAP-YEAR.              CL*14
   137         10  DIVIDE-RESULT            PIC 999.                       CL*26
   138         10  DIVIDE-REMAINDER         PIC V99.                       CL*26
   139             88  A-LEAP-YEAR                         VALUE ZERO.     CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATW1)
   140/                                                                    CL*15
   141 01  FILLER.                                                      ELCDATW1
   142     05  BIN-DATE            COMP    PIC S9(9)       VALUE ZERO.  ELCDATW1
   143                                                                  ELCDATW1
   144     05  FILLER                      REDEFINES                    ELCDATW1
   145         BIN-DATE.                                                ELCDATW1
   146         10  FILLER                  PIC XX.                      ELCDATW1
   147         10  BIN-DATE-WORK           PIC XX.                      ELCDATW1
   148                                                                  ELCDATW1
   149     05  BIN-DATE-3                  REDEFINES                    ELCDATW1
   150         BIN-DATE.                                                ELCDATW1
   151         10  FILLER                  PIC X.                       ELCDATW1
   152         10  BIN-DATE-3-WORK         PIC XXX.                     ELCDATW1
   153                                                                  ELCDATW1
   154      05  GREG-ALPHA-MASK         PIC X(18)                       ELCDATW1
   155                        VALUE '            , 0000'.               ELCDATW1
   156                                                                     CL*18
   157      05  WORK-DATE-1.                                               CL*20
   158          10  YEAR1                   PIC S9(3)     VALUE ZERO.      CL*20
   159          10  MONTH1                  PIC S9(3)     VALUE ZERO.      CL*20
   160          10  DAY1                    PIC S9(3)     VALUE ZERO.      CL*20
   161                                                                     CL*24
   162     05  WORK-DATE-2.                                                CL*24
   163         10  YEAR2                    PIC S9(3)     VALUE ZERO.      CL*25
   164         10  MONTH2                   PIC S9(3)     VALUE ZERO.      CL*25
   165         10  DAY2                     PIC S9(3)     VALUE ZERO.      CL*25
   166                                                                     CL*18
   167 01  YR-2                        PIC 9(3).                           CL**2
   168 01  YR-2-R REDEFINES YR-2.                                       ELCDATW1
   169     05  YEAR2-CEN-CD            PIC 9.                              CL**2
   170     05  YEAR2-YR                PIC 99.                             CL**2
   171                                                                  ELCDATW1
   172 01  MONTH-AND-DAYS-TABLE.                                        ELCDATW1
   173     05  FILLER             PIC X(10)  VALUE ' JANUARY  '.        ELCDATW1
   174     05  FILLER             PIC 9(3)   VALUE ZERO.                   CL*29
   175     05  FILLER             PIC 9(3)   VALUE ZERO.                   CL*29
   176     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   177     05  FILLER             PIC X(10)  VALUE 'FEBRUARY  '.        ELCDATW1
   178     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   179     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   180     05  FILLER             PIC 9(3)   VALUE 28.                     CL*29
   181     05  FILLER             PIC X(10)  VALUE '  MARCH   '.        ELCDATW1
   182     05  FILLER             PIC 9(3)   VALUE 59.                     CL*29
   183     05  FILLER             PIC 9(3)   VALUE 60.                     CL*29
   184     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   185     05  FILLER             PIC X(10)  VALUE '  APRIL   '.        ELCDATW1
   186     05  FILLER             PIC 9(3)   VALUE 90.                     CL*29
   187     05  FILLER             PIC 9(3)   VALUE 91.                     CL*29
   188     05  FILLER             PIC 9(3)   VALUE 30.                     CL*29
   189     05  FILLER             PIC X(10)  VALUE '   MAY    '.        ELCDATW1
   190     05  FILLER             PIC 9(3)   VALUE 120.                    CL*29
   191     05  FILLER             PIC 9(3)   VALUE 121.                    CL*29
   192     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   193     05  FILLER             PIC X(10)  VALUE '  JUNE    '.        ELCDATW1
   194     05  FILLER             PIC 9(3)   VALUE 151.                    CL*29
   195     05  FILLER             PIC 9(3)   VALUE 152.                    CL*29
   196     05  FILLER             PIC 9(3)   VALUE 30.                     CL*29
   197     05  FILLER             PIC X(10)  VALUE '  JULY    '.        ELCDATW1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATW1)
   198     05  FILLER             PIC 9(3)   VALUE 181.                    CL*29
   199     05  FILLER             PIC 9(3)   VALUE 182.                    CL*29
   200     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   201     05  FILLER             PIC X(10)  VALUE ' AUGUST   '.        ELCDATW1
   202     05  FILLER             PIC 9(3)   VALUE 212.                    CL*29
   203     05  FILLER             PIC 9(3)   VALUE 213.                    CL*29
   204     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   205     05  FILLER             PIC X(10)  VALUE 'SEPTEMBER '.        ELCDATW1
   206     05  FILLER             PIC 9(3)   VALUE 243.                    CL*29
   207     05  FILLER             PIC 9(3)   VALUE 244.                    CL*29
   208     05  FILLER             PIC 9(3)   VALUE 30.                     CL*29
   209     05  FILLER             PIC X(10)  VALUE ' OCTOBER  '.        ELCDATW1
   210     05  FILLER             PIC 9(3)   VALUE 273.                    CL*29
   211     05  FILLER             PIC 9(3)   VALUE 274.                    CL*29
   212     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   213     05  FILLER             PIC X(10)  VALUE 'NOVEMBER  '.        ELCDATW1
   214     05  FILLER             PIC 9(3)   VALUE 304.                    CL*29
   215     05  FILLER             PIC 9(3)   VALUE 305.                    CL*29
   216     05  FILLER             PIC 9(3)   VALUE 30.                     CL*29
   217     05  FILLER             PIC X(10)  VALUE 'DECEMBER  '.        ELCDATW1
   218     05  FILLER             PIC 9(3)   VALUE 334.                    CL*29
   219     05  FILLER             PIC 9(3)   VALUE 335.                    CL*29
   220     05  FILLER             PIC 9(3)   VALUE 31.                     CL*29
   221     05  FILLER             PIC X(10)  VALUE 'XXXXXXXX  '.        ELCDATW1
   222     05  FILLER             PIC 9(3)   VALUE 365.                    CL*29
   223     05  FILLER             PIC 9(3)   VALUE 366.                    CL*29
   224     05  FILLER             PIC 9(3)   VALUE ZERO.                   CL*29
   225                                                                  ELCDATW1
   226 01  TABLE-OF-MONTHS-AND-DAYS  REDEFINES  MONTH-AND-DAYS-TABLE.   ELCDATW1
   227     05  MONTHS-AND-DAYS                                          ELCDATW1
   228         OCCURS 13 TIMES             INDEXED BY MTHX              ELCDATW1
   229                                                SUB1.             ELCDATW1
   230         10  NAME-OF-MONTH            PIC X(10).                     CL*26
   231         10  REGULAR-DAYS             PIC 999.                       CL*26
   232         10  LEAP-YR-DAYS             PIC 999.                       CL*26
   233         10  DAYS-IN-MONTH            PIC 999.                       CL*26
   234                                                                  ELCDATW1
   235 01  CENTURY-CONVERSION-TABLE.                                    ELCDATW1
   236     05  FILLER                      PIC 9(4)  VALUE 0019.           CL**7
   237     05  FILLER                      PIC 9(4)  VALUE 0120.           CL**7
   238     05  FILLER                      PIC 9(4)  VALUE 0221.           CL**7
   239     05  FILLER                      PIC 9(4)  VALUE 0322.           CL**7
   240     05  FILLER                      PIC 9(4)  VALUE 0423.           CL**7
   241     05  FILLER                      PIC 9(4)  VALUE 0524.           CL**7
   242     05  FILLER                      PIC 9(4)  VALUE 0625.           CL**7
   243     05  FILLER                      PIC 9(4)  VALUE 0726.           CL**7
   244     05  FILLER                      PIC 9(4)  VALUE 0827.           CL**7
   245     05  FILLER                      PIC 9(4)  VALUE 0928.           CL**7
   246 01  TABLE-CENTURY  REDEFINES CENTURY-CONVERSION-TABLE.           ELCDATW1
   247     05  CENTURY-TBL OCCURS 10 TIMES INDEXED BY CNTRY-NDX.        ELCDATW1
   248         10  CENTURY-CODE            PIC 99.                      ELCDATW1
   249         10  CENTURY                 PIC 99.                      ELCDATW1
   250                                                                  ELCDATW1
   251 01  CENTURY-SEARCH-VARIABLES.                                    ELCDATW1
   252     05  FIND-CENTURY-FLAG       PIC  X.                          ELCDATW1
   253     05  SEARCH-CENTURY.                                          ELCDATW1
   254         10  SEARCH-CENTURY-N    PIC  99.                            CL**7
   255     05  SEARCH-CENTURY-CODE.                                     ELCDATW1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATW1)
   256         10  SEARCH-CENTURY-CD-N PIC  99.                            CL**7
   257     05  FOUND-CENTURY.                                           ELCDATW1
   258         10  FOUND-CENTURY-N     PIC  99.                            CL**7
   259     05  FOUND-CENTURY-CODE.                                      ELCDATW1
   260         10  FOUND-CENTURY-CD-N  PIC  99.                            CL**7
   261     05  CURRENT-CENTURY-1.                                       ELCDATW1
   262         10  CURRENT-CENTURY-1-N PIC 99     VALUE 19.                CL*23
   263     05  CONTROL-YEAR            PIC 9(03)  VALUE 070.               CL**7
   264     05  CONTROL-YR REDEFINES CONTROL-YEAR.                       ELCDATW1
   265         10 CONTROL-YEAR-CD      PIC  9.                          ELCDATW1
   266         10 CONTROL-YEAR-YY      PIC  99.                            CL**7
   267     05  W-PRESENT-YEAR          PIC  9(03) VALUE ZEROS.          ELCDATW1
   268     05  PREVIOUS-CENTURY        PIC  99    VALUE ZEROS.             CL**7
   269     05  NEXT-CENTURY            PIC  99    VALUE ZEROS.             CL**7
   270     05  CENTURY-MARK            PIC  9(03) VALUE 100.            ELCDATW1
   271     05  CHECK-CCYY              PIC  9(04) VALUE ZEROES.         ELCDATW1
   272     05  CHECK-CCYY-R REDEFINES CHECK-CCYY.                       ELCDATW1
   273         10  CHECK-CCYY-CC       PIC 99.                             CL*26
   274         10  CHECK-CCYY-YY       PIC 99.                             CL*26
   275     05  BREAK-PERIOD            PIC  9(03) VALUE 0.                 CL*20
   276                                                                  ELCDATW1
   277                                                                  ELDATCX
   279 LINKAGE SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SUNATCX.cbl
*                       COPY ELCDATE.                                      CL**5
   280******************************************************************06/11/98
   281*                                                                *ELCDATE
   282*                                                                *ELCDATE
   283*                            ELCDATE.                            *   LV023
   284*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   285*                            VMOD=2.003                           ELCDATE
   286*                                                                *ELCDATE
   287*                                                                *ELCDATE
   288*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   289*                 LENGTH = 200                                   *   CL*19
   290******************************************************************ELCDATE
   291                                                                  ELCDATE
   292 01  DATE-CONVERSION-DATA.                                        ELCDATE
   293     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   294     12  DC-OPTION-CODE                PIC X.                        CL*15
   295         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   296         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   297         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   298         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   299         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   300         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   301         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   302         88  FIND-CENTURY               VALUE '7'.                   CL*22
   303         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   304         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   305         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   306         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   307         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   308         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   309         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   310         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   311         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   312         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   313         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   314         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   315         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   316         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   317         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   318         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   319         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   320         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   321         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   322         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   323         88  THREE-CHARACTER-BIN                                  ELCDATE
   324                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   325         88  GREGORIAN-TO-BIN                                        CL**2
   326                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   327         88  BIN-TO-GREGORIAN                                        CL**2
   328                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   329         88  JULIAN-TO-BINARY                                        CL**2
   330                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   331     12  DC-ERROR-CODE                 PIC X.                        CL*15
   332         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   333         88  DATE-CONVERSION-ERROR                                ELCDATE
   334                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   335         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   336         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   337         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   338         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   339         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   340         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   341         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   342         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   343         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   344         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   345     12  DC-END-OF-MONTH               PIC X.                        CL*15
   346         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   347     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   348         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   349         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   350         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   351     12  FILLER                        PIC X.                        CL*15
   352     12  DC-CONVERSION-DATES.                                        CL*15
   353         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   354         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   355         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   356         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   357                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   358             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   359             20  SLASH1-1              PIC X.                        CL*15
   360             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   361             20  SLASH1-2              PIC X.                        CL*15
   362             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   363         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   364         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   365                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   366             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   367             20  SLASH2-1              PIC X.                        CL*15
   368             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   369             20  SLASH2-2              PIC X.                        CL*15
   370             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   371         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   372         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   373                     DC-GREG-DATE-1-YMD.                          ELCDATE
   374             20  DC-YMD-YEAR           PIC 99.                       CL*15
   375             20  DC-YMD-MONTH          PIC 99.                       CL*15
   376             20  DC-YMD-DAY            PIC 99.                       CL*15
   377         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   378         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   379                      DC-GREG-DATE-1-MDY.                         ELCDATE
   380             20  DC-MDY-MONTH          PIC 99.                       CL*15
   381             20  DC-MDY-DAY            PIC 99.                       CL*15
   382             20  DC-MDY-YEAR           PIC 99.                       CL*15
   383         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   384             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   385             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   386             20  FILLER                PIC XX.                       CL*15
   387             20  DC-ALPHA-CENTURY.                                   CL*15
   388                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   389             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   390         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   391         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   392         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   393         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   394         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   395                                       PIC 9(05).                    CL*20
   396         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   397             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   398             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   399         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   400         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   401         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   402     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   403         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   404         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   405             20  FILLER                PIC 9(3).                     CL*15
   406             20  HOLD-CEN-1-CCYY.                                    CL*15
   407                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   408                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   409             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   410             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   411         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   412             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   413             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   414             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   415                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   416                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   417             20  FILLER                PIC 9(3).                     CL*15
   418         16  HOLD-CENTURY-1-X.                                       CL*15
   419             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   420             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   421                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   422                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   423             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   424             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   425         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   426             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   427             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   428             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   429                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   430                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   431             20  FILLER                PIC XXX.                      CL*23
   432         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   433         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   434         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   435         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   436             20  DC-JULIAN-1-CCYY.                                   CL*15
   437                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   438                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   439             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   440         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   441         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   442             20  DC-JULIAN-2-CCYY.                                   CL*15
   443                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   444                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   445             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   446         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   447             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   448             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   449             20  DC-EDITA-DAY          PIC 99.                       CL*15
   450             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   451             20  DC-EDITA-CCYY.                                      CL*15
   452                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   453                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   454         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   455             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   456             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   457             20  DC-EDITB-DAY          PIC 99.                       CL*15
   458             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   459             20  DC-EDITB-CCYY.                                      CL*15
   460                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   461                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   462         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   463         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   464                              DC-GREG-DATE-CYMD.                  ELCDATE
   465             20  DC-CYMD-CEN           PIC 99.                       CL*15
   466             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   467             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   468             20  DC-CYMD-DAY           PIC 99.                       CL*15
   469         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   470         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   471                              DC-GREG-DATE-MDCY.                  ELCDATE
   472             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   473             20  DC-MDCY-DAY           PIC 99.                       CL*15
   474             20  DC-MDCY-CEN           PIC 99.                       CL*15
   475             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   476    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   477        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   478    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   479    12  FILLER                         PIC X(28).                    CL*26
   480                                                                  ELDATCX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SUNATCX.cbl
   482 PROCEDURE DIVISION USING DATE-CONVERSION-DATA.                   ELDATCX
   483                                                                     CL**4
   484     IF DC-FORCE-EL310-DATE
   485        MOVE DC-EL310-DATE       TO FUNCTION-DATE
   486     ELSE
   487        MOVE FUNCTION CURRENT-DATE
   488                                 TO FUNCTION-DATE
   489*       CALL 'SYSDATE'           USING SYSTEM-DATE
   490*       MOVE SYS-MO              TO WS-FN-MO
   491*       MOVE SYS-DA              TO WS-FN-DA
   492*       MOVE SYS-CCYY            TO WS-FN-CCYR
   493     END-IF
   494
   495     MOVE WS-FN-CC               TO CURRENT-CENTURY-1-N
   496     MOVE WS-FN-YR               TO W-CURRENT-YEAR-YY
   497     MOVE WS-FN-MO               TO W-CURRENT-MONTH
   498     MOVE WS-FN-DA               TO W-CURRENT-DAY
   499
   500*    ACCEPT W-CURRENT-DATE(2:6) FROM DATE.                           CL*13
   501                                                                     CL*14
   502*    MOVE FUNCTION CURRENT-DATE TO FUNCTION-DATE.                    CL*10
   503*    MOVE FUNCTION-DATE(1:2)    TO CURRENT-CENTURY-1-N.              CL*10
   504                                                                     CL*14
   505     MOVE CURRENT-CENTURY-1-N    TO SEARCH-CENTURY.                  CL*14
   506                                                                     CL*14
   507     MOVE '2'                    TO FIND-CENTURY-FLAG.               CL**7
   508     PERFORM 0800-FIND-CENTURY                                       CL**7
   509*    IF NO-CONVERSION-ERROR                                          CL**7
   510*        MOVE FOUND-CENTURY-CD-N TO W-CD-YEAR-CD                     CL**7
   511*                                   CONTROL-YEAR-CD                  CL*14
   512*    END-IF
   513                                                                     CL*14
   514     MOVE FOUND-CENTURY-CD-N     TO W-CD-YEAR-CD
   515                                    CONTROL-YEAR-CD
   516
   517     COMPUTE W-FLOAT-YEAR = W-CD-CCYY - CONTROL-YEAR.                CL**6
   518                                                                  ELDATCX
   519 0100-PROGRAM-PROCESSING SECTION.
*                                        COPY ELCDATP1.                 ELDATCX
   520***************************************************************** 05/29/98
   521*                                                               * ELCDATP1
   522*                                                               * ELCDATP1
   523*                            ELCDATP1.                          *    LV023
   524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   525*                            VMOD=2.002                         * ELCDATP1
   526*                                                               * ELCDATP1
   527***************************************************************** ELCDATP1
   528                                                                  ELCDATP1
   529     IF NOT FIND-CENTURY
   530        MOVE GREG-ALPHA-MASK   TO DC-GREG-DATE-1-ALPHA
   531     END-IF
   532
   533     MOVE 2                    TO FIND-CENTURY-FLAG.                 CL**5
   534     MOVE CURRENT-CENTURY-1-N  TO SEARCH-CENTURY-N                ELCDATP1
   535     PERFORM 0800-FIND-CENTURY.                                   ELCDATP1
   536                                                                     CL**6
   537     MOVE FOUND-CENTURY-CD-N   TO CONTROL-YEAR-CD                    CL**5
   538                                  W-CD-YEAR-CD.                      CL*18
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP1)
   539*Y2K                                                                 CL*18
   540*                                 W-FLOAT-YEAR-CD.                   CL*18
   541                                                                     CL*19
   542     COMPUTE BREAK-PERIOD = (FOUND-CENTURY-CD-N * 100) + 69          CL*20
   543                                                                     CL*19
   544     EVALUATE TRUE                                                   CL*11
   545        WHEN W-CD-CCYY < BREAK-PERIOD                                CL*22
   546           COMPUTE CONTROL-YEAR-CD = FOUND-CENTURY-CD-N - 1          CL*16
   547           ADD +1 TO CURRENT-CENTURY-1-N                             CL*16
   548                            GIVING NEXT-CENTURY                      CL*16
   549           SUBTRACT +1 FROM CURRENT-CENTURY-1-N                      CL*16
   550                            GIVING PREVIOUS-CENTURY                  CL*16
   551        WHEN OTHER                                                   CL*11
   552           MOVE FOUND-CENTURY-CD-N TO CONTROL-YEAR-CD                CL*11
   553           COMPUTE CENTURY-MARK = 100 +                              CL*15
   554                           (FOUND-CENTURY-CD-N * 100)                CL*16
   555           ADD +1 TO CURRENT-CENTURY-1-N                             CL*11
   556                            GIVING NEXT-CENTURY                      CL*11
   557           SUBTRACT +1 FROM CURRENT-CENTURY-1-N                      CL*11
   558                            GIVING PREVIOUS-CENTURY                  CL*11
   559     END-EVALUATE.                                                   CL*11
   560                                                                  ELCDATP1
   561     MOVE SPACES                 TO DC-ERROR-CODE.                ELCDATP1
   562                                                                  ELCDATP1
   563     MOVE ZERO                   TO  BIN-DATE.                    ELCDATP1
   564                                                                     CL**6
   565     EVALUATE TRUE                                                ELCDATP1
   566        WHEN BIN-TO-GREG                                          ELCDATP1
   567             OR ELAPSED-BETWEEN-BIN                               ELCDATP1
   568             OR BIN-PLUS-ELAPSED                                  ELCDATP1
   569           MOVE DC-BIN-DATE-1    TO  BIN-DATE-WORK                ELCDATP1
   570        WHEN BIN-3-TO-GREG                                        ELCDATP1
   571             OR ELAPSED-BETWEEN-BIN-3                             ELCDATP1
   572             OR BIN-TO-JULIAN-EXPANDED                            ELCDATP1
   573             OR BIN-PLUS-ELAPSED-3                                ELCDATP1
   574           MOVE DC-BIN-DATE-EXPAND-1 TO BIN-DATE-3-WORK           ELCDATP1
   575     END-EVALUATE.                                                ELCDATP1
   576                                                                     CL**6
   577     MOVE BIN-DATE               TO  WS-BINARY-DATE-1.            ELCDATP1
   578                                                                  ELCDATP1
   579     MOVE ZERO                   TO  BIN-DATE.                    ELCDATP1
   580                                                                     CL**6
   581     EVALUATE TRUE                                                ELCDATP1
   582        WHEN ELAPSED-BETWEEN-BIN                                  ELCDATP1
   583           MOVE DC-BIN-DATE-2          TO  BIN-DATE-WORK          ELCDATP1
   584        WHEN ELAPSED-BETWEEN-BIN-3                                ELCDATP1
   585           MOVE DC-BIN-DATE-EXPAND-2 TO BIN-DATE-3-WORK           ELCDATP1
   586     END-EVALUATE.                                                ELCDATP1
   587                                                                  ELCDATP1
   588     MOVE BIN-DATE               TO  WS-BINARY-DATE-2.            ELCDATP1
   589                                                                  ELCDATP1
   590     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.           ELCDATP1
   591     MOVE DC-ELAPSED-DAYS        TO  WS-ELAPSED-DAYS.             ELCDATP1
   592                                                                  ELCDATP1
   593     EVALUATE TRUE                                                ELCDATP1
   594        WHEN JULIAN-TO-BIN OR                                        CL**6
   595             JULIAN-TO-BIN-3                                         CL**6
   596           MOVE DC-JULIAN-YEAR   TO  JULIAN-YEAR1                 ELCDATP1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP1)
   597           MOVE DC-JULIAN-DAYS   TO  JULIAN-DAY1                  ELCDATP1
   598        WHEN JULIAN-EXPANDED-TO-BIN OR                               CL**6
   599             JULIAN-EXPANDED-TO-BIN-3                                CL**6
   600           MOVE DC-JULIAN-1-CC   TO DC-ALPHA-CEN-N                ELCDATP1
   601           MOVE DC-JULIAN-1-YR   TO JULIAN-YEAR1                  ELCDATP1
   602           MOVE DC-JULIAN-DA-1   TO JULIAN-DAY1                      CL**5
   603     END-EVALUATE.                                                ELCDATP1
   604                                                                  ELCDATP1
   605     EVALUATE TRUE                                                ELCDATP1
   606        WHEN BIN-PLUS-ELAPSED OR                                     CL**6
   607             BIN-PLUS-ELAPSED-3                                      CL**6
   608           PERFORM 0700-CALCULATE-END-DATE                        ELCDATP1
   609        WHEN BIN-TO-GREGORIAN                                        CL**2
   610           PERFORM 0300-REFORMAT-BINARY-DAYS                      ELCDATP1
   611        WHEN GREGORIAN-TO-BIN                                        CL**2
   612           PERFORM 0400-REFORMAT-GREGORIAN-DATE                   ELCDATP1
   613        WHEN JULIAN-TO-BINARY                                        CL**2
   614           PERFORM 0500-REFORMAT-JULIAN-DATE                      ELCDATP1
   615        WHEN FIND-CENTURY                                         ELCDATP1
   616           MOVE SPACE         TO DC-ERROR-CODE                       CL**5
   617           MOVE 0             TO YEAR1                               CL**8
   618           MOVE 3             TO FIND-CENTURY-FLAG                   CL**8
   619           MOVE DC-ALPHA-YEAR TO YEAR1                               CL**9
   620*          display ' cpdbebug task prior if ' eibtaskn
   621           IF YEAR1 < W-FLOAT-YEAR                                   CL*10
   622*             display ' cpdebug task inside if ' eibtaskn
   623              ADD 100 TO YEAR1                                       CL*10
   624           END-IF                                                    CL*10
   625*          display ' cpdebug task prior  ' eibtaskn
   626           PERFORM 0800-FIND-CENTURY                              ELCDATP1
   627*          display ' cpdebug task after  ' eibtaskn
   628           IF NO-CONVERSION-ERROR                                 ELCDATP1
   629              MOVE 'B'        TO DC-ERROR-CODE                       CL**5
   630           END-IF                                                 ELCDATP1
   631        WHEN CHECK-LEAP-YEAR                                      ELCDATP1
   632           MOVE HOLD-CEN-1-YY TO CHECK-YEAR                       ELCDATP1
   633           MOVE HOLD-CEN-1-CC TO SEARCH-CENTURY                   ELCDATP1
   634           MOVE 2             TO FIND-CENTURY-FLAG                   CL*23
   635           PERFORM 0800-FIND-CENTURY                              ELCDATP1
   636           IF NO-CONVERSION-ERROR                                 ELCDATP1
   637              PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT     ELCDATP1
   638              IF A-LEAP-YEAR                                      ELCDATP1
   639                 MOVE LEAP-YR-DAYS (2) TO HOLD-CEN-1-DA              CL**3
   640              ELSE                                                ELCDATP1
   641                 MOVE REGULAR-DAYS (2) TO HOLD-CEN-1-DA              CL**3
   642              END-IF                                              ELCDATP1
   643              MOVE 'C'        TO DC-ERROR-CODE                       CL**5
   644           END-IF                                                 ELCDATP1
   645        WHEN OTHER                                                ELCDATP1
   646           MOVE '9'           TO DC-ERROR-CODE                       CL**5
   647     END-EVALUATE.                                                ELCDATP1
   648                                                                  ELCDATP1
   649     IF NO-CONVERSION-ERROR                                       ELCDATP1
   650         PERFORM 0200-DATE-CONVERSION-ROUTINES.                   ELCDATP1
   651                                                                  ELCDATP1
   652                                                                  ELDATCX
   653 0100-EXIT.                                                       ELDATCX
   654     MOVE ZEROS                  TO RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SUNATCX.cbl
   655     GOBACK.                                                      ELDATCX
   656                                                                     CL*14
   658 0200-DATE-CONVERSION-ROUTINES SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SUNATCX.cbl
*                                             COPY ELCDATP2.            ELDATCX
   659* 11-16-98: JJPA -  ADDED CODE TO FIX Y2K ERROR -
   660* 11-16-98: JJPA -  MOVE CCYY TO DC-EDITB-CENT/-YEAR
   661******************************************************************05/26/98
   662*                                                                *ELCDATP2
   663*                                                                *ELCDATP2
   664*                            ELCDATP2.                           *   LV078
   665*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**8
   666*                            VMOD=2.005                          *ELCDATP2
   667*                                                                *ELCDATP2
   668*                       DATE CONVERSION ROUTINE                  *ELCDATP2
   669*                                                                *ELCDATP2
   670******************************************************************ELCDATP2
   671                                                                  ELCDATP2
   672     IF BIN-PLUS-ELAPSED  OR                                      ELCDATP2
   673        BIN-PLUS-ELAPSED-3                                           CL**9
   674         COMPUTE WS-BINARY-DATE-2 = (((YEAR1 * 12) +              ELCDATP2
   675                                    (MONTH1 - 1)) * 32) + DAY1    ELCDATP2
   676         MOVE WS-BINARY-DATE-2   TO  BIN-DATE                     ELCDATP2
   677         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-2                ELCDATP2
   678         MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-2         ELCDATP2
   679     ELSE                                                         ELCDATP2
   680         COMPUTE WS-BINARY-DATE-1 = (((YEAR1 * 12) +              ELCDATP2
   681                                    (MONTH1 - 1)) * 32) + DAY1    ELCDATP2
   682         MOVE WS-BINARY-DATE-1   TO  BIN-DATE                     ELCDATP2
   683         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-1                ELCDATP2
   684         MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-1.           CL**9
   685                                                                  ELCDATP2
   686     SET MTHX TO MONTH1.                                          ELCDATP2
   687                                                                  ELCDATP2
   688*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.        ELCDATP2
   689                                                                  ELCDATP2
   690     MOVE '/'                    TO  SLASH1-1  SLASH1-2           ELCDATP2
   691                                     SLASH2-1  SLASH2-2           ELCDATP2
   692                                     SLASHA-1  SLASHA-2           ELCDATP2
   693                                     SLASHB-1  SLASHB-2.          ELCDATP2
   694                                                                  ELCDATP2
   695     EVALUATE TRUE                                                   CL*73
   696        WHEN ADJUST-DOWN-100-YRS                                     CL*73
   697           IF CURRENT-CENTURY-1-N = 19                               CL*73
   698              MOVE 19               TO DC-ALPHA-CEN-N                CL*78
   699           ELSE                                                      CL*73
   700              MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N                CL*73
   701           END-IF                                                    CL*73
   702        WHEN ADJUST-UP-100-YRS                                       CL*73
   703           MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N                       CL*73
   704        WHEN DC-ALPHA-CEN-N > 0                                      CL*73
   705           CONTINUE                                                  CL*73
   706        WHEN OTHER                                                   CL*73
   707           MOVE 3 TO FIND-CENTURY-FLAG                               CL*73
   708           PERFORM 0800-FIND-CENTURY                                 CL*73
   709     END-EVALUATE.                                                   CL*73
   710                                                                  ELCDATP2
   711     MOVE MONTH1                TO DC-EDIT1-MONTH                    CL**9
   712                                   DC-YMD-MONTH                      CL**9
   713                                   DC-MDY-MONTH                      CL**9
   714                                   DC-CYMD-MONTH                     CL**9
   715                                   DC-MDCY-MONTH                     CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   716                                   DC-EDITA-MONTH                    CL**9
   717                                   DC-EDITB-MONTH.                   CL**9
   718                                                                  ELCDATP2
   719     MOVE NAME-OF-MONTH (MTHX)  TO DC-ALPHA-MONTH.                   CL**9
   720                                                                  ELCDATP2
   721     MOVE DAYS-IN-MONTH (MTHX)  TO DC-DAYS-IN-MONTH.                 CL**9
   722                                                                  ELCDATP2
   723     MOVE DAY1                  TO DC-EDIT1-DAY                      CL**9
   724                                   DC-YMD-DAY                        CL**9
   725                                   DC-MDY-DAY                        CL**9
   726                                   DC-CYMD-DAY                       CL**9
   727                                   DC-MDCY-DAY                       CL**9
   728                                   DC-ALPHA-DAY                      CL**9
   729                                   DC-EDITA-DAY                      CL**9
   730                                   DC-EDITB-DAY.                     CL**9
   731                                                                  ELCDATP2
   732     MOVE YEAR1                 TO DC-EDIT1-YEAR                     CL**9
   733                                   DC-YMD-YEAR                       CL**9
   734                                   DC-MDY-YEAR                       CL**9
   735                                   DC-CYMD-YEAR                      CL**9
   736                                   DC-MDCY-YEAR                      CL**9
   737                                   DC-ALPHA-YEAR                     CL**9
   738                                   DC-EDITA-YEAR                     CL**9
   739                                   DC-EDITB-YEAR.                    CL**9
   740                                                                  ELCDATP2
   741     MOVE DC-ALPHA-CEN-N        TO DC-EDITA-CENT                     CL**9
   742                                   DC-EDITB-CENT                     CL**9
   743                                   DC-CYMD-CEN                       CL**9
   744                                   DC-MDCY-CEN.                      CL**9
   745                                                                  ELCDATP2
   746     IF JULIAN-TO-BIN                                             ELCDATP2
   747         MOVE WORK-JULIAN-1     TO WORK-JULIAN                       CL**9
   748         PERFORM 0250-CALCULATE-DAY-OF-WEEK                       ELCDATP2
   749         MOVE DAY-OF-WEEK-X     TO DC-DAY-OF-WEEK                    CL**9
   750         GO TO 0200-EXIT.                                         ELCDATP2
   751                                                                  ELCDATP2
   752     MOVE YEAR1                 TO JULIAN-YEAR1.                     CL**9
   753                                                                  ELCDATP2
   754     IF A-LEAP-YEAR                                               ELCDATP2
   755         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY1                  ELCDATP2
   756       ELSE                                                       ELCDATP2
   757         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY1.                 ELCDATP2
   758                                                                  ELCDATP2
   759     ADD DAY1 TO JULIAN-DAY1.                                     ELCDATP2
   760                                                                  ELCDATP2
   761     MOVE JULIAN-YEAR1           TO DC-JULIAN-YEAR                   CL**9
   762                                    DC-JULIAN-1-YR.                  CL**9
   763     MOVE JULIAN-DAY1            TO DC-JULIAN-DAYS                   CL**9
   764                                    DC-JULIAN-DA-1.                  CL**9
   765     MOVE DC-ALPHA-CEN-N         TO DC-JULIAN-1-CC.                  CL**9
   766                                                                  ELCDATP2
   767                                                                  ELCDATP2
   768     MOVE WORK-JULIAN-1          TO WORK-JULIAN.                     CL**9
   769     PERFORM 0250-CALCULATE-DAY-OF-WEEK.                          ELCDATP2
   770     MOVE DAY-OF-WEEK-X          TO DC-DAY-OF-WEEK.                  CL**9
   771                                                                  ELCDATP2
   772     IF ELAPSED-BETWEEN-BIN OR                                       CL**9
   773        ELAPSED-BETWEEN-BIN-3                                        CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   774         MOVE YEAR2              TO YR-2                             CL**9
   775         MOVE MONTH2             TO DC-EDIT2-MONTH                   CL**9
   776         MOVE DAY2               TO DC-EDIT2-DAY                     CL**9
   777         MOVE YEAR2-YR           TO DC-EDIT2-YEAR                    CL**9
   778                                    DC-EDITB-YEAR                    CL**9
   779         MOVE YEAR2-CEN-CD       TO SEARCH-CENTURY-CD-N              CL**9
   780         MOVE 1                  TO FIND-CENTURY-FLAG                CL**9
   781         PERFORM 0800-FIND-CENTURY                                ELCDATP2
   782         IF NO-CONVERSION-ERROR                                   ELCDATP2
   783            MOVE FOUND-CENTURY-N TO DC-EDITB-CENT                 ELCDATP2
   784         ELSE                                                     ELCDATP2
   785            GO TO 0200-EXIT                                       ELCDATP2
   786         END-IF                                                   ELCDATP2
   787         PERFORM 0600-ELAPSED-TIME-CALCULATIONS.                  ELCDATP2
   788                                                                  ELCDATP2
   789     IF ELAPSED-BETWEEN-BIN   OR                                     CL**9
   790        ELAPSED-BETWEEN-BIN-3 OR                                     CL**9
   791        BIN-PLUS-ELAPSED      OR                                     CL**9
   792        BIN-PLUS-ELAPSED-3                                           CL**9
   793         MOVE WORK-JULIAN-2      TO WORK-JULIAN                      CL**9
   794         PERFORM 0250-CALCULATE-DAY-OF-WEEK                       ELCDATP2
   795         MOVE DAY-OF-WEEK-X      TO DC-DAY-OF-WEEK2                  CL**9
   796       ELSE                                                       ELCDATP2
   797         MOVE ZERO               TO DC-DAY-OF-WEEK2.                 CL**9
   798                                                                  ELCDATP2
   799 0200-EXIT.                                                       ELCDATP2
   800     EXIT.                                                        ELCDATP2
   801                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   803 0250-CALCULATE-DAY-OF-WEEK SECTION.                              ELCDATP2
   804                                                                  ELCDATP2
   805     COMPUTE WS-DAY-OF-CENTURY =                                  ELCDATP2
   806             (JULIAN-YEAR * +365.25) + JULIAN-DAY.                ELCDATP2
   807                                                                  ELCDATP2
   808     DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT          ELCDATP2
   809             REMAINDER DAY-OF-WEEK-X.                             ELCDATP2
   810                                                                  ELCDATP2
   811     MOVE JULIAN-YEAR        TO  CHECK-YEAR.                      ELCDATP2
   812                                                                  ELCDATP2
   813     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
   814                                                                  ELCDATP2
   815     IF NOT A-LEAP-YEAR                                           ELCDATP2
   816         ADD +1  TO  DAY-OF-WEEK-X                                ELCDATP2
   817       ELSE                                                       ELCDATP2
   818         IF DAY-OF-WEEK-X NOT > ZERO                                 CL**9
   819             MOVE +7  TO  DAY-OF-WEEK-X.                          ELCDATP2
   820                                                                  ELCDATP2
   821 0250-EXIT.                                                       ELCDATP2
   822     EXIT.                                                        ELCDATP2
   823                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   825 0300-REFORMAT-BINARY-DAYS SECTION.                               ELCDATP2
   826                                                                  ELCDATP2
   827     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          ELCDATP2
   828                                     DC-GREG-DATE-2-EDIT.         ELCDATP2
   829     MOVE '00/00/0000'           TO  DC-GREG-DATE-A-EDIT          ELCDATP2
   830                                     DC-GREG-DATE-B-EDIT.         ELCDATP2
   831                                                                  ELCDATP2
   832     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           ELCDATP2
   833                                     DC-GREG-DATE-1-MDY           ELCDATP2
   834                                     DC-GREG-DATE-CYMD               CL**5
   835                                     DC-GREG-DATE-MDCY               CL**5
   836                                     DC-JULIAN-DATE               ELCDATP2
   837                                     DC-ELAPSED-MONTHS            ELCDATP2
   838                                     DC-ODD-DAYS-OVER             ELCDATP2
   839                                     DC-ELAPSED-DAYS              ELCDATP2
   840                                     DC-DAY-OF-WEEK               ELCDATP2
   841                                     DC-DAY-OF-WEEK2.             ELCDATP2
   842                                                                  ELCDATP2
   843     IF (ELAPSED-BETWEEN-BIN AND                                     CL**9
   844         WS-BINARY-DATE-1 > WS-BINARY-DATE-2)                        CL**9
   845                    OR                                               CL**9
   846        (ELAPSED-BETWEEN-BIN-3 AND                                   CL**9
   847         WS-BINARY-DATE-1 > WS-BINARY-DATE-2)                        CL**9
   848           MOVE '4'               TO DC-ERROR-CODE                   CL**9
   849           GO TO 0300-EXIT.                                          CL**9
   850                                                                  ELCDATP2
   851     IF WS-BINARY-DATE-1 = ZERO                                   ELCDATP2
   852         MOVE '1'                TO DC-ERROR-CODE                 ELCDATP2
   853         MOVE ZERO               TO DC-GREG-DATE-1-EDIT              CL**9
   854         GO TO 0300-EXIT.                                         ELCDATP2
   855                                                                  ELCDATP2
   856     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 ELCDATP2
   857               REMAINDER DAYS-REMAINING.                          ELCDATP2
   858                                                                  ELCDATP2
   859     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   ELCDATP2
   860               REMAINDER DAY1.                                    ELCDATP2
   861                                                                  ELCDATP2
   862***  Y2K, PROJ 7744                                                  CL*28
   863     IF DAY1 = ZEROS                                                 CL*28
   864         MOVE '3'                TO DC-ERROR-CODE                    CL*30
   865         GO TO 0300-EXIT                                             CL*28
   866     END-IF                                                          CL*28
   867***  Y2K, PROJ 7744                                                  CL*28
   868                                                                     CL*28
   869     ADD +1 TO MONTH1.                                            ELCDATP2
   870                                                                  ELCDATP2
   871     MOVE YEAR1              TO CHECK-YEAR.                          CL**9
   872     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                               CL**9
   873                                                                  ELCDATP2
   874     IF ELAPSED-BETWEEN-BIN OR                                       CL**9
   875        ELAPSED-BETWEEN-BIN-3                                        CL**9
   876        CONTINUE                                                  ELCDATP2
   877     ELSE                                                         ELCDATP2
   878        GO TO 0300-EXIT.                                             CL**9
   879                                                                  ELCDATP2
   880     IF WS-BINARY-DATE-2 = ZERO                                   ELCDATP2
   881         MOVE '1'               TO DC-ERROR-CODE                     CL**9
   882         GO TO 0300-EXIT.                                         ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   883                                                                  ELCDATP2
   884     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 ELCDATP2
   885                                 REMAINDER DAYS-REMAINING.        ELCDATP2
   886                                                                  ELCDATP2
   887     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   ELCDATP2
   888                                 REMAINDER DAY2.                  ELCDATP2
   889                                                                  ELCDATP2
   890     ADD +1 TO MONTH2.                                            ELCDATP2
   891                                                                  ELCDATP2
   892 0300-EXIT.                                                       ELCDATP2
   893     EXIT.                                                        ELCDATP2
   894                                                                     CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   896 0400-REFORMAT-GREGORIAN-DATE SECTION.                            ELCDATP2
   897                                                                  ELCDATP2
   898     MOVE LOW-VALUES             TO  DC-BIN-DATE-1                ELCDATP2
   899                                     DC-BIN-DATE-2.               ELCDATP2
   900                                                                  ELCDATP2
   901     EVALUATE TRUE                                                ELCDATP2
   902        WHEN EDIT-GREG-TO-BIN OR                                     CL**9
   903             EDIT-GREG-TO-BIN-3                                      CL**9
   904           IF (DC-EDIT1-MONTH NOT NUMERIC) OR                     ELCDATP2
   905              (DC-EDIT1-DAY   NOT NUMERIC) OR                     ELCDATP2
   906              (DC-EDIT1-YEAR  NOT NUMERIC)                        ELCDATP2
   907             MOVE '2'            TO DC-ERROR-CODE                    CL**9
   908             GO TO 0400-EXIT                                      ELCDATP2
   909           END-IF                                                 ELCDATP2
   910           MOVE DC-EDIT1-MONTH   TO MONTH1                           CL**9
   911           MOVE DC-EDIT1-DAY     TO DAY1                             CL**9
   912           MOVE DC-EDIT1-YEAR    TO YEAR1                            CL**9
   913        WHEN YMD-GREG-TO-BIN OR                                      CL**9
   914             YMD-GREG-TO-BIN-3                                       CL**9
   915           IF DC-GREG-DATE-1-YMD NOT NUMERIC                      ELCDATP2
   916              MOVE '2'           TO DC-ERROR-CODE                    CL**9
   917              GO TO 0400-EXIT                                     ELCDATP2
   918           END-IF                                                 ELCDATP2
   919           MOVE DC-YMD-YEAR      TO YEAR1                            CL**9
   920           MOVE DC-YMD-MONTH     TO MONTH1                           CL**9
   921           MOVE DC-YMD-DAY       TO DAY1                             CL**9
   922           MOVE 0                TO DC-ALPHA-CEN-N                   CL**9
   923        WHEN MDY-GREG-TO-BIN OR                                      CL**9
   924             MDY-GREG-TO-BIN-3                                       CL**9
   925           IF DC-GREG-DATE-1-MDY NOT NUMERIC                      ELCDATP2
   926              MOVE '2'           TO DC-ERROR-CODE                    CL**9
   927              GO TO 0400-EXIT                                     ELCDATP2
   928           END-IF                                                 ELCDATP2
   929           MOVE DC-MDY-MONTH     TO MONTH1                           CL**9
   930           MOVE DC-MDY-DAY       TO DAY1                             CL**9
   931           MOVE DC-MDY-YEAR      TO YEAR1                            CL**9
   932           MOVE 0                TO DC-ALPHA-CEN-N                   CL**9
   933        WHEN MDCY-GREG-TO-BIN OR                                     CL**9
   934             MDCY-GREG-TO-BIN-3                                      CL**9
   935           IF DC-GREG-DATE-MDCY NOT NUMERIC                       ELCDATP2
   936              MOVE '2'           TO DC-ERROR-CODE                    CL**9
   937              GO TO 0400-EXIT                                     ELCDATP2
   938           END-IF                                                 ELCDATP2
   939           MOVE DC-MDCY-MONTH    TO MONTH1                           CL**9
   940           MOVE DC-MDCY-DAY      TO DAY1                             CL**9
   941           MOVE DC-MDCY-YEAR     TO YEAR1                            CL**9
   942           MOVE DC-MDCY-CEN      TO DC-ALPHA-CEN-N                   CL**9
   943        WHEN CYMD-GREG-TO-BIN OR                                     CL**9
   944             CYMD-GREG-TO-BIN-3                                      CL**9
   945           IF DC-GREG-DATE-CYMD NOT NUMERIC                       ELCDATP2
   946              MOVE '2'           TO DC-ERROR-CODE                    CL**9
   947              GO TO 0400-EXIT                                     ELCDATP2
   948           END-IF                                                 ELCDATP2
   949           MOVE DC-CYMD-CEN      TO DC-ALPHA-CEN-N                   CL**9
   950           MOVE DC-CYMD-YEAR     TO YEAR1                            CL**9
   951           MOVE DC-CYMD-MONTH    TO MONTH1                           CL**9
   952           MOVE DC-CYMD-DAY      TO DAY1                             CL**9
   953     END-EVALUATE                                                 ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
   954                                                                  ELCDATP2
   955     EVALUATE TRUE                                                   CL*16
   956        WHEN MONTH1 NOT NUMERIC OR                                   CL*16
   957             DAY1   NOT NUMERIC OR                                   CL*16
   958             YEAR1  NOT NUMERIC                                      CL*16
   959              MOVE '3'           TO DC-ERROR-CODE                    CL*16
   960              GO TO 0400-EXIT                                        CL*16
   961        WHEN MONTH1 = ZERO  AND                                      CL*16
   962             DAY1   = ZERO  AND                                      CL*16
   963             YEAR1  = ZERO                                           CL*16
   964              MOVE '1'           TO DC-ERROR-CODE                    CL*16
   965              GO TO 0400-EXIT                                        CL*16
   966        WHEN MONTH1 < 1 OR > 12                                      CL*16
   967              MOVE '3'           TO DC-ERROR-CODE                    CL*16
   968              GO TO 0400-EXIT                                        CL*16
   969        WHEN DAY1 < 1 OR > 31                                        CL*16
   970              MOVE '3'           TO DC-ERROR-CODE                    CL*16
   971              GO TO 0400-EXIT                                        CL*16
   972     END-EVALUATE                                                    CL*16
   973                                                                     CL*10
   974     EVALUATE TRUE                                                ELCDATP2
   975        WHEN ADJUST-DOWN-100-YRS                                     CL*74
   976           IF CURRENT-CENTURY-1-N = 19                               CL*74
   977              CONTINUE                                               CL*74
   978           ELSE                                                      CL*74
   979              MOVE '2'              TO FIND-CENTURY-FLAG             CL*74
   980              MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N              CL*74
   981              PERFORM 0800-FIND-CENTURY                              CL*75
   982              IF NO-CONVERSION-ERROR                                 CL*74
   983                 COMPUTE YEAR1 = YEAR1 +                             CL*74
   984                                    (FOUND-CENTURY-CD-N * 100)       CL*74
   985              ELSE                                                   CL*74
   986                 GO TO 0400-EXIT                                     CL*74
   987              END-IF                                                 CL*74
   988           END-IF                                                    CL*74
   989        WHEN ADJUST-UP-100-YRS                                       CL*74
   990           MOVE '2'              TO FIND-CENTURY-FLAG                CL*74
   991           MOVE NEXT-CENTURY TO SEARCH-CENTURY-N                     CL*77
   992           PERFORM 0800-FIND-CENTURY                                 CL*75
   993           IF NO-CONVERSION-ERROR                                    CL*74
   994              COMPUTE YEAR1 = YEAR1 +                                CL*74
   995                                 (FOUND-CENTURY-CD-N * 100)          CL*74
   996           ELSE                                                      CL*74
   997              GO TO 0400-EXIT                                        CL*74
   998           END-IF                                                    CL*74
   999        WHEN DC-ALPHA-CEN-N > 0                                   ELCDATP2
  1000           MOVE '2'              TO FIND-CENTURY-FLAG                CL**9
  1001           MOVE DC-ALPHA-CEN-N   TO SEARCH-CENTURY-N                 CL**9
  1002           PERFORM 0800-FIND-CENTURY                              ELCDATP2
  1003           IF NO-CONVERSION-ERROR                                 ELCDATP2
  1004              COMPUTE YEAR1 = YEAR1 + (FOUND-CENTURY-CD-N * 100)  ELCDATP2
  1005           ELSE                                                   ELCDATP2
  1006              GO TO 0400-EXIT                                     ELCDATP2
  1007           END-IF                                                 ELCDATP2
  1008        WHEN YEAR1 < W-FLOAT-YEAR                                    CL*70
  1009           COMPUTE YEAR1 = YEAR1 + CENTURY-MARK                   ELCDATP2
  1010     END-EVALUATE.                                                ELCDATP2
  1011                                                                     CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1012     MOVE YEAR1                  TO CHECK-YEAR.                      CL**9
  1013     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             ELCDATP2
  1014                                                                  ELCDATP2
  1015     IF DAY1 > DAYS-IN-MONTH (MONTH1)                                CL**9
  1016         MOVE '3'                TO DC-ERROR-CODE                    CL**9
  1017         GO TO 0400-EXIT.                                         ELCDATP2
  1018                                                                  ELCDATP2
  1019 0400-EXIT.                                                       ELCDATP2
  1020     EXIT.                                                        ELCDATP2
  1021                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1023 0500-REFORMAT-JULIAN-DATE SECTION.                               ELCDATP2
  1024                                                                  ELCDATP2
  1025     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT          ELCDATP2
  1026                                     DC-GREG-DATE-2-EDIT.         ELCDATP2
  1027                                                                  ELCDATP2
  1028*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.        ELCDATP2
  1029                                                                  ELCDATP2
  1030     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD           ELCDATP2
  1031                                     DC-GREG-DATE-1-MDY           ELCDATP2
  1032                                     DC-GREG-DATE-CYMD            ELCDATP2
  1033                                     DC-GREG-DATE-MDCY            ELCDATP2
  1034                                     DC-ELAPSED-MONTHS            ELCDATP2
  1035                                     DC-ODD-DAYS-OVER             ELCDATP2
  1036                                     DC-ALPHA-CEN-N                  CL*61
  1037                                     DC-ELAPSED-DAYS.             ELCDATP2
  1038                                                                  ELCDATP2
  1039     MOVE LOW-VALUES             TO  DC-BIN-DATE-1                ELCDATP2
  1040                                     DC-BIN-DATE-2.               ELCDATP2
  1041                                                                  ELCDATP2
  1042     IF DC-JULIAN-DATE = ZERO                                     ELCDATP2
  1043         MOVE '1'             TO DC-ERROR-CODE                       CL**9
  1044         GO TO 0500-EXIT.                                         ELCDATP2
  1045                                                                  ELCDATP2
  1046     IF DC-JULIAN-DAYS = ZERO                                     ELCDATP2
  1047         MOVE '3'             TO DC-ERROR-CODE                       CL**9
  1048         GO TO 0500-EXIT.                                         ELCDATP2
  1049                                                                  ELCDATP2
  1050     IF JULIAN-EXPANDED-TO-BIN OR                                 ELCDATP2
  1051        JULIAN-EXPANDED-TO-BIN-3                                     CL**9
  1052          MOVE DC-JULIAN-1-CC   TO DC-ALPHA-CEN-N.                   CL*54
  1053                                                                  ELCDATP2
  1054     EVALUATE TRUE                                                ELCDATP2
  1055        WHEN ADJUST-DOWN-100-YRS                                     CL*74
  1056           IF CURRENT-CENTURY-1-N = 19                               CL*74
  1057              CONTINUE                                               CL*74
  1058           ELSE                                                      CL*74
  1059              MOVE '2'              TO FIND-CENTURY-FLAG             CL*74
  1060              MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N              CL*74
  1061              PERFORM 0800-FIND-CENTURY                              CL*75
  1062              IF NO-CONVERSION-ERROR                                 CL*74
  1063                 COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +               CL*74
  1064                                    (FOUND-CENTURY-CD-N * 100)       CL*74
  1065              ELSE                                                   CL*74
  1066                 GO TO 0500-EXIT                                     CL*74
  1067              END-IF                                                 CL*74
  1068           END-IF                                                    CL*74
  1069        WHEN ADJUST-UP-100-YRS                                       CL*74
  1070           MOVE '2'              TO FIND-CENTURY-FLAG                CL*74
  1071           MOVE NEXT-CENTURY     TO SEARCH-CENTURY-N                 CL*76
  1072           PERFORM 0800-FIND-CENTURY                                 CL*75
  1073           IF NO-CONVERSION-ERROR                                    CL*74
  1074              COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +                  CL*74
  1075                                 (FOUND-CENTURY-CD-N * 100)          CL*74
  1076           ELSE                                                      CL*74
  1077              GO TO 0500-EXIT                                        CL*74
  1078           END-IF                                                    CL*74
  1079        WHEN DC-ALPHA-CEN-N > 0                                   ELCDATP2
  1080           MOVE DC-ALPHA-CEN-N        TO SEARCH-CENTURY-N            CL**9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1081           MOVE 2                     TO FIND-CENTURY-FLAG           CL**9
  1082           PERFORM 0800-FIND-CENTURY                              ELCDATP2
  1083           IF NO-CONVERSION-ERROR                                 ELCDATP2
  1084              COMPUTE JULIAN-YEAR1 =                              ELCDATP2
  1085                      JULIAN-YEAR1 + (FOUND-CENTURY-CD-N * 100)      CL**9
  1086           ELSE                                                   ELCDATP2
  1087              GO TO 0500-EXIT                                     ELCDATP2
  1088           END-IF                                                 ELCDATP2
  1089         WHEN JULIAN-YEAR1 NOT > W-FLOAT-YEAR                        CL*71
  1090                 COMPUTE JULIAN-YEAR1 =                           ELCDATP2
  1091                            JULIAN-YEAR1 + 100                    ELCDATP2
  1092     END-EVALUATE.                                                ELCDATP2
  1093                                                                  ELCDATP2
  1094     MOVE JULIAN-YEAR1           TO YEAR1                            CL**9
  1095                                    CHECK-YEAR.                      CL**9
  1096                                                                  ELCDATP2
  1097     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.             ELCDATP2
  1098                                                                  ELCDATP2
  1099     IF (A-LEAP-YEAR AND JULIAN-DAY1 > LEAP-YR-DAYS (13))            CL**9
  1100                       OR                                            CL**9
  1101        (NOT A-LEAP-YEAR AND DC-JULIAN-DAYS > REGULAR-DAYS (13))     CL**9
  1102           MOVE '3'              TO DC-ERROR-CODE                    CL**9
  1103           GO TO 0500-EXIT.                                       ELCDATP2
  1104                                                                  ELCDATP2
  1105     SET MTHX TO +1.                                              ELCDATP2
  1106                                                                  ELCDATP2
  1107     IF A-LEAP-YEAR                                               ELCDATP2
  1108         PERFORM 0550-JULIAN-LEAP-YEAR                            ELCDATP2
  1109     ELSE                                                            CL*18
  1110         PERFORM 0575-JULIAN-REGULAR-YEAR                            CL*19
  1111     END-IF                                                          CL*19
  1112     .                                                               CL*18
  1113 0500-EXIT.                                                       ELCDATP2
  1114     EXIT.                                                        ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1115/                                                                    CL*10
  1116                                                                  ELCDATP2
  1117 0550-JULIAN-LEAP-YEAR SECTION.                                      CL*10
  1118                                                                     CL*10
  1119     IF JULIAN-DAY1 NOT > LEAP-YR-DAYS (MTHX)                        CL*10
  1120         SET MTHX DOWN BY +1                                         CL*10
  1121         SET MONTH1 TO MTHX                                          CL*10
  1122         SUBTRACT LEAP-YR-DAYS (MTHX) FROM JULIAN-DAY1               CL*10
  1123                                      GIVING DAY1                    CL*10
  1124         MOVE JULIAN-YEAR1       TO  YEAR1                           CL*10
  1125       ELSE                                                          CL*10
  1126         SET MTHX UP BY +1                                           CL*10
  1127         GO TO 0550-JULIAN-LEAP-YEAR.                                CL*10
  1128                                                                     CL*10
  1129 0550-EXIT.                                                          CL*10
  1130     EXIT.                                                           CL*10
  1131                                                                     CL*10
  1132                                                                  ELCDATP2
  1133 0575-JULIAN-REGULAR-YEAR SECTION.                                ELCDATP2
  1134                                                                  ELCDATP2
  1135     IF JULIAN-DAY1 NOT > REGULAR-DAYS (MTHX)                        CL**9
  1136         SET MTHX DOWN BY +1                                      ELCDATP2
  1137         SET MONTH1 TO MTHX                                       ELCDATP2
  1138         SUBTRACT REGULAR-DAYS (MTHX) FROM JULIAN-DAY1               CL**9
  1139                                      GIVING DAY1                    CL**9
  1140         MOVE JULIAN-YEAR1       TO  YEAR1                        ELCDATP2
  1141       ELSE                                                       ELCDATP2
  1142         SET MTHX UP BY +1                                        ELCDATP2
  1143         GO TO 0575-JULIAN-REGULAR-YEAR.                          ELCDATP2
  1144                                                                  ELCDATP2
  1145 0575-EXIT.                                                       ELCDATP2
  1146     EXIT.                                                        ELCDATP2
  1147                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1149 0600-ELAPSED-TIME-CALCULATIONS SECTION.                          ELCDATP2
  1150                                                                  ELCDATP2
  1151     MOVE YEAR2                 TO JULIAN-YEAR2                      CL**9
  1152                                   CHECK-YEAR.                       CL**9
  1153     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1154                                                                  ELCDATP2
  1155     SET MTHX TO MONTH2.                                          ELCDATP2
  1156                                                                  ELCDATP2
  1157     IF A-LEAP-YEAR                                               ELCDATP2
  1158         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  ELCDATP2
  1159       ELSE                                                       ELCDATP2
  1160         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 ELCDATP2
  1161                                                                  ELCDATP2
  1162     ADD DAY2 TO JULIAN-DAY2.                                     ELCDATP2
  1163                                                                  ELCDATP2
  1164     MOVE ZERO                   TO WS-ELAPSED-DAYS.              ELCDATP2
  1165     MOVE YEAR1                  TO CHECK-YEAR.                   ELCDATP2
  1166                                                                  ELCDATP2
  1167 0600-LOOP.                                                       ELCDATP2
  1168     IF CHECK-YEAR = JULIAN-YEAR2                                 ELCDATP2
  1169         GO TO 0600-COMPUTE.                                      ELCDATP2
  1170                                                                  ELCDATP2
  1171     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1172                                                                  ELCDATP2
  1173     IF A-LEAP-YEAR                                               ELCDATP2
  1174         ADD +366 TO WS-ELAPSED-DAYS                              ELCDATP2
  1175       ELSE                                                       ELCDATP2
  1176         ADD +365 TO WS-ELAPSED-DAYS.                             ELCDATP2
  1177                                                                  ELCDATP2
  1178     ADD +1  TO  CHECK-YEAR.                                      ELCDATP2
  1179                                                                  ELCDATP2
  1180     GO TO 0600-LOOP.                                             ELCDATP2
  1181                                                                  ELCDATP2
  1182 0600-COMPUTE.                                                    ELCDATP2
  1183     ADD JULIAN-DAY2        TO WS-ELAPSED-DAYS.                      CL**9
  1184                                                                     CL**9
  1185     SUBTRACT JULIAN-DAY1 FROM WS-ELAPSED-DAYS.                   ELCDATP2
  1186                                                                  ELCDATP2
  1187     COMPUTE WS-ELAPSED-MONTHS =                                  ELCDATP2
  1188         ((YEAR2 - YEAR1) * 12) + (MONTH2 - MONTH1)               ELCDATP2
  1189                                                                  ELCDATP2
  1190     IF DAY2 = DAY1                                               ELCDATP2
  1191         MOVE ZERO               TO  DC-ODD-DAYS-OVER             ELCDATP2
  1192       ELSE                                                       ELCDATP2
  1193     IF DAY1 NOT < DAYS-IN-MONTH (MONTH1)                            CL**9
  1194         MOVE DAY2               TO  DC-ODD-DAYS-OVER             ELCDATP2
  1195         SUBTRACT +1 FROM WS-ELAPSED-MONTHS                       ELCDATP2
  1196       ELSE                                                       ELCDATP2
  1197     IF DAY2 > DAY1                                                  CL**9
  1198         SUBTRACT DAY1 FROM DAY2 GIVING DC-ODD-DAYS-OVER          ELCDATP2
  1199       ELSE                                                       ELCDATP2
  1200         COMPUTE DC-ODD-DAYS-OVER =                               ELCDATP2
  1201              (DAYS-IN-MONTH (MONTH1) - DAY1) + DAY2              ELCDATP2
  1202         SUBTRACT +1 FROM WS-ELAPSED-MONTHS.                      ELCDATP2
  1203                                                                  ELCDATP2
  1204     MOVE YEAR2                  TO CHECK-YEAR.                   ELCDATP2
  1205     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1206                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1207     IF DC-ODD-DAYS-OVER NOT < DAYS-IN-MONTH (MONTH2) AND            CL**9
  1208        DAY2 = DAYS-IN-MONTH (MONTH2)                             ELCDATP2
  1209         MOVE ZERO               TO  DC-ODD-DAYS-OVER             ELCDATP2
  1210         ADD +1 TO WS-ELAPSED-MONTHS.                             ELCDATP2
  1211                                                                  ELCDATP2
  1212 0600-MOVE.                                                       ELCDATP2
  1213     MOVE WS-ELAPSED-MONTHS      TO  DC-ELAPSED-MONTHS.           ELCDATP2
  1214     MOVE WS-ELAPSED-DAYS        TO  DC-ELAPSED-DAYS.             ELCDATP2
  1215                                                                  ELCDATP2
  1216 0600-EXIT.                                                       ELCDATP2
  1217     EXIT.                                                        ELCDATP2
  1218                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1220 0700-CALCULATE-END-DATE SECTION.                                 ELCDATP2
  1221                                                                  ELCDATP2
  1222     IF NOT CALCULATE-END-OF-MONTH                                ELCDATP2
  1223         GO TO 0700-CONTINUE.                                     ELCDATP2
  1224                                                                  ELCDATP2
  1225     IF WS-ELAPSED-MONTHS = ZERO  OR                              ELCDATP2
  1226        WS-ELAPSED-DAYS NOT = ZERO                                ELCDATP2
  1227         MOVE '2'                TO  DC-END-OF-MONTH              ELCDATP2
  1228         GO TO 0700-CONTINUE.                                     ELCDATP2
  1229                                                                  ELCDATP2
  1230     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1                 ELCDATP2
  1231             REMAINDER DAYS-REMAINING.                            ELCDATP2
  1232                                                                  ELCDATP2
  1233     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1                   ELCDATP2
  1234             REMAINDER DAY1.                                      ELCDATP2
  1235                                                                  ELCDATP2
  1236     ADD +1  TO  MONTH1.                                          ELCDATP2
  1237                                                                  ELCDATP2
  1238     SET MTHX TO MONTH1.                                          ELCDATP2
  1239                                                                  ELCDATP2
  1240     MOVE YEAR1                 TO CHECK-YEAR.                    ELCDATP2
  1241     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1242                                                                  ELCDATP2
  1243     IF DAY1 < DAYS-IN-MONTH (MTHX)                                  CL**9
  1244         MOVE '3'            TO  DC-END-OF-MONTH.                 ELCDATP2
  1245                                                                  ELCDATP2
  1246 0700-CONTINUE.                                                   ELCDATP2
  1247     COMPUTE WS-BINARY-DATE-2 = WS-BINARY-DATE-1 +                ELCDATP2
  1248             (WS-ELAPSED-MONTHS * 32).                            ELCDATP2
  1249                                                                  ELCDATP2
  1250     IF WS-BINARY-DATE-2 NOT > ZERO                                  CL**9
  1251         MOVE '5'                TO  DC-ERROR-CODE                ELCDATP2
  1252         GO TO 0700-EXIT.                                         ELCDATP2
  1253                                                                  ELCDATP2
  1254     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2                 ELCDATP2
  1255             REMAINDER DAYS-REMAINING.                            ELCDATP2
  1256                                                                  ELCDATP2
  1257     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2                   ELCDATP2
  1258             REMAINDER DAY2.                                      ELCDATP2
  1259                                                                  ELCDATP2
  1260     ADD +1 TO MONTH2.                                            ELCDATP2
  1261                                                                  ELCDATP2
  1262     SET MTHX TO MONTH2.                                          ELCDATP2
  1263                                                                  ELCDATP2
  1264     MOVE YEAR2 TO YEAR1                                          ELCDATP2
  1265                   CHECK-YEAR                                     ELCDATP2
  1266                   JULIAN-YEAR2.                                  ELCDATP2
  1267                                                                  ELCDATP2
  1268     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1269                                                                  ELCDATP2
  1270     IF A-LEAP-YEAR                                               ELCDATP2
  1271         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2                  ELCDATP2
  1272       ELSE                                                       ELCDATP2
  1273         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.                 ELCDATP2
  1274                                                                  ELCDATP2
  1275     IF DAY2 NOT < DAYS-IN-MONTH (MTHX)                              CL**9
  1276         MOVE DAYS-IN-MONTH (MTHX) TO DAY2.                       ELCDATP2
  1277                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1278     ADD DAY2 TO JULIAN-DAY2.                                     ELCDATP2
  1279                                                                  ELCDATP2
  1280 0700-ADD-DAYS.                                                   ELCDATP2
  1281     IF WS-ELAPSED-DAYS = ZERO                                    ELCDATP2
  1282         GO TO 0700-CONVERT-NEW-DATE.                             ELCDATP2
  1283                                                                  ELCDATP2
  1284     MOVE WS-ELAPSED-DAYS TO DAYS-ELAPSED.                        ELCDATP2
  1285                                                                  ELCDATP2
  1286     IF WS-ELAPSED-DAYS < ZERO                                       CL**9
  1287         MULTIPLY -1  BY  WS-ELAPSED-DAYS                         ELCDATP2
  1288         GO TO 0700-SUBTRACT-DAYS.                                ELCDATP2
  1289                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1291 0700-ADD-DAYS-LOOP.                                              ELCDATP2
  1292     IF A-LEAP-YEAR                                               ELCDATP2
  1293         MOVE 366 TO DAYS-NEEDED                                  ELCDATP2
  1294       ELSE                                                       ELCDATP2
  1295         MOVE 365 TO DAYS-NEEDED.                                 ELCDATP2
  1296                                                                  ELCDATP2
  1297     SUBTRACT JULIAN-DAY2 FROM DAYS-NEEDED.                       ELCDATP2
  1298                                                                  ELCDATP2
  1299     IF DAYS-ELAPSED NOT > DAYS-NEEDED                               CL**9
  1300         GO TO 0700-ADD-REMAINING-DAYS.                           ELCDATP2
  1301                                                                  ELCDATP2
  1302     IF DAYS-ELAPSED > ZERO                                          CL**9
  1303         SUBTRACT +1  FROM DAYS-ELAPSED.                          ELCDATP2
  1304                                                                  ELCDATP2
  1305     SUBTRACT DAYS-NEEDED FROM DAYS-ELAPSED.                      ELCDATP2
  1306                                                                  ELCDATP2
  1307     ADD +1 TO JULIAN-YEAR2.                                      ELCDATP2
  1308                                                                  ELCDATP2
  1309     MOVE +1                     TO JULIAN-DAY2.                     CL**9
  1310                                                                  ELCDATP2
  1311     MOVE JULIAN-YEAR2           TO CHECK-YEAR.                      CL**9
  1312                                                                     CL**9
  1313     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1314                                                                  ELCDATP2
  1315     GO TO 0700-ADD-DAYS-LOOP.                                    ELCDATP2
  1316                                                                  ELCDATP2
  1317 0700-ADD-REMAINING-DAYS.                                         ELCDATP2
  1318     ADD DAYS-ELAPSED TO JULIAN-DAY2.                             ELCDATP2
  1319                                                                  ELCDATP2
  1320     GO TO 0700-CALCULATE-JULIAN-DATE.                            ELCDATP2
  1321                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1323 0700-SUBTRACT-DAYS.                                              ELCDATP2
  1324     IF WS-ELAPSED-DAYS < JULIAN-DAY2                                CL**9
  1325         SUBTRACT WS-ELAPSED-DAYS FROM JULIAN-DAY2                ELCDATP2
  1326         GO TO 0700-CALCULATE-JULIAN-DATE.                        ELCDATP2
  1327                                                                  ELCDATP2
  1328     SUBTRACT JULIAN-DAY2 FROM WS-ELAPSED-DAYS.                   ELCDATP2
  1329                                                                  ELCDATP2
  1330     SUBTRACT +1  FROM JULIAN-YEAR2.                              ELCDATP2
  1331                                                                  ELCDATP2
  1332     MOVE JULIAN-YEAR2           TO  CHECK-YEAR.                  ELCDATP2
  1333     PERFORM 0900-CHECK-FOR-LEAP-YEAR.                            ELCDATP2
  1334                                                                  ELCDATP2
  1335     IF A-LEAP-YEAR                                               ELCDATP2
  1336         MOVE +366               TO  JULIAN-DAY2                  ELCDATP2
  1337       ELSE                                                       ELCDATP2
  1338         MOVE +365               TO  JULIAN-DAY2.                 ELCDATP2
  1339                                                                  ELCDATP2
  1340     GO TO 0700-SUBTRACT-DAYS.                                    ELCDATP2
  1341                                                                  ELCDATP2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1343 0700-CALCULATE-JULIAN-DATE.                                      ELCDATP2
  1344     MOVE WORK-JULIAN-2          TO  WORK-JULIAN-1.               ELCDATP2
  1345     SET MTHX TO +1.                                              ELCDATP2
  1346                                                                  ELCDATP2
  1347     IF A-LEAP-YEAR                                               ELCDATP2
  1348         PERFORM 0550-JULIAN-LEAP-YEAR                            ELCDATP2
  1349       ELSE                                                       ELCDATP2
  1350         PERFORM 0575-JULIAN-REGULAR-YEAR.                        ELCDATP2
  1351                                                                  ELCDATP2
  1352     MOVE WORK-DATE-1 TO WORK-DATE-2.                             ELCDATP2
  1353                                                                  ELCDATP2
  1354 0700-CONVERT-NEW-DATE.                                           ELCDATP2
  1355     IF CALCULATE-END-OF-MONTH                                    ELCDATP2
  1356         SET MTHX TO MONTH2                                       ELCDATP2
  1357         IF DAY2 < DAYS-IN-MONTH (MTHX)                              CL**9
  1358             MOVE DAYS-IN-MONTH (MTHX) TO  DAY2.                  ELCDATP2
  1359                                                                  ELCDATP2
  1360     MOVE WORK-DATE-2 TO WORK-DATE-1.                             ELCDATP2
  1361                                                                  ELCDATP2
  1362 0700-EXIT.                                                       ELCDATP2
  1363     EXIT.                                                        ELCDATP2
  1364                                                                  ELCDATP2
  1365*0800-FIND-CENTURY.                                               ELCDATP2
  1366 0800-FIND-CENTURY section.                                       ELCDATP2
  1367
  1368                                                                  ELCDATP2
  1369     SET CNTRY-NDX TO +1.                                         ELCDATP2
  1370     EVALUATE FIND-CENTURY-FLAG                                   ELCDATP2
  1371        WHEN 1                                                    ELCDATP2
  1372           SEARCH  CENTURY-TBL                                    ELCDATP2
  1373             AT END                                               ELCDATP2
  1374               MOVE 'A' TO DC-ERROR-CODE                          ELCDATP2
  1375           WHEN CENTURY-CODE(CNTRY-NDX) = SEARCH-CENTURY-CD-N     ELCDATP2
  1376              MOVE CENTURY(CNTRY-NDX) TO FOUND-CENTURY-N          ELCDATP2
  1377           END-SEARCH                                             ELCDATP2
  1378        WHEN 2                                                    ELCDATP2
  1379           SEARCH  CENTURY-TBL                                    ELCDATP2
  1380              AT END                                              ELCDATP2
  1381                 MOVE 'A' TO DC-ERROR-CODE                        ELCDATP2
  1382           WHEN CENTURY(CNTRY-NDX) = SEARCH-CENTURY-N             ELCDATP2
  1383              MOVE CENTURY-CODE(CNTRY-NDX) TO FOUND-CENTURY-CD-N  ELCDATP2
  1384           END-SEARCH                                             ELCDATP2
  1385        WHEN 3                                                    ELCDATP2
  1386***  Y2K                                                             CL*35
  1387*          IF YEAR1 <= CENTURY-MARK                                  CL*50
  1388           EVALUATE YEAR1 < CENTURY-MARK                             CL*55
  1389                    ALSO W-FLOAT-YEAR-YY > 34                        CL*57
  1390                WHEN TRUE ALSO TRUE                                  CL*55
  1391                    MOVE PREVIOUS-CENTURY TO                         CL*65
  1392                                   DC-ALPHA-CEN-N                    CL*64
  1393                WHEN TRUE ALSO FALSE                                 CL*55
  1394                 IF W-FLOAT-YEAR-YY < 30                             CL*51
  1395                    MOVE CURRENT-CENTURY-1-N TO                      CL*59
  1396                                   DC-ALPHA-CEN-N                    CL*59
  1397                 ELSE                                                CL*51
  1398                    MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N              CL*51
  1399                 END-IF                                              CL*51
  1400                WHEN FALSE ALSO FALSE                                CL*55
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* SUNATCX.cbl (/apps/prod/cid1p/copy/ELCDATP2)
  1401                 IF YEAR1 > BREAK-PERIOD                             CL*67
  1402                    MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N              CL*59
  1403                 ELSE                                                CL*55
  1404                    MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N          CL*59
  1405                 END-IF                                              CL*55
  1406                WHEN  OTHER                                          CL*43
  1407                 IF YEAR1 > BREAK-PERIOD                             CL*67
  1408                    MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N          CL*68
  1409                 ELSE                                                CL*62
  1410                    MOVE CURRENT-CENTURY-1-N                         CL*68
  1411                                         TO DC-ALPHA-CEN-N           CL*68
  1412                 END-IF                                              CL*62
  1413           END-EVALUATE                                              CL*57
  1414     END-EVALUATE.                                                ELCDATP2
  1415***  Y2K                                                             CL*35
  1416                                                                  ELCDATP2
  1417 0800-EXIT.                                                       ELCDATP2
  1418     EXIT.                                                        ELCDATP2
  1419                                                                  ELCDATP2
  1420 0900-CHECK-FOR-LEAP-YEAR SECTION.                                ELCDATP2
  1421                                                                  ELCDATP2
  1422     MOVE CHECK-YEAR TO CHECK-CCYY.                               ELCDATP2
  1423                                                                  ELCDATP2
  1424***  Y2K, PROJ 7744                                                  CL*26
  1425     IF CHECK-CCYY-YY > 00                                        ELCDATP2
  1426         COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 4                   CL*26
  1427     ELSE                                                         ELCDATP2
  1428         MOVE CHECK-CCYY-CC      TO SEARCH-CENTURY-CD-N              CL*26
  1429         MOVE 1                  TO FIND-CENTURY-FLAG                CL*26
  1430         PERFORM 0800-FIND-CENTURY                                   CL*26
  1431         IF NO-CONVERSION-ERROR                                      CL*26
  1432             MOVE FOUND-CENTURY-N TO CHECK-CCYY-CC                   CL*27
  1433             COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 400             CL*27
  1434         END-IF                                                      CL*26
  1435     END-IF                                                          CL*25
  1436***  Y2K, PROJ 7744                                                  CL*26
  1437                                                                  ELCDATP2
  1438     IF A-LEAP-YEAR                                               ELCDATP2
  1439         MOVE +29                TO  DAYS-IN-MONTH (2)            ELCDATP2
  1440     ELSE                                                            CL*26
  1441         MOVE +28                TO  DAYS-IN-MONTH (2).           ELCDATP2
  1442                                                                  ELCDATP2
  1443 0900-EXIT.                                                       ELCDATP2
  1444     EXIT.                                                        ELCDATP2
  1445                                                                  ELDATCX
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1184     Code:        5350
