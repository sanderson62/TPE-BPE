* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIB009S.cbl
* Options: int("CIB009S.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIB009S.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIB009S.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIB009S.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CIB009S.
     3 AUTHOR.     PABLO.
     4
     5*****************************************************************
     6*                                                               *
     7*  THIS PROGRAM SEARCHES THE FIRST 10 LINES OF A REPORT LOOKING *
     8*  FOR THE VALUE IN THE PARAMETER.  IF THE PARM IS FOUND, THE   *
     9*  ENTIRE PAGE IS PRINTED.                                      *
    10*                                                               *
    11*  THE PROGRAM ALSO INSERTS BLANK LINES INSTEAD OF PRINTER      *
    12*  CARRIAGE CONTROL CHARACTERS.                                 *
    13*                                                               *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIB009S.cbl
    14*****************************************************************
    15
    16 ENVIRONMENT DIVISION.
    17 INPUT-OUTPUT SECTION.
    18 FILE-CONTROL.
    19
    20     SELECT IN-FILE              ASSIGN TO SYS010.
    21
    22     SELECT OUT-FILE1            ASSIGN TO SYS011.
    23
    24     SELECT OUT-FILE2            ASSIGN TO SYS012.
    25
    26     SELECT OUT-FILE3            ASSIGN TO SYS013.
    27
    28     SELECT OUT-FILE4            ASSIGN TO SYS014.
    29
    30 DATA DIVISION.
    31 FILE SECTION.
    32
    33 FD  IN-FILE
    34     LABEL RECORDS ARE STANDARD
    35     RECORDING MODE IS F
    36     BLOCK CONTAINS 0 RECORDS.
    37 01  IN-REC.
    38     05  PRINT-CONTROL    PIC X.
    39     05  FICHE-RECORD     PIC X(132).
    40
    41 FD  OUT-FILE1
    42     LABEL RECORDS ARE STANDARD
    43     RECORDING MODE IS F
    44     BLOCK CONTAINS 0 RECORDS.
    45 01  OUT-RECORD1                 PIC X(133).
    46
    47 FD  OUT-FILE2
    48     LABEL RECORDS ARE STANDARD
    49     RECORDING MODE IS F
    50     BLOCK CONTAINS 0 RECORDS.
    51 01  OUT-RECORD2                 PIC X(133).
    52
    53 FD  OUT-FILE3
    54     LABEL RECORDS ARE STANDARD
    55     RECORDING MODE IS F
    56     BLOCK CONTAINS 0 RECORDS.
    57 01  OUT-RECORD3                 PIC X(133).
    58
    59 FD  OUT-FILE4
    60     LABEL RECORDS ARE STANDARD
    61     RECORDING MODE IS F
    62     BLOCK CONTAINS 0 RECORDS.
    63 01  OUT-RECORD4                 PIC X(133).
    64
    65 WORKING-STORAGE SECTION.
    66
    67 77  WS-EOF-SW                   PIC X  VALUE SPACES.
    68     88  END-OF-INPUT              VALUE 'Y'.
    69 01  BINARY.
    70     05  SUB         PIC S9(4)  VALUE +0.
    71     05  STRT        PIC S9(4)  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIB009S.cbl
    72     05  END-LINE    PIC S9(4)  VALUE +0.
    73
    74 01  FILLER.
    75     05  WS-ZERO         PIC S999  COMP-3 VALUE +0.
    76     05  BLANK-LINE      PIC X     VALUE SPACE.
    77     05  S0C7            PIC X     VALUE SPACE.
    78     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
    79     05  SYS010-STATUS   PIC XX    VALUE ZERO.
    80         88  EOF                   VALUE '10'.
    81     05  SYS011-STATUS   PIC XX    VALUE ZERO.
    82     05  IN-CNT          PIC S9(9) COMP-3 VALUE +0.
    83     05  OUT-CNT         PIC S9(9) COMP-3 VALUE +0.
    84     05  WS-CNTR         PIC S9(7) COMP-3 VALUE +0.
    85     05  WS-ON-FILE      PIC 9     VALUE 1.
    86     05  PRINT-SW        PIC X(3)  VALUE SPACE.
    87     05  WORKAREA.
    88         10  SAVE-REC OCCURS 10 TIMES PIC X(133).
    89
    90 LINKAGE SECTION.
    91
    92 01  PARM.
    93     05  PARM-LENGTH BINARY  PICTURE IS S9(4).
    94     05  PARM-VALUE  DISPLAY PICTURE IS X(100).
    95
    96 PROCEDURE DIVISION USING PARM.
    97
    98     PERFORM 0000-INIT           THRU 0000-EXIT
    99     PERFORM 0100-PROCESS        THRU 0100-EXIT
   100        UNTIL END-OF-INPUT
   101     PERFORM 0900-END-PROGRAM    THRU 0900-EXIT
   102     GOBACK
   103
   104    .
   105 0000-INIT.
   106*
   107     OPEN INPUT IN-FILE
   108
   109     OPEN OUTPUT OUT-FILE1 OUT-FILE2 OUT-FILE3 OUT-FILE4
   110
   111     COMPUTE END-LINE = LENGTH OF WORKAREA - PARM-LENGTH
   112     if parm-length > +0
   113        DISPLAY ' PARM LENGTH = ' PARM-LENGTH
   114
   115        inspect parm-value replacing
   116           all '-' by ' '
   117     end-if
   118     PERFORM 0050-READ-INPUT     THRU 0050-EXIT
   119
   120     .
   121 0000-EXIT.
   122     EXIT.
   123
   124 0050-READ-INPUT.
   125
   126     READ IN-FILE AT END
   127        SET END-OF-INPUT         TO TRUE
   128     END-READ
   129
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIB009S.cbl
   130     IF NOT END-OF-INPUT
   131        ADD +1                   TO IN-CNT
   132                                    WS-CNTR
   133     END-IF
   134
   135     .
   136 0050-EXIT.
   137     EXIT.
   138
   139 0100-PROCESS.
   140
   141     IF IN-REC (1:PARM-LENGTH) = PARM-VALUE (1:PARM-LENGTH)
   142        IF WS-CNTR > +88220
   143           MOVE ZEROS            TO WS-CNTR
   144           ADD 1                 TO WS-ON-FILE
   145        END-IF
   146     END-IF
   147
   148     EVALUATE TRUE
   149        WHEN WS-ON-FILE = 1
   150           WRITE OUT-RECORD1     FROM IN-REC
   151        WHEN WS-ON-FILE = 2
   152           WRITE OUT-RECORD2     FROM IN-REC
   153        WHEN WS-ON-FILE = 3
   154           WRITE OUT-RECORD3     FROM IN-REC
   155        WHEN WS-ON-FILE = 4
   156           WRITE OUT-RECORD4     FROM IN-REC
   157        WHEN OTHER
   158           DISPLAY ' PROBLEM WITH ON FILE ' WS-ON-FILE
   159           CALL 'DUMMY'
   160     END-EVALUATE
   161
   162     ADD +1                      TO OUT-CNT
   163
   164     PERFORM 0050-READ-INPUT     THRU 0050-EXIT
   165
   166     .
   167 0100-EXIT.
   168     EXIT.
   169
   170
   171 0900-END-PROGRAM.
   172
   173     CLOSE IN-FILE OUT-FILE1 OUT-FILE2 OUT-FILE3 OUT-FILE4
   174     DISPLAY 'RECORDS IN....' IN-CNT
   175     DISPLAY 'RECORDS OUT...' OUT-CNT
   176
   177     .
   178 0900-EXIT.
   179     EXIT.
   180
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4704     Code:        1454
