* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* SUNAMTX.cbl
* Options: int("SUNAMTX.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SUNAMTX.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SUNAMTX.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SUNAMTX.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                SUNAMTX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:19:23.
     7*                           VMOD=2.007
     8*
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* SUNAMTX.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE REMAINING AMOUNTS    *
    28*            *    FOR A CERTIFICATE.                             *
    29*            *                                                   *
    30*            *    ORIGINAL BENEFIT = CP-ORIGINAL-BENEFIT         *
    31*            *    ORIGINAL TERM   = CP-ORIGINAL-TERM             *
    32*            *    REMAINING-TERM  = CP-REMAINING-TERM            *
    33*            *    A.P.R (FOR NET PAY) = CP-LOAN-APR              *
    34*            *    BENEFIT TYPE = CP-BENEFIT-TYPE                 *
    35*            *    METHOD = CP-EARNING-METHOD                     *
    36*            *    IF COMPANY SPECIAL METHOD  - PUT COMPANY       *
    37*            *     I.D. IN CP-COMPANY-ID.                        *
    38*            *                                                   *
    39*            *****************************************************
    40 ENVIRONMENT DIVISION.
    41
    42 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* SUNAMTX.cbl
    44 WORKING-STORAGE SECTION.
    45 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    46 77  FILLER   PIC X(32) VALUE '********************************'.
    47 77  FILLER   PIC X(32) VALUE '**  ELRAMTX WORKING STORAGE   **'.
    48 77  FILLER   PIC X(32) VALUE '******** VMOD=2.007 ************'.
    49
*   50     COPY ELCRAMTW.
    51***************************************************************** 04/15/98
    52*                                                               * ELCRAMTW
    53*                                                               * ELCRAMTW
    54*                            ELCRAMTW.                          *    LV002
    55*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    56*                            VMOD=2.004                         * ELCRAMTW
    57*                                                               * ELCRAMTW
    58*****************************************************************.ELCRAMTW
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
    68* 071312  CR2012042600002  PEMA  AHL GROSS TRUNC RAMT
    69******************************************************************
    70                                                                  ELCRAMTW
    71 01  FILLER.                                                      ELCRAMTW
    72     12  WS-PASS-SW          PIC 9                  VALUE ZERO.   ELCRAMTW
    73       88 COMPUTING-CURRENT-MO                      VALUE ZERO.   ELCRAMTW
    74       88 COMPUTING-PRIOR-MO                        VALUE 1.      ELCRAMTW
    75                                                                  ELCRAMTW
    76 01  WS-WORK-MISC.                                                ELCRAMTW
    77     12  ws-extra-pmts       pic s999        comp-3.
    78     12  WS-REMAINING-TERM   PIC S9(4)V9     COMP-3.              ELCRAMTW
    79     12  WS-TEMP-RESULT      PIC S9(9)V9(6)  COMP-3.              ELCRAMTW
    80     12  WS-REMAINING-AMT    PIC S9(9)V99    COMP-3.              ELCRAMTW
    81                                                                  ELCRAMTW
    82 01  TEXAS-REG-WORK-AREAS.                                        ELCRAMTW
    83     12  TEX-FACT-1          PIC S9(9)V9(2)  COMP-3.              ELCRAMTW
    84     12  TEX-FACT-2          PIC S9(3)       COMP-3.              ELCRAMTW
    85     12  TEX-FACT-3          PIC S9(3)       COMP-3.              ELCRAMTW
    86     12  TEX-FACT-4          PIC S9(7)       COMP-3.              ELCRAMTW
    87     12  TEX-FACT-5          PIC S9(3)       COMP-3.              ELCRAMTW
    88     12  TEX-FACT-6          PIC S9(3)       COMP-3.              ELCRAMTW
    89     12  TEX-FACT-7          PIC S9(7)       COMP-3.              ELCRAMTW
    90     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.              ELCRAMTW
    91     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.              ELCRAMTW
    92                                                                  ELCRAMTW
    93 01  NET-PAY-INTERFACE.                                           ELCRAMTW
    94     12  NP-APR              PIC S9(3)V9(4)  COMP-3.              ELCRAMTW
    95     12  NP-ORIG             PIC S9(3)       COMP-3.              ELCRAMTW
    96     12  NP-LOAN-TERM        PIC S9(3)       COMP-3.              ELCRAMTW
    97     12  NP-REM              PIC S9(3)       COMP-3.              ELCRAMTW
    98     12  NP-CAP              PIC S9(3)       COMP-3.              ELCRAMTW
    99     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.              ELCRAMTW
   100     12  NP-WORK1            PIC S9(6)V9(6)  COMP-3.              ELCRAMTW
   101     12  NP-WORK2            PIC S9(6)V9(6)  COMP-3.              ELCRAMTW
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTW)
   102     12  NP-OPT              PIC X(01).                           ELCRAMTW
   103         88  NPO-STD                         VALUE ' '.           ELCRAMTW
   104         88  NPO-ALT                         VALUE 'A'.           ELCRAMTW
   105         88  NPO-SIMPLE                      VALUE 'S'.           ELCRAMTW
   106         88  NPO-2MO                         VALUE 'I'.           ELCRAMTW
   107         88  NPO-TRUNC                       VALUE 'T' 'U' 'V'.   ELCRAMTW
   108         88  NPO-TRUNC-0                     VALUE 'T'.           ELCRAMTW
   109         88  NPO-TRUNC-1                     VALUE 'U'.           ELCRAMTW
   110         88  NPO-TRUNC-2                     VALUE 'V'.           ELCRAMTW
   111         88  NPO-REFUND                      VALUE 'R'.           ELCRAMTW
   112     12  NP-TYPE             PIC X(01).                           ELCRAMTW
   113         88  NET-STD                         VALUE 'N'.           ELCRAMTW
   114         88  NET-SMP                         VALUE 'S'.           ELCRAMTW
   115                                                                  ELCRAMTW
   116 01  COMP-3-WORK-AREA         COMP-3.                             ELCRAMTW
   117     12  V               PIC SV9(9)    VALUE +.0.                 ELCRAMTW
   118     12  I               PIC SV9(9)    VALUE +.0.                 ELCRAMTW
   119     12  Y               PIC S9(2)V9(5) VALUE +.0.
   120     12  WK1             PIC S9(4)V9(9).                          ELCRAMTW
   121     12  WK2             PIC S9(4)V9(9).                          ELCRAMTW
   122     12  WK3             PIC S9(4)V9(9).                          ELCRAMTW
   123     12  K1              PIC S999,     VALUE +1.                  ELCRAMTW
   124     12  K12             PIC S999,     VALUE +12.                 ELCRAMTW
   125     12  K100            PIC S999,     VALUE +100.                ELCRAMTW
   126     12  K1000           PIC S9(7),    VALUE +1000.               ELCRAMTW
   127     12  ANNUAL-INT-RATE PIC S9(3)V9(4).                          ELCRAMTW
   128     12  ORIGINAL-TERM   PIC S999.                                ELCRAMTW
   129     12  REMAINING-TERM  PIC S999.                                ELCRAMTW
   130     12  CAPPED-TERM     PIC S999.                                ELCRAMTW
   131     12  FACTOR          PIC S9(4)V9(9).                          ELCRAMTW
   132     12  VX              PIC S9V9(8)        VALUE +0.0.           ELCRAMTW
   133     12  SV              PIC S9V9(8)        VALUE +0.0.           ELCRAMTW
   134     12  SX              PIC S9V9(8)        VALUE +0.0.           ELCRAMTW
   135     12  RA              PIC S9(6)V9(9)     VALUE +0.0.           ELCRAMTW
   136     12  N2              PIC S9(7)          VALUE +0.             ELCRAMTW
   137     12  N3              PIC S9(7)          VALUE +0.             ELCRAMTW
   138     12  K-I             PIC S9V9(8)        VALUE +0.0.           ELCRAMTW
   139     12  ODF             PIC S9(3)V9(10)    VALUE +0.0.           ELCRAMTW
   140     12  OD              PIC S9(3)V9(10)    VALUE +0.0.           ELCRAMTW
   141     12  ANGLEM          PIC S9(7)V9(10)    VALUE +0.0.           ELCRAMTW
   142     12  ANGLEN          PIC S9(7)V9(10)    VALUE +0.0.           ELCRAMTW
   143     12  ANGLEU          PIC S9(7)V9(10)    VALUE +0.0.           ELCRAMTW
   144     12  ANGLEM1         PIC S9(7)V9(10)    VALUE +0.0.           ELCRAMTW
   145     12  ANGLEN1         PIC S9(7)V9(10)    VALUE +0.0.           ELCRAMTW
   146                                                                  ELCRAMTW
   147 01  BINARY-WORK-AREA        COMP.                                ELCRAMTW
   148     12  X1      PIC S999        VALUE +0.                        ELCRAMTW
   149     12  X2      PIC S999        VALUE +0.                        ELCRAMTW
   150     12  MAX-X   PIC S9(5)       VALUE +0.                        ELCRAMTW
   151     12  B1      PIC S9(5)       VALUE +1.                        ELCRAMTW
   152     12  B2      PIC S9(5)       VALUE +2.                        ELCRAMTW
   153                                                                  ELCRAMTW
   154
*  155     COPY ELCDATE.
   156******************************************************************06/11/98
   157*                                                                *ELCDATE
   158*                                                                *ELCDATE
   159*                            ELCDATE.                            *   LV023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   160*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   161*                            VMOD=2.003                           ELCDATE
   162*                                                                *ELCDATE
   163*                                                                *ELCDATE
   164*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   165*                 LENGTH = 200                                   *   CL*19
   166******************************************************************ELCDATE
   167                                                                  ELCDATE
   168 01  DATE-CONVERSION-DATA.                                        ELCDATE
   169     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   170     12  DC-OPTION-CODE                PIC X.                        CL*15
   171         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   172         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   173         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   174         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   175         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   176         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   177         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   178         88  FIND-CENTURY               VALUE '7'.                   CL*22
   179         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   180         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   181         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   182         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   183         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   184         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   185         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   186         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   187         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   188         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   189         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   190         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   191         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   192         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   193         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   194         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   195         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   196         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   197         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   198         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   199         88  THREE-CHARACTER-BIN                                  ELCDATE
   200                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   201         88  GREGORIAN-TO-BIN                                        CL**2
   202                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   203         88  BIN-TO-GREGORIAN                                        CL**2
   204                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   205         88  JULIAN-TO-BINARY                                        CL**2
   206                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   207     12  DC-ERROR-CODE                 PIC X.                        CL*15
   208         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   209         88  DATE-CONVERSION-ERROR                                ELCDATE
   210                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   211         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   212         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   213         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   214         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   215         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   216         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   217         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   218         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   219         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   220         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   221     12  DC-END-OF-MONTH               PIC X.                        CL*15
   222         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   223     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   224         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   225         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   226         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   227     12  FILLER                        PIC X.                        CL*15
   228     12  DC-CONVERSION-DATES.                                        CL*15
   229         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   230         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   231         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   232         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   233                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   234             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   235             20  SLASH1-1              PIC X.                        CL*15
   236             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   237             20  SLASH1-2              PIC X.                        CL*15
   238             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   239         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   240         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   241                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   242             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   243             20  SLASH2-1              PIC X.                        CL*15
   244             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   245             20  SLASH2-2              PIC X.                        CL*15
   246             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   247         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   248         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   249                     DC-GREG-DATE-1-YMD.                          ELCDATE
   250             20  DC-YMD-YEAR           PIC 99.                       CL*15
   251             20  DC-YMD-MONTH          PIC 99.                       CL*15
   252             20  DC-YMD-DAY            PIC 99.                       CL*15
   253         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   254         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   255                      DC-GREG-DATE-1-MDY.                         ELCDATE
   256             20  DC-MDY-MONTH          PIC 99.                       CL*15
   257             20  DC-MDY-DAY            PIC 99.                       CL*15
   258             20  DC-MDY-YEAR           PIC 99.                       CL*15
   259         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   260             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   261             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   262             20  FILLER                PIC XX.                       CL*15
   263             20  DC-ALPHA-CENTURY.                                   CL*15
   264                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   265             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   266         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   267         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   268         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   269         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   270         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   271                                       PIC 9(05).                    CL*20
   272         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   273             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   274             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   275         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   276         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   277         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   278     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   279         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   280         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   281             20  FILLER                PIC 9(3).                     CL*15
   282             20  HOLD-CEN-1-CCYY.                                    CL*15
   283                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   284                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   285             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   286             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   287         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   288             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   289             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   290             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   291                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   292                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   293             20  FILLER                PIC 9(3).                     CL*15
   294         16  HOLD-CENTURY-1-X.                                       CL*15
   295             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   296             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   297                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   298                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   299             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   300             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   301         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   302             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   303             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   304             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   305                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   306                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   307             20  FILLER                PIC XXX.                      CL*23
   308         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   309         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   310         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   311         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   312             20  DC-JULIAN-1-CCYY.                                   CL*15
   313                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   314                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   315             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   316         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   317         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   318             20  DC-JULIAN-2-CCYY.                                   CL*15
   319                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   320                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   321             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   322         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   323             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   324             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   325             20  DC-EDITA-DAY          PIC 99.                       CL*15
   326             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   327             20  DC-EDITA-CCYY.                                      CL*15
   328                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   329                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   330         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   331             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   332             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   333             20  DC-EDITB-DAY          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCDATE)
   334             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   335             20  DC-EDITB-CCYY.                                      CL*15
   336                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   337                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   338         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   339         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   340                              DC-GREG-DATE-CYMD.                  ELCDATE
   341             20  DC-CYMD-CEN           PIC 99.                       CL*15
   342             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   343             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   344             20  DC-CYMD-DAY           PIC 99.                       CL*15
   345         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   346         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   347                              DC-GREG-DATE-MDCY.                  ELCDATE
   348             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   349             20  DC-MDCY-DAY           PIC 99.                       CL*15
   350             20  DC-MDCY-CEN           PIC 99.                       CL*15
   351             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   352    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   353        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   354    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   355    12  FILLER                         PIC X(28).                    CL*26
   356
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* SUNAMTX.cbl
   358 LINKAGE SECTION.
*  359     COPY ELCCALC.
   360******************************************************************04/15/98
   361*                                                                *ELCCALC
   362*                           ELCCALC.                            *    LV003
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   364*                            VMOD=2.025                          *   CL**3
   365*                                                                *   CL**2
   366*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   367*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   368*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   369*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   370*                                                                *   CL**2
   371*  PASSED TO ELRTRM                                              *   CL**2
   372*  -----------------                                             *   CL**2
   373*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   374*  ORIGINAL TERM                                                 *   CL**2
   375*  BEGINNING DATE                                                *   CL**2
   376*  ENDING DATE                                                   *   CL**2
   377*  COMPANY I.D.                                                  *   CL**2
   378*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   379*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   380*  FREE LOOK DAYS                                                *   CL**2
   381*                                                                *   CL**2
   382*  RETURNED FROM ELRTRM                                          *   CL**2
   383*  ---------------------                                         *   CL**2
   384*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   385*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   386*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   387*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   388*----------------------------------------------------------------*   CL**2
   389*  PASSED TO ELRAMT                                              *   CL**2
   390*  ----------------                                              *   CL**2
   391*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   392*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   393*  ORIGINAL AMOUNT                                               *   CL**2
   394*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   395*  A.P.R. - NET PAY ONLY                                         *   CL**2
   396*  METHOD                                                            CL**2
   397*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   398*  COMPANY I.D.                                                  *   CL**2
   399*  BENEFIT TYPE                                                  *   CL**2
   400*                                                                *   CL**2
   401*  RETURNED FROM ELRAMT                                          *   CL**2
   402*  --------------------                                          *   CL**2
   403*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   404*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   405*  REMAINING AMOUNT FACTOR                                           CL**2
   406*----------------------------------------------------------------*   CL**2
   407*  PASSED TO ELRESV                                              *   CL**2
   408*  -----------------                                             *   CL**2
   409*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   410*  VALUATION DATE                                                *   CL**2
   411*  PAID THRU DATE                                                *   CL**2
   412*  BENEFIT                                                       *   CL**2
   413*  INCURRED DATE                                                 *   CL**2
   414*  REPORTED DATE                                                 *   CL**2
   415*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   416*  TERM                                                          *   CL**2
   417*  CDT PERCENT                                                   *   CL**2
   418*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   419* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   420* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   421* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   422*                                                                *   CL**2
   423*  RETURNED FROM ELRESV                                          *   CL**2
   424*  --------------------                                          *   CL**2
   425*  CDT TABLE USED                                                *   CL**2
   426*  CDT FACTOR USED                                               *   CL**2
   427*  PAY TO CURRENT RESERVE                                        *   CL**2
   428*  I.B.N.R. - A/H ONLY                                           *   CL**2
   429*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   430*----------------------------------------------------------------*   CL**2
   431*  PASSED TO ELRATE                                              *   CL**2
   432*  ----------------                                              *   CL**2
   433*  CERT ISSUE DATE                                               *   CL**2
   434*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   435*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   436*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   437*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   438*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   439*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   440*  DEVIATION CODE                                                *   CL**2
   441*  ISSUE AGE                                                     *   CL**2
   442*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   443*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   444*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   445*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   446*  A.P.R.                                                        *   CL**2
   447*  METHOD                                                            CL**2
   448*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   449*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   450*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   451*  BENEFIT CODE                                                  *   CL**2
   452*  BENEFIT OVERRIDE CODE                                         *   CL**2
   453*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   454*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   455*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   456*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   457*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   458*                                                                *   CL**2
   459*  RETURNED FROM ELRATE                                          *   CL**2
   460*  --------------------                                          *   CL**2
   461*  CALCULATED PREMIUM                                            *   CL**2
   462*  PREMIUM RATE                                                  *   CL**2
   463*  MORTALITY CODE                                                *   CL**2
   464*  MAX ATTAINED AGE                                              *   CL**2
   465*  MAX AGE                                                       *   CL**2
   466*  MAX TERM                                                      *   CL**2
   467*  MAX MONTHLY BENEFIT                                           *   CL**2
   468*  MAX TOTAL BENIFIT                                             *   CL**2
   469*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   470*----------------------------------------------------------------*   CL**2
   471*  PASSED TO ELRFND                                              *   CL**2
   472*  ----------------                                              *   CL**2
   473*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   474*  REFUND DATE                                                   *   CL**2
   475*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   476*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   477*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   478*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   479*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   480*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   481*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   482*  DEVIATION CODE                                                *   CL**2
   483*  ISSUE AGE                                                     *   CL**2
   484*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   485*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   486*  PROCESS TYPE (CANCEL)                                         *   CL**2
   487*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   488*  A.P.R.                                                        *   CL**2
   489*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   490*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   491*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   492*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   493*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   494*  BENEFIT CODE                                                  *   CL**2
   495*  BENEFIT OVERRIDE CODE                                         *   CL**2
   496*                                                                *   CL**2
   497*  RETURNED FROM ELRFND                                          *   CL**2
   498*  --------------------                                          *   CL**2
   499*  CALCULATED REFUND                                             *   CL**2
   500*----------------------------------------------------------------*   CL**2
   501*  PASSED TO ELEARN                                              *   CL**2
   502*  ----------------                                              *   CL**2
   503*  CERT ISSUE DATE                                               *   CL**2
   504*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   505*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   506*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   507*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   508*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   509*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   510*  DEVIATION CODE                                                *   CL**2
   511*  ISSUE AGE                                                     *   CL**2
   512*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   513*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   514*  A.P.R.                                                        *   CL**2
   515*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   516*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   517*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   518*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   519*  BENEFIT CODE                                                  *   CL**2
   520*  BENEFIT OVERRIDE CODE                                         *   CL**2
   521*                                                                *   CL**2
   522*  RETURNED FROM ELEARN                                          *   CL**2
   523*  --------------------                                          *   CL**2
   524*  INDICATED  EARNINGS                                           *   CL**2
   525*----------------------------------------------------------------*   CL**2
   526*                 LENGTH = 450                                   *   CL**2
   527*                                                                *   CL**2
   528******************************************************************   CL**2
   529******************************************************************
   530*                   C H A N G E   L O G
   531*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   532* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   533*-----------------------------------------------------------------
   534*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   535* EFFECTIVE    NUMBER
   536*-----------------------------------------------------------------
   537* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   538* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   539* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   540* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   541* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   542* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   543* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   544* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   545* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   546* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   547******************************************************************
   548                                                                     CL**2
   549 01  CALCULATION-PASS-AREA.                                          CL**2
   550     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   551                                     COMP.                           CL**2
   552                                                                     CL**2
   553     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   554       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   555       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   556                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   557       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   558       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   559       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   560       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   561       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   562       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   563       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   564       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   565       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   566       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   567       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   568       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   569       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   570       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   571       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   572       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   573       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   574                                                                     CL**2
   575     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   576       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   577***********************  INPUT AREAS ****************************    CL**2
   578                                                                     CL**2
   579     12  CP-CALCULATION-AREA.                                        CL**2
   580         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   581         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   582         16  CP-VALUATION-DT       PIC XX.                           CL**2
   583         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   584         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   585           88  CP-AH                               VALUE 'A' 'D'     CL**2
   586                                                   'I' 'U'.          CL**2
   587           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   588           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   589         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   590         16  CP-REPORTED-DT        PIC XX.                           CL**2
   591         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   592         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   593         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   594                                     COMP-3.                         CL**2
   595         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   596                                     COMP-3.                         CL**2
   597         16  CP-CDT-METHOD         PIC X.                            CL**2
   598           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   599           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   600           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   601         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   602           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   603           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   604         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   605                                     COMP-3.                         CL**2
   606         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   607                                     COMP-3.                         CL**2
   608         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   609                                     COMP-3.                         CL**2
   610         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   611                                     COMP-3.                         CL**2
   612         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   613                                     COMP-3.                         CL**2
   614         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   615                                     COMP-3.                         CL**2
   616         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   617                                     COMP-3.                         CL**2
   618         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   619           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   620           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   621           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   622           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   623           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   624           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   625           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   626         16  CP-EARNING-METHOD     PIC X.                            CL**2
   627           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   628           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   629           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   630           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   631           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   632           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   633           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   634           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   635           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   636           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   637           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   638           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   639           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   640           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   641         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   642           88  CP-CLAIM                            VALUE '1'.        CL**2
   643           88  CP-CANCEL                           VALUE '2'.        CL**2
   644           88  CP-ISSUE                            VALUE '3'.        CL**2
   645         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   646           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   647           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   648           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   649           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   650           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   651           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   652           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   653           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   654           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   655           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   656           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   657           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   658           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   659           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   660           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   661           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   662           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   663           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   664                                                     'W' 'X'.        CL**2
   665           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   666           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   667           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   668           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   669           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   670           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   671           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   672           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   673           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   674           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   675           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   676           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   677           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   678                                                                     CL**2
   679         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   680                                     COMP-3.                         CL**2
   681         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   682         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   683         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   684         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   685         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   686           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   687               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   688         16  CP-R78-OPTION         PIC X.                            CL**2
   689           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   690           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   691                                                                     CL**2
   692         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   693         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   694         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   695         16  CP-RATE-FILE          PIC X.                            CL**2
   696         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   697                                     COMP-3.                         CL**2
   698                                                                     CL**2
   699         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   700         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   701                                                                     CL**2
   702         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   703                                     COMP-3.
   704         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   705                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   706         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   707                                     COMP-3.                         CL**2
   708         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   709                                     COMP-3.                         CL**2
   710         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   711                                     COMP-3.
   712         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   713                                  PIC S9(7)V99 COMP-3.
   714                                                                     CL**2
   715         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   716         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   717         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   718           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   719           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   720           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   721           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   722         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   723         16  CP-CARRIER            PIC X.                            CL**2
   724         16  CP-REIN-FLAG          PIC X.                            CL**2
   725         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   726           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   727                      '2' '3' '4' '5'.                               CL**2
   728           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   729           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   730           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   731           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   732           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   733           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   734           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   735           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   736         16  CP-SIG-SWITCH         PIC X.                            CL**2
   737         16  CP-RATING-METHOD      PIC X.                            CL**2
   738           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   739           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   740           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   741           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   742           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   743           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   744           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   745           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   746           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   747         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   748                                     COMP-3.                         CL**2
   749         16  CP-BEN-CATEGORY       PIC X.
   750         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   751         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   752                                   PIC S99V9(5) COMP-3.
   753         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   754         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   755                                   PIC S99V9(5) COMP-3.
   756         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   757         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   758         16  CP-EXPIRE-DT          PIC XX.
   759         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   760         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   761         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   762         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   763         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   764             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   765             88  CP-CALC-CLP              VALUE 'C'.
   766         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   767         16  CP-CANCEL-REASON      PIC X.
   768         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   769         16  CP-PMT-MODE           PIC X.
   770         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   771         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   772         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   773         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   774         16  FILLER                PIC X.
   775                                                                     CL**2
   776***************    OUTPUT FROM ELRESV   ************************     CL**2
   777                                                                     CL**2
   778         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   779                                                                     CL**2
   780         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   781                                     COMP-3.                         CL**2
   782         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   783                                     COMP-3.                         CL**2
   784         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   785                                     COMP-3.                         CL**2
   786         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   787                                     COMP-3.                         CL**2
   788         16  FILLER                PIC X(09).                        CL**2
   789***************    OUTPUT FROM ELRTRM   *************************    CL**2
   790                                                                     CL**2
   791         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   792                                     COMP-3.                         CL**2
   793         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   794                                     COMP-3.                         CL**2
   795         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   796                                     COMP-3.                         CL**2
   797         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   798                                     COMP-3.                         CL**2
   799         16  FILLER                PIC X(12).                        CL**2
   800                                                                     CL**2
   801***************    OUTPUT FROM ELRAMT   *************************    CL**2
   802                                                                     CL**2
   803         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   804                                     COMP-3.                         CL**2
   805         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   806                                     COMP-3.                         CL**2
   807         16  FILLER                PIC X(12).                        CL**2
   808                                                                     CL**2
   809***************    OUTPUT FROM ELRATE   *************************    CL**2
   810                                                                     CL**2
   811         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   812                                     COMP-3.                         CL**2
   813         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   814                                     COMP-3.                         CL**2
   815         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   816         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   817             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   818         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   819                                     COMP-3.                         CL**2
   820         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   821         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   822         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   823                                   PIC S9(7)V99 COMP-3.
   824         16  FILLER                PIC X(07).                        CL**2
   825                                                                     CL**2
   826***************    OUTPUT FROM ELRFND   *************************    CL**2
   827                                                                     CL**2
   828         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   829                                     COMP-3.                         CL**2
   830         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   831           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   832           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   833           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   834           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   835           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   836           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   837           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   838           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   839           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   840           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   841           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   842           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   843           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   844           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   845         16  FILLER                PIC X(12).                        CL**2
   846                                                                     CL**2
   847***************    OUTPUT FROM ELEARN   *************************    CL**2
   848                                                                     CL**2
   849         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   850                                     COMP-3.                         CL**2
   851         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   852                                     COMP-3.                         CL**2
   853         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   854                                     COMP-3.                         CL**2
   855         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   856                                     COMP-3.                         CL**2
   857         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
   858                                     COMP-3.                         CL**2
   859         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
   860                                     COMP-3.                         CL**2
   861         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
   862           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
   863           88  CP-E-AS-R78                         VALUE '1'.        CL**2
   864           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
   865           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
   866           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
   867           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
   868           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
   869           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
   870           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   871         16  FILLER                PIC X(12).                        CL**2
   872                                                                     CL**2
   873***************    OUTPUT FROM ELPMNT   *************************    CL**2
   874                                                                     CL**2
   875         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
   876                                     COMP-3.                         CL**2
   877         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
   878                                     COMP-3.                         CL**2
   879         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   880                                                                     CL**2
   881***************   MISC WORK AREAS    *****************************   CL**2
   882         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
   883                                     COMP-3.                         CL**2
   884         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
   885                                     COMP-3.                         CL**2
   886         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
   887                                     COMP-3.                         CL**2
   888         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
   889                                     COMP-3.                         CL**2
   890         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   891                                     COMP-3.                         CL**2
   892         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
   893                                     COMP-3.                         CL**2
   894         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
   895             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
   896             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
   897             88  IO-ERROR                         VALUE 'E'.         CL**2
   898                                                                     CL**2
   899         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
   900                                                                     CL**2
   901         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
   902                                                                     CL**2
   903         16  CP-RESERVE-REMAINING-TERM                               CL**2
   904                                   PIC S9(4)V9    VALUE ZERO         CL**2
   905                                     COMP-3.                         CL**2
   906                                                                     CL**2
   907         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
   908                                                                     CL**2
   909         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
   910                                     COMP-3.                         CL**2
   911                                                                     CL**2
   912         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
   913                                     COMP-3.                         CL**2
   914                                                                     CL**2
   915         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
   916                                     COMP-3.                         CL**2
   917                                                                     CL**2
   918         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
   919                                     COMP-3.                         CL**2
   920                                                                     CL**2
   921         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
   922                                     COMP-3.                         CL**2
   923                                                                     CL**2
   924         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
   925                                     COMP-3.                         CL**2
   926                                                                     CL**2
   927         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
   928                                     COMP-3.                         CL**2
   929                                                                     CL**2
   930         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
   931             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
   932                                                                     CL**2
   933         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
   934                                     COMP-3.                         CL**2
   935         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
   936                                     COMP-3.
   937         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCCALC)
   938         16  cp-extra-periods      pic 9 value zeros.
   939         16  cp-net-only-state     pic x value spaces.
   940         16  FILLER                PIC X(13).                        CL**2
   941******************************************************************   CL**2
   942
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* SUNAMTX.cbl
   944 PROCEDURE DIVISION USING CALCULATION-PASS-AREA.
   945
   946 000-START-REM-CALC.
*                                 COPY ELCRAMTP.
   947*****************************************************************
   948*                                                               *
   949*                                                               *
   950*                            ELCRAMTP.                          *
   951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   952*                            VMOD=2.015                         *
   953*                                                               *
   954*                CALCULATE THE REMAINING AMOUNT.                *
   955*****************************************************************
   956*****************************************************************
   957*                   C H A N G E   L O G
   958*
   959* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   960*-----------------------------------------------------------------
   961*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   962* EFFECTIVE    NUMBER
   963*-----------------------------------------------------------------
   964* 041710    2007111300001  AJRA  CALC SC NET PAY PLUS 6
   965* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   966* 032612  CR2011110200001  PEMA  AHL CHANGES
   967* 071312  CR2012042600002  PEMA  AHL GROSS TRUNC RAMT
   968* 060414  IR2014060200001  PEMA  DISAB REM AMT CHANGES
   969******************************************************************
   970
   971     MOVE ZERO                   TO  CP-RETURN-CODE
   972                                     CP-REMAINING-AMT
   973                                     CP-REMAINING-AMT-PRV
   974                                     CP-REMAMT-FACTOR
   975                                     NP-FACTOR
   976                                     WS-PASS-SW.
   977
   978 050-START.
   979     IF COMPUTING-PRIOR-MO
   980         COMPUTE WS-REMAINING-TERM = CP-REMAINING-TERM + +1
   981      ELSE
   982          MOVE CP-REMAINING-TERM   TO WS-REMAINING-TERM.
   983
   984     IF CP-BENEFIT-TYPE = 'A'
   985        IF (CP-R-MAX-MON-BEN NOT = ZEROS)
   986           and (cp-r-max-mon-ben < cp-original-benefit)
   987           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM *
   988              CP-R-MAX-MON-BEN
   989        ELSE
   990           COMPUTE CP-REMAINING-AMT = CP-REMAINING-TERM  *
   991              CP-ORIGINAL-BENEFIT
   992        END-IF
   993        GO TO 999-CALC-REM-AMT-X
   994     END-IF
   995
   996     IF CP-BENEFIT-TYPE = 'L' OR 'P'
   997         IF CP-EARN-AS-NET-PAY
   998             NEXT SENTENCE
   999         ELSE
  1000             MOVE CP-ORIGINAL-BENEFIT    TO  WS-REMAINING-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTP)
  1001             GO TO 800-CALC-REM-RESULT.
  1002
  1003     IF CP-ORIGINAL-TERM = ZERO
  1004         MOVE '4'                TO  CP-RETURN-CODE
  1005         GO TO 999-CALC-REM-AMT-X.
  1006
  1007*    IF (CP-EARN-AS-REG-BALLOON)
  1008*      AND
  1009*       (NOT CP-BALLOON-LAST-PMT)
  1010*       COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1011*         CP-ORIGINAL-BENEFIT / (CP-ORIGINAL-TERM - 1)
  1012*    ELSE
  1013
  1014     if (cp-company-id = 'AHL')
  1015        and (cp-lf-claim-calc-sw = 'Y')
  1016        and (cp-loan-term > cp-original-term)
  1017        compute ws-temp-result rounded =
  1018           cp-original-benefit / cp-loan-term
  1019     else
  1020        COMPUTE WS-TEMP-RESULT ROUNDED EQUAL
  1021                CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM
  1022     end-if
  1023
  1024     IF CP-EARN-AS-REG-BALLOON
  1025        GO TO 400-CALC-REM-BALLOON.
  1026
  1027     IF (CP-EARN-AS-NET-PAY)
  1028*       AND (CP-LOAN-APR > ZEROS)
  1029        GO TO 300-CALC-NET-PAY-REM
  1030     END-IF
  1031
  1032     IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'
  1033         GO TO 300-CALC-NET-PAY-REM.
  1034
  1035     MOVE CP-CERT-EFF-DT            TO  DC-BIN-DATE-1.
  1036     MOVE ' '                       TO  DC-OPTION-CODE.
  1037     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1038
  1039*    IF CP-STATE-STD-ABBRV IS EQUAL TO 'OH'   AND
  1040     IF (CP-STATE-STD-ABBRV IS EQUAL TO 'OH')   AND
  1041        (CP-CLASS-CODE NOT = 'L ') AND
  1042        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1043        CP-LOAN-APR IS GREATER THAN +0
  1044         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831031
  1045             GO TO 300-CALC-NET-PAY-REM.
  1046
  1047     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'   AND
  1048        CP-ORIGINAL-TERM IS GREATER THAN +61  AND
  1049        CP-LOAN-APR IS GREATER THAN +0
  1050         IF DC-GREG-DATE-CYMD IS GREATER THAN 19830318
  1051             GO TO 300-CALC-NET-PAY-REM.
  1052
  1053     IF CP-STATE-STD-ABBRV IS EQUAL TO 'UT'   AND
  1054        CP-ORIGINAL-TERM IS GREATER THAN +62  AND
  1055        CP-LOAN-APR IS GREATER THAN +0
  1056         IF DC-GREG-DATE-CYMD IS GREATER THAN 19810831  AND
  1057            DC-GREG-DATE-CYMD IS LESS    THAN 19830901
  1058             GO TO 300-CALC-NET-PAY-REM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTP)
  1059
  1060     IF CP-STATE-STD-ABBRV IS EQUAL TO 'RI'   AND
  1061        CP-ORIGINAL-TERM IS GREATER THAN +60  AND
  1062        CP-LOAN-APR IS GREATER THAN +0
  1063         IF DC-GREG-DATE-CYMD IS GREATER THAN 19831231
  1064             GO TO 300-CALC-NET-PAY-REM.
  1065
  1066     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1067         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1068         GO TO 800-CALC-REM-RESULT.
  1069
  1070     IF CP-EARN-AS-TEXAS
  1071         GO TO 200-CALC-TEXAS-REM.
  1072
  1073 100-ORDINARY-REM.
  1074
  1075     if (cp-company-id = 'AHL')
  1076        and (cp-loan-term > cp-original-term)
  1077        compute ws-temp-result rounded =
  1078           cp-original-benefit / cp-loan-term
  1079        compute ws-remaining-amt rounded = ws-temp-result *
  1080           (ws-remaining-term + cp-loan-term - cp-original-term)
  1081     else
  1082        COMPUTE WS-REMAINING-AMT ROUNDED = WS-TEMP-RESULT *
  1083                                          WS-REMAINING-TERM
  1084     end-if
  1085
  1086     GO TO 800-CALC-REM-RESULT.
  1087
  1088 200-CALC-TEXAS-REM.
  1089     DIVIDE CP-ORIGINAL-BENEFIT BY CP-ORIGINAL-TERM
  1090         GIVING TEX-FACT-1.
  1091
  1092     IF CP-PAY-FREQUENCY = ZERO
  1093         MOVE '5'                TO  CP-RETURN-CODE
  1094         GO TO 999-CALC-REM-AMT-X.
  1095
  1096     DIVIDE WS-REMAINING-TERM BY CP-PAY-FREQUENCY
  1097         GIVING TEX-FACT-2
  1098         REMAINDER TEX-FACT-3.
  1099
  1100     IF TEX-FACT-3 NOT = ZERO
  1101         ADD +1 TO TEX-FACT-2.
  1102
  1103     IF (TEX-FACT-2 * CP-PAY-FREQUENCY) = CP-ORIGINAL-TERM
  1104         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1105     ELSE
  1106         COMPUTE WS-REMAINING-AMT ROUNDED =
  1107             (TEX-FACT-1 * (TEX-FACT-2 * CP-PAY-FREQUENCY)).
  1108
  1109     GO TO 800-CALC-REM-RESULT.
  1110
  1111 300-CALC-NET-PAY-REM.
  1112
  1113     MOVE CP-LOAN-APR            TO  NP-APR.
  1114     MOVE CP-ORIGINAL-TERM       TO  NP-ORIG.
  1115     MOVE WS-REMAINING-TERM      TO  NP-REM.
  1116     MOVE CP-LOAN-TERM           TO  NP-LOAN-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTP)
  1117     MOVE CP-SPECIAL-CALC-CD     TO  NP-OPT.
  1118
  1119     IF CP-COMPANY-ID IS NOT EQUAL TO 'NCL'
  1120         GO TO 300-CONT-CALC-NET-PAY-REM.
  1121
  1122     MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1.
  1123     MOVE CP-FIRST-PAY-DATE      TO  DC-BIN-DATE-2.
  1124     MOVE '1'                    TO  DC-OPTION-CODE.
  1125     PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT.
  1126
  1127     IF DATE-CONVERSION-ERROR
  1128         MOVE '2'                TO  CP-RETURN-CODE
  1129         GO TO 999-CALC-REM-AMT-X
  1130     ELSE
  1131         MOVE DC-ELAPSED-MONTHS  TO  CP-MNTHS-TO-FIRST-PMT
  1132         MOVE DC-ODD-DAYS-OVER   TO  CP-ODD-DAYS-TO-PMT.
  1133
  1134     IF WS-REMAINING-TERM = CP-ORIGINAL-TERM
  1135         MOVE +1                 TO ODF
  1136     ELSE
  1137         COMPUTE ODF =
  1138         ((1 + (NP-APR / +1200)) ** (1 - CP-MNTHS-TO-FIRST-PMT)) /
  1139         ((1 + (CP-ODD-DAYS-TO-PMT * NP-APR / 36500))).
  1140
  1141 300-CONT-CALC-NET-PAY-REM.
  1142
  1143     PERFORM 1000-NET-TERM.
  1144
  1145     IF ANNUAL-INT-RATE = ZEROS
  1146         COMPUTE WS-REMAINING-AMT ROUNDED =
  1147             (CP-ORIGINAL-BENEFIT / CP-ORIGINAL-TERM)
  1148              * WS-REMAINING-TERM
  1149     ELSE
  1150     COMPUTE WS-REMAINING-AMT ROUNDED =
  1151             NP-FACTOR * (CP-ORIGINAL-BENEFIT / +1000).
  1152
  1153     IF CP-COMPANY-ID NOT = 'CID' AND 'AHL'
  1154        IF CP-STATE-STD-ABBRV IS EQUAL TO 'NC'
  1155                  AND
  1156           CP-EARN-AS-NET-PAY
  1157            MOVE CP-CERT-EFF-DT         TO  DC-BIN-DATE-1
  1158            MOVE ' '                    TO  DC-OPTION-CODE
  1159            PERFORM 0030-CNVT-DT THRU 0030-CNVT-EXIT
  1160            IF DC-GREG-DATE-CYMD IS GREATER THAN 19931231
  1161                GO TO 500-CALC-REM-RESULT.
  1162
  1163     evaluate true
  1164        when (cp-company-id = 'AHL')
  1165           and (cp-benefit-cd = '5M' OR '6M')
  1166           and (cp-lf-claim-calc-sw = 'Y')
  1167           move 1                to ws-extra-pmts
  1168           go to 600-calc-rem-result
  1169        when (cp-company-id = 'AHL')
  1170           and (cp-benefit-cd = '5G' or '5J' or '5S'
  1171                or '6D' or '6H' or '6R')
  1172           and (cp-lf-claim-calc-sw = 'Y')
  1173           move 2                to ws-extra-pmts
  1174           go to 600-calc-rem-result
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTP)
  1175        when (cp-company-id = 'AHL')
  1176           and (cp-benefit-cd = '5I' OR '6J')
  1177           and (cp-lf-claim-calc-sw = 'Y')
  1178           move 6                to ws-extra-pmts
  1179           go to 600-calc-rem-result
  1180        when(CP-COMPANY-ID = 'CID' AND
  1181           CP-STATE-STD-ABBRV = 'SC' AND
  1182           CP-EARN-AS-NET-PAY AND
  1183           CP-LF-CLAIM-CALC-SW = 'Y' AND
  1184           (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L'))
  1185           move 6                to ws-extra-pmts
  1186           GO TO 600-CALC-REM-RESULT
  1187     end-evaluate
  1188
  1189     GO TO 800-CALC-REM-RESULT.
  1190
  1191 400-CALC-REM-BALLOON.
  1192     IF CP-ORIGINAL-TERM LESS THAN CP-REMAINING-TERM
  1193        MOVE CP-ORIGINAL-BENEFIT TO CP-REMAINING-AMT
  1194        ADD CP-ALTERNATE-BENEFIT TO CP-REMAINING-AMT
  1195        GO TO 999-CALC-REM-AMT-X.
  1196
  1197     IF NOT CP-BALLOON-LAST-PMT
  1198        COMPUTE WS-REMAINING-AMT ROUNDED =
  1199          (WS-TEMP-RESULT * CP-REMAINING-TERM) +
  1200*         (WS-TEMP-RESULT * (CP-REMAINING-TERM - 1)) +
  1201           CP-ALTERNATE-BENEFIT
  1202     ELSE
  1203        COMPUTE WS-REMAINING-AMT ROUNDED =
  1204          (WS-TEMP-RESULT * CP-REMAINING-TERM ) +
  1205           CP-ALTERNATE-BENEFIT.
  1206
  1207     GO TO 800-CALC-REM-RESULT.
  1208
  1209 500-CALC-REM-RESULT.
  1210
  1211     IF ANNUAL-INT-RATE = ZEROS
  1212         MOVE CP-ORIGINAL-BENEFIT
  1213                              TO  WS-REMAINING-AMT
  1214         GO TO 999-CALC-REM-AMT-X.
  1215
  1216     IF REMAINING-TERM  = ZEROS
  1217         GO TO 999-CALC-REM-AMT-X.
  1218
  1219     COMPUTE ANGLEN = WK1 / I.
  1220     COMPUTE WS-TEMP-RESULT = CP-ORIGINAL-BENEFIT / ANGLEN.
  1221     COMPUTE WS-REMAINING-AMT =
  1222             WS-REMAINING-AMT + (WS-TEMP-RESULT * 3).
  1223     MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT.
  1224
  1225     GO TO 800-CALC-REM-RESULT.
  1226
  1227 600-CALC-REM-RESULT.
  1228
  1229     IF WS-REMAINING-TERM  = ZEROS
  1230         GO TO 800-CALC-REM-RESULT
  1231     END-IF.
  1232
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTP)
  1233     IF ANNUAL-INT-RATE = ZEROS
  1234         COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1235                                  CP-ORIGINAL-TERM
  1236         COMPUTE WS-REMAINING-AMT ROUNDED =
  1237             WS-TEMP-RESULT * (WS-REMAINING-TERM + WS-EXTRA-PMTS)
  1238         IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1239            MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1240         END-IF
  1241         MOVE WS-TEMP-RESULT      TO  CP-MONTHLY-PAYMENT
  1242         GO TO 800-CALC-REM-RESULT
  1243     END-IF.
  1244
  1245     COMPUTE ANGLEN = WK1 / I.
  1246     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  1247                 / (1 + I)
  1248     COMPUTE ANGLEN1 = ANGLEN / Y
  1249     COMPUTE WS-TEMP-RESULT ROUNDED = CP-ORIGINAL-BENEFIT /
  1250                                   ANGLEN1.
  1251     COMPUTE CP-SCNP-6MO-AMT ROUNDED = WS-TEMP-RESULT
  1252        * WS-EXTRA-PMTS.
  1253     COMPUTE WS-REMAINING-AMT ROUNDED =
  1254             WS-REMAINING-AMT + CP-SCNP-6MO-AMT.
  1255     IF WS-REMAINING-AMT > CP-ORIGINAL-BENEFIT
  1256         MOVE CP-ORIGINAL-BENEFIT TO WS-REMAINING-AMT
  1257     END-IF
  1258
  1259     .
  1260 800-CALC-REM-RESULT.
  1261     IF COMPUTING-CURRENT-MO
  1262        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT
  1263        MOVE NP-FACTOR        TO CP-REMAMT-FACTOR
  1264        MOVE 1                TO WS-PASS-SW
  1265        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1266           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT)
  1267           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT
  1268        END-IF
  1269        GO TO 050-START
  1270      ELSE
  1271        MOVE WS-REMAINING-AMT TO CP-REMAINING-AMT-PRV
  1272        IF (CP-R-MAX-TOT-BEN NOT = ZEROS)
  1273           AND (CP-R-MAX-TOT-BEN < CP-REMAINING-AMT-PRV)
  1274           MOVE CP-R-MAX-TOT-BEN TO CP-REMAINING-AMT-PRV
  1275        END-IF
  1276     END-IF
  1277     .
  1278 999-CALC-REM-AMT-X.
  1279
  1280
  1281     GOBACK.
  1282
  1283 0030-CNVT-DT.
  1284
  1285     CALL 'SUNATCX' USING DATE-CONVERSION-DATA.
  1286
  1287 0030-CNVT-EXIT.
  1288     EXIT.
  1290 1000-NET-TERM SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* SUNAMTX.cbl
*                                 COPY ELCRAMTN.
  1291***************************************************************** 04/15/98
  1292*                                                               * ELCRAMTN
  1293*                                                               * ELCRAMTN
  1294*                            ELCRAMTN.                          *    LV002
  1295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1296*                            VMOD=2.008                         *    CL**2
  1297*                                                               * ELCRAMTN
  1298*             CALCULATE NET PAY REMAINING AMOUNT                * ELCRAMTN
  1299*****************************************************************.ELCRAMTN
  1300                                                                  ELCRAMTN
  1301     MOVE NP-APR                 TO  ANNUAL-INT-RATE.             ELCRAMTN
  1302     MOVE NP-ORIG                TO  ORIGINAL-TERM.               ELCRAMTN
  1303     MOVE NP-REM                 TO  REMAINING-TERM.              ELCRAMTN
  1304                                                                  ELCRAMTN
  1305 1000-EDIT-DATA.                                                  ELCRAMTN
  1306     MOVE +0 TO FACTOR.                                           ELCRAMTN
  1307                                                                  ELCRAMTN
  1308     IF ANNUAL-INT-RATE = ZERO                                    ELCRAMTN
  1309         GO TO 9000-ERROR.                                        ELCRAMTN
  1310                                                                  ELCRAMTN
  1311     IF ORIGINAL-TERM  = ZERO OR                                  ELCRAMTN
  1312        REMAINING-TERM = ZERO                                     ELCRAMTN
  1313         GO TO 9500-RETURN.                                       ELCRAMTN
  1314                                                                  ELCRAMTN
  1315     IF NP-LOAN-TERM NOT NUMERIC                                  ELCRAMTN
  1316        MOVE +0 TO NP-LOAN-TERM.                                  ELCRAMTN
  1317                                                                  ELCRAMTN
  1318     IF NP-LOAN-TERM EQUAL +0                                     ELCRAMTN
  1319        MOVE ORIGINAL-TERM TO NP-LOAN-TERM.                       ELCRAMTN
  1320                                                                  ELCRAMTN
  1321     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ELCRAMTN
  1322         GO TO 9000-ERROR.                                        ELCRAMTN
  1323                                                                  ELCRAMTN
  1324*    IF ANNUAL-INT-RATE LESS THAN +3                              ELCRAMTN
  1325*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ELCRAMTN
  1326*    IF ANNUAL-INT-RATE LESS THAN +3                              ELCRAMTN
  1327*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ELCRAMTN
  1328*    IF ANNUAL-INT-RATE LESS THAN +3                              ELCRAMTN
  1329*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ELCRAMTN
  1330                                                                  ELCRAMTN
  1331     IF NPO-SIMPLE                                                ELCRAMTN
  1332         MOVE 'S'                TO  NP-TYPE                      ELCRAMTN
  1333     ELSE                                                         ELCRAMTN
  1334         MOVE 'N'                TO  NP-TYPE.                     ELCRAMTN
  1335                                                                  ELCRAMTN
  1336     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ELCRAMTN
  1337                                                                  ELCRAMTN
  1338     COMPUTE V ROUNDED = K1 / (K1 + I).                           ELCRAMTN
  1339                                                                  ELCRAMTN
  1340     IF (NP-LOAN-TERM GREATER THAN NP-ORIG)                       ELCRAMTN
  1341                AND                                               ELCRAMTN
  1342        (CP-TRUNCATED-LIFE OR CP-SPECIAL-CALC-CD = 'N')           ELCRAMTN
  1343         MOVE NP-LOAN-TERM TO MAX-X                               ELCRAMTN
  1344         COMPUTE REMAINING-TERM EQUAL REMAINING-TERM +            ELCRAMTN
  1345             (NP-LOAN-TERM - NP-ORIG)                             ELCRAMTN
  1346     ELSE                                                         ELCRAMTN
  1347         MOVE ORIGINAL-TERM TO MAX-X.                             ELCRAMTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTN)
  1348                                                                  ELCRAMTN
  1349     COMPUTE X1 = MAX-X - ORIGINAL-TERM.                          ELCRAMTN
  1350                                                                  ELCRAMTN
  1351     MOVE B1 TO X1 SX.                                            ELCRAMTN
  1352     MOVE V TO VX  SV.                                            ELCRAMTN
  1353                                                                  ELCRAMTN
  1354     IF MAX-X = B1                                                ELCRAMTN
  1355         GO TO 1000-COMPUTE-REMAINING-FACTOR.                     ELCRAMTN
  1356                                                                  ELCRAMTN
  1357 1000-VX-LOOP.                                                    ELCRAMTN
  1358     COMPUTE VX ROUNDED = VX * V.                                 ELCRAMTN
  1359                                                                  ELCRAMTN
  1360     ADD B1 TO X1.                                                ELCRAMTN
  1361                                                                  ELCRAMTN
  1362     IF X1 = REMAINING-TERM                                       ELCRAMTN
  1363         MOVE VX TO SV.                                           ELCRAMTN
  1364                                                                  ELCRAMTN
  1365     IF X1 = X2                                                   ELCRAMTN
  1366         MOVE VX TO SX.                                           ELCRAMTN
  1367                                                                  ELCRAMTN
  1368     IF X1 NOT = MAX-X                                            ELCRAMTN
  1369         GO TO 1000-VX-LOOP.                                      ELCRAMTN
  1370                                                                  ELCRAMTN
  1371 1000-COMPUTE-REMAINING-FACTOR.                                   ELCRAMTN
  1372     COMPUTE WK1 = K1 - VX.                                       ELCRAMTN
  1373                                                                  ELCRAMTN
  1374     COMPUTE WK2 = K1 - SV.                                       ELCRAMTN
  1375                                                                  ELCRAMTN
  1376     IF CP-COMPANY-ID IS EQUAL TO 'NCL'       AND                 ELCRAMTN
  1377        CP-EARN-AS-NET-PAY                                        ELCRAMTN
  1378         GO TO 2100-CHECK-NCL-NET-PAY.                            ELCRAMTN
  1379                                                                  ELCRAMTN
  1380     IF CP-COMPANY-ID IS EQUAL TO 'NCL'                           ELCRAMTN
  1381        IF CP-SPECIAL-CALC-CD IS EQUAL TO 'N'                     ELCRAMTN
  1382            IF CP-LOAN-TERM IS GREATER THAN CP-ORIGINAL-TERM      ELCRAMTN
  1383                GO TO 2100-NCL-NET-TRUNC                          ELCRAMTN
  1384            ELSE                                                  ELCRAMTN
  1385                GO TO 2100-NCL-NET-PAY.                           ELCRAMTN
  1386                                                                  ELCRAMTN
  1387*    IF CP-TRUNCATED-LIFE                                         ELCRAMTN
  1388*        IF CP-LOAN-TERM = REMAINING-TERM                         ELCRAMTN
  1389*            GO TO 2000-PREMIUM-RATE.                             ELCRAMTN
  1390                                                                  ELCRAMTN
  1391*    IF NOT CP-TRUNCATED-LIFE                                     ELCRAMTN
  1392*        IF ORIGINAL-TERM = REMAINING-TERM                        ELCRAMTN
  1393*            GO TO 2000-PREMIUM-RATE.                             ELCRAMTN
  1394                                                                  ELCRAMTN
  1395     COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.                   ELCRAMTN
  1396                                                                  ELCRAMTN
  1397     MOVE WK3 TO FACTOR.                                          ELCRAMTN
  1398                                                                  ELCRAMTN
  1399     GO TO 9500-RETURN.                                           ELCRAMTN
  1400                                                                  ELCRAMTN
  1401 2000-PREMIUM-RATE.                                               ELCRAMTN
  1402                                                                  ELCRAMTN
  1403     COMPUTE K-I = K1 + I                                         ELCRAMTN
  1404                                                                  ELCRAMTN
  1405     IF NPO-ALT OR NPO-TRUNC                                      ELCRAMTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTN)
  1406         MOVE K1                 TO  K-I.                         ELCRAMTN
  1407                                                                  ELCRAMTN
  1408     IF NPO-2MO OR NPO-TRUNC-2                                    ELCRAMTN
  1409         COMPUTE K-I = K1 + (2 * I).                              ELCRAMTN
  1410                                                                  ELCRAMTN
  1411     COMPUTE RA ROUNDED = 1 -                                     ELCRAMTN
  1412         ((X2 * (X2 + 1)) /                                       ELCRAMTN
  1413          (MAX-X * (MAX-X + 1))).                                 ELCRAMTN
  1414                                                                  ELCRAMTN
  1415     IF NET-STD                                                   ELCRAMTN
  1416         COMPUTE WK3 ROUNDED =                                    ELCRAMTN
  1417             ((I * ORIGINAL-TERM) + VX - SX) * 2 * MAX-X          ELCRAMTN
  1418         COMPUTE WK3 ROUNDED =                                    ELCRAMTN
  1419             WK3 / (( 1 - VX) * ORIGINAL-TERM * I)                ELCRAMTN
  1420         COMPUTE WK3 ROUNDED =                                    ELCRAMTN
  1421             WK3 / ((2 * MAX-X) - ORIGINAL-TERM + 1)              ELCRAMTN
  1422         COMPUTE WK3 ROUNDED =                                    ELCRAMTN
  1423             WK3 * RA * K-I.                                      ELCRAMTN
  1424                                                                  ELCRAMTN
  1425     IF NET-SMP                                                   ELCRAMTN
  1426         COMPUTE N2 = MAX-X * MAX-X                               ELCRAMTN
  1427         COMPUTE N3 = N2 * MAX-X                                  ELCRAMTN
  1428         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ELCRAMTN
  1429         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ELCRAMTN
  1430         COMPUTE WK3 ROUNDED = WK3 + (4 * MAX-X * WK1)            ELCRAMTN
  1431         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ELCRAMTN
  1432         COMPUTE WK3 ROUNDED = WK3 / (36 * (MAX-X + 1) * WK1).    ELCRAMTN
  1433                                                                  ELCRAMTN
  1434     MOVE WK3                    TO  FACTOR.                      ELCRAMTN
  1435     GO TO 9500-RETURN.                                           ELCRAMTN
  1436                                                                  ELCRAMTN
  1437 2100-CHECK-NCL-NET-PAY.                                          ELCRAMTN
  1438                                                                  ELCRAMTN
  1439     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN'    AND                ELCRAMTN
  1440        CP-ORIGINAL-TERM IS GREATER THAN +63   AND                ELCRAMTN
  1441        CP-TRUNCATED-LIFE                                         ELCRAMTN
  1442         GO TO 2100-CHECK-MINN-TRUNC.                             ELCRAMTN
  1443                                                                  ELCRAMTN
  1444     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MN' AND                   ELCRAMTN
  1445        CP-ORIGINAL-TERM IS GREATER THAN +63                      ELCRAMTN
  1446         GO TO 2100-CHECK-MINN.                                   ELCRAMTN
  1447                                                                  ELCRAMTN
  1448     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT'    AND                ELCRAMTN
  1449        CP-ORIGINAL-TERM IS GREATER THAN +63   AND                ELCRAMTN
  1450        CP-TRUNCATED-LIFE                                         ELCRAMTN
  1451         GO TO 2100-CHECK-MONTANA-TRUNC.                          ELCRAMTN
  1452                                                                  ELCRAMTN
  1453     IF CP-STATE-STD-ABBRV IS EQUAL TO 'MT' AND                   ELCRAMTN
  1454        CP-ORIGINAL-TERM IS GREATER THAN +63                      ELCRAMTN
  1455         GO TO 2100-CHECK-MONTANA.                                ELCRAMTN
  1456                                                                  ELCRAMTN
  1457     IF CP-TRUNCATED-LIFE                                         ELCRAMTN
  1458         GO TO 2100-NCL-NET-TRUNC.                                ELCRAMTN
  1459                                                                  ELCRAMTN
  1460 2100-NCL-NET-PAY.                                                ELCRAMTN
  1461                                                                  ELCRAMTN
  1462     COMPUTE ANGLEN = WK1 / I.                                    ELCRAMTN
  1463                                                                  ELCRAMTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTN)
  1464     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1465                                                                  ELCRAMTN
  1466     COMPUTE ANGLEN1 = ANGLEN * ODF.                              ELCRAMTN
  1467                                                                  ELCRAMTN
  1468     COMPUTE FACTOR = (ANGLEU / ANGLEN1) * 1000.                  ELCRAMTN
  1469                                                                  ELCRAMTN
  1470     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1471         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEN1.                ELCRAMTN
  1472                                                                  ELCRAMTN
  1473     GO TO 9500-RETURN.                                           ELCRAMTN
  1474                                                                  ELCRAMTN
  1475 2100-NCL-NET-TRUNC.                                              ELCRAMTN
  1476                                                                  ELCRAMTN
  1477     COMPUTE ANGLEM = WK1 / I.                                    ELCRAMTN
  1478                                                                  ELCRAMTN
  1479     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1480                                                                  ELCRAMTN
  1481     COMPUTE ANGLEM1 = ANGLEM * ODF.                              ELCRAMTN
  1482                                                                  ELCRAMTN
  1483     COMPUTE FACTOR = (ANGLEU / ANGLEM1) * 1000.                  ELCRAMTN
  1484                                                                  ELCRAMTN
  1485     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1486         (CP-ORIGINAL-BENEFIT * ANGLEU) / ANGLEM1.                ELCRAMTN
  1487                                                                  ELCRAMTN
  1488     GO TO 9500-RETURN.                                           ELCRAMTN
  1489                                                                  ELCRAMTN
  1490 2100-CHECK-MINN-TRUNC.                                           ELCRAMTN
  1491                                                                  ELCRAMTN
  1492     COMPUTE ANGLEM = WK1 / I.                                    ELCRAMTN
  1493                                                                  ELCRAMTN
  1494     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1495                                                                  ELCRAMTN
  1496     COMPUTE ANGLEM1 = ANGLEM * ODF.                              ELCRAMTN
  1497                                                                  ELCRAMTN
  1498     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEM1) * 1000.            ELCRAMTN
  1499                                                                  ELCRAMTN
  1500     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1501         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEM1.          ELCRAMTN
  1502                                                                  ELCRAMTN
  1503     GO TO 9500-RETURN.                                           ELCRAMTN
  1504                                                                  ELCRAMTN
  1505 2100-CHECK-MINN.                                                 ELCRAMTN
  1506                                                                  ELCRAMTN
  1507     COMPUTE ANGLEN = WK1 / I.                                    ELCRAMTN
  1508                                                                  ELCRAMTN
  1509     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1510                                                                  ELCRAMTN
  1511     COMPUTE ANGLEN1 = ANGLEN * ODF.                              ELCRAMTN
  1512                                                                  ELCRAMTN
  1513     COMPUTE FACTOR = ((ANGLEU + 2) / ANGLEN1) * 1000.            ELCRAMTN
  1514                                                                  ELCRAMTN
  1515     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1516         (CP-ORIGINAL-BENEFIT * (ANGLEU + 2)) / ANGLEN1.          ELCRAMTN
  1517                                                                  ELCRAMTN
  1518     GO TO 9500-RETURN.                                           ELCRAMTN
  1519                                                                  ELCRAMTN
  1520 2100-CHECK-MONTANA-TRUNC.                                        ELCRAMTN
  1521                                                                  ELCRAMTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* SUNAMTX.cbl (/apps/prod/cid1p/copy/ELCRAMTN)
  1522     COMPUTE ANGLEM = WK1 / I.                                    ELCRAMTN
  1523                                                                  ELCRAMTN
  1524     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1525                                                                  ELCRAMTN
  1526     COMPUTE ANGLEM1 = ANGLEM * ODF.                              ELCRAMTN
  1527                                                                  ELCRAMTN
  1528     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEM1) * 1000.            ELCRAMTN
  1529                                                                  ELCRAMTN
  1530     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1531         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEM1.          ELCRAMTN
  1532                                                                  ELCRAMTN
  1533     GO TO 9500-RETURN.                                           ELCRAMTN
  1534                                                                  ELCRAMTN
  1535 2100-CHECK-MONTANA.                                              ELCRAMTN
  1536                                                                  ELCRAMTN
  1537     COMPUTE ANGLEN = WK1 / I.                                    ELCRAMTN
  1538                                                                  ELCRAMTN
  1539     COMPUTE ANGLEU = WK2 / I.                                    ELCRAMTN
  1540                                                                  ELCRAMTN
  1541     COMPUTE ANGLEN1 = ANGLEN * ODF.                              ELCRAMTN
  1542                                                                  ELCRAMTN
  1543     COMPUTE FACTOR = ((ANGLEU + 4) / ANGLEN1) * 1000.            ELCRAMTN
  1544                                                                  ELCRAMTN
  1545     COMPUTE WS-REMAINING-AMT ROUNDED =                           ELCRAMTN
  1546         (CP-ORIGINAL-BENEFIT * (ANGLEU + 4)) / ANGLEN1.          ELCRAMTN
  1547                                                                  ELCRAMTN
  1548     GO TO 9500-RETURN.                                           ELCRAMTN
  1549                                                                  ELCRAMTN
  1550 9000-ERROR.                                                      ELCRAMTN
  1551     GO TO 9500-RETURN.                                           ELCRAMTN
  1552                                                                  ELCRAMTN
  1553 9500-RETURN.                                                     ELCRAMTN
  1554     MOVE FACTOR                 TO  NP-FACTOR.                   ELCRAMTN
  1555                                                                  ELCRAMTN
  1556 9999-EXIT.                                                       ELCRAMTN
  1557     EXIT.                                                        ELCRAMTN
  1558                                                                  ELCRAMTN
  1559
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1156     Code:        4457
