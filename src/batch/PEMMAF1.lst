* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMMAF1.cbl
* Options: int("PEMMAF1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMMAF1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMMAF1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMMAF1.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMMAF1.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9
    10     SELECT ZIP-FILE-IN          ASSIGN TO SYS010
    11        ORGANIZATION IS LINE SEQUENTIAL.
    12
    13     SELECT ERMAIL           ASSIGN TO ERMAIL
    14                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMMAF1.cbl
    15                             ACCESS IS DYNAMIC
    16                             RECORD KEY IS MA-CONTROL-PRIMARY
    17                             FILE STATUS IS ERMAIL-FILE-STATUS.
    18
    19     SELECT ELCERT           ASSIGN TO ELCERT
    20                             ORGANIZATION IS INDEXED
    21                             ACCESS IS DYNAMIC
    22                             RECORD KEY IS CM-CONTROL-PRIMARY
    23                             FILE STATUS IS ELCERT-FILE-STATUS.
    24
    25 DATA DIVISION.
    26 FILE SECTION.
    27
    28 FD  ZIP-FILE-IN
    29     BLOCK CONTAINS 0 RECORDS
    30     RECORDING MODE IS F.
    31
    32 01  ZIP-IN-REC.
    33     05  ZIP-CODE               PIC X(05).
    34     05  ZIP-STATE              PIC XX.
    35     05  FILLER                 PIC X.
    36     05  ZIP-CITY               PIC X(34).
    37     05  FILLER                 PIC X.
    38
    39 FD  ERMAIL.
    40
*   41                                 COPY ERCMAIL.
    42******************************************************************
    43*                                                                *
    44*                                                                *
    45*                            ERCMAIL                             *
    46*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    47*                            VMOD=2.003                          *
    48*                                                                *
    49*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
    50*                                                                *
    51*   FILE TYPE = VSAM,KSDS                                        *
    52*   RECORD SIZE = 374   RECFORM = FIX                            *
    53*                                                                *
    54*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
    55*   ALTERNATE PATH    = NOT USED                                 *
    56*                                                                *
    57*   LOG = YES                                                    *
    58*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
    68* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
    69* 111108                   PEMA  ADD CRED BENE ADDR2
    70******************************************************************
    71
    72 01  MAILING-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ERCMAIL)
    73     12  MA-RECORD-ID                      PIC XX.
    74         88  VALID-MA-ID                       VALUE 'MA'.
    75
    76     12  MA-CONTROL-PRIMARY.
    77         16  MA-COMPANY-CD                 PIC X.
    78         16  MA-CARRIER                    PIC X.
    79         16  MA-GROUPING.
    80             20  MA-GROUPING-PREFIX        PIC XXX.
    81             20  MA-GROUPING-PRIME         PIC XXX.
    82         16  MA-STATE                      PIC XX.
    83         16  MA-ACCOUNT.
    84             20  MA-ACCOUNT-PREFIX         PIC X(4).
    85             20  MA-ACCOUNT-PRIME          PIC X(6).
    86         16  MA-CERT-EFF-DT                PIC XX.
    87         16  MA-CERT-NO.
    88             20  MA-CERT-PRIME             PIC X(10).
    89             20  MA-CERT-SFX               PIC X.
    90
    91     12  FILLER                            PIC XX.
    92
    93     12  MA-ACCESS-CONTROL.
    94         16  MA-SOURCE-SYSTEM              PIC XX.
    95             88  MA-FROM-CREDIT                VALUE 'CR'.
    96             88  MA-FROM-VSI                   VALUE 'VS'.
    97             88  MA-FROM-WARRANTY              VALUE 'WA'.
    98             88  MA-FROM-OTHER                 VALUE 'OT'.
    99         16  MA-RECORD-ADD-DT              PIC XX.
   100         16  MA-RECORD-ADDED-BY            PIC XXXX.
   101         16  MA-LAST-MAINT-DT              PIC XX.
   102         16  MA-LAST-MAINT-BY              PIC XXXX.
   103         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
   104
   105     12  MA-PROFILE-INFO.
   106         16  MA-QUALIFY-CODE-1             PIC XX.
   107         16  MA-QUALIFY-CODE-2             PIC XX.
   108         16  MA-QUALIFY-CODE-3             PIC XX.
   109         16  MA-QUALIFY-CODE-4             PIC XX.
   110         16  MA-QUALIFY-CODE-5             PIC XX.
   111
   112         16  MA-INSURED-LAST-NAME          PIC X(15).
   113         16  MA-INSURED-FIRST-NAME         PIC X(10).
   114         16  MA-INSURED-MIDDLE-INIT        PIC X.
   115         16  MA-INSURED-ISSUE-AGE          PIC 99.
   116         16  MA-INSURED-BIRTH-DT           PIC XX.
   117         16  MA-INSURED-SEX                PIC X.
   118             88  MA-SEX-MALE                   VALUE 'M'.
   119             88  MA-SEX-FEMALE                 VALUE 'F'.
   120         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
   121
   122         16  MA-ADDRESS-CORRECTED          PIC X.
   123         16  MA-JOINT-BIRTH-DT             PIC XX.
   124*        16  FILLER                        PIC X(12).
   125
   126         16  MA-ADDRESS-LINE-1             PIC X(30).
   127         16  MA-ADDRESS-LINE-2             PIC X(30).
   128         16  MA-CITY-STATE.
   129             20  MA-CITY                   PIC X(28).
   130             20  MA-ADDR-STATE             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ERCMAIL)
   131         16  MA-ZIP.
   132             20  MA-ZIP-CODE.
   133                 24  MA-ZIP-CODE-1ST       PIC X(1).
   134                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   135                 24  FILLER                PIC X(4).
   136             20  MA-ZIP-PLUS4              PIC X(4).
   137         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
   138             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
   139             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
   140             20  FILLER                    PIC X(3).
   141
   142         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
   143
   144         16  FILLER                        PIC XXX.
   145*        16  FILLER                        PIC X(10).
   146
   147
   148     12  MA-CRED-BENE-INFO.
   149         16  MA-CRED-BENE-NAME                 PIC X(25).
   150         16  MA-CRED-BENE-ADDR                 PIC X(30).
   151         16  MA-CRED-BENE-ADDR2                PIC X(30).
   152         16  MA-CRED-BENE-CTYST.
   153             20  MA-CRED-BENE-CITY             PIC X(28).
   154             20  MA-CRED-BENE-STATE            PIC XX.
   155         16  MA-CRED-BENE-ZIP.
   156             20  MA-CB-ZIP-CODE.
   157                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
   158                     88  MA-CB-CANADIAN-POST-CODE
   159                                           VALUE 'A' THRU 'Z'.
   160                 24  FILLER                    PIC X(4).
   161             20  MA-CB-ZIP-PLUS4               PIC X(4).
   162         16  MA-CB-CANADIAN-POSTAL-CODE
   163                            REDEFINES MA-CRED-BENE-ZIP.
   164             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
   165             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
   166             20  FILLER                        PIC X(3).
   167     12  MA-POST-CARD-MAIL-DATA.
   168         16  MA-MAIL-DATA OCCURS 7.
   169             20  MA-MAIL-TYPE              PIC X.
   170                 88  MA-12MO-MAILING           VALUE '1'.
   171                 88  MA-EXP-MAILING            VALUE '2'.
   172             20  MA-MAIL-STATUS            PIC X.
   173                 88  MA-MAIL-ST-MAILED         VALUE '1'.
   174                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
   175                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
   176             20  MA-MAIL-DATE              PIC XX.
   177     12  FILLER                            PIC XX.
   178     12  FILLER                            PIC XX.
   179*    12  FILLER                            PIC X(30).
   180******************************************************************
   181
   182 FD  ELCERT.
   183
*  184                                 COPY ELCCERT.
   185******************************************************************04/15/98
   186*                                                                *ELCCERT
   187*                            ELCCERT.                            *   LV002
   188*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   189*                            VMOD=2.013                          *   CL**2
   190*                                                                *ELCCERT
   191*   FILE DESCRIPTION = CERTIFICATE MASTER                        *ELCCERT
   192*                                                                *ELCCERT
   193*   FILE TYPE = VSAM,KSDS                                        *ELCCERT
   194*   RECORD SIZE = 450  RECFORM = FIXED                           *ELCCERT
   195*                                                                *ELCCERT
   196*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *ELCCERT
   197*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *ELCCERT
   198*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *ELCCERT
   199*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *ELCCERT
   200*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *ELCCERT
   201*                                                                *ELCCERT
   202*   LOG = YES                                                    *ELCCERT
   203*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCERT
   204******************************************************************
   205*                   C H A N G E   L O G
   206*
   207* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   208*-----------------------------------------------------------------
   209*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   210* EFFECTIVE    NUMBER
   211*-----------------------------------------------------------------
   212* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   213* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   214* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   215* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   216* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   217* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   218* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   219* 032612  CR2011110200001  PEMA  AHL CHANGES
   220* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   221******************************************************************
   222                                                                  ELCCERT
   223 01  CERTIFICATE-MASTER.                                          ELCCERT
   224     12  CM-RECORD-ID                      PIC XX.                ELCCERT
   225         88  VALID-CM-ID                      VALUE 'CM'.         ELCCERT
   226                                                                  ELCCERT
   227     12  CM-CONTROL-PRIMARY.                                      ELCCERT
   228         16  CM-COMPANY-CD                 PIC X.                 ELCCERT
   229         16  CM-CARRIER                    PIC X.                 ELCCERT
   230         16  CM-GROUPING.                                         ELCCERT
   231             20  CM-GROUPING-PREFIX        PIC X(3).              ELCCERT
   232             20  CM-GROUPING-PRIME         PIC X(3).              ELCCERT
   233         16  CM-STATE                      PIC XX.                ELCCERT
   234         16  CM-ACCOUNT.                                          ELCCERT
   235             20  CM-ACCOUNT-PREFIX         PIC X(4).              ELCCERT
   236             20  CM-ACCOUNT-PRIME          PIC X(6).              ELCCERT
   237         16  CM-CERT-EFF-DT                PIC XX.                ELCCERT
   238         16  CM-CERT-NO.                                          ELCCERT
   239             20  CM-CERT-PRIME             PIC X(10).             ELCCERT
   240             20  CM-CERT-SFX               PIC X.                 ELCCERT
   241                                                                  ELCCERT
   242     12  CM-CONTROL-BY-NAME.                                      ELCCERT
   243         16  CM-COMPANY-CD-A1              PIC X.                 ELCCERT
   244         16  CM-INSURED-LAST-NAME          PIC X(15).             ELCCERT
   245         16  CM-INSURED-INITIALS.                                 ELCCERT
   246             20  CM-INSURED-INITIAL1       PIC X.                 ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   247             20  CM-INSURED-INITIAL2       PIC X.                 ELCCERT
   248                                                                  ELCCERT
   249     12  CM-CONTROL-BY-SSN.                                       ELCCERT
   250         16  CM-COMPANY-CD-A2              PIC X.                 ELCCERT
   251         16  CM-SOC-SEC-NO.                                       ELCCERT
   252             20  CM-SSN-STATE              PIC XX.                ELCCERT
   253             20  CM-SSN-ACCOUNT            PIC X(6).              ELCCERT
   254             20  CM-SSN-LN3.                                      ELCCERT
   255                 25  CM-INSURED-INITIALS-A2.                      ELCCERT
   256                     30 CM-INSURED-INITIAL1-A2   PIC X.           ELCCERT
   257                     30 CM-INSURED-INITIAL2-A2   PIC X.           ELCCERT
   258                 25 CM-PART-LAST-NAME-A2         PIC X.           ELCCERT
   259                                                                  ELCCERT
   260     12  CM-CONTROL-BY-CERT-NO.                                   ELCCERT
   261         16  CM-COMPANY-CD-A4              PIC X.                 ELCCERT
   262         16  CM-CERT-NO-A4                 PIC X(11).             ELCCERT
   263                                                                  ELCCERT
   264     12  CM-CONTROL-BY-MEMB.                                      ELCCERT
   265         16  CM-COMPANY-CD-A5              PIC X.                 ELCCERT
   266         16  CM-MEMBER-NO.                                        ELCCERT
   267             20  CM-MEMB-STATE             PIC XX.                ELCCERT
   268             20  CM-MEMB-ACCOUNT           PIC X(6).              ELCCERT
   269             20  CM-MEMB-LN4.                                     ELCCERT
   270                 25  CM-INSURED-INITIALS-A5.                      ELCCERT
   271                     30 CM-INSURED-INITIAL1-A5   PIC X.           ELCCERT
   272                     30 CM-INSURED-INITIAL2-A5   PIC X.           ELCCERT
   273                 25 CM-PART-LAST-NAME-A5         PIC XX.          ELCCERT
   274                                                                  ELCCERT
   275     12  CM-INSURED-PROFILE-DATA.                                 ELCCERT
   276         16  CM-INSURED-FIRST-NAME.                               ELCCERT
   277             20  CM-INSURED-1ST-INIT       PIC X.                 ELCCERT
   278             20  FILLER                    PIC X(9).              ELCCERT
   279         16  CM-INSURED-ISSUE-AGE          PIC 99.                ELCCERT
   280         16  CM-INSURED-SEX                PIC X.                 ELCCERT
   281             88  CM-SEX-MALE                  VALUE 'M'.          ELCCERT
   282             88  CM-SEX-FEMAL                 VALUE 'F'.          ELCCERT
   283         16  CM-INSURED-JOINT-AGE          PIC 99.                ELCCERT
   284         16  CM-JOINT-INSURED-NAME.                               ELCCERT
   285             20  CM-JT-LAST-NAME           PIC X(15).             ELCCERT
   286             20  CM-JT-FIRST-NAME.                                ELCCERT
   287                 24  CM-JT-1ST-INIT        PIC X.                 ELCCERT
   288                 24  FILLER                PIC X(9).              ELCCERT
   289             20  CM-JT-INITIAL             PIC X.                 ELCCERT
   290                                                                  ELCCERT
   291     12  CM-LIFE-DATA.                                            ELCCERT
   292         16  CM-LF-BENEFIT-CD              PIC XX.                ELCCERT
   293         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   294         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   295         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.  ELCCERT
   296         16  CM-LF-DEV-CODE                PIC XXX.               ELCCERT
   297         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   298         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.  ELCCERT
   299         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   300         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.  ELCCERT
   301         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   302         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   303         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   304         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   305         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.  ELCCERT
   306         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   307         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   308         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.  ELCCERT
   309         16  cm-temp-epiq                  pic xx.
   310             88  EPIQ-CLASS                  value 'EQ'.
   311*        16  FILLER                        PIC XX.                ELCCERT
   312                                                                  ELCCERT
   313     12  CM-AH-DATA.                                              ELCCERT
   314         16  CM-AH-BENEFIT-CD              PIC XX.                ELCCERT
   315         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.  ELCCERT
   316         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.  ELCCERT
   317         16  CM-AH-DEV-CODE                PIC XXX.               ELCCERT
   318         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.  ELCCERT
   319         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   320         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.  ELCCERT
   321         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.  ELCCERT
   322         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.  ELCCERT
   323         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.  ELCCERT
   324         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.  ELCCERT
   325         16  CM-AH-PAID-THRU-DT            PIC XX.                ELCCERT
   326             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.    ELCCERT
   327         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.  ELCCERT
   328         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.  ELCCERT
   329         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.  ELCCERT
   330         16  FILLER                        PIC X.                 ELCCERT
   331                                                                  ELCCERT
   332     12  CM-LOAN-INFORMATION.                                     ELCCERT
   333         16  CM-LIVES                      PIC S9(7)     COMP-3.  ELCCERT
   334         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   335                                           PIC S9(5)V99  COMP-3.
   336         16  CM-BILLED                     PIC S9(7)     COMP-3.  ELCCERT
   337         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.  ELCCERT
   338         16  CM-PAY-FREQUENCY              PIC S99.               ELCCERT
   339         16  CM-LOAN-TERM                  PIC S999      COMP-3.  ELCCERT
   340         16  CM-RATE-CLASS                 PIC XX.                ELCCERT
   341         16  CM-BENEFICIARY                PIC X(25).             ELCCERT
   342         16  CM-POLICY-FORM-NO             PIC X(12).             ELCCERT
   343         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.  ELCCERT
   344         16  CM-LAST-ADD-ON-DT             PIC XX.                ELCCERT
   345         16  CM-DEDUCTIBLE-AMOUNTS.                               ELCCERT
   346             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.  ELCCERT
   347             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.  ELCCERT
   348         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.    ELCCERT
   349             20  CM-RESIDENT-STATE         PIC XX.                ELCCERT
   350             20  CM-RATE-CODE              PIC X(4).              ELCCERT
   351             20  FILLER                    PIC XX.                ELCCERT
   352         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.              ELCCERT
   353             20  CM-LOAN-OFFICER           PIC X(5).              ELCCERT
   354             20  FILLER                    PIC XXX.               ELCCERT
   355         16  CM-CSR-CODE                   PIC XXX.               ELCCERT
   356         16  CM-UNDERWRITING-CODE          PIC X.                 ELCCERT
   357             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.          ELCCERT
   358         16  CM-POST-CARD-IND              PIC X.
   359         16  CM-NH-INTERFACE-SW            PIC X.
   360         16  CM-PREMIUM-TYPE               PIC X.                 ELCCERT
   361             88  CM-SING-PRM                  VALUE '1'.          ELCCERT
   362             88  CM-O-B-COVERAGE              VALUE '2'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   363             88  CM-OPEN-END                  VALUE '3'.          ELCCERT
   364         16  CM-IND-GRP-TYPE               PIC X.                 ELCCERT
   365             88  CM-INDIVIDUAL                VALUE 'I'.          ELCCERT
   366             88  CM-GROUP                     VALUE 'G'.          ELCCERT
   367         16  CM-SKIP-CODE                  PIC X.                 ELCCERT
   368             88  NO-MONTHS-SKIPPED            VALUE SPACE.        ELCCERT
   369             88  SKIP-JULY                    VALUE '1'.          ELCCERT
   370             88  SKIP-AUGUST                  VALUE '2'.          ELCCERT
   371             88  SKIP-SEPTEMBER               VALUE '3'.          ELCCERT
   372             88  SKIP-JULY-AUG                VALUE '4'.          ELCCERT
   373             88  SKIP-AUG-SEPT                VALUE '5'.          ELCCERT
   374             88  SKIP-JULY-AUG-SEPT           VALUE '6'.          ELCCERT
   375             88  SKIP-JUNE-JULY-AUG           VALUE '7'.          ELCCERT
   376             88  SKIP-JUNE                    VALUE '8'.          ELCCERT
   377             88  SKIP-JUNE-JULY               VALUE '9'.          ELCCERT
   378             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.          ELCCERT
   379             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.          ELCCERT
   380         16  CM-PAYMENT-MODE               PIC X.                 ELCCERT
   381             88  PAY-MONTHLY                  VALUE SPACE.        ELCCERT
   382             88  PAY-WEEKLY                   VALUE '1'.          ELCCERT
   383             88  PAY-SEMI-MONTHLY             VALUE '2'.          ELCCERT
   384             88  PAY-BI-WEEKLY                VALUE '3'.          ELCCERT
   385             88  PAY-SEMI-ANUALLY             VALUE '4'.          ELCCERT
   386         16  CM-LOAN-NUMBER                PIC X(8).              ELCCERT
   387         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.  ELCCERT
   388         16  CM-OLD-LOF                    PIC XXX.               ELCCERT
   389*        16  CM-LOAN-OFFICER               PIC XXX.               ELCCERT
   390         16  CM-REIN-TABLE                 PIC XXX.               ELCCERT
   391         16  CM-SPECIAL-REIN-CODE          PIC X.                 ELCCERT
   392         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   393         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.                ELCCERT
   394         16  CM-LOAN-1ST-PMT-DT            PIC XX.                ELCCERT
   395                                                                  ELCCERT
   396     12  CM-STATUS-DATA.                                          ELCCERT
   397         16  CM-ENTRY-STATUS               PIC X.                 ELCCERT
   398         16  CM-ENTRY-DT                   PIC XX.                ELCCERT
   399                                                                  ELCCERT
   400         16  CM-LF-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   401         16  CM-LF-CANCEL-DT               PIC XX.                ELCCERT
   402         16  CM-LF-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   403                                                                  ELCCERT
   404         16  CM-LF-STATUS-AT-DEATH         PIC X.                 ELCCERT
   405         16  CM-LF-DEATH-DT                PIC XX.                ELCCERT
   406         16  CM-LF-DEATH-EXIT-DT           PIC XX.                ELCCERT
   407                                                                  ELCCERT
   408         16  CM-LF-CURRENT-STATUS          PIC X.                 ELCCERT
   409             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   410                                                'M' '4' '5' '9'.  ELCCERT
   411             88  CM-LF-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   412             88  CM-LF-POLICY-PENDING         VALUE '2'.          ELCCERT
   413             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   414             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   415             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   416             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   417             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   418             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   419             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   420             88  CM-LF-CANCEL-APPLIED         VALUE '8'.          ELCCERT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   421             88  CM-LF-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   422             88  CM-LF-DECLINED               VALUE 'D'.          ELCCERT
   423             88  CM-LF-VOIDED                 VALUE 'V'.          ELCCERT
   424                                                                  ELCCERT
   425         16  CM-AH-STATUS-AT-CANCEL        PIC X.                 ELCCERT
   426         16  CM-AH-CANCEL-DT               PIC XX.                ELCCERT
   427         16  CM-AH-CANCEL-EXIT-DT          PIC XX.                ELCCERT
   428                                                                  ELCCERT
   429         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.                 ELCCERT
   430         16  CM-AH-SETTLEMENT-DT           PIC XX.                ELCCERT
   431         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.                ELCCERT
   432                                                                  ELCCERT
   433         16  CM-AH-CURRENT-STATUS          PIC X.                 ELCCERT
   434             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'   ELCCERT
   435                                                'M' '4' '5' '9'.  ELCCERT
   436             88  CM-AH-NORMAL-ENTRY           VALUE '1'.          ELCCERT
   437             88  CM-AH-POLICY-PENDING         VALUE '2'.          ELCCERT
   438             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.          ELCCERT
   439             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.          ELCCERT
   440             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.          ELCCERT
   441             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   442             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.          ELCCERT
   443             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.          ELCCERT
   444             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.          ELCCERT
   445             88  CM-AH-CANCEL-APPLIED         VALUE '8'.          ELCCERT
   446             88  CM-AH-IS-REIN-ONLY           VALUE '9'.          ELCCERT
   447             88  CM-AH-DECLINED               VALUE 'D'.          ELCCERT
   448             88  CM-AH-VOIDED                 VALUE 'V'.          ELCCERT
   449                                                                  ELCCERT
   450         16  CM-CLAIM-INTERFACE-SW         PIC X.                 ELCCERT
   451             88  NO-CLAIM-ATTACHED            VALUE SPACE.        ELCCERT
   452             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.          ELCCERT
   453             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.          ELCCERT
   454         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.    ELCCERT
   455                                                                  ELCCERT
   456         16  CM-ENTRY-BATCH                PIC X(6).              ELCCERT
   457         16  CM-LF-EXIT-BATCH              PIC X(6).              ELCCERT
   458         16  CM-AH-EXIT-BATCH              PIC X(6).              ELCCERT
   459         16  CM-LAST-MONTH-END             PIC XX.                ELCCERT
   460                                                                  ELCCERT
   461     12  CM-NOTE-SW                        PIC X.                 ELCCERT
   462         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.          ELCCERT
   463         88  CERT-NOTES-PRESENT               VALUE '1'.          ELCCERT
   464         88  BILLING-NOTES-PRESENT            VALUE '2'.          ELCCERT
   465         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.          ELCCERT
   466         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   467         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
   468         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   469         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   470     12  CM-COMP-EXCP-SW                   PIC X.                 ELCCERT
   471         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.          ELCCERT
   472         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.          ELCCERT
   473     12  CM-INSURED-ADDRESS-SW             PIC X.                 ELCCERT
   474         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.          ELCCERT
   475         88  INSURED-ADDR-PRESENT             VALUE '1'.          ELCCERT
   476                                                                  ELCCERT
   477*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3. ELCCERT
   478     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCCERT)
   479     12  FILLER                            PIC X.
   480                                                                  ELCCERT
   481*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   482     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   483     12  FILLER                            PIC X.
   484*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3. ELCCERT
   485     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3. ELCCERT
   486                                                                  ELCCERT
   487     12  CM-CREDIT-INTERFACE-SW-1          PIC X.                 ELCCERT
   488         88  CERT-ADDED-BATCH                 VALUE ' '.          ELCCERT
   489         88  CERT-ADDED-ONLINE                VALUE '1'.          ELCCERT
   490         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.          ELCCERT
   491         88  CERT-PURGED-OFFLINE              VALUE '3'.          ELCCERT
   492         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.          ELCCERT
   493     12  CM-CREDIT-INTERFACE-SW-2          PIC X.                 ELCCERT
   494         88  CERT-AS-LOADED                   VALUE ' '.          ELCCERT
   495         88  CERT-CANCELLED-ONLINE            VALUE '1'.          ELCCERT
   496         88  CERT-CLAIM-ONLINE                VALUE '2'.          ELCCERT
   497         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.          ELCCERT
   498         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.          ELCCERT
   499         88  CERT-PEND-CANCEL-VOID            VALUE '5'.          ELCCERT
   500         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.          ELCCERT
   501         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.          ELCCERT
   502                                                                  ELCCERT
   503     12  CM-ACCOUNT-COMM-PCTS.                                    ELCCERT
   504         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.  ELCCERT
   505         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.  ELCCERT
   506                                                                  ELCCERT
   507     12  CM-USER-FIELD                     PIC X.                 ELCCERT
   508     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   509     12  CM-CLP-STATE                      PIC XX.
   510     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   511     12  CM-USER-RESERVED                  PIC XXX.
   512     12  FILLER REDEFINES CM-USER-RESERVED.
   513         16  CM-AH-CLASS-CD                PIC XX.
   514         16  F                             PIC X.
   515******************************************************************ELCCERT
   516
   517 WORKING-STORAGE SECTION.
   518 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   519 77  WS-STATE-SW                 PIC X  VALUE ' '.
   520     88  VALID-STATE               VALUE 'Y'.
   521 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   522 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   523 77  WS-REWRITE-SW               PIC X      VALUE SPACES.
   524     88  REWRITE-MA                 VALUE 'Y'.
   525 77  WS-ADDR-SW                  PIC X VALUE ' '.
   526     88  INS-ADDR                  VALUE '1'.
   527     88  BENE-ADDR                 VALUE '2'.
   528 77  WS-TABLE-EOF-SW             PIC X  VALUE SPACES.
   529     88  END-OF-TABLE               VALUE 'Y'.
   530 77  WS-INS-FIX                  PIC X  VALUE ' '.
   531     88  INS-FIXED                VALUE 'Y'.
   532 77  WS-BEN-FIX                  PIC X  VALUE ' '.
   533     88  BEN-FIXED                VALUE 'Y'.
   534 01  WS-STATUS-CODES.
   535     05  ERMAIL-FILE-STATUS      PIC XX  VALUE SPACES.
   536     05  ELCERT-FILE-STATUS      PIC XX  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMMAF1.cbl
   537     05  WS-EOF-SW               PIC X   VALUE SPACES.
   538         88  END-OF-ERMAIL               VALUE 'Y'.
   539         88  MORE-ERMAIL                 VALUE ' '.
   540
   541*****************************************************************
   542*                                                               *
   543*                     STATE CODE TABLE                          *
   544*                                                               *
   545*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   546*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   547*                                                               *
   548*****************************************************************
   549
   550 01  STATE-VALUES.
   551     05  PIC X(24)  VALUE 'AAAA                    '.
   552     05  PIC X(24)  VALUE 'AEAE                    '.
   553     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   554     05  PIC X(24)  VALUE 'ALALALABAMA             '.
   555     05  PIC X(24)  VALUE 'APAP                    '.
   556     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   557     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   558     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   559     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   560     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   561     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   562     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   563     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   564     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   565     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   566     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   567     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   568     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   569     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   570     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   571     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   572     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   573     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   574     05  PIC X(24)  VALUE 'INININDIANA             '.
   575     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   576     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   577     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   578     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   579     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   580     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   581     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   582     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   583     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   584     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   585     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   586     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   587     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   588     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   589     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   590     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   591     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   592     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   593     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   594     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMMAF1.cbl
   595     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   596     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   597     05  PIC X(24)  VALUE 'OROROREGON              '.
   598     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   599     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   600     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   601     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   602     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   603     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   604     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   605     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   606     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   607     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   608     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   609     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   610     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   611     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   612     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
   613     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   614
   615 01  FILLER REDEFINES STATE-VALUES.
   616     05  STATE-TABLE
   617             OCCURS 63 TIMES
   618             ASCENDING KEY IS ST-STATE
   619             INDEXED BY ST-INDEX.
   620         10  ST-STATE          PIC XX.
   621         10  ST-ALT-STATE      PIC XX.
   622         10  ST-NAME           PIC X(20).
   623
*  624                                 COPY ELCDATE.
   625******************************************************************06/11/98
   626*                                                                *ELCDATE
   627*                                                                *ELCDATE
   628*                            ELCDATE.                            *   LV023
   629*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   630*                            VMOD=2.003                           ELCDATE
   631*                                                                *ELCDATE
   632*                                                                *ELCDATE
   633*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   634*                 LENGTH = 200                                   *   CL*19
   635******************************************************************ELCDATE
   636                                                                  ELCDATE
   637 01  DATE-CONVERSION-DATA.                                        ELCDATE
   638     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   639     12  DC-OPTION-CODE                PIC X.                        CL*15
   640         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   641         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   642         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   643         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   644         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   645         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   646         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   647         88  FIND-CENTURY               VALUE '7'.                   CL*22
   648         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   649         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   650         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   651         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   652         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   653         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   654         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   655         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   656         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   657         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   658         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   659         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   660         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   661         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   662         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   663         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   664         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   665         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   666         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   667         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   668         88  THREE-CHARACTER-BIN                                  ELCDATE
   669                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   670         88  GREGORIAN-TO-BIN                                        CL**2
   671                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   672         88  BIN-TO-GREGORIAN                                        CL**2
   673                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   674         88  JULIAN-TO-BINARY                                        CL**2
   675                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   676     12  DC-ERROR-CODE                 PIC X.                        CL*15
   677         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   678         88  DATE-CONVERSION-ERROR                                ELCDATE
   679                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   680         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   681         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   682         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   683         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   684         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   685         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   686         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   687         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   688         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   689         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   690     12  DC-END-OF-MONTH               PIC X.                        CL*15
   691         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   692     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   693         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   694         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   695         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   696     12  FILLER                        PIC X.                        CL*15
   697     12  DC-CONVERSION-DATES.                                        CL*15
   698         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   699         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   700         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   701         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   702                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   703             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   704             20  SLASH1-1              PIC X.                        CL*15
   705             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   706             20  SLASH1-2              PIC X.                        CL*15
   707             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   708         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   709         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   710                     DC-GREG-DATE-2-EDIT.                         ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   711             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   712             20  SLASH2-1              PIC X.                        CL*15
   713             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   714             20  SLASH2-2              PIC X.                        CL*15
   715             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   716         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   717         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   718                     DC-GREG-DATE-1-YMD.                          ELCDATE
   719             20  DC-YMD-YEAR           PIC 99.                       CL*15
   720             20  DC-YMD-MONTH          PIC 99.                       CL*15
   721             20  DC-YMD-DAY            PIC 99.                       CL*15
   722         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   723         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   724                      DC-GREG-DATE-1-MDY.                         ELCDATE
   725             20  DC-MDY-MONTH          PIC 99.                       CL*15
   726             20  DC-MDY-DAY            PIC 99.                       CL*15
   727             20  DC-MDY-YEAR           PIC 99.                       CL*15
   728         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   729             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   730             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   731             20  FILLER                PIC XX.                       CL*15
   732             20  DC-ALPHA-CENTURY.                                   CL*15
   733                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   734             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   735         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   736         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   737         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   738         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   739         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   740                                       PIC 9(05).                    CL*20
   741         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   742             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   743             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   744         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   745         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   746         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   747     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   748         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   749         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   750             20  FILLER                PIC 9(3).                     CL*15
   751             20  HOLD-CEN-1-CCYY.                                    CL*15
   752                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   753                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   754             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   755             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   756         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   757             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   758             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   759             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   760                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   761                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   762             20  FILLER                PIC 9(3).                     CL*15
   763         16  HOLD-CENTURY-1-X.                                       CL*15
   764             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   765             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   766                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   767                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   768             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMMAF1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   769             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   770         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   771             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   772             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   773             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   774                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   775                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   776             20  FILLER                PIC XXX.                      CL*23
   777         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   778         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   779         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   780         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   781             20  DC-JULIAN-1-CCYY.                                   CL*15
   782                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   783                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   784             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   785         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   786         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   787             20  DC-JULIAN-2-CCYY.                                   CL*15
   788                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   789                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   790             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   791         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   792             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   793             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   794             20  DC-EDITA-DAY          PIC 99.                       CL*15
   795             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   796             20  DC-EDITA-CCYY.                                      CL*15
   797                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   798                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   799         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   800             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   801             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   802             20  DC-EDITB-DAY          PIC 99.                       CL*15
   803             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   804             20  DC-EDITB-CCYY.                                      CL*15
   805                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   806                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   807         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   808         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   809                              DC-GREG-DATE-CYMD.                  ELCDATE
   810             20  DC-CYMD-CEN           PIC 99.                       CL*15
   811             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   812             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   813             20  DC-CYMD-DAY           PIC 99.                       CL*15
   814         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   815         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   816                              DC-GREG-DATE-MDCY.                  ELCDATE
   817             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   818             20  DC-MDCY-DAY           PIC 99.                       CL*15
   819             20  DC-MDCY-CEN           PIC 99.                       CL*15
   820             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   821    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   822        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   823    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   824    12  FILLER                         PIC X(28).                    CL*26
   825
   826
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMMAF1.cbl
   827 01  Z1                          PIC S9(5) COMP-3 VALUE +0.
   828 01  FILLER.
   829     05  WS-ZIP-TABLE OCCURS 42078.
   830         10  WS-ZIP-CODE         PIC X(5).
   831         10  WS-ZIP-STATE        PIC XX.
   832         10  WS-ZIP-CITY         PIC X(28).
   833
   834 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   835 01  WS-WORK-CITY-ST.
   836     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   837     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   838 01  WS-HOLD-ERMAIL              PIC X(374) VALUE LOW-VALUES.
   839 01  WS-WORK-FIELDS.
   840     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   841     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   842     05  WS-ERMAIL-RECS-IN       PIC 9(9)      VALUE ZEROS.
   843     05  WS-ERMAIL-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   844     05  WS-ERMAIL-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   845     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   846     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   847
   848 PROCEDURE DIVISION.
   849 0000-MAINLINE.
   850
   851     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   852     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
   853     PERFORM 0300-BUILD-TABLE    THRU 0300-EXIT
   854     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   855        END-OF-ERMAIL
   856*       OR WS-ERMAIL-RECS-FIX > 10000
   857     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   858     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   859     GOBACK
   860
   861     .
   862 0000-EXIT.
   863     EXIT.
   864
   865 0100-OPEN-FILES.
   866
   867     OPEN I-O   ERMAIL
   868*    OPEN INPUT ERMAIL
   869
   870     OPEN INPUT ELCERT ZIP-FILE-IN
   871
   872     IF ERMAIL-FILE-STATUS = '00'
   873         CONTINUE
   874     ELSE
   875         DISPLAY '*** ERROR OPENING ERMAIL FILE ***'
   876         DISPLAY '*** STATUS CODE IS ' ERMAIL-FILE-STATUS
   877         PERFORM 9999-ABEND-RTN
   878     END-IF
   879
   880     IF ELCERT-FILE-STATUS = '00'
   881         CONTINUE
   882     ELSE
   883         DISPLAY '*** ERROR OPENING ELCERT FILE ***'
   884         DISPLAY '*** STATUS CODE IS ' ELCERT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMMAF1.cbl
   885         PERFORM 9999-ABEND-RTN
   886     END-IF
   887
   888     .
   889 0100-EXIT.
   890     EXIT.
   891
   892 0200-INITIALIZE.
   893
   894     MOVE SPACES                 TO WS-EOF-SW
   895     MOVE ZEROS                  TO WS-ERMAIL-RECS-IN
   896                                    WS-ERMAIL-RECS-FIX
   897                                    WS-ERMAIL-RECS-DEL
   898
   899     PERFORM 1100-START-ERMAIL   THRU 1100-EXIT
   900
   901     PERFORM 1200-READ-ERMAIL    THRU 1200-EXIT
   902
   903     .
   904 0200-EXIT.
   905     EXIT.
   906
   907 0300-BUILD-TABLE.
   908
   909     PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
   910        END-OF-TABLE
   911        READ ZIP-FILE-IN AT END
   912           SET END-OF-TABLE      TO TRUE
   913        END-READ
   914        IF NOT END-OF-TABLE
   915           MOVE ZIP-CODE         TO WS-ZIP-CODE  (Z1)
   916           MOVE ZIP-STATE        TO WS-ZIP-STATE (Z1)
   917           MOVE ZIP-CITY         TO WS-ZIP-CITY  (Z1)
   918        END-IF
   919     END-PERFORM
   920
   921     SUBTRACT +2                 FROM Z1
   922
   923     DISPLAY ' NUMBER OF ZIP RECORDS ' Z1
   924
   925     .
   926 0300-EXIT.
   927     EXIT.
   928
   929 0500-PROCESS.
   930
   931     IF (MA-CITY-STATE NOT = SPACES)
   932        OR (MA-CRED-BENE-CTYST NOT = SPACES)
   933        PERFORM 1000-PROCESS     THRU 1000-EXIT
   934     END-IF
   935
   936     PERFORM 1200-READ-ERMAIL    THRU 1200-EXIT
   937
   938     .
   939 0500-EXIT.
   940     EXIT.
   941
   942 1000-PROCESS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMMAF1.cbl
   943
   944     MOVE ' '                    TO WS-REWRITE-SW
   945     IF MA-CITY-STATE NOT = SPACES
   946        MOVE SPACES              TO WS-WORK-CITY-ST
   947        MOVE MA-CITY-STATE       TO WS-HOLD-CITY-STATE
   948
   949** CHECK FOR GUAM AND CHANGE TO GU **
   950        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   951           (S1 = +1)
   952           OR (MA-CITY-STATE (S1:4) = 'GUAM')
   953        END-PERFORM
   954        IF MA-CITY-STATE (S1:4) = 'GUAM'
   955           MOVE 'GU  '              TO MA-CITY-STATE (S1:4)
   956           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   957              MA-CITY-STATE
   958           MOVE MA-CITY-STATE       TO WS-HOLD-CITY-STATE
   959        END-IF
   960
   961        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   962           (MA-CITY-STATE (S1:1) NOT = SPACE AND '.')
   963           OR (S1 = +1)
   964        END-PERFORM
   965        IF S1 > 3
   966           SUBTRACT +1 FROM S1
   967           MOVE MA-CITY-STATE (S1:2)
   968                                    TO WS-WORK-STATE
   969           SUBTRACT +1 FROM S1
   970           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   971              MA-CITY-STATE (S1:1) NOT = SPACE
   972           END-PERFORM
   973           IF S1 > 2
   974              IF MA-CITY-STATE (S1:1) = ',' OR ';' OR '.'
   975                 MOVE MA-CITY-STATE (1:S1 - 1) TO WS-WORK-CITY
   976              ELSE
   977                 MOVE MA-CITY-STATE (1:S1) TO WS-WORK-CITY
   978              END-IF
   979           END-IF
   980           MOVE SPACE            TO WS-STATE-SW
   981           MOVE '1'              TO WS-ADDR-SW
   982           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   983           IF VALID-STATE
   984              MOVE WS-WORK-CITY  TO MA-CITY
   985              MOVE WS-WORK-STATE TO MA-ADDR-STATE
   986*             DISPLAY ' MA OLD ' WS-HOLD-CITY-STATE
   987*                ' NEW ' MA-CITY-STATE
   988              SET REWRITE-MA TO TRUE
   989*          ELSE
   990*             PERFORM 1650-CONVERT-DATES
   991*                                THRU 1650-EXIT
   992*             DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
   993*                ' ' WS-HOLD-CITY-STATE ' '
   994*                   MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
   995*                   ' ' MA-CERT-NO
   996           END-IF
   997        ELSE
   998           PERFORM 1600-READ-ELCERT THRU 1600-EXIT
   999*          DISPLAY ' WEIRD CITY STATE ' WS-HOLD-CITY-STATE ' '
  1000*                   MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMMAF1.cbl
  1001*                   ' ' MA-CERT-NO
  1002        END-IF
  1003     END-IF
  1004
  1005
  1006     IF MA-CRED-BENE-CTYST NOT = SPACES
  1007        MOVE SPACES              TO WS-WORK-CITY-ST
  1008        MOVE MA-CRED-BENE-CTYST  TO WS-HOLD-CITY-STATE
  1009
  1010** CHECK FOR GUAM AND CHANGE TO GU **
  1011        PERFORM VARYING S1 FROM +27 BY -1 UNTIL
  1012           (S1 = +1)
  1013           OR (MA-CRED-BENE-CTYST (S1:4) = 'GUAM')
  1014        END-PERFORM
  1015        IF MA-CRED-BENE-CTYST (S1:4) = 'GUAM'
  1016           MOVE 'GU  '           TO MA-CRED-BENE-CTYST (S1:4)
  1017           DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
  1018              MA-CRED-BENE-CTYST
  1019           MOVE MA-CRED-BENE-CTYST  TO WS-HOLD-CITY-STATE
  1020        END-IF
  1021
  1022        PERFORM VARYING S1 FROM +30 BY -1 UNTIL
  1023           (MA-CRED-BENE-CTYST (S1:1) NOT = SPACE AND '.')
  1024           OR (S1 = +1)
  1025        END-PERFORM
  1026        IF S1 > 3
  1027           SUBTRACT +1 FROM S1
  1028           MOVE MA-CRED-BENE-CTYST (S1:2)
  1029                                    TO WS-WORK-STATE
  1030           SUBTRACT +1 FROM S1
  1031           PERFORM VARYING S1 FROM S1 BY -1 UNTIL
  1032              MA-CRED-BENE-CTYST (S1:1) NOT = SPACE
  1033           END-PERFORM
  1034           IF S1 > 2
  1035              IF MA-CRED-BENE-CTYST (S1:1) = ',' OR ';' OR '.'
  1036                 MOVE MA-CRED-BENE-CTYST (1:S1 - 1)
  1037                                 TO WS-WORK-CITY
  1038              ELSE
  1039                 MOVE MA-CRED-BENE-CTYST (1:S1)
  1040                                 TO WS-WORK-CITY
  1041              END-IF
  1042           END-IF
  1043           MOVE SPACE            TO WS-STATE-SW
  1044           MOVE '2'              TO WS-ADDR-SW
  1045           PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
  1046           IF VALID-STATE
  1047              MOVE WS-WORK-CITY  TO MA-CRED-BENE-CITY
  1048              MOVE WS-WORK-STATE TO MA-CRED-BENE-STATE
  1049*             DISPLAY ' CB OLD ' WS-HOLD-CITY-STATE
  1050*                ' NEW ' MA-CRED-BENE-CTYST
  1051              SET REWRITE-MA TO TRUE
  1052*          ELSE
  1053*             PERFORM 1650-CONVERT-DATES
  1054*                                THRU 1650-EXIT
  1055*             DISPLAY 'INVALID STATE CODE: ' WS-WORK-STATE
  1056*                ' ' WS-HOLD-CITY-STATE ' '
  1057*                   MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1058*                   ' ' MA-CERT-NO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMMAF1.cbl
  1059           END-IF
  1060        ELSE
  1061           PERFORM 1600-READ-ELCERT THRU 1600-EXIT
  1062*          DISPLAY ' WEIRD CITY STATE ' WS-HOLD-CITY-STATE ' '
  1063*                   MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1064*                   ' ' MA-CERT-NO
  1065        END-IF
  1066     END-IF
  1067
  1068     IF REWRITE-MA
  1069        PERFORM 2100-REWRITE-ERMAIL
  1070                                    THRU 2100-EXIT
  1071     END-IF
  1072
  1073     .
  1074 1000-EXIT.
  1075     EXIT.
  1076
  1077 1100-START-ERMAIL.
  1078
  1079     MOVE LOW-VALUES             TO MA-CONTROL-PRIMARY
  1080     MOVE X'04'                  TO MA-COMPANY-CD
  1081
  1082     START ERMAIL KEY IS NOT <
  1083                      MA-CONTROL-PRIMARY
  1084     IF ERMAIL-FILE-STATUS NOT = '00'
  1085        DISPLAY ' ERMAIL, BAD START '
  1086              ERMAIL-FILE-STATUS
  1087        PERFORM 9999-ABEND-RTN
  1088     END-IF
  1089
  1090     .
  1091
  1092 1100-EXIT.
  1093     EXIT.
  1094
  1095 1200-READ-ERMAIL.
  1096
  1097     READ ERMAIL NEXT RECORD
  1098
  1099     IF ERMAIL-FILE-STATUS = '10' OR '23'
  1100        SET END-OF-ERMAIL TO TRUE
  1101     ELSE
  1102        IF ERMAIL-FILE-STATUS NOT = '00'
  1103           DISPLAY 'ERMAIL, BAD READ NEXT '
  1104                ERMAIL-FILE-STATUS
  1105           PERFORM 9999-ABEND-RTN
  1106        ELSE
  1107           ADD 1              TO WS-ERMAIL-RECS-IN
  1108        END-IF
  1109     END-IF
  1110
  1111     .
  1112 1200-EXIT.
  1113     EXIT.
  1114
  1115 1500-EDIT-STATE.
  1116
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMMAF1.cbl
  1117     SEARCH ALL STATE-TABLE AT END
  1118        ADD 1 TO WS-INVALID-ST-CNT
  1119        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
  1120           SET VALID-STATE TO TRUE
  1121     END-SEARCH
  1122
  1123     IF NOT VALID-STATE
  1124        PERFORM 1600-READ-ELCERT THRU 1600-EXIT
  1125     END-IF
  1126
  1127     .
  1128 1500-EXIT.
  1129     EXIT.
  1130
  1131 1600-READ-ELCERT.
  1132
  1133     MOVE MA-CONTROL-PRIMARY     TO CM-CONTROL-PRIMARY
  1134     READ ELCERT
  1135
  1136     IF ELCERT-FILE-STATUS = '00'
  1137        IF (CM-LF-CANCEL-EXIT-DT = X'0000'
  1138           AND CM-AH-CANCEL-EXIT-DT = X'0000'
  1139           AND CM-LF-DEATH-EXIT-DT = X'0000'
  1140           AND CM-AH-SETTLEMENT-EXIT-DT = X'0000')
  1141                   AND
  1142           ((CM-LF-LOAN-EXPIRE-DT NOT = X'0000' AND > X'A59F')
  1143                   OR
  1144           (CM-AH-LOAN-EXPIRE-DT NOT = X'0000' AND > X'A59F'))
  1145
  1146           PERFORM 1650-CONVERT-DATES
  1147                                 THRU 1650-EXIT
  1148           PERFORM 1700-TRY-TO-FIX THRU 1700-EXIT
  1149*          IF WS-ADDR-SW = '1'
  1150*             DISPLAY 'INS - INVALID STATE CODE: ' WS-WORK-STATE
  1151*             ' ' WS-HOLD-CITY-STATE ' '
  1152*             MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1153*             ' ' MA-CERT-NO
  1154*          ELSE
  1155*             DISPLAY 'BEN - INVALID STATE CODE: ' WS-WORK-STATE
  1156*             ' ' WS-HOLD-CITY-STATE ' '
  1157*             MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1158*             ' ' MA-CERT-NO
  1159*          END-IF
  1160        END-IF
  1161     ELSE
  1162        IF ERMAIL-FILE-STATUS = '22' OR '10'
  1163           DISPLAY ' NO CERT RECORD ' MA-CONTROL-PRIMARY (2:19)
  1164              ' ' WS-DIS-EFF-DT ' ' MA-CERT-NO
  1165        ELSE
  1166           IF ERMAIL-FILE-STATUS NOT = '00'
  1167              DISPLAY 'ELCERT, BAD READ '
  1168                ELCERT-FILE-STATUS
  1169              PERFORM 9999-ABEND-RTN
  1170           END-IF
  1171        END-IF
  1172     END-IF
  1173
  1174     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* PEMMAF1.cbl
  1175 1600-EXIT.
  1176     EXIT.
  1177
  1178 1650-CONVERT-DATES.
  1179
  1180     MOVE MA-CERT-EFF-DT         TO DC-BIN-DATE-1
  1181     MOVE ' '                    TO DC-OPTION-CODE
  1182     MOVE +0                     TO DC-ELAPSED-MONTHS
  1183                                    DC-ELAPSED-DAYS
  1184     PERFORM 8510-DATE-CONVERSION
  1185                                 THRU 8590-EXIT
  1186     IF NO-CONVERSION-ERROR
  1187        MOVE DC-GREG-DATE-A-EDIT TO WS-DIS-EFF-DT
  1188     ELSE
  1189        MOVE 'XX/XX/XXXX'        TO WS-DIS-EFF-DT
  1190        DISPLAY ' ERROR CONVERTING EFFECT  DATE ' MA-ADDR-STATE
  1191        ' ' MA-ACCOUNT ' ' MA-CERT-NO
  1192     END-IF
  1193
  1194     .
  1195 1650-EXIT.
  1196     EXIT.
  1197
  1198 1700-TRY-TO-FIX.
  1199
  1200     IF WS-ADDR-SW = '1'
  1201        IF (MA-ZIP-CODE NUMERIC)
  1202           AND (MA-ZIP-CODE NOT = ZEROS)
  1203           PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
  1204              (Z1 > 42078)
  1205              OR (MA-ZIP-CODE = WS-ZIP-CODE (Z1))
  1206           END-PERFORM
  1207           IF MA-ZIP-CODE = WS-ZIP-CODE (Z1)
  1208              DISPLAY ' INS - FIXING CITY ST FROM '
  1209                 WS-HOLD-CITY-STATE
  1210                 ' TO ' WS-ZIP-CITY (Z1) ' ' WS-ZIP-STATE (Z1) ' '
  1211                 MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1212                 ' ' MA-CERT-NO
  1213              MOVE WS-ZIP-CITY (Z1) TO MA-CITY
  1214              MOVE WS-ZIP-STATE (Z1) TO MA-ADDR-STATE
  1215              SET REWRITE-MA TO TRUE
  1216           ELSE
  1217              DISPLAY 'INS - INVALID STATE CODE: ' WS-WORK-STATE
  1218              ' ' WS-HOLD-CITY-STATE ' '
  1219              MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1220              ' ' MA-CERT-NO
  1221           END-IF
  1222        ELSE
  1223           MOVE ' ' TO WS-INS-FIX
  1224
  1225** CHECK FOR SACRAMENTO            **
  1226           PERFORM VARYING S1 FROM +21 BY -1 UNTIL
  1227              (S1 = +1)
  1228              OR (MA-CITY-STATE (S1:10) = 'SACRAMENTO')
  1229           END-PERFORM
  1230           IF MA-CITY-STATE (S1:10) = 'SACRAMENTO'
  1231              MOVE 'CA'                TO MA-ADDR-STATE
  1232              DISPLAY ' INS FIXED SACRAMENTO ' WS-HOLD-CITY-STATE ' '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* PEMMAF1.cbl
  1233                 MA-CITY-STATE
  1234              MOVE MA-CITY-STATE       TO WS-HOLD-CITY-STATE
  1235              SET REWRITE-MA TO TRUE
  1236              SET INS-FIXED TO TRUE
  1237           END-IF
  1238
  1239** CHECK FOR CHARLOTTE             **
  1240           PERFORM VARYING S1 FROM +22 BY -1 UNTIL
  1241              (S1 = +1)
  1242              OR (MA-CITY-STATE (S1:9) = 'CHARLOTTE')
  1243           END-PERFORM
  1244           IF MA-CITY-STATE (S1:9) = 'CHARLOTTE'
  1245              MOVE 'NC'                TO MA-ADDR-STATE
  1246              DISPLAY ' INS FIXED CHARLOTTE  ' WS-HOLD-CITY-STATE ' '
  1247                 MA-CITY-STATE
  1248              MOVE MA-CITY-STATE       TO WS-HOLD-CITY-STATE
  1249              SET REWRITE-MA TO TRUE
  1250              SET INS-FIXED TO TRUE
  1251           END-IF
  1252           IF NOT INS-FIXED
  1253              DISPLAY 'INS - INVALID ZIP CANT FIX ' WS-WORK-STATE
  1254                 ' ' WS-HOLD-CITY-STATE ' '
  1255                 MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1256                 ' ' MA-CERT-NO ' ' MA-ZIP-CODE
  1257           END-IF
  1258        END-IF
  1259     END-IF
  1260
  1261
  1262     IF WS-ADDR-SW = '2'
  1263        IF (MA-CB-ZIP-CODE NUMERIC)
  1264           AND (MA-CB-ZIP-CODE NOT = ZEROS)
  1265           PERFORM VARYING Z1 FROM +1 BY +1 UNTIL
  1266              (Z1 > 42078)
  1267              OR (MA-CB-ZIP-CODE = WS-ZIP-CODE (Z1))
  1268           END-PERFORM
  1269           IF MA-CB-ZIP-CODE = WS-ZIP-CODE (Z1)
  1270              DISPLAY ' BEN - FIXING CITY ST FROM '
  1271                 WS-HOLD-CITY-STATE
  1272                 ' TO ' WS-ZIP-CITY (Z1) ' ' WS-ZIP-STATE (Z1) ' '
  1273                 MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1274                 ' ' MA-CERT-NO
  1275              MOVE WS-ZIP-CITY (Z1) TO MA-CRED-BENE-CITY
  1276              MOVE WS-ZIP-STATE (Z1) TO MA-CRED-BENE-STATE
  1277              SET REWRITE-MA TO TRUE
  1278           ELSE
  1279              DISPLAY 'BEN - INVALID STATE CODE: ' WS-WORK-STATE
  1280              ' ' WS-HOLD-CITY-STATE ' '
  1281              MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1282              ' ' MA-CERT-NO
  1283           END-IF
  1284        ELSE
  1285           MOVE ' ' TO WS-BEN-FIX
  1286
  1287** CHECK FOR SACRAMENTO            **
  1288           PERFORM VARYING S1 FROM +21 BY -1 UNTIL
  1289              (S1 = +1)
  1290              OR (MA-CRED-BENE-CTYST (S1:10) = 'SACRAMENTO')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* PEMMAF1.cbl
  1291           END-PERFORM
  1292           IF MA-CRED-BENE-CTYST (S1:10) = 'SACRAMENTO'
  1293              MOVE 'CA'                TO MA-CRED-BENE-STATE
  1294              DISPLAY ' BEN FIXED SACRAMENTO ' WS-HOLD-CITY-STATE
  1295                ' ' MA-CRED-BENE-CTYST
  1296              MOVE MA-CRED-BENE-CTYST   TO WS-HOLD-CITY-STATE
  1297              SET REWRITE-MA TO TRUE
  1298              SET BEN-FIXED TO TRUE
  1299           END-IF
  1300
  1301** CHECK FOR CHARLOTTE             **
  1302           PERFORM VARYING S1 FROM +22 BY -1 UNTIL
  1303              (S1 = +1)
  1304              OR (MA-CRED-BENE-CTYST (S1:9) = 'CHARLOTTE')
  1305           END-PERFORM
  1306           IF MA-CRED-BENE-CTYST (S1:9) = 'CHARLOTTE'
  1307              MOVE 'NC'                TO MA-CRED-BENE-STATE
  1308              DISPLAY ' BEN FIXED CHARLOTTE  ' WS-HOLD-CITY-STATE
  1309              ' ' MA-CRED-BENE-CTYST
  1310              MOVE MA-CRED-BENE-CTYST TO WS-HOLD-CITY-STATE
  1311              SET REWRITE-MA TO TRUE
  1312              SET BEN-FIXED TO TRUE
  1313           END-IF
  1314           IF NOT BEN-FIXED
  1315              DISPLAY 'BEN - INVALID ZIP CANT FIX ' WS-WORK-STATE
  1316                 ' ' WS-HOLD-CITY-STATE ' '
  1317                 MA-CONTROL-PRIMARY (2:19) ' ' WS-DIS-EFF-DT
  1318                 ' ' MA-CERT-NO ' ' MA-CB-ZIP-CODE
  1319           END-IF
  1320        END-IF
  1321     END-IF
  1322
  1323     .
  1324 1700-EXIT.
  1325     EXIT.
  1326
  1327 2100-REWRITE-ERMAIL.
  1328
  1329     REWRITE MAILING-DATA
  1330*    MOVE '00' TO ERMAIL-FILE-STATUS
  1331
  1332     IF ERMAIL-FILE-STATUS = '00'
  1333         ADD 1                   TO WS-ERMAIL-RECS-FIX
  1334     ELSE
  1335         DISPLAY 'ERMAIL, BAD REWRITE '
  1336         DISPLAY '*** STATUS CODE IS ' ERMAIL-FILE-STATUS
  1337         PERFORM 9999-ABEND-RTN
  1338     END-IF
  1339     .
  1340 2100-EXIT.
  1341     EXIT.
  1342
  1343 2200-DELETE-ERMAIL.
  1344
  1345     DELETE  ERMAIL
  1346
  1347     IF ERMAIL-FILE-STATUS = '00'
  1348         ADD 1                   TO WS-ERMAIL-RECS-DEL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* PEMMAF1.cbl
  1349     ELSE
  1350         DISPLAY 'ERMAIL, BAD DELETE  '
  1351         DISPLAY '*** STATUS CODE IS ' ERMAIL-FILE-STATUS
  1352         PERFORM 9999-ABEND-RTN
  1353     END-IF
  1354     .
  1355 2200-EXIT.
  1356     EXIT.
  1357
  1358
  1359 3000-CLOSE-FILES.
  1360
  1361     CLOSE ERMAIL ELCERT ZIP-FILE-IN
  1362
  1363     .
  1364 3000-EXIT.
  1365     EXIT.
  1366
  1367 4000-FINAL-TOTALS.
  1368
  1369     DISPLAY '**************************************************'
  1370     DISPLAY '***                                            ***'
  1371
  1372     MOVE WS-ERMAIL-RECS-IN      TO WS-DISPLAY-CNT
  1373     DISPLAY '***  ERMAIL RECORDS   IN         = ' WS-DISPLAY-CNT
  1374
  1375     MOVE WS-ERMAIL-RECS-FIX     TO WS-DISPLAY-CNT
  1376     DISPLAY '***  ERMAIL RECORDS   FIXED      = ' WS-DISPLAY-CNT
  1377
  1378     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
  1379     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
  1380
  1381     MOVE WS-ERMAIL-RECS-DEL     TO WS-DISPLAY-CNT
  1382     DISPLAY '***  ERMAIL RECORDS   DELETED    = ' WS-DISPLAY-CNT
  1383
  1384     DISPLAY '***                                            ***'
  1385     DISPLAY '**************************************************'
  1386
  1387     .
  1388 4000-EXIT.
  1389     EXIT.
  1390
  1391 8510-DATE-CONVERSION.
  1392
  1393     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  1394
  1395     .
  1396 8590-EXIT.
  1397     EXIT.
  1398
  1399 9999-ABEND-RTN.
  1400
  1401     DISPLAY '*** ERMAIL  FILE CONVERSION PROGRAM ABENDING ***'
  1402     DISPLAY '************************************************'
  1403
  1404     MOVE 1                      TO WS-ABEND-FLD
  1405     MOVE 0                      TO WS-ZERO-FLD
  1406
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* PEMMAF1.cbl
  1407     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
  1408     .
  1409 9999-EXIT.
  1410     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:     1477812     Code:        4678
