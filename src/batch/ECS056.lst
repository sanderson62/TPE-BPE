* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS056.cbl
* Options: int("ECS056.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS056.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS056.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS056.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS056.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS056.cbl
    16* 062304    2004061600004  PEMA  ADD PROCESSING FOR CANCELED
    18* 110304    2004110200007  PEMA  ADD NI AND NU TO LIST OF AH
    19*                                GIANT BEN CODES
    20*                                ADD MS TO LIFE
    21* 072005    2005071100001  PEMA  CREATE CREDIT ON REFUNDS
    22* 080305    2005080300010  PEMA  ADD SUM REM PMTS FORMULA
    23* 071906    2006012700002  PEMA  ADD MI AND MU TO CASH CERT
    24* 061112    2012060600001  AJRA  ADD P TYPE
    25* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    26******************************************************************
    27 ENVIRONMENT DIVISION.
    28 INPUT-OUTPUT SECTION.
    29 FILE-CONTROL.
    30
    31     SELECT CERTS                ASSIGN TO SYS010.
    32     SELECT EXTRACT              ASSIGN TO SYS011
    33            ORGANIZATION IS LINE SEQUENTIAL.
    34     SELECT DEBUG-EXTRACT        ASSIGN TO SYS012
    35            ORGANIZATION IS LINE SEQUENTIAL.
    36     SELECT DISK-DATE            ASSIGN TO SYS019.
    37     SELECT PRINTX               ASSIGN TO SYS008.
    38     SELECT FICH                 ASSIGN TO SYS020.
    39
    40     SELECT ERPYAJ               ASSIGN TO ERPYAJ
    41            ORGANIZATION IS INDEXED
    42            ACCESS IS DYNAMIC
    43            RECORD KEY IS PY-CONTROL-PRIMARY
    44            FILE STATUS IS ERPYAJ-FILE-STATUS.
    45
    46     SELECT ERDUEP               ASSIGN TO ERDUEP
    47            ACCESS IS DYNAMIC
    48            ORGANIZATION IS INDEXED
    49            FILE STATUS IS ERDUEP-FILE-STATUS
    50            RECORD KEY IS DP-CONTROL-PRIMARY.
    51
    52 DATA DIVISION.
    53 FILE SECTION.
    54
    55
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS056.cbl
    57 FD  CERTS
*   58                                 COPY ECSCRIFD.
    59******************************************************************07/10/97
    60*                                                                *ECSCRIFD
    61*                            ECSCRIFD                            *   LV001
    62*                            VMOD 2.005                          *ECSCRIFD
    63*                                                                *ECSCRIFD
    64*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
    65*                                                                *ECSCRIFD
    66******************************************************************ECSCRIFD
    67     BLOCK CONTAINS 0 RECORDS
    68     RECORDING MODE F.                                            ECSCRIFD
    69                                                                  ECSCRIFD
    70 01  CERT-IN-RECORD.                                              ECSCRIFD
    71                                                                  ECSCRIFD
    72     12  FILLER                            PIC XXX.               ECSCRIFD
    73     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
    74     12  FILLER                            PIC X(66).             ECSCRIFD
    75     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
    76     12  FILLER                            PIC X(20).             ECSCRIFD
    77     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
    78     12  FILLER                            PIC X(14).             ECSCRIFD
    79     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
    80     12  FILLER                            PIC X(39).             ECSCRIFD
    81     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    82     12  FILLER                            PIC X(45).             ECSCRIFD
    83     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
    84     12  FILLER                            PIC X(35).             ECSCRIFD
    85     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
    86     12  FILLER                            PIC X(41).             ECSCRIFD
    87     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
    88     12  FILLER                            PIC X(48).             ECSCRIFD
    89     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
    90     12  FILLER                            PIC X(9).              ECSCRIFD
    91     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
    92     12  FILLER                            PIC X(120).            ECSCRIFD
    93     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    94     12  FILLER                            PIC X(73).             ECSCRIFD
    95     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
    96     12  FILLER                            PIC X(464).            ECSCRIFD
    97                                                                  ECSCRIFD
    98******************************************************************ECSCRIFD
*   99                                 COPY ECSCRT01.
   100******************************************************************
   101*                                                                *
   102*                            ECSCRT01                            *
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   104*                            VMOD=2.016                          *
   105*                                                                *
   106*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   107*                                                                *
   108*   FILE TYPE = SEQUENTIAL
   109*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   110*                                                                *
   111*   KEY DATA =                         START=4, LEN=36           *
   112*                                                                *
   113*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   114*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   115******************************************************************
   116******************************************************************
   117*                   C H A N G E   L O G
   118*
   119* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   120*-----------------------------------------------------------------
   121*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   122* EFFECTIVE    NUMBER
   123*-----------------------------------------------------------------
   124* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   125* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   126* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   127* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   128* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   129* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   130* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   131* 032612  CR2011110200001  PEMA  AHL CHANGES
   132* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   133* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   134******************************************************************
   135
   136 01  CERTIFICATE-RECORD.
   137     12  CR-RECORD-ID                      PIC XX.
   138         88  VALID-CR-ID                      VALUE 'CR'.
   139
   140     12  CR-COMPANY-CD                     PIC X.
   141
   142     12  CR-FULL-CONTROL.
   143         16  CR-CONTROL-1.
   144             20  CR-ACCT-CONTROL.
   145                 24  CR-CARRIER            PIC X.
   146                 24  CR-GROUPING.
   147                     28  CR-GROUP-PREFIX   PIC XXX.
   148                     28  CR-GROUP-PRIME    PIC XXX.
   149                 24  CR-STATE              PIC XX.
   150                 24  CR-ACCOUNT.
   151                     28  CR-ACCT-PREFIX    PIC X(4).
   152                     28  CR-ACCT-PRIME     PIC X(6).
   153             20  CR-DT                     PIC 9(11)  COMP-3.
   154         16  CR-CERT-NO.
   155             20  CR-CERT.
   156                 24  CR-CERT-PREFIX        PIC X(3).
   157                 24  CR-CERT-PRIME         PIC X(7).
   158             20  CR-CERT-SFX               PIC X.
   159
   160     12  CR-INSUREDS-PROFILE.
   161         16  CR-NAME.
   162             20  CR-LNAME                  PIC X(15).
   163             20  CR-FNAME.
   164                 24  CR-1ST-INITIAL        PIC X.
   165                 24  FILLER                PIC X(9).
   166             20  CR-INIT                   PIC X.
   167         16  CR-AGE                        PIC 99.
   168         16  CR-SEX                        PIC X.
   169             88  CR-SEX-MALE                  VALUE 'M'.
   170             88  CR-SEX-FEMALE                VALUE 'F'.
   171         16  CR-SOC-SEC                    PIC X(11).
   172         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   173             20  CR-JT-LNAME               PIC X(15).
   174             20  CR-JT-FNAME.
   175                 24  CR-JT-1ST-INIT        PIC X.
   176                 24  FILLER                PIC X(9).
   177             20  CR-JT-INIT                PIC X.
   178         16  CR-JOINT-AGE                  PIC 99.
   179
   180         16  cr-ahl-ah-claim-no            pic x(9).
   181         16  cr-ahl-ah-cert-seq            pic x(3).
   182         16  cr-hst-proc-lf                pic x.
   183         16  f                             pic x(7).
   184
   185     12  CR-LF-COVERAGE-DATA.
   186         16  CR-LFTYP                      PIC XX.
   187         16  CR-LF-TERM                    PIC S999       COMP-3.
   188         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   189         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   190         16  CR-LF-DEV-CODE                PIC XXX.
   191         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   192
   193         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   194         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   195         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   196         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   197
   198         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   199         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   200         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   201         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   202
   203         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   204         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   205
   206         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   207         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   208
   209         16  CR-LF-REFUND-TYPE             PIC X.
   210         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   211
   212         16  CR-LF-COMM-CHARGEBACK         PIC X.
   213             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   214
   215         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   216
   217         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   218         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   219         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   220
   221         16  cr-ahl-lf-claim-no            pic x(9).
   222         16  cr-ahl-lf-cert-seq            pic x(3).
   223         16  FILLER                        PIC XX.
   224
   225     12  CR-AH-COVERAGE-DATA.
   226         16  CR-AHTYP                      PIC XX.
   227         16  CR-AH-TERM                    PIC S999       COMP-3.
   228         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   229         16  CR-AH-DEV-CODE                PIC XXX.
   230         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   231
   232         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   233         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   234         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   235         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   236
   237         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   238         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   239
   240         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   241         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   242
   243         16  CR-AH-REFUND-TYPE             PIC X.
   244         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   245
   246         16  CR-AH-COMM-CHARGEBACK         PIC X.
   247             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   248
   249         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   250
   251         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   252         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   253         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   254
   255         16  FILLER                        PIC XX.
   256*        16  FILLER                        PIC X(8).
   257
   258     12  CR-LOAN-DATA.
   259         16  CR-LIVES                      PIC S9(7)      COMP-3.
   260         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   261                                           PIC S9(5)V99   COMP-3.
   262         16  CR-BILLED                     PIC S9(7)      COMP-3.
   263         16  CR-APR                        PIC S999V9(4)  COMP-3.
   264         16  CR-PMT-FREQ                   PIC 99.
   265         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   266         16  CR-RATING-CLASS               PIC XX.
   267         16  CR-POLICY-FORM-NO             PIC X(12).
   268         16  CR-GRPTYP                     PIC XX.
   269         16  CR-IND-GRP                    PIC X.
   270             88  CR-INDIVIDUAL                VALUE '1'.
   271             88  CR-GROUP                     VALUE '2'.
   272         16  CR-SKIP                       PIC 99.
   273             88  NO-MONTHS-SKIPPED            VALUE 00.
   274             88  SKIP-JULY                    VALUE 01.
   275             88  SKIP-AUGUST                  VALUE 02.
   276             88  SKIP-SEPTEMBER               VALUE 03.
   277             88  SKIP-JULY-AUG                VALUE 04.
   278             88  SKIP-AUG-SEPT                VALUE 05.
   279             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   280             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   281             88  SKIP-JUNE                    VALUE 08.
   282             88  SKIP-JUNE-JULY               VALUE 09.
   283             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   284             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   285         16  CR-RESIDENT-STATE             PIC XX.
   286         16  CR-RATE-CODE.
   287             20  CR-LF-CLASS-CD            PIC XX.
   288             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   289         16  CR-MORT.
   290             20  CR-TAB                    PIC X.
   291             20  CR-INT                    PIC 99.
   292             20  CR-GRP                    PIC X.
   293         16  CR-MEMBER-NO                  PIC X(12).
   294         16  CR-OLD-LOF                    PIC XXX.
   295*        16  CR-LOAN-OFFICER               PIC XXX.
   296         16  CR-REIN-TABLE                 PIC XXX.
   297         16  CR-REIN-SPEC                  PIC X.
   298         16  CR-LOAN-1ST-PMT-DT.
   299             20  CR-1ST-PMT-YR             PIC 99.
   300             20  CR-1ST-PMT-MO             PIC 99.
   301             20  CR-1ST-PMT-DA             PIC 99.
   302         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   303         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   304         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   305         16  CR-LAST-ADD-ON-DT             PIC XX.
   306
   307         16  CR-UNDERWRITING-CODE          PIC X.
   308             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   309
   310         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   311         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   312         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   313         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   314
   315     12  CR-STATUS-INFORMATION.
   316         16  CR-ENTRY-STATUS               PIC X.
   317             88  CR-NORMAL-ENTRY              VALUE '1'.
   318             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   319             88  CR-CONVERSION-ENTRY          VALUE '4'.
   320             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   321             88  CR-POLICY-IS-CASH            VALUE 'C'.
   322             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   323             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   324             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   325             88  CR-POLICY-IS-VOID            VALUE 'V'.
   326             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   327             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   328                                                'C' '5' '9' 'P'.
   329         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   330
   331         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   332         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   333         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   334
   335         16  CR-LF-STATUS-AT-DEATH         PIC X.
   336         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   337
   338         16  CR-LF-CURRENT-STATUS          PIC X.
   339             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   340             88  CR-LF-POLICY-PENDING         VALUE '2'.
   341             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   342             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   343             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   344             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   345             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   346             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   347             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   348             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   349             88  CR-LF-IS-DECLINED            VALUE 'D'.
   350             88  CR-LF-IS-VOID                VALUE 'V'.
   351             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   352                                                    '4' '5' '9'.
   353
   354         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   355
   356         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   357         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   358
   359         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   360         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   361
   362         16  CR-AH-CURRENT-STATUS          PIC X.
   363             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   364             88  CR-AH-POLICY-PENDING         VALUE '2'.
   365             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   366             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   367             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   368             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   369             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   370             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   371             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   372             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   373             88  CR-AH-IS-DECLINED            VALUE 'D'.
   374             88  CR-AH-IS-VOID                VALUE 'V'.
   375             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   376                                                    '4' '5' '9'.
   377         16  CR-LOAN-OFFICER               PIC X(5).
   378         16  CR-CANCEL-REASON              PIC X.
   379         16  cr-xycor-lf-cov-code          pic x(4).
   380         16  cr-xycor-ah-cov-code          pic x(4).
   381         16  cr-temp-epiq                  pic x(4).
   382         16  FILLER                        PIC XX.
   383
   384     12  CR-DEATH-CLAIM-DATA.
   385         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   386
   387         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   388         16  CR-DTH-RPT-DT.
   389             20  CR-DTH-RPT-YR             PIC 99.
   390             20  CR-DTH-RPT-MO             PIC 99.
   391             20  CR-DTH-RPT-DA             PIC 99.
   392         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   393
   394         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   395         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   396         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   397         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   398         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   399
   400         16  CR-DTH-AGE                    PIC 99.
   401         16  CR-DTH-PAY-CD                 PIC X.
   402         16  CR-DEATH-CAUSE                PIC X(6).
   403
   404         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   405
   406     12  CR-DISAB-CLAIM-DATA.
   407         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   408
   409         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   410         16  CR-DIS-RPT-DT.
   411             20  CR-DIS-RPT-YR             PIC 99.
   412             20  CR-DIS-RPT-MO             PIC 99.
   413             20  CR-DIS-RPT-DA             PIC 99.
   414         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   415         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   416
   417         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   418         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   419         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   420         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   421         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   422
   423         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   424         16  CR-DIS-PAY-CD                 PIC X.
   425         16  FILLER                        PIC XX.
   426
   427         16  CR-DISAB-INCURRED-DETAIL.
   428             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   429**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   430                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   431                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   432                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   433
   434         16  CR-DISAB-CAUSE                PIC X(6).
   435         16  FILLER                        PIC X(14).
   436
   437     12  CR-REMIT-TO                       PIC 99.
   438
   439     12  CR-COMPENSATION-LEVELS.
   440         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   441             20  CR-COM-AGT.
   442                 24  CR-COM-AGT-PREFIX     PIC X(4).
   443                 24  CR-COM-AGT-PRIME      PIC X(6).
   444             20  CR-AGT-TYPE               PIC X.
   445             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   446             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   447
   448     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   449     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   450     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   451     12  CR-CLP-STATE                      PIC XX.
   452     12  CR-POST-CARD-IND                  PIC X.
   453     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   454     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   455     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   456     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   457     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   458     12  FILLER                            PIC X(07).
   459
   460     12  CR-CSR-CODE                       PIC XXX.
   461
   462     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS056.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   463     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   464
   465     12  CR-MICROFILM-NUMBERS.
   466*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   467         16  FILLER                        PIC X(5).
   468     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   469
   470     12  CR-USER-CODE                      PIC X.
   471     12  CR-USER-FUTURE                    PIC X(9).
   472
   473     12  CR-BENEFICIARY.
   474         16  CR-BANK-NO                    PIC X(10).
   475         16  FILLER                        PIC X(15).
   476
   477     12  CR-ENTRY-BATCH                    PIC X(6).
   478     12  CR-LF-EXIT-BATCH                  PIC X(6).
   479     12  CR-AH-EXIT-BATCH                  PIC X(6).
   480
   481     12  CR-NOTE-SW                        PIC X.
   482
   483     12  CR-ORIGIN-INDICATOR               PIC X.
   484         88  CR-ENTERED-MANUALLY              VALUE '1'.
   485         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   486
   487     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   488     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   489     12  FILLER                            PIC X(33).
   490
   491******************************************************************
   492
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS056.cbl
   494 FD  EXTRACT
   495     BLOCK CONTAINS 0 RECORDS
   496     RECORDING MODE IS F.
   497
   498*         236 BYTES
   499 01  EXTRACT-RECORD.
   500     05  EXT-CAR                 PIC X.
   501     05  WS-TAB1                 PIC X.
   502     05  EXT-GROUP               PIC X(6).
   503     05  WS-TAB2                 PIC X.
   504     05  EXT-STATE               PIC XX.
   505     05  WS-TAB3                 PIC X.
   506     05  EXT-ACCOUNT             PIC X(10).
   507     05  WS-TAB4                 PIC X.
   508     05  EXT-EFF-DATE            PIC X(10).
   509     05  WS-TAB5                 PIC X.
   510     05  EXT-ENT-DATE            PIC X(10).
   511     05  WS-TAB6                 PIC X.
   512     05  EXT-VAL-DATE            PIC X(10).
   513     05  WS-TAB7                 PIC X.
   514     05  EXT-EARN-TERM           PIC 999.
   515     05  WS-TAB8                 PIC X.
   516     05  EXT-CERT-NO             PIC X(11).
   517     05  WS-TAB9                 PIC X.
   518     05  EXT-LF-BEN-CODE         PIC XX.
   519     05  WS-TAB10                PIC X.
   520     05  EXT-AH-BEN-CODE         PIC XX.
   521     05  WS-TAB11                PIC X.
   522     05  EXT-LF-TERM             PIC 999.
   523     05  WS-TAB12                PIC X.
   524     05  EXT-AH-TERM             PIC 999.
   525     05  WS-TAB13                PIC X.
   526     05  EXT-LF-EXP-DATE         PIC X(10).
   527     05  WS-TAB14                PIC X.
   528     05  EXT-AH-EXP-DATE         PIC X(10).
   529     05  WS-TAB15                PIC X.
   530     05  EXT-EXP-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   531     05  WS-TAB16                PIC X.
   532     05  EXT-REC-PREM            PIC -ZZ,ZZZ,ZZ9.99.
   533     05  WS-TAB17                PIC X.
   534     05  EXT-BASE-COMM           PIC -ZZZ,ZZ9.99.
   535     05  WS-TAB18                PIC X.
   536     05  EXT-GA-COMM             PIC -ZZZ,ZZ9.99.
   537     05  WS-TAB19                PIC X.
   538     05  EXT-MISC1               PIC ZZZ,ZZZ,ZZ9.99.
   539     05  WS-TAB20                PIC X.
   540     05  EXT-MISC2               PIC ZZZ,ZZZ,ZZ9.99.
   541     05  WS-TAB21                PIC X.
   542     05  EXT-MISC3               PIC ZZZ,ZZZ,ZZ9.99.
   543     05  WS-TAB22                PIC X.
   544     05  EXT-MISC4               PIC ZZZ,ZZZ,ZZ9.99.
   545     05  WS-TAB23                PIC X.
   546     05  EXT-MISC5               PIC ZZZ,ZZZ,ZZ9.99.
   547
   548
   549 FD  DEBUG-EXTRACT
   550     BLOCK CONTAINS 0 RECORDS
   551     RECORDING MODE IS F.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS056.cbl
   552
   553*         236 BYTES
   554 01  DEBUG-EXTRACT-RECORD.
   555     05  DB-ACCOUNT              PIC X(10).
   556     05  DB-TAB1                 PIC X.
   557     05  DB-CERT-NO              PIC X(11).
   558     05  DB-TAB2                 PIC X.
   559     05  DB-EFF-DATE             PIC X(10).
   560     05  DB-TAB3                 PIC X.
   561     05  DB-ENT-DATE             PIC X(10).
   562     05  DB-TAB4                 PIC X.
   563     05  DB-VAL-DATE             PIC X(10).
   564     05  DB-TAB5                 PIC X.
   565     05  DB-PERIOD               PIC 999.
   566     05  DB-TAB6                 PIC X.
   567     05  DB-PAYMENT              PIC -ZZ,ZZZ,ZZ9.99.
   568     05  DB-TAB7                 PIC X.
   569     05  DB-PRINC                PIC -ZZZ,ZZ9.99.
   570     05  DB-TAB8                 PIC X.
   571     05  DB-INTEREST             PIC -Z,ZZ9.99.
   572     05  DB-TAB9                 PIC X.
   573     05  DB-LINS                 PIC -Z,ZZ9.99.
   574     05  DB-TAB10                PIC X.
   575     05  DB-DINS                 PIC -Z,ZZ9.99.
   576     05  DB-TAB11                PIC X.
   577     05  DB-BALANCE              PIC -ZZ,ZZZ,ZZ9.99.
   578     05  DB-TAB12                PIC X.
   579     05  DB-LF-BEN-CODE          PIC XX.
   580     05  DB-TAB13                PIC X.
   581     05  DB-AH-BEN-CODE          PIC XX.
   582     05  DB-TAB14                PIC X.
   583     05  DB-LF-TERM              PIC 999.
   584     05  DB-TAB15                PIC X.
   585     05  DB-AH-TERM              PIC 999.
   586     05  DB-TAB16                PIC X.
   587     05  DB-LF-EXP-DATE          PIC X(10).
   588     05  DB-TAB17                PIC X.
   589     05  DB-AH-EXP-DATE          PIC X(10).
   590
   591 FD  DISK-DATE
*  592                                 COPY ELCDTEFD.
   593******************************************************************04/15/98
   594*                                                                *ELCDTEFD
   595*                                                                *ELCDTEFD
   596*                            ELCDTEFD.                           *   LV002
   597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   598*                            VMOD=2.007                          *   CL**2
   599*                                                                *ELCDTEFD
   600******************************************************************ELCDTEFD
   601     BLOCK CONTAINS 0 RECORDS
   602     RECORDING MODE F.                                            ELCDTEFD
   603                                                                  ELCDTEFD
   604 01  DATE-DISK.                                                   ELCDTEFD
   605     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   606     12  FILLER                      PIC  X(14).                  ELCDTEFD
   607     12  DD-CR1                      PIC  9.                      ELCDTEFD
   608     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   609     12  DD-CR2                      PIC  9.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   610     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   611     12  FILLER                      PIC  X(20).                  ELCDTEFD
   612                                                                  ELCDTEFD
   613 01  DATE-DISK-R.                                                 ELCDTEFD
   614     12  FILLER                      PIC  X(4).                   ELCDTEFD
   615     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   616                                     PIC  X(32).                  ELCDTEFD
   617                                                                  ELCDTEFD
   618 01  DATE-DISK-T.                                                 ELCDTEFD
   619     12  FILLER                      PIC  X(4).                   ELCDTEFD
   620     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   621                                     PIC  X(48).                  ELCDTEFD
   622                                                                  ELCDTEFD
   623 01  DATE-DISK-M.                                                 ELCDTEFD
   624     12  FILLER                      PIC  X(4).                   ELCDTEFD
   625     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   626                                     PIC  X(48).                  ELCDTEFD
   627                                                                  ELCDTEFD
   628 01  DATE-DISK-P.                                                 ELCDTEFD
   629     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   630     12  DD-IDX                      PIC  99.                     ELCDTEFD
   631     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   632     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   633         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   634                                     PIC  X.                      ELCDTEFD
   635         16  FILLER                  PIC  X(46).                  ELCDTEFD
   636     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   637         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   638             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   639             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   640             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   641             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   642         16  FILLER                  PIC  X(16).                  ELCDTEFD
   643                                                                  ELCDTEFD
   644 01  DATE-DISK-E.                                                 ELCDTEFD
   645     12  FILLER                      PIC  X(4).                   ELCDTEFD
   646     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   647                                     PIC  X(4).                   ELCDTEFD
   648                                                                  ELCDTEFD
   649 01  DATE-DISK-C.                                                 ELCDTEFD
   650     12  FILLER                      PIC  X(7).                   ELCDTEFD
   651     12  DD-CARR1-SECPAY-SW          PIC  X.
   652     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   653     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   654     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   655     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   656     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   657     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   658     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   659     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   660     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   661     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   662     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   663     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   664     12  DD-CARR2-SECPAY-SW          PIC  X.
   665     12  FILLER                      PIC  X(7).                   ELCDTEFD
   666                                                                  ELCDTEFD
   667 01  DATE-DISK-OPT.                                               ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   668     12  FILLER                      PIC  X(04).                  ELCDTEFD
   669     12  DD-TLR-DATA.                                             ELCDTEFD
   670         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   671                                     PIC  X(03).                  ELCDTEFD
   672     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   673         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   674                                     PIC  X(06).                  ELCDTEFD
   675     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   676         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   677                                     PIC  X(07).                  ELCDTEFD
   678         16  FILLER                  PIC  X(05).                  ELCDTEFD
   679     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   680                                     PIC  X(96).                  ELCDTEFD
   681******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS056.cbl
   683 FD  PRINTX
*  684                                 COPY ELCPRTFD.
   685******************************************************************04/15/98
   686*                                                                *ELCPRTFD
   687*                                                                *ELCPRTFD
   688*                            ELCPRTFD.                           *   LV003
   689*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   690*                            VMOD=2.006                          *ELCPRTFD
   691******************************************************************ELCPRTFD
   692     RECORDING MODE F                                             ELCPRTFD
   693     LABEL RECORDS OMITTED                                        ELCPRTFD
   694     BLOCK CONTAINS 0 RECORDS
   695     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   696 01  PRT.                                                         ELCPRTFD
   697     12  P-CTL               PIC  X.                                 CL**2
   698     12  P-DATA              PIC  X(132).                         ELCPRTFD
   699******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS056.cbl
   701 FD  FICH
*  702                                 COPY ELCFCHFD.
   703******************************************************************04/15/98
   704*                                                                *ELCFCHFD
   705*                            ELCFCHFD.                           *   LV003
   706*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   707*                            VMOD=2.004                          *   CL**3
   708*                                                                *ELCFCHFD
   709******************************************************************ELCFCHFD
   710     BLOCK CONTAINS 0 RECORDS
   711     RECORDING MODE F.                                            ELCFCHFD
   712                                                                  ELCFCHFD
   713 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   714******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS056.cbl
   716 FD  ERDUEP.
*  717                                 COPY ERCDUEP.
   718******************************************************************
   719*                                                                *
   720*                                                                *
   721*                            ERCDUEP                             *
   722*                            VMOD=2.001                          *
   723*                                                                *
   724*   ONLINE CREDIT SYSTEM                                         *
   725*                                                                *
   726*   FILE DESCRIPTION = DUE PREMIUM MASTER                        *
   727*                                                                *
   728*   FILE TYPE = VSAM,KSDS                                        *
   729*   RECORD SIZE = 512   RECFORM = FIXED                          *
   730*                                                                *
   731*   BASE CLUSTER NAME = ERDUEP                   RKP=2,LEN=26    *
   732*       ALTERNATE PATH = NONE                                    *
   733*                                                                *
   734*   LOG = NO                                                     *
   735*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   736*                                                                *
   737******************************************************************
   738
   739 01  DUE-PREMIUM-RECORD.
   740     12  DP-RECORD-ID                          PIC XX.
   741         88  VALID-DP-ID                          VALUE 'DP'.
   742
   743     12  DP-CONTROL-PRIMARY.
   744         16  DP-COMPANY-CD                     PIC X.
   745         16  DP-CONTROL.
   746             20  DP-ACCOUNT-CONTROL.
   747                 24  DP-CARRIER                PIC X.
   748                 24  DP-GROUPING               PIC X(6).
   749                 24  DP-STATE                  PIC XX.
   750                 24  DP-ACCOUNT                PIC X(10).
   751             20  DP-KEY-FILLER                 PIC X(6).
   752
   753     12  DP-MAINT-INFORMATION.
   754         16  DP-LAST-MONTH-END-DT              PIC XX.
   755         16  DP-LAST-MAINT-DT                  PIC XX.
   756         16  DP-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   757         16  DP-LAST-MAINT-USER                PIC X(4).
   758         16  FILLER                            PIC X(10).
   759
   760     12  DP-FUTURE-SPACE                       PIC X(5).
   761         88  DP-FUTURE-NOT-USED                   VALUE '     '.
   762
   763     12  DP-LAST-EOM-STMT-DT                   PIC XX.
   764
   765     12  DP-LAST-ACTIVITY-DATE.
   766         16  DP-ACT-YEAR                       PIC 99.
   767         16  DP-ACT-MONTH                      PIC 99.
   768         16  DP-ACT-DAY                        PIC 99.
   769
   770     12  DP-MO-END-TOTALS.
   771         16  DP-MONTHLY-TOTALS.
   772             20  DP-BAL-FWD                PIC S9(7)V99   COMP-3.
   773             20  DP-EXP-PREM               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS056.cbl (/apps/prod/cid1p/copy/ERCDUEP)
   774             20  DP-REC-PREM               PIC S9(7)V99   COMP-3.
   775             20  DP-ADJUSTMENTS            PIC S9(7)V99   COMP-3.
   776             20  DP-BASE-COMM              PIC S9(7)V99   COMP-3.
   777             20  DP-GA-COMM                PIC S9(7)V99   COMP-3.
   778             20  DP-END-BAL                PIC S9(7)V99   COMP-3.
   779
   780         16  DP-AGING-TOTALS.
   781             20  DP-CUR                    PIC S9(7)V99   COMP-3.
   782             20  DP-OV30                   PIC S9(7)V99   COMP-3.
   783             20  DP-OV60                   PIC S9(7)V99   COMP-3.
   784             20  DP-OV90                   PIC S9(7)V99   COMP-3.
   785
   786     12  FILLER                                PIC X(394).
   787
   788******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS056.cbl
   790 FD  ERPYAJ.
   791
*  792                                 COPY ERCPYAJ.
   793******************************************************************04/29/98
   794*                                                                *ERCPYAJ
   795*                            ERCPYAJ                             *   LV003
   796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   797*                            VMOD=2.015                          *   CL**2
   798*                                                                *ERCPYAJ
   799*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *ERCPYAJ
   800*                                                                *ERCPYAJ
   801*                                                                *ERCPYAJ
   802*   FILE TYPE = VSAM,KSDS                                        *ERCPYAJ
   803*   RECORD SIZE = 200  RECFORM = FIXED                           *ERCPYAJ
   804*                                                                *ERCPYAJ
   805*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *ERCPYAJ
   806*       ALTERNATE PATHS = NONE                                   *ERCPYAJ
   807*                                                                *ERCPYAJ
   808*   LOG = YES                                                    *ERCPYAJ
   809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPYAJ
   810******************************************************************ERCPYAJ
   811******************************************************************
   812*                   C H A N G E   L O G
   813*
   814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   815*-----------------------------------------------------------------
   816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   817* EFFECTIVE    NUMBER
   818*-----------------------------------------------------------------
   819* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
   820* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
   821******************************************************************
   822                                                                  ERCPYAJ
   823 01  PENDING-PAY-ADJ.                                             ERCPYAJ
   824     12  PY-RECORD-ID                     PIC XX.                 ERCPYAJ
   825         88  VALID-PY-ID                        VALUE 'PY'.       ERCPYAJ
   826                                                                  ERCPYAJ
   827     12  PY-CONTROL-PRIMARY.                                      ERCPYAJ
   828         16  PY-COMPANY-CD                PIC X.                  ERCPYAJ
   829         16  PY-CARRIER                   PIC X.                  ERCPYAJ
   830         16  PY-GROUPING                  PIC X(6).               ERCPYAJ
   831         16  PY-FIN-RESP                  PIC X(10).              ERCPYAJ
   832         16  PY-ACCOUNT                   PIC X(10).              ERCPYAJ
   833         16  PY-PRODUCER REDEFINES PY-ACCOUNT                     ERCPYAJ
   834                                          PIC X(10).              ERCPYAJ
   835         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCPYAJ
   836         16  PY-RECORD-TYPE               PIC X.                  ERCPYAJ
   837             88  PY-REMIT-RECEIVED            VALUE 'R'.          ERCPYAJ
   838             88  PY-DEPOSIT                   VALUE 'D'.          ERCPYAJ
   839             88  PY-CHARGE-TO-AGENT           VALUE 'C'.          ERCPYAJ
   840             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.          ERCPYAJ
   841             88  PY-ADJ-DEPOSIT               VALUE 'T'.          ERCPYAJ
   842             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.          ERCPYAJ
   843             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.          ERCPYAJ
   844             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.          ERCPYAJ
   845             88  PY-ADD-TO-BALANCE            VALUE 'Z'.          ERCPYAJ
   846             88  PY-FICA-ENTRY                VALUE 'F'.          ERCPYAJ
   847             88  PY-REMIT-IND-GROUPING        VALUE 'G'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   848             88  PY-POLICY-FEE                VALUE 'W'.          ERCPYAJ
   849             88  PY-DUE-PREM-ADJ              VALUE 'P'.
   850                                                                  ERCPYAJ
   851     12  PY-PYMT-TYPE                     PIC X.                  ERCPYAJ
   852             88  PY-NEW-BUS-PYMT              VALUE 'B'.          ERCPYAJ
   853             88  PY-REINS-PYMT                VALUE 'R'.          ERCPYAJ
   854             88  PY-EXP-PYMT                  VALUE 'E'.          ERCPYAJ
   855                                                                  ERCPYAJ
   856     12  PY-BIL-INV                       PIC X(6).               ERCPYAJ
   857     12  PY-REF-NO                        PIC X(12).              ERCPYAJ
   858                                                                  ERCPYAJ
   859     12  PY-LAST-MAINT-DT                 PIC XX.                 ERCPYAJ
   860     12  PY-LAST-MAINT-BY                 PIC X(4).               ERCPYAJ
   861     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPYAJ
   862                                                                  ERCPYAJ
   863     12  PY-PYADJ-RECORD.                                         ERCPYAJ
   864         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.   ERCPYAJ
   865         16  PY-ENTRY-COMMENT             PIC X(30).              ERCPYAJ
   866         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.               000
   867             20  PY-GL-ACCOUNT            PIC X(10).                   000
   868             20  PY-GL-STATE              PIC X(02).                   000
   869             20  PY-GL-CANC-SW            PIC X(01).                   000
   870                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.                   000
   871                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.                   000
   872             20  PY-GL-COMMENT            PIC X(10).                   000
   873             20  FILLER      REDEFINES PY-GL-COMMENT.                  000
   874                 24  PY-GL-CHECK-NO       PIC 9(06).                   000
   875                 24  FILLER               PIC X(04).                   000
   876             20  FILLER                   PIC X(07).                   ERC
   877         16  PY-SAVE-ACCOUNT              PIC X(10).              ERCPYAJ
   878         16  PY-SAVE-TYPE                 PIC X(01).              ERCPYAJ
   879                                                                  ERCPYAJ
   880         16  PY-LETTERS.                                          ERCPYAJ
   881             20  PY-LETTER OCCURS 3 TIMES                         ERCPYAJ
   882                           INDEXED BY PY-LET-NDX                  ERCPYAJ
   883                                          PIC X(04).              ERCPYAJ
   884                                                                  ERCPYAJ
   885         16  PY-ERCOMP-TYPE               PIC X.
   886             88  PY-ACCOUNT-TYPE              VALUE 'A'.
   887             88  PY-GA-TYPE                   VALUE 'G'.
   888             88  PY-BANK-TYPE                 VALUE 'B'.
   889         16  FILLER                       PIC X(05).
   890                                                                  ERCPYAJ
   891     12  PY-RECORD-STATUS.                                        ERCPYAJ
   892         16  PY-CREDIT-SELECT-DT          PIC XX.                 ERCPYAJ
   893         16  PY-CREDIT-ACCEPT-DT          PIC XX.                 ERCPYAJ
   894         16  PY-BILLED-DATE               PIC XX.                 ERCPYAJ
   895         16  PY-REPORTED-DT               PIC XX.                 ERCPYAJ
   896         16  PY-PMT-APPLIED               PIC X.                  ERCPYAJ
   897             88  PY-ACCOUNT-PMT               VALUE 'A'.          ERCPYAJ
   898             88  PY-GA-PMT                    VALUE 'G'.          ERCPYAJ
   899             88  PY-OVWRITE-PMT               VALUE 'O'.          ERCPYAJ
   900             88  PY-NON-AR-PMT                VALUE 'N'.          ERCPYAJ
   901         16  FILLER                       PIC X(5).               ERCPYAJ
   902         16  PY-INPUT-DT                  PIC XX.                 ERCPYAJ
   903         16  PY-CHECK-NUMBER              PIC X(6).               ERCPYAJ
   904         16  PY-VOID-SW                   PIC X.                  ERCPYAJ
   905             88  PY-CHECK-VOIDED              VALUE 'V'.          ERCPYAJ
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS056.cbl (/apps/prod/cid1p/copy/ERCPYAJ)
   906         16  PY-CHECK-ORIGIN-SW           PIC X.                  ERCPYAJ
   907             88  PY-BILLING-CHECK             VALUE 'B'.          ERCPYAJ
   908             88  PY-REFUND-CHECK              VALUE 'R'.          ERCPYAJ
   909             88  PY-GA-CHECK                  VALUE 'G'.          ERCPYAJ
   910             88  PY-CHECK-WRITTEN             VALUE 'W'.          ERCPYAJ
   911             88  PY-CHECK-REVERSAL            VALUE 'V'.          ERCPYAJ
   912         16  PY-CHECK-WRITTEN-DT          PIC XX.                 ERCPYAJ
   913         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.         ERCPYAJ
   914         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.         ERCPYAJ
   915         16  PY-BILL-FLAG                 PIC X.                  ERCPYAJ
   916             88  PY-BILLED                    VALUE 'B'.          ERCPYAJ
   917         16  PY-AR-FLAG                   PIC X.                  ERCPYAJ
   918             88  PY-AR-CYCLE                  VALUE 'C'.          ERCPYAJ
   919             88  PY-AR-MONTH-END              VALUE 'M'.          ERCPYAJ
   920         16  PY-AR-DATE                   PIC XX.                 ERCPYAJ
   921                                                                  ERCPYAJ
   922     12  PY-GL-CODES.                                             ERCPYAJ
   923         16  PY-GL-DB                     PIC X(14).              ERCPYAJ
   924         16  PY-GL-CR                     PIC X(14).              ERCPYAJ
   925         16  PY-GL-FLAG                   PIC X.                  ERCPYAJ
   926         16  PY-GL-DATE                   PIC XX.                 ERCPYAJ
   927                                                                  ERCPYAJ
   928     12  PY-CANCEL-FEE-FLAG               PIC X(2).               ERCPYAJ
   929     12  FILLER                           PIC X(3).               ERCPYAJ
   930******************************************************************ERCPYAJ
   931
   932
   933 WORKING-STORAGE SECTION.
   934 77  FILLER  PIC X(32) VALUE '********************************'.
   935 77  FILLER  PIC X(32) VALUE '      ECS056  WORKING STORAGE   '.
   936 77  FILLER  PIC X(32) VALUE '********************************'.
   937
   938 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   939     88  END-OF-FILE                VALUE 'Y'.
   940     88  MORE-RECORDS               VALUE 'N'.
   941 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   942 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   943 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   944 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   945 77  SPACE-NP                    PIC X      VALUE '1'.
   946 77  SPACE-1                     PIC X      VALUE ' '.
   947 77  SPACE-2                     PIC X      VALUE '0'.
   948 77  SPACE-3                     PIC X      VALUE '-'.
   949 77  X                           PIC X      VALUE ' '.
   950 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   951 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   952
   953 01  HD1.
   954     12  FILLER              PIC  X(44)      VALUE SPACES.
   955     12  FILLER              PIC  X(44)      VALUE
   956             '        DUE PREMIUM AND COMMISSION         '.
   957     12  FILLER              PIC  X(31)      VALUE SPACES.
   958     12  FILLER              PIC  X(08)      VALUE 'ECS056'.
   959
   960 01  HD2.
   961     12  FILLER              PIC  X(51)      VALUE SPACES.
   962     12  HD-CO               PIC  X(30).
   963     12  FILLER              PIC  X(38)      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS056.cbl
   964     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   965
   966 01  HD3.
   967     12  FILLER              PIC  X(57)      VALUE SPACES.
   968     12  HD-DT               PIC  X(18).
   969     12  FILLER              PIC  X(44)      VALUE SPACES.
   970     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   971     12  HD-PG               PIC ZZ,ZZ9.
   972
   973 01  HD4.
   974     12  FILLER              PIC  X(44)      VALUE
   975             '-- ACCOUNT TOTALS  --      BEGINNING   EXPEC'.
   976     12  FILLER              PIC  X(44)      VALUE
   977             'TED   RECEIVED              ENDING          '.
   978     12  FILLER              PIC  X(44)      VALUE
   979             '                    DUE      NO OF          '.
   980
   981 01  HD5.
   982     12  FILLER              PIC  X(44)      VALUE
   983             '--CAR GROUP  ST  ACCOUNT--- BALANCE    PREMI'.
   984     12  FILLER              PIC  X(44)      VALUE
   985             'UMS   PREMIUMS  ADJUSTMENTS BALANCE      < 9'.
   986     12  FILLER              PIC  X(44)      VALUE
   987             '0        > 90   COMMISSION   MONTHS         '.
   988 01  DETAIL-LINE.
   989     05  FILLER                  PIC X(4).
   990     05  DTL1-CAR                PIC X.
   991     05  FILLER                  PIC X.
   992     05  DTL1-GRP                PIC X(6).
   993     05  FILLER                  PIC X.
   994     05  DTL1-ST                 PIC XX.
   995     05  FILLER                  PIC X.
   996     05  DTL1-ACCT               PIC X(10).
   997     05  FILLER                  PIC X.
   998     05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99.
   999     05  FILLER                  PIC X.
  1000     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
  1001     05  FILLER                  PIC X.
  1002     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
  1003     05  FILLER                  PIC X.
  1004     05  DTL1-ADJS               PIC ZZZ,ZZ9.99.
  1005     05  FILLER                  PIC X.
  1006     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99.
  1007     05  FILLER                  PIC X.
  1008     05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99.
  1009     05  FILLER                  PIC X.
  1010     05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99.
  1011     05  FILLER                  PIC X.
  1012     05  DTL1-COMM               PIC ZZZ,ZZ9.99.
  1013     05  FILLER                  PIC X(4).
  1014     05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS056.cbl
  1016 01  WS-DUE-PREM-ADJ-TABLE.
  1017     05  WS-DUEP-ADJ OCCURS 500.
  1018         10  WS-DA-KEY           PIC X(33).
  1019         10  WS-DA-AMOUNT        PIC S9(7)V99 COMP-3.
  1020
  1021 01  WS-DUE-PREM-TABLE.
  1022     05  WS-RECORD.
  1023         10  WS-CAR              PIC X.
  1024         10  WS-GROUP            PIC X(6).
  1025         10  WS-STATE            PIC XX.
  1026         10  WS-ACCOUNT          PIC X(10).
  1027         10  WS-EFF-DATE         PIC X(10).
  1028         10  WS-CERT-NO          PIC X(11).
  1029         10  WS-LF-BEN-CODE      PIC XX.
  1030         10  WS-AH-BEN-CODE      PIC XX.
  1031         10  WS-LF-TERM          PIC ZZ9.
  1032         10  WS-AH-TERM          PIC ZZ9.
  1033         10  WS-LF-EXP-DATE      PIC X(10).
  1034         10  WS-AH-EXP-DATE      PIC X(10).
  1035         10  WS-LF-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1036         10  WS-AH-EXP-PREM      PIC S9(9)V99 COMP-3 VALUE +0.
  1037         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1038         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
  1039         10  WS-LF-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1040         10  WS-AH-BASE-COMM     PIC S9(7)V99 COMP-3 VALUE +0.
  1041         10  WS-BASE-COMM        PIC S9(7)V99 COMP-3 VALUE +0.
  1042         10  WS-REC-BASE-COMM    PIC S9(7)V99 COMP-3 VALUE +0.
  1043         10  WS-LF-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1044         10  WS-AH-GA-COMM       PIC S9(7)V99 COMP-3 VALUE +0.
  1045         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
  1046         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
  1047         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
  1048         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
  1049         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
  1050         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
  1051
  1052 01  WS-MISC.
  1053     05  WS-INIT-EXTRACT         PIC X(236) VALUE LOW-VALUES.
  1054     05  WS-INIT-DB-EXTRACT      PIC X(236) VALUE LOW-VALUES.
  1055     05  WS-PYAJ-MATCH-KEY       PIC X(28) VALUE LOW-VALUES.
  1056     05  WS-ERPYAJ-KEY.
  1057         10  WS-PY-COMPANY-CD    PIC X.
  1058         10  WS-PY-CARRIER       PIC X.
  1059         10  WS-PY-GROUPING      PIC X(6).
  1060         10  WS-PY-FIN-RESP      PIC X(10).
  1061         10  WS-PY-ACCOUNT       PIC X(10).
  1062     05  ERDUEP-FILE-STATUS      PIC XX.
  1063     05  ERPYAJ-FILE-STATUS      PIC XX.
  1064     05  WS-HOLD-PRT             PIC X(133).
  1065     05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
  1066     05  WS-HOLD-CONTROL.
  1067         10  WS-HOLD-CAR         PIC X.
  1068         10  WS-HOLD-GRP         PIC X(6).
  1069         10  WS-HOLD-ST          PIC XX.
  1070         10  WS-HOLD-ACCT        PIC X(10).
  1071     05  WS-WORK-TERM            PIC S999   COMP-3 VALUE +0.
  1072     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
  1073     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS056.cbl
  1074     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1075     05  WS-DISPLAY-TERM         PIC Z99.
  1076     05  WS-DISPLAY-RTERM        PIC Z99.99.
  1077     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1078     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1079     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1080     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1081     05  WS-BIN-LAST-MONTH-DT    PIC XX  VALUE LOW-VALUES.
  1082     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1083     05  WS-BIN-1ST-DT           PIC XX  VALUE LOW-VALUES.
  1084     05  WS-DAYS-TO-1ST          PIC S9(3) COMP-3 VALUE +0.
  1085     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
  1086     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1087     05  WS-BIN-LF-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1088     05  WS-BIN-AH-CAN-DATE      PIC XX  VALUE LOW-VALUES.
  1089     05  WS-LF-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1090     05  WS-AH-CAN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1091     05  WS-LF-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1092     05  WS-LF-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1093     05  WS-AH-MIN-TERM          PIC S9(3) COMP-3 VALUE +0.
  1094     05  WS-AH-MAX-TERM          PIC S9(3) COMP-3 VALUE +0.
  1095     05  WS-LF-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1096     05  WS-AH-REF               PIC S9(7)V99 COMP-3 VALUE +0.
  1097     05  WS-LF-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1098         88  CREDIT-LF-CANCEL              VALUE 'Y'.
  1099     05  WS-AH-CAN-QUAL-SW       PIC X     VALUE 'N'.
  1100         88  CREDIT-AH-CANCEL              VALUE 'Y'.
  1101     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1102     05  FILLER REDEFINES WS-END-YEAR.
  1103         10  WS-CCYY             PIC 9(7).
  1104         10  WS-MMDD             PIC 9(4).
  1105 01  WS-DEBUG-AREA.
  1106     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1107         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1108         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1109         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1110         88  DEBUG-LF-STATUTORY         VALUE '3'.
  1111         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1112
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS056.cbl
  1114
  1115 01  TEXAS-REGS-WORK-AREAS.
  1116     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1117     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1118     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1119     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1120     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1121     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1122     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1123     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1124     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1125
  1126 01  NET-PAY-INTERFACE.
  1127     05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1128     05  NP-ORIG                 PIC S9(3)         COMP-3.
  1129     05  NP-REM                  PIC S9(3)         COMP-3.
  1130     05  NP-OPT                  PIC X(01).
  1131     05  NP-CAP                  PIC S9(3)         COMP-3.
  1132     05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1133     05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1134     05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1135
  1136 01  WS-ABEND-AREA.
  1137     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1138     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1139     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1140     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1141
  1142 01  WORK-ABEND-CODE.
  1143     12  WAC-1                   PIC X.
  1144     12  WAC-2                   PIC X.
  1145     12  WAC-3-4.
  1146         16  WAC-3               PIC X.
  1147         16  WAC-4               PIC X.
  1148
  1149 01  DATE-AREAS.
  1150     05  WS-THIS-MONTH-DATE      PIC 9(11).
  1151     05  WS-LAST-MONTH-DATE      PIC 9(11).
  1152     05  WS-WORK-DATE            PIC 9(11).
  1153     05  FILLER REDEFINES WS-WORK-DATE.
  1154         10  FILLER              PIC XXX.
  1155         10  WS-WORK-CCYY        PIC 9(4).
  1156         10  WS-WORK-MMDD        PIC 9(4).
  1157     05  WS-ISSUE-DATE           PIC 9(11).
  1158     05  FILLER REDEFINES WS-ISSUE-DATE.
  1159         10  FILLER              PIC XXX.
  1160         10  WS-ISSUE-CCYY       PIC 9(4).
  1161         10  WS-ISSUE-MMDD       PIC 9(4).
  1162     05  WS-EXPIRE-DATE          PIC 9(11).
  1163     05  FILLER REDEFINES WS-EXPIRE-DATE.
  1164         10  FILLER              PIC XXX.
  1165         10  WS-EXPIRE-CCYY      PIC 9(4).
  1166         10  WS-EXPIRE-MMDD      PIC 9(4).
  1167     05  WS-ENTRY-DATE           PIC 9(11).
  1168     05  FILLER REDEFINES WS-ENTRY-DATE.
  1169         10  FILLER              PIC XXX.
  1170         10  WS-ENTRY-CCYY       PIC 9(4).
  1171         10  WS-ENTRY-MMDD       PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS056.cbl
  1172     05  WS-CANCEL-DATE          PIC 9(11).
  1173     05  FILLER REDEFINES WS-CANCEL-DATE.
  1174         10  FILLER              PIC XXX.
  1175         10  WS-CANCEL-CCYY      PIC 9(4).
  1176         10  WS-CANCEL-MMDD      PIC 9(4).
  1177     05  WS-CLAIM-DATE           PIC 9(11).
  1178     05  FILLER REDEFINES WS-CLAIM-DATE.
  1179         10  FILLER              PIC XXX.
  1180         10  WS-CLAIM-CCYY       PIC 9(4).
  1181         10  WS-CLAIM-MMDD       PIC 9(4).
  1182     05  WS-POSTING-DATE         PIC X(8).
  1183     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1184     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
  1185     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1186     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
  1187     05  WS-BIN-VAL-DATES OCCURS 50
  1188                                 PIC XX.
  1189
  1190 01  WS-MISC-AREA.
  1191     12  WS-DP-EXP-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1192     12  WS-DP-REC-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
  1193     12  WS-DP-GA-COMM           PIC S9(9)V99 COMP-3 VALUE +0.
  1194     12  WS-DP-BASE-COMM         PIC S9(9)V99 COMP-3 VALUE +0.
  1195     12  WS-DP-ADJ               PIC S9(9)V99 COMP-3 VALUE +0.
  1196*   1ST OCCURANCE           ACCOUNT TOTALS
  1197*   2ND                     STATE
  1198*   3RD                     GROUP
  1199*   4TH                     CARRIER
  1200*   5TH                     FINAL
  1201     12  WS-TOTAL-TABLE OCCURS 5.
  1202         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1203         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
  1204         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
  1205         16  WS-TOT-BASE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
  1206     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
  1207     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1208     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
  1209     12  CERT-IN-CNT             PIC 9(9)     VALUE ZEROS.
  1210     12  WS-INT                  PIC S9(5)V999 COMP-3 VALUE +0.
  1211     12  WS-FINT                 PIC S9(5)V999 COMP-3 VALUE +0.
  1212     12  WS-LINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1213     12  WS-DINS                 PIC S9(7)V99 COMP-3  VALUE +0.
  1214     12  WS-FLINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1215     12  WS-FDINS                PIC S9(7)V99 COMP-3  VALUE +0.
  1216     12  WS-I                    PIC SV9(9)   COMP-3  VALUE +0.
  1217     12  WS-J                    PIC SV9(9)   COMP-3  VALUE +0.
  1218     12  WS-Y                    PIC S99V9(9)   COMP-3  VALUE +0.
  1219     12  WS-K                    PIC SV9(9)   COMP-3  VALUE +0.
  1220     12  WS-VM                   PIC S9V9(9)  COMP-3  VALUE +0.
  1221     12  WS-P                    PIC S9(7)V99 COMP-3  VALUE +0.
  1222     12  WS-B                    PIC S9(7)V99 COMP-3  VALUE +0.
  1223     12  WS-R                    PIC S9(7)V99 COMP-3  VALUE +0.
  1224     12  WS-I1                   PIC S9(7)V99 COMP-3  VALUE +0.
  1225     12  X1                      PIC S999     COMP-3  VALUE +0.
  1226     12  WS-A                    PIC S999     COMP-3  VALUE +0.
  1227     12  WS-PYAJ-INDEX           PIC S999     COMP-3  VALUE +0.
  1228     12  WS-PYAJ-MAX             PIC S999     COMP-3  VALUE +0.
  1229     12  WS-ANGLEN               PIC S9(5)V9999 COMP-3  VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS056.cbl
  1230     12  WS-OD                   PIC S9(5)V9999 COMP-3  VALUE +0.
  1231     12  WS-AMT                  PIC S9(9)V99 COMP-3  VALUE +0.
  1232     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3  VALUE +0.
  1233     12  WS-ANGLEM               PIC S9(5)V9999 COMP-3  VALUE +0.
  1234     12  WS-ANGLEM-1             PIC S9(5)V9999 COMP-3  VALUE +0.
  1235     12  WS-ANGLEMJ              PIC S9(5)V9999 COMP-3  VALUE +0.
  1236     12  WS-ANGLEMK              PIC S9(5)V9999 COMP-3  VALUE +0.
  1237     12  WS-ANGLEN-M             PIC S9(5)V9999 COMP-3  VALUE +0.
  1238     12  LF-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1239     12  AH-REM-TERM             PIC S999     COMP-3  VALUE +0.
  1240     12  LF-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1241     12  AH-REM-TRM1             PIC S999V99  COMP-3  VALUE +0.
  1242     12  LF-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1243     12  AH-REM-TRM2             PIC S999V99  COMP-3  VALUE +0.
  1244     12  REM-TERM                PIC S9(3)V99    COMP-3.
  1245     12  REM-TRM2                PIC S9(3)V99    COMP-3.
  1246     12  WS-LF-EARN-TERM         PIC S999            VALUE ZEROS.
  1247     12  WS-AH-EARN-TERM         PIC S999            VALUE ZEROS.
  1248     12  WS-EARN-TERM            PIC S999            VALUE ZEROS.
  1249     12  WS-GIANT-SW             PIC X           VALUE SPACES.
  1250         88  THIS-IS-A-GIANT-CERT                VALUE 'X'.
  1251
  1252
  1253 01  ABEND-FIELDS.
  1254     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
  1255     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1256         88  FIRST-TIME                 VALUE 'Y'.
  1257
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS056.cbl
* 1259                                 COPY ELCCALC.
  1260******************************************************************04/15/98
  1261*                                                                *ELCCALC
  1262*                           ELCCALC.                            *    LV003
  1263*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1264*                            VMOD=2.025                          *   CL**3
  1265*                                                                *   CL**2
  1266*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1267*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1268*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1269*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1270*                                                                *   CL**2
  1271*  PASSED TO ELRTRM                                              *   CL**2
  1272*  -----------------                                             *   CL**2
  1273*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1274*  ORIGINAL TERM                                                 *   CL**2
  1275*  BEGINNING DATE                                                *   CL**2
  1276*  ENDING DATE                                                   *   CL**2
  1277*  COMPANY I.D.                                                  *   CL**2
  1278*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1279*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1280*  FREE LOOK DAYS                                                *   CL**2
  1281*                                                                *   CL**2
  1282*  RETURNED FROM ELRTRM                                          *   CL**2
  1283*  ---------------------                                         *   CL**2
  1284*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1285*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1286*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1287*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1288*----------------------------------------------------------------*   CL**2
  1289*  PASSED TO ELRAMT                                              *   CL**2
  1290*  ----------------                                              *   CL**2
  1291*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1292*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1293*  ORIGINAL AMOUNT                                               *   CL**2
  1294*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1295*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1296*  METHOD                                                            CL**2
  1297*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1298*  COMPANY I.D.                                                  *   CL**2
  1299*  BENEFIT TYPE                                                  *   CL**2
  1300*                                                                *   CL**2
  1301*  RETURNED FROM ELRAMT                                          *   CL**2
  1302*  --------------------                                          *   CL**2
  1303*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1304*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1305*  REMAINING AMOUNT FACTOR                                           CL**2
  1306*----------------------------------------------------------------*   CL**2
  1307*  PASSED TO ELRESV                                              *   CL**2
  1308*  -----------------                                             *   CL**2
  1309*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1310*  VALUATION DATE                                                *   CL**2
  1311*  PAID THRU DATE                                                *   CL**2
  1312*  BENEFIT                                                       *   CL**2
  1313*  INCURRED DATE                                                 *   CL**2
  1314*  REPORTED DATE                                                 *   CL**2
  1315*  ISSUE AGE                                                     *   CL**2
  1316*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1317*  CDT PERCENT                                                   *   CL**2
  1318*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1319* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1320* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1321* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1322*                                                                *   CL**2
  1323*  RETURNED FROM ELRESV                                          *   CL**2
  1324*  --------------------                                          *   CL**2
  1325*  CDT TABLE USED                                                *   CL**2
  1326*  CDT FACTOR USED                                               *   CL**2
  1327*  PAY TO CURRENT RESERVE                                        *   CL**2
  1328*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1329*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1330*----------------------------------------------------------------*   CL**2
  1331*  PASSED TO ELRATE                                              *   CL**2
  1332*  ----------------                                              *   CL**2
  1333*  CERT ISSUE DATE                                               *   CL**2
  1334*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1335*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1336*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1337*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1338*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1339*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1340*  DEVIATION CODE                                                *   CL**2
  1341*  ISSUE AGE                                                     *   CL**2
  1342*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1343*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1344*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1345*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1346*  A.P.R.                                                        *   CL**2
  1347*  METHOD                                                            CL**2
  1348*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1349*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1350*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1351*  BENEFIT CODE                                                  *   CL**2
  1352*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1353*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1354*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1355*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1356*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1357*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1358*                                                                *   CL**2
  1359*  RETURNED FROM ELRATE                                          *   CL**2
  1360*  --------------------                                          *   CL**2
  1361*  CALCULATED PREMIUM                                            *   CL**2
  1362*  PREMIUM RATE                                                  *   CL**2
  1363*  MORTALITY CODE                                                *   CL**2
  1364*  MAX ATTAINED AGE                                              *   CL**2
  1365*  MAX AGE                                                       *   CL**2
  1366*  MAX TERM                                                      *   CL**2
  1367*  MAX MONTHLY BENEFIT                                           *   CL**2
  1368*  MAX TOTAL BENIFIT                                             *   CL**2
  1369*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1370*----------------------------------------------------------------*   CL**2
  1371*  PASSED TO ELRFND                                              *   CL**2
  1372*  ----------------                                              *   CL**2
  1373*  CERT ISSUE DATE                                               *   CL**2
  1374*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1375*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1376*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1377*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1378*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1379*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1380*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1381*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1382*  DEVIATION CODE                                                *   CL**2
  1383*  ISSUE AGE                                                     *   CL**2
  1384*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1385*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1386*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1387*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1388*  A.P.R.                                                        *   CL**2
  1389*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1390*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1391*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1392*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1393*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1394*  BENEFIT CODE                                                  *   CL**2
  1395*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1396*                                                                *   CL**2
  1397*  RETURNED FROM ELRFND                                          *   CL**2
  1398*  --------------------                                          *   CL**2
  1399*  CALCULATED REFUND                                             *   CL**2
  1400*----------------------------------------------------------------*   CL**2
  1401*  PASSED TO ELEARN                                              *   CL**2
  1402*  ----------------                                              *   CL**2
  1403*  CERT ISSUE DATE                                               *   CL**2
  1404*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1405*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1406*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1407*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1408*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1409*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1410*  DEVIATION CODE                                                *   CL**2
  1411*  ISSUE AGE                                                     *   CL**2
  1412*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1413*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1414*  A.P.R.                                                        *   CL**2
  1415*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1416*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1417*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1418*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1419*  BENEFIT CODE                                                  *   CL**2
  1420*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1421*                                                                *   CL**2
  1422*  RETURNED FROM ELEARN                                          *   CL**2
  1423*  --------------------                                          *   CL**2
  1424*  INDICATED  EARNINGS                                           *   CL**2
  1425*----------------------------------------------------------------*   CL**2
  1426*                 LENGTH = 450                                   *   CL**2
  1427*                                                                *   CL**2
  1428******************************************************************   CL**2
  1429******************************************************************
  1430*                   C H A N G E   L O G
  1431*
  1432* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1433*-----------------------------------------------------------------
  1434*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1435* EFFECTIVE    NUMBER
  1436*-----------------------------------------------------------------
  1437* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1438* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1439* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1440* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1441* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1442* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1443* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1444* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1445* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1446* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1447******************************************************************
  1448                                                                     CL**2
  1449 01  CALCULATION-PASS-AREA.                                          CL**2
  1450     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1451                                     COMP.                           CL**2
  1452                                                                     CL**2
  1453     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1454       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1455       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1456                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1457       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1458       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1459       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1460       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1461       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1462       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1463       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1464       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1465       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1466       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1467       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1468       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1469       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1470       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1471       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1472       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1473       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1474                                                                     CL**2
  1475     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1476       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1477***********************  INPUT AREAS ****************************    CL**2
  1478                                                                     CL**2
  1479     12  CP-CALCULATION-AREA.                                        CL**2
  1480         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1481         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1482         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1483         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1484         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1485           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1486                                                   'I' 'U'.          CL**2
  1487           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1488           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1489         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1490         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1491         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1492         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1493         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1494                                     COMP-3.                         CL**2
  1495         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1496                                     COMP-3.                         CL**2
  1497         16  CP-CDT-METHOD         PIC X.                            CL**2
  1498           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1499           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1500           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1501         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1502           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1503           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1504         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1505                                     COMP-3.                         CL**2
  1506         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1507                                     COMP-3.                         CL**2
  1508         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1509                                     COMP-3.                         CL**2
  1510         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1511                                     COMP-3.                         CL**2
  1512         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1513                                     COMP-3.                         CL**2
  1514         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1515                                     COMP-3.                         CL**2
  1516         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1517                                     COMP-3.                         CL**2
  1518         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1519           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1520           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1521           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1522           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1523           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1524           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1525           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1526         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1527           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1528           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1529           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1530           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1531           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1532           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1533           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1534           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1535           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1536           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1537           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1538           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1539           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1540           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1541         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1542           88  CP-CLAIM                            VALUE '1'.        CL**2
  1543           88  CP-CANCEL                           VALUE '2'.        CL**2
  1544           88  CP-ISSUE                            VALUE '3'.        CL**2
  1545         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1546           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1547           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1548           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1549           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1550           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1551           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1552           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1553           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1554           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1555           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1556           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1557           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1558           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1559           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1560           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1561           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1562           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1563           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1564                                                     'W' 'X'.        CL**2
  1565           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1566           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1567           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1568           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1569           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1570           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1571           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1572           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1573           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1574           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1575           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1576           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1577           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1578                                                                     CL**2
  1579         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1580                                     COMP-3.                         CL**2
  1581         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1582         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1583         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1584         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1585         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1586           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1587               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1588         16  CP-R78-OPTION         PIC X.                            CL**2
  1589           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1590           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1591                                                                     CL**2
  1592         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1593         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1594         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1595         16  CP-RATE-FILE          PIC X.                            CL**2
  1596         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1597                                     COMP-3.                         CL**2
  1598                                                                     CL**2
  1599         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1600         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1601                                                                     CL**2
  1602         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1603                                     COMP-3.
  1604         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1605                                   PIC S9(5)V99 COMP-3.
  1606         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1607                                     COMP-3.                         CL**2
  1608         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1609                                     COMP-3.                         CL**2
  1610         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1611                                     COMP-3.
  1612         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1613                                  PIC S9(7)V99 COMP-3.
  1614                                                                     CL**2
  1615         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1616         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1617         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1618           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1619           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1620           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1621           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1622         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1623         16  CP-CARRIER            PIC X.                            CL**2
  1624         16  CP-REIN-FLAG          PIC X.                            CL**2
  1625         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1626           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1627                      '2' '3' '4' '5'.                               CL**2
  1628           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1629           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1630           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1631           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1632           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1633           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1634           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1635           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1636         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1637         16  CP-RATING-METHOD      PIC X.                            CL**2
  1638           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1639           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1640           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1641           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1642           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1643           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1644           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1645           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1646           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1647         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1648                                     COMP-3.                         CL**2
  1649         16  CP-BEN-CATEGORY       PIC X.
  1650         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1651         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1652                                   PIC S99V9(5) COMP-3.
  1653         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1654         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1655                                   PIC S99V9(5) COMP-3.
  1656         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1657         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1658         16  CP-EXPIRE-DT          PIC XX.
  1659         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1660         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1661         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1662         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1663         16  CP-DDF-SPEC-CALC      PIC X.
  1664             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1665             88  CP-CALC-CLP              VALUE 'C'.
  1666         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1667         16  CP-CANCEL-REASON      PIC X.
  1668         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1669         16  CP-PMT-MODE           PIC X.
  1670         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1671         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1672         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1673         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1674         16  FILLER                PIC X.
  1675                                                                     CL**2
  1676***************    OUTPUT FROM ELRESV   ************************     CL**2
  1677                                                                     CL**2
  1678         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1679                                                                     CL**2
  1680         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1681                                     COMP-3.                         CL**2
  1682         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1683                                     COMP-3.                         CL**2
  1684         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1685                                     COMP-3.                         CL**2
  1686         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1687                                     COMP-3.                         CL**2
  1688         16  FILLER                PIC X(09).                        CL**2
  1689***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1690                                                                     CL**2
  1691         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1692                                     COMP-3.                         CL**2
  1693         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1694                                     COMP-3.                         CL**2
  1695         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1696                                     COMP-3.                         CL**2
  1697         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1698                                     COMP-3.                         CL**2
  1699         16  FILLER                PIC X(12).                        CL**2
  1700                                                                     CL**2
  1701***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1702                                                                     CL**2
  1703         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1704                                     COMP-3.                         CL**2
  1705         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1706                                     COMP-3.                         CL**2
  1707         16  FILLER                PIC X(12).                        CL**2
  1708                                                                     CL**2
  1709***************    OUTPUT FROM ELRATE   *************************    CL**2
  1710                                                                     CL**2
  1711         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1712                                     COMP-3.                         CL**2
  1713         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1714                                     COMP-3.                         CL**2
  1715         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1716         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1717             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1718         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1719                                     COMP-3.                         CL**2
  1720         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1721         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1722         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1723                                   PIC S9(7)V99 COMP-3.
  1724         16  FILLER                PIC X(07).                        CL**2
  1725                                                                     CL**2
  1726***************    OUTPUT FROM ELRFND   *************************    CL**2
  1727                                                                     CL**2
  1728         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1729                                     COMP-3.                         CL**2
  1730         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1731           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1732           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1733           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1734           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1735           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1736           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1737           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1738           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1739           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1740           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1741           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1742           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1743           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1744           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1745         16  FILLER                PIC X(12).                        CL**2
  1746                                                                     CL**2
  1747***************    OUTPUT FROM ELEARN   *************************    CL**2
  1748                                                                     CL**2
  1749         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1750                                     COMP-3.                         CL**2
  1751         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1752                                     COMP-3.                         CL**2
  1753         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1754                                     COMP-3.                         CL**2
  1755         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1756                                     COMP-3.                         CL**2
  1757         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1758                                     COMP-3.                         CL**2
  1759         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1760                                     COMP-3.                         CL**2
  1761         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1762           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1763           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1764           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1765           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1766           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1767           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1768           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1769           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1770           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1771         16  FILLER                PIC X(12).                        CL**2
  1772                                                                     CL**2
  1773***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1774                                                                     CL**2
  1775         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1776                                     COMP-3.                         CL**2
  1777         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1778                                     COMP-3.                         CL**2
  1779         16  FILLER                PIC X(12).                        CL**2
  1780                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1781***************   MISC WORK AREAS    *****************************   CL**2
  1782         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1783                                     COMP-3.                         CL**2
  1784         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1785                                     COMP-3.                         CL**2
  1786         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1787                                     COMP-3.                         CL**2
  1788         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1789                                     COMP-3.                         CL**2
  1790         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1791                                     COMP-3.                         CL**2
  1792         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1793                                     COMP-3.                         CL**2
  1794         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1795             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1796             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1797             88  IO-ERROR                         VALUE 'E'.         CL**2
  1798                                                                     CL**2
  1799         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1800                                                                     CL**2
  1801         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1802                                                                     CL**2
  1803         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1804                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1805                                     COMP-3.                         CL**2
  1806                                                                     CL**2
  1807         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1808                                                                     CL**2
  1809         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1810                                     COMP-3.                         CL**2
  1811                                                                     CL**2
  1812         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1813                                     COMP-3.                         CL**2
  1814                                                                     CL**2
  1815         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1816                                     COMP-3.                         CL**2
  1817                                                                     CL**2
  1818         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1819                                     COMP-3.                         CL**2
  1820                                                                     CL**2
  1821         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1822                                     COMP-3.                         CL**2
  1823                                                                     CL**2
  1824         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1825                                     COMP-3.                         CL**2
  1826                                                                     CL**2
  1827         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1828                                     COMP-3.                         CL**2
  1829                                                                     CL**2
  1830         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1831             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1832                                                                     CL**2
  1833         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1834                                     COMP-3.                         CL**2
  1835         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1836                                     COMP-3.
  1837         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1838         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS056.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1839         16  cp-net-only-state     pic x value spaces.
  1840         16  FILLER                PIC X(13).                        CL**2
  1841******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS056.cbl
  1842/
* 1843                                 COPY ELCDATE.
  1844******************************************************************06/11/98
  1845*                                                                *ELCDATE
  1846*                                                                *ELCDATE
  1847*                            ELCDATE.                            *   LV023
  1848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1849*                            VMOD=2.003                           ELCDATE
  1850*                                                                *ELCDATE
  1851*                                                                *ELCDATE
  1852*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1853*                 LENGTH = 200                                   *   CL*19
  1854******************************************************************ELCDATE
  1855                                                                  ELCDATE
  1856 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1857     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1858     12  DC-OPTION-CODE                PIC X.                        CL*15
  1859         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1860         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1861         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1862         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1863         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1864         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1865         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1866         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1867         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1868         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1869         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1870         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1871         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1872         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1873         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1874         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1875         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1876         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1877         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1878         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1879         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1880         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1881         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1882         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1883         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1884         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1885         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1886         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1887         88  THREE-CHARACTER-BIN                                  ELCDATE
  1888                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1889         88  GREGORIAN-TO-BIN                                        CL**2
  1890                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1891         88  BIN-TO-GREGORIAN                                        CL**2
  1892                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1893         88  JULIAN-TO-BINARY                                        CL**2
  1894                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1895     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1896         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1897         88  DATE-CONVERSION-ERROR                                ELCDATE
  1898                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1899         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1900         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1901         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1902         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1903         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1904         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1905         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1906         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1907         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1908         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1909     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1910         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1911     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1912         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1913         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1914         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1915     12  FILLER                        PIC X.                        CL*15
  1916     12  DC-CONVERSION-DATES.                                        CL*15
  1917         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1918         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1919         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1920         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1921                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1922             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1923             20  SLASH1-1              PIC X.                        CL*15
  1924             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1925             20  SLASH1-2              PIC X.                        CL*15
  1926             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1927         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1928         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1929                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1930             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1931             20  SLASH2-1              PIC X.                        CL*15
  1932             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1933             20  SLASH2-2              PIC X.                        CL*15
  1934             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1935         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1936         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1937                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1938             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1939             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1940             20  DC-YMD-DAY            PIC 99.                       CL*15
  1941         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1942         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1943                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1944             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1945             20  DC-MDY-DAY            PIC 99.                       CL*15
  1946             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1947         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1948             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1949             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1950             20  FILLER                PIC XX.                       CL*15
  1951             20  DC-ALPHA-CENTURY.                                   CL*15
  1952                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1953             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1954         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1955         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1956         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1957         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1958         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1959                                       PIC 9(05).                    CL*20
  1960         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1961             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1962             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1963         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1964         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1965         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1966     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1967         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1968         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1969             20  FILLER                PIC 9(3).                     CL*15
  1970             20  HOLD-CEN-1-CCYY.                                    CL*15
  1971                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1972                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1973             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1974             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1975         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1976             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1977             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1978             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1979                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1980                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1981             20  FILLER                PIC 9(3).                     CL*15
  1982         16  HOLD-CENTURY-1-X.                                       CL*15
  1983             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1984             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1985                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1986                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1987             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1988             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1989         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1990             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1991             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1992             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1993                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1994                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1995             20  FILLER                PIC XXX.                      CL*23
  1996         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1997         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1998         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1999         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  2000             20  DC-JULIAN-1-CCYY.                                   CL*15
  2001                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  2002                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  2003             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  2004         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  2005         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  2006             20  DC-JULIAN-2-CCYY.                                   CL*15
  2007                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  2008                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  2009             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  2010         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  2011             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  2012             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  2013             20  DC-EDITA-DAY          PIC 99.                       CL*15
  2014             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  2015             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDATE)
  2016                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  2017                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  2018         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  2019             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  2020             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  2021             20  DC-EDITB-DAY          PIC 99.                       CL*15
  2022             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  2023             20  DC-EDITB-CCYY.                                      CL*15
  2024                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  2025                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  2026         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  2027         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  2028                              DC-GREG-DATE-CYMD.                  ELCDATE
  2029             20  DC-CYMD-CEN           PIC 99.                       CL*15
  2030             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  2031             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  2032             20  DC-CYMD-DAY           PIC 99.                       CL*15
  2033         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  2034         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  2035                              DC-GREG-DATE-MDCY.                  ELCDATE
  2036             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  2037             20  DC-MDCY-DAY           PIC 99.                       CL*15
  2038             20  DC-MDCY-CEN           PIC 99.                       CL*15
  2039             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  2040    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  2041        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  2042    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  2043    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS056.cbl
  2044/
* 2045                                 COPY ELCDTECX.
  2046******************************************************************06/05/98
  2047*                                                                *ELCDTECX
  2048*                            ELCDTECX.                           *   LV005
  2049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2050*                            VMOD=2.015                          *ELCDTECX
  2051*                                                                *ELCDTECX
  2052*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2053*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2054*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2055*                                                                *ELCDTECX
  2056******************************************************************ELCDTECX
  2057******************************************************************
  2058*                   C H A N G E   L O G
  2059*
  2060* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2061*-----------------------------------------------------------------
  2062*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2063* EFFECTIVE    NUMBER
  2064*-----------------------------------------------------------------
  2065* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2066*                                  BENEFIT CODES FROM 300 TO 900
  2067* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2068* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2069* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2070******************************************************************
  2071 01  DATE-CARD.                                                   ELCDTECX
  2072     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2073     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2074     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2075     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2076     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2077     12  EP-SW                       PIC  X.                      ELCDTECX
  2078         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2079     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2080         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2081     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2082     12  RUN-CENTURY.                                             ELCDTECX
  2083         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2084     12  FILLER                      PIC  X.                         CL**4
  2085     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2086     12  FILLER                      PIC  XXX.                    ELCDTECX
  2087     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2088                                                                  ELCDTECX
  2089 01  FILLER                          PIC  X(7)                       CL**6
  2090                                          VALUE 'OPTIONS'.        ELCDTECX
  2091 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2092     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2093     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2094     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2095         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2096         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2097     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2098     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2099     12  FILLER                      PIC  X.                      ELCDTECX
  2100     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2101     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2102     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  2103     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2104     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2105     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2106     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2107     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2108     12  FILLER                      PIC  X.                      ELCDTECX
  2109     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2110     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2111     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2112     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2113     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2114     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2115     12  FILLER                      PIC  X.                      ELCDTECX
  2116     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2117     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2118     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2119     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2120     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2121     12  DTE-R78                     PIC  X.                      ELCDTECX
  2122     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2123     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2124     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2125     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2126     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2127     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2128     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2129                                     PIC  X.                      ELCDTECX
  2130         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2131                                                 ' '.             ELCDTECX
  2132         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2133         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2134     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2135         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2136         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2137     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2138     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2139                                     PIC  9.                         CL**4
  2140     12  DTE-SYSTEM.                                              ELCDTECX
  2141         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2142         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2143         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2144         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2145         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2146         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2147         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2148         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2149         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2150         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2151         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2152         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2153         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2154         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2155         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2156         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2157         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2158         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2159         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2160         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  2161         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2162         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2163         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2164         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2165         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2166         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2167     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2168         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2169                                     PIC  X.                      ELCDTECX
  2170     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2171                                                                  ELCDTECX
  2172 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2173     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2174     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2175     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2176*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2177     12  FILLER                      PIC  X.                      ELCDTECX
  2178     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2179     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2180     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2181     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2182     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2183     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2184     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2185                                                                  ELCDTECX
  2186     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2187     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2188     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2189     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2190                                                                  ELCDTECX
  2191     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2192     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2193     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2194     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2195                                                                  ELCDTECX
  2196     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2197     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2198                                                                  ELCDTECX
  2199     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2200     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2201                                                                  ELCDTECX
  2202     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2203                                                                  ELCDTECX
  2204 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2205     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2206     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2207     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2208     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2209     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2210     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2211     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2212                                                                  ELCDTECX
  2213 01  FILLER                          PIC  X(12)                   ELCDTECX
  2214                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2215 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2216     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2217         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2218         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  2219                                                                  ELCDTECX
  2220 01  FILLER                          PIC  X(11)                   ELCDTECX
  2221                                          VALUE 'STATE NAMES'.    ELCDTECX
  2222 01  STATE-NAMES.                                                 ELCDTECX
  2223     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2224         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2225         16  STATE-PIC1.                                          ELCDTECX
  2226             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2227             20  FILLER              PIC  XXX.                    ELCDTECX
  2228             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2229             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2230             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2231             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2232                                                                  ELCDTECX
  2233 01  FILLER                          PIC  X(13)                   ELCDTECX
  2234                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2235 01  CARRIER-NAMES.                                               ELCDTECX
  2236     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2237         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2238         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2239         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2240         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2241         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2242         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2243*        16  FILLER                  PIC  X.                      ELCDTECX
  2244         16  CARRIER-SEC-PAY         PIC  X.
  2245             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2246                                                                  ELCDTECX
  2247 01  FILLER                          PIC  X(9)                       CL**6
  2248                                          VALUE 'INS TYPES'.      ELCDTECX
  2249 01  CLAS-INS-TYPES.                                              ELCDTECX
  2250*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2251     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2252         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2253         16  CLAS-I-AB3.                                          ELCDTECX
  2254             20  FILLER              PIC  X.                      ELCDTECX
  2255             20  CLAS-I-AB2.                                      ELCDTECX
  2256                 24  FILLER          PIC  X.                      ELCDTECX
  2257                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2258         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2259             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2260             20  FILLER              PIC  X.                         CL**4
  2261         16  CLAS-I-AB10.                                         ELCDTECX
  2262             20  FILLER              PIC  X(9).                   ELCDTECX
  2263             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2264         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2265         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2266         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2267         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2268             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2269         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2270         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2271         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2272         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2273         16  CLAS-I-REFUND-METHOD    PIC  X.
  2274         16  CLAS-I-MAX-BENEFITS     PIC 99.
  2275         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2276                                                                  ELCDTECX
  2277 01  FILLER                          PIC  X(16)                   ELCDTECX
  2278                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2279 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2280     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2281                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2282         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2283         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2284         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2285         16  CLAS-MORT-DESC.                                      ELCDTECX
  2286             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2287             20  FILLER              PIC  XX.                        CL**5
  2288             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2289             20  FILLER              PIC  X.                         CL**5
  2290             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2291             20  FILLER              PIC  X.                         CL**5
  2292             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2293             20  FILLER              PIC  X.                         CL**5
  2294             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2295             20  FILLER              PIC  X(5).                      CL**6
  2296                                                                  ELCDTECX
  2297 01  FILLER                          PIC  X(15)                   ELCDTECX
  2298                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2299 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2300     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2301         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2302         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2303         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2304         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2305         16  FILLER                  PIC  X(4).                      CL**6
  2306                                                                  ELCDTECX
  2307 01  FILLER                          PIC  X(7)                       CL**6
  2308                                     VALUE 'INDEXES'.             ELCDTECX
  2309 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2310     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2311     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2312     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2313     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2314     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2315     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2316     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2317     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2318     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2319     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2320     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2321     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2322     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2323     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2324     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2325     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2326     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2327                                                                  ELCDTECX
  2328 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2329     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2330     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2331     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2332     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2333     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2334     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2335     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2336     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2337     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2338     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2339     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2340                                                                  ELCDTECX
  2341 01  FILLER                          PIC  X(13)                   ELCDTECX
  2342                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2343 01  CLAS-MISC.                                                   ELCDTECX
  2344     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2345         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2346         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2347         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2348     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2349     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2350     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2351     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2352     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2353     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2354     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2355     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2356     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2357     12  STATE-L                     PIC  XX.                     ELCDTECX
  2358     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2359     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2360     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2361         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2362         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2363     12  DTE-ABEND-WORK.                                          ELCDTECX
  2364         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2365         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2366                                                                  ELCDTECX
  2367 01  FILLER                          PIC  X(12)                   ELCDTECX
  2368                                     VALUE 'WORKING DATE'.        ELCDTECX
  2369 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2370     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2371         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2372         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2373         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2374     12  WS-CURRENT-DATE.                                         ELCDTECX
  2375         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2376         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2377         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2378         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2379         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2380     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2381         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2382         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2383                                                                  ELCDTECX
  2384 01  FILLER                          PIC  X(12)                   ELCDTECX
  2385                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2386 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2387     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2388         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2389         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2390         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2391                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2392 01  FILLER                          PIC  X(10)                   ELCDTECX
  2393                                     VALUE 'STATE TLRS'.          ELCDTECX
  2394 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2395     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2396         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2397         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2398                                                                  ELCDTECX
  2399 01  FILLER                          PIC  X(13)                   ELCDTECX
  2400                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2401 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2402     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2403         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2404                                                                  ELCDTECX
  2405 01  FILLER                          PIC  X(13)                   ELCDTECX
  2406                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2407 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2408     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2409     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2410     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2411                                     PIC  X.                         CL**5
  2412     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2413     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2414     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2415     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2416     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2417     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2418     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2419     12  FILLER                      PIC  X(75).                  ELCDTECX
  2420******************************************************************ELCDTECX
  2421*01  MISC-CARR-PCT-DATA.                                          00001521
  2422*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2423*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2424*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2425*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2426*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2427*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2428******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS056.cbl
  2429/
* 2430                                 COPY ELCDTEVR.
  2431***************************************************************** 04/15/98
  2432*                                                                *ELCDTEVR
  2433*                                                                *ELCDTEVR
  2434*                            ELCDTEVR.                           *   LV003
  2435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2436*                            VMOD=2.001                          *   CL**2
  2437*                                                                *ELCDTEVR
  2438*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2439*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2440*                                                                *ELCDTEVR
  2441******************************************************************ELCDTEVR
  2442 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2443     05  WS-RUN-DATE.                                             ELCDTEVR
  2444         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2445         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2446         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2447             15  RUN-CC              PIC  99.                     ELCDTEVR
  2448             15  RUN-YR              PIC  99.                     ELCDTEVR
  2449         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2450         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2451     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2452            WS-RUN-DATE              PIC 9(11).                      CL**2
  2453     05  WS-EP-DT.                                                ELCDTEVR
  2454         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2455         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2456         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2457             15  EP-CC               PIC  99.                     ELCDTEVR
  2458             15  EP-YR               PIC  99.                     ELCDTEVR
  2459         10  EP-MO                   PIC  99.                     ELCDTEVR
  2460         10  EP-DA                   PIC  99.                     ELCDTEVR
  2461     05  WS-EP-DT-N REDEFINES                                        CL**2
  2462            WS-EP-DT                 PIC 9(11).                      CL**2
  2463     05  WS-DTE-CONV-DT.                                             CL**4
  2464         10  FILLER                  PIC  9(03).                     CL**4
  2465         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2466         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2467             15  DTE-CONV-CC         PIC  99.                        CL**4
  2468             15  DTE-CONV-YR         PIC  99.                        CL**4
  2469         10  DTE-CONV-MO             PIC  99.                        CL**4
  2470         10  DTE-CONV-DA             PIC  99.                        CL**4
  2471     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2472            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2473 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2474     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2475         10  FILLER                            PIC 999.           ELCDTEVR
  2476         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2477         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2478             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2479             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2480         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2481         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2482     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2483            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2484     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2485         10  FILLER                            PIC 999.           ELCDTEVR
  2486         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2487         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2488         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2489         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2490     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2491            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2492 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2493     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2494         10  FILLER                            PIC 999.           ELCDTEVR
  2495         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2496         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2497             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2498             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2499         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2500         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2501     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2502            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2503     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2504         10  FILLER                            PIC 999.           ELCDTEVR
  2505         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2506         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2507             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2508             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2509         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2510         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2511     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2512            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2513     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2514         10  FILLER                            PIC 999.           ELCDTEVR
  2515         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2516         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2517             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2518             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2519         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2520         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2521     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2522            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2523 01  WS-RATE-RECORD.                                              ELCDTEVR
  2524         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2525             10  FILLER                        PIC 999.           ELCDTEVR
  2526             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2527             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2528                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2529                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2530             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2531             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2532         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2533                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS056.cbl
  2534/
  2535 PROCEDURE DIVISION.
  2536
  2537 0001-DT-CRD-READ SECTION.
* 2538                                 COPY ELCDTERX.
  2539******************************************************************04/15/98
  2540*                                                                *ELCDTERX
  2541*                                                                *ELCDTERX
  2542*                            ELCDTERX.                           *   LV002
  2543*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2544*                            VMOD=2.007                          *ELCDTERX
  2545*                                                                *ELCDTERX
  2546*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2547*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2548*      = ELCDTEFD)                                               *ELCDTERX
  2549*                                                                *ELCDTERX
  2550******************************************************************ELCDTERX
  2551                                                                  ELCDTERX
  2552     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2553                                                                  ELCDTERX
  2554     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2555     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2556     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2557                                                                  ELCDTERX
  2558     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2559                                                                  ELCDTERX
  2560******************************************************************ELCDTERX
  2561*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2562*          WARNING MESSAGES.                                      ELCDTERX
  2563******************************************************************ELCDTERX
  2564     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2565         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2566                                                                  ELCDTERX
  2567     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2568                                                                  ELCDTERX
  2569     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2570                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2571                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2572                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2573                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2574                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2575                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2576                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2577                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2578                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2579                                                                  ELCDTERX
  2580     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2581                                                                  ELCDTERX
  2582     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2583                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2584                                                                  ELCDTERX
  2585     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2586     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2587     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2588     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2589                                                                  ELCDTERX
  2590     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2591         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2592     ELSE                                                         ELCDTERX
  2593         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2594                                                                  ELCDTERX
  2595     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2596         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2597     ELSE                                                         ELCDTERX
  2598         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2599                                                                  ELCDTERX
  2600 0005-READ--CARD.                                                 ELCDTERX
  2601     READ DISK-DATE                                               ELCDTERX
  2602         AT END CLOSE DISK-DATE                                   ELCDTERX
  2603             GO TO 0060-READ--TEST.                               ELCDTERX
  2604                                                                  ELCDTERX
  2605     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2606                                                                  ELCDTERX
  2607     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2608         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2609         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2610         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2611         GO TO 0005-READ--CARD.                                   ELCDTERX
  2612                                                                  ELCDTERX
  2613     IF DD-ID = 'CLAD'                                            ELCDTERX
  2614         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2615         GO TO 0005-READ--CARD.                                   ELCDTERX
  2616                                                                  ELCDTERX
  2617     IF DD-ID = 'CLAX'                                            ELCDTERX
  2618         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2619         GO TO 0005-READ--CARD.                                   ELCDTERX
  2620                                                                  ELCDTERX
  2621     IF DD-ID = 'CLAF'                                            ELCDTERX
  2622         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2623         GO TO 0005-READ--CARD.                                   ELCDTERX
  2624                                                                  ELCDTERX
  2625     IF DD-ID = 'CLAC'                                            ELCDTERX
  2626         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2627                                                                  ELCDTERX
  2628     IF DD-ID = 'CARR'                                            ELCDTERX
  2629         GO TO 0015-READ--CARR.                                   ELCDTERX
  2630                                                                  ELCDTERX
  2631     IF DD-ID = 'STAT'                                            ELCDTERX
  2632         GO TO 0020-READ--STAT.                                   ELCDTERX
  2633                                                                  ELCDTERX
  2634     IF DD-ID = 'BUSC'                                            ELCDTERX
  2635         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2636                                                                  ELCDTERX
  2637     IF DD-ID = 'MORT'                                            ELCDTERX
  2638         GO TO 0030-READ--MORT.                                   ELCDTERX
  2639                                                                  ELCDTERX
  2640     IF DD-ID = 'CLAI'                                            ELCDTERX
  2641         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2642                                                                  ELCDTERX
  2643     IF DD-ID = 'COLC'                                            ELCDTERX
  2644         GO TO 0065-READ--COLC.                                   ELCDTERX
  2645                                                                  ELCDTERX
  2646     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2647        DD-IDA = 'CL'                                             ELCDTERX
  2648         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2649                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2650     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2651        DD-IDA = 'PO'                                             ELCDTERX
  2652         GO TO 0050-READ--POXX.                                   ELCDTERX
  2653                                                                  ELCDTERX
  2654     IF DD-ID = 'OPCA'                                            ELCDTERX
  2655         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2656                                                                  ELCDTERX
  2657     IF DD-ID = 'OPST'                                            ELCDTERX
  2658         GO TO 0072-READ--OPST.                                   ELCDTERX
  2659                                                                  ELCDTERX
  2660     IF DD-ID = 'OPBS'                                            ELCDTERX
  2661         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2662                                                                  ELCDTERX
  2663     IF DD-ID = 'OPMS'                                            ELCDTERX
  2664         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2665                                                                  ELCDTERX
  2666     GO TO 0005-READ--CARD.                                       ELCDTERX
  2667                                                                  ELCDTERX
  2668 0010-READ--CLAC.                                                 ELCDTERX
  2669     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2670     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2671     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2672     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2673     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2674     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2675     GO TO 0005-READ--CARD.                                       ELCDTERX
  2676                                                                  ELCDTERX
  2677 0015-READ--CARR.                                                 ELCDTERX
  2678     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2679     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2680        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2681        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2682        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2683        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2684        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2685        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2686        MOVE DD-CARR1-SECPAY-SW
  2687                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2688     END-IF
  2689                                                                  ELCDTERX
  2690     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2691     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2692        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2693        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2694        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2695        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2696        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2697        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2698        MOVE DD-CARR2-SECPAY-SW
  2699                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2700     END-IF
  2701                                                                  ELCDTERX
  2702                                                                  ELCDTERX
  2703     GO TO 0005-READ--CARD.                                       ELCDTERX
  2704                                                                  ELCDTERX
  2705 0020-READ--STAT.                                                 ELCDTERX
  2706     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2707     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2708        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2709         GO TO 0005-READ--CARD.                                   ELCDTERX
  2710                                                                  ELCDTERX
  2711     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2712     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2713     GO TO 0020-READ--STAT.                                       ELCDTERX
  2714                                                                  ELCDTERX
  2715 0025-READ--BUSC.                                                 ELCDTERX
  2716     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2717     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2718        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2719         GO TO 0005-READ--CARD.                                   ELCDTERX
  2720                                                                  ELCDTERX
  2721     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2722     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2723     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2724                                                                  ELCDTERX
  2725 0030-READ--MORT.                                                 ELCDTERX
  2726     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2727     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2728        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2729         GO TO 0005-READ--CARD.                                   ELCDTERX
  2730                                                                  ELCDTERX
  2731     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2732     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2733     GO TO 0030-READ--MORT.                                       ELCDTERX
  2734                                                                  ELCDTERX
  2735 0035-READ--CLXX.                                                 ELCDTERX
  2736     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2737          GO TO 0005-READ--CARD.                                  ELCDTERX
  2738                                                                  ELCDTERX
  2739     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2740         DISPLAY '***********************************************'ELCDTERX
  2741         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2742         DISPLAY '***********************************************'ELCDTERX
  2743         GO TO 0055-READ--STOP.                                   ELCDTERX
  2744                                                                  ELCDTERX
  2745     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2746        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2747         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2748                                                                  ELCDTERX
  2749     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2750        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2751         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2752                                                                  ELCDTERX
  2753*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2754     GO TO 0005-READ--CARD.                                       ELCDTERX
  2755                                                                  ELCDTERX
  2756 0040-READ--CLAI.                                                 ELCDTERX
  2757     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2758     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2759        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2760         GO TO 0005-READ--CARD.                                   ELCDTERX
  2761                                                                  ELCDTERX
  2762     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2763     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2764     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2765                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2766 0045-READ--DUMP.                                                 ELCDTERX
  2767     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2768     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2769                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2770     PERFORM ABEND-PGM.                                           ELCDTERX
  2771                                                                  ELCDTERX
  2772 0050-READ--POXX.                                                 ELCDTERX
  2773     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2774         GO TO 0005-READ--CARD.                                   ELCDTERX
  2775                                                                  ELCDTERX
  2776     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2777         DISPLAY '***********************************************'ELCDTERX
  2778         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2779         DISPLAY '***********************************************'ELCDTERX
  2780         GO TO 0055-READ--STOP.                                   ELCDTERX
  2781                                                                  ELCDTERX
  2782     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2783     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2784     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2785     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2786                                                                  ELCDTERX
  2787     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2788         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2789     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2790         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2791                                                                  ELCDTERX
  2792     GO TO 0005-READ--CARD.                                       ELCDTERX
  2793                                                                  ELCDTERX
  2794 0055-READ--STOP.                                                 ELCDTERX
  2795     GOBACK.                                                      ELCDTERX
  2796                                                                  ELCDTERX
  2797 0060-READ--TEST.                                                 ELCDTERX
  2798     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2799        CLAX-ID         = SPACE  OR                               ELCDTERX
  2800        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2801         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2802                                                                  ELCDTERX
  2803     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2804     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2805                                                                  ELCDTERX
  2806 0065-READ--COLC.                                                 ELCDTERX
  2807     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2808     GO TO 0005-READ--CARD.                                       ELCDTERX
  2809                                                                  ELCDTERX
  2810 0070-READ--OPCA.                                                 ELCDTERX
  2811                                                                  ELCDTERX
  2812     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2813                                                                  ELCDTERX
  2814     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2815             OR                                                   ELCDTERX
  2816         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2817         GO TO 0005-READ--CARD.                                   ELCDTERX
  2818                                                                  ELCDTERX
  2819     ADD 1                       TO INDEXCA.                      ELCDTERX
  2820     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2821                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2822     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2823                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS056.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2824 0072-READ--OPST.                                                 ELCDTERX
  2825                                                                  ELCDTERX
  2826     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2827                                                                  ELCDTERX
  2828     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2829             OR                                                   ELCDTERX
  2830         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2831         GO TO 0005-READ--CARD.                                   ELCDTERX
  2832                                                                  ELCDTERX
  2833     ADD 1                       TO INDEXST.                      ELCDTERX
  2834     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2835                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2836     GO TO 0072-READ--OPST.                                       ELCDTERX
  2837                                                                  ELCDTERX
  2838 0074-READ--OPBS.                                                 ELCDTERX
  2839                                                                  ELCDTERX
  2840     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2841                                                                  ELCDTERX
  2842     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2843             OR                                                   ELCDTERX
  2844         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2845         GO TO 0005-READ--CARD.                                   ELCDTERX
  2846                                                                  ELCDTERX
  2847     ADD 1                       TO INDEXBS.                      ELCDTERX
  2848     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2849     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2850                                                                  ELCDTERX
  2851 0079-READ--EXIT.                                                 ELCDTERX
  2852*    EXIT.                                                        ELCDTERX
  2853******************************************************************ELCDTERX
  2854
  2855     MOVE COMPANY-NAME           TO  HD-CO
  2856     MOVE ALPH-DATE              TO  HD-DT
  2857     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  2858     MOVE RUN-DATE               TO WS-THIS-MONTH-DATE
  2859
  2860     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2861
  2862     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2863
  2864     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2865
  2866     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2867
  2868     GOBACK
  2869     .
  2870
  2871 0010-INITIALIZE.
  2872
  2873     MOVE +0                     TO WS-EXP-PREM
  2874                                    WS-REC-PREM
  2875                                    WS-GA-COMM
  2876                                    WS-BASE-COMM
  2877                                    WS-REC-BASE-COMM
  2878
  2879     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  2880        (WS-A > +5)
  2881        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS056.cbl
  2882                                    WS-TOT-REC-PREM (WS-A)
  2883                                    WS-TOT-GA-COMM (WS-A)
  2884     END-PERFORM
  2885     MOVE LOW-VALUES             TO WS-ERPYAJ-KEY
  2886
  2887     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  2888        (WS-PYAJ-INDEX > +500)
  2889        MOVE LOW-VALUES          TO WS-DA-KEY (WS-PYAJ-INDEX)
  2890        MOVE +0                  TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
  2891     END-PERFORM
  2892
  2893     MOVE +0                     TO WS-PYAJ-INDEX
  2894     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  2895     MOVE -1                     TO DC-ELAPSED-MONTHS
  2896     MOVE '1'                    TO DC-END-OF-MONTH
  2897     MOVE +0                     TO DC-ELAPSED-DAYS
  2898     MOVE '6'                    TO DC-OPTION-CODE
  2899     PERFORM 8510-DATE-CONVERSION
  2900                                 THRU 8590-EXIT
  2901     IF NO-CONVERSION-ERROR
  2902        MOVE DC-GREG-DATE-CYMD   TO WS-LAST-MONTH-DATE
  2903        MOVE DC-BIN-DATE-2       TO WS-BIN-LAST-MONTH-DT
  2904        DISPLAY ' LAST MONTH IS ' WS-LAST-MONTH-DATE
  2905     ELSE
  2906        DISPLAY ' ERROR IN LAST MONTH DATE CONVERSION '
  2907     END-IF
  2908
  2909     MOVE RUN-DATE               TO WS-WORK-DATE
  2910     MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
  2911     MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
  2912
  2913     .
  2914
  2915 0010-EXIT.
  2916     EXIT.
  2917
  2918 0020-OPEN-FILES.
  2919
  2920     OPEN INPUT CERTS
  2921                ERPYAJ
  2922         OUTPUT EXTRACT PRINTX DEBUG-EXTRACT
  2923         I-O ERDUEP
  2924
  2925     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2926        CONTINUE
  2927     ELSE
  2928        DISPLAY ' ERROR ON ERDUEP OPEN  '
  2929           ERDUEP-FILE-STATUS
  2930        MOVE ' ERROR ON ERDUEP OPEN  '
  2931                                 TO WS-ABEND-MESSAGE
  2932        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2933        PERFORM ABEND-PGM
  2934     END-IF
  2935
  2936     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  2937        CONTINUE
  2938     ELSE
  2939        DISPLAY ' ERROR ON ERPYAJ OPEN  '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS056.cbl
  2940           ERPYAJ-FILE-STATUS
  2941        MOVE ' ERROR ON ERPYAJ OPEN  '
  2942                                 TO WS-ABEND-MESSAGE
  2943        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2944        PERFORM ABEND-PGM
  2945     END-IF
  2946
  2947     MOVE SPACES                 TO EXTRACT-RECORD
  2948     MOVE ';'                    TO WS-TAB1  WS-TAB2  WS-TAB3
  2949                                    WS-TAB4  WS-TAB5  WS-TAB6
  2950                                    WS-TAB7  WS-TAB8  WS-TAB9
  2951                                    WS-TAB10 WS-TAB11 WS-TAB12
  2952                                    WS-TAB13 WS-TAB14 WS-TAB15
  2953                                    WS-TAB16 WS-TAB17 WS-TAB18
  2954                                    WS-TAB19 WS-TAB20 WS-TAB21
  2955                                    WS-TAB22 WS-TAB23
  2956
  2957     MOVE ZEROS                  TO EXT-MISC1
  2958                                    EXT-MISC2
  2959                                    EXT-MISC3
  2960                                    EXT-MISC4
  2961                                    EXT-MISC5
  2962
  2963     MOVE EXTRACT-RECORD         TO WS-INIT-EXTRACT
  2964
  2965     MOVE SPACES                 TO DEBUG-EXTRACT-RECORD
  2966     MOVE ';'                    TO DB-TAB1  DB-TAB2  DB-TAB3
  2967                                    DB-TAB4  DB-TAB5  DB-TAB6
  2968                                    DB-TAB7  DB-TAB8  DB-TAB9
  2969                                    DB-TAB10 DB-TAB11 DB-TAB12
  2970                                    DB-TAB13 DB-TAB14 DB-TAB15
  2971                                    DB-TAB16 DB-TAB17
  2972
  2973     MOVE DEBUG-EXTRACT-RECORD   TO WS-INIT-DB-EXTRACT
  2974
  2975     .
  2976 0020-EXIT.
  2977     EXIT.
  2978
  2979 0030-CLOSE-FILES.
  2980
  2981     DISPLAY ' MADE IT TO CLOSE FILES '
  2982     CLOSE CERTS PRINTX
  2983         EXTRACT ERDUEP DEBUG-EXTRACT
  2984
  2985     IF ERDUEP-FILE-STATUS = '00' OR '97'
  2986        CONTINUE
  2987     ELSE
  2988        DISPLAY ' ERROR ON ERDUEP CLOSE '
  2989           ERDUEP-FILE-STATUS
  2990        MOVE ' ERROR ON ERDUEP OPEN  '
  2991                                 TO WS-ABEND-MESSAGE
  2992        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  2993        PERFORM ABEND-PGM
  2994     END-IF
  2995
  2996
  2997     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS056.cbl
  2998
  2999 0030-EXIT.
  3000     EXIT.
  3001
  3002 0042-START-ERPYAJ.
  3003
  3004     MOVE LOW-VALUES             TO PY-CONTROL-PRIMARY
  3005     MOVE DTE-CLASIC-COMPANY-CD  TO PY-COMPANY-CD
  3006
  3007     START ERPYAJ KEY IS NOT < PY-CONTROL-PRIMARY
  3008
  3009     IF ERPYAJ-FILE-STATUS = '10' OR '23'
  3010        SET END-OF-FILE          TO TRUE
  3011     ELSE
  3012        IF ERPYAJ-FILE-STATUS NOT = '00'
  3013           MOVE ' ERROR ON ERPYAJ START '
  3014                                 TO WS-ABEND-MESSAGE
  3015           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3016           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3017           PERFORM ABEND-PGM
  3018        ELSE
  3019           DISPLAY ' GOOD START ON ERPYAJ '
  3020        END-IF
  3021     END-IF
  3022
  3023     .
  3024 0042-EXIT.
  3025     EXIT.
  3026
  3027 0043-READ-ERPYAJ.
  3028
  3029     READ ERPYAJ NEXT RECORD
  3030
  3031     IF (ERPYAJ-FILE-STATUS = '10' OR '23')
  3032        OR (PY-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  3033        SET END-OF-FILE          TO TRUE
  3034     ELSE
  3035        IF ERPYAJ-FILE-STATUS NOT = '00'
  3036           MOVE ' ERROR ON ERPYAJ READ  '
  3037                                 TO WS-ABEND-MESSAGE
  3038           MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3039           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3040           PERFORM ABEND-PGM
  3041        ELSE
  3042           DISPLAY ' GOOD READ ON ERPYAJ ' PY-CONTROL-PRIMARY
  3043        END-IF
  3044     END-IF
  3045
  3046     .
  3047 0043-EXIT.
  3048     EXIT.
  3049
  3050 0045-PROCESS-ERPYAJ.
  3051
  3052     IF PY-RECORD-TYPE = 'P'
  3053        ADD +1                   TO WS-PYAJ-INDEX
  3054        MOVE PY-CONTROL-PRIMARY  TO WS-DA-KEY (WS-PYAJ-INDEX)
  3055        MOVE PY-ENTRY-AMT        TO WS-DA-AMOUNT (WS-PYAJ-INDEX)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS056.cbl
  3056*       DISPLAY ' FOUND A HIT '
  3057     END-IF
  3058
  3059     PERFORM 0043-READ-ERPYAJ    THRU 0043-EXIT
  3060
  3061     .
  3062 0045-EXIT.
  3063     EXIT.
  3064
  3065 0050-PROCESS-FILE.
  3066
  3067     PERFORM 0042-START-ERPYAJ   THRU 0042-EXIT
  3068     IF NOT END-OF-FILE
  3069        PERFORM 0043-READ-ERPYAJ THRU 0043-EXIT
  3070     END-IF
  3071
  3072     PERFORM 0045-PROCESS-ERPYAJ THRU 0045-EXIT UNTIL
  3073        END-OF-FILE
  3074     MOVE WS-PYAJ-INDEX          TO WS-PYAJ-MAX
  3075
  3076     CLOSE ERPYAJ
  3077
  3078     IF ERPYAJ-FILE-STATUS = '00' OR '97'
  3079        CONTINUE
  3080     ELSE
  3081        MOVE ' ERROR ON ERPYAJ CLOSE '
  3082                                 TO WS-ABEND-MESSAGE
  3083        MOVE ERPYAJ-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3084        DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  3085        PERFORM ABEND-PGM
  3086     END-IF
  3087
  3088     SET MORE-RECORDS            TO TRUE
  3089     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3090     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3091     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  3092           END-OF-FILE
  3093
  3094     PERFORM 0150-UPDATE-DUEP    THRU 0150-EXIT
  3095     PERFORM 0300-ACCT-BREAK     THRU 0300-EXIT
  3096     PERFORM 0310-ST-BREAK       THRU 0310-EXIT
  3097     PERFORM 0320-GRP-BREAK      THRU 0320-EXIT
  3098     PERFORM 0330-CAR-BREAK      THRU 0330-EXIT
  3099     PERFORM 0340-FIN-BREAK      THRU 0340-EXIT
  3100
  3101     .
  3102
  3103 0050-EXIT.
  3104     EXIT.
  3105
  3106 0060-READ-CERT.
  3107
  3108     READ CERTS AT END
  3109         SET END-OF-FILE         TO TRUE
  3110     END-READ
  3111
  3112     IF NOT END-OF-FILE
  3113        ADD +1                   TO CERT-IN-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS056.cbl
  3114        MOVE ' '                 TO WS-GIANT-SW
  3115     END-IF
  3116     .
  3117
  3118 0060-EXIT.
  3119     EXIT.
  3120
  3121 0080-PROCESS-CERT.
  3122
  3123     IF CR-LFTYP NOT = '  ' AND ZEROS
  3124        PERFORM 0207-FIND-LIFE-TYPE
  3125                                 THRU 0207-EXIT
  3126     END-IF
  3127
  3128     IF CR-AHTYP NOT = '  ' AND ZEROS
  3129        PERFORM 0208-FIND-AH-TYPE
  3130                                 THRU 0208-EXIT
  3131     END-IF
  3132
  3133     IF (CR-LFTYP = 'MJ' OR 'MS'
  3134         OR 'NJ' OR 'NL'
  3135         OR 'PL' OR 'PJ'
  3136         OR 'SJ' OR 'SL')
  3137        OR (CR-AHTYP =
  3138               'MJ' OR 'MS' OR 'MI' OR 'MU'
  3139            OR 'NI' OR 'NJ' OR 'NL' OR 'NU'
  3140            OR 'PI' OR 'PJ' OR 'PL' OR 'PU'
  3141            OR 'SI' OR 'SJ' OR 'SL' OR 'SU'
  3142            OR 'MX' OR 'MY' OR 'MZ')
  3143        IF (CR-ENTRY-DATE = WS-THIS-MONTH-DATE)
  3144           OR (CR-LF-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3145           OR (CR-AH-CANCEL-EXIT-DATE = WS-THIS-MONTH-DATE)
  3146           SET THIS-IS-A-GIANT-CERT TO TRUE
  3147        ELSE
  3148           MOVE 'V'              TO CR-ENTRY-STATUS
  3149        END-IF
  3150     END-IF
  3151
  3152     IF CR-ACCT-CONTROL NOT = WS-HOLD-CONTROL
  3153        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  3154     END-IF
  3155
  3156     MOVE CR-ACCT-CONTROL        TO WS-HOLD-CONTROL
  3157     MOVE CR-DT                  TO WS-ISSUE-DATE
  3158
  3159     IF (CR-ENTRY-STATUS = '9' OR 'D' OR 'V')
  3160                 OR
  3161        ((CR-LFTYP (1:1) NOT = 'M' AND 'N' AND 'P' AND 'S')
  3162        AND (CR-AHTYP (1:1) NOT = 'M' AND 'N' AND 'P' AND 'S'))
  3163        CONTINUE
  3164     ELSE
  3165        IF CR-ENTRY-STATUS NOT = '5'
  3166           PERFORM 0200-CALC-UEP THRU 0200-EXIT
  3167           PERFORM 0090-FIND-ADJ THRU 0090-EXIT
  3168        END-IF
  3169     END-IF
  3170
  3171     IF (WS-EXP-PREM NOT = +0)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS056.cbl
  3172        OR (WS-REC-PREM NOT = +0)
  3173        OR (WS-GA-COMM NOT = +0)
  3174        PERFORM 0100-WRITE-EXTRACT
  3175                                 THRU 0100-EXIT
  3176     END-IF
  3177
  3178     MOVE +0                     TO WS-EXP-PREM
  3179                                    WS-REC-PREM
  3180                                    WS-GA-COMM
  3181                                    WS-BASE-COMM
  3182                                    WS-REC-BASE-COMM
  3183
  3184     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3185
  3186     .
  3187
  3188 0080-EXIT.
  3189     EXIT.
  3190
  3191 0090-FIND-ADJ.
  3192
  3193     MOVE CR-COMPANY-CD          TO WS-PYAJ-MATCH-KEY (1:1)
  3194     MOVE CR-CARRIER             TO WS-PYAJ-MATCH-KEY (2:1)
  3195     MOVE CR-GROUPING            TO WS-PYAJ-MATCH-KEY (3:6)
  3196     IF CR-REMIT-TO NOT NUMERIC
  3197        MOVE ZEROS               TO CR-REMIT-TO
  3198     END-IF
  3199     IF CR-REMIT-TO = ZEROS
  3200        MOVE 01                  TO CR-REMIT-TO
  3201     END-IF
  3202     MOVE CR-COM-AGT (CR-REMIT-TO)
  3203                                 TO WS-PYAJ-MATCH-KEY (9:10)
  3204     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  3205        (WS-A > +10)
  3206        OR (CR-AGT-TYPE (WS-A) = 'D' OR 'C')
  3207     END-PERFORM
  3208
  3209     IF WS-A < +11
  3210        MOVE CR-COM-AGT (WS-A)   TO WS-PYAJ-MATCH-KEY (19:10)
  3211     ELSE
  3212        MOVE CR-ACCOUNT          TO WS-PYAJ-MATCH-KEY (19:10)
  3213     END-IF
  3214*    MOVE +0                     TO WS-DP-ADJ
  3215*    DISPLAY ' CERT KEY TO MATCH ' WS-PYAJ-MATCH-KEY
  3216     PERFORM VARYING WS-PYAJ-INDEX FROM +1 BY +1 UNTIL
  3217        (WS-PYAJ-INDEX > WS-PYAJ-MAX)
  3218        IF WS-DA-KEY (WS-PYAJ-INDEX) (1:28) = WS-PYAJ-MATCH-KEY
  3219           COMPUTE WS-DP-ADJ
  3220              = WS-DP-ADJ + WS-DA-AMOUNT (WS-PYAJ-INDEX)
  3221           MOVE LOW-VALUES       TO WS-DA-KEY (WS-PYAJ-INDEX)
  3222        END-IF
  3223     END-PERFORM
  3224
  3225     .
  3226 0090-EXIT.
  3227     EXIT.
  3228
  3229
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS056.cbl
  3230 0100-WRITE-EXTRACT.
  3231
  3232     MOVE WS-INIT-EXTRACT        TO EXTRACT-RECORD
  3233
  3234     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  3235        + WS-EXP-PREM
  3236
  3237     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  3238        + WS-REC-PREM
  3239
  3240     COMPUTE WS-TOT-BASE-COMM (1) = WS-TOT-BASE-COMM (1)
  3241        + WS-BASE-COMM
  3242
  3243     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  3244        + WS-GA-COMM
  3245
  3246     MOVE CR-CARRIER             TO EXT-CAR
  3247     MOVE CR-GROUPING            TO EXT-GROUP
  3248     MOVE CR-STATE               TO EXT-STATE
  3249     MOVE CR-ACCOUNT             TO EXT-ACCOUNT
  3250     MOVE CR-DT                  TO WS-ISSUE-DATE
  3251     MOVE WS-ISSUE-MMDD (1:2)    TO EXT-EFF-DATE (1:2)
  3252     MOVE '-'                    TO EXT-EFF-DATE (3:1)
  3253                                    EXT-EFF-DATE (6:1)
  3254     MOVE WS-ISSUE-MMDD (3:2)    TO EXT-EFF-DATE (4:2)
  3255     MOVE WS-ISSUE-CCYY          TO EXT-EFF-DATE (7:4)
  3256     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  3257     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-ENT-DATE (1:2)
  3258     MOVE '-'                    TO EXT-ENT-DATE (3:1)
  3259                                    EXT-ENT-DATE (6:1)
  3260     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-ENT-DATE (4:2)
  3261     MOVE WS-ENTRY-CCYY          TO EXT-ENT-DATE (7:4)
  3262     MOVE RUN-DATE               TO WS-ENTRY-DATE
  3263     MOVE WS-ENTRY-MMDD (1:2)    TO EXT-VAL-DATE (1:2)
  3264     MOVE '-'                    TO EXT-VAL-DATE (3:1)
  3265                                    EXT-VAL-DATE (6:1)
  3266     MOVE WS-ENTRY-MMDD (3:2)    TO EXT-VAL-DATE (4:2)
  3267     MOVE WS-ENTRY-CCYY          TO EXT-VAL-DATE (7:4)
  3268
  3269     MOVE WS-EARN-TERM           TO EXT-EARN-TERM
  3270     MOVE CR-CERT-NO             TO EXT-CERT-NO
  3271     MOVE CR-LFTYP               TO EXT-LF-BEN-CODE
  3272     MOVE CR-AHTYP               TO EXT-AH-BEN-CODE
  3273     MOVE CR-LF-TERM             TO EXT-LF-TERM
  3274     MOVE CR-AH-TERM             TO EXT-AH-TERM
  3275     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3276     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-LF-EXP-DATE (1:2)
  3277     MOVE '-'                    TO EXT-LF-EXP-DATE (3:1)
  3278                                    EXT-LF-EXP-DATE (6:1)
  3279     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-LF-EXP-DATE (4:2)
  3280     MOVE WS-EXPIRE-CCYY         TO EXT-LF-EXP-DATE (7:4)
  3281
  3282     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  3283     MOVE WS-EXPIRE-MMDD (1:2)   TO EXT-AH-EXP-DATE (1:2)
  3284     MOVE '-'                    TO EXT-AH-EXP-DATE (3:1)
  3285                                    EXT-AH-EXP-DATE (6:1)
  3286     MOVE WS-EXPIRE-MMDD (3:2)   TO EXT-AH-EXP-DATE (4:2)
  3287     MOVE WS-EXPIRE-CCYY         TO EXT-AH-EXP-DATE (7:4)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS056.cbl
  3288     MOVE WS-EXP-PREM            TO EXT-EXP-PREM
  3289     MOVE WS-REC-PREM            TO EXT-REC-PREM
  3290     MOVE WS-BASE-COMM           TO EXT-BASE-COMM
  3291
  3292*    IF WS-BASE-COMM > ZEROS
  3293*       MOVE WS-BASE-COMM        TO EXT-BASE-COMM
  3294*    ELSE
  3295*       MOVE WS-REC-BASE-COMM    TO EXT-BASE-COMM
  3296*    END-IF
  3297
  3298     MOVE WS-GA-COMM             TO EXT-GA-COMM
  3299
  3300     WRITE EXTRACT-RECORD
  3301     PERFORM 0125-ACCUM-DUEP     THRU 0125-EXIT
  3302
  3303     .
  3304
  3305 0100-EXIT.
  3306     EXIT.
  3307 0125-ACCUM-DUEP.
  3308
  3309     IF (WS-DUEP-CONTROL NOT = LOW-VALUES)
  3310        AND (WS-DUEP-CONTROL NOT = CR-ACCT-CONTROL)
  3311        PERFORM 0150-UPDATE-DUEP  THRU 0150-EXIT
  3312        MOVE +0                  TO WS-DP-REC-PREM
  3313                                    WS-DP-EXP-PREM
  3314                                    WS-DP-GA-COMM
  3315                                    WS-DP-BASE-COMM
  3316                                    WS-DP-ADJ
  3317     END-IF
  3318
  3319     MOVE CR-ACCT-CONTROL        TO WS-DUEP-CONTROL
  3320
  3321     COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM + WS-REC-PREM
  3322     COMPUTE WS-DP-EXP-PREM = WS-DP-EXP-PREM + WS-EXP-PREM
  3323     COMPUTE WS-DP-GA-COMM = WS-DP-GA-COMM + WS-GA-COMM
  3324     COMPUTE WS-DP-BASE-COMM = WS-DP-BASE-COMM + WS-BASE-COMM
  3325
  3326
  3327
  3328     .
  3329 0125-EXIT.
  3330     EXIT.
  3331
  3332 0150-UPDATE-DUEP.
  3333
  3334     MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
  3335     MOVE WS-DUEP-CONTROL        TO DP-ACCOUNT-CONTROL
  3336     MOVE LOW-VALUES             TO DP-KEY-FILLER
  3337     READ ERDUEP
  3338     IF ERDUEP-FILE-STATUS = '00'
  3339*       COMPUTE WS-DP-REC-PREM = WS-DP-REC-PREM
  3340        MOVE WS-DP-REC-PREM      TO DP-REC-PREM
  3341        MOVE WS-DP-EXP-PREM      TO DP-EXP-PREM
  3342        MOVE WS-DP-GA-COMM       TO DP-GA-COMM
  3343        MOVE WS-DP-BASE-COMM     TO DP-BASE-COMM
  3344        MOVE WS-DP-ADJ           TO DP-ADJUSTMENTS
  3345        IF DP-LAST-MONTH-END-DT NOT = BIN-RUN-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS056.cbl
  3346*  NEED TO THINK ABOUT THE AGEING STUFF RIGHT HERE
  3347           MOVE DP-END-BAL       TO DP-BAL-FWD
  3348           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3349        END-IF
  3350        COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3351           - DP-REC-PREM + DP-ADJUSTMENTS
  3352        REWRITE DUE-PREMIUM-RECORD
  3353     ELSE
  3354        IF ERDUEP-FILE-STATUS = '23'
  3355           MOVE DTE-CLASIC-COMPANY-CD
  3356                                 TO DP-COMPANY-CD
  3357           MOVE WS-DUEP-CONTROL  TO DP-ACCOUNT-CONTROL
  3358           MOVE +0               TO DP-BAL-FWD
  3359                                    DP-ADJUSTMENTS
  3360                                    DP-END-BAL
  3361           MOVE WS-DP-REC-PREM   TO DP-REC-PREM
  3362           MOVE WS-DP-EXP-PREM   TO DP-EXP-PREM
  3363           MOVE WS-DP-GA-COMM    TO DP-GA-COMM
  3364           MOVE WS-DP-BASE-COMM  TO DP-BASE-COMM
  3365           MOVE WS-DP-ADJ        TO DP-ADJUSTMENTS
  3366           COMPUTE DP-END-BAL = DP-BAL-FWD + DP-EXP-PREM
  3367              - DP-REC-PREM + DP-ADJUSTMENTS
  3368           MOVE BIN-RUN-DATE     TO DP-LAST-MONTH-END-DT
  3369           WRITE DUE-PREMIUM-RECORD
  3370        END-IF
  3371     END-IF
  3372
  3373
  3374     .
  3375 0150-EXIT.
  3376     EXIT.
  3377
  3378
  3379 0200-CALC-UEP.
  3380
  3381     MOVE LOW-VALUES             TO WS-BIN-AH-END-DATE
  3382                                    WS-BIN-LF-END-DATE
  3383
  3384     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3385        CONTINUE
  3386     ELSE
  3387        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3388            (CLAS-INDEXS = CLAS-MAXS) OR
  3389            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3390        END-PERFORM
  3391        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3392           CONTINUE
  3393        ELSE
  3394           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3395           MOVE 0302 TO WS-RETURN-CODE
  3396           PERFORM ABEND-PGM
  3397        END-IF
  3398     END-IF
  3399
  3400     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3401     MOVE 'L'                    TO DC-OPTION-CODE
  3402     PERFORM 8510-DATE-CONVERSION
  3403                                 THRU 8590-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS056.cbl
  3404     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3405                                    WS-BIN-CR-DT
  3406
  3407     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3408        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3409     END-IF
  3410
  3411     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3412
  3413     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3414        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3415        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3416                                    DC-ELAPSED-DAYS
  3417        MOVE '3'                 TO DC-OPTION-CODE
  3418        PERFORM 8510-DATE-CONVERSION
  3419                                 THRU 8590-EXIT
  3420        IF NO-CONVERSION-ERROR
  3421           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3422                                   WS-BIN-1ST-DT
  3423        ELSE
  3424           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3425        END-IF
  3426      END-IF
  3427
  3428     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3429        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3430     END-IF
  3431
  3432     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3433        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3434        MOVE +1                  TO DC-ELAPSED-MONTHS
  3435        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3436        MOVE '6'                 TO DC-OPTION-CODE
  3437        PERFORM 8510-DATE-CONVERSION
  3438                                 THRU 8590-EXIT
  3439        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3440                                    WS-BIN-1ST-DT
  3441        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3442     END-IF
  3443
  3444     MOVE WS-BIN-CR-DT           TO DC-BIN-DATE-1
  3445     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-2
  3446     MOVE '1'                    TO DC-OPTION-CODE
  3447     MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  3448                                    DC-ELAPSED-DAYS
  3449     PERFORM 8510-DATE-CONVERSION
  3450                                 THRU 8590-EXIT
  3451     IF NO-CONVERSION-ERROR
  3452        MOVE DC-ELAPSED-DAYS     TO WS-DAYS-TO-1ST
  3453     ELSE
  3454        MOVE +30                 TO WS-DAYS-TO-1ST
  3455     END-IF
  3456
  3457     MOVE CR-LF-EXPIRE-DATE      TO WS-WORK-DATE
  3458
  3459     MOVE LOW-VALUES             TO WS-BIN-LF-CAN-DATE
  3460     MOVE +0                     TO WS-LF-CAN-TERM
  3461     MOVE 'N'                    TO WS-LF-CAN-QUAL-SW
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS056.cbl
  3462
  3463     IF CR-LF-CANC-DT NOT = ZEROS
  3464        MOVE CR-LF-CANC-DT       TO DC-GREG-DATE-CYMD
  3465        MOVE 'L'                 TO DC-OPTION-CODE
  3466        PERFORM 8510-DATE-CONVERSION
  3467                                 THRU 8590-EXIT
  3468        IF NO-CONVERSION-ERROR
  3469           MOVE DC-BIN-DATE-1    TO WS-BIN-LF-CAN-DATE
  3470        ELSE
  3471           MOVE LOW-VALUES       TO WS-BIN-LF-CAN-DATE
  3472        END-IF
  3473        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3474        MOVE '1'                 TO DC-OPTION-CODE
  3475        MOVE +0                  TO DC-ELAPSED-MONTHS
  3476                                    DC-ELAPSED-DAYS
  3477        PERFORM 8510-DATE-CONVERSION
  3478                                 THRU 8590-EXIT
  3479        IF NO-CONVERSION-ERROR
  3480           MOVE DC-ELAPSED-MONTHS
  3481                                 TO WS-LF-CAN-TERM
  3482           IF (WS-LF-CAN-TERM > +0)
  3483              AND (WS-BIN-LF-CAN-DATE > WS-BIN-1ST-DT)
  3484              SUBTRACT +1        FROM WS-LF-CAN-TERM
  3485           END-IF
  3486           IF (WS-LF-CAN-TERM > +0)
  3487              AND (WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE)
  3488              SET CREDIT-LF-CANCEL TO TRUE
  3489           END-IF
  3490        END-IF
  3491     END-IF
  3492
  3493*    IF (CR-LF-CANC-DT NOT = ZEROS) AND
  3494*       (CR-LF-CANC-DT < WS-WORK-DATE)
  3495*       MOVE CR-LF-CANC-DT           TO WS-WORK-DATE
  3496*    END-IF
  3497
  3498     IF (CR-LF-CANCEL-EXIT-DATE NOT = ZEROS)
  3499        AND (CR-LF-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3500        MOVE CR-LF-CANCEL-EXIT-DATE
  3501                                 TO WS-WORK-DATE
  3502     END-IF
  3503
  3504     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3505        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3506        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3507     END-IF
  3508
  3509     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3510     MOVE 'L'                    TO DC-OPTION-CODE
  3511     PERFORM 8510-DATE-CONVERSION
  3512                                 THRU 8590-EXIT
  3513     IF NO-CONVERSION-ERROR
  3514        MOVE DC-BIN-DATE-1       TO WS-BIN-LF-END-DATE
  3515     ELSE
  3516        DISPLAY ' NO LIFE COVERAGE ?? ' CR-ACCT-CONTROL
  3517           '   ' CR-CERT-NO
  3518     END-IF
  3519
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS056.cbl
  3520     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3521
  3522     MOVE LOW-VALUES             TO WS-BIN-AH-CAN-DATE
  3523     MOVE +0                     TO WS-AH-CAN-TERM
  3524     MOVE 'N'                    TO WS-AH-CAN-QUAL-SW
  3525
  3526     IF CR-AH-CANC-DT NOT = ZEROS
  3527        MOVE CR-AH-CANC-DT       TO DC-GREG-DATE-CYMD
  3528        MOVE 'L'                 TO DC-OPTION-CODE
  3529        PERFORM 8510-DATE-CONVERSION
  3530                                 THRU 8590-EXIT
  3531        IF NO-CONVERSION-ERROR
  3532           MOVE DC-BIN-DATE-1    TO WS-BIN-AH-CAN-DATE
  3533        ELSE
  3534           MOVE LOW-VALUES       TO WS-BIN-AH-CAN-DATE
  3535        END-IF
  3536        MOVE BIN-RUN-DATE        TO DC-BIN-DATE-2
  3537        MOVE '1'                 TO DC-OPTION-CODE
  3538        MOVE +0                  TO DC-ELAPSED-MONTHS
  3539                                    DC-ELAPSED-DAYS
  3540        PERFORM 8510-DATE-CONVERSION
  3541                                 THRU 8590-EXIT
  3542        IF NO-CONVERSION-ERROR
  3543           MOVE DC-ELAPSED-MONTHS
  3544                                 TO WS-AH-CAN-TERM
  3545           IF (WS-AH-CAN-TERM > +0)
  3546              AND (WS-BIN-AH-CAN-DATE > WS-BIN-1ST-DT)
  3547              SUBTRACT +1        FROM WS-AH-CAN-TERM
  3548           END-IF
  3549           IF (WS-AH-CAN-TERM > +0)
  3550              AND (WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE)
  3551              SET CREDIT-AH-CANCEL TO TRUE
  3552           END-IF
  3553        END-IF
  3554     END-IF
  3555
  3556*    IF (CR-AH-CANC-DT NOT = ZEROS) AND
  3557*       (CR-AH-CANC-DT < WS-WORK-DATE)
  3558*       MOVE CR-AH-CANC-DT           TO WS-WORK-DATE
  3559*    END-IF
  3560
  3561     IF (CR-AH-CANCEL-EXIT-DATE NOT = ZEROS)
  3562        AND (CR-AH-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3563        MOVE CR-AH-CANCEL-EXIT-DATE
  3564                                 TO WS-WORK-DATE
  3565     END-IF
  3566
  3567     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3568        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3569        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3570                                     TO WS-WORK-DATE
  3571     END-IF
  3572
  3573     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3574     MOVE 'L'                    TO DC-OPTION-CODE
  3575     PERFORM 8510-DATE-CONVERSION
  3576                                 THRU 8590-EXIT
  3577     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS056.cbl
  3578        MOVE DC-BIN-DATE-1       TO WS-BIN-AH-END-DATE
  3579     ELSE
  3580        DISPLAY ' NO AH COVERAGE ' CR-ACCT-CONTROL
  3581           '   ' CR-CERT-NO
  3582     END-IF
  3583
  3584     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3585     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3586     MOVE '3'                        TO CP-PROCESS-TYPE
  3587     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3588     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3589     MOVE SPACES                     TO CP-ACCT-FLD-5
  3590     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
  3591
  3592*    IF (WS-BIN-LF-END-DATE NOT > BIN-RUN-DATE)
  3593*       AND (NOT THIS-IS-A-GIANT-CERT)
  3594*       AND (NOT CREDIT-LF-CANCEL)
  3595*       MOVE ZEROS               TO CR-LFPRM
  3596*                                   CR-LFTYP
  3597*                                   CR-LF-TERM
  3598*                                   CR-LFPRM-RATE
  3599*    END-IF
  3600
  3601     IF (WS-BIN-LF-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3602        AND (NOT THIS-IS-A-GIANT-CERT)
  3603        MOVE ZEROS               TO CR-LFPRM
  3604                                    CR-LFTYP
  3605                                    CR-LF-TERM
  3606                                    CR-LFPRM-RATE
  3607     END-IF
  3608
  3609*    IF (WS-BIN-AH-END-DATE NOT > BIN-RUN-DATE)
  3610*       AND (NOT THIS-IS-A-GIANT-CERT)
  3611*       AND (NOT CREDIT-AH-CANCEL)
  3612*       MOVE ZEROS               TO CR-AHPRM
  3613*                                   CR-AHTYP
  3614*                                   CR-AH-TERM
  3615*                                   CR-AHPRM-RATE
  3616*    END-IF
  3617
  3618     IF (WS-BIN-AH-END-DATE NOT > WS-BIN-LAST-MONTH-DT)
  3619        AND (NOT THIS-IS-A-GIANT-CERT)
  3620        MOVE ZEROS               TO CR-AHPRM
  3621                                    CR-AHTYP
  3622                                    CR-AH-TERM
  3623                                    CR-AHPRM-RATE
  3624     END-IF
  3625
  3626     IF CR-LF-TERM > CR-AH-TERM
  3627        MOVE CR-LF-TERM          TO WS-WORK-TERM
  3628     ELSE
  3629        MOVE CR-AH-TERM          TO WS-WORK-TERM
  3630     END-IF
  3631
  3632     IF (CR-LFTYP = '00' OR '  ')
  3633        AND (CR-AHTYP = '00' OR '  ')
  3634        CONTINUE
  3635     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS056.cbl
  3636        PERFORM 0205-CALC-REM-TERMS
  3637                                 THRU 0205-EXIT
  3638        IF LF-REM-TERM > AH-REM-TERM
  3639           MOVE LF-REM-TERM      TO REM-TERM
  3640        ELSE
  3641           MOVE AH-REM-TERM      TO REM-TERM
  3642        END-IF
  3643
  3644        PERFORM 0210-CALC-UEP    THRU 0210-EXIT
  3645     END-IF
  3646
  3647
  3648     .
  3649
  3650 0200-EXIT.
  3651     EXIT.
  3652
  3653 0205-CALC-REM-TERMS.
  3654
  3655     MOVE +0                     TO LF-REM-TERM
  3656                                    AH-REM-TERM
  3657                                    REM-TERM
  3658
  3659     IF CR-LFTYP NOT = '  ' AND ZEROS
  3660        PERFORM 0207-FIND-LIFE-TYPE
  3661                                 THRU 0207-EXIT
  3662        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3663           CONTINUE
  3664        ELSE
  3665           PERFORM 0220-CALC-LF-REM-TERM
  3666                                 THRU 0220-EXIT
  3667        END-IF
  3668     END-IF
  3669
  3670     IF CR-AHTYP NOT = '  ' AND ZEROS
  3671        PERFORM 0208-FIND-AH-TYPE
  3672                                 THRU 0208-EXIT
  3673        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  3674           CONTINUE
  3675        ELSE
  3676           PERFORM 0225-CALC-AH-REM-TERM
  3677                                 THRU 0225-EXIT
  3678        END-IF
  3679     END-IF
  3680
  3681
  3682     .
  3683 0205-EXIT.
  3684    EXIT.
  3685
  3686 0207-FIND-LIFE-TYPE.
  3687
  3688     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3689        CONTINUE
  3690     ELSE
  3691        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3692         (CLAS-INDEXL = CLAS-MAXL) OR
  3693         (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS056.cbl
  3694        END-PERFORM
  3695        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3696           CONTINUE
  3697        ELSE
  3698           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3699           DISPLAY 'RETURN CODE - 0401'
  3700           MOVE 0401 TO WS-RETURN-CODE
  3701           PERFORM ABEND-PGM
  3702        END-IF
  3703     END-IF
  3704
  3705     .
  3706 0207-EXIT.
  3707     EXIT.
  3708
  3709 0208-FIND-AH-TYPE.
  3710
  3711     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3712        CONTINUE
  3713     ELSE
  3714        PERFORM VARYING CLAS-INDEXA FROM +1 BY +1 UNTIL
  3715            (CLAS-INDEXA = CLAS-MAXA) OR
  3716            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3717        END-PERFORM
  3718        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3719           CONTINUE
  3720        ELSE
  3721           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3722           DISPLAY 'RETURN CODE - 0401'
  3723           MOVE 0401 TO WS-RETURN-CODE
  3724           PERFORM ABEND-PGM
  3725        END-IF
  3726     END-IF
  3727
  3728     .
  3729 0208-EXIT.
  3730     EXIT.
  3731
  3732 0210-CALC-UEP.
  3733
  3734     MOVE ZEROS                  TO WS-REM-AMT
  3735     IF THIS-IS-A-GIANT-CERT
  3736        PERFORM 0215-CALC-RECEIVE
  3737                                 THRU 0215-EXIT
  3738     ELSE
  3739        MOVE +0            TO WS-BASE-COMM
  3740                              WS-GA-COMM
  3741        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3742           (X1 > +10)
  3743           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3744              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3745              + (CR-LFPRM * CR-LCOM-L (X1))
  3746              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3747              + (CR-AHPRM * CR-LCOM-AH (X1))
  3748           END-IF
  3749           IF CR-AGT-TYPE (X1) = 'O' OR 'P' or 'S'
  3750              COMPUTE WS-GA-COMM = WS-GA-COMM +
  3751                 (CR-LFPRM * CR-LCOM-L (X1)) +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS056.cbl
  3752                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3753                 (CR-AHPRM * CR-LCOM-AH (X1))
  3754           END-IF
  3755        END-PERFORM
  3756        IF (CR-LFTYP (1:1) = 'M')
  3757           OR (CR-AHTYP (1:1) = 'M')
  3758*          COMPUTE WS-EARN-TERM = CR-LF-TERM - LF-REM-TRM2
  3759           COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  3760           COMPUTE WS-EXP-PREM = (CR-LFPRM + CR-AHPRM)
  3761           IF (CREDIT-LF-CANCEL)
  3762              OR (CREDIT-AH-CANCEL)
  3763              PERFORM 0212-CALC-CANCEL-CREDIT
  3764                                 THRU 0212-EXIT
  3765           ELSE
  3766             IF RUN-DATE = CR-ENTRY-DATE
  3767              COMPUTE WS-EXP-PREM = WS-EXP-PREM
  3768                 * WS-EARN-TERM
  3769              COMPUTE WS-BASE-COMM = WS-BASE-COMM
  3770                 * WS-EARN-TERM
  3771              COMPUTE WS-GA-COMM   = WS-GA-COMM
  3772                 * WS-EARN-TERM
  3773             END-IF
  3774             COMPUTE WS-EXP-PREM =
  3775              (WS-EXP-PREM - WS-BASE-COMM)
  3776           END-IF
  3777        ELSE
  3778           IF (CR-LFTYP (1:1) = 'S')
  3779              OR (CR-AHTYP (1:1) = 'S')
  3780              PERFORM 0240-CALC-SRP
  3781                                 THRU 0240-EXIT
  3782           ELSE
  3783              PERFORM 0230-CALC-UEP
  3784                                 THRU 0230-EXIT
  3785           END-IF
  3786        END-IF
  3787     END-IF
  3788
  3789     .
  3790
  3791 0210-EXIT.
  3792     EXIT.
  3793
  3794 0212-CALC-CANCEL-CREDIT.
  3795
  3796     MOVE ZEROS                  TO WS-EXP-PREM
  3797                                    WS-LF-EXP-PREM
  3798                                    WS-AH-EXP-PREM
  3799                                    WS-LF-BASE-COMM
  3800                                    WS-AH-BASE-COMM
  3801                                    WS-LF-GA-COMM
  3802                                    WS-AH-GA-COMM
  3803
  3804
  3805     IF CREDIT-LF-CANCEL
  3806        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3807           (X1 > +10)
  3808           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3809              COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS056.cbl
  3810              + (CR-LFPRM * CR-LCOM-L (X1))
  3811              + (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3812           END-IF
  3813           IF CR-AGT-TYPE (X1) = 'O' OR 'P' or 'S'
  3814              COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM +
  3815                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3816                 (CR-LFPRM-ALT * CR-LCOM-L (X1))
  3817           END-IF
  3818        END-PERFORM
  3819        COMPUTE WS-LF-EXP-PREM = CR-LFPRM * WS-LF-CAN-TERM
  3820        COMPUTE WS-LF-BASE-COMM = WS-LF-BASE-COMM * WS-LF-CAN-TERM
  3821        COMPUTE WS-LF-GA-COMM = WS-LF-GA-COMM * WS-LF-CAN-TERM
  3822     END-IF
  3823
  3824     IF CREDIT-AH-CANCEL
  3825        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3826           (X1 > +10)
  3827           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3828              COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM
  3829              + (CR-AHPRM * CR-LCOM-AH (X1))
  3830           END-IF
  3831           IF CR-AGT-TYPE (X1) = 'O' OR 'P' or 'S'
  3832              COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM +
  3833                 (CR-AHPRM * CR-LCOM-AH (X1))
  3834           END-IF
  3835        END-PERFORM
  3836        COMPUTE WS-AH-EXP-PREM = CR-AHPRM * WS-AH-CAN-TERM
  3837        COMPUTE WS-AH-BASE-COMM = WS-AH-BASE-COMM * WS-AH-CAN-TERM
  3838        COMPUTE WS-AH-GA-COMM = WS-AH-GA-COMM * WS-AH-CAN-TERM
  3839     END-IF
  3840
  3841     COMPUTE WS-EXP-PREM = WS-LF-EXP-PREM + WS-AH-EXP-PREM
  3842     COMPUTE WS-BASE-COMM = WS-LF-BASE-COMM + WS-AH-BASE-COMM
  3843     COMPUTE WS-GA-COMM = WS-LF-GA-COMM + WS-AH-GA-COMM
  3844     COMPUTE WS-EXP-PREM = (WS-EXP-PREM - WS-BASE-COMM) * -1
  3845
  3846     .
  3847 0212-EXIT.
  3848     EXIT.
  3849
  3850
  3851 0215-CALC-RECEIVE.
  3852
  3853     MOVE +0                     TO WS-GA-COMM
  3854                                    WS-REC-BASE-COMM
  3855
  3856     IF WS-THIS-MONTH-DATE = CR-ENTRY-DATE
  3857        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3858           (X1 > +10)
  3859           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3860              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM +
  3861                 (CR-LFPRM * CR-LCOM-L (X1)) +
  3862                 (CR-LFPRM-ALT * CR-LCOM-L (X1)) +
  3863                 (CR-AHPRM * CR-LCOM-AH (X1))
  3864           END-IF
  3865        END-PERFORM
  3866        COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3867     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS056.cbl
  3868
  3869     IF WS-THIS-MONTH-DATE = CR-LF-CANCEL-EXIT-DATE
  3870        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3871           (X1 > +10)
  3872           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3873              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3874                 (CR-LFRFND * CR-LCOM-L (X1))
  3875           END-IF
  3876        END-PERFORM
  3877        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-LFRFND
  3878     END-IF
  3879
  3880     IF WS-THIS-MONTH-DATE = CR-AH-CANCEL-EXIT-DATE
  3881        PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  3882           (X1 > +10)
  3883           IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  3884              COMPUTE WS-REC-BASE-COMM = WS-REC-BASE-COMM -
  3885                 (CR-AHRFND * CR-LCOM-AH (X1))
  3886           END-IF
  3887        END-PERFORM
  3888        COMPUTE WS-REC-PREM = WS-REC-PREM - CR-AHRFND
  3889     END-IF
  3890
  3891     COMPUTE WS-REC-PREM = WS-REC-PREM - WS-REC-BASE-COMM
  3892*    COMPUTE WS-REC-PREM = (CR-LFPRM + CR-LFPRM-ALT + CR-AHPRM)
  3893*       - WS-REC-BASE-COMM
  3894
  3895     .
  3896
  3897 0215-EXIT.
  3898     EXIT.
  3899
  3900 0220-CALC-LF-REM-TERM.
  3901
  3902     MOVE ZEROS                  TO LF-REM-TERM
  3903     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  3904     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  3905
  3906     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3907        MOVE ZEROS               TO WS-LF-EARN-TERM
  3908     ELSE
  3909        MOVE '1'                 TO DC-OPTION-CODE
  3910        PERFORM 8510-DATE-CONVERSION
  3911                                 THRU 8590-EXIT
  3912        IF NO-CONVERSION-ERROR
  3913           MOVE DC-ELAPSED-MONTHS
  3914                                 TO WS-LF-EARN-TERM
  3915           IF DC-ODD-DAYS-OVER > +0
  3916              ADD +1             TO WS-LF-EARN-TERM
  3917           END-IF
  3918        ELSE
  3919           DISPLAY ' PROBLEM WITH LIFE EARN TERM '
  3920              CR-ACCT-CONTROL '   ' CR-CERT-NO
  3921        END-IF
  3922     END-IF
  3923
  3924     IF CR-LF-TERM NOT = ZEROS
  3925        COMPUTE LF-REM-TERM = CR-LF-TERM - WS-LF-EARN-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS056.cbl
  3926     END-IF
  3927
  3928*    IF WS-BIN-LF-END-DATE = LOW-VALUES
  3929*       MOVE ZEROS               TO LF-REM-TERM
  3930*    ELSE
  3931*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  3932*       MOVE WS-BIN-LF-END-DATE  TO DC-BIN-DATE-2
  3933*       MOVE '1'                 TO DC-OPTION-CODE
  3934*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  3935*          MOVE +1               TO LF-REM-TERM
  3936*       ELSE
  3937*          PERFORM 8510-DATE-CONVERSION
  3938*                                THRU 8590-EXIT
  3939*          IF NO-CONVERSION-ERROR
  3940*             MOVE DC-ELAPSED-MONTHS
  3941*                                TO LF-REM-TERM
  3942*             IF DC-ODD-DAYS-OVER > +0
  3943*                ADD +1          TO LF-REM-TERM
  3944*             END-IF
  3945*          ELSE
  3946*             DISPLAY ' ERROR WITH LIFE REM TERM '
  3947*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  3948*             MOVE ZEROS         TO LF-REM-TERM
  3949*          END-IF
  3950*       END-IF
  3951*    END-IF
  3952
  3953*    IF LF-REM-TERM > CR-LF-TERM
  3954*       MOVE CR-LF-TERM          TO LF-REM-TERM
  3955*       DISPLAY ' LF REM TERM > LF TERM ' CR-ACCT-CONTROL
  3956*          '   ' CR-CERT-NO
  3957*    END-IF
  3958
  3959*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  3960
  3961*    MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3962*                                TO CP-BENEFIT-TYPE
  3963*    MOVE CLAS-I-BAL (CLAS-INDEXL)
  3964*                                TO CP-SPECIAL-CALC-CD
  3965*    MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3966*                                   CP-LOAN-TERM
  3967
  3968*    IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3969*       CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3970*       ADD +1                   TO CP-ORIGINAL-TERM
  3971*                                   CP-LOAN-TERM
  3972*    END-IF
  3973
  3974*    IF CP-TERM-IS-DAYS
  3975*       MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3976*    ELSE
  3977*       MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3978*    END-IF
  3979
  3980*    MOVE DTE-REM-TRM-CALC-OPTION
  3981*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  3982
  3983*    PERFORM 0510-GET-REMAINING-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS056.cbl
  3984*                                THRU 0510-EXIT
  3985
  3986*    IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3987*         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3988*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3989*       COMPUTE CP-REMAINING-TERM-1 =
  3990*                      CP-REMAINING-TERM-1 - 1
  3991*       COMPUTE CP-REMAINING-TERM-2 =
  3992*                      CP-REMAINING-TERM-2 - 1
  3993*    END-IF
  3994
  3995*    IF CP-REMAINING-TERM-1 NEGATIVE
  3996*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  3997*    END-IF
  3998
  3999*    IF CP-REMAINING-TERM-2 NEGATIVE
  4000*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  4001*    END-IF
  4002
  4003*    MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  4004*    MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  4005*    DISPLAY ' LF CERT ' CR-CERT-NO ' TERM ' CR-LF-TERM
  4006*       ' REM2 ' LF-REM-TRM2
  4007
  4008     .
  4009
  4010 0220-EXIT.
  4011     EXIT.
  4012
  4013 0225-CALC-AH-REM-TERM.
  4014
  4015     MOVE +0                     TO AH-REM-TERM
  4016     MOVE WS-BIN-1ST-DT          TO DC-BIN-DATE-1
  4017     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-2
  4018
  4019     IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4020        MOVE ZEROS               TO WS-AH-EARN-TERM
  4021     ELSE
  4022        MOVE '1'                 TO DC-OPTION-CODE
  4023        PERFORM 8510-DATE-CONVERSION
  4024                                 THRU 8590-EXIT
  4025        IF NO-CONVERSION-ERROR
  4026           MOVE DC-ELAPSED-MONTHS
  4027                                 TO WS-AH-EARN-TERM
  4028           IF DC-ODD-DAYS-OVER > +0
  4029              ADD +1             TO WS-AH-EARN-TERM
  4030           END-IF
  4031        ELSE
  4032           DISPLAY ' PROBLEM WITH  AH  EARN TERM '
  4033              CR-ACCT-CONTROL '   ' CR-CERT-NO
  4034        END-IF
  4035     END-IF
  4036
  4037     IF CR-AH-TERM NOT = ZEROS
  4038        COMPUTE AH-REM-TERM = CR-AH-TERM - WS-AH-EARN-TERM
  4039     END-IF
  4040
  4041*    IF WS-BIN-AH-END-DATE = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS056.cbl
  4042*       MOVE ZEROS               TO AH-REM-TERM
  4043*    ELSE
  4044*       MOVE BIN-RUN-DATE        TO DC-BIN-DATE-1
  4045*       MOVE WS-BIN-AH-END-DATE  TO DC-BIN-DATE-2
  4046*       IF DC-BIN-DATE-2 NOT > DC-BIN-DATE-1
  4047*          MOVE +1               TO AH-REM-TERM
  4048*       ELSE
  4049*          MOVE '1'              TO DC-OPTION-CODE
  4050*          PERFORM 8510-DATE-CONVERSION
  4051*                                THRU 8590-EXIT
  4052*          IF NO-CONVERSION-ERROR
  4053*             MOVE DC-ELAPSED-MONTHS
  4054*                                TO AH-REM-TERM
  4055*             IF DC-ODD-DAYS-OVER > +0
  4056*                ADD +1          TO AH-REM-TERM
  4057*             END-IF
  4058*          ELSE
  4059*             DISPLAY ' ERROR WITH  AH  REM TERM '
  4060*               CR-ACCT-CONTROL '  ' CR-CERT-NO
  4061*             MOVE ZEROS         TO AH-REM-TERM
  4062*          END-IF
  4063*       END-IF
  4064*    END-IF
  4065
  4066*    IF AH-REM-TERM > CR-AH-TERM
  4067*       MOVE CR-AH-TERM          TO AH-REM-TERM
  4068*       DISPLAY ' AH REM TERM > AH TERM ' CR-ACCT-CONTROL
  4069*          '   ' CR-CERT-NO
  4070*    END-IF
  4071
  4072*    MOVE BIN-RUN-DATE           TO CP-VALUATION-DT
  4073
  4074*    MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  4075*                                TO CP-BENEFIT-TYPE
  4076*    MOVE CLAS-I-BAL (CLAS-INDEXA)
  4077*                                TO CP-SPECIAL-CALC-CD
  4078*    MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  4079*                                   CP-LOAN-TERM
  4080
  4081*    MOVE DTE-REM-TRM-CALC-OPTION
  4082*    MOVE '3'                    TO CP-REM-TRM-CALC-OPTION
  4083
  4084*    PERFORM 0510-GET-REMAINING-TERM
  4085*                                THRU 0510-EXIT
  4086
  4087*    IF CP-REMAINING-TERM-1 NEGATIVE
  4088*        MOVE ZEROS              TO CP-REMAINING-TERM-1
  4089*    END-IF
  4090
  4091*    IF CP-REMAINING-TERM-2 NEGATIVE
  4092*        MOVE ZEROS              TO CP-REMAINING-TERM-2
  4093*    END-IF
  4094
  4095*    MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  4096*    MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  4097*    DISPLAY ' AH CERT ' CR-CERT-NO ' TERM ' CR-AH-TERM
  4098*       ' REM2 ' AH-REM-TRM2
  4099*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS056.cbl
  4100     .
  4101
  4102 0225-EXIT.
  4103     EXIT.
  4104
  4105 0230-CALC-UEP.
  4106
  4107*     DISPLAY ' MADE IT TO 0230 ' CR-CERT-NO
  4108
  4109     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  4110
  4111     MOVE WS-EARN-TERM           TO WS-DISPLAY-FLD
  4112     IF CR-CERT-NO = '0004052380 '
  4113        DISPLAY ' EARN TRM ' WS-DISPLAY-FLD
  4114     END-IF
  4115     IF CR-LOAN-TERM NOT NUMERIC
  4116        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4117     END-IF
  4118     IF CR-LOAN-TERM = ZEROS
  4119        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4120     END-IF
  4121     IF CR-LOAN-TERM = ZEROS
  4122        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4123     END-IF
  4124*    COMPUTE WS-I = CR-APR / +1200
  4125
  4126*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4127*    DISPLAY ' WS I ' WS-DISPLAY-FLD
  4128*
  4129*    COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4130*       + (CR-AHPRM-RATE / +1000))
  4131
  4132*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4133*    DISPLAY ' WS J ' WS-DISPLAY-FLD
  4134
  4135*    COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4136
  4137*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4138*    DISPLAY ' WS VM ' WS-DISPLAY-FLD
  4139*
  4140*    COMPUTE WS-ANGLEMJ = (1 - ((1 + WS-J)
  4141*       ** (WS-WORK-TERM * -1))) / WS-J
  4142
  4143*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4144*    DISPLAY ' WS ANGLEMJ ' WS-DISPLAY-FLD
  4145*    COMPUTE WS-ANGLEN = (1 - ((1 + WS-I)
  4146*       ** (CR-LOAN-TERM * -1))) / WS-I
  4147
  4148*    MOVE WS-ANGLEN              TO WS-DISPLAY-FLD
  4149*    DISPLAY ' WS ANGLEN  ' WS-DISPLAY-FLD
  4150*    COMPUTE WS-ANGLEM = (1 - ((1 + WS-I)
  4151*       ** (WS-WORK-TERM * -1))) / WS-I
  4152
  4153*    MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4154*    DISPLAY ' WS ANGLEM  ' WS-DISPLAY-FLD
  4155*    COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4156*       ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4157
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS056.cbl
  4158*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4159*    DISPLAY ' WS ANGLEN - M ' WS-DISPLAY-FLD
  4160
  4161*    IF CR-LFAMT = ZEROS
  4162*       COMPUTE CR-LFAMT = CR-AHAMT * WS-WORK-TERM
  4163*    END-IF
  4164
  4165*    COMPUTE WS-P = CR-LFAMT / WS-ANGLEN
  4166*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4167*    DISPLAY ' WS P       ' WS-DISPLAY-FLD
  4168*    COMPUTE WS-B = WS-P * WS-ANGLEN-M
  4169*    MOVE WS-B                   TO WS-DISPLAY-FLD
  4170*    DISPLAY ' WS B       ' WS-DISPLAY-FLD
  4171*    COMPUTE WS-R = (CR-LFAMT - (WS-B * WS-VM))
  4172*       / WS-ANGLEMJ
  4173*    MOVE WS-R                   TO WS-DISPLAY-FLD
  4174*    DISPLAY ' WS R       ' WS-DISPLAY-FLD
  4175
  4176*    MOVE CR-LFAMT               TO WS-AMT
  4177
  4178*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4179*    DISPLAY ' LF RATE ' WS-DISPLAY-FLD
  4180*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4181*    DISPLAY ' AH RATE ' WS-DISPLAY-FLD
  4182
  4183*    MOVE +0                     TO WS-LF-PRM
  4184*                                   WS-AH-PRM
  4185*    PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4186*       (WS-A > WS-EARN-TERM)
  4187*       IF WS-A = +1
  4188*          COMPUTE WS-I1 ROUNDED = (WS-AMT * (WS-I / +30
  4189*             * (CR-PMT-EXTENSION-DAYS + +30)) * +100) / +100
  4190*       ELSE
  4191*          COMPUTE WS-I1 ROUNDED = (WS-AMT * WS-I * +100)
  4192*             / +100
  4193*       END-IF
  4194*       MOVE WS-I1               TO WS-DISPLAY-FLD
  4195*       DISPLAY ' ' WS-A '  WS-I1  ' WS-DISPLAY-FLD
  4196*       DISPLAY ' RUN DATE ' RUN-DATE
  4197*       DISPLAY ' ENTRY DATE ' CR-ENTRY-DATE
  4198*       IF RUN-DATE = CR-ENTRY-DATE
  4199*          COMPUTE WS-LF-PRM = WS-LF-PRM
  4200*             + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4201*          COMPUTE WS-AH-PRM = WS-AH-PRM
  4202*             + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4203*          COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4204*          COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4205*       ELSE
  4206*          COMPUTE WS-LF-PRM = WS-AMT / +1000 * CR-LFPRM-RATE
  4207*          COMPUTE WS-AH-PRM = WS-AMT / +1000 * CR-AHPRM-RATE
  4208*       END-IF
  4209*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4210*       DISPLAY ' WS-AMT B4    ' WS-AMT
  4211*       COMPUTE WS-AMT ROUNDED = (.05 + (WS-AMT - (WS-R
  4212*          - WS-I1 - (WS-LF-PRM + WS-AH-PRM))) * +100)
  4213*          / +100
  4214*       MOVE WS-AMT              TO WS-DISPLAY-FLD
  4215*       DISPLAY ' WS-AMT AFTER ' WS-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS056.cbl
  4216*       IF WS-AMT < +0
  4217*          COMPUTE WS-P = WS-P + WS-AMT
  4218*          MOVE ZEROS            TO WS-AMT
  4219*       END-IF
  4220*       IF WS-A = CR-LOAN-TERM
  4221*          IF WS-AMT > ZEROS
  4222*             IF WS-R > WS-AMT
  4223*                COMPUTE WS-R = WS-R - WS-AMT
  4224*                MOVE ZEROS      TO WS-AMT
  4225*             ELSE
  4226*                MOVE CR-LFAMT-ALT TO WS-R
  4227*                MOVE ZEROS      TO WS-AMT
  4228*             END-IF
  4229*          END-IF
  4230*       END-IF
  4231*    END-PERFORM
  4232
  4233*    COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4234
  4235*    DISPLAY ' WS-LF-PRM        = ' WS-LF-PRM
  4236*    DISPLAY ' WS-AH-PRM        = ' WS-AH-PRM
  4237*    DISPLAY ' WS-BASE-COMM     = ' WS-BASE-COMM
  4238*    DISPLAY ' WS-REC-BASE-COMM = ' WS-REC-BASE-COMM
  4239*       - WS-BASE-COMM
  4240
  4241
  4242*    MOVE CR-LFPRM-RATE          TO WS-DISPLAY-FLD
  4243*    DISPLAY ' LFRATE   ' WS-DISPLAY-FLD
  4244*    MOVE CR-AHPRM-RATE          TO WS-DISPLAY-FLD
  4245*    DISPLAY ' AHRATE   ' WS-DISPLAY-FLD
  4246*    MOVE CR-APR                 TO WS-DISPLAY-FLD
  4247*    DISPLAY ' APR      ' WS-DISPLAY-FLD
  4248     COMPUTE WS-I = CR-APR / +1200
  4249*    MOVE WS-I                   TO WS-DISPLAY-FLD
  4250*    DISPLAY ' WS I     ' WS-DISPLAY-FLD
  4251
  4252     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4253        + (CR-AHPRM-RATE / +1000))
  4254*    MOVE WS-J                   TO WS-DISPLAY-FLD
  4255*    DISPLAY ' WS J     ' WS-DISPLAY-FLD
  4256     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4257
  4258*    I = APR/1200
  4259*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4260*    RA = PAYMENT AMOUNT
  4261*    WK5-CSL = THE BALANCE (PAY OFF )
  4262*    WK3 = THE ACCUMULATED PREMIUM
  4263*    WK2 = (1 + I) ^ (m * -1)
  4264*
  4265*
  4266     COMPUTE WS-OD = (1 + (WS-DAYS-TO-1ST * WS-I / 30))
  4267        / (1 + WS-I)
  4268
  4269*    MOVE WS-DAYS-TO-1ST         TO WS-DISPLAY-FLD
  4270*    DISPLAY ' DYS 2 1ST' WS-DISPLAY-FLD
  4271*    MOVE WS-OD                  TO WS-DISPLAY-FLD
  4272*    DISPLAY ' WS OD    ' WS-DISPLAY-FLD
  4273     COMPUTE WS-ANGLEN-M = ((1 - ((1 + WS-I)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS056.cbl
  4274        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I)
  4275        / WS-OD
  4276     COMPUTE WS-VM = (1 + WS-J) ** (WS-WORK-TERM * -1)
  4277*    MOVE WS-VM                  TO WS-DISPLAY-FLD
  4278*    DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4279     COMPUTE WS-ANGLEN-M = WS-ANGLEN-M * WS-VM
  4280*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4281*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4282     COMPUTE WS-ANGLEMJ = ((1 - ((1 + WS-J)
  4283        ** (WS-WORK-TERM * -1))) / WS-J) / WS-OD
  4284*    MOVE WS-ANGLEMJ             TO WS-DISPLAY-FLD
  4285*    DISPLAY ' WS AMJ   ' WS-DISPLAY-FLD
  4286     COMPUTE WS-ANGLEM = ((1 - ((1 + WS-I)
  4287        ** (WS-WORK-TERM * -1))) / WS-I) / WS-OD
  4288     MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4289*     DISPLAY ' WS Anglem 230 ' WS-DISPLAY-FLD
  4290     COMPUTE WS-ANGLEM-1 = (1 - ((1 + WS-J)
  4291        ** ((WS-WORK-TERM - 1) * -1))) / WS-J
  4292
  4293
  4294     IF CR-LFAMT = ZEROS
  4295        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4296     END-IF
  4297
  4298     IF CR-LFAMT-ALT > +0
  4299        COMPUTE WS-P = (CR-LFAMT * WS-OD - (CR-LFAMT-ALT *
  4300           (1 + WS-K) ** (WS-WORK-TERM * -1))) / WS-ANGLEM-1
  4301     ELSE
  4302        COMPUTE WS-P = CR-LFAMT / (WS-ANGLEMJ + WS-ANGLEN-M)
  4303     END-IF
  4304*    MOVE WS-P                   TO WS-DISPLAY-FLD
  4305*    DISPLAY ' WS P     ' WS-DISPLAY-FLD
  4306     COMPUTE WS-ANGLEN-M = (1 - ((1 + WS-I)
  4307        ** ((CR-LOAN-TERM - WS-WORK-TERM) * -1))) / WS-I
  4308*    MOVE WS-ANGLEN-M            TO WS-DISPLAY-FLD
  4309*    DISPLAY ' WS AN-M  ' WS-DISPLAY-FLD
  4310     MOVE +0                     TO WS-LF-PRM
  4311                                    WS-AH-PRM
  4312                                    WS-LF-REF
  4313                                    WS-AH-REF
  4314                                    WS-LF-MIN-TERM
  4315                                    WS-LF-MAX-TERM
  4316                                    WS-AH-MIN-TERM
  4317                                    WS-AH-MAX-TERM
  4318     IF WS-LF-CAN-TERM > +0
  4319        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4320        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4321           - +1
  4322     END-IF
  4323
  4324     IF WS-AH-CAN-TERM > +0
  4325        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4326        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4327           - +1
  4328     END-IF
  4329
  4330     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4331        (WS-A > WS-EARN-TERM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS056.cbl
  4332        IF CR-LFAMT-ALT > +0
  4333           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
  4334             ** ((WS-WORK-TERM - WS-A) * -1))) / WS-J
  4335           COMPUTE WS-AMT = (WS-P * WS-ANGLEM) +
  4336             (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4337             ** (WS-WORK-TERM - WS-A + 1)))
  4338        ELSE
  4339
  4340           COMPUTE WS-ANGLEM = (1 - ((1 + WS-J)
  4341             ** ((WS-WORK-TERM - WS-A + 1) * -1))) / WS-J
  4342           COMPUTE WS-VM = (1 / (1 + WS-J))
  4343             ** (WS-WORK-TERM - WS-A + 1)
  4344           COMPUTE WS-AMT = WS-P *
  4345             (WS-ANGLEM + (WS-ANGLEN-M * WS-VM))
  4346        END-IF
  4347        MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4348*        DISPLAY ' WS Anglem 230b ' WS-DISPLAY-FLD
  4349
  4350*       IF WS-A = +1
  4351*          MOVE WS-VM               TO WS-DISPLAY-FLD
  4352*          DISPLAY ' WS VM    ' WS-DISPLAY-FLD
  4353*          MOVE WS-ANGLEM           TO WS-DISPLAY-FLD
  4354*          DISPLAY ' WS AM    ' WS-DISPLAY-FLD
  4355*          MOVE WS-AMT TO WS-DISPLAY-FLD
  4356*          DISPLAY ' AMT FIRST ' WS-DISPLAY-FLD
  4357*       END-IF
  4358        IF RUN-DATE = CR-ENTRY-DATE
  4359           COMPUTE WS-LF-PRM = WS-LF-PRM
  4360              + (WS-AMT / +1000 * CR-LFPRM-RATE)
  4361           IF CR-LFAMT-ALT > +0
  4362              COMPUTE WS-AH-PRM = WS-AH-PRM +
  4363                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4364                ** (WS-WORK-TERM - WS-A + 1)))) *
  4365                (CR-AHPRM-RATE / 1000)
  4366           ELSE
  4367              COMPUTE WS-AH-PRM = WS-AH-PRM
  4368                + (WS-AMT / +1000 * CR-AHPRM-RATE)
  4369           END-IF
  4370*          MOVE WS-LF-PRM           TO WS-DISPLAY-FLD
  4371*          DISPLAY ' WS LFPRM ' WS-DISPLAY-FLD
  4372           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4373           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4374        ELSE
  4375           COMPUTE WS-LF-PRM = WS-AMT * CR-LFPRM-RATE / +1000
  4376           IF CR-LFAMT-ALT > +0
  4377              COMPUTE WS-AH-PRM =
  4378                (WS-AMT - (CR-LFAMT-ALT * (1 / (1 + WS-K)
  4379                ** (WS-WORK-TERM - WS-A + 1)))) *
  4380                (CR-AHPRM-RATE / 1000)
  4381           ELSE
  4382              COMPUTE WS-AH-PRM = WS-AMT * CR-AHPRM-RATE / +1000
  4383           END-IF
  4384        END-IF
  4385        IF (CREDIT-LF-CANCEL)
  4386           AND (WS-LF-CAN-TERM > +0)
  4387           AND (WS-A NOT < WS-LF-MIN-TERM)
  4388           AND (WS-A NOT > WS-LF-MAX-TERM)
  4389           MOVE WS-A             TO WS-DISPLAY-FLD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS056.cbl
  4390           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4391              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4392           MOVE WS-LF-PRM        TO WS-DISPLAY-FLD
  4393           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4394           COMPUTE WS-LF-REF = WS-LF-REF + WS-LF-PRM
  4395        END-IF
  4396        IF (CREDIT-AH-CANCEL)
  4397           AND (WS-AH-CAN-TERM > +0)
  4398           AND (WS-A NOT < WS-AH-MIN-TERM)
  4399           AND (WS-A NOT > WS-AH-MAX-TERM)
  4400           MOVE WS-A             TO WS-DISPLAY-FLD
  4401           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4402              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4403           MOVE WS-AH-PRM        TO WS-DISPLAY-FLD
  4404           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4405           COMPUTE WS-AH-REF = WS-AH-REF + WS-AH-PRM
  4406        END-IF
  4407     END-PERFORM
  4408
  4409     IF (WS-LF-REF > +0)
  4410        OR (WS-AH-REF > +0)
  4411        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4412     ELSE
  4413        COMPUTE WS-EXP-PREM = (WS-LF-PRM + WS-AH-PRM)
  4414     END-IF
  4415
  4416     MOVE +0                     TO WS-BASE-COMM
  4417                                    WS-GA-COMM
  4418     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4419        (X1 > +10)
  4420        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4421           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4422*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4423*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4424           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4425              * CR-LCOM-L (X1))
  4426           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4427              * CR-LCOM-AH (X1))
  4428
  4429
  4430
  4431
  4432        END-IF
  4433        IF CR-AGT-TYPE (X1) = 'O' OR 'P' or 'S'
  4434           COMPUTE WS-GA-COMM = WS-GA-COMM
  4435*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4436*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4437           + (WS-LF-PRM / (1 - CR-LCOM-L (X1))
  4438              * CR-LCOM-L (X1))
  4439           + (WS-AH-PRM / (1 - CR-LCOM-AH (X1))
  4440              * CR-LCOM-AH (X1))
  4441        END-IF
  4442     END-PERFORM
  4443     .
  4444
  4445 0230-EXIT.
  4446     EXIT.
  4447
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS056.cbl
  4448 0240-CALC-SRP.
  4449
  4450     DISPLAY ' MADE IT TO 0240 ' CR-CERT-NO
  4451
  4452     COMPUTE WS-EARN-TERM = WS-WORK-TERM - REM-TERM
  4453
  4454     IF CR-LOAN-TERM NOT NUMERIC
  4455        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4456     END-IF
  4457     IF CR-LOAN-TERM = ZEROS
  4458        MOVE CR-LF-TERM          TO CR-LOAN-TERM
  4459     END-IF
  4460     IF CR-LOAN-TERM = ZEROS
  4461        MOVE CR-AH-TERM          TO CR-LOAN-TERM
  4462     END-IF
  4463
  4464     COMPUTE WS-I = CR-APR / +1200
  4465
  4466     COMPUTE WS-J = WS-I + ((CR-LFPRM-RATE / +1000)
  4467        + (CR-AHPRM-RATE / +1000))
  4468
  4469     COMPUTE WS-K = WS-I + (CR-LFPRM-RATE / +1000)
  4470
  4471     COMPUTE WS-Y = (1 + (WS-DAYS-TO-1ST * WS-K / 30))
  4472        / (1 + WS-K)
  4473
  4474     COMPUTE WS-ANGLEMK = ((1 - ((1 + WS-K)
  4475        ** (WS-WORK-TERM * -1))) / WS-K)
  4476
  4477     IF CR-LFAMT = ZEROS
  4478*        COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEM
  4479         COMPUTE CR-LFAMT = CR-AHAMT * WS-ANGLEMK
  4480     END-IF
  4481     MOVE CR-LFAMT               TO WS-AMT
  4482
  4483     MOVE WS-ANGLEM              TO WS-DISPLAY-FLD
  4484*     DISPLAY ' WS Anglem 240 ' WS-DISPLAY-FLD
  4485     MOVE WS-ANGLEMk             TO WS-DISPLAY-FLD
  4486*     DISPLAY ' WS Anglemk 240 ' WS-DISPLAY-FLD
  4487
  4488     COMPUTE WS-P = WS-AMT / ((WS-ANGLEMK / WS-Y)
  4489        - ((((WS-WORK-TERM - WS-ANGLEMK) / WS-K)
  4490        * CR-AHPRM-RATE / 1000)
  4491        + WS-ANGLEMK / WS-Y * (WS-DAYS-TO-1ST - 30) / 30
  4492        * CR-AHPRM-RATE / 1000))
  4493
  4494     MOVE +0                     TO WS-LF-PRM
  4495                                    WS-AH-PRM
  4496                                    WS-LF-REF
  4497                                    WS-AH-REF
  4498                                    WS-LF-MIN-TERM
  4499                                    WS-LF-MAX-TERM
  4500                                    WS-AH-MIN-TERM
  4501                                    WS-AH-MAX-TERM
  4502                                    WS-LINS WS-DINS
  4503                                    WS-FLINS WS-FDINS
  4504                                    WS-INT   WS-FINT
  4505     IF WS-LF-CAN-TERM > +0
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS056.cbl
  4506        COMPUTE WS-LF-MIN-TERM = WS-EARN-TERM - WS-LF-CAN-TERM
  4507        COMPUTE WS-LF-MAX-TERM = WS-LF-MIN-TERM + WS-LF-CAN-TERM
  4508           - +1
  4509     END-IF
  4510
  4511     IF WS-AH-CAN-TERM > +0
  4512        COMPUTE WS-AH-MIN-TERM = WS-EARN-TERM - WS-AH-CAN-TERM
  4513        COMPUTE WS-AH-MAX-TERM = WS-AH-MIN-TERM + WS-AH-CAN-TERM
  4514           - +1
  4515     END-IF
  4516
  4517***  THE BELOW 3 FIELDS ARE FOR CALCULATING THE FEES AND INT
  4518***  FOR THE TIME BETWEEN THE EFF DATE AND 1ST PMT DATE ONLY
  4519
  4520     COMPUTE WS-FINT = WS-AMT * (1 + WS-I *
  4521        (WS-DAYS-TO-1ST - 30) / 30) - WS-AMT
  4522
  4523     COMPUTE WS-FLINS = WS-AMT * CR-LFPRM-RATE / 1000
  4524        * (WS-DAYS-TO-1ST - 30) / 30
  4525
  4526     COMPUTE WS-FDINS = WS-P * WS-WORK-TERM * CR-AHPRM-RATE
  4527        / 1000 * (WS-DAYS-TO-1ST - 30) / 30
  4528
  4529     IF CR-ACCOUNT = '0005500363'
  4530*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4531     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4532     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4533     MOVE CR-CERT-NO             TO DB-CERT-NO
  4534
  4535     MOVE CR-DT                  TO WS-ISSUE-DATE
  4536     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4537     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4538                                    DB-EFF-DATE (6:1)
  4539     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4540     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4541     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4542     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4543     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4544                                    DB-ENT-DATE (6:1)
  4545     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4546     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4547     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4548     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4549     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4550                                    DB-VAL-DATE (6:1)
  4551     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4552     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4553     MOVE ZEROS                  TO DB-PERIOD
  4554     MOVE WS-P                   TO DB-PAYMENT
  4555     MOVE ZEROS                  TO DB-PRINC
  4556     MOVE WS-FINT                TO DB-INTEREST
  4557     MOVE WS-FLINS               TO DB-LINS
  4558     MOVE WS-FDINS               TO DB-DINS
  4559     MOVE WS-AMT                 TO DB-BALANCE
  4560     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4561     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4562     MOVE CR-LF-TERM             TO DB-LF-TERM
  4563     MOVE CR-AH-TERM             TO DB-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS056.cbl
  4564     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4565     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4566     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4567                                    DB-LF-EXP-DATE (6:1)
  4568     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4569     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4570
  4571     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4572     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4573     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4574                                    DB-AH-EXP-DATE (6:1)
  4575     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4576     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4577     WRITE DEBUG-EXTRACT-RECORD
  4578     END-IF
  4579
  4580     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  4581        (WS-A > WS-EARN-TERM)
  4582
  4583        IF RUN-DATE = CR-ENTRY-DATE
  4584           COMPUTE WS-LINS = WS-LINS + WS-FLINS
  4585              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4586           COMPUTE WS-DINS = WS-DINS + WS-FDINS
  4587              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4588              * CR-AHPRM-RATE / 1000
  4589           COMPUTE WS-BASE-COMM = WS-BASE-COMM * WS-A
  4590           COMPUTE WS-GA-COMM   = WS-GA-COMM   * WS-A
  4591        ELSE
  4592           COMPUTE WS-LINS = WS-FLINS
  4593              + (WS-AMT / 1000 * CR-LFPRM-RATE)
  4594           COMPUTE WS-DINS = WS-FDINS
  4595              + (WS-WORK-TERM - WS-A + 1) * WS-P
  4596              * CR-AHPRM-RATE / 1000
  4597        END-IF
  4598
  4599        COMPUTE WS-INT = WS-AMT * WS-I
  4600        COMPUTE WS-INT = WS-INT + WS-FINT
  4601
  4602        IF WS-A = +1
  4603           COMPUTE WS-AMT = WS-AMT - WS-P + WS-LINS
  4604              + WS-DINS + WS-INT
  4605        ELSE
  4606           COMPUTE WS-AMT = WS-AMT -
  4607             (WS-P - WS-INT - WS-LINS - WS-DINS)
  4608        END-IF
  4609
  4610
  4611        IF (CREDIT-LF-CANCEL)
  4612           AND (WS-LF-CAN-TERM > +0)
  4613           AND (WS-A NOT < WS-LF-MIN-TERM)
  4614           AND (WS-A NOT > WS-LF-MAX-TERM)
  4615           MOVE WS-A             TO WS-DISPLAY-FLD
  4616           DISPLAY ' FOUND LF ADJUST ' CR-ACCT-CONTROL
  4617              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4618           MOVE WS-LINS          TO WS-DISPLAY-FLD
  4619           DISPLAY '  LF REFUND ' WS-DISPLAY-FLD
  4620           COMPUTE WS-LF-REF = WS-LF-REF + WS-LINS
  4621        END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS056.cbl
  4622        IF (CREDIT-AH-CANCEL)
  4623           AND (WS-AH-CAN-TERM > +0)
  4624           AND (WS-A NOT < WS-AH-MIN-TERM)
  4625           AND (WS-A NOT > WS-AH-MAX-TERM)
  4626           MOVE WS-A             TO WS-DISPLAY-FLD
  4627           DISPLAY ' FOUND AH ADJUST ' CR-ACCT-CONTROL
  4628              '   ' CR-CERT-NO '  ' WS-DISPLAY-FLD
  4629           MOVE WS-DINS          TO WS-DISPLAY-FLD
  4630           DISPLAY '  AH REFUND ' WS-DISPLAY-FLD
  4631           COMPUTE WS-AH-REF = WS-AH-REF + WS-DINS
  4632        END-IF
  4633
  4634
  4635
  4636        MOVE +0                  TO WS-FLINS
  4637                                    WS-FDINS
  4638                                    WS-FINT
  4639
  4640
  4641     IF CR-ACCOUNT = '0005500363'
  4642*    IF CR-CERT-NO = '0126880300 ' OR '0018664366 '
  4643     MOVE WS-INIT-DB-EXTRACT     TO DEBUG-EXTRACT-RECORD
  4644     MOVE CR-ACCOUNT             TO DB-ACCOUNT
  4645     MOVE CR-CERT-NO             TO DB-CERT-NO
  4646
  4647     MOVE CR-DT                  TO WS-ISSUE-DATE
  4648     MOVE WS-ISSUE-MMDD (1:2)    TO DB-EFF-DATE (1:2)
  4649     MOVE '-'                    TO DB-EFF-DATE (3:1)
  4650                                    DB-EFF-DATE (6:1)
  4651     MOVE WS-ISSUE-MMDD (3:2)    TO DB-EFF-DATE (4:2)
  4652     MOVE WS-ISSUE-CCYY          TO DB-EFF-DATE (7:4)
  4653     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  4654     MOVE WS-ENTRY-MMDD (1:2)    TO DB-ENT-DATE (1:2)
  4655     MOVE '-'                    TO DB-ENT-DATE (3:1)
  4656                                    DB-ENT-DATE (6:1)
  4657     MOVE WS-ENTRY-MMDD (3:2)    TO DB-ENT-DATE (4:2)
  4658     MOVE WS-ENTRY-CCYY          TO DB-ENT-DATE (7:4)
  4659     MOVE RUN-DATE               TO WS-ENTRY-DATE
  4660     MOVE WS-ENTRY-MMDD (1:2)    TO DB-VAL-DATE (1:2)
  4661     MOVE '-'                    TO DB-VAL-DATE (3:1)
  4662                                    DB-VAL-DATE (6:1)
  4663     MOVE WS-ENTRY-MMDD (3:2)    TO DB-VAL-DATE (4:2)
  4664     MOVE WS-ENTRY-CCYY          TO DB-VAL-DATE (7:4)
  4665     MOVE WS-A                   TO DB-PERIOD
  4666     MOVE WS-P                   TO DB-PAYMENT
  4667     COMPUTE DB-PRINC = WS-P - WS-INT - WS-LINS - WS-DINS
  4668     MOVE WS-INT                 TO DB-INTEREST
  4669     MOVE WS-LINS                TO DB-LINS
  4670     MOVE WS-DINS                TO DB-DINS
  4671     MOVE WS-AMT                 TO DB-BALANCE
  4672     MOVE CR-LFTYP               TO DB-LF-BEN-CODE
  4673     MOVE CR-AHTYP               TO DB-AH-BEN-CODE
  4674     MOVE CR-LF-TERM             TO DB-LF-TERM
  4675     MOVE CR-AH-TERM             TO DB-AH-TERM
  4676     MOVE CR-LF-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4677     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-LF-EXP-DATE (1:2)
  4678     MOVE '-'                    TO DB-LF-EXP-DATE (3:1)
  4679                                    DB-LF-EXP-DATE (6:1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS056.cbl
  4680     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-LF-EXP-DATE (4:2)
  4681     MOVE WS-EXPIRE-CCYY         TO DB-LF-EXP-DATE (7:4)
  4682
  4683     MOVE CR-AH-EXPIRE-DATE      TO WS-EXPIRE-DATE
  4684     MOVE WS-EXPIRE-MMDD (1:2)   TO DB-AH-EXP-DATE (1:2)
  4685     MOVE '-'                    TO DB-AH-EXP-DATE (3:1)
  4686                                    DB-AH-EXP-DATE (6:1)
  4687     MOVE WS-EXPIRE-MMDD (3:2)   TO DB-AH-EXP-DATE (4:2)
  4688     MOVE WS-EXPIRE-CCYY         TO DB-AH-EXP-DATE (7:4)
  4689
  4690     WRITE DEBUG-EXTRACT-RECORD
  4691     END-IF
  4692     END-PERFORM
  4693
  4694     IF (WS-LF-REF > +0)
  4695        OR (WS-AH-REF > +0)
  4696        COMPUTE WS-EXP-PREM = (WS-LF-REF + WS-AH-REF) * -1
  4697     ELSE
  4698        COMPUTE WS-EXP-PREM = (WS-LINS + WS-DINS)
  4699     END-IF
  4700
  4701     MOVE +0                     TO WS-BASE-COMM
  4702                                    WS-GA-COMM
  4703     PERFORM VARYING X1 FROM +1 BY +1 UNTIL
  4704        (X1 > +10)
  4705        IF CR-AGT-TYPE (X1) = 'C' OR 'D'
  4706           COMPUTE WS-BASE-COMM = WS-BASE-COMM
  4707*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4708*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4709           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4710              * CR-LCOM-L (X1))
  4711           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4712              * CR-LCOM-AH (X1))
  4713
  4714
  4715
  4716
  4717        END-IF
  4718        IF CR-AGT-TYPE (X1) = 'O' OR 'P' or 'S'
  4719           COMPUTE WS-GA-COMM = WS-GA-COMM
  4720*          + (WS-LF-PRM * CR-LCOM-L (X1))
  4721*          + (WS-AH-PRM * CR-LCOM-AH (X1))
  4722           + (WS-LINS / (1 - CR-LCOM-L (X1))
  4723              * CR-LCOM-L (X1))
  4724           + (WS-DINS / (1 - CR-LCOM-AH (X1))
  4725              * CR-LCOM-AH (X1))
  4726        END-IF
  4727     END-PERFORM
  4728     .
  4729
  4730 0240-EXIT.
  4731     EXIT.
  4732
  4733 0250-BREAK-RTN.
  4734
  4735*    DISPLAY ' MADE IT TO 0250      BREAK '
  4736     IF WS-HOLD-CAR NOT = CR-CARRIER
  4737        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS056.cbl
  4738        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  4739        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  4740        PERFORM 0330-CAR-BREAK   THRU 0330-EXIT
  4741     ELSE
  4742        IF WS-HOLD-GRP NOT = CR-GROUPING
  4743           PERFORM 0300-ACCT-BREAK
  4744                                 THRU 0300-EXIT
  4745           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  4746           PERFORM 0320-GRP-BREAK
  4747                                 THRU 0320-EXIT
  4748        ELSE
  4749           IF WS-HOLD-ST NOT = CR-STATE
  4750              PERFORM 0300-ACCT-BREAK
  4751                                 THRU 0300-EXIT
  4752              PERFORM 0310-ST-BREAK
  4753                                 THRU 0310-EXIT
  4754           ELSE
  4755              IF WS-HOLD-ACCT NOT = CR-ACCOUNT
  4756                 PERFORM 0300-ACCT-BREAK
  4757                                 THRU 0300-EXIT
  4758              END-IF
  4759           END-IF
  4760        END-IF
  4761     END-IF
  4762     .
  4763 0250-EXIT.
  4764     EXIT.
  4765
  4766 0300-ACCT-BREAK.
  4767
  4768*    DISPLAY ' MADE IT TO 0300 ACCT BREAK '
  4769     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  4770        AND (WS-TOT-REC-PREM (1) = ZEROS)
  4771        AND (WS-TOT-GA-COMM (1) = ZEROS)
  4772        CONTINUE
  4773     ELSE
  4774        MOVE SPACES              TO DETAIL-LINE
  4775        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4776        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4777        MOVE WS-HOLD-ST          TO DTL1-ST
  4778        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  4779        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  4780        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  4781        MOVE WS-TOT-GA-COMM (1)  TO DTL1-COMM
  4782        MOVE DETAIL-LINE         TO P-DATA
  4783        MOVE SPACE-1             TO P-CTL
  4784        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4785
  4786        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
  4787           + WS-TOT-EXP-PREM (1)
  4788        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  4789           + WS-TOT-REC-PREM (1)
  4790        COMPUTE WS-TOT-GA-COMM (2) = WS-TOT-GA-COMM (2)
  4791           + WS-TOT-GA-COMM (1)
  4792     END-IF
  4793     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  4794                                    WS-TOT-REC-PREM (1)
  4795                                    WS-TOT-GA-COMM  (1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS056.cbl
  4796
  4797     .
  4798 0300-EXIT.
  4799     EXIT.
  4800
  4801 0310-ST-BREAK.
  4802
  4803*    DISPLAY ' MADE IT TO 0310  ST  BREAK '
  4804     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  4805        AND (WS-TOT-REC-PREM (2) = ZEROS)
  4806        AND (WS-TOT-GA-COMM (2) = ZEROS)
  4807        CONTINUE
  4808     ELSE
  4809        MOVE SPACES              TO DETAIL-LINE
  4810        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4811        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4812        MOVE WS-HOLD-ST          TO DTL1-ST
  4813        MOVE SPACES              TO DTL1-ACCT
  4814        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  4815        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  4816        MOVE WS-TOT-GA-COMM (2)  TO DTL1-COMM
  4817        MOVE DETAIL-LINE         TO P-DATA
  4818        MOVE SPACE-2             TO P-CTL
  4819        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4820
  4821        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  4822           + WS-TOT-EXP-PREM (2)
  4823        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
  4824           + WS-TOT-REC-PREM (2)
  4825        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  4826           + WS-TOT-GA-COMM (2)
  4827     END-IF
  4828
  4829     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  4830                                    WS-TOT-REC-PREM (2)
  4831                                    WS-TOT-GA-COMM  (2)
  4832
  4833     .
  4834 0310-EXIT.
  4835     EXIT.
  4836
  4837 0320-GRP-BREAK.
  4838
  4839*    DISPLAY ' MADE IT TO 0320 GRP  BREAK '
  4840     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  4841        AND (WS-TOT-REC-PREM (3) = ZEROS)
  4842        AND (WS-TOT-GA-COMM (3) = ZEROS)
  4843        CONTINUE
  4844     ELSE
  4845        MOVE SPACES              TO DETAIL-LINE
  4846        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4847        MOVE WS-HOLD-GRP         TO DTL1-GRP
  4848        MOVE SPACES              TO DTL1-ST
  4849        MOVE SPACES              TO DTL1-ACCT
  4850        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  4851        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  4852        MOVE WS-TOT-GA-COMM (3)  TO DTL1-COMM
  4853        MOVE DETAIL-LINE         TO P-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS056.cbl
  4854        MOVE SPACE-2             TO P-CTL
  4855        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4856
  4857        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  4858           + WS-TOT-EXP-PREM (3)
  4859        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  4860           + WS-TOT-REC-PREM (3)
  4861        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
  4862           + WS-TOT-GA-COMM (3)
  4863     END-IF
  4864
  4865     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  4866                                    WS-TOT-REC-PREM (3)
  4867                                    WS-TOT-GA-COMM  (3)
  4868
  4869     .
  4870 0320-EXIT.
  4871     EXIT.
  4872
  4873 0330-CAR-BREAK.
  4874
  4875     DISPLAY ' MADE IT TO 0330 CAR  BREAK '
  4876     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  4877        AND (WS-TOT-REC-PREM (4) = ZEROS)
  4878        AND (WS-TOT-GA-COMM (4) = ZEROS)
  4879        CONTINUE
  4880     ELSE
  4881        MOVE SPACES              TO DETAIL-LINE
  4882        MOVE WS-HOLD-CAR         TO DTL1-CAR
  4883        MOVE SPACES              TO DTL1-GRP
  4884        MOVE SPACES              TO DTL1-ST
  4885        MOVE SPACES              TO DTL1-ACCT
  4886        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  4887        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  4888        MOVE WS-TOT-GA-COMM (4)  TO DTL1-COMM
  4889        MOVE DETAIL-LINE         TO P-DATA
  4890        MOVE SPACE-2             TO P-CTL
  4891        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4892
  4893        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4894           + WS-TOT-EXP-PREM (4)
  4895        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4896           + WS-TOT-REC-PREM (4)
  4897        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4898           + WS-TOT-GA-COMM (4)
  4899     END-IF
  4900
  4901     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  4902                                    WS-TOT-REC-PREM (4)
  4903                                    WS-TOT-GA-COMM  (4)
  4904
  4905     .
  4906 0330-EXIT.
  4907     EXIT.
  4908
  4909 0340-FIN-BREAK.
  4910
  4911     DISPLAY ' MADE IT TO 0340 FIN  BREAK '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS056.cbl
  4912     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  4913        AND (WS-TOT-REC-PREM (5) = ZEROS)
  4914        AND (WS-TOT-GA-COMM (5) = ZEROS)
  4915        CONTINUE
  4916     ELSE
  4917        MOVE SPACES              TO DETAIL-LINE
  4918        MOVE SPACES              TO DTL1-CAR
  4919        MOVE SPACES              TO DTL1-GRP
  4920        MOVE SPACES              TO DTL1-ST
  4921        MOVE SPACES              TO DTL1-ACCT
  4922        MOVE ' GRAND TOTALS '    TO DETAIL-LINE (1:14)
  4923        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
  4924        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  4925        MOVE WS-TOT-GA-COMM (5)  TO DTL1-COMM
  4926        MOVE DETAIL-LINE         TO P-DATA
  4927        MOVE SPACE-2             TO P-CTL
  4928        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  4929
  4930*       COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  4931*          + WS-TOT-EXP-PREM (4)
  4932*       COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  4933*          + WS-TOT-REC-PREM (4)
  4934*       COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  4935*          + WS-TOT-GA-COMM (4)
  4936     END-IF
  4937
  4938     .
  4939 0340-EXIT.
  4940     EXIT.
  4941
  4942
  4943
  4944 0510-GET-REMAINING-TERM.
  4945
  4946     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  4947
  4948     .
  4949
  4950 0510-EXIT.
  4951     EXIT.
  4952
  4953 8600-HD-RTN.
  4954
  4955     MOVE +0                     TO LNCTR
  4956     MOVE HD1                    TO  P-DATA
  4957     MOVE SPACE-NP               TO  P-CTL
  4958
  4959     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4960
  4961     ADD +1                      TO  PGCTR
  4962
  4963     MOVE PGCTR                  TO  HD-PG
  4964     MOVE HD2                    TO  P-DATA
  4965     MOVE SPACE-1                TO  P-CTL
  4966
  4967     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4968
  4969     MOVE HD3                    TO  P-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS056.cbl
  4970     MOVE SPACE-1                TO  P-CTL
  4971
  4972     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4973
  4974     MOVE SPACE-2                TO  P-CTL
  4975     MOVE HD4                    TO  P-DATA
  4976
  4977     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4978
  4979     MOVE HD5                    TO  P-DATA
  4980     MOVE SPACE-1                TO  P-CTL
  4981     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4982
  4983     MOVE SPACES                 TO  P-DATA
  4984     MOVE SPACE-1                TO  P-CTL
  4985     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  4986
  4987     MOVE +10                    TO  LNCTR
  4988*    MOVE SPACE-2                TO  P-CTL
  4989
  4990     .
  4991 8699-EXIT.
  4992     EXIT.
  4993
  4994 8800-PRT-RTN.
  4995
  4996     IF LNCTR > +56
  4997        MOVE PRT                 TO WS-HOLD-PRT
  4998        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  4999        MOVE WS-HOLD-PRT         TO PRT
  5000     END-IF
  5001
  5002     MOVE P-CTL                  TO X
  5003     IF P-CTL = SPACE-1
  5004        ADD +1                   TO LNCTR
  5005     ELSE
  5006        IF P-CTL = SPACE-2
  5007           ADD +2                TO LNCTR
  5008        ELSE
  5009           IF P-CTL = SPACE-3
  5010              ADD +3             TO LNCTR
  5011           END-IF
  5012        END-IF
  5013     END-IF
  5014
  5015     .
  5016 8850-COPY-PRT-RTN.
* 5017                                 COPY ELCPRT2.
  5018******************************************************************04/15/98
  5019*                                                                *ELCPRT2
  5020*                                                                *ELCPRT2
  5021*                            ELCPRT2                             *   LV005
  5022*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  5023*                            VMOD=2.002                          *   CL**5
  5024*                                                                *   CL**4
  5025******************************************************************   CL**4
  5026                                                                     CL**4
  5027     IF DTE-FICH NOT = SPACE AND                                     CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS056.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  5028        FICH-OPEN    = SPACE                                         CL**4
  5029         MOVE 'X'                TO  FICH-OPEN                       CL**4
  5030         OPEN OUTPUT FICH.                                           CL**4
  5031                                                                     CL**4
  5032     IF DTE-FICH NOT = SPACE                                         CL**4
  5033         MOVE X                  TO  P-CTL                           CL**4
  5034         WRITE FICH-REC FROM PRT.                                    CL**4
  5035                                                                     CL**4
  5036     IF DTE-FICH = SPACE OR '2'                                      CL**4
  5037       MOVE X                    TO  P-CTL                           CL**4
  5038       IF P-CTL = ' '                                                CL**4
  5039         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  5040       ELSE                                                          CL**4
  5041         IF P-CTL = '0'                                              CL**4
  5042           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  5043         ELSE                                                        CL**4
  5044           IF P-CTL = '-'                                            CL**4
  5045             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  5046           ELSE                                                      CL**4
  5047             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  5048                                                                     CL**4
  5049******************************************************************   CL**4
  5050
  5051 8800-EXIT.
  5052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS056.cbl
  5054 8510-DATE-CONVERSION.
  5055
  5056     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  5057
  5058     .
  5059
  5060 8590-EXIT.
  5061     EXIT.
  5062
  5063
  5064
  5065
  5066 ABEND-PGM.
* 5067                                 COPY ELCABEND.
  5068***************************************************************** 04/14/98
  5069*                                                               * ELCABEND
  5070*                            ELCABEND.                          *    LV003
  5071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5072*                            VMOD 2.002                              CL**2
  5073*                                                               * ELCABEND
  5074*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  5075*            AND THEN ABENDS.                                   * ELCABEND
  5076*                                                               * ELCABEND
  5077*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  5078*                                                               * ELCABEND
  5079***************************************************************** ELCABEND
  5080*APS-010.                                                         ELCABEND
  5081     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  5082     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  5083                                                                  ELCABEND
  5084     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  5085         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5086         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  5087                                 UPON CONSOLE.                    ELCABEND
  5088                                                                  ELCABEND
  5089     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  5090         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5091         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  5092                                 UPON CONSOLE.                    ELCABEND
  5093                                                                  ELCABEND
  5094     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5095     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  5096                                 UPON CONSOLE.                    ELCABEND
  5097                                                                  ELCABEND
  5098     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  5099     CALL 'ABORTME'.
  5100                                                                  ELCABEND
  5101 APS-EXIT.                                                        ELCABEND
  5102     EXIT.                                                        ELCABEND
  5103
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       73648     Code:       19020
