* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS043RET.cbl
* Options: int("ECS043RET.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS043RET.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS043RET.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ECS043RET.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECSRETRO.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 16:43:46.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS043RET.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND CREATE
    23*            A RETRO EXTRACT FILE.
    24
    25*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    26*        FORMAT OTHER THAN YTD AND ITD.
    27
    28*        FORMAT OF INPUT IS -
    29*         CC 1-2    CARD I.D. 'RF'
    30*            3-5    CLIENT-ID
    31*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    32
    33*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    34*                      1  YTD
    35*                      2  QTD
    36*                      3  LAST 3 MOS.
    37*                      4  LAST 6 MOS.
    38*                      5  LAST 12 MOS.
    39*                      6  LAST MONTH
    40
    41*            7-14   BEGINNING DATE  (CCYYMMDD)
    42
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    52* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    53* 081208    2008073000002  AJRA  CREATE EXTRACT FILE OF ACCOUNT TOTALS
    54* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    55*                                FIX DIVIDE BY ZERO
    56* 010809    2008090300001  AJRA  FOR PRIOR YEARS WHERE EXP DT MAY NOT
    57*                                MATCH, COMPARE ACCT AND EPEC BY EFF DT
    58* 020409    2008073000002  AJRA  ADD RETRO PAYMENTS
    59* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    60******************************************************************
    61
    62
    63 ENVIRONMENT DIVISION.
    64 INPUT-OUTPUT SECTION.
    65 FILE-CONTROL.
    66
    67     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    68     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    69     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    70     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
    71                             ACCESS IS SEQUENTIAL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS043RET.cbl
    72                             ORGANIZATION IS INDEXED
    73                             FILE STATUS IS ERACCTT-FILE-STATUS
    74                             RECORD KEY IS AM-CONTROL-PRIMARY.
    75     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    76                             ORGANIZATION IS INDEXED
    77                             ACCESS IS DYNAMIC
    78                             FILE STATUS IS ERPLAN-FILE-STATUS
    79                             RECORD KEY IS PL-CONTROL-PRIMARY.
    80     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    81     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    82     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    83     SELECT  DATA-OUT        ASSIGN TO SYS022-UT-2400-S-SYS022
    84                             ORGANIZATION IS LINE SEQUENTIAL.
    85
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS043RET.cbl
    87 DATA DIVISION.
    88 FILE SECTION.
    89
    90 SD  SORT-WORK.
    91
    92 01  SW-REC-OUT.
    93     12  SW-RPT-TYPE-ID-OUT  PIC X.
    94     12  SW-CTL-OUT          PIC X(35).
    95*00077      12  FILLER              PIC X(1090).
    96     12  FILLER              PIC X(1307).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS043RET.cbl
    98 FD  CONTROL-CARD
    99     BLOCK CONTAINS 0 RECORDS
   100     RECORDING MODE F.
   101
   102 01  CARD-IN-AREA            PIC X(80).
   103
   104 FD  PRNTR
*  105                             COPY ELCPRTFD.
   106******************************************************************04/15/98
   107*                                                                *ELCPRTFD
   108*                                                                *ELCPRTFD
   109*                            ELCPRTFD.                           *   LV003
   110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   111*                            VMOD=2.006                          *ELCPRTFD
   112******************************************************************ELCPRTFD
   113     RECORDING MODE F                                             ELCPRTFD
   114     LABEL RECORDS OMITTED                                        ELCPRTFD
   115     BLOCK CONTAINS 0 RECORDS
   116     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   117 01  PRT.                                                         ELCPRTFD
   118     12  P-CTL               PIC  X.                                 CL**2
   119     12  P-DATA              PIC  X(132).                         ELCPRTFD
   120******************************************************************ELCPRTFD
   121
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS043RET.cbl
   123 FD  EPEC-FILE
*  124                             COPY ECSEPCFD.
   125******************************************************************07/10/97
   126*                                                                *ECSEPCFD
   127*                            ECSEPCFD                            *   LV001
   128*                            VMOD=2.002                          *ECSEPCFD
   129*                                                                *ECSEPCFD
   130*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   131*                                                                *ECSEPCFD
   132******************************************************************ECSEPCFD
   133     RECORDING MODE F                                             ECSEPCFD
   134     LABEL RECORDS STANDARD                                       ECSEPCFD
   135     BLOCK CONTAINS 0 RECORDS
   136     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   137******************************************************************ECSEPCFD
*  138                             COPY ECSEPC01.
   139******************************************************************
   140*                                                                *
   141*                            ECSEPC01                            *
   142*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   143*                            VMOD=2.008                          *
   144*                                                                *
   145*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   146*                                                                *
   147*   FILE TYPE = SEQUENTIAL                                       *
   148*   RECORD SIZE = 325  RECFORM = FIXED                           *
   149*                                                                *
   150*   KEY DATA =                                  START=5, LEN=31  *
   151*                                                                *
   152*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   153*                                                                *
   154******************************************************************
   155
   156 01  EP-RECORD.
   157     02 EP-FILE.
   158     12  EP-RECORD-ID                      PIC XX.
   159         88  VALID-EP-ID                      VALUE 'EP'.
   160
   161     12  EP-COMPANY-CD                     PIC X.
   162
   163     12  EP-REIN                           PIC X.
   164         88  EP-REIN-EXTRACT                  VALUE 'R'.
   165
   166     12  EP-CONTROL.
   167         16  EP-CNTRL-1.
   168             20  EP-COMPANY.
   169                 24  EP-CARRIER            PIC X.
   170                 24  EP-GROUPING.
   171                     28  EP-GROUP-PREFIX   PIC XXX.
   172                     28  EP-GROUP-PRIME    PIC XXX.
   173             20  EP-STATE                  PIC XX.
   174             20  EP-ACCOUNT.
   175                 24  EP-ACCT-PREFIX        PIC X(4).
   176                 24  EP-ACCT-PRIME         PIC X(6).
   177         16  EP-CNTRL-2.
   178             20  EP-DATES.
   179                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   180                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   181
   182     12  EP-REI-CO.
   183         16  EP-REINCO                     PIC XXX.
   184         16  EP-REINCO-SUB                 PIC XXX.
   185
   186     12  EP-RCD-TYPE                       PIC X.
   187         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   188         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   189         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   190         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   191         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   192         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   193     12  EP-BEN-CODE                       PIC XX.
   194     12  FILLER                            PIC X.
   195
   196     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   197     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   198     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   199
   200     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   201     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   202     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   203
   204     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   205     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   206     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   207     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   208
   209     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   210     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   211     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   212
   213     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   214     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   215     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   216
   217     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   218     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   219     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   220     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   221     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   222
   223     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   224     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   225     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   226
   227     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   228     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   229     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   230
   231     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   232         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   233         16  EP-NEW-DATA-IND               PIC X(01).
   234             88  EP-NEW-DATA                   VALUE 'Y'.
   235         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   236         16  FILLER                        PIC X(19).
   237
   238     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   239     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   240     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   241
   242     12  FILLER                            PIC XXX.
   243
   244     12  EP-UNDERWRITING-CODE              PIC X.
   245         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   246
   247     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   248
   249     12  FILLER                            PIC X(29).
   250*    12  FILLER                            PIC X(34).
   251
   252     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   253     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   254     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   255     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   256     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   257     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   258
   259     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   260
   261     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   262     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   263
   264     12  EP-PURGE                          PIC X.
   265         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   266
   267     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   268
   269     02 EC-RECORD     REDEFINES     EP-FILE.
   270     12  EC-RECORD-ID                      PIC XX.
   271         88  VALID-EC-ID                      VALUE 'EC'.
   272
   273     12  EC-COMPANY-CD                     PIC X.
   274
   275     12  EC-REIN                           PIC X.
   276         88  EC-REIN-EXTRACT                  VALUE 'R'.
   277
   278     12  EC-CONTROL.
   279         16  EC-CARRIER                    PIC X.
   280         16  EC-GROUPING.
   281             20  EC-GROUP-PREFIX           PIC XXX.
   282             20  EC-GROUP-PRIME            PIC XXX.
   283         16  EC-STATE                      PIC XX.
   284         16  EC-ACCOUNT.
   285             20  EC-ACCT-PREFIX            PIC X(4).
   286             20  EC-ACCT-PRIME             PIC X(6).
   287         16  EC-DATES.
   288             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   289             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   290
   291     12  EC-REI-CO.
   292         16  EC-REINCO                     PIC XXX.
   293         16  EC-REINCO-SUB                 PIC XXX.
   294
   295     12  EC-RCD-TYPE                       PIC X.
   296         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   297         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   298         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   299         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   300         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   301     12  EC-BEN-CODE                       PIC XX.
   302     12  EC-SEQ-NBR                        PIC X.
   303         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   304         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   305
   306     12  EC-AGENTS-DATA.
   307         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   308             20  EC-AGT-NO.
   309                 24  EC-AGT-PREFIX         PIC X(4).
   310                 24  EC-AGT-PRIME          PIC X(6).
   311             20  EC-AGT-TYPE               PIC X.
   312             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   313             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   314             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   315             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   316             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   317
   318     12  EC-UNDERWRITING-CODE              PIC X.
   319         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   320
   321     12  EC-AGENTS-DATA-II.
   322         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   323             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   324             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   325
   326     12  FILLER                            PIC X(7).
   327
   328     12  EC-PURGE                          PIC X.
   329         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   330
   331     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   332
   333******************************************************************
   334
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS043RET.cbl
   336 FD  ACC-MSTR.
*  337                             COPY ERCACCT.
   338******************************************************************04/19/98
   339*                                                                *ERCACCT
   340*                                                                *ERCACCT
   341*                            ERCACCT                             *   LV031
   342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   343*                            VMOD=2.031                          *ERCACCT
   344*                                                                *ERCACCT
   345*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   346*                                                                *ERCACCT
   347*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   348*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   349*                                                                *ERCACCT
   350*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   351*                                                                *ERCACCT
   352*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   353*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   354*                                                                *ERCACCT
   355*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   356*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   357*                                                                *ERCACCT
   358*   LOG = NO                                                     *ERCACCT
   359*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   360*                                                                *ERCACCT
   361*                                                                *ERCACCT
   362******************************************************************ERCACCT
   363*                   C H A N G E   L O G
   364*
   365* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   366*-----------------------------------------------------------------
   367*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   368* EFFECTIVE    NUMBER
   369*-----------------------------------------------------------------
   370* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   371* 092705    2005050300006  PEMA  ADD SPP LEASES
   372* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   373* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   374* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   375* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   376* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   377******************************************************************
   378                                                                  ERCACCT
   379 01  ACCOUNT-MASTER.                                              ERCACCT
   380     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   381         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   382                                                                  ERCACCT
   383     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   384         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   385         16  AM-MSTR-CNTRL.                                       ERCACCT
   386             20  AM-CONTROL-A.                                    ERCACCT
   387                 24  AM-CARRIER            PIC X.                 ERCACCT
   388                 24  AM-GROUPING.                                 ERCACCT
   389                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   390                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   391                 24  AM-STATE              PIC XX.                ERCACCT
   392                 24  AM-ACCOUNT.                                  ERCACCT
   393                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   394                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   395             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   396                                           PIC X(19).             ERCACCT
   397             20  AM-CNTRL-B.                                      ERCACCT
   398                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   399                 24  FILLER                PIC X(4).              ERCACCT
   400             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   401                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   402                                                                  ERCACCT
   403     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   404         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   405         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   406         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   407         16  AM-VG-STATE                   PIC XX.                ERCACCT
   408         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   409         16  AM-VG-DATE.                                          ERCACCT
   410             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   411             20  FILLER                    PIC X(4).              ERCACCT
   412         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   413                                           PIC 9(11)      COMP-3. ERCACCT
   414     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   415         16  FILLER                        PIC X(10).
   416         16  AM-VG-KEY3.
   417             20  AM-VG3-ACCOUNT            PIC X(10).
   418             20  AM-VG3-EXP-DT             PIC XX.
   419         16  FILLER                        PIC X(4).
   420     12  AM-MAINT-INFORMATION.                                    ERCACCT
   421         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   422         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   423         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   424         16  FILLER                        PIC XX.                ERCACCT
   425                                                                  ERCACCT
   426     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   427     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   428                                                                  ERCACCT
   429     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   430         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   431         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   432                                                                  ERCACCT
   433     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   434     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   435                                                                  ERCACCT
   436     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   437     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   438                                                                  ERCACCT
   439     12  AM-NAME                           PIC X(30).             ERCACCT
   440     12  AM-PERSON                         PIC X(30).             ERCACCT
   441     12  AM-ADDRS                          PIC X(30).             ERCACCT
   442     12  AM-CITY.
   443         16  AM-ADDR-CITY                  PIC X(28).
   444         16  AM-ADDR-STATE                 PIC XX.
   445     12  AM-ZIP.                                                  ERCACCT
   446         16  AM-ZIP-PRIME.                                        ERCACCT
   447             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   448                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   449             20  FILLER                    PIC X(4).              ERCACCT
   450         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   451     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   452         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   453         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   454         16  FILLER                        PIC XXX.               ERCACCT
   455     12  AM-TEL-NO.                                               ERCACCT
   456         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   457         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   458         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   459     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   460         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   461         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   462                                                                  ERCACCT
   463     12  AM-COMM-STRUCTURE.                                       ERCACCT
   464         16  AM-DEFN-1.                                           ERCACCT
   465             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   466                 24  AM-AGT.                                      ERCACCT
   467                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   468                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   469                 24  AM-COM-TYP            PIC X.                 ERCACCT
   470                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   471                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   472                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   473                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   474                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   475                 24  AM-GL-CODES           PIC X.                 ERCACCT
   476                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   477                 24  FILLER                PIC X(01).             ERCACCT
   478         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   479             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   480                 24  FILLER                PIC X(11).             ERCACCT
   481                 24  AM-L-COMA             PIC XXX.               ERCACCT
   482                 24  AM-J-COMA             PIC XXX.               ERCACCT
   483                 24  AM-A-COMA             PIC XXX.               ERCACCT
   484                 24  FILLER                PIC X(6).              ERCACCT
   485                                                                  ERCACCT
   486     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   487         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   488                                                                  ERCACCT
   489     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   490                                                                  ERCACCT
   491     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   492         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   493         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   494     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   495         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   496         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   497     12  AM-GPCD                           PIC 99.                ERCACCT
   498     12  AM-IG                             PIC X.                 ERCACCT
   499         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   500         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   501     12  AM-STATUS                         PIC X.                 ERCACCT
   502         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   503         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   504         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   505         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   506         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   507         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   508     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   509     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   510                                                                  ERCACCT
   511     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   512     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   513     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   514     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   515     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   516     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   517     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   518     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   519     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   520                                                                  ERCACCT
   521     12  AM-USER-FIELDS.                                          ERCACCT
   522         16  AM-FLD-1                      PIC XX.                ERCACCT
   523         16  AM-FLD-2                      PIC XX.                ERCACCT
   524         16  AM-FLD-3                      PIC XX.                ERCACCT
   525         16  AM-FLD-4                      PIC XX.                ERCACCT
   526         16  AM-FLD-5                      PIC XX.                ERCACCT
   527                                                                  ERCACCT
   528     12  AM-1ST-PROD-DATE.                                        ERCACCT
   529         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   530         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   531         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   532     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   533     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   534         16  AM-PUR-YR                     PIC XX.                ERCACCT
   535         16  AM-PUR-MO                     PIC XX.                ERCACCT
   536         16  AM-PUR-DA                     PIC XX.                ERCACCT
   537     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   538     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   539     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   540     12  AM-INACTIVE-DATE.                                        ERCACCT
   541         16  AM-INA-MO                     PIC 99.                ERCACCT
   542         16  AM-INA-DA                     PIC 99.                ERCACCT
   543         16  AM-INA-YR                     PIC 99.                ERCACCT
   544     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   545                                                                  ERCACCT
   546     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   547     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   548                                                                  ERCACCT
   549     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   550         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   551         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   552         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   553         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   554                                                                  ERCACCT
   555     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   556         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   557         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   558                                                                  ERCACCT
   559     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   560                                                                  ERCACCT
   561     12  AM-OVER-SHORT.                                           ERCACCT
   562         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   563         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   564                                                                  ERCACCT
   565     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   566     12  AM-DCC-CLP-STATE                  PIC XX.
   567                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   568     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   569     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   570                                                                  ERCACCT
   571     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   572     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   573     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   574     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   575     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   576     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   577     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   578     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   579     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   580     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   581     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   582     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   583     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   584     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   585     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   586     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   587                                                                  ERCACCT
   588     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   589                                                                  ERCACCT
   590     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   591     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   592                                                                  ERCACCT
   593     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   594     12  AM-EARN-METHODS.                                         ERCACCT
   595         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   596             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   597             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   598             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   599             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   600         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   601             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   602             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   603             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   604             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   605         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   606             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   607             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   608             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   609             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   610             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   611             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   612                                                                  ERCACCT
   613     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   614     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   615     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   616                                                                  ERCACCT
   617     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   618     12  AM-RET-P-E                        PIC X.                 ERCACCT
   619     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   620     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   621     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   622     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   623         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   624         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   625     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   626         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   627         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   628         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   629     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   630         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   631         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   632     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   633         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   634         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   635         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   636     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   637     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   638                                                                  ERCACCT
   639     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   640         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   641         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   642         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   643         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   644         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   645                                                                  ERCACCT
   646     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   647                                                                  ERCACCT
   648     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   649                                                                  ERCACCT
   650     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   651         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   652                                                                  ERCACCT
   653     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   654         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   655         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   656                                                                  ERCACCT
   657     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   658         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   659                                                                  ERCACCT
   660     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   661         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   662         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   663                                                                  ERCACCT
   664     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   665                                                                  ERCACCT
   666     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   667     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   668     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   669     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   670     12  AM-DCC-UEF-STATE                  PIC XX.
   671     12  FILLER                            PIC XXX.
   672     12  AM-REPORT-CODE-3                  PIC X(10).
   673*    12  FILLER                            PIC X(22).             ERCACCT
   674                                                                  ERCACCT
   675     12  AM-RESERVE-DATE.                                         ERCACCT
   676         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   677         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   678         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   679                                                                  ERCACCT
   680     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   681     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   682         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   683         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   684         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   685         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   686                                                                  ERCACCT
   687     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   688         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   689         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   690         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   691         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   692                                                                  ERCACCT
   693     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   694         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   695             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   696             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   697             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   698             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   699             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   700             20  FILLER                    PIC XX.                ERCACCT
   701         16  FILLER                        PIC X(80).             ERCACCT
   702                                                                  ERCACCT
   703     12  AM-TRANSFER-DATA.                                        ERCACCT
   704         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   705             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   706             20  AM-TRNFROM-GROUPING.                             ERCACCT
   707                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   708                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   709             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   710             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   711                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   712                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   713             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   714         16  AM-TRANSFERRED-TO.                                   ERCACCT
   715             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   716             20  AM-TRNTO-GROUPING.                               ERCACCT
   717                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   718                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   719             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   720             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   721                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   722                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   723             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   724         16  FILLER                        PIC X(10).             ERCACCT
   725                                                                  ERCACCT
   726     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   727                                                                  ERCACCT
   728     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   729         16  AM-DEFN-1-SAVED.                                     ERCACCT
   730             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   731                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   732                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   733                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   734                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   735                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   736                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   737                 24  FILLER                PIC X.                 ERCACCT
   738                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   739                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   740                 24  FILLER                PIC X.                 ERCACCT
   741         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   742             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   743                 24  FILLER                PIC X(11).             ERCACCT
   744                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   745                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   746                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   747                 24  FILLER                PIC X(6).              ERCACCT
   748                                                                  ERCACCT
   749     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   750         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   751            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   752            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   753            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   754                                                                  ERCACCT
   755     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   756     12  FILLER                            PIC X(120).            ERCACCT
   757                                                                  ERCACCT
   758     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   759         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   760         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   761             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   762             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   763                                                          COMP-3. ERCACCT
   764             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   765                                                          COMP-3. ERCACCT
   766         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   767             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   768             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   769                                                          COMP-3. ERCACCT
   770             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   771                                                          COMP-3. ERCACCT
   772                                                                  ERCACCT
   773     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   774         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   775         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   776         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   777         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   778             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   779                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   780                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   781             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   782                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   783                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   784             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   785                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   786                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   787         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   788             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   789                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   790                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   791                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   792             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   793                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   794                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   795             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   796                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   797                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   798                                                                  ERCACCT
   799     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   800         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   801                                                                  ERCACCT
   802     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   803         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   804         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   805         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   806         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   807         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   808             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   809             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   810             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   811             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   812         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   813             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   814             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   815             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   816         16  FILLER                        PIC X(102).            ERCACCT
   817                                                                  ERCACCT
   818     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   819         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   820             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   821             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   822             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   823             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   824             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   825         16  FILLER                          PIC X(10).           ERCACCT
   826******************************************************************ERCACCT
   827
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS043RET.cbl
   829 FD  ERPLAN-IN.
*  830                             COPY ERCPLAN.
   831******************************************************************04/29/98
   832*                                                                *ERCPLAN
   833*                                                                *ERCPLAN
   834*                            ERCPLAN                             *   LV003
   835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   836*                            VMOD=2.003                          *   CL**2
   837*                                                                *ERCPLAN
   838*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   839*                                                                *ERCPLAN
   840*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   841*   PLAN MASTER                                                  *ERCPLAN
   842*                                                                *ERCPLAN
   843*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   844*                                                                *ERCPLAN
   845*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   846*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   847*                                                                *ERCPLAN
   848*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   849*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   850*                                                                *ERCPLAN
   851*   LOG = NO                                                     *ERCPLAN
   852*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   853*                                                                *ERCPLAN
   854*                                                                *ERCPLAN
   855******************************************************************ERCPLAN
   856                                                                  ERCPLAN
   857 01  PLAN-MASTER.                                                 ERCPLAN
   858     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   859         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   860                                                                  ERCPLAN
   861     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   862         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   863         16  PL-MSTR-CNTRL.                                       ERCPLAN
   864             20  PL-CONTROL-A.                                    ERCPLAN
   865                 24  PL-CARRIER            PIC X.                 ERCPLAN
   866                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   867                 24  PL-STATE              PIC XX.                ERCPLAN
   868                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   869             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   870             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   871             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   872                                                                  ERCPLAN
   873     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   874         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   875         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   876         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   877         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   878         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   879         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   880         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   881         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   882                                                                  ERCPLAN
   883     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   884         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   885         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   886         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS043RET.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   887         16  FILLER                        PIC XX.                ERCPLAN
   888                                                                  ERCPLAN
   889     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   890         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   891         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   892             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   893             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   894             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   895             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   896                                                                  ERCPLAN
   897     12  FILLER                            PIC X(30).             ERCPLAN
   898                                                                  ERCPLAN
   899     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   900         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   901         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   902         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   903     12  FILLER                            PIC X(24).             ERCPLAN
   904     12  PL-TOLERANCES.                                           ERCPLAN
   905         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   906         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   907         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   908         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   909         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   910         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   911     12  PL-OVER-SHORT.                                           ERCPLAN
   912         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   913         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   914     12  FILLER                            PIC X(24).             ERCPLAN
   915     12  PLAN-MISC.                                               ERCPLAN
   916         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   917         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   918         16  PL-IG                         PIC X.                 ERCPLAN
   919         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   920         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   921         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   922         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   923         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   924         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   925         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   926         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   927                                                                  ERCPLAN
   928         16  FILLER                        PIC X(99).             ERCPLAN
   929******************************************************************ERCPLAN
   930
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS043RET.cbl
   932 FD  DISK-DATE
*  933                             COPY ELCDTEFD.
   934******************************************************************04/15/98
   935*                                                                *ELCDTEFD
   936*                                                                *ELCDTEFD
   937*                            ELCDTEFD.                           *   LV002
   938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   939*                            VMOD=2.007                          *   CL**2
   940*                                                                *ELCDTEFD
   941******************************************************************ELCDTEFD
   942     BLOCK CONTAINS 0 RECORDS
   943     RECORDING MODE F.                                            ELCDTEFD
   944                                                                  ELCDTEFD
   945 01  DATE-DISK.                                                   ELCDTEFD
   946     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   947     12  FILLER                      PIC  X(14).                  ELCDTEFD
   948     12  DD-CR1                      PIC  9.                      ELCDTEFD
   949     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   950     12  DD-CR2                      PIC  9.                      ELCDTEFD
   951     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   952     12  FILLER                      PIC  X(20).                  ELCDTEFD
   953                                                                  ELCDTEFD
   954 01  DATE-DISK-R.                                                 ELCDTEFD
   955     12  FILLER                      PIC  X(4).                   ELCDTEFD
   956     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   957                                     PIC  X(32).                  ELCDTEFD
   958                                                                  ELCDTEFD
   959 01  DATE-DISK-T.                                                 ELCDTEFD
   960     12  FILLER                      PIC  X(4).                   ELCDTEFD
   961     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   962                                     PIC  X(48).                  ELCDTEFD
   963                                                                  ELCDTEFD
   964 01  DATE-DISK-M.                                                 ELCDTEFD
   965     12  FILLER                      PIC  X(4).                   ELCDTEFD
   966     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   967                                     PIC  X(48).                  ELCDTEFD
   968                                                                  ELCDTEFD
   969 01  DATE-DISK-P.                                                 ELCDTEFD
   970     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   971     12  DD-IDX                      PIC  99.                     ELCDTEFD
   972     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   973     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   974         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   975                                     PIC  X.                      ELCDTEFD
   976         16  FILLER                  PIC  X(46).                  ELCDTEFD
   977     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   978         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   979             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   980             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   981             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   982             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   983         16  FILLER                  PIC  X(16).                  ELCDTEFD
   984                                                                  ELCDTEFD
   985 01  DATE-DISK-E.                                                 ELCDTEFD
   986     12  FILLER                      PIC  X(4).                   ELCDTEFD
   987     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   988                                     PIC  X(4).                   ELCDTEFD
   989                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   990 01  DATE-DISK-C.                                                 ELCDTEFD
   991     12  FILLER                      PIC  X(7).                   ELCDTEFD
   992     12  DD-CARR1-SECPAY-SW          PIC  X.
   993     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   994     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   995     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   996     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   997     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   998     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   999     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1000     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1001     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1002     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1003     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1004     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1005     12  DD-CARR2-SECPAY-SW          PIC  X.
  1006     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1007                                                                  ELCDTEFD
  1008 01  DATE-DISK-OPT.                                               ELCDTEFD
  1009     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1010     12  DD-TLR-DATA.                                             ELCDTEFD
  1011         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1012                                     PIC  X(03).                  ELCDTEFD
  1013     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1014         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1015                                     PIC  X(06).                  ELCDTEFD
  1016     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1017         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1018                                     PIC  X(07).                  ELCDTEFD
  1019         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1020     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1021                                     PIC  X(96).                  ELCDTEFD
  1022******************************************************************ELCDTEFD
  1023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS043RET.cbl
  1025 FD  FICH
* 1026                             COPY ELCFCHFD.
  1027******************************************************************04/15/98
  1028*                                                                *ELCFCHFD
  1029*                            ELCFCHFD.                           *   LV003
  1030*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1031*                            VMOD=2.004                          *   CL**3
  1032*                                                                *ELCFCHFD
  1033******************************************************************ELCFCHFD
  1034     BLOCK CONTAINS 0 RECORDS
  1035     RECORDING MODE F.                                            ELCFCHFD
  1036                                                                  ELCFCHFD
  1037 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1038******************************************************************ELCFCHFD
  1039 FD  DATA-OUT
  1040     RECORDING MODE F
  1041     BLOCK CONTAINS 0 RECORDS.
  1042
  1043 01  DATA-OUT-REC               PIC X(1413).
  1044
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS043RET.cbl
  1046 WORKING-STORAGE SECTION.
  1047
  1048 77  FILLER  PIC X(32) VALUE '********************************'.
  1049 77  FILLER  PIC X(32) VALUE '     ECS043 WORKING STORAGE     '.
  1050 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1051
  1052 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1053 77  NDX                     PIC S999            COMP.
  1054 77  SA                      PIC S999            COMP.
  1055 77  SB                      PIC S999            COMP.
  1056 77  SC                      PIC S999            COMP.
  1057 77  SE                      PIC S999            COMP.
  1058 77  SF                      PIC S999            COMP.
  1059 77  SG                      PIC S999            COMP.
  1060 77  SH                      PIC S999            COMP.
  1061 77  CL                      PIC S999            COMP.
  1062 77  AL                      PIC S999            COMP.
  1063 77  AN                      PIC S999            COMP.
  1064 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1065 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1066 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1067 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1068 77  X                       PIC X.
  1069 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1070 77  WS-EP-CODE              PIC X.
  1071 77  WS-OB-CODE              PIC X.
  1072 77  SAVE-DA-UP              PIC S9(9)V99.
  1073 77  SAVE-DA-UC              PIC S9(9)V99.
  1074 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1075 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1076 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1077 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1078 77  WS-RETRO-FLAG           PIC X.
  1079 77  WS-DO-SUB               PIC S9(3)     COMP-3 VALUE +0.
  1080
  1081 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1082
  1083 01  WS-ABEND-STORAGE.
  1084     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1085     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1086     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1087     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1088
  1089     12  WS-ABEND-CODE         PIC 9(4).
  1090     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1091         16  W-ABEND-CODE-1    PIC XX.
  1092         16  W-ABEND-CODE-2    PIC XX.
  1093     12  ERACCTT-FILE-STATUS   PIC XX.
  1094     12  ERPLAN-FILE-STATUS    PIC XX.
  1095
  1096 01  WORK-MSG.
  1097     05  FILLER              PIC X    VALUE SPACE.
  1098     05  W-MM                PIC XX.
  1099     05  FILLER              PIC X    VALUE '/'.
  1100     05  W-DD                PIC XX.
  1101     05  FILLER              PIC X    VALUE '/'.
  1102     05  W-CCYY              PIC X(4).
  1103     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS043RET.cbl
  1104
  1105 01  FORMAT-CONTROL-CARD.
  1106     05  FC-ID               PIC XX.
  1107     05  FC-CLIENT           PIC XXX.
  1108     05  FC-CODE             PIC X.
  1109     05  FC-DATE             PIC 9(8).
  1110     05  FC-DATE-R  REDEFINES  FC-DATE.
  1111         10  FC-CCYY         PIC 9(04).
  1112         10  FC-CCYR REDEFINES FC-CCYY.
  1113             15  FC-CC       PIC 99.
  1114             15  FC-YY       PIC 99.
  1115         10  FC-MM           PIC 99.
  1116         10  FC-DD           PIC 99.
  1117     05  FILLER              PIC X(66).
  1118
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS043RET.cbl
  1120 01  SW-REC.
  1121     12  SW-RPT-TYPE-ID      PIC X.
  1122         88  ACCOUNT-RPT        VALUE 'A'.
  1123         88  RETRO-GROUP-RPT    VALUE 'B'.
  1124         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1125     12  SW-CTL.
  1126         16  SW-GA           PIC X(10).
  1127         16  SW-CARR         PIC X.
  1128         16  SW-COMP         PIC XXXXXX.
  1129         16  SW-STATE        PIC XX.
  1130         16  SW-ACCT         PIC X(10).
  1131         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1132     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1133     12  SW-NAME             PIC X(30).
  1134     12  SW-ADDRS            PIC X(20).
  1135     12  SW-CITY             PIC X(20).
  1136     12  SW-ZIP.
  1137         16  SW-ZIP-PRIME.
  1138             20  FILLER      PIC X(01).
  1139                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1140             20  FILLER      PIC X(04).
  1141         16  SW-ZIP-PLUS4    PIC X(04).
  1142     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1143         16  SW-CAN-POST-CODE-1
  1144                             PIC X(03).
  1145         16  SW-CAN-POST-CODE-2
  1146                             PIC X(03).
  1147         16  FILLER          PIC X(03).
  1148     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1149     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1150     12  SW-RET-Y-N          PIC X.
  1151     12  SW-RET-TYP          PIC X.
  1152     12  SW-GA-FLAG          PIC X.
  1153*00214      12  SW-ACCUMS           PIC X(972).
  1154     12  SW-ACCUMS           PIC X(1188).
  1155     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1156     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1157     12  SW-PREM-P-E         PIC X.
  1158     12  SW-CLMS-P-I         PIC X.
  1159     12  SW-RETRO-POOL       PIC X(10).
  1160     12  SW-TAX-P-E          PIC X.
  1161*00219      12  FILLER              PIC X(12).
  1162     12  FILLER              PIC X(2).
  1163
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS043RET.cbl
  1165 01  WS-ACCT-CONTROL.
  1166     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1167     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1168
  1169 01  WS-SAVE-CONTROL.
  1170     12  WS-SAVE-CARR        PIC X.
  1171     12  WS-SAVE-COMP        PIC XXXXXX.
  1172     12  WS-SAVE-STATE       PIC XX.
  1173     12  WS-SAVE-ACCT        PIC X(10).
  1174     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1175     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1176
  1177 01  WS-ACCT-CONTROL-EFFDT.
  1178     12  WS-MSTR-CNTRL-EFFDT PIC X(19).
  1179     12  WS-EFFECT-EFFDT     PIC 9(11)  COMP-3  VALUE ZEROS.
  1180 01  WS-SAVE-CONTROL-EFFDT.
  1181     12  WS-SAVE-CNTRL-EFFDT PIC X(19).
  1182     12  WS-SAVE-EFF-DATE-EFFDT PIC 9(11)  COMP-3.
  1183
  1184 01  WS-SAVE-CTL.
  1185     12  WS-SAVE-GA          PIC X(10).
  1186     12  WS-SAVE-CAR         PIC X.
  1187     12  WS-SAVE-CMP         PIC XXXXXX.
  1188     12  WS-SAVE-ST          PIC XX.
  1189     12  WS-SAVE-ACC         PIC X(10).
  1190     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1191
  1192 01  WS-PLAN-CONTROL.
  1193     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1194     12  WS-PL-CONTROL-A.
  1195         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1196         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1197         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1198         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1199     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1200     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1201     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1202
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS043RET.cbl
  1204 01  MISC.
  1205     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1206     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1207     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1208     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1209     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1210     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1211     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1212     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1213     12  HEAD-SW             PIC X         VALUE SPACE.
  1214     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1215     12  SAVE-GA-FLAG        PIC X.
  1216     12  SAVE-RET-Y-N        PIC X.
  1217     12  SAVE-RET-TYP        PIC X.
  1218     12  SAVE-PREM-P-E       PIC X.
  1219     12  SAVE-CLMS-P-I       PIC X.
  1220     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1221         88  EXCLUDING-BENEFIT  VALUE '*'.
  1222
  1223 01  BEG-DATE                PIC 9(11).
  1224 01  BEG-DATE-R REDEFINES BEG-DATE.
  1225     12 FILLER               PIC 999.
  1226     12  BD-CCYY             PIC 9(04).
  1227     12  BD-CCYR REDEFINES BD-CCYY.
  1228         16  BD-CC           PIC 99.
  1229         16  BD-YR           PIC 99.
  1230     12  BD-MO               PIC 99.
  1231     12  BD-DA               PIC 99.
  1232
  1233 01  RUN-DT                  PIC 9(11).
  1234 01  RUN-DT-R REDEFINES RUN-DT.
  1235     12  FILLER              PIC 999.
  1236     12  RD-CCYY             PIC 9(04).
  1237     12  RD-CCYR REDEFINES RD-CCYY.
  1238         16  RD-CC           PIC 99.
  1239         16  RD-YR           PIC 99.
  1240     12  RD-MO               PIC 99.
  1241     12  RD-DA               PIC 99.
  1242
  1243 01  WORK-DATE           PIC 9(11).
  1244 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1245     12  FILLER          PIC 999.
  1246     12  WK-CCYY         PIC 9(04).
  1247     12  WK-CCYR REDEFINES WK-CCYY.
  1248         16  WK-CC       PIC 99.
  1249         16  WK-YR       PIC 99.
  1250     12  WK-MO           PIC 99.
  1251     12  WK-DA           PIC 99.
  1252
  1253 01  ZONE-GROUP.
  1254     03  ZON                 PIC XXX       VALUE 'ZON'.
  1255     03  Z-G                 PIC XXX.
  1256
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS043RET.cbl
  1258*
  1259* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1260*
  1261*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1262*    OCCURRENCE 2 = A&H BEGINNING DATA
  1263*    OCCURRENCE 3 = LIFE CURRENT DATA
  1264*    OCCURRENCE 4 = A&H CURRENT DATA
  1265*
  1266 01  DETAIL-ACCUMULATORS     COMP-3.
  1267     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1268         16  DA-ISP          PIC S9(9)V99.
  1269         16  DA-TAX          PIC S9(9)V99.
  1270         16  DA-CNP          PIC S9(9)V99.
  1271         16  DA-UP           PIC S9(9)V99.
  1272         16  DA-CLM          PIC S9(9)V99.
  1273         16  DA-EXP          PIC S9(9)V99.
  1274         16  DA-CPS          PIC S9(9)V99.
  1275         16  DA-OTC          PIC S9(9)V99.
  1276         16  DA-LRV          PIC S9(9)V99.
  1277         16  DA-CAJ          PIC S9(9)V99.
  1278         16  DA-ISC          PIC S9(9)V99.
  1279         16  DA-CNC          PIC S9(9)V99.
  1280         16  DA-UC           PIC S9(9)V99.
  1281         16  DA-ISC-ADDL     PIC S9(9)V99.
  1282         16  DA-CNC-ADDL     PIC S9(9)V99.
  1283         16  DA-UC-ADDL      PIC S9(9)V99.
  1284         16  DA-GA-ISC       PIC S9(9)V99.
  1285         16  DA-GA-CNC       PIC S9(9)V99.
  1286         16  DA-GA-UC        PIC S9(9)V99.
  1287         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1288
  1289 01  TEMP-GA-ACCUMS.
  1290     12  GA-LEVELS.
  1291         16  GA-LEVELS OCCURS 10 TIMES.
  1292             20  XDA-GA-NO       PIC X(10).
  1293             20  XDA-GA-TYPE     PIC X.
  1294             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1295                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1296                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1297                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1298
  1299 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS043RET.cbl
  1301*
  1302* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1303*
  1304*    A SET CONSISTS OF 6 ACCUMULATORS
  1305*
  1306*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1307*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1308*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1309*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1310*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1311*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1312*
  1313*    THERE ARE 6 SETS
  1314*
  1315*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1316*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1317*        SET 3 = LEVEL 3 (STATE TOTALS)
  1318*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1319*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1320*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1321*
  1322 01  PRINT-ACCUMULATORS      COMP-3.
  1323     12  PRINT-ACCUMS    OCCURS 36.
  1324         16  PA-NW           PIC S9(9)V99.
  1325         16  PA-BR           PIC S9(9)V99.
  1326         16  PA-ER           PIC S9(9)V99.
  1327         16  PA-EP           PIC S9(9)V99.
  1328         16  PA-PE           PIC S9(9)V99.
  1329         16  PA-PL           PIC S9(9)V99.
  1330         16  PA-BLR          PIC S9(9)V99.
  1331         16  PA-ELR          PIC S9(9)V99.
  1332         16  PA-TL           PIC S9(9)V99.
  1333         16  PA-RC           PIC S9(9)V99.
  1334         16  PA-OC           PIC S9(9)V99.
  1335         16  PA-TC           PIC S9(9)V99.
  1336         16  PA-CP           PIC S9(9)V99.
  1337         16  PA-EX           PIC S9(9)V99.
  1338         16  PA-TE           PIC S9(9)V99.
  1339         16  PA-BA           PIC S9(9)V99.
  1340         16  PA-NTE          PIC S9(9)V99.
  1341         16  PA-NBA          PIC S9(9)V99.
  1342         16  PA-EC           PIC S9(9)V99.
  1343         16  PA-GARC         PIC S9(9)V99.
  1344         16  PA-GAEC         PIC S9(9)V99.
  1345         16  PA-GACU         PIC S9(9)V99.
  1346         16  PA-CU           PIC S9(9)V99.
  1347         16  PA-GATC         PIC S9(9)V99.
  1348         16  PA-GAGT         PIC S9(9)V99.
  1349         16  PA-GABA         PIC S9(9)V99.
  1350         16  PA-GATE         PIC S9(9)V99.
  1351         16  PA-TAXP         PIC S9(9)V99.
  1352         16  PA-TAXE         PIC S9(9)V99.
  1353         16  PA-ACCT-COMMP   PIC S9(9)V99.
  1354         16  PA-ACCT-COMME   PIC S9(9)V99.
  1355         16  PA-OW-COMMP     PIC S9(9)V99.
  1356         16  PA-OW-COMME     PIC S9(9)V99.
  1357 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1358     12  PRINT-ACCUMS-R  OCCURS 6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS043RET.cbl
  1359         16  PRINT-ACCUMS-SL OCCURS 6.
  1360*00403              20  PRINT-ACCUMS-L OCCURS 27.
  1361             20  PRINT-ACCUMS-L OCCURS 33.
  1362                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS043RET.cbl
  1364
  1365*
  1366* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1367*    TO BE PRINTED ON THE RETRO
  1368*
  1369 01  PERCENT-ACCUMULATORS    COMP-3.
  1370     12  PER-ACCUMS      OCCURS 2.
  1371       14  PER-ACCUMS-X   OCCURS 27.
  1372         16  PT-PRCNT        PIC S9(4)V9(4).
  1373
  1374 01  DESC-TABLE.
  1375     12  FILLER              PIC X(33)   VALUE
  1376             '1. NET WRITTEN PREMIUM      00101'.
  1377     12  FILLER              PIC X(33)   VALUE
  1378             '2. PLUS BEGINNING RESERVE   00202'.
  1379     12  FILLER              PIC X(33)   VALUE
  1380             '3. LESS ENDING RESERVE      00303'.
  1381     12  FILLER              PIC X(33)   VALUE
  1382             '4. EARNED PREMIUM           00404'.
  1383     12  FILLER              PIC X(33)   VALUE
  1384             '5. PERCENT OF EARNED PREMIUM00505'.
  1385     12  FILLER              PIC X(33)   VALUE
  1386             '6. EXPENSES                 -0000'.
  1387     12  FILLER              PIC X(33)   VALUE
  1388             ' A. LOSSES                  00000'.
  1389     12  FILLER              PIC X(33)   VALUE
  1390             '  1. PAID                    0606'.
  1391     12  FILLER              PIC X(33)   VALUE
  1392             '  2. LESS BEG. LOSS RESERVE  0707'.
  1393     12  FILLER              PIC X(33)   VALUE
  1394             '  3. PLUS END. LOSS RESERVE  0808'.
  1395     12  FILLER              PIC X(33)   VALUE
  1396             '  4. TOTAL                   0909'.
  1397     12  FILLER              PIC X(33)   VALUE
  1398             ' B. COMMISSIONS             00000'.
  1399     12  FILLER              PIC X(33)   VALUE
  1400             '  1. RETAINED                2323'.
  1401     12  FILLER              PIC X(33)   VALUE
  1402             '  2. OTHER COMMISSION PAID   1111'.
  1403     12  FILLER              PIC X(33)   VALUE
  1404             '  3. OVERWRITE                 22'.
  1405     12  FILLER              PIC X(33)   VALUE
  1406             '  3. TOTAL                   12  '.
  1407     12  FILLER              PIC X(33)   VALUE
  1408             '  4. TOTAL                     24'.
  1409     12  WS-EX-LINE          PIC X(33)   VALUE
  1410             ' C. OTHER EXPENSE           01414'.
  1411     12  FILLER              PIC X(33)   VALUE
  1412             '7. TOTAL EXPENSE            01727'.
  1413     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1414             '8. BALANCE AT END OF PERIOD 01826'.
  1415     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1416             '   (LINE 5 MINUS LINE 7)     0000'.
  1417     12  FILLER              PIC X(33)   VALUE
  1418             '9. ACCOUNT BALANCES         0  18'.
  1419     12  FILLER              PIC X(33)   VALUE
  1420             '9. EXPERIENCE REFUND PRV PD 013  '.
  1421     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS043RET.cbl
  1422             '10. EXPERIENCE REFUND PRV PD0  13'.
  1423     12  FILLER              PIC X(33)   VALUE
  1424             '10. NET BALANCE OR LOSS     -16  '.
  1425     12  FILLER              PIC X(33)   VALUE
  1426             '11. NET BALANCE OR LOSS     -  25'.
  1427     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1428 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1429     12  DT-TB-ENT   OCCURS 27.
  1430         16  DT-ENTRY    PIC X(28).
  1431         16  DT-CTL-CHAR PIC X.
  1432         16  DT-SUBSCR   OCCURS 2.
  1433             20  DT-SS-R.
  1434                 24  DT-SS   PIC 99.
  1435
  1436 01  DESC-TABLE-DESCRIPTIONS.
  1437     12  EXPENSE-LINE        PIC X(33)   VALUE
  1438             ' C. TAXES AND OTHER EXPENSES01414'.
  1439     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1440             '8. BALANCE AT END OF PERIOD 01826'.
  1441     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1442             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS043RET.cbl
  1444
  1445 01  HEAD-1.
  1446     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1447     12  FILLER          PIC X(21)   VALUE SPACES.
  1448     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1449     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1450     12  FILLER          PIC X(38)   VALUE SPACES.
  1451     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1452     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1453
  1454 01  HEAD-2.
  1455     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1456     12  FILLER          PIC X(21)   VALUE SPACES.
  1457     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1458     12  FILLER          PIC X(38)   VALUE SPACES.
  1459     12  HD-RD           PIC X(8)    VALUE SPACES.
  1460
  1461 01  HEAD-3.
  1462     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1463     12  FILLER          PIC X       VALUE SPACES.
  1464     12  H3-ZIP.
  1465         16  H3-ZIP-PRIME
  1466                         PIC X(5).
  1467         16  H3-DASH     PIC X.
  1468         16  H3-ZIP-PLUS4
  1469                         PIC X(4).
  1470     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1471         16  H3-CAN-POSTAL-CODE-1
  1472                         PIC X(3).
  1473         16  H3-DASH-CAN PIC X.
  1474         16  H3-CAN-POSTAL-CODE-2
  1475                         PIC X(3).
  1476         16  H3-CAN-FILLER
  1477                         PIC X(3).
  1478     12  FILLER          PIC X(26)   VALUE SPACES.
  1479     12  HD-AD           PIC X(18)   VALUE SPACES.
  1480     12  FILLER          PIC X(44)   VALUE SPACES.
  1481     12  FILLER          PIC X(05)   VALUE
  1482         'PAGE '.
  1483     12  H3-PAGE         PIC ZZZZ9.
  1484
  1485 01  HEAD-4.
  1486     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1487     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1488     12  FILLER          PIC X(5)    VALUE SPACES.
  1489     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1490
  1491 01  HEAD-5.
  1492     12  H5-CARR         PIC X       VALUE SPACES.
  1493     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1494     12  FILLER          PIC X       VALUE SPACES.
  1495     12  H5-ST           PIC XX      VALUE SPACES.
  1496     12  FILLER          PIC X       VALUE SPACES.
  1497     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1498     12  FILLER          PIC X       VALUE SPACES.
  1499     12  H5-FMO          PIC XX      VALUE SPACES.
  1500     12  H5-FS1          PIC X       VALUE '-'.
  1501     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS043RET.cbl
  1502     12  H5-FS2          PIC X       VALUE '-'.
  1503     12  H5-FYR          PIC XX      VALUE SPACES.
  1504     12  FILLER          PIC X       VALUE SPACES.
  1505     12  H5-TMO          PIC XX      VALUE SPACES.
  1506     12  H5-TS1          PIC X       VALUE '-'.
  1507     12  H5-TDA          PIC XX      VALUE SPACES.
  1508     12  H5-TS2          PIC X       VALUE '-'.
  1509     12  H5-TYR          PIC XX      VALUE SPACES.
  1510     12  FILLER          PIC X(4)    VALUE SPACES.
  1511     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1512     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1513     12  END-CHARACTER   PIC X       VALUE ' '.
  1514
  1515 01  HEAD-6.
  1516     12  FILLER          PIC X(15)   VALUE '***************'.
  1517     12  H6-YTD-HD.
  1518         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1519         14  H6-MTHS     PIC Z9.
  1520         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1521     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1522         16  H6R-FILLER  PIC X.
  1523         16  H6R-MO      PIC XX.
  1524         16  H6R-DASH1   PIC X.
  1525         16  H6R-DA      PIC XX.
  1526         16  H6R-DASH2   PIC X.
  1527         16  H6R-CCYY    PIC X(4).
  1528         16  H6R-MSG     PIC X(9).
  1529     12  FILLER          PIC X(15)   VALUE '***************'.
  1530     12  FILLER          PIC X(29)   VALUE SPACES.
  1531     12  FILLER          PIC X(16)   VALUE '****************'.
  1532     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1533     12  FILLER          PIC X(16)   VALUE '****************'.
  1534
  1535 01  HEAD-7.
  1536     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1537     12  FILLER          PIC X(1)    VALUE SPACES.
  1538     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1539     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1540     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1541     12  FILLER          PIC X(20)   VALUE '                    '.
  1542     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1543     12  FILLER          PIC X       VALUE SPACES.
  1544     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1545     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1546     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1547
  1548 01  HEAD-8-STATE.
  1549     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1550     12  H8-ST           PIC XX      VALUE SPACES.
  1551     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1552
  1553 01  HEAD-8-COMP.
  1554     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1555     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1556     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1557
  1558 01  HEAD-8-CARR.
  1559     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS043RET.cbl
  1560     12  H8-CARR         PIC X       VALUE SPACES.
  1561     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1562
  1563 01  HEAD-8-GROUP.
  1564     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1565     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1566     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1567
  1568 01  HEAD-8-GA.
  1569     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1570     12  H8-GA           PIC X(10)   VALUE SPACES.
  1571     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1572
  1573 01  HEAD-8-FINAL.
  1574     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1575
  1576*01  HEAD-9.
  1577*    12  FILLER          PIC X(127)  VALUE SPACES.
  1578*    12  H9-PAGE         PIC ZZZZ9.
  1579
  1580 01  DETAIL-LINE.
  1581     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1582     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1583     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1584     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1585     12  FILLER          PIC X.
  1586     12  DL-DESC         PIC X(28).
  1587     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1588     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1589     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1590     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1591
* 1592                                    COPY ELCDATE.
  1593******************************************************************06/11/98
  1594*                                                                *ELCDATE
  1595*                                                                *ELCDATE
  1596*                            ELCDATE.                            *   LV023
  1597*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1598*                            VMOD=2.003                           ELCDATE
  1599*                                                                *ELCDATE
  1600*                                                                *ELCDATE
  1601*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1602*                 LENGTH = 200                                   *   CL*19
  1603******************************************************************ELCDATE
  1604                                                                  ELCDATE
  1605 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1606     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1607     12  DC-OPTION-CODE                PIC X.                        CL*15
  1608         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1609         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1610         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1611         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1612         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1613         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1614         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1615         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1616         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1617         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1618         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1619         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1620         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1621         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1622         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1623         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1624         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1625         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1626         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1627         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1628         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1629         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1630         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1631         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1632         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1633         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1634         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1635         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1636         88  THREE-CHARACTER-BIN                                  ELCDATE
  1637                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1638         88  GREGORIAN-TO-BIN                                        CL**2
  1639                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1640         88  BIN-TO-GREGORIAN                                        CL**2
  1641                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1642         88  JULIAN-TO-BINARY                                        CL**2
  1643                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1644     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1645         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1646         88  DATE-CONVERSION-ERROR                                ELCDATE
  1647                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1648         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1649         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1650         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1651         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1652         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1653         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1654         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1655         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1656         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1657         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1658     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1659         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1660     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1661         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1662         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1663         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1664     12  FILLER                        PIC X.                        CL*15
  1665     12  DC-CONVERSION-DATES.                                        CL*15
  1666         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1667         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1668         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1669         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1670                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1671             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1672             20  SLASH1-1              PIC X.                        CL*15
  1673             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1674             20  SLASH1-2              PIC X.                        CL*15
  1675             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1676         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1677         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1678                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1679             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1680             20  SLASH2-1              PIC X.                        CL*15
  1681             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1682             20  SLASH2-2              PIC X.                        CL*15
  1683             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1684         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1685         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1686                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1687             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1688             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1689             20  DC-YMD-DAY            PIC 99.                       CL*15
  1690         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1691         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1692                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1693             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1694             20  DC-MDY-DAY            PIC 99.                       CL*15
  1695             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1696         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1697             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1698             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1699             20  FILLER                PIC XX.                       CL*15
  1700             20  DC-ALPHA-CENTURY.                                   CL*15
  1701                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1702             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1703         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1704         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1705         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1706         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1707         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1708                                       PIC 9(05).                    CL*20
  1709         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1710             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1711             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1712         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1713         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1714         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1715     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1716         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1717         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1718             20  FILLER                PIC 9(3).                     CL*15
  1719             20  HOLD-CEN-1-CCYY.                                    CL*15
  1720                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1721                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1722             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1723             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1724         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1725             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1726             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1727             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1728                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1729                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1730             20  FILLER                PIC 9(3).                     CL*15
  1731         16  HOLD-CENTURY-1-X.                                       CL*15
  1732             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1733             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1734                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1735                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1736             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1737             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1738         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1739             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1740             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1741             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1742                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1743                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1744             20  FILLER                PIC XXX.                      CL*23
  1745         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1746         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1747         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1748         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1749             20  DC-JULIAN-1-CCYY.                                   CL*15
  1750                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1751                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1752             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1753         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1754         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1755             20  DC-JULIAN-2-CCYY.                                   CL*15
  1756                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1757                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1758             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1759         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1760             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1761             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1762             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1763             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1764             20  DC-EDITA-CCYY.                                      CL*15
  1765                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1766                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1767         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1768             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1769             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1770             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1771             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1772             20  DC-EDITB-CCYY.                                      CL*15
  1773                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1774                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1775         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1776         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1777                              DC-GREG-DATE-CYMD.                  ELCDATE
  1778             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1779             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1780             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1781             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1782         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1783         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1784                              DC-GREG-DATE-MDCY.                  ELCDATE
  1785             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1786             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1787             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1788             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1789    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1790        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1791    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS043RET.cbl
  1792    12  FILLER                         PIC X(28).                    CL*26
  1793
* 1794                                    COPY ELCDTECX.
  1795******************************************************************06/05/98
  1796*                                                                *ELCDTECX
  1797*                            ELCDTECX.                           *   LV005
  1798*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1799*                            VMOD=2.015                          *ELCDTECX
  1800*                                                                *ELCDTECX
  1801*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1802*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1803*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1804*                                                                *ELCDTECX
  1805******************************************************************ELCDTECX
  1806******************************************************************
  1807*                   C H A N G E   L O G
  1808*
  1809* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1810*-----------------------------------------------------------------
  1811*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1812* EFFECTIVE    NUMBER
  1813*-----------------------------------------------------------------
  1814* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1815*                                  BENEFIT CODES FROM 300 TO 900
  1816* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1817* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1818* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1819******************************************************************
  1820 01  DATE-CARD.                                                   ELCDTECX
  1821     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1822     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1823     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1824     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1825     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1826     12  EP-SW                       PIC  X.                      ELCDTECX
  1827         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1828     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1829         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1830     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1831     12  RUN-CENTURY.                                             ELCDTECX
  1832         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1833     12  FILLER                      PIC  X.                         CL**4
  1834     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1835     12  FILLER                      PIC  XXX.                    ELCDTECX
  1836     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1837                                                                  ELCDTECX
  1838 01  FILLER                          PIC  X(7)                       CL**6
  1839                                          VALUE 'OPTIONS'.        ELCDTECX
  1840 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1841     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1842     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1843     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1844         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1845         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1846     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1847     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1848     12  FILLER                      PIC  X.                      ELCDTECX
  1849     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1850     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1851     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1852     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1853     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1854     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1855     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1856     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1857     12  FILLER                      PIC  X.                      ELCDTECX
  1858     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1859     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1860     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1861     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1862     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1863     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1864     12  FILLER                      PIC  X.                      ELCDTECX
  1865     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1866     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1867     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1868     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1869     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1870     12  DTE-R78                     PIC  X.                      ELCDTECX
  1871     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1872     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1873     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1874     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1875     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1876     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1877     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1878                                     PIC  X.                      ELCDTECX
  1879         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1880                                                 ' '.             ELCDTECX
  1881         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1882         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1883     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1884         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1885         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1886     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1887     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1888                                     PIC  9.                         CL**4
  1889     12  DTE-SYSTEM.                                              ELCDTECX
  1890         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1891         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1892         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1893         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1894         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1895         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1896         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1897         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1898         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1899         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1900         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1901         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1902         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1903         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1904         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1905         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1906         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1907         16  DTE-SYS-R               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1908         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1909         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1910         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1911         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1912         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1913         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1914         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1915         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1916     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1917         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1918                                     PIC  X.                      ELCDTECX
  1919     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1920                                                                  ELCDTECX
  1921 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1922     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1923     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1924     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1925*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1926     12  FILLER                      PIC  X.                      ELCDTECX
  1927     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1928     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1929     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1930     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1931     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1932     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1933     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1934                                                                  ELCDTECX
  1935     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1936     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1937     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1938     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1939                                                                  ELCDTECX
  1940     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1941     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1942     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1943     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1944                                                                  ELCDTECX
  1945     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1946     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1947                                                                  ELCDTECX
  1948     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1949     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1950                                                                  ELCDTECX
  1951     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1952                                                                  ELCDTECX
  1953 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1954     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1955     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1956     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1957     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1958     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1959     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1960     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1961                                                                  ELCDTECX
  1962 01  FILLER                          PIC  X(12)                   ELCDTECX
  1963                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1964 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1965     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1966         16  CNT-ID                  PIC  X.                      ELCDTECX
  1967         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1968                                                                  ELCDTECX
  1969 01  FILLER                          PIC  X(11)                   ELCDTECX
  1970                                          VALUE 'STATE NAMES'.    ELCDTECX
  1971 01  STATE-NAMES.                                                 ELCDTECX
  1972     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1973         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1974         16  STATE-PIC1.                                          ELCDTECX
  1975             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1976             20  FILLER              PIC  XXX.                    ELCDTECX
  1977             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1978             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1979             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1980             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1981                                                                  ELCDTECX
  1982 01  FILLER                          PIC  X(13)                   ELCDTECX
  1983                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1984 01  CARRIER-NAMES.                                               ELCDTECX
  1985     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1986         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1987         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1988         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1989         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1990         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1991         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1992*        16  FILLER                  PIC  X.                      ELCDTECX
  1993         16  CARRIER-SEC-PAY         PIC  X.
  1994             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1995                                                                  ELCDTECX
  1996 01  FILLER                          PIC  X(9)                       CL**6
  1997                                          VALUE 'INS TYPES'.      ELCDTECX
  1998 01  CLAS-INS-TYPES.                                              ELCDTECX
  1999*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2000     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2001         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2002         16  CLAS-I-AB3.                                          ELCDTECX
  2003             20  FILLER              PIC  X.                      ELCDTECX
  2004             20  CLAS-I-AB2.                                      ELCDTECX
  2005                 24  FILLER          PIC  X.                      ELCDTECX
  2006                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2007         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2008             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2009             20  FILLER              PIC  X.                         CL**4
  2010         16  CLAS-I-AB10.                                         ELCDTECX
  2011             20  FILLER              PIC  X(9).                   ELCDTECX
  2012             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2013         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2014         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2015         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2016         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2017             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2018         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2019         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2020         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2021         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2022         16  CLAS-I-REFUND-METHOD    PIC  X.
  2023         16  CLAS-I-MAX-BENEFITS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2024         16  FILLER                  PIC  XXX.
  2025                                                                  ELCDTECX
  2026 01  FILLER                          PIC  X(16)                   ELCDTECX
  2027                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2028 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2029     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2030                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2031         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2032         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2033         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2034         16  CLAS-MORT-DESC.                                      ELCDTECX
  2035             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2036             20  FILLER              PIC  XX.                        CL**5
  2037             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2038             20  FILLER              PIC  X.                         CL**5
  2039             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2040             20  FILLER              PIC  X.                         CL**5
  2041             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2042             20  FILLER              PIC  X.                         CL**5
  2043             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2044             20  FILLER              PIC  X(5).                      CL**6
  2045                                                                  ELCDTECX
  2046 01  FILLER                          PIC  X(15)                   ELCDTECX
  2047                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2048 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2049     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2050         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2051         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2052         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2053         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2054         16  FILLER                  PIC  X(4).                      CL**6
  2055                                                                  ELCDTECX
  2056 01  FILLER                          PIC  X(7)                       CL**6
  2057                                     VALUE 'INDEXES'.             ELCDTECX
  2058 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2059     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2060     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2061     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2062     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2063     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2064     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2065     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2066     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2067     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2068     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2069     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2070     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2071     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2072     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2073     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2074     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2075     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2076                                                                  ELCDTECX
  2077 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2078     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2079     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2080     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2081     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2082     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2083     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2084     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2085     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2086     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2087     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2088     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2089                                                                  ELCDTECX
  2090 01  FILLER                          PIC  X(13)                   ELCDTECX
  2091                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2092 01  CLAS-MISC.                                                   ELCDTECX
  2093     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2094         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2095         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2096         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2097     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2098     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2099     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2100     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2101     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2102     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2103     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2104     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2105     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2106     12  STATE-L                     PIC  XX.                     ELCDTECX
  2107     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2108     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2109     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2110         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2111         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2112     12  DTE-ABEND-WORK.                                          ELCDTECX
  2113         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2114         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2115                                                                  ELCDTECX
  2116 01  FILLER                          PIC  X(12)                   ELCDTECX
  2117                                     VALUE 'WORKING DATE'.        ELCDTECX
  2118 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2119     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2120         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2121         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2122         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2123     12  WS-CURRENT-DATE.                                         ELCDTECX
  2124         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2125         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2126         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2127         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2128         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2129     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2130         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2131         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2132                                                                  ELCDTECX
  2133 01  FILLER                          PIC  X(12)                   ELCDTECX
  2134                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2135 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2136     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2137         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2138         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2139         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2140                                                                  ELCDTECX
  2141 01  FILLER                          PIC  X(10)                   ELCDTECX
  2142                                     VALUE 'STATE TLRS'.          ELCDTECX
  2143 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2144     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2145         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2146         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2147                                                                  ELCDTECX
  2148 01  FILLER                          PIC  X(13)                   ELCDTECX
  2149                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2150 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2151     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2152         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2153                                                                  ELCDTECX
  2154 01  FILLER                          PIC  X(13)                   ELCDTECX
  2155                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2156 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2157     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2158     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2159     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2160                                     PIC  X.                         CL**5
  2161     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2162     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2163     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2164     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2165     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2166     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2167     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2168     12  FILLER                      PIC  X(75).                  ELCDTECX
  2169******************************************************************ELCDTECX
  2170*01  MISC-CARR-PCT-DATA.                                          00001521
  2171*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2172*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2173*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2174*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2175*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2176*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2177******************************************************************ELCDTECX
  2178
* 2179                                    COPY ELCDTEVR.
  2180***************************************************************** 04/15/98
  2181*                                                                *ELCDTEVR
  2182*                                                                *ELCDTEVR
  2183*                            ELCDTEVR.                           *   LV003
  2184*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2185*                            VMOD=2.001                          *   CL**2
  2186*                                                                *ELCDTEVR
  2187*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2188*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2189*                                                                *ELCDTEVR
  2190******************************************************************ELCDTEVR
  2191 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2192     05  WS-RUN-DATE.                                             ELCDTEVR
  2193         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2194         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2195         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2196             15  RUN-CC              PIC  99.                     ELCDTEVR
  2197             15  RUN-YR              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2198         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2199         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2200     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2201            WS-RUN-DATE              PIC 9(11).                      CL**2
  2202     05  WS-EP-DT.                                                ELCDTEVR
  2203         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2204         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2205         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2206             15  EP-CC               PIC  99.                     ELCDTEVR
  2207             15  EP-YR               PIC  99.                     ELCDTEVR
  2208         10  EP-MO                   PIC  99.                     ELCDTEVR
  2209         10  EP-DA                   PIC  99.                     ELCDTEVR
  2210     05  WS-EP-DT-N REDEFINES                                        CL**2
  2211            WS-EP-DT                 PIC 9(11).                      CL**2
  2212     05  WS-DTE-CONV-DT.                                             CL**4
  2213         10  FILLER                  PIC  9(03).                     CL**4
  2214         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2215         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2216             15  DTE-CONV-CC         PIC  99.                        CL**4
  2217             15  DTE-CONV-YR         PIC  99.                        CL**4
  2218         10  DTE-CONV-MO             PIC  99.                        CL**4
  2219         10  DTE-CONV-DA             PIC  99.                        CL**4
  2220     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2221            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2222 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2223     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2224         10  FILLER                            PIC 999.           ELCDTEVR
  2225         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2226         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2227             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2228             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2229         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2230         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2231     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2232            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2233     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2234         10  FILLER                            PIC 999.           ELCDTEVR
  2235         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2236         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2237         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2238         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2239     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2240            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2241 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2242     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2243         10  FILLER                            PIC 999.           ELCDTEVR
  2244         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2245         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2246             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2247             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2248         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2249         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2250     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2251            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2252     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2253         10  FILLER                            PIC 999.           ELCDTEVR
  2254         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2255         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2256             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2257             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2258         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2259         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2260     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2261            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2262     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2263         10  FILLER                            PIC 999.           ELCDTEVR
  2264         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2265         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2266             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2267             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2268         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2269         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2270     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2271            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2272 01  WS-RATE-RECORD.                                              ELCDTEVR
  2273         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2274             10  FILLER                        PIC 999.           ELCDTEVR
  2275             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2276             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2277                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2278                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2279             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2280             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2281         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2282                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2283
* 2284                                    COPY ELCACCTV.
  2285******************************************************************04/14/98
  2286*                                                                *ELCACCTV
  2287*                            ELCACCTV                            *   LV002
  2288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2289*                            VMOD=2.001                          *ELCACCTV
  2290*                                                                *ELCACCTV
  2291*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2292*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2293*                                                                *ELCACCTV
  2294*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2295*                                                                *ELCACCTV
  2296******************************************************************ELCACCTV
  2297                                                                  ELCACCTV
  2298 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2299                                                                  ELCACCTV
  2300     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2301         10  FILLER            PIC 999.                           ELCACCTV
  2302         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2303         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2304             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2305             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2306         10  AM-EXP-MO         PIC 99.                               CL**5
  2307         10  AM-EXP-DA         PIC 99.                               CL**5
  2308     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2309            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2310     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2311         10  FILLER                    PIC 999.                   ELCACCTV
  2312         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2313         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2314             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2315             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  2316         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2317         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2318     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2319            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2320     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2321         10  FILLER                    PIC 999.                   ELCACCTV
  2322         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2323         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2324             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2325             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2326         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2327         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2328     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2329            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2330     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2331         10 FILLER                     PIC 999.                   ELCACCTV
  2332         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2333         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2334            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2335            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2336         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2337         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2338     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2339            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2340     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2341         10 FILLER                     PIC 999.                   ELCACCTV
  2342         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2343         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2344            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2345            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2346         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2347         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2348     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2349            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2350     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2351         10  FILLER                    PIC 999.                   ELCACCTV
  2352         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2353         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2354             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2355             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2356         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2357         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2358     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2359            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2360     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2361         10  FILLER                    PIC 999.                   ELCACCTV
  2362         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2363         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2364             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2365             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2366         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2367         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2368     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2369            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2370     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2371         10  FILLER                    PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2372         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2373         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  2374             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2375             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2376         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2377         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2378     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2379            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2380     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2381         10  FILLER                    PIC 999.                   ELCACCTV
  2382         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2383         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2384             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2385             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2386         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2387         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2388     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2389            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2390
* 2391                                    COPY ELCEPCVR.
  2392******************************************************************05/15/98
  2393*                                                                *ELCEPCVR
  2394*                                                                *ELCEPCVR
  2395*                            ELCEPCVR                            *   LV003
  2396*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2397*                            VMOD=2.001                          *ELCEPCVR
  2398*                                                                *ELCEPCVR
  2399*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2400*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2401*                                                                *ELCEPCVR
  2402******************************************************************ELCEPCVR
  2403 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2404     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2405         10  FILLER            PIC 999.                           ELCEPCVR
  2406         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2407         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2408             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2409             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2410         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2411         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2412     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2413            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2414     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2415         10  FILLER            PIC 999.                              CL**5
  2416         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2417         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2418             15  EC-EXP-CC     PIC 99.                               CL**5
  2419             15  EC-EXP-YR     PIC 99.                               CL**5
  2420         10  EC-EXP-MO         PIC 99.                               CL**5
  2421         10  EC-EXP-DA         PIC 99.                               CL**5
  2422     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2423            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2424     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2425         10  FILLER            PIC 999.                           ELCEPCVR
  2426         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2427         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2428             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2429             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2430         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2431         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2432     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2433            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2434     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2435         10  FILLER            PIC 999.                              CL**5
  2436         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2437         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2438             15  EC-EFF-CC     PIC 99.                               CL**5
  2439             15  EC-EFF-YR     PIC 99.                               CL**5
  2440         10  EC-EFF-MO         PIC 99.                               CL**5
  2441         10  EC-EFF-DA         PIC 99.                               CL**5
  2442     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2443            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2444     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2445         10  FILLER            PIC 999.                           ELCEPCVR
  2446         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2447         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2448             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2449             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2450         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2451         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2452     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2453            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2454     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2455         10  FILLER            PIC 999.                           ELCEPCVR
  2456         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2457         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2458             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2459             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2460         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2461         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2462     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2463            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2464     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2465         10  FILLER            PIC 999.                           ELCEPCVR
  2466         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2467         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2468             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2469             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2470         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2471         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2472     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2473            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2474     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2475         10  FILLER            PIC 999.                           ELCEPCVR
  2476         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2477         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2478             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2479             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2480         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2481         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2482     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2483            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2484     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2485         10  FILLER            PIC 999.                           ELCEPCVR
  2486         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2487         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS043RET.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2488             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2489             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2490         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2491         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2492     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2493            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2494
  2495
  2496 01  DATA-OUT-RECORD.
  2497     05  DO-ME-DATE.
  2498         10  DO-ME-MO         PIC 9(2).
  2499         10  FILLER           PIC X(1)  VALUE '/'.
  2500         10  DO-ME-DD         PIC 9(2).
  2501         10  FILLER           PIC X(1)  VALUE '/'.
  2502         10  DO-ME-YR         PIC 9(4).
  2503     05  DO-CARRIER           PIC X(1).
  2504     05  DO-COMP              PIC X(6).
  2505     05  DO-STATE             PIC X(2).
  2506     05  DO-ACCOUNT-NUM       PIC X(10).
  2507     05  DO-GROUP             PIC X(10).
  2508     05  DO-EXP-DATE.
  2509         10  DO-EXP-MO        PIC 9(2).
  2510         10  FILLER           PIC X(1)  VALUE '/'.
  2511         10  DO-EXP-DD        PIC 9(2).
  2512         10  FILLER           PIC X(1)  VALUE '/'.
  2513         10  DO-EXP-YR        PIC 9(4).
  2514     05  DO-EFF-DATE.
  2515         10  DO-EFF-MO        PIC 9(2).
  2516         10  FILLER           PIC X(1)  VALUE '/'.
  2517         10  DO-EFF-DD        PIC 9(2).
  2518         10  FILLER           PIC X(1)  VALUE '/'.
  2519         10  DO-EFF-YR        PIC 9(4).
  2520     05  DO-ACCOUNT-NAME      PIC X(30).
  2521     05  DO-PERIOD            PIC X(3).
  2522     05  DO-ACCUMULATORS OCCURS 9 TIMES.
  2523         10  DO-DESCR         PIC X(28).
  2524         10  DO-PERLFP        PIC -(11).99.
  2525         10  DO-PERLFE        PIC -(11).99.
  2526         10  DO-ITDLFP        PIC -(11).99.
  2527         10  DO-ITDLFE        PIC -(11).99.
  2528         10  DO-PERAHP        PIC -(11).99.
  2529         10  DO-PERAHE        PIC -(11).99.
  2530         10  DO-ITDAHP        PIC -(11).99.
  2531         10  DO-ITDAHE        PIC -(11).99.
  2532     05  DO-PREM-P-E          PIC X(1).
  2533     05  DO-CLAIM-P-I         PIC X(1).
  2534     05  DO-RETRO-Y-N         PIC X(1).
  2535     05  DO-RETRO-P-E         PIC X(1).
  2536     05  DO-TAX-P-E           PIC X(1).
  2537     05  DO-PER-LF-RETRO-PMT  PIC -(11).99.
  2538     05  DO-ITD-LF-RETRO-PMT  PIC -(11).99.
  2539     05  DO-PER-AH-RETRO-PMT  PIC -(11).99.
  2540     05  DO-ITD-AH-RETRO-PMT  PIC -(11).99.
  2541
  2542 01  DATA-OUT-SELECTIONS.
  2543     05  DO-SUBSCRIPTS.
  2544         10 DO-SUB-1        PIC X(3) VALUE '001'.
  2545         10 DO-SUB-2        PIC X(3) VALUE '002'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS043RET.cbl
  2546         10 DO-SUB-3        PIC X(3) VALUE '003'.
  2547         10 DO-SUB-4        PIC X(3) VALUE '004'.
  2548         10 DO-SUB-5        PIC X(3) VALUE '005'.
  2549         10 DO-SUB-6        PIC X(3) VALUE '000'.
  2550         10 DO-SUB-7        PIC X(3) VALUE '000'.
  2551         10 DO-SUB-8        PIC X(3) VALUE '006'.
  2552         10 DO-SUB-9        PIC X(3) VALUE '007'.
  2553         10 DO-SUB-10       PIC X(3) VALUE '008'.
  2554         10 DO-SUB-11       PIC X(3) VALUE '009'.
  2555         10 DO-SUB-12       PIC X(3) VALUE '000'.
  2556         10 DO-SUB-13       PIC X(3) VALUE '010'.
  2557         10 DO-SUB-14       PIC X(3) VALUE '011'.
  2558         10 DO-SUB-15       PIC X(3) VALUE '000'.
  2559         10 DO-SUB-16       PIC X(3) VALUE '012'.
  2560         10 DO-SUB-17       PIC X(3) VALUE '000'.
  2561         10 DO-SUB-18       PIC X(3) VALUE '013'.
  2562         10 DO-SUB-19       PIC X(3) VALUE '014'.
  2563         10 DO-SUB-20       PIC X(3) VALUE '015'.
  2564         10 DO-SUB-21       PIC X(3) VALUE '000'.
  2565         10 DO-SUB-22       PIC X(3) VALUE '000'.
  2566         10 DO-SUB-23       PIC X(3) VALUE '016'.
  2567         10 DO-SUB-24       PIC X(3) VALUE '000'.
  2568         10 DO-SUB-25       PIC X(3) VALUE '017'.
  2569         10 DO-SUB-26       PIC X(3) VALUE '000'.
  2570         10 DO-SUB-27       PIC X(3) VALUE '000'.
  2571     05  DO-SELECT-SUBSCRIPT REDEFINES DO-SUBSCRIPTS
  2572             OCCURS 27 TIMES.
  2573         10 DO-OUT-SUBSCRIPT        PIC 9(3).
  2574
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS043RET.cbl
  2576 PROCEDURE DIVISION.
  2577 0100-READ-DATE-CARD.
* 2578                             COPY ELCDTERX SUPPRESS.
  2894
  2895     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2896                                   HEAD-7-PLUG-3.
  2897     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2898                                   HEAD-7-PLUG-4.
  2899     MOVE WS-CURRENT-DATE TO HD-RD.
  2900     MOVE ALPH-DATE       TO HD-AD.
  2901     MOVE COMPANY-NAME    TO HD-COMP.
  2902
  2903     MOVE LOW-VALUES      TO END-CHARACTER.
  2904
  2905     MOVE RUN-DATE        TO RUN-DT
  2906                             BEG-DATE.
  2907
  2908     OPEN INPUT CONTROL-CARD.
  2909
  2910     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2911          AT END   MOVE '1' TO FC-CODE
  2912                   GO TO 0130-BUILD-SELECT-DATES.
  2913
  2914 0110-READ-CARD-LOOP.
  2915     IF FC-ID = 'RF'
  2916         IF FC-CLIENT = DTE-CLIENT
  2917             GO TO 0120-FLUSH-REMAINING-CARDS.
  2918
  2919     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2920          AT END   MOVE '1' TO FC-CODE
  2921                   GO TO 0130-BUILD-SELECT-DATES.
  2922
  2923     GO TO 0110-READ-CARD-LOOP.
  2924
  2925 0120-FLUSH-REMAINING-CARDS.
  2926     READ CONTROL-CARD
  2927            AT END GO TO 0130-BUILD-SELECT-DATES.
  2928
  2929     GO TO 0120-FLUSH-REMAINING-CARDS.
  2930
  2931 0130-BUILD-SELECT-DATES.
  2932     IF DTE-PGM-OPT = '5' OR '7'
  2933        MOVE 'RF'       TO FC-ID
  2934        MOVE DTE-CLIENT TO FC-CLIENT
  2935        MOVE '5'        TO FC-CODE
  2936        MOVE RUN-DATE   TO FC-DATE.
  2937
  2938     IF FC-CODE = ' '
  2939       IF FC-DATE NOT NUMERIC  OR
  2940          FC-DATE = ZEROS
  2941          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  2942          GO TO ABEND-PGM.
  2943
  2944     IF FC-CODE = ' '
  2945         MOVE FC-DATE   TO BEG-DATE
  2946         MOVE FC-MM     TO W-MM
  2947         MOVE FC-DD     TO W-DD
  2948         MOVE FC-CCYY   TO W-CCYY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS043RET.cbl
  2949         MOVE WORK-MSG  TO H6-YTD-HD
  2950         GO TO 0140-SORT-CONTROL.
  2951
  2952     IF DTE-PGM-OPT = '5'
  2953         MOVE FC-DATE   TO BEG-DATE.
  2954
  2955     IF FC-CODE = ('1' OR '5')
  2956         SUBTRACT 1 FROM BD-CCYY
  2957         IF FC-CODE = '1'
  2958              MOVE 31   TO BD-DA
  2959              MOVE 12   TO BD-MO
  2960              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  2961              GO TO 0140-SORT-CONTROL
  2962         ELSE
  2963              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  2964              MOVE BEG-DATE TO SAVE-BEG-DATE
  2965              GO TO 0140-SORT-CONTROL.
  2966
  2967     IF FC-CODE = '2'
  2968         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  2969         IF RD-MO LESS 3
  2970             MOVE 12    TO BD-MO
  2971             MOVE 31    TO BD-DA
  2972             SUBTRACT 1 FROM BD-CCYY
  2973             GO TO 0140-SORT-CONTROL
  2974         ELSE
  2975             IF RD-MO LESS 6
  2976                 MOVE 03 TO BD-MO
  2977                 MOVE 31 TO BD-DA
  2978                 GO TO 0140-SORT-CONTROL
  2979             ELSE
  2980                 IF BD-MO LESS 9
  2981                     MOVE 06 TO BD-MO
  2982                     MOVE 30 TO BD-DA
  2983                     GO TO 0140-SORT-CONTROL
  2984                 ELSE
  2985                     MOVE 09 TO BD-MO
  2986                     MOVE 30 TO BD-DA
  2987                     GO TO 0140-SORT-CONTROL.
  2988
  2989     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  2990     MOVE '6'                   TO DC-OPTION-CODE.
  2991
  2992     EVALUATE FC-CODE
  2993        WHEN '3'
  2994           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  2995           MOVE  -3 TO DC-ELAPSED-MONTHS
  2996        WHEN '4'
  2997           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  2998           MOVE  -6 TO DC-ELAPSED-MONTHS
  2999        WHEN '6'
  3000           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  3001           MOVE  -1 TO DC-ELAPSED-MONTHS
  3002     END-EVALUATE.
  3003
  3004     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  3005     MOVE '1'                   TO DC-END-OF-MONTH.
  3006     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS043RET.cbl
  3007     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  3008
  3009
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS043RET.cbl
  3011 0140-SORT-CONTROL.
  3012     SORT SORT-WORK ON
  3013         ASCENDING  SW-RPT-TYPE-ID-OUT
  3014                    SW-CTL-OUT
  3015         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  3016         OUTPUT PROCEDURE
  3017             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  3018
  3019     IF SORT-RETURN NOT = ZERO AND 4
  3020          MOVE SORT-RETURN            TO WS-RETURN-CODE
  3021          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  3022          GO TO ABEND-PGM.
  3023
  3024     GOBACK.
  3025
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS043RET.cbl
  3027 0150-BUILD-EXTRACTS SECTION.
  3028
  3029 0160-BEGIN-PROCESSING.
  3030     OPEN INPUT
  3031             ACC-MSTR
  3032             ERPLAN-IN
  3033             EPEC-FILE
  3034         OUTPUT
  3035             DATA-OUT
  3036             PRNTR.
  3037
  3038     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  3039         NEXT SENTENCE
  3040       ELSE
  3041         MOVE '11'                TO W-ABEND-CODE-1
  3042         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  3043         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3044         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  3045         GO TO ABEND-PGM.
  3046
  3047     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  3048         NEXT SENTENCE
  3049       ELSE
  3050         MOVE '12'                TO W-ABEND-CODE-1
  3051         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  3052         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3053         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3054         GO TO ABEND-PGM.
  3055
  3056     PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT.
  3057
  3058     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  3059                           UNTIL SA GREATER 4.
  3060     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  3061                           UNTIL SB GREATER 36.
  3062     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3063                           UNTIL CL GREATER 10.
  3064
  3065     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3066     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  3067
  3068     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3069
  3070     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3071     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3072
  3073     GO TO 0200-CHECK-ACCT-MSTR.
  3074
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS043RET.cbl
  3076 0170-CHECK-CONTROL.
  3077
  3078     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  3079
  3080     IF EXCLUDING-BENEFIT
  3081        GO TO 0190-BYPASS-ACCUM.
  3082
  3083     IF DTE-PGM-OPT = '5'
  3084        AND AM-AN-MO NOT = RUN-MO
  3085        GO TO 0190-BYPASS-ACCUM.
  3086
  3087     IF AM-RET-Y-N = 'L'
  3088         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  3089             GO TO 0190-BYPASS-ACCUM.
  3090
  3091     IF AM-RET-Y-N = 'D'
  3092         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  3093             GO TO 0190-BYPASS-ACCUM.
  3094
  3095     IF EP-RECORD-ID = 'EP'
  3096         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3097             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  3098             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  3099             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  3100         ELSE
  3101             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  3102             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  3103             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  3104
  3105     IF EP-RECORD-ID = 'EP'
  3106         IF EP-RUN-DTE NOT GREATER BEG-DATE
  3107             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3108                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  3109                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  3110                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  3111             ELSE
  3112                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  3113                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  3114                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  3115
  3116     IF EP-PURGE = 'P'
  3117         IF EP-RUN-DTE GREATER BEG-DATE
  3118             MOVE 'Q' TO EP-PURGE
  3119             GO TO 0180-TEST-ACCUM
  3120         ELSE
  3121             GO TO 0180-TEST-ACCUM.
  3122
  3123     IF EP-RUN-CCYY = RD-CCYY  AND
  3124        EP-RUN-MO = RD-MO
  3125         MOVE '2' TO EP-PURGE
  3126         GO TO 0180-TEST-ACCUM.
  3127
  3128     IF EP-RUN-CCYY = BD-CCYY  AND
  3129        EP-RUN-MO = BD-MO
  3130         MOVE '1' TO EP-PURGE
  3131         GO TO 0180-TEST-ACCUM.
  3132
  3133     GO TO 0190-BYPASS-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS043RET.cbl
  3134
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS043RET.cbl
  3136 0180-TEST-ACCUM.
  3137     IF EP-RECORD-ID = 'EP'
  3138         IF EP-PURGE = ('1' OR 'P')
  3139             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3140                 MOVE +1 TO SA
  3141                 MOVE LIFE-RETENT   TO RETENT-FACT
  3142                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3143             ELSE
  3144                 MOVE +2 TO SA
  3145                 MOVE   AH-RETENT   TO RETENT-FACT
  3146                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3147
  3148     IF EP-RECORD-ID = 'EP'
  3149         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3150             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3151                 MOVE +3 TO SA
  3152                 MOVE LIFE-RETENT   TO RETENT-FACT
  3153                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3154             ELSE
  3155                 MOVE +4 TO SA
  3156                 MOVE   AH-RETENT   TO RETENT-FACT
  3157                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3158
  3159     IF EP-RECORD-ID = 'EC'
  3160         IF EP-PURGE = ('1' OR 'P')
  3161             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3162                 MOVE +1 TO SA
  3163                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3164             ELSE
  3165                 MOVE +2 TO SA
  3166                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3167
  3168     IF EP-RECORD-ID = 'EC'
  3169         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3170             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3171                 MOVE +3 TO SA
  3172                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3173             ELSE
  3174                 MOVE +4 TO SA
  3175                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3176
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS043RET.cbl
  3178 0190-BYPASS-ACCUM.
  3179     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3180
  3181     IF EP-CONTROL = WS-SAVE-CONTROL
  3182         GO TO 0170-CHECK-CONTROL.
  3183
  3184     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3185
  3186     IF EP-CONTROL = HIGH-VALUES
  3187         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3188
  3189     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3190
  3191     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3192     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3193
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS043RET.cbl
  3195 0200-CHECK-ACCT-MSTR.
  3196     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3197         IF WS-ACCT-CONTROL-EFFDT = WS-SAVE-CONTROL-EFFDT
  3198             GO TO 0211-CONTINUE
  3199         END-IF
  3200         IF AM-GPCD = 98
  3201             PERFORM 0360-BUILD-DUMMY-GA
  3202             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3203             GO TO 0200-CHECK-ACCT-MSTR
  3204         ELSE
  3205             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3206             GO TO 0200-CHECK-ACCT-MSTR.
  3207
  3208 0210-NO-ACCT-MSTR.
  3209     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3210         PERFORM 0270-NO-ACCT-MSG
  3211         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3212         IF EP-CONTROL = HIGH-VALUES
  3213             GO TO 0220-BUILD-EXTRACTS-EXIT
  3214         ELSE
  3215             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3216             MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT
  3217             MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT
  3218             GO TO 0200-CHECK-ACCT-MSTR.
  3219
  3220 0211-CONTINUE.
  3221     IF DTE-PGM-OPT = '7'
  3222         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3223
  3224     GO TO 0170-CHECK-CONTROL.
  3225
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS043RET.cbl
  3227 0215-COMPUTE-BEG-DATE.
  3228     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3229        (AM-AN-MO LESS 01 OR GREATER 12)
  3230            MOVE SAVE-BEG-DATE TO BEG-DATE
  3231            GO TO 0215-EXIT.
  3232
  3233     MOVE RD-CCYY  TO BD-CCYY.
  3234     MOVE AM-AN-MO TO BD-MO.
  3235
  3236     IF BD-MO NOT LESS RD-MO
  3237         SUBTRACT 1 FROM BD-CCYY.
  3238
  3239     IF BD-MO = 04 OR 06 OR 09 OR 11
  3240         MOVE 30 TO BD-DA
  3241     ELSE
  3242         MOVE 31 TO BD-DA.
  3243
  3244     IF BD-MO = 02
  3245         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3246         MOVE 'H'         TO DC-OPTION-CODE
  3247         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3248         IF ONLY-LEAP-YEAR
  3249             MOVE HOLD-CEN-1-DA TO BD-DA
  3250         ELSE
  3251             MOVE 28            TO BD-DA.
  3252
  3253 0215-EXIT.
  3254     EXIT.
  3255
  3256 0220-BUILD-EXTRACTS-EXIT.
  3257     CLOSE
  3258         ACC-MSTR
  3259         ERPLAN-IN
  3260         EPEC-FILE.
  3261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS043RET.cbl
  3263****************************************************************
  3264*                                                              *
  3265****************************************************************
  3266
  3267 0230-PERFORMED-ROUTINES SECTION.
  3268
  3269 0240-READ-EXTRACT.
  3270     READ EPEC-FILE AT END
  3271          MOVE HIGH-VALUES TO EP-CONTROL
  3272          GO TO 0240-EXIT.
  3273
  3274     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3275         GO TO 0240-READ-EXTRACT.
  3276
  3277     IF EP-REIN = 'R'
  3278         GO TO 0240-READ-EXTRACT.
  3279
  3280     IF EP-RUN-DTE GREATER RUN-DT
  3281         GO TO 0240-READ-EXTRACT.
  3282
* 3283     COPY ELCEPCM1.
  3284******************************************************************05/15/98
  3285*                                                                *ELCEPCM1
  3286*                                                                *ELCEPCM1
  3287*                            ELCEPCM1                            *   LV007
  3288*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3289*                            VMOD=2.001                          *ELCEPCM1
  3290*                                                                *ELCEPCM1
  3291*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3292*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3293*                                                                *ELCEPCM1
  3294******************************************************************ELCEPCM1
  3295                                                                     CL**7
  3296     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3297                                 WS-EC-EXP-DTE-N.                    CL**7
  3298     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3299                                 WS-EC-EFF-DTE-N.                    CL**7
  3300     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3301                                 WS-EC-RUN-DTE-N.                    CL**7
  3302                                                                     CL**7
  3303     IF VALID-EP-ID                                                  CL**7
  3304         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3305         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3306         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3307                                                                     CL**7
  3308
  3309 0240-EXIT.
  3310     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS043RET.cbl
  3312
  3313 0250-CHECK-PLAN.
  3314
  3315     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3316
  3317*    IF AM-RET-Y-N = ' '   OR  'N'
  3318*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3319*        GO TO 0250-EXIT.
  3320
  3321
  3322     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3323        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3324        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3325        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3326            GO TO 0250-EXIT.
  3327
  3328     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3329     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3330     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3331     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3332
  3333     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3334
  3335     MOVE +1                  TO NDX.
  3336
  3337 0250-PLAN-LOOP.
  3338
  3339     IF NDX GREATER THAN +20
  3340        MOVE +1                 TO NDX
  3341        GO TO 025A-EDIT-FOR-SPECIAL.
  3342
  3343     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3344        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3345          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3346          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3347          GO TO 0250-READ-PLAN
  3348     ELSE
  3349        ADD +1                TO NDX
  3350        GO TO 0250-PLAN-LOOP.
  3351
  3352 0250-READ-PLAN.
  3353
  3354     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3355         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3356         GO TO 0250-EXIT.
  3357
  3358     READ ERPLAN-IN.
  3359
  3360     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3361         NEXT SENTENCE
  3362     ELSE
  3363        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3364            GO TO 0250-PLAN-NOT-FOUND
  3365        ELSE
  3366            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3367            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3368            DISPLAY '**BAD PLAN FILE READ'
  3369            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS043RET.cbl
  3370            GO TO ABEND-PGM.
  3371
  3372     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3373        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3374        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3375        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3376           NEXT SENTENCE
  3377     ELSE
  3378           GO TO 0250-PLAN-NOT-FOUND.
  3379
  3380     IF AM-RET-Y-N = ' '   OR  'N'
  3381         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3382         GO TO 0250-EXIT.
  3383
  3384     IF PL-RETRO-RET EQUAL ZEROS
  3385         GO TO 0250-PLAN-NOT-FOUND.
  3386
  3387     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3388         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3389         GO TO 0250-EXIT
  3390     ELSE
  3391         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3392         GO TO 0250-EXIT.
  3393
  3394 025A-EDIT-FOR-SPECIAL.
  3395
  3396     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3397      AND
  3398        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3399          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3400          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3401          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3402          GO TO 0250-READ-PLAN.
  3403
  3404     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3405      AND
  3406        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3407        AND
  3408          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3409          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3410              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3411          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3412          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3413          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3414          GO TO 0250-READ-PLAN.
  3415
  3416     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3417      AND
  3418        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3419      AND
  3420        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3421         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3422            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3423            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3424            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3425            GO TO 0250-READ-PLAN.
  3426
  3427     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS043RET.cbl
  3428      AND
  3429        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3430      AND
  3431        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3432         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3433           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3434             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3435             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3436             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3437             GO TO 0250-READ-PLAN.
  3438
  3439     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3440      AND
  3441        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3442      AND
  3443        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3444         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3445             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3446             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3447             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3448             GO TO 0250-READ-PLAN.
  3449
  3450     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3451      AND
  3452        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3453      AND
  3454        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3455         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3456           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3457             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3458             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3459             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3460             GO TO 0250-READ-PLAN.
  3461
  3462     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3463      AND
  3464        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3465      AND
  3466        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3467         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3468           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3469             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3470             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3471             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3472             GO TO 0250-READ-PLAN.
  3473
  3474     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3475      AND
  3476        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3477             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3478             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3479             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3480             GO TO 0250-READ-PLAN.
  3481
  3482     IF NDX NOT LESS THAN +20
  3483       GO TO 0250-PLAN-NOT-FOUND
  3484     ELSE
  3485       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS043RET.cbl
  3486       GO TO 025A-EDIT-FOR-SPECIAL.
  3487
  3488
  3489 0250-PLAN-NOT-FOUND.
  3490     IF AM-RET-Y-N = ' '   OR  'N'
  3491         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3492         GO TO 0250-EXIT
  3493     ELSE
  3494         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3495         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3496         GO TO 0250-EXIT.
  3497
  3498 0250-EXIT.
  3499     EXIT.
  3500
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS043RET.cbl
  3502 0260-READ-ACCT.
  3503     READ ACC-MSTR
  3504             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3505                    GO TO 0260-EXIT.
  3506
* 3507     COPY ELCACCTI.
  3508******************************************************************04/14/98
  3509*                                                                *ELCACCTI
  3510*                            ELCACCTI                            *   LV003
  3511*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3512*                            VMOD=2.001                          *ELCACCTI
  3513*                                                                *ELCACCTI
  3514*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3515*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3516*                                                                *ELCACCTI
  3517*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3518*                                                                *ELCACCTI
  3519******************************************************************ELCACCTI
  3520     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3521     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3522     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3523     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3524     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3525     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3526     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3527     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3528     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3529
  3530     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3531     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3532
  3533     MOVE AM-CNTRL-1    TO WS-MSTR-CNTRL-EFFDT.
  3534     MOVE AM-EFFECT-DT  TO WS-EFFECT-EFFDT.
  3535
  3536     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3537         MOVE EXPENSE-LINE TO WS-EX-LINE.
  3538
  3539     IF DTE-PGM-OPT  = '5' AND
  3540        AM-AN-MO NOT = RUN-MO
  3541         MOVE SPACES TO AM-RETRO-POOL
  3542         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3543         MOVE 'N'    TO AM-RET-Y-N.
  3544
  3545     IF DTE-CLIENT = 'GIC'
  3546         MOVE 'P' TO AM-RET-P-E.
  3547     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3548        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3549         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3550
  3551     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3552         MOVE 'E'              TO AM-RET-P-E.
  3553     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3554         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3555     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3556         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
  3557     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3558         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3559     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS043RET.cbl
  3560         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3561     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
  3562         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3563     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3564         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3565
  3566     IF AM-RETRO-USE-LIFE-METHOD
  3567         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3568
  3569 0260-EXIT.
  3570     EXIT.
  3571
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS043RET.cbl
  3573 0270-NO-ACCT-MSG.
  3574     IF LINE-CNT GREATER +55
  3575         MOVE ZERO   TO LINE-CNT
  3576         MOVE '1'    TO X
  3577         MOVE HEAD-1 TO P-DATA
  3578         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3579         MOVE ' '    TO X
  3580         MOVE HEAD-2 TO P-DATA
  3581         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3582         ADD +1               TO PAGE-CNT
  3583         MOVE PAGE-CNT        TO H3-PAGE
  3584         MOVE ' '    TO X
  3585         MOVE HEAD-3 TO P-DATA
  3586         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3587         MOVE ' '    TO X
  3588         MOVE HEAD-4 TO P-DATA
  3589         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3590         MOVE ' '    TO X
  3591         MOVE SPACES TO P-DATA
  3592         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3593
  3594     MOVE WS-SAVE-CARR     TO H5-CARR.
  3595     MOVE WS-SAVE-COMP     TO H5-COMP.
  3596     MOVE WS-SAVE-STATE    TO H5-ST.
  3597     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3598     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3599     MOVE WK-YR            TO H5-TYR.
  3600     MOVE WK-MO            TO H5-TMO.
  3601     MOVE WK-DA            TO H5-TDA.
  3602     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3603     MOVE WK-YR            TO H5-FYR.
  3604     MOVE WK-MO            TO H5-FMO.
  3605     MOVE WK-DA            TO H5-FDA.
  3606     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3607     MOVE ' '              TO X.
  3608     MOVE HEAD-5           TO P-DATA.
  3609     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3610
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS043RET.cbl
  3612 0280-CALCULATE-RETRO.
  3613******************************************************************
  3614*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3615
  3616     IF DTE-CLIENT NOT = 'POS'
  3617         GO TO 0290-SKIP-CC.
  3618
  3619     IF AM-CARRIER NOT = '1'
  3620         GO TO 0290-SKIP-CC.
  3621
  3622     IF AM-FLD-5 NOT = 'CC'
  3623         GO TO 0290-SKIP-CC.
  3624
  3625     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3626                     - DA-UP (1))) - DA-CLM (1).
  3627     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3628                     - DA-UP (2))) - DA-CLM (2).
  3629     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3630                     - DA-UP (3))) - DA-CLM (3).
  3631     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3632                     - DA-UP (4))) - DA-CLM (4).
  3633
  3634     IF DA-LRV (1) LESS ZERO
  3635         ADD DA-LRV (1) TO DA-LRV (2)
  3636         MOVE ZEROS TO DA-LRV (1)
  3637         IF DA-LRV (2) LESS ZERO
  3638             MOVE ZEROS TO DA-LRV (2).
  3639
  3640     IF DA-LRV (2) LESS ZERO
  3641         ADD DA-LRV (2) TO DA-LRV (1)
  3642         MOVE ZEROS TO DA-LRV (2)
  3643         IF DA-LRV (1) LESS ZERO
  3644             MOVE ZEROS TO DA-LRV (1).
  3645
  3646     IF DA-LRV (3) LESS ZERO
  3647         ADD DA-LRV (3) TO DA-LRV (4)
  3648         MOVE ZEROS TO DA-LRV (3)
  3649         IF DA-LRV (4) LESS ZERO
  3650             MOVE ZEROS TO DA-LRV (4).
  3651
  3652     IF DA-LRV (4) LESS ZERO
  3653         ADD DA-LRV (4) TO DA-LRV (3)
  3654         MOVE ZEROS TO DA-LRV (4)
  3655         IF DA-LRV (3) LESS ZERO
  3656             MOVE ZEROS TO DA-LRV (3).
  3657
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS043RET.cbl
  3659******************************************************************
  3660**       END OF SPECIAL OLI CODING
  3661******************************************************************
  3662
  3663 0290-SKIP-CC.
  3664
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS043RET.cbl
  3666 0300-CALC-RETRO-A.
  3667
  3668     MOVE +1 TO SA.
  3669     MOVE +3 TO SB.
  3670     MOVE +1 TO SC.
  3671     MOVE +3 TO SF.
  3672     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3673     MOVE +2 TO SA.
  3674     MOVE +4 TO SB.
  3675     MOVE +2 TO SC.
  3676     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3677     MOVE +3 TO SB.
  3678     MOVE +4 TO SC.
  3679     MOVE +6 TO SF.
  3680     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3681     MOVE +4 TO SB.
  3682     MOVE +5 TO SC.
  3683     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3684     MOVE SPACES       TO SW-REC.
  3685     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3686     MOVE AM-NAME      TO SW-NAME.
  3687     MOVE AM-ADDRS     TO SW-ADDRS.
  3688     MOVE SPACES       TO SW-CITY.
  3689     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3690        DELIMITED BY '  ' INTO SW-CITY
  3691     END-STRING
  3692     MOVE AM-ZIP       TO SW-ZIP.
  3693     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3694     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3695
  3696     IF PA-EP (4) NOT EQUAL ZEROS
  3697        COMPUTE LIFE-RETENT ROUNDED =
  3698            PA-PE (4) / PA-EP (4)
  3699     ELSE
  3700        MOVE +0.0      TO LIFE-RETENT.
  3701
  3702     IF PA-EP (5) NOT EQUAL ZEROS
  3703        COMPUTE AH-RETENT  ROUNDED =
  3704            PA-PE (5) / PA-EP (5)
  3705     ELSE
  3706        MOVE +0.0      TO AH-RETENT.
  3707
  3708     MOVE LIFE-RETENT  TO SW-LRET.
  3709     MOVE AH-RETENT    TO SW-ARET.
  3710     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3711     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3712     MOVE AM-RET-ST-TAX-USE TO SW-TAX-P-E.
  3713     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3714     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3715     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3716     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3717     MOVE AM-CARRIER   TO SW-CARR.
  3718     MOVE AM-GROUPING  TO SW-COMP.
  3719     MOVE AM-STATE     TO SW-STATE.
  3720     MOVE AM-ACCOUNT   TO SW-ACCT.
  3721     MOVE BEG-DATE     TO SW-BEG-DATE.
  3722
  3723 0310-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS043RET.cbl
  3724     EXIT.
  3725
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS043RET.cbl
  3727 0320-CONT-RETRO-A.
  3728*01408      IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3729         IF AM-RETRO-POOL EQUAL LOW-VALUES
  3730             MOVE SPACES TO SW-RETRO-POOL SW-GA
  3731         ELSE
  3732             MOVE AM-RETRO-POOL TO SW-RETRO-POOL  SW-GA
  3733         END-IF
  3734         RELEASE SW-REC-OUT FROM SW-REC
  3735         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3736
  3737     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3738         MOVE AM-RETRO-POOL TO SW-GA
  3739         MOVE 'B'           TO SW-RPT-TYPE-ID
  3740         IF DTE-CLIENT NOT = 'VSL'
  3741             RELEASE SW-REC-OUT FROM SW-REC
  3742             ADD +1 TO NO-OF-RECORDS-RELEASED
  3743         ELSE
  3744             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3745                 RELEASE SW-REC-OUT FROM SW-REC
  3746                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3747
  3748     IF DTE-CLIENT = 'TAO'
  3749         MOVE AM-USER-FIELDS TO Z-G
  3750         MOVE ZONE-GROUP     TO SW-GA
  3751         MOVE 'B'            TO SW-RPT-TYPE-ID
  3752         RELEASE SW-REC-OUT FROM SW-REC
  3753         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3754
  3755     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3756                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3757                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3758                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3759
  3760     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3761         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3762
  3763     IF AM-GPCD = 98
  3764         MOVE AM-ACCOUNT  TO SW-GA
  3765         MOVE 'X'         TO SW-GA-FLAG
  3766         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3767         MOVE 'C'         TO SW-RPT-TYPE-ID
  3768         RELEASE SW-REC-OUT FROM SW-REC
  3769         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3770
  3771     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3772                          UNTIL SA GREATER 4.
  3773     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3774                          UNTIL SB GREATER 6.
  3775     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3776                          UNTIL CL GREATER 10.
  3777
  3778 0330-EXIT.
  3779     EXIT.
  3780
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS043RET.cbl
  3782 0340-GA-EXT-LOOP.
  3783     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B'
  3784         NEXT SENTENCE
  3785      ELSE
  3786         GO TO 0350-EXIT.
  3787
  3788     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3789     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3790     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3791     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3792     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3793     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3794     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3795     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3796     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3797     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3798     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3799     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3800
  3801     MOVE 3 TO SB.
  3802     PERFORM 0560-ZERO-PA.
  3803     MOVE 6 TO SB.
  3804     PERFORM 0560-ZERO-PA.
  3805     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3806     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3807     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3808     RELEASE SW-REC-OUT FROM SW-REC.
  3809     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3810
  3811 0350-EXIT.
  3812     EXIT.
  3813
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS043RET.cbl
  3815 0360-BUILD-DUMMY-GA.
  3816
  3817     MOVE SPACES       TO SW-REC.
  3818     MOVE -9999999     TO SW-RETRO-LIMIT.
  3819     MOVE 'X'          TO SW-GA-FLAG.
  3820     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3821     MOVE AM-NAME      TO SW-NAME.
  3822     MOVE AM-ADDRS     TO SW-ADDRS.
  3823     MOVE SPACES       TO SW-CITY.
  3824     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3825        DELIMITED BY '  ' INTO SW-CITY
  3826     END-STRING
  3827     MOVE AM-ZIP       TO SW-ZIP.
  3828     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3829     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3830
  3831     IF AM-RET-Y-N = ' '   OR  'N'
  3832         MOVE +1.0 TO SW-LRET SW-ARET
  3833     ELSE
  3834         COMPUTE SW-LRET = 1 - AM-LF-RET
  3835         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3836
  3837     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3838     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3839     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3840     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3841     RELEASE SW-REC-OUT FROM SW-REC.
  3842     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3843
  3844 0370-EXIT.
  3845     EXIT.
  3846
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS043RET.cbl
  3848 0380-COMPUTE-YTD.
  3849     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3850                          (DA-ISP (SA) - DA-CNP (SA)).
  3851
  3852*01524      IF AM-RETRO-PREM-P-E = 'E'
  3853         MOVE DA-UP (SA) TO PA-BR (SC)
  3854         MOVE DA-UP (SB) TO PA-ER (SC).
  3855
  3856     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3857
  3858     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3859
  3860     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3861
  3862     IF AM-RETRO-CLMS-P-I = 'I'
  3863         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3864         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3865
  3866     IF DTE-CLIENT = 'ABL'
  3867         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3868         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3869            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3870         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3871
  3872     IF DTE-CLIENT = 'GIC'
  3873         IF SC = +1
  3874             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3875             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3876         ELSE
  3877             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3878             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3879
  3880     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3881         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3882
  3883     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3884         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3885
  3886     IF SC = +1
  3887         COMPUTE WS-MIN-LOSS ROUNDED =
  3888            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3889                                              + PA-BLR (SC)
  3890        ELSE
  3891         COMPUTE WS-MIN-LOSS ROUNDED =
  3892            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3893                                              + PA-BLR (SC).
  3894     IF SC = +1
  3895         IF AM-RET-MIN-LOSS-L = ZERO
  3896            MOVE ZERO TO WS-MIN-LOSS.
  3897
  3898     IF SC = +2
  3899         IF AM-RET-MIN-LOSS-A = ZERO
  3900            MOVE ZERO TO WS-MIN-LOSS.
  3901
  3902     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3903         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3904
  3905     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS043RET.cbl
  3906
  3907     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3908                           (DA-ISC (SA) - DA-CNC (SA))) +
  3909                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3910                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3911
  3912     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3913                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3914
  3915     COMPUTE PA-ACCT-COMMP (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3916                                  (DA-ISC (SA) - DA-CNC (SA))).
  3917     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) +
  3918                                  (DA-UC (SA) - DA-UC (SB)).
  3919     COMPUTE PA-OW-COMMP (SC) =
  3920                         ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3921                          (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3922     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) +
  3923                            (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3924
  3925     IF AM-RET-P-E = 'P'
  3926         MOVE PA-RC (SC) TO PA-CU (SC)
  3927      ELSE
  3928         MOVE PA-EC (SC) TO PA-CU (SC).
  3929
  3930     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3931     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3932     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3933     COMPUTE PA-TAXP (SC) = DA-TAX (SB) - DA-TAX (SA).
  3934     IF PA-NW (SC) <> 0
  3935         COMPUTE PA-TAXE (SC) = (PA-EP (SC) / PA-NW (SC)) *
  3936                                (DA-TAX (SB) - DA-TAX (SA))
  3937     ELSE
  3938         COMPUTE PA-TAXE (SC) = DA-TAX (SB) - DA-TAX (SA)
  3939     END-IF.
  3940
  3941     IF DTE-CLIENT = 'FLA'
  3942         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3943      ELSE
  3944         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  3945
  3946     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3947         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3948              IF SC = 1
  3949                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3950*                          (PA-NW (SC) * AM-REI-LF-TAX)
  3951                    (DA-TAX (SB) - DA-TAX (SA))
  3952               ELSE
  3953                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3954*                          (PA-NW (SC) * AM-REI-AH-TAX)
  3955                    (DA-TAX (SB) - DA-TAX (SA))
  3956          ELSE
  3957              IF PA-NW(SC) <> 0
  3958                 IF SC = 1
  3959                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3960*                             (PA-EP (SC) * AM-REI-LF-TAX)
  3961                       (PA-EP (SC) / PA-NW (SC)) *
  3962                       (DA-TAX (SB) - DA-TAX (SA))
  3963                  ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS043RET.cbl
  3964                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3965*                             (PA-EP (SC) * AM-REI-AH-TAX).
  3966                       (PA-EP (SC) / PA-NW (SC)) *
  3967                       (DA-TAX (SB) - DA-TAX (SA)).
  3968
  3969     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3970                          + PA-CP (SC) + PA-EX (SC).
  3971     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3972     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3973     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3974     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  3975                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  3976     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  3977                                        DA-GA-UC (SB).
  3978     PERFORM 0520-ADD-PA-LEVELS.
  3979
  3980 0390-EXIT.
  3981     EXIT.
  3982
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS043RET.cbl
  3984 0400-COMPUTE-ITD.
  3985     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  3986
  3987*01635      IF AM-RETRO-PREM-P-E = 'E'
  3988         MOVE DA-UP (SB)       TO PA-ER (SC).
  3989
  3990     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  3991
  3992     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  3993
  3994     MOVE DA-CLM (SB)          TO PA-PL (SC).
  3995
  3996     IF AM-RETRO-CLMS-P-I = 'I'
  3997         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  3998
  3999     IF DTE-CLIENT = 'ABL'
  4000         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  4001
  4002     IF DTE-CLIENT = 'GIC'
  4003         IF SC = +4
  4004             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  4005         ELSE
  4006             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  4007
  4008     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  4009         MOVE +0 TO AM-RET-MIN-LOSS-L.
  4010
  4011     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  4012         MOVE +0 TO AM-RET-MIN-LOSS-A.
  4013
  4014     IF SC = +4
  4015         COMPUTE WS-MIN-LOSS ROUNDED =
  4016            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  4017     ELSE
  4018         COMPUTE WS-MIN-LOSS ROUNDED =
  4019            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  4020
  4021     IF SC = +4
  4022         IF AM-RET-MIN-LOSS-L = ZERO
  4023            MOVE ZERO TO WS-MIN-LOSS.
  4024
  4025     IF SC = +5
  4026         IF AM-RET-MIN-LOSS-A = ZERO
  4027            MOVE ZERO TO WS-MIN-LOSS.
  4028
  4029     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  4030         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  4031
  4032     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  4033
  4034
  4035     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  4036                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  4037     COMPUTE PA-EC (SC) =
  4038                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  4039
  4040     COMPUTE PA-ACCT-COMMP (SC) = DA-ISC (SB) - DA-CNC (SB).
  4041     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) - DA-UC (SB).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS043RET.cbl
  4042     COMPUTE PA-OW-COMMP (SC) = DA-ISC-ADDL (SB) -
  4043                                DA-CNC-ADDL (SB).
  4044     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) -
  4045                                DA-UC-ADDL (SB).
  4046
  4047     IF AM-RET-P-E = 'P'
  4048         MOVE PA-RC (SC) TO PA-CU (SC)
  4049     ELSE
  4050         MOVE PA-EC (SC) TO PA-CU (SC).
  4051
  4052     MOVE DA-OTC (SB) TO PA-OC (SC).
  4053     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  4054     MOVE DA-CPS (SB) TO PA-CP (SC).
  4055     MOVE DA-TAX (SB) TO PA-TAXP (SC).
  4056     IF PA-NW (SC) <> 0
  4057         COMPUTE PA-TAXE (SC) = ((PA-EP (SC) / PA-NW (SC))
  4058                                * DA-TAX (SB))
  4059     ELSE
  4060         MOVE DA-TAX (SB) TO PA-TAXE (SC)
  4061     END-IF.
  4062
  4063     IF DTE-CLIENT = 'FLA'
  4064        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  4065     ELSE
  4066        MOVE DA-EXP (SB) TO PA-EX (SC)
  4067     END-IF
  4068
  4069*    MOVE 'P' TO AM-RET-ST-TAX-USE
  4070*    MOVE 'P' TO AM-RET-P-E
  4071     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4072        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4073           IF SC = 4
  4074              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4075*                (PA-NW (SC) * AM-REI-LF-TAX)
  4076                 DA-TAX (SB)
  4077           ELSE
  4078              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4079*                (PA-NW (SC) * AM-REI-AH-TAX)
  4080                 DA-TAX (SB)
  4081           END-IF
  4082        ELSE
  4083          IF PA-NW (SC) <> 0
  4084           IF SC = 4
  4085              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4086*                (PA-EP (SC) * AM-REI-LF-TAX)
  4087                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4088           ELSE
  4089              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4090*                (PA-EP (SC) * AM-REI-AH-TAX).
  4091                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4092           END-IF
  4093          END-IF
  4094        END-IF
  4095     END-IF
  4096
  4097     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4098                        + PA-CP (SC) + PA-EX (SC).
  4099     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS043RET.cbl
  4100     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4101     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4102     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  4103     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
  4104
  4105     PERFORM 0520-ADD-PA-LEVELS.
  4106
  4107 0410-EXIT.
  4108     EXIT.
  4109
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS043RET.cbl
  4111 0420-CALCULATE-GA.
  4112     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  4113
  4114     IF SAVE-RET-TYP = 'E'
  4115         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  4116     ELSE
  4117         MOVE PA-GARC (SC) TO PA-GACU (SC).
  4118
  4119     COMPUTE PA-GATC (SC) = PA-TC (SC) + PA-GACU (SC).
  4120     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  4121     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  4122     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  4123                                      - PA-NBA (SC).
  4124     ADD PA-GACU (SC) TO PA-GACU (SF).
  4125     ADD PA-GATC (SC) TO PA-GATC (SF).
  4126     ADD PA-GATE (SC) TO PA-GATE (SF).
  4127     ADD PA-GABA (SC) TO PA-GABA (SF).
  4128     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4129
  4130 0430-EXIT.
  4131
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS043RET.cbl
  4133 0440-GENERATE-RETRO.
  4134     IF DTE-PGM-OPT = '1'
  4135         AND H1-REPORT-SUF NOT = 'A'
  4136     OR DTE-PGM-OPT = '2'
  4137         AND H1-REPORT-SUF NOT = 'B'
  4138     OR DTE-PGM-OPT = '3'
  4139         AND H1-REPORT-SUF NOT = 'C'
  4140             GO TO 0470-EXIT.
  4141
  4142     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4143        H1-REPORT-SUF NOT = ('A' AND 'B')
  4144          GO TO 0470-EXIT.
  4145
  4146     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  4147                            UNTIL SB GREATER 2
  4148       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 27.
  4149
  4150     MOVE +1 TO SE.
  4151     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4152     MOVE +2 TO SE.
  4153     ADD +3 TO SF.
  4154
  4155     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4156
  4157     IF SG = 1
  4158         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  4159     END-IF.
  4160
  4161     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  4162
  4163     IF HEAD-SW = '1' OR '2'
  4164         IF SAVE-RET-TYP = 'E'
  4165             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  4166         ELSE
  4167             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  4168     ELSE
  4169         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  4170
  4171     MOVE +1 TO SB.
  4172
  4173 0450-PRINT-LOOP.
  4174     IF DT-SS-R (SB SH) = SPACES
  4175         GO TO 0460-CHECK-NEXT-LINE.
  4176
  4177     IF DT-SS-R (SB SH) = '00'
  4178         MOVE DT-CTL-CHAR (SB) TO X
  4179         MOVE DT-ENTRY (SB)    TO DL-DESC
  4180         MOVE DETAIL-LINE      TO P-DATA
  4181         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4182         GO TO 0460-CHECK-NEXT-LINE.
  4183
  4184     MOVE DT-CTL-CHAR (SB) TO X.
  4185     MOVE DT-SS (SB SH)    TO SA.
  4186
  4187     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4188
  4189 0460-CHECK-NEXT-LINE.
  4190     ADD +1 TO SB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS043RET.cbl
  4191     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4192         GO TO 0450-PRINT-LOOP.
  4193
  4194     MOVE '-'    TO X.
  4195     MOVE SPACES TO P-DATA.
  4196     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4197*    IF (DTE-FMT-OPT  =  2)        AND
  4198*       (BREAK-1-SWITCH NOT = ' ')   AND
  4199*       (H1-REPORT-SUF = 'A')
  4200*       NEXT SENTENCE
  4201*    ELSE
  4202*       ADD 1 TO PAGE-CNT.
  4203*    MOVE PAGE-CNT TO H9-PAGE.
  4204*    MOVE HEAD-9   TO P-DATA.
  4205*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4206
  4207 0470-EXIT.
  4208     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS043RET.cbl
  4210
  4211 0480-COMPUTE-PERCENTS.
  4212     IF PA-EP (SF) = ZERO
  4213         GO TO 0490-EXIT.
  4214
  4215     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4216         PA-PE (SF) / PA-EP (SF).
  4217     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4218         PA-TL (SF) / PA-EP (SF).
  4219     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4220         PA-TC (SF) / PA-EP (SF).
  4221
  4222     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4223         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4224             PA-TC (SF) / PA-NW (SF).
  4225
  4226     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4227         PA-CP (SF) / PA-EP (SF).
  4228     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4229         PA-EX (SF) / PA-EP (SF).
  4230     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4231         PA-BA (SF) / PA-EP (SF).
  4232     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4233         PA-NTE (SF) / PA-EP (SF).
  4234     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4235         PA-NBA (SF) / PA-EP (SF).
  4236     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4237         PA-GATC (SF) / PA-EP (SF).
  4238     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4239         PA-GAGT (SF) / PA-EP (SF).
  4240     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4241         PA-GABA (SF) / PA-EP (SF).
  4242     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4243         PA-GATE (SF) / PA-EP (SF).
  4244
  4245     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4246     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4247     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4248     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4249     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4250     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4251     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4252     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4253     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4254     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4255     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4256     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4257
  4258 0490-EXIT.
  4259     EXIT.
  4260
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS043RET.cbl
  4262 0500-PRINT-DETAIL.
  4263     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4264     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4265     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4266     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4267     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4268     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4269     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4270     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4271     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4272     MOVE DETAIL-LINE      TO P-DATA.
  4273     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4274     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4275
  4276*     IF SG = 2
  4277*         IF DO-OUT-SUBSCRIPT (SB) > 0
  4278*            MOVE DO-OUT-SUBSCRIPT (SB) TO WS-DO-SUB
  4279*            MOVE DT-ENTRY (SB)     TO DO-DESCR (WS-DO-SUB)
  4280*            MOVE PA-AMT (SG 1 SA)  TO DO-PERLF (WS-DO-SUB)
  4281*            MOVE PA-AMT (SG 4 SA)  TO DO-ITDLF (WS-DO-SUB)
  4282*            MOVE PA-AMT (SG 2 SA)  TO DO-PERAH (WS-DO-SUB)
  4283*            MOVE PA-AMT (SG 5 SA)  TO DO-ITDAH (WS-DO-SUB)
  4284*         END-IF
  4285*     END-IF.
  4286
  4287 0510-EXIT.
  4288     EXIT.
  4289
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS043RET.cbl
  4291 0520-ADD-PA-LEVELS.
  4292     ADD PA-NW   (SC) TO PA-NW   (SF).
  4293     ADD PA-BR   (SC) TO PA-BR   (SF).
  4294     ADD PA-ER   (SC) TO PA-ER   (SF).
  4295     ADD PA-EP   (SC) TO PA-EP   (SF).
  4296     ADD PA-PE   (SC) TO PA-PE   (SF).
  4297     ADD PA-PL   (SC) TO PA-PL   (SF).
  4298     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4299     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4300     ADD PA-TL   (SC) TO PA-TL   (SF).
  4301     ADD PA-RC   (SC) TO PA-RC   (SF).
  4302     ADD PA-OC   (SC) TO PA-OC   (SF).
  4303     ADD PA-TC   (SC) TO PA-TC   (SF).
  4304     ADD PA-CP   (SC) TO PA-CP   (SF).
  4305     ADD PA-EX   (SC) TO PA-EX   (SF).
  4306     ADD PA-TE   (SC) TO PA-TE   (SF).
  4307     ADD PA-BA   (SC) TO PA-BA   (SF).
  4308     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4309     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4310     ADD PA-EC   (SC) TO PA-EC   (SF).
  4311     ADD PA-GARC (SC) TO PA-GARC (SF).
  4312     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4313     ADD PA-GACU (SC) TO PA-GACU (SF).
  4314     ADD PA-CU   (SC) TO PA-CU   (SF).
  4315     ADD PA-GATC (SC) TO PA-GATC (SF).
  4316     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4317     ADD PA-GABA (SC) TO PA-GABA (SF).
  4318     ADD PA-GATE (SC) TO PA-GATE (SF).
  4319     ADD PA-TAXP (SC) TO PA-TAXP (SF).
  4320     ADD PA-TAXE (SC) TO PA-TAXE (SF).
  4321
  4322 0530-ADD-UP-LEVELS.
  4323     PERFORM 0520-ADD-PA-LEVELS.
  4324     ADD +1 TO SC
  4325               SF.
  4326
  4327 0540-EXIT.
  4328     EXIT.
  4329
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS043RET.cbl
  4331 0550-ZERO-DA.
  4332     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4333                DA-TAX (SA)
  4334                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4335                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4336                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4337                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4338                DA-PCT-E-PREM (SA).
  4339
  4340 0560-ZERO-PA.
  4341     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4342                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4343                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4344                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4345                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4346                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4347                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4348                PA-GATE (SB)  PA-CU (SB).
  4349     MOVE +0 TO PA-TAXP (SB)  PA-TAXE (SB).
  4350
  4351 0570-ZERO-XDA.
  4352
  4353     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4354                           UNTIL SA GREATER THAN 4.
  4355
  4356 0575-ZERO-XDA.
  4357
  4358     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4359                                     XDA-GA-TYPE (CL).
  4360     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4361                                     XDA-GA-CNC (CL SA)
  4362                                     XDA-GA-UC  (CL SA).
  4363
  4364 0580-ZERO-PCNT.
  4365     MOVE +0 TO PT-PRCNT (SB SC).
  4366
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS043RET.cbl
  4368 0590-HEADING-ROUTINE.
  4369     IF DTE-PGM-OPT = '1'
  4370         AND H1-REPORT-SUF NOT = 'A'
  4371     OR DTE-PGM-OPT = '2'
  4372         AND H1-REPORT-SUF NOT = 'B'
  4373     OR DTE-PGM-OPT = '3'
  4374         AND H1-REPORT-SUF NOT = 'C'
  4375             GO TO 0600-EXIT.
  4376
  4377     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4378        H1-REPORT-SUF NOT = ('A' AND 'B')
  4379        GO TO 0600-EXIT.
  4380
  4381     MOVE '1'    TO X.
  4382     MOVE HEAD-1 TO P-DATA.
  4383     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4384     MOVE ' '    TO X.
  4385     MOVE HEAD-2 TO P-DATA.
  4386     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4387     ADD +1               TO PAGE-CNT.
  4388     MOVE PAGE-CNT        TO H3-PAGE.
  4389     MOVE HEAD-3 TO P-DATA.
  4390     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4391
  4392     IF HEAD-SW = '1' OR '2'
  4393         MOVE '0'    TO X
  4394         MOVE HEAD-4 TO P-DATA
  4395         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4396         MOVE ' '    TO X
  4397         MOVE HEAD-5 TO P-DATA
  4398         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4399
  4400     MOVE '0' TO X.
  4401     IF DTE-PGM-OPT = '7'
  4402         IF HEAD-SW NOT = '1' AND '2'
  4403             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4404         ELSE
  4405             MOVE BD-MO     TO H6R-MO
  4406             MOVE BD-DA     TO H6R-DA
  4407             MOVE BD-CCYY   TO H6R-CCYY
  4408             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4409             MOVE ' TO DATE '       TO H6R-MSG
  4410             MOVE ' '       TO H6R-FILLER.
  4411
  4412     MOVE HEAD-6 TO P-DATA.
  4413     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4414     MOVE ' '    TO X.
  4415     MOVE HEAD-7 TO P-DATA.
  4416     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4417     MOVE '0'    TO X.
  4418
  4419 0600-EXIT.
  4420     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS043RET.cbl
  4422
  4423 0610-PRT-RTN.
  4424****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4425
  4426     IF (DTE-FMT-OPT  =  2)        AND
  4427        (BREAK-1-SWITCH NOT = ' ')   AND
  4428        (H1-REPORT-SUF = 'A')
  4429             MOVE SPACES TO P-DATA  DETAIL-LINE
  4430             GO TO 0630-EXIT.
  4431
  4432 0620-PRT-REST.
  4433*                            COPY ELCPRT2.
* 4434                             COPY PRTN043.
  4435******************************************************************
  4436*                                                                *
  4437*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4438*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4439*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4440*                                                                *
  4441******************************************************************
  4442*                                                                *
  4443*                            ELCPRTN                             *
  4444*                            VMOD=2.002                          *
  4445*                                                                *
  4446******************************************************************
  4447*                   C H A N G E   L O G
  4448*
  4449* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4450*-----------------------------------------------------------------
  4451*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4452* EFFECTIVE    NUMBER
  4453*-----------------------------------------------------------------
  4454* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4455******************************************************************
  4456
  4457     IF DTE-FICH NOT = SPACE AND
  4458        FICH-OPEN    = SPACE
  4459         MOVE 'X' TO FICH-OPEN
  4460         OPEN OUTPUT FICH.
  4461
  4462     IF DTE-FICH NOT = SPACE
  4463         MOVE X TO P-CTL
  4464         WRITE FICH-REC FROM PRT.
  4465
  4466     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4467         GO TO SKIP-A-REPORT.
  4468
  4469     IF DTE-FICH = SPACE OR '2'
  4470       MOVE X                    TO  P-CTL
  4471       IF P-CTL = ' '
  4472         WRITE PRT AFTER ADVANCING 1 LINE
  4473       ELSE
  4474         IF P-CTL = '0'
  4475           WRITE PRT AFTER ADVANCING 2 LINES
  4476         ELSE
  4477           IF P-CTL = '-'
  4478             WRITE PRT AFTER ADVANCING 3 LINES
  4479           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS043RET.cbl (/apps/prod/cid1p/copy/PRTN043)
  4480             WRITE PRT AFTER ADVANCING PAGE.
  4481
  4482******************************************************************
  4483
  4484******************************************************************
  4485 SKIP-A-REPORT.
  4486     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4487
  4488 0630-EXIT.
  4489     EXIT.
  4490
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS043RET.cbl
  4492 0640-EP-ADD.
  4493     ADD EP-ISS-PRM TO DA-ISP (SA).
  4494     IF EP-PRM-TAX NUMERIC
  4495        ADD EP-PRM-TAX TO DA-TAX (SA).
  4496     ADD EP-CNC-PRM TO DA-CNP (SA).
  4497     ADD EP-CLM-AMT TO DA-CLM (SA).
  4498     ADD EP-CLM-DU TO DA-LRV (SA).
  4499
  4500     IF DTE-CLIENT NOT = 'ABL'
  4501         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4502
  4503     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4504     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4505
  4506     IF DTE-CLIENT = 'ABL'
  4507         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4508
  4509*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4510
  4511     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4512     MOVE 0                    TO SAVE-DA-PCT-UP.
  4513
  4514     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4515         COMPUTE SAVE-DA-PCT-UP =
  4516                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4517         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4518                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4519
  4520     IF WS-EP-CODE = 'P'
  4521         COMPUTE SAVE-DA-PCT-UP =
  4522                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4523         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4524                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4525
  4526     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4527         COMPUTE SAVE-DA-PCT-UP =
  4528                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4529         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4530                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4531
  4532     IF WS-EP-CODE = 'M'
  4533         COMPUTE SAVE-DA-PCT-UP =
  4534             ((EP-ISS-PRM - EP-CNC-PRM) -
  4535               ((EP-PRM-PR + EP-PRM-78) * .5))
  4536         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4537             ((EP-ISS-PRM - EP-CNC-PRM) -
  4538               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4539
  4540     IF WS-EP-CODE = '1'
  4541         COMPUTE SAVE-DA-PCT-UP =
  4542             ((EP-ISS-PRM - EP-CNC-PRM) -
  4543              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4544         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4545             ((EP-ISS-PRM - EP-CNC-PRM) -
  4546              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4547
  4548     IF WS-EP-CODE = '2'
  4549         COMPUTE SAVE-DA-PCT-UP =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS043RET.cbl
  4550             ((EP-ISS-PRM - EP-CNC-PRM) -
  4551              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4552         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4553             ((EP-ISS-PRM - EP-CNC-PRM) -
  4554              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4555
  4556     IF AM-RETRO-PREM-P-E = 'E'
  4557         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4558             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4559                                                 * RETENT-FACT
  4560     ELSE
  4561         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4562                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4563
  4564     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4565
  4566 0640-EXIT.
  4567     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS043RET.cbl
  4569
  4570 0650-EP-EARN-TYPE.
  4571     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4572
  4573 0652-ST-LOOK-UP.
  4574     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4575         NEXT SENTENCE
  4576      ELSE
  4577          ADD +1 TO CLAS-INDEXS
  4578          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4579              GO TO 0652-ST-LOOK-UP
  4580           ELSE
  4581             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4582             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4583             MOVE 0402      TO WS-RETURN-CODE
  4584             GO TO ABEND-PGM.
  4585
  4586     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4587         MOVE CLAS-STARTA TO CLAS-INDEXA
  4588         GO TO 0670-EP-EARN-AH.
  4589
  4590     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4591
  4592 0660-EP-EARN-TYPE-LOOP.
  4593     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4594         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4595         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4596         MOVE 0401            TO WS-RETURN-CODE
  4597         GO TO ABEND-PGM.
  4598
  4599     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4600         ADD +1 TO CLAS-INDEXL
  4601         GO TO 0660-EP-EARN-TYPE-LOOP.
  4602
  4603     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4604
  4605     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4606          MOVE 'P' TO WS-EP-CODE.
  4607
  4608     IF DTE-CLIENT = 'ITG'
  4609          MOVE 'P' TO WS-EP-CODE.
  4610
  4611     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4612       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4613           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4614     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4615       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4616           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4617
  4618     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4619
  4620     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4621       AND (SA = 1 OR 2)
  4622       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4623           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4624
  4625     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4626       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS043RET.cbl
  4627       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4628           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4629
  4630     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS043RET.cbl
  4632
  4633 0670-EP-EARN-AH.
  4634     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4635         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4636         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4637         MOVE 0402         TO WS-RETURN-CODE
  4638         GO TO ABEND-PGM.
  4639
  4640     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4641         ADD +1 TO CLAS-INDEXA
  4642         GO TO 0670-EP-EARN-AH.
  4643
  4644     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4645
  4646     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4647          MOVE 'P' TO WS-EP-CODE.
  4648
  4649     IF DTE-CLIENT = 'ITG'
  4650          MOVE 'P' TO WS-EP-CODE.
  4651
  4652     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4653       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4654           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4655
  4656     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4657       AND (SA = 1 OR 2)
  4658       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4659           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4660
  4661     IF DTE-CLIENT = 'ITY'
  4662         IF EP-CARRIER = '5' OR '7'
  4663              MOVE '1' TO WS-EP-CODE.
  4664
  4665     IF DTE-CLIENT = 'GIC'
  4666         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4667              MOVE '2' TO WS-EP-CODE.
  4668
  4669     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4670                     'UW1' OR 'DDB' OR 'GSL'
  4671         MOVE 'M'                  TO WS-EP-CODE.
  4672
  4673     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4674
  4675 0680-EXIT.
  4676     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS043RET.cbl
  4678
  4679 0690-EC-ADD.
  4680     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4681         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4682
  4683     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS043RET.cbl
  4685
  4686 0700-ACCT-EC-ADD.
  4687******************************************************************
  4688*         CL - AGENT LEVEL WITHIN EC RECORD
  4689*         AL - AGENT LEVEL WITHIN GA TABLE
  4690*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4691******************************************************************
  4692
  4693     IF EC-AGT-NO (CL) = ZEROS
  4694         GO TO 0710-EXIT.
  4695
  4696     IF EC-SEQ-NBR GREATER THAN 1
  4697         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4698         SUBTRACT +1 FROM WS-SEQ-NBR
  4699         COMPUTE AL = WS-SEQ-NBR * 5.
  4700
  4701     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4702
  4703     IF WS-RETRO-FLAG = 'N'
  4704        GO TO 0710-EXIT.
  4705
  4706     MOVE +1                     TO  AL.
  4707
  4708 0700-LOOP.
  4709
  4710     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4711         GO TO 0705-ACCUM.
  4712
  4713     IF XDA-GA-NO (AL) = SPACES
  4714         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4715         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4716         GO TO 0705-ACCUM.
  4717
  4718     ADD +1 TO AL.
  4719
  4720     IF AL GREATER THAN EC-REC-MAX
  4721         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4722                                 TO  WS-ABEND-MESSAGE
  4723         GO TO ABEND-PGM.
  4724
  4725     GO TO 0700-LOOP.
  4726
  4727 0705-ACCUM.
  4728
  4729     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4730         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4731         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4732
  4733     IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4734         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4735         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4736*02281        IF AM-RETRO-LV-INDIC (AL) = 'A'
  4737       IF WS-RETRO-FLAG = 'A'
  4738           ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4739           ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4740
  4741*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4742*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS043RET.cbl
  4743
  4744     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4745        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4746         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4747             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4748              EC-COMM-78 (CL))
  4749        ELSE
  4750         IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4751          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4752             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4753              EC-COMM-78 (CL))
  4754*02298             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4755            IF WS-RETRO-FLAG = 'A'
  4756               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4757                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4758                    EC-COMM-78 (CL)).
  4759
  4760     IF WS-EP-CODE = 'P'
  4761       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4762         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4763             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4764              EC-COMM-PR (CL))
  4765       ELSE
  4766        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4767         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4768             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4769              EC-COMM-PR (CL))
  4770*02313             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4771            IF WS-RETRO-FLAG = 'A'
  4772               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4773                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4774                  EC-COMM-PR (CL)).
  4775
  4776     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4777       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4778         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4779             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4780              EC-COMM-ST (CL))
  4781       ELSE
  4782        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4783         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4784             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4785              EC-COMM-ST (CL))
  4786*02328             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4787            IF WS-RETRO-FLAG = 'A'
  4788               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4789                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4790                  EC-COMM-ST (CL)).
  4791
  4792     IF WS-EP-CODE = 'M'
  4793         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4794                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4795                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4796                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4797          ELSE
  4798           IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4799                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4800                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS043RET.cbl
  4801                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4802*02343                IF AM-RETRO-LV-INDIC (AL) = 'A'
  4803               IF WS-RETRO-FLAG = 'A'
  4804                   COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4805                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4806                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4807
  4808     IF WS-EP-CODE = '1'
  4809         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4810                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4811                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4812                      ((EC-COMM-PR (CL) * +.6667) +
  4813                       (EC-COMM-78 (CL) * +.3333)))
  4814         ELSE
  4815             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4816                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4817                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4818                      ((EC-COMM-PR (CL) * +.6667) +
  4819                       (EC-COMM-78 (CL) * +.3333)))
  4820*02360                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4821                 IF WS-RETRO-FLAG = 'A'
  4822                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4823                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4824                      ((EC-COMM-PR (CL) * +.6667) +
  4825                       (EC-COMM-78 (CL) * +.3333))).
  4826
  4827     IF WS-EP-CODE = '2'
  4828         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4829                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4830                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4831                      ((EC-COMM-PR (CL) * +.80) +
  4832                       (EC-COMM-78 (CL) * +.20)))
  4833         ELSE
  4834             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4835                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4836                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4837                      ((EC-COMM-PR (CL) * +.80) +
  4838                       (EC-COMM-78 (CL) * +.20)))
  4839*02378                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4840                 IF WS-RETRO-FLAG = 'A'
  4841                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4842                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4843                      ((EC-COMM-PR (CL) * +.80) +
  4844                       (EC-COMM-78 (CL) * +.20))).
  4845
  4846 0710-EXIT.
  4847     EXIT.
  4848
  4849 0725-CHECK-AM-RETRO.
  4850
  4851     MOVE SPACE                  TO  WS-RETRO-FLAG.
  4852
  4853     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  4854                             UNTIL AN GREATER THAN 10.
  4855 0725-CHECK-LOOP.
  4856
  4857     IF EC-AGT-NO (CL) = AM-AGT (AN)
  4858         MOVE AM-RETRO-LV-INDIC (AN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS043RET.cbl
  4859                                 TO  WS-RETRO-FLAG
  4860         MOVE +11                TO  AN.
  4861
  4862 0725-EXIT.
  4863     EXIT.
  4864
  4865 0729-EXIT.
  4866     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS043RET.cbl
  4868
  4869 0730-RETURN-SORTED-FILE.
  4870
  4871     IF SW-CTL NOT = HIGH-VALUES
  4872         RETURN SORT-WORK  INTO  SW-REC
  4873                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  4874                                               SW-CTL.
  4875 0730-EXIT.
  4876     EXIT.
  4877
  4878 0740-MOVE-SW-REC.
  4879     IF SW-RPT-TYPE-ID = 'C'
  4880         IF DTE-CLIENT = 'LBL'
  4881             MOVE 'E'            TO SW-RET-TYP.
  4882
  4883     MOVE SW-NAME                TO H1-NAME.
  4884     MOVE SW-ADDRS               TO H2-ADDR.
  4885     MOVE SW-CITY                TO H3-ADDR.
  4886
  4887     IF  SW-CANADIAN-POST-CODE
  4888         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  4889         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  4890         MOVE SPACES             TO H3-DASH-CAN
  4891                                    H3-CAN-FILLER
  4892
  4893     ELSE
  4894         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  4895
  4896         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  4897             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  4898
  4899         ELSE
  4900             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  4901             MOVE '-'            TO H3-DASH.
  4902
  4903     MOVE SW-CARR                TO H5-CARR.
  4904     MOVE SW-COMP                TO H5-COMP.
  4905     MOVE SW-STATE               TO H5-ST.
  4906     MOVE SW-ACCT                TO H5-ACCT.
  4907     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  4908     MOVE SW-EFF-DT              TO WORK-DATE.
  4909     MOVE WK-MO                  TO H5-FMO.
  4910     MOVE WK-DA                  TO H5-FDA.
  4911     MOVE WK-YR                  TO H5-FYR.
  4912     MOVE SW-EXP-DT              TO WORK-DATE.
  4913     MOVE WK-MO                  TO H5-TMO.
  4914     MOVE WK-DA                  TO H5-TDA.
  4915     MOVE WK-YR                  TO H5-TYR.
  4916     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
  4917     MOVE SW-CTL                 TO WS-SAVE-CTL.
  4918     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  4919     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  4920     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  4921     MOVE SW-LRET                TO LIFE-RETENT.
  4922     MOVE SW-ARET                TO AH-RETENT.
  4923     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  4924     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  4925     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS043RET.cbl
  4926     MOVE SW-BEG-DATE            TO BEG-DATE.
  4927
  4928*****rpt type a = rpt 43a,  b = rpt 43b
  4929     IF SW-RPT-TYPE-ID = 'A' AND
  4930       (FC-CODE = '1' OR '5' OR '6')
  4931         MOVE RD-MO    TO DO-ME-MO
  4932         MOVE RD-DA    TO DO-ME-DD
  4933         MOVE RD-CCYY  TO DO-ME-YR
  4934         MOVE SW-CARR  TO DO-CARRIER
  4935         MOVE SW-COMP  TO DO-COMP
  4936         MOVE SW-STATE TO DO-STATE
  4937         MOVE SW-ACCT  TO DO-ACCOUNT-NUM
  4938         MOVE SW-EXP-DT TO WORK-DATE
  4939         MOVE WK-CCYY  TO DO-EXP-YR
  4940         MOVE WK-MO    TO DO-EXP-MO
  4941         MOVE WK-DA    TO DO-EXP-DD
  4942         IF DO-EXP-MO = 99
  4943             MOVE 12   TO DO-EXP-MO
  4944             MOVE 31   TO DO-EXP-DD
  4945         END-IF
  4946         MOVE SW-EFF-DT TO WORK-DATE
  4947         MOVE WK-CCYY  TO DO-EFF-YR
  4948         MOVE WK-MO    TO DO-EFF-MO
  4949         MOVE WK-DA    TO DO-EFF-DD
  4950         IF SW-RETRO-POOL < SPACES
  4951             MOVE SPACES TO DO-GROUP
  4952         ELSE
  4953             MOVE SW-RETRO-POOL TO DO-GROUP
  4954         END-IF
  4955         MOVE SW-NAME  TO DO-ACCOUNT-NAME
  4956         MOVE SW-PREM-P-E TO DO-PREM-P-E
  4957         MOVE SW-CLMS-P-I TO DO-CLAIM-P-I
  4958         IF SW-RET-Y-N EQUAL LOW-VALUES
  4959            MOVE SPACES TO DO-RETRO-Y-N
  4960         ELSE
  4961            MOVE SW-RET-Y-N  TO DO-RETRO-Y-N
  4962         END-IF
  4963         MOVE SW-RET-TYP  TO DO-RETRO-P-E
  4964         MOVE SW-TAX-P-E  TO DO-TAX-P-E
  4965*         MOVE SW-LRET     TO DO-LIFE-RETENT
  4966*         MOVE SW-ARET     TO DO-AH-RETENT
  4967         IF FC-CODE = '1'
  4968             MOVE 'YTD'   TO DO-PERIOD
  4969         ELSE
  4970             IF FC-CODE = '5'
  4971                 MOVE 'L12'   TO DO-PERIOD
  4972             ELSE
  4973                 MOVE 'CUR'   TO DO-PERIOD
  4974             END-IF
  4975         END-IF
  4976      END-IF.
  4977
  4978     IF SW-RPT-TYPE-ID = 'A' OR 'B'
  4979         MOVE 'GROUP'            TO H4-GROUP
  4980         MOVE SW-GA              TO H5-GROUP.
  4981
  4982     MOVE SW-GA                  TO ZONE-GROUP.
  4983
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS043RET.cbl
  4984     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  4985         MOVE '  ZONE'           TO H4-GROUP
  4986         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  4987
  4988     IF SW-RPT-TYPE-ID = 'C'
  4989         MOVE ' G.A.'            TO H4-GROUP
  4990         MOVE SW-GA              TO H5-GROUP.
  4991
  4992     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS043RET.cbl
  4994 0745-OUTPUT-PROCEDURE SECTION.
  4995     IF NO-OF-RECORDS-RELEASED = +0
  4996        GO TO 1080-E-O-J.
  4997
  4998 0746-MOVE-OUT-DATA SECTION.
  4999     MOVE 'PREMIUM' TO DO-DESCR(1).
  5000     MOVE PA-AMT (1 1 1) TO DO-PERLFP (1).
  5001     MOVE PA-AMT (1 1 4) TO DO-PERLFE (1).
  5002     MOVE PA-AMT (1 4 1) TO DO-ITDLFP (1).
  5003     MOVE PA-AMT (1 4 4) TO DO-ITDLFE (1).
  5004     MOVE PA-AMT (1 2 1) TO DO-PERAHP (1).
  5005     MOVE PA-AMT (1 2 4) TO DO-PERAHE (1).
  5006     MOVE PA-AMT (1 5 1) TO DO-ITDAHP (1).
  5007     MOVE PA-AMT (1 5 4) TO DO-ITDAHE (1).
  5008     MOVE 'BEG PREM RESERVE' TO DO-DESCR (2).
  5009     MOVE +0             TO DO-PERLFP (2).
  5010     MOVE PA-AMT (1 1 2) TO DO-PERLFE (2).
  5011     MOVE +0             TO DO-ITDLFP (2).
  5012     MOVE PA-AMT (1 4 2) TO DO-ITDLFE (2).
  5013     MOVE +0             TO DO-PERAHP (2).
  5014     MOVE PA-AMT (1 2 2) TO DO-PERAHE (2).
  5015     MOVE +0             TO DO-ITDAHP (2).
  5016     MOVE PA-AMT (1 5 2) TO DO-ITDAHE (2).
  5017     MOVE 'END PREM RESERVE' TO DO-DESCR (3).
  5018     MOVE +0             TO DO-PERLFP (3).
  5019     MOVE PA-AMT (1 1 3) TO DO-PERLFE (3).
  5020     MOVE +0             TO DO-ITDLFP (3).
  5021     MOVE PA-AMT (1 4 3) TO DO-ITDLFE (3).
  5022     MOVE +0             TO DO-PERAHP (3).
  5023     MOVE PA-AMT (1 2 3) TO DO-PERAHE (3).
  5024     MOVE +0             TO DO-ITDAHP (3).
  5025     MOVE PA-AMT (1 5 3) TO DO-ITDAHE (3).
  5026     MOVE 'ACCOUNT COMMISSION' TO DO-DESCR (4).
  5027     MOVE PA-AMT (1 1 30) TO DO-PERLFP (4).
  5028     MOVE PA-AMT (1 1 31) TO DO-PERLFE (4).
  5029     MOVE PA-AMT (1 4 30) TO DO-ITDLFP (4).
  5030     MOVE PA-AMT (1 4 31) TO DO-ITDLFE (4).
  5031     MOVE PA-AMT (1 2 30) TO DO-PERAHP (4).
  5032     MOVE PA-AMT (1 2 31) TO DO-PERAHE (4).
  5033     MOVE PA-AMT (1 5 30) TO DO-ITDAHP (4).
  5034     MOVE PA-AMT (1 5 31) TO DO-ITDAHE (4).
  5035     MOVE 'OW COMMISSION' TO DO-DESCR (5).
  5036     MOVE PA-AMT (1 1 32) TO DO-PERLFP (5).
  5037     MOVE PA-AMT (1 1 33) TO DO-PERLFE (5).
  5038     MOVE PA-AMT (1 4 32) TO DO-ITDLFP (5).
  5039     MOVE PA-AMT (1 4 33) TO DO-ITDLFE (5).
  5040     MOVE PA-AMT (1 2 32) TO DO-PERAHP (5).
  5041     MOVE PA-AMT (1 2 33) TO DO-PERAHE (5).
  5042     MOVE PA-AMT (1 5 32) TO DO-ITDAHP (5).
  5043     MOVE PA-AMT (1 5 33) TO DO-ITDAHE (5).
  5044     MOVE 'CLAIMS' TO DO-DESCR (6).
  5045     MOVE PA-AMT (1 1 6) TO DO-PERLFP (6).
  5046     MOVE PA-AMT (1 1 9) TO DO-PERLFE (6).
  5047     MOVE PA-AMT (1 4 6) TO DO-ITDLFP (6).
  5048     MOVE PA-AMT (1 4 9) TO DO-ITDLFE (6).
  5049     MOVE PA-AMT (1 2 6) TO DO-PERAHP (6).
  5050     MOVE PA-AMT (1 2 9) TO DO-PERAHE (6).
  5051     MOVE PA-AMT (1 5 6) TO DO-ITDAHP (6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS043RET.cbl
  5052     MOVE PA-AMT (1 5 9) TO DO-ITDAHE (6).
  5053     MOVE 'BEG CLAIM RESERVE' TO DO-DESCR (7).
  5054     MOVE +0             TO DO-PERLFP (7).
  5055     MOVE PA-AMT (1 1 7) TO DO-PERLFE (7).
  5056     MOVE +0             TO DO-ITDLFP (7).
  5057     MOVE PA-AMT (1 4 7) TO DO-ITDLFE (7).
  5058     MOVE +0             TO DO-PERAHP (7).
  5059     MOVE PA-AMT (1 2 7) TO DO-PERAHE (7).
  5060     MOVE +0             TO DO-ITDAHP (7).
  5061     MOVE PA-AMT (1 5 7) TO DO-ITDAHE (7).
  5062     MOVE 'END CLAIM RESERVE' TO DO-DESCR (8).
  5063     MOVE +0             TO DO-PERLFP (8).
  5064     MOVE PA-AMT (1 1 8) TO DO-PERLFE (8).
  5065     MOVE +0             TO DO-ITDLFP (8).
  5066     MOVE PA-AMT (1 4 8) TO DO-ITDLFE (8).
  5067     MOVE +0             TO DO-PERAHP (8).
  5068     MOVE PA-AMT (1 2 8) TO DO-PERAHE (8).
  5069     MOVE +0             TO DO-ITDAHP (8).
  5070     MOVE PA-AMT (1 5 8) TO DO-ITDAHE (8).
  5071     MOVE 'TAXES'        TO DO-DESCR (9).
  5072     MOVE PA-AMT (1 1 28) TO DO-PERLFP (9).
  5073     MOVE PA-AMT (1 1 29) TO DO-PERLFE (9).
  5074     MOVE PA-AMT (1 4 28) TO DO-ITDLFP (9).
  5075     MOVE PA-AMT (1 4 29) TO DO-ITDLFE (9).
  5076     MOVE PA-AMT (1 2 28) TO DO-PERAHP (9).
  5077     MOVE PA-AMT (1 2 29) TO DO-PERAHE (9).
  5078     MOVE PA-AMT (1 5 28) TO DO-ITDAHP (9).
  5079     MOVE PA-AMT (1 5 29) TO DO-ITDAHE (9).
  5080     MOVE PA-AMT (1 1 13) TO DO-PER-LF-RETRO-PMT.
  5081     MOVE PA-AMT (1 4 13) TO DO-ITD-LF-RETRO-PMT.
  5082     MOVE PA-AMT (1 2 13) TO DO-PER-AH-RETRO-PMT.
  5083     MOVE PA-AMT (1 5 13) TO DO-ITD-AH-RETRO-PMT.
  5084
  5085 0747-EXIT.
  5086     EXIT.
  5087
  5088 0750-PRINT-REPORT SECTION.
  5089     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5090
  5091     IF SW-RPT-TYPE-ID = 'B'
  5092         GO TO 0900-PRINT-GROUP-TOTALS.
  5093
  5094     IF SW-RPT-TYPE-ID = 'C'
  5095         GO TO 0990-PRINT-GA-TOTALS.
  5096
  5097     MOVE 'A'    TO H1-REPORT-SUF.
  5098     PERFORM 0740-MOVE-SW-REC.
  5099     MOVE SPACES TO H5-MESSAGE.
  5100
  5101*    IF SW-CARR = WS-SAVE-CAR
  5102*        AND SW-COMP = WS-SAVE-CMP
  5103*        AND SW-STATE = WS-SAVE-ST
  5104*        AND SW-ACCT = WS-SAVE-ACC
  5105*            GO TO 0780-BREAK-1
  5106*    ELSE
  5107*        GO TO 0800-BREAK-2.
  5108
  5109 0760-CHECK-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS043RET.cbl
  5110     IF SW-CARR NOT = WS-SAVE-CAR
  5111         GO TO 0860-BREAK-5.
  5112     IF SW-COMP NOT = WS-SAVE-CMP
  5113         GO TO 0840-BREAK-4.
  5114     IF SW-STATE NOT = WS-SAVE-ST
  5115         GO TO 0820-BREAK-3.
  5116     IF SW-ACCT NOT = WS-SAVE-ACC
  5117         GO TO 0800-BREAK-2.
  5118
  5119     GO TO 0780-BREAK-1.
  5120
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS043RET.cbl
  5122 0770-BREAK-RETURN.
  5123     PERFORM 0740-MOVE-SW-REC.
  5124
  5125     IF SW-CTL = HIGH-VALUES
  5126         PERFORM 0880-BREAK-6
  5127         GO TO 1080-E-O-J
  5128     ELSE
  5129         IF SW-RPT-TYPE-ID = 'B'
  5130             PERFORM 0880-BREAK-6
  5131             GO TO 0900-PRINT-GROUP-TOTALS
  5132         ELSE
  5133             IF SW-RPT-TYPE-ID = 'C'
  5134                 PERFORM 0880-BREAK-6
  5135                 GO TO 0990-PRINT-GA-TOTALS
  5136             ELSE
  5137                 GO TO 0760-CHECK-BREAK.
  5138
  5139 0780-BREAK-1.
  5140     MOVE 'X'            TO BREAK-1-SWITCH.
  5141     MOVE '1'            TO HEAD-SW.
  5142     MOVE 'FROM      TO' TO H4-FT.
  5143     MOVE +1             TO SG.
  5144     MOVE +3             TO SF.
  5145     MOVE +1             TO SH.
  5146
  5147     IF DTE-CLIENT NOT = 'ITG'
  5148         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5149
  5150     IF (FC-CODE = '1' OR '5' OR '6')
  5151         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5152         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5153     END-IF.
  5154
  5155     MOVE +1 TO SC.
  5156     MOVE +7 TO SF.
  5157     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5158     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5159                          UNTIL SB GREATER 6.
  5160
  5161 0790-BREAD-1-EXIT.
  5162     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS043RET.cbl
  5164
  5165 0800-BREAK-2.
  5166     IF BREAK-1-SWITCH NOT = ' '
  5167         PERFORM 0780-BREAK-1
  5168     ELSE
  5169         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  5170         IF (FC-CODE = '1' OR '5' OR '6')
  5171             WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5172             PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5173         END-IF
  5174         MOVE +1 TO SC
  5175         MOVE +7 TO SF
  5176         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  5177         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5178                              UNTIL SB GREATER 6.
  5179
  5180     MOVE SPACES TO BREAK-1-SWITCH.
  5181     MOVE '2'    TO HEAD-SW.
  5182
  5183     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5184                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5185
  5186     IF FC-CODE = ' '  OR  '5'
  5187         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  5188     IF FC-CODE = '1'
  5189         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  5190     IF FC-CODE = '2'
  5191         IF RD-MO = 01 OR 04 OR 07 OR 10
  5192             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  5193         ELSE
  5194             IF RD-MO = 02 OR 05 OR 08 OR 11
  5195                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  5196             ELSE
  5197                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5198     IF FC-CODE = '3'
  5199         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5200     IF FC-CODE = '4'
  5201         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  5202     IF FC-CODE = '6'
  5203         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  5204
  5205     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  5206         MOVE +2   TO SG
  5207         MOVE +9   TO SF
  5208         MOVE +1   TO SH
  5209         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  5210         MOVE +7   TO SC
  5211         MOVE +13  TO SF
  5212         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5213
  5214     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5215                          UNTIL SB GREATER 12.
  5216
  5217 0810-BREAK-2-EXIT.
  5218     GO TO 0770-BREAK-RETURN.
  5219
  5220 0820-BREAK-3.
  5221     PERFORM 0800-BREAK-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS043RET.cbl
  5222     MOVE '3'           TO HEAD-SW.
  5223     MOVE WS-SAVE-ST    TO H8-ST.
  5224     MOVE HEAD-8-STATE  TO H2-ADDR.
  5225     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  5226     MOVE +3            TO SG.
  5227     MOVE +15           TO SF.
  5228     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5229     MOVE +13           TO SC.
  5230     MOVE +19           TO SF.
  5231     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5232     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5233                          UNTIL SB GREATER 18.
  5234
  5235     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  5236     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  5237
  5238 0830-BREAK-3-EXIT.
  5239     GO TO 0770-BREAK-RETURN.
  5240
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS043RET.cbl
  5242 0840-BREAK-4.
  5243     PERFORM 0820-BREAK-3.
  5244     MOVE '4'         TO HEAD-SW.
  5245     MOVE WS-SAVE-CMP TO H8-COMP.
  5246     MOVE HEAD-8-COMP TO H2-ADDR.
  5247     MOVE +4          TO SG.
  5248     MOVE +21         TO SF.
  5249     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5250     MOVE +19         TO SC.
  5251     MOVE +25         TO SF.
  5252     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5253     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  5254                          UNTIL SB GREATER 24.
  5255
  5256 0850-BREAK-4-EXIT.
  5257     GO TO 0770-BREAK-RETURN.
  5258
  5259 0860-BREAK-5.
  5260     PERFORM 0840-BREAK-4.
  5261     MOVE '5'         TO HEAD-SW.
  5262     MOVE WS-SAVE-CAR TO H8-CARR.
  5263     MOVE HEAD-8-CARR TO H2-ADDR.
  5264     MOVE +5          TO SG.
  5265     MOVE +27         TO SF.
  5266     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5267     MOVE +25         TO SC.
  5268     MOVE +31         TO SF.
  5269     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5270     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  5271                          UNTIL SB GREATER 30.
  5272
  5273 0870-BREAK-5-EXIT.
  5274     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS043RET.cbl
  5276
  5277 0880-BREAK-6.
  5278     PERFORM 0860-BREAK-5.
  5279     MOVE '6'          TO HEAD-SW.
  5280     MOVE HEAD-8-FINAL TO H2-ADDR.
  5281     MOVE +6           TO SG.
  5282     MOVE +33          TO SF.
  5283     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5284
  5285 0890-BREAK-6-EXIT.
  5286     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS043RET.cbl
  5288
  5289 0900-PRINT-GROUP-TOTALS.
  5290     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5291                          UNTIL SB GREATER 36.
  5292     MOVE 'B' TO H1-REPORT-SUF.
  5293     PERFORM 0740-MOVE-SW-REC.
  5294
  5295 0910-CHECK-GROUP-BREAK.
  5296     IF SW-GA NOT = WS-SAVE-GA
  5297         GO TO 0970-BREAK-GROUP-3.
  5298
  5299     IF SW-CARR  NOT = WS-SAVE-CAR OR
  5300        SW-COMP  NOT = WS-SAVE-CMP OR
  5301        SW-STATE NOT = WS-SAVE-ST  OR
  5302        SW-ACCT  NOT = WS-SAVE-ACC
  5303           GO TO 0950-BREAK-GROUP-2.
  5304
  5305     GO TO 0930-BREAK-GROUP-1.
  5306
  5307 0920-BREAK-GROUP-RETURN.
  5308     PERFORM 0740-MOVE-SW-REC.
  5309
  5310     IF SW-CTL = HIGH-VALUES
  5311         PERFORM 0970-BREAK-GROUP-3
  5312         GO TO 1080-E-O-J
  5313     ELSE
  5314         IF SW-RPT-TYPE-ID = 'C'
  5315             PERFORM 0970-BREAK-GROUP-3
  5316             GO TO 0990-PRINT-GA-TOTALS
  5317         ELSE
  5318             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS043RET.cbl
  5320
  5321 0930-BREAK-GROUP-1.
  5322     MOVE +1 TO SC.
  5323     MOVE +7 TO SF.
  5324     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5325     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5326                          UNTIL SB GREATER 6.
  5327
  5328 0940-BREAK-GROUP-1-EXIT.
  5329     GO TO 0920-BREAK-GROUP-RETURN.
  5330
  5331 0950-BREAK-GROUP-2.
  5332     PERFORM 0930-BREAK-GROUP-1.
  5333     MOVE '2'    TO HEAD-SW.
  5334     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5335                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5336     MOVE +2     TO SG.
  5337     MOVE +9     TO SF.
  5338     MOVE +1     TO SH.
  5339     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5340*
  5341***rpt-type a = rpt 43a, b = rpt 43b
  5342*     IF SW-RPT-TYPE-ID = 'A' AND
  5343*       (FC-CODE = '1' OR '5' OR '6')
  5344*         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5345*         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5346*     END-IF.
  5347*
  5348     MOVE +7     TO SC.
  5349     MOVE +13    TO SF.
  5350     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5351     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5352                          UNTIL SB GREATER 12.
  5353
  5354 0960-BREAK-GROUP-2-EXIT.
  5355     GO TO 0920-BREAK-GROUP-RETURN.
  5356
  5357 0970-BREAK-GROUP-3.
  5358     PERFORM 0950-BREAK-GROUP-2.
  5359     MOVE '3'        TO HEAD-SW.
  5360     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5361     MOVE '  GROUP'  TO H-8-G.
  5362
  5363     IF ZON = 'ZON'
  5364         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5365         MOVE '  ZONE' TO H-8-G.
  5366*
  5367*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5368*  SEPARATE PAGE BY ITSELF.
  5369*
  5370     MOVE '1'              TO X.
  5371     MOVE SPACE-LINE       TO P-DATA.
  5372     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5373
  5374     MOVE HEAD-8-GROUP TO H2-ADDR.
  5375     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5376     MOVE +3           TO SG.
  5377     MOVE +15          TO SF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS043RET.cbl
  5378     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5379*
  5380*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5381*  SEPARATE PAGE BY ITSELF.
  5382*
  5383     MOVE '1'              TO X.
  5384     MOVE SPACE-LINE       TO P-DATA.
  5385     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5386
  5387     MOVE +13          TO SC.
  5388     MOVE +19          TO SF.
  5389     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5390     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5391                          UNTIL SB GREATER 18.
  5392
  5393 0980-BREAK-GROUP-3-EXIT.
  5394     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS043RET.cbl
  5396 0990-PRINT-GA-TOTALS.
  5397     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5398                          UNTIL SB GREATER 36.
  5399     MOVE 'C' TO H1-REPORT-SUF.
  5400     PERFORM 0740-MOVE-SW-REC.
  5401
  5402 1000-CHECK-GA-BREAK.
  5403     IF SW-GA NOT = WS-SAVE-GA
  5404         GO TO 1060-BREAK-GA-3.
  5405
  5406     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5407        SW-COMP  NOT = WS-SAVE-CMP  OR
  5408        SW-STATE NOT = WS-SAVE-ST   OR
  5409        SW-ACCT  NOT = WS-SAVE-ACC
  5410           GO TO 1040-BREAK-GA-2.
  5411
  5412     GO TO 1020-BREAK-GA-1.
  5413
  5414 1010-BREAK-GA-RETURN.
  5415     PERFORM 0740-MOVE-SW-REC.
  5416
  5417     IF SW-CTL = HIGH-VALUES
  5418         PERFORM 1060-BREAK-GA-3
  5419         GO TO 1080-E-O-J.
  5420
  5421     GO TO 1000-CHECK-GA-BREAK.
  5422
  5423 1020-BREAK-GA-1.
  5424     MOVE +1 TO SC.
  5425     MOVE +7 TO SF.
  5426     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5427     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5428                          UNTIL SB GREATER 6.
  5429
  5430 1030-BREAK-GA-1-EXIT.
  5431     GO TO 1010-BREAK-GA-RETURN.
  5432
  5433 1040-BREAK-GA-2.
  5434     PERFORM 1020-BREAK-GA-1.
  5435
  5436     IF LIFE-RETENT = ZERO
  5437         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5438
  5439     IF AH-RETENT = ZERO
  5440         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5441
  5442     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5443     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5444
  5445     MOVE '2' TO HEAD-SW.
  5446     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5447                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5448
  5449     MOVE +2 TO SG.
  5450     MOVE +9 TO SF.
  5451     MOVE +1 TO SH.
  5452     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5453
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS043RET.cbl
  5454     IF PA-NBA (7) LESS +0
  5455         ADD PA-NBA (7) TO PA-NBA (8)
  5456         MOVE +0 TO PA-NBA (7)
  5457         IF PA-NBA (8) LESS +0
  5458             MOVE +0 TO PA-NBA (8).
  5459
  5460     IF PA-NBA (8) LESS +0
  5461         ADD PA-NBA (8) TO PA-NBA (7)
  5462         MOVE +0 TO PA-NBA (8)
  5463         IF PA-NBA (7) LESS +0
  5464             MOVE +0 TO PA-NBA (7).
  5465
  5466     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5467
  5468     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5469         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5470
  5471     IF PA-NBA (10) LESS +0
  5472         ADD PA-NBA (10) TO PA-NBA (11)
  5473         MOVE +0 TO PA-NBA (10)
  5474         IF PA-NBA (11) LESS +0
  5475             MOVE +0 TO PA-NBA (11).
  5476
  5477     IF PA-NBA (11) LESS +0
  5478         ADD PA-NBA (11) TO PA-NBA (10)
  5479         MOVE +0 TO PA-NBA (11)
  5480         IF PA-NBA (10) LESS +0
  5481             MOVE +0 TO PA-NBA (10).
  5482
  5483     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5484
  5485     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5486         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5487
  5488     MOVE +7  TO SC.
  5489     MOVE +13 TO SF.
  5490     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5491     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5492                          UNTIL SB GREATER 12.
  5493
  5494 1050-BREAK-GA-2-EXIT.
  5495     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS043RET.cbl
  5497
  5498 1060-BREAK-GA-3.
  5499     PERFORM 1040-BREAK-GA-2.
  5500     MOVE '3'        TO HEAD-SW.
  5501     MOVE WS-SAVE-GA TO H8-GA.
  5502     MOVE HEAD-8-GA  TO H2-ADDR.
  5503     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5504*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5505
  5506     IF DTE-CLIENT = 'GIC'
  5507         MOVE 'P' TO SAVE-RET-TYP
  5508     ELSE
  5509         MOVE 'E' TO SAVE-RET-TYP.
  5510
  5511     MOVE +3    TO SG.
  5512     MOVE +15   TO SF.
  5513     MOVE +2    TO SH.
  5514     MOVE LIFE-RETENT TO RETENT-FACT.
  5515     MOVE +13   TO SC.
  5516     MOVE +15   TO SF.
  5517     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5518     MOVE AH-RETENT TO RETENT-FACT.
  5519     MOVE +14   TO SC.
  5520     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5521     MOVE LIFE-RETENT TO RETENT-FACT.
  5522     MOVE +16   TO SC.
  5523     MOVE +18   TO SF.
  5524     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5525     MOVE AH-RETENT TO RETENT-FACT.
  5526     MOVE +17 TO SC.
  5527     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5528
  5529     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5530     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5531
  5532     MOVE +15 TO SF.
  5533
  5534     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5535     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5536                          UNTIL SB GREATER 18.
  5537
  5538 1070-BREAK-GA-3-EXIT.
  5539     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS043RET.cbl
  5541 1080-E-O-J.
  5542     CLOSE
  5543         PRNTR.
  5544     CLOSE DATA-OUT.
  5545
  5546 1090-CLOSE-FICH.
* 5547                             COPY ELCPRTC.
  5548******************************************************************04/15/98
  5549*                                                                *ELCPRTC
  5550*                                                                *ELCPRTC
  5551*                            ELCPRTC.                            *   LV003
  5552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5553*                            VMOD=2.002                          *   CL**2
  5554*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5555*                                                                *ELCPRTC
  5556* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5557******************************************************************ELCPRTC
  5558                                                                  ELCPRTC
  5559      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5560          CLOSE FICH.                                             ELCPRTC
  5561                                                                  ELCPRTC
  5562******************************************************************ELCPRTC
  5563
  5564 1090-CLOSE-EXIT.
  5565     EXIT.
  5566
  5567 3300-INIT-DATA-OUT.
  5568     MOVE SPACES TO DO-CARRIER
  5569                    DO-COMP
  5570                    DO-STATE
  5571                    DO-ACCOUNT-NUM
  5572                    DO-GROUP
  5573                    DO-ACCOUNT-NAME
  5574                    DO-PERIOD
  5575                    DO-PREM-P-E
  5576                    DO-CLAIM-P-I
  5577                    DO-RETRO-Y-N
  5578                    DO-RETRO-P-E
  5579                    DO-TAX-P-E.
  5580
  5581*     MOVE ZEROS  TO DO-RET-PCT
  5582*                    DO-ITD-RET-PCT
  5583*                    DO-LIFE-RETENT
  5584*                    DO-AH-RETENT.
  5585
  5586     PERFORM VARYING WS-DO-SUB FROM 1 BY 1 UNTIL
  5587                     WS-DO-SUB > 4
  5588          MOVE SPACES TO DO-DESCR (WS-DO-SUB)
  5589          MOVE ZEROS  TO DO-PERLFP (WS-DO-SUB)
  5590                         DO-ITDLFP (WS-DO-SUB)
  5591                         DO-PERAHP (WS-DO-SUB)
  5592                         DO-ITDAHP (WS-DO-SUB)
  5593                         DO-PERLFE (WS-DO-SUB)
  5594                         DO-ITDLFE (WS-DO-SUB)
  5595                         DO-PERAHE (WS-DO-SUB)
  5596                         DO-ITDAHE (WS-DO-SUB)
  5597     END-PERFORM.
  5598
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS043RET.cbl
  5599     MOVE +0     TO WS-DO-SUB.
  5600
  5601 3399-EXIT.
  5602     EXIT.
  5603
* 5604 COPY ELCDCS.
  5605****************************************************************  04/15/98
  5606*                                                              *  ELCDCS
  5607*                                                              *  ELCDCS
  5608*                            ELCDCS.                           *     LV003
  5609*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5610*                            VMOD=2.002                        *     CL**3
  5611*                                                              *  ELCDCS
  5612*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5613****************************************************************. ELCDCS
  5614                                                                  ELCDCS
  5615 8510-DATE-CONVERSION.                                            ELCDCS
  5616     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5617                                                                  ELCDCS
  5618 8590-EXIT.                                                       ELCDCS
  5619     EXIT.                                                        ELCDCS
  5620                                                                  ELCDCS
  5621
  5622 ABEND-PGM SECTION.
* 5623                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       70292     Code:       33115
