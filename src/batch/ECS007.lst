* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS007.cbl
* Options: int("ECS007.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS007.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS007.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS007.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS007.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*    THIS PROGRAM READS THE DUE PREMIUM AND COMMISSION FILE
     8*    THAT WAS UPDATED IN PROGRAM ECS056 AND REPORTS THE
     9*    DIFFERENCES BETWEEN COLLECTED AND CALCULATED.
    10******************************************************************
    11*                   C H A N G E   L O G
    12*
    13* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    14*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS007.cbl
    15*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    16* EFFECTIVE    NUMBER
    17*-----------------------------------------------------------------
    18* 080309  2009010500003    PEMA  CHECK FOR NON 0 B4 DIVIDE
    19******************************************************************
    21 ENVIRONMENT DIVISION.
    22 INPUT-OUTPUT SECTION.
    23 FILE-CONTROL.
    24
    25     SELECT DISK-DATE            ASSIGN TO SYS019.
    26     SELECT PRINTX               ASSIGN TO SYS008.
    27     SELECT FICH                 ASSIGN TO SYS020.
    28     SELECT ERDUEP               ASSIGN TO ERDUEP
    29            ACCESS IS DYNAMIC
    30            ORGANIZATION IS INDEXED
    31            FILE STATUS IS ERDUEP-FILE-STATUS
    32            RECORD KEY IS DP-CONTROL-PRIMARY.
    33
    34 DATA DIVISION.
    35 FILE SECTION.
    36
    37
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS007.cbl
    39 FD  DISK-DATE
*   40                                 COPY ELCDTEFD.
    41******************************************************************04/15/98
    42*                                                                *ELCDTEFD
    43*                                                                *ELCDTEFD
    44*                            ELCDTEFD.                           *   LV002
    45*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    46*                            VMOD=2.007                          *   CL**2
    47*                                                                *ELCDTEFD
    48******************************************************************ELCDTEFD
    49     BLOCK CONTAINS 0 RECORDS
    50     RECORDING MODE F.                                            ELCDTEFD
    51                                                                  ELCDTEFD
    52 01  DATE-DISK.                                                   ELCDTEFD
    53     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    54     12  FILLER                      PIC  X(14).                  ELCDTEFD
    55     12  DD-CR1                      PIC  9.                      ELCDTEFD
    56     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    57     12  DD-CR2                      PIC  9.                      ELCDTEFD
    58     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    59     12  FILLER                      PIC  X(20).                  ELCDTEFD
    60                                                                  ELCDTEFD
    61 01  DATE-DISK-R.                                                 ELCDTEFD
    62     12  FILLER                      PIC  X(4).                   ELCDTEFD
    63     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    64                                     PIC  X(32).                  ELCDTEFD
    65                                                                  ELCDTEFD
    66 01  DATE-DISK-T.                                                 ELCDTEFD
    67     12  FILLER                      PIC  X(4).                   ELCDTEFD
    68     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    69                                     PIC  X(48).                  ELCDTEFD
    70                                                                  ELCDTEFD
    71 01  DATE-DISK-M.                                                 ELCDTEFD
    72     12  FILLER                      PIC  X(4).                   ELCDTEFD
    73     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    74                                     PIC  X(48).                  ELCDTEFD
    75                                                                  ELCDTEFD
    76 01  DATE-DISK-P.                                                 ELCDTEFD
    77     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    78     12  DD-IDX                      PIC  99.                     ELCDTEFD
    79     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    80     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    81         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    82                                     PIC  X.                      ELCDTEFD
    83         16  FILLER                  PIC  X(46).                  ELCDTEFD
    84     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    85         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    86             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    87             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    88             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    89             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    90         16  FILLER                  PIC  X(16).                  ELCDTEFD
    91                                                                  ELCDTEFD
    92 01  DATE-DISK-E.                                                 ELCDTEFD
    93     12  FILLER                      PIC  X(4).                   ELCDTEFD
    94     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
    95                                     PIC  X(4).                   ELCDTEFD
    96                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    97 01  DATE-DISK-C.                                                 ELCDTEFD
    98     12  FILLER                      PIC  X(7).                   ELCDTEFD
    99     12  DD-CARR1-SECPAY-SW          PIC  X.
   100     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   101     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   102     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   103     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   104     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   105     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   106     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   107     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   108     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   109     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   110     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   111     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   112     12  DD-CARR2-SECPAY-SW          PIC  X.
   113     12  FILLER                      PIC  X(7).                   ELCDTEFD
   114                                                                  ELCDTEFD
   115 01  DATE-DISK-OPT.                                               ELCDTEFD
   116     12  FILLER                      PIC  X(04).                  ELCDTEFD
   117     12  DD-TLR-DATA.                                             ELCDTEFD
   118         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   119                                     PIC  X(03).                  ELCDTEFD
   120     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   121         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   122                                     PIC  X(06).                  ELCDTEFD
   123     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   124         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   125                                     PIC  X(07).                  ELCDTEFD
   126         16  FILLER                  PIC  X(05).                  ELCDTEFD
   127     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   128                                     PIC  X(96).                  ELCDTEFD
   129******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS007.cbl
   131 FD  PRINTX
*  132                                 COPY ELCPRTFD.
   133******************************************************************04/15/98
   134*                                                                *ELCPRTFD
   135*                                                                *ELCPRTFD
   136*                            ELCPRTFD.                           *   LV003
   137*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   138*                            VMOD=2.006                          *ELCPRTFD
   139******************************************************************ELCPRTFD
   140     RECORDING MODE F                                             ELCPRTFD
   141     LABEL RECORDS OMITTED                                        ELCPRTFD
   142     BLOCK CONTAINS 0 RECORDS
   143     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   144 01  PRT.                                                         ELCPRTFD
   145     12  P-CTL               PIC  X.                                 CL**2
   146     12  P-DATA              PIC  X(132).                         ELCPRTFD
   147******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS007.cbl
   149 FD  FICH
*  150                                 COPY ELCFCHFD.
   151******************************************************************04/15/98
   152*                                                                *ELCFCHFD
   153*                            ELCFCHFD.                           *   LV003
   154*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   155*                            VMOD=2.004                          *   CL**3
   156*                                                                *ELCFCHFD
   157******************************************************************ELCFCHFD
   158     BLOCK CONTAINS 0 RECORDS
   159     RECORDING MODE F.                                            ELCFCHFD
   160                                                                  ELCFCHFD
   161 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   162******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS007.cbl
   164 FD  ERDUEP.
*  165                                 COPY ERCDUEP.
   166******************************************************************
   167*                                                                *
   168*                                                                *
   169*                            ERCDUEP                             *
   170*                            VMOD=2.001                          *
   171*                                                                *
   172*   ONLINE CREDIT SYSTEM                                         *
   173*                                                                *
   174*   FILE DESCRIPTION = DUE PREMIUM MASTER                        *
   175*                                                                *
   176*   FILE TYPE = VSAM,KSDS                                        *
   177*   RECORD SIZE = 512   RECFORM = FIXED                          *
   178*                                                                *
   179*   BASE CLUSTER NAME = ERDUEP                   RKP=2,LEN=26    *
   180*       ALTERNATE PATH = NONE                                    *
   181*                                                                *
   182*   LOG = NO                                                     *
   183*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   184*                                                                *
   185******************************************************************
   186
   187 01  DUE-PREMIUM-RECORD.
   188     12  DP-RECORD-ID                          PIC XX.
   189         88  VALID-DP-ID                          VALUE 'DP'.
   190
   191     12  DP-CONTROL-PRIMARY.
   192         16  DP-COMPANY-CD                     PIC X.
   193         16  DP-CONTROL.
   194             20  DP-ACCOUNT-CONTROL.
   195                 24  DP-CARRIER                PIC X.
   196                 24  DP-GROUPING               PIC X(6).
   197                 24  DP-STATE                  PIC XX.
   198                 24  DP-ACCOUNT                PIC X(10).
   199             20  DP-KEY-FILLER                 PIC X(6).
   200
   201     12  DP-MAINT-INFORMATION.
   202         16  DP-LAST-MONTH-END-DT              PIC XX.
   203         16  DP-LAST-MAINT-DT                  PIC XX.
   204         16  DP-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   205         16  DP-LAST-MAINT-USER                PIC X(4).
   206         16  FILLER                            PIC X(10).
   207
   208     12  DP-FUTURE-SPACE                       PIC X(5).
   209         88  DP-FUTURE-NOT-USED                   VALUE '     '.
   210
   211     12  DP-LAST-EOM-STMT-DT                   PIC XX.
   212
   213     12  DP-LAST-ACTIVITY-DATE.
   214         16  DP-ACT-YEAR                       PIC 99.
   215         16  DP-ACT-MONTH                      PIC 99.
   216         16  DP-ACT-DAY                        PIC 99.
   217
   218     12  DP-MO-END-TOTALS.
   219         16  DP-MONTHLY-TOTALS.
   220             20  DP-BAL-FWD                PIC S9(7)V99   COMP-3.
   221             20  DP-EXP-PREM               PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS007.cbl (/apps/prod/cid1p/copy/ERCDUEP)
   222             20  DP-REC-PREM               PIC S9(7)V99   COMP-3.
   223             20  DP-ADJUSTMENTS            PIC S9(7)V99   COMP-3.
   224             20  DP-BASE-COMM              PIC S9(7)V99   COMP-3.
   225             20  DP-GA-COMM                PIC S9(7)V99   COMP-3.
   226             20  DP-END-BAL                PIC S9(7)V99   COMP-3.
   227
   228         16  DP-AGING-TOTALS.
   229             20  DP-CUR                    PIC S9(7)V99   COMP-3.
   230             20  DP-OV30                   PIC S9(7)V99   COMP-3.
   231             20  DP-OV60                   PIC S9(7)V99   COMP-3.
   232             20  DP-OV90                   PIC S9(7)V99   COMP-3.
   233
   234     12  FILLER                                PIC X(394).
   235
   236******************************************************************
   237
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS007.cbl
   239 WORKING-STORAGE SECTION.
   240 77  FILLER  PIC X(32) VALUE '********************************'.
   241 77  FILLER  PIC X(32) VALUE '      ECS007 WORKING STORAGE    '.
   242 77  FILLER  PIC X(32) VALUE '********************************'.
   243
   244 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   245     88  END-OF-ERDUEP              VALUE 'Y'.
   246     88  MORE-ERDUEP                VALUE 'N'.
   247 77  WS-A                       PIC S9(03) COMP-3 VALUE +0.
   248 77  IYR                         PIC S9(03) COMP-3 VALUE +0.
   249 77  VYR                         PIC S9(03) COMP-3 VALUE +0.
   250 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   251 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   252 77  SPACE-NP                    PIC X      VALUE '1'.
   253 77  SPACE-1                     PIC X      VALUE ' '.
   254 77  SPACE-2                     PIC X      VALUE '0'.
   255 77  SPACE-3                     PIC X      VALUE '-'.
   256 77  X                           PIC X      VALUE ' '.
   257 77  LNCTR                       PIC S999   VALUE +60 COMP-3.
   258 77  PGCTR                       PIC S9(5)  VALUE +0 COMP-3.
   259 77  ERDUEP-IN-CNT               PIC 9(11)   VALUE ZEROS.
   260 77  WS-BASE-PCT                 PIC S9V9(5) COMP-3 VALUE +0.
   261 77  WS-OW-PCT                   PIC S9V9(5) COMP-3 VALUE +0.
   262 77  WS-DUE-COMM                 PIC S9(9)V99 COMP-3 VALUE +0.
   263
   264 01  HD1.
   265     12  FILLER              PIC  X(44)      VALUE SPACES.
   266     12  FILLER              PIC  X(44)      VALUE
   267             '           EXPECTED DUE PREMIUM            '.
   268     12  FILLER              PIC  X(31)      VALUE SPACES.
   269     12  FILLER              PIC  X(08)      VALUE 'ECS007'.
   270
   271 01  HD2.
   272     12  FILLER              PIC  X(51)      VALUE SPACES.
   273     12  HD-CO               PIC  X(30).
   274     12  FILLER              PIC  X(38)      VALUE SPACES.
   275     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   276
   277 01  HD3.
   278     12  FILLER              PIC  X(57)      VALUE SPACES.
   279     12  HD-DT               PIC  X(18).
   280     12  FILLER              PIC  X(44)      VALUE SPACES.
   281     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   282     12  HD-PG               PIC ZZ,ZZ9.
   283
   284 01  HD4.
   285     12  FILLER              PIC  X(45)      VALUE
   286             '-- ACCOUNT TOTALS  --                   EXPEC'.
   287     12  FILLER              PIC  X(46)      VALUE
   288             'TED   RECEIVED                                '.
   289     12  FILLER              PIC  X(41)      VALUE
   290             '                                         '.
   291
   292 01  HD5.
   293     12  FILLER              PIC  X(45)      VALUE
   294             '--CAR GROUP  ST  ACCOUNT---             PREMI'.
   295     12  FILLER              PIC  X(46)      VALUE
   296             'UMS   PREMIUMS  ADJUSTMENTS   DIFFERENCE      '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS007.cbl
   297     12  FILLER              PIC  X(41)      VALUE
   298             '                                         '.
   299 01  DETAIL-LINE.
   300     05  FILLER                  PIC X(4).
   301     05  DTL1-CAR                PIC X.
   302     05  FILLER                  PIC X.
   303     05  DTL1-GRP                PIC X(6).
   304     05  FILLER                  PIC X.
   305     05  DTL1-ST                 PIC XX.
   306     05  FILLER                  PIC X.
   307     05  DTL1-ACCT               PIC X(10).
   308     05  FILLER                  PIC X.
   309     05  FILLER                  PIC X(11).
   310*    05  DTL1-BEG-BAL            PIC ZZZ,ZZ9.99-.
   311     05  FILLER                  PIC X.
   312     05  DTL1-EXP-PREM           PIC ZZZ,ZZ9.99.
   313     05  FILLER                  PIC X.
   314     05  DTL1-REC-PREM           PIC ZZZ,ZZ9.99.
   315     05  FILLER                  PIC X.
   316     05  DTL1-ADJS               PIC ZZZ,ZZ9.99-.
   317     05  FILLER                  PIC XXX.
   318     05  DTL1-END-BAL            PIC ZZZ,ZZ9.99-.
   319     05  FILLER                  PIC X.
   320     05  FILLER                  PIC X(11).
   321*    05  DTL1-DUE-LT90           PIC ZZZ,ZZ9.99-.
   322     05  FILLER                  PIC X.
   323     05  FILLER                  PIC X(11).
   324*    05  DTL1-DUE-GT90           PIC ZZZ,ZZ9.99-.
   325     05  FILLER                  PIC X.
   326     05  FILLER                  PIC X(11).
   327*    05  DTL1-COMM               PIC ZZZ,ZZ9.99-.
   328     05  FILLER                  PIC X(4).
   329     05  FILLER                  PIC XXX.
   330*    05  DTL1-NO-MOS             PIC ZZ9.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS007.cbl
   332 01  WS-DUE-PREM-TABLE.
   333     05  WS-RECORD.
   334         10  WS-CAR              PIC X.
   335         10  WS-GROUP            PIC X(6).
   336         10  WS-STATE            PIC XX.
   337         10  WS-ACCOUNT          PIC X(10).
   338         10  WS-EFF-DATE         PIC X(10).
   339         10  WS-CERT-NO          PIC X(11).
   340         10  WS-LF-BEN-CODE      PIC XX.
   341         10  WS-AH-BEN-CODE      PIC XX.
   342         10  WS-LF-TERM          PIC ZZ9.
   343         10  WS-AH-TERM          PIC ZZ9.
   344         10  WS-LF-EXP-DATE      PIC X(10).
   345         10  WS-AH-EXP-DATE      PIC X(10).
   346         10  WS-EXP-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   347         10  WS-REC-PREM         PIC S9(9)V99 COMP-3 VALUE +0.
   348         10  WS-BASE-COMM        PIC S9(7)V99 COMP-3 VALUE +0.
   349         10  WS-GA-COMM          PIC S9(7)V99 COMP-3 VALUE +0.
   350         10  WS-MISC1            PIC S9(7)V99 COMP-3 VALUE +0.
   351         10  WS-MISC2            PIC S9(7)V99 COMP-3 VALUE +0.
   352         10  WS-MISC3            PIC S9(7)V99 COMP-3 VALUE +0.
   353         10  WS-MISC4            PIC S9(7)V99 COMP-3 VALUE +0.
   354         10  WS-MISC5            PIC S9(7)V99 COMP-3 VALUE +0.
   355
   356 01  WS-MISC.
   357     05  ERDUEP-FILE-STATUS      PIC XX.
   358     05  WS-HOLD-PRT             PIC X(133).
   359     05  WS-DUEP-CONTROL         PIC X(19)    VALUE LOW-VALUES.
   360     05  WS-HOLD-CONTROL.
   361         10  WS-HOLD-CAR         PIC X.
   362         10  WS-HOLD-GRP         PIC X(6).
   363         10  WS-HOLD-ST          PIC XX.
   364         10  WS-HOLD-ACCT        PIC X(10).
   365     05  INTERMED                PIC S9(9)V9(6)  COMP-3.
   366     05  WS-REM-AMT              PIC S9(11)V99 COMP-3 VALUE +0.
   367     05  WS-DISPLAY-DATE         PIC ZZZ9(8).
   368     05  WS-DISPLAY-TERM         PIC Z99.
   369     05  WS-DISPLAY-RTERM        PIC Z99.99.
   370     05  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
   371     05  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
   372     05  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
   373     05  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
   374     05  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
   375     05  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
   376     05  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
   377     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
   378     05  FILLER REDEFINES WS-END-YEAR.
   379         10  WS-CCYY             PIC 9(7).
   380         10  WS-MMDD             PIC 9(4).
   381 01  WS-DEBUG-AREA.
   382     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
   383         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
   384         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
   385         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
   386         88  DEBUG-LF-STATUTORY         VALUE '3'.
   387         88  DEBUG-AH-STATUTORY         VALUE '4'.
   388
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS007.cbl
   390
   391
   392 01  WS-ABEND-AREA.
   393     05  WS-ABEND-FILE-STATUS    PIC X(02).
   394     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
   395     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
   396     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
   397
   398 01  WORK-ABEND-CODE.
   399     12  WAC-1                   PIC X.
   400     12  WAC-2                   PIC X.
   401     12  WAC-3-4.
   402         16  WAC-3               PIC X.
   403         16  WAC-4               PIC X.
   404
   405 01  WS-EXTRACT-RECORD.
*  406                                 COPY FNC022.
   407     05  FX-COMMON-SECTION.                                       00010001
   408         10  FX-SYSTEM             PIC X(10).                     00020001
   409         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   410         10  FX-DIVISION           PIC X(2).                      00040001
   411         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   412         10  FX-SUB-TYPE           PIC X(2).                      00060001
   413         10  FX-CLM-RES            PIC X(2).                      00070001
   414         10  FX-ANN-STMT           PIC X(3).                      00080001
   415         10  FX-PLAN-CODE          PIC X(6).                      00090001
   416         10  FX-FORM               PIC X(3).                      00091001
   417         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   418         10  FX-POSTING-DATE       PIC X(8).                      00093001
   419         10  FX-POLICY-NO          PIC X(10).                     00094001
   420         10  FX-CITY               PIC X(30).                     00095002
   421         10  FX-STATE              PIC X(2).                      00095102
   422         10  FX-ZIP-CODE           PIC X(9).                      00096001
   423         10  FX-LOC-CODE           PIC X.                         00096102
   424         10  FX-FY-REN             PIC X.                         00097001
   425         10  FX-AGENT-01           PIC X(9).                      00098001
   426         10  FX-AGENT-50           PIC X(9).                      00099001
   427         10  FX-COST-CENTER        PIC X(4).                      00100001
   428         10  FX-TAXABLE            PIC X.                         00110004
   429         10  FX-DISTR              PIC X(2).                      00120001
   430         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   431         10  FX-DESCRIPTION        PIC X(30).                     00140001
   432         10  FX-REFERENCE          PIC X(10).                     00150001
   433         10  FX-SUSPENSE           PIC X(15).                     00151002
   434         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   435                                   SIGN IS TRAILING SEPARATE.     00170001
   436                                                                  00180001
   437     05  FX-CLAIM-SECTION.                                        00190001
   438         10  FX-CLAIM-NO           PIC X(10).                     00200001
   439         10  FX-CLAIM-TYPE         PIC X.                         00210001
   440         10  FX-DRAFT-NO           PIC X(10).                     00220001
   441         10  FX-DRAFT-STATUS       PIC X.                         00230001
   442         10  FX-TAX-ID             PIC X(10).                     00240001
   443         10  FILLER                PIC X(10).                     00250003
   444                                                                  00290001
   445
   446
   447 01  DATE-AREAS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS007.cbl
   448     05  WS-TEST-RUN-DATE        PIC 9(11).
   449     05  WS-WORK-DATE            PIC 9(11).
   450     05  FILLER REDEFINES WS-WORK-DATE.
   451         10  FILLER              PIC XXX.
   452         10  WS-WORK-CCYY        PIC 9(4).
   453         10  WS-WORK-MMDD        PIC 9(4).
   454     05  WS-ISSUE-DATE           PIC 9(11).
   455     05  FILLER REDEFINES WS-ISSUE-DATE.
   456         10  FILLER              PIC XXX.
   457         10  WS-ISSUE-CCYY       PIC 9(4).
   458         10  WS-ISSUE-MMDD       PIC 9(4).
   459     05  WS-EXPIRE-DATE          PIC 9(11).
   460     05  FILLER REDEFINES WS-EXPIRE-DATE.
   461         10  FILLER              PIC XXX.
   462         10  WS-EXPIRE-CCYY      PIC 9(4).
   463         10  WS-EXPIRE-MMDD      PIC 9(4).
   464     05  WS-ENTRY-DATE           PIC 9(11).
   465     05  FILLER REDEFINES WS-ENTRY-DATE.
   466         10  FILLER              PIC XXX.
   467         10  WS-ENTRY-CCYY       PIC 9(4).
   468         10  WS-ENTRY-MMDD       PIC 9(4).
   469     05  WS-CANCEL-DATE          PIC 9(11).
   470     05  FILLER REDEFINES WS-CANCEL-DATE.
   471         10  FILLER              PIC XXX.
   472         10  WS-CANCEL-CCYY      PIC 9(4).
   473         10  WS-CANCEL-MMDD      PIC 9(4).
   474     05  WS-CLAIM-DATE           PIC 9(11).
   475     05  FILLER REDEFINES WS-CLAIM-DATE.
   476         10  FILLER              PIC XXX.
   477         10  WS-CLAIM-CCYY       PIC 9(4).
   478         10  WS-CLAIM-MMDD       PIC 9(4).
   479     05  WS-POSTING-DATE         PIC X(8).
   480     05  WS-HI-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   481     05  WS-LO-ISSUE-CCYY        PIC 9(4) VALUE ZEROS.
   482     05  WS-HI-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   483     05  WS-LO-VALUATION-CCYY    PIC 9(4) VALUE ZEROS.
   484     05  WS-BIN-VAL-DATES OCCURS 50
   485                                 PIC XX.
   486
   487 01  WS-MISC-AREA.
   488     12  WS-DP-EXP-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
   489     12  WS-DP-REC-PREM          PIC S9(9)V99 COMP-3 VALUE +0.
   490     12  WS-DP-GA-COMM           PIC S9(9)V99 COMP-3 VALUE +0.
   491     12  WS-DP-BASE-COMM         PIC S9(9)V99 COMP-3 VALUE +0.
   492*   1ST OCCURANCE           ACCOUNT TOTALS
   493*   2ND                     STATE
   494*   3RD                     GROUP
   495*   4TH                     CARRIER
   496*   5TH                     FINAL
   497     12  WS-TOTAL-TABLE OCCURS 5.
   498         16  WS-TOT-BAL-FWD      PIC S9(9)V99 COMP-3 VALUE +0.
   499         16  WS-TOT-EXP-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
   500         16  WS-TOT-REC-PREM     PIC S9(9)V99 COMP-3 VALUE +0.
   501         16  WS-TOT-GA-COMM      PIC S9(9)V99 COMP-3 VALUE +0.
   502         16  WS-TOT-BASE-COMM    PIC S9(9)V99 COMP-3 VALUE +0.
   503         16  WS-TOT-ADJS         PIC S9(9)V99 COMP-3 VALUE +0.
   504         16  WS-TOT-END-BAL      PIC S9(9)V99 COMP-3 VALUE +0.
   505         16  WS-TOT-DUE-COMM     PIC S9(9)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS007.cbl
   506     12  WS-DISPLAY-FLD          PIC 9(9).9(5).
   507     12  WS-LF-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   508     12  WS-AH-PRM               PIC S9(7)V99 COMP-3  VALUE +0.
   509
   510
   511 01  ABEND-FIELDS.
   512     12  PGM-SUB                 PIC S999 COMP  VALUE +064.
   513     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
   514         88  FIRST-TIME                 VALUE 'Y'.
   515
*  516                                 COPY ELCDATE.
   517******************************************************************06/11/98
   518*                                                                *ELCDATE
   519*                                                                *ELCDATE
   520*                            ELCDATE.                            *   LV023
   521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   522*                            VMOD=2.003                           ELCDATE
   523*                                                                *ELCDATE
   524*                                                                *ELCDATE
   525*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   526*                 LENGTH = 200                                   *   CL*19
   527******************************************************************ELCDATE
   528                                                                  ELCDATE
   529 01  DATE-CONVERSION-DATA.                                        ELCDATE
   530     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   531     12  DC-OPTION-CODE                PIC X.                        CL*15
   532         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   533         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   534         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   535         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   536         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   537         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   538         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   539         88  FIND-CENTURY               VALUE '7'.                   CL*22
   540         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   541         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   542         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   543         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   544         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   545         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   546         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   547         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   548         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   549         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   550         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   551         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   552         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   553         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   554         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   555         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   556         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   557         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   558         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   559         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   560         88  THREE-CHARACTER-BIN                                  ELCDATE
   561                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   562         88  GREGORIAN-TO-BIN                                        CL**2
   563                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDATE)
   564         88  BIN-TO-GREGORIAN                                        CL**2
   565                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   566         88  JULIAN-TO-BINARY                                        CL**2
   567                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   568     12  DC-ERROR-CODE                 PIC X.                        CL*15
   569         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   570         88  DATE-CONVERSION-ERROR                                ELCDATE
   571                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   572         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   573         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   574         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   575         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   576         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   577         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   578         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   579         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   580         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   581         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   582     12  DC-END-OF-MONTH               PIC X.                        CL*15
   583         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   584     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   585         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   586         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   587         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   588     12  FILLER                        PIC X.                        CL*15
   589     12  DC-CONVERSION-DATES.                                        CL*15
   590         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   591         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   592         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   593         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   594                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   595             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   596             20  SLASH1-1              PIC X.                        CL*15
   597             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   598             20  SLASH1-2              PIC X.                        CL*15
   599             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   600         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   601         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   602                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   603             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   604             20  SLASH2-1              PIC X.                        CL*15
   605             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   606             20  SLASH2-2              PIC X.                        CL*15
   607             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   608         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   609         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   610                     DC-GREG-DATE-1-YMD.                          ELCDATE
   611             20  DC-YMD-YEAR           PIC 99.                       CL*15
   612             20  DC-YMD-MONTH          PIC 99.                       CL*15
   613             20  DC-YMD-DAY            PIC 99.                       CL*15
   614         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   615         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   616                      DC-GREG-DATE-1-MDY.                         ELCDATE
   617             20  DC-MDY-MONTH          PIC 99.                       CL*15
   618             20  DC-MDY-DAY            PIC 99.                       CL*15
   619             20  DC-MDY-YEAR           PIC 99.                       CL*15
   620         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   621             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDATE)
   622             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   623             20  FILLER                PIC XX.                       CL*15
   624             20  DC-ALPHA-CENTURY.                                   CL*15
   625                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   626             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   627         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   628         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   629         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   630         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   631         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   632                                       PIC 9(05).                    CL*20
   633         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   634             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   635             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   636         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   637         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   638         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   639     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   640         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   641         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   642             20  FILLER                PIC 9(3).                     CL*15
   643             20  HOLD-CEN-1-CCYY.                                    CL*15
   644                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   645                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   646             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   647             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   648         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   649             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   650             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   651             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   652                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   653                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   654             20  FILLER                PIC 9(3).                     CL*15
   655         16  HOLD-CENTURY-1-X.                                       CL*15
   656             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   657             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   658                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   659                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   660             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   661             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   662         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   663             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   664             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   665             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   666                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   667                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   668             20  FILLER                PIC XXX.                      CL*23
   669         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   670         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   671         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   672         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   673             20  DC-JULIAN-1-CCYY.                                   CL*15
   674                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   675                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   676             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   677         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   678         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   679             20  DC-JULIAN-2-CCYY.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDATE)
   680                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   681                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   682             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   683         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   684             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   685             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   686             20  DC-EDITA-DAY          PIC 99.                       CL*15
   687             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   688             20  DC-EDITA-CCYY.                                      CL*15
   689                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   690                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   691         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   692             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   693             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   694             20  DC-EDITB-DAY          PIC 99.                       CL*15
   695             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   696             20  DC-EDITB-CCYY.                                      CL*15
   697                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   698                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   699         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   700         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   701                              DC-GREG-DATE-CYMD.                  ELCDATE
   702             20  DC-CYMD-CEN           PIC 99.                       CL*15
   703             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   704             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   705             20  DC-CYMD-DAY           PIC 99.                       CL*15
   706         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   707         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   708                              DC-GREG-DATE-MDCY.                  ELCDATE
   709             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   710             20  DC-MDCY-DAY           PIC 99.                       CL*15
   711             20  DC-MDCY-CEN           PIC 99.                       CL*15
   712             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   713    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   714        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   715    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   716    12  FILLER                         PIC X(28).                    CL*26
   717
*  718                                 COPY ELCDTECX.
   719******************************************************************06/05/98
   720*                                                                *ELCDTECX
   721*                            ELCDTECX.                           *   LV005
   722*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   723*                            VMOD=2.015                          *ELCDTECX
   724*                                                                *ELCDTECX
   725*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   726*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   727*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   728*                                                                *ELCDTECX
   729******************************************************************ELCDTECX
   730******************************************************************
   731*                   C H A N G E   L O G
   732*
   733* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   734*-----------------------------------------------------------------
   735*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   736* EFFECTIVE    NUMBER
   737*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   738* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   739*                                  BENEFIT CODES FROM 300 TO 900
   740* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   741* 051304    2003080800002  SMVA  ADD REFUND METHOD
   742* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   743******************************************************************
   744 01  DATE-CARD.                                                   ELCDTECX
   745     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   746     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   747     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   748     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   749     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   750     12  EP-SW                       PIC  X.                      ELCDTECX
   751         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   752     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   753         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   754     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   755     12  RUN-CENTURY.                                             ELCDTECX
   756         16 RUN-CENTURY-N            PIC  99.                        CL**4
   757     12  FILLER                      PIC  X.                         CL**4
   758     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   759     12  FILLER                      PIC  XXX.                    ELCDTECX
   760     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   761                                                                  ELCDTECX
   762 01  FILLER                          PIC  X(7)                       CL**6
   763                                          VALUE 'OPTIONS'.        ELCDTECX
   764 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   765     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   766     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   767     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   768         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   769         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   770     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   771     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   772     12  FILLER                      PIC  X.                      ELCDTECX
   773     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   774     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   775     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   776     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   777     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   778     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   779     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   780     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   781     12  FILLER                      PIC  X.                      ELCDTECX
   782     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   783     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   784     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   785     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   786     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   787     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   788     12  FILLER                      PIC  X.                      ELCDTECX
   789     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   790     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   791     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   792     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   793     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   794     12  DTE-R78                     PIC  X.                      ELCDTECX
   795     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   796     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   797     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   798     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   799     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   800     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   801     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   802                                     PIC  X.                      ELCDTECX
   803         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   804                                                 ' '.             ELCDTECX
   805         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   806         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   807     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   808         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   809         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   810     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   811     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   812                                     PIC  9.                         CL**4
   813     12  DTE-SYSTEM.                                              ELCDTECX
   814         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   815         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   816         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   817         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   818         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   819         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   820         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   821         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   822         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   823         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   824         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   825         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   826         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   827         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   828         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   829         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   830         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   831         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   832         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   833         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   834         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   835         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   836         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   837         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   838         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   839         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   840     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   841         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   842                                     PIC  X.                      ELCDTECX
   843     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   844                                                                  ELCDTECX
   845 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   846     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   847     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   848     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   849*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   850     12  FILLER                      PIC  X.                      ELCDTECX
   851     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   852     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   853     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   854     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   855     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   856     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   857     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   858                                                                  ELCDTECX
   859     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   860     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   861     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   862     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   863                                                                  ELCDTECX
   864     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   865     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   866     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   867     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   868                                                                  ELCDTECX
   869     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   870     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   871                                                                  ELCDTECX
   872     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   873     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   874                                                                  ELCDTECX
   875     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   876                                                                  ELCDTECX
   877 01  DATE-CARD-FACTORS.                                           ELCDTECX
   878     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   879     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   880     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   881     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   882     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   883     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   884     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   885                                                                  ELCDTECX
   886 01  FILLER                          PIC  X(12)                   ELCDTECX
   887                                          VALUE 'COMPANY NAME'.   ELCDTECX
   888 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   889     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   890         16  CNT-ID                  PIC  X.                      ELCDTECX
   891         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   892                                                                  ELCDTECX
   893 01  FILLER                          PIC  X(11)                   ELCDTECX
   894                                          VALUE 'STATE NAMES'.    ELCDTECX
   895 01  STATE-NAMES.                                                 ELCDTECX
   896     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   897         16  STATE-SUB               PIC  XX.                     ELCDTECX
   898         16  STATE-PIC1.                                          ELCDTECX
   899             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   900             20  FILLER              PIC  XXX.                    ELCDTECX
   901             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   902             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   903             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   904             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   905                                                                  ELCDTECX
   906 01  FILLER                          PIC  X(13)                   ELCDTECX
   907                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   908 01  CARRIER-NAMES.                                               ELCDTECX
   909     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   910         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   911         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   912         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   913         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   914         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   915         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   916*        16  FILLER                  PIC  X.                      ELCDTECX
   917         16  CARRIER-SEC-PAY         PIC  X.
   918             88  SEC-PAY-CARRIER          VALUE 'Y'.
   919                                                                  ELCDTECX
   920 01  FILLER                          PIC  X(9)                       CL**6
   921                                          VALUE 'INS TYPES'.      ELCDTECX
   922 01  CLAS-INS-TYPES.                                              ELCDTECX
   923*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   924     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   925         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   926         16  CLAS-I-AB3.                                          ELCDTECX
   927             20  FILLER              PIC  X.                      ELCDTECX
   928             20  CLAS-I-AB2.                                      ELCDTECX
   929                 24  FILLER          PIC  X.                      ELCDTECX
   930                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   931         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   932             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   933             20  FILLER              PIC  X.                         CL**4
   934         16  CLAS-I-AB10.                                         ELCDTECX
   935             20  FILLER              PIC  X(9).                   ELCDTECX
   936             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   937         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   938         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   939         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   940         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   941             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   942         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   943         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   944         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   945         16  CLAS-I-BEN-CATEGORY     PIC  X.
   946         16  CLAS-I-REFUND-METHOD    PIC  X.
   947         16  CLAS-I-MAX-BENEFITS     PIC 99.
   948         16  FILLER                  PIC  XXX.
   949                                                                  ELCDTECX
   950 01  FILLER                          PIC  X(16)                   ELCDTECX
   951                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   952 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   953     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   954                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   955         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   956         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   957         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   958         16  CLAS-MORT-DESC.                                      ELCDTECX
   959             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   960             20  FILLER              PIC  XX.                        CL**5
   961             20  CLAS-YEAR           PIC  X(4).                      CL**6
   962             20  FILLER              PIC  X.                         CL**5
   963             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   964             20  FILLER              PIC  X.                         CL**5
   965             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   966             20  FILLER              PIC  X.                         CL**5
   967             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   968             20  FILLER              PIC  X(5).                      CL**6
   969                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   970 01  FILLER                          PIC  X(15)                   ELCDTECX
   971                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   972 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   973     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   974         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   975         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   976         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   977         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   978         16  FILLER                  PIC  X(4).                      CL**6
   979                                                                  ELCDTECX
   980 01  FILLER                          PIC  X(7)                       CL**6
   981                                     VALUE 'INDEXES'.             ELCDTECX
   982 01  CLAS-INDEX-TBL.                                              ELCDTECX
   983     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   984     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   985     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   986     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   987     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   988     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   989     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   990     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   991     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   992     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   993     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   994     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   995     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   996     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   997     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   998     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   999     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1000                                                                  ELCDTECX
  1001 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1002     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1003     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1004     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1005     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1006     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1007     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1008     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1009     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1010     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1011     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1012     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1013                                                                  ELCDTECX
  1014 01  FILLER                          PIC  X(13)                   ELCDTECX
  1015                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1016 01  CLAS-MISC.                                                   ELCDTECX
  1017     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1018         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1019         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1020         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1021     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1022     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1023     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1024     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1025     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1026     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1027     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1028     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1029     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1030     12  STATE-L                     PIC  XX.                     ELCDTECX
  1031     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1032     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1033     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1034         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1035         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1036     12  DTE-ABEND-WORK.                                          ELCDTECX
  1037         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1038         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1039                                                                  ELCDTECX
  1040 01  FILLER                          PIC  X(12)                   ELCDTECX
  1041                                     VALUE 'WORKING DATE'.        ELCDTECX
  1042 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1043     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1044         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1045         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1046         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1047     12  WS-CURRENT-DATE.                                         ELCDTECX
  1048         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1049         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1050         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1051         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1052         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1053     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1054         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1055         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1056                                                                  ELCDTECX
  1057 01  FILLER                          PIC  X(12)                   ELCDTECX
  1058                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1059 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1060     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1061         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1062         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1063         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1064                                                                  ELCDTECX
  1065 01  FILLER                          PIC  X(10)                   ELCDTECX
  1066                                     VALUE 'STATE TLRS'.          ELCDTECX
  1067 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1068     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1069         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1070         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1071                                                                  ELCDTECX
  1072 01  FILLER                          PIC  X(13)                   ELCDTECX
  1073                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1074 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1075     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1076         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1077                                                                  ELCDTECX
  1078 01  FILLER                          PIC  X(13)                   ELCDTECX
  1079                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1080 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1081     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1082     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1083     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1084                                     PIC  X.                         CL**5
  1085     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1086     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1087     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1088     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1089     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1090     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1091     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1092     12  FILLER                      PIC  X(75).                  ELCDTECX
  1093******************************************************************ELCDTECX
  1094*01  MISC-CARR-PCT-DATA.                                          00001521
  1095*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1096*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1097*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1098*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1099*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1100*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1101******************************************************************ELCDTECX
  1102
* 1103                                 COPY ELCDTEVR.
  1104***************************************************************** 04/15/98
  1105*                                                                *ELCDTEVR
  1106*                                                                *ELCDTEVR
  1107*                            ELCDTEVR.                           *   LV003
  1108*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1109*                            VMOD=2.001                          *   CL**2
  1110*                                                                *ELCDTEVR
  1111*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1112*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1113*                                                                *ELCDTEVR
  1114******************************************************************ELCDTEVR
  1115 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1116     05  WS-RUN-DATE.                                             ELCDTEVR
  1117         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1118         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1119         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1120             15  RUN-CC              PIC  99.                     ELCDTEVR
  1121             15  RUN-YR              PIC  99.                     ELCDTEVR
  1122         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1123         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1124     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1125            WS-RUN-DATE              PIC 9(11).                      CL**2
  1126     05  WS-EP-DT.                                                ELCDTEVR
  1127         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1128         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1129         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1130             15  EP-CC               PIC  99.                     ELCDTEVR
  1131             15  EP-YR               PIC  99.                     ELCDTEVR
  1132         10  EP-MO                   PIC  99.                     ELCDTEVR
  1133         10  EP-DA                   PIC  99.                     ELCDTEVR
  1134     05  WS-EP-DT-N REDEFINES                                        CL**2
  1135            WS-EP-DT                 PIC 9(11).                      CL**2
  1136     05  WS-DTE-CONV-DT.                                             CL**4
  1137         10  FILLER                  PIC  9(03).                     CL**4
  1138         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1139         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1140             15  DTE-CONV-CC         PIC  99.                        CL**4
  1141             15  DTE-CONV-YR         PIC  99.                        CL**4
  1142         10  DTE-CONV-MO             PIC  99.                        CL**4
  1143         10  DTE-CONV-DA             PIC  99.                        CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1144     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1145            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1146 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1147     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1148         10  FILLER                            PIC 999.           ELCDTEVR
  1149         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1150         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1151             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1152             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1153         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1154         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1155     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1156            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1157     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1158         10  FILLER                            PIC 999.           ELCDTEVR
  1159         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1160         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1161         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1162         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1163     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1164            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1165 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1166     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1167         10  FILLER                            PIC 999.           ELCDTEVR
  1168         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1169         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1170             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1171             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1172         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1173         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1174     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1175            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1176     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1177         10  FILLER                            PIC 999.           ELCDTEVR
  1178         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1179         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1180             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1181             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1182         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1183         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1184     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1185            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1186     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1187         10  FILLER                            PIC 999.           ELCDTEVR
  1188         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1189         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1190             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1191             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1192         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1193         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1194     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1195            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1196 01  WS-RATE-RECORD.                                              ELCDTEVR
  1197         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1198             10  FILLER                        PIC 999.           ELCDTEVR
  1199             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1200             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1201                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1202                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1203             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1204             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1205         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1206                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1207
  1208 PROCEDURE DIVISION.
  1209
  1210 0001-DT-CRD-READ SECTION.
* 1211                                 COPY ELCDTERX.
  1212******************************************************************04/15/98
  1213*                                                                *ELCDTERX
  1214*                                                                *ELCDTERX
  1215*                            ELCDTERX.                           *   LV002
  1216*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1217*                            VMOD=2.007                          *ELCDTERX
  1218*                                                                *ELCDTERX
  1219*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1220*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1221*      = ELCDTEFD)                                               *ELCDTERX
  1222*                                                                *ELCDTERX
  1223******************************************************************ELCDTERX
  1224                                                                  ELCDTERX
  1225     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1226                                                                  ELCDTERX
  1227     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1228     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1229     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1230                                                                  ELCDTERX
  1231     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1232                                                                  ELCDTERX
  1233******************************************************************ELCDTERX
  1234*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1235*          WARNING MESSAGES.                                      ELCDTERX
  1236******************************************************************ELCDTERX
  1237     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1238         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1239                                                                  ELCDTERX
  1240     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1241                                                                  ELCDTERX
  1242     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1243                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1244                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1245                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1246                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1247                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1248                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1249                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1250                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1251                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1252                                                                  ELCDTERX
  1253     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1254                                                                  ELCDTERX
  1255     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1256                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1257                                                                  ELCDTERX
  1258     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1259     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1260     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1261     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1262                                                                  ELCDTERX
  1263     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1264         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1265     ELSE                                                         ELCDTERX
  1266         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1267                                                                  ELCDTERX
  1268     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1269         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1270     ELSE                                                         ELCDTERX
  1271         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1272                                                                  ELCDTERX
  1273 0005-READ--CARD.                                                 ELCDTERX
  1274     READ DISK-DATE                                               ELCDTERX
  1275         AT END CLOSE DISK-DATE                                   ELCDTERX
  1276             GO TO 0060-READ--TEST.                               ELCDTERX
  1277                                                                  ELCDTERX
  1278     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1279                                                                  ELCDTERX
  1280     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1281         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1282         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1283         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1284         GO TO 0005-READ--CARD.                                   ELCDTERX
  1285                                                                  ELCDTERX
  1286     IF DD-ID = 'CLAD'                                            ELCDTERX
  1287         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1288         GO TO 0005-READ--CARD.                                   ELCDTERX
  1289                                                                  ELCDTERX
  1290     IF DD-ID = 'CLAX'                                            ELCDTERX
  1291         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1292         GO TO 0005-READ--CARD.                                   ELCDTERX
  1293                                                                  ELCDTERX
  1294     IF DD-ID = 'CLAF'                                            ELCDTERX
  1295         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1296         GO TO 0005-READ--CARD.                                   ELCDTERX
  1297                                                                  ELCDTERX
  1298     IF DD-ID = 'CLAC'                                            ELCDTERX
  1299         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1300                                                                  ELCDTERX
  1301     IF DD-ID = 'CARR'                                            ELCDTERX
  1302         GO TO 0015-READ--CARR.                                   ELCDTERX
  1303                                                                  ELCDTERX
  1304     IF DD-ID = 'STAT'                                            ELCDTERX
  1305         GO TO 0020-READ--STAT.                                   ELCDTERX
  1306                                                                  ELCDTERX
  1307     IF DD-ID = 'BUSC'                                            ELCDTERX
  1308         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1309                                                                  ELCDTERX
  1310     IF DD-ID = 'MORT'                                            ELCDTERX
  1311         GO TO 0030-READ--MORT.                                   ELCDTERX
  1312                                                                  ELCDTERX
  1313     IF DD-ID = 'CLAI'                                            ELCDTERX
  1314         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1315                                                                  ELCDTERX
  1316     IF DD-ID = 'COLC'                                            ELCDTERX
  1317         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1318                                                                  ELCDTERX
  1319     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1320        DD-IDA = 'CL'                                             ELCDTERX
  1321         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1322                                                                  ELCDTERX
  1323     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1324        DD-IDA = 'PO'                                             ELCDTERX
  1325         GO TO 0050-READ--POXX.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     IF DD-ID = 'OPCA'                                            ELCDTERX
  1328         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1329                                                                  ELCDTERX
  1330     IF DD-ID = 'OPST'                                            ELCDTERX
  1331         GO TO 0072-READ--OPST.                                   ELCDTERX
  1332                                                                  ELCDTERX
  1333     IF DD-ID = 'OPBS'                                            ELCDTERX
  1334         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF DD-ID = 'OPMS'                                            ELCDTERX
  1337         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1338                                                                  ELCDTERX
  1339     GO TO 0005-READ--CARD.                                       ELCDTERX
  1340                                                                  ELCDTERX
  1341 0010-READ--CLAC.                                                 ELCDTERX
  1342     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1343     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1344     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1345     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1346     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1347     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1348     GO TO 0005-READ--CARD.                                       ELCDTERX
  1349                                                                  ELCDTERX
  1350 0015-READ--CARR.                                                 ELCDTERX
  1351     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1352     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1353        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1354        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1355        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1356        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1357        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1358        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1359        MOVE DD-CARR1-SECPAY-SW
  1360                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1361     END-IF
  1362                                                                  ELCDTERX
  1363     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1364     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1365        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1366        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1367        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1368        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1369        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1370        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1371        MOVE DD-CARR2-SECPAY-SW
  1372                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1373     END-IF
  1374                                                                  ELCDTERX
  1375                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1376     GO TO 0005-READ--CARD.                                       ELCDTERX
  1377                                                                  ELCDTERX
  1378 0020-READ--STAT.                                                 ELCDTERX
  1379     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1380     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1381        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1382         GO TO 0005-READ--CARD.                                   ELCDTERX
  1383                                                                  ELCDTERX
  1384     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1385     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1386     GO TO 0020-READ--STAT.                                       ELCDTERX
  1387                                                                  ELCDTERX
  1388 0025-READ--BUSC.                                                 ELCDTERX
  1389     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1390     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1391        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1392         GO TO 0005-READ--CARD.                                   ELCDTERX
  1393                                                                  ELCDTERX
  1394     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1395     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1396     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1397                                                                  ELCDTERX
  1398 0030-READ--MORT.                                                 ELCDTERX
  1399     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1400     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1401        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1402         GO TO 0005-READ--CARD.                                   ELCDTERX
  1403                                                                  ELCDTERX
  1404     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1405     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1406     GO TO 0030-READ--MORT.                                       ELCDTERX
  1407                                                                  ELCDTERX
  1408 0035-READ--CLXX.                                                 ELCDTERX
  1409     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1410          GO TO 0005-READ--CARD.                                  ELCDTERX
  1411                                                                  ELCDTERX
  1412     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1413         DISPLAY '***********************************************'ELCDTERX
  1414         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1415         DISPLAY '***********************************************'ELCDTERX
  1416         GO TO 0055-READ--STOP.                                   ELCDTERX
  1417                                                                  ELCDTERX
  1418     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1419        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1420         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1421                                                                  ELCDTERX
  1422     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1423        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1424         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1425                                                                  ELCDTERX
  1426*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1427     GO TO 0005-READ--CARD.                                       ELCDTERX
  1428                                                                  ELCDTERX
  1429 0040-READ--CLAI.                                                 ELCDTERX
  1430     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1431     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1432        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1433         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1434                                                                  ELCDTERX
  1435     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1436     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1437     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1438                                                                  ELCDTERX
  1439 0045-READ--DUMP.                                                 ELCDTERX
  1440     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1441     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1442                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1443     PERFORM ABEND-PGM.                                           ELCDTERX
  1444                                                                  ELCDTERX
  1445 0050-READ--POXX.                                                 ELCDTERX
  1446     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1447         GO TO 0005-READ--CARD.                                   ELCDTERX
  1448                                                                  ELCDTERX
  1449     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1450         DISPLAY '***********************************************'ELCDTERX
  1451         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1452         DISPLAY '***********************************************'ELCDTERX
  1453         GO TO 0055-READ--STOP.                                   ELCDTERX
  1454                                                                  ELCDTERX
  1455     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1456     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1457     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1458     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1459                                                                  ELCDTERX
  1460     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1461         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1462     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1463         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1464                                                                  ELCDTERX
  1465     GO TO 0005-READ--CARD.                                       ELCDTERX
  1466                                                                  ELCDTERX
  1467 0055-READ--STOP.                                                 ELCDTERX
  1468     GOBACK.                                                      ELCDTERX
  1469                                                                  ELCDTERX
  1470 0060-READ--TEST.                                                 ELCDTERX
  1471     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1472        CLAX-ID         = SPACE  OR                               ELCDTERX
  1473        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1474         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1475                                                                  ELCDTERX
  1476     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1477     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1478                                                                  ELCDTERX
  1479 0065-READ--COLC.                                                 ELCDTERX
  1480     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1481     GO TO 0005-READ--CARD.                                       ELCDTERX
  1482                                                                  ELCDTERX
  1483 0070-READ--OPCA.                                                 ELCDTERX
  1484                                                                  ELCDTERX
  1485     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1486                                                                  ELCDTERX
  1487     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1488             OR                                                   ELCDTERX
  1489         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1490         GO TO 0005-READ--CARD.                                   ELCDTERX
  1491                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS007.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1492     ADD 1                       TO INDEXCA.                      ELCDTERX
  1493     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1494                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1495     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1496                                                                  ELCDTERX
  1497 0072-READ--OPST.                                                 ELCDTERX
  1498                                                                  ELCDTERX
  1499     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1500                                                                  ELCDTERX
  1501     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1502             OR                                                   ELCDTERX
  1503         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1504         GO TO 0005-READ--CARD.                                   ELCDTERX
  1505                                                                  ELCDTERX
  1506     ADD 1                       TO INDEXST.                      ELCDTERX
  1507     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1508                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1509     GO TO 0072-READ--OPST.                                       ELCDTERX
  1510                                                                  ELCDTERX
  1511 0074-READ--OPBS.                                                 ELCDTERX
  1512                                                                  ELCDTERX
  1513     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1514                                                                  ELCDTERX
  1515     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1516             OR                                                   ELCDTERX
  1517         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1518         GO TO 0005-READ--CARD.                                   ELCDTERX
  1519                                                                  ELCDTERX
  1520     ADD 1                       TO INDEXBS.                      ELCDTERX
  1521     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1522     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1523                                                                  ELCDTERX
  1524 0079-READ--EXIT.                                                 ELCDTERX
  1525*    EXIT.                                                        ELCDTERX
  1526******************************************************************ELCDTERX
  1527
  1528     MOVE COMPANY-NAME           TO  HD-CO
  1529     MOVE ALPH-DATE              TO  HD-DT
  1530     MOVE WS-CURRENT-DATE        TO  HD-RUN-DT
  1531
  1532     MOVE RUN-DATE               TO WS-TEST-RUN-DATE
  1533
  1534     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
  1535
  1536     PERFORM 0020-INITIALIZE     THRU 0020-EXIT
  1537
  1538     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  1539
  1540     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  1541
  1542
  1543     GOBACK
  1544     .
  1545
  1546 0010-OPEN-FILES.
  1547
  1548     OPEN INPUT ERDUEP
  1549         OUTPUT PRINTX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS007.cbl
  1550
  1551     IF ERDUEP-FILE-STATUS = '00' OR '97'
  1552        CONTINUE
  1553     ELSE
  1554        DISPLAY ' ERROR ON ERDUEP OPEN  '
  1555           ERDUEP-FILE-STATUS
  1556        MOVE ' ERROR ON ERDUEP OPEN  '
  1557                                 TO WS-ABEND-MESSAGE
  1558        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1559        PERFORM ABEND-PGM
  1560     END-IF
  1561
  1562     .
  1563 0010-EXIT.
  1564     EXIT.
  1565
  1566 0020-INITIALIZE.
  1567
  1568     MOVE +0                     TO WS-EXP-PREM
  1569                                    WS-REC-PREM
  1570                                    WS-GA-COMM
  1571                                    WS-BASE-COMM
  1572
  1573     PERFORM VARYING WS-A FROM +1 BY +1 UNTIL
  1574        (WS-A > +5)
  1575        MOVE +0                  TO WS-TOT-EXP-PREM (WS-A)
  1576                                    WS-TOT-REC-PREM (WS-A)
  1577                                    WS-TOT-BASE-COMM (WS-A)
  1578                                    WS-TOT-GA-COMM  (WS-A)
  1579                                    WS-TOT-BAL-FWD  (WS-A)
  1580                                    WS-TOT-ADJS     (WS-A)
  1581                                    WS-TOT-END-BAL  (WS-A)
  1582                                    WS-TOT-DUE-COMM (WS-A)
  1583     END-PERFORM
  1584
  1585     MOVE RUN-DATE               TO WS-WORK-DATE
  1586     MOVE WS-WORK-MMDD           TO WS-POSTING-DATE (1:4)
  1587     MOVE WS-WORK-CCYY           TO WS-POSTING-DATE (5:4)
  1588
  1589     PERFORM 0040-START-ERDUEP   THRU 0040-EXIT
  1590     PERFORM 0060-READ-ERDUEP    THRU 0060-EXIT
  1591     MOVE DP-ACCOUNT-CONTROL     TO WS-HOLD-CONTROL
  1592
  1593     .
  1594 0020-EXIT.
  1595     EXIT.
  1596
  1597
  1598 0030-CLOSE-FILES.
  1599
  1600     CLOSE PRINTX
  1601           ERDUEP
  1602
  1603     IF ERDUEP-FILE-STATUS = '00' OR '97'
  1604        CONTINUE
  1605     ELSE
  1606        DISPLAY ' ERROR ON ERDUEP CLOSE '
  1607           ERDUEP-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS007.cbl
  1608        MOVE ' ERROR ON ERDUEP OPEN  '
  1609                                 TO WS-ABEND-MESSAGE
  1610        MOVE ERDUEP-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  1611        PERFORM ABEND-PGM
  1612     END-IF
  1613
  1614     .
  1615 0030-EXIT.
  1616     EXIT.
  1617
  1618 0040-START-ERDUEP.
  1619
  1620     MOVE LOW-VALUES             TO DP-CONTROL-PRIMARY
  1621     MOVE DTE-CLASIC-COMPANY-CD  TO DP-COMPANY-CD
  1622     START ERDUEP KEY IS NOT < DP-CONTROL-PRIMARY
  1623
  1624     IF ERDUEP-FILE-STATUS = '10' OR '23'
  1625        SET END-OF-ERDUEP        TO TRUE
  1626     ELSE
  1627        IF ERDUEP-FILE-STATUS NOT = '00'
  1628           MOVE ' ERROR ON ERDUEP  START     '
  1629                                 TO WS-ABEND-MESSAGE
  1630           MOVE ERDUEP-FILE-STATUS
  1631                                 TO WS-ABEND-FILE-STATUS
  1632           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1633           PERFORM ABEND-PGM
  1634        END-IF
  1635     END-IF
  1636
  1637     .
  1638 0040-EXIT.
  1639     EXIT.
  1640
  1641 0050-PROCESS-FILE.
  1642
  1643     PERFORM 0080-PROCESS-ERDUEP THRU 0080-EXIT UNTIL
  1644           END-OF-ERDUEP
  1645     PERFORM 0300-ACCT-BREAK     THRU 0300-EXIT
  1646     PERFORM 0310-ST-BREAK       THRU 0310-EXIT
  1647     PERFORM 0320-GRP-BREAK      THRU 0320-EXIT
  1648     PERFORM 0330-CAR-BREAK      THRU 0330-EXIT
  1649     PERFORM 0340-FIN-BREAK      THRU 0340-EXIT
  1650
  1651     .
  1652 0050-EXIT.
  1653     EXIT.
  1654
  1655 0060-READ-ERDUEP.
  1656
  1657     READ ERDUEP NEXT RECORD
  1658
  1659     IF ERDUEP-FILE-STATUS = '10' OR '23'
  1660        SET END-OF-ERDUEP        TO TRUE
  1661     ELSE
  1662        IF ERDUEP-FILE-STATUS NOT = '00'
  1663           MOVE ' ERROR ON ERDUEP READ NEXT  '
  1664                                 TO WS-ABEND-MESSAGE
  1665           MOVE ERDUEP-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS007.cbl
  1666                                 TO WS-ABEND-FILE-STATUS
  1667           DISPLAY WS-ABEND-MESSAGE '  ' WS-ABEND-FILE-STATUS
  1668           PERFORM ABEND-PGM
  1669        ELSE
  1670           ADD +1                TO ERDUEP-IN-CNT
  1671        END-IF
  1672     END-IF
  1673
  1674     .
  1675
  1676 0060-EXIT.
  1677     EXIT.
  1678
  1679 0080-PROCESS-ERDUEP.
  1680
  1681     IF DP-ACCOUNT-CONTROL NOT = WS-HOLD-CONTROL
  1682        PERFORM 0250-BREAK-RTN   THRU 0250-EXIT
  1683     END-IF
  1684
  1685     COMPUTE WS-TOT-BAL-FWD (1) = WS-TOT-BAL-FWD (1)
  1686        + DP-BAL-FWD
  1687     COMPUTE WS-TOT-EXP-PREM (1) = WS-TOT-EXP-PREM (1)
  1688        + DP-EXP-PREM
  1689     COMPUTE WS-TOT-REC-PREM (1) = WS-TOT-REC-PREM (1)
  1690        + DP-REC-PREM
  1691     COMPUTE WS-TOT-GA-COMM (1) = WS-TOT-GA-COMM (1)
  1692        + DP-GA-COMM
  1693     COMPUTE WS-TOT-BASE-COMM (1) = WS-TOT-BASE-COMM (1)
  1694        + DP-BASE-COMM
  1695     COMPUTE WS-TOT-ADJS (1)    = WS-TOT-ADJS (1)
  1696        + DP-ADJUSTMENTS
  1697     COMPUTE WS-TOT-END-BAL (1) = WS-TOT-END-BAL (1)
  1698        + DP-END-BAL
  1699
  1700     IF (DP-EXP-PREM + DP-BASE-COMM) NOT = ZEROS
  1701        COMPUTE WS-BASE-PCT = DP-BASE-COMM
  1702           / (DP-EXP-PREM + DP-BASE-COMM)
  1703        COMPUTE WS-OW-PCT   = DP-GA-COMM
  1704           / (DP-EXP-PREM + DP-BASE-COMM)
  1705        COMPUTE WS-DUE-COMM = (DP-END-BAL
  1706           / (1 - WS-BASE-PCT)) * WS-OW-PCT
  1707        COMPUTE WS-TOT-DUE-COMM (1) = WS-TOT-DUE-COMM (1)
  1708           + WS-DUE-COMM
  1709     END-IF
  1710
  1711     MOVE DP-ACCOUNT-CONTROL     TO WS-HOLD-CONTROL
  1712
  1713     PERFORM 0060-READ-ERDUEP    THRU 0060-EXIT
  1714
  1715     .
  1716
  1717 0080-EXIT.
  1718     EXIT.
  1719
  1720
  1721
  1722 0250-BREAK-RTN.
  1723
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS007.cbl
  1724     IF WS-HOLD-CAR NOT = DP-CARRIER
  1725        PERFORM 0300-ACCT-BREAK  THRU 0300-EXIT
  1726        PERFORM 0310-ST-BREAK    THRU 0310-EXIT
  1727        PERFORM 0320-GRP-BREAK   THRU 0320-EXIT
  1728        PERFORM 0330-CAR-BREAK   THRU 0330-EXIT
  1729     ELSE
  1730        IF WS-HOLD-GRP NOT = DP-GROUPING
  1731           PERFORM 0300-ACCT-BREAK
  1732                                 THRU 0300-EXIT
  1733           PERFORM 0310-ST-BREAK THRU 0310-EXIT
  1734           PERFORM 0320-GRP-BREAK
  1735                                 THRU 0320-EXIT
  1736        ELSE
  1737           IF WS-HOLD-ST NOT = DP-STATE
  1738              PERFORM 0300-ACCT-BREAK
  1739                                 THRU 0300-EXIT
  1740              PERFORM 0310-ST-BREAK
  1741                                 THRU 0310-EXIT
  1742           ELSE
  1743              IF WS-HOLD-ACCT NOT = DP-ACCOUNT
  1744                 PERFORM 0300-ACCT-BREAK
  1745                                 THRU 0300-EXIT
  1746              END-IF
  1747           END-IF
  1748        END-IF
  1749     END-IF
  1750     .
  1751 0250-EXIT.
  1752     EXIT.
  1753
  1754 0300-ACCT-BREAK.
  1755
  1756     IF (WS-TOT-EXP-PREM (1) = ZEROS)
  1757        AND (WS-TOT-REC-PREM (1) = ZEROS)
  1758        AND (WS-TOT-GA-COMM (1)  = ZEROS)
  1759        AND (WS-TOT-END-BAL (1)  = ZEROS)
  1760        AND (WS-TOT-BAL-FWD (1)  = ZEROS)
  1761        AND (WS-TOT-ADJS (1)     = ZEROS)
  1762        CONTINUE
  1763     ELSE
  1764        MOVE SPACES              TO DETAIL-LINE
  1765        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1766        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1767        MOVE WS-HOLD-ST          TO DTL1-ST
  1768        MOVE WS-HOLD-ACCT        TO DTL1-ACCT
  1769        MOVE WS-TOT-EXP-PREM (1) TO DTL1-EXP-PREM
  1770        MOVE WS-TOT-REC-PREM (1) TO DTL1-REC-PREM
  1771        MOVE WS-TOT-ADJS (1)     TO DTL1-ADJS
  1772        COMPUTE WS-TOT-END-BAL (1) = WS-TOT-EXP-PREM (1)
  1773           - WS-TOT-REC-PREM (1) + WS-TOT-ADJS (1)
  1774        MOVE WS-TOT-END-BAL (1)  TO DTL1-END-BAL
  1775        MOVE DETAIL-LINE         TO P-DATA
  1776        MOVE SPACE-2             TO P-CTL
  1777        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1778
  1779        COMPUTE WS-TOT-BAL-FWD  (2) = WS-TOT-BAL-FWD  (2)
  1780           + WS-TOT-BAL-FWD  (1)
  1781        COMPUTE WS-TOT-EXP-PREM (2) = WS-TOT-EXP-PREM (2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS007.cbl
  1782           + WS-TOT-EXP-PREM (1)
  1783        COMPUTE WS-TOT-REC-PREM (2) = WS-TOT-REC-PREM (2)
  1784           + WS-TOT-REC-PREM (1)
  1785        COMPUTE WS-TOT-BASE-COMM  (2) = WS-TOT-BASE-COMM  (2)
  1786           + WS-TOT-BASE-COMM  (1)
  1787        COMPUTE WS-TOT-GA-COMM  (2) = WS-TOT-GA-COMM  (2)
  1788           + WS-TOT-GA-COMM  (1)
  1789        COMPUTE WS-TOT-ADJS     (2) = WS-TOT-ADJS     (2)
  1790           + WS-TOT-ADJS     (1)
  1791        COMPUTE WS-TOT-END-BAL  (2) = WS-TOT-END-BAL  (2)
  1792           + WS-TOT-END-BAL  (1)
  1793        COMPUTE WS-TOT-DUE-COMM (2) = WS-TOT-DUE-COMM (2)
  1794           + WS-TOT-DUE-COMM (1)
  1795     END-IF
  1796
  1797     MOVE +0                     TO WS-TOT-EXP-PREM (1)
  1798                                    WS-TOT-REC-PREM (1)
  1799                                    WS-TOT-BASE-COMM (1)
  1800                                    WS-TOT-GA-COMM  (1)
  1801                                    WS-TOT-BAL-FWD  (1)
  1802                                    WS-TOT-ADJS     (1)
  1803                                    WS-TOT-END-BAL  (1)
  1804                                    WS-TOT-DUE-COMM (1)
  1805     .
  1806 0300-EXIT.
  1807     EXIT.
  1808
  1809 0310-ST-BREAK.
  1810
  1811     IF (WS-TOT-EXP-PREM (2) = ZEROS)
  1812        AND (WS-TOT-REC-PREM (2) = ZEROS)
  1813        AND (WS-TOT-GA-COMM (2)  = ZEROS)
  1814        AND (WS-TOT-END-BAL (2)  = ZEROS)
  1815        AND (WS-TOT-BAL-FWD (2)  = ZEROS)
  1816        AND (WS-TOT-ADJS (2)     = ZEROS)
  1817        CONTINUE
  1818     ELSE
  1819        MOVE SPACES              TO DETAIL-LINE
  1820        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1821        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1822        MOVE WS-HOLD-ST          TO DTL1-ST
  1823*       MOVE WS-TOT-BAL-FWD (2)  TO DTL1-BEG-BAL
  1824        MOVE WS-TOT-EXP-PREM (2) TO DTL1-EXP-PREM
  1825        MOVE WS-TOT-REC-PREM (2) TO DTL1-REC-PREM
  1826        MOVE WS-TOT-ADJS (2)     TO DTL1-ADJS
  1827        COMPUTE WS-TOT-END-BAL (2) = WS-TOT-EXP-PREM (2)
  1828           - WS-TOT-REC-PREM (2) + WS-TOT-ADJS (2)
  1829        MOVE WS-TOT-END-BAL (2)  TO DTL1-END-BAL
  1830*       MOVE WS-TOT-DUE-COMM (2) TO DTL1-COMM
  1831        MOVE DETAIL-LINE         TO P-DATA
  1832        MOVE SPACE-2             TO P-CTL
  1833        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1834
  1835        COMPUTE WS-TOT-BAL-FWD (3)  = WS-TOT-BAL-FWD (3)
  1836           + WS-TOT-BAL-FWD (2)
  1837        COMPUTE WS-TOT-EXP-PREM (3) = WS-TOT-EXP-PREM (3)
  1838           + WS-TOT-EXP-PREM (2)
  1839        COMPUTE WS-TOT-REC-PREM (3) = WS-TOT-REC-PREM (3)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS007.cbl
  1840           + WS-TOT-REC-PREM (2)
  1841        COMPUTE WS-TOT-BASE-COMM  (3) = WS-TOT-BASE-COMM  (3)
  1842           + WS-TOT-BASE-COMM  (2)
  1843        COMPUTE WS-TOT-GA-COMM (3) = WS-TOT-GA-COMM (3)
  1844           + WS-TOT-GA-COMM (2)
  1845        COMPUTE WS-TOT-ADJS (3)     = WS-TOT-ADJS (3)
  1846           + WS-TOT-ADJS (2)
  1847        COMPUTE WS-TOT-END-BAL (3)  = WS-TOT-END-BAL (3)
  1848           + WS-TOT-END-BAL (2)
  1849        COMPUTE WS-TOT-DUE-COMM (3) = WS-TOT-DUE-COMM (3)
  1850           + WS-TOT-DUE-COMM (2)
  1851     END-IF
  1852
  1853     MOVE +0                     TO WS-TOT-EXP-PREM (2)
  1854                                    WS-TOT-REC-PREM (2)
  1855                                    WS-TOT-BASE-COMM (2)
  1856                                    WS-TOT-GA-COMM  (2)
  1857                                    WS-TOT-BAL-FWD  (2)
  1858                                    WS-TOT-ADJS     (2)
  1859                                    WS-TOT-END-BAL  (2)
  1860                                    WS-TOT-DUE-COMM (2)
  1861
  1862     .
  1863 0310-EXIT.
  1864     EXIT.
  1865
  1866 0320-GRP-BREAK.
  1867
  1868     IF (WS-TOT-EXP-PREM (3) = ZEROS)
  1869        AND (WS-TOT-REC-PREM (3) = ZEROS)
  1870        AND (WS-TOT-GA-COMM (3)  = ZEROS)
  1871        AND (WS-TOT-END-BAL (3)  = ZEROS)
  1872        AND (WS-TOT-BAL-FWD (3)  = ZEROS)
  1873        AND (WS-TOT-ADJS (3)     = ZEROS)
  1874        CONTINUE
  1875     ELSE
  1876        MOVE SPACES              TO DETAIL-LINE
  1877        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1878        MOVE WS-HOLD-GRP         TO DTL1-GRP
  1879        MOVE WS-TOT-EXP-PREM (3) TO DTL1-EXP-PREM
  1880        MOVE WS-TOT-REC-PREM (3) TO DTL1-REC-PREM
  1881        MOVE WS-TOT-ADJS (3)     TO DTL1-ADJS
  1882        COMPUTE WS-TOT-END-BAL (3) = WS-TOT-EXP-PREM (3)
  1883           - WS-TOT-REC-PREM (3) + WS-TOT-ADJS (3)
  1884        MOVE WS-TOT-END-BAL (3)  TO DTL1-END-BAL
  1885        MOVE DETAIL-LINE         TO P-DATA
  1886        MOVE SPACE-2             TO P-CTL
  1887        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1888
  1889        COMPUTE WS-TOT-BAL-FWD (4)  = WS-TOT-BAL-FWD (4)
  1890           + WS-TOT-BAL-FWD (3)
  1891        COMPUTE WS-TOT-EXP-PREM (4) = WS-TOT-EXP-PREM (4)
  1892           + WS-TOT-EXP-PREM (3)
  1893        COMPUTE WS-TOT-REC-PREM (4) = WS-TOT-REC-PREM (4)
  1894           + WS-TOT-REC-PREM (3)
  1895        COMPUTE WS-TOT-BASE-COMM  (4) = WS-TOT-BASE-COMM  (4)
  1896           + WS-TOT-BASE-COMM  (3)
  1897        COMPUTE WS-TOT-GA-COMM (4) = WS-TOT-GA-COMM (4)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS007.cbl
  1898           + WS-TOT-GA-COMM (3)
  1899        COMPUTE WS-TOT-ADJS (4)     = WS-TOT-ADJS (4)
  1900           + WS-TOT-ADJS (3)
  1901        COMPUTE WS-TOT-END-BAL (4)  = WS-TOT-END-BAL (4)
  1902           + WS-TOT-END-BAL (3)
  1903        COMPUTE WS-TOT-DUE-COMM (4) = WS-TOT-DUE-COMM (4)
  1904           + WS-TOT-DUE-COMM (3)
  1905     END-IF
  1906
  1907     MOVE +0                     TO WS-TOT-EXP-PREM (3)
  1908                                    WS-TOT-REC-PREM (3)
  1909                                    WS-TOT-BASE-COMM (3)
  1910                                    WS-TOT-GA-COMM  (3)
  1911                                    WS-TOT-BAL-FWD  (3)
  1912                                    WS-TOT-ADJS     (3)
  1913                                    WS-TOT-END-BAL  (3)
  1914                                    WS-TOT-DUE-COMM (3)
  1915
  1916     .
  1917 0320-EXIT.
  1918     EXIT.
  1919
  1920 0330-CAR-BREAK.
  1921
  1922     IF (WS-TOT-EXP-PREM (4) = ZEROS)
  1923        AND (WS-TOT-REC-PREM (4) = ZEROS)
  1924        AND (WS-TOT-GA-COMM (4)  = ZEROS)
  1925        AND (WS-TOT-END-BAL (4)  = ZEROS)
  1926        AND (WS-TOT-BAL-FWD (4)  = ZEROS)
  1927        AND (WS-TOT-ADJS (4)     = ZEROS)
  1928        CONTINUE
  1929     ELSE
  1930        MOVE SPACES              TO DETAIL-LINE
  1931        MOVE WS-HOLD-CAR         TO DTL1-CAR
  1932        MOVE WS-TOT-EXP-PREM (4) TO DTL1-EXP-PREM
  1933        MOVE WS-TOT-REC-PREM (4) TO DTL1-REC-PREM
  1934        MOVE WS-TOT-ADJS (4)     TO DTL1-ADJS
  1935        COMPUTE WS-TOT-END-BAL (4) = WS-TOT-EXP-PREM (4)
  1936           - WS-TOT-REC-PREM (4) + WS-TOT-ADJS (4)
  1937        MOVE WS-TOT-END-BAL (4)  TO DTL1-END-BAL
  1938        MOVE DETAIL-LINE         TO P-DATA
  1939        MOVE SPACE-2             TO P-CTL
  1940        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1941
  1942        COMPUTE WS-TOT-BAL-FWD (5)  = WS-TOT-BAL-FWD (5)
  1943           + WS-TOT-BAL-FWD (4)
  1944        COMPUTE WS-TOT-EXP-PREM (5) = WS-TOT-EXP-PREM (5)
  1945           + WS-TOT-EXP-PREM (4)
  1946        COMPUTE WS-TOT-REC-PREM (5) = WS-TOT-REC-PREM (5)
  1947           + WS-TOT-REC-PREM (4)
  1948        COMPUTE WS-TOT-BASE-COMM  (5) = WS-TOT-BASE-COMM  (5)
  1949           + WS-TOT-BASE-COMM  (4)
  1950        COMPUTE WS-TOT-GA-COMM (5) = WS-TOT-GA-COMM (5)
  1951           + WS-TOT-GA-COMM (4)
  1952        COMPUTE WS-TOT-ADJS (5)     = WS-TOT-ADJS (5)
  1953           + WS-TOT-ADJS (4)
  1954        COMPUTE WS-TOT-END-BAL (5)  = WS-TOT-END-BAL (5)
  1955           + WS-TOT-END-BAL (4)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS007.cbl
  1956        COMPUTE WS-TOT-DUE-COMM (5) = WS-TOT-DUE-COMM (5)
  1957           + WS-TOT-DUE-COMM (4)
  1958     END-IF
  1959
  1960     MOVE +0                     TO WS-TOT-EXP-PREM (4)
  1961                                    WS-TOT-REC-PREM (4)
  1962                                    WS-TOT-BASE-COMM (4)
  1963                                    WS-TOT-GA-COMM  (4)
  1964                                    WS-TOT-BAL-FWD  (4)
  1965                                    WS-TOT-ADJS     (4)
  1966                                    WS-TOT-END-BAL  (4)
  1967                                    WS-TOT-DUE-COMM (4)
  1968
  1969     .
  1970 0330-EXIT.
  1971     EXIT.
  1972
  1973 0340-FIN-BREAK.
  1974
  1975     IF (WS-TOT-EXP-PREM (5) = ZEROS)
  1976        AND (WS-TOT-REC-PREM (5) = ZEROS)
  1977        AND (WS-TOT-GA-COMM (5)  = ZEROS)
  1978        AND (WS-TOT-END-BAL (5)  = ZEROS)
  1979        AND (WS-TOT-BAL-FWD (5)  = ZEROS)
  1980        AND (WS-TOT-ADJS (5)     = ZEROS)
  1981        CONTINUE
  1982     ELSE
  1983        MOVE SPACES              TO DETAIL-LINE
  1984        MOVE '    GRAND TOTALS       '
  1985                                 TO DETAIL-LINE (1:23)
  1986        MOVE WS-TOT-EXP-PREM (5) TO DTL1-EXP-PREM
  1987        MOVE WS-TOT-REC-PREM (5) TO DTL1-REC-PREM
  1988        MOVE WS-TOT-ADJS (5)     TO DTL1-ADJS
  1989        COMPUTE WS-TOT-END-BAL (5) = WS-TOT-EXP-PREM (5)
  1990           - WS-TOT-REC-PREM (5) + WS-TOT-ADJS (5)
  1991        MOVE WS-TOT-END-BAL (5)  TO DTL1-END-BAL
  1992        MOVE DETAIL-LINE         TO P-DATA
  1993        MOVE SPACE-2             TO P-CTL
  1994        PERFORM 8800-PRT-RTN     THRU 8800-EXIT
  1995
  1996     END-IF
  1997
  1998     .
  1999 0340-EXIT.
  2000     EXIT.
  2001
  2002
  2003 8600-HD-RTN.
  2004     MOVE +0                     TO LNCTR
  2005     MOVE HD1                    TO  P-DATA
  2006     MOVE SPACE-NP               TO  P-CTL
  2007
  2008     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2009
  2010     ADD +1                      TO  PGCTR
  2011
  2012     MOVE PGCTR                  TO  HD-PG
  2013     MOVE HD2                    TO  P-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS007.cbl
  2014     MOVE SPACE-1                TO  P-CTL
  2015
  2016     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2017
  2018     MOVE HD3                    TO  P-DATA
  2019     MOVE SPACE-1                TO  P-CTL
  2020
  2021     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2022
  2023     MOVE SPACE-2                TO  P-CTL
  2024     MOVE HD4                    TO  P-DATA
  2025
  2026     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2027
  2028     MOVE HD5                    TO  P-DATA
  2029     MOVE SPACE-1                TO  P-CTL
  2030     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2031
  2032     MOVE SPACES                 TO  P-DATA
  2033     MOVE SPACE-1                TO  P-CTL
  2034     PERFORM 8800-PRT-RTN  THRU  8800-EXIT
  2035
  2036     MOVE +10                    TO  LNCTR
  2037*    MOVE SPACE-2                TO  P-CTL
  2038
  2039     .
  2040 8699-EXIT.
  2041     EXIT.
  2042
  2043 8800-PRT-RTN.
  2044
  2045     IF LNCTR > +56
  2046        MOVE PRT                 TO WS-HOLD-PRT
  2047        PERFORM 8600-HD-RTN      THRU 8699-EXIT
  2048        MOVE WS-HOLD-PRT         TO PRT
  2049     END-IF
  2050
  2051     MOVE P-CTL                  TO X
  2052     IF P-CTL = SPACE-1
  2053        ADD +1                   TO LNCTR
  2054     ELSE
  2055        IF P-CTL = SPACE-2
  2056           ADD +2                TO LNCTR
  2057        ELSE
  2058           IF P-CTL = SPACE-3
  2059              ADD +3             TO LNCTR
  2060           END-IF
  2061        END-IF
  2062     END-IF
  2063
  2064     .
  2065 8850-COPY-PRT-RTN.
* 2066                                 COPY ELCPRT2.
  2067******************************************************************04/15/98
  2068*                                                                *ELCPRT2
  2069*                                                                *ELCPRT2
  2070*                            ELCPRT2                             *   LV005
  2071*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS007.cbl (/apps/prod/cid1p/copy/ELCPRT2)
  2072*                            VMOD=2.002                          *   CL**5
  2073*                                                                *   CL**4
  2074******************************************************************   CL**4
  2075                                                                     CL**4
  2076     IF DTE-FICH NOT = SPACE AND                                     CL**4
  2077        FICH-OPEN    = SPACE                                         CL**4
  2078         MOVE 'X'                TO  FICH-OPEN                       CL**4
  2079         OPEN OUTPUT FICH.                                           CL**4
  2080                                                                     CL**4
  2081     IF DTE-FICH NOT = SPACE                                         CL**4
  2082         MOVE X                  TO  P-CTL                           CL**4
  2083         WRITE FICH-REC FROM PRT.                                    CL**4
  2084                                                                     CL**4
  2085     IF DTE-FICH = SPACE OR '2'                                      CL**4
  2086       MOVE X                    TO  P-CTL                           CL**4
  2087       IF P-CTL = ' '                                                CL**4
  2088         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  2089       ELSE                                                          CL**4
  2090         IF P-CTL = '0'                                              CL**4
  2091           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  2092         ELSE                                                        CL**4
  2093           IF P-CTL = '-'                                            CL**4
  2094             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  2095           ELSE                                                      CL**4
  2096             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  2097                                                                     CL**4
  2098******************************************************************   CL**4
  2099
  2100 8800-EXIT.
  2101     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS007.cbl
  2103 8510-DATE-CONVERSION.
  2104
  2105     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2106
  2107     .
  2108
  2109 8590-EXIT.
  2110     EXIT.
  2111
  2112
  2113
  2114
  2115 ABEND-PGM.
* 2116                                 COPY ELCABEND.
  2117***************************************************************** 04/14/98
  2118*                                                               * ELCABEND
  2119*                            ELCABEND.                          *    LV003
  2120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2121*                            VMOD 2.002                              CL**2
  2122*                                                               * ELCABEND
  2123*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2124*            AND THEN ABENDS.                                   * ELCABEND
  2125*                                                               * ELCABEND
  2126*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2127*                                                               * ELCABEND
  2128***************************************************************** ELCABEND
  2129*APS-010.                                                         ELCABEND
  2130     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2131     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2132                                                                  ELCABEND
  2133     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2134         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2135         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2136                                 UPON CONSOLE.                    ELCABEND
  2137                                                                  ELCABEND
  2138     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2139         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2140         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2141                                 UPON CONSOLE.                    ELCABEND
  2142                                                                  ELCABEND
  2143     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2144     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2145                                 UPON CONSOLE.                    ELCABEND
  2146                                                                  ELCABEND
  2147     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2148     CALL 'ABORTME'.
  2149                                                                  ELCABEND
  2150 APS-EXIT.                                                        ELCABEND
  2151     EXIT.                                                        ELCABEND
  2152
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       50392     Code:        7410
