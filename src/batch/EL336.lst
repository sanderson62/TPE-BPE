* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL336.cbl
* Options: int("EL336.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL336.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL336.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL336.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         09/24/97
     2                                                                  EL336
     3 PROGRAM-ID.                 EL336 .                                 LV001
     4*              PROGRAM CONVERTED BY                               EL336
     5*              COBOL CONVERSION AID PO 5785-ABJ                   EL336
     6*              CONVERSION DATE 03/21/95 15:34:51.                 EL336
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE            EL336
     8*                            VMOD=2.012.                          EL336
     9                                                                  EL336
    10                                                                  EL336
    11*AUTHOR.     LOGIC INC.                                           EL336
    12*            DALLAS, TEXAS.                                       EL336
    13                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL336.cbl
    14*DATE-COMPILED.                                                   EL336
    15                                                                  EL336
    16*SECURITY.   *****************************************************EL336
    17*            *                                                   *EL336
    18*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *EL336
    19*            *                                                   *EL336
    20*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *EL336
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *EL336
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *EL336
    23*            *                                                   *EL336
    24*            *****************************************************EL336
    25                                                                  EL336
    26*REMARKS.                                                         EL336
    27                                                                  EL336
    28*         THIS PROGRAM IS USED TO LOAD THE VSAM MASTER FILE       EL336
    29*       ALTERNATE INDEXES.                                        EL336
    30                                                                  EL336
    31*                ALTERNATE INDEX RECORD LAYOUT                    EL336
    32                                                                  EL336
    33*        OFFSET      BYTES &    FIELD                             EL336
    34*    DECIMAL  HEXBIT PATTERN    NAME     DESCRIPTION              EL336
    35                                                                  EL336
    36*       0      0       1        AIXFG    FLAG BYTE                EL336
    37*                   XXXX XXX.            RESERVED                 EL336
    38*                   .... ...1            PRIME KEY POINTERS USED  EL336
    39*                   .... ...0            RBA POINTERS ARE USED    EL336
    40*       1      1       1        AIXPKP   POINTER LENGTH (BINARY-74EL336
    41*                                                              )  EL336
    42*       2      2       2        AIXPC    NUMBER OF POINTERS IN    EL336
    43*                                        THIS RECORD (IN BINARY-74EL336
    44*                                                              )  EL336
    45*       4      4       1        AIXKL    LENGTH OF ALTERNATE KEY  EL336
    46*                                        (IN BINARY-74)           EL336
    47*       5      5                                                  EL336
    48*                    NOTE 1     AIXKY    ALTERNATE KEY            EL336
    49*       NOTE 2       NOTE 3     AIXPT    FIRST POINTER TO BASE    EL336
    50*                                        CLUSTER                  EL336
    51                                                                  EL336
    52*     NOTE 1:  THE LENGTH OF THIS FIELD IS SPECIFIED IN AIXKL     EL336
    53*     NOTE 2:  THE DISPLACEMENT OF THIS FIELD IS 5 + THE LENGTH   EL336
    54*              OF AIXKY                                           EL336
    55*     NOTE 3:  THE LENGTH OF THIS FIELD IS SPECIFIED IN AIXPL     EL336
    56                                                                  EL336
    57*        THE ABOVE WAS COPIED FROM THE VSAM LOGIC MANUAL.         EL336
    58                                                                  EL336
    59 ENVIRONMENT DIVISION.                                            EL336
    60                                                                  EL336
    61 INPUT-OUTPUT SECTION.                                            EL336
    62                                                                  EL336
    63 FILE-CONTROL.                                                    EL336
    64                                                                  EL336
    65     SELECT ELARCH-AIX02                                          EL336
    66         ASSIGN TO SYS013-FBA1-ELARCH2                            EL336
    67         ORGANIZATION IS INDEXED                                  EL336
    68         ACCESS IS SEQUENTIAL                                     EL336
    69         RECORD KEY IS ELARCH-AIX02-KEY                           EL336
    70         FILE STATUS IS ELARCH-AIX02-FILE-STATUS.                 EL336
    71                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL336.cbl
    73     SELECT ELCERT-AIX02                                          EL336
    74         ASSIGN TO SYS013-FBA1-ELCERT2                            EL336
    75         ORGANIZATION IS INDEXED                                  EL336
    76         ACCESS IS SEQUENTIAL                                     EL336
    77         RECORD KEY IS ELCERT-AIX02-KEY                           EL336
    78         FILE STATUS IS ELCERT-AIX02-FILE-STATUS.                 EL336
    79                                                                  EL336
    80     SELECT ELCERT-AIX03                                          EL336
    81         ASSIGN TO SYS014-FBA1-ELCERT3                            EL336
    82         ORGANIZATION IS INDEXED                                  EL336
    83         ACCESS IS SEQUENTIAL                                     EL336
    84         RECORD KEY IS ELCERT-AIX03-KEY                           EL336
    85         FILE STATUS IS ELCERT-AIX03-FILE-STATUS.                 EL336
    86                                                                  EL336
    87     SELECT ELCERT-AIX05                                          EL336
    88         ASSIGN TO SYS016-FBA1-ELCERT5                            EL336
    89         ORGANIZATION IS INDEXED                                  EL336
    90         ACCESS IS SEQUENTIAL                                     EL336
    91         RECORD KEY IS ELCERT-AIX05-KEY                           EL336
    92         FILE STATUS IS ELCERT-AIX05-FILE-STATUS.                 EL336
    93                                                                  EL336
    94     SELECT ELCERT-AIX06                                          EL336
    95         ASSIGN TO SYS017-FBA1-ELCERT6                            EL336
    96         ORGANIZATION IS INDEXED                                  EL336
    97         ACCESS IS SEQUENTIAL                                     EL336
    98         RECORD KEY IS ELCERT-AIX06-KEY                           EL336
    99         FILE STATUS IS ELCERT-AIX06-FILE-STATUS.                 EL336
   100                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL336.cbl
   102     SELECT ELMSTR-AIX02                                          EL336
   103         ASSIGN TO SYS013-FBA1-ELMSTR2                            EL336
   104         ORGANIZATION IS INDEXED                                  EL336
   105         ACCESS IS SEQUENTIAL                                     EL336
   106         RECORD KEY IS ELMSTR-AIX02-KEY                           EL336
   107         FILE STATUS IS ELMSTR-AIX02-FILE-STATUS.                 EL336
   108                                                                  EL336
   109     SELECT ELMSTR-AIX03                                          EL336
   110         ASSIGN TO SYS014-FBA1-ELMSTR3                            EL336
   111         ORGANIZATION IS INDEXED                                  EL336
   112         ACCESS IS SEQUENTIAL                                     EL336
   113         RECORD KEY IS ELMSTR-AIX03-KEY                           EL336
   114         FILE STATUS IS ELMSTR-AIX03-FILE-STATUS.                 EL336
   115                                                                  EL336
   116     SELECT ELMSTR-AIX05                                          EL336
   117         ASSIGN TO SYS016-FBA1-ELMSTR5                            EL336
   118         ORGANIZATION IS INDEXED                                  EL336
   119         ACCESS IS SEQUENTIAL                                     EL336
   120         RECORD KEY IS ELMSTR-AIX05-KEY                           EL336
   121         FILE STATUS IS ELMSTR-AIX05-FILE-STATUS.                 EL336
   122                                                                  EL336
   123     SELECT ERACCT-AIX02                                          EL336
   124         ASSIGN TO SYS013-FBA1-ERACCT2                            EL336
   125         ORGANIZATION IS INDEXED                                  EL336
   126         ACCESS IS SEQUENTIAL                                     EL336
   127         RECORD KEY IS ERACCT-AIX02-KEY                           EL336
   128         FILE STATUS IS ERACCT-AIX02-FILE-STATUS.                 EL336
   129                                                                  EL336
   130     SELECT ERPNDB-AIX02                                          EL336
   131         ASSIGN TO SYS013-FBA1-ERPNDB2                            EL336
   132         ORGANIZATION IS INDEXED                                  EL336
   133         ACCESS IS SEQUENTIAL                                     EL336
   134         RECORD KEY IS ERPNDB-AIX02-KEY                           EL336
   135         FILE STATUS IS ERPNDB-AIX02-FILE-STATUS.                 EL336
   136                                                                  EL336
   137     SELECT CARD-FILE                                             EL336
   138         ASSIGN TO SYS006-UR-2540R-S-SYS006.                      EL336
   139                                                                  EL336
   140     SELECT COMPANY-NAME-WORK-FILE                                EL336
   141         ASSIGN TO SYS012-UT-FBA1-S-SYS012.                       EL336
   142                                                                  EL336
   143     SELECT SORT-OUTPUT-FILE                                      EL336
   144         ASSIGN TO SYS018-UT-2400-S-SYS018.                       EL336
   145                                                                  EL336
   146     SELECT SORT-WORK-FILE                                        EL336
   147         ASSIGN TO SYS001-UT-3380-S-SORTWK1.                      EL336
   148                                                                  EL336
   149     SELECT PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.    EL336
   150                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL336.cbl
   152 DATA DIVISION.                                                   EL336
   153                                                                  EL336
   154 FILE SECTION.                                                    EL336
   155                                                                  EL336
   156 FD  CARD-FILE                                                    EL336
   157     BLOCK CONTAINS 0 RECORDS
   158     RECORDING MODE IS F.                                         EL336
   159                                                                  EL336
   160 01  CARD-RECORD.                                                 EL336
   161     05  CR-DATASET                  PIC X(6).                    EL336
   162     05  FILLER                      PIC X.                       EL336
   163     05  CR-RESTART-POINT.                                        EL336
   164         10  FILLER                  PIC X(6).                    EL336
   165         10  CR-AIX-NUMBER           PIC 9.                       EL336
   166         10  FILLER                  PIC X.                       EL336
   167     05  FILLER                      PIC X(65).                   EL336
   168                                                                  EL336
   169 FD  ELARCH-AIX02.                                                EL336
   170                                                                  EL336
   171 01  ELARCH-AIX02-RECORD.                                         EL336
   172     05  ELARCH-AIX02-FLAG-BYTE      PIC X.                       EL336
   173     05  ELARCH-AIX02-POINTER-LENGTH PIC X.                       EL336
   174     05  ELARCH-AIX02-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   175     05  ELARCH-AIX02-ALT-KEY-LENGTH PIC X.                       EL336
   176     05  ELARCH-AIX02-KEY            PIC X(8).                    EL336
   177     05  ELARCH-AIX02-PRIME-KEY      PIC X(8)                     EL336
   178         OCCURS 1 TIMES                                           EL336
   179         INDEXED BY ELARCH-AIX02-INDEX.                           EL336
   180                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL336.cbl
   182 FD  ELCERT-AIX02.                                                EL336
   183                                                                  EL336
   184 01  ELCERT-AIX02-RECORD.                                         EL336
   185     05  ELCERT-AIX02-FLAG-BYTE      PIC X.                       EL336
   186     05  ELCERT-AIX02-POINTER-LENGTH PIC X.                       EL336
   187     05  ELCERT-AIX02-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   188     05  ELCERT-AIX02-ALT-KEY-LENGTH PIC X.                       EL336
   189     05  ELCERT-AIX02-KEY            PIC X(18).                   EL336
   190     05  ELCERT-AIX02-PRIME-KEY      PIC X(33)                    EL336
   191         OCCURS  500  TIMES                                       EL336
   192         DEPENDING ON ELCERT-AIX02-NUMBER-OF-KEYS                 EL336
   193         INDEXED BY ELCERT-AIX02-INDEX.                           EL336
   194                                                                  EL336
   195 FD  ELCERT-AIX03.                                                EL336
   196                                                                  EL336
   197 01  ELCERT-AIX03-RECORD.                                         EL336
   198     05  ELCERT-AIX03-FLAG-BYTE      PIC X.                       EL336
   199     05  ELCERT-AIX03-POINTER-LENGTH PIC X.                       EL336
   200     05  ELCERT-AIX03-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   201     05  ELCERT-AIX03-ALT-KEY-LENGTH PIC X.                       EL336
   202     05  ELCERT-AIX03-KEY            PIC X(12).                   EL336
   203     05  ELCERT-AIX03-PRIME-KEY      PIC X(33)                    EL336
   204         OCCURS 500 TIMES                                         EL336
   205         DEPENDING ON ELCERT-AIX03-NUMBER-OF-KEYS                 EL336
   206         INDEXED BY ELCERT-AIX03-INDEX.                           EL336
   207                                                                  EL336
   208 FD  ELCERT-AIX05.                                                EL336
   209                                                                  EL336
   210 01  ELCERT-AIX05-RECORD.                                         EL336
   211     05  ELCERT-AIX05-FLAG-BYTE      PIC X.                       EL336
   212     05  ELCERT-AIX05-POINTER-LENGTH PIC X.                       EL336
   213     05  ELCERT-AIX05-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   214     05  ELCERT-AIX05-ALT-KEY-LENGTH PIC X.                       EL336
   215     05  ELCERT-AIX05-KEY            PIC X(12).                   EL336
   216     05  ELCERT-AIX05-PRIME-KEY      PIC X(33)                    EL336
   217         OCCURS 500 TIMES                                         EL336
   218         DEPENDING ON ELCERT-AIX05-NUMBER-OF-KEYS                 EL336
   219         INDEXED BY ELCERT-AIX05-INDEX.                           EL336
   220                                                                  EL336
   221 FD  ELCERT-AIX06.                                                EL336
   222                                                                  EL336
   223 01  ELCERT-AIX06-RECORD.                                         EL336
   224     05  ELCERT-AIX06-FLAG-BYTE      PIC X.                       EL336
   225     05  ELCERT-AIX06-POINTER-LENGTH PIC X.                       EL336
   226     05  ELCERT-AIX06-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   227     05  ELCERT-AIX06-ALT-KEY-LENGTH PIC X.                       EL336
   228     05  ELCERT-AIX06-KEY            PIC X(13).                   EL336
   229     05  ELCERT-AIX06-PRIME-KEY      PIC X(33)                    EL336
   230         OCCURS 500  TIMES                                        EL336
   231         DEPENDING ON ELCERT-AIX06-NUMBER-OF-KEYS                 EL336
   232         INDEXED BY ELCERT-AIX06-INDEX.                           EL336
   233                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL336.cbl
   235 FD  ELMSTR-AIX02.                                                EL336
   236                                                                  EL336
   237 01  ELMSTR-AIX02-RECORD.                                         EL336
   238     05  ELMSTR-AIX02-FLAG-BYTE      PIC X.                       EL336
   239     05  ELMSTR-AIX02-POINTER-LENGTH PIC X.                       EL336
   240     05  ELMSTR-AIX02-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   241     05  ELMSTR-AIX02-ALT-KEY-LENGTH PIC X.                       EL336
   242     05  ELMSTR-AIX02-KEY            PIC X(29).                   EL336
   243     05  ELMSTR-AIX02-PRIME-KEY      PIC X(20)                    EL336
   244         OCCURS 1145 TIMES                                        EL336
   245         DEPENDING ON ELMSTR-AIX02-NUMBER-OF-KEYS                 EL336
   246         INDEXED BY ELMSTR-AIX02-INDEX.                           EL336
   247                                                                  EL336
   248 FD  ELMSTR-AIX03.                                                EL336
   249                                                                  EL336
   250 01  ELMSTR-AIX03-RECORD.                                         EL336
   251     05  ELMSTR-AIX03-FLAG-BYTE      PIC X.                       EL336
   252     05  ELMSTR-AIX03-POINTER-LENGTH PIC X.                       EL336
   253     05  ELMSTR-AIX03-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   254     05  ELMSTR-AIX03-ALT-KEY-LENGTH PIC X.                       EL336
   255     05  ELMSTR-AIX03-KEY            PIC X(12).                   EL336
   256     05  ELMSTR-AIX03-PRIME-KEY      PIC X(20)                    EL336
   257         OCCURS 285 TIMES                                         EL336
   258         DEPENDING ON ELMSTR-AIX03-NUMBER-OF-KEYS                 EL336
   259         INDEXED BY ELMSTR-AIX03-INDEX.                           EL336
   260                                                                  EL336
   261 FD  ELMSTR-AIX05.                                                EL336
   262                                                                  EL336
   263 01  ELMSTR-AIX05-RECORD.                                         EL336
   264     05  ELMSTR-AIX05-FLAG-BYTE      PIC X.                       EL336
   265     05  ELMSTR-AIX05-POINTER-LENGTH PIC X.                       EL336
   266     05  ELMSTR-AIX05-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   267     05  ELMSTR-AIX05-ALT-KEY-LENGTH PIC X.                       EL336
   268     05  ELMSTR-AIX05-KEY            PIC X(12).                   EL336
   269     05  ELMSTR-AIX05-PRIME-KEY      PIC X(20)                    EL336
   270         OCCURS 285 TIMES                                         EL336
   271         DEPENDING ON ELMSTR-AIX05-NUMBER-OF-KEYS                 EL336
   272         INDEXED BY ELMSTR-AIX05-INDEX.                           EL336
   273                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL336.cbl
   275 FD  ERACCT-AIX02.                                                EL336
   276                                                                  EL336
   277 01  ERACCT-AIX02-RECORD.                                         EL336
   278     05  ERACCT-AIX02-FLAG-BYTE      PIC X.                       EL336
   279     05  ERACCT-AIX02-POINTER-LENGTH PIC X.                       EL336
   280     05  ERACCT-AIX02-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   281     05  ERACCT-AIX02-ALT-KEY-LENGTH PIC X.                       EL336
   282     05  ERACCT-AIX02-KEY            PIC X(26).                   EL336
   283     05  ERACCT-AIX02-PRIME-KEY      PIC X(26)                    EL336
   284         OCCURS 1 TIMES                                           EL336
   285         INDEXED BY ERACCT-AIX02-INDEX.                           EL336
   286                                                                  EL336
   287 FD  ERPNDB-AIX02.                                                EL336
   288                                                                  EL336
   289 01  ERPNDB-AIX02-RECORD.                                         EL336
   290     05  ERPNDB-AIX02-FLAG-BYTE      PIC X.                       EL336
   291     05  ERPNDB-AIX02-POINTER-LENGTH PIC X.                       EL336
   292     05  ERPNDB-AIX02-NUMBER-OF-KEYS PIC S9(4) COMP.              EL336
   293     05  ERPNDB-AIX02-ALT-KEY-LENGTH PIC X.                       EL336
   294     05  ERPNDB-AIX02-KEY            PIC X(36).                   EL336
   295     05  ERPNDB-AIX02-PRIME-KEY      PIC X(11)                    EL336
   296         OCCURS 1 TIMES                                           EL336
   297         INDEXED BY ERPNDB-AIX02-INDEX.                           EL336
   298                                                                  EL336
   300 FD  COMPANY-NAME-WORK-FILE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL336.cbl
*                                 COPY ELC335F2.                        EL336
   301******************************************************************04/19/98
   302*                                                                *ELC335F2
   303*                            ELC335F2.                           *   LV002
   304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   305*                            VMOD=2.002                          *   CL**2
   306******************************************************************ELC335F2
   307                                                                  ELC335F2
   308     RECORDING MODE IS F                                          ELC335F2
   309     BLOCK CONTAINS 0 RECORDS
   310     RECORD CONTAINS 34 CHARACTERS                                ELC335F2
   311     LABEL RECORDS ARE STANDARD.                                  ELC335F2
   312                                                                  ELC335F2
   313 01  COMPANY-NAME-WORK-RECORD.                                    ELC335F2
   314     05  NWR-COMPANY-CODE            PIC X.                       ELC335F2
   315     05  NWR-COMPANY-ID              PIC X(3).                    ELC335F2
   316     05  NWR-COMPANY-NAME            PIC X(30).                   ELC335F2
   317                                                                  ELC335F2
   318                                                                  EL336
   319 FD  SORT-OUTPUT-FILE
*                           COPY ELC335F1.                              EL336
   320***************************************************************** 04/19/98
   321*                                                               * ELC335F1
   322*                            ELC335F1.                          *    LV002
   323*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   324*                            VMOD=2.003                         *    CL**2
   325*****************************************************************.ELC335F1
   326                                                                  ELC335F1
   327     RECORDING MODE F                                             ELC335F1
   328     BLOCK CONTAINS 0 RECORDS
   329     LABEL RECORDS STANDARD.                                      ELC335F1
   330                                                                  ELC335F1
   331 01  SORT-OUTPUT-RECORD.                                          ELC335F1
   332     05  SOR-AIX-NUMBER              PIC S9(4)                    ELC335F1
   333                                     COMP.                        ELC335F1
   334     05  SOR-KEYS.                                                ELC335F1
   335         10  SOR-AIX-KEY             PIC X(18).                   ELC335F1
   336         10  SOR-PRIME-KEY           PIC X(33).                   ELC335F1
   337                                                                  ELC335F1
   338     05  FILLER                      REDEFINES                    ELC335F1
   339         SOR-KEYS.                                                ELC335F1
   340         10  SOR-AIX-KEY2            PIC X(36).                   ELC335F1
   341         10  SOR-PRIME-KEY2          PIC X(15).                   ELC335F1
   342                                                                  ELC335F1
   343     05  FILLER                      REDEFINES                    ELC335F1
   344         SOR-KEYS.                                                ELC335F1
   345         10  SOR-AIX-KEY3            PIC X(29).                   ELC335F1
   346         10  SOR-PRIME-KEY3          PIC X(22).                   ELC335F1
   347                                                                  ELC335F1
   348                                                                  EL336
   349 FD  PRNTR
*                COPY ELCPRTFD.                                         EL336
   350******************************************************************04/15/98
   351*                                                                *ELCPRTFD
   352*                                                                *ELCPRTFD
   353*                            ELCPRTFD.                           *   LV003
   354*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   355*                            VMOD=2.006                          *ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL336.cbl (/apps/prod/cid1p/copy/ELCPRTFD)
   356******************************************************************ELCPRTFD
   357     RECORDING MODE F                                             ELCPRTFD
   358     LABEL RECORDS OMITTED                                        ELCPRTFD
   359     BLOCK CONTAINS 0 RECORDS
   360     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   361 01  PRT.                                                         ELCPRTFD
   362     12  P-CTL               PIC  X.                                 CL**2
   363     12  P-DATA              PIC  X(132).                         ELCPRTFD
   364******************************************************************ELCPRTFD
   365                                                                  EL336
   366 SD  SORT-WORK-FILE                                               EL336
   367                     .                                            EL336
   368                                                                  EL336
   369 01  SORT-WORK-RECORD.                                            EL336
   370     05  SWR-OCCURS              PIC S9(3) COMP-3.                EL336
   371     05  SWR-FREQ                PIC S9(9) COMP-3.                EL336
   372                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL336.cbl
   374 WORKING-STORAGE SECTION.                                         EL336
   375 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      EL336
   376                                                                  EL336
   377 77  FILLER  PIC X(32) VALUE '********************************'.  EL336
   378 77  FILLER  PIC X(32) VALUE '     EL336 WORKING-STORAGE      '.  EL336
   379 77  FILLER  PIC X(32) VALUE '********* V/M 2.012 ************'.  EL336
   380                                                                  EL336
   381 01  FILLER                          COMP-3.                      EL336
   382     05  WS-RECORDS-RETURNED         PIC S9(9)       VALUE ZERO.  EL336
   383     05  WS-AIX02-RECORDS-INPUT      PIC S9(9)       VALUE ZERO.  EL336
   384     05  WS-AIX03-RECORDS-INPUT      PIC S9(9)       VALUE ZERO.  EL336
   385     05  WS-AIX04-RECORDS-INPUT      PIC S9(9)       VALUE ZERO.  EL336
   386     05  WS-AIX05-RECORDS-INPUT      PIC S9(9)       VALUE ZERO.  EL336
   387     05  WS-AIX06-RECORDS-INPUT      PIC S9(9)       VALUE ZERO.  EL336
   388     05  WS-AIX02-RECORDS-OUTPUT     PIC S9(9)       VALUE ZERO.  EL336
   389     05  WS-AIX03-RECORDS-OUTPUT     PIC S9(9)       VALUE ZERO.  EL336
   390     05  WS-AIX04-RECORDS-OUTPUT     PIC S9(9)       VALUE ZERO.  EL336
   391     05  WS-AIX05-RECORDS-OUTPUT     PIC S9(9)       VALUE ZERO.  EL336
   392     05  WS-AIX06-RECORDS-OUTPUT     PIC S9(9)       VALUE ZERO.  EL336
   393     05  WS-RECORDS-INPUT            PIC S9(9)       VALUE ZERO.  EL336
   394     05  WS-RECORDS-OUTPUT           PIC S9(9)       VALUE ZERO.  EL336
   395     05  WS-WORK                     PIC S9(9)       VALUE ZERO.  EL336
   396     05  WS-REMAINDER                PIC S9(9)       VALUE ZERO.  EL336
   397     05  WS-OVERFLOW-COUNT           PIC S9(9)       VALUE ZERO.  EL336
   398       88  OVERFLOW-HAS-NOT-OCCURED                  VALUE ZERO.  EL336
   399     05  WS-ZERO                     PIC S9          VALUE ZERO.  EL336
   400     05  WS-LINE-COUNT               PIC S9(3)       VALUE +99.   EL336
   401                                                                  EL336
   402     05  WS-MESSAGE-OCCURRENCE-AREA.                              EL336
   403       07  ELARCH-MESSAGE-OCCURRENCE PIC S9(7)      VALUE +10000. EL336
   404       07  ELCERT-MESSAGE-OCCURRENCE PIC S9(7)      VALUE +100000.EL336
   405       07  ELMSTR-MESSAGE-OCCURRENCE PIC S9(7)      VALUE +10000. EL336
   406       07  ERACCT-MESSAGE-OCCURRENCE PIC S9(7)      VALUE +10000. EL336
   407       07  ERPNDB-MESSAGE-OCCURRENCE PIC S9(7)      VALUE +10000. EL336
   408     05  WS-MESSAGE-OCCURRENCE       REDEFINES                    EL336
   409         WS-MESSAGE-OCCURRENCE-AREA  PIC S9(7)                    EL336
   410         OCCURS 5 TIMES.                                          EL336
   411                                                                  EL336
   412 01  FILLER                          COMP SYNC.                   EL336
   413     05  WS-RETURN-CODE              PIC S9(4)       VALUE ZERO.  EL336
   414     05  WS-INDEX                    PIC S9(4)       VALUE ZERO.  EL336
   415     05  WS-DATASET                  PIC S9(4)       VALUE ZERO.  EL336
   416       88  PROCESSING-ELARCH-FILE                    VALUE +1.    EL336
   417       88  PROCESSING-ELCERT-FILE                    VALUE +2.    EL336
   418       88  PROCESSING-ELMSTR-FILE                    VALUE +3.    EL336
   419       88  PROCESSING-ERACCT-FILE                    VALUE +4.    EL336
   420       88  PROCESSING-ERPNDB-FILE                    VALUE +5.    EL336
   421     05  WS-LAST-AIX-NUMBER          PIC S9(4)       VALUE ZERO.  EL336
   422     05  WS-RESTART-POINT            PIC S9(4)       VALUE ZERO.  EL336
   423                                                                  EL336
   424     05  ELARCH-AIX02-MAX          PIC S9(4)       VALUE +1.      EL336
   425     05  ELCERT-AIX02-MAX          PIC S9(4)       VALUE +500.    EL336
   426     05  ELCERT-AIX03-MAX          PIC S9(4)       VALUE +500.    EL336
   427     05  ELCERT-AIX05-MAX          PIC S9(4)       VALUE +500.    EL336
   428     05  ELCERT-AIX06-MAX          PIC S9(4)       VALUE +500.    EL336
   429     05  ELMSTR-AIX02-MAX          PIC S9(4)       VALUE +1145.   EL336
   430     05  ELMSTR-AIX03-MAX          PIC S9(4)       VALUE +285.    EL336
   431     05  ELMSTR-AIX05-MAX          PIC S9(4)       VALUE +285.    EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL336.cbl
   432     05  ERACCT-AIX02-MAX          PIC S9(4)       VALUE +1.      EL336
   433     05  ERPNDB-AIX02-MAX          PIC S9(4)       VALUE +1.      EL336
   434                                                                  EL336
   435     05  WS-KEY-LENGTH-AREA.                                      EL336
   436       07  ELARCH-KEY-LENGTH         PIC S9(4)       VALUE +8.    EL336
   437       07  ELARCH2-KEY-LENGTH        PIC S9(4)       VALUE +8.    EL336
   438       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   439       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   440       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   441       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   442       07  ELCERT-KEY-LENGTH         PIC S9(4)       VALUE +33.   EL336
   443       07  ELCERT2-KEY-LENGTH        PIC S9(4)       VALUE +18.   EL336
   444       07  ELCERT3-KEY-LENGTH        PIC S9(4)       VALUE +12.   EL336
   445       07  FILLER                    PIC S9(4)       VALUE +0.    EL336
   446       07  ELCERT5-KEY-LENGTH        PIC S9(4)       VALUE +12.   EL336
   447       07  ELCERT6-KEY-LENGTH        PIC S9(4)       VALUE +13.   EL336
   448       07  ELMSTR-KEY-LENGTH         PIC S9(4)       VALUE +20.   EL336
   449       07  ELMSTR2-KEY-LENGTH        PIC S9(4)       VALUE +29.   EL336
   450       07  ELMSTR3-KEY-LENGTH        PIC S9(4)       VALUE +12.   EL336
   451       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   452       07  ELMSTR5-KEY-LENGTH        PIC S9(4)       VALUE +12.   EL336
   453       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   454       07  ERACCT-KEY-LENGTH         PIC S9(4)       VALUE +26.   EL336
   455       07  ERACCT2-KEY-LENGTH        PIC S9(4)       VALUE +26.   EL336
   456       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   457       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   458       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   459       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   460       07  ERPNDB-KEY-LENGTH         PIC S9(4)       VALUE +11.   EL336
   461       07  ERPNDB2-KEY-LENGTH        PIC S9(4)       VALUE +36.   EL336
   462       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   463       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   464       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   465       07  FILLER                    PIC S9(4)       VALUE ZERO.  EL336
   466                                                                  EL336
   467     05  FILLER                      REDEFINES                    EL336
   468         WS-KEY-LENGTH-AREA          OCCURS 5 TIMES.              EL336
   469         10  WS-BASE-KEY-LENGTH      PIC S9(4).                   EL336
   470         10  WS-AIX-KEY-LENGTH       PIC S9(4)                    EL336
   471             OCCURS 5 TIMES.                                      EL336
   472                                                                  EL336
   473 01  FILLER.                                                      EL336
   474     05  WS-LAST-AIX-KEY2        PIC X(36) VALUE LOW-VALUES.      EL336
   475     05  WS-LAST-AIX-KEY         REDEFINES                        EL336
   476         WS-LAST-AIX-KEY2        PIC X(26).                       EL336
   477     05  WS-KEY-CHAR             REDEFINES                        EL336
   478         WS-LAST-AIX-KEY2        PIC X         OCCURS 36 TIMES.   EL336
   479                                                                  EL336
   480     05  WS-COMPANY-NUMBER           PIC S9(4) COMP  VALUE ZERO.  EL336
   481                                                                  EL336
   482     05  FILLER                      REDEFINES                    EL336
   483         WS-COMPANY-NUMBER.                                       EL336
   484         10  FILLER                  PIC X.                       EL336
   485         10  WS-COMPANY-CD           PIC X.                       EL336
   486                                                                  EL336
   487     05  WS-NUMBER                   REDEFINES                    EL336
   488         WS-COMPANY-NUMBER           PIC S9(4)       COMP.        EL336
   489                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL336.cbl
   490     05  FILLER                      REDEFINES                    EL336
   491         WS-COMPANY-NUMBER.                                       EL336
   492         10  FILLER                  PIC X.                       EL336
   493         10  WS-CHAR                 PIC X.                       EL336
   494                                                                  EL336
   495     05  WS-KEY-LENGTH2              REDEFINES                    EL336
   496         WS-COMPANY-NUMBER           PIC S9(4)       COMP.        EL336
   497                                                                  EL336
   498     05  FILLER                      REDEFINES                    EL336
   499         WS-COMPANY-NUMBER.                                       EL336
   500         10  FILLER                  PIC X.                       EL336
   501         10  WS-KEY-LENGTH           PIC X.                       EL336
   502                                                                  EL336
   503     05  WS-LAST-COMPANY-CD          PIC X      VALUE LOW-VALUES. EL336
   504                                                                  EL336
   505     05  ELARCH-AIX02-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   506     05  ELCERT-AIX02-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   507     05  ELCERT-AIX03-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   508     05  ELCERT-AIX05-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   509     05  ELCERT-AIX06-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   510     05  ELMSTR-AIX02-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   511     05  ELMSTR-AIX03-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   512     05  ELMSTR-AIX05-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   513     05  ERACCT-AIX02-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   514     05  ERPNDB-AIX02-FILE-STATUS    PIC XX          VALUE ZERO.  EL336
   515                                                                  EL336
   516     05  ELARCH-FILE-NAME            PIC X(8) VALUE 'ELARCH'.     EL336
   517     05  ELCERT-FILE-NAME            PIC X(8) VALUE 'ELCERT'.     EL336
   518     05  ELMSTR-FILE-NAME            PIC X(8) VALUE 'ELMSTR'.     EL336
   519     05  ERACCT-FILE-NAME            PIC X(8) VALUE 'ERACCT'.     EL336
   520     05  ERPNDB-FILE-NAME            PIC X(8) VALUE 'ERPNDB'.     EL336
   521                                                                  EL336
   522     05  WS-ERROR-MESSAGE.                                        EL336
   523         10  FILLER                  PIC X(14)       VALUE        EL336
   524             'ERROR OCCURED '.                                    EL336
   525         10  WS-EM-OPERATION         PIC X(6) VALUE 'WRITE'.      EL336
   526         10  WS-EM-FILE-NAME         PIC X(6) VALUE 'ELCERT'.     EL336
   527         10  WS-EM-AIX               PIC 9           VALUE ZERO.  EL336
   528         10  FILLER                  PIC X           VALUE 'I'.   EL336
   529                                                                  EL336
   530     05  WS-LOADED-MESSAGE.                                       EL336
   531         10  WS-LM-FILE-NAME         PIC X(6) VALUE 'ELCERT'.     EL336
   532         10  WS-LM-AIX               PIC 9           VALUE ZERO.  EL336
   533         10  FILLER                  PIC X(20)       VALUE        EL336
   534             ' SUCCESSFULLY LOADED'.                              EL336
   535                                                                  EL336
   536     05  WS-HEX-01                   PIC S9(4) COMP  VALUE +1.    EL336
   537                                                                  EL336
   538     05  FILLER                      REDEFINES                    EL336
   539         WS-HEX-01.                                               EL336
   540         10  FILLER                  PIC X.                       EL336
   541         10  WS-FLAG-BYTE            PIC X.                       EL336
   542                                                                  EL336
   543     05  FILLER.                                                  EL336
   544         10  BASE-KEY-LENGTH         PIC X.                       EL336
   545         10  AIX-KEY-LENGTHS.                                     EL336
   546             15  AIX02-KEY-LENGTH    PIC X.                       EL336
   547             15  AIX03-KEY-LENGTH    PIC X.                       EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL336.cbl
   548             15  AIX04-KEY-LENGTH    PIC X.                       EL336
   549             15  AIX05-KEY-LENGTH    PIC X.                       EL336
   550             15  AIX06-KEY-LENGTH    PIC X.                       EL336
   551                                                                  EL336
   552         10  AIX-KEY-LENGTH          REDEFINES                    EL336
   553             AIX-KEY-LENGTHS         PIC X                        EL336
   554             OCCURS 5 TIMES.                                      EL336
   555                                                                  EL336
   556     05  WS-ABEND-MESSAGE        PIC X(80)           VALUE SPACES.EL336
   557     05  WS-ABEND-FILE-STATUS    PIC XX              VALUE ZERO.  EL336
   558                                                                  EL336
   559 01  WS-AIX-COUNT-AREA             COMP-3.                        EL336
   560     05  WS-AIX-COUNT-ARRAY  OCCURS 500 TIMES INDEXED BY CI1.     EL336
   561         10  WS-AIX-COUNT-OCCURS  PIC S9(3).                      EL336
   562         10  WS-AIX-COUNT-FREQ    PIC S9(9).                      EL336
   563                                                                  EL336
   564 01  WS-TOTAL-COUNT-AREA           COMP-3.                        EL336
   565     05  WS-TOTAL-COUNT-ARRAY  OCCURS 500 TIMES INDEXED BY TI1.   EL336
   566         10  WS-TOTAL-COUNT-OCCURS  PIC S9(3).                    EL336
   567         10  WS-TOTAL-COUNT-FREQ    PIC S9(9).                    EL336
   568                                                                  EL336
   569 01  WS-COUNT-AREA-INITALIZED      PIC X(3500).                   EL336
   570                                                                  EL336
*  571            COPY ELC335W1.                                        EL336
   572******************************************************************04/19/98
   573*                                                                *ELC335W1
   574*                            ELC335W1.                           *   LV002
   575*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   576*                            VMOD=2.002                          *   CL**2
   577******************************************************************ELC335W1
   578                                                                  ELC335W1
   579 01  FILLER.                                                      ELC335W1
   580     05  WS-HEX-VALUES               PIC X(15)       VALUE        ELC335W1
   581         '123456789ABCDEF'.                                       ELC335W1
   582                                                                  ELC335W1
   583     05  WS-HEX-CHAR                 REDEFINES                    ELC335W1
   584         WS-HEX-VALUES               PIC X                        ELC335W1
   585         OCCURS 15 TIMES.                                         ELC335W1
   586                                                                  ELC335W1
   587     05  WS-COMPANY-NAME-TABLE       OCCURS 100 TIMES             ELC335W1
   588         ASCENDING KEY IS WS-COMPANY-CODE                         ELC335W1
   589         INDEXED BY CI CI-MAX.                                    ELC335W1
   590                                                                  ELC335W1
   591         10  WS-COMPANY-CODE         PIC X.                       ELC335W1
   592         10  WS-COMPANY-ID           PIC X(3).                    ELC335W1
   593         10  WS-COMPANY-NAME         PIC X(30).                   ELC335W1
   594                                                                  ELC335W1
   595     05  WS-CI-MAX                   PIC S9(4)       VALUE +100   ELC335W1
   596                                     COMP                         ELC335W1
   597                                     SYNC.                        ELC335W1
   598                                                                  ELC335W1
   599                                                                  EL336
   600     05  WS-DIGET-CHARACTERS                         VALUE SPACES.EL336
   601         10  WS-DIGET                PIC X                        EL336
   602             OCCURS 50 TIMES.                                     EL336
   603                                                                  EL336
   604 01  WS-DETAIL-LINE1.                                             EL336
   605     05  FILLER                      PIC XX.                      EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL336.cbl
   606     05  WS-D2-MESSAGE               PIC X(20).                   EL336
   607     05  FILLER                      PIC X(5).                    EL336
   608     05  WS-D2-COUNT                 PIC ZZZ,ZZZ,ZZ9-.            EL336
   609     05 FILLER                       PIC X(94).                   EL336
   610                                                                  EL336
   611 01  FILLER                          REDEFINES                    EL336
   612     WS-DETAIL-LINE1.                                             EL336
   613                                                                  EL336
   614     05  FILLER                      PIC XX.                      EL336
   615     05  WS-D3-AIX                   PIC 9.                       EL336
   616     05  FILLER                      PIC XX.                      EL336
   617     05  WS-D3-COMPANY               PIC 999.                     EL336
   618     05  FILLER                      PIC XX.                      EL336
   619     05  WS-D3-AIX-KEY.                                           EL336
   620         10  WS-D3-CHAR              PIC X                        EL336
   621             OCCURS 36 TIMES         INDEXED BY CHAR-INDEX.       EL336
   622                                                                  EL336
   623     05  FILLER                      PIC XX.                      EL336
   624     05  WS-D3-MESSAGE               PIC X(18).                   EL336
   625     05  FILLER                      PIC X(5).                    EL336
   626     05  WS-D3-COUNT                 PIC ZZZ,ZZZ,ZZ9-.            EL336
   627                                                                  EL336
   628 01  FILLER                          REDEFINES                    EL336
   629     WS-DETAIL-LINE1.                                             EL336
   630                                                                  EL336
   631     05  FILLER                      PIC XX.                      EL336
   632     05  WS-D4-FILE-NAME             PIC X(6).                    EL336
   633     05  WS-D4-AIX-NUMBER            PIC 9.                       EL336
   634     05  FILLER                      PIC XX.                      EL336
   635     05  WS-D4-COMPANY-NUMBER        PIC 999.                     EL336
   636     05  FILLER                      PIC XX.                      EL336
   637     05  WS-D4-COMPANY-ID            PIC X(3).                    EL336
   638     05  FILLER                      PIC XX.                      EL336
   639     05  WS-D4-COMPANY-CD1           PIC X.                       EL336
   640     05  WS-D4-COMPANY-CD2           PIC X.                       EL336
   641     05  FILLER                      PIC XX.                      EL336
   642     05  WS-D4-COMPANY-NAME          PIC X(30).                   EL336
   643     05  FILLER                      PIC XX.                      EL336
   644     05  WS-D4-MESSAGE               PIC X(20).                   EL336
   645     05  FILLER                      PIC X(5).                    EL336
   646     05  WS-D4-COUNT                 PIC ZZZ,ZZZ,ZZ9-.            EL336
   647                                                                  EL336
   648 01  FILLER                          REDEFINES                    EL336
   649     WS-DETAIL-LINE1.                                             EL336
   650     05  FILLER                      PIC X(25).                   EL336
   651     05  WS-D5-AIX-OCCURS            PIC ZZ9-.                    EL336
   652     05  WS-D5-AIX-OCCURS-FREQ       PIC ZZZ,ZZZ,ZZ9-.            EL336
   653                                                                  EL336
   654 01  WS-DISPLAY1.                                                 EL336
   655     05  WS-D1-TIME                  PIC 99B99B99.                EL336
   656     05  FILLER                      PIC X           VALUE SPACES.EL336
   657     05  WS-D1-MESSAGE               PIC X(30).                   EL336
   658     05  WS-D1-COUNT                 PIC ZZZ,ZZZ,ZZ9-.            EL336
   659                                                                  EL336
   660 01  WS-DATE-AND-TIME.                                            EL336
   661     12  WS-ACCEPT-DATE.                                          EL336
   662         16  WS-AD-YY                PIC  99.                     EL336
   663         16  WS-AD-MM                PIC  99.                     EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL336.cbl
   664         16  WS-AD-DD                PIC  99.                     EL336
   665     12  WS-CURRENT-DATE.                                         EL336
   666         16  WS-CD-MM                PIC  99.                     EL336
   667         16  FILLER                  PIC  X          VALUE '/'.   EL336
   668         16  WS-CD-DD                PIC  99.                     EL336
   669         16  FILLER                  PIC  X          VALUE '/'.   EL336
   670         16  WS-CD-YY                PIC  99.                     EL336
   671     12  WS-TIME-OF-DAY.                                          EL336
   672         16  WS-TIME                 PIC  9(6).                   EL336
   673         16  WS-HUN-SEC              PIC  99.                     EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL336.cbl
   675 PROCEDURE DIVISION.                                              EL336
   676                                                                  EL336
   677     OPEN INPUT CARD-FILE                                         EL336
   678                COMPANY-NAME-WORK-FILE                            EL336
   679          OUTPUT PRNTR.                                           EL336
   680                                                                  EL336
   681     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      EL336
   682                                                                  EL336
   683     MOVE WS-AD-YY               TO  WS-CD-YY.                    EL336
   684     MOVE WS-AD-MM               TO  WS-CD-MM.                    EL336
   685     MOVE WS-AD-DD               TO  WS-CD-DD.                    EL336
   686                                                                  EL336
   687*    NOTE ******************************************************* EL336
   688*         *          LOAD THE COMPANY NAME TABLE                * EL336
   689*         *******************************************************.EL336
   690                                                                  EL336
   691     SET CI TO +1.                                                EL336
   692                                                                  EL336
   693  0010-MAIN-LOGIC.                                                EL336
   694     READ COMPANY-NAME-WORK-FILE INTO WS-COMPANY-NAME-TABLE (CI)  EL336
   695         AT END                                                   EL336
   696             CLOSE COMPANY-NAME-WORK-FILE                         EL336
   697             SET CI-MAX TO CI                                     EL336
   698             SET CI-MAX DOWN BY +1                                EL336
   699             GO TO 0020-MAIN-LOGIC.                               EL336
   700                                                                  EL336
   701     IF CI LESS THAN WS-CI-MAX                                    EL336
   702         SET CI UP BY +1                                          EL336
   703         GO TO 0010-MAIN-LOGIC.                                   EL336
   704                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL336.cbl
   706 0020-MAIN-LOGIC.                                                 EL336
   707*    NOTE ******************************************************* EL336
   708*         *      READ THE CONTROL CARDS TO SEE WHICH ALTERNATE  * EL336
   709*         *  INDEXES TO LOAD AND THEN SET THE BASE KEY LENGTH   * EL336
   710*         *  AND ALL OF THE ALTERNATE KEY LENGTHS.              * EL336
   711*         *******************************************************.EL336
   712                                                                  EL336
   713     READ CARD-FILE                                               EL336
   714         AT END                                                   EL336
   715             GO TO 0900-MAIN-LOGIC.                               EL336
   716                                                                  EL336
   717     MOVE ZERO                   TO  WS-RECORDS-RETURNED.         EL336
   718                                                                  EL336
   719     IF CR-DATASET = ELARCH-FILE-NAME                             EL336
   720         MOVE +1                 TO  WS-DATASET                   EL336
   721         MOVE ELARCH-FILE-NAME   TO  WS-EM-FILE-NAME              EL336
   722                                     WS-LM-FILE-NAME              EL336
   723         GO TO 0100-MAIN-LOGIC.                                   EL336
   724                                                                  EL336
   725     IF CR-DATASET = ELCERT-FILE-NAME                             EL336
   726         MOVE +2                 TO  WS-DATASET                   EL336
   727         MOVE ELCERT-FILE-NAME   TO  WS-EM-FILE-NAME              EL336
   728                                     WS-LM-FILE-NAME              EL336
   729         GO TO 0100-MAIN-LOGIC.                                   EL336
   730                                                                  EL336
   731     IF CR-DATASET = ELMSTR-FILE-NAME                             EL336
   732         MOVE +3                 TO  WS-DATASET                   EL336
   733         MOVE ELMSTR-FILE-NAME   TO  WS-EM-FILE-NAME              EL336
   734                                     WS-LM-FILE-NAME              EL336
   735         GO TO 0100-MAIN-LOGIC.                                   EL336
   736                                                                  EL336
   737     IF CR-DATASET = ERACCT-FILE-NAME                             EL336
   738         MOVE +4                 TO  WS-DATASET                   EL336
   739         MOVE ERACCT-FILE-NAME   TO  WS-EM-FILE-NAME              EL336
   740                                     WS-LM-FILE-NAME              EL336
   741         GO TO 0100-MAIN-LOGIC.                                   EL336
   742                                                                  EL336
   743     IF CR-DATASET = ERPNDB-FILE-NAME                             EL336
   744         MOVE +5                 TO  WS-DATASET                   EL336
   745         MOVE ERPNDB-FILE-NAME   TO  WS-EM-FILE-NAME              EL336
   746                                     WS-LM-FILE-NAME              EL336
   747         GO TO 0100-MAIN-LOGIC.                                   EL336
   748                                                                  EL336
   749     MOVE 'INVALID DATASET NAME'  TO  WS-ABEND-MESSAGE.           EL336
   750     GO TO ABEND-PGM.                                             EL336
   751                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL336.cbl
   753 0100-MAIN-LOGIC.                                                 EL336
   754     MOVE WS-BASE-KEY-LENGTH (WS-DATASET) TO  WS-KEY-LENGTH2.     EL336
   755     MOVE WS-KEY-LENGTH          TO  BASE-KEY-LENGTH.             EL336
   756                                                                  EL336
   757     MOVE +1                     TO  WS-INDEX.                    EL336
   758                                                                  EL336
   759 0110-MAIN-LOGIC.                                                 EL336
   760     MOVE WS-AIX-KEY-LENGTH (WS-DATASET WS-INDEX)                 EL336
   761                                 TO  WS-KEY-LENGTH2.              EL336
   762     MOVE WS-KEY-LENGTH      TO  AIX-KEY-LENGTH (WS-INDEX).       EL336
   763                                                                  EL336
   764     IF WS-INDEX LESS THAN +5                                     EL336
   765         ADD +1  TO  WS-INDEX                                     EL336
   766         GO TO 0110-MAIN-LOGIC.                                   EL336
   767                                                                  EL336
   768     SET CI1 TO +1.                                               EL336
   769                                                                  EL336
   770 0120-MAIN-LOGIC.                                                 EL336
   771     MOVE ZERO  TO  WS-AIX-COUNT-OCCURS (CI1)                     EL336
   772                    WS-AIX-COUNT-FREQ (CI1).                      EL336
   773                                                                  EL336
   774     IF CI1 IS LESS THAN +500                                     EL336
   775         SET CI1 UP BY +1                                         EL336
   776         GO TO 0120-MAIN-LOGIC.                                   EL336
   777                                                                  EL336
   778     SET CI1 TI1 TO +1.                                           EL336
   779                                                                  EL336
   780     MOVE WS-AIX-COUNT-AREA  TO  WS-COUNT-AREA-INITALIZED.        EL336
   781     MOVE WS-COUNT-AREA-INITALIZED TO WS-TOTAL-COUNT-AREA.        EL336
   782                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL336.cbl
   784*    NOTE ******************************************************* EL336
   785*         *      CHECK TO SEE IF THERE IS A RESTART POINT.      * EL336
   786*         *                                                     * EL336
   787*         *      THAT IS,YOU HAVE SUCCESSFULLY LOADED THE FIRST * EL336
   788*         *  ALTERNATE INDEX AND SOMETHING HAPPENED DURING THE  * EL336
   789*         *  LOADING OF THE SECOND ALTERNATE INDEX.SO SINCE THE * EL336
   790*         *  LOADING OF THE FIRST AIX WAS SUCCESSFUL, THEN YOU  * EL336
   791*         *  CAN BYPASS THE LOADING OF THE FIRST AIX WITH A     * EL336
   792*         *  RESTART POINT.                                     * EL336
   793*         *******************************************************.EL336
   794                                                                  EL336
   795     MOVE +1                     TO  WS-RESTART-POINT.            EL336
   796                                                                  EL336
   797     IF CR-RESTART-POINT = SPACES                                 EL336
   798         GO TO 0200-MAIN-LOGIC.                                   EL336
   799                                                                  EL336
   800     IF (CR-RESTART-POINT = 'ELARCH2 ' AND                        EL336
   801         CR-DATASET = ELARCH-FILE-NAME)                           EL336
   802       OR                                                         EL336
   803        (CR-RESTART-POINT = ('ELCERT2 ' OR                        EL336
   804                                    'ELCERT3 ' OR                 EL336
   805                                    'ELCERT5 ' OR                 EL336
   806                                    'ELCERT6 ') AND               EL336
   807         CR-DATASET = ELCERT-FILE-NAME)                           EL336
   808       OR                                                         EL336
   809        (CR-RESTART-POINT = ('ELMSTR2 ' OR                        EL336
   810                                    'ELMSTR3 ' OR                 EL336
   811                                    'ELMSTR5 ') AND               EL336
   812         CR-DATASET = ELMSTR-FILE-NAME)                           EL336
   813       OR                                                         EL336
   814        (CR-RESTART-POINT = 'ERACCT2 ' AND                        EL336
   815         CR-DATASET = ERACCT-FILE-NAME)                           EL336
   816       OR                                                         EL336
   817        (CR-RESTART-POINT = 'ERPNDB2 ' AND                        EL336
   818         CR-DATASET = ERPNDB-FILE-NAME)                           EL336
   819             MOVE CR-AIX-NUMBER      TO  WS-RESTART-POINT         EL336
   820             SUBTRACT +1 FROM WS-RESTART-POINT                    EL336
   821           ELSE                                                   EL336
   822             MOVE 'RESTART POINT NOT VALID'  TO  WS-ABEND-MESSAGE EL336
   823             GO TO ABEND-PGM.                                     EL336
   824                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL336.cbl
   826 0200-MAIN-LOGIC.                                                 EL336
   827     PERFORM 3000-SORT-OUTPUT-PROCEDURE.                          EL336
   828                                                                  EL336
   829     MOVE '0'                    TO  WS-DETAIL-LINE1.             EL336
   830                                                                  EL336
   831     MOVE 'RECORDS RETURNED'     TO  WS-D2-MESSAGE.               EL336
   832     MOVE WS-RECORDS-RETURNED    TO  WS-D2-COUNT.                 EL336
   833     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   834     PERFORM WRITE-PRINTER.                                       EL336
   835                                                                  EL336
   836     MOVE 'AIX02 RECORDS INPUT'  TO  WS-D2-MESSAGE.               EL336
   837     MOVE WS-AIX02-RECORDS-INPUT TO  WS-D2-COUNT.                 EL336
   838     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   839     PERFORM WRITE-PRINTER.                                       EL336
   840                                                                  EL336
   841     MOVE 'AIX02 RECORDS OUTPUT' TO  WS-D2-MESSAGE.               EL336
   842     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D2-COUNT.                EL336
   843     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   844     PERFORM WRITE-PRINTER.                                       EL336
   845                                                                  EL336
   846     MOVE 'AIX03 RECORDS INPUT'  TO  WS-D2-MESSAGE.               EL336
   847     MOVE WS-AIX03-RECORDS-INPUT TO  WS-D2-COUNT.                 EL336
   848     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   849     PERFORM WRITE-PRINTER.                                       EL336
   850                                                                  EL336
   851     MOVE 'AIX03 RECORDS OUTPUT' TO  WS-D2-MESSAGE.               EL336
   852     MOVE WS-AIX03-RECORDS-OUTPUT TO  WS-D2-COUNT.                EL336
   853     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   854     PERFORM WRITE-PRINTER.                                       EL336
   855                                                                  EL336
   856     MOVE 'AIX04 RECORDS INPUT'  TO  WS-D2-MESSAGE.               EL336
   857     MOVE WS-AIX04-RECORDS-INPUT TO  WS-D2-COUNT.                 EL336
   858     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   859     PERFORM WRITE-PRINTER.                                       EL336
   860                                                                  EL336
   861     MOVE 'AIX04 RECORDS OUTPUT' TO  WS-D2-MESSAGE.               EL336
   862     MOVE WS-AIX04-RECORDS-OUTPUT TO  WS-D2-COUNT.                EL336
   863     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   864     PERFORM WRITE-PRINTER.                                       EL336
   865                                                                  EL336
   866     MOVE 'AIX05 RECORDS INPUT'  TO  WS-D2-MESSAGE.               EL336
   867     MOVE WS-AIX05-RECORDS-INPUT TO  WS-D2-COUNT.                 EL336
   868     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   869     PERFORM WRITE-PRINTER.                                       EL336
   870                                                                  EL336
   871     MOVE 'AIX05 RECORDS OUTPUT' TO  WS-D2-MESSAGE.               EL336
   872     MOVE WS-AIX05-RECORDS-OUTPUT TO  WS-D2-COUNT.                EL336
   873     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   874     PERFORM WRITE-PRINTER.                                       EL336
   875                                                                  EL336
   876     MOVE 'AIX06 RECORDS INPUT'  TO  WS-D2-MESSAGE.               EL336
   877     MOVE WS-AIX06-RECORDS-INPUT TO  WS-D2-COUNT.                 EL336
   878     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
   879     PERFORM WRITE-PRINTER.                                       EL336
   880                                                                  EL336
   881     MOVE 'AIX06 RECORDS OUTPUT' TO  WS-D2-MESSAGE.               EL336
   882     MOVE WS-AIX06-RECORDS-OUTPUT TO  WS-D2-COUNT.                EL336
   883     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL336.cbl
   884     PERFORM WRITE-PRINTER.                                       EL336
   885                                                                  EL336
   886     GO TO 0020-MAIN-LOGIC.                                       EL336
   887                                                                  EL336
   888 0900-MAIN-LOGIC.                                                 EL336
   889     CLOSE CARD-FILE                                              EL336
   890           PRNTR.                                                 EL336
   891                                                                  EL336
   892     GOBACK.                                                      EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL336.cbl
   894 3000-SORT-OUTPUT-PROCEDURE SECTION.                              EL336
   895                                                                  EL336
   896*    NOTE ******************************************************* EL336
   897*         *                                                     * EL336
   898*         *      THIS SECTION READS THE SORTED ALTERNATE INDEX  * EL336
   899*         *  KEYS AND LOADS THEM TO THE ALTERNATE INDEX RECORDS * EL336
   900*         *                                                     * EL336
   901*         *      ON THE FIRST RECORD OF EACH ALTERNATE INDEX    * EL336
   902*         *  THE ALTERNATE INDEX VSAM FILE WILL BE OPENED.      * EL336
   903*         *                                                     * EL336
   904*         *      AS EACH RECORD IS BEING LOADED,WHEN THE RECORD * EL336
   905*         *  IS FULL OR THE AIX KEY CHANGES,THE RECORD WILL BE  * EL336
   906*         *  OUTPUT.  IF MORE ALTERNATE KEYS ARE AVAILABLE THAN * EL336
   907*         *  WILL FIT IN THE ALTERNATE INDEX RECORD,THE AIX KEY * EL336
   908*         *  THAT OVERFLOWED WILL BE PRINTED WITH THE NUMBER OF * EL336
   909*         *  TIMES IT OVERFLOWED.                               * EL336
   910*         *******************************************************.EL336
   911                                                                  EL336
   912     OPEN INPUT SORT-OUTPUT-FILE.                                 EL336
   913                                                                  EL336
   914 3100-SOP.                                                        EL336
   915     READ SORT-OUTPUT-FILE                                        EL336
   916         AT END                                                   EL336
   917             PERFORM 4000-WRITE-AIX                               EL336
   918             PERFORM 6000-CLOSE-AIX                               EL336
   919             PERFORM 7000-PRINT-COMPANY-TOTALS                    EL336
   920             CLOSE SORT-OUTPUT-FILE                               EL336
   921             GO TO 3900-EXIT.                                     EL336
   922                                                                  EL336
   923     ADD +1  TO  WS-RECORDS-RETURNED.                             EL336
   924                                                                  EL336
   925     DIVIDE WS-RECORDS-RETURNED                                   EL336
   926         BY WS-MESSAGE-OCCURRENCE (WS-DATASET)                    EL336
   927             GIVING WS-WORK REMAINDER WS-REMAINDER.               EL336
   928                                                                  EL336
   929     IF WS-REMAINDER = ZERO                                       EL336
   930         MOVE WS-RECORDS-RETURNED  TO  WS-D1-COUNT                EL336
   931         ACCEPT WS-TIME-OF-DAY     FROM  TIME                     EL336
   932         MOVE WS-TIME              TO  WS-D1-TIME                 EL336
   933         INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'           EL336
   934         MOVE 'RECORDS RETURNED='  TO  WS-D1-MESSAGE              EL336
   935         DISPLAY WS-DISPLAY1 UPON CONSOLE.                        EL336
   936                                                                  EL336
   937     IF SOR-AIX-NUMBER LESS THAN WS-RESTART-POINT                 EL336
   938         GO TO 3100-SOP.                                          EL336
   939                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL336.cbl
   941     IF WS-RECORDS-RETURNED = +1                                  EL336
   942         MOVE SOR-AIX-NUMBER     TO  WS-LAST-AIX-NUMBER           EL336
   943         MOVE SOR-AIX-KEY        TO  WS-LAST-COMPANY-CD.          EL336
   944                                                                  EL336
   945     IF SOR-AIX-NUMBER NOT = WS-LAST-AIX-NUMBER                   EL336
   946         PERFORM 4000-WRITE-AIX                                   EL336
   947         PERFORM 7000-PRINT-COMPANY-TOTALS                        EL336
   948         MOVE SOR-AIX-KEY        TO  WS-LAST-COMPANY-CD           EL336
   949         PERFORM 6000-CLOSE-AIX                                   EL336
   950       ELSE                                                       EL336
   951         MOVE SOR-AIX-KEY        TO  WS-COMPANY-CD                EL336
   952         IF WS-COMPANY-CD NOT = WS-LAST-COMPANY-CD                EL336
   953             PERFORM 7000-PRINT-COMPANY-TOTALS                    EL336
   954             MOVE SOR-AIX-KEY    TO  WS-LAST-COMPANY-CD.          EL336
   955                                                                  EL336
   956     ADD +1  TO  WS-RECORDS-INPUT.                                EL336
   957                                                                  EL336
   958     MOVE SOR-AIX-NUMBER         TO  WS-LAST-AIX-NUMBER.          EL336
   959                                                                  EL336
   960     GO TO 3300-SOP-ELARCH                                        EL336
   961           3400-SOP-ELCERT                                        EL336
   962           3500-SOP-ELMSTR                                        EL336
   963           3600-SOP-ERACCT                                        EL336
   964           3700-SOP-ERPNDB DEPENDING ON WS-DATASET.               EL336
   965                                                                  EL336
   967 3300-SOP-ELARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL336.cbl
*                       COPY ELC336P1 REPLACING                         EL336
*  968     AIX02-INDEX                 BY  ELARCH-AIX02-INDEX           EL336
*  969     AIX02-FLAG-BYTE             BY  ELARCH-AIX02-FLAG-BYTE       EL336
*  970     AIX02-POINTER-LENGTH        BY  ELARCH-AIX02-POINTER-LENGTH  EL336
*  971     AIX02-ALT-KEY-LENGTH        BY  ELARCH-AIX02-ALT-KEY-LENGTH  EL336
*  972     AIX02-KEY                   BY  ELARCH-AIX02-KEY             EL336
*  973     AIX02-PRIME-KEY             BY  ELARCH-AIX02-PRIME-KEY       EL336
*  974     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
*  975     WS-AIX02-KEY-LENGTH         BY  AIX02-KEY-LENGTH             EL336
*  976     WS-AIX02-RECORDS-INPUT      BY  WS-AIX02-RECORDS-INPUT       EL336
*  977     WS-AIX02-MAX                BY  ELARCH-AIX02-MAX.            EL336
   978*****************************************************************
   979*                                                               *
   980*                            ELC336P1.                          *
   981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   982*                            VMOD=2.003                         *
   983*****************************************************************.
   984
   985     IF WS-AIX02-RECORDS-INPUT EQUAL TO ZERO
   986         PERFORM 5000-OPEN-AIX
   987         SET ELARCH-AIX02-INDEX TO +1
   988         MOVE WS-FLAG-BYTE        TO ELARCH-AIX02-FLAG-BYTE
   989         MOVE BASE-KEY-LENGTH     TO ELARCH-AIX02-POINTER-LENGTH
   990         MOVE AIX02-KEY-LENGTH    TO ELARCH-AIX02-ALT-KEY-LENGTH
   991         MOVE SOR-AIX-KEY         TO ELARCH-AIX02-KEY
   992                                     WS-LAST-AIX-KEY.
   993
   994     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
   995         PERFORM 4000-WRITE-AIX
   996         MOVE WS-FLAG-BYTE        TO ELARCH-AIX02-FLAG-BYTE
   997         MOVE BASE-KEY-LENGTH     TO ELARCH-AIX02-POINTER-LENGTH
   998         MOVE AIX02-KEY-LENGTH    TO ELARCH-AIX02-ALT-KEY-LENGTH
   999         MOVE SOR-AIX-KEY         TO ELARCH-AIX02-KEY
  1000                                     WS-LAST-AIX-KEY.
  1001
  1002     ADD +1  TO  WS-AIX02-RECORDS-INPUT.
  1003
  1004     IF ELARCH-AIX02-INDEX NOT GREATER ELARCH-AIX02-MAX
  1005         MOVE SOR-PRIME-KEY       TO ELARCH-AIX02-PRIME-KEY (ELARCH-AIX02-INDEX)
  1006         SET ELARCH-AIX02-INDEX UP BY +1
  1007       ELSE
  1008         ADD +1  TO  WS-OVERFLOW-COUNT.
  1009
  1010     GO TO 3100-SOP.
  1011
  1012                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL336.cbl
  1014 3400-SOP-ELCERT.                                                 EL336
  1015     GO TO 3420-SOP-ELCERT2                                       EL336
  1016           3430-SOP-ELCERT3                                       EL336
  1017           3440-SOP-ELCERT4                                       EL336
  1018           3450-SOP-ELCERT5                                       EL336
  1019           3460-SOP-ELCERT6 DEPENDING ON SOR-AIX-NUMBER.          EL336
  1020                                                                  EL336
  1021 3420-SOP-ELCERT2.
*                        COPY ELC336P1 REPLACING                        EL336
* 1022     AIX02-INDEX                 BY  ELCERT-AIX02-INDEX           EL336
* 1023     AIX02-FLAG-BYTE             BY  ELCERT-AIX02-FLAG-BYTE       EL336
* 1024     AIX02-POINTER-LENGTH        BY  ELCERT-AIX02-POINTER-LENGTH  EL336
* 1025     AIX02-ALT-KEY-LENGTH        BY  ELCERT-AIX02-ALT-KEY-LENGTH  EL336
* 1026     AIX02-KEY                   BY  ELCERT-AIX02-KEY             EL336
* 1027     AIX02-PRIME-KEY             BY  ELCERT-AIX02-PRIME-KEY       EL336
* 1028     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1029     WS-AIX02-KEY-LENGTH         BY  AIX02-KEY-LENGTH             EL336
* 1030     WS-AIX02-RECORDS-INPUT      BY  WS-AIX02-RECORDS-INPUT       EL336
* 1031     WS-AIX02-MAX                BY  ELCERT-AIX02-MAX.            EL336
  1032*****************************************************************
  1033*                                                               *
  1034*                            ELC336P1.                          *
  1035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1036*                            VMOD=2.003                         *
  1037*****************************************************************.
  1038
  1039     IF WS-AIX02-RECORDS-INPUT EQUAL TO ZERO
  1040         PERFORM 5000-OPEN-AIX
  1041         SET ELCERT-AIX02-INDEX TO +1
  1042         MOVE WS-FLAG-BYTE        TO ELCERT-AIX02-FLAG-BYTE
  1043         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX02-POINTER-LENGTH
  1044         MOVE AIX02-KEY-LENGTH    TO ELCERT-AIX02-ALT-KEY-LENGTH
  1045         MOVE SOR-AIX-KEY         TO ELCERT-AIX02-KEY
  1046                                     WS-LAST-AIX-KEY.
  1047
  1048     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1049         PERFORM 4000-WRITE-AIX
  1050         MOVE WS-FLAG-BYTE        TO ELCERT-AIX02-FLAG-BYTE
  1051         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX02-POINTER-LENGTH
  1052         MOVE AIX02-KEY-LENGTH    TO ELCERT-AIX02-ALT-KEY-LENGTH
  1053         MOVE SOR-AIX-KEY         TO ELCERT-AIX02-KEY
  1054                                     WS-LAST-AIX-KEY.
  1055
  1056     ADD +1  TO  WS-AIX02-RECORDS-INPUT.
  1057
  1058     IF ELCERT-AIX02-INDEX NOT GREATER ELCERT-AIX02-MAX
  1059         MOVE SOR-PRIME-KEY       TO ELCERT-AIX02-PRIME-KEY (ELCERT-AIX02-INDEX)
  1060         SET ELCERT-AIX02-INDEX UP BY +1
  1061       ELSE
  1062         ADD +1  TO  WS-OVERFLOW-COUNT.
  1063
  1064     GO TO 3100-SOP.
  1065
  1066                                                                  EL336
  1068 3430-SOP-ELCERT3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL336.cbl
*                        COPY ELC336P1 REPLACING                        EL336
* 1069     AIX02-INDEX                 BY  ELCERT-AIX03-INDEX           EL336
* 1070     AIX02-FLAG-BYTE             BY  ELCERT-AIX03-FLAG-BYTE       EL336
* 1071     AIX02-POINTER-LENGTH        BY  ELCERT-AIX03-POINTER-LENGTH  EL336
* 1072     AIX02-ALT-KEY-LENGTH        BY  ELCERT-AIX03-ALT-KEY-LENGTH  EL336
* 1073     AIX02-KEY                   BY  ELCERT-AIX03-KEY             EL336
* 1074     AIX02-PRIME-KEY             BY  ELCERT-AIX03-PRIME-KEY       EL336
* 1075     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1076     WS-AIX02-KEY-LENGTH         BY  AIX03-KEY-LENGTH             EL336
* 1077     WS-AIX02-RECORDS-INPUT      BY  WS-AIX03-RECORDS-INPUT       EL336
* 1078     WS-AIX02-MAX                BY  ELCERT-AIX03-MAX.            EL336
  1079*****************************************************************
  1080*                                                               *
  1081*                            ELC336P1.                          *
  1082*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1083*                            VMOD=2.003                         *
  1084*****************************************************************.
  1085
  1086     IF WS-AIX03-RECORDS-INPUT EQUAL TO ZERO
  1087         PERFORM 5000-OPEN-AIX
  1088         SET ELCERT-AIX03-INDEX TO +1
  1089         MOVE WS-FLAG-BYTE        TO ELCERT-AIX03-FLAG-BYTE
  1090         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX03-POINTER-LENGTH
  1091         MOVE AIX03-KEY-LENGTH    TO ELCERT-AIX03-ALT-KEY-LENGTH
  1092         MOVE SOR-AIX-KEY         TO ELCERT-AIX03-KEY
  1093                                     WS-LAST-AIX-KEY.
  1094
  1095     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1096         PERFORM 4000-WRITE-AIX
  1097         MOVE WS-FLAG-BYTE        TO ELCERT-AIX03-FLAG-BYTE
  1098         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX03-POINTER-LENGTH
  1099         MOVE AIX03-KEY-LENGTH    TO ELCERT-AIX03-ALT-KEY-LENGTH
  1100         MOVE SOR-AIX-KEY         TO ELCERT-AIX03-KEY
  1101                                     WS-LAST-AIX-KEY.
  1102
  1103     ADD +1  TO  WS-AIX03-RECORDS-INPUT.
  1104
  1105     IF ELCERT-AIX03-INDEX NOT GREATER ELCERT-AIX03-MAX
  1106         MOVE SOR-PRIME-KEY       TO ELCERT-AIX03-PRIME-KEY (ELCERT-AIX03-INDEX)
  1107         SET ELCERT-AIX03-INDEX UP BY +1
  1108       ELSE
  1109         ADD +1  TO  WS-OVERFLOW-COUNT.
  1110
  1111     GO TO 3100-SOP.
  1112
  1113                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL336.cbl
  1115 3440-SOP-ELCERT4.                                                EL336
  1116     GO TO 3100-SOP.                                              EL336
  1117                                                                  EL336
  1118 3450-SOP-ELCERT5.
*                        COPY ELC336P1 REPLACING                        EL336
* 1119     AIX02-INDEX                 BY  ELCERT-AIX05-INDEX           EL336
* 1120     AIX02-FLAG-BYTE             BY  ELCERT-AIX05-FLAG-BYTE       EL336
* 1121     AIX02-POINTER-LENGTH        BY  ELCERT-AIX05-POINTER-LENGTH  EL336
* 1122     AIX02-ALT-KEY-LENGTH        BY  ELCERT-AIX05-ALT-KEY-LENGTH  EL336
* 1123     AIX02-KEY                   BY  ELCERT-AIX05-KEY             EL336
* 1124     AIX02-PRIME-KEY             BY  ELCERT-AIX05-PRIME-KEY       EL336
* 1125     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1126     WS-AIX02-KEY-LENGTH         BY  AIX05-KEY-LENGTH             EL336
* 1127     WS-AIX02-RECORDS-INPUT      BY  WS-AIX05-RECORDS-INPUT       EL336
* 1128     WS-AIX02-MAX                BY  ELCERT-AIX05-MAX.            EL336
  1129*****************************************************************
  1130*                                                               *
  1131*                            ELC336P1.                          *
  1132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1133*                            VMOD=2.003                         *
  1134*****************************************************************.
  1135
  1136     IF WS-AIX05-RECORDS-INPUT EQUAL TO ZERO
  1137         PERFORM 5000-OPEN-AIX
  1138         SET ELCERT-AIX05-INDEX TO +1
  1139         MOVE WS-FLAG-BYTE        TO ELCERT-AIX05-FLAG-BYTE
  1140         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX05-POINTER-LENGTH
  1141         MOVE AIX05-KEY-LENGTH    TO ELCERT-AIX05-ALT-KEY-LENGTH
  1142         MOVE SOR-AIX-KEY         TO ELCERT-AIX05-KEY
  1143                                     WS-LAST-AIX-KEY.
  1144
  1145     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1146         PERFORM 4000-WRITE-AIX
  1147         MOVE WS-FLAG-BYTE        TO ELCERT-AIX05-FLAG-BYTE
  1148         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX05-POINTER-LENGTH
  1149         MOVE AIX05-KEY-LENGTH    TO ELCERT-AIX05-ALT-KEY-LENGTH
  1150         MOVE SOR-AIX-KEY         TO ELCERT-AIX05-KEY
  1151                                     WS-LAST-AIX-KEY.
  1152
  1153     ADD +1  TO  WS-AIX05-RECORDS-INPUT.
  1154
  1155     IF ELCERT-AIX05-INDEX NOT GREATER ELCERT-AIX05-MAX
  1156         MOVE SOR-PRIME-KEY       TO ELCERT-AIX05-PRIME-KEY (ELCERT-AIX05-INDEX)
  1157         SET ELCERT-AIX05-INDEX UP BY +1
  1158       ELSE
  1159         ADD +1  TO  WS-OVERFLOW-COUNT.
  1160
  1161     GO TO 3100-SOP.
  1162
  1163                                                                  EL336
  1165 3460-SOP-ELCERT6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL336.cbl
*                        COPY ELC336P1 REPLACING                        EL336
* 1166     AIX02-INDEX                 BY  ELCERT-AIX06-INDEX           EL336
* 1167     AIX02-FLAG-BYTE             BY  ELCERT-AIX06-FLAG-BYTE       EL336
* 1168     AIX02-POINTER-LENGTH        BY  ELCERT-AIX06-POINTER-LENGTH  EL336
* 1169     AIX02-ALT-KEY-LENGTH        BY  ELCERT-AIX06-ALT-KEY-LENGTH  EL336
* 1170     AIX02-KEY                   BY  ELCERT-AIX06-KEY             EL336
* 1171     AIX02-PRIME-KEY             BY  ELCERT-AIX06-PRIME-KEY       EL336
* 1172     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1173     WS-AIX02-KEY-LENGTH         BY  AIX06-KEY-LENGTH             EL336
* 1174     WS-AIX02-RECORDS-INPUT      BY  WS-AIX06-RECORDS-INPUT       EL336
* 1175     WS-AIX02-MAX                BY  ELCERT-AIX06-MAX.            EL336
  1176*****************************************************************
  1177*                                                               *
  1178*                            ELC336P1.                          *
  1179*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1180*                            VMOD=2.003                         *
  1181*****************************************************************.
  1182
  1183     IF WS-AIX06-RECORDS-INPUT EQUAL TO ZERO
  1184         PERFORM 5000-OPEN-AIX
  1185         SET ELCERT-AIX06-INDEX TO +1
  1186         MOVE WS-FLAG-BYTE        TO ELCERT-AIX06-FLAG-BYTE
  1187         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX06-POINTER-LENGTH
  1188         MOVE AIX06-KEY-LENGTH    TO ELCERT-AIX06-ALT-KEY-LENGTH
  1189         MOVE SOR-AIX-KEY         TO ELCERT-AIX06-KEY
  1190                                     WS-LAST-AIX-KEY.
  1191
  1192     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1193         PERFORM 4000-WRITE-AIX
  1194         MOVE WS-FLAG-BYTE        TO ELCERT-AIX06-FLAG-BYTE
  1195         MOVE BASE-KEY-LENGTH     TO ELCERT-AIX06-POINTER-LENGTH
  1196         MOVE AIX06-KEY-LENGTH    TO ELCERT-AIX06-ALT-KEY-LENGTH
  1197         MOVE SOR-AIX-KEY         TO ELCERT-AIX06-KEY
  1198                                     WS-LAST-AIX-KEY.
  1199
  1200     ADD +1  TO  WS-AIX06-RECORDS-INPUT.
  1201
  1202     IF ELCERT-AIX06-INDEX NOT GREATER ELCERT-AIX06-MAX
  1203         MOVE SOR-PRIME-KEY       TO ELCERT-AIX06-PRIME-KEY (ELCERT-AIX06-INDEX)
  1204         SET ELCERT-AIX06-INDEX UP BY +1
  1205       ELSE
  1206         ADD +1  TO  WS-OVERFLOW-COUNT.
  1207
  1208     GO TO 3100-SOP.
  1209
  1210                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL336.cbl
  1212 3500-SOP-ELMSTR.                                                 EL336
  1213     GO TO 3520-SOP-ELMSTR2                                       EL336
  1214           3530-SOP-ELMSTR3                                       EL336
  1215           3540-SOP-ELMSTR4                                       EL336
  1216           3550-SOP-ELMSTR5 DEPENDING ON SOR-AIX-NUMBER.          EL336
  1217                                                                  EL336
  1218 3520-SOP-ELMSTR2.
*                        COPY ELC336P1 REPLACING                        EL336
* 1219     AIX02-INDEX                 BY  ELMSTR-AIX02-INDEX           EL336
* 1220     AIX02-FLAG-BYTE             BY  ELMSTR-AIX02-FLAG-BYTE       EL336
* 1221     AIX02-POINTER-LENGTH        BY  ELMSTR-AIX02-POINTER-LENGTH  EL336
* 1222     AIX02-ALT-KEY-LENGTH        BY  ELMSTR-AIX02-ALT-KEY-LENGTH  EL336
* 1223     AIX02-KEY                   BY  ELMSTR-AIX02-KEY             EL336
* 1224     AIX02-PRIME-KEY             BY  ELMSTR-AIX02-PRIME-KEY       EL336
* 1225     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1226     WS-AIX02-KEY-LENGTH         BY  AIX02-KEY-LENGTH             EL336
* 1227     WS-AIX02-RECORDS-INPUT      BY  WS-AIX02-RECORDS-INPUT       EL336
* 1228     WS-AIX02-MAX                BY  ELMSTR-AIX02-MAX             EL336
* 1229     SOR-AIX-KEY                 BY SOR-AIX-KEY3                  EL336
* 1230     SOR-PRIME-KEY               BY SOR-PRIME-KEY3                EL336
* 1231     WS-LAST-AIX-KEY             BY WS-LAST-AIX-KEY2.             EL336
  1232*****************************************************************
  1233*                                                               *
  1234*                            ELC336P1.                          *
  1235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1236*                            VMOD=2.003                         *
  1237*****************************************************************.
  1238
  1239     IF WS-AIX02-RECORDS-INPUT EQUAL TO ZERO
  1240         PERFORM 5000-OPEN-AIX
  1241         SET ELMSTR-AIX02-INDEX TO +1
  1242         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX02-FLAG-BYTE
  1243         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX02-POINTER-LENGTH
  1244         MOVE AIX02-KEY-LENGTH    TO ELMSTR-AIX02-ALT-KEY-LENGTH
  1245         MOVE SOR-AIX-KEY3        TO ELMSTR-AIX02-KEY
  1246                                     WS-LAST-AIX-KEY2.
  1247
  1248     IF WS-LAST-AIX-KEY2 NOT = SOR-AIX-KEY3
  1249         PERFORM 4000-WRITE-AIX
  1250         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX02-FLAG-BYTE
  1251         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX02-POINTER-LENGTH
  1252         MOVE AIX02-KEY-LENGTH    TO ELMSTR-AIX02-ALT-KEY-LENGTH
  1253         MOVE SOR-AIX-KEY3        TO ELMSTR-AIX02-KEY
  1254                                     WS-LAST-AIX-KEY2.
  1255
  1256     ADD +1  TO  WS-AIX02-RECORDS-INPUT.
  1257
  1258     IF ELMSTR-AIX02-INDEX NOT GREATER ELMSTR-AIX02-MAX
  1259         MOVE SOR-PRIME-KEY3      TO ELMSTR-AIX02-PRIME-KEY (ELMSTR-AIX02-INDEX)
  1260         SET ELMSTR-AIX02-INDEX UP BY +1
  1261       ELSE
  1262         ADD +1  TO  WS-OVERFLOW-COUNT.
  1263
  1264     GO TO 3100-SOP.
  1265
  1266                                                                  EL336
  1268 3530-SOP-ELMSTR3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL336.cbl
*                        COPY ELC336P1 REPLACING                        EL336
* 1269     AIX02-INDEX                 BY  ELMSTR-AIX03-INDEX           EL336
* 1270     AIX02-FLAG-BYTE             BY  ELMSTR-AIX03-FLAG-BYTE       EL336
* 1271     AIX02-POINTER-LENGTH        BY  ELMSTR-AIX03-POINTER-LENGTH  EL336
* 1272     AIX02-ALT-KEY-LENGTH        BY  ELMSTR-AIX03-ALT-KEY-LENGTH  EL336
* 1273     AIX02-KEY                   BY  ELMSTR-AIX03-KEY             EL336
* 1274     AIX02-PRIME-KEY             BY  ELMSTR-AIX03-PRIME-KEY       EL336
* 1275     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1276     WS-AIX02-KEY-LENGTH         BY  AIX03-KEY-LENGTH             EL336
* 1277     WS-AIX02-RECORDS-INPUT      BY  WS-AIX03-RECORDS-INPUT       EL336
* 1278     WS-AIX02-MAX                BY  ELMSTR-AIX03-MAX.            EL336
  1279*****************************************************************
  1280*                                                               *
  1281*                            ELC336P1.                          *
  1282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1283*                            VMOD=2.003                         *
  1284*****************************************************************.
  1285
  1286     IF WS-AIX03-RECORDS-INPUT EQUAL TO ZERO
  1287         PERFORM 5000-OPEN-AIX
  1288         SET ELMSTR-AIX03-INDEX TO +1
  1289         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX03-FLAG-BYTE
  1290         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX03-POINTER-LENGTH
  1291         MOVE AIX03-KEY-LENGTH    TO ELMSTR-AIX03-ALT-KEY-LENGTH
  1292         MOVE SOR-AIX-KEY         TO ELMSTR-AIX03-KEY
  1293                                     WS-LAST-AIX-KEY.
  1294
  1295     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1296         PERFORM 4000-WRITE-AIX
  1297         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX03-FLAG-BYTE
  1298         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX03-POINTER-LENGTH
  1299         MOVE AIX03-KEY-LENGTH    TO ELMSTR-AIX03-ALT-KEY-LENGTH
  1300         MOVE SOR-AIX-KEY         TO ELMSTR-AIX03-KEY
  1301                                     WS-LAST-AIX-KEY.
  1302
  1303     ADD +1  TO  WS-AIX03-RECORDS-INPUT.
  1304
  1305     IF ELMSTR-AIX03-INDEX NOT GREATER ELMSTR-AIX03-MAX
  1306         MOVE SOR-PRIME-KEY       TO ELMSTR-AIX03-PRIME-KEY (ELMSTR-AIX03-INDEX)
  1307         SET ELMSTR-AIX03-INDEX UP BY +1
  1308       ELSE
  1309         ADD +1  TO  WS-OVERFLOW-COUNT.
  1310
  1311     GO TO 3100-SOP.
  1312
  1313                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL336.cbl
  1315 3540-SOP-ELMSTR4.                                                EL336
  1316*    NOTE ******************************************************* EL336
  1317*         *          THERE IS NO ELMSTR AIX 4                   * EL336
  1318*         *******************************************************.EL336
  1319                                                                  EL336
  1320     GO TO 3100-SOP.                                              EL336
  1321                                                                  EL336
  1323 3550-SOP-ELMSTR5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL336.cbl
*                        COPY ELC336P1 REPLACING                        EL336
* 1324     AIX02-INDEX                 BY  ELMSTR-AIX05-INDEX           EL336
* 1325     AIX02-FLAG-BYTE             BY  ELMSTR-AIX05-FLAG-BYTE       EL336
* 1326     AIX02-POINTER-LENGTH        BY  ELMSTR-AIX05-POINTER-LENGTH  EL336
* 1327     AIX02-ALT-KEY-LENGTH        BY  ELMSTR-AIX05-ALT-KEY-LENGTH  EL336
* 1328     AIX02-KEY                   BY  ELMSTR-AIX05-KEY             EL336
* 1329     AIX02-PRIME-KEY             BY  ELMSTR-AIX05-PRIME-KEY       EL336
* 1330     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1331     WS-AIX02-KEY-LENGTH         BY  AIX05-KEY-LENGTH             EL336
* 1332     WS-AIX02-RECORDS-INPUT      BY  WS-AIX05-RECORDS-INPUT       EL336
* 1333     WS-AIX02-MAX                BY  ELMSTR-AIX05-MAX.            EL336
  1334*****************************************************************
  1335*                                                               *
  1336*                            ELC336P1.                          *
  1337*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1338*                            VMOD=2.003                         *
  1339*****************************************************************.
  1340
  1341     IF WS-AIX05-RECORDS-INPUT EQUAL TO ZERO
  1342         PERFORM 5000-OPEN-AIX
  1343         SET ELMSTR-AIX05-INDEX TO +1
  1344         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX05-FLAG-BYTE
  1345         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX05-POINTER-LENGTH
  1346         MOVE AIX05-KEY-LENGTH    TO ELMSTR-AIX05-ALT-KEY-LENGTH
  1347         MOVE SOR-AIX-KEY         TO ELMSTR-AIX05-KEY
  1348                                     WS-LAST-AIX-KEY.
  1349
  1350     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1351         PERFORM 4000-WRITE-AIX
  1352         MOVE WS-FLAG-BYTE        TO ELMSTR-AIX05-FLAG-BYTE
  1353         MOVE BASE-KEY-LENGTH     TO ELMSTR-AIX05-POINTER-LENGTH
  1354         MOVE AIX05-KEY-LENGTH    TO ELMSTR-AIX05-ALT-KEY-LENGTH
  1355         MOVE SOR-AIX-KEY         TO ELMSTR-AIX05-KEY
  1356                                     WS-LAST-AIX-KEY.
  1357
  1358     ADD +1  TO  WS-AIX05-RECORDS-INPUT.
  1359
  1360     IF ELMSTR-AIX05-INDEX NOT GREATER ELMSTR-AIX05-MAX
  1361         MOVE SOR-PRIME-KEY       TO ELMSTR-AIX05-PRIME-KEY (ELMSTR-AIX05-INDEX)
  1362         SET ELMSTR-AIX05-INDEX UP BY +1
  1363       ELSE
  1364         ADD +1  TO  WS-OVERFLOW-COUNT.
  1365
  1366     GO TO 3100-SOP.
  1367
  1368                                                                  EL336
  1370 3600-SOP-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL336.cbl
*                       COPY ELC336P1 REPLACING                         EL336
* 1371     AIX02-INDEX                 BY  ERACCT-AIX02-INDEX           EL336
* 1372     AIX02-FLAG-BYTE             BY  ERACCT-AIX02-FLAG-BYTE       EL336
* 1373     AIX02-POINTER-LENGTH        BY  ERACCT-AIX02-POINTER-LENGTH  EL336
* 1374     AIX02-ALT-KEY-LENGTH        BY  ERACCT-AIX02-ALT-KEY-LENGTH  EL336
* 1375     AIX02-KEY                   BY  ERACCT-AIX02-KEY             EL336
* 1376     AIX02-PRIME-KEY             BY  ERACCT-AIX02-PRIME-KEY       EL336
* 1377     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1378     WS-AIX02-KEY-LENGTH         BY  AIX02-KEY-LENGTH             EL336
* 1379     WS-AIX02-RECORDS-INPUT      BY  WS-AIX02-RECORDS-INPUT       EL336
* 1380     WS-AIX02-MAX                BY  ERACCT-AIX02-MAX.            EL336
  1381*****************************************************************
  1382*                                                               *
  1383*                            ELC336P1.                          *
  1384*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1385*                            VMOD=2.003                         *
  1386*****************************************************************.
  1387
  1388     IF WS-AIX02-RECORDS-INPUT EQUAL TO ZERO
  1389         PERFORM 5000-OPEN-AIX
  1390         SET ERACCT-AIX02-INDEX TO +1
  1391         MOVE WS-FLAG-BYTE        TO ERACCT-AIX02-FLAG-BYTE
  1392         MOVE BASE-KEY-LENGTH     TO ERACCT-AIX02-POINTER-LENGTH
  1393         MOVE AIX02-KEY-LENGTH    TO ERACCT-AIX02-ALT-KEY-LENGTH
  1394         MOVE SOR-AIX-KEY         TO ERACCT-AIX02-KEY
  1395                                     WS-LAST-AIX-KEY.
  1396
  1397     IF WS-LAST-AIX-KEY NOT = SOR-AIX-KEY
  1398         PERFORM 4000-WRITE-AIX
  1399         MOVE WS-FLAG-BYTE        TO ERACCT-AIX02-FLAG-BYTE
  1400         MOVE BASE-KEY-LENGTH     TO ERACCT-AIX02-POINTER-LENGTH
  1401         MOVE AIX02-KEY-LENGTH    TO ERACCT-AIX02-ALT-KEY-LENGTH
  1402         MOVE SOR-AIX-KEY         TO ERACCT-AIX02-KEY
  1403                                     WS-LAST-AIX-KEY.
  1404
  1405     ADD +1  TO  WS-AIX02-RECORDS-INPUT.
  1406
  1407     IF ERACCT-AIX02-INDEX NOT GREATER ERACCT-AIX02-MAX
  1408         MOVE SOR-PRIME-KEY       TO ERACCT-AIX02-PRIME-KEY (ERACCT-AIX02-INDEX)
  1409         SET ERACCT-AIX02-INDEX UP BY +1
  1410       ELSE
  1411         ADD +1  TO  WS-OVERFLOW-COUNT.
  1412
  1413     GO TO 3100-SOP.
  1414
  1415                                                                  EL336
  1417 3700-SOP-ERPNDB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL336.cbl
*                       COPY ELC336P1 REPLACING                         EL336
* 1418     AIX02-INDEX                 BY  ERPNDB-AIX02-INDEX           EL336
* 1419     AIX02-FLAG-BYTE             BY  ERPNDB-AIX02-FLAG-BYTE       EL336
* 1420     AIX02-POINTER-LENGTH        BY  ERPNDB-AIX02-POINTER-LENGTH  EL336
* 1421     AIX02-ALT-KEY-LENGTH        BY  ERPNDB-AIX02-ALT-KEY-LENGTH  EL336
* 1422     AIX02-KEY                   BY  ERPNDB-AIX02-KEY             EL336
* 1423     AIX02-PRIME-KEY             BY  ERPNDB-AIX02-PRIME-KEY       EL336
* 1424     WS-POINTER-LENGTH           BY  BASE-KEY-LENGTH              EL336
* 1425     WS-AIX02-KEY-LENGTH         BY  AIX02-KEY-LENGTH             EL336
* 1426     WS-AIX02-RECORDS-INPUT      BY  WS-AIX02-RECORDS-INPUT       EL336
* 1427     WS-AIX02-MAX                BY  ERPNDB-AIX02-MAX             EL336
* 1428     SOR-AIX-KEY                 BY  SOR-AIX-KEY2                 EL336
* 1429     SOR-PRIME-KEY               BY  SOR-PRIME-KEY2               EL336
* 1430     WS-LAST-AIX-KEY             BY  WS-LAST-AIX-KEY2.            EL336
  1431*****************************************************************
  1432*                                                               *
  1433*                            ELC336P1.                          *
  1434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1435*                            VMOD=2.003                         *
  1436*****************************************************************.
  1437
  1438     IF WS-AIX02-RECORDS-INPUT EQUAL TO ZERO
  1439         PERFORM 5000-OPEN-AIX
  1440         SET ERPNDB-AIX02-INDEX TO +1
  1441         MOVE WS-FLAG-BYTE        TO ERPNDB-AIX02-FLAG-BYTE
  1442         MOVE BASE-KEY-LENGTH     TO ERPNDB-AIX02-POINTER-LENGTH
  1443         MOVE AIX02-KEY-LENGTH    TO ERPNDB-AIX02-ALT-KEY-LENGTH
  1444         MOVE SOR-AIX-KEY2        TO ERPNDB-AIX02-KEY
  1445                                     WS-LAST-AIX-KEY2.
  1446
  1447     IF WS-LAST-AIX-KEY2 NOT = SOR-AIX-KEY2
  1448         PERFORM 4000-WRITE-AIX
  1449         MOVE WS-FLAG-BYTE        TO ERPNDB-AIX02-FLAG-BYTE
  1450         MOVE BASE-KEY-LENGTH     TO ERPNDB-AIX02-POINTER-LENGTH
  1451         MOVE AIX02-KEY-LENGTH    TO ERPNDB-AIX02-ALT-KEY-LENGTH
  1452         MOVE SOR-AIX-KEY2        TO ERPNDB-AIX02-KEY
  1453                                     WS-LAST-AIX-KEY2.
  1454
  1455     ADD +1  TO  WS-AIX02-RECORDS-INPUT.
  1456
  1457     IF ERPNDB-AIX02-INDEX NOT GREATER ERPNDB-AIX02-MAX
  1458         MOVE SOR-PRIME-KEY2      TO ERPNDB-AIX02-PRIME-KEY (ERPNDB-AIX02-INDEX)
  1459         SET ERPNDB-AIX02-INDEX UP BY +1
  1460       ELSE
  1461         ADD +1  TO  WS-OVERFLOW-COUNT.
  1462
  1463     GO TO 3100-SOP.
  1464
  1465                                                                  EL336
  1466 3900-EXIT.                                                       EL336
  1467     EXIT.                                                        EL336
  1468                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL336.cbl
  1470 4000-WRITE-AIX SECTION.                                          EL336
  1471                                                                  EL336
  1472     IF WS-OVERFLOW-COUNT NOT GREATER THAN ZERO                   EL336
  1473         GO TO 4100-WRITE-AIX.                                    EL336
  1474                                                                  EL336
  1475     MOVE '0'                    TO  WS-DETAIL-LINE1.             EL336
  1476                                                                  EL336
  1477     IF PROCESSING-ERPNDB-FILE                                    EL336
  1478         MOVE WS-LAST-AIX-KEY2   TO  WS-D3-AIX-KEY                EL336
  1479                                     WS-COMPANY-CD                EL336
  1480       ELSE                                                       EL336
  1481         MOVE WS-LAST-AIX-KEY    TO  WS-D3-AIX-KEY                EL336
  1482                                     WS-COMPANY-CD.               EL336
  1483                                                                  EL336
  1484     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-D3-AIX.              EL336
  1485     MOVE WS-COMPANY-NUMBER      TO  WS-D3-COMPANY.               EL336
  1486     MOVE 'AIX KEY OVERFLOW'     TO  WS-D3-MESSAGE.               EL336
  1487     MOVE WS-OVERFLOW-COUNT      TO  WS-D3-COUNT.                 EL336
  1488     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
  1489     PERFORM WRITE-PRINTER.                                       EL336
  1490                                                                  EL336
  1491     MOVE SPACES                 TO  WS-DETAIL-LINE1.             EL336
  1492                                                                  EL336
  1493     SET CHAR-INDEX TO +1.                                        EL336
  1494     MOVE SPACES                 TO  WS-DIGET-CHARACTERS.         EL336
  1495                                                                  EL336
  1496 4020-WRITE-AIX.                                                  EL336
  1497     MOVE WS-KEY-CHAR (CHAR-INDEX) TO WS-CHAR.                    EL336
  1498                                                                  EL336
  1499     IF WS-NUMBER = ZERO                                          EL336
  1500         MOVE ZERO               TO  WS-D3-CHAR (CHAR-INDEX)      EL336
  1501                                     WS-DIGET (CHAR-INDEX)        EL336
  1502         GO TO 4030-WRITE-AIX.                                    EL336
  1503                                                                  EL336
  1504     DIVIDE WS-NUMBER BY +16 GIVING WS-NUMBER                     EL336
  1505         REMAINDER WS-REMAINDER.                                  EL336
  1506                                                                  EL336
  1507     IF WS-NUMBER NOT = ZERO                                      EL336
  1508         MOVE WS-HEX-CHAR (WS-NUMBER) TO  WS-D3-CHAR (CHAR-INDEX) EL336
  1509       ELSE                                                       EL336
  1510         MOVE ZERO               TO  WS-D3-CHAR (CHAR-INDEX).     EL336
  1511                                                                  EL336
  1512     IF WS-REMAINDER NOT = ZERO                                   EL336
  1513         MOVE WS-HEX-CHAR (WS-REMAINDER) TO  WS-DIGET (CHAR-INDEX)EL336
  1514       ELSE                                                       EL336
  1515         MOVE ZERO               TO  WS-DIGET (CHAR-INDEX).       EL336
  1516                                                                  EL336
  1517 4030-WRITE-AIX.                                                  EL336
  1518     IF CHAR-INDEX LESS THAN WS-AIX-KEY-LENGTH                    EL336
  1519                                  (WS-DATASET, WS-LAST-AIX-NUMBER)EL336
  1520         SET CHAR-INDEX UP BY +1                                  EL336
  1521         GO TO 4020-WRITE-AIX.                                    EL336
  1522                                                                  EL336
  1523     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
  1524     PERFORM WRITE-PRINTER.                                       EL336
  1525                                                                  EL336
  1526     MOVE WS-DIGET-CHARACTERS    TO  WS-D3-AIX-KEY.               EL336
  1527                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL336.cbl
  1528     MOVE WS-DETAIL-LINE1        TO  PRT.                         EL336
  1529     PERFORM WRITE-PRINTER.                                       EL336
  1530                                                                  EL336
  1531     MOVE ZERO                   TO  WS-OVERFLOW-COUNT.           EL336
  1532                                                                  EL336
  1533 4100-WRITE-AIX.                                                  EL336
  1534     ADD +1 TO WS-RECORDS-OUTPUT.                                 EL336
  1535                                                                  EL336
  1536     GO TO 4300-WRITE-ELARCH                                      EL336
  1537           4400-WRITE-ELCERT                                      EL336
  1538           4500-WRITE-ELMSTR                                      EL336
  1539           4600-WRITE-ERACCT                                      EL336
  1540           4700-WRITE-ERPNDB DEPENDING ON WS-DATASET.             EL336
  1541                                                                  EL336
  1543 4300-WRITE-ELARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL336.cbl
*                         COPY ELC336P2 REPLACING                       EL336
* 1544     AIX02-INDEX                 BY  ELARCH-AIX02-INDEX           EL336
* 1545     AIX02-NUMBER-OF-KEYS        BY  ELARCH-AIX02-NUMBER-OF-KEYS  EL336
* 1546     AIX02-RECORD                BY  ELARCH-AIX02-RECORD          EL336
* 1547     AIX02-FILE-STATUS           BY  ELARCH-AIX02-FILE-STATUS     EL336
* 1548     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX02-RECORDS-OUTPUT.     EL336
  1549*****************************************************************
  1550*                                                               *
  1551*                            ELC336P2.                          *
  1552*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1553*                            VMOD=2.003                         *
  1554*                                                               *
  1555*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1556*                                                               *
  1557*****************************************************************.
  1558
  1559     SET ELARCH-AIX02-INDEX DOWN BY +1.
  1560     SET ELARCH-AIX02-NUMBER-OF-KEYS TO ELARCH-AIX02-INDEX.
  1561
  1562     IF ELARCH-AIX02-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1563         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1564       ELSE
  1565         SET CI1 TO +1
  1566         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1567             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1568                    IS EQUAL TO ELARCH-AIX02-NUMBER-OF-KEYS
  1569                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1570             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1571                 MOVE ELARCH-AIX02-NUMBER-OF-KEYS
  1572                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1573                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1574
  1575     IF ELARCH-AIX02-NUMBER-OF-KEYS GREATER THAN ZERO
  1576         ADD +1  TO  WS-AIX02-RECORDS-OUTPUT
  1577         WRITE ELARCH-AIX02-RECORD
  1578         IF ELARCH-AIX02-FILE-STATUS NOT = ZERO
  1579             MOVE 'WRITE'            TO WS-EM-OPERATION
  1580             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1581             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1582             MOVE ELARCH-AIX02-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1583             PERFORM ABEND-PGM.
  1584
  1585     SET ELARCH-AIX02-INDEX TO +1
  1586
  1587     GO TO 4900-EXIT.
  1588
  1589                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL336.cbl
  1591 4400-WRITE-ELCERT.                                               EL336
  1592     GO TO 4420-WRITE-ELCERT2                                     EL336
  1593           4430-WRITE-ELCERT3                                     EL336
  1594           4440-WRITE-ELCERT4                                     EL336
  1595           4450-WRITE-ELCERT5                                     EL336
  1596           4460-WRITE-ELCERT6 DEPENDING ON WS-LAST-AIX-NUMBER.    EL336
  1597                                                                  EL336
  1599 4420-WRITE-ELCERT2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1600     AIX02-INDEX                 BY  ELCERT-AIX02-INDEX           EL336
* 1601     AIX02-NUMBER-OF-KEYS        BY  ELCERT-AIX02-NUMBER-OF-KEYS  EL336
* 1602     AIX02-RECORD                BY  ELCERT-AIX02-RECORD          EL336
* 1603     AIX02-FILE-STATUS           BY  ELCERT-AIX02-FILE-STATUS     EL336
* 1604     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX02-RECORDS-OUTPUT.     EL336
  1605*****************************************************************
  1606*                                                               *
  1607*                            ELC336P2.                          *
  1608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1609*                            VMOD=2.003                         *
  1610*                                                               *
  1611*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1612*                                                               *
  1613*****************************************************************.
  1614
  1615     SET ELCERT-AIX02-INDEX DOWN BY +1.
  1616     SET ELCERT-AIX02-NUMBER-OF-KEYS TO ELCERT-AIX02-INDEX.
  1617
  1618     IF ELCERT-AIX02-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1619         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1620       ELSE
  1621         SET CI1 TO +1
  1622         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1623             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1624                    IS EQUAL TO ELCERT-AIX02-NUMBER-OF-KEYS
  1625                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1626             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1627                 MOVE ELCERT-AIX02-NUMBER-OF-KEYS
  1628                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1629                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1630
  1631     IF ELCERT-AIX02-NUMBER-OF-KEYS GREATER THAN ZERO
  1632         ADD +1  TO  WS-AIX02-RECORDS-OUTPUT
  1633         WRITE ELCERT-AIX02-RECORD
  1634         IF ELCERT-AIX02-FILE-STATUS NOT = ZERO
  1635             MOVE 'WRITE'            TO WS-EM-OPERATION
  1636             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1637             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1638             MOVE ELCERT-AIX02-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1639             PERFORM ABEND-PGM.
  1640
  1641     SET ELCERT-AIX02-INDEX TO +1
  1642
  1643     GO TO 4900-EXIT.
  1644
  1645                                                                  EL336
  1647 4430-WRITE-ELCERT3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1648     AIX02-INDEX                 BY  ELCERT-AIX03-INDEX           EL336
* 1649     AIX02-NUMBER-OF-KEYS        BY  ELCERT-AIX03-NUMBER-OF-KEYS  EL336
* 1650     AIX02-RECORD                BY  ELCERT-AIX03-RECORD          EL336
* 1651     AIX02-FILE-STATUS           BY  ELCERT-AIX03-FILE-STATUS     EL336
* 1652     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX03-RECORDS-OUTPUT.     EL336
  1653*****************************************************************
  1654*                                                               *
  1655*                            ELC336P2.                          *
  1656*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1657*                            VMOD=2.003                         *
  1658*                                                               *
  1659*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1660*                                                               *
  1661*****************************************************************.
  1662
  1663     SET ELCERT-AIX03-INDEX DOWN BY +1.
  1664     SET ELCERT-AIX03-NUMBER-OF-KEYS TO ELCERT-AIX03-INDEX.
  1665
  1666     IF ELCERT-AIX03-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1667         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1668       ELSE
  1669         SET CI1 TO +1
  1670         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1671             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1672                    IS EQUAL TO ELCERT-AIX03-NUMBER-OF-KEYS
  1673                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1674             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1675                 MOVE ELCERT-AIX03-NUMBER-OF-KEYS
  1676                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1677                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1678
  1679     IF ELCERT-AIX03-NUMBER-OF-KEYS GREATER THAN ZERO
  1680         ADD +1  TO  WS-AIX03-RECORDS-OUTPUT
  1681         WRITE ELCERT-AIX03-RECORD
  1682         IF ELCERT-AIX03-FILE-STATUS NOT = ZERO
  1683             MOVE 'WRITE'            TO WS-EM-OPERATION
  1684             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1685             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1686             MOVE ELCERT-AIX03-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1687             PERFORM ABEND-PGM.
  1688
  1689     SET ELCERT-AIX03-INDEX TO +1
  1690
  1691     GO TO 4900-EXIT.
  1692
  1693                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL336.cbl
  1695 4440-WRITE-ELCERT4.                                              EL336
  1696     GO TO 4900-EXIT.                                             EL336
  1697                                                                  EL336
  1698 4450-WRITE-ELCERT5.
*                          COPY ELC336P2 REPLACING                      EL336
* 1699     AIX02-INDEX                 BY  ELCERT-AIX05-INDEX           EL336
* 1700     AIX02-NUMBER-OF-KEYS        BY  ELCERT-AIX05-NUMBER-OF-KEYS  EL336
* 1701     AIX02-RECORD                BY  ELCERT-AIX05-RECORD          EL336
* 1702     AIX02-FILE-STATUS           BY  ELCERT-AIX05-FILE-STATUS     EL336
* 1703     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX05-RECORDS-OUTPUT.     EL336
  1704*****************************************************************
  1705*                                                               *
  1706*                            ELC336P2.                          *
  1707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1708*                            VMOD=2.003                         *
  1709*                                                               *
  1710*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1711*                                                               *
  1712*****************************************************************.
  1713
  1714     SET ELCERT-AIX05-INDEX DOWN BY +1.
  1715     SET ELCERT-AIX05-NUMBER-OF-KEYS TO ELCERT-AIX05-INDEX.
  1716
  1717     IF ELCERT-AIX05-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1718         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1719       ELSE
  1720         SET CI1 TO +1
  1721         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1722             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1723                    IS EQUAL TO ELCERT-AIX05-NUMBER-OF-KEYS
  1724                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1725             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1726                 MOVE ELCERT-AIX05-NUMBER-OF-KEYS
  1727                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1728                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1729
  1730     IF ELCERT-AIX05-NUMBER-OF-KEYS GREATER THAN ZERO
  1731         ADD +1  TO  WS-AIX05-RECORDS-OUTPUT
  1732         WRITE ELCERT-AIX05-RECORD
  1733         IF ELCERT-AIX05-FILE-STATUS NOT = ZERO
  1734             MOVE 'WRITE'            TO WS-EM-OPERATION
  1735             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1736             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1737             MOVE ELCERT-AIX05-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1738             PERFORM ABEND-PGM.
  1739
  1740     SET ELCERT-AIX05-INDEX TO +1
  1741
  1742     GO TO 4900-EXIT.
  1743
  1744                                                                  EL336
  1746 4460-WRITE-ELCERT6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1747     AIX02-INDEX                 BY  ELCERT-AIX06-INDEX           EL336
* 1748     AIX02-NUMBER-OF-KEYS        BY  ELCERT-AIX06-NUMBER-OF-KEYS  EL336
* 1749     AIX02-RECORD                BY  ELCERT-AIX06-RECORD          EL336
* 1750     AIX02-FILE-STATUS           BY  ELCERT-AIX06-FILE-STATUS     EL336
* 1751     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX06-RECORDS-OUTPUT.     EL336
  1752*****************************************************************
  1753*                                                               *
  1754*                            ELC336P2.                          *
  1755*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1756*                            VMOD=2.003                         *
  1757*                                                               *
  1758*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1759*                                                               *
  1760*****************************************************************.
  1761
  1762     SET ELCERT-AIX06-INDEX DOWN BY +1.
  1763     SET ELCERT-AIX06-NUMBER-OF-KEYS TO ELCERT-AIX06-INDEX.
  1764
  1765     IF ELCERT-AIX06-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1766         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1767       ELSE
  1768         SET CI1 TO +1
  1769         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1770             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1771                    IS EQUAL TO ELCERT-AIX06-NUMBER-OF-KEYS
  1772                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1773             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1774                 MOVE ELCERT-AIX06-NUMBER-OF-KEYS
  1775                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1776                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1777
  1778     IF ELCERT-AIX06-NUMBER-OF-KEYS GREATER THAN ZERO
  1779         ADD +1  TO  WS-AIX06-RECORDS-OUTPUT
  1780         WRITE ELCERT-AIX06-RECORD
  1781         IF ELCERT-AIX06-FILE-STATUS NOT = ZERO
  1782             MOVE 'WRITE'            TO WS-EM-OPERATION
  1783             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1784             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1785             MOVE ELCERT-AIX06-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1786             PERFORM ABEND-PGM.
  1787
  1788     SET ELCERT-AIX06-INDEX TO +1
  1789
  1790     GO TO 4900-EXIT.
  1791
  1792                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL336.cbl
  1794 4500-WRITE-ELMSTR.                                               EL336
  1795     GO TO 4520-WRITE-ELMSTR2                                     EL336
  1796           4530-WRITE-ELMSTR3                                     EL336
  1797           4540-WRITE-ELMSTR4                                     EL336
  1798           4550-WRITE-ELMSTR5 DEPENDING ON WS-LAST-AIX-NUMBER.    EL336
  1799                                                                  EL336
  1801 4520-WRITE-ELMSTR2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1802     AIX02-INDEX                 BY  ELMSTR-AIX02-INDEX           EL336
* 1803     AIX02-NUMBER-OF-KEYS        BY  ELMSTR-AIX02-NUMBER-OF-KEYS  EL336
* 1804     AIX02-RECORD                BY  ELMSTR-AIX02-RECORD          EL336
* 1805     AIX02-FILE-STATUS           BY  ELMSTR-AIX02-FILE-STATUS     EL336
* 1806     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX02-RECORDS-OUTPUT.     EL336
  1807*****************************************************************
  1808*                                                               *
  1809*                            ELC336P2.                          *
  1810*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1811*                            VMOD=2.003                         *
  1812*                                                               *
  1813*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1814*                                                               *
  1815*****************************************************************.
  1816
  1817     SET ELMSTR-AIX02-INDEX DOWN BY +1.
  1818     SET ELMSTR-AIX02-NUMBER-OF-KEYS TO ELMSTR-AIX02-INDEX.
  1819
  1820     IF ELMSTR-AIX02-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1821         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1822       ELSE
  1823         SET CI1 TO +1
  1824         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1825             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1826                    IS EQUAL TO ELMSTR-AIX02-NUMBER-OF-KEYS
  1827                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1828             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1829                 MOVE ELMSTR-AIX02-NUMBER-OF-KEYS
  1830                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1831                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1832
  1833     IF ELMSTR-AIX02-NUMBER-OF-KEYS GREATER THAN ZERO
  1834         ADD +1  TO  WS-AIX02-RECORDS-OUTPUT
  1835         WRITE ELMSTR-AIX02-RECORD
  1836         IF ELMSTR-AIX02-FILE-STATUS NOT = ZERO
  1837             MOVE 'WRITE'            TO WS-EM-OPERATION
  1838             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1839             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1840             MOVE ELMSTR-AIX02-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1841             PERFORM ABEND-PGM.
  1842
  1843     SET ELMSTR-AIX02-INDEX TO +1
  1844
  1845     GO TO 4900-EXIT.
  1846
  1847                                                                  EL336
  1849 4530-WRITE-ELMSTR3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1850     AIX02-INDEX                 BY  ELMSTR-AIX03-INDEX           EL336
* 1851     AIX02-NUMBER-OF-KEYS        BY  ELMSTR-AIX03-NUMBER-OF-KEYS  EL336
* 1852     AIX02-RECORD                BY  ELMSTR-AIX03-RECORD          EL336
* 1853     AIX02-FILE-STATUS           BY  ELMSTR-AIX03-FILE-STATUS     EL336
* 1854     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX03-RECORDS-OUTPUT.     EL336
  1855*****************************************************************
  1856*                                                               *
  1857*                            ELC336P2.                          *
  1858*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1859*                            VMOD=2.003                         *
  1860*                                                               *
  1861*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1862*                                                               *
  1863*****************************************************************.
  1864
  1865     SET ELMSTR-AIX03-INDEX DOWN BY +1.
  1866     SET ELMSTR-AIX03-NUMBER-OF-KEYS TO ELMSTR-AIX03-INDEX.
  1867
  1868     IF ELMSTR-AIX03-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1869         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1870       ELSE
  1871         SET CI1 TO +1
  1872         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1873             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1874                    IS EQUAL TO ELMSTR-AIX03-NUMBER-OF-KEYS
  1875                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1876             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1877                 MOVE ELMSTR-AIX03-NUMBER-OF-KEYS
  1878                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1879                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1880
  1881     IF ELMSTR-AIX03-NUMBER-OF-KEYS GREATER THAN ZERO
  1882         ADD +1  TO  WS-AIX03-RECORDS-OUTPUT
  1883         WRITE ELMSTR-AIX03-RECORD
  1884         IF ELMSTR-AIX03-FILE-STATUS NOT = ZERO
  1885             MOVE 'WRITE'            TO WS-EM-OPERATION
  1886             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1887             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1888             MOVE ELMSTR-AIX03-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1889             PERFORM ABEND-PGM.
  1890
  1891     SET ELMSTR-AIX03-INDEX TO +1
  1892
  1893     GO TO 4900-EXIT.
  1894
  1895                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL336.cbl
  1897 4540-WRITE-ELMSTR4.                                              EL336
  1898*    NOTE ******************************************************* EL336
  1899*         *        THERE IS NO CLAIM MASTER AIX FOUR            * EL336
  1900*         *******************************************************.EL336
  1901                                                                  EL336
  1902     GO TO 4900-EXIT.                                             EL336
  1903                                                                  EL336
  1905 4550-WRITE-ELMSTR5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL336.cbl
*                          COPY ELC336P2 REPLACING                      EL336
* 1906     AIX02-INDEX                 BY  ELMSTR-AIX05-INDEX           EL336
* 1907     AIX02-NUMBER-OF-KEYS        BY  ELMSTR-AIX05-NUMBER-OF-KEYS  EL336
* 1908     AIX02-RECORD                BY  ELMSTR-AIX05-RECORD          EL336
* 1909     AIX02-FILE-STATUS           BY  ELMSTR-AIX05-FILE-STATUS     EL336
* 1910     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX05-RECORDS-OUTPUT.     EL336
  1911*****************************************************************
  1912*                                                               *
  1913*                            ELC336P2.                          *
  1914*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1915*                            VMOD=2.003                         *
  1916*                                                               *
  1917*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1918*                                                               *
  1919*****************************************************************.
  1920
  1921     SET ELMSTR-AIX05-INDEX DOWN BY +1.
  1922     SET ELMSTR-AIX05-NUMBER-OF-KEYS TO ELMSTR-AIX05-INDEX.
  1923
  1924     IF ELMSTR-AIX05-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1925         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1926       ELSE
  1927         SET CI1 TO +1
  1928         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1929             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1930                    IS EQUAL TO ELMSTR-AIX05-NUMBER-OF-KEYS
  1931                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1932             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1933                 MOVE ELMSTR-AIX05-NUMBER-OF-KEYS
  1934                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1935                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1936
  1937     IF ELMSTR-AIX05-NUMBER-OF-KEYS GREATER THAN ZERO
  1938         ADD +1  TO  WS-AIX05-RECORDS-OUTPUT
  1939         WRITE ELMSTR-AIX05-RECORD
  1940         IF ELMSTR-AIX05-FILE-STATUS NOT = ZERO
  1941             MOVE 'WRITE'            TO WS-EM-OPERATION
  1942             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1943             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1944             MOVE ELMSTR-AIX05-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1945             PERFORM ABEND-PGM.
  1946
  1947     SET ELMSTR-AIX05-INDEX TO +1
  1948
  1949     GO TO 4900-EXIT.
  1950
  1951                                                                  EL336
  1953 4600-WRITE-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL336.cbl
*                         COPY ELC336P2 REPLACING                       EL336
* 1954     AIX02-INDEX                 BY  ERACCT-AIX02-INDEX           EL336
* 1955     AIX02-NUMBER-OF-KEYS        BY  ERACCT-AIX02-NUMBER-OF-KEYS  EL336
* 1956     AIX02-RECORD                BY  ERACCT-AIX02-RECORD          EL336
* 1957     AIX02-FILE-STATUS           BY  ERACCT-AIX02-FILE-STATUS     EL336
* 1958     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX02-RECORDS-OUTPUT.     EL336
  1959*****************************************************************
  1960*                                                               *
  1961*                            ELC336P2.                          *
  1962*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1963*                            VMOD=2.003                         *
  1964*                                                               *
  1965*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  1966*                                                               *
  1967*****************************************************************.
  1968
  1969     SET ERACCT-AIX02-INDEX DOWN BY +1.
  1970     SET ERACCT-AIX02-NUMBER-OF-KEYS TO ERACCT-AIX02-INDEX.
  1971
  1972     IF ERACCT-AIX02-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  1973         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1974       ELSE
  1975         SET CI1 TO +1
  1976         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  1977             WHEN WS-AIX-COUNT-OCCURS (CI1)
  1978                    IS EQUAL TO ERACCT-AIX02-NUMBER-OF-KEYS
  1979                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  1980             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  1981                 MOVE ERACCT-AIX02-NUMBER-OF-KEYS
  1982                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  1983                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  1984
  1985     IF ERACCT-AIX02-NUMBER-OF-KEYS GREATER THAN ZERO
  1986         ADD +1  TO  WS-AIX02-RECORDS-OUTPUT
  1987         WRITE ERACCT-AIX02-RECORD
  1988         IF ERACCT-AIX02-FILE-STATUS NOT = ZERO
  1989             MOVE 'WRITE'            TO WS-EM-OPERATION
  1990             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  1991             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  1992             MOVE ERACCT-AIX02-FILE-STATUS TO WS-ABEND-FILE-STATUS
  1993             PERFORM ABEND-PGM.
  1994
  1995     SET ERACCT-AIX02-INDEX TO +1
  1996
  1997     GO TO 4900-EXIT.
  1998
  1999                                                                  EL336
  2001 4700-WRITE-ERPNDB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL336.cbl
*                         COPY ELC336P2 REPLACING                       EL336
* 2002     AIX02-INDEX                 BY  ERPNDB-AIX02-INDEX           EL336
* 2003     AIX02-NUMBER-OF-KEYS        BY  ERPNDB-AIX02-NUMBER-OF-KEYS  EL336
* 2004     AIX02-RECORD                BY  ERPNDB-AIX02-RECORD          EL336
* 2005     AIX02-FILE-STATUS           BY  ERPNDB-AIX02-FILE-STATUS     EL336
* 2006     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX02-RECORDS-OUTPUT.     EL336
  2007*****************************************************************
  2008*                                                               *
  2009*                            ELC336P2.                          *
  2010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2011*                            VMOD=2.003                         *
  2012*                                                               *
  2013*  THE FOLLOWING WRITES THE ALTERNATE INDEX RECORDS.            *
  2014*                                                               *
  2015*****************************************************************.
  2016
  2017     SET ERPNDB-AIX02-INDEX DOWN BY +1.
  2018     SET ERPNDB-AIX02-NUMBER-OF-KEYS TO ERPNDB-AIX02-INDEX.
  2019
  2020     IF ERPNDB-AIX02-NUMBER-OF-KEYS IS EQUAL TO WS-AIX-COUNT-OCCURS (CI1)
  2021         ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  2022       ELSE
  2023         SET CI1 TO +1
  2024         SEARCH WS-AIX-COUNT-ARRAY VARYING CI1
  2025             WHEN WS-AIX-COUNT-OCCURS (CI1)
  2026                    IS EQUAL TO ERPNDB-AIX02-NUMBER-OF-KEYS
  2027                 ADD +1  TO  WS-AIX-COUNT-FREQ (CI1)
  2028             WHEN WS-AIX-COUNT-OCCURS (CI1) EQUAL TO ZERO
  2029                 MOVE ERPNDB-AIX02-NUMBER-OF-KEYS
  2030                                 TO  WS-AIX-COUNT-OCCURS (CI1)
  2031                 MOVE +1  TO  WS-AIX-COUNT-FREQ (CI1).
  2032
  2033     IF ERPNDB-AIX02-NUMBER-OF-KEYS GREATER THAN ZERO
  2034         ADD +1  TO  WS-AIX02-RECORDS-OUTPUT
  2035         WRITE ERPNDB-AIX02-RECORD
  2036         IF ERPNDB-AIX02-FILE-STATUS NOT = ZERO
  2037             MOVE 'WRITE'            TO WS-EM-OPERATION
  2038             ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2039             MOVE WS-ERROR-MESSAGE   TO WS-ABEND-MESSAGE
  2040             MOVE ERPNDB-AIX02-FILE-STATUS TO WS-ABEND-FILE-STATUS
  2041             PERFORM ABEND-PGM.
  2042
  2043     SET ERPNDB-AIX02-INDEX TO +1
  2044
  2045     GO TO 4900-EXIT.
  2046
  2047                                                                  EL336
  2048 4900-EXIT.                                                       EL336
  2049     EXIT.                                                        EL336
  2050                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL336.cbl
  2052 5000-OPEN-AIX SECTION.                                           EL336
  2053                                                                  EL336
  2054     GO TO 5300-OPEN-ELARCH                                       EL336
  2055           5400-OPEN-ELCERT                                       EL336
  2056           5500-OPEN-ELMSTR                                       EL336
  2057           5600-OPEN-ERACCT                                       EL336
  2058           5700-OPEN-ERPNDB DEPENDING ON WS-DATASET.              EL336
  2059                                                                  EL336
  2060 5300-OPEN-ELARCH.
*                        COPY ELC336P3 REPLACING                        EL336
* 2061     CERTIFICATE-MASTER-AIX02    BY  ELARCH-AIX02                 EL336
* 2062     AIX02-FILE-STATUS           BY  ELARCH-AIX02-FILE-STATUS.    EL336
  2063*****************************************************************
  2064*                                                               *
  2065*                            ELC336P3.                          *
  2066*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2067*                            VMOD=2.002                         *
  2068*****************************************************************.
  2069
  2070     OPEN OUTPUT ELARCH-AIX02.
  2071
  2072     IF ELARCH-AIX02-FILE-STATUS NOT = ZERO
  2073         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2074         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2075         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2076         MOVE ELARCH-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2077         PERFORM ABEND-PGM.
  2078
  2079     GO TO 5900-EXIT.
  2080
  2081                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL336.cbl
  2083 5400-OPEN-ELCERT.                                                EL336
  2084     GO TO 5420-OPEN-ELCERT2                                      EL336
  2085           5430-OPEN-ELCERT3                                      EL336
  2086           5440-OPEN-ELCERT4                                      EL336
  2087           5450-OPEN-ELCERT5                                      EL336
  2088           5460-OPEN-ELCERT6 DEPENDING ON WS-LAST-AIX-NUMBER.     EL336
  2089                                                                  EL336
  2090 5420-OPEN-ELCERT2.
*                         COPY ELC336P3 REPLACING                       EL336
* 2091     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX02                 EL336
* 2092     AIX02-FILE-STATUS           BY  ELCERT-AIX02-FILE-STATUS.    EL336
  2093*****************************************************************
  2094*                                                               *
  2095*                            ELC336P3.                          *
  2096*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2097*                            VMOD=2.002                         *
  2098*****************************************************************.
  2099
  2100     OPEN OUTPUT ELCERT-AIX02.
  2101
  2102     IF ELCERT-AIX02-FILE-STATUS NOT = ZERO
  2103         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2104         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2105         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2106         MOVE ELCERT-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2107         PERFORM ABEND-PGM.
  2108
  2109     GO TO 5900-EXIT.
  2110
  2111                                                                  EL336
  2112 5430-OPEN-ELCERT3.
*                         COPY ELC336P3 REPLACING                       EL336
* 2113     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX03                 EL336
* 2114     AIX02-FILE-STATUS           BY  ELCERT-AIX03-FILE-STATUS.    EL336
  2115*****************************************************************
  2116*                                                               *
  2117*                            ELC336P3.                          *
  2118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2119*                            VMOD=2.002                         *
  2120*****************************************************************.
  2121
  2122     OPEN OUTPUT ELCERT-AIX03.
  2123
  2124     IF ELCERT-AIX03-FILE-STATUS NOT = ZERO
  2125         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2126         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2127         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2128         MOVE ELCERT-AIX03-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2129         PERFORM ABEND-PGM.
  2130
  2131     GO TO 5900-EXIT.
  2132
  2133                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL336.cbl
  2135 5440-OPEN-ELCERT4.                                               EL336
  2136     GO TO 5900-EXIT.                                             EL336
  2137                                                                  EL336
  2138 5450-OPEN-ELCERT5.
*                         COPY ELC336P3 REPLACING                       EL336
* 2139     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX05                 EL336
* 2140     AIX02-FILE-STATUS           BY  ELCERT-AIX05-FILE-STATUS.    EL336
  2141*****************************************************************
  2142*                                                               *
  2143*                            ELC336P3.                          *
  2144*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2145*                            VMOD=2.002                         *
  2146*****************************************************************.
  2147
  2148     OPEN OUTPUT ELCERT-AIX05.
  2149
  2150     IF ELCERT-AIX05-FILE-STATUS NOT = ZERO
  2151         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2152         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2153         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2154         MOVE ELCERT-AIX05-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2155         PERFORM ABEND-PGM.
  2156
  2157     GO TO 5900-EXIT.
  2158
  2159                                                                  EL336
  2160 5460-OPEN-ELCERT6.
*                         COPY ELC336P3 REPLACING                       EL336
* 2161     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX06                 EL336
* 2162     AIX02-FILE-STATUS           BY  ELCERT-AIX06-FILE-STATUS.    EL336
  2163*****************************************************************
  2164*                                                               *
  2165*                            ELC336P3.                          *
  2166*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2167*                            VMOD=2.002                         *
  2168*****************************************************************.
  2169
  2170     OPEN OUTPUT ELCERT-AIX06.
  2171
  2172     IF ELCERT-AIX06-FILE-STATUS NOT = ZERO
  2173         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2174         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2175         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2176         MOVE ELCERT-AIX06-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2177         PERFORM ABEND-PGM.
  2178
  2179     GO TO 5900-EXIT.
  2180
  2181                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL336.cbl
  2183 5500-OPEN-ELMSTR.                                                EL336
  2184     GO TO 5520-OPEN-ELMSTR2                                      EL336
  2185           5530-OPEN-ELMSTR3                                      EL336
  2186           5540-OPEN-ELMSTR4                                      EL336
  2187           5550-OPEN-ELMSTR5 DEPENDING ON WS-LAST-AIX-NUMBER.     EL336
  2188                                                                  EL336
  2189 5520-OPEN-ELMSTR2.
*                         COPY ELC336P3 REPLACING                       EL336
* 2190     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX02                 EL336
* 2191     AIX02-FILE-STATUS           BY  ELMSTR-AIX02-FILE-STATUS.    EL336
  2192*****************************************************************
  2193*                                                               *
  2194*                            ELC336P3.                          *
  2195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2196*                            VMOD=2.002                         *
  2197*****************************************************************.
  2198
  2199     OPEN OUTPUT ELMSTR-AIX02.
  2200
  2201     IF ELMSTR-AIX02-FILE-STATUS NOT = ZERO
  2202         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2203         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2204         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2205         MOVE ELMSTR-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2206         PERFORM ABEND-PGM.
  2207
  2208     GO TO 5900-EXIT.
  2209
  2210                                                                  EL336
  2211 5530-OPEN-ELMSTR3.
*                         COPY ELC336P3 REPLACING                       EL336
* 2212     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX03                 EL336
* 2213     AIX02-FILE-STATUS           BY  ELMSTR-AIX03-FILE-STATUS.    EL336
  2214*****************************************************************
  2215*                                                               *
  2216*                            ELC336P3.                          *
  2217*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2218*                            VMOD=2.002                         *
  2219*****************************************************************.
  2220
  2221     OPEN OUTPUT ELMSTR-AIX03.
  2222
  2223     IF ELMSTR-AIX03-FILE-STATUS NOT = ZERO
  2224         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2225         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2226         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2227         MOVE ELMSTR-AIX03-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2228         PERFORM ABEND-PGM.
  2229
  2230     GO TO 5900-EXIT.
  2231
  2232                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL336.cbl
  2234 5540-OPEN-ELMSTR4.                                               EL336
  2235*    NOTE ******************************************************* EL336
  2236*         *        THERE IS NO CLAIM MASTER AIX FOUR            * EL336
  2237*         *******************************************************.EL336
  2238                                                                  EL336
  2239     GO TO 5900-EXIT.                                             EL336
  2240                                                                  EL336
  2241 5550-OPEN-ELMSTR5.
*                         COPY ELC336P3 REPLACING                       EL336
* 2242     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX05                 EL336
* 2243     AIX02-FILE-STATUS           BY  ELMSTR-AIX05-FILE-STATUS.    EL336
  2244*****************************************************************
  2245*                                                               *
  2246*                            ELC336P3.                          *
  2247*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2248*                            VMOD=2.002                         *
  2249*****************************************************************.
  2250
  2251     OPEN OUTPUT ELMSTR-AIX05.
  2252
  2253     IF ELMSTR-AIX05-FILE-STATUS NOT = ZERO
  2254         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2255         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2256         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2257         MOVE ELMSTR-AIX05-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2258         PERFORM ABEND-PGM.
  2259
  2260     GO TO 5900-EXIT.
  2261
  2262                                                                  EL336
  2264 5600-OPEN-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL336.cbl
*                        COPY ELC336P3 REPLACING                        EL336
* 2265     CERTIFICATE-MASTER-AIX02    BY  ERACCT-AIX02                 EL336
* 2266     AIX02-FILE-STATUS           BY  ERACCT-AIX02-FILE-STATUS.    EL336
  2267*****************************************************************
  2268*                                                               *
  2269*                            ELC336P3.                          *
  2270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2271*                            VMOD=2.002                         *
  2272*****************************************************************.
  2273
  2274     OPEN OUTPUT ERACCT-AIX02.
  2275
  2276     IF ERACCT-AIX02-FILE-STATUS NOT = ZERO
  2277         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2278         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2279         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2280         MOVE ERACCT-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2281         PERFORM ABEND-PGM.
  2282
  2283     GO TO 5900-EXIT.
  2284
  2285                                                                  EL336
  2286 5700-OPEN-ERPNDB.
*                        COPY ELC336P3 REPLACING                        EL336
* 2287     CERTIFICATE-MASTER-AIX02    BY  ERPNDB-AIX02                 EL336
* 2288     AIX02-FILE-STATUS           BY  ERPNDB-AIX02-FILE-STATUS.    EL336
  2289*****************************************************************
  2290*                                                               *
  2291*                            ELC336P3.                          *
  2292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2293*                            VMOD=2.002                         *
  2294*****************************************************************.
  2295
  2296     OPEN OUTPUT ERPNDB-AIX02.
  2297
  2298     IF ERPNDB-AIX02-FILE-STATUS NOT = ZERO
  2299         MOVE 'OPEN '            TO  WS-EM-OPERATION
  2300         ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-EM-AIX
  2301         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2302         MOVE ERPNDB-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2303         PERFORM ABEND-PGM.
  2304
  2305     GO TO 5900-EXIT.
  2306
  2307                                                                  EL336
  2308 5900-EXIT.                                                       EL336
  2309     EXIT.                                                        EL336
  2310                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL336.cbl
  2312 6000-CLOSE-AIX SECTION.                                          EL336
  2313                                                                  EL336
  2314     MOVE '0AIX TOTALS'          TO  PRT.                         EL336
  2315     PERFORM WRITE-PRINTER.                                       EL336
  2316                                                                  EL336
  2317 6010-CLOSE-AIX.                                                  EL336
  2318     MOVE WS-TOTAL-COUNT-AREA  TO  WS-AIX-COUNT-AREA.             EL336
  2319                                                                  EL336
  2320     SORT SORT-WORK-FILE                                          EL336
  2321         ON DESCENDING KEY SWR-FREQ                               EL336
  2322         INPUT PROCEDURE IS 8000-SORT-INPUT-PROCEDURE             EL336
  2323         OUTPUT PROCEDURE IS 8100-SORT-OUTPUT-PROCEDURE           EL336
  2324                                                                  EL336
  2325     MOVE WS-COUNT-AREA-INITALIZED TO WS-TOTAL-COUNT-AREA         EL336
  2326                                 WS-AIX-COUNT-AREA.               EL336
  2327                                                                  EL336
  2328 6020-CLOSE-AIX.                                                  EL336
  2329     GO TO 6300-CLOSE-ELARCH                                      EL336
  2330           6400-CLOSE-ELCERT                                      EL336
  2331           6500-CLOSE-ELMSTR                                      EL336
  2332           6600-CLOSE-ERACCT                                      EL336
  2333           6700-CLOSE-ERPNDB DEPENDING ON WS-DATASET.             EL336
  2334                                                                  EL336
  2336 6300-CLOSE-ELARCH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL336.cbl
*                         COPY ELC336P4 REPLACING                       EL336
* 2337     CERTIFICATE-MASTER-AIX02    BY  ELARCH-AIX02                 EL336
* 2338     AIX02-FILE-STATUS           BY  ELARCH-AIX02-FILE-STATUS.    EL336
  2339*****************************************************************
  2340*                                                               *
  2341*                            ELC336P4.                          *
  2342*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2343*                            VMOD=2.003                         *
  2344*****************************************************************.
  2345
  2346     CLOSE ELARCH-AIX02.
  2347
  2348     IF ELARCH-AIX02-FILE-STATUS NOT = ZERO
  2349         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2350         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2351         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2352         MOVE ELARCH-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2353         PERFORM ABEND-PGM.
  2354
  2355     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2356     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2357
  2358     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2359
  2360     MOVE WS-TIME              TO  WS-D1-TIME.
  2361     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2362
  2363     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2364
  2365     GO TO 6900-EXIT.
  2366
  2367                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL336.cbl
  2369 6400-CLOSE-ELCERT.                                               EL336
  2370     GO TO 6420-CLOSE-ELCERT2                                     EL336
  2371           6430-CLOSE-ELCERT3                                     EL336
  2372           6440-CLOSE-ELCERT4                                     EL336
  2373           6450-CLOSE-ELCERT5                                     EL336
  2374           6460-CLOSE-ELCERT6 DEPENDING ON WS-LAST-AIX-NUMBER.    EL336
  2375                                                                  EL336
  2376 6420-CLOSE-ELCERT2.
*                          COPY ELC336P4 REPLACING                      EL336
* 2377     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX02                 EL336
* 2378     AIX02-FILE-STATUS           BY  ELCERT-AIX02-FILE-STATUS.    EL336
  2379*****************************************************************
  2380*                                                               *
  2381*                            ELC336P4.                          *
  2382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2383*                            VMOD=2.003                         *
  2384*****************************************************************.
  2385
  2386     CLOSE ELCERT-AIX02.
  2387
  2388     IF ELCERT-AIX02-FILE-STATUS NOT = ZERO
  2389         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2390         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2391         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2392         MOVE ELCERT-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2393         PERFORM ABEND-PGM.
  2394
  2395     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2396     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2397
  2398     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2399
  2400     MOVE WS-TIME              TO  WS-D1-TIME.
  2401     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2402
  2403     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2404
  2405     GO TO 6900-EXIT.
  2406
  2407                                                                  EL336
  2409 6430-CLOSE-ELCERT3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL336.cbl
*                          COPY ELC336P4 REPLACING                      EL336
* 2410     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX03                 EL336
* 2411     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX03-RECORDS-OUTPUT      EL336
* 2412     AIX02-FILE-STATUS           BY  ELCERT-AIX03-FILE-STATUS.    EL336
  2413*****************************************************************
  2414*                                                               *
  2415*                            ELC336P4.                          *
  2416*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2417*                            VMOD=2.003                         *
  2418*****************************************************************.
  2419
  2420     CLOSE ELCERT-AIX03.
  2421
  2422     IF ELCERT-AIX03-FILE-STATUS NOT = ZERO
  2423         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2424         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2425         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2426         MOVE ELCERT-AIX03-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2427         PERFORM ABEND-PGM.
  2428
  2429     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2430     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2431
  2432     MOVE WS-AIX03-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2433
  2434     MOVE WS-TIME              TO  WS-D1-TIME.
  2435     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2436
  2437     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2438
  2439     GO TO 6900-EXIT.
  2440
  2441                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL336.cbl
  2443 6440-CLOSE-ELCERT4.                                              EL336
  2444     GO TO 6900-EXIT.                                             EL336
  2445                                                                  EL336
  2446 6450-CLOSE-ELCERT5.
*                          COPY ELC336P4 REPLACING                      EL336
* 2447     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX05                 EL336
* 2448     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX05-RECORDS-OUTPUT      EL336
* 2449     AIX02-FILE-STATUS           BY  ELCERT-AIX05-FILE-STATUS.    EL336
  2450*****************************************************************
  2451*                                                               *
  2452*                            ELC336P4.                          *
  2453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2454*                            VMOD=2.003                         *
  2455*****************************************************************.
  2456
  2457     CLOSE ELCERT-AIX05.
  2458
  2459     IF ELCERT-AIX05-FILE-STATUS NOT = ZERO
  2460         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2461         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2462         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2463         MOVE ELCERT-AIX05-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2464         PERFORM ABEND-PGM.
  2465
  2466     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2467     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2468
  2469     MOVE WS-AIX05-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2470
  2471     MOVE WS-TIME              TO  WS-D1-TIME.
  2472     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2473
  2474     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2475
  2476     GO TO 6900-EXIT.
  2477
  2478                                                                  EL336
  2480 6460-CLOSE-ELCERT6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL336.cbl
*                          COPY ELC336P4 REPLACING                      EL336
* 2481     CERTIFICATE-MASTER-AIX02    BY  ELCERT-AIX06                 EL336
* 2482     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX06-RECORDS-OUTPUT      EL336
* 2483     AIX02-FILE-STATUS           BY  ELCERT-AIX06-FILE-STATUS.    EL336
  2484*****************************************************************
  2485*                                                               *
  2486*                            ELC336P4.                          *
  2487*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2488*                            VMOD=2.003                         *
  2489*****************************************************************.
  2490
  2491     CLOSE ELCERT-AIX06.
  2492
  2493     IF ELCERT-AIX06-FILE-STATUS NOT = ZERO
  2494         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2495         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2496         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2497         MOVE ELCERT-AIX06-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2498         PERFORM ABEND-PGM.
  2499
  2500     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2501     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2502
  2503     MOVE WS-AIX06-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2504
  2505     MOVE WS-TIME              TO  WS-D1-TIME.
  2506     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2507
  2508     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2509
  2510     GO TO 6900-EXIT.
  2511
  2512                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL336.cbl
  2514 6500-CLOSE-ELMSTR.                                               EL336
  2515     GO TO 6520-CLOSE-ELMSTR2                                     EL336
  2516           6530-CLOSE-ELMSTR3                                     EL336
  2517           6540-CLOSE-ELMSTR4                                     EL336
  2518           6550-CLOSE-ELMSTR5 DEPENDING ON WS-LAST-AIX-NUMBER.    EL336
  2519                                                                  EL336
  2520 6520-CLOSE-ELMSTR2.
*                          COPY ELC336P4 REPLACING                      EL336
* 2521     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX02                 EL336
* 2522     AIX02-FILE-STATUS           BY  ELMSTR-AIX02-FILE-STATUS.    EL336
  2523*****************************************************************
  2524*                                                               *
  2525*                            ELC336P4.                          *
  2526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2527*                            VMOD=2.003                         *
  2528*****************************************************************.
  2529
  2530     CLOSE ELMSTR-AIX02.
  2531
  2532     IF ELMSTR-AIX02-FILE-STATUS NOT = ZERO
  2533         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2534         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2535         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2536         MOVE ELMSTR-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2537         PERFORM ABEND-PGM.
  2538
  2539     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2540     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2541
  2542     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2543
  2544     MOVE WS-TIME              TO  WS-D1-TIME.
  2545     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2546
  2547     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2548
  2549     GO TO 6900-EXIT.
  2550
  2551                                                                  EL336
  2553 6530-CLOSE-ELMSTR3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL336.cbl
*                          COPY ELC336P4 REPLACING                      EL336
* 2554     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX03                 EL336
* 2555     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX03-RECORDS-OUTPUT      EL336
* 2556     AIX02-FILE-STATUS           BY  ELMSTR-AIX03-FILE-STATUS.    EL336
  2557*****************************************************************
  2558*                                                               *
  2559*                            ELC336P4.                          *
  2560*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2561*                            VMOD=2.003                         *
  2562*****************************************************************.
  2563
  2564     CLOSE ELMSTR-AIX03.
  2565
  2566     IF ELMSTR-AIX03-FILE-STATUS NOT = ZERO
  2567         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2568         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2569         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2570         MOVE ELMSTR-AIX03-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2571         PERFORM ABEND-PGM.
  2572
  2573     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2574     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2575
  2576     MOVE WS-AIX03-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2577
  2578     MOVE WS-TIME              TO  WS-D1-TIME.
  2579     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2580
  2581     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2582
  2583     GO TO 6900-EXIT.
  2584
  2585                                                                  EL336
  2586 6540-CLOSE-ELMSTR4.                                              EL336
  2587*    NOTE ******************************************************* EL336
  2588*         *        THERE IS NO CLAIM MASTER AIX FOUR            * EL336
  2589*         *******************************************************.EL336
  2590                                                                  EL336
  2591     GO TO 6900-EXIT.                                             EL336
  2592                                                                  EL336
  2594 6550-CLOSE-ELMSTR5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL336.cbl
*                          COPY ELC336P4 REPLACING                      EL336
* 2595     CERTIFICATE-MASTER-AIX02    BY  ELMSTR-AIX05                 EL336
* 2596     WS-AIX02-RECORDS-OUTPUT     BY  WS-AIX03-RECORDS-OUTPUT      EL336
* 2597     AIX02-FILE-STATUS           BY  ELMSTR-AIX05-FILE-STATUS.    EL336
  2598*****************************************************************
  2599*                                                               *
  2600*                            ELC336P4.                          *
  2601*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2602*                            VMOD=2.003                         *
  2603*****************************************************************.
  2604
  2605     CLOSE ELMSTR-AIX05.
  2606
  2607     IF ELMSTR-AIX05-FILE-STATUS NOT = ZERO
  2608         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2609         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2610         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2611         MOVE ELMSTR-AIX05-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2612         PERFORM ABEND-PGM.
  2613
  2614     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2615     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2616
  2617     MOVE WS-AIX03-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2618
  2619     MOVE WS-TIME              TO  WS-D1-TIME.
  2620     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2621
  2622     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2623
  2624     GO TO 6900-EXIT.
  2625
  2626                                                                  EL336
  2628 6600-CLOSE-ERACCT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL336.cbl
*                         COPY ELC336P4 REPLACING                       EL336
* 2629     CERTIFICATE-MASTER-AIX02    BY  ERACCT-AIX02                 EL336
* 2630     AIX02-FILE-STATUS           BY  ERACCT-AIX02-FILE-STATUS.    EL336
  2631*****************************************************************
  2632*                                                               *
  2633*                            ELC336P4.                          *
  2634*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2635*                            VMOD=2.003                         *
  2636*****************************************************************.
  2637
  2638     CLOSE ERACCT-AIX02.
  2639
  2640     IF ERACCT-AIX02-FILE-STATUS NOT = ZERO
  2641         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2642         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2643         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2644         MOVE ERACCT-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2645         PERFORM ABEND-PGM.
  2646
  2647     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2648     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2649
  2650     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2651
  2652     MOVE WS-TIME              TO  WS-D1-TIME.
  2653     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2654
  2655     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2656
  2657     GO TO 6900-EXIT.
  2658
  2659                                                                  EL336
  2661 6700-CLOSE-ERPNDB.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL336.cbl
*                         COPY ELC336P4 REPLACING                       EL336
* 2662     CERTIFICATE-MASTER-AIX02    BY  ERPNDB-AIX02                 EL336
* 2663     AIX02-FILE-STATUS           BY  ERPNDB-AIX02-FILE-STATUS.    EL336
  2664*****************************************************************
  2665*                                                               *
  2666*                            ELC336P4.                          *
  2667*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2668*                            VMOD=2.003                         *
  2669*****************************************************************.
  2670
  2671     CLOSE ERPNDB-AIX02.
  2672
  2673     IF ERPNDB-AIX02-FILE-STATUS NOT = ZERO
  2674         MOVE 'CLOSE'            TO  WS-EM-OPERATION
  2675         ADD +1 WS-LAST-AIX-NUMBER GIVING WS-EM-AIX
  2676         MOVE WS-ERROR-MESSAGE   TO  WS-ABEND-MESSAGE
  2677         MOVE ERPNDB-AIX02-FILE-STATUS TO  WS-ABEND-FILE-STATUS
  2678         PERFORM ABEND-PGM.
  2679
  2680     ADD  +1  WS-LAST-AIX-NUMBER  GIVING  WS-LM-AIX.
  2681     MOVE WS-LOADED-MESSAGE      TO  WS-D1-MESSAGE.
  2682
  2683     MOVE WS-AIX02-RECORDS-OUTPUT TO  WS-D1-COUNT.
  2684
  2685     MOVE WS-TIME              TO  WS-D1-TIME.
  2686     INSPECT WS-D1-TIME REPLACING ALL SPACES BY '.'
  2687
  2688     DISPLAY WS-DISPLAY1 UPON CONSOLE.
  2689
  2690     GO TO 6900-EXIT.
  2691
  2692                                                                  EL336
  2693 6900-EXIT.                                                       EL336
  2694     EXIT.                                                        EL336
  2695                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL336.cbl
  2697 7000-PRINT-COMPANY-TOTALS SECTION.                               EL336
  2698                                                                  EL336
  2699     MOVE '0'                TO  WS-DETAIL-LINE1.                 EL336
  2700     MOVE WS-EM-FILE-NAME    TO  WS-D4-FILE-NAME.                 EL336
  2701     ADD +1 WS-LAST-AIX-NUMBER GIVING WS-D4-AIX-NUMBER.           EL336
  2702     MOVE WS-LAST-COMPANY-CD TO  WS-COMPANY-CD.                   EL336
  2703     MOVE WS-COMPANY-NUMBER  TO  WS-D4-COMPANY-NUMBER.            EL336
  2704                                                                  EL336
  2705     DIVIDE WS-COMPANY-NUMBER BY +16                              EL336
  2706         GIVING WS-WORK REMAINDER WS-REMAINDER.                   EL336
  2707                                                                  EL336
  2708     IF WS-WORK GREATER THAN ZERO                                 EL336
  2709         MOVE WS-HEX-CHAR (WS-WORK) TO WS-D4-COMPANY-CD1          EL336
  2710       ELSE                                                       EL336
  2711         MOVE ZERO               TO  WS-D4-COMPANY-CD1.           EL336
  2712                                                                  EL336
  2713     IF WS-REMAINDER GREATER THAN ZERO                            EL336
  2714         MOVE WS-HEX-CHAR (WS-REMAINDER) TO WS-D4-COMPANY-CD2     EL336
  2715       ELSE                                                       EL336
  2716         MOVE ZERO               TO  WS-D4-COMPANY-CD2.           EL336
  2717                                                                  EL336
  2718     SET CI TO +1.                                                EL336
  2719                                                                  EL336
  2720 7020-PRINT-COMPANY-TOTALS.                                       EL336
  2721     IF WS-COMPANY-CD = WS-COMPANY-CODE (CI)                      EL336
  2722         MOVE WS-COMPANY-ID   (CI) TO WS-D4-COMPANY-ID            EL336
  2723         MOVE WS-COMPANY-NAME (CI) TO WS-D4-COMPANY-NAME          EL336
  2724         GO TO 7030-PRINT-COMPANY-TOTALS.                         EL336
  2725                                                                  EL336
  2726     IF CI LESS THAN CI-MAX                                       EL336
  2727         SET CI UP BY +1                                          EL336
  2728         GO TO 7020-PRINT-COMPANY-TOTALS.                         EL336
  2729                                                                  EL336
  2730     MOVE '*** UNKNOWN COMPANY CODE ***' TO WS-D4-COMPANY-NAME.   EL336
  2731                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL336.cbl
  2733 7030-PRINT-COMPANY-TOTALS.                                       EL336
  2734     MOVE 'RECORDS OUTPUT='  TO  WS-D4-MESSAGE.                   EL336
  2735     MOVE WS-RECORDS-OUTPUT  TO  WS-D4-COUNT.                     EL336
  2736     MOVE ZERO               TO  WS-RECORDS-OUTPUT.               EL336
  2737     MOVE WS-DETAIL-LINE1    TO  PRT.                             EL336
  2738     PERFORM WRITE-PRINTER.                                       EL336
  2739                                                                  EL336
  2740     SORT SORT-WORK-FILE                                          EL336
  2741         ON DESCENDING KEY SWR-FREQ                               EL336
  2742         INPUT PROCEDURE IS 8000-SORT-INPUT-PROCEDURE             EL336
  2743         OUTPUT PROCEDURE IS 8100-SORT-OUTPUT-PROCEDURE           EL336
  2744                                                                  EL336
  2745     SET CI1 TO +1.                                               EL336
  2746                                                                  EL336
  2747 7040-PRINT-COMPANY-TOTALS.                                       EL336
  2748     IF WS-AIX-COUNT-OCCURS (CI1) = ZERO                          EL336
  2749         MOVE WS-COUNT-AREA-INITALIZED TO WS-AIX-COUNT-AREA       EL336
  2750         SET CI1 TO +1                                            EL336
  2751         GO TO 7090-EXIT.                                         EL336
  2752                                                                  EL336
  2753     IF WS-TOTAL-COUNT-OCCURS (TI1) = WS-AIX-COUNT-OCCURS (CI1)   EL336
  2754         ADD WS-AIX-COUNT-FREQ (CI1) TO WS-TOTAL-COUNT-FREQ (TI1) EL336
  2755       ELSE                                                       EL336
  2756         SET TI1 TO +1                                            EL336
  2757         SEARCH WS-TOTAL-COUNT-ARRAY VARYING TI1                  EL336
  2758             WHEN WS-TOTAL-COUNT-OCCURS (TI1) =                   EL336
  2759                                 WS-AIX-COUNT-OCCURS (CI1)        EL336
  2760                 ADD WS-AIX-COUNT-FREQ (CI1)                      EL336
  2761                                 TO  WS-TOTAL-COUNT-FREQ (TI1)    EL336
  2762             WHEN WS-TOTAL-COUNT-OCCURS (TI1) = ZERO              EL336
  2763                 MOVE WS-AIX-COUNT-OCCURS (CI1)                   EL336
  2764                                 TO  WS-TOTAL-COUNT-OCCURS (TI1)  EL336
  2765                 ADD WS-AIX-COUNT-FREQ (CI1)                      EL336
  2766                                 TO  WS-TOTAL-COUNT-FREQ (TI1).   EL336
  2767                                                                  EL336
  2768     IF CI1 IS LESS THAN +500                                     EL336
  2769         SET CI1 UP BY +1                                         EL336
  2770         GO TO 7040-PRINT-COMPANY-TOTALS.                         EL336
  2771                                                                  EL336
  2772 7090-EXIT.                                                       EL336
  2773     EXIT.                                                        EL336
  2774                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL336.cbl
  2776 8000-SORT-INPUT-PROCEDURE SECTION.                               EL336
  2777                                                                  EL336
  2778     SET CI1 TO +1.                                               EL336
  2779     MOVE '0'                    TO  WS-DETAIL-LINE1.             EL336
  2780                                                                  EL336
  2781 8010-SIP.                                                        EL336
  2782     IF WS-AIX-COUNT-OCCURS (CI1) = ZERO                          EL336
  2783         GO TO 8099-EXIT.                                         EL336
  2784                                                                  EL336
  2785     MOVE WS-AIX-COUNT-OCCURS (CI1) TO SWR-OCCURS.                EL336
  2786     MOVE WS-AIX-COUNT-FREQ   (CI1) TO SWR-FREQ.                  EL336
  2787                                                                  EL336
  2788     RELEASE SORT-WORK-RECORD.                                    EL336
  2789                                                                  EL336
  2790     IF CI1 IS LESS THAN +500                                     EL336
  2791         SET CI1 UP BY +1                                         EL336
  2792         GO TO 8010-SIP.                                          EL336
  2793                                                                  EL336
  2794 8099-EXIT.                                                       EL336
  2795     EXIT.                                                        EL336
  2796                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL336.cbl
  2798 8100-SORT-OUTPUT-PROCEDURE SECTION.                              EL336
  2799                                                                  EL336
  2800 8110-SOP.                                                        EL336
  2801     RETURN SORT-WORK-FILE                                        EL336
  2802         AT END                                                   EL336
  2803             GO TO 8199-EXIT.                                     EL336
  2804                                                                  EL336
  2805     MOVE SWR-OCCURS       TO WS-D5-AIX-OCCURS.                   EL336
  2806     MOVE SWR-FREQ         TO WS-D5-AIX-OCCURS-FREQ.              EL336
  2807                                                                  EL336
  2808     MOVE WS-DETAIL-LINE1 TO  PRT.                                EL336
  2809     PERFORM WRITE-PRINTER.                                       EL336
  2810                                                                  EL336
  2811     MOVE SPACES           TO  WS-DETAIL-LINE1.                   EL336
  2812     GO TO 8110-SOP.                                              EL336
  2813                                                                  EL336
  2814 8199-EXIT.                                                       EL336
  2815     EXIT.                                                        EL336
  2816                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL336.cbl
  2818 WRITE-PRINTER SECTION.                                           EL336
  2819                                                                  EL336
  2820*    NOTE ******************************************************* EL336
  2821*         * THIS SECTION CONTROLS WRITES TO THE PRINTER         * EL336
  2822*         *******************************************************.EL336
  2823                                                                  EL336
  2824 WPS-010.                                                         EL336
  2825     WRITE PRT.                                                   EL336
  2826                                                                  EL336
  2827 WPS-EXIT.                                                        EL336
  2828     EXIT.                                                        EL336
  2829                                                                  EL336
  2831 ABEND-PGM SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL336.cbl
*                         COPY ELCABEND.                                EL336
  2832***************************************************************** 04/14/98
  2833*                                                               * ELCABEND
  2834*                            ELCABEND.                          *    LV003
  2835*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2836*                            VMOD 2.002                              CL**2
  2837*                                                               * ELCABEND
  2838*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2839*            AND THEN ABENDS.                                   * ELCABEND
  2840*                                                               * ELCABEND
  2841*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2842*                                                               * ELCABEND
  2843***************************************************************** ELCABEND
  2844*APS-010.                                                         ELCABEND
  2845     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2846     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2847                                                                  ELCABEND
  2848     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2849         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2850         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2851                                 UPON CONSOLE.                    ELCABEND
  2852                                                                  ELCABEND
  2853     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2854         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2855         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2856                                 UPON CONSOLE.                    ELCABEND
  2857                                                                  ELCABEND
  2858     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2859     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2860                                 UPON CONSOLE.                    ELCABEND
  2861                                                                  ELCABEND
  2862     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2863     CALL 'ABORTME'.
  2864                                                                  ELCABEND
  2865 APS-EXIT.                                                        ELCABEND
  2866     EXIT.                                                        ELCABEND
  2867                                                                  EL336
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      123144     Code:       13306
