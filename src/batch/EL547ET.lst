* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* EL547ET.cbl
* Options: int("EL547ET.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL547ET.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL547ET.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL547ET.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    EL547ET.
     3 AUTHOR.        CENTRAL STATES HEALTH AND LIFE.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     6*REMARKS.
     7*    THIS PROGRAM READS THE MONTH END CERT FILE AND CLMS FILE
     8*    AND BUILDS AN EXTRACT BY ISSUE YEAR.  THE EXTRACT IS
     9*    PRIMARLIY USED BY ACTUARIAL.  THE REFUNDS SELECTED ARE
    10*    PLACED IN THE VALUATION YEAR BASED ON THE CANCEL DATE.
    11*    THE CLAIMS SELECTED ARE PLACED IN THE VALUATION YEAR
    12*    BASED ON INCURRED DATE.  THE LOWEST ISSUE YEAR WILL ALWAYS
    13*    BE 1986.  IF YOU NEED TO CHANGE THAT SIMPLY CHANGE THE
    14*    HARD CODING WHERE YOU FIND MOVE 1986 TO LO-ISSUE AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* EL547ET.cbl
    15*    LO-VALUATION.  ANY CHANGES MADE TO THE SPECIAL ECS083
    16*    MUST ALSO BE MADE IN THIS PROGRAM.
    18 ENVIRONMENT DIVISION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT CERTS        ASSIGN TO
    23*       '/data/seqfiles/ZI.XX.CERT.PEMA'.
    24        SYS010.
    25     SELECT EXTRACT      ASSIGN TO
    26*       '/data/seqfiles/ZI.XX.EXTR547'
    27        SYS011
    28        ORGANIZATION IS LINE SEQUENTIAL.
    29     SELECT CLMS-HIST    ASSIGN TO
    30*       '/data/seqfiles/ZI.XX.CLMS.A15860'.
    31        SYS013.
    32     SELECT DISK-DATE    ASSIGN TO
    33*       '/data/seqfiles/ZI.DD.ER.DATECARD.EL547'.
    34        SYS019.
    35     SELECT PRINTX       ASSIGN TO
    36*       '/data/seqfiles/sys008'.
    37        SYS008.
    38
    39 DATA DIVISION.
    40 FILE SECTION.
    41
    42 FD  CLMS-HIST
*   43                                 COPY ECSEXTFD.
    44******************************************************************07/10/97
    45*                                                                *ECSEXTFD
    46*                            ECSEXTFD                            *   LV001
    47*                            VMOD=2.001                          *ECSEXTFD
    48*                                                                *ECSEXTFD
    49*  NO  CID  MODS  IN  COPYBOOK  ECSEXTFD                         *ECSEXTFD
    50*                                                                *ECSEXTFD
    51******************************************************************ECSEXTFD
    52     RECORDING MODE F                                             ECSEXTFD
    53     LABEL RECORDS STANDARD                                       ECSEXTFD
    54     BLOCK CONTAINS 0 RECORDS
    55     RECORD CONTAINS 510 CHARACTERS.                              ECSEXTFD
    56******************************************************************ECSEXTFD
*   57                                 COPY ECSEXT01.
    58******************************************************************04/29/98
    59*                                                                *ECSEXT01
    60*                            ECSEXT01                            *   LV015
    61*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
    62*                            VMOD=2.015                          *ECSEXT01
    63*                                                                *ECSEXT01
    64*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
    65*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
    66*                                                                *ECSEXT01
    67*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
    68*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
    69*                                                                *ECSEXT01
    70*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
    71*                                                                *ECSEXT01
    72******************************************************************ECSEXT01
    73******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
    74*                   C H A N G E   L O G
    75*
    76* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    77*-----------------------------------------------------------------
    78*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    79* EFFECTIVE    NUMBER
    80*-----------------------------------------------------------------
    81* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    82* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
    83* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    84* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
    85* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
    86* 032612  CR2011110200001  PEMA  AHL CHANGES
    87******************************************************************
    88                                                                  ECSEXT01
    89 01  DETAIL-EXTRACT.                                              ECSEXT01
    90     02 DETAIL-FILE.                                              ECSEXT01
    91     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
    92         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
    93                                                                  ECSEXT01
    94     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
    95                                                                  ECSEXT01
    96     12  DE-REIN                           PIC X.                 ECSEXT01
    97                                                                  ECSEXT01
    98     12  DE-CONTROL.                                              ECSEXT01
    99         16  DE-CNTRL1.                                           ECSEXT01
   100             20  DE-CARRIER                PIC X.                 ECSEXT01
   101             20  DE-GROUPING.                                     ECSEXT01
   102                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   103                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
   104             20  DE-STATE                  PIC XX.                ECSEXT01
   105             20  DE-ACCOUNT.                                      ECSEXT01
   106                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
   107                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   108         16  DE-CNTRL2.                                           ECSEXT01
   109             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   110             20  DE-CERT.                                         ECSEXT01
   111                 24 DE-CERT-NO.                                   ECSEXT01
   112                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   113                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   114                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   115                                                                  ECSEXT01
   116     12  DE-TRANS                          PIC X.                 ECSEXT01
   117         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   118         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   119         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   120         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   121         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   122         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   123         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   124         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   125         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   126         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   127                                                                  ECSEXT01
   128     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   129     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   130                                                                  ECSEXT01
   131     12  DE-NAME.                                                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   132         16  DE-LNAME                      PIC X(15).             ECSEXT01
   133         16  DE-FNAME.                                            ECSEXT01
   134             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   135             20  FILLER                    PIC X(9).              ECSEXT01
   136         16  DE-INIT                       PIC X.                 ECSEXT01
   137     12  DE-AGE                            PIC 99.                ECSEXT01
   138     12  DE-SEX                            PIC X.                 ECSEXT01
   139     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   140                                                                  ECSEXT01
   141     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   142     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   143     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   144     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   145     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   146     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   147     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   148     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   149     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   150                                                                  ECSEXT01
   151     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   152     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   153     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   154     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   155                                                                  ECSEXT01
   156     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   157     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   158     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   159     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   160     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   161                                                                  ECSEXT01
   162     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   163     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   164     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   165     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   166                                                                  ECSEXT01
   167     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   168     12  DE-ADDL-CLP REDEFINES DE-LIVES
   169                                           PIC S9(5)V99   COMP-3.
   170     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   171     12  FILLER REDEFINES DE-NUM-BILLED.
   172         16  DE-CLP-STATE                  PIC XX.
   173         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   174     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   175     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   176                                                                  ECSEXT01
   177     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   178     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   179     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   180     12  DE-IG                             PIC X.                 ECSEXT01
   181     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   182*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   183     12  DE-MEMBER-NO.                                            ECSEXT01
   184         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   185         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   186         16  FILLER                        PIC X(03).             ECSEXT01
   187     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   188                                                                  ECSEXT01
   189     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   190         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   191                                                                  ECSEXT01
   192     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   193     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   194                                                                  ECSEXT01
   195     12  DE-REI-AREA.                                             ECSEXT01
   196         16  DE-REI-COMP.                                         ECSEXT01
   197             20  DE-REINCO                 PIC XXX.               ECSEXT01
   198             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   199         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   200         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   201         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   202         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   203         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   204         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   205         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   206                                                                  ECSEXT01
   207     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   208     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   209         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   210         16  F                             PIC X.
   211*    12  FILLER                            PIC X(5).              ECSEXT01
   212                                                                  ECSEXT01
   213     12  DE-BILLED-AREA.                                          ECSEXT01
   214         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   215             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   216                                                                  ECSEXT01
   217         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   218             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   219             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
   220             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   221             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   222             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
   223             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   224                                                                  ECSEXT01
   225         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   226             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   227                                                                  ECSEXT01
   228         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   229         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   230         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   231         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   232                                                                  ECSEXT01
   233         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   234*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   235*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   236                                                                  ECSEXT01
   237     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   238         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   239         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   240         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   241                                                                  ECSEXT01
   242     12  DE-REVERSE-REASONS.                                      ECSEXT01
   243         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   244         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   245     12  DE-CANCEL-REASON                  PIC X.
   246                                                                  ECSEXT01
   247     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   248     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   249                                                                  ECSEXT01
   250     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   251         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   252             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   253         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   254             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   255                                                                  ECSEXT01
   256     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   257         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   258                                                                  ECSEXT01
   259     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   260     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   261         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   262         16  FILLER                        PIC X.
   263                                                                  ECSEXT01
   264****************************************************************  ECSEXT01
   265**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   266****************************************************************  ECSEXT01
   267     12  DE-COMM-LEVELS.                                          ECSEXT01
   268         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   269             20  DE-AGT.                                          ECSEXT01
   270                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   271                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   272             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   273             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   274             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   275                                                                  ECSEXT01
   276     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   277****************************************************************  ECSEXT01
   278*******                 CLAIM EXTRACT                      *****  ECSEXT01
   279****************************************************************  ECSEXT01
   280     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
   281     12  FILLER                            PIC X(334).            ECSEXT01
   282     12  DE-TYPE                           PIC X.                 ECSEXT01
   283         88  DE-DTH                           VALUE '1'.          ECSEXT01
   284         88  DE-AH                            VALUE '2'.          ECSEXT01
   285         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   286         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   287         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   288         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   289                                                                  ECSEXT01
   290     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   291     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   292                                                                  ECSEXT01
   293     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   294     12  DE-REPORTED.                                             ECSEXT01
   295         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   296         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   297         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   298     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   299     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   300                                                                  ECSEXT01
   301     12  DE-CNUM                           PIC X(7).              ECSEXT01
   302     12  DE-CHECK                          PIC X(7).              ECSEXT01
   303     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   304     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   305     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   306     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   307         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   308         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   309         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   310         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   311         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   312         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   313         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   314                                                                  ECSEXT01
   315     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   316                                                                  ECSEXT01
   317     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   318     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   319     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   320     12  FILLER                            PIC XX.                ECSEXT01
   321     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   322                                                                  ECSEXT01
   323     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   324     12  DE-BENEFICIARY                    PIC X(10).
   325     12  filler redefines de-beneficiary.
   326         16  de-birth-date                 pic 9(11)  comp-3.
   327         16  f                             pic x(4).
   328     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   329     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   330     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   331     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   332     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   333     12  DE-CLM-CLASS                      PIC XX.
   334     12  DE-CLM-DEV                        PIC XXX.
   335     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
   336     12  de-xycor-cert-seq                 pic x(3).
   337     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   338     12  DE-XYCOR-ACTION-CD                PIC XXX.
   339     12  DE-XYCOR-STATUS                   PIC X.
   340     12  FILLER                            PIC X(4).              ECSEXT01
   341                                                                  ECSEXT01
   342     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   343                                                                  ECSEXT01
   344****************************************************************  ECSEXT01
   345*******               RESERVE EXTRACT                      *****  ECSEXT01
   346****************************************************************  ECSEXT01
   347     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   348     12  FILLER                            PIC X(334).            ECSEXT01
   349                                                                  ECSEXT01
   350     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   351         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   352         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   353                                                                  ECSEXT01
   354     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   355     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   356     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   357                                                                  ECSEXT01
   358     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   359                                                                  ECSEXT01
   360     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   361     12  DE-RSV-REPORTED.                                         ECSEXT01
   362         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   363         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   364         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   365     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   366                                                                  ECSEXT01
   367     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   368     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   369     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   370                                                                  ECSEXT01
   371     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   372     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   373     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   374                                                                  ECSEXT01
   375     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   376                                                                  ECSEXT01
   377     12  DE-RATE-CLASS                     PIC XX.
   378     12  DE-DEV-CODE                       PIC XXX.
   379     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   380     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   381     12  FILLER                            PIC X(58).             ECSEXT01
   382                                                                  ECSEXT01
   383     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   384******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* EL547ET.cbl
   385/
   386
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* EL547ET.cbl
   388 FD  CERTS
*  389                                 COPY ECSCRIFD.
   390******************************************************************07/10/97
   391*                                                                *ECSCRIFD
   392*                            ECSCRIFD                            *   LV001
   393*                            VMOD 2.005                          *ECSCRIFD
   394*                                                                *ECSCRIFD
   395*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   396*                                                                *ECSCRIFD
   397******************************************************************ECSCRIFD
   398     BLOCK CONTAINS 0 RECORDS
   399     RECORDING MODE F.                                            ECSCRIFD
   400                                                                  ECSCRIFD
   401 01  CERT-IN-RECORD.                                              ECSCRIFD
   402                                                                  ECSCRIFD
   403     12  FILLER                            PIC XXX.               ECSCRIFD
   404     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   405     12  FILLER                            PIC X(66).             ECSCRIFD
   406     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   407     12  FILLER                            PIC X(20).             ECSCRIFD
   408     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   409     12  FILLER                            PIC X(14).             ECSCRIFD
   410     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   411     12  FILLER                            PIC X(39).             ECSCRIFD
   412     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   413     12  FILLER                            PIC X(45).             ECSCRIFD
   414     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   415     12  FILLER                            PIC X(35).             ECSCRIFD
   416     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   417     12  FILLER                            PIC X(41).             ECSCRIFD
   418     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   419     12  FILLER                            PIC X(48).             ECSCRIFD
   420     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   421     12  FILLER                            PIC X(9).              ECSCRIFD
   422     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   423     12  FILLER                            PIC X(120).            ECSCRIFD
   424     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   425     12  FILLER                            PIC X(73).             ECSCRIFD
   426     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   427     12  FILLER                            PIC X(464).            ECSCRIFD
   428                                                                  ECSCRIFD
   429******************************************************************ECSCRIFD
*  430                                 COPY ECSCRT01.
   431******************************************************************
   432*                                                                *
   433*                            ECSCRT01                            *
   434*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   435*                            VMOD=2.016                          *
   436*                                                                *
   437*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   438*                                                                *
   439*   FILE TYPE = SEQUENTIAL
   440*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   441*                                                                *
   442*   KEY DATA =                         START=4, LEN=36           *
   443*                                                                *
   444*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   445*                                                                *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   446******************************************************************
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   456* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   457* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   458* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   459* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   460* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   461* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   462* 032612  CR2011110200001  PEMA  AHL CHANGES
   463* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   464* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   465******************************************************************
   466
   467 01  CERTIFICATE-RECORD.
   468     12  CR-RECORD-ID                      PIC XX.
   469         88  VALID-CR-ID                      VALUE 'CR'.
   470
   471     12  CR-COMPANY-CD                     PIC X.
   472
   473     12  CR-FULL-CONTROL.
   474         16  CR-CONTROL-1.
   475             20  CR-ACCT-CONTROL.
   476                 24  CR-CARRIER            PIC X.
   477                 24  CR-GROUPING.
   478                     28  CR-GROUP-PREFIX   PIC XXX.
   479                     28  CR-GROUP-PRIME    PIC XXX.
   480                 24  CR-STATE              PIC XX.
   481                 24  CR-ACCOUNT.
   482                     28  CR-ACCT-PREFIX    PIC X(4).
   483                     28  CR-ACCT-PRIME     PIC X(6).
   484             20  CR-DT                     PIC 9(11)  COMP-3.
   485         16  CR-CERT-NO.
   486             20  CR-CERT.
   487                 24  CR-CERT-PREFIX        PIC X(3).
   488                 24  CR-CERT-PRIME         PIC X(7).
   489             20  CR-CERT-SFX               PIC X.
   490
   491     12  CR-INSUREDS-PROFILE.
   492         16  CR-NAME.
   493             20  CR-LNAME                  PIC X(15).
   494             20  CR-FNAME.
   495                 24  CR-1ST-INITIAL        PIC X.
   496                 24  FILLER                PIC X(9).
   497             20  CR-INIT                   PIC X.
   498         16  CR-AGE                        PIC 99.
   499         16  CR-SEX                        PIC X.
   500             88  CR-SEX-MALE                  VALUE 'M'.
   501             88  CR-SEX-FEMALE                VALUE 'F'.
   502         16  CR-SOC-SEC                    PIC X(11).
   503         16  CR-JOINT-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   504             20  CR-JT-LNAME               PIC X(15).
   505             20  CR-JT-FNAME.
   506                 24  CR-JT-1ST-INIT        PIC X.
   507                 24  FILLER                PIC X(9).
   508             20  CR-JT-INIT                PIC X.
   509         16  CR-JOINT-AGE                  PIC 99.
   510
   511         16  cr-ahl-ah-claim-no            pic x(9).
   512         16  cr-ahl-ah-cert-seq            pic x(3).
   513         16  cr-hst-proc-lf                pic x.
   514         16  f                             pic x(7).
   515
   516     12  CR-LF-COVERAGE-DATA.
   517         16  CR-LFTYP                      PIC XX.
   518         16  CR-LF-TERM                    PIC S999       COMP-3.
   519         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   520         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   521         16  CR-LF-DEV-CODE                PIC XXX.
   522         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   523
   524         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   525         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   526         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   527         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   528
   529         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   530         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   531         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   532         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   533
   534         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   535         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   536
   537         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   538         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   539
   540         16  CR-LF-REFUND-TYPE             PIC X.
   541         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   542
   543         16  CR-LF-COMM-CHARGEBACK         PIC X.
   544             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   545
   546         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   547
   548         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   549         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   550         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   551
   552         16  cr-ahl-lf-claim-no            pic x(9).
   553         16  cr-ahl-lf-cert-seq            pic x(3).
   554         16  FILLER                        PIC XX.
   555
   556     12  CR-AH-COVERAGE-DATA.
   557         16  CR-AHTYP                      PIC XX.
   558         16  CR-AH-TERM                    PIC S999       COMP-3.
   559         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   560         16  CR-AH-DEV-CODE                PIC XXX.
   561         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   562
   563         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   564         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   565         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   566         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   567
   568         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   569         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   570
   571         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   572         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   573
   574         16  CR-AH-REFUND-TYPE             PIC X.
   575         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   576
   577         16  CR-AH-COMM-CHARGEBACK         PIC X.
   578             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   579
   580         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   581
   582         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   583         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   584         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   585
   586         16  FILLER                        PIC XX.
   587*        16  FILLER                        PIC X(8).
   588
   589     12  CR-LOAN-DATA.
   590         16  CR-LIVES                      PIC S9(7)      COMP-3.
   591         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   592                                           PIC S9(5)V99   COMP-3.
   593         16  CR-BILLED                     PIC S9(7)      COMP-3.
   594         16  CR-APR                        PIC S999V9(4)  COMP-3.
   595         16  CR-PMT-FREQ                   PIC 99.
   596         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   597         16  CR-RATING-CLASS               PIC XX.
   598         16  CR-POLICY-FORM-NO             PIC X(12).
   599         16  CR-GRPTYP                     PIC XX.
   600         16  CR-IND-GRP                    PIC X.
   601             88  CR-INDIVIDUAL                VALUE '1'.
   602             88  CR-GROUP                     VALUE '2'.
   603         16  CR-SKIP                       PIC 99.
   604             88  NO-MONTHS-SKIPPED            VALUE 00.
   605             88  SKIP-JULY                    VALUE 01.
   606             88  SKIP-AUGUST                  VALUE 02.
   607             88  SKIP-SEPTEMBER               VALUE 03.
   608             88  SKIP-JULY-AUG                VALUE 04.
   609             88  SKIP-AUG-SEPT                VALUE 05.
   610             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   611             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   612             88  SKIP-JUNE                    VALUE 08.
   613             88  SKIP-JUNE-JULY               VALUE 09.
   614             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   615             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   616         16  CR-RESIDENT-STATE             PIC XX.
   617         16  CR-RATE-CODE.
   618             20  CR-LF-CLASS-CD            PIC XX.
   619             20  CR-AH-CLASS-CD            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   620         16  CR-MORT.
   621             20  CR-TAB                    PIC X.
   622             20  CR-INT                    PIC 99.
   623             20  CR-GRP                    PIC X.
   624         16  CR-MEMBER-NO                  PIC X(12).
   625         16  CR-OLD-LOF                    PIC XXX.
   626*        16  CR-LOAN-OFFICER               PIC XXX.
   627         16  CR-REIN-TABLE                 PIC XXX.
   628         16  CR-REIN-SPEC                  PIC X.
   629         16  CR-LOAN-1ST-PMT-DT.
   630             20  CR-1ST-PMT-YR             PIC 99.
   631             20  CR-1ST-PMT-MO             PIC 99.
   632             20  CR-1ST-PMT-DA             PIC 99.
   633         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   634         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   635         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   636         16  CR-LAST-ADD-ON-DT             PIC XX.
   637
   638         16  CR-UNDERWRITING-CODE          PIC X.
   639             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   640
   641         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   642         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   643         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   644         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   645
   646     12  CR-STATUS-INFORMATION.
   647         16  CR-ENTRY-STATUS               PIC X.
   648             88  CR-NORMAL-ENTRY              VALUE '1'.
   649             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   650             88  CR-CONVERSION-ENTRY          VALUE '4'.
   651             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   652             88  CR-POLICY-IS-CASH            VALUE 'C'.
   653             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   654             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   655             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   656             88  CR-POLICY-IS-VOID            VALUE 'V'.
   657             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   658             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   659                                                'C' '5' '9' 'P'.
   660         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   661
   662         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   663         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   664         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   665
   666         16  CR-LF-STATUS-AT-DEATH         PIC X.
   667         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   668
   669         16  CR-LF-CURRENT-STATUS          PIC X.
   670             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   671             88  CR-LF-POLICY-PENDING         VALUE '2'.
   672             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   673             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   674             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   675             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   676             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   677             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   678             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   679             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   680             88  CR-LF-IS-DECLINED            VALUE 'D'.
   681             88  CR-LF-IS-VOID                VALUE 'V'.
   682             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   683                                                    '4' '5' '9'.
   684
   685         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   686
   687         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   688         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   689
   690         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   691         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   692
   693         16  CR-AH-CURRENT-STATUS          PIC X.
   694             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   695             88  CR-AH-POLICY-PENDING         VALUE '2'.
   696             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   697             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   698             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   699             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   700             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   701             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   702             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   703             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   704             88  CR-AH-IS-DECLINED            VALUE 'D'.
   705             88  CR-AH-IS-VOID                VALUE 'V'.
   706             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   707                                                    '4' '5' '9'.
   708         16  CR-LOAN-OFFICER               PIC X(5).
   709         16  CR-CANCEL-REASON              PIC X.
   710         16  cr-xycor-lf-cov-code          pic x(4).
   711         16  cr-xycor-ah-cov-code          pic x(4).
   712         16  cr-temp-epiq                  pic x(4).
   713         16  FILLER                        PIC XX.
   714
   715     12  CR-DEATH-CLAIM-DATA.
   716         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   717
   718         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   719         16  CR-DTH-RPT-DT.
   720             20  CR-DTH-RPT-YR             PIC 99.
   721             20  CR-DTH-RPT-MO             PIC 99.
   722             20  CR-DTH-RPT-DA             PIC 99.
   723         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   724
   725         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   726         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   727         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   728         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   729         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   730
   731         16  CR-DTH-AGE                    PIC 99.
   732         16  CR-DTH-PAY-CD                 PIC X.
   733         16  CR-DEATH-CAUSE                PIC X(6).
   734
   735         16  FILLER                        PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   736
   737     12  CR-DISAB-CLAIM-DATA.
   738         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   739
   740         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   741         16  CR-DIS-RPT-DT.
   742             20  CR-DIS-RPT-YR             PIC 99.
   743             20  CR-DIS-RPT-MO             PIC 99.
   744             20  CR-DIS-RPT-DA             PIC 99.
   745         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   746         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   747
   748         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   749         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   750         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   751         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   752         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   753
   754         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   755         16  CR-DIS-PAY-CD                 PIC X.
   756         16  FILLER                        PIC XX.
   757
   758         16  CR-DISAB-INCURRED-DETAIL.
   759             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   760**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   761                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   762                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   763                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   764
   765         16  CR-DISAB-CAUSE                PIC X(6).
   766         16  FILLER                        PIC X(14).
   767
   768     12  CR-REMIT-TO                       PIC 99.
   769
   770     12  CR-COMPENSATION-LEVELS.
   771         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   772             20  CR-COM-AGT.
   773                 24  CR-COM-AGT-PREFIX     PIC X(4).
   774                 24  CR-COM-AGT-PRIME      PIC X(6).
   775             20  CR-AGT-TYPE               PIC X.
   776             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   777             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   778
   779     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   780     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   781     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   782     12  CR-CLP-STATE                      PIC XX.
   783     12  CR-POST-CARD-IND                  PIC X.
   784     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   785     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   786     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   787     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   788     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   789     12  FILLER                            PIC X(07).
   790
   791     12  CR-CSR-CODE                       PIC XXX.
   792
   793     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* EL547ET.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   794     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   795
   796     12  CR-MICROFILM-NUMBERS.
   797*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   798         16  FILLER                        PIC X(5).
   799     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   800
   801     12  CR-USER-CODE                      PIC X.
   802     12  CR-USER-FUTURE                    PIC X(9).
   803
   804     12  CR-BENEFICIARY.
   805         16  CR-BANK-NO                    PIC X(10).
   806         16  FILLER                        PIC X(15).
   807
   808     12  CR-ENTRY-BATCH                    PIC X(6).
   809     12  CR-LF-EXIT-BATCH                  PIC X(6).
   810     12  CR-AH-EXIT-BATCH                  PIC X(6).
   811
   812     12  CR-NOTE-SW                        PIC X.
   813
   814     12  CR-ORIGIN-INDICATOR               PIC X.
   815         88  CR-ENTERED-MANUALLY              VALUE '1'.
   816         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   817
   818     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   819     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   820     12  FILLER                            PIC X(33).
   821
   822******************************************************************
   823
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* EL547ET.cbl
   825 FD  EXTRACT
   826     BLOCK CONTAINS 0 RECORDS
   827     RECORDING MODE IS F.
   828
   829 01  EXTRACT-RECORD-OUT          PIC X(302).
   830 01  EXTRACT-RECORD-OUT-HD       PIC X(400).
   831
   832
   833 FD  DISK-DATE
*  834                                 COPY ELCDTEFD.
   835******************************************************************04/15/98
   836*                                                                *ELCDTEFD
   837*                                                                *ELCDTEFD
   838*                            ELCDTEFD.                           *   LV002
   839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   840*                            VMOD=2.007                          *   CL**2
   841*                                                                *ELCDTEFD
   842******************************************************************ELCDTEFD
   843     BLOCK CONTAINS 0 RECORDS
   844     RECORDING MODE F.                                            ELCDTEFD
   845                                                                  ELCDTEFD
   846 01  DATE-DISK.                                                   ELCDTEFD
   847     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   848     12  FILLER                      PIC  X(14).                  ELCDTEFD
   849     12  DD-CR1                      PIC  9.                      ELCDTEFD
   850     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   851     12  DD-CR2                      PIC  9.                      ELCDTEFD
   852     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   853     12  FILLER                      PIC  X(20).                  ELCDTEFD
   854                                                                  ELCDTEFD
   855 01  DATE-DISK-R.                                                 ELCDTEFD
   856     12  FILLER                      PIC  X(4).                   ELCDTEFD
   857     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   858                                     PIC  X(32).                  ELCDTEFD
   859                                                                  ELCDTEFD
   860 01  DATE-DISK-T.                                                 ELCDTEFD
   861     12  FILLER                      PIC  X(4).                   ELCDTEFD
   862     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   863                                     PIC  X(48).                  ELCDTEFD
   864                                                                  ELCDTEFD
   865 01  DATE-DISK-M.                                                 ELCDTEFD
   866     12  FILLER                      PIC  X(4).                   ELCDTEFD
   867     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   868                                     PIC  X(48).                  ELCDTEFD
   869                                                                  ELCDTEFD
   870 01  DATE-DISK-P.                                                 ELCDTEFD
   871     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   872     12  DD-IDX                      PIC  99.                     ELCDTEFD
   873     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   874     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   875         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   876                                     PIC  X.                      ELCDTEFD
   877         16  FILLER                  PIC  X(46).                  ELCDTEFD
   878     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   879         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   880             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   881             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   882             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   883             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   884         16  FILLER                  PIC  X(16).                  ELCDTEFD
   885                                                                  ELCDTEFD
   886 01  DATE-DISK-E.                                                 ELCDTEFD
   887     12  FILLER                      PIC  X(4).                   ELCDTEFD
   888     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   889                                     PIC  X(4).                   ELCDTEFD
   890                                                                  ELCDTEFD
   891 01  DATE-DISK-C.                                                 ELCDTEFD
   892     12  FILLER                      PIC  X(7).                   ELCDTEFD
   893     12  DD-CARR1-SECPAY-SW          PIC  X.
   894     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   895     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   896     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   897     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   898     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   899     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   900     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   901     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   902     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   903     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   904     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   905     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   906     12  DD-CARR2-SECPAY-SW          PIC  X.
   907     12  FILLER                      PIC  X(7).                   ELCDTEFD
   908                                                                  ELCDTEFD
   909 01  DATE-DISK-OPT.                                               ELCDTEFD
   910     12  FILLER                      PIC  X(04).                  ELCDTEFD
   911     12  DD-TLR-DATA.                                             ELCDTEFD
   912         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   913                                     PIC  X(03).                  ELCDTEFD
   914     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   915         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   916                                     PIC  X(06).                  ELCDTEFD
   917     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   918         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   919                                     PIC  X(07).                  ELCDTEFD
   920         16  FILLER                  PIC  X(05).                  ELCDTEFD
   921     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   922                                     PIC  X(96).                  ELCDTEFD
   923******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* EL547ET.cbl
   925 FD  PRINTX
*  926                                 COPY ELCPRTFD.
   927******************************************************************04/15/98
   928*                                                                *ELCPRTFD
   929*                                                                *ELCPRTFD
   930*                            ELCPRTFD.                           *   LV003
   931*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   932*                            VMOD=2.006                          *ELCPRTFD
   933******************************************************************ELCPRTFD
   934     RECORDING MODE F                                             ELCPRTFD
   935     LABEL RECORDS OMITTED                                        ELCPRTFD
   936     BLOCK CONTAINS 0 RECORDS
   937     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   938 01  PRT.                                                         ELCPRTFD
   939     12  P-CTL               PIC  X.                                 CL**2
   940     12  P-DATA              PIC  X(132).                         ELCPRTFD
   941******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* EL547ET.cbl
   943 WORKING-STORAGE SECTION.
   944 77  FILLER  PIC X(32) VALUE '********************************'.
   945 77  FILLER  PIC X(32) VALUE '     EL547ET  WORKING STORAGE   '.
   946 77  FILLER  PIC X(32) VALUE '********************************'.
   947
   948 77  WS-EOF-SW                   PIC X  VALUE SPACES.
   949     88  THERE-ARE-NO-MORE-RECORDS  VALUE 'Y'.
   950     88  THERE-ARE-MORE-RECORDS     VALUE 'N'.
   951 77  IYR                         PIC S999   COMP-3 VALUE +0.
   952 77  VYR                         PIC S999   COMP-3 VALUE +0.
   953 77  PAGE-CTR                    PIC S9(07) VALUE +0  COMP-3.
   954 77  LINE-CTR                    PIC S9(03) VALUE +99 COMP-3.
   955 77  X                           PIC X      VALUE ' '.
   956 77  WS-CRT-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   957 77  WS-CLM-CNT                  PIC S9(9)  COMP-3 VALUE +0.
   958 77  WS-CRT-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   959 77  WS-CLM-CNT-TOT              PIC S9(9)  COMP-3 VALUE +0.
   960 77  INTERMED                    PIC S9(9)V9(6)  COMP-3.
   961 77  WS-REM-AMT                  PIC S9(11)V99 COMP-3 VALUE +0.
   962 77  LF-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   963 77  AH-REM-TRM1                 PIC S999V99  COMP-3  VALUE +0.
   964 77  LF-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   965 77  AH-REM-TRM2                 PIC S999V99  COMP-3  VALUE +0.
   966 77  REM-TRM1                    PIC S9(3)V99    COMP-3.
   967 77  REM-TRM2                    PIC S9(3)V99    COMP-3.
   968 77  WS-CERT-PREV-ST             PIC S9(7)V99    COMP-3 VALUE +0.
   969 77  WS-CERT-PREV-R78            PIC S9(7)V99    COMP-3 VALUE +0.
   970 77  WS-CERT-PREV-PRO            PIC S9(7)V99    COMP-3 VALUE +0.
   971
   972 01  WS-INIT-EXT-RECORD          PIC X(302)  VALUE LOW-VALUES.
   973
   974 01  WS-EXTRACT-RECORD.
   975     05  EXT-ISSUE-CCYYMM        PIC 9(6).
   976     05  WS-TAB1                 PIC X.
   977     05  EXT-VALUE-CCYYMM        PIC 9(6).
   978     05  WS-TAB2                 PIC X.
   979     05  EXT-LF-INFORCE          PIC ZZZ,ZZZ,ZZZ,ZZ9.99.
   980     05  WS-TAB3                 PIC X.
   981     05  EXT-LF-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   982     05  WS-TAB4                 PIC X.
   983     05  EXT-AH-WRITTEN          PIC ZZZ,ZZZ,ZZ9.99.
   984     05  WS-TAB5                 PIC X.
   985     05  EXT-LF-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   986     05  WS-TAB6                 PIC X.
   987     05  EXT-AH-REFUNDS          PIC ZZZ,ZZZ,ZZ9.99.
   988     05  WS-TAB7                 PIC X.
   989     05  EXT-LF-R78              PIC ZZZ,ZZZ,ZZ9.99.
   990     05  WS-TAB8                 PIC X.
   991     05  EXT-LF-PRO              PIC ZZZ,ZZZ,ZZ9.99.
   992     05  WS-TAB9                 PIC X.
   993     05  EXT-LF-ST               PIC ZZZ,ZZZ,ZZ9.99.
   994     05  WS-TAB10                PIC X.
   995     05  EXT-LF-R78-EP           PIC ZZZ,ZZZ,ZZ9.99.
   996     05  WS-TAB11                PIC X.
   997     05  EXT-LF-PRO-EP           PIC ZZZ,ZZZ,ZZ9.99.
   998     05  WS-TAB12                PIC X.
   999     05  EXT-LF-ST-EP            PIC ZZZ,ZZZ,ZZ9.99.
  1000     05  WS-TAB13                PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* EL547ET.cbl
  1001     05  EXT-AH-R78              PIC ZZZ,ZZZ,ZZ9.99.
  1002     05  WS-TAB14                PIC X.
  1003     05  EXT-AH-PRO              PIC ZZZ,ZZZ,ZZ9.99.
  1004     05  WS-TAB15                PIC X.
  1005     05  EXT-AH-ST               PIC ZZZ,ZZZ,ZZ9.99.
  1006     05  WS-TAB16                PIC X.
  1007     05  EXT-AH-R78-EP           PIC ZZZ,ZZZ,ZZ9.99.
  1008     05  WS-TAB17                PIC X.
  1009     05  EXT-AH-PRO-EP           PIC ZZZ,ZZZ,ZZ9.99.
  1010     05  WS-TAB18                PIC X.
  1011     05  EXT-AH-ST-EP            PIC ZZZ,ZZZ,ZZ9.99.
  1012     05  WS-TAB19                PIC X.
  1013     05  EXT-LF-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
  1014     05  WS-TAB20                PIC X.
  1015     05  EXT-AH-CLAIM            PIC ZZZ,ZZZ,ZZ9.99.
  1016
  1017 01  WS-HEAD-RECORD.
  1018     05  FILLER                  PIC X(8)    VALUE 'ISS DATE'.
  1019     05  WS-HTAB1                PIC X.
  1020     05  FILLER                  PIC X(8)    VALUE 'VAL DATE'.
  1021     05  WS-HTAB2                PIC X.
  1022     05  FILLER                  PIC X(10)   VALUE 'LF INFORCE'.
  1023     05  WS-HTAB3                PIC X.
  1024     05  FILLER                  PIC X(10)   VALUE 'LF WRITTEN'.
  1025     05  WS-HTAB4                PIC X.
  1026     05  FILLER                  PIC X(10)   VALUE 'AH WRITTEN'.
  1027     05  WS-HTAB5                PIC X.
  1028     05  FILLER                  PIC X(10)   VALUE 'LF REFUNDS'.
  1029     05  WS-HTAB6                PIC X.
  1030     05  FILLER                  PIC X(10)   VALUE 'AH REFUNDS'.
  1031     05  WS-HTAB7                PIC X.
  1032     05  FILLER                  PIC X(10)   VALUE 'LF UEP R78'.
  1033     05  WS-HTAB8                PIC X.
  1034     05  FILLER                  PIC X(10)   VALUE 'LF UEP PRO'.
  1035     05  WS-HTAB9                PIC X.
  1036     05  FILLER                  PIC X(9)    VALUE 'LF UEP ST'.
  1037     05  WS-HTAB10               PIC X.
  1038     05  FILLER                  PIC X(9)    VALUE 'LF EP R78'.
  1039     05  WS-HTAB11               PIC X.
  1040     05  FILLER                  PIC X(9)    VALUE 'LF EP PRO'.
  1041     05  WS-HTAB12               PIC X.
  1042     05  FILLER                  PIC X(8)    VALUE 'LF EP ST'.
  1043     05  WS-HTAB13               PIC X.
  1044     05  FILLER                  PIC X(10)   VALUE 'AH UEP R78'.
  1045     05  WS-HTAB14               PIC X.
  1046     05  FILLER                  PIC X(10)   VALUE 'AH UEP PRO'.
  1047     05  WS-HTAB15               PIC X.
  1048     05  FILLER                  PIC X(9)    VALUE 'AH UEP ST'.
  1049     05  WS-HTAB16               PIC X.
  1050     05  FILLER                  PIC X(9)    VALUE 'AH EP R78'.
  1051     05  WS-HTAB17               PIC X.
  1052     05  FILLER                  PIC X(9)    VALUE 'AH EP PRO'.
  1053     05  WS-HTAB18               PIC X.
  1054     05  FILLER                  PIC X(8)    VALUE 'AH EP ST'.
  1055     05  WS-HTAB19               PIC X.
  1056     05  FILLER                  PIC X(9)    VALUE 'LF CLAIMS'.
  1057     05  WS-HTAB20               PIC X.
  1058     05  FILLER                  PIC X(9)    VALUE 'AH CLAIMS'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* EL547ET.cbl
  1059
  1060
  1061
  1062 01  WS-ISSUE-YR-TABLE.
  1063     05  WS-ISSUE         OCCURS 600.
  1064         10  WS-ISSUE-CCYYMM     PIC 9(6).
  1065         10  FILLER              PIC XX.
  1066         10  WS-VALUATION OCCURS 600.
  1067           12  WS-RECORD.
  1068             15  WS-VALUATION-CCYYMM PIC 9(6).
  1069             15  WS-LF-INFORCE   PIC S9(12)V99 COMP-3.
  1070             15  WS-LF-WRITTEN   PIC S9(9)V99 COMP-3.
  1071             15  WS-AH-WRITTEN   PIC S9(9)V99 COMP-3.
  1072             15  WS-LF-REFUNDS   PIC S9(9)V99 COMP-3.
  1073             15  WS-AH-REFUNDS   PIC S9(9)V99 COMP-3.
  1074             15  WS-LF-R78       PIC S9(9)V99 COMP-3.
  1075             15  WS-LF-PRO       PIC S9(9)V99 COMP-3.
  1076             15  WS-LF-ST        PIC S9(9)V99 COMP-3.
  1077             15  WS-LF-R78-EP    PIC S9(9)V99 COMP-3.
  1078             15  WS-LF-PRO-EP    PIC S9(9)V99 COMP-3.
  1079             15  WS-LF-ST-EP     PIC S9(9)V99 COMP-3.
  1080             15  WS-AH-R78       PIC S9(9)V99 COMP-3.
  1081             15  WS-AH-PRO       PIC S9(9)V99 COMP-3.
  1082             15  WS-AH-ST        PIC S9(9)V99 COMP-3.
  1083             15  WS-AH-R78-EP    PIC S9(9)V99 COMP-3.
  1084             15  WS-AH-PRO-EP    PIC S9(9)V99 COMP-3.
  1085             15  WS-AH-ST-EP     PIC S9(9)V99 COMP-3.
  1086             15  WS-LF-CLAIM     PIC S9(9)V99 COMP-3.
  1087             15  WS-AH-CLAIM     PIC S9(9)V99 COMP-3.
  1088
  1089 01  FILLER                  PIC X(400)  VALUE LOW-VALUES.
  1090
  1091 01  WS-DISPLAY-DATE         PIC ZZZ9(8).
  1092 01  WS-DISPLAY-TERM         PIC Z99.
  1093 01  WS-DISPLAY-RTERM        PIC Z99.99.
  1094 01  WS-DISPLAY-AMT          PIC ZZZZZZZ.99.
  1095 01  WS-DISPLAY-RAMT         PIC ZZZZZZZ.99.
  1096 01  WS-DISPLAY-PRM          PIC ZZZZZZZ.99.
  1097 01  WS-DISPLAY-UEP          PIC ZZZZZZZ.99.
  1098 01  WS-BIN-CR-DT            PIC XX  VALUE LOW-VALUES.
  1099 01  WS-BIN-ENTRY-DT         PIC XX  VALUE LOW-VALUES.
  1100 01  WS-BIN-LF-END-DATE      PIC XX  VALUE LOW-VALUES.
  1101 01  WS-BIN-AH-END-DATE      PIC XX  VALUE LOW-VALUES.
  1102 01  FILLER.
  1103     05  WS-END-YEAR             PIC 9(11)  VALUE ZEROS.
  1104     05  FILLER REDEFINES WS-END-YEAR.
  1105         10  FILLER              PIC 999.
  1106         10  WS-CCYYMM           PIC 9(6).
  1107         10  FILLER REDEFINES WS-CCYYMM.
  1108             15  WS-CCYY         PIC 9999.
  1109             15  WS-MM           PIC 99.
  1110         10  WS-DD               PIC 99.
  1111 01  WS-DEBUG-AREA.
  1112     12  WS-DEBUG-SW             PIC X(01) VALUE ' '.
  1113         88  DEBUG-IS-ON                VALUES '1' '2' '3' '4'.
  1114         88  DEBUG-LF-INFORCE-CNT       VALUE '1'.
  1115         88  DEBUG-AH-INFORCE-CNT       VALUE '2'.
  1116         88  DEBUG-LF-STATUTORY         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* EL547ET.cbl
  1117         88  DEBUG-AH-STATUTORY         VALUE '4'.
  1118
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* EL547ET.cbl
  1120
  1121 01  TEXAS-REGS-WORK-AREAS.
  1122     12  TEX-FACT-1              PIC S9(7)V9(2)    COMP-3.
  1123     12  TEX-FACT-2              PIC S9(3)   COMP-3.
  1124     12  TEX-FACT-3              PIC S9(3)   COMP-3.
  1125     12  TEX-FACT-4              PIC S9(7)   COMP-3.
  1126     12  TEX-FACT-5              PIC S9(3)   COMP-3.
  1127     12  TEX-FACT-6              PIC S9(3)   COMP-3.
  1128     12  TEX-FACT-7              PIC S9(7)   COMP-3.
  1129     12  TEX-FACT-8              PIC S9V9(6) COMP-3.
  1130     12  TEX-FACT-9              PIC S9(4)V9(11)   COMP-3.
  1131
  1132*01  NET-PAY-INTERFACE.
  1133*    05  NP-APR                  PIC S9(3)V9(4)    COMP-3.
  1134*    05  NP-ORIG                 PIC S9(3)         COMP-3.
  1135*    05  NP-REM                  PIC S9(3)         COMP-3.
  1136*    05  NP-OPT                  PIC X(01).
  1137*    05  NP-CAP                  PIC S9(3)         COMP-3.
  1138*    05  NP-FACTOR               PIC S9(4)V9(9)    COMP-3.
  1139*    05  NP-WORK1                PIC S9(6)V9(9)    COMP-3.
  1140*    05  NP-WORK2                PIC S9(6)V9(9)    COMP-3.
  1141
  1142 01  WS-ABEND-AREA.
  1143     05  WS-ABEND-FILE-STATUS    PIC X(02).
  1144     05  WS-ABEND-MESSAGE        PIC X(80) VALUE SPACES.
  1145     05  WS-RETURN-CODE          PIC S9(04)  COMP VALUE +0.
  1146     05  WS-ZERO                 PIC S9(01) VALUE +0 COMP-3.
  1147
  1148 01  WORK-ABEND-CODE.
  1149     12  WAC-1                   PIC X.
  1150     12  WAC-2                   PIC X.
  1151     12  WAC-3-4.
  1152         16  WAC-3               PIC X.
  1153         16  WAC-4               PIC X.
  1154
  1155 01  FILLER.
  1156     05  WS-WORK-DATE            PIC 9(11).
  1157     05  FILLER REDEFINES WS-WORK-DATE.
  1158         10  FILLER              PIC XXX.
  1159         10  WS-WORK-CCYYMM      PIC 9(6).
  1160         10  FILLER REDEFINES WS-WORK-CCYYMM.
  1161             15  WS-WORK-CCYY    PIC 9999.
  1162             15  WS-WORK-MM      PIC 99.
  1163         10  WS-WORK-DD          PIC 99.
  1164 01  FILLER.
  1165     05  WS-EFFECT-DATE          PIC 9(11).
  1166     05  FILLER REDEFINES WS-EFFECT-DATE.
  1167         10  FILLER              PIC 999.
  1168         10  WS-EFFECT-CCYYMM     PIC 9(6).
  1169         10  WS-EFFECT-DD        PIC 99.
  1170 01  FILLER.
  1171     05  WS-ENTRY-DATE           PIC 9(11).
  1172     05  FILLER REDEFINES        WS-ENTRY-DATE.
  1173         10  FILLER              PIC 999.
  1174         10  WS-ENTRY-CCYYMM     PIC 9(6).
  1175         10  WS-ENTRY-DD         PIC 99.
  1176 01  FILLER.
  1177     05  WS-CANCEL-DATE          PIC 9(11).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* EL547ET.cbl
  1178     05  FILLER REDEFINES WS-CANCEL-DATE.
  1179         10  FILLER              PIC 999.
  1180         10  WS-CANCEL-CCYYMM    PIC 9(6).
  1181         10  WS-CANCEL-DD        PIC 99.
  1182 01  FILLER.
  1183     05  WS-CLAIM-DATE           PIC 9(11).
  1184     05  FILLER REDEFINES WS-CLAIM-DATE.
  1185         10  FILLER              PIC 999.
  1186         10  WS-CLAIM-CCYYMM     PIC 9(6).
  1187         10  WS-CLAIM-DD         PIC 99.
  1188 01  FILLER.
  1189     05  WS-HI-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1190     05  WS-LO-ISSUE-CCYYMM      PIC 9(6) VALUE ZEROS.
  1191 01  FILLER.
  1192     05  WS-HI-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1193     05  WS-LO-VALUATION-CCYYMM  PIC 9(6) VALUE ZEROS.
  1194     05  FILLER REDEFINES WS-LO-VALUATION-CCYYMM.
  1195         10  WS-LO-VAL-CCYY      PIC 9999.
  1196         10  WS-LO-VAL-MM        PIC 99.
  1197 01  FILLER.
  1198     05  WS-BIN-VAL-DATES OCCURS 600
  1199                                 PIC XX.
  1200
  1201 01  ABEND-FIELDS.
  1202     12  PGM-SUB                 PIC S999 COMP  VALUE +158.
  1203     12  FIRST-TIME-SW           PIC X  VALUE 'Y'.
  1204         88  FIRST-TIME                 VALUE 'Y'.
  1205
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* EL547ET.cbl
* 1207                                 COPY ELCCALC.
  1208******************************************************************04/15/98
  1209*                                                                *ELCCALC
  1210*                           ELCCALC.                            *    LV003
  1211*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1212*                            VMOD=2.025                          *   CL**3
  1213*                                                                *   CL**2
  1214*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1215*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1216*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1217*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1218*                                                                *   CL**2
  1219*  PASSED TO ELRTRM                                              *   CL**2
  1220*  -----------------                                             *   CL**2
  1221*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1222*  ORIGINAL TERM                                                 *   CL**2
  1223*  BEGINNING DATE                                                *   CL**2
  1224*  ENDING DATE                                                   *   CL**2
  1225*  COMPANY I.D.                                                  *   CL**2
  1226*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1227*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1228*  FREE LOOK DAYS                                                *   CL**2
  1229*                                                                *   CL**2
  1230*  RETURNED FROM ELRTRM                                          *   CL**2
  1231*  ---------------------                                         *   CL**2
  1232*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1233*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1234*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1235*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1236*----------------------------------------------------------------*   CL**2
  1237*  PASSED TO ELRAMT                                              *   CL**2
  1238*  ----------------                                              *   CL**2
  1239*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1240*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1241*  ORIGINAL AMOUNT                                               *   CL**2
  1242*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1243*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1244*  METHOD                                                            CL**2
  1245*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1246*  COMPANY I.D.                                                  *   CL**2
  1247*  BENEFIT TYPE                                                  *   CL**2
  1248*                                                                *   CL**2
  1249*  RETURNED FROM ELRAMT                                          *   CL**2
  1250*  --------------------                                          *   CL**2
  1251*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1252*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1253*  REMAINING AMOUNT FACTOR                                           CL**2
  1254*----------------------------------------------------------------*   CL**2
  1255*  PASSED TO ELRESV                                              *   CL**2
  1256*  -----------------                                             *   CL**2
  1257*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1258*  VALUATION DATE                                                *   CL**2
  1259*  PAID THRU DATE                                                *   CL**2
  1260*  BENEFIT                                                       *   CL**2
  1261*  INCURRED DATE                                                 *   CL**2
  1262*  REPORTED DATE                                                 *   CL**2
  1263*  ISSUE AGE                                                     *   CL**2
  1264*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1265*  CDT PERCENT                                                   *   CL**2
  1266*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1267* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1268* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1269* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1270*                                                                *   CL**2
  1271*  RETURNED FROM ELRESV                                          *   CL**2
  1272*  --------------------                                          *   CL**2
  1273*  CDT TABLE USED                                                *   CL**2
  1274*  CDT FACTOR USED                                               *   CL**2
  1275*  PAY TO CURRENT RESERVE                                        *   CL**2
  1276*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1277*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1278*----------------------------------------------------------------*   CL**2
  1279*  PASSED TO ELRATE                                              *   CL**2
  1280*  ----------------                                              *   CL**2
  1281*  CERT ISSUE DATE                                               *   CL**2
  1282*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1283*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1284*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1285*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1286*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1287*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1288*  DEVIATION CODE                                                *   CL**2
  1289*  ISSUE AGE                                                     *   CL**2
  1290*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1291*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1292*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1293*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1294*  A.P.R.                                                        *   CL**2
  1295*  METHOD                                                            CL**2
  1296*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1297*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1298*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1299*  BENEFIT CODE                                                  *   CL**2
  1300*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1301*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1302*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1303*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1304*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1305*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1306*                                                                *   CL**2
  1307*  RETURNED FROM ELRATE                                          *   CL**2
  1308*  --------------------                                          *   CL**2
  1309*  CALCULATED PREMIUM                                            *   CL**2
  1310*  PREMIUM RATE                                                  *   CL**2
  1311*  MORTALITY CODE                                                *   CL**2
  1312*  MAX ATTAINED AGE                                              *   CL**2
  1313*  MAX AGE                                                       *   CL**2
  1314*  MAX TERM                                                      *   CL**2
  1315*  MAX MONTHLY BENEFIT                                           *   CL**2
  1316*  MAX TOTAL BENIFIT                                             *   CL**2
  1317*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1318*----------------------------------------------------------------*   CL**2
  1319*  PASSED TO ELRFND                                              *   CL**2
  1320*  ----------------                                              *   CL**2
  1321*  CERT ISSUE DATE                                               *   CL**2
  1322*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1323*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1324*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1325*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1326*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1327*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1328*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1329*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1330*  DEVIATION CODE                                                *   CL**2
  1331*  ISSUE AGE                                                     *   CL**2
  1332*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1333*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1334*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1335*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1336*  A.P.R.                                                        *   CL**2
  1337*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1338*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1339*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1340*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1341*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1342*  BENEFIT CODE                                                  *   CL**2
  1343*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1344*                                                                *   CL**2
  1345*  RETURNED FROM ELRFND                                          *   CL**2
  1346*  --------------------                                          *   CL**2
  1347*  CALCULATED REFUND                                             *   CL**2
  1348*----------------------------------------------------------------*   CL**2
  1349*  PASSED TO ELEARN                                              *   CL**2
  1350*  ----------------                                              *   CL**2
  1351*  CERT ISSUE DATE                                               *   CL**2
  1352*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1353*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1354*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1355*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1356*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1357*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1358*  DEVIATION CODE                                                *   CL**2
  1359*  ISSUE AGE                                                     *   CL**2
  1360*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1361*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1362*  A.P.R.                                                        *   CL**2
  1363*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1364*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1365*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1366*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1367*  BENEFIT CODE                                                  *   CL**2
  1368*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1369*                                                                *   CL**2
  1370*  RETURNED FROM ELEARN                                          *   CL**2
  1371*  --------------------                                          *   CL**2
  1372*  INDICATED  EARNINGS                                           *   CL**2
  1373*----------------------------------------------------------------*   CL**2
  1374*                 LENGTH = 450                                   *   CL**2
  1375*                                                                *   CL**2
  1376******************************************************************   CL**2
  1377******************************************************************
  1378*                   C H A N G E   L O G
  1379*
  1380* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1381*-----------------------------------------------------------------
  1382*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1383* EFFECTIVE    NUMBER
  1384*-----------------------------------------------------------------
  1385* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1386* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1387* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1388* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1389* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1390* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1391* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1392* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1393* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1394* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1395******************************************************************
  1396                                                                     CL**2
  1397 01  CALCULATION-PASS-AREA.                                          CL**2
  1398     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1399                                     COMP.                           CL**2
  1400                                                                     CL**2
  1401     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1402       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1403       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1404                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1405       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1406       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1407       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1408       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1409       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1410       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1411       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1412       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1413       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1414       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1415       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1416       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1417       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1418       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1419       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1420       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1421       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1422                                                                     CL**2
  1423     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1424       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1425***********************  INPUT AREAS ****************************    CL**2
  1426                                                                     CL**2
  1427     12  CP-CALCULATION-AREA.                                        CL**2
  1428         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1429         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1430         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1431         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1432         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1433           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1434                                                   'I' 'U'.          CL**2
  1435           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1436           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1437         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1438         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1439         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1440         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1441         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1442                                     COMP-3.                         CL**2
  1443         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1444                                     COMP-3.                         CL**2
  1445         16  CP-CDT-METHOD         PIC X.                            CL**2
  1446           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1447           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1448           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1449         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1450           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1451           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1452         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1453                                     COMP-3.                         CL**2
  1454         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1455                                     COMP-3.                         CL**2
  1456         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1457                                     COMP-3.                         CL**2
  1458         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1459                                     COMP-3.                         CL**2
  1460         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1461                                     COMP-3.                         CL**2
  1462         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1463                                     COMP-3.                         CL**2
  1464         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1465                                     COMP-3.                         CL**2
  1466         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1467           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1468           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1469           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1470           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1471           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1472           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1473           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1474         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1475           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1476           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1477           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1478           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1479           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1480           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1481           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1482           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1483           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1484           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1485           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1486           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1487           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1488           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1489         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1490           88  CP-CLAIM                            VALUE '1'.        CL**2
  1491           88  CP-CANCEL                           VALUE '2'.        CL**2
  1492           88  CP-ISSUE                            VALUE '3'.        CL**2
  1493         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1494           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1495           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1496           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1497           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1498           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1499           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1500           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1501           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1502           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1503           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1504           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1505           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1506           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1507           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1508           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1509           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1510           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1511           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1512                                                     'W' 'X'.        CL**2
  1513           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1514           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1515           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1516           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1517           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1518           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1519           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1520           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1521           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1522           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1523           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1524           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1525           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1526                                                                     CL**2
  1527         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1528                                     COMP-3.                         CL**2
  1529         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1530         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1531         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1532         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1533         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1534           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1535               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1536         16  CP-R78-OPTION         PIC X.                            CL**2
  1537           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1538           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1539                                                                     CL**2
  1540         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1541         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1542         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1543         16  CP-RATE-FILE          PIC X.                            CL**2
  1544         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1545                                     COMP-3.                         CL**2
  1546                                                                     CL**2
  1547         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1548         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1549                                                                     CL**2
  1550         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1551                                     COMP-3.
  1552         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1553                                   PIC S9(5)V99 COMP-3.
  1554         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1555                                     COMP-3.                         CL**2
  1556         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1557                                     COMP-3.                         CL**2
  1558         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1559                                     COMP-3.
  1560         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1561                                  PIC S9(7)V99 COMP-3.
  1562                                                                     CL**2
  1563         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1564         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1565         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1566           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1567           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1568           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1569           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1570         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1571         16  CP-CARRIER            PIC X.                            CL**2
  1572         16  CP-REIN-FLAG          PIC X.                            CL**2
  1573         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1574           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1575                      '2' '3' '4' '5'.                               CL**2
  1576           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1577           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1578           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1579           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1580           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1581           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1582           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1583           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1584         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1585         16  CP-RATING-METHOD      PIC X.                            CL**2
  1586           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1587           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1588           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1589           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1590           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1591           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1592           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1593           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1594           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1595         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1596                                     COMP-3.                         CL**2
  1597         16  CP-BEN-CATEGORY       PIC X.
  1598         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1599         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1600                                   PIC S99V9(5) COMP-3.
  1601         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1602         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1603                                   PIC S99V9(5) COMP-3.
  1604         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1605         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  1606         16  CP-EXPIRE-DT          PIC XX.
  1607         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  1608         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  1609         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  1610         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  1611         16  CP-DDF-SPEC-CALC      PIC X.
  1612             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1613             88  CP-CALC-CLP              VALUE 'C'.
  1614         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  1615         16  CP-CANCEL-REASON      PIC X.
  1616         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  1617         16  CP-PMT-MODE           PIC X.
  1618         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  1619         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  1620         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  1621         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  1622         16  FILLER                PIC X.
  1623                                                                     CL**2
  1624***************    OUTPUT FROM ELRESV   ************************     CL**2
  1625                                                                     CL**2
  1626         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  1627                                                                     CL**2
  1628         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  1629                                     COMP-3.                         CL**2
  1630         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  1631                                     COMP-3.                         CL**2
  1632         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  1633                                     COMP-3.                         CL**2
  1634         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  1635                                     COMP-3.                         CL**2
  1636         16  FILLER                PIC X(09).                        CL**2
  1637***************    OUTPUT FROM ELRTRM   *************************    CL**2
  1638                                                                     CL**2
  1639         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  1640                                     COMP-3.                         CL**2
  1641         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  1642                                     COMP-3.                         CL**2
  1643         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  1644                                     COMP-3.                         CL**2
  1645         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  1646                                     COMP-3.                         CL**2
  1647         16  FILLER                PIC X(12).                        CL**2
  1648                                                                     CL**2
  1649***************    OUTPUT FROM ELRAMT   *************************    CL**2
  1650                                                                     CL**2
  1651         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  1652                                     COMP-3.                         CL**2
  1653         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  1654                                     COMP-3.                         CL**2
  1655         16  FILLER                PIC X(12).                        CL**2
  1656                                                                     CL**2
  1657***************    OUTPUT FROM ELRATE   *************************    CL**2
  1658                                                                     CL**2
  1659         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  1660                                     COMP-3.                         CL**2
  1661         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  1662                                     COMP-3.                         CL**2
  1663         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  1664         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  1665             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  1666         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  1667                                     COMP-3.                         CL**2
  1668         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  1669         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  1670         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1671                                   PIC S9(7)V99 COMP-3.
  1672         16  FILLER                PIC X(07).                        CL**2
  1673                                                                     CL**2
  1674***************    OUTPUT FROM ELRFND   *************************    CL**2
  1675                                                                     CL**2
  1676         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  1677                                     COMP-3.                         CL**2
  1678         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  1679           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  1680           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  1681           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  1682           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  1683           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1684           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  1685           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  1686           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  1687           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1688           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  1689           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  1690           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  1691           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  1692           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  1693         16  FILLER                PIC X(12).                        CL**2
  1694                                                                     CL**2
  1695***************    OUTPUT FROM ELEARN   *************************    CL**2
  1696                                                                     CL**2
  1697         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  1698                                     COMP-3.                         CL**2
  1699         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  1700                                     COMP-3.                         CL**2
  1701         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  1702                                     COMP-3.                         CL**2
  1703         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  1704                                     COMP-3.                         CL**2
  1705         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1706                                     COMP-3.                         CL**2
  1707         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1708                                     COMP-3.                         CL**2
  1709         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1710           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1711           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1712           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1713           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1714           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1715           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1716           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1717           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1718           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1719         16  FILLER                PIC X(12).                        CL**2
  1720                                                                     CL**2
  1721***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1722                                                                     CL**2
  1723         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1724                                     COMP-3.                         CL**2
  1725         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1726                                     COMP-3.                         CL**2
  1727         16  FILLER                PIC X(12).                        CL**2
  1728                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1729***************   MISC WORK AREAS    *****************************   CL**2
  1730         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1731                                     COMP-3.                         CL**2
  1732         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1733                                     COMP-3.                         CL**2
  1734         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1735                                     COMP-3.                         CL**2
  1736         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1737                                     COMP-3.                         CL**2
  1738         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1739                                     COMP-3.                         CL**2
  1740         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1741                                     COMP-3.                         CL**2
  1742         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1743             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1744             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1745             88  IO-ERROR                         VALUE 'E'.         CL**2
  1746                                                                     CL**2
  1747         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1748                                                                     CL**2
  1749         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1750                                                                     CL**2
  1751         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1752                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1753                                     COMP-3.                         CL**2
  1754                                                                     CL**2
  1755         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1756                                                                     CL**2
  1757         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1758                                     COMP-3.                         CL**2
  1759                                                                     CL**2
  1760         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1761                                     COMP-3.                         CL**2
  1762                                                                     CL**2
  1763         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1764                                     COMP-3.                         CL**2
  1765                                                                     CL**2
  1766         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1767                                     COMP-3.                         CL**2
  1768                                                                     CL**2
  1769         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1770                                     COMP-3.                         CL**2
  1771                                                                     CL**2
  1772         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1773                                     COMP-3.                         CL**2
  1774                                                                     CL**2
  1775         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1776                                     COMP-3.                         CL**2
  1777                                                                     CL**2
  1778         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1779             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1780                                                                     CL**2
  1781         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1782                                     COMP-3.                         CL**2
  1783         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1784                                     COMP-3.
  1785         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  1786         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1787         16  cp-net-only-state     pic x value spaces.
  1788         16  FILLER                PIC X(13).                        CL**2
  1789******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* EL547ET.cbl
  1790/
* 1791                                 COPY ELCDATE.
  1792******************************************************************06/11/98
  1793*                                                                *ELCDATE
  1794*                                                                *ELCDATE
  1795*                            ELCDATE.                            *   LV023
  1796*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1797*                            VMOD=2.003                           ELCDATE
  1798*                                                                *ELCDATE
  1799*                                                                *ELCDATE
  1800*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1801*                 LENGTH = 200                                   *   CL*19
  1802******************************************************************ELCDATE
  1803                                                                  ELCDATE
  1804 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1805     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1806     12  DC-OPTION-CODE                PIC X.                        CL*15
  1807         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1808         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1809         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1810         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1811         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1812         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1813         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1814         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1815         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1816         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1817         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1818         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1819         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1820         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1821         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1822         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1823         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1824         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1825         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1826         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1827         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1828         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1829         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1830         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1831         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1832         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1833         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1834         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1835         88  THREE-CHARACTER-BIN                                  ELCDATE
  1836                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1837         88  GREGORIAN-TO-BIN                                        CL**2
  1838                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1839         88  BIN-TO-GREGORIAN                                        CL**2
  1840                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1841         88  JULIAN-TO-BINARY                                        CL**2
  1842                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1843     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1844         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1845         88  DATE-CONVERSION-ERROR                                ELCDATE
  1846                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1847         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1848         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1849         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1850         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1851         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1852         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1853         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1854         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1855         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1856         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1857     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1858         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1859     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1860         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1861         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1862         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1863     12  FILLER                        PIC X.                        CL*15
  1864     12  DC-CONVERSION-DATES.                                        CL*15
  1865         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1866         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1867         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1868         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1869                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1870             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1871             20  SLASH1-1              PIC X.                        CL*15
  1872             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1873             20  SLASH1-2              PIC X.                        CL*15
  1874             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1875         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1876         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1877                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1878             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1879             20  SLASH2-1              PIC X.                        CL*15
  1880             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1881             20  SLASH2-2              PIC X.                        CL*15
  1882             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1883         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1884         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1885                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1886             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1887             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1888             20  DC-YMD-DAY            PIC 99.                       CL*15
  1889         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1890         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1891                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1892             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1893             20  DC-MDY-DAY            PIC 99.                       CL*15
  1894             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1895         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1896             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1897             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1898             20  FILLER                PIC XX.                       CL*15
  1899             20  DC-ALPHA-CENTURY.                                   CL*15
  1900                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1901             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1902         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1903         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1904         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1905         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1906         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1907                                       PIC 9(05).                    CL*20
  1908         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1909             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1910             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1911         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1912         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1913         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1914     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1915         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1916         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1917             20  FILLER                PIC 9(3).                     CL*15
  1918             20  HOLD-CEN-1-CCYY.                                    CL*15
  1919                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1920                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1921             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1922             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1923         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1924             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1925             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1926             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1927                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1928                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1929             20  FILLER                PIC 9(3).                     CL*15
  1930         16  HOLD-CENTURY-1-X.                                       CL*15
  1931             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1932             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1933                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1934                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1935             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1936             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1937         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1938             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1939             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1940             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1941                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1942                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1943             20  FILLER                PIC XXX.                      CL*23
  1944         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1945         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1946         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1947         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1948             20  DC-JULIAN-1-CCYY.                                   CL*15
  1949                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1950                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1951             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1952         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1953         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1954             20  DC-JULIAN-2-CCYY.                                   CL*15
  1955                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1956                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1957             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1958         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1959             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1960             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1961             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1962             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1963             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1964                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1965                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1966         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1967             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1968             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1969             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1970             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1971             20  DC-EDITB-CCYY.                                      CL*15
  1972                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1973                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1974         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1975         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1976                              DC-GREG-DATE-CYMD.                  ELCDATE
  1977             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1978             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1979             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1980             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1981         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1982         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1983                              DC-GREG-DATE-MDCY.                  ELCDATE
  1984             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1985             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1986             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1987             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1988    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1989        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1990    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1991    12  FILLER                         PIC X(28).                    CL*26
* 1992                                 COPY ELCFUNDT.
  1993***************************************************************** 12/03/98
  1994*                                                               * ELCFUNDT
  1995*                            ELCFUNDT.                          *    LV004
  1996*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  1997*                            VMOD=2.001                         * ELCFUNDT
  1998*                                                               * ELCFUNDT
  1999*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  2000*                                                               * ELCFUNDT
  2001***************************************************************** ELCFUNDT
  2002                                                                  ELCFUNDT
  2003                                                                  ELCFUNDT
  2004 01  FUNCTION-DATE.                                                  CL**2
  2005     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  2006     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  2007         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  2008         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  2009             15  WS-FN-CC          PIC 99.                           CL**3
  2010             15  WS-FN-YR          PIC 99.                           CL**3
  2011         10  WS-FN-MO              PIC 99.                           CL**3
  2012         10  WS-FN-DA              PIC 99.                           CL**3
  2013     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  2014     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  2015     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  2016     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  2017     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  2018         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  2019         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  2020         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  2021     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* EL547ET.cbl
  2022     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
  2023
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* EL547ET.cbl
  2024/
* 2025                                 COPY ELCDTECX.
  2026******************************************************************06/05/98
  2027*                                                                *ELCDTECX
  2028*                            ELCDTECX.                           *   LV005
  2029*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2030*                            VMOD=2.015                          *ELCDTECX
  2031*                                                                *ELCDTECX
  2032*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2033*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2034*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2035*                                                                *ELCDTECX
  2036******************************************************************ELCDTECX
  2037******************************************************************
  2038*                   C H A N G E   L O G
  2039*
  2040* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2041*-----------------------------------------------------------------
  2042*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2043* EFFECTIVE    NUMBER
  2044*-----------------------------------------------------------------
  2045* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2046*                                  BENEFIT CODES FROM 300 TO 900
  2047* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2048* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2049* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2050******************************************************************
  2051 01  DATE-CARD.                                                   ELCDTECX
  2052     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2053     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2054     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2055     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2056     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2057     12  EP-SW                       PIC  X.                      ELCDTECX
  2058         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2059     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2060         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2061     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2062     12  RUN-CENTURY.                                             ELCDTECX
  2063         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2064     12  FILLER                      PIC  X.                         CL**4
  2065     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2066     12  FILLER                      PIC  XXX.                    ELCDTECX
  2067     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2068                                                                  ELCDTECX
  2069 01  FILLER                          PIC  X(7)                       CL**6
  2070                                          VALUE 'OPTIONS'.        ELCDTECX
  2071 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2072     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2073     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2074     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2075         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2076         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2077     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2078     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2079     12  FILLER                      PIC  X.                      ELCDTECX
  2080     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2081     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2082     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  2083     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2084     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  2085     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2086     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2087     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2088     12  FILLER                      PIC  X.                      ELCDTECX
  2089     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2090     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2091     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2092     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2093     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2094     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2095     12  FILLER                      PIC  X.                      ELCDTECX
  2096     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2097     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2098     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2099     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2100     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2101     12  DTE-R78                     PIC  X.                      ELCDTECX
  2102     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2103     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2104     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2105     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2106     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2107     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2108     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2109                                     PIC  X.                      ELCDTECX
  2110         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2111                                                 ' '.             ELCDTECX
  2112         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2113         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2114     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2115         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2116         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2117     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2118     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2119                                     PIC  9.                         CL**4
  2120     12  DTE-SYSTEM.                                              ELCDTECX
  2121         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2122         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2123         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2124         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2125         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2126         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2127         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  2128         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  2129         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  2130         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  2131         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  2132         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  2133         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  2134         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  2135         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  2136         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  2137         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  2138         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  2139         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2140         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  2141         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  2142         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  2143         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  2144         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  2145         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  2146         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  2147     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  2148         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  2149                                     PIC  X.                      ELCDTECX
  2150     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  2151                                                                  ELCDTECX
  2152 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  2153     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  2154     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  2155     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  2156*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  2157     12  FILLER                      PIC  X.                      ELCDTECX
  2158     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  2159     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  2160     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  2161     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  2162     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  2163     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  2164     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  2165                                                                  ELCDTECX
  2166     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  2167     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  2168     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  2169     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  2170                                                                  ELCDTECX
  2171     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  2172     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  2173     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  2174     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  2175                                                                  ELCDTECX
  2176     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  2177     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  2178                                                                  ELCDTECX
  2179     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  2180     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  2181                                                                  ELCDTECX
  2182     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  2183                                                                  ELCDTECX
  2184 01  DATE-CARD-FACTORS.                                           ELCDTECX
  2185     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  2186     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  2187     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  2188     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  2189     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  2190     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  2191     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  2192                                                                  ELCDTECX
  2193 01  FILLER                          PIC  X(12)                   ELCDTECX
  2194                                          VALUE 'COMPANY NAME'.   ELCDTECX
  2195 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  2196     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  2197         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2198         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  2199                                                                  ELCDTECX
  2200 01  FILLER                          PIC  X(11)                   ELCDTECX
  2201                                          VALUE 'STATE NAMES'.    ELCDTECX
  2202 01  STATE-NAMES.                                                 ELCDTECX
  2203     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  2204         16  STATE-SUB               PIC  XX.                     ELCDTECX
  2205         16  STATE-PIC1.                                          ELCDTECX
  2206             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  2207             20  FILLER              PIC  XXX.                    ELCDTECX
  2208             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  2209             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  2210             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  2211             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2212                                                                  ELCDTECX
  2213 01  FILLER                          PIC  X(13)                   ELCDTECX
  2214                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2215 01  CARRIER-NAMES.                                               ELCDTECX
  2216     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2217         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2218         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2219         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2220         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2221         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2222         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2223*        16  FILLER                  PIC  X.                      ELCDTECX
  2224         16  CARRIER-SEC-PAY         PIC  X.
  2225             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2226                                                                  ELCDTECX
  2227 01  FILLER                          PIC  X(9)                       CL**6
  2228                                          VALUE 'INS TYPES'.      ELCDTECX
  2229 01  CLAS-INS-TYPES.                                              ELCDTECX
  2230*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2231     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2232         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2233         16  CLAS-I-AB3.                                          ELCDTECX
  2234             20  FILLER              PIC  X.                      ELCDTECX
  2235             20  CLAS-I-AB2.                                      ELCDTECX
  2236                 24  FILLER          PIC  X.                      ELCDTECX
  2237                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2238         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2239             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2240             20  FILLER              PIC  X.                         CL**4
  2241         16  CLAS-I-AB10.                                         ELCDTECX
  2242             20  FILLER              PIC  X(9).                   ELCDTECX
  2243             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2244         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2245         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2246         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2247         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2248             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2249         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2250         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2251         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2252         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2253         16  CLAS-I-REFUND-METHOD    PIC  X.
  2254         16  CLAS-I-MAX-BENEFITS     PIC 99.
  2255         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2256                                                                  ELCDTECX
  2257 01  FILLER                          PIC  X(16)                   ELCDTECX
  2258                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2259 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2260     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2261                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2262         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2263         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2264         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2265         16  CLAS-MORT-DESC.                                      ELCDTECX
  2266             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2267             20  FILLER              PIC  XX.                        CL**5
  2268             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2269             20  FILLER              PIC  X.                         CL**5
  2270             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2271             20  FILLER              PIC  X.                         CL**5
  2272             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2273             20  FILLER              PIC  X.                         CL**5
  2274             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2275             20  FILLER              PIC  X(5).                      CL**6
  2276                                                                  ELCDTECX
  2277 01  FILLER                          PIC  X(15)                   ELCDTECX
  2278                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2279 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2280     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2281         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2282         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2283         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2284         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2285         16  FILLER                  PIC  X(4).                      CL**6
  2286                                                                  ELCDTECX
  2287 01  FILLER                          PIC  X(7)                       CL**6
  2288                                     VALUE 'INDEXES'.             ELCDTECX
  2289 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2290     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2291     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2292     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2293     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2294     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2295     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2296     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2297     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2298     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2299     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2300     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2301     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2302     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2303     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2304     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2305     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2306     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2307                                                                  ELCDTECX
  2308 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2309     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2310     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2311     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2312     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  2313     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2314     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2315     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2316     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2317     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2318     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2319     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2320                                                                  ELCDTECX
  2321 01  FILLER                          PIC  X(13)                   ELCDTECX
  2322                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2323 01  CLAS-MISC.                                                   ELCDTECX
  2324     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2325         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2326         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2327         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2328     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2329     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2330     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2331     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2332     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2333     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2334     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2335     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2336     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2337     12  STATE-L                     PIC  XX.                     ELCDTECX
  2338     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2339     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2340     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2341         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2342         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2343     12  DTE-ABEND-WORK.                                          ELCDTECX
  2344         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2345         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2346                                                                  ELCDTECX
  2347 01  FILLER                          PIC  X(12)                   ELCDTECX
  2348                                     VALUE 'WORKING DATE'.        ELCDTECX
  2349 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2350     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2351         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2352         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2353         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2354     12  WS-CURRENT-DATE.                                         ELCDTECX
  2355         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2356         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2357         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2358         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2359         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2360     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2361         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2362         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2363                                                                  ELCDTECX
  2364 01  FILLER                          PIC  X(12)                   ELCDTECX
  2365                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2366 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2367     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2368         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2369         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2370         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2371                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2372 01  FILLER                          PIC  X(10)                   ELCDTECX
  2373                                     VALUE 'STATE TLRS'.          ELCDTECX
  2374 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2375     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2376         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2377         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2378                                                                  ELCDTECX
  2379 01  FILLER                          PIC  X(13)                   ELCDTECX
  2380                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2381 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2382     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2383         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2384                                                                  ELCDTECX
  2385 01  FILLER                          PIC  X(13)                   ELCDTECX
  2386                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2387 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2388     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2389     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2390     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2391                                     PIC  X.                         CL**5
  2392     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2393     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2394     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2395     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2396     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2397     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2398     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2399     12  FILLER                      PIC  X(75).                  ELCDTECX
  2400******************************************************************ELCDTECX
  2401*01  MISC-CARR-PCT-DATA.                                          00001521
  2402*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2403*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2404*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2405*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2406*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2407*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2408******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* EL547ET.cbl
  2409/
* 2410                                 COPY ELCDTEVR.
  2411***************************************************************** 04/15/98
  2412*                                                                *ELCDTEVR
  2413*                                                                *ELCDTEVR
  2414*                            ELCDTEVR.                           *   LV003
  2415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2416*                            VMOD=2.001                          *   CL**2
  2417*                                                                *ELCDTEVR
  2418*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2419*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2420*                                                                *ELCDTEVR
  2421******************************************************************ELCDTEVR
  2422 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2423     05  WS-RUN-DATE.                                             ELCDTEVR
  2424         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2425         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2426         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2427             15  RUN-CC              PIC  99.                     ELCDTEVR
  2428             15  RUN-YR              PIC  99.                     ELCDTEVR
  2429         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2430         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2431     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2432            WS-RUN-DATE              PIC 9(11).                      CL**2
  2433     05  WS-EP-DT.                                                ELCDTEVR
  2434         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2435         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2436         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2437             15  EP-CC               PIC  99.                     ELCDTEVR
  2438             15  EP-YR               PIC  99.                     ELCDTEVR
  2439         10  EP-MO                   PIC  99.                     ELCDTEVR
  2440         10  EP-DA                   PIC  99.                     ELCDTEVR
  2441     05  WS-EP-DT-N REDEFINES                                        CL**2
  2442            WS-EP-DT                 PIC 9(11).                      CL**2
  2443     05  WS-DTE-CONV-DT.                                             CL**4
  2444         10  FILLER                  PIC  9(03).                     CL**4
  2445         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2446         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2447             15  DTE-CONV-CC         PIC  99.                        CL**4
  2448             15  DTE-CONV-YR         PIC  99.                        CL**4
  2449         10  DTE-CONV-MO             PIC  99.                        CL**4
  2450         10  DTE-CONV-DA             PIC  99.                        CL**4
  2451     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2452            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2453 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2454     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2455         10  FILLER                            PIC 999.           ELCDTEVR
  2456         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2457         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2458             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2459             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2460         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2461         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2462     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2463            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2464     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2465         10  FILLER                            PIC 999.           ELCDTEVR
  2466         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2467         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2468         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2469         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2470     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2471            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2472 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2473     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2474         10  FILLER                            PIC 999.           ELCDTEVR
  2475         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2476         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2477             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2478             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2479         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2480         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2481     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2482            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2483     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2484         10  FILLER                            PIC 999.           ELCDTEVR
  2485         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2486         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2487             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2488             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2489         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2490         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2491     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2492            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2493     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2494         10  FILLER                            PIC 999.           ELCDTEVR
  2495         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2496         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2497             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2498             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2499         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2500         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2501     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2502            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2503 01  WS-RATE-RECORD.                                              ELCDTEVR
  2504         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2505             10  FILLER                        PIC 999.           ELCDTEVR
  2506             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2507             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2508                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2509                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2510             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2511             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2512         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2513                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* EL547ET.cbl
  2514/
  2515 PROCEDURE DIVISION.
  2516
  2517 0001-DT-CRD-READ SECTION.
* 2518                                 COPY ELCDTERX.
  2519******************************************************************04/15/98
  2520*                                                                *ELCDTERX
  2521*                                                                *ELCDTERX
  2522*                            ELCDTERX.                           *   LV002
  2523*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2524*                            VMOD=2.007                          *ELCDTERX
  2525*                                                                *ELCDTERX
  2526*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2527*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2528*      = ELCDTEFD)                                               *ELCDTERX
  2529*                                                                *ELCDTERX
  2530******************************************************************ELCDTERX
  2531                                                                  ELCDTERX
  2532     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2533                                                                  ELCDTERX
  2534     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2535     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2536     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2537                                                                  ELCDTERX
  2538     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2539                                                                  ELCDTERX
  2540******************************************************************ELCDTERX
  2541*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2542*          WARNING MESSAGES.                                      ELCDTERX
  2543******************************************************************ELCDTERX
  2544     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2545         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2546                                                                  ELCDTERX
  2547     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2548                                                                  ELCDTERX
  2549     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2550                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2551                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2552                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2553                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2554                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2555                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2556                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2557                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2558                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2559                                                                  ELCDTERX
  2560     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2561                                                                  ELCDTERX
  2562     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2563                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2564                                                                  ELCDTERX
  2565     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2566     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2567     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2568     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2569                                                                  ELCDTERX
  2570     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2571         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2572     ELSE                                                         ELCDTERX
  2573         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2574                                                                  ELCDTERX
  2575     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2576         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2577     ELSE                                                         ELCDTERX
  2578         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2579                                                                  ELCDTERX
  2580 0005-READ--CARD.                                                 ELCDTERX
  2581     READ DISK-DATE                                               ELCDTERX
  2582         AT END CLOSE DISK-DATE                                   ELCDTERX
  2583             GO TO 0060-READ--TEST.                               ELCDTERX
  2584                                                                  ELCDTERX
  2585     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2586                                                                  ELCDTERX
  2587     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2588         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2589         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2590         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2591         GO TO 0005-READ--CARD.                                   ELCDTERX
  2592                                                                  ELCDTERX
  2593     IF DD-ID = 'CLAD'                                            ELCDTERX
  2594         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2595         GO TO 0005-READ--CARD.                                   ELCDTERX
  2596                                                                  ELCDTERX
  2597     IF DD-ID = 'CLAX'                                            ELCDTERX
  2598         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2599         GO TO 0005-READ--CARD.                                   ELCDTERX
  2600                                                                  ELCDTERX
  2601     IF DD-ID = 'CLAF'                                            ELCDTERX
  2602         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2603         GO TO 0005-READ--CARD.                                   ELCDTERX
  2604                                                                  ELCDTERX
  2605     IF DD-ID = 'CLAC'                                            ELCDTERX
  2606         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2607                                                                  ELCDTERX
  2608     IF DD-ID = 'CARR'                                            ELCDTERX
  2609         GO TO 0015-READ--CARR.                                   ELCDTERX
  2610                                                                  ELCDTERX
  2611     IF DD-ID = 'STAT'                                            ELCDTERX
  2612         GO TO 0020-READ--STAT.                                   ELCDTERX
  2613                                                                  ELCDTERX
  2614     IF DD-ID = 'BUSC'                                            ELCDTERX
  2615         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2616                                                                  ELCDTERX
  2617     IF DD-ID = 'MORT'                                            ELCDTERX
  2618         GO TO 0030-READ--MORT.                                   ELCDTERX
  2619                                                                  ELCDTERX
  2620     IF DD-ID = 'CLAI'                                            ELCDTERX
  2621         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2622                                                                  ELCDTERX
  2623     IF DD-ID = 'COLC'                                            ELCDTERX
  2624         GO TO 0065-READ--COLC.                                   ELCDTERX
  2625                                                                  ELCDTERX
  2626     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2627        DD-IDA = 'CL'                                             ELCDTERX
  2628         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2629                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2630     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2631        DD-IDA = 'PO'                                             ELCDTERX
  2632         GO TO 0050-READ--POXX.                                   ELCDTERX
  2633                                                                  ELCDTERX
  2634     IF DD-ID = 'OPCA'                                            ELCDTERX
  2635         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2636                                                                  ELCDTERX
  2637     IF DD-ID = 'OPST'                                            ELCDTERX
  2638         GO TO 0072-READ--OPST.                                   ELCDTERX
  2639                                                                  ELCDTERX
  2640     IF DD-ID = 'OPBS'                                            ELCDTERX
  2641         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2642                                                                  ELCDTERX
  2643     IF DD-ID = 'OPMS'                                            ELCDTERX
  2644         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2645                                                                  ELCDTERX
  2646     GO TO 0005-READ--CARD.                                       ELCDTERX
  2647                                                                  ELCDTERX
  2648 0010-READ--CLAC.                                                 ELCDTERX
  2649     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2650     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2651     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2652     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2653     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2654     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2655     GO TO 0005-READ--CARD.                                       ELCDTERX
  2656                                                                  ELCDTERX
  2657 0015-READ--CARR.                                                 ELCDTERX
  2658     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2659     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2660        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2661        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2662        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2663        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2664        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2665        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2666        MOVE DD-CARR1-SECPAY-SW
  2667                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2668     END-IF
  2669                                                                  ELCDTERX
  2670     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2671     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2672        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2673        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2674        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2675        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2676        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2677        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2678        MOVE DD-CARR2-SECPAY-SW
  2679                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2680     END-IF
  2681                                                                  ELCDTERX
  2682                                                                  ELCDTERX
  2683     GO TO 0005-READ--CARD.                                       ELCDTERX
  2684                                                                  ELCDTERX
  2685 0020-READ--STAT.                                                 ELCDTERX
  2686     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2687     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2688        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2689         GO TO 0005-READ--CARD.                                   ELCDTERX
  2690                                                                  ELCDTERX
  2691     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2692     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2693     GO TO 0020-READ--STAT.                                       ELCDTERX
  2694                                                                  ELCDTERX
  2695 0025-READ--BUSC.                                                 ELCDTERX
  2696     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2697     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2698        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2699         GO TO 0005-READ--CARD.                                   ELCDTERX
  2700                                                                  ELCDTERX
  2701     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2702     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2703     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2704                                                                  ELCDTERX
  2705 0030-READ--MORT.                                                 ELCDTERX
  2706     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2707     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2708        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2709         GO TO 0005-READ--CARD.                                   ELCDTERX
  2710                                                                  ELCDTERX
  2711     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2712     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2713     GO TO 0030-READ--MORT.                                       ELCDTERX
  2714                                                                  ELCDTERX
  2715 0035-READ--CLXX.                                                 ELCDTERX
  2716     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2717          GO TO 0005-READ--CARD.                                  ELCDTERX
  2718                                                                  ELCDTERX
  2719     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2720         DISPLAY '***********************************************'ELCDTERX
  2721         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2722         DISPLAY '***********************************************'ELCDTERX
  2723         GO TO 0055-READ--STOP.                                   ELCDTERX
  2724                                                                  ELCDTERX
  2725     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2726        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2727         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2728                                                                  ELCDTERX
  2729     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2730        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2731         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2732                                                                  ELCDTERX
  2733*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2734     GO TO 0005-READ--CARD.                                       ELCDTERX
  2735                                                                  ELCDTERX
  2736 0040-READ--CLAI.                                                 ELCDTERX
  2737     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2738     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2739        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2740         GO TO 0005-READ--CARD.                                   ELCDTERX
  2741                                                                  ELCDTERX
  2742     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2743     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2744     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2745                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2746 0045-READ--DUMP.                                                 ELCDTERX
  2747     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2748     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2749                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2750     PERFORM ABEND-PGM.                                           ELCDTERX
  2751                                                                  ELCDTERX
  2752 0050-READ--POXX.                                                 ELCDTERX
  2753     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2754         GO TO 0005-READ--CARD.                                   ELCDTERX
  2755                                                                  ELCDTERX
  2756     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2757         DISPLAY '***********************************************'ELCDTERX
  2758         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2759         DISPLAY '***********************************************'ELCDTERX
  2760         GO TO 0055-READ--STOP.                                   ELCDTERX
  2761                                                                  ELCDTERX
  2762     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2763     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2764     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2765     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2766                                                                  ELCDTERX
  2767     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2768         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2769     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2770         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2771                                                                  ELCDTERX
  2772     GO TO 0005-READ--CARD.                                       ELCDTERX
  2773                                                                  ELCDTERX
  2774 0055-READ--STOP.                                                 ELCDTERX
  2775     GOBACK.                                                      ELCDTERX
  2776                                                                  ELCDTERX
  2777 0060-READ--TEST.                                                 ELCDTERX
  2778     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2779        CLAX-ID         = SPACE  OR                               ELCDTERX
  2780        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2781         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2782                                                                  ELCDTERX
  2783     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2784     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2785                                                                  ELCDTERX
  2786 0065-READ--COLC.                                                 ELCDTERX
  2787     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2788     GO TO 0005-READ--CARD.                                       ELCDTERX
  2789                                                                  ELCDTERX
  2790 0070-READ--OPCA.                                                 ELCDTERX
  2791                                                                  ELCDTERX
  2792     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2793                                                                  ELCDTERX
  2794     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2795             OR                                                   ELCDTERX
  2796         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2797         GO TO 0005-READ--CARD.                                   ELCDTERX
  2798                                                                  ELCDTERX
  2799     ADD 1                       TO INDEXCA.                      ELCDTERX
  2800     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2801                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2802     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2803                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* EL547ET.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2804 0072-READ--OPST.                                                 ELCDTERX
  2805                                                                  ELCDTERX
  2806     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2807                                                                  ELCDTERX
  2808     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2809             OR                                                   ELCDTERX
  2810         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2811         GO TO 0005-READ--CARD.                                   ELCDTERX
  2812                                                                  ELCDTERX
  2813     ADD 1                       TO INDEXST.                      ELCDTERX
  2814     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2815                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2816     GO TO 0072-READ--OPST.                                       ELCDTERX
  2817                                                                  ELCDTERX
  2818 0074-READ--OPBS.                                                 ELCDTERX
  2819                                                                  ELCDTERX
  2820     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2821                                                                  ELCDTERX
  2822     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2823             OR                                                   ELCDTERX
  2824         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2825         GO TO 0005-READ--CARD.                                   ELCDTERX
  2826                                                                  ELCDTERX
  2827     ADD 1                       TO INDEXBS.                      ELCDTERX
  2828     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2829     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2830                                                                  ELCDTERX
  2831 0079-READ--EXIT.                                                 ELCDTERX
  2832*    EXIT.                                                        ELCDTERX
  2833******************************************************************ELCDTERX
  2834
  2835     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  2836     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  2837     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  2838
  2839
  2840     PERFORM 0010-INITIALIZE     THRU 0010-EXIT
  2841
  2842     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
  2843
  2844     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT
  2845
  2846     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
  2847
  2848
  2849     GOBACK
  2850     .
  2851
  2852 0010-INITIALIZE.
  2853
  2854*    DISPLAY ' MADE IT TO 0010 '
  2855     MOVE RUN-DATE               TO WS-WORK-DATE
  2856
  2857     MOVE 200001                 TO WS-LO-ISSUE-CCYYMM
  2858                                    WS-LO-VALUATION-CCYYMM
  2859     MOVE WS-WORK-CCYYMM         TO WS-HI-ISSUE-CCYYMM
  2860     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2861            (IYR > +600) OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* EL547ET.cbl
  2862            (WS-ISSUE-CCYYMM (IYR) > WS-HI-ISSUE-CCYYMM)
  2863        MOVE WS-LO-VALUATION-CCYYMM TO WS-ISSUE-CCYYMM (IYR)
  2864        ADD +1 TO WS-LO-VALUATION-CCYYMM
  2865        IF WS-LO-VAL-MM > 12
  2866           MOVE 01               TO WS-LO-VAL-MM
  2867           ADD 1                 TO WS-LO-VAL-CCYY
  2868        END-IF
  2869     END-PERFORM
  2870
  2871     MOVE WS-LO-ISSUE-CCYYMM     TO WS-LO-VALUATION-CCYYMM
  2872                                    WS-WORK-CCYYMM
  2873
  2874     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2875            VYR > +600
  2876          PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2877             IYR > +600
  2878             MOVE WS-WORK-CCYYMM TO WS-VALUATION-CCYYMM (IYR VYR)
  2879          END-PERFORM
  2880        MOVE WS-WORK-CCYYMM      TO WS-CCYYMM
  2881
  2882        IF WS-MM = 01 OR 03 OR 05 OR 07 OR 08 OR 10 OR 12
  2883           MOVE 31               TO WS-DD
  2884        ELSE
  2885           IF WS-MM = 04 OR 06 OR 09 OR 11
  2886              MOVE 30            TO WS-DD
  2887           ELSE
  2888              MOVE 01            TO WS-DD
  2889              MOVE WS-END-YEAR   TO DC-GREG-DATE-CYMD
  2890              MOVE 'L'           TO DC-OPTION-CODE
  2891              PERFORM 8510-DATE-CONVERSION
  2892                                 THRU 8590-EXIT
  2893              IF NO-CONVERSION-ERROR
  2894*                DISPLAY ' FEB DAYS ' DC-DAYS-IN-MONTH
  2895                 MOVE DC-DAYS-IN-MONTH
  2896                                 TO WS-DD
  2897              ELSE
  2898                 DISPLAY ' PROBLEMOS WITH FEB VAL DTE CONV '
  2899                 PERFORM ABEND-PGM
  2900              END-IF
  2901           END-IF
  2902        END-IF
  2903
  2904        MOVE WS-END-YEAR         TO DC-GREG-DATE-CYMD
  2905        MOVE 'L'                 TO DC-OPTION-CODE
  2906        PERFORM 8510-DATE-CONVERSION
  2907                                 THRU 8590-EXIT
  2908        MOVE DC-BIN-DATE-1       TO WS-BIN-VAL-DATES (VYR)
  2909        ADD 1                    TO WS-WORK-CCYYMM
  2910        IF WS-WORK-MM > 12
  2911           MOVE 01               TO WS-WORK-MM
  2912           ADD 1                 TO WS-WORK-CCYY
  2913        END-IF
  2914     END-PERFORM
  2915
  2916     SUBTRACT +1 FROM WS-WORK-CCYYMM
  2917     IF WS-WORK-MM = ZEROS
  2918        MOVE 12                  TO WS-WORK-MM
  2919        SUBTRACT 1               FROM WS-WORK-CCYY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* EL547ET.cbl
  2920     END-IF
  2921     MOVE WS-WORK-CCYYMM         TO WS-HI-VALUATION-CCYYMM
  2922
  2923     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  2924         IYR > +600
  2925         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  2926            VYR > +600
  2927            MOVE +0              TO WS-LF-INFORCE (IYR VYR)
  2928                                    WS-LF-WRITTEN (IYR VYR)
  2929                                    WS-AH-WRITTEN (IYR VYR)
  2930                                    WS-LF-REFUNDS (IYR VYR)
  2931                                    WS-AH-REFUNDS (IYR VYR)
  2932                                    WS-LF-R78     (IYR VYR)
  2933                                    WS-LF-PRO     (IYR VYR)
  2934                                    WS-LF-ST      (IYR VYR)
  2935                                    WS-LF-R78-EP  (IYR VYR)
  2936                                    WS-LF-PRO-EP  (IYR VYR)
  2937                                    WS-LF-ST-EP   (IYR VYR)
  2938                                    WS-AH-R78     (IYR VYR)
  2939                                    WS-AH-PRO     (IYR VYR)
  2940                                    WS-AH-ST      (IYR VYR)
  2941                                    WS-AH-R78-EP  (IYR VYR)
  2942                                    WS-AH-PRO-EP  (IYR VYR)
  2943                                    WS-AH-ST-EP   (IYR VYR)
  2944                                    WS-LF-CLAIM   (IYR VYR)
  2945                                    WS-AH-CLAIM   (IYR VYR)
  2946         END-PERFORM
  2947     END-PERFORM
  2948
  2949     MOVE SPACES                 TO WS-EXTRACT-RECORD
  2950     MOVE ';'                    TO WS-TAB1
  2951                                    WS-TAB2
  2952                                    WS-TAB3
  2953                                    WS-TAB4
  2954                                    WS-TAB5
  2955                                    WS-TAB6
  2956                                    WS-TAB7
  2957                                    WS-TAB8
  2958                                    WS-TAB9
  2959                                    WS-TAB10
  2960                                    WS-TAB11
  2961                                    WS-TAB12
  2962                                    WS-TAB13
  2963                                    WS-TAB14
  2964                                    WS-TAB15
  2965                                    WS-TAB16
  2966                                    WS-TAB17
  2967                                    WS-TAB18
  2968                                    WS-TAB19
  2969                                    WS-TAB20
  2970     MOVE WS-EXTRACT-RECORD      TO WS-INIT-EXT-RECORD
  2971
  2972     MOVE ';'                    TO WS-HTAB1
  2973                                    WS-HTAB2
  2974                                    WS-HTAB3
  2975                                    WS-HTAB4
  2976                                    WS-HTAB5
  2977                                    WS-HTAB6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* EL547ET.cbl
  2978                                    WS-HTAB7
  2979                                    WS-HTAB8
  2980                                    WS-HTAB9
  2981                                    WS-HTAB10
  2982                                    WS-HTAB11
  2983                                    WS-HTAB12
  2984                                    WS-HTAB13
  2985                                    WS-HTAB14
  2986                                    WS-HTAB15
  2987                                    WS-HTAB16
  2988                                    WS-HTAB17
  2989                                    WS-HTAB18
  2990                                    WS-HTAB19
  2991                                    WS-HTAB20
  2992
  2993
  2994     DISPLAY '  LO ISSUE  ' WS-LO-ISSUE-CCYYMM
  2995           '    HI ISSUE  ' WS-HI-ISSUE-CCYYMM
  2996     DISPLAY '  LO VALUE  ' WS-LO-VALUATION-CCYYMM
  2997           '    HI VALUE  ' WS-HI-VALUATION-CCYYMM
  2998
  2999     .
  3000
  3001 0010-EXIT.
  3002     EXIT.
  3003
  3004 0020-OPEN-FILES.
  3005
  3006     DISPLAY ' MADE IT TO 0020 '
  3007     OPEN INPUT CERTS CLMS-HIST
  3008         OUTPUT EXTRACT
  3009
  3010     .
  3011
  3012 0020-EXIT.
  3013     EXIT.
  3014
  3015 0030-CLOSE-FILES.
  3016     DISPLAY ' MADE IT TO 0030 '
  3017
  3018     CLOSE CERTS CLMS-HIST
  3019         EXTRACT
  3020
  3021     .
  3022
  3023 0030-EXIT.
  3024     EXIT.
  3025
  3026 0050-PROCESS-FILE.
  3027
  3028*    DISPLAY ' MADE IT TO 0050 '
  3029     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3030     PERFORM 0080-PROCESS-CERT   THRU 0080-EXIT UNTIL
  3031           THERE-ARE-NO-MORE-RECORDS
  3032
  3033     DISPLAY ' FINISHED CERTS '
  3034
  3035     SET THERE-ARE-MORE-RECORDS TO TRUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* EL547ET.cbl
  3036
  3037     PERFORM 0070-READ-CLMS      THRU 0070-EXIT UNTIL
  3038         (THERE-ARE-NO-MORE-RECORDS) OR
  3039         ((DE-REIN = SPACES) AND
  3040         (DE-CLAIM))
  3041
  3042     DISPLAY ' POSITIONED CLAIMS '
  3043
  3044     IF NOT THERE-ARE-NO-MORE-RECORDS
  3045        PERFORM 0090-PROCESS-CLMS
  3046                                 THRU 0090-EXIT UNTIL
  3047           THERE-ARE-NO-MORE-RECORDS
  3048     END-IF
  3049
  3050     DISPLAY ' FINISHED CLMS  '
  3051
  3052     PERFORM 0500-EMPTY-TABLE    THRU 0500-EXIT
  3053
  3054     .
  3055
  3056 0050-EXIT.
  3057     EXIT.
  3058
  3059 0060-READ-CERT.
  3060
  3061*    DISPLAY ' MADE IT TO 0060 '
  3062     READ CERTS AT END
  3063         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  3064     END-READ
  3065
  3066     IF NOT THERE-ARE-NO-MORE-RECORDS
  3067        ADD +1                   TO WS-CRT-CNT
  3068                                    WS-CRT-CNT-TOT
  3069        IF WS-CRT-CNT = +10000
  3070           DISPLAY ' CERTS READ ' WS-CRT-CNT-TOT
  3071           MOVE +0               TO WS-CRT-CNT
  3072        END-IF
  3073        IF CR-CERT-NO = '0000109489 '
  3074           DISPLAY ' FOUND BAD CERT '
  3075        END-IF
  3076     END-IF
  3077
  3078     .
  3079
  3080 0060-EXIT.
  3081     EXIT.
  3082
  3083 0070-READ-CLMS.
  3084
  3085*    DISPLAY ' MADE IT TO 0070 '
  3086     READ CLMS-HIST AT END
  3087         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  3088     END-READ
  3089
  3090     IF NOT THERE-ARE-NO-MORE-RECORDS
  3091        ADD +1                   TO WS-CLM-CNT
  3092                                    WS-CLM-CNT-TOT
  3093        IF WS-CLM-CNT = +10000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* EL547ET.cbl
  3094           DISPLAY ' CLMS  READ ' WS-CLM-CNT-TOT
  3095           MOVE +0               TO WS-CLM-CNT
  3096        END-IF
  3097     END-IF
  3098
  3099     .
  3100
  3101 0070-EXIT.
  3102     EXIT.
  3103
  3104 0080-PROCESS-CERT.
  3105
  3106*    DISPLAY ' MADE IT TO 0080 '
  3107     MOVE CR-DT                  TO WS-EFFECT-DATE
  3108     MOVE CR-ENTRY-DATE          TO WS-ENTRY-DATE
  3109
  3110     IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  3111        (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM) OR
  3112        (CR-ENTRY-STATUS = '9' OR 'D' OR 'V' OR 'M')
  3113        CONTINUE
  3114     ELSE
  3115        PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3116           WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  3117        END-PERFORM
  3118        PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3119           WS-ENTRY-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3120        END-PERFORM
  3121        IF CR-ENTRY-STATUS = '5'
  3122           CONTINUE
  3123        ELSE
  3124           IF CR-LFTYP NOT = '00' AND '  '
  3125             COMPUTE WS-LF-WRITTEN (IYR VYR) =
  3126               WS-LF-WRITTEN (IYR VYR) +
  3127               CR-LFPRM + CR-LFPRM-ALT
  3128           END-IF
  3129           COMPUTE WS-AH-WRITTEN (IYR VYR) =
  3130               WS-AH-WRITTEN (IYR VYR) + CR-AHPRM
  3131        END-IF
  3132        IF (CR-LFTYP NOT = '00' AND '  ')
  3133           AND (CR-LF-CANCEL-EXIT-DATE > 19991231)
  3134           IF CR-LFRFND NOT NUMERIC
  3135              MOVE +0            TO CR-LFRFND
  3136           END-IF
  3137           MOVE CR-LF-CANCEL-EXIT-DATE    TO WS-CANCEL-DATE
  3138           PERFORM VARYING VYR FROM IYR BY +1 UNTIL
  3139              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3140           END-PERFORM
  3141           COMPUTE WS-LF-REFUNDS (IYR VYR) =
  3142                 WS-LF-REFUNDS (IYR VYR) + CR-LFRFND
  3143        END-IF
  3144        IF (CR-AHTYP NOT = '00' AND '  ')
  3145           AND (CR-AH-CANCEL-EXIT-DATE > 19991231)
  3146           IF CR-AHRFND NOT NUMERIC
  3147              MOVE +0            TO CR-AHRFND
  3148           END-IF
  3149           MOVE CR-AH-CANCEL-EXIT-DATE    TO WS-CANCEL-DATE
  3150           PERFORM VARYING VYR FROM IYR BY +1 UNTIL
  3151              WS-CANCEL-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* EL547ET.cbl
  3152           END-PERFORM
  3153           COMPUTE WS-AH-REFUNDS (IYR VYR) =
  3154                 WS-AH-REFUNDS (IYR VYR) + CR-AHRFND
  3155        END-IF
  3156        IF CR-ENTRY-STATUS NOT = '5'
  3157           PERFORM 0200-CALC-UEP    THRU 0200-EXIT
  3158        END-IF
  3159     END-IF
  3160
  3161     PERFORM 0060-READ-CERT      THRU 0060-EXIT
  3162
  3163     .
  3164
  3165 0080-EXIT.
  3166     EXIT.
  3167
  3168 0090-PROCESS-CLMS.
  3169
  3170*    DISPLAY ' MADE IT TO 0090 '
  3171*    MOVE DE-EFF                 TO WS-EFFECT-DATE
  3172     MOVE DE-ENTRY-DTE           TO WS-EFFECT-DATE
  3173     MOVE DE-CLM-PROC-DT         TO WS-CLAIM-DATE
  3174*    MOVE DE-PAY                 TO WS-CLAIM-DATE
  3175*    MOVE DE-INCUR               TO WS-CLAIM-DATE
  3176
  3177     IF (DE-REIN = ' ') AND
  3178        (DE-TRANS = 'X')
  3179     IF (DE-CLM-PROC-DT > RUN-DATE)
  3180        CONTINUE
  3181     ELSE
  3182        IF (WS-EFFECT-CCYYMM < WS-LO-ISSUE-CCYYMM) OR
  3183           (WS-EFFECT-CCYYMM > WS-HI-ISSUE-CCYYMM)
  3184           CONTINUE
  3185        ELSE
  3186           PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3187              WS-EFFECT-CCYYMM = WS-ISSUE-CCYYMM (IYR)
  3188           END-PERFORM
  3189           PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3190              WS-CLAIM-CCYYMM = WS-VALUATION-CCYYMM (IYR VYR)
  3191           END-PERFORM
  3192           IF DE-DEATH
  3193              COMPUTE WS-LF-CLAIM (IYR VYR) =
  3194                     WS-LF-CLAIM (IYR VYR) +
  3195                     DE-CLAIM-AMT
  3196           ELSE
  3197              COMPUTE WS-AH-CLAIM (IYR VYR) =
  3198                     WS-AH-CLAIM (IYR VYR) +
  3199                     DE-CLAIM-AMT
  3200           END-IF
  3201        END-IF
  3202     END-IF
  3203     END-IF
  3204
  3205     PERFORM 0070-READ-CLMS      THRU 0070-EXIT
  3206
  3207     .
  3208
  3209 0090-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* EL547ET.cbl
  3210     EXIT.
  3211
  3212 0200-CALC-UEP.
  3213
  3214*    DISPLAY ' MADE IT TO 0200 '
  3215     IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3216        CONTINUE
  3217     ELSE
  3218        PERFORM VARYING CLAS-INDEXS FROM +1 BY +1 UNTIL
  3219            (CLAS-INDEXS > CLAS-MAXS) OR
  3220            CR-STATE = STATE-SUB (CLAS-INDEXS)
  3221        END-PERFORM
  3222        IF CR-STATE = STATE-SUB (CLAS-INDEXS)
  3223           CONTINUE
  3224        ELSE
  3225           DISPLAY 'STATE ' CR-STATE ' NOT IN TABLE'
  3226           MOVE 0302 TO WS-RETURN-CODE
  3227           PERFORM ABEND-PGM
  3228        END-IF
  3229     END-IF
  3230
  3231     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  3232     MOVE 'L'                    TO DC-OPTION-CODE
  3233     PERFORM 8510-DATE-CONVERSION
  3234                                 THRU 8590-EXIT
  3235     MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
  3236                                    WS-BIN-CR-DT
  3237
  3238     MOVE CR-ENTRY-DATE          TO DC-GREG-DATE-CYMD
  3239     MOVE 'L'                    TO DC-OPTION-CODE
  3240     PERFORM 8510-DATE-CONVERSION
  3241                                 THRU 8590-EXIT
  3242     MOVE DC-BIN-DATE-1          TO WS-BIN-ENTRY-DT
  3243
  3244     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  3245        MOVE ZEROS               TO CR-LOAN-1ST-PMT-DT
  3246     END-IF
  3247
  3248     MOVE LOW-VALUES             TO CP-FIRST-PAY-DATE
  3249
  3250     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  3251        MOVE CR-LOAN-1ST-PMT-DT  TO DC-GREG-DATE-1-YMD
  3252        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  3253                                    DC-ELAPSED-DAYS
  3254        MOVE '3'                 TO DC-OPTION-CODE
  3255        PERFORM 8510-DATE-CONVERSION
  3256                                 THRU 8590-EXIT
  3257        IF NO-CONVERSION-ERROR
  3258           MOVE DC-BIN-DATE-1   TO CP-FIRST-PAY-DATE
  3259        ELSE
  3260           MOVE ZEROS           TO CR-LOAN-1ST-PMT-DT
  3261        END-IF
  3262      END-IF
  3263
  3264     IF CP-FIRST-PAY-DATE  LESS THAN  CP-CERT-EFF-DT
  3265        MOVE ZEROS  TO  CR-LOAN-1ST-PMT-DT
  3266     END-IF
  3267
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* EL547ET.cbl
  3268     IF CR-LOAN-1ST-PMT-DT = ZEROS
  3269        MOVE CP-CERT-EFF-DT      TO DC-BIN-DATE-1
  3270        MOVE +1                  TO DC-ELAPSED-MONTHS
  3271        MOVE ZEROS               TO DC-ELAPSED-DAYS
  3272        MOVE '6'                 TO DC-OPTION-CODE
  3273        PERFORM 8510-DATE-CONVERSION
  3274                                 THRU 8590-EXIT
  3275        MOVE DC-BIN-DATE-2       TO CP-FIRST-PAY-DATE
  3276        MOVE DC-GREG-DATE-1-YMD  TO CR-LOAN-1ST-PMT-DT
  3277     END-IF
  3278
  3279     MOVE CR-LF-EXPIRE-DATE          TO WS-WORK-DATE
  3280
  3281     IF (CR-LF-CANCEL-EXIT-DATE NOT = ZEROS) AND
  3282        (CR-LF-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3283        MOVE CR-LF-CANCEL-EXIT-DATE
  3284                                 TO WS-WORK-DATE
  3285     END-IF
  3286
  3287     IF (CR-LF-CLAIM-EXIT-DATE NOT = ZEROS) AND
  3288        (CR-LF-CLAIM-EXIT-DATE < WS-WORK-DATE)
  3289        MOVE CR-LF-CLAIM-EXIT-DATE   TO WS-WORK-DATE
  3290     END-IF
  3291
  3292     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3293     MOVE 'L'                    TO DC-OPTION-CODE
  3294     PERFORM 8510-DATE-CONVERSION
  3295                                 THRU 8590-EXIT
  3296     MOVE DC-BIN-DATE-1          TO WS-BIN-LF-END-DATE
  3297
  3298     MOVE CR-AH-EXPIRE-DATE          TO WS-WORK-DATE
  3299
  3300     IF (CR-AH-CANCEL-EXIT-DATE NOT = ZEROS) AND
  3301        (CR-AH-CANCEL-EXIT-DATE < WS-WORK-DATE)
  3302        MOVE CR-AH-CANCEL-EXIT-DATE
  3303                                 TO WS-WORK-DATE
  3304     END-IF
  3305
  3306     IF (CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS) AND
  3307        (CR-AH-SETTLEMENT-EXIT-DATE < WS-WORK-DATE)
  3308        MOVE CR-AH-SETTLEMENT-EXIT-DATE
  3309                                     TO WS-WORK-DATE
  3310     END-IF
  3311
  3312     MOVE WS-WORK-DATE           TO DC-GREG-DATE-CYMD
  3313     MOVE 'L'                    TO DC-OPTION-CODE
  3314     PERFORM 8510-DATE-CONVERSION
  3315                                 THRU 8590-EXIT
  3316     MOVE DC-BIN-DATE-1          TO WS-BIN-AH-END-DATE
  3317
  3318
  3319     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE
  3320     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV
  3321     MOVE '3'                        TO CP-PROCESS-TYPE
  3322     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD
  3323     MOVE DTE-CLIENT                 TO CP-COMPANY-ID
  3324     MOVE SPACES                     TO CP-ACCT-FLD-5
  3325     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* EL547ET.cbl
  3326
  3327     IF CR-LFTYP = '00' OR '  '
  3328        CONTINUE
  3329     ELSE
  3330        PERFORM 0210-CALC-LIFE-UEP   THRU 0210-EXIT
  3331     END-IF
  3332
  3333     IF CR-AHTYP = '00' OR '  '
  3334        CONTINUE
  3335     ELSE
  3336        PERFORM 0410-CALC-AH-UEP   THRU 0410-EXIT
  3337     END-IF
  3338
  3339     .
  3340
  3341 0200-EXIT.
  3342     EXIT.
  3343
  3344 0210-CALC-LIFE-UEP.
  3345
  3346*    DISPLAY ' MADE IT TO 0210 '
  3347     IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3348        CONTINUE
  3349     ELSE
  3350        PERFORM VARYING CLAS-INDEXL FROM +1 BY +1 UNTIL
  3351            (CLAS-INDEXL = CLAS-MAXL) OR
  3352            (CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL))
  3353        END-PERFORM
  3354        IF CR-LFTYP = CLAS-I-BEN (CLAS-INDEXL)
  3355           CONTINUE
  3356        ELSE
  3357           DISPLAY 'LIFE BENEFIT ' CR-LFTYP ' NOT IN TABLE'
  3358           DISPLAY 'RETURN CODE - 0401'
  3359           MOVE 0401 TO WS-RETURN-CODE
  3360           PERFORM ABEND-PGM
  3361        END-IF
  3362     END-IF
  3363
  3364     COMPUTE WS-CERT-PREV-R78 = CR-LFPRM + CR-LFPRM-ALT
  3365     MOVE WS-CERT-PREV-R78       TO WS-CERT-PREV-PRO
  3366                                    WS-CERT-PREV-ST
  3367
  3368     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3369         (VYR > +600) OR
  3370*        (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3371         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-ENTRY-DT)
  3372     END-PERFORM
  3373
  3374     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  3375        CONTINUE
  3376     ELSE
  3377       PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3378         (VYR > +600) OR
  3379         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-LF-END-DATE)
  3380
  3381        PERFORM 0220-CALC-LF-REM-TERM
  3382                                 THRU 0220-EXIT
  3383        MOVE ZEROS               TO WS-REM-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* EL547ET.cbl
  3384        IF LF-REM-TRM2 > ZERO
  3385           PERFORM 2000-CALC-REM-AMT
  3386                                 THRU 2999-CALC-REM-AMT-X
  3387        END-IF
  3388        COMPUTE WS-LF-INFORCE (IYR VYR) =
  3389            WS-LF-INFORCE (IYR VYR) + WS-REM-AMT
  3390        PERFORM 0230-CALC-LF-UEP THRU 0230-EXIT
  3391       END-PERFORM
  3392     END-IF
  3393
  3394     .
  3395
  3396 0210-EXIT.
  3397     EXIT.
  3398
  3399 0220-CALC-LF-REM-TERM.
  3400
  3401*    DISPLAY ' MADE IT TO 0220 '
  3402     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3403
  3404     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3405                                 TO CP-BENEFIT-TYPE
  3406     MOVE CLAS-I-BAL (CLAS-INDEXL)
  3407                                 TO CP-SPECIAL-CALC-CD
  3408     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3409                                    CP-LOAN-TERM
  3410
  3411     IF ((CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L') AND
  3412        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L')
  3413        ADD +1                   TO CP-ORIGINAL-TERM
  3414                                    CP-LOAN-TERM
  3415     END-IF
  3416
  3417     IF CP-TERM-IS-DAYS
  3418        MOVE CR-LF-TERM-IN-DAYS  TO CP-TERM-OR-EXT-DAYS
  3419     ELSE
  3420        MOVE ZEROS               TO CP-TERM-OR-EXT-DAYS
  3421     END-IF
  3422
  3423     MOVE DTE-REM-TRM-CALC-OPTION
  3424                                 TO CP-REM-TRM-CALC-OPTION
  3425
  3426     PERFORM 0510-GET-REMAINING-TERM
  3427                                 THRU 0510-EXIT
  3428
  3429     IF ((CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L') AND
  3430          CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L')
  3431*       MOVE CP-REMAINING-TERM-2 TO LF-BAL-REMTERM
  3432        COMPUTE CP-REMAINING-TERM-1 =
  3433                       CP-REMAINING-TERM-1 - 1
  3434        COMPUTE CP-REMAINING-TERM-2 =
  3435                       CP-REMAINING-TERM-2 - 1
  3436     END-IF
  3437
  3438     IF CP-REMAINING-TERM-1 NEGATIVE
  3439         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3440     END-IF
  3441
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* EL547ET.cbl
  3442     IF CP-REMAINING-TERM-2 NEGATIVE
  3443         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3444     END-IF
  3445
  3446     MOVE CP-REMAINING-TERM-1    TO LF-REM-TRM1
  3447     MOVE CP-REMAINING-TERM-2    TO LF-REM-TRM2
  3448
  3449     .
  3450
  3451 0220-EXIT.
  3452     EXIT.
  3453
  3454 0230-CALC-LF-UEP.
  3455
  3456*    DISPLAY ' MADE IT TO 0230 '
  3457     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM
  3458     MOVE CR-LF-TERM             TO CP-ORIGINAL-TERM
  3459     MOVE LF-REM-TRM1            TO CP-REMAINING-TERM
  3460     MOVE CLAS-I-EP (CLAS-INDEXL)
  3461                                 TO CP-EARNING-METHOD
  3462     MOVE CR-LFPRM-ALT           TO CP-ALTERNATE-PREMIUM
  3463     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3464                                 TO CP-BENEFIT-TYPE
  3465     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3466                                 TO CP-SPECIAL-CALC-CD
  3467     MOVE CR-LFTYP               TO CP-BENEFIT-CD
  3468     MOVE LIFE-OVERRIDE-L1       TO CP-LIFE-OVERRIDE-CODE
  3469
  3470     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3471
  3472     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3473
  3474     MOVE DTE-R78                TO CP-R78-OPTION
  3475     MOVE SPACES                 TO CP-ACCT-FLD-5
  3476     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3477     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3478     MOVE CR-APR                 TO CP-LOAN-APR
  3479     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3480     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3481     MOVE CR-CARRIER             TO CP-CARRIER
  3482
  3483     IF CR-RATING-CLASS NOT = SPACE AND ZERO
  3484        MOVE CR-RATING-CLASS     TO CP-CLASS-CODE
  3485     END-IF
  3486
  3487     MOVE STATE-SUB (CLAS-INDEXS)
  3488                                 TO CP-STATE
  3489     MOVE STATE-ABBR (CLAS-INDEXS)
  3490                                 TO CP-STATE-STD-ABBRV
  3491     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3492     MOVE CR-PMT-EXTENSION-DAYS  TO CP-TERM-OR-EXT-DAYS
  3493
  3494     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3495
  3496     COMPUTE WS-LF-ST  (IYR VYR) =
  3497             WS-LF-ST  (IYR VYR) + CP-STATE-U-PRM
  3498
  3499     COMPUTE WS-LF-R78 (IYR VYR) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* EL547ET.cbl
  3500             WS-LF-R78 (IYR VYR) + CP-R78-U-PRM
  3501*            + CP-R78-U-PRM-ALT
  3502
  3503     COMPUTE WS-LF-PRO (IYR VYR) =
  3504             WS-LF-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3505*            + CP-PRORATA-U-PRM-ALT
  3506
  3507     COMPUTE WS-LF-ST-EP (IYR VYR) =
  3508             WS-LF-ST-EP (IYR VYR) + (WS-CERT-PREV-ST
  3509             - CP-STATE-U-PRM)
  3510
  3511     COMPUTE WS-LF-R78-EP (IYR VYR) =
  3512             WS-LF-R78-EP (IYR VYR) + (WS-CERT-PREV-R78
  3513             - CP-R78-U-PRM)
  3514
  3515     COMPUTE WS-LF-PRO-EP (IYR VYR) =
  3516             WS-LF-PRO-EP (IYR VYR) + (WS-CERT-PREV-PRO
  3517             - CP-PRORATA-U-PRM)
  3518
  3519     MOVE CP-STATE-U-PRM         TO WS-CERT-PREV-ST
  3520     COMPUTE WS-CERT-PREV-R78 = CP-R78-U-PRM
  3521
  3522     COMPUTE WS-CERT-PREV-PRO = CP-PRORATA-U-PRM
  3523
  3524*    IF (CR-DT > 20020630)
  3525*       AND (CR-DT < 20020801)
  3526*       AND (WS-BIN-VAL-DATES (VYR) = X'9BFF')
  3527*       AND (CR-ACCOUNT = '0000579700')
  3528*       MOVE CR-DT TO WS-DISPLAY-DATE
  3529*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3530*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3531*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3532*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3533*       MOVE CP-R78-U-PRM TO WS-DISPLAY-UEP
  3534*       DISPLAY ' LF ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3535*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3536*        WS-DISPLAY-PRM '   ' WS-DISPLAY-RAMT '   '
  3537*        WS-DISPLAY-UEP
  3538*    END-IF
  3539
  3540     .
  3541
  3542 0230-EXIT.
  3543     EXIT.
  3544
  3545 0410-CALC-AH-UEP.
  3546
  3547*    DISPLAY ' MADE IT TO 0410 '
  3548     IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3549        CONTINUE
  3550     ELSE
  3551        PERFORM VARYING CLAS-INDEXA FROM CLAS-STARTA BY +1 UNTIL
  3552            (CLAS-INDEXA = CLAS-MAXA) OR
  3553            (CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA))
  3554        END-PERFORM
  3555        IF CR-AHTYP = CLAS-I-BEN (CLAS-INDEXA)
  3556           CONTINUE
  3557        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* EL547ET.cbl
  3558           DISPLAY ' AH  BENEFIT ' CR-AHTYP ' NOT IN TABLE'
  3559           DISPLAY 'RETURN CODE - 0402'
  3560           MOVE 0402 TO WS-RETURN-CODE
  3561           PERFORM ABEND-PGM
  3562        END-IF
  3563     END-IF
  3564
  3565     PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3566         (VYR > +600) OR
  3567*        (WS-BIN-VAL-DATES (VYR) NOT < CP-CERT-EFF-DT)
  3568         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-ENTRY-DT)
  3569     END-PERFORM
  3570
  3571     MOVE CR-AHPRM            TO WS-CERT-PREV-R78
  3572                                 WS-CERT-PREV-PRO
  3573                                 WS-CERT-PREV-ST
  3574
  3575     PERFORM VARYING VYR FROM VYR BY +1 UNTIL
  3576         (VYR > +600) OR
  3577         (WS-BIN-VAL-DATES (VYR) NOT < WS-BIN-AH-END-DATE)
  3578
  3579        PERFORM 0420-CALC-AH-REM-TERM THRU 0420-EXIT
  3580        PERFORM 0430-CALC-AH-UEP THRU 0430-EXIT
  3581     END-PERFORM
  3582
  3583     .
  3584
  3585 0410-EXIT.
  3586     EXIT.
  3587
  3588 0420-CALC-AH-REM-TERM.
  3589
  3590*    DISPLAY ' MADE IT TO 0420 '
  3591     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3592
  3593     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3594                                 TO CP-BENEFIT-TYPE
  3595     MOVE CLAS-I-BAL (CLAS-INDEXA)
  3596                                 TO CP-SPECIAL-CALC-CD
  3597     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3598                                    CP-LOAN-TERM
  3599
  3600     MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS
  3601
  3602     MOVE DTE-REM-TRM-CALC-OPTION
  3603                                 TO CP-REM-TRM-CALC-OPTION
  3604
  3605     PERFORM 0510-GET-REMAINING-TERM
  3606                                 THRU 0510-EXIT
  3607
  3608     IF CP-REMAINING-TERM-1 NEGATIVE
  3609         MOVE ZEROS              TO CP-REMAINING-TERM-1
  3610     END-IF
  3611
  3612     IF CP-REMAINING-TERM-2 NEGATIVE
  3613         MOVE ZEROS              TO CP-REMAINING-TERM-2
  3614     END-IF
  3615
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* EL547ET.cbl
  3616     MOVE CP-REMAINING-TERM-1    TO AH-REM-TRM1
  3617     MOVE CP-REMAINING-TERM-2    TO AH-REM-TRM2
  3618
  3619     .
  3620
  3621 0420-EXIT.
  3622     EXIT.
  3623
  3624 0430-CALC-AH-UEP.
  3625
  3626*    DISPLAY ' MADE IT TO 0430 '
  3627     MOVE CR-AHPRM               TO CP-ORIGINAL-PREMIUM
  3628     MOVE CR-AH-TERM             TO CP-ORIGINAL-TERM
  3629     MOVE CR-AHAMT               TO CP-ORIGINAL-BENEFIT
  3630                                    CP-RATING-BENEFIT-AMT
  3631     MOVE AH-REM-TRM1            TO CP-REMAINING-TERM
  3632     MOVE CLAS-I-EP (CLAS-INDEXA)
  3633                                 TO CP-EARNING-METHOD
  3634     MOVE ZEROS                  TO CP-ALTERNATE-PREMIUM
  3635     MOVE CLAS-I-RL-AH (CLAS-INDEXA)
  3636                                 TO CP-BENEFIT-TYPE
  3637     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA)
  3638                                 TO CP-SPECIAL-CALC-CD
  3639     MOVE CR-AHTYP               TO CP-BENEFIT-CD
  3640     MOVE AH-OVERRIDE-L1         TO CP-AH-OVERRIDE-CODE
  3641
  3642     MOVE WS-BIN-CR-DT           TO CP-CERT-EFF-DT
  3643
  3644     MOVE WS-BIN-VAL-DATES (VYR) TO CP-VALUATION-DT
  3645
  3646     MOVE DTE-R78                TO CP-R78-OPTION
  3647     MOVE SPACES                 TO CP-ACCT-FLD-5
  3648     MOVE DTE-CLIENT             TO CP-COMPANY-ID
  3649     MOVE CR-AGE                 TO CP-ISSUE-AGE
  3650     MOVE CR-APR                 TO CP-LOAN-APR
  3651     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY
  3652     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM
  3653     MOVE CR-CARRIER             TO CP-CARRIER
  3654
  3655     MOVE STATE-SUB (CLAS-INDEXS)
  3656                                 TO CP-STATE
  3657     MOVE STATE-ABBR (CLAS-INDEXS)
  3658                                 TO CP-STATE-STD-ABBRV
  3659     MOVE DTE-CLASIC-COMPANY-CD  TO CP-COMPANY-CD
  3660
  3661     CALL 'ELUPRMX' USING CALCULATION-PASS-AREA
  3662
  3663     COMPUTE WS-AH-R78 (IYR VYR) =
  3664             WS-AH-R78 (IYR VYR) + CP-R78-U-PRM
  3665     COMPUTE WS-AH-PRO (IYR VYR) =
  3666             WS-AH-PRO (IYR VYR) + CP-PRORATA-U-PRM
  3667     COMPUTE WS-AH-ST  (IYR VYR) =
  3668             WS-AH-ST  (IYR VYR) + CP-STATE-U-PRM
  3669
  3670     COMPUTE WS-AH-R78-EP (IYR VYR) =
  3671             WS-AH-R78-EP (IYR VYR) + (WS-CERT-PREV-R78
  3672             - CP-R78-U-PRM)
  3673     COMPUTE WS-AH-PRO-EP (IYR VYR) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* EL547ET.cbl
  3674             WS-AH-PRO-EP (IYR VYR) + (WS-CERT-PREV-PRO
  3675             - CP-PRORATA-U-PRM)
  3676     COMPUTE WS-AH-ST-EP (IYR VYR) =
  3677             WS-AH-ST-EP (IYR VYR) + (WS-CERT-PREV-ST
  3678             - CP-STATE-U-PRM)
  3679
  3680     MOVE CP-R78-U-PRM           TO WS-CERT-PREV-R78
  3681     MOVE CP-PRORATA-U-PRM       TO WS-CERT-PREV-PRO
  3682     MOVE CP-STATE-U-PRM         TO WS-CERT-PREV-ST
  3683
  3684     IF (WS-BIN-VAL-DATES (VYR) = X'9BFF')
  3685        AND (CR-ACCOUNT = '0000579700')
  3686        MOVE CR-DT TO WS-DISPLAY-DATE
  3687        MOVE CR-AH-TERM TO WS-DISPLAY-TERM
  3688        MOVE AH-REM-TRM1 TO WS-DISPLAY-RTERM
  3689        MOVE CR-AHPRM TO WS-DISPLAY-PRM
  3690        MOVE CP-R78-U-PRM TO WS-DISPLAY-UEP
  3691        DISPLAY ' AH ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3692         WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3693         WS-DISPLAY-PRM '   '
  3694         WS-DISPLAY-UEP
  3695     END-IF
  3696
  3697     .
  3698
  3699 0430-EXIT.
  3700     EXIT.
  3701
  3702 0500-EMPTY-TABLE.
  3703
  3704     WRITE EXTRACT-RECORD-OUT-HD FROM WS-HEAD-RECORD
  3705     MOVE WS-INIT-EXT-RECORD     TO WS-EXTRACT-RECORD
  3706     DISPLAY ' MADE IT TO 0500 '
  3707     PERFORM VARYING IYR FROM +1 BY +1 UNTIL
  3708             IYR > +600
  3709         PERFORM VARYING VYR FROM +1 BY +1 UNTIL
  3710                VYR > +600
  3711             MOVE WS-ISSUE-CCYYMM (IYR)
  3712                                 TO EXT-ISSUE-CCYYMM
  3713             MOVE WS-VALUATION-CCYYMM (IYR VYR)
  3714                                 TO EXT-VALUE-CCYYMM
  3715             MOVE WS-LF-INFORCE (IYR VYR)
  3716                                 TO EXT-LF-INFORCE
  3717             MOVE WS-LF-WRITTEN (IYR VYR)
  3718                                 TO EXT-LF-WRITTEN
  3719             MOVE WS-AH-WRITTEN (IYR VYR)
  3720                                 TO EXT-AH-WRITTEN
  3721             MOVE WS-LF-REFUNDS (IYR VYR)
  3722                                 TO EXT-LF-REFUNDS
  3723             MOVE WS-AH-REFUNDS (IYR VYR)
  3724                                 TO EXT-AH-REFUNDS
  3725             MOVE WS-LF-R78     (IYR VYR)
  3726                                 TO EXT-LF-R78
  3727             MOVE WS-LF-PRO     (IYR VYR)
  3728                                 TO EXT-LF-PRO
  3729             MOVE WS-LF-ST      (IYR VYR)
  3730                                 TO EXT-LF-ST
  3731             MOVE WS-LF-R78-EP  (IYR VYR)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* EL547ET.cbl
  3732                                 TO EXT-LF-R78-EP
  3733             MOVE WS-LF-PRO-EP  (IYR VYR)
  3734                                 TO EXT-LF-PRO-EP
  3735             MOVE WS-LF-ST-EP   (IYR VYR)
  3736                                 TO EXT-LF-ST-EP
  3737             MOVE WS-AH-R78     (IYR VYR)
  3738                                 TO EXT-AH-R78
  3739             MOVE WS-AH-PRO     (IYR VYR)
  3740                                 TO EXT-AH-PRO
  3741             MOVE WS-AH-ST      (IYR VYR)
  3742                                 TO EXT-AH-ST
  3743             MOVE WS-AH-R78-EP  (IYR VYR)
  3744                                 TO EXT-AH-R78-EP
  3745             MOVE WS-AH-PRO-EP  (IYR VYR)
  3746                                 TO EXT-AH-PRO-EP
  3747             MOVE WS-AH-ST-EP   (IYR VYR)
  3748                                 TO EXT-AH-ST-EP
  3749             MOVE WS-LF-CLAIM   (IYR VYR)
  3750                                 TO EXT-LF-CLAIM
  3751             MOVE WS-AH-CLAIM   (IYR VYR)
  3752                                 TO EXT-AH-CLAIM
  3753             IF (EXT-ISSUE-CCYYMM > EXT-VALUE-CCYYMM) OR
  3754                (ZERO = WS-LF-INFORCE (IYR VYR) AND
  3755                        WS-LF-ST      (IYR VYR) AND
  3756                        WS-AH-ST      (IYR VYR) AND
  3757                        WS-LF-CLAIM   (IYR VYR) AND
  3758                        WS-AH-CLAIM   (IYR VYR) AND
  3759                        WS-LF-REFUNDS (IYR VYR) AND
  3760                        WS-AH-REFUNDS (IYR VYR))
  3761                CONTINUE
  3762             ELSE
  3763                WRITE EXTRACT-RECORD-OUT
  3764                                 FROM WS-EXTRACT-RECORD
  3765             END-IF
  3766         END-PERFORM
  3767     END-PERFORM
  3768
  3769     .
  3770
  3771 0500-EXIT.
  3772     EXIT.
  3773
  3774 0510-GET-REMAINING-TERM.
  3775
  3776*    DISPLAY ' MADE IT TO 0510 '
  3777     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA
  3778
  3779     .
  3780
  3781 0510-EXIT.
  3782     EXIT.
  3783
  3784
  3785 2000-CALC-REM-AMT.
  3786
  3787*    DISPLAY ' MADE IT TO 2000 '
  3788     IF CR-LFTYP = 'QD'
  3789        MOVE +15.0               TO CR-APR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* EL547ET.cbl
  3790     END-IF
  3791
  3792     MOVE +0                     TO WS-REM-AMT
  3793     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
  3794        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3795           COMPUTE WS-REM-AMT =
  3796             CR-LFAMT + CR-LFAMT-ALT
  3797        ELSE
  3798           MOVE CR-LFAMT         TO WS-REM-AMT
  3799        END-IF
  3800        GO TO 2900-DISPLAY-AMTS
  3801     END-IF
  3802
  3803     COMPUTE INTERMED ROUNDED = CR-LFAMT / CR-LF-TERM
  3804
  3805     IF LF-REM-TRM2 = CR-LF-TERM
  3806        IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3807           COMPUTE WS-REM-AMT =
  3808             CR-LFAMT + CR-LFAMT-ALT
  3809        ELSE
  3810           MOVE CR-LFAMT         TO WS-REM-AMT
  3811        END-IF
  3812        GO TO 2900-DISPLAY-AMTS
  3813     END-IF
  3814
  3815     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3816        GO TO 2010-ORDINARY-REM
  3817     END-IF
  3818
  3819     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  3820        GO TO 2020-CALC-TEXAS-REM
  3821     END-IF
  3822
  3823     IF CR-LFTYP = 'QD'
  3824        MOVE +15.0               TO CR-APR
  3825        MOVE 'N'                 TO
  3826                       CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3827        GO TO 2030-CALC-NET-PAY-REM
  3828     END-IF
  3829
  3830     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  3831        GO TO 2030-CALC-NET-PAY-REM
  3832     END-IF
  3833
  3834     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  3835        (CR-RATING-CLASS NOT = 'L ')
  3836         IF (CR-LF-TERM GREATER THAN +60) AND
  3837            (CR-DT GREATER THAN 19831031) AND
  3838            (CR-APR GREATER THAN ZERO)
  3839             GO TO 2030-CALC-NET-PAY-REM
  3840        END-IF
  3841     END-IF
  3842
  3843     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  3844         IF (CR-LF-TERM GREATER THAN +61) AND
  3845            (CR-DT  GREATER THAN 19830318) AND
  3846            (CR-APR GREATER THAN ZERO)
  3847             GO TO 2030-CALC-NET-PAY-REM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* EL547ET.cbl
  3848        END-IF
  3849     END-IF
  3850
  3851     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  3852         IF (CR-LF-TERM GREATER THAN +62) AND
  3853            (CR-DT  GREATER THAN 19810831) AND
  3854            (CR-DT  LESS THAN 19830901) AND
  3855            (CR-APR GREATER THAN ZERO)
  3856             GO TO 2030-CALC-NET-PAY-REM
  3857        END-IF
  3858     END-IF
  3859
  3860     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  3861         IF (CR-LF-TERM GREATER THAN +60) AND
  3862            (CR-DT  GREATER THAN 19831231) AND
  3863            (CR-APR GREATER THAN ZERO)
  3864             GO TO 2030-CALC-NET-PAY-REM
  3865        END-IF
  3866     END-IF
  3867
  3868     .
  3869 2010-ORDINARY-REM.
  3870
  3871*    DISPLAY ' MADE IT TO 2010 '
  3872     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3873         COMPUTE WS-REM-AMT ROUNDED =
  3874                  (INTERMED * LF-REM-TRM2) + CR-LFAMT-ALT
  3875     ELSE
  3876         COMPUTE WS-REM-AMT ROUNDED = INTERMED * LF-REM-TRM2
  3877     END-IF
  3878
  3879     GO TO 2900-DISPLAY-AMTS
  3880
  3881     .
  3882 2020-CALC-TEXAS-REM.
  3883
  3884*    DISPLAY ' MADE IT TO 2020 '
  3885
  3886     IF (CR-LF-TERM = ZEROS)
  3887        OR (CR-PMT-FREQ = ZEROS)
  3888        DISPLAY ' ZEROS KEY = ' CR-FULL-CONTROL
  3889        '  PMT FREQ = ' CR-PMT-FREQ
  3890        '  LF TERM  = ' CR-LF-TERM
  3891        MOVE ZEROS               TO WS-REM-AMT
  3892        GO TO 2900-DISPLAY-AMTS
  3893     END-IF
  3894
  3895     IF (CR-LF-TERM NOT = ZEROS)
  3896        AND (CR-PMT-FREQ) NOT = ZEROS
  3897     DIVIDE CR-LFAMT BY CR-LF-TERM
  3898         GIVING TEX-FACT-1.
  3899     DIVIDE LF-REM-TRM2 BY CR-PMT-FREQ
  3900         GIVING TEX-FACT-2
  3901         REMAINDER TEX-FACT-3.
  3902
  3903     IF TEX-FACT-3 NOT = ZERO
  3904         ADD +1                  TO TEX-FACT-2
  3905     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* EL547ET.cbl
  3906
  3907     IF (TEX-FACT-2 * CR-PMT-FREQ) = CR-LF-TERM
  3908         MOVE CR-LFAMT           TO WS-REM-AMT
  3909     ELSE
  3910         COMPUTE WS-REM-AMT ROUNDED =
  3911             (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ))
  3912     END-IF
  3913
  3914     GO TO 2900-DISPLAY-AMTS
  3915
  3916     .
  3917 2030-CALC-NET-PAY-REM.
  3918
  3919*    DISPLAY ' MADE IT TO 2030 '
  3920     MOVE WS-BIN-CR-DT           TO  CP-CERT-EFF-DT
  3921
  3922     IF CR-LOAN-1ST-PMT-DT IS NOT = ZEROS
  3923        MOVE CR-LOAN-1ST-PMT-DT  TO  DC-GREG-DATE-1-YMD
  3924        MOVE '3'                 TO  DC-OPTION-CODE
  3925        PERFORM 8510-DATE-CONVERSION
  3926                                 THRU 8590-EXIT
  3927        MOVE DC-BIN-DATE-1       TO  CP-FIRST-PAY-DATE
  3928     ELSE
  3929        MOVE CP-CERT-EFF-DT      TO  DC-BIN-DATE-1
  3930        MOVE +1                  TO  DC-ELAPSED-MONTHS
  3931        MOVE +0                  TO  DC-ELAPSED-DAYS
  3932        MOVE '6'                 TO  DC-OPTION-CODE
  3933        PERFORM 8510-DATE-CONVERSION
  3934                                 THRU 8590-EXIT
  3935        MOVE DC-BIN-DATE-2       TO  CP-FIRST-PAY-DATE
  3936     END-IF
  3937
  3938     IF CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L'
  3939        COMPUTE CP-ORIGINAL-BENEFIT = CR-LFAMT + CR-LFAMT-ALT
  3940     ELSE
  3941        MOVE CR-LFAMT            TO  CP-ORIGINAL-BENEFIT
  3942     END-IF
  3943     MOVE CR-APR                 TO  CP-LOAN-APR
  3944     MOVE CR-LF-TERM             TO  CP-ORIGINAL-TERM
  3945     MOVE CR-LOAN-TERM           TO  CP-LOAN-TERM
  3946     MOVE LF-REM-TRM2            TO  CP-REMAINING-TERM
  3947     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL)
  3948                                 TO CP-SPECIAL-CALC-CD
  3949     MOVE CLAS-I-RL-AH (CLAS-INDEXL)
  3950                                 TO  CP-BENEFIT-TYPE
  3951     MOVE CLAS-I-EP (CLAS-INDEXL)
  3952                                 TO  CP-EARNING-METHOD
  3953
  3954     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
  3955
  3956     MOVE CP-REMAINING-AMT       TO  WS-REM-AMT
  3957
  3958     .
  3959 2900-DISPLAY-AMTS.
  3960
  3961*    DISPLAY ' MADE IT TO 2900 '
  3962*    IF (CR-DT > 19921231) AND
  3963*       (CR-DT < 19940101) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* EL547ET.cbl
  3964*    IF (WS-BIN-VAL-DATES (VYR) = X'95FF')
  3965*       MOVE CR-DT TO WS-DISPLAY-DATE
  3966*       MOVE CR-LF-TERM TO WS-DISPLAY-TERM
  3967*       MOVE LF-REM-TRM2 TO WS-DISPLAY-RTERM
  3968*       MOVE CR-LFPRM TO WS-DISPLAY-PRM
  3969*       IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B' OR 'K' OR 'L'
  3970*          ADD CR-LFAMT CR-LFAMT-ALT GIVING WS-DISPLAY-AMT
  3971*       ELSE
  3972*          MOVE CR-LFAMT     TO WS-DISPLAY-AMT
  3973*       END-IF
  3974*       MOVE WS-REM-AMT   TO WS-DISPLAY-RAMT
  3975*       DISPLAY '  ' CR-CERT-NO '  ' WS-DISPLAY-DATE '   '
  3976*        WS-DISPLAY-TERM '  ' WS-DISPLAY-RTERM '   '
  3977*        WS-DISPLAY-AMT '   ' WS-DISPLAY-RAMT
  3978*    END-IF
  3979
  3980     .
  3981 2999-CALC-REM-AMT-X.
  3982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* EL547ET.cbl
  3984 8510-DATE-CONVERSION.
  3985
  3986*    DISPLAY ' MADE IT TO 8510 '
  3987     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  3988
  3989     .
  3990
  3991 8590-EXIT.
  3992     EXIT.
  3993
  3994
  3995
  3996
  3997 ABEND-PGM.
* 3998                                 COPY ELCABEND.
  3999***************************************************************** 04/14/98
  4000*                                                               * ELCABEND
  4001*                            ELCABEND.                          *    LV003
  4002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4003*                            VMOD 2.002                              CL**2
  4004*                                                               * ELCABEND
  4005*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  4006*            AND THEN ABENDS.                                   * ELCABEND
  4007*                                                               * ELCABEND
  4008*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  4009*                                                               * ELCABEND
  4010***************************************************************** ELCABEND
  4011*APS-010.                                                         ELCABEND
  4012     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  4013     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  4014                                                                  ELCABEND
  4015     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  4016         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4017         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4018                                 UPON CONSOLE.                    ELCABEND
  4019                                                                  ELCABEND
  4020     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  4021         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4022         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4023                                 UPON CONSOLE.                    ELCABEND
  4024                                                                  ELCABEND
  4025     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4026     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4027                                 UPON CONSOLE.                    ELCABEND
  4028                                                                  ELCABEND
  4029     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  4030     CALL 'ABORTME'.
  4031                                                                  ELCABEND
  4032 APS-EXIT.                                                        ELCABEND
  4033     EXIT.                                                        ELCABEND
  4034
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:    43978160     Code:       12113
