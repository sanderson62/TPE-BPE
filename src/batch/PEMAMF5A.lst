* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMAMF5A.cbl
* Options: int("PEMAMF5A.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMAMF5A.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMAMF5A.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "PEMAMF5A.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMAMF5A.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     6 ENVIRONMENT DIVISION.
     7 INPUT-OUTPUT SECTION.
     8 FILE-CONTROL.
     9     SELECT ERACCT           ASSIGN TO ERACCT
    10                             ORGANIZATION IS INDEXED
    11                             ACCESS IS DYNAMIC
    12                             RECORD KEY IS AM-CONTROL-PRIMARY
    13                             FILE STATUS IS ERACCT-FILE-STATUS.
    14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMAMF5A.cbl
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  ERACCT.
    19
*   20                                 COPY ERCACCT.
    21******************************************************************04/19/98
    22*                                                                *ERCACCT
    23*                                                                *ERCACCT
    24*                            ERCACCT                             *   LV031
    25*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
    26*                            VMOD=2.031                          *ERCACCT
    27*                                                                *ERCACCT
    28*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
    29*                                                                *ERCACCT
    30*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
    31*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
    32*                                                                *ERCACCT
    33*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
    34*                                                                *ERCACCT
    35*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
    36*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
    37*                                                                *ERCACCT
    38*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
    39*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
    40*                                                                *ERCACCT
    41*   LOG = NO                                                     *ERCACCT
    42*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
    43*                                                                *ERCACCT
    44*                                                                *ERCACCT
    45******************************************************************ERCACCT
    46*                   C H A N G E   L O G
    47*
    48* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    49*-----------------------------------------------------------------
    50*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    51* EFFECTIVE    NUMBER
    52*-----------------------------------------------------------------
    53* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
    54* 092705    2005050300006  PEMA  ADD SPP LEASES
    55* 022808    2007083100002  PEMA  ADD FREEZE STATUS
    56* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    57* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
    58* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
    59* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
    60******************************************************************
    61                                                                  ERCACCT
    62 01  ACCOUNT-MASTER.                                              ERCACCT
    63     12  AM-RECORD-ID                      PIC XX.                ERCACCT
    64         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
    65                                                                  ERCACCT
    66     12  AM-CONTROL-PRIMARY.                                      ERCACCT
    67         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
    68         16  AM-MSTR-CNTRL.                                       ERCACCT
    69             20  AM-CONTROL-A.                                    ERCACCT
    70                 24  AM-CARRIER            PIC X.                 ERCACCT
    71                 24  AM-GROUPING.                                 ERCACCT
    72                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
    73                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
    74                 24  AM-STATE              PIC XX.                ERCACCT
    75                 24  AM-ACCOUNT.                                  ERCACCT
    76                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
    77                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
    78             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
    79                                           PIC X(19).             ERCACCT
    80             20  AM-CNTRL-B.                                      ERCACCT
    81                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
    82                 24  FILLER                PIC X(4).              ERCACCT
    83             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
    84                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
    85                                                                  ERCACCT
    86     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
    87         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
    88         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
    89         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
    90         16  AM-VG-STATE                   PIC XX.                ERCACCT
    91         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
    92         16  AM-VG-DATE.                                          ERCACCT
    93             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
    94             20  FILLER                    PIC X(4).              ERCACCT
    95         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
    96                                           PIC 9(11)      COMP-3. ERCACCT
    97     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
    98         16  FILLER                        PIC X(10).
    99         16  AM-VG-KEY3.
   100             20  AM-VG3-ACCOUNT            PIC X(10).
   101             20  AM-VG3-EXP-DT             PIC XX.
   102         16  FILLER                        PIC X(4).
   103     12  AM-MAINT-INFORMATION.                                    ERCACCT
   104         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   105         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   106         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   107         16  FILLER                        PIC XX.                ERCACCT
   108                                                                  ERCACCT
   109     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   110     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   111                                                                  ERCACCT
   112     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   113         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   114         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   115                                                                  ERCACCT
   116     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   117     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   118                                                                  ERCACCT
   119     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   120     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   121                                                                  ERCACCT
   122     12  AM-NAME                           PIC X(30).             ERCACCT
   123     12  AM-PERSON                         PIC X(30).             ERCACCT
   124     12  AM-ADDRS                          PIC X(30).             ERCACCT
   125     12  AM-CITY.
   126         16  AM-ADDR-CITY                  PIC X(28).
   127         16  AM-ADDR-STATE                 PIC XX.
   128     12  AM-ZIP.                                                  ERCACCT
   129         16  AM-ZIP-PRIME.                                        ERCACCT
   130             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   131                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   132             20  FILLER                    PIC X(4).              ERCACCT
   133         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   134     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   135         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   136         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   137         16  FILLER                        PIC XXX.               ERCACCT
   138     12  AM-TEL-NO.                                               ERCACCT
   139         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   140         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   141         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   142     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   143         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   144         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   145                                                                  ERCACCT
   146     12  AM-COMM-STRUCTURE.                                       ERCACCT
   147         16  AM-DEFN-1.                                           ERCACCT
   148             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   149                 24  AM-AGT.                                      ERCACCT
   150                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   151                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   152                 24  AM-COM-TYP            PIC X.                 ERCACCT
   153                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   154                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   155                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   156                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   157                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   158                 24  AM-GL-CODES           PIC X.                 ERCACCT
   159                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   160                 24  FILLER                PIC X(01).             ERCACCT
   161         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   162             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   163                 24  FILLER                PIC X(11).             ERCACCT
   164                 24  AM-L-COMA             PIC XXX.               ERCACCT
   165                 24  AM-J-COMA             PIC XXX.               ERCACCT
   166                 24  AM-A-COMA             PIC XXX.               ERCACCT
   167                 24  FILLER                PIC X(6).              ERCACCT
   168                                                                  ERCACCT
   169     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   170         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   171                                                                  ERCACCT
   172     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   173                                                                  ERCACCT
   174     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   175         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   176         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   177     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   178         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   179         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   180     12  AM-GPCD                           PIC 99.                ERCACCT
   181     12  AM-IG                             PIC X.                 ERCACCT
   182         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   183         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   184     12  AM-STATUS                         PIC X.                 ERCACCT
   185         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   186         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   187         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   188         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   189         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   190         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   191     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   192     12  AM-ID-NO                          PIC X(11).             ERCACCT
   193                                                                  ERCACCT
   194     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   195     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   196     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   197     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   198     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   199     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   200     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   201     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   202     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   203                                                                  ERCACCT
   204     12  AM-USER-FIELDS.                                          ERCACCT
   205         16  AM-FLD-1                      PIC XX.                ERCACCT
   206         16  AM-FLD-2                      PIC XX.                ERCACCT
   207         16  AM-FLD-3                      PIC XX.                ERCACCT
   208         16  AM-FLD-4                      PIC XX.                ERCACCT
   209         16  AM-FLD-5                      PIC XX.                ERCACCT
   210                                                                  ERCACCT
   211     12  AM-1ST-PROD-DATE.                                        ERCACCT
   212         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   213         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   214         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   215     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   216     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   217         16  AM-PUR-YR                     PIC XX.                ERCACCT
   218         16  AM-PUR-MO                     PIC XX.                ERCACCT
   219         16  AM-PUR-DA                     PIC XX.                ERCACCT
   220     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   221     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   222     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   223     12  AM-INACTIVE-DATE.                                        ERCACCT
   224         16  AM-INA-MO                     PIC 99.                ERCACCT
   225         16  AM-INA-DA                     PIC 99.                ERCACCT
   226         16  AM-INA-YR                     PIC 99.                ERCACCT
   227     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   228                                                                  ERCACCT
   229     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   230     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   231                                                                  ERCACCT
   232     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   233         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   234         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   235         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   236         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   237                                                                  ERCACCT
   238     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   239         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   240         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   241                                                                  ERCACCT
   242     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   243                                                                  ERCACCT
   244     12  AM-OVER-SHORT.                                           ERCACCT
   245         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   246         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   247                                                                  ERCACCT
   248     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   249     12  AM-DCC-CLP-STATE                  PIC XX.
   250                                                                  ERCACCT
   251     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   252     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   253                                                                  ERCACCT
   254     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   255     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   256     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   257     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   258     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   259     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   260     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   261     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   262     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   263     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   264     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   265     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   266     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   267     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   268     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   269     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   270                                                                  ERCACCT
   271     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   272                                                                  ERCACCT
   273     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   274     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   275                                                                  ERCACCT
   276     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   277     12  AM-EARN-METHODS.                                         ERCACCT
   278         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   279             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   280             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   281             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   282             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   283         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   284             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   285             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   286             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   287             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   288         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   289             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   290             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   291             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   292             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   293             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   294             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   295                                                                  ERCACCT
   296     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   297     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   298     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   299                                                                  ERCACCT
   300     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   301     12  AM-RET-P-E                        PIC X.                 ERCACCT
   302     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   303     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   304     12  AM-RET-GRP                        PIC X(6).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   305     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   306         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   307         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   308     12  AM-RETRO-EARNINGS.                                       ERCACCT
   309         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   310         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   311         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   312     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   313         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   314         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   315     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   316         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   317         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   318         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   319     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   320     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   321                                                                  ERCACCT
   322     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   323         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   324         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   325         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   326         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   327         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   328                                                                  ERCACCT
   329     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   330                                                                  ERCACCT
   331     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   332                                                                  ERCACCT
   333     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   334         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   335                                                                  ERCACCT
   336     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   337         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   338         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   339                                                                  ERCACCT
   340     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   341         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   342                                                                  ERCACCT
   343     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   344         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   345         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   346                                                                  ERCACCT
   347     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   348                                                                  ERCACCT
   349     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   350     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   351     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   352     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   353     12  AM-DCC-UEF-STATE                  PIC XX.
   354     12  FILLER                            PIC XXX.
   355     12  AM-REPORT-CODE-3                  PIC X(10).
   356*    12  FILLER                            PIC X(22).             ERCACCT
   357                                                                  ERCACCT
   358     12  AM-RESERVE-DATE.                                         ERCACCT
   359         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   360         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   361         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   362                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   363     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   364     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   365         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   366         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   367         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   368         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   369                                                                  ERCACCT
   370     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   371         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   372         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   373         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   374         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   375                                                                  ERCACCT
   376     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   377         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   378             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   379             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   380             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   381             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   382             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   383             20  FILLER                    PIC XX.                ERCACCT
   384         16  FILLER                        PIC X(80).             ERCACCT
   385                                                                  ERCACCT
   386     12  AM-TRANSFER-DATA.                                        ERCACCT
   387         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   388             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   389             20  AM-TRNFROM-GROUPING.                             ERCACCT
   390                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   391                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   392             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   393             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   394                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   395                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   396             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   397         16  AM-TRANSFERRED-TO.                                   ERCACCT
   398             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   399             20  AM-TRNTO-GROUPING.                               ERCACCT
   400                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   401                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   402             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   403             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   404                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   405                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   406             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   407         16  FILLER                        PIC X(10).             ERCACCT
   408                                                                  ERCACCT
   409     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   410                                                                  ERCACCT
   411     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   412         16  AM-DEFN-1-SAVED.                                     ERCACCT
   413             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   414                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   415                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   416                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   417                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   418                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   419                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   420                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   421                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   422                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   423                 24  FILLER                PIC X.                 ERCACCT
   424         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   425             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   426                 24  FILLER                PIC X(11).             ERCACCT
   427                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   428                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   429                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   430                 24  FILLER                PIC X(6).              ERCACCT
   431                                                                  ERCACCT
   432     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   433         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   434            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   435            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   436            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   437                                                                  ERCACCT
   438     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   439     12  FILLER                            PIC X(120).            ERCACCT
   440                                                                  ERCACCT
   441     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   442         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   443         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   444             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   445             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   446                                                          COMP-3. ERCACCT
   447             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   448                                                          COMP-3. ERCACCT
   449         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   450             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   451             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   452                                                          COMP-3. ERCACCT
   453             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   454                                                          COMP-3. ERCACCT
   455                                                                  ERCACCT
   456     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   457         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   458         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   459         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   460         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   461             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   462                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   463                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   464             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   465                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   466                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   467             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   468                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   469                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   470         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   471             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   472                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   473                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   474                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   475             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   476                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   477                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   478             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ERCACCT)
   479                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   480                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   481                                                                  ERCACCT
   482     12  AM-COMMENTS.                                             ERCACCT
   483         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   484                                                                  ERCACCT
   485     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   486         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   487         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   488         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   489         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   490         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   491             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   492             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   493             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   494             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   495         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   496             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   497             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   498             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   499         16  FILLER                        PIC X(102).            ERCACCT
   500                                                                  ERCACCT
   501     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   502         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   503             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   504             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   505             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   506             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   507             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   508         16  FILLER                          PIC X(10).           ERCACCT
   509******************************************************************ERCACCT
   510
   511 WORKING-STORAGE SECTION.
   512 77  S1                          PIC S9(3) COMP-3 VALUE +0.
   513 77  WS-STATE-SW                 PIC X  VALUE ' '.
   514     88  VALID-STATE               VALUE 'Y'.
   515 77  WS-DIS-EFF-DT               PIC X(10)  VALUE SPACES.
   516 77  WS-DIS-EXP-DT               PIC X(10)  VALUE SPACES.
   517 01  WS-STATUS-CODES.
   518     05  ERACCT-FILE-STATUS      PIC XX  VALUE SPACES.
   519     05  WS-EOF-SW               PIC X   VALUE SPACES.
   520         88  END-OF-ERACCT               VALUE 'Y'.
   521         88  MORE-ERACCT                 VALUE ' '.
   522
   523*****************************************************************
   524*                                                               *
   525*                     STATE CODE TABLE                          *
   526*                                                               *
   527*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     *
   528*            SEARCH VERB WILL NOT WORK PROPERLY !               *
   529*                                                               *
   530*****************************************************************
   531
   532 01  STATE-VALUES.
   533     05  PIC X(24)  VALUE 'AAAA                    '.
   534     05  PIC X(24)  VALUE 'AEAE                    '.
   535     05  PIC X(24)  VALUE 'AKAKALASKA              '.
   536     05  PIC X(24)  VALUE 'ALALALABAMA             '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMAMF5A.cbl
   537     05  PIC X(24)  VALUE 'APAP                    '.
   538     05  PIC X(24)  VALUE 'ARARARKANSAS            '.
   539     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.
   540     05  PIC X(24)  VALUE 'AZAZARIZONA             '.
   541     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.
   542     05  PIC X(24)  VALUE 'CDCNCANADA              '.
   543     05  PIC X(24)  VALUE 'CNCNCANADA              '.
   544     05  PIC X(24)  VALUE 'COCOCOLORADO            '.
   545     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.
   546     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.
   547     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.
   548     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.
   549     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.
   550     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.
   551     05  PIC X(24)  VALUE 'GUGUGUAM                '.
   552     05  PIC X(24)  VALUE 'HIHIHAWAII              '.
   553     05  PIC X(24)  VALUE 'IAIAIOWA                '.
   554     05  PIC X(24)  VALUE 'IDIDIDAHO               '.
   555     05  PIC X(24)  VALUE 'ILILILLINOIS            '.
   556     05  PIC X(24)  VALUE 'INININDIANA             '.
   557     05  PIC X(24)  VALUE 'KSKSKANSAS              '.
   558     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.
   559     05  PIC X(24)  VALUE 'LALALOUISIANA           '.
   560     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.
   561     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.
   562     05  PIC X(24)  VALUE 'MEMEMAINE               '.
   563     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.
   564     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.
   565     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.
   566     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.
   567     05  PIC X(24)  VALUE 'MTMTMONTANA             '.
   568     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.
   569     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.
   570     05  PIC X(24)  VALUE 'NENENEBRASKA            '.
   571     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.
   572     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.
   573     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.
   574     05  PIC X(24)  VALUE 'NVNVNEVADA              '.
   575     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.
   576     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.
   577     05  PIC X(24)  VALUE 'OHOHOHIO                '.
   578     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.
   579     05  PIC X(24)  VALUE 'OROROREGON              '.
   580     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.
   581     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.
   582     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.
   583     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.
   584     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.
   585     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.
   586     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.
   587     05  PIC X(24)  VALUE 'TXTXTEXAS               '.
   588     05  PIC X(24)  VALUE 'UTUTUTAH                '.
   589     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.
   590     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.
   591     05  PIC X(24)  VALUE 'VTVTVERMONT             '.
   592     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.
   593     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.
   594     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMAMF5A.cbl
   595     05  PIC X(24)  VALUE 'WYWYWYOMING             '.
   596
   597 01  FILLER REDEFINES STATE-VALUES.
   598     05  STATE-TABLE
   599             OCCURS 63 TIMES
   600             ASCENDING KEY IS ST-STATE
   601             INDEXED BY ST-INDEX.
   602         10  ST-STATE          PIC XX.
   603         10  ST-ALT-STATE      PIC XX.
   604         10  ST-NAME           PIC X(20).
   605
*  606                                 COPY ELCDATE.
   607******************************************************************06/11/98
   608*                                                                *ELCDATE
   609*                                                                *ELCDATE
   610*                            ELCDATE.                            *   LV023
   611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   612*                            VMOD=2.003                           ELCDATE
   613*                                                                *ELCDATE
   614*                                                                *ELCDATE
   615*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   616*                 LENGTH = 200                                   *   CL*19
   617******************************************************************ELCDATE
   618                                                                  ELCDATE
   619 01  DATE-CONVERSION-DATA.                                        ELCDATE
   620     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   621     12  DC-OPTION-CODE                PIC X.                        CL*15
   622         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   623         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   624         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   625         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   626         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   627         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   628         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   629         88  FIND-CENTURY               VALUE '7'.                   CL*22
   630         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   631         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   632         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   633         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   634         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   635         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   636         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   637         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   638         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   639         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   640         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   641         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   642         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   643         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   644         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   645         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   646         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   647         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   648         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   649         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   650         88  THREE-CHARACTER-BIN                                  ELCDATE
   651                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   652         88  GREGORIAN-TO-BIN                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ELCDATE)
   653                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   654         88  BIN-TO-GREGORIAN                                        CL**2
   655                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   656         88  JULIAN-TO-BINARY                                        CL**2
   657                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   658     12  DC-ERROR-CODE                 PIC X.                        CL*15
   659         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   660         88  DATE-CONVERSION-ERROR                                ELCDATE
   661                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   662         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   663         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   664         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   665         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   666         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   667         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   668         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   669         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   670         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   671         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   672     12  DC-END-OF-MONTH               PIC X.                        CL*15
   673         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   674     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   675         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   676         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   677         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   678     12  FILLER                        PIC X.                        CL*15
   679     12  DC-CONVERSION-DATES.                                        CL*15
   680         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   681         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   682         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   683         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   684                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   685             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   686             20  SLASH1-1              PIC X.                        CL*15
   687             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   688             20  SLASH1-2              PIC X.                        CL*15
   689             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   690         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   691         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   692                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   693             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   694             20  SLASH2-1              PIC X.                        CL*15
   695             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   696             20  SLASH2-2              PIC X.                        CL*15
   697             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   698         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   699         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   700                     DC-GREG-DATE-1-YMD.                          ELCDATE
   701             20  DC-YMD-YEAR           PIC 99.                       CL*15
   702             20  DC-YMD-MONTH          PIC 99.                       CL*15
   703             20  DC-YMD-DAY            PIC 99.                       CL*15
   704         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   705         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   706                      DC-GREG-DATE-1-MDY.                         ELCDATE
   707             20  DC-MDY-MONTH          PIC 99.                       CL*15
   708             20  DC-MDY-DAY            PIC 99.                       CL*15
   709             20  DC-MDY-YEAR           PIC 99.                       CL*15
   710         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ELCDATE)
   711             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   712             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   713             20  FILLER                PIC XX.                       CL*15
   714             20  DC-ALPHA-CENTURY.                                   CL*15
   715                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   716             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   717         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   718         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   719         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   720         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   721         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   722                                       PIC 9(05).                    CL*20
   723         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   724             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   725             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   726         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   727         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   728         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   729     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   730         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   731         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   732             20  FILLER                PIC 9(3).                     CL*15
   733             20  HOLD-CEN-1-CCYY.                                    CL*15
   734                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   735                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   736             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   737             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   738         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   739             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   740             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   741             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   742                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   743                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   744             20  FILLER                PIC 9(3).                     CL*15
   745         16  HOLD-CENTURY-1-X.                                       CL*15
   746             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   747             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   748                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   749                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   750             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   751             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   752         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   753             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   754             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   755             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   756                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   757                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   758             20  FILLER                PIC XXX.                      CL*23
   759         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   760         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   761         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   762         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   763             20  DC-JULIAN-1-CCYY.                                   CL*15
   764                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   765                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   766             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   767         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   768         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMAMF5A.cbl (/apps/prod/cid1p/copy/ELCDATE)
   769             20  DC-JULIAN-2-CCYY.                                   CL*15
   770                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   771                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   772             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   773         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   774             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   775             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   776             20  DC-EDITA-DAY          PIC 99.                       CL*15
   777             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   778             20  DC-EDITA-CCYY.                                      CL*15
   779                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   780                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   781         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   782             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   783             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   784             20  DC-EDITB-DAY          PIC 99.                       CL*15
   785             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   786             20  DC-EDITB-CCYY.                                      CL*15
   787                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   788                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   789         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   790         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   791                              DC-GREG-DATE-CYMD.                  ELCDATE
   792             20  DC-CYMD-CEN           PIC 99.                       CL*15
   793             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   794             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   795             20  DC-CYMD-DAY           PIC 99.                       CL*15
   796         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   797         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   798                              DC-GREG-DATE-MDCY.                  ELCDATE
   799             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   800             20  DC-MDCY-DAY           PIC 99.                       CL*15
   801             20  DC-MDCY-CEN           PIC 99.                       CL*15
   802             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   803    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   804        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   805    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   806    12  FILLER                         PIC X(28).                    CL*26
   807
   808 01  WS-HOLD-CITY-STATE          PIC X(30)  VALUE SPACES.
   809 01  WS-WORK-CITY-ST.
   810     05  WS-WORK-CITY            PIC X(28)  VALUE SPACES.
   811     05  WS-WORK-STATE           PIC XX     VALUE SPACES.
   812 01  WS-HOLD-ERACCT              PIC X(2000) VALUE LOW-VALUES.
   813 01  WS-WORK-FIELDS.
   814     05  WS-ABEND-FLD            PIC 9         VALUE ZEROS.
   815     05  WS-ZERO-FLD             PIC 9         VALUE ZEROS.
   816     05  WS-ERACCT-RECS-IN       PIC 9(9)      VALUE ZEROS.
   817     05  WS-ERACCT-RECS-FIX      PIC 9(9)      VALUE ZEROS.
   818     05  WS-ERACCT-RECS-DEL      PIC 9(9)      VALUE ZEROS.
   819     05  WS-DISPLAY-CNT          PIC Z,ZZZ,ZZ9 VALUE ZEROS.
   820     05  WS-INVALID-ST-CNT       PIC 9(9)      VALUE ZEROS.
   821
   822 PROCEDURE DIVISION.
   823 0000-MAINLINE.
   824
   825     PERFORM 0100-OPEN-FILES     THRU 0100-EXIT
   826     PERFORM 0200-INITIALIZE     THRU 0200-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMAMF5A.cbl
   827     PERFORM 0500-PROCESS        THRU 0500-EXIT UNTIL
   828        END-OF-ERACCT
   829*       OR WS-ERACCT-RECS-FIX > 500
   830     PERFORM 3000-CLOSE-FILES    THRU 3000-EXIT
   831     PERFORM 4000-FINAL-TOTALS   THRU 4000-EXIT
   832     GOBACK
   833
   834     .
   835 0000-EXIT.
   836     EXIT.
   837
   838 0100-OPEN-FILES.
   839
   840     OPEN I-O   ERACCT
   841*    OPEN INPUT ERACCT
   842
   843     IF ERACCT-FILE-STATUS = '00'
   844         CONTINUE
   845     ELSE
   846         DISPLAY '*** ERROR OPENING ERACCT FILE ***'
   847         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
   848         PERFORM 9999-ABEND-RTN
   849     END-IF
   850
   851     .
   852 0100-EXIT.
   853     EXIT.
   854
   855 0200-INITIALIZE.
   856
   857     MOVE SPACES                 TO WS-EOF-SW
   858     MOVE ZEROS                  TO WS-ERACCT-RECS-IN
   859                                    WS-ERACCT-RECS-FIX
   860                                    WS-ERACCT-RECS-DEL
   861
   862     PERFORM 1100-START-ERACCT   THRU 1100-EXIT
   863
   864     PERFORM 1200-READ-ERACCT    THRU 1200-EXIT
   865
   866     .
   867 0200-EXIT.
   868     EXIT.
   869
   870 0500-PROCESS.
   871
   872     IF AM-CITY NOT = SPACES
   873        PERFORM 1000-PROCESS     THRU 1000-EXIT
   874     END-IF
   875
   876     PERFORM 1200-READ-ERACCT    THRU 1200-EXIT
   877
   878     .
   879 0500-EXIT.
   880     EXIT.
   881
   882 1000-PROCESS.
   883
   884     MOVE SPACES                 TO WS-WORK-CITY-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMAMF5A.cbl
   885     MOVE AM-CITY                TO WS-HOLD-CITY-STATE
   886
   887** CHECK FOR GUAM AND CHANGE TO GU **
   888     PERFORM VARYING S1 FROM +27 BY -1 UNTIL
   889        (S1 = +1)
   890        OR (AM-CITY (S1:4) = 'GUAM')
   891     END-PERFORM
   892     IF AM-CITY (S1:4) = 'GUAM'
   893        MOVE 'GU  '              TO AM-CITY (S1:4)
   894        DISPLAY ' FIXED GUAM ' WS-HOLD-CITY-STATE ' '
   895           AM-CITY
   896        MOVE AM-CITY             TO WS-HOLD-CITY-STATE
   897     END-IF
   898
   899     PERFORM VARYING S1 FROM +30 BY -1 UNTIL
   900        (AM-CITY (S1:1) NOT = SPACE AND '.')
   901        OR (S1 = +1)
   902     END-PERFORM
   903     IF S1 > 3
   904        SUBTRACT +1 FROM S1
   905        MOVE AM-CITY (S1:2)
   906                                 TO WS-WORK-STATE
   907        SUBTRACT +1 FROM S1
   908        PERFORM VARYING S1 FROM S1 BY -1 UNTIL
   909           AM-CITY (S1:1) NOT = SPACE
   910        END-PERFORM
   911        IF S1 > 2
   912           IF AM-CITY (S1:1) = ',' OR ';' OR '.'
   913              MOVE AM-CITY (1:S1 - 1) TO WS-WORK-CITY
   914           ELSE
   915              MOVE AM-CITY (1:S1) TO WS-WORK-CITY
   916           END-IF
   917        END-IF
   918        MOVE SPACE               TO WS-STATE-SW
   919        PERFORM 1500-EDIT-STATE  THRU 1500-EXIT
   920        IF VALID-STATE
   921           MOVE WS-WORK-CITY     TO AM-ADDR-CITY
   922           MOVE WS-WORK-STATE    TO AM-ADDR-STATE
   923           PERFORM 2100-REWRITE-ERACCT
   924                                 THRU 2100-EXIT
   925        ELSE
   926           IF AM-STATUS = '0'
   927              DISPLAY 'ACTIVE INVALID STATE CODE: ' WS-WORK-STATE
   928                 ' ' WS-HOLD-CITY-STATE ' ' AM-CONTROL-A ' '
   929                 WS-DIS-EXP-DT ' ' WS-DIS-EFF-DT
   930           ELSE
   931              DISPLAY 'INACTIVE INVALID STATE CODE: '
   932                WS-WORK-STATE ' ' WS-HOLD-CITY-STATE ' '
   933                AM-CONTROL-A ' ' WS-DIS-EXP-DT ' ' WS-DIS-EFF-DT
   934           END-IF
   935        END-IF
   936     ELSE
   937        DISPLAY ' WEIRD CITY STATE ' AM-CONTROL-A
   938           ' ' AM-CITY
   939     END-IF
   940
   941
   942     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMAMF5A.cbl
   943 1000-EXIT.
   944     EXIT.
   945
   946 1100-START-ERACCT.
   947
   948     MOVE LOW-VALUES             TO AM-CONTROL-PRIMARY
   949     MOVE X'04'                  TO AM-COMPANY-CD
   950
   951     START ERACCT KEY IS NOT <
   952                      AM-CONTROL-PRIMARY
   953     IF ERACCT-FILE-STATUS NOT = '00'
   954        DISPLAY ' ERACCT, BAD START '
   955              ERACCT-FILE-STATUS
   956        PERFORM 9999-ABEND-RTN
   957     END-IF
   958
   959     .
   960
   961 1100-EXIT.
   962     EXIT.
   963
   964 1200-READ-ERACCT.
   965
   966     READ ERACCT NEXT RECORD
   967
   968     IF ERACCT-FILE-STATUS = '10' OR '23'
   969        SET END-OF-ERACCT TO TRUE
   970     ELSE
   971        IF ERACCT-FILE-STATUS NOT = '00'
   972           DISPLAY 'ERACCT, BAD READ NEXT '
   973                ERACCT-FILE-STATUS
   974           PERFORM 9999-ABEND-RTN
   975        ELSE
   976           ADD 1              TO WS-ERACCT-RECS-IN
   977        END-IF
   978     END-IF
   979
   980     .
   981 1200-EXIT.
   982     EXIT.
   983
   984 1500-EDIT-STATE.
   985
   986     SEARCH ALL STATE-TABLE AT END
   987        PERFORM 1650-CONVERT-DATES THRU 1650-EXIT
   988        ADD 1 TO WS-INVALID-ST-CNT
   989        WHEN ST-STATE (ST-INDEX) = WS-WORK-STATE
   990           SET VALID-STATE TO TRUE
   991     END-SEARCH
   992
   993     .
   994 1500-EXIT.
   995     EXIT.
   996
   997 1650-CONVERT-DATES.
   998
   999     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1
  1000     MOVE ' '                    TO DC-OPTION-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMAMF5A.cbl
  1001     MOVE +0                     TO DC-ELAPSED-MONTHS
  1002                                    DC-ELAPSED-DAYS
  1003     PERFORM 8510-DATE-CONVERSION
  1004                                 THRU 8590-EXIT
  1005     IF NO-CONVERSION-ERROR
  1006        MOVE DC-GREG-DATE-A-EDIT TO WS-DIS-EFF-DT
  1007     ELSE
  1008        MOVE 'XX/XX/XXXX'        TO WS-DIS-EFF-DT
  1009        DISPLAY ' ERROR CONVERTING EFFECT  DATE ' AM-STATE
  1010        ' ' AM-ACCOUNT
  1011     END-IF
  1012
  1013     IF AM-EXPIRATION-DT = HIGH-VALUES
  1014        MOVE '12/31/9999'        TO WS-DIS-EXP-DT
  1015     ELSE
  1016        MOVE AM-EXPIRATION-DT    TO DC-BIN-DATE-1
  1017        MOVE ' '                 TO DC-OPTION-CODE
  1018        MOVE +0                  TO DC-ELAPSED-MONTHS
  1019                                    DC-ELAPSED-DAYS
  1020        PERFORM 8510-DATE-CONVERSION
  1021                                 THRU 8590-EXIT
  1022        IF NO-CONVERSION-ERROR
  1023           MOVE DC-GREG-DATE-A-EDIT
  1024                                 TO WS-DIS-EXP-DT
  1025        ELSE
  1026           MOVE 'XX/XX/XXXX'     TO WS-DIS-EXP-DT
  1027           DISPLAY ' ERROR CONVERTING EXPIRE  DATE ' AM-STATE
  1028           ' ' AM-ACCOUNT
  1029        END-IF
  1030     END-IF
  1031
  1032     .
  1033 1650-EXIT.
  1034     EXIT.
  1035
  1036 2100-REWRITE-ERACCT.
  1037
  1038     DISPLAY ' OLD ' WS-HOLD-CITY-STATE ' NEW ' WS-WORK-CITY-ST
  1039     REWRITE ACCOUNT-MASTER
  1040*    MOVE '00' TO ERACCT-FILE-STATUS
  1041
  1042     IF ERACCT-FILE-STATUS = '00'
  1043         ADD 1                   TO WS-ERACCT-RECS-FIX
  1044     ELSE
  1045         DISPLAY 'ERACCT, BAD REWRITE '
  1046         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
  1047         PERFORM 9999-ABEND-RTN
  1048     END-IF
  1049     .
  1050 2100-EXIT.
  1051     EXIT.
  1052
  1053 2200-DELETE-ERACCT.
  1054
  1055     DELETE  ERACCT
  1056
  1057     IF ERACCT-FILE-STATUS = '00'
  1058         ADD 1                   TO WS-ERACCT-RECS-DEL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMAMF5A.cbl
  1059     ELSE
  1060         DISPLAY 'ERACCT, BAD DELETE  '
  1061         DISPLAY '*** STATUS CODE IS ' ERACCT-FILE-STATUS
  1062         PERFORM 9999-ABEND-RTN
  1063     END-IF
  1064     .
  1065 2200-EXIT.
  1066     EXIT.
  1067
  1068
  1069 3000-CLOSE-FILES.
  1070
  1071     CLOSE ERACCT
  1072
  1073     .
  1074 3000-EXIT.
  1075     EXIT.
  1076
  1077 4000-FINAL-TOTALS.
  1078
  1079     DISPLAY '**************************************************'
  1080     DISPLAY '***                                            ***'
  1081
  1082     MOVE WS-ERACCT-RECS-IN      TO WS-DISPLAY-CNT
  1083     DISPLAY '***  ERACCT RECORDS   IN         = ' WS-DISPLAY-CNT
  1084
  1085     MOVE WS-ERACCT-RECS-FIX     TO WS-DISPLAY-CNT
  1086     DISPLAY '***  ERACCT RECORDS   FIXED      = ' WS-DISPLAY-CNT
  1087
  1088     MOVE WS-INVALID-ST-CNT      TO WS-DISPLAY-CNT
  1089     DISPLAY '***  INVALID STATES              = ' WS-DISPLAY-CNT
  1090
  1091     MOVE WS-ERACCT-RECS-DEL     TO WS-DISPLAY-CNT
  1092     DISPLAY '***  ERACCT RECORDS   DELETED    = ' WS-DISPLAY-CNT
  1093
  1094     DISPLAY '***                                            ***'
  1095     DISPLAY '**************************************************'
  1096
  1097     .
  1098 4000-EXIT.
  1099     EXIT.
  1100
  1101 8510-DATE-CONVERSION.
  1102
  1103     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  1104
  1105     .
  1106 8590-EXIT.
  1107     EXIT.
  1108
  1109 9999-ABEND-RTN.
  1110
  1111     DISPLAY '*** ERACCT  FILE CONVERSION PROGRAM ABENDING ***'
  1112     DISPLAY '************************************************'
  1113
  1114     MOVE 1                      TO WS-ABEND-FLD
  1115     MOVE 0                      TO WS-ZERO-FLD
  1116
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* PEMAMF5A.cbl
  1117     COMPUTE WS-ABEND-FLD = WS-ABEND-FLD / WS-ZERO-FLD
  1118     .
  1119 9999-EXIT.
  1120     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6916     Code:        2413
