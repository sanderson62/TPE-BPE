* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIUMFMT.cbl
* Options: int("CIUMFMT.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIUMFMT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIUMFMT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIUMFMT.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         00000100
     2 PROGRAM-ID.                 CIUMFMT.                             00000200
     3                                                                  00000300
     4*AUTHOR.     CENTRAL STATES OF OMAHA.                             00000400
     5*            OMAHA, NEBR.                                         00000500
     6                                                                  00000600
     7*DATE-COMPILED.                                                   00000700
     8                                                                  00000800
     9*REMARKS.                                                         00000900
    10*    THIS PROGRAM CONVERTS UMB INPUT INFO BASED ON A CONVERSION   00001000
    11*      TABLE. FIELDS INVOLVED ARE : EFFECTIVE DATE                00001100
    12*                                   ACCOUNT NUMBER                00001200
    13*                                   CERTIFICATE NUMBER.           00001300
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIUMFMT.cbl
    14                                                                  00001400
    15*    ONLY CANCELLATION RECORDS ARE INVOLVED IN THE CHANGE.        00001500
    16*         ============ =======                                    00001600
    17                                                                  00001610
    18 ENVIRONMENT DIVISION.                                            00001700
    19 INPUT-OUTPUT SECTION.                                            00001800
    20 FILE-CONTROL.                                                    00001900
    21     SELECT  UMB-LIFE-IN     ASSIGN TO SYS010-UT-2400-S-SYS010.   00002000
    22     SELECT  UMB-LIFE-OUT    ASSIGN TO SYS012-UT-2400-S-SYS012.   00002100
    23     SELECT  CID-CONV-FILE   ASSIGN TO SYS011-UT-2400-S-SYS011.   00002200
    24                                                                  00002300



    26 DATA DIVISION.                                                   00002500
    27                                                                  00002600
    28 FILE SECTION.                                                    00002700
    29                                                                  00002800
    30******************************************************************00002900
    31**        INPUT TAPE FILE FROM UNITED MISSOURI BANK (UMB)       **00003000
    32******************************************************************00003100
    33                                                                  00003200
    34 FD  UMB-LIFE-IN                                                  00003300
    35     RECORDING MODE IS F                                          00003400
    36     LABEL RECORDS ARE STANDARD                                   00003500
    37     RECORD CONTAINS 150 CHARACTERS                               00003600
    38     BLOCK CONTAINS 0 RECORDS                                     00003700
    39     DATA RECORD IS UMB-LIFE-RECORD.                              00003800
    40                                                                  00003900
    41 01  UMB-LIFE-RECORD            PIC X(150).                       00004000
    42                                                                  00004100
    43******************************************************************00004200
    44**     INPUT CONVERSION FILE FOR UMB-TO-CSO CERT/ACCT NUMBS.    **00004300
    45******************************************************************00004400
    46                                                                  00004500
    47 FD  CID-CONV-FILE                                                00004600
    48     RECORDING MODE IS F                                          00004700
    49     LABEL RECORDS ARE STANDARD                                   00004800
    50     RECORD CONTAINS 80 CHARACTERS                                00004900
    51     BLOCK CONTAINS 0 RECORDS                                     00005000
    52     DATA RECORD IS CONV-RECORD.                                  00005100
    53                                                                  00005200
    54 01  CONV-RECORD             PIC X(80).                           00005300
    55                                                                  00005400
    56                                                                  00005500
    57******************************************************************00005600
    58**       OUTPUT CARD FILE FOR INPUT TO PROGRAM 'CIUMB511'.      **00005700
    59******************************************************************00005800
    60                                                                  00005900
    61 FD  UMB-LIFE-OUT                                                 00006000
    62     RECORDING MODE IS F                                          00006100
    63     LABEL RECORDS ARE STANDARD                                   00006200
    64     RECORD CONTAINS 150 CHARACTERS                               00006300
    65     BLOCK CONTAINS 0 RECORDS                                     00006400
    66     DATA RECORD IS CONVERTED-RECORD.                             00006500
    67                                                                  00006600
    68 01  CONVERTED-RECORD        PIC X(150).                          00006700
    69                                                                  00006800
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIUMFMT.cbl
    70******************************************************************00006900
    71******************************************************************00007000



    73                                                                  00007200
    74 WORKING-STORAGE SECTION.                                         00007300
    75 77  FILLER  PIC X(32) VALUE '********************************'.  00007400
    76 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.  00007500
    77 77  FILLER  PIC X(32) VALUE '********************************'.  00007600
    78                                                                  00007700
    79 77  C-SUB                  PIC 999       VALUE ZEROS.            00007800
    80 77  IN-CNT                 PIC 99999     VALUE ZEROS.            00007900
    81 77  RPT-CNT                PIC 9999999   VALUE ZEROS.            00008000
    82 77  TOT-LIFE-WRITTEN       PIC S9(8)V99  VALUE ZEROS.            00008100
    83 77  TOT-LIFE-CANC          PIC S9(8)V99  VALUE ZEROS.            00008200
    84 77  TOT-AH-WRITTEN         PIC S9(8)V99  VALUE ZEROS.            00008300
    85 77  TOT-AH-CANC            PIC S9(8)V99  VALUE ZEROS.            00008400
    86 77  TOT-CERT-ISS           PIC  9(5)     VALUE ZEROS.            00008500
    87 77  TOT-CERTS-CHANGED      PIC  9(5)     VALUE ZEROS.            00008600
    88 77  TOT-CERTS-NOCHANGE     PIC  9(5)     VALUE ZEROS.            00008700
    89 77  TOT-CERT-CANC          PIC  9(5)     VALUE ZEROS.            00008800
    90 77  WRT-CNT                PIC 99999     VALUE ZEROS.            00008900
    91 77  WRITE-ISS-CNT          PIC 9999      VALUE ZEROS.            00009000
    92 77  WRITE-CNC-CNT          PIC 9999      VALUE ZEROS.            00009100
    93                                                                  00009200
    94 01  FILLER   PIC X(44) VALUE                                     00009300
    95      '****  UMB CONV FILE  ****'.                                00009400
    96                                                                  00009500
    97 01  UMB-CONV-REC.                                                00009600
    98     05  UMB-C-REC                 PIC X(80).                     00009700
    99                                                                  00009800
   100 01  CONV-REC REDEFINES UMB-CONV-REC.                             00009900
   101     05  C-REC  OCCURS  400.                                      00010000
   102         10  CONV-LAST-NAME        PIC X(17).                     00010100
   103         10  CONV-CSO-CERT         PIC X(10).                     00010200
   104         10  CONV-UMB-LOAN-NO      PIC X(10).                     00010300
   105         10  CONV-CSO-ACCT-NO      PIC X(10).                     00010400
   106         10  CONV-UMB-BANK-NO      PIC X(05).                     00010500
   107         10  CONV-CSO-DATE.                                       00010600
   108             15  CONV-MO           PIC X(02).                     00010700
   109             15  CONV-DA           PIC X(02).                     00010800
   110             15  CONV-YR           PIC X(02).                     00010900
   111         10  FILLER                PIC X(22).                     00010910
   112                                                                  00011000
   113                                                                  00011100
   114 01  FILLER   PIC X(44) VALUE                                     00011200
   115      '****  UMB RECORD IN  ****'.                                00011300
   116                                                                  00011400
   117 01  UMB-IN-REC.                                                  00011500
   118     05  UMB-TRANS                 PIC X(02)     VALUE SPACES.    00011600
   119     05  UMB-ACCT.                                                00011700
   120         10  UMB-BANK-NO           PIC X(02)     VALUE SPACES.    00011800
   121         10  UMB-BRANCH-NO         PIC X(03)     VALUE SPACES.    00011900
   122     05  UMB-CERT-NO.                                             00012000
   123         10  UMB-LOAN-TYPE         PIC X(02)     VALUE SPACES.    00012100
   124         10  UMB-LOAN-NO           PIC X(08)     VALUE SPACES.    00012200
   125     05  UMB-NEW-ACCOUNT.                                         00012300
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIUMFMT.cbl
   126         10  UMB-EFF-DATE.                                        00012400
   127             15  UMB-EFF-MO        PIC X(02)     VALUE SPACES.    00012500
   128             15  UMB-EFF-DA        PIC X(02)     VALUE SPACES.    00012600
   129             15  UMB-EFF-YR        PIC X(02)     VALUE SPACES.    00012700
   130         10  UMB-ADVANCE-DATE.                                    00012800
   131             15  UMB-ADV-MO        PIC X(02)     VALUE SPACES.    00012900
   132             15  UMB-ADV-DA        PIC X(02)     VALUE SPACES.    00013000
   133             15  UMB-ADV-YR        PIC X(02)     VALUE SPACES.    00013100
   134         10  UMB-PAYMENT-DATE.                                    00013200
   135             15  UMB-PMT-MO        PIC X(02)     VALUE SPACES.    00013300
   136             15  UMB-PMT-DA        PIC X(02)     VALUE SPACES.    00013400
   137             15  UMB-PMT-YR        PIC X(02)     VALUE SPACES.    00013500
   138         10  UMB-MATURITY-DATE.                                   00013600
   139             15  UMB-MATUR-MO      PIC X(02)     VALUE SPACES.    00013700
   140             15  UMB-MATUR-DA      PIC X(02)     VALUE SPACES.    00013800
   141             15  UMB-MATUR-YR      PIC X(02)     VALUE SPACES.    00013900
   142         10  UMB-LOAN-TERM         PIC X(03)     VALUE SPACES.    00014000
   143         10  UMB-LIFE-COVG         PIC X(01)     VALUE SPACES.    00014100
   144         10  UMB-LIFE-AMT          PIC 9(06)V99  VALUE ZEROS.     00014200
   145         10  UMB-LIFE-PREM         PIC 9(05)V99  VALUE ZEROS.     00014300
   146         10  UMB-ACC-COVG          PIC X(01)     VALUE SPACES.    00014400
   147         10  UMB-ACC-BENEFIT       PIC 9(05)V99  VALUE ZEROS.     00014500
   148         10  UMB-ACC-PREM          PIC 9(05)V99  VALUE ZEROS.     00014600
   149         10  UMB-OFFICER           PIC X(02)     VALUE SPACES.    00014700
   150         10  UMB-NAME              PIC X(29)     VALUE SPACES.    00014800
   151         10  UMB-AGE               PIC X(02)     VALUE SPACES.    00014900
   152         10  UMB-NAME2             PIC X(29)     VALUE SPACES.    00015000
   153         10  UMB-AGE2              PIC X(02)     VALUE SPACES.    00015100
   154         10  FILLER                PIC X(11)     VALUE SPACES.    00015200
   155     05  UMB-ADJ-CANCEL  REDEFINES  UMB-NEW-ACCOUNT.              00015300
   156         10  UMB-ADJ-CAN-DATE.                                    00015400
   157             15  UMB-ADJ-CAN-MO    PIC X(02).                     00015500
   158             15  UMB-ADJ-CAN-DA    PIC X(02).                     00015600
   159             15  UMB-ADJ-CAN-YR    PIC X(02).                     00015700
   160         10  UMB-ADJ-LIFE-AMT      PIC 9(05)V99.                  00015800
   161         10  UMB-ADJ-ACC-AMT       PIC 9(05)V99.                  00015900
   162         10  UMB-ADJ-EFF-DATE.                                    00016000
   163             15  UMB-ADJ-EFF-MO    PIC X(02).                     00016100
   164             15  UMB-ADJ-EFF-DA    PIC X(02).                     00016200
   165             15  UMB-ADJ-EFF-YR    PIC X(02).                     00016300
   166         10  FILLER                PIC X(107).                    00016400
   167                                                                  00016500
   168 01  FILLER   PIC X(44) VALUE                                     00016600
   169      '****  UMB RECORD OUT ****'.                                00016700
   170                                                                  00016800
   171 01  OUT-RECORD.                                                  00016900
   172     05  O-TRANS                   PIC X(02)     VALUE SPACES.    00017000
   173     05  O-ACCT                    PIC X(10)     VALUE SPACES.    00017100
   174     05  O-CERT-NO                 PIC X(10)     VALUE SPACES.    00017200
   175     05  O-MISC                    PIC X(128)    VALUE SPACES.    00017300
   176     05  O-ADJ-CANCEL  REDEFINES  O-MISC.                         00017400
   177         10  O-ADJ-CAN-DATE.                                      00017500
   178             15  O-ADJ-CAN-MO    PIC X(02).                       00017600
   179             15  O-ADJ-CAN-DA    PIC X(02).                       00017700
   180             15  O-ADJ-CAN-YR    PIC X(02).                       00017800
   181         10  O-ADJ-LIFE-AMT      PIC 9(05)V99.                    00017900
   182         10  O-ADJ-ACC-AMT       PIC 9(05)V99.                    00018000
   183         10  O-ADJ-EFF-DATE.                                      00018100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIUMFMT.cbl
   184             15  O-ADJ-EFF-MO    PIC X(02).                       00018200
   185             15  O-ADJ-EFF-DA    PIC X(02).                       00018300
   186             15  O-ADJ-EFF-YR    PIC X(02).                       00018400
   187         10  FILLER                PIC X(102).                    00018500
   188                                                                  00018600
   189                                                                  00018700
   190 01  WORK-ACCT.                                                   00018800
   191     05 WORK-ACCT-1ST-5     PIC X(05)     VALUE SPACES.           00018900
   192     05 WORK-ACCT-L5        PIC X(05)     VALUE SPACES.           00019000
   193                                                                  00019100
   194 01  WK-DATE.                                                     00019200
   195     05  WK-MO               PIC XX     VALUE SPACES.             00019300
   196     05  FILLER              PIC X      VALUE SPACES.             00019400
   197     05  WK-DA               PIC XX     VALUE SPACES.             00019500
   198     05  FILLER              PIC X      VALUE SPACES.             00019600
   199     05  WK-YR               PIC XX     VALUE SPACES.             00019700
   200                                                                  00019800
   201 01  WORK-DATE.                                                   00019900
   202     12  WORK-DATE-X.                                             00020000
   203         15  WORK-MO-X       PIC XX.                              00020100
   204         15  WORK-DA-X       PIC XX.                              00020200
   205         15  WORK-YR-X       PIC XX.                              00020300
   206     12  WORK-DATE-N    REDEFINES   WORK-DATE-X.                  00020400
   207         15  WORK-MO-N       PIC 99.                              00020500
   208         15  WORK-DA-N       PIC 99.                              00020600
   209         15  WORK-YR-N       PIC 99.                              00020700
   210                                                                  00020800
   211     12  WORK-DATE-IN.                                            00020400
   212         15  WORK-YR-IN      PIC 99.                              00020700
   213         15  WORK-MO-IN      PIC 99.                              00020500
   214         15  WORK-DA-IN      PIC 99.                              00020600
   215                                                                  00020800



   217                                                                  00021000
   218******************************************************************00021100



   220 PROCEDURE DIVISION.                                              00021300



   222                                                                  00021500
   223* *  START INPUT-ROUTINE PROCESSING.                              00021600
   224                                                                  00021700
   225     ACCEPT WORK-DATE-IN  FROM  DATE.                             00021800
   226                                                                  00021900
   227     MOVE   WORK-YR-IN  TO  WORK-YR-N.                            00021800
   228     MOVE   WORK-MO-IN  TO  WORK-MO-N.                            00021800
   229     MOVE   WORK-DA-IN  TO  WORK-DA-N.                            00021800
   230                                                                  00021900
   231     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'.     00022000
   232     DISPLAY '*   CURRENT DATE IS -- ' WK-DATE.                   00022100
   233     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'.     00022200
   234                                                                  00022300
   235 PROCESS-CONV-FILE.                                               00022400
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIUMFMT.cbl
   236                                                                  00022500
   237     MOVE ZEROS TO C-SUB.                                         00022600
   238                                                                  00022700
   239     OPEN INPUT    CID-CONV-FILE.                                 00022800
   240                                                                  00022900
   241 READ-CONV-FILE.                                                  00023000
   242                                                                  00023100
   243      READ         CID-CONV-FILE                                  00023200
   244         AT END                                                   00023300
   245             DISPLAY '   '                                        00023400
   246             DISPLAY 'CONV FILE AT END - RCD COUNT = ' C-SUB      00023500
   247             DISPLAY '   '                                        00023600
   248             CLOSE CID-CONV-FILE                                  00023700
   249             GO TO CONT-NORMAL-PROCESSING.                        00023800
   250                                                                  00023900
   251      ADD  1  TO C-SUB.                                           00024000
   252                                                                  00024100
   253      IF   C-SUB  >  400                                          00024200
   254           DISPLAY '   '                                          00024300
   255           DISPLAY 'CONV FILE HAS MORE THAN 400 RCDS '            00024400
   256           DISPLAY 'CONV FILE TABLE MUST BE INCREASED'            00024410
   257           DISPLAY 'CONV FILE RECORD COUNT IS - ' C-SUB           00024500
   258           DISPLAY '   '                                          00024600
   259           GO  TO  READ-CONV-FILE.                                00024700
   260                                                                  00024800
   261      MOVE CONV-RECORD  TO  C-REC (C-SUB).                        00024900
   262                                                                  00025000
   263      GO  TO  READ-CONV-FILE.                                     00025100
   264                                                                  00025200
   265 CONT-NORMAL-PROCESSING.                                          00025300
   266                                                                  00025400
   267     OPEN  INPUT     UMB-LIFE-IN.                                 00025500
   268                                                                  00025600
   269     OPEN  OUTPUT    UMB-LIFE-OUT.                                00025700
   270                                                                  00025800
   271     MOVE  WK-MO     TO   WORK-MO-X.                              00025900
   272     MOVE  WK-YR     TO   WORK-YR-X.                              00026000
   273     MOVE  WK-DA     TO   WORK-DA-X.                              00026100
   274                                                                  00026200
   275     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'.     00026300
   276     DISPLAY '*   WORK-DATE-X  IS -- ' WORK-DATE-X.               00026400
   277     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'.     00026500
   278                                                                  00026600
   279 010-READ-INPUT-FILE.                                             00026700
   280                                                                  00026800
   281*    DISPLAY ' '.                                                 00026900
   282*    DISPLAY '  010-READ-INPUT ENTERED '.                         00027000
   283                                                                  00027100
   284      READ UMB-LIFE-IN                                            00027200
   285         INTO  UMB-IN-REC                                         00027300
   286             AT END                                               00027400
   287              DISPLAY ' "READ" AT END INPUT COUNT  = ' IN-CNT     00027500
   288              DISPLAY '"WRITE" AT END OUTPUT COUNT = ' WRT-CNT    00027600
   289                GO TO END-OF-JOB.                                 00027700
   290                                                                  00027800
   291*    DISPLAY ' '.                                                 00027900
   292*    DISPLAY 'UMB-IN-REC (ORIG) ' UMB-IN-REC.                     00028000
   293                                                                  00028100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIUMFMT.cbl
   294      IF  UMB-BANK-NO  = '06' OR '08' OR '31' OR '53' OR '56'     00028200
   295          MOVE '30' TO UMB-BANK-NO.                               00028300
   296**           DISPLAY ' '                                          00028400
   297**              DISPLAY 'UMB-IN-REC (CHGD) ' UMB-IN-REC.          00028500
   298                                                                  00028600
   299                                                                  00028700
   300      ADD  1  TO IN-CNT.                                          00028800
   301                                                                  00028900
   302 GET-RECORDS.                                                     00029000
   303                                                                  00029100
   304*    DISPLAY 'GET-RECORDS  ENTERED '.                             00029200
   305                                                                  00029300
   306*  CK-TYPE-30.                                                    00029400
   307                                                                  00029500
   308     IF  UMB-TRANS      = 30                                      00029600
   309*      DISPLAY 'REC TYPE 30 FOUND'                                00029700
   310         GO  TO  CANCEL-BLD.                                      00029800
   311                                                                  00029900
   312*  CK-TYPE-20.                                                    00030000
   313                                                                  00030100
   314     IF  UMB-TRANS      = 20                                      00030200
   315*        DISPLAY 'REC TYPE 20 FOUND'                              00030300
   316         GO TO PROCESS-ISSUES.                                    00030400
   317                                                                  00030500
   318 REC-TYPE-ERROR.                                                  00030600
   319                                                                  00030700
   320     DISPLAY ' '.                                                 00030800
   321     DISPLAY 'REC-TYPE-ERROR  ENTERED'.                           00030900
   322                                                                  00031000
   323     ADD     1   TO  RPT-CNT.                                     00031100
   324                                                                  00031200
   325     DISPLAY '******************************************'         00031300
   326     DISPLAY ' '                                                  00031400
   327     DISPLAY 'ERROR RECORD - RECORD IS BYPASSED '                 00031500
   328     DISPLAY ' '                                                  00031600
   329     DISPLAY 'INPUT RECORD NUMBER IS '  IN-CNT.                   00031700
   330     DISPLAY ' '                                                  00031800
   331     DISPLAY 'UMB-TRANS = ' UMB-TRANS.                            00031900
   332     DISPLAY ' '                                                  00032000
   333     DISPLAY 'UMB-LIFE-RECORD     = ' UMB-LIFE-RECORD             00032100
   334     DISPLAY ' '                                                  00032200
   335     DISPLAY '******************************************'         00032300
   336                                                                  00032400
   337     GO TO 010-READ-INPUT-FILE.                                   00032500
   338                                                                  00032600
   339 PROCESS-ISSUES.                                                  00032700
   340                                                                  00032800
   341*    DISPLAY 'PROCESS-ISSUES       ENTERED '.                     00032900
   342                                                                  00033000
   343* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00033100
   344* * * * * * * *      START ISSUE PROCESSING     * * * * * * * *   00033200
   345* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00033300
   346                                                                  00033400
   347*                ICARD                                            00033500
   348                                                                  00033600
   349*    DISPLAY 'ISSUE-BLD           ENTERED  '.                     00033700
   350                                                                  00033800
   351*    DISPLAY ' '.                                                 00033900
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIUMFMT.cbl
   352*    DISPLAY 'UMB-IN-REC (ISS ) ' UMB-IN-REC.                     00034000
   353                                                                  00034100
   354* * * * * * *    BUILD THE CSO INPUT RECORDS   * * * * * * * *.   00034200
   355                                                                  00034300
   356      IF    UMB-LIFE-PREM  NOT  NUMERIC                           00034400
   357            MOVE  ZEROS  TO  UMB-LIFE-PREM.                       00034500
   358                                                                  00034600
   359      IF    UMB-ACC-PREM  NOT  NUMERIC                            00034700
   360            MOVE  ZEROS  TO  UMB-ACC-PREM.                        00034800
   361                                                                  00034900
   362     ADD    1                  TO  TOT-CERT-ISS.                  00035000
   363                                                                  00035100
   364     MOVE   UMB-TRANS          TO  O-TRANS.                       00035200
   365     MOVE   UMB-ACCT           TO  WORK-ACCT-L5.                  00035300
   366     MOVE   ZEROS              TO  WORK-ACCT-1ST-5.               00035400
   367     MOVE   WORK-ACCT          TO  O-ACCT.                        00035500
   368     MOVE   UMB-CERT-NO        TO  O-CERT-NO.                     00035600
   369     MOVE   UMB-NEW-ACCOUNT    TO  O-MISC.                        00035700
   370     ADD    UMB-LIFE-PREM      TO  TOT-LIFE-WRITTEN.              00035800
   371     ADD    UMB-ACC-PREM       TO  TOT-AH-WRITTEN.                00035900
   372                                                                  00036000
   373                                                                  00036100
   374*    DISPLAY 'WRITE ISSUE RECORD '.                               00036200
   375                                                                  00036300
   376*    DISPLAY  OUT-RECORD.                                         00036400
   377                                                                  00036500
   378     ADD  1  TO WRITE-ISS-CNT.                                    00036600
   379     ADD  1  TO WRT-CNT.                                          00036700
   380                                                                  00036800
   381     WRITE CONVERTED-RECORD    FROM OUT-RECORD.                   00036900
   382                                                                  00037000
   383     GO  TO  010-READ-INPUT-FILE.                                 00037400
   384                                                                  00037500
   385                                                                  00037600
   386* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00037700
   387* * * * * * * * *   END  ISSUE   PROCESSING   * * * * * * * * *   00037800
   388* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00037900
   389                                                                  00038000
   390                                                                  00038100
   391* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00038200
   392* * * * * * * *   START  CANCELLATION PROCESSING  * * * * * * *   00038300
   393* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00038400
   394                                                                  00038500
   395*                   ACARD                                         00038600
   396 CANCEL-BLD.                                                      00038700
   397                                                                  00038800
   398                                                                  00038900
   399*    DISPLAY 'CANCEL-BLD   ENTERED '.                             00039000
   400                                                                  00039100
   401*    DISPLAY ' '.                                                 00039200
   402*    DISPLAY 'UMB-IN-REC (CANC) ' UMB-IN-REC.                     00039300
   403                                                                  00039400
   404     ADD    1                  TO  TOT-CERT-CANC.                 00039500
   405                                                                  00039600
   406      IF    UMB-ADJ-LIFE-AMT  NOT  NUMERIC                        00039700
   407            MOVE  ZEROS  TO  UMB-ADJ-LIFE-AMT.                    00039800
   408                                                                  00039900
   409      IF    UMB-ADJ-ACC-AMT   NOT  NUMERIC                        00040000
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIUMFMT.cbl
   410            MOVE  ZEROS  TO  UMB-ADJ-ACC-AMT.                     00040100
   411                                                                  00040200
   412     MOVE   UMB-IN-REC         TO  OUT-RECORD.                    00040300
   413                                                                  00040400
   414 CK-FOR-CONVERSION.                                               00040500
   415                                                                  00040600
   416*    DISPLAY  'CK-FOR-CONVERSION ENTERED ' UMB-IN-REC.            00040700
   417                                                                  00040800
   418     MOVE ZEROS  TO C-SUB.                                        00040900
   419                                                                  00041000
   420 CONVERSION-LOOP.                                                 00041100
   421                                                                  00041200
   422     ADD  1      TO C-SUB.                                        00041300
   423                                                                  00041400
   424     IF   C-SUB   >   400                                         00041500
   425          GO TO CK-FOR-CONVERSION-EXIT.                           00041600
   426                                                                  00041700
   427     IF   CONV-UMB-LOAN-NO (C-SUB)  =  UMB-CERT-NO                00041800
   428          NEXT  SENTENCE                                          00041900
   429       ELSE                                                       00042000
   430          GO TO CONVERSION-LOOP.                                  00042100
   431                                                                  00042200
   432     ADD  1      TO TOT-CERTS-CHANGED.                            00042300
   433                                                                  00042400
   434     DISPLAY  '   '.                                              00042500
   435     DISPLAY  'RECORDS MATCH  -   UMB-IN =  ' UMB-IN-REC.         00042600
   436     DISPLAY  '               - CONV-REC =  ' C-REC (C-SUB).      00042700
   437                                                                  00042800
   438     MOVE  UMB-ADJ-CAN-DATE           TO  O-ADJ-CANCEL.           00042810
   439                                                                  00042820
   440*    MOVE   CONV-YR (C-SUB)           TO  O-ADJ-EFF-YR.           00042900
   441*    MOVE   CONV-MO (C-SUB)           TO  O-ADJ-EFF-MO            00043000
   442*    MOVE   CONV-DA (C-SUB)           TO  O-ADJ-EFF-DA.           00043100
   443                                                                  00043200
   444     MOVE   CONV-CSO-DATE (C-SUB)    TO  O-ADJ-EFF-DATE.          00043210
   445                                                                  00043220
   446     MOVE   CONV-CSO-ACCT-NO (C-SUB)  TO  O-ACCT.                 00043300
   447                                                                  00043400
   448     MOVE   CONV-CSO-CERT (C-SUB)     TO  O-CERT-NO.              00043500
   449                                                                  00043510
   450     MOVE  UMB-ADJ-LIFE-AMT           TO  O-ADJ-LIFE-AMT.         00043520
   451     MOVE  UMB-ADJ-ACC-AMT            TO  O-ADJ-ACC-AMT.          00043530
   452                                                                  00043600
   453     DISPLAY  '   '.                                              00043900
   454     DISPLAY  'CHANGED UMB OUT RECORD NOW =  ' OUT-RECORD.        00044000
   455                                                                  00044100
   456     GO TO CONT-CANCEL-REC.                                       00044200
   457                                                                  00044300
   458 CK-FOR-CONVERSION-EXIT.                                          00044400
   459                                                                  00044500
   460*    DISPLAY  '   '.                                              00044600
   461*    DISPLAY  'NO CHANGE MADE -   UMB-IN =  ' UMB-IN-REC.         00044700
   462                                                                  00044800
   463     ADD  1      TO TOT-CERTS-NOCHANGE.                           00044900
   464                                                                  00045000
   465     MOVE   UMB-ADJ-CAN-MO            TO  O-ADJ-CAN-MO.           00045100
   466     MOVE   UMB-ADJ-CAN-DA            TO  O-ADJ-CAN-DA            00045200
   467     MOVE   UMB-ADJ-CAN-YR            TO  O-ADJ-CAN-YR.           00045300
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CIUMFMT.cbl
   468                                                                  00045400
   469     MOVE   UMB-TRANS                 TO  O-TRANS.                00045500
   470     MOVE   UMB-ACCT                  TO  WORK-ACCT-L5.           00045600
   471     MOVE   ZEROS                     TO  WORK-ACCT-1ST-5.        00045700
   472     MOVE   WORK-ACCT                 TO  O-ACCT.                 00045800
   473     MOVE   UMB-CERT-NO               TO  O-CERT-NO.              00045900
   474                                                                  00046000
   475     MOVE  UMB-ADJ-CANCEL             TO  O-ADJ-CANCEL.           00046100
   476                                                                  00046200
   477 CONT-CANCEL-REC.                                                 00046300
   478                                                                  00046400
   479     ADD   UMB-ADJ-LIFE-AMT           TO  TOT-LIFE-CANC.          00046500
   480     ADD   UMB-ADJ-ACC-AMT            TO  TOT-AH-CANC.            00046600
   481                                                                  00046700
   482     ADD  1  TO WRITE-CNC-CNT.                                    00046800
   483     ADD  1  TO WRT-CNT.                                          00046900
   484                                                                  00047000
   485*    DISPLAY  '   '.                                              00047100
   486*    DISPLAY  'WRITE CANCELLED RECORD '.                          00047200
   487                                                                  00047300
   488*    DISPLAY   OUT-RECORD.                                        00047400
   489                                                                  00047500
   490     WRITE CONVERTED-RECORD           FROM  OUT-RECORD.           00047600
   491                                                                  00047700
   492     GO  TO  010-READ-INPUT-FILE.                                 00048100
   493                                                                  00048200
   494* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00048300
   495* * * * * * * *   END  CANCELLATION PROCESSING  * * * * * * * *   00048400
   496* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *   00048500
   497                                                                  00048600



   499 END-OF-JOB SECTION.                                              00048800
   500                                                                  00048900
   501     DISPLAY 'END-OF-JOB       ENTERED '.                         00049000
   502                                                                  00049100
   503     DISPLAY '************************************************'   00049200
   504     DISPLAY ' '.                                                 00049300
   505     DISPLAY 'CONVERSION  RUN  TOTALS  AND  COUNTS '.             00049400
   506     DISPLAY '==================================== '.             00049500
   507     DISPLAY ' '.                                                 00049600
   508     DISPLAY 'INPUT RECORDS          -- ' IN-CNT.                 00049700
   509     DISPLAY ' '.                                                 00049800
   510     DISPLAY 'WRITE RECORDS          -- ' WRT-CNT.                00049900
   511     DISPLAY ' '.                                                 00050000
   512     DISPLAY 'ISSUE WRITE COUNT      -- ' WRITE-ISS-CNT.          00050100
   513     DISPLAY ' '.                                                 00050200
   514     DISPLAY 'CANCEL WRITE COUNT     -- ' WRITE-CNC-CNT.          00050300
   515     DISPLAY ' '.                                                 00050400
   516     DISPLAY 'ERROR RECORD COUNT     -- ' RPT-CNT.                00050500
   517     DISPLAY ' '.                                                 00050600
   518     DISPLAY 'TOTAL ISSUES           -- ' TOT-CERT-ISS.           00050700
   519     DISPLAY ' '.                                                 00050800
   520     DISPLAY 'TOTAL CANCELS          -- ' TOT-CERT-CANC.          00050900
   521     DISPLAY ' '.                                                 00051000
   522     DISPLAY 'TOTAL CERTS NOCHANGE   -- ' TOT-CERTS-NOCHANGE.     00051100
   523     DISPLAY ' '.                                                 00051200
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CIUMFMT.cbl
   524     DISPLAY 'TOTAL CERTS CHANGED    -- ' TOT-CERTS-CHANGED.      00051300
   525     DISPLAY ' '.                                                 00051400
   526     DISPLAY 'TOTAL LIFE PREM        -- ' TOT-LIFE-WRITTEN.       00051500
   527     DISPLAY ' '.                                                 00051600
   528     DISPLAY 'TOTAL A&H PREM         -- ' TOT-AH-WRITTEN.         00051700
   529     DISPLAY ' '.                                                 00051800
   530     DISPLAY 'TOTAL LIFE CANCELS     -- ' TOT-LIFE-CANC.          00051900
   531     DISPLAY ' '.                                                 00052000
   532     DISPLAY 'TOTAL AH CANCELS       -- ' TOT-AH-CANC.            00052100
   533     DISPLAY ' '.                                                 00052200
   534     DISPLAY '************************************************'.  00052300
   535                                                                  00052400
   536     CLOSE   UMB-LIFE-IN                                          00052500
   537             UMB-LIFE-OUT.                                        00052600
   538                                                                  00052700
   539     GOBACK.                                                      00052800
   540                                                                  00052900
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       34924     Code:        3022
