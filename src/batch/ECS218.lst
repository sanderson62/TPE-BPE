* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS218.cbl
* Options: int("ECS218.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS218.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS218.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS218.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. ECS218.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT CREDIT         ASSIGN TO SYS011.
    10     SELECT NON-CREDIT     ASSIGN TO SYS012.
    11     SELECT PRNTR          ASSIGN TO SYS008.
    12     SELECT CERT-FILE      ASSIGN TO SYS010.
    13     SELECT DISK-DATE      ASSIGN TO SYS019.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS218.cbl
    14
    15 DATA DIVISION.
    16 FILE SECTION.
    17
    18 FD  CREDIT
    19     BLOCK CONTAINS 0 RECORDS
    20     RECORDING MODE F.
    21
    22 01  CREDIT-REC              PIC X(1056).
    23
    24 FD  NON-CREDIT
    25     BLOCK CONTAINS 0 RECORDS
    26     RECORDING MODE F.
    27
    28 01  NON-CREDIT-REC          PIC X(1056).
    29
    30
    31 FD  PRNTR
*   32                             COPY ELCPRTFD.
    33******************************************************************04/15/98
    34*                                                                *ELCPRTFD
    35*                                                                *ELCPRTFD
    36*                            ELCPRTFD.                           *   LV003
    37*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    38*                            VMOD=2.006                          *ELCPRTFD
    39******************************************************************ELCPRTFD
    40     RECORDING MODE F                                             ELCPRTFD
    41     LABEL RECORDS OMITTED                                        ELCPRTFD
    42     BLOCK CONTAINS 0 RECORDS
    43     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    44 01  PRT.                                                         ELCPRTFD
    45     12  P-CTL               PIC  X.                                 CL**2
    46     12  P-DATA              PIC  X(132).                         ELCPRTFD
    47******************************************************************ELCPRTFD
    48
    49 FD  CERT-FILE
    50     BLOCK CONTAINS 0 RECORDS
    51     RECORDING MODE F.
    52
*   53                             COPY ECSCRT01.
    54******************************************************************
    55*                                                                *
    56*                            ECSCRT01                            *
    57*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    58*                            VMOD=2.016                          *
    59*                                                                *
    60*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    61*                                                                *
    62*   FILE TYPE = SEQUENTIAL
    63*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    64*                                                                *
    65*   KEY DATA =                         START=4, LEN=36           *
    66*                                                                *
    67*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    68*                                                                *
    69******************************************************************
    70******************************************************************
    71*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    72*
    73* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    74*-----------------------------------------------------------------
    75*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    76* EFFECTIVE    NUMBER
    77*-----------------------------------------------------------------
    78* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    79* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    80* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    81* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    82* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    83* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    84* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    85* 032612  CR2011110200001  PEMA  AHL CHANGES
    86* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    87* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    88******************************************************************
    89
    90 01  CERTIFICATE-RECORD.
    91     12  CR-RECORD-ID                      PIC XX.
    92         88  VALID-CR-ID                      VALUE 'CR'.
    93
    94     12  CR-COMPANY-CD                     PIC X.
    95
    96     12  CR-FULL-CONTROL.
    97         16  CR-CONTROL-1.
    98             20  CR-ACCT-CONTROL.
    99                 24  CR-CARRIER            PIC X.
   100                 24  CR-GROUPING.
   101                     28  CR-GROUP-PREFIX   PIC XXX.
   102                     28  CR-GROUP-PRIME    PIC XXX.
   103                 24  CR-STATE              PIC XX.
   104                 24  CR-ACCOUNT.
   105                     28  CR-ACCT-PREFIX    PIC X(4).
   106                     28  CR-ACCT-PRIME     PIC X(6).
   107             20  CR-DT                     PIC 9(11)  COMP-3.
   108         16  CR-CERT-NO.
   109             20  CR-CERT.
   110                 24  CR-CERT-PREFIX        PIC X(3).
   111                 24  CR-CERT-PRIME         PIC X(7).
   112             20  CR-CERT-SFX               PIC X.
   113
   114     12  CR-INSUREDS-PROFILE.
   115         16  CR-NAME.
   116             20  CR-LNAME                  PIC X(15).
   117             20  CR-FNAME.
   118                 24  CR-1ST-INITIAL        PIC X.
   119                 24  FILLER                PIC X(9).
   120             20  CR-INIT                   PIC X.
   121         16  CR-AGE                        PIC 99.
   122         16  CR-SEX                        PIC X.
   123             88  CR-SEX-MALE                  VALUE 'M'.
   124             88  CR-SEX-FEMALE                VALUE 'F'.
   125         16  CR-SOC-SEC                    PIC X(11).
   126         16  CR-JOINT-NAME.
   127             20  CR-JT-LNAME               PIC X(15).
   128             20  CR-JT-FNAME.
   129                 24  CR-JT-1ST-INIT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   130                 24  FILLER                PIC X(9).
   131             20  CR-JT-INIT                PIC X.
   132         16  CR-JOINT-AGE                  PIC 99.
   133
   134         16  cr-ahl-ah-claim-no            pic x(9).
   135         16  cr-ahl-ah-cert-seq            pic x(3).
   136         16  cr-hst-proc-lf                pic x.
   137         16  f                             pic x(7).
   138
   139     12  CR-LF-COVERAGE-DATA.
   140         16  CR-LFTYP                      PIC XX.
   141         16  CR-LF-TERM                    PIC S999       COMP-3.
   142         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   143         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   144         16  CR-LF-DEV-CODE                PIC XXX.
   145         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   146
   147         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   148         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   149         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   150         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   151
   152         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   153         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   154         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   155         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   156
   157         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   158         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   159
   160         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   161         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   162
   163         16  CR-LF-REFUND-TYPE             PIC X.
   164         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   165
   166         16  CR-LF-COMM-CHARGEBACK         PIC X.
   167             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   168
   169         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   170
   171         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   172         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   173         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   174
   175         16  cr-ahl-lf-claim-no            pic x(9).
   176         16  cr-ahl-lf-cert-seq            pic x(3).
   177         16  FILLER                        PIC XX.
   178
   179     12  CR-AH-COVERAGE-DATA.
   180         16  CR-AHTYP                      PIC XX.
   181         16  CR-AH-TERM                    PIC S999       COMP-3.
   182         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   183         16  CR-AH-DEV-CODE                PIC XXX.
   184         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   185
   186         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   187         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   188         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   189         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   190
   191         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   192         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   193
   194         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   195         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   196
   197         16  CR-AH-REFUND-TYPE             PIC X.
   198         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   199
   200         16  CR-AH-COMM-CHARGEBACK         PIC X.
   201             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   202
   203         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   204
   205         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   206         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   207         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   208
   209         16  FILLER                        PIC XX.
   210*        16  FILLER                        PIC X(8).
   211
   212     12  CR-LOAN-DATA.
   213         16  CR-LIVES                      PIC S9(7)      COMP-3.
   214         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   215                                           PIC S9(5)V99   COMP-3.
   216         16  CR-BILLED                     PIC S9(7)      COMP-3.
   217         16  CR-APR                        PIC S999V9(4)  COMP-3.
   218         16  CR-PMT-FREQ                   PIC 99.
   219         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   220         16  CR-RATING-CLASS               PIC XX.
   221         16  CR-POLICY-FORM-NO             PIC X(12).
   222         16  CR-GRPTYP                     PIC XX.
   223         16  CR-IND-GRP                    PIC X.
   224             88  CR-INDIVIDUAL                VALUE '1'.
   225             88  CR-GROUP                     VALUE '2'.
   226         16  CR-SKIP                       PIC 99.
   227             88  NO-MONTHS-SKIPPED            VALUE 00.
   228             88  SKIP-JULY                    VALUE 01.
   229             88  SKIP-AUGUST                  VALUE 02.
   230             88  SKIP-SEPTEMBER               VALUE 03.
   231             88  SKIP-JULY-AUG                VALUE 04.
   232             88  SKIP-AUG-SEPT                VALUE 05.
   233             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   234             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   235             88  SKIP-JUNE                    VALUE 08.
   236             88  SKIP-JUNE-JULY               VALUE 09.
   237             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   238             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   239         16  CR-RESIDENT-STATE             PIC XX.
   240         16  CR-RATE-CODE.
   241             20  CR-LF-CLASS-CD            PIC XX.
   242             20  CR-AH-CLASS-CD            PIC XX.
   243         16  CR-MORT.
   244             20  CR-TAB                    PIC X.
   245             20  CR-INT                    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   246             20  CR-GRP                    PIC X.
   247         16  CR-MEMBER-NO                  PIC X(12).
   248         16  CR-OLD-LOF                    PIC XXX.
   249*        16  CR-LOAN-OFFICER               PIC XXX.
   250         16  CR-REIN-TABLE                 PIC XXX.
   251         16  CR-REIN-SPEC                  PIC X.
   252         16  CR-LOAN-1ST-PMT-DT.
   253             20  CR-1ST-PMT-YR             PIC 99.
   254             20  CR-1ST-PMT-MO             PIC 99.
   255             20  CR-1ST-PMT-DA             PIC 99.
   256         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   257         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   258         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   259         16  CR-LAST-ADD-ON-DT             PIC XX.
   260
   261         16  CR-UNDERWRITING-CODE          PIC X.
   262             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   263
   264         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   265         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   266         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   267         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   268
   269     12  CR-STATUS-INFORMATION.
   270         16  CR-ENTRY-STATUS               PIC X.
   271             88  CR-NORMAL-ENTRY              VALUE '1'.
   272             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   273             88  CR-CONVERSION-ENTRY          VALUE '4'.
   274             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   275             88  CR-POLICY-IS-CASH            VALUE 'C'.
   276             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   277             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   278             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   279             88  CR-POLICY-IS-VOID            VALUE 'V'.
   280             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   281             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   282                                                'C' '5' '9' 'P'.
   283         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   284
   285         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   286         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   287         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   288
   289         16  CR-LF-STATUS-AT-DEATH         PIC X.
   290         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   291
   292         16  CR-LF-CURRENT-STATUS          PIC X.
   293             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   294             88  CR-LF-POLICY-PENDING         VALUE '2'.
   295             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   296             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   297             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   298             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   299             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   300             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   301             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   302             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   303             88  CR-LF-IS-DECLINED            VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   304             88  CR-LF-IS-VOID                VALUE 'V'.
   305             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   306                                                    '4' '5' '9'.
   307
   308         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   309
   310         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   311         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   312
   313         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   314         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   315
   316         16  CR-AH-CURRENT-STATUS          PIC X.
   317             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   318             88  CR-AH-POLICY-PENDING         VALUE '2'.
   319             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   320             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   321             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   322             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   323             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   324             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   325             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   326             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   327             88  CR-AH-IS-DECLINED            VALUE 'D'.
   328             88  CR-AH-IS-VOID                VALUE 'V'.
   329             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   330                                                    '4' '5' '9'.
   331         16  CR-LOAN-OFFICER               PIC X(5).
   332         16  CR-CANCEL-REASON              PIC X.
   333         16  cr-xycor-lf-cov-code          pic x(4).
   334         16  cr-xycor-ah-cov-code          pic x(4).
   335         16  cr-temp-epiq                  pic x(4).
   336         16  FILLER                        PIC XX.
   337
   338     12  CR-DEATH-CLAIM-DATA.
   339         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   340
   341         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   342         16  CR-DTH-RPT-DT.
   343             20  CR-DTH-RPT-YR             PIC 99.
   344             20  CR-DTH-RPT-MO             PIC 99.
   345             20  CR-DTH-RPT-DA             PIC 99.
   346         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   347
   348         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   349         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   350         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   351         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   352         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   353
   354         16  CR-DTH-AGE                    PIC 99.
   355         16  CR-DTH-PAY-CD                 PIC X.
   356         16  CR-DEATH-CAUSE                PIC X(6).
   357
   358         16  FILLER                        PIC X(16).
   359
   360     12  CR-DISAB-CLAIM-DATA.
   361         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   362
   363         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   364         16  CR-DIS-RPT-DT.
   365             20  CR-DIS-RPT-YR             PIC 99.
   366             20  CR-DIS-RPT-MO             PIC 99.
   367             20  CR-DIS-RPT-DA             PIC 99.
   368         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   369         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   370
   371         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   372         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   373         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   374         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   375         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   376
   377         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   378         16  CR-DIS-PAY-CD                 PIC X.
   379         16  FILLER                        PIC XX.
   380
   381         16  CR-DISAB-INCURRED-DETAIL.
   382             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   383**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   384                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   385                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   386                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   387
   388         16  CR-DISAB-CAUSE                PIC X(6).
   389         16  FILLER                        PIC X(14).
   390
   391     12  CR-REMIT-TO                       PIC 99.
   392
   393     12  CR-COMPENSATION-LEVELS.
   394         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   395             20  CR-COM-AGT.
   396                 24  CR-COM-AGT-PREFIX     PIC X(4).
   397                 24  CR-COM-AGT-PRIME      PIC X(6).
   398             20  CR-AGT-TYPE               PIC X.
   399             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   400             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   401
   402     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   403     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   404     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   405     12  CR-CLP-STATE                      PIC XX.
   406     12  CR-POST-CARD-IND                  PIC X.
   407     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   408     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   409     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   410     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   411     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   412     12  FILLER                            PIC X(07).
   413
   414     12  CR-CSR-CODE                       PIC XXX.
   415
   416     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   417     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   418
   419     12  CR-MICROFILM-NUMBERS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS218.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   420*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   421         16  FILLER                        PIC X(5).
   422     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   423
   424     12  CR-USER-CODE                      PIC X.
   425     12  CR-USER-FUTURE                    PIC X(9).
   426
   427     12  CR-BENEFICIARY.
   428         16  CR-BANK-NO                    PIC X(10).
   429         16  FILLER                        PIC X(15).
   430
   431     12  CR-ENTRY-BATCH                    PIC X(6).
   432     12  CR-LF-EXIT-BATCH                  PIC X(6).
   433     12  CR-AH-EXIT-BATCH                  PIC X(6).
   434
   435     12  CR-NOTE-SW                        PIC X.
   436
   437     12  CR-ORIGIN-INDICATOR               PIC X.
   438         88  CR-ENTERED-MANUALLY              VALUE '1'.
   439         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   440
   441     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   442     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   443     12  FILLER                            PIC X(33).
   444
   445******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS218.cbl
   447 FD  DISK-DATE
*  448                             COPY ELCDTEFD.
   449******************************************************************04/15/98
   450*                                                                *ELCDTEFD
   451*                                                                *ELCDTEFD
   452*                            ELCDTEFD.                           *   LV002
   453*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   454*                            VMOD=2.007                          *   CL**2
   455*                                                                *ELCDTEFD
   456******************************************************************ELCDTEFD
   457     BLOCK CONTAINS 0 RECORDS
   458     RECORDING MODE F.                                            ELCDTEFD
   459                                                                  ELCDTEFD
   460 01  DATE-DISK.                                                   ELCDTEFD
   461     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   462     12  FILLER                      PIC  X(14).                  ELCDTEFD
   463     12  DD-CR1                      PIC  9.                      ELCDTEFD
   464     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   465     12  DD-CR2                      PIC  9.                      ELCDTEFD
   466     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   467     12  FILLER                      PIC  X(20).                  ELCDTEFD
   468                                                                  ELCDTEFD
   469 01  DATE-DISK-R.                                                 ELCDTEFD
   470     12  FILLER                      PIC  X(4).                   ELCDTEFD
   471     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   472                                     PIC  X(32).                  ELCDTEFD
   473                                                                  ELCDTEFD
   474 01  DATE-DISK-T.                                                 ELCDTEFD
   475     12  FILLER                      PIC  X(4).                   ELCDTEFD
   476     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   477                                     PIC  X(48).                  ELCDTEFD
   478                                                                  ELCDTEFD
   479 01  DATE-DISK-M.                                                 ELCDTEFD
   480     12  FILLER                      PIC  X(4).                   ELCDTEFD
   481     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   482                                     PIC  X(48).                  ELCDTEFD
   483                                                                  ELCDTEFD
   484 01  DATE-DISK-P.                                                 ELCDTEFD
   485     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   486     12  DD-IDX                      PIC  99.                     ELCDTEFD
   487     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   488     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   489         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   490                                     PIC  X.                      ELCDTEFD
   491         16  FILLER                  PIC  X(46).                  ELCDTEFD
   492     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   493         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   494             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   495             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   496             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   497             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   498         16  FILLER                  PIC  X(16).                  ELCDTEFD
   499                                                                  ELCDTEFD
   500 01  DATE-DISK-E.                                                 ELCDTEFD
   501     12  FILLER                      PIC  X(4).                   ELCDTEFD
   502     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   503                                     PIC  X(4).                   ELCDTEFD
   504                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   505 01  DATE-DISK-C.                                                 ELCDTEFD
   506     12  FILLER                      PIC  X(7).                   ELCDTEFD
   507     12  DD-CARR1-SECPAY-SW          PIC  X.
   508     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   509     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   510     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   511     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   512     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   513     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   514     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   515     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   516     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   517     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   518     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   519     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   520     12  DD-CARR2-SECPAY-SW          PIC  X.
   521     12  FILLER                      PIC  X(7).                   ELCDTEFD
   522                                                                  ELCDTEFD
   523 01  DATE-DISK-OPT.                                               ELCDTEFD
   524     12  FILLER                      PIC  X(04).                  ELCDTEFD
   525     12  DD-TLR-DATA.                                             ELCDTEFD
   526         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   527                                     PIC  X(03).                  ELCDTEFD
   528     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   529         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   530                                     PIC  X(06).                  ELCDTEFD
   531     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   532         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   533                                     PIC  X(07).                  ELCDTEFD
   534         16  FILLER                  PIC  X(05).                  ELCDTEFD
   535     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   536                                     PIC  X(96).                  ELCDTEFD
   537******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS218.cbl
   539 WORKING-STORAGE SECTION.
   540 77  FILLER  PIC X(32) VALUE '********************************'.
   541 77  FILLER  PIC X(32) VALUE '    ECS218 WORKING STORAGE      '.
   542 77  FILLER  PIC X(32) VALUE '********************************'.
   543
   544 77  PGM-SUB                 PIC S999    COMP    VALUE +158.
   545 77  WS-SPLIT-CNT            PIC 9(5)  VALUE ZEROS.
   546
   547 01  WS-NON-CREDIT-TABLES.
   548     12  WS-LIFE-TABLE.
   549         16  FILLER         PIC XX  VALUE 'QD'.
   550         16  FILLER         PIC XX  VALUE 'QL'.
   551         16  FILLER         PIC XX  VALUE '29'.
   552         16  FILLER         PIC XX  VALUE '32'.
   553         16  FILLER         PIC XX  VALUE '33'.
   554         16  FILLER         PIC XX  VALUE '38'.
   555         16  FILLER         PIC XX  VALUE '45'.
   556         16  FILLER         PIC XX  VALUE '46'.
   557         16  FILLER         PIC XX  VALUE '76'.
   558         16  FILLER         PIC XX  VALUE '77'.
   559         16  FILLER         PIC XX  VALUE '80'.
   560         16  FILLER         PIC XX  VALUE '81'.
   561     12  WS-LIFE REDEFINES WS-LIFE-TABLE OCCURS 12
   562                      INDEXED BY WS-LF-NDX.
   563         16  WS-LIFE-BEN   PIC XX.
   564     12  WS-AH-TABLE.
   565         16  FILLER         PIC XX  VALUE '38'.
   566         16  FILLER         PIC XX  VALUE '39'.
   567         16  FILLER         PIC XX  VALUE '40'.
   568         16  FILLER         PIC XX  VALUE '41'.
   569         16  FILLER         PIC XX  VALUE '42'.
   570         16  FILLER         PIC XX  VALUE '63'.
   571         16  FILLER         PIC XX  VALUE '64'.
   572         16  FILLER         PIC XX  VALUE '65'.
   573         16  FILLER         PIC XX  VALUE '66'.
   574         16  FILLER         PIC XX  VALUE '67'.
   575         16  FILLER         PIC XX  VALUE '2C'.
   576         16  FILLER         PIC XX  VALUE '2D'.
   577         16  FILLER         PIC XX  VALUE '2E'.
   578         16  FILLER         PIC XX  VALUE '2F'.
   579         16  FILLER         PIC XX  VALUE '2G'.
   580         16  FILLER         PIC XX  VALUE '2H'.
   581         16  FILLER         PIC XX  VALUE '2I'.
   582         16  FILLER         PIC XX  VALUE '2J'.
   583         16  FILLER         PIC XX  VALUE '2K'.
   584         16  FILLER         PIC XX  VALUE '2L'.
   585         16  FILLER         PIC XX  VALUE '2Q'.
   586         16  FILLER         PIC XX  VALUE '2R'.
   587         16  FILLER         PIC XX  VALUE '2S'.
   588         16  FILLER         PIC XX  VALUE '2T'.
   589         16  FILLER         PIC XX  VALUE '2U'.
   590         16  FILLER         PIC XX  VALUE '5U'.
   591         16  FILLER         PIC XX  VALUE '5V'.
   592         16  FILLER         PIC XX  VALUE '5W'.
   593         16  FILLER         PIC XX  VALUE '5X'.
   594         16  FILLER         PIC XX  VALUE '5Y'.
   595         16  FILLER         PIC XX  VALUE '5Z'.
   596         16  FILLER         PIC XX  VALUE '6A'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS218.cbl
   597         16  FILLER         PIC XX  VALUE '6B'.
   598         16  FILLER         PIC XX  VALUE '6C'.
   599         16  FILLER         PIC XX  VALUE '6D'.
   600         16  FILLER         PIC XX  VALUE '6E'.
   601         16  FILLER         PIC XX  VALUE '6F'.
   602         16  FILLER         PIC XX  VALUE '6G'.
   603         16  FILLER         PIC XX  VALUE '6H'.
   604         16  FILLER         PIC XX  VALUE '6I'.
   605     12  WS-AH REDEFINES WS-AH-TABLE OCCURS 40
   606                      INDEXED BY WS-AH-NDX.
   607         16  WS-AH-BEN     PIC XX.
   608
   609 01  MISC-WS.
   610     12  WS-HOLD-CERT        PIC X(1056) VALUE SPACES.
   611     12  X                   PIC X   VALUE ' '.
   612     12  WS-EOF-SW           PIC X   VALUE ' '.
   613         88  THERE-ARE-NO-MORE-RECORDS  VALUE 'Y'.
   614     12  WS-NON-CREDIT       PIC X   VALUE 'N'.
   615         88  RECORD-NON-CREDIT       VALUE 'Y'.
   616     12  WS-SPLIT-CERT       PIC X   VALUE 'N'.
   617         88  SPLIT-RECORD            VALUE 'Y'.
   618*    12  WS-CREDIT-120       PIC X   VALUE 'N'.
   619*        88  RECORD-CREDIT-120       VALUE 'Y'.
   620     12  WS-RETURN-CODE      PIC S9(4)   COMP.
   621     12  WS-ABEND-MESSAGE    PIC X(80).
   622     12  WS-ABEND-FILE-STATUS PIC XX     VALUE ZEROS.
   623     12  WS-ZERO             PIC S9       VALUE +0 COMP-3.
   624
   625 01  HEAD-1.
   626     12  FILLER              PIC X(42)           VALUE SPACES.
   627     12  FILLER              PIC X(39)           VALUE
   628             'CERTIFICATE MASTER FILE SPLIT          '.
   629     12  FILLER              PIC X(37)           VALUE SPACES.
   630     12  FILLER              PIC X(8)         VALUE 'ECS-218 '.
   631
   632 01  HEAD-2.
   633     12  FILLER              PIC X(47)           VALUE SPACES.
   634     12  HD-CLIENT           PIC X(30)           VALUE SPACES.
   635     12  FILLER              PIC X(42)           VALUE SPACES.
   636     12  HD-DATE             PIC X(8)            VALUE SPACES.
   637
   638 01  HEAD-3.
   639     12  FILLER              PIC X(53)           VALUE SPACES.
   640     12  HD-ALF-DTE          PIC X(18)           VALUE SPACES.
   641     12  FILLER              PIC X(48)           VALUE SPACES.
   642     12  FILLER              PIC X(5)            VALUE 'PAGE'.
   643     12  HD-PAGE             PIC ZZ,ZZZ.
   644
*  645                             COPY ELCDTECX.
   646******************************************************************06/05/98
   647*                                                                *ELCDTECX
   648*                            ELCDTECX.                           *   LV005
   649*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   650*                            VMOD=2.015                          *ELCDTECX
   651*                                                                *ELCDTECX
   652*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   653*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   654*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   655*                                                                *ELCDTECX
   656******************************************************************ELCDTECX
   657******************************************************************
   658*                   C H A N G E   L O G
   659*
   660* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   661*-----------------------------------------------------------------
   662*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   663* EFFECTIVE    NUMBER
   664*-----------------------------------------------------------------
   665* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   666*                                  BENEFIT CODES FROM 300 TO 900
   667* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   668* 051304    2003080800002  SMVA  ADD REFUND METHOD
   669* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   670******************************************************************
   671 01  DATE-CARD.                                                   ELCDTECX
   672     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   673     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   674     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   675     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   676     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   677     12  EP-SW                       PIC  X.                      ELCDTECX
   678         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   679     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   680         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   681     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   682     12  RUN-CENTURY.                                             ELCDTECX
   683         16 RUN-CENTURY-N            PIC  99.                        CL**4
   684     12  FILLER                      PIC  X.                         CL**4
   685     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   686     12  FILLER                      PIC  XXX.                    ELCDTECX
   687     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   688                                                                  ELCDTECX
   689 01  FILLER                          PIC  X(7)                       CL**6
   690                                          VALUE 'OPTIONS'.        ELCDTECX
   691 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   692     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   693     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   694     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   695         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   696         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   697     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   698     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   699     12  FILLER                      PIC  X.                      ELCDTECX
   700     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   701     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   702     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   703     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   704     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   705     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   706     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   707     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   708     12  FILLER                      PIC  X.                      ELCDTECX
   709     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   710     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   711     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   712     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   713     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   714     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   715     12  FILLER                      PIC  X.                      ELCDTECX
   716     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   717     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   718     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   719     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   720     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   721     12  DTE-R78                     PIC  X.                      ELCDTECX
   722     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   723     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   724     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   725     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   726     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   727     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   728     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   729                                     PIC  X.                      ELCDTECX
   730         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   731                                                 ' '.             ELCDTECX
   732         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   733         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   734     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   735         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   736         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   737     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   738     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   739                                     PIC  9.                         CL**4
   740     12  DTE-SYSTEM.                                              ELCDTECX
   741         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   742         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   743         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   744         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   745         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   746         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   747         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   748         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   749         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   750         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   751         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   752         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   753         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   754         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   755         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   756         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   757         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   758         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   759         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   760         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   761         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   762         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   763         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   764         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   765         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   766         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   767     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   768         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   769                                     PIC  X.                      ELCDTECX
   770     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   771                                                                  ELCDTECX
   772 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   773     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   774     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   775     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   776*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   777     12  FILLER                      PIC  X.                      ELCDTECX
   778     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   779     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   780     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   781     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   782     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   783     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   784     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   785                                                                  ELCDTECX
   786     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   787     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   788     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   789     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   790                                                                  ELCDTECX
   791     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   792     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   793     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   794     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   795                                                                  ELCDTECX
   796     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   797     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   798                                                                  ELCDTECX
   799     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   800     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   801                                                                  ELCDTECX
   802     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   803                                                                  ELCDTECX
   804 01  DATE-CARD-FACTORS.                                           ELCDTECX
   805     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   806     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   807     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   808     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   809     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   810     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   811     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   812                                                                  ELCDTECX
   813 01  FILLER                          PIC  X(12)                   ELCDTECX
   814                                          VALUE 'COMPANY NAME'.   ELCDTECX
   815 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   816     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   817         16  CNT-ID                  PIC  X.                      ELCDTECX
   818         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   819                                                                  ELCDTECX
   820 01  FILLER                          PIC  X(11)                   ELCDTECX
   821                                          VALUE 'STATE NAMES'.    ELCDTECX
   822 01  STATE-NAMES.                                                 ELCDTECX
   823     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   824         16  STATE-SUB               PIC  XX.                     ELCDTECX
   825         16  STATE-PIC1.                                          ELCDTECX
   826             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   827             20  FILLER              PIC  XXX.                    ELCDTECX
   828             20  STATE-PIC           PIC  X(20).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   829             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   830             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   831             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   832                                                                  ELCDTECX
   833 01  FILLER                          PIC  X(13)                   ELCDTECX
   834                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   835 01  CARRIER-NAMES.                                               ELCDTECX
   836     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   837         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   838         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   839         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   840         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   841         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   842         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   843*        16  FILLER                  PIC  X.                      ELCDTECX
   844         16  CARRIER-SEC-PAY         PIC  X.
   845             88  SEC-PAY-CARRIER          VALUE 'Y'.
   846                                                                  ELCDTECX
   847 01  FILLER                          PIC  X(9)                       CL**6
   848                                          VALUE 'INS TYPES'.      ELCDTECX
   849 01  CLAS-INS-TYPES.                                              ELCDTECX
   850*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   851     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   852         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   853         16  CLAS-I-AB3.                                          ELCDTECX
   854             20  FILLER              PIC  X.                      ELCDTECX
   855             20  CLAS-I-AB2.                                      ELCDTECX
   856                 24  FILLER          PIC  X.                      ELCDTECX
   857                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   858         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   859             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   860             20  FILLER              PIC  X.                         CL**4
   861         16  CLAS-I-AB10.                                         ELCDTECX
   862             20  FILLER              PIC  X(9).                   ELCDTECX
   863             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   864         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   865         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   866         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   867         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   868             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   869         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   870         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   871         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   872         16  CLAS-I-BEN-CATEGORY     PIC  X.
   873         16  CLAS-I-REFUND-METHOD    PIC  X.
   874         16  CLAS-I-MAX-BENEFITS     PIC 99.
   875         16  FILLER                  PIC  XXX.
   876                                                                  ELCDTECX
   877 01  FILLER                          PIC  X(16)                   ELCDTECX
   878                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   879 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   880     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   881                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   882         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   883         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   884         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   885         16  CLAS-MORT-DESC.                                      ELCDTECX
   886             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   887             20  FILLER              PIC  XX.                        CL**5
   888             20  CLAS-YEAR           PIC  X(4).                      CL**6
   889             20  FILLER              PIC  X.                         CL**5
   890             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   891             20  FILLER              PIC  X.                         CL**5
   892             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   893             20  FILLER              PIC  X.                         CL**5
   894             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   895             20  FILLER              PIC  X(5).                      CL**6
   896                                                                  ELCDTECX
   897 01  FILLER                          PIC  X(15)                   ELCDTECX
   898                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   899 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   900     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   901         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   902         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   903         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   904         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   905         16  FILLER                  PIC  X(4).                      CL**6
   906                                                                  ELCDTECX
   907 01  FILLER                          PIC  X(7)                       CL**6
   908                                     VALUE 'INDEXES'.             ELCDTECX
   909 01  CLAS-INDEX-TBL.                                              ELCDTECX
   910     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   911     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   912     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   913     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   914     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   915     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   916     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   917     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   918     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   919     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   920     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   921     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   922     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   923     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   924     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   925     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   926     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   927                                                                  ELCDTECX
   928 01  CLAS-TYPE-MISC.                                              ELCDTECX
   929     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   930     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   931     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   932     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   933     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   934     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   935     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   936     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   937     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   938     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   939     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   940                                                                  ELCDTECX
   941 01  FILLER                          PIC  X(13)                   ELCDTECX
   942                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   943 01  CLAS-MISC.                                                   ELCDTECX
   944     12  DTE-FICH                    PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   945         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   946         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   947         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   948     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   949     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   950     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   951     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   952     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   953     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   954     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   955     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   956     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   957     12  STATE-L                     PIC  XX.                     ELCDTECX
   958     12  CLAS-CN                     PIC  99.                     ELCDTECX
   959     12  CLAS-CO                     PIC  99.                     ELCDTECX
   960     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   961         16  DTE-F-1                 PIC  X.                      ELCDTECX
   962         16  DTE-F-2                 PIC  X.                      ELCDTECX
   963     12  DTE-ABEND-WORK.                                          ELCDTECX
   964         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   965         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   966                                                                  ELCDTECX
   967 01  FILLER                          PIC  X(12)                   ELCDTECX
   968                                     VALUE 'WORKING DATE'.        ELCDTECX
   969 01  WS-DATE-AND-TIME.                                            ELCDTECX
   970     12  WS-ACCEPT-DATE.                                          ELCDTECX
   971         16  WS-AD-YY                PIC  99.                     ELCDTECX
   972         16  WS-AD-MM                PIC  99.                     ELCDTECX
   973         16  WS-AD-DD                PIC  99.                     ELCDTECX
   974     12  WS-CURRENT-DATE.                                         ELCDTECX
   975         16  WS-CD-MM                PIC  99.                     ELCDTECX
   976         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   977         16  WS-CD-DD                PIC  99.                     ELCDTECX
   978         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   979         16  WS-CD-YY                PIC  99.                     ELCDTECX
   980     12  WS-TIME-OF-DAY.                                          ELCDTECX
   981         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   982         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   983                                                                  ELCDTECX
   984 01  FILLER                          PIC  X(12)                   ELCDTECX
   985                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   986 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   987     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   988         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   989         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   990         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   991                                                                  ELCDTECX
   992 01  FILLER                          PIC  X(10)                   ELCDTECX
   993                                     VALUE 'STATE TLRS'.          ELCDTECX
   994 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   995     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   996         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   997         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   998                                                                  ELCDTECX
   999 01  FILLER                          PIC  X(13)                   ELCDTECX
  1000                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1001 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1002     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1003         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1004                                                                  ELCDTECX
  1005 01  FILLER                          PIC  X(13)                   ELCDTECX
  1006                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1007 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1008     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1009     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1010     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1011                                     PIC  X.                         CL**5
  1012     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1013     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1014     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1015     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1016     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1017     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1018     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1019     12  FILLER                      PIC  X(75).                  ELCDTECX
  1020******************************************************************ELCDTECX
  1021*01  MISC-CARR-PCT-DATA.                                          00001521
  1022*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1023*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1024*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1025*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1026*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1027*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1028******************************************************************ELCDTECX
  1029
* 1030                             COPY ELCDTEVR.
  1031***************************************************************** 04/15/98
  1032*                                                                *ELCDTEVR
  1033*                                                                *ELCDTEVR
  1034*                            ELCDTEVR.                           *   LV003
  1035*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1036*                            VMOD=2.001                          *   CL**2
  1037*                                                                *ELCDTEVR
  1038*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1039*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1040*                                                                *ELCDTEVR
  1041******************************************************************ELCDTEVR
  1042 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1043     05  WS-RUN-DATE.                                             ELCDTEVR
  1044         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1045         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1046         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1047             15  RUN-CC              PIC  99.                     ELCDTEVR
  1048             15  RUN-YR              PIC  99.                     ELCDTEVR
  1049         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1050         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1051     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1052            WS-RUN-DATE              PIC 9(11).                      CL**2
  1053     05  WS-EP-DT.                                                ELCDTEVR
  1054         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1055         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1056         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1057             15  EP-CC               PIC  99.                     ELCDTEVR
  1058             15  EP-YR               PIC  99.                     ELCDTEVR
  1059         10  EP-MO                   PIC  99.                     ELCDTEVR
  1060         10  EP-DA                   PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1061     05  WS-EP-DT-N REDEFINES                                        CL**2
  1062            WS-EP-DT                 PIC 9(11).                      CL**2
  1063     05  WS-DTE-CONV-DT.                                             CL**4
  1064         10  FILLER                  PIC  9(03).                     CL**4
  1065         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1066         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1067             15  DTE-CONV-CC         PIC  99.                        CL**4
  1068             15  DTE-CONV-YR         PIC  99.                        CL**4
  1069         10  DTE-CONV-MO             PIC  99.                        CL**4
  1070         10  DTE-CONV-DA             PIC  99.                        CL**4
  1071     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1072            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1073 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1074     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1075         10  FILLER                            PIC 999.           ELCDTEVR
  1076         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1077         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1078             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1079             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1080         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1081         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1082     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1083            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1084     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1085         10  FILLER                            PIC 999.           ELCDTEVR
  1086         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1087         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1088         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1089         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1090     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1091            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1092 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1093     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1094         10  FILLER                            PIC 999.           ELCDTEVR
  1095         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1096         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1097             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1098             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1099         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1100         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1101     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1102            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1103     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1104         10  FILLER                            PIC 999.           ELCDTEVR
  1105         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1106         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1107             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1108             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1109         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1110         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1111     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1112            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1113     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1114         10  FILLER                            PIC 999.           ELCDTEVR
  1115         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1116         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1117             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1118             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1119         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1120         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1121     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1122            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1123 01  WS-RATE-RECORD.                                              ELCDTEVR
  1124         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1125             10  FILLER                        PIC 999.           ELCDTEVR
  1126             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1127             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1128                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1129                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1130             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1131             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1132         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1133                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1134
  1135 PROCEDURE DIVISION.
  1136
  1137 0100-SET-START.
* 1138                             COPY ELCDTERX.
  1139******************************************************************04/15/98
  1140*                                                                *ELCDTERX
  1141*                                                                *ELCDTERX
  1142*                            ELCDTERX.                           *   LV002
  1143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1144*                            VMOD=2.007                          *ELCDTERX
  1145*                                                                *ELCDTERX
  1146*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1147*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1148*      = ELCDTEFD)                                               *ELCDTERX
  1149*                                                                *ELCDTERX
  1150******************************************************************ELCDTERX
  1151                                                                  ELCDTERX
  1152     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1153                                                                  ELCDTERX
  1154     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1155     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1156     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1157                                                                  ELCDTERX
  1158     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1159                                                                  ELCDTERX
  1160******************************************************************ELCDTERX
  1161*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1162*          WARNING MESSAGES.                                      ELCDTERX
  1163******************************************************************ELCDTERX
  1164     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1165         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1166                                                                  ELCDTERX
  1167     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1168                                                                  ELCDTERX
  1169     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1170                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1171                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1172                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1173                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1174                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1175                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1176                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1177                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1178                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1179                                                                  ELCDTERX
  1180     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1181                                                                  ELCDTERX
  1182     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1183                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1184                                                                  ELCDTERX
  1185     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1186     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1187     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1188     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1189                                                                  ELCDTERX
  1190     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1191         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1192     ELSE                                                         ELCDTERX
  1193         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1194                                                                  ELCDTERX
  1195     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1196         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1197     ELSE                                                         ELCDTERX
  1198         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1199                                                                  ELCDTERX
  1200 0005-READ--CARD.                                                 ELCDTERX
  1201     READ DISK-DATE                                               ELCDTERX
  1202         AT END CLOSE DISK-DATE                                   ELCDTERX
  1203             GO TO 0060-READ--TEST.                               ELCDTERX
  1204                                                                  ELCDTERX
  1205     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1206                                                                  ELCDTERX
  1207     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1208         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1209         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1210         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1211         GO TO 0005-READ--CARD.                                   ELCDTERX
  1212                                                                  ELCDTERX
  1213     IF DD-ID = 'CLAD'                                            ELCDTERX
  1214         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1215         GO TO 0005-READ--CARD.                                   ELCDTERX
  1216                                                                  ELCDTERX
  1217     IF DD-ID = 'CLAX'                                            ELCDTERX
  1218         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1219         GO TO 0005-READ--CARD.                                   ELCDTERX
  1220                                                                  ELCDTERX
  1221     IF DD-ID = 'CLAF'                                            ELCDTERX
  1222         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1223         GO TO 0005-READ--CARD.                                   ELCDTERX
  1224                                                                  ELCDTERX
  1225     IF DD-ID = 'CLAC'                                            ELCDTERX
  1226         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1227                                                                  ELCDTERX
  1228     IF DD-ID = 'CARR'                                            ELCDTERX
  1229         GO TO 0015-READ--CARR.                                   ELCDTERX
  1230                                                                  ELCDTERX
  1231     IF DD-ID = 'STAT'                                            ELCDTERX
  1232         GO TO 0020-READ--STAT.                                   ELCDTERX
  1233                                                                  ELCDTERX
  1234     IF DD-ID = 'BUSC'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1235         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1236                                                                  ELCDTERX
  1237     IF DD-ID = 'MORT'                                            ELCDTERX
  1238         GO TO 0030-READ--MORT.                                   ELCDTERX
  1239                                                                  ELCDTERX
  1240     IF DD-ID = 'CLAI'                                            ELCDTERX
  1241         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1242                                                                  ELCDTERX
  1243     IF DD-ID = 'COLC'                                            ELCDTERX
  1244         GO TO 0065-READ--COLC.                                   ELCDTERX
  1245                                                                  ELCDTERX
  1246     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1247        DD-IDA = 'CL'                                             ELCDTERX
  1248         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1249                                                                  ELCDTERX
  1250     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1251        DD-IDA = 'PO'                                             ELCDTERX
  1252         GO TO 0050-READ--POXX.                                   ELCDTERX
  1253                                                                  ELCDTERX
  1254     IF DD-ID = 'OPCA'                                            ELCDTERX
  1255         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1256                                                                  ELCDTERX
  1257     IF DD-ID = 'OPST'                                            ELCDTERX
  1258         GO TO 0072-READ--OPST.                                   ELCDTERX
  1259                                                                  ELCDTERX
  1260     IF DD-ID = 'OPBS'                                            ELCDTERX
  1261         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1262                                                                  ELCDTERX
  1263     IF DD-ID = 'OPMS'                                            ELCDTERX
  1264         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1265                                                                  ELCDTERX
  1266     GO TO 0005-READ--CARD.                                       ELCDTERX
  1267                                                                  ELCDTERX
  1268 0010-READ--CLAC.                                                 ELCDTERX
  1269     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1270     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1271     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1272     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1273     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1274     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1275     GO TO 0005-READ--CARD.                                       ELCDTERX
  1276                                                                  ELCDTERX
  1277 0015-READ--CARR.                                                 ELCDTERX
  1278     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1279     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1280        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1281        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1282        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1283        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1284        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1285        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1286        MOVE DD-CARR1-SECPAY-SW
  1287                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1288     END-IF
  1289                                                                  ELCDTERX
  1290     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1291     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1292        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1293        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1294        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1295        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1296        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1297        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1298        MOVE DD-CARR2-SECPAY-SW
  1299                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1300     END-IF
  1301                                                                  ELCDTERX
  1302                                                                  ELCDTERX
  1303     GO TO 0005-READ--CARD.                                       ELCDTERX
  1304                                                                  ELCDTERX
  1305 0020-READ--STAT.                                                 ELCDTERX
  1306     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1307     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1308        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1309         GO TO 0005-READ--CARD.                                   ELCDTERX
  1310                                                                  ELCDTERX
  1311     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1312     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1313     GO TO 0020-READ--STAT.                                       ELCDTERX
  1314                                                                  ELCDTERX
  1315 0025-READ--BUSC.                                                 ELCDTERX
  1316     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1317     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1318        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1319         GO TO 0005-READ--CARD.                                   ELCDTERX
  1320                                                                  ELCDTERX
  1321     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1322     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1323     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1324                                                                  ELCDTERX
  1325 0030-READ--MORT.                                                 ELCDTERX
  1326     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1327     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1328        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1329         GO TO 0005-READ--CARD.                                   ELCDTERX
  1330                                                                  ELCDTERX
  1331     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1332     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1333     GO TO 0030-READ--MORT.                                       ELCDTERX
  1334                                                                  ELCDTERX
  1335 0035-READ--CLXX.                                                 ELCDTERX
  1336     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1337          GO TO 0005-READ--CARD.                                  ELCDTERX
  1338                                                                  ELCDTERX
  1339     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1340         DISPLAY '***********************************************'ELCDTERX
  1341         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1342         DISPLAY '***********************************************'ELCDTERX
  1343         GO TO 0055-READ--STOP.                                   ELCDTERX
  1344                                                                  ELCDTERX
  1345     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1346        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1347         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1348                                                                  ELCDTERX
  1349     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1350        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1351         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1352                                                                  ELCDTERX
  1353*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1354     GO TO 0005-READ--CARD.                                       ELCDTERX
  1355                                                                  ELCDTERX
  1356 0040-READ--CLAI.                                                 ELCDTERX
  1357     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1358     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1359        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1360         GO TO 0005-READ--CARD.                                   ELCDTERX
  1361                                                                  ELCDTERX
  1362     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1363     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1364     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1365                                                                  ELCDTERX
  1366 0045-READ--DUMP.                                                 ELCDTERX
  1367     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1368     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1369                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1370     PERFORM ABEND-PGM.                                           ELCDTERX
  1371                                                                  ELCDTERX
  1372 0050-READ--POXX.                                                 ELCDTERX
  1373     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1374         GO TO 0005-READ--CARD.                                   ELCDTERX
  1375                                                                  ELCDTERX
  1376     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1377         DISPLAY '***********************************************'ELCDTERX
  1378         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1379         DISPLAY '***********************************************'ELCDTERX
  1380         GO TO 0055-READ--STOP.                                   ELCDTERX
  1381                                                                  ELCDTERX
  1382     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1383     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1384     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1385     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1386                                                                  ELCDTERX
  1387     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1388         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1389     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1390         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1391                                                                  ELCDTERX
  1392     GO TO 0005-READ--CARD.                                       ELCDTERX
  1393                                                                  ELCDTERX
  1394 0055-READ--STOP.                                                 ELCDTERX
  1395     GOBACK.                                                      ELCDTERX
  1396                                                                  ELCDTERX
  1397 0060-READ--TEST.                                                 ELCDTERX
  1398     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1399        CLAX-ID         = SPACE  OR                               ELCDTERX
  1400        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1401         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1402                                                                  ELCDTERX
  1403     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1404     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1405                                                                  ELCDTERX
  1406 0065-READ--COLC.                                                 ELCDTERX
  1407     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1408     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS218.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1409                                                                  ELCDTERX
  1410 0070-READ--OPCA.                                                 ELCDTERX
  1411                                                                  ELCDTERX
  1412     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1413                                                                  ELCDTERX
  1414     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1415             OR                                                   ELCDTERX
  1416         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1417         GO TO 0005-READ--CARD.                                   ELCDTERX
  1418                                                                  ELCDTERX
  1419     ADD 1                       TO INDEXCA.                      ELCDTERX
  1420     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1421                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1422     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1423                                                                  ELCDTERX
  1424 0072-READ--OPST.                                                 ELCDTERX
  1425                                                                  ELCDTERX
  1426     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1427                                                                  ELCDTERX
  1428     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1429             OR                                                   ELCDTERX
  1430         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1431         GO TO 0005-READ--CARD.                                   ELCDTERX
  1432                                                                  ELCDTERX
  1433     ADD 1                       TO INDEXST.                      ELCDTERX
  1434     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1435                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1436     GO TO 0072-READ--OPST.                                       ELCDTERX
  1437                                                                  ELCDTERX
  1438 0074-READ--OPBS.                                                 ELCDTERX
  1439                                                                  ELCDTERX
  1440     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1441                                                                  ELCDTERX
  1442     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1443             OR                                                   ELCDTERX
  1444         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1445         GO TO 0005-READ--CARD.                                   ELCDTERX
  1446                                                                  ELCDTERX
  1447     ADD 1                       TO INDEXBS.                      ELCDTERX
  1448     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1449     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1450                                                                  ELCDTERX
  1451 0079-READ--EXIT.                                                 ELCDTERX
  1452*    EXIT.                                                        ELCDTERX
  1453******************************************************************ELCDTERX
  1454
  1455 0110-OPEN-RTN.
  1456
  1457     OPEN INPUT  CERT-FILE
  1458          OUTPUT CREDIT NON-CREDIT
  1459                 PRNTR
  1460
  1461     PERFORM 0500-PRINT-HEADINGS THRU 0510-HEADING-EXIT
  1462
  1463     PERFORM 0130-READ-CERT  THRU 0130-EXIT
  1464
  1465     PERFORM 0120-PROCESS-CERT THRU 0120-EXIT UNTIL
  1466        THERE-ARE-NO-MORE-RECORDS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS218.cbl
  1467
  1468     PERFORM 0600-CLOSE-FILES THRU 0600-EXIT
  1469
  1470     DISPLAY ' CERTS SPLIT ' WS-SPLIT-CNT
  1471     GOBACK
  1472
  1473     .
  1474 0120-PROCESS-CERT.
  1475
  1476     MOVE 'N'                    TO WS-NON-CREDIT
  1477                                    WS-SPLIT-CERT
  1478
  1479     SET WS-LF-NDX TO +1
  1480
  1481     SEARCH WS-LIFE VARYING WS-LF-NDX AT END
  1482          CONTINUE
  1483       WHEN WS-LIFE-BEN (WS-LF-NDX) = CR-LFTYP
  1484          SET RECORD-NON-CREDIT TO TRUE
  1485     END-SEARCH
  1486
  1487     SET WS-AH-NDX TO +1
  1488
  1489     SEARCH WS-AH VARYING WS-AH-NDX AT END
  1490          CONTINUE
  1491       WHEN WS-AH-BEN (WS-AH-NDX) = CR-AHTYP
  1492          SET RECORD-NON-CREDIT TO TRUE
  1493     END-SEARCH
  1494
  1495     IF ((CR-LF-TERM = 0) OR
  1496        (CR-LF-TERM > 120))
  1497              AND
  1498        ((CR-AH-TERM = 0) OR
  1499        (CR-AH-TERM > 120))
  1500          SET RECORD-NON-CREDIT TO TRUE
  1501     END-IF
  1502
  1503     IF RECORD-NON-CREDIT
  1504        CONTINUE
  1505     ELSE
  1506        IF ((CR-LF-TERM > 120) AND
  1507           (CR-AH-TERM NOT = 0) AND
  1508           (CR-AH-TERM < 121))
  1509                 OR
  1510           ((CR-AH-TERM > 120) AND
  1511           (CR-LF-TERM NOT = 0) AND
  1512           (CR-LF-TERM < 121))
  1513           SET SPLIT-RECORD TO TRUE
  1514        END-IF
  1515     END-IF
  1516
  1517     IF SPLIT-RECORD
  1518        ADD 1 TO WS-SPLIT-CNT
  1519        MOVE CERTIFICATE-RECORD  TO WS-HOLD-CERT
  1520        IF CR-LF-TERM > 120
  1521           MOVE ZEROS            TO CR-AHTYP
  1522           WRITE NON-CREDIT-REC  FROM CERTIFICATE-RECORD
  1523           MOVE WS-HOLD-CERT     TO CERTIFICATE-RECORD
  1524           MOVE ZEROS            TO CR-LFTYP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS218.cbl
  1525           WRITE CREDIT-REC      FROM CERTIFICATE-RECORD
  1526        ELSE
  1527           MOVE ZEROS            TO CR-LFTYP
  1528           WRITE NON-CREDIT-REC  FROM CERTIFICATE-RECORD
  1529           MOVE WS-HOLD-CERT     TO CERTIFICATE-RECORD
  1530           MOVE ZEROS            TO CR-AHTYP
  1531           WRITE CREDIT-REC      FROM CERTIFICATE-RECORD
  1532        END-IF
  1533     ELSE
  1534        IF RECORD-NON-CREDIT
  1535           WRITE NON-CREDIT-REC  FROM CERTIFICATE-RECORD
  1536        ELSE
  1537           WRITE CREDIT-REC      FROM CERTIFICATE-RECORD
  1538        END-IF
  1539     END-IF
  1540
  1541     PERFORM 0130-READ-CERT      THRU 0130-EXIT
  1542
  1543     .
  1544 0120-EXIT.
  1545     EXIT.
  1546
  1547 0130-READ-CERT.
  1548
  1549     READ CERT-FILE AT END
  1550         SET THERE-ARE-NO-MORE-RECORDS TO TRUE
  1551     END-READ
  1552
  1553     .
  1554 0130-EXIT.
  1555     EXIT.
  1556
  1557 0480-PRT-RTN.
  1558
  1559     IF DTE-FICH = SPACE OR '2'
  1560       MOVE X                    TO  P-CTL
  1561       IF P-CTL = ' '
  1562         WRITE PRT AFTER ADVANCING 1 LINE
  1563       ELSE
  1564         IF P-CTL = '0'
  1565           WRITE PRT AFTER ADVANCING 2 LINES
  1566         ELSE
  1567           IF P-CTL = '-'
  1568             WRITE PRT AFTER ADVANCING 3 LINES
  1569           ELSE
  1570             WRITE PRT AFTER ADVANCING PAGE.
  1571
  1572******************************************************************
  1573
  1574 0490-E-PRT-RTN.
  1575     EXIT.
  1576
  1577 0500-PRINT-HEADINGS.
  1578
  1579     MOVE '1'                    TO X
  1580     MOVE HEAD-1                 TO P-DATA
  1581     PERFORM 0480-PRT-RTN        THRU 0490-E-PRT-RTN
  1582
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS218.cbl
  1583     MOVE ' '                    TO X
  1584     MOVE WS-CURRENT-DATE        TO HD-DATE
  1585     MOVE COMPANY-NAME           TO HD-CLIENT
  1586     MOVE HEAD-2                 TO P-DATA
  1587     PERFORM 0480-PRT-RTN        THRU 0490-E-PRT-RTN
  1588
  1589     MOVE 1                      TO HD-PAGE
  1590     MOVE ALPH-DATE              TO HD-ALF-DTE
  1591     MOVE HEAD-3                 TO P-DATA
  1592     PERFORM 0480-PRT-RTN        THRU 0490-E-PRT-RTN
  1593
  1594     .
  1595 0510-HEADING-EXIT.
  1596     EXIT.
  1597
  1598 0600-CLOSE-FILES.
  1599
  1600     CLOSE CERT-FILE CREDIT NON-CREDIT PRNTR
  1601
  1602     .
  1603 0600-EXIT.
  1604     EXIT.
  1605
  1606 ABEND-PGM.
* 1607                     COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       52560     Code:        4592
