* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIFPB511.cbl
* Options: int("CIFPB511.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIFPB511.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIFPB511.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CIFPB511.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CIFPB511.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5******************************************************************
     6*                   C H A N G E   L O G
     7*
     8* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     9*-----------------------------------------------------------------
    10*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    11* EFFECTIVE    NUMBER
    12*-----------------------------------------------------------------
    13* 051606   CR2006050500001 PEMA  NEW PROGRAM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIFPB511.cbl
    14* 021109   CR2009010500002 PEMA  REMOVE LOAN TERM MOVE STMT
    15* 032109     2009021700002 PEMA  ADD CRED BENE TO PNDB REC
    16* 030612   IR2012030600001 PEMA  ADD A&H ONLY BENEFIT CODES
    17* 110712   CR2011071400001 PEMA  A&H ONLY IN ACCT 0001107201
    18* 120312   IR2012120300004 PEMA  PASS DOB TO OUTPUT
    19******************************************************************
    20 ENVIRONMENT DIVISION.
    21 INPUT-OUTPUT SECTION.
    22 FILE-CONTROL.
    23     SELECT  FPB-IN              ASSIGN TO SYS010.
    24*       ORGANIZATION IS LINE SEQUENTIAL.
    25     SELECT  DISK-DATE           ASSIGN TO SYS019.
    26     SELECT  FPB-OUT             ASSIGN TO SYS012.
    27     SELECT SORT-FILE        ASSIGN TO SYS001-UT-3380-S-SORTWK1.
    28
    29 DATA DIVISION.
    30 FILE SECTION.
    31
    32 FD  FPB-IN
    33     RECORDING MODE F
    34     LABEL RECORDS STANDARD
    35     BLOCK CONTAINS 0 RECORDS.
    36
    37 01  FPB-IN-RECORD.
    38     05  FPB-RECORD-TYPE         PIC X.
    39         88  FPB-VALID-REC-1        VALUE '1'.
    40         88  FPB-VALID-REC-2        VALUE '2'.
    41         88  FPB-VALID-REC-3        VALUE '3'.
    42         88  FPB-VALID-REC-4        VALUE '4'.
    43         88  FPB-VALID-REC-5        VALUE '5'.
    44         88  FPB-VALID-REC-7        VALUE '7'.
    45         88  FPB-VALID-REC-9        VALUE '9'.
    46     05  FILLER                  PIC XXX.
    47     05  FPB-INST-NO             PIC 99.
    48     05  FPB-ACCT-NO             PIC X(10).
    49     05  FILLER                  PIC X(920).
    50
    51 FD  DISK-DATE
*   52                                 COPY ELCDTEFD.
    53******************************************************************04/15/98
    54*                                                                *ELCDTEFD
    55*                                                                *ELCDTEFD
    56*                            ELCDTEFD.                           *   LV002
    57*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    58*                            VMOD=2.007                          *   CL**2
    59*                                                                *ELCDTEFD
    60******************************************************************ELCDTEFD
    61     BLOCK CONTAINS 0 RECORDS
    62     RECORDING MODE F.                                            ELCDTEFD
    63                                                                  ELCDTEFD
    64 01  DATE-DISK.                                                   ELCDTEFD
    65     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    66     12  FILLER                      PIC  X(14).                  ELCDTEFD
    67     12  DD-CR1                      PIC  9.                      ELCDTEFD
    68     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    69     12  DD-CR2                      PIC  9.                      ELCDTEFD
    70     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    71     12  FILLER                      PIC  X(20).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72                                                                  ELCDTEFD
    73 01  DATE-DISK-R.                                                 ELCDTEFD
    74     12  FILLER                      PIC  X(4).                   ELCDTEFD
    75     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    76                                     PIC  X(32).                  ELCDTEFD
    77                                                                  ELCDTEFD
    78 01  DATE-DISK-T.                                                 ELCDTEFD
    79     12  FILLER                      PIC  X(4).                   ELCDTEFD
    80     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    81                                     PIC  X(48).                  ELCDTEFD
    82                                                                  ELCDTEFD
    83 01  DATE-DISK-M.                                                 ELCDTEFD
    84     12  FILLER                      PIC  X(4).                   ELCDTEFD
    85     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    86                                     PIC  X(48).                  ELCDTEFD
    87                                                                  ELCDTEFD
    88 01  DATE-DISK-P.                                                 ELCDTEFD
    89     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    90     12  DD-IDX                      PIC  99.                     ELCDTEFD
    91     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    92     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    93         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    94                                     PIC  X.                      ELCDTEFD
    95         16  FILLER                  PIC  X(46).                  ELCDTEFD
    96     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    97         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    98             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    99             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   100             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   101             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   102         16  FILLER                  PIC  X(16).                  ELCDTEFD
   103                                                                  ELCDTEFD
   104 01  DATE-DISK-E.                                                 ELCDTEFD
   105     12  FILLER                      PIC  X(4).                   ELCDTEFD
   106     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   107                                     PIC  X(4).                   ELCDTEFD
   108                                                                  ELCDTEFD
   109 01  DATE-DISK-C.                                                 ELCDTEFD
   110     12  FILLER                      PIC  X(7).                   ELCDTEFD
   111     12  DD-CARR1-SECPAY-SW          PIC  X.
   112     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   113     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   114     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   115     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   116     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   117     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   118     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   119     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   120     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   121     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   122     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   123     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   124     12  DD-CARR2-SECPAY-SW          PIC  X.
   125     12  FILLER                      PIC  X(7).                   ELCDTEFD
   126                                                                  ELCDTEFD
   127 01  DATE-DISK-OPT.                                               ELCDTEFD
   128     12  FILLER                      PIC  X(04).                  ELCDTEFD
   129     12  DD-TLR-DATA.                                             ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   131                                     PIC  X(03).                  ELCDTEFD
   132     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   133         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   134                                     PIC  X(06).                  ELCDTEFD
   135     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   136         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   137                                     PIC  X(07).                  ELCDTEFD
   138         16  FILLER                  PIC  X(05).                  ELCDTEFD
   139     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   140                                     PIC  X(96).                  ELCDTEFD
   141******************************************************************ELCDTEFD
   142 FD  FPB-OUT
   143     RECORDING MODE F
   144     LABEL RECORDS STANDARD
   145     BLOCK CONTAINS 0 RECORDS.
   146
   147 01  CARD-RECORD                 PIC X(91).
   148
   149 SD  SORT-FILE.
   150
   151 01  SORT-RECORD.
   152     12  SR-PENDING-RECORD.
   153         16  SR-CERT-NO              PIC X(11).
   154         16  F                       PIC X(67).
   155         16  SR-REC-TYPE             PIC XX.
   156     12  SR-CONTROL                  PIC X(10).
   157     12  SR-BATCH-HDR-IND            PIC X.
   158
   159 WORKING-STORAGE SECTION.
   160 77  FILLER  PIC X(32) VALUE '********************************'.  00133388
   161 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.  00133389
   162 77  FILLER  PIC X(32) VALUE '********************************'.  00133390
   163 77  W-DISPLAY-DATE        PIC 9(9) VALUE ZEROS.
   164 77  WS-SAVE-ACCT-NO             PIC X(10) VALUE LOW-VALUES.
   165 77  V-AH-BEN-AMT-WORK      PIC S9(7)V99  VALUE ZEROS.            00134107
   166 77  LAST-REC-SW            PIC X         VALUE 'N'.              00133393
   167 77  LETTER-SW              PIC X         VALUE 'N'.              00133393
   168 77  SAVE-SUB               PIC 99        VALUE ZERO.             00133393
   169 77  SAVE-1                 PIC X         VALUE SPACE.            00133393
   170 77  CANCL-SW               PIC X         VALUE 'N'.              00133394
   171 77  SW-20                  PIC X         VALUE ' '.              00133395
   172 77  ERROR-CODE             PIC X(25)     VALUE SPACES.           00133396
   173 77  SAVE-SEQ               PIC X(30)     VALUE SPACES.           00133397
   174 77  SAVE-CERT              PIC X(10)     VALUE SPACES.           00133398
   175 77  SAVE-STATE             PIC X(02)     VALUE SPACES.           00133399
   176 77  HDR-CNT                PIC 9(07)     VALUE ZEROS.            00133400
   177 77  NAME-LINE-CNT          PIC 99        VALUE ZEROS.            00133403
   178 77  RPT-CNT                PIC 9999999   VALUE ZEROS.            00133404
   179 77  SPACE-CNT              PIC 9         VALUE ZEROS.            00133404
   180 77  DETAIL-CNT             PIC 9999      VALUE ZEROS.            00133405
   181 77  NINES-IN               PIC 9(12)     VALUE 999999999999.     00133406
   182 77  DETAIL-CNT-TOT         PIC 9999999   VALUE ZEROS.            00133407
   183 77  PPA-CNT                PIC 9999999   VALUE ZEROS.            00133407
   184 77  LOGIC-CNT              PIC 9999999   VALUE ZEROS.            00133407
   185 77  LOGIC-CANC-CNT         PIC 9999999   VALUE ZEROS.            00133407
   186 77  IN-CNT                 PIC 9999999   VALUE ZEROS.            00133408
   187 77  TOT-LIFE-WRITTEN       PIC S9(8)V99  VALUE ZEROS.            00133409
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIFPB511.cbl
   188 77  TOT-LIFE-CANC          PIC S9(8)V99  VALUE ZEROS.            00133410
   189 77  TOT-AH-WRITTEN         PIC S9(8)V99  VALUE ZEROS.            00133411
   190 77  TOT-AH-CANC            PIC S9(8)V99  VALUE ZEROS.            00133412
   191 77  TOT-CERT-ISS           PIC S9(4)     VALUE ZEROS.            00133413
   192 77  TOT-CERT-CANC          PIC S9(4)     VALUE ZEROS.            00133414
   193 77  CANC-CNT               PIC 9999      VALUE ZEROS.            00133415
   194 77  CERT-CNT               PIC 9999      VALUE ZEROS.            00133416
   195 77  FIRST-SW               PIC X         VALUE 'Y'.              00133418
   196 77  WRITTEN-PREM-SW        PIC X         VALUE 'N'.              00133419
   197 77  JR-SUB                 PIC 99        VALUE ZEROS.            00133421
   198 77  SP-SUB                 PIC 99        VALUE ZEROS.            00133421
   199 77  JR-SW                  PIC X         VALUE 'N'.              00133422
   200 77  SAVE-JNT-FIRST-INIT    PIC X(01)     VALUE SPACES.           00133423
   201 77  SAVE-SUB-LT-SUB1       PIC 9999999   VALUE ZEROS.            00133424
   202 77  SUB1                   PIC 99        VALUE ZEROS.            00133425
   203 77  SUB2                   PIC 99        VALUE ZEROS.            00133426
   204 77  CODE-SUB               PIC 99        VALUE ZEROS.            00133427
   205 77  G-SUB                  PIC 99        VALUE ZEROS.            00133428
   206 77  SAVE-G-SUB             PIC 99        VALUE ZEROS.            00133429
   207 77  PGM-SUB                PIC S9(4) COMP  VALUE +511.
   208 77  WS-EOF-SW              PIC X         VALUE ' '.
   209     88  END-OF-FPB                       VALUE 'Y'.
   210 77  WS-RETURN-CODE         PIC S9(3)     VALUE ZERO.
   211 77  WS-ABEND-MESSAGE       PIC X(80)     VALUE SPACES.
   212 77  SAVE-EFF-DATE          PIC X(6)      VALUE SPACES.
   213 77  WS-BIN-1ST-PAY-DT      PIC XX        VALUE LOW-VALUES.
   214 77  WS-BIN-EFF-DT          PIC XX        VALUE LOW-VALUES.
   215 77  WS-BIN-BIRTH-DT        PIC XX        VALUE LOW-VALUES.
   216 77  WS-INSURED-AGE         PIC 999       VALUE ZEROS.
   217 77  RECS-IN                PIC 9(7)      VALUE ZEROS.
   218 77  RECS-RET               PIC 9(7)      VALUE ZEROS.
   219 77  RECS-REL               PIC 9(7)      VALUE ZEROS.
   220 77  WS-ABEND-FILE-STATUS   PIC XX        VALUE ZERO.
   221 77  WS-ZERO                PIC S9        VALUE ZERO.
   222 77  WS-ISS-SW              PIC X         VALUE ' '.
   223     88  ISSUED-CERT                      VALUE 'Y'.
   224 77  WS-CAN-SW              PIC X         VALUE ' '.
   225     88  CANCELLED-CERT                   VALUE 'Y'.
   226
   227 77  S1                          PIC S999 COMP-3 VALUE +0.
   228 77  S2                          PIC S999 COMP-3 VALUE +0.
   229 77  WS-LF-BENEFIT-CD            PIC XX        VALUE '  '.
   230 77  WS-AH-BENEFIT-CD            PIC XX        VALUE '  '.
   231 77  WS-LF-PREM                  PIC 9(9)V99   VALUE ZEROS.
   232 77  WS-AH-PREM                  PIC 9(9)V99   VALUE ZEROS.
   233 77  WS-LF-PREM-ALT              PIC 9(9)V99   VALUE ZEROS.
   234 77  WS-LF-BALLOON               PIC 9(11)V99  VALUE ZEROS.
   235 77  WS-LF-REF                   PIC 9(9)V99   VALUE ZEROS.
   236 77  WS-AH-REF                   PIC 9(9)V99   VALUE ZEROS.
   237 77  WS-LF-REF-DATE              PIC X(6)      VALUE ZEROS.
   238 77  WS-AH-REF-DATE              PIC X(6)      VALUE ZEROS.
   239 77  WS-PREV-SR-ACCOUNT          PIC X(10)     VALUE LOW-VALUES.
   240 77  WS-AH-ONLY-SW               PIC X         VALUE ' '.
   241     88  FOUND-AH-ONLY                   VALUE 'Y'.
   242
   243 01  BRANCH-RESP-TABLE.
   244     05  LOAN-OFFICERS.
   245         10  FILLER              PIC X(5)  VALUE '11001'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIFPB511.cbl
   246         10  FILLER              PIC X(5)  VALUE '13445'.
   247         10  FILLER              PIC X(5)  VALUE '13645'.
   248         10  FILLER              PIC X(5)  VALUE '13745'.
   249         10  FILLER              PIC X(5)  VALUE '13917'.
   250         10  FILLER              PIC X(5)  VALUE '14312'.
   251         10  FILLER              PIC X(5)  VALUE '14413'.
   252         10  FILLER              PIC X(5)  VALUE '14518'.
   253         10  FILLER              PIC X(5)  VALUE '14821'.
   254         10  FILLER              PIC X(5)  VALUE '15117'.
   255         10  FILLER              PIC X(5)  VALUE '15319'.
   256         10  FILLER              PIC X(5)  VALUE '20117'.
   257         10  FILLER              PIC X(5)  VALUE '21118'.
   258         10  FILLER              PIC X(5)  VALUE '22417'.
   259         10  FILLER              PIC X(5)  VALUE '22617'.
   260         10  FILLER              PIC X(5)  VALUE '22714'.
   261         10  FILLER              PIC X(5)  VALUE '23217'.
   262         10  FILLER              PIC X(5)  VALUE '23616'.
   263         10  FILLER              PIC X(5)  VALUE '23720'.
   264         10  FILLER              PIC X(5)  VALUE '24207'.
   265         10  FILLER              PIC X(5)  VALUE '24605'.
   266         10  FILLER              PIC X(5)  VALUE '25217'.
   267         10  FILLER              PIC X(5)  VALUE '26818'.
   268         10  FILLER              PIC X(5)  VALUE '26918'.
   269         10  FILLER              PIC X(5)  VALUE '27014'.
   270         10  FILLER              PIC X(5)  VALUE '27117'.
   271         10  FILLER              PIC X(5)  VALUE '27501'.
   272         10  FILLER              PIC X(5)  VALUE '27620'.
   273         10  FILLER              PIC X(5)  VALUE '27712'.
   274         10  FILLER              PIC X(5)  VALUE '30513'.
   275         10  FILLER              PIC X(5)  VALUE '31017'.
   276         10  FILLER              PIC X(5)  VALUE '31521'.
   277         10  FILLER              PIC X(5)  VALUE '32013'.
   278         10  FILLER              PIC X(5)  VALUE '36001'.
   279         10  FILLER              PIC X(5)  VALUE '42516'.
   280         10  FILLER              PIC X(5)  VALUE '43016'.
   281         10  FILLER              PIC X(5)  VALUE '48116'.
   282         10  FILLER              PIC X(5)  VALUE '48512'.
   283         10  FILLER              PIC X(5)  VALUE '50019'.
   284         10  FILLER              PIC X(5)  VALUE '50503'.
   285         10  FILLER              PIC X(5)  VALUE '50710'.
   286         10  FILLER              PIC X(5)  VALUE '51521'.
   287         10  FILLER              PIC X(5)  VALUE '53806'.
   288         10  FILLER              PIC X(5)  VALUE '54206'.
   289         10  FILLER              PIC X(5)  VALUE '54805'.
   290         10  FILLER              PIC X(5)  VALUE '60718'.
   291         10  FILLER              PIC X(5)  VALUE '60821'.
   292         10  FILLER              PIC X(5)  VALUE '60901'.
   293         10  FILLER              PIC X(5)  VALUE '63407'.
   294         10  FILLER              PIC X(5)  VALUE '63801'.
   295         10  FILLER              PIC X(5)  VALUE '64101'.
   296         10  FILLER              PIC X(5)  VALUE '64614'.
   297         10  FILLER              PIC X(5)  VALUE '70105'.
   298         10  FILLER              PIC X(5)  VALUE '73505'.
   299         10  FILLER              PIC X(5)  VALUE '74105'.
   300         10  FILLER              PIC X(5)  VALUE '74405'.
   301         10  FILLER              PIC X(5)  VALUE '81005'.
   302         10  FILLER              PIC X(5)  VALUE '90501'.
   303     05  LOAN-OFFS REDEFINES LOAN-OFFICERS OCCURS 58
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIFPB511.cbl
   304                   ASCENDING KEY RESP-CODE
   305                   INDEXED BY S3.
   306         10  RESP-CODE           PIC XXX.
   307         10  BRANCH-CODE         PIC XX.
   308
   309
   310 01  WS-WORK-APR.
   311     05  WS-WORK-APR-DOLLARS       PIC 9(6).
   312     05  WS-WORK-APR-CENTS         PIC 9(6).
   313 01  WS-WORK-APR-N REDEFINES WS-WORK-APR
   314                                   PIC 9(6)V9(6).
   315
   316 01  WS-WORK-PREM-1.
   317     05  WS-WORK-PREM-DOLLARS-1    PIC 9(9).
   318     05  WS-WORK-PREM-CENTS-1      PIC 99.
   319 01  WS-WORK-PREM-N-1 REDEFINES WS-WORK-PREM-1
   320                                   PIC 9(9)V99.
   321
   322 01  WS-WORK-PREM-2.
   323     05  WS-WORK-PREM-DOLLARS-2    PIC 9(9).
   324     05  WS-WORK-PREM-CENTS-2      PIC 99.
   325 01  WS-WORK-PREM-N-2 REDEFINES WS-WORK-PREM-2
   326                                   PIC 9(9)V99.
   327
   328 01  WS-WORK-AMT.
   329     05  WS-WORK-AMT-DOLLARS       PIC 9(9).
   330     05  WS-WORK-AMT-CENTS         PIC 99.
   331 01  WS-WORK-AMT-N   REDEFINES WS-WORK-AMT
   332                                   PIC 9(9)V99.
   333
   334 01  WS-WORK-AMT-2.
   335     05  WS-WORK-AMT-DOLLARS-2     PIC 9(9).
   336     05  WS-WORK-AMT-CENTS-2       PIC 99.
   337 01  WS-WORK-AMT-N-2 REDEFINES WS-WORK-AMT-2
   338                                   PIC 9(9)V99.
   339
   340 01  WS-WORK-REFUND-1.
   341     05  WS-WORK-REF-DOLLARS-1   PIC 9(9).
   342     05  WS-WORK-REF-CENTS-1     PIC 99.
   343 01  WS-WORK-REFUND-N-1 REDEFINES WS-WORK-REFUND-1
   344                                   PIC 9(9)V99.
   345
   346 01  WS-WORK-REFUND-2.
   347     05  WS-WORK-REF-DOLLARS-2   PIC 9(9).
   348     05  WS-WORK-REF-CENTS-2     PIC 99.
   349 01  WS-WORK-REFUND-N-2 REDEFINES WS-WORK-REFUND-2
   350                                   PIC 9(9)V99.
   351
   352 01  WS-CERT-WORK1.                                               00133352
   353     05  WS-CERT-WK1-NUM-6         PIC X(06).                     00133352
   354     05  WS-CERT-WK1-ZEROS-4       PIC X(04).                     00133352
   355 01  WS-CERT-WORK1-R  REDEFINES                                   00133352
   356     WS-CERT-WORK1.                                               00133352
   357     05  WS-CERT-WK1-NUM-7         PIC X(07).                     00133352
   358     05  WS-CERT-WK1-ZEROS-3       PIC X(03).                     00133352
   359                                                                  00133352
   360 01  WS-CERT-WORK2.                                               00133352
   361     05  WS-CERT-WK2-ZEROS-4       PIC X(04).                     00133352
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIFPB511.cbl
   362     05  WS-CERT-WK2-NUM-6         PIC X(06).                     00133352
   363 01  WS-CERT-WORK2-R  REDEFINES                                   00133352
   364     WS-CERT-WORK2.                                               00133352
   365     05  WS-CERT-WK2-ZEROS-3       PIC X(03).                     00133352
   366     05  WS-CERT-WK2-NUM-7         PIC X(07).                     00133352
   367
   368 01  SPACE-CK.                                                    00133447
   369     05  SP-CK               PIC X    OCCURS 26 TIMES.            00133448
   370
   371 01  CANC-NAME.                                                   00133461
   372     05   A-NAME             PIC X(11) VALUE SPACE.               00133462
   373     05   A-INIT             PIC X     VALUE SPACE.               00133463
   374
   375 01  W-PROC-YR-CEN.                                               00133497
   376     05  W-PROC-MO          PIC 99        VALUE ZEROS.            00133417
   377     05  W-PROC-SLASH       PIC X         VALUE '/'.              00133417
   378     05  W-PROC-CEN         PIC X(02)     VALUE SPACES.           00133498
   379     05  W-PROC-YR          PIC 9(02)     VALUE ZEROS.            00133499
   380                                                                  00133500
   381 01  OUT-RECORD.                                                  00133501
   382     05  OUT-CERT-NO        PIC X(10)     VALUE SPACES.           00133502
   383     05  OUT-CERT-SFX       PIC X(01)     VALUE SPACES.           00133503
   384     05  OUT-EFF-DATE       PIC X(06)     VALUE SPACES.           00133504
   385     05  OUT-INFO           PIC X(61)     VALUE SPACES.           00133505
   386     05  OUT-TRAN-TYPE      PIC X         VALUE SPACES.           00133506
   387     05  OUT-SEQUENCE       PIC X         VALUE SPACES.           00133507
   388     05  OUT-ACCOUNT-NO     PIC X(10)     VALUE SPACES.
   389     05  OUT-BATCH-HDR-IND  PIC X         VALUE SPACES.
   390
   391 01  FPB-BATCH-NO.
   392     05  SR-BATCH-NUMB.                                           00133508
   393         10  SR-BATCH-ID    PIC XX        VALUE ZEROS.            00133508
   394         10  SR-BATCH-DA    PIC XX        VALUE ZEROS.            00133508
   395         10  SR-BATCH-NO    PIC 99        VALUE ZEROS.            00133508
   396     05  SR-REC-CNT         PIC 9(4)      VALUE ZEROS.            00133509
   397                                                                  00133510
   398 01  SAVE-FULL-ACCT.                                              00133511
   399     05 SAVE-ACCT-7         PIC X(07)     VALUE SPACES.           00133512
   400     05 SAVE-ACCT           PIC XXX       VALUE SPACES.           00133513
   401                                                                  00133514
   402 01  FPB-BATCH-HDR.
   403     05 FP-CARR-CO.                                               00133516
   404         10 FP-CARR          PIC X         VALUE '9'.             00133517
   405         10 FP-COMP          PIC X(6)      VALUE '000000'.        00133518
   406     05 FP-STATE             PIC XX        VALUE 'SD'.            00133519
   407     05 FP-ACCT-NO           PIC X(10)     VALUE SPACES.
   408     05 FP-BATCH-NUMB.                                            00133521
   409         10 FP-BATCH-ID      PIC XX        VALUE ZEROS.           00133521
   410         10 FP-BATCH-DA      PIC XX        VALUE ZEROS.           00133521
   411         10 FP-BATCH-NO      PIC 99        VALUE ZEROS.           00133521
   412     05 FP-HD-EFF-DT.                                             00133522
   413         10 FP-HD-EFF-MO     PIC XX        VALUE SPACES.          00133523
   414         10 FP-HD-EFF-DA     PIC XX        VALUE SPACES.          00133524
   415         10 FP-HD-EFF-YR     PIC XX        VALUE SPACES.          00133525
   416     05 FP-CERT-ISS          PIC S9(4)     VALUE ZEROS.           00133526
   417     05 FP-LF-WRITTEN        PIC S9(7)V99  VALUE ZEROS.           00133527
   418     05 FP-AH-WRITTEN        PIC S9(7)V99  VALUE ZEROS.           00133528
   419     05 FP-CERT-CANC         PIC S9(4)     VALUE ZEROS.           00133529
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIFPB511.cbl
   420     05 FP-LF-CANC           PIC S9(7)V99  VALUE ZEROS.           00133530
   421     05 FP-AH-CANC           PIC S9(7)V99  VALUE ZEROS.           00133531
   422     05 FP-CLIENT-ID         PIC X(3)      VALUE 'CID'.           00133532
   423     05 FP-TRANS-TYPE        PIC X         VALUE '1'.             00133533
   424     05 FP-SEQUENCE-NO       PIC X         VALUE '0'.             00133534
   425     05 FP-ACCOUNT-NO        PIC X(10)  VALUE SPACES.
   426     05 FP-BATCH-HDR-IND     PIC X      VALUE ' '.
   427                                                                  00133535
   428                                                                  00133621
   429 01  WS-BIRTH-DT                 PIC 9(6).
   430 01  ws-birth-dt-x redefines ws-birth-dt pic x(6).
   431 01  WS-1ST-PMT-DT               PIC 9(6).
   432
   433 01  WS-WORK-DATE            PIC X(8).
   434 01  WS-WORK-DATE-N REDEFINES WS-WORK-DATE
   435                             PIC 9(8).
   436 01  WK-DATE-N.                                                   00133622
   437     05  WK-MO-X             PIC XX     VALUE SPACES.             00133623
   438     05  WK-MO-N REDEFINES WK-MO-X PIC 99.                        00133624
   439                                                                  00133625
   440 01  WK-DATE.                                                     00133626
   441     05  WK-MO               PIC XX     VALUE SPACES.             00133627
   442     05  FILLER              PIC X      VALUE SPACES.             00133628
   443     05  WK-DA               PIC XX     VALUE SPACES.             00133629
   444     05  FILLER              PIC X      VALUE SPACES.             00133630
   445     05  WK-YR               PIC XX     VALUE SPACES.             00133631
   446                                                                  00133632
   447 01  WORK-DATE.                                                   00133633
   448     12  WORK-BIRTH-DATE.
   449         15  WB-CC               PIC XX.
   450         15  WB-YY               PIC XX.
   451         15  WB-MM               PIC XX.
   452         15  WB-DD               PIC XX.
   453     12  WORK-BIRTH-DATE-N REDEFINES WORK-BIRTH-DATE
   454                                 PIC 9(8).
   455     12  WORK-DATE-X.                                             00133634
   456         15  WORK-MO-X       PIC XX.                              00133635
   457         15  WORK-DA-X       PIC XX.                              00133636
   458         15  WORK-YR-X       PIC XX.                              00133637
   459     12  WORK-DATE-N    REDEFINES   WORK-DATE-X.                  00133638
   460         15  WORK-MO-N       PIC 99.                              00133639
   461         15  WORK-DA-N       PIC 99.                              00133640
   462         15  WORK-YR-N       PIC 99.                              00133641
   463                                                                  00133642
   464     12  WORK-DATE-IN.                                            00133638
   465         15  WORK-YR-IN      PIC 99.                              00133641
   466         15  WORK-MO-IN      PIC 99.                              00133639
   467         15  WORK-DA-IN      PIC 99.                              00133640
   468                                                                  00133642
   469 01  WORK-ISS-DATE.                                               00133642
   470     05  WRK-ISS-YR          PIC XX.                              00133642
   471     05  WRK-ISS-MO          PIC XX.                              00133642
   472     05  WRK-ISS-DA          PIC XX.                              00133642
   473                                                                  00133642
   474 01  WORK-ISS-DTE-R          REDEFINES                            00133638
   475     WORK-ISS-DATE           PIC 9(06).                           00133638
   476                                                                  00133642
   477 01  WORK-ISS-DTE-N          REDEFINES                            00133638
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CIFPB511.cbl
   478     WORK-ISS-DATE.                                               00133638
   479     05  WRK-ISS-YR-N        PIC 99.                              00133642
   480     05  WRK-ISS-MO-N        PIC 99.                              00133642
   481     05  WRK-ISS-DA-N        PIC 99.                              00133642
   482                                                                  00133642
   483                                                                  00133383
   484******************************************************************00133384
   485                                                                  00133379
   486                                                                  00133662
*  487                                 COPY ERCPNDBI.
   488******************************************************************04/29/98
   489*                                                                *ERCPNDBI
   490*                                                                *ERCPNDBI
   491*                            ERCPNDBI                            *   LV015
   492*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
   493*                            VMOD=2.014                          *   CL*14
   494*                                                                *ERCPNDBI
   495*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *ERCPNDBI
   496*                      BATCH INPUT FILE                          *ERCPNDBI
   497*                                                                *ERCPNDBI
   498*   FILE TYPE = SEQUENTIAL                                       *ERCPNDBI
   499*   RECORD SIZE = 80  RECFORM = FIXED                            *ERCPNDBI
   500*                                                                *ERCPNDBI
   501******************************************************************ERCPNDBI
   502*                   C H A N G E   L O G
   503*
   504* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   505*-----------------------------------------------------------------
   506*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   507* EFFECTIVE    NUMBER
   508*-----------------------------------------------------------------
   509* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   510* 032306                   PEMA  ADD BOW LOAN NUMBER
   511* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDBI REC
   512* 032409    2009031600001  AJRA  ADD VIN NUMBER
   513* 040414  CR2014040400001  PEMA  ADD JOINT BIRTHDATE
   514******************************************************************
   515                                                                  ERCPNDBI
   516 01  PENDING-BUSINESS-IN.                                         ERCPNDBI
   517     12  PBI-RECORD-BODY                       PIC X(80).         ERCPNDBI
   518                                                                  ERCPNDBI
   519     12  PBI-ISSUE-CANCEL-COMMON               REDEFINES          ERCPNDBI
   520         PBI-RECORD-BODY.                                         ERCPNDBI
   521         16  PBI-CERT-NO.                                         ERCPNDBI
   522             20  PBI-CERT-PRIME                PIC X(10).         ERCPNDBI
   523             20  PBI-CERT-SFX                  PIC X.             ERCPNDBI
   524         16  PBI-CERT-EFF-DT.                                     ERCPNDBI
   525             20  PBI-CERT-EFF-MO               PIC S99.           ERCPNDBI
   526             20  PBI-CERT-EFF-DA               PIC S99.           ERCPNDBI
   527             20  PBI-CERT-EFF-YR               PIC S99.           ERCPNDBI
   528         16  PBI-CERT-EFF-DT-X                 REDEFINES          ERCPNDBI
   529             PBI-CERT-EFF-DT                   PIC X(6).          ERCPNDBI
   530                                                                  ERCPNDBI
   531         16  FILLER                            PIC X(61).         ERCPNDBI
   532                                                                  ERCPNDBI
   533         16  PBI-TRANS-TYPE                    PIC X.             ERCPNDBI
   534             88  PBI-REMITTANCE                VALUE '1'.         ERCPNDBI
   535             88  PBI-ISSUE                     VALUE '2'.         ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   536             88  PBI-CANCEL                    VALUE '3'.         ERCPNDBI
   537         16  PBI-SEQUENCE                      PIC X.             ERCPNDBI
   538             88  PBI-PROFILE                   VALUE '1'.         ERCPNDBI
   539             88  PBI-JOINT                     VALUE '2'.         ERCPNDBI
   540             88  PBI-LIFE                      VALUE '3'.         ERCPNDBI
   541             88  PBI-AH                        VALUE '4'.         ERCPNDBI
   542             88  PBI-LOAN-INFO                 VALUE '5'.         ERCPNDBI
   543             88  PBI-ADDR-1                    VALUE '6'.         ERCPNDBI
   544             88  PBI-ADDR-2                    VALUE '7'.         ERCPNDBI
   545             88  PBI-CRED-BENE1                VALUE '8'.         ERCPNDBI
   546                                                                  ERCPNDBI
   547******************************************************************ERCPNDBI
   548                                                                  ERCPNDBI
   549     12  PBI-ISSUE-RECORD                      REDEFINES          ERCPNDBI
   550         PBI-RECORD-BODY.                                         ERCPNDBI
   551         16  FILLER                            PIC X(17).         ERCPNDBI
   552                                                                  ERCPNDBI
   553         16  PBI-I-CERT-FORM                   PIC X(61).         ERCPNDBI
   554                                                                  ERCPNDBI
   555         16  PBI-I-ISSUE-REC-SEQ-1             REDEFINES          ERCPNDBI
   556             PBI-I-CERT-FORM.                                     ERCPNDBI
   557             20  PBI-I-INSURED-NAME.                              ERCPNDBI
   558                 24  PBI-I-INS-1ST-NAME.                          ERCPNDBI
   559                     28  PBI-I-INS-1ST-INIT    PIC X.             ERCPNDBI
   560                     28  FILLER                PIC X(9).          ERCPNDBI
   561                 24  PBI-I-INS-MIDDLE-INIT     PIC X.             ERCPNDBI
   562                 24  PBI-I-INS-LAST-NAME       PIC X(15).         ERCPNDBI
   563             20  PBI-I-INSURED-AGE             PIC S99.           ERCPNDBI
   564             20  PBI-I-INSURED-AGE-X           REDEFINES          ERCPNDBI
   565                 PBI-I-INSURED-AGE             PIC XX.            ERCPNDBI
   566             20  PBI-I-INSURED-SEX             PIC X.             ERCPNDBI
   567             20  PBI-I-SOC-SEC-NO              PIC X(11).         ERCPNDBI
   568             20  PBI-I-MEMBER-NO               PIC X(12).         ERCPNDBI
   569             20  PBI-I-BIRTHDAY.                                  ERCPNDBI
   570                 24  PBI-I-BIRTH-MO            PIC S99.           ERCPNDBI
   571                 24  PBI-I-BIRTH-DA            PIC S99.           ERCPNDBI
   572                 24  PBI-I-BIRTH-YR            PIC S99.           ERCPNDBI
   573             20  PBI-I-BIRTHDAY-X              REDEFINES          ERCPNDBI
   574                 PBI-I-BIRTHDAY                PIC X(6).          ERCPNDBI
   575             20  FILLER                        PIC X.             ERCPNDBI
   576             20  PBI-I-ENTRY-CD                PIC X.             ERCPNDBI
   577                 88  REIN-ONLY-CERT            VALUE 'R'.         ERCPNDBI
   578                 88  REISSUED-CERT             VALUE 'E'.         ERCPNDBI
   579                 88  PREM-ACCTNG-ONLY          VALUE 'P'.            CL**3
   580                 88  DECLINED-CERT             VALUE 'D'.            CL**9
   581                 88  CERT-NEEDS-UNDERWRITING   VALUE 'U'.            CL**9
   582                 88  VOIDED-CERT               VALUE 'V'.            CL**9
   583             20  PBI-I-FORCE-CD                PIC X.             ERCPNDBI
   584                 88  FORCE-ALL-ISSUE-ERRORS    VALUE 'A'.         ERCPNDBI
   585                 88  FORCE-DATE-ERRORS-ONLY    VALUE 'D'.         ERCPNDBI
   586                 88  PLACE-REC-ON-HOLD         VALUE 'H'.         ERCPNDBI
   587                                                                  ERCPNDBI
   588         16  PBI-I-ISSUE-REC-SEQ-2             REDEFINES          ERCPNDBI
   589             PBI-I-CERT-FORM.                                     ERCPNDBI
   590             20  PBI-I-JOINT-NAME.                                ERCPNDBI
   591                 24  PBI-I-JNT-1ST-NAME.                          ERCPNDBI
   592                     28  PBI-I-JNT-1ST-INIT    PIC X.             ERCPNDBI
   593                     28  FILLER                PIC X(9).          ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   594                 24  PBI-I-JNT-MIDDLE-INIT     PIC X.             ERCPNDBI
   595                 24  PBI-I-JNT-LAST-NAME       PIC X(15).         ERCPNDBI
   596             20  PBI-I-JOINT-AGE               PIC S99.           ERCPNDBI
   597             20  PBI-I-JOINT-AGE-X             REDEFINES          ERCPNDBI
   598                 PBI-I-JOINT-AGE               PIC XX.            ERCPNDBI
   599             20  PBI-I-POLICY-FORM-NO          PIC X(12).
   600             20  PBI-I-JNT-BIRTHDAY.
   601                 24  PBI-I-JNT-BIRTH-MO        PIC S99.
   602                 24  PBI-I-JNT-BIRTH-DA        PIC S99.
   603                 24  PBI-I-JNT-BIRTH-YR        PIC S99.
   604             20  PBI-I-JNT-BIRTHDAY-X          REDEFINES
   605                 PBI-I-JNT-BIRTHDAY            PIC X(6).
   606             20  FILLER                        PIC X(15).            CL**4
   607                                                                  ERCPNDBI
   608         16  PBI-I-ISSUE-REC-SEQ-3             REDEFINES          ERCPNDBI
   609             PBI-I-CERT-FORM.                                     ERCPNDBI
   610             20  FILLER                        PIC X.             ERCPNDBI
   611             20  PBI-I-LF-BENEFIT-TYPE         PIC XX.            ERCPNDBI
   612             20  PBI-I-LF-TERM                 PIC S9(03).        ERCPNDBI
   613             20  PBI-I-LF-TERM-X               REDEFINES          ERCPNDBI
   614                 PBI-I-LF-TERM                 PIC X(3).          ERCPNDBI
   615             20  PBI-I-LF-BENEFIT-AMT          PIC S9(09)V99.     ERCPNDBI
   616             20  PBI-I-LF-BENEFIT-AMT-X        REDEFINES          ERCPNDBI
   617                 PBI-I-LF-BENEFIT-AMT          PIC X(11).         ERCPNDBI
   618             20  PBI-I-LF-PREM-AMT             PIC S9(7)V99.      ERCPNDBI
   619             20  PBI-I-LF-PREM-AMT-X           REDEFINES          ERCPNDBI
   620                 PBI-I-LF-PREM-AMT             PIC X(9).          ERCPNDBI
   621             20  PBI-I-LF-CRIT-PERIOD          PIC 999.           ERCPNDBI
   622             20  PBI-I-LF-CRIT-PERIOD-X        REDEFINES          ERCPNDBI
   623                 PBI-I-LF-CRIT-PERIOD          PIC XXX.           ERCPNDBI
   624             20  PBI-I-LF-EXPIRE-DT.                              ERCPNDBI
   625                 24  PBI-I-LF-EXPIRE-MO        PIC S99.           ERCPNDBI
   626                 24  PBI-I-LF-EXPIRE-DA        PIC S99.           ERCPNDBI
   627                 24  PBI-I-LF-EXPIRE-YR        PIC S99.           ERCPNDBI
   628             20  PBI-I-LF-EXPIRE-DT-X          REDEFINES          ERCPNDBI
   629                 PBI-I-LF-EXPIRE-DT            PIC X(6).          ERCPNDBI
   630             20  PBI-I-LF-ALT-BENEFIT-AMT      PIC S9(07)V99.     ERCPNDBI
   631             20  PBI-I-LF-ALT-BENEFIT-AMT-X    REDEFINES          ERCPNDBI
   632                 PBI-I-LF-ALT-BENEFIT-AMT      PIC X(9).          ERCPNDBI
   633             20  PBI-I-LF-ALT-PREM-AMT         PIC S9(5)V99.      ERCPNDBI
   634             20  PBI-I-LF-ALT-PREM-AMT-X       REDEFINES          ERCPNDBI
   635                 PBI-I-LF-ALT-PREM-AMT         PIC X(7).          ERCPNDBI
   636             20  PBI-I-TERM-AS-DAYS            PIC 9(5).          ERCPNDBI
   637             20  PBI-I-TERM-AS-DAYS-X          REDEFINES          ERCPNDBI
   638                 PBI-I-TERM-AS-DAYS            PIC X(5).          ERCPNDBI
   639             20  FILLER                        PIC X(5).          ERCPNDBI
   640                                                                  ERCPNDBI
   641         16  PBI-I-ISSUE-REC-SEQ-4             REDEFINES          ERCPNDBI
   642             PBI-I-CERT-FORM.                                     ERCPNDBI
   643             20  PBI-I-AH-BENEFIT-TYPE.                           ERCPNDBI
   644                 24  PBI-I-AH-BENEFIT-POS1     PIC X.                CL**4
   645                 24  PBI-I-AH-BENEFIT-NO       PIC XX.            ERCPNDBI
   646             20  PBI-I-AH-TERM                 PIC S9(3).         ERCPNDBI
   647             20  PBI-I-AH-TERM-X               REDEFINES          ERCPNDBI
   648                 PBI-I-AH-TERM                 PIC X(3).          ERCPNDBI
   649             20  FILLER                        PIC XX.            ERCPNDBI
   650             20  PBI-I-AH-BENEFIT-AMT          PIC S9(7)V99.      ERCPNDBI
   651             20  PBI-I-AH-BENEFIT-AMT-X        REDEFINES          ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   652                 PBI-I-AH-BENEFIT-AMT          PIC X(9).          ERCPNDBI
   653             20  PBI-I-AH-PREM-AMT             PIC S9(7)V99.      ERCPNDBI
   654             20  PBI-I-AH-PREM-AMT-X           REDEFINES          ERCPNDBI
   655                 PBI-I-AH-PREM-AMT             PIC X(9).          ERCPNDBI
   656             20  PBI-I-AH-CRIT-PERIOD          PIC 999.           ERCPNDBI
   657             20  PBI-I-AH-CRIT-PERIOD-X        REDEFINES          ERCPNDBI
   658                 PBI-I-AH-CRIT-PERIOD          PIC XXX.           ERCPNDBI
   659             20  PBI-I-AH-EXPIRE-DT.                              ERCPNDBI
   660                 24  PBI-I-AH-EXPIRE-MO        PIC S99.           ERCPNDBI
   661                 24  PBI-I-AH-EXPIRE-DA        PIC S99.           ERCPNDBI
   662                 24  PBI-I-AH-EXPIRE-YR        PIC S99.           ERCPNDBI
   663             20  PBI-I-AH-EXPIRE-DT-X          REDEFINES          ERCPNDBI
   664                 PBI-I-AH-EXPIRE-DT            PIC X(6).          ERCPNDBI
   665             20  PBI-I-AH-PAYMENT              PIC S9(7)V99.         CL**6
   666             20  PBI-I-AH-PAYMENT-X            REDEFINES             CL**6
   667                 PBI-I-AH-PAYMENT              PIC X(9).             CL**6
   668*00160              20  FILLER                        PIC X(17).
   669             20  PBI-I-VIN                     PIC X(17).
   670                                                                  ERCPNDBI
   671         16  PBI-I-ISSUE-REC-SEQ-5             REDEFINES          ERCPNDBI
   672             PBI-I-CERT-FORM.                                     ERCPNDBI
   673             20  PBI-I-LOAN-OFFICER            PIC X(5).          ERCPNDBI
   674             20  PBI-I-LOAN-TERM               PIC S999.          ERCPNDBI
   675             20  PBI-I-LOAN-TERM-X             REDEFINES          ERCPNDBI
   676                 PBI-I-LOAN-TERM               PIC XXX.           ERCPNDBI
   677             20  PBI-I-1ST-PMT-DT.                                ERCPNDBI
   678                 24  PBI-I-1ST-PMT-MO          PIC S99.           ERCPNDBI
   679                 24  PBI-I-1ST-PMT-DA          PIC S99.           ERCPNDBI
   680                 24  PBI-I-1ST-PMT-YR          PIC S99.           ERCPNDBI
   681             20  PBI-I-1ST-PMT-DT-X            REDEFINES          ERCPNDBI
   682                 PBI-I-1ST-PMT-DT              PIC X(6).          ERCPNDBI
   683             20  PBI-I-EXT-DAYS                PIC S999.          ERCPNDBI
   684             20  PBI-I-EXT-DAYS-X              REDEFINES          ERCPNDBI
   685                 PBI-I-EXT-DAYS                PIC XXX.           ERCPNDBI
   686             20  PBI-I-INDV-GRP-CD             PIC X.             ERCPNDBI
   687             20  PBI-I-REIN-CODE               PIC X.             ERCPNDBI
   688             20  PBI-I-SIG-SW                  PIC X.             ERCPNDBI
   689             20  PBI-I-TERM-TYPE               PIC X.                CL**6
   690*            20  FILLER                        PIC X.                CL**6
   691             20  PBI-I-LOAN-APR                PIC 9(2)V9(4).     ERCPNDBI
   692             20  PBI-I-LOAN-APR-X              REDEFINES          ERCPNDBI
   693                 PBI-I-LOAN-APR                PIC X(6).          ERCPNDBI
   694             20  PBI-I-LIVES                   PIC 9(3).          ERCPNDBI
   695             20  PBI-I-LIVES-X                 REDEFINES          ERCPNDBI
   696                 PBI-I-LIVES                   PIC X(3).             CL**6
   697             20  PBI-I-NO-OF-PAYMENTS          REDEFINES             CL**6
   698                 PBI-I-LIVES                   PIC 9(3).             CL**6
   699             20  PBI-I-NO-OF-PAYMENTS-X        REDEFINES             CL**6
   700                 PBI-I-LIVES                   PIC X(3).          ERCPNDBI
   701             20  PBI-I-PAY-FREQUENCY           PIC 99.            ERCPNDBI
   702             20  PBI-I-PAY-FREQUENCY-X         REDEFINES          ERCPNDBI
   703                 PBI-I-PAY-FREQUENCY           PIC XX.            ERCPNDBI
   704             20  PBI-I-RATE-CLASS              PIC XX.            ERCPNDBI
   705             20  PBI-I-SKIP-CODE               PIC XX.            ERCPNDBI
   706*            20  FILLER                        PIC X.             ERCPNDBI
   707             20  PBI-I-BENEFICIARY             PIC X(25).         ERCPNDBI
   708                                                                  ERCPNDBI
   709         16  PBI-I-ISSUE-REC-SEQ-6             REDEFINES          ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   710             PBI-I-CERT-FORM.                                     ERCPNDBI
   711             20  PBI-I-INSURED-ADDRESS-1       PIC X(30).         ERCPNDBI
   712             20  PBI-I-INSURED-ADDRESS-2       PIC X(30).         ERCPNDBI
   713             20  FILLER                        PIC X.             ERCPNDBI
   714                                                                  ERCPNDBI
   715         16  PBI-I-ISSUE-REC-SEQ-7             REDEFINES          ERCPNDBI
   716             PBI-I-CERT-FORM.                                     ERCPNDBI
   717             20  PBI-I-INSURED-CITY-STATE.
   718                 24  PBI-I-INSURED-CITY        PIC X(28).
   719                 24  PBI-I-INSURED-STATE       PIC XX.
   720             20  PBI-I-INSURED-ZIP-CODE.                             CL**7
   721                 24  PBI-I-INSURED-ZIP-PRIME.                        CL**7
   722                     28  PBI-I-INSURED-ZIP-1   PIC X.                CL**7
   723                         88  PBI-I-CANADIAN-POST-CODE                CL**7
   724                                             VALUE 'A' THRU 'Z'.     CL**7
   725                     28  FILLER                PIC X(4).             CL**7
   726                 24  PBI-I-INSURED-ZIP-PLUS4   PIC X(4).             CL**7
   727             20  PBI-I-INSURED-CANADIAN-ZIP  REDEFINES               CL**7
   728                                          PBI-I-INSURED-ZIP-CODE.    CL**7
   729                 24  PBI-I-INS-CAN-POST1       PIC XXX.              CL**7
   730                 24  PBI-I-INS-CAN-POST2       PIC XXX.              CL**7
   731                 24  FILLER                    PIC XXX.              CL**7
   732             20  PBI-I-INSURED-PHONE-NO        PIC X(10).         ERCPNDBI
   733             20  FILLER                        PIC X(12).         ERCPNDBI
   734                                                                     CL*10
   735         16  PBI-I-ISSUE-REC-SEQ-8             REDEFINES          ERCPNDBI
   736             PBI-I-CERT-FORM.                                     ERCPNDBI
   737             20  PBI-I-CRED-BENE-NAME          PIC X(30).         ERCPNDBI
   738             20  PBI-I-CRED-BENE-ADDR1         PIC X(30).         ERCPNDBI
   739             20  FILLER                        PIC X.             ERCPNDBI
   740                                                                  ERCPNDBI
   741         16  PBI-I-ISSUE-REC-SEQ-9             REDEFINES          ERCPNDBI
   742             PBI-I-CERT-FORM.                                     ERCPNDBI
   743             20  PBI-I-CRED-BENE-ADDR2         PIC X(30).         ERCPNDBI
   744             20  PBI-I-CRED-BENE-CITYST.
   745                 24  PBI-I-CRED-BENE-CITY      PIC X(28).
   746                 24  PBI-I-CRED-BENE-STATE     PIC XX.
   747             20  FILLER                        PIC X.             ERCPNDBI
   748                                                                  ERCPNDBI
   749         16  PBI-I-ISSUE-REC-DMD-MISC          REDEFINES             CL*12
   750             PBI-I-ISSUE-REC-SEQ-7.                                  CL*12
   751             20  PBI-I-DMD-CURRENT-PREM-RATE   PIC S99V9(5).         CL*11
   752             20  PBI-I-DMD-PRIMA-FACIA-PRM-RATE                      CL*10
   753                                               PIC S99V9(5).         CL*10
   754             20  PBI-I-DMD-RATE-CODE           PIC X(4).             CL*10
   755             20  PBI-I-DMD-RESIDENT-STATE      PIC XX.               CL*10
   756             20  PBI-I-DMD-LIVES               PIC S9(7).            CL*10
   757             20  PBI-I-DMD-BILLED              PIC S9(7).            CL*10
   758             20  FILLER                        PIC X(27).            CL*10
   759                                                                  ERCPNDBI
   760         16  PBI-I-TRANS-TYPE                  PIC X.             ERCPNDBI
   761             88  PBI-ISSUE-TRANS               VALUE '2'.         ERCPNDBI
   762         16  PBI-I-SEQUENCE                    PIC X.             ERCPNDBI
   763                                                                  ERCPNDBI
   764******************************************************************ERCPNDBI
   765                                                                  ERCPNDBI
   766     12  PBI-CANCEL-RECORD                    REDEFINES           ERCPNDBI
   767         PBI-RECORD-BODY.                                         ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   768         16  FILLER                            PIC X(17).         ERCPNDBI
   769                                                                  ERCPNDBI
   770         16  PBI-C-CERT-FORM                   PIC X(61).            CL**5
   771         16  PBI-C-CANCEL-REC-SEQ-1 REDEFINES                        CL**5
   772             PBI-C-CERT-FORM.                                        CL**5
   773             20  PBI-C-LF-CANCEL-DATE.                               CL**5
   774                 24  PBI-C-LF-CAN-MO           PIC S99.              CL**5
   775                 24  PBI-C-LF-CAN-DA           PIC S99.              CL**5
   776                 24  PBI-C-LF-CAN-YR           PIC S99.              CL**5
   777             20  PBI-C-LF-CANCEL-DATE-X        REDEFINES             CL**5
   778                 PBI-C-LF-CANCEL-DATE          PIC X(6).             CL**5
   779             20  PBI-C-LF-PREM-REFUND          PIC S9(7)V99.         CL**5
   780             20  PBI-C-LF-PREM-REFUND-X        REDEFINES             CL**5
   781                 PBI-C-LF-PREM-REFUND          PIC X(9).             CL**5
   782                                                                  ERCPNDBI
   783             20  PBI-C-AH-CANCEL-DATE.                               CL**5
   784                 24  PBI-C-AH-CAN-MO           PIC S99.              CL**5
   785                 24  PBI-C-AH-CAN-DA           PIC S99.              CL**5
   786                 24  PBI-C-AH-CAN-YR           PIC S99.              CL**5
   787             20  PBI-C-AH-CANCEL-DATE-X        REDEFINES             CL**5
   788                 PBI-C-AH-CANCEL-DATE          PIC X(6).             CL**5
   789             20  PBI-C-AH-PREM-REFUND          PIC S9(7)V99.         CL**5
   790             20  PBI-C-AH-PREM-REFUND-X        REDEFINES             CL**5
   791                 PBI-C-AH-PREM-REFUND          PIC X(9).             CL**5
   792                                                                  ERCPNDBI
   793             20  PBI-C-INSURED-NAME            PIC X(15).            CL**5
   794             20  PBI-C-LIVES                   PIC 999.              CL**5
   795             20  PBI-C-LIVES-X                 REDEFINES             CL**5
   796                 PBI-C-LIVES                   PIC XXX.              CL**5
   797             20  PBI-C-POLICY-FORM-NO          PIC X(12).            CL*13
   798             20  PBI-C-FORCE-CD                PIC X.                CL**5
   799         16  PBI-C-CANCEL-REC-SEQ-2 REDEFINES                        CL**5
   800             PBI-C-CERT-FORM.                                        CL**5
   801             20  PBI-C-BENEFICIARY-NAME        PIC X(25).            CL**5
   802             20  PBI-C-BOW-LOAN-NUMBER         PIC X(14).
   803*            20  FILLER                        PIC X(36).            CL**5
   804             20  FILLER                        PIC X(22).            CL**5
   805         16  PBI-C-TRANS-TYPE                  PIC X.             ERCPNDBI
   806             88  PBI-CANCEL-TRANS              VALUE '3'.         ERCPNDBI
   807         16  PBI-C-SEQUENCE                    PIC X.             ERCPNDBI
   808                                                                  ERCPNDBI
   809******************************************************************ERCPNDBI
   810                                                                  ERCPNDBI
   811     12  PBI-BATCH-RECORD   REDEFINES PBI-RECORD-BODY.            ERCPNDBI
   812         16  PBI-CARRIER                       PIC X.             ERCPNDBI
   813         16  PBI-GROUPING                      PIC X(6).          ERCPNDBI
   814         16  PBI-STATE                         PIC XX.            ERCPNDBI
   815         16  PBI-ACCOUNT                       PIC X(10).         ERCPNDBI
   816                                                                  ERCPNDBI
   817         16  PBI-B-BATCH-NO                    PIC S9(6).         ERCPNDBI
   818         16  PBI-B-BATCH-NO-X                  REDEFINES          ERCPNDBI
   819             PBI-B-BATCH-NO                    PIC X(6).          ERCPNDBI
   820                                                                  ERCPNDBI
   821         16  PBI-B-BATCH-DT.                                      ERCPNDBI
   822             20  PBI-B-BATCH-MO                PIC S99.           ERCPNDBI
   823             20  PBI-B-BATCH-DA                PIC S99.              CL**8
   824             20  PBI-B-BATCH-YR                PIC S99.              CL**8
   825         16  PBI-B-BATCH-DT-X                  REDEFINES          ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   826             PBI-B-BATCH-DT                    PIC X(6).          ERCPNDBI
   827                                                                  ERCPNDBI
   828         16  PBI-B-CERT-ISS-COUNT              PIC S9(4).         ERCPNDBI
   829         16  PBI-B-CERT-ISS-COUNT-X            REDEFINES          ERCPNDBI
   830             PBI-B-CERT-ISS-COUNT              PIC X(4).          ERCPNDBI
   831                                                                  ERCPNDBI
   832         16  PBI-B-LF-PRM-WRITTEN              PIC S9(7)V99.      ERCPNDBI
   833         16  PBI-B-LF-PRM-WRITTEN-X            REDEFINES          ERCPNDBI
   834             PBI-B-LF-PRM-WRITTEN              PIC X(9).          ERCPNDBI
   835                                                                  ERCPNDBI
   836         16  PBI-B-AH-PRM-WRITTEN              PIC S9(7)V99.      ERCPNDBI
   837         16  PBI-B-AH-PRM-WRITTEN-X            REDEFINES          ERCPNDBI
   838             PBI-B-AH-PRM-WRITTEN              PIC X(9).          ERCPNDBI
   839                                                                  ERCPNDBI
   840         16  PBI-B-CERT-CAN-COUNT              PIC S9(4).         ERCPNDBI
   841         16  PBI-B-CERT-CAN-COUNT-X            REDEFINES          ERCPNDBI
   842             PBI-B-CERT-CAN-COUNT              PIC X(4).          ERCPNDBI
   843                                                                  ERCPNDBI
   844         16  PBI-B-LF-PRM-CANCELLED            PIC S9(7)V99.      ERCPNDBI
   845         16  PBI-B-LF-PRM-CANCELLED-X          REDEFINES          ERCPNDBI
   846             PBI-B-LF-PRM-CANCELLED            PIC X(9).          ERCPNDBI
   847                                                                  ERCPNDBI
   848         16  PBI-B-AH-PRM-CANCELLED            PIC S9(7)V99.      ERCPNDBI
   849         16  PBI-B-AH-PRM-CANCELLED-X          REDEFINES          ERCPNDBI
   850             PBI-B-AH-PRM-CANCELLED            PIC X(9).          ERCPNDBI
   851                                                                  ERCPNDBI
   852         16  PBI-CLIENT-ID                     PIC XXX.           ERCPNDBI
   853                                                                  ERCPNDBI
   854         16  PBI-B-TRANS-TYPE                  PIC X.             ERCPNDBI
   855             88  PBI-REMITTANCE-TRANS          VALUE '1'.         ERCPNDBI
   856         16  PBI-B-SEQUENCE                    PIC X.             ERCPNDBI
   857                                                                  ERCPNDBI
   858******************************************************************ERCPNDBI
*  859                                 COPY ERCFPBRL.
   860******************************************************************
   861*                                                                *
   862*                                                                *
   863*                            ERCFPBRL.                           *
   864*                                                                *
   865* FILE DESCRIPTION = NEW BUSINESS AND CANCELS FOR FIRST PREMIER  *
   866*                                                                *
   867******************************************************************
   868*                                                                *
   869*                                                                *
   870*   FILE TYPE = QSAM                                             *
   871*   RECORD SIZE = 936  RECFORM = FIXED                           *
   872*                                                                *
   873******************************************************************
   874******************************************************************
   875*                   C H A N G E   L O G
   876*
   877* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   878*-----------------------------------------------------------------
   879*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   880* EFFECTIVE    NUMBER
   881*-----------------------------------------------------------------
   882* 051106                   PEMA  NEW COPYBOOK
   883******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
   884
   885 01  FIRST-PREMIER-INPUT.
   886     05  FP-RECORD-ID                     PIC X.
   887         88  VALID-REC-1                        VALUE '1'.
   888         88  VALID-REC-2                        VALUE '2'.
   889         88  VALID-REC-3                        VALUE '3'.
   890         88  VALID-REC-4                        VALUE '4'.
   891         88  VALID-REC-5                        VALUE '5'.
   892         88  VALID-REC-7                        VALUE '7'.
   893         88  VALID-REC-9                        VALUE '9'.
   894     05  FP-RECORD-NA-TYPE                PIC X.
   895     05  FP-RECORD-DATA-TYPE              PIC X.
   896     05  FP-RECORD-SOFT-TYPE              PIC X.
   897     05  FP-RECORD-BODY                   PIC X(932).
   898
   899******************************************************************
   900*    SECTION 1: RECORD ONE                                       *
   901******************************************************************
   902     05  FP-REC-1 REDEFINES FP-RECORD-BODY.
   903         10  FP1-REC-SIZE                 PIC 9(4).
   904         10  FP1-BLOCK-FACTOR             PIC 9(4).
   905         10  FP1-INST-NUMBER              PIC 99.
   906         10  FP1-EDIT-MASK-TYPE           PIC X.
   907         10  FP1-NA-TYPE                  PIC X.
   908         10  FP1-DATA-REC-TYPE            PIC X.
   909         10  FP1-SOFT-TYPE                PIC X.
   910         10  FILLER                       PIC X(914).
   911
   912******************************************************************
   913*    SECTION 2: RECORD TWO                                       *
   914******************************************************************
   915     05  FP-REC-2 REDEFINES FP-RECORD-BODY.
   916         10  FP2-NA-ELEMENTS-USED         PIC 99.
   917         10  FP2-NA-ELEMENT-START         PIC 99.
   918         10  FP2-DATA-ELEMENTS-USED       PIC 99.
   919         10  FP2-DATA-ELEMENTS-START      PIC 99.
   920         10  FP2-SOFT-ELEMENTS-USED       PIC 999.
   921         10  FP2-SOFT-ELEMENTS-START      PIC 99.
   922         10  FILLER                       PIC X(915).
   923
   924******************************************************************
   925*    SECTION 3: RECORD THREE                                     *
   926******************************************************************
   927     05  FP-REC-3 REDEFINES FP-RECORD-BODY.
   928         10  FP3-DATE-CREATED             PIC X(6).
   929         10  FP3-TIME-CREATED             PIC X(4).
   930         10  FILLER                       PIC X(922).
   931
   932******************************************************************
   933*    SECTION 4: RECORD FOUR                                      *
   934******************************************************************
   935     05  FP-REC-4 REDEFINES FP-RECORD-BODY.
   936         10  FP4-PROGRAM-NAME             PIC X(8).
   937         10  FP4-PROGRAM-RELEASE          PIC X(6).
   938         10  FILLER                       PIC X(918).
   939
   940******************************************************************
   941*    SECTION 5: RECORD FIVE                                      *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
   942******************************************************************
   943     05  FP-REC-5 REDEFINES FP-RECORD-BODY.
   944         10  FP5-SOFT-FIELD-AREA OCCURS 26.
   945             15  FP5-SOFT-FLD-TYPE        PIC 9.
   946             15  FP5-SOFT-FLD-CODE        PIC X(4).
   947             15  FP5-SOFT-FLD-REF         PIC 999.
   948             15  FP5-SOFT-FLD-OCCURS      PIC 99.
   949         10  FILLER                       PIC X(722).
   950
   951******************************************************************
   952*    SECTION 7: RECORD SEVEN                                     *
   953******************************************************************
   954     05  FP-REC-7 REDEFINES FP-RECORD-BODY.
   955         10  FP7-INST-NUMBER              PIC 99.
   956         10  FP7-ACCOUNT-NUMBER           PIC X(10).
   957         10  FP7-MASTER-LINK              PIC X(7).
   958         10  FP7-1ST-ACCOUNT-FLAG         PIC X.
   959         10  FP7-NAME-1                   PIC X(30).
   960         10  FP7-NAME-2                   PIC X(30).
   961         10  FP7-NAME-3                   PIC X(30).
   962         10  FP7-ADDRESS                  PIC X(30).
   963         10  FP7-CITY-STATE-ZIP           PIC X(35).
   964         10  FP7-SHORT-LNAME              PIC X(15).
   965         10  FP7-SHORT-FNAME              PIC X(10).
   966         10  FP7-MID-INIT                 PIC X.
   967         10  FP7-TAX-ID-CODE              PIC X.
   968         10  FP7-TAX-ID                   PIC X(9).
   969         10  FP7-TAX-ID-NAME-NO           PIC X.
   970         10  FP7-ADDENDA-TYPE             PIC XX.
   971         10  FP7-ADDENDA-NO               PIC 999.
   972         10  FP7-RESP-CODE                PIC 9(5).
   973         10  FP7-MISC-CODE                PIC 999.
   974         10  FP7-EXP-DATE1                PIC X(10).
   975         10  FP7-FORECAST-DATE            PIC X(10).
   976         10  FP7-INS-TABLE                PIC 999.
   977         10  FP7-POLICY-DATE              PIC X(10).
   978         10  FP7-1ST-EARN-DATE            PIC X(10).
   979         10  FP7-LST-EARN-DATE            PIC X(10).
   980         10  FP7-INS-MOS                  PIC 999.
   981         10  FP7-PREMIUM                  PIC 9(8)V99.
   982         10  FP7-CANC-DATE                PIC X(10).
   983         10  FP7-CANC-AMT                 PIC 9(8)V99.
   984         10  FP7-CANC-REASON              PIC 99.
   985         10  FP7-EARN-RATE                PIC 999V9(4).
   986         10  FP7-INT-CODE                 PIC 9.
   987         10  FP7-PMT-AMT                  PIC 9(11)V99.
   988         10  FP7-BALLOON-AMT              PIC 9(11)V99.
   989         10  FP7-MOS-EXT                  PIC 999.
   990         10  FP7-ADJ-AMT                  PIC S9(8)V99.
   991         10  FP7-PREV-PREMIUM             PIC 9(8)V99.
   992         10  FP7-CURR-UEP                 PIC 9(8)V99.
   993         10  FP7-PREV-UEP                 PIC 9(8)V99.
   994         10  FP7-CHG-DATE                 PIC X(10).
   995         10  FP7-REPT-CODE                PIC 9.
   996         10  FP7-CANC-REPT-CODE           PIC 9.
   997         10  FP7-EOM-REPT-CODE            PIC 9.
   998         10  FP7-DESC                     PIC X(60).
   999         10  FP7-FILLER                   PIC X(73).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
  1000         10  FILLER                       PIC X.
  1001         10  FP7-CISM-SHORT-LNAME         PIC X(17).
  1002         10  FILLER                       PIC X.
  1003         10  FP7-CISM-SHORT-MID-INIT      PIC X(17).
  1004         10  FILLER                       PIC X.
  1005         10  FP7-CISM-SHORT-FNAME         PIC X(17).
  1006         10  FILLER                       PIC X(6).
  1007         10  FP7-CISM-GENDER-CODE         PIC 9(12).
  1008         10  FILLER                       PIC X(6).
  1009         10  FP7-CISM-TAX-ID-NO           PIC 9(12).
  1010         10  FILLER                       PIC X(8).
  1011         10  FP7-CISM-BIRTH-DT            PIC X(10).
  1012         10  FILLER                       PIC X.
  1013         10  FP7-LASN-ORIG-NOTE-AMT-SIGN  PIC X.
  1014         10  FP7-LASN-ORIG-NOTE-AMT.
  1015             15  FP7-AMT-DOLLARS          PIC 9(13).
  1016             15  FILLER                   PIC X.
  1017             15  FP7-AMT-CENTS            PIC 99.
  1018         10  FILLER                       PIC X(6).
  1019         10  FP7-LASN-RESP-CODE           PIC 9(12).
  1020         10  FILLER                       PIC X(6).
  1021         10  FP7-LASN-LOAN-TERM           PIC 9(12).
  1022         10  FILLER                       PIC X(8).
  1023         10  FP7-LASN-ORIG-1ST-PMT-DT     PIC X(10).
  1024         10  FILLER                       PIC X(4).
  1025         10  FP7-APR.
  1026             15  FP7-APR-SIGN             PIC X.
  1027             15  FP7-APR-WHOLE            PIC 9(6).
  1028             15  FILLER                   PIC X.
  1029             15  FP7-APR-DEC              PIC 9(6).
  1030         10  FILLER                       PIC X.
  1031         10  FP7-CISM-ADDRESS             PIC X(17).
  1032         10  FILLER                       PIC X.
  1033         10  FP7-CISM-CITY                PIC X(17).
  1034         10  FILLER                       PIC X.
  1035         10  FP7-CISM-STATE               PIC X(17).
  1036         10  FILLER                       PIC X(6).
  1037         10  FP7-CISM-ZIP-5               PIC X(12).
  1038         10  FILLER                       PIC X(6).
  1039         10  FP7-CISM-ZIP-9               PIC X(12).
  1040         10  FILLER                       PIC X(6).
  1041         10  FP7-CISM-HOME-PHONE          PIC 9(12).
  1042         10  FILLER                       PIC X(8).
  1043         10  FP7-NOTE-DATE                PIC X(10).
  1044         10  FILLER                       PIC X.
  1045         10  FP7-REG-PYMT-AMT.
  1046             15  FP7-REG-PYMT-PI-AMT-SIGN PIC X.
  1047             15  FP7-REG-PYMT-DOLLARS     PIC 9(13).
  1048             15  FILLER                   PIC X.
  1049             15  FP7-REG-PYMT-CENTS       PIC 99.
  1050         10  FILLER                       PIC X(8).
  1051         10  FP7-CURR-MAT-DATE            PIC X(10).
  1052         10  FILLER                       PIC X(6).
  1053         10  FP7-PYMT-SCHED-FREQ          PIC X(12).
  1054         10  FILLER                       PIC X(6).
  1055         10  FP7-BRANCH-NO                PIC X(12).
  1056
  1057******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
  1058*    SECTION 9: RECORD NINE                                      *
  1059******************************************************************
  1060     05  FP-REC-9 REDEFINES FP-RECORD-BODY.
  1061         10  FP9-REC-COUNT                PIC 9(8).
  1062         10  FILLER                       PIC X(924).
  1063
  1064******************************************************************
* 1065                                 COPY ELCDATE.
  1066******************************************************************06/11/98
  1067*                                                                *ELCDATE
  1068*                                                                *ELCDATE
  1069*                            ELCDATE.                            *   LV023
  1070*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1071*                            VMOD=2.003                           ELCDATE
  1072*                                                                *ELCDATE
  1073*                                                                *ELCDATE
  1074*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1075*                 LENGTH = 200                                   *   CL*19
  1076******************************************************************ELCDATE
  1077                                                                  ELCDATE
  1078 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1079     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1080     12  DC-OPTION-CODE                PIC X.                        CL*15
  1081         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1082         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1083         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1084         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1085         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1086         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1087         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1088         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1089         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1090         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1091         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1092         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1093         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1094         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1095         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1096         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1097         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1098         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1099         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1100         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1101         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1102         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1103         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1104         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1105         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1106         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1107         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1108         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1109         88  THREE-CHARACTER-BIN                                  ELCDATE
  1110                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1111         88  GREGORIAN-TO-BIN                                        CL**2
  1112                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1113         88  BIN-TO-GREGORIAN                                        CL**2
  1114                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1115         88  JULIAN-TO-BINARY                                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1116                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1117     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1118         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1119         88  DATE-CONVERSION-ERROR                                ELCDATE
  1120                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1121         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1122         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1123         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1124         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1125         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1126         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1127         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1128         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1129         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1130         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1131     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1132         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1133     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1134         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1135         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1136         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1137     12  FILLER                        PIC X.                        CL*15
  1138     12  DC-CONVERSION-DATES.                                        CL*15
  1139         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1140         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1141         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1142         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1143                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1144             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1145             20  SLASH1-1              PIC X.                        CL*15
  1146             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1147             20  SLASH1-2              PIC X.                        CL*15
  1148             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1149         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1150         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1151                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1152             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1153             20  SLASH2-1              PIC X.                        CL*15
  1154             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1155             20  SLASH2-2              PIC X.                        CL*15
  1156             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1157         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1158         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1159                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1160             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1161             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1162             20  DC-YMD-DAY            PIC 99.                       CL*15
  1163         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1164         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1165                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1166             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1167             20  DC-MDY-DAY            PIC 99.                       CL*15
  1168             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1169         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1170             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1171             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1172             20  FILLER                PIC XX.                       CL*15
  1173             20  DC-ALPHA-CENTURY.                                   CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1174                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1175             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1176         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1177         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1178         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1179         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1180         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1181                                       PIC 9(05).                    CL*20
  1182         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1183             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1184             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1185         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1186         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1187         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1188     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1189         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1190         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1191             20  FILLER                PIC 9(3).                     CL*15
  1192             20  HOLD-CEN-1-CCYY.                                    CL*15
  1193                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1194                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1195             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1196             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1197         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1198             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1199             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1200             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1201                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1202                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1203             20  FILLER                PIC 9(3).                     CL*15
  1204         16  HOLD-CENTURY-1-X.                                       CL*15
  1205             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1206             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1207                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1208                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1209             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1210             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1211         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1212             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1213             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1214             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1215                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1216                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1217             20  FILLER                PIC XXX.                      CL*23
  1218         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1219         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1220         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1221         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1222             20  DC-JULIAN-1-CCYY.                                   CL*15
  1223                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1224                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1225             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1226         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1227         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1228             20  DC-JULIAN-2-CCYY.                                   CL*15
  1229                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1230                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1231             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1233             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1234             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1235             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1236             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1237             20  DC-EDITA-CCYY.                                      CL*15
  1238                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1239                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1240         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1241             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1242             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1243             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1244             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1245             20  DC-EDITB-CCYY.                                      CL*15
  1246                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1247                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1248         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1249         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1250                              DC-GREG-DATE-CYMD.                  ELCDATE
  1251             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1252             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1253             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1254             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1255         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1256         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1257                              DC-GREG-DATE-MDCY.                  ELCDATE
  1258             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1259             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1260             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1261             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1262    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1263        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1264    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1265    12  FILLER                         PIC X(28).                    CL*26
* 1266                                 COPY ELCDTECX.
  1267******************************************************************06/05/98
  1268*                                                                *ELCDTECX
  1269*                            ELCDTECX.                           *   LV005
  1270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1271*                            VMOD=2.015                          *ELCDTECX
  1272*                                                                *ELCDTECX
  1273*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1274*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1275*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1276*                                                                *ELCDTECX
  1277******************************************************************ELCDTECX
  1278******************************************************************
  1279*                   C H A N G E   L O G
  1280*
  1281* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1282*-----------------------------------------------------------------
  1283*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1284* EFFECTIVE    NUMBER
  1285*-----------------------------------------------------------------
  1286* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1287*                                  BENEFIT CODES FROM 300 TO 900
  1288* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1289* 051304    2003080800002  SMVA  ADD REFUND METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1290* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1291******************************************************************
  1292 01  DATE-CARD.                                                   ELCDTECX
  1293     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1294     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1295     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1296     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1297     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1298     12  EP-SW                       PIC  X.                      ELCDTECX
  1299         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1300     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1301         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1302     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1303     12  RUN-CENTURY.                                             ELCDTECX
  1304         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1305     12  FILLER                      PIC  X.                         CL**4
  1306     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1307     12  FILLER                      PIC  XXX.                    ELCDTECX
  1308     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1309                                                                  ELCDTECX
  1310 01  FILLER                          PIC  X(7)                       CL**6
  1311                                          VALUE 'OPTIONS'.        ELCDTECX
  1312 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1313     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1314     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1315     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1316         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1317         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1318     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1319     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1320     12  FILLER                      PIC  X.                      ELCDTECX
  1321     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1322     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1323     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1324     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1325     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1326     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1327     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1328     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1329     12  FILLER                      PIC  X.                      ELCDTECX
  1330     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1331     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1332     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1333     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1334     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1335     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1336     12  FILLER                      PIC  X.                      ELCDTECX
  1337     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1338     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1339     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1340     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1341     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1342     12  DTE-R78                     PIC  X.                      ELCDTECX
  1343     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1344     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1345     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1346     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1347     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1349     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1350                                     PIC  X.                      ELCDTECX
  1351         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1352                                                 ' '.             ELCDTECX
  1353         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1354         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1355     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1356         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1357         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1358     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1359     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1360                                     PIC  9.                         CL**4
  1361     12  DTE-SYSTEM.                                              ELCDTECX
  1362         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1363         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1364         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1365         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1366         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1367         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1368         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1369         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1370         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1371         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1372         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1373         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1374         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1375         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1376         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1377         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1378         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1379         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1380         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1381         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1382         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1383         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1384         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1385         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1386         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1387         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1388     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1389         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1390                                     PIC  X.                      ELCDTECX
  1391     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1392                                                                  ELCDTECX
  1393 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1394     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1395     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1396     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1397*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1398     12  FILLER                      PIC  X.                      ELCDTECX
  1399     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1400     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1401     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1402     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1403     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1404     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1405     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406                                                                  ELCDTECX
  1407     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1408     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1409     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1410     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1411                                                                  ELCDTECX
  1412     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1413     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1414     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1415     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1416                                                                  ELCDTECX
  1417     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1418     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1419                                                                  ELCDTECX
  1420     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1421     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1422                                                                  ELCDTECX
  1423     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1424                                                                  ELCDTECX
  1425 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1426     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1427     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1428     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1429     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1430     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1431     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1432     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1433                                                                  ELCDTECX
  1434 01  FILLER                          PIC  X(12)                   ELCDTECX
  1435                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1436 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1437     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1438         16  CNT-ID                  PIC  X.                      ELCDTECX
  1439         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1440                                                                  ELCDTECX
  1441 01  FILLER                          PIC  X(11)                   ELCDTECX
  1442                                          VALUE 'STATE NAMES'.    ELCDTECX
  1443 01  STATE-NAMES.                                                 ELCDTECX
  1444     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1445         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1446         16  STATE-PIC1.                                          ELCDTECX
  1447             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1448             20  FILLER              PIC  XXX.                    ELCDTECX
  1449             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1450             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1451             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1452             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1453                                                                  ELCDTECX
  1454 01  FILLER                          PIC  X(13)                   ELCDTECX
  1455                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1456 01  CARRIER-NAMES.                                               ELCDTECX
  1457     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1458         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1459         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1460         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1461         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1462         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1463         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464*        16  FILLER                  PIC  X.                      ELCDTECX
  1465         16  CARRIER-SEC-PAY         PIC  X.
  1466             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1467                                                                  ELCDTECX
  1468 01  FILLER                          PIC  X(9)                       CL**6
  1469                                          VALUE 'INS TYPES'.      ELCDTECX
  1470 01  CLAS-INS-TYPES.                                              ELCDTECX
  1471*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1472     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1473         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1474         16  CLAS-I-AB3.                                          ELCDTECX
  1475             20  FILLER              PIC  X.                      ELCDTECX
  1476             20  CLAS-I-AB2.                                      ELCDTECX
  1477                 24  FILLER          PIC  X.                      ELCDTECX
  1478                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1479         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1480             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1481             20  FILLER              PIC  X.                         CL**4
  1482         16  CLAS-I-AB10.                                         ELCDTECX
  1483             20  FILLER              PIC  X(9).                   ELCDTECX
  1484             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1485         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1486         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1487         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1488         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1489             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1490         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1491         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1492         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1493         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1494         16  CLAS-I-REFUND-METHOD    PIC  X.
  1495         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1496         16  FILLER                  PIC  XXX.
  1497                                                                  ELCDTECX
  1498 01  FILLER                          PIC  X(16)                   ELCDTECX
  1499                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1500 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1501     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1502                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1503         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1504         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1505         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1506         16  CLAS-MORT-DESC.                                      ELCDTECX
  1507             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1508             20  FILLER              PIC  XX.                        CL**5
  1509             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1510             20  FILLER              PIC  X.                         CL**5
  1511             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1512             20  FILLER              PIC  X.                         CL**5
  1513             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1514             20  FILLER              PIC  X.                         CL**5
  1515             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1516             20  FILLER              PIC  X(5).                      CL**6
  1517                                                                  ELCDTECX
  1518 01  FILLER                          PIC  X(15)                   ELCDTECX
  1519                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1520 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1521     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1522         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1523         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1524         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1525         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1526         16  FILLER                  PIC  X(4).                      CL**6
  1527                                                                  ELCDTECX
  1528 01  FILLER                          PIC  X(7)                       CL**6
  1529                                     VALUE 'INDEXES'.             ELCDTECX
  1530 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1531     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1532     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1533     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1534     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1535     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1536     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1537     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1538     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1539     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1540     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1541     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1542     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1543     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1544     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1545     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1546     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1547     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1548                                                                  ELCDTECX
  1549 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1550     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1551     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1552     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1553     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1554     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1555     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1556     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1557     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1558     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1559     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1560     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1561                                                                  ELCDTECX
  1562 01  FILLER                          PIC  X(13)                   ELCDTECX
  1563                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1564 01  CLAS-MISC.                                                   ELCDTECX
  1565     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1566         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1567         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1568         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1569     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1570     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1571     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1572     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1573     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1574     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1575     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1576     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1577     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1578     12  STATE-L                     PIC  XX.                     ELCDTECX
  1579     12  CLAS-CN                     PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1580     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1581     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1582         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1583         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1584     12  DTE-ABEND-WORK.                                          ELCDTECX
  1585         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1586         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1587                                                                  ELCDTECX
  1588 01  FILLER                          PIC  X(12)                   ELCDTECX
  1589                                     VALUE 'WORKING DATE'.        ELCDTECX
  1590 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1591     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1592         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1593         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1594         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1595     12  WS-CURRENT-DATE.                                         ELCDTECX
  1596         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1597         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1598         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1599         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1600         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1601     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1602         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1603         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1604                                                                  ELCDTECX
  1605 01  FILLER                          PIC  X(12)                   ELCDTECX
  1606                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1607 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1608     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1609         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1610         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1611         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1612                                                                  ELCDTECX
  1613 01  FILLER                          PIC  X(10)                   ELCDTECX
  1614                                     VALUE 'STATE TLRS'.          ELCDTECX
  1615 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1616     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1617         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1618         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1619                                                                  ELCDTECX
  1620 01  FILLER                          PIC  X(13)                   ELCDTECX
  1621                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1622 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1623     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1624         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1625                                                                  ELCDTECX
  1626 01  FILLER                          PIC  X(13)                   ELCDTECX
  1627                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1628 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1629     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1630     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1631     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1632                                     PIC  X.                         CL**5
  1633     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1634     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1635     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1636     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1637     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1638     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1639     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1640     12  FILLER                      PIC  X(75).                  ELCDTECX
  1641******************************************************************ELCDTECX
  1642*01  MISC-CARR-PCT-DATA.                                          00001521
  1643*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1644*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1645*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1646*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1647*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1648*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1649******************************************************************ELCDTECX
* 1650                                 COPY ELCDTEVR.
  1651***************************************************************** 04/15/98
  1652*                                                                *ELCDTEVR
  1653*                                                                *ELCDTEVR
  1654*                            ELCDTEVR.                           *   LV003
  1655*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1656*                            VMOD=2.001                          *   CL**2
  1657*                                                                *ELCDTEVR
  1658*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1659*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1660*                                                                *ELCDTEVR
  1661******************************************************************ELCDTEVR
  1662 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1663     05  WS-RUN-DATE.                                             ELCDTEVR
  1664         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1665         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1666         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1667             15  RUN-CC              PIC  99.                     ELCDTEVR
  1668             15  RUN-YR              PIC  99.                     ELCDTEVR
  1669         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1670         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1671     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1672            WS-RUN-DATE              PIC 9(11).                      CL**2
  1673     05  WS-EP-DT.                                                ELCDTEVR
  1674         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1675         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1676         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1677             15  EP-CC               PIC  99.                     ELCDTEVR
  1678             15  EP-YR               PIC  99.                     ELCDTEVR
  1679         10  EP-MO                   PIC  99.                     ELCDTEVR
  1680         10  EP-DA                   PIC  99.                     ELCDTEVR
  1681     05  WS-EP-DT-N REDEFINES                                        CL**2
  1682            WS-EP-DT                 PIC 9(11).                      CL**2
  1683     05  WS-DTE-CONV-DT.                                             CL**4
  1684         10  FILLER                  PIC  9(03).                     CL**4
  1685         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1686         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1687             15  DTE-CONV-CC         PIC  99.                        CL**4
  1688             15  DTE-CONV-YR         PIC  99.                        CL**4
  1689         10  DTE-CONV-MO             PIC  99.                        CL**4
  1690         10  DTE-CONV-DA             PIC  99.                        CL**4
  1691     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1692            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1693 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1694     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1695         10  FILLER                            PIC 999.           ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1696         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1697         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1698             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1699             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1700         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1701         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1702     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1703            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1704     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1705         10  FILLER                            PIC 999.           ELCDTEVR
  1706         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1707         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1708         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1709         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1710     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1711            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1712 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1713     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1714         10  FILLER                            PIC 999.           ELCDTEVR
  1715         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1716         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1717             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1718             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1719         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1720         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1721     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1722            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1723     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1724         10  FILLER                            PIC 999.           ELCDTEVR
  1725         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1726         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1727             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1728             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1729         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1730         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1731     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1732            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1733     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1734         10  FILLER                            PIC 999.           ELCDTEVR
  1735         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1736         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1737             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1738             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1739         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1740         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1741     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1742            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1743 01  WS-RATE-RECORD.                                              ELCDTEVR
  1744         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1745             10  FILLER                        PIC 999.           ELCDTEVR
  1746             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1747             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1748                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1749                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1750             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1751             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1752         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1753                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* CIFPB511.cbl
  1754                                                                  00133669
  1755******************************************************************00133673
  1756 PROCEDURE DIVISION.
  1757
* 1758                                 COPY ELCDTERX.
  1759******************************************************************04/15/98
  1760*                                                                *ELCDTERX
  1761*                                                                *ELCDTERX
  1762*                            ELCDTERX.                           *   LV002
  1763*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1764*                            VMOD=2.007                          *ELCDTERX
  1765*                                                                *ELCDTERX
  1766*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1767*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1768*      = ELCDTEFD)                                               *ELCDTERX
  1769*                                                                *ELCDTERX
  1770******************************************************************ELCDTERX
  1771                                                                  ELCDTERX
  1772     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1773                                                                  ELCDTERX
  1774     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1775     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1776     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1777                                                                  ELCDTERX
  1778     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1779                                                                  ELCDTERX
  1780******************************************************************ELCDTERX
  1781*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1782*          WARNING MESSAGES.                                      ELCDTERX
  1783******************************************************************ELCDTERX
  1784     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1785         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1786                                                                  ELCDTERX
  1787     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1788                                                                  ELCDTERX
  1789     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1790                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1791                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1792                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1793                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1794                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1795                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1796                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1797                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1798                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1799                                                                  ELCDTERX
  1800     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1801                                                                  ELCDTERX
  1802     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1803                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1804                                                                  ELCDTERX
  1805     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1806     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1807     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1808     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1809                                                                  ELCDTERX
  1810     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1811         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1812     ELSE                                                         ELCDTERX
  1813         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1814                                                                  ELCDTERX
  1815     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1816         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1817     ELSE                                                         ELCDTERX
  1818         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1819                                                                  ELCDTERX
  1820 0005-READ--CARD.                                                 ELCDTERX
  1821     READ DISK-DATE                                               ELCDTERX
  1822         AT END CLOSE DISK-DATE                                   ELCDTERX
  1823             GO TO 0060-READ--TEST.                               ELCDTERX
  1824                                                                  ELCDTERX
  1825     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1826                                                                  ELCDTERX
  1827     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1828         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1829         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1830         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1831         GO TO 0005-READ--CARD.                                   ELCDTERX
  1832                                                                  ELCDTERX
  1833     IF DD-ID = 'CLAD'                                            ELCDTERX
  1834         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1835         GO TO 0005-READ--CARD.                                   ELCDTERX
  1836                                                                  ELCDTERX
  1837     IF DD-ID = 'CLAX'                                            ELCDTERX
  1838         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1839         GO TO 0005-READ--CARD.                                   ELCDTERX
  1840                                                                  ELCDTERX
  1841     IF DD-ID = 'CLAF'                                            ELCDTERX
  1842         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1843         GO TO 0005-READ--CARD.                                   ELCDTERX
  1844                                                                  ELCDTERX
  1845     IF DD-ID = 'CLAC'                                            ELCDTERX
  1846         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1847                                                                  ELCDTERX
  1848     IF DD-ID = 'CARR'                                            ELCDTERX
  1849         GO TO 0015-READ--CARR.                                   ELCDTERX
  1850                                                                  ELCDTERX
  1851     IF DD-ID = 'STAT'                                            ELCDTERX
  1852         GO TO 0020-READ--STAT.                                   ELCDTERX
  1853                                                                  ELCDTERX
  1854     IF DD-ID = 'BUSC'                                            ELCDTERX
  1855         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1856                                                                  ELCDTERX
  1857     IF DD-ID = 'MORT'                                            ELCDTERX
  1858         GO TO 0030-READ--MORT.                                   ELCDTERX
  1859                                                                  ELCDTERX
  1860     IF DD-ID = 'CLAI'                                            ELCDTERX
  1861         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1862                                                                  ELCDTERX
  1863     IF DD-ID = 'COLC'                                            ELCDTERX
  1864         GO TO 0065-READ--COLC.                                   ELCDTERX
  1865                                                                  ELCDTERX
  1866     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1867        DD-IDA = 'CL'                                             ELCDTERX
  1868         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1869                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1870     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1871        DD-IDA = 'PO'                                             ELCDTERX
  1872         GO TO 0050-READ--POXX.                                   ELCDTERX
  1873                                                                  ELCDTERX
  1874     IF DD-ID = 'OPCA'                                            ELCDTERX
  1875         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1876                                                                  ELCDTERX
  1877     IF DD-ID = 'OPST'                                            ELCDTERX
  1878         GO TO 0072-READ--OPST.                                   ELCDTERX
  1879                                                                  ELCDTERX
  1880     IF DD-ID = 'OPBS'                                            ELCDTERX
  1881         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1882                                                                  ELCDTERX
  1883     IF DD-ID = 'OPMS'                                            ELCDTERX
  1884         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1885                                                                  ELCDTERX
  1886     GO TO 0005-READ--CARD.                                       ELCDTERX
  1887                                                                  ELCDTERX
  1888 0010-READ--CLAC.                                                 ELCDTERX
  1889     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1890     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1891     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1892     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1893     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1894     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1895     GO TO 0005-READ--CARD.                                       ELCDTERX
  1896                                                                  ELCDTERX
  1897 0015-READ--CARR.                                                 ELCDTERX
  1898     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1899     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1900        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1901        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1902        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1903        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1904        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1905        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1906        MOVE DD-CARR1-SECPAY-SW
  1907                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1908     END-IF
  1909                                                                  ELCDTERX
  1910     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1911     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1912        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1913        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1914        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1915        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1916        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1917        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1918        MOVE DD-CARR2-SECPAY-SW
  1919                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1920     END-IF
  1921                                                                  ELCDTERX
  1922                                                                  ELCDTERX
  1923     GO TO 0005-READ--CARD.                                       ELCDTERX
  1924                                                                  ELCDTERX
  1925 0020-READ--STAT.                                                 ELCDTERX
  1926     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1927     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1928        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1929         GO TO 0005-READ--CARD.                                   ELCDTERX
  1930                                                                  ELCDTERX
  1931     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1932     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1933     GO TO 0020-READ--STAT.                                       ELCDTERX
  1934                                                                  ELCDTERX
  1935 0025-READ--BUSC.                                                 ELCDTERX
  1936     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1937     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1938        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1939         GO TO 0005-READ--CARD.                                   ELCDTERX
  1940                                                                  ELCDTERX
  1941     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1942     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1943     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1944                                                                  ELCDTERX
  1945 0030-READ--MORT.                                                 ELCDTERX
  1946     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1947     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1948        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1949         GO TO 0005-READ--CARD.                                   ELCDTERX
  1950                                                                  ELCDTERX
  1951     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1952     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1953     GO TO 0030-READ--MORT.                                       ELCDTERX
  1954                                                                  ELCDTERX
  1955 0035-READ--CLXX.                                                 ELCDTERX
  1956     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1957          GO TO 0005-READ--CARD.                                  ELCDTERX
  1958                                                                  ELCDTERX
  1959     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1960         DISPLAY '***********************************************'ELCDTERX
  1961         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1962         DISPLAY '***********************************************'ELCDTERX
  1963         GO TO 0055-READ--STOP.                                   ELCDTERX
  1964                                                                  ELCDTERX
  1965     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1966        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1967         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1968                                                                  ELCDTERX
  1969     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1970        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1971         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1972                                                                  ELCDTERX
  1973*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1974     GO TO 0005-READ--CARD.                                       ELCDTERX
  1975                                                                  ELCDTERX
  1976 0040-READ--CLAI.                                                 ELCDTERX
  1977     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1978     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1979        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1980         GO TO 0005-READ--CARD.                                   ELCDTERX
  1981                                                                  ELCDTERX
  1982     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1983     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1984     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1985                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1986 0045-READ--DUMP.                                                 ELCDTERX
  1987     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1988     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1989                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1990     PERFORM ABEND-PGM.                                           ELCDTERX
  1991                                                                  ELCDTERX
  1992 0050-READ--POXX.                                                 ELCDTERX
  1993     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1994         GO TO 0005-READ--CARD.                                   ELCDTERX
  1995                                                                  ELCDTERX
  1996     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1997         DISPLAY '***********************************************'ELCDTERX
  1998         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1999         DISPLAY '***********************************************'ELCDTERX
  2000         GO TO 0055-READ--STOP.                                   ELCDTERX
  2001                                                                  ELCDTERX
  2002     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2003     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2004     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2005     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2006                                                                  ELCDTERX
  2007     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2008         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2009     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2010         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2011                                                                  ELCDTERX
  2012     GO TO 0005-READ--CARD.                                       ELCDTERX
  2013                                                                  ELCDTERX
  2014 0055-READ--STOP.                                                 ELCDTERX
  2015     GOBACK.                                                      ELCDTERX
  2016                                                                  ELCDTERX
  2017 0060-READ--TEST.                                                 ELCDTERX
  2018     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2019        CLAX-ID         = SPACE  OR                               ELCDTERX
  2020        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2021         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2024     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2025                                                                  ELCDTERX
  2026 0065-READ--COLC.                                                 ELCDTERX
  2027     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2028     GO TO 0005-READ--CARD.                                       ELCDTERX
  2029                                                                  ELCDTERX
  2030 0070-READ--OPCA.                                                 ELCDTERX
  2031                                                                  ELCDTERX
  2032     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2033                                                                  ELCDTERX
  2034     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2035             OR                                                   ELCDTERX
  2036         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2037         GO TO 0005-READ--CARD.                                   ELCDTERX
  2038                                                                  ELCDTERX
  2039     ADD 1                       TO INDEXCA.                      ELCDTERX
  2040     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2041                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2042     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2043                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2044 0072-READ--OPST.                                                 ELCDTERX
  2045                                                                  ELCDTERX
  2046     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2047                                                                  ELCDTERX
  2048     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2049             OR                                                   ELCDTERX
  2050         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2051         GO TO 0005-READ--CARD.                                   ELCDTERX
  2052                                                                  ELCDTERX
  2053     ADD 1                       TO INDEXST.                      ELCDTERX
  2054     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2055                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2056     GO TO 0072-READ--OPST.                                       ELCDTERX
  2057                                                                  ELCDTERX
  2058 0074-READ--OPBS.                                                 ELCDTERX
  2059                                                                  ELCDTERX
  2060     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2061                                                                  ELCDTERX
  2062     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2063             OR                                                   ELCDTERX
  2064         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2065         GO TO 0005-READ--CARD.                                   ELCDTERX
  2066                                                                  ELCDTERX
  2067     ADD 1                       TO INDEXBS.                      ELCDTERX
  2068     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2069     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2070                                                                  ELCDTERX
  2071 0079-READ--EXIT.                                                 ELCDTERX
  2072*    EXIT.                                                        ELCDTERX
  2073******************************************************************ELCDTERX
  2074
  2075     OPEN INPUT FPB-IN
  2076
  2077     ACCEPT WORK-DATE-IN         FROM DATE
  2078     DISPLAY ' WORK DATE IN ' WORK-DATE-IN
  2079
  2080     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'
  2081     DISPLAY '*   CURRENT DATE IS -- ' WS-CURRENT-DATE
  2082     MOVE RUN-DATE               TO W-DISPLAY-DATE
  2083     DISPLAY ' RUN DATE IS ' W-DISPLAY-DATE
  2084     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'
  2085
  2086     SORT SORT-FILE
  2087         ON ASCENDING KEY SR-CONTROL SR-CERT-NO SR-REC-TYPE
  2088             INPUT PROCEDURE  0000-SORT-INPUT-PROCEDURE
  2089             OUTPUT PROCEDURE 0001-SORT-OUTPUT-PROCEDURE.
  2090
  2091     PERFORM 0015-FINALIZE       THRU 0015-EXIT
  2092
  2093     DISPLAY ' RECORDS INPUT      ' RECS-IN
  2094     DISPLAY ' RECORDS RELEASED   ' RECS-REL
  2095     DISPLAY ' RECORDS RETURNED   ' RECS-RET
  2096
  2097     GOBACK
  2098
  2099     .
  2100 0000-SORT-INPUT-PROCEDURE SECTION.
  2101
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* CIFPB511.cbl
  2102     PERFORM 0040-READ-FPB       THRU 0040-EXIT
  2103
  2104     PERFORM 0030-PROCESS-FPB    THRU 0030-EXIT UNTIL
  2105        END-OF-FPB
  2106
  2107     PERFORM 0045-WRITE-PENDING-RECS
  2108                                 THRU 0045-EXIT
  2109
  2110     .
  2111 0001-SORT-OUTPUT-PROCEDURE SECTION.
  2112
  2113     OPEN OUTPUT FPB-OUT
  2114     PERFORM 0025-RETURN-FPB     THRU 0025-EXIT
  2115     MOVE ' ' TO WS-EOF-SW
  2116     MOVE SR-CONTROL             TO WS-PREV-SR-ACCOUNT
  2117     PERFORM 0020-PROCESS        THRU 0020-EXIT UNTIL
  2118        END-OF-FPB
  2119
  2120     .
  2121 0015-FINALIZE SECTION.
  2122
  2123     PERFORM 0160-ACCOUNT-BREAK  THRU 0160-EXIT
  2124     CLOSE FPB-IN FPB-OUT
  2125
  2126     .
  2127 0015-EXIT.
  2128     EXIT.
  2129
  2130 0020-PROCESS.
  2131
  2132     IF SR-CONTROL NOT = WS-PREV-SR-ACCOUNT
  2133        PERFORM 0160-ACCOUNT-BREAK THRU 0160-EXIT
  2134        MOVE SR-CONTROL          TO WS-PREV-SR-ACCOUNT
  2135     END-IF
  2136     EVALUATE TRUE
  2137        WHEN SR-REC-TYPE = '21'
  2138           ADD +1 TO FP-CERT-ISS
  2139        WHEN SR-REC-TYPE = '23'
  2140           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2141           COMPUTE FP-LF-WRITTEN = FP-LF-WRITTEN +
  2142              PBI-I-LF-PREM-AMT + PBI-I-LF-ALT-PREM-AMT
  2143        WHEN SR-REC-TYPE = '24'
  2144           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2145           COMPUTE FP-AH-WRITTEN = FP-AH-WRITTEN +
  2146              PBI-I-AH-PREM-AMT
  2147        WHEN SR-REC-TYPE = '31'
  2148           ADD +1 TO FP-CERT-CANC
  2149           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2150           COMPUTE FP-LF-CANC = FP-LF-CANC +
  2151              PBI-C-LF-PREM-REFUND
  2152           COMPUTE FP-AH-CANC = FP-AH-CANC +
  2153              PBI-C-AH-PREM-REFUND
  2154     END-EVALUATE
  2155
  2156     WRITE CARD-RECORD           FROM SORT-RECORD
  2157
  2158     PERFORM 0025-RETURN-FPB     THRU 0025-EXIT
  2159
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* CIFPB511.cbl
  2160     .
  2161 0020-EXIT.
  2162     EXIT.
  2163
  2164 0025-RETURN-FPB.
  2165
  2166     RETURN SORT-FILE AT END
  2167          SET END-OF-FPB         TO TRUE
  2168     END-RETURN
  2169
  2170     IF NOT END-OF-FPB
  2171        ADD 1                    TO RECS-RET
  2172     END-IF
  2173
  2174     .
  2175 0025-EXIT.
  2176     EXIT.
  2177
  2178 0030-PROCESS-FPB.
  2179
  2180     IF NOT FPB-VALID-REC-7
  2181        CONTINUE
  2182     ELSE
  2183        IF FPB-ACCT-NO NOT = WS-SAVE-ACCT-NO
  2184           PERFORM 0045-WRITE-PENDING-RECS
  2185                                 THRU 0045-EXIT
  2186           MOVE FPB-IN-RECORD    TO FIRST-PREMIER-INPUT
  2187           MOVE FPB-ACCT-NO      TO WS-SAVE-ACCT-NO
  2188           PERFORM 0070-BUILD-COMMON
  2189                                 THRU 0070-EXIT
  2190        END-IF
  2191        MOVE FPB-IN-RECORD       TO FIRST-PREMIER-INPUT
  2192        IF FP7-CANC-DATE NOT = SPACES
  2193           PERFORM 0060-PROCESS-CANCELS
  2194                                 THRU 0060-EXIT
  2195        ELSE
  2196           PERFORM 0055-PROCESS-ISSUES
  2197                                 THRU 0055-EXIT
  2198        END-IF
  2199     END-IF
  2200
  2201     PERFORM 0040-READ-FPB       THRU 0040-EXIT
  2202
  2203     .
  2204 0030-EXIT.
  2205     EXIT.
  2206
  2207 0040-READ-FPB.
  2208
  2209     READ FPB-IN AT END
  2210          SET END-OF-FPB         TO TRUE
  2211     END-READ
  2212
  2213     IF NOT END-OF-FPB
  2214        ADD 1                    TO RECS-IN
  2215     END-IF
  2216
  2217     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* CIFPB511.cbl
  2218 0040-EXIT.
  2219     EXIT.
  2220
  2221 0045-WRITE-PENDING-RECS.
  2222
  2223     IF (WS-LF-PREM > ZEROS)
  2224        OR (WS-AH-PREM > ZEROS)
  2225        PERFORM 0050-BUILD-ISSUE-REC
  2226                                 THRU 0050-EXIT
  2227     ELSE
  2228        IF (WS-LF-REF > ZEROS)
  2229           OR (WS-AH-REF > ZEROS)
  2230           PERFORM 0065-BUILD-CANCEL-REC
  2231                                 THRU 0065-EXIT
  2232        END-IF
  2233     END-IF
  2234
  2235     .
  2236 0045-EXIT.
  2237     EXIT.
  2238
  2239
  2240 0050-BUILD-ISSUE-REC.
  2241
  2242*    IF (WS-LF-PREM = ZEROS)
  2243*       AND (WS-AH-PREM > ZEROS)
  2244*       DISPLAY ' FOUND A&H ONLY USING 1107201 '
  2245*       MOVE '0001107201'        TO OUT-ACCOUNT-NO
  2246*    ELSE
  2247*       MOVE '0001107200'        TO OUT-ACCOUNT-NO
  2248*    END-IF
  2249     move '0001107200'           to out-account-no
  2250     if found-ah-only
  2251        move '0001107201'        to out-account-no
  2252        DISPLAY ' FOUND A&H ONLY USING 1107201 ' save-cert
  2253     end-if
  2254     PERFORM 0080-BUILD-SEQ-1    THRU 0080-EXIT
  2255     PERFORM 0090-BUILD-SEQ-2    THRU 0090-EXIT
  2256     PERFORM 0100-BUILD-SEQ-3    THRU 0100-EXIT
  2257     PERFORM 0110-BUILD-SEQ-4    THRU 0110-EXIT
  2258     PERFORM 0120-BUILD-SEQ-5    THRU 0120-EXIT
  2259     PERFORM 0122-BUILD-SEQ-6    THRU 0122-EXIT
  2260     PERFORM 0125-BUILD-SEQ-7    THRU 0125-EXIT
  2261     PERFORM 0127-BUILD-SEQ-8    THRU 0127-EXIT
  2262
  2263     .
  2264 0050-EXIT.
  2265     EXIT.
  2266
  2267 0055-PROCESS-ISSUES.
  2268
  2269     DISPLAY ' FOUND ISSUE '
  2270     IF FP7-INS-TABLE NOT NUMERIC
  2271        MOVE ZEROS               TO FP7-INS-TABLE
  2272     END-IF
  2273
  2274     IF FP7-BALLOON-AMT NOT NUMERIC
  2275        MOVE ZEROS               TO FP7-BALLOON-AMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* CIFPB511.cbl
  2276     END-IF
  2277
  2278     IF FP7-PREMIUM NOT NUMERIC
  2279        MOVE ZEROS               TO FP7-PREMIUM
  2280     END-IF
  2281
  2282     EVALUATE TRUE
  2283        WHEN FP7-INS-TABLE = 51
  2284           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2285           MOVE '22'             TO WS-LF-BENEFIT-CD
  2286        WHEN FP7-INS-TABLE = 52
  2287           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2288           MOVE '23'             TO WS-LF-BENEFIT-CD
  2289        WHEN (FP7-INS-TABLE = 53)
  2290             AND (WS-LF-PREM NOT = ZEROS)
  2291           MOVE FP7-PREMIUM      TO WS-LF-PREM-ALT
  2292           MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2293           MOVE '62'             TO WS-LF-BENEFIT-CD
  2294        WHEN (FP7-INS-TABLE = 54)
  2295             AND (WS-LF-PREM NOT = ZEROS)
  2296           MOVE FP7-PREMIUM      TO WS-LF-PREM-ALT
  2297           MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2298           MOVE '63'             TO WS-LF-BENEFIT-CD
  2299        WHEN (FP7-INS-TABLE = 53)
  2300             AND (WS-LF-PREM = ZEROS)
  2301           DISPLAY ' FOUND PURE LEVEL ' FP7-ACCOUNT-NUMBER
  2302           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2303*          MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2304           MOVE '24'             TO WS-LF-BENEFIT-CD
  2305        WHEN (FP7-INS-TABLE = 54)
  2306             AND (WS-LF-PREM = ZEROS)
  2307           DISPLAY ' FOUND PURE LEVEL ' FP7-ACCOUNT-NUMBER
  2308           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2309*          MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2310           MOVE '25'             TO WS-LF-BENEFIT-CD
  2311        WHEN FP7-INS-TABLE = 55
  2312           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2313           MOVE '03'             TO WS-AH-BENEFIT-CD
  2314        WHEN FP7-INS-TABLE = 57
  2315           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2316           MOVE '03'             TO WS-AH-BENEFIT-CD
  2317           set found-ah-only to true
  2318        WHEN FP7-INS-TABLE = 56
  2319           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2320           MOVE '53'             TO WS-AH-BENEFIT-CD
  2321        WHEN FP7-INS-TABLE = 58
  2322           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2323           MOVE '53'             TO WS-AH-BENEFIT-CD
  2324           set found-ah-only to true
  2325        WHEN OTHER
  2326           DISPLAY ' INVALID OR UNKNOWN INS TABLE '
  2327              FP7-INS-TABLE
  2328           PERFORM ABEND-PGM
  2329     END-EVALUATE
  2330
  2331     .
  2332 0055-EXIT.
  2333     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* CIFPB511.cbl
  2334
  2335 0060-PROCESS-CANCELS.
  2336
  2337     IF FP7-INS-TABLE NOT NUMERIC
  2338        MOVE ZEROS               TO FP7-INS-TABLE
  2339     END-IF
  2340
  2341     MOVE FP7-CANC-DATE (7:4)    TO WS-WORK-DATE (1:4)
  2342     MOVE FP7-CANC-DATE (1:2)    TO WS-WORK-DATE (5:2)
  2343     MOVE FP7-CANC-DATE (4:2)    TO WS-WORK-DATE (7:2)
  2344     IF WS-WORK-DATE-N NOT = ZEROS
  2345        MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2346        MOVE 'L'                    TO DC-OPTION-CODE
  2347        PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2348        IF NO-CONVERSION-ERROR
  2349           CONTINUE
  2350*          MOVE DC-GREG-DATE-1-MDY  TO WS-REF-DATE
  2351        ELSE
  2352           DISPLAY ' BAD REFUND DATE ' FP7-CANC-DATE
  2353           ' CERT = ' FP7-ACCOUNT-NUMBER
  2354        END-IF
  2355     END-IF
  2356
  2357     EVALUATE TRUE
  2358        WHEN FP7-INS-TABLE = 51 OR 52 OR 53 OR 54
  2359           COMPUTE WS-LF-REF = WS-LF-REF + FP7-CANC-AMT
  2360           MOVE DC-GREG-DATE-1-MDY
  2361                                 TO WS-LF-REF-DATE
  2362        WHEN FP7-INS-TABLE = 55 OR 56
  2363           MOVE FP7-CANC-AMT     TO WS-AH-REF
  2364           MOVE DC-GREG-DATE-1-MDY
  2365                                 TO WS-AH-REF-DATE
  2366        WHEN FP7-INS-TABLE = 57 or 58
  2367           set found-ah-only to true
  2368           MOVE FP7-CANC-AMT     TO WS-AH-REF
  2369           MOVE DC-GREG-DATE-1-MDY
  2370                                 TO WS-AH-REF-DATE
  2371        WHEN OTHER
  2372           DISPLAY ' INVALID OR UNKNOWN INS TABLE '
  2373              FP7-INS-TABLE
  2374           PERFORM ABEND-PGM
  2375     END-EVALUATE
  2376
  2377     .
  2378 0060-EXIT.
  2379     EXIT.
  2380
  2381 0065-BUILD-CANCEL-REC.
  2382
  2383     move '0001107200'           to out-account-no
  2384     if found-ah-only
  2385        move '0001107201'        to out-account-no
  2386        DISPLAY ' FOUND A&H ONLY CAN USING 1107201 ' save-cert
  2387     end-if
  2388     PERFORM 0130-BUILD-CANCEL   THRU 0130-EXIT
  2389
  2390     .
  2391 0065-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* CIFPB511.cbl
  2392     EXIT.
  2393
  2394 0070-BUILD-COMMON.
  2395
  2396*    DISPLAY FIRST-PREMIER-INPUT
  2397     MOVE ' '                    TO WS-ISS-SW
  2398                                    WS-CAN-SW
  2399
  2400     MOVE ZEROS                  TO WS-BIRTH-DT
  2401                                    WS-1ST-PMT-DT
  2402
  2403*    DISPLAY ' NOTE DATE ' FP7-NOTE-DATE
  2404     MOVE FP7-NOTE-DATE (7:4)    TO WS-WORK-DATE (1:4)
  2405     MOVE FP7-NOTE-DATE (1:2)    TO WS-WORK-DATE (5:2)
  2406     MOVE FP7-NOTE-DATE (4:2)    TO WS-WORK-DATE (7:2)
  2407     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2408     MOVE 'L'                    TO DC-OPTION-CODE
  2409     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2410     IF NO-CONVERSION-ERROR
  2411        MOVE DC-BIN-DATE-1       TO WS-BIN-EFF-DT
  2412        MOVE DC-GREG-DATE-1-MDY  TO SAVE-EFF-DATE
  2413     ELSE
  2414        DISPLAY ' BAD EFFECT  DT ' WS-WORK-DATE '  '
  2415        'CERT = ' FP7-ACCOUNT-NUMBER
  2416     END-IF
  2417
  2418     MOVE FP7-LASN-ORIG-1ST-PMT-DT (7:4)
  2419                                 TO WS-WORK-DATE (1:4)
  2420     MOVE FP7-LASN-ORIG-1ST-PMT-DT (1:2)
  2421                                 TO WS-WORK-DATE (5:2)
  2422     MOVE FP7-LASN-ORIG-1ST-PMT-DT (4:2)
  2423                                 TO WS-WORK-DATE (7:2)
  2424     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2425     MOVE 'L'                    TO DC-OPTION-CODE
  2426     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2427     IF NO-CONVERSION-ERROR
  2428        MOVE DC-BIN-DATE-1       TO WS-BIN-1ST-PAY-DT
  2429        MOVE DC-GREG-DATE-1-MDY  TO WS-1ST-PMT-DT
  2430     ELSE
  2431        DISPLAY ' BAD 1ST PMT DT ' WS-WORK-DATE '  '
  2432        'CERT = ' FP7-ACCOUNT-NUMBER
  2433     END-IF
  2434
  2435     MOVE FP7-CISM-BIRTH-DT (7:4)
  2436                                 TO WS-WORK-DATE (1:4)
  2437                                    WORK-BIRTH-DATE (1:4)
  2438     MOVE FP7-CISM-BIRTH-DT (1:2)
  2439                                 TO WS-WORK-DATE (5:2)
  2440                                    WB-MM
  2441                                    ws-birth-dt-x (1:2)
  2442     MOVE FP7-CISM-BIRTH-DT (4:2)
  2443                                 TO WS-WORK-DATE (7:2)
  2444                                    WB-DD
  2445                                    ws-birth-dt-x (3:2)
  2446     move fp7-cism-birth-dt (9:2) to ws-birth-dt-x (5:2)
  2447     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2448     MOVE 'L'                    TO DC-OPTION-CODE
  2449     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* CIFPB511.cbl
  2450     IF NO-CONVERSION-ERROR
  2451        MOVE DC-BIN-DATE-1       TO WS-BIN-BIRTH-DT
  2452     ELSE
  2453        DISPLAY ' BAD BIRTH DATE ' FP7-CISM-BIRTH-DT
  2454        ' CERT = ' FP7-ACCOUNT-NUMBER
  2455     END-IF
  2456
  2457     MOVE 40                     TO WS-INSURED-AGE
  2458
  2459     MOVE WS-BIN-BIRTH-DT        TO DC-BIN-DATE-1
  2460     MOVE WS-BIN-EFF-DT          TO DC-BIN-DATE-2
  2461     MOVE '1'                    TO DC-OPTION-CODE
  2462     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2463     IF NO-CONVERSION-ERROR
  2464        COMPUTE WS-INSURED-AGE = DC-ELAPSED-MONTHS / +12
  2465     ELSE
  2466        DISPLAY ' BAD AGE CALC CERT = ' FP7-ACCOUNT-NUMBER
  2467        ' ' DC-ERROR-CODE
  2468     END-IF
  2469
  2470     MOVE  FP7-ACCOUNT-NUMBER    TO SAVE-CERT
  2471
  2472     IF FP7-PMT-AMT NOT NUMERIC
  2473        MOVE ZEROS               TO FP7-PMT-AMT
  2474     END-IF
  2475
  2476     IF FP7-CANC-AMT NOT NUMERIC
  2477        MOVE ZEROS               TO FP7-CANC-AMT
  2478     END-IF
  2479
  2480     IF FP7-INS-MOS NOT NUMERIC
  2481        MOVE ZEROS               TO FP7-INS-MOS
  2482     END-IF
  2483
  2484     IF FP7-AMT-DOLLARS NOT NUMERIC
  2485        MOVE ZEROS               TO FP7-AMT-DOLLARS
  2486     END-IF
  2487
  2488     IF FP7-AMT-CENTS NOT NUMERIC
  2489        MOVE ZEROS               TO FP7-AMT-CENTS
  2490     END-IF
  2491
  2492     MOVE FP7-AMT-DOLLARS        TO WS-WORK-AMT-DOLLARS
  2493     MOVE FP7-AMT-CENTS          TO WS-WORK-AMT-CENTS
  2494
  2495     DISPLAY ' FP7 APR =' FP7-APR
  2496     IF FP7-APR-WHOLE NOT NUMERIC
  2497        MOVE ZEROS               TO FP7-APR-WHOLE
  2498     END-IF
  2499     IF FP7-APR-DEC NOT NUMERIC
  2500        MOVE ZEROS               TO FP7-APR-DEC
  2501     END-IF
  2502     MOVE FP7-APR-WHOLE          TO WS-WORK-APR-DOLLARS
  2503     MOVE FP7-APR-DEC            TO WS-WORK-APR-CENTS
  2504     DISPLAY ' APR = **' WS-WORK-APR-N '**'
  2505
  2506     IF FP7-LASN-LOAN-TERM NOT NUMERIC
  2507        MOVE ZEROS               TO FP7-LASN-LOAN-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* CIFPB511.cbl
  2508     END-IF
  2509
  2510     MOVE SPACES                 TO WS-LF-BENEFIT-CD
  2511                                    WS-AH-BENEFIT-CD
  2512                                    WS-AH-ONLY-SW
  2513     MOVE ZEROS                  TO WS-LF-PREM
  2514                                    WS-AH-PREM
  2515                                    WS-LF-REF
  2516                                    WS-AH-REF
  2517                                    WS-LF-PREM-ALT
  2518                                    WS-LF-BALLOON
  2519                                    WS-LF-REF-DATE
  2520                                    WS-AH-REF-DATE
  2521
  2522     .
  2523 0070-EXIT.
  2524     EXIT.
  2525
  2526 0080-BUILD-SEQ-1.
  2527
  2528     ADD 1                       TO LOGIC-CNT
  2529     ADD 1                       TO CERT-CNT
  2530*    ADD 1                       TO FP-CERT-ISS
  2531     ADD 1                       TO TOT-CERT-ISS
  2532
  2533     MOVE SPACES                 TO PBI-RECORD-BODY
  2534
  2535     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2536     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2537
  2538     MOVE FP7-SHORT-FNAME        TO PBI-I-INS-1ST-NAME
  2539     MOVE FP7-MID-INIT           TO PBI-I-INS-MIDDLE-INIT
  2540     MOVE FP7-SHORT-LNAME        TO PBI-I-INS-LAST-NAME
  2541
  2542     MOVE WS-INSURED-AGE         TO PBI-I-INSURED-AGE
  2543     MOVE 'M'                    TO PBI-I-INSURED-SEX
  2544
  2545     STRING FP7-TAX-ID (1:3) '-' FP7-TAX-ID (4:2) '-'
  2546        FP7-TAX-ID (6:4) DELIMITED BY SIZE INTO PBI-I-SOC-SEC-NO
  2547     END-STRING
  2548
  2549     MOVE WS-BIRTH-DT            TO PBI-I-BIRTHDAY
  2550
  2551     MOVE '2'                    TO PBI-TRANS-TYPE
  2552     MOVE '1'                    TO PBI-SEQUENCE
  2553
  2554     MOVE PBI-ISSUE-RECORD       TO OUT-RECORD (1:80)
  2555     PERFORM 0140-RELEASE-REC    THRU 0140-EXIT
  2556
  2557     .
  2558 0080-EXIT.
  2559     EXIT.
  2560
  2561 0090-BUILD-SEQ-2.
  2562
  2563     MOVE SPACES                 TO PBI-RECORD-BODY
  2564     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2565     MOVE SAVE-CERT              TO PBI-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* CIFPB511.cbl
  2566
  2567     MOVE +1                     TO S1
  2568     IF FP7-NAME-2 NOT = SPACES
  2569        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2570           (S2 > +30)
  2571           OR (FP7-NAME-2 (S2:1) = ' ')
  2572        END-PERFORM
  2573        IF (S2 < +30)
  2574           AND (S2 > +1)
  2575           MOVE FP7-NAME-2 (S1:(S2 - 1))
  2576                                 TO PBI-I-JNT-1ST-NAME
  2577        END-IF
  2578        IF (FP7-NAME-2 (S2:1) = SPACES)
  2579           AND (FP7-NAME-2 ((S2 + 2):1) = SPACES)
  2580           MOVE FP7-NAME-2 ((S2 + 1):1)
  2581                                 TO PBI-I-JNT-MIDDLE-INIT
  2582           COMPUTE S2 = S2 + 3
  2583        ELSE
  2584           COMPUTE S2 = S2 + 1
  2585        END-IF
  2586        MOVE S2                  TO S1
  2587        COMPUTE S2 = 31 - S2
  2588        MOVE FP7-NAME-2 (S1:S2)  TO PBI-I-JNT-LAST-NAME
  2589     END-IF
  2590
  2591     MOVE '2'                    TO PBI-TRANS-TYPE
  2592     MOVE '2'                    TO PBI-SEQUENCE
  2593
  2594     IF PBI-I-ISSUE-REC-SEQ-2 NOT = SPACES
  2595        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2596        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2597     END-IF
  2598
  2599     .
  2600 0090-EXIT.
  2601     EXIT.
  2602
  2603 0100-BUILD-SEQ-3.
  2604
  2605     MOVE SPACES                 TO PBI-RECORD-BODY
  2606
  2607     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2608     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2609
  2610     MOVE WS-LF-BENEFIT-CD       TO PBI-I-LF-BENEFIT-TYPE
  2611     MOVE WS-LF-PREM             TO PBI-I-LF-PREM-AMT
  2612     MOVE WS-LF-PREM-ALT         TO PBI-I-LF-ALT-PREM-AMT
  2613     MOVE WS-LF-BALLOON          TO PBI-I-LF-ALT-BENEFIT-AMT
  2614
  2615     COMPUTE PBI-I-LF-BENEFIT-AMT = FP7-PMT-AMT * FP7-INS-MOS
  2616*    IF WS-WORK-AMT-N NOT = ZEROS
  2617*       MOVE WS-WORK-AMT-N       TO PBI-I-LF-BENEFIT-AMT
  2618*    END-IF
  2619
  2620     MOVE FP7-INS-MOS            TO PBI-I-LF-TERM
  2621
  2622     ADD WS-LF-PREM              TO TOT-LIFE-WRITTEN
  2623*                                   FP-LF-WRITTEN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* CIFPB511.cbl
  2624
  2625     ADD WS-LF-PREM-ALT          TO TOT-LIFE-WRITTEN
  2626*                                   FP-LF-WRITTEN
  2627
  2628     IF PBI-I-LF-PREM-AMT = ZEROS
  2629        MOVE ZEROS               TO PBI-I-LF-BENEFIT-AMT
  2630     END-IF
  2631
  2632     MOVE '2'                    TO PBI-TRANS-TYPE
  2633     MOVE '3'                    TO PBI-SEQUENCE
  2634
  2635     IF (PBI-I-LF-PREM-AMT > ZEROS)
  2636*       AND (PBI-I-LF-BENEFIT-AMT > ZEROS)
  2637        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2638        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2639     END-IF
  2640
  2641     .
  2642 0100-EXIT.
  2643     EXIT.
  2644
  2645 0110-BUILD-SEQ-4.
  2646
  2647     MOVE SPACES                 TO PBI-RECORD-BODY
  2648
  2649     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2650     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2651
  2652     DISPLAY ' BENEFIT CD **' WS-AH-BENEFIT-CD '**'
  2653     DISPLAY '  PMT AMT   **' FP7-PMT-AMT '**'
  2654     DISPLAY '  PREM AMT  **' WS-AH-PREM '**'
  2655     MOVE WS-AH-BENEFIT-CD       TO PBI-I-AH-BENEFIT-TYPE
  2656     MOVE FP7-PMT-AMT            TO PBI-I-AH-BENEFIT-AMT
  2657     MOVE FP7-INS-MOS            TO PBI-I-AH-TERM
  2658     MOVE WS-AH-PREM             TO PBI-I-AH-PREM-AMT
  2659
  2660
  2661     ADD WS-AH-PREM              TO TOT-AH-WRITTEN
  2662*                                   FP-AH-WRITTEN
  2663
  2664     MOVE '2'                       TO  PBI-TRANS-TYPE.
  2665     MOVE '4'                       TO  PBI-SEQUENCE.
  2666
  2667     IF (PBI-I-AH-BENEFIT-AMT > ZEROS)
  2668        AND (PBI-I-AH-PREM-AMT > ZEROS)
  2669        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2670        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2671     END-IF
  2672
  2673     .
  2674 0110-EXIT.
  2675     EXIT.
  2676
  2677 0120-BUILD-SEQ-5.
  2678
  2679     MOVE SPACES                 TO PBI-RECORD-BODY
  2680
  2681     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* CIFPB511.cbl
  2682     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2683
  2684     MOVE FP7-RESP-CODE          TO PBI-I-LOAN-OFFICER
  2685
  2686     SET S3                      TO +1
  2687*    SEARCH ALL LOAN-OFFS AT END
  2688*       MOVE 'XX'                TO PBI-I-LOAN-OFFICER (1:2)
  2689*         WHEN RESP-CODE (S3) = PBI-I-LOAN-OFFICER (3:3)
  2690*            MOVE BRANCH-CODE (S3) TO PBI-I-LOAN-OFFICER (1:2)
  2691*    END-SEARCH
  2692     MOVE FP7-BRANCH-NO (11:2)   TO PBI-I-LOAN-OFFICER (1:2)
  2693
  2694*    MOVE FP7-LASN-LOAN-TERM     TO PBI-I-LOAN-TERM
  2695
  2696     MOVE WS-1ST-PMT-DT          TO PBI-I-1ST-PMT-DT
  2697
  2698     MOVE WS-WORK-APR-N          TO PBI-I-LOAN-APR
  2699
  2700     MOVE '2'                    TO PBI-TRANS-TYPE
  2701     MOVE '5'                    TO PBI-SEQUENCE
  2702
  2703     MOVE PBI-ISSUE-RECORD       TO OUT-RECORD (1:80)
  2704     PERFORM 0140-RELEASE-REC    THRU 0140-EXIT
  2705
  2706     .
  2707 0120-EXIT.
  2708     EXIT.
  2709
  2710 0122-BUILD-SEQ-6.
  2711
  2712     MOVE SPACES                 TO PBI-RECORD-BODY
  2713
  2714     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2715     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2716
  2717     MOVE FP7-ADDRESS            TO PBI-I-INSURED-ADDRESS-1
  2718
  2719     MOVE '2'                    TO PBI-TRANS-TYPE
  2720     MOVE '6'                    TO PBI-SEQUENCE
  2721
  2722     IF PBI-I-ISSUE-REC-SEQ-6 NOT = SPACES
  2723        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2724        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2725     END-IF
  2726
  2727     .
  2728 0122-EXIT.
  2729     EXIT.
  2730
  2731 0125-BUILD-SEQ-7.
  2732
  2733     MOVE SPACES                 TO PBI-RECORD-BODY
  2734
  2735     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2736     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2737
  2738     MOVE FP7-CISM-CITY          TO PBI-I-INSURED-CITY
  2739     MOVE FP7-CISM-STATE         TO PBI-I-INSURED-STATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* CIFPB511.cbl
  2740*    STRING FP7-CISM-CITY ', ' FP7-CISM-STATE DELIMITED BY SIZE
  2741*       INTO PBI-I-INSURED-CITY-STATE
  2742*    END-STRING
  2743     MOVE FP7-CISM-ZIP-9 (4:9)   TO PBI-I-INSURED-ZIP-CODE
  2744     MOVE FP7-CISM-HOME-PHONE (3:10)
  2745                                 TO PBI-I-INSURED-PHONE-NO
  2746
  2747     MOVE '2'                    TO PBI-TRANS-TYPE
  2748     MOVE '7'                    TO PBI-SEQUENCE
  2749
  2750     IF PBI-I-ISSUE-REC-SEQ-7 NOT = SPACES
  2751        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2752        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2753     END-IF
  2754
  2755     .
  2756 0125-EXIT.
  2757     EXIT.
  2758
  2759 0127-BUILD-SEQ-8.
  2760
  2761     MOVE SPACES                 TO PBI-RECORD-BODY
  2762
  2763     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2764     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2765
  2766     MOVE 'FIRST PREMIER BANK'   TO  PBI-I-CRED-BENE-NAME
  2767
  2768     MOVE '2'                    TO PBI-TRANS-TYPE
  2769     MOVE '8'                    TO PBI-SEQUENCE
  2770
  2771     IF PBI-I-ISSUE-REC-SEQ-8 NOT = SPACES
  2772        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2773        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2774     END-IF
  2775
  2776     .
  2777 0127-EXIT.
  2778     EXIT.
  2779
  2780 0130-BUILD-CANCEL.
  2781
  2782     MOVE SPACES                 TO PBI-RECORD-BODY
  2783     ADD 1                       TO LOGIC-CANC-CNT
  2784     ADD 1                       TO CANC-CNT
  2785
  2786     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2787     MOVE WS-SAVE-ACCT-NO        TO PBI-CERT-PRIME
  2788
  2789     MOVE FP7-SHORT-LNAME        TO PBI-C-INSURED-NAME
  2790
  2791     MOVE WS-LF-REF              TO PBI-C-LF-PREM-REFUND
  2792     MOVE WS-AH-REF              TO PBI-C-AH-PREM-REFUND
  2793
  2794     IF PBI-C-LF-PREM-REFUND > ZEROS
  2795        MOVE WS-LF-REF-DATE      TO PBI-C-LF-CANCEL-DATE
  2796     END-IF
  2797
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* CIFPB511.cbl
  2798     IF PBI-C-AH-PREM-REFUND > ZEROS
  2799        MOVE WS-AH-REF-DATE      TO PBI-C-AH-CANCEL-DATE
  2800     END-IF
  2801
  2802     MOVE '3'                    TO PBI-C-TRANS-TYPE
  2803     MOVE '1'                    TO PBI-C-SEQUENCE
  2804
  2805*    ADD 1                       TO FP-CERT-CANC
  2806*    ADD PBI-C-LF-PREM-REFUND    TO FP-LF-CANC
  2807*    ADD PBI-C-AH-PREM-REFUND    TO FP-AH-CANC
  2808
  2809     ADD 1                       TO TOT-CERT-CANC
  2810     ADD PBI-C-LF-PREM-REFUND    TO TOT-LIFE-CANC
  2811     ADD PBI-C-AH-PREM-REFUND    TO TOT-AH-CANC
  2812
  2813     IF (PBI-C-LF-PREM-REFUND > ZEROS)
  2814        OR (PBI-C-AH-PREM-REFUND > ZEROS)
  2815        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2816        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2817     END-IF
  2818
  2819     .
  2820 0130-EXIT.
  2821     EXIT.
  2822
  2823 0140-RELEASE-REC.
  2824
  2825     MOVE '1'                 TO OUT-BATCH-HDR-IND
  2826     RELEASE SORT-RECORD      FROM OUT-RECORD
  2827     ADD +1 TO RECS-REL
  2828
  2829     .
  2830 0140-EXIT.
  2831     EXIT.
  2832
  2833 0160-ACCOUNT-BREAK.
  2834
  2835     MOVE '9'                    TO FP-CARR
  2836     MOVE '000000'               TO FP-COMP
  2837     MOVE 'SD'                   TO FP-STATE
  2838     MOVE WS-PREV-SR-ACCOUNT     TO FP-ACCT-NO
  2839     MOVE 'FP'                   TO FP-BATCH-ID
  2840     MOVE WORK-MO-IN             TO FP-BATCH-DA
  2841     ADD  1                      TO FP-BATCH-NO
  2842     MOVE WORK-YR-IN             TO FP-HD-EFF-YR
  2843     MOVE WORK-MO-IN             TO FP-HD-EFF-MO
  2844     MOVE WORK-DA-IN             TO FP-HD-EFF-DA
  2845     MOVE 'CID'                  TO FP-CLIENT-ID
  2846     MOVE '1'                    TO FP-TRANS-TYPE
  2847     MOVE '0'                    TO FP-SEQUENCE-NO
  2848     MOVE WS-PREV-SR-ACCOUNT     TO FP-ACCOUNT-NO
  2849     MOVE '0'                    TO FP-BATCH-HDR-IND
  2850     ADD 1                       TO HDR-CNT
  2851
  2852     WRITE CARD-RECORD           FROM FPB-BATCH-HDR
  2853
  2854     MOVE ZEROS                 TO FP-LF-WRITTEN
  2855                                   FP-LF-CANC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* CIFPB511.cbl
  2856                                   FP-AH-WRITTEN
  2857                                   FP-AH-CANC
  2858                                   FP-CERT-ISS
  2859                                   FP-CERT-CANC
  2860                                   CERT-CNT
  2861                                   CANC-CNT
  2862                                   DETAIL-CNT
  2863
  2864     .
  2865 0160-EXIT.
  2866     EXIT.
  2867
  2868 8500-DATE-CONVERT.
  2869
  2870     CALL 'ELDATCX'              USING DATE-CONVERSION-DATA
  2871
  2872     .
  2873 8590-EXIT.
  2874     EXIT.
  2875
  2876 ABEND-PGM.
*                 COPY ELCABEND.
  2877***************************************************************** 04/14/98
  2878*                                                               * ELCABEND
  2879*                            ELCABEND.                          *    LV003
  2880*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2881*                            VMOD 2.002                              CL**2
  2882*                                                               * ELCABEND
  2883*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2884*            AND THEN ABENDS.                                   * ELCABEND
  2885*                                                               * ELCABEND
  2886*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2887*                                                               * ELCABEND
  2888***************************************************************** ELCABEND
  2889*APS-010.                                                         ELCABEND
  2890     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2891     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2892                                                                  ELCABEND
  2893     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2894         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2895         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2896                                 UPON CONSOLE.                    ELCABEND
  2897                                                                  ELCABEND
  2898     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2899         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2900         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2901                                 UPON CONSOLE.                    ELCABEND
  2902                                                                  ELCABEND
  2903     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2904     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2905                                 UPON CONSOLE.                    ELCABEND
  2906                                                                  ELCABEND
  2907     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2908     CALL 'ABORTME'.
  2909                                                                  ELCABEND
  2910 APS-EXIT.                                                        ELCABEND
  2911     EXIT.                                                        ELCABEND
  2912
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* CIFPB511.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51296     Code:        8051
