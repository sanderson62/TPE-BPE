* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS010V.cbl
* Options: int("ECS010V.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS010V.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS010V.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS010V.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ECS010.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/27/94 07:51:58.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.082.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS010V.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM ACCEPTS VALIDATED TRANSACTIONS FROM EL522
    27*        AND APPLIES THEM TO THE CERTIFICATE MASTER FILE.
    28*        EXTRACTS ARE PRODUCED FOR PRODUCTION  EARNED PREMIUM &
    29*        LOSS, REINSURANCE, COMMISSIONS, CLAIMS REGISTER, ETC.
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 061802                   PEMA  ADD PROCESS FOR PEOPLES
    39* 062602    2002061900011  SMVA  CHANGE SYS009 SYSOUT TO FILE WITH
    40*                              ORGANIZATION AS LINE SEQUENTIAL
    41* 070102                   SMVA  CLEAN UP COMPILE ERRORS
    42* 080702    2002061800008  PEMA  ADD PROCESS FOR SUNFLOWER
    43* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
    44*                                  BENEFIT CODES FROM 450 TO 900
    45* 111402    2001061800003  PEMA  ADD DCC PROCESSING
    46* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    47* 052703                   PEMA  MODIFY CEDE BALLOON PREM TO NSP
    48* 070203                   PEMA  BUILD REIN COMP DATA FOR NSP
    49* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    50* 123003                   PEMA  MODIFY COMPUTE STMTS FOR REIN
    51* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    52* 062104    2004050700001  SMVA  ADD NEW FILES TO AUTOMATE ME BALANCING
    53* 102204    2004101500007  PEMA  IBNR FOR DCC
    54* 111204    2004110300005  PEMA  SPLIT SPP BANK FEE
    55* 123004                   PEMA  ADD REFUND PROCESSING FOR "MONTHLY"
    56* 020305    2005020000000  PEMA  ADD CLP STATE PROCESSING
    57* 092705  CR2005050300006  PEMA  ADD SPP LEASES
    58* 052306  CR2006050800002  PEMA  ADD COMM TYPE 'J'
    59* 061206  CR2006050500001  PEMA  ADD FIRST PREMIER BANK
    60* 011207                   PEMA  PASS SIG SW TO BATCH CERT FILE
    61*  special one time only ecs010 to process VA thru 04/30/07 eom
    62******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS010V.cbl
    64 ENVIRONMENT DIVISION.
    65 CONFIGURATION SECTION.
    66 SPECIAL-NAMES.
    67     C02 IS LCP-CH2
    68     C03 IS LCP-CH3
    69     C04 IS LCP-CH4
    70     C05 IS LCP-CH5
    71     C06 IS LCP-CH6
    72     C07 IS LCP-CH7
    73     C08 IS LCP-CH8
    74     C09 IS LCP-CH9
    75     C10 IS LCP-CH10
    76     C11 IS LCP-CH11
    77     C12 IS LCP-CH12
    78     S01 IS LCP-P01
    79     S02 IS LCP-P02.
    80
    81 INPUT-OUTPUT SECTION.
    82 FILE-CONTROL.
    83
    84     SELECT PENDING-EXTRACT  ASSIGN TO SYS005.
    85
    86     SELECT CERT-MASTER-IN   ASSIGN TO SYS010.
    87
    88     SELECT ERACCTT-IN       ASSIGN TO ERACCTT
    89                             ACCESS IS SEQUENTIAL
    90                             ORGANIZATION IS INDEXED
    91                             FILE STATUS IS ERACCTT-FILE-STATUS
    92                             RECORD KEY IS AM-CONTROL-PRIMARY.
    93
    94     SELECT ERRTBL-IN        ASSIGN TO ERRTBLT
    95                             ACCESS IS DYNAMIC
    96                             ORGANIZATION IS INDEXED
    97                             FILE STATUS IS ERRTBL-FILE-STATUS
    98                             RECORD KEY IS RE-CONTROL-PRIMARY.
    99
   100     SELECT ERCTBL           ASSIGN TO ERCTBLT
   101                             ACCESS IS DYNAMIC
   102                             ORGANIZATION IS INDEXED
   103                             FILE STATUS IS ERCTBL-FILE-STATUS
   104                             RECORD KEY IS CT-CONTROL-PRIMARY.
   105
   106     SELECT ERMEBL-INOUT     ASSIGN TO ERMEBL
   107                             ORGANIZATION INDEXED
   108                             ACCESS DYNAMIC
   109                             RECORD KEY ME-CONTROL-PRIMARY
   110                             FILE STATUS ERMEBL-FILE-STATUS.
   111
   112     SELECT ERRESC-IN        ASSIGN TO ERRESC
   113                             ORGANIZATION IS INDEXED
   114                             ACCESS IS DYNAMIC
   115                             RECORD KEY IS ERRESC-RECORD-KEY
   116                             FILE STATUS IS ERRESC-FILE-STATUS.
   117
   118     SELECT ELCRTT           ASSIGN TO ELCRTT
   119                             ACCESS IS DYNAMIC
   120                             ORGANIZATION IS INDEXED
   121                             FILE STATUS IS ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS010V.cbl
   122                             RECORD KEY IS CS-CONTROL-PRIMARY.
   123
   124     SELECT ERAGTC           ASSIGN TO ERAGTC
   125                             ACCESS IS DYNAMIC
   126                             ORGANIZATION IS INDEXED
   127                             FILE STATUS IS ERAGTC-FILE-STATUS
   128                             RECORD KEY IS AG-CONTROL-PRIMARY.
   129
   130     SELECT CERT-MASTER-OUT  ASSIGN TO SYS011.
   131
   132     SELECT DETAIL-EXTR      ASSIGN TO SYS017.
   133
   134     SELECT SUMMARY-EXTR     ASSIGN TO SYS018.
   135
   136
   137     SELECT ME-ECS010-BALANCE
   138                             ASSIGN TO SYS012
   139                             ORGANIZATION IS LINE SEQUENTIAL.
   140
   141     SELECT ME50-ECS010-BALANCE
   142                             ASSIGN TO SYS013
   143                             ORGANIZATION IS LINE SEQUENTIAL.
   144
   145     SELECT DISPLAY-PRT      ASSIGN TO SYS022.
   146
   147     SELECT DISK-DATE        ASSIGN TO SYS019.
   148
   149     SELECT PRINT-COPY       ASSIGN TO SYS008.
   150
   151     SELECT MISMATCH-REPORT  ASSIGN TO SYS009.
   152
   153     SELECT FICH             ASSIGN TO SYS020.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS010V.cbl
   155 DATA DIVISION.
   156 FILE SECTION.
   157
   158 FD  PENDING-EXTRACT
   159     BLOCK CONTAINS 0 RECORDS
   160     RECORDING MODE F.
   161
*  162                             COPY ERCEXTD.
   163******************************************************************04/29/98
   164*                                                                *ERCEXTD
   165*                                                                *ERCEXTD
   166*                            ERCEXTD                             *   LV002
   167*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   168*                            VMOD=2.002                          *   CL**2
   169*                                                                *ERCEXTD
   170*   FILE DESCRIPTION = ONLINE TO BATCH FILE INTERFACE AND REPORT *ERCEXTD
   171*                      EXTRACT FOR OFFLINE REPORTING.            *ERCEXTD
   172*                                                                *ERCEXTD
   173*     THIS FILE IS CREATED FROM ERCEXTR EXTRACT INTERFACE        *ERCEXTD
   174*  FOR THE FOLLOWING RECORD TYPES. THE MAIN BODY OF EACH RECORD  *ERCEXTD
   175*  CONTAINS A STRAIGHT COPY OF THE EX-DATA-AREA IN EXCEXTR.      *ERCEXTD
   176*                                                                *ERCEXTD
   177*         RECORD                                                 *ERCEXTD
   178*          TYPE          PROGRAM USING                           *ERCEXTD
   179*        --------        --------------------------------        *ERCEXTD
   180*           A             EL522  PENDING BUSINESS EXTRACT        *ERCEXTD
   181*           B             EL522  PENDING CLAIMS   EXTRACT        *ERCEXTD
   182*           C             EL522  CERT CHANGES     EXTRACT        *ERCEXTD
   183*                                                                *ERCEXTD
   184* -------------------------------------------------------------- *ERCEXTD
   185*                                                                *ERCEXTD
   186*   FILE TYPE = SEQUENTIAL                                       *ERCEXTD
   187*   RECORD SIZE = 588   RECFORM = FIX                            *ERCEXTD
   188*                                                                *ERCEXTD
   189*   FILENAME = EREXTD                                            *ERCEXTD
   190*                                                                *ERCEXTD
   191******************************************************************ERCEXTD
   192                                                                  ERCEXTD
   193 01  EXTRACT-DATA-RECORD.                                         ERCEXTD
   194     12  ED-RECORD-ID                        PIC XX.              ERCEXTD
   195         88  VALID-IN-ID                           VALUE 'ED'.    ERCEXTD
   196                                                                  ERCEXTD
   197     12  ED-RECORD-TYPE                      PIC X.               ERCEXTD
   198         88  ED-PENDING-BUSINESS                   VALUE 'A'.     ERCEXTD
   199         88  ED-PENDING-CLAIMS                     VALUE 'B'.     ERCEXTD
   200         88  ED-CERT-CHANGES                       VALUE 'C'.     ERCEXTD
   201                                                                  ERCEXTD
   202     12  ED-DATA-AREAS                       PIC X(585).          ERCEXTD
   203                                                                  ERCEXTD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS010V.cbl
   205 FD  CERT-MASTER-IN
*  206                             COPY ECSCRIFD.
   207******************************************************************07/10/97
   208*                                                                *ECSCRIFD
   209*                            ECSCRIFD                            *   LV001
   210*                            VMOD 2.005                          *ECSCRIFD
   211*                                                                *ECSCRIFD
   212*  NO CID MODS FOR COPYBOOK ECSCRIFD                             *ECSCRIFD
   213*                                                                *ECSCRIFD
   214******************************************************************ECSCRIFD
   215     BLOCK CONTAINS 0 RECORDS
   216     RECORDING MODE F.                                            ECSCRIFD
   217                                                                  ECSCRIFD
   218 01  CERT-IN-RECORD.                                              ECSCRIFD
   219                                                                  ECSCRIFD
   220     12  FILLER                            PIC XXX.               ECSCRIFD
   221     12  CIR-CONTROL                       PIC X(36).             ECSCRIFD
   222     12  FILLER                            PIC X(66).             ECSCRIFD
   223     12  CIR-JOINT-AGE                     PIC 99.                ECSCRIFD
   224     12  FILLER                            PIC X(20).             ECSCRIFD
   225     12  CIR-LFTYP                         PIC XX.                ECSCRIFD
   226     12  FILLER                            PIC X(14).             ECSCRIFD
   227     12  CIR-LFAMT                         PIC S9(9)V99   COMP-3. ECSCRIFD
   228     12  FILLER                            PIC X(39).             ECSCRIFD
   229     12  CIR-LFRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   230     12  FILLER                            PIC X(45).             ECSCRIFD
   231     12  CIR-AHTYP                         PIC XX.                ECSCRIFD
   232     12  FILLER                            PIC X(35).             ECSCRIFD
   233     12  CIR-AHRFND-CALC                   PIC S9(7)V99   COMP-3. ECSCRIFD
   234     12  FILLER                            PIC X(41).             ECSCRIFD
   235     12  CIR-APR                           PIC S999V9(4)  COMP-3. ECSCRIFD
   236     12  FILLER                            PIC X(48).             ECSCRIFD
   237     12  CIR-REIN-TABLE                    PIC XXX.               ECSCRIFD
   238     12  FILLER                            PIC X(9).              ECSCRIFD
   239     12  CIR-SUM-CAN-CNT-YTD               PIC S999       COMP-3. ECSCRIFD
   240     12  FILLER                            PIC X(120).            ECSCRIFD
   241     12  CIR-DTHAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   242     12  FILLER                            PIC X(73).             ECSCRIFD
   243     12  CIR-DISAMT-YTD                    PIC S9(9)V99   COMP-3. ECSCRIFD
   244     12  FILLER                            PIC X(464).            ECSCRIFD
   245                                                                  ECSCRIFD
   246******************************************************************ECSCRIFD
   247
   248 01  CI-RECORD.
   249     12  FILLER          PIC  X(03).
   250     12  CI-ACCOUNT-CONTROL.
   251         16  CI-CARRIER      PIC  X(01).
   252         16  CI-GROUPING     PIC  X(06).
   253         16  CI-STATE        PIC  X(02).
   254         16  CI-ACCOUNT      PIC  X(10).
   255     12  FILLER          PIC  X(06).
   256     12  CI-CERT-NO.
   257         16  CI-CERT     PIC X(10).
   258         16  CI-CERT-SFX PIC X.
   259     12  FILLER          PIC  X(1017).
   260
   261******************************************************
   262*   THIS FILE DEFINITION WAS ADDED TO ACCOMMODATE THE EXECUTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS010V.cbl
   263*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
   264*   COMMERCIAL FEDERAL BANK
   265******************************************************
   266 01  CF-RECORD.
   267     12  FILLER          PIC X(759).
   268     12  CF-THIRD-AGENT  PIC X(10).
   269     12  FILLER          PIC X(7).
   270     12  CF-FOURTH-AGENT PIC X(10).
   271     12  FILLER          PIC X(270).
   272
   273******************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS010V.cbl
   275 FD  ERACCTT-IN.
   276
*  277                             COPY ERCACCT.
   278******************************************************************04/19/98
   279*                                                                *ERCACCT
   280*                                                                *ERCACCT
   281*                            ERCACCT                             *   LV031
   282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   283*                            VMOD=2.031                          *ERCACCT
   284*                                                                *ERCACCT
   285*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   286*                                                                *ERCACCT
   287*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   288*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   289*                                                                *ERCACCT
   290*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   291*                                                                *ERCACCT
   292*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   293*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   294*                                                                *ERCACCT
   295*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   296*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   297*                                                                *ERCACCT
   298*   LOG = NO                                                     *ERCACCT
   299*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   300*                                                                *ERCACCT
   301*                                                                *ERCACCT
   302******************************************************************ERCACCT
   303*                   C H A N G E   L O G
   304*
   305* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   306*-----------------------------------------------------------------
   307*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   308* EFFECTIVE    NUMBER
   309*-----------------------------------------------------------------
   310* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   311* 092705    2005050300006  PEMA  ADD SPP LEASES
   312* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   313* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   314* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   315* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   316* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   317******************************************************************
   318                                                                  ERCACCT
   319 01  ACCOUNT-MASTER.                                              ERCACCT
   320     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   321         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   322                                                                  ERCACCT
   323     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   324         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   325         16  AM-MSTR-CNTRL.                                       ERCACCT
   326             20  AM-CONTROL-A.                                    ERCACCT
   327                 24  AM-CARRIER            PIC X.                 ERCACCT
   328                 24  AM-GROUPING.                                 ERCACCT
   329                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   330                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   331                 24  AM-STATE              PIC XX.                ERCACCT
   332                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   333                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   334                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   335             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   336                                           PIC X(19).             ERCACCT
   337             20  AM-CNTRL-B.                                      ERCACCT
   338                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   339                 24  FILLER                PIC X(4).              ERCACCT
   340             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   341                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   342                                                                  ERCACCT
   343     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   344         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   345         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   346         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   347         16  AM-VG-STATE                   PIC XX.                ERCACCT
   348         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   349         16  AM-VG-DATE.                                          ERCACCT
   350             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   351             20  FILLER                    PIC X(4).              ERCACCT
   352         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   353                                           PIC 9(11)      COMP-3. ERCACCT
   354     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   355         16  FILLER                        PIC X(10).
   356         16  AM-VG-KEY3.
   357             20  AM-VG3-ACCOUNT            PIC X(10).
   358             20  AM-VG3-EXP-DT             PIC XX.
   359         16  FILLER                        PIC X(4).
   360     12  AM-MAINT-INFORMATION.                                    ERCACCT
   361         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   362         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   363         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   364         16  FILLER                        PIC XX.                ERCACCT
   365                                                                  ERCACCT
   366     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   367     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   368                                                                  ERCACCT
   369     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   370         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   371         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   372                                                                  ERCACCT
   373     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   374     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   375                                                                  ERCACCT
   376     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   377     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   378                                                                  ERCACCT
   379     12  AM-NAME                           PIC X(30).             ERCACCT
   380     12  AM-PERSON                         PIC X(30).             ERCACCT
   381     12  AM-ADDRS                          PIC X(30).             ERCACCT
   382     12  AM-CITY.
   383         16  AM-ADDR-CITY                  PIC X(28).
   384         16  AM-ADDR-STATE                 PIC XX.
   385     12  AM-ZIP.                                                  ERCACCT
   386         16  AM-ZIP-PRIME.                                        ERCACCT
   387             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   388                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   389             20  FILLER                    PIC X(4).              ERCACCT
   390         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   391     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   392         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   393         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   394         16  FILLER                        PIC XXX.               ERCACCT
   395     12  AM-TEL-NO.                                               ERCACCT
   396         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   397         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   398         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   399     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   400         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   401         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   402                                                                  ERCACCT
   403     12  AM-COMM-STRUCTURE.                                       ERCACCT
   404         16  AM-DEFN-1.                                           ERCACCT
   405             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   406                 24  AM-AGT.                                      ERCACCT
   407                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   408                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   409                 24  AM-COM-TYP            PIC X.                 ERCACCT
   410                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   411                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   412                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   413                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   414                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   415                 24  AM-GL-CODES           PIC X.                 ERCACCT
   416                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   417                 24  FILLER                PIC X(01).             ERCACCT
   418         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   419             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   420                 24  FILLER                PIC X(11).             ERCACCT
   421                 24  AM-L-COMA             PIC XXX.               ERCACCT
   422                 24  AM-J-COMA             PIC XXX.               ERCACCT
   423                 24  AM-A-COMA             PIC XXX.               ERCACCT
   424                 24  FILLER                PIC X(6).              ERCACCT
   425                                                                  ERCACCT
   426     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   427         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   428                                                                  ERCACCT
   429     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   430                                                                  ERCACCT
   431     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   432         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   433         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   434     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   435         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   436         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   437     12  AM-GPCD                           PIC 99.                ERCACCT
   438     12  AM-IG                             PIC X.                 ERCACCT
   439         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   440         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   441     12  AM-STATUS                         PIC X.                 ERCACCT
   442         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   443         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   444         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   445         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   446         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   447         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   448     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   449     12  AM-ID-NO                          PIC X(11).             ERCACCT
   450                                                                  ERCACCT
   451     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   452     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   453     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   454     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   455     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   456     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   457     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   458     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   459     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   460                                                                  ERCACCT
   461     12  AM-USER-FIELDS.                                          ERCACCT
   462         16  AM-FLD-1                      PIC XX.                ERCACCT
   463         16  AM-FLD-2                      PIC XX.                ERCACCT
   464         16  AM-FLD-3                      PIC XX.                ERCACCT
   465         16  AM-FLD-4                      PIC XX.                ERCACCT
   466         16  AM-FLD-5                      PIC XX.                ERCACCT
   467                                                                  ERCACCT
   468     12  AM-1ST-PROD-DATE.                                        ERCACCT
   469         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   470         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   471         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   472     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   473     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   474         16  AM-PUR-YR                     PIC XX.                ERCACCT
   475         16  AM-PUR-MO                     PIC XX.                ERCACCT
   476         16  AM-PUR-DA                     PIC XX.                ERCACCT
   477     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   478     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   479     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   480     12  AM-INACTIVE-DATE.                                        ERCACCT
   481         16  AM-INA-MO                     PIC 99.                ERCACCT
   482         16  AM-INA-DA                     PIC 99.                ERCACCT
   483         16  AM-INA-YR                     PIC 99.                ERCACCT
   484     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   485                                                                  ERCACCT
   486     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   487     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   488                                                                  ERCACCT
   489     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   490         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   491         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   492         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   493         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   494                                                                  ERCACCT
   495     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   496         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   497         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   498                                                                  ERCACCT
   499     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   500                                                                  ERCACCT
   501     12  AM-OVER-SHORT.                                           ERCACCT
   502         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   503         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   504                                                                  ERCACCT
   505     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   506     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   507                                                                  ERCACCT
   508     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   509     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   510                                                                  ERCACCT
   511     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   512     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   513     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   514     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   515     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   516     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   517     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   518     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   519     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   520     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   521     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   522     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   523     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   524     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   525     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   526     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   527                                                                  ERCACCT
   528     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   529                                                                  ERCACCT
   530     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   531     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   532                                                                  ERCACCT
   533     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   534     12  AM-EARN-METHODS.                                         ERCACCT
   535         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   536             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   537             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   538             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   539             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   540         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   541             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   542             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   543             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   544             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   545         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   546             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   547             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   548             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   549             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   550             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   551             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   552                                                                  ERCACCT
   553     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   554     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   555     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   556                                                                  ERCACCT
   557     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   558     12  AM-RET-P-E                        PIC X.                 ERCACCT
   559     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   560     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   561     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   562     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   563         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   564         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   565     12  AM-RETRO-EARNINGS.                                       ERCACCT
   566         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   567         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   568         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   569     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   570         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   571         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   572     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   573         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   574         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   575         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   576     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   577     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   578                                                                  ERCACCT
   579     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   580         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   581         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   582         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   583         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   584         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   585                                                                  ERCACCT
   586     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   587                                                                  ERCACCT
   588     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   589                                                                  ERCACCT
   590     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   591         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   592                                                                  ERCACCT
   593     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   594         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   595         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   596                                                                  ERCACCT
   597     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   598         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   599                                                                  ERCACCT
   600     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   601         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   602         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   603                                                                  ERCACCT
   604     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   605                                                                  ERCACCT
   606     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   607     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   608     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   609     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   610     12  AM-DCC-UEF-STATE                  PIC XX.
   611     12  FILLER                            PIC XXX.
   612     12  AM-REPORT-CODE-3                  PIC X(10).
   613*    12  FILLER                            PIC X(22).             ERCACCT
   614                                                                  ERCACCT
   615     12  AM-RESERVE-DATE.                                         ERCACCT
   616         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   617         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   618         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   619                                                                  ERCACCT
   620     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   621     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   622         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   623         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   624         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   625         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   626                                                                  ERCACCT
   627     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   628         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   629         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   630         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   631         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   632                                                                  ERCACCT
   633     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   634         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   635             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   636             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   637             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   638             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   639             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   640             20  FILLER                    PIC XX.                ERCACCT
   641         16  FILLER                        PIC X(80).             ERCACCT
   642                                                                  ERCACCT
   643     12  AM-TRANSFER-DATA.                                        ERCACCT
   644         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   645             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   646             20  AM-TRNFROM-GROUPING.                             ERCACCT
   647                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   648                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   649             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   650             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   651                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   652                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   653             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   654         16  AM-TRANSFERRED-TO.                                   ERCACCT
   655             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   656             20  AM-TRNTO-GROUPING.                               ERCACCT
   657                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   658                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   659             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   660             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   661                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   662                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   663             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   664         16  FILLER                        PIC X(10).             ERCACCT
   665                                                                  ERCACCT
   666     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   667                                                                  ERCACCT
   668     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   669         16  AM-DEFN-1-SAVED.                                     ERCACCT
   670             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   671                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   672                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   673                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   674                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   675                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   676                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   677                 24  FILLER                PIC X.                 ERCACCT
   678                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   679                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   680                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   681         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   682             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   683                 24  FILLER                PIC X(11).             ERCACCT
   684                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   685                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   686                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   687                 24  FILLER                PIC X(6).              ERCACCT
   688                                                                  ERCACCT
   689     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   690         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   691            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   692            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   693            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   694                                                                  ERCACCT
   695     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   696     12  FILLER                            PIC X(120).            ERCACCT
   697                                                                  ERCACCT
   698     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   699         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   700         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   701             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   702             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   703                                                          COMP-3. ERCACCT
   704             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   705                                                          COMP-3. ERCACCT
   706         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   707             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   708             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   709                                                          COMP-3. ERCACCT
   710             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   711                                                          COMP-3. ERCACCT
   712                                                                  ERCACCT
   713     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   714         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   715         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   716         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   717         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   718             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   719                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   720                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   721             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   722                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   723                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   724             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   725                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   726                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   727         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   728             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   729                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   730                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   731                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   732             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   733                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   734                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   735             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   736                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   737                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   738                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCACCT)
   739     12  AM-COMMENTS.                                             ERCACCT
   740         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   741                                                                  ERCACCT
   742     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   743         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   744         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   745         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   746         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   747         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   748             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   749             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   750             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   751             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   752         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   753             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   754             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   755             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   756         16  FILLER                        PIC X(102).            ERCACCT
   757                                                                  ERCACCT
   758     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   759         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   760             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   761             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   762             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   763             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   764             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   765         16  FILLER                          PIC X(10).           ERCACCT
   766******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS010V.cbl
   768 FD  ERRTBL-IN.
   769
*  770                             COPY ERCREIN.
   771******************************************************************07/27/93
   772*                                                                *ERCREIN
   773*                            ERCREIN                             *   LV009
   774*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   775*                            VMOD=2.010                          *   CL**9
   776*                                                                *ERCREIN
   777*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   778*                                                                *ERCREIN
   779*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   780*                                                                *ERCREIN
   781*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   782*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   783*                                                                *ERCREIN
   784*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   785*       ALTERNATE PATH = NONE                                    *ERCREIN
   786*                                                                *ERCREIN
   787*   LOG = NO                                                     *ERCREIN
   788*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   789*                                                                *ERCREIN
   790******************************************************************ERCREIN
   791*                   C H A N G E   L O G
   792*
   793* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   794*-----------------------------------------------------------------
   795*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   796* EFFECTIVE    NUMBER
   797*-----------------------------------------------------------------
   798* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   799* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   800******************************************************************
   801 01  REINSURANCE-RECORD.                                          ERCREIN
   802     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   803         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   804                                                                  ERCREIN
   805     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   806         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   807         16  RE-KEY.                                              ERCREIN
   808             20  RE-CODE                   PIC X.                 ERCREIN
   809                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   810                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   811             20  RE-TABLE                  PIC XXX.               ERCREIN
   812             20  FILLER                    PIC XXX.               ERCREIN
   813         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   814             20  FILLER                    PIC X.                 ERCREIN
   815             20  RE-COMPANY.                                      ERCREIN
   816                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   817                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   818                                                                  ERCREIN
   819     12  RE-MAINT-INFORMATION.                                    ERCREIN
   820         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   821         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   822         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   823         16  FILLER                        PIC X(10).             ERCREIN
   824                                                                  ERCREIN
   825     12  RE-TABLE-DATA.                                           ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCREIN)
   826         16  RE-100-COMP                   PIC 99.                ERCREIN
   827                                                                  ERCREIN
   828         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   829             20  RE-REI-COMP-NO.                                  ERCREIN
   830                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   831                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   832             20  RE-LF-QC                  PIC X.                 ERCREIN
   833             20  RE-AH-QC                  PIC X.                 ERCREIN
   834             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   835             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   836             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   837             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   838             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   839             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   840             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   841             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   842             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   843             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   844             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   845             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   846             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   847             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   848             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   849             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   850             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   851             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   852             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   853             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   854             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   855             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   856             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   857             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   858             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   859             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   860             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   861             20  RE-REMAINING              PIC X.                 ERCREIN
   862             20  RE-LF-RUNOFF-SW           PIC X.                      000
   863             20  RE-AH-RUNOFF-SW           PIC X.                      000
   864             20  FILLER                    PIC X(19).                  000
   865                                                                  ERCREIN
   866         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   867         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   868         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   869         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   870             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   871                                                                  ERCREIN
   872         16  FILLER                        PIC X(27).             ERCREIN
   873                                                                  ERCREIN
   874     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   875         16  RE-NAME                       PIC X(30).             ERCREIN
   876         16  RE-LF-PE                      PIC X.                 ERCREIN
   877         16  RE-AH-PE                      PIC X.                 ERCREIN
   878         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   879         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   880         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   881         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   882         16  RE-PRT-ST                     PIC X.                 ERCREIN
   883         16  RE-PRT-OW                     PIC X.                 ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCREIN)
   884         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
   885         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   886         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   887         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   888         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   889         16  RE-LF-COMM                    PIC X.                 ERCREIN
   890         16  RE-AH-COMM                    PIC X.                 ERCREIN
   891         16  RE-LF-TAX                     PIC X.                 ERCREIN
   892         16  RE-AH-TAX                     PIC X.                 ERCREIN
   893         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   894         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   895         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   896                                                                  ERCREIN
   897         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   898             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   899                                                                  ERCREIN
   900         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   901             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   902                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   903                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   904                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   905                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   906             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   907                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   908                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   909                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   910                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   911                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   912                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   913                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   914                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   915             20  FILLER                    PIC XXX.               ERCREIN
   916             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   917                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   918                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   919                                                                  ERCREIN
   920         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   921             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   922                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   923                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   924                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   925                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   926             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   927                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   928                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   929                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   930                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   931                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   932                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   933                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   934                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   935             20  FILLER                    PIC XXX.               ERCREIN
   936             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   937                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   938                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   939                                                                  ERCREIN
   940         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   941                                                                  ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCREIN)
   942         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
   943                                                                  ERCREIN
   944         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   945         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   946         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   947         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   948         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   949         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   950         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   951         16  RE-MORT-SW                    PIC X.                 ERCREIN
   952         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   953             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   954             88  RE-CEDED                          VALUE 'C'.        CL**2
   955             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   956             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   957                                                                  ERCREIN
   958         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   959             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   960         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   961             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   962         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   963             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   964         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   965             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   966         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   967             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   968                                                                     CL**3
   969         16  RE-PRT-CRSV                   PIC X.                    CL**5
   970                                                                     CL**5
   971         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   972                                                                     CL**8
   973         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   974                                                                     CL**8
   975         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   976                                                                     CL**9
   977         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   978             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   979             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   980
   981         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   982             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   983                                                                     CL**9
   984         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   985         16  FILLER                        PIC X(2281).              CL**9
   986                                                                  ERCREIN
   987         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   988                                                                  ERCREIN
   989******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS010V.cbl
   991 FD  ERCTBL.
   992
*  993                             COPY ERCCTBL.
   994******************************************************************04/29/98
   995*                                                                *ERCCTBL
   996*                                                                *ERCCTBL
   997*                            ERCCTBL                             *   LV002
   998*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   999*                            VMOD=2.003                              CL**2
  1000*                                                                *ERCCTBL
  1001*   ONLINE CREDIT SYSTEM                                         *ERCCTBL
  1002*                                                                *ERCCTBL
  1003*   FILE DESCRIPTION = COMPENSATION TABLE                        *ERCCTBL
  1004*                                                                *ERCCTBL
  1005*   FILE TYPE = VSAM,KSDS                                        *ERCCTBL
  1006*   RECORD SIZE = 200   RECFORM = FIXED                          *ERCCTBL
  1007*                                                                *ERCCTBL
  1008*   BASE CLUSTER NAME = ERCTBL                   RKP=2,LEN=7     *ERCCTBL
  1009*       ALTERNATE PATH = NONE                                    *ERCCTBL
  1010*                                                                *ERCCTBL
  1011*   LOG = NO                                                     *ERCCTBL
  1012*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCTBL
  1013*                                                                *ERCCTBL
  1014*                                                                *ERCCTBL
  1015******************************************************************ERCCTBL
  1016                                                                  ERCCTBL
  1017 01  COMM-TABLE-RECORD.                                           ERCCTBL
  1018     12  CT-RECORD-ID                      PIC XX.                ERCCTBL
  1019         88  VALID-CT-ID                      VALUE 'CT'.         ERCCTBL
  1020                                                                  ERCCTBL
  1021     12  CT-CONTROL-PRIMARY.                                      ERCCTBL
  1022         16  CT-COMPANY-CD                 PIC X.                 ERCCTBL
  1023         16  CT-TABLE                      PIC XXX.               ERCCTBL
  1024         16  CT-CNTRL-2.                                          ERCCTBL
  1025             20  CT-BEN-TYPE               PIC X.                 ERCCTBL
  1026             20  CT-BEN-CODE               PIC XX.                ERCCTBL
  1027                                                                  ERCCTBL
  1028     12  CT-MAINT-INFORMATION.                                    ERCCTBL
  1029         16  CT-LAST-MAINT-DT              PIC XX.                ERCCTBL
  1030         16  CT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCCTBL
  1031         16  CT-LAST-MAINT-USER            PIC X(4).              ERCCTBL
  1032         16  FILLER                        PIC X(31).             ERCCTBL
  1033                                                                  ERCCTBL
  1034     12  CT-LIMITS.                                               ERCCTBL
  1035         16  CT-TBF OCCURS 3 TIMES         PIC S9(7)V99   COMP-3. ERCCTBL
  1036                                                                  ERCCTBL
  1037         16  CT-AGE OCCURS 3 TIMES         PIC S99        COMP-3. ERCCTBL
  1038                                                                  ERCCTBL
  1039         16  CT-TRM OCCURS 3 TIMES         PIC S999       COMP-3. ERCCTBL
  1040                                                                  ERCCTBL
  1041     12  CT-RATES.                                                ERCCTBL
  1042         16  CT-RTX          OCCURS 27 TIMES.                     ERCCTBL
  1043             20  CT-RT                     PIC SV9(5)     COMP-3. ERCCTBL
  1044             20  CT-RT-R   REDEFINES                              ERCCTBL
  1045                 CT-RT                     PIC XXX.               ERCCTBL
  1046                                                                  ERCCTBL
  1047     12  FILLER                            PIC  X(42).            ERCCTBL
  1048                                                                  ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS010V.cbl
  1049******************************************************************ERCCTBL
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS010V.cbl
  1051 FD  ERMEBL-INOUT.
  1052
* 1053                             COPY ERCMEBL.
  1054******************************************************************
  1055*
  1056*
  1057*                            ERCMEBL                             *
  1058*                                                                *
  1059*    FILE DESCRIPTION = REPOSITORY FOR MONTH-END BALANCES FROM   *
  1060*                       SEVERAL PROGRAMS (IDENTIFIED IN BYTES    *
  1061*                       4-6 OF THE FIELD NAMES) AND BY EL541     *
  1062*                       FOR REPORTING DISCREPANCIES AND RUN TIME.*
  1063*                                                                *
  1064*    FILE TYPE = VSAM, KSDS                                      *
  1065*    RECORD SIZE = 765       RECFORM = FIXED                     *
  1066*                                                                *
  1067*    BASE CLUSTER = ERMEBL         KEY SIZE  =  5                *
  1068*    ALTERNATE PATHS = NONE        STARTING IN  3                *
  1069*                                                                *
  1070******************************************************************
  1071
  1072******************************************************************
  1073*                   C H A N G E   L O G
  1074*
  1075* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1076*-----------------------------------------------------------------
  1077*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1078* EFFECTIVE    NUMBER
  1079*-----------------------------------------------------------------
  1080* 070714  CR2013060600001  PEMA  AUTOMATE EOM BALANCING
  1081******************************************************************
  1082 01  MONTH-END-BALANCES.
  1083     12  ME-RECORD-ID            PIC  XX.
  1084     12  ME-CONTROL-PRIMARY.
  1085         16  ME-COMPANY          PIC  XXX.
  1086         16  ME-MOYR             PIC  9999       COMP.
  1087     12  ME-010-PREM-L           PIC S9(9)V99    COMP-3.
  1088     12  ME-010-PREM-AH          PIC S9(9)V99    COMP-3.
  1089     12  ME-010-REF-L            PIC S9(9)V99    COMP-3.
  1090     12  ME-010-REF-AH           PIC S9(9)V99    COMP-3.
  1091     12  ME-010-NET-L            PIC S9(9)V99    COMP-3.
  1092     12  ME-010-NET-AH           PIC S9(9)V99    COMP-3.
  1093     12  ME-010-COMM-L           PIC S9(9)V99    COMP-3.
  1094     12  ME-010-COMM-AH          PIC S9(9)V99    COMP-3.
  1095     12  ME-010-PMT-L            PIC S9(9)V99    COMP-3.
  1096     12  ME-010-PMT-AH           PIC S9(9)V99    COMP-3.
  1097     12  ME-010-CERT-IN          PIC S9(7)       COMP-3.
  1098     12  ME-010-CERT-OUT         PIC S9(7)       COMP-3.
  1099     12  ME-010-DUP-ISS          PIC S9(7)       COMP-3.
  1100     12  ME-010-RUN-DT           PIC  9(6)       COMP-3.
  1101*    12  ME-010-START            PIC  9(6)       COMP-3.
  1102*    12  ME-010-END              PIC  9(6)       COMP-3.
  1103     12  ME-010-RUN-CT           PIC S9(3)       COMP-3.
  1104     12  ME-018-COMM-Y           PIC S9(9)V99    COMP-3.
  1105     12  ME-018-COMM-1           PIC S9(9)V99    COMP-3.
  1106     12  ME-018-OW-Y             PIC S9(9)V99    COMP-3.
  1107     12  ME-018-OW-1             PIC S9(9)V99    COMP-3.
  1108     12  ME-018-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1109*    12  ME-018-START            PIC  9(6)       COMP-3.
  1110*    12  ME-018-END              PIC  9(6)       COMP-3.
  1111     12  ME-018-RUN-CT           PIC S9(3)       COMP-3.
  1112     12  ME-019-PREM-L           PIC S9(9)V99    COMP-3.
  1113     12  ME-019-PREM-AH          PIC S9(9)V99    COMP-3.
  1114     12  ME-019-REF-L            PIC S9(9)V99    COMP-3.
  1115     12  ME-019-REF-AH           PIC S9(9)V99    COMP-3.
  1116     12  ME-019-COMM-L           PIC S9(9)V99    COMP-3.
  1117     12  ME-019-COMM-AH          PIC S9(9)V99    COMP-3.
  1118     12  ME-019-OR-L             PIC S9(9)V99    COMP-3.
  1119     12  ME-019-OR-AH            PIC S9(9)V99    COMP-3.
  1120     12  ME-019-RUN-DT           PIC  9(6)       COMP-3.
  1121*    12  ME-019-START            PIC  9(6)       COMP-3.
  1122*    12  ME-019-END              PIC  9(6)       COMP-3.
  1123     12  ME-019-RUN-CT           PIC S9(3)       COMP-3.
  1124     12  ME-030-CLMS-L           PIC S9(9)V99    COMP-3.
  1125     12  ME-030-CLMS-AH          PIC S9(9)V99    COMP-3.
  1126     12  ME-030-RUN-DT           PIC  9(6)       COMP-3.
  1127*    12  ME-030-START            PIC  9(6)       COMP-3.
  1128*    12  ME-030-END              PIC  9(6)       COMP-3.
  1129     12  ME-030-RUN-CT           PIC S9(3)       COMP-3.
  1130     12  ME-032-RESV-L           PIC S9(9)V99    COMP-3.
  1131     12  ME-032-RESV-AH          PIC S9(9)V99    COMP-3.
  1132     12  ME-032-RUN-DT           PIC  9(6)       COMP-3.
  1133*    12  ME-032-START            PIC  9(6)       COMP-3.
  1134*    12  ME-032-END              PIC  9(6)       COMP-3.
  1135     12  ME-032-RUN-CT           PIC S9(3)       COMP-3.
  1136     12  ME-035-NET-L            PIC S9(9)V99    COMP-3.
  1137     12  ME-035-NET-AH           PIC S9(9)V99    COMP-3.
  1138     12  ME-035-RUN-DT           PIC S9(6)       COMP-3.
  1139*    12  ME-035-START            PIC S9(6)       COMP-3.
  1140*    12  ME-035-END              PIC S9(6)       COMP-3.
  1141     12  ME-035-RUN-CT           PIC S9(3)       COMP-3.
  1142     12  ME-038-RECS-IN          PIC S9(7)       COMP-3.
  1143     12  ME-038-RECS-OUT         PIC S9(7)       COMP-3.
  1144     12  ME-038-RUN-DT           PIC  9(6)       COMP-3.
  1145*    12  ME-038-START            PIC  9(6)       COMP-3.
  1146*    12  ME-038-END              PIC  9(6)       COMP-3.
  1147     12  ME-038-RUN-CT           PIC S9(3)       COMP-3.
  1148     12  ME-041-RETROS           PIC S9(9)V99    COMP-3.
  1149     12  ME-041-RUN-DT           PIC  9(6)       COMP-3.
  1150*    12  ME-041-START            PIC  9(6)       COMP-3.
  1151*    12  ME-041-END              PIC  9(6)       COMP-3.
  1152     12  ME-041-RUN-CT           PIC S9(3)       COMP-3.
  1153     12  ME-050-CERT-IN          PIC S9(7)       COMP-3.
  1154     12  ME-050-CERT-OUT         PIC S9(7)       COMP-3.
  1155*    12  ME-050-START            PIC  9(6)       COMP-3.
  1156     12  ME-050-RUN-DT           PIC  9(6)       COMP-3.
  1157*    12  ME-050-END              PIC  9(6)       COMP-3.
  1158     12  ME-050-RUN-CT           PIC S9(3)       COMP-3.
  1159     12  ME-061-PREM             PIC S9(9)V99    COMP-3.
  1160     12  ME-061-COMM             PIC S9(9)V99    COMP-3.
  1161     12  ME-061-OR               PIC S9(9)V99    COMP-3.
  1162     12  ME-061-PY-ADJ           PIC S9(9)V99    COMP-3.
  1163     12  ME-061-COMM-RCALC       PIC S9(9)V99    COMP-3.
  1164     12  ME-061-OR-RCALC         PIC S9(9)V99    COMP-3.
  1165     12  ME-061-PREM-RCALC       PIC S9(9)V99    COMP-3.
  1166     12  ME-061-RUN-DT           PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1167*    12  ME-061-START            PIC  9(6)       COMP-3.
  1168*    12  ME-061-END              PIC  9(6)       COMP-3.
  1169     12  ME-061-RUN-CT           PIC S9(3)       COMP-3.
  1170     12  ME-080-MORT-ERRS        PIC  9(7)       COMP-3.
  1171     12  ME-080-RUN-DT           PIC  9(6)       COMP-3.
  1172*    12  ME-080-START            PIC  9(6)       COMP-3.
  1173*    12  ME-080-END              PIC  9(6)       COMP-3.
  1174     12  ME-080-RUN-CT           PIC S9(3)       COMP-3.
  1175     12  ME-315-RESV-L           PIC S9(9)V99    COMP-3.
  1176     12  ME-315-RESV-AH          PIC S9(9)V99    COMP-3.
  1177     12  ME-315-RUN-DT           PIC  9(6)       COMP-3.
  1178*    12  ME-315-START            PIC  9(6)       COMP-3.
  1179*    12  ME-315-END              PIC  9(6)       COMP-3.
  1180     12  ME-315-RUN-CT           PIC S9(3)       COMP-3.
  1181     12  ME-331-FLAG             PIC  9.
  1182     12  ME-331-RUN-DT           PIC  9(6)       COMP-3.
  1183*    12  ME-331-START            PIC  9(6)       COMP-3.
  1184*    12  ME-331-END              PIC  9(6)       COMP-3.
  1185     12  ME-331-RUN-CT           PIC S9(3)       COMP-3.
  1186     12  ME-341-NOT-FOUND        PIC S9(7)       COMP-3.
  1187     12  ME-341-RUN-DT           PIC  9(6)       COMP-3.
  1188*    12  ME-341-START            PIC  9(6)       COMP-3.
  1189*    12  ME-341-END              PIC  9(6)       COMP-3.
  1190     12  ME-341-RUN-CT           PIC S9(3)       COMP-3.
  1191     12  ME-501-FLAG             PIC  9.
  1192     12  ME-501-RUN-DT           PIC  9(6)       COMP-3.
  1193     12  ME-501-START            PIC  9(6)       COMP-3.
  1194     12  ME-501-END              PIC  9(6)       COMP-3.
  1195     12  ME-501-RUN-CT           PIC S9(3)       COMP-3.
  1196     12  ME-509-FLAG             PIC  9.
  1197     12  ME-509-RUN-DT           PIC  9(6)       COMP-3.
  1198     12  ME-509-START            PIC  9(6)       COMP-3.
  1199     12  ME-509-END              PIC  9(6)       COMP-3.
  1200     12  ME-509-RUN-CT           PIC S9(3)       COMP-3.
  1201     12  ME-522-PY-ADJ           PIC S9(9)V99    COMP-3.
  1202     12  ME-522-RETROS           PIC S9(9)V99    COMP-3.
  1203     12  ME-522-PROC-CLM-L       PIC S9(9)V99    COMP-3.
  1204     12  ME-522-PROC-CLM-AH      PIC S9(9)V99    COMP-3.
  1205     12  ME-522-ALL-CLM-L        PIC S9(9)V99    COMP-3.
  1206     12  ME-522-ALL-CLM-AH       PIC S9(9)V99    COMP-3.
  1207     12  ME-522-PROC-RSV-L       PIC S9(9)V99    COMP-3.
  1208     12  ME-522-PROC-RSV-AH      PIC S9(9)V99    COMP-3.
  1209     12  ME-522-ALL-RSV-L        PIC S9(9)V99    COMP-3.
  1210     12  ME-522-ALL-RSV-AH       PIC S9(9)V99    COMP-3.
  1211     12  ME-522-PREM-L           PIC S9(9)V99    COMP-3.
  1212     12  ME-522-PREM-AH          PIC S9(9)V99    COMP-3.
  1213     12  ME-522-REF-L            PIC S9(9)V99    COMP-3.
  1214     12  ME-522-REF-AH           PIC S9(9)V99    COMP-3.
  1215     12  ME-522-RUN-DT           PIC  9(6)       COMP-3.
  1216     12  ME-522-START            PIC  9(6)       COMP-3.
  1217     12  ME-522-END              PIC  9(6)       COMP-3.
  1218     12  ME-522-RUN-CT           PIC S9(3)       COMP-3.
  1219     12  ME-524-CLMS-L           PIC S9(9)V99    COMP-3.
  1220     12  ME-524-CLMS-AH          PIC S9(9)V99    COMP-3.
  1221     12  ME-524-RESV-L           PIC S9(9)V99    COMP-3.
  1222     12  ME-524-RESV-AH          PIC S9(9)V99    COMP-3.
  1223     12  ME-524-RUN-DT           PIC  9(6)       COMP-3.
  1224     12  ME-524-START            PIC  9(6)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCMEBL)
  1225     12  ME-524-END              PIC  9(6)       COMP-3.
  1226     12  ME-524-RUN-CT           PIC S9(3)       COMP-3.
  1227     12  ME-525-FLAG             PIC  9.
  1228     12  ME-525-RUN-DT           PIC  9(6)       COMP-3.
  1229     12  ME-525-START            PIC  9(6)       COMP-3.
  1230     12  ME-525-END              PIC  9(6)       COMP-3.
  1231     12  ME-525-RUN-CT           PIC S9(3)       COMP-3.
  1232     12  ME-048-RECS-IN          PIC S9(7)       COMP-3.
  1233     12  ME-048-RECS-OUT         PIC S9(7)       COMP-3.
  1234     12  ME-048-RUN-DT           PIC  9(6)       COMP-3.
  1235     12  ME-048-START            PIC  9(6)       COMP-3.
  1236     12  ME-048-END              PIC  9(6)       COMP-3.
  1237     12  ME-048-RUN-CT           PIC S9(3)       COMP-3.
  1238     12  ME-041-REIN-ADJ         PIC S9(9)V99    COMP-3.
  1239
  1240     12  ME-019-CLMS-L           PIC S9(9)V99    COMP-3.
  1241     12  ME-019-CLMS-AH          PIC S9(9)V99    COMP-3.
  1242     12  ME-035-COMM-TOT         PIC S9(9)V99    COMP-3.
  1243     12  ME-035-CLMS-L           PIC S9(9)V99    COMP-3.
  1244     12  ME-035-CLMS-AH          PIC S9(9)V99    COMP-3.
  1245     12  ME-041-RECS-IN          PIC S9(9)       COMP-3.
  1246     12  ME-041-RECS-OUT         PIC S9(9)       COMP-3.
  1247     12  ME-050-ACT-L            PIC S9(7)       COMP-3.
  1248     12  ME-050-ACT-AH           PIC S9(7)       COMP-3.
  1249     12  ME-061-CLMS             PIC S9(9)V99    COMP-3.
  1250     12  ME-341-CLMS-L           PIC S9(9)V99    COMP-3.
  1251     12  ME-341-CLMS-AH          PIC S9(9)V99    COMP-3.
  1252     12  ME-515-CLMS-WRAP        PIC S9(7)V99    COMP-3.
  1253     12  ME-515-RESV-WRAP        PIC S9(7)V99    COMP-3.
  1254     12  ME-317-CLMS-TOT         PIC S9(9)V99    comp-3.
  1255     12  ME-325-CLMS-TOT         PIC S9(9)V99    comp-3.
  1256     12  ME-020-PREM-TOT         PIC S9(11)V99   COMP-3.
  1257     12  ME-020-CLMS-TOT         PIC S9(9)V99    COMP-3.
  1258     12  ME-020-RESV-TOT         PIC S9(9)V99    COMP-3.
  1259     12  ME-063-OW               PIC S9(9)V99    COMP-3.
  1260     12  ME-082-ACT-L            PIC S9(7)       COMP-3.
  1261     12  ME-082-ACT-AH           PIC S9(7)       COMP-3.
  1262     12  ME-016-RECS-IN          PIC S9(9)       COMP-3.
  1263     12  ME-016-RECS-OUT         PIC S9(9)       COMP-3.
  1264     12  ME-562-PREM-TOT         PIC S9(9)V99    COMP-3.
  1265     12  ME-562-COMM-TOT         PIC S9(9)V99    COMP-3.
  1266     12  ME-524-CLMS-TOT-CM      PIC S9(9)V99    comp-3.
  1267     12  ME-523-PREM-TOT         PIC S9(9)V99    COMP-3.
  1268     12  ME-064-BEG-BAL          PIC S9(9)V99    COMP-3.
  1269     12  ME-064-END-BAL          PIC S9(9)V99    COMP-3.
  1270     12  ME-010-MM-PREM-TOT      PIC S9(9)V99    COMP-3.
  1271     12  ME-010-MM-TOT-CLMS      PIC S9(9)V99    COMP-3.
  1272     12  ME-010-MM-TOT-RESV      PIC S9(9)V99    COMP-3.
  1273     12  ME-080-MORT-RESV        PIC S9(9)V99    COMP-3.
  1274
  1275     12  FILLER                  PIC  X(09).
  1276*    12  FILLER                  PIC  X(88).
  1277******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS010V.cbl
  1279 FD  CERT-MASTER-OUT
* 1280                             COPY ECSCROFD.
  1281******************************************************************07/10/97
  1282*                                                                *ECSCROFD
  1283*                            ECSCROFD                            *   LV001
  1284*                            VMOD=2.002                          *ECSCROFD
  1285*                                                                *ECSCROFD
  1286*  NO CID MODS IN COPYBOOK ECSCROFD.                             *ECSCROFD
  1287*                                                                *ECSCROFD
  1288******************************************************************ECSCROFD
  1289     RECORDING MODE F                                             ECSCROFD
  1290     LABEL RECORDS STANDARD                                       ECSCROFD
  1291     BLOCK CONTAINS 0 RECORDS
  1292     RECORD CONTAINS 1056 CHARACTERS.                             ECSCROFD
  1293 01  CERT-OUT-RECORD.                                             ECSCROFD
  1294     12  FILLER                            PIC  XXX.              ECSCROFD
  1295     12  COR-CONTROL                       PIC  X(36).            ECSCROFD
  1296     12  FILLER                            PIC  X(1017).          ECSCROFD
  1297                                                                  ECSCROFD
  1298******************************************************************ECSCROFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS010V.cbl
  1300 FD  DETAIL-EXTR
  1301     BLOCK CONTAINS 0 RECORDS
  1302     RECORDING MODE F.
  1303
* 1304                             COPY ECSEXT01.
  1305******************************************************************04/29/98
  1306*                                                                *ECSEXT01
  1307*                            ECSEXT01                            *   LV015
  1308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  1309*                            VMOD=2.015                          *ECSEXT01
  1310*                                                                *ECSEXT01
  1311*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
  1312*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
  1313*                                                                *ECSEXT01
  1314*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
  1315*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
  1316*                                                                *ECSEXT01
  1317*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
  1318*                                                                *ECSEXT01
  1319******************************************************************ECSEXT01
  1320******************************************************************
  1321*                   C H A N G E   L O G
  1322*
  1323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1324*-----------------------------------------------------------------
  1325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1326* EFFECTIVE    NUMBER
  1327*-----------------------------------------------------------------
  1328* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1329* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
  1330* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1331* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1332* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
  1333* 032612  CR2011110200001  PEMA  AHL CHANGES
  1334******************************************************************
  1335                                                                  ECSEXT01
  1336 01  DETAIL-EXTRACT.                                              ECSEXT01
  1337     02 DETAIL-FILE.                                              ECSEXT01
  1338     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
  1339         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
  1340                                                                  ECSEXT01
  1341     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
  1342                                                                  ECSEXT01
  1343     12  DE-REIN                           PIC X.                 ECSEXT01
  1344                                                                  ECSEXT01
  1345     12  DE-CONTROL.                                              ECSEXT01
  1346         16  DE-CNTRL1.                                           ECSEXT01
  1347             20  DE-CARRIER                PIC X.                 ECSEXT01
  1348             20  DE-GROUPING.                                     ECSEXT01
  1349                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
  1350                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
  1351             20  DE-STATE                  PIC XX.                ECSEXT01
  1352             20  DE-ACCOUNT.                                      ECSEXT01
  1353                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
  1354                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
  1355         16  DE-CNTRL2.                                           ECSEXT01
  1356             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
  1357             20  DE-CERT.                                         ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1358                 24 DE-CERT-NO.                                   ECSEXT01
  1359                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
  1360                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
  1361                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
  1362                                                                  ECSEXT01
  1363     12  DE-TRANS                          PIC X.                 ECSEXT01
  1364         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
  1365         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
  1366         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
  1367         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
  1368         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
  1369         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
  1370         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
  1371         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
  1372         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
  1373         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
  1374                                                                  ECSEXT01
  1375     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
  1376     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
  1377                                                                  ECSEXT01
  1378     12  DE-NAME.                                                 ECSEXT01
  1379         16  DE-LNAME                      PIC X(15).             ECSEXT01
  1380         16  DE-FNAME.                                            ECSEXT01
  1381             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
  1382             20  FILLER                    PIC X(9).              ECSEXT01
  1383         16  DE-INIT                       PIC X.                 ECSEXT01
  1384     12  DE-AGE                            PIC 99.                ECSEXT01
  1385     12  DE-SEX                            PIC X.                 ECSEXT01
  1386     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
  1387                                                                  ECSEXT01
  1388     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
  1389     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
  1390     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
  1391     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
  1392     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1393     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
  1394     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
  1395     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
  1396     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1397                                                                  ECSEXT01
  1398     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
  1399     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
  1400     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
  1401     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
  1402                                                                  ECSEXT01
  1403     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
  1404     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
  1405     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
  1406     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
  1407     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
  1408                                                                  ECSEXT01
  1409     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
  1410     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
  1411     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1412     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
  1413                                                                  ECSEXT01
  1414     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
  1415     12  DE-ADDL-CLP REDEFINES DE-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1416                                           PIC S9(5)V99   COMP-3.
  1417     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
  1418     12  FILLER REDEFINES DE-NUM-BILLED.
  1419         16  DE-CLP-STATE                  PIC XX.
  1420         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
  1421     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
  1422     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
  1423                                                                  ECSEXT01
  1424     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
  1425     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
  1426     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
  1427     12  DE-IG                             PIC X.                 ECSEXT01
  1428     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
  1429*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
  1430     12  DE-MEMBER-NO.                                            ECSEXT01
  1431         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
  1432         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
  1433         16  FILLER                        PIC X(03).             ECSEXT01
  1434     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
  1435                                                                  ECSEXT01
  1436     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
  1437         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
  1438                                                                  ECSEXT01
  1439     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
  1440     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
  1441                                                                  ECSEXT01
  1442     12  DE-REI-AREA.                                             ECSEXT01
  1443         16  DE-REI-COMP.                                         ECSEXT01
  1444             20  DE-REINCO                 PIC XXX.               ECSEXT01
  1445             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
  1446         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1447         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1448         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1449         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
  1450         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
  1451         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
  1452         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1453                                                                  ECSEXT01
  1454     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1455     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
  1456         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
  1457         16  F                             PIC X.
  1458*    12  FILLER                            PIC X(5).              ECSEXT01
  1459                                                                  ECSEXT01
  1460     12  DE-BILLED-AREA.                                          ECSEXT01
  1461         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
  1462             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
  1463                                                                  ECSEXT01
  1464         16  DE-BILL-SW                    PIC X.                 ECSEXT01
  1465             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
  1466             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
  1467             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
  1468             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
  1469             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
  1470             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
  1471                                                                  ECSEXT01
  1472         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
  1473             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1474                                                                  ECSEXT01
  1475         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1476         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1477         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
  1478         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
  1479                                                                  ECSEXT01
  1480         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
  1481*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
  1482*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
  1483                                                                  ECSEXT01
  1484     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
  1485         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
  1486         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
  1487         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
  1488                                                                  ECSEXT01
  1489     12  DE-REVERSE-REASONS.                                      ECSEXT01
  1490         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
  1491         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
  1492     12  DE-CANCEL-REASON                  PIC X.
  1493                                                                  ECSEXT01
  1494     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
  1495     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
  1496                                                                  ECSEXT01
  1497     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
  1498         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1499             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1500         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
  1501             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
  1502                                                                  ECSEXT01
  1503     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
  1504         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
  1505                                                                  ECSEXT01
  1506     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
  1507     12  FILLER REDEFINES DE-NCL-POOL-CODE.
  1508         16  DE-LOAN-TERM                  PIC S999 COMP-3.
  1509         16  FILLER                        PIC X.
  1510                                                                  ECSEXT01
  1511****************************************************************  ECSEXT01
  1512**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
  1513****************************************************************  ECSEXT01
  1514     12  DE-COMM-LEVELS.                                          ECSEXT01
  1515         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
  1516             20  DE-AGT.                                          ECSEXT01
  1517                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
  1518                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
  1519             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
  1520             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1521             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
  1522                                                                  ECSEXT01
  1523     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
  1524****************************************************************  ECSEXT01
  1525*******                 CLAIM EXTRACT                      *****  ECSEXT01
  1526****************************************************************  ECSEXT01
  1527     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
  1528     12  FILLER                            PIC X(334).            ECSEXT01
  1529     12  DE-TYPE                           PIC X.                 ECSEXT01
  1530         88  DE-DTH                           VALUE '1'.          ECSEXT01
  1531         88  DE-AH                            VALUE '2'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1532         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
  1533         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
  1534         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
  1535         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
  1536                                                                  ECSEXT01
  1537     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
  1538     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
  1539                                                                  ECSEXT01
  1540     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
  1541     12  DE-REPORTED.                                             ECSEXT01
  1542         16  DE-RPT-YR                     PIC 99.                ECSEXT01
  1543         16  DE-RPT-MO                     PIC 99.                ECSEXT01
  1544         16  DE-RPT-DA                     PIC 99.                ECSEXT01
  1545     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
  1546     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
  1547                                                                  ECSEXT01
  1548     12  DE-CNUM                           PIC X(7).              ECSEXT01
  1549     12  DE-CHECK                          PIC X(7).              ECSEXT01
  1550     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
  1551     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
  1552     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
  1553     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
  1554         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
  1555         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
  1556         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
  1557         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
  1558         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
  1559         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
  1560         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
  1561                                                                  ECSEXT01
  1562     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
  1563                                                                  ECSEXT01
  1564     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
  1565     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1566     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
  1567     12  FILLER                            PIC XX.                ECSEXT01
  1568     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
  1569                                                                  ECSEXT01
  1570     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
  1571     12  DE-BENEFICIARY                    PIC X(10).
  1572     12  filler redefines de-beneficiary.
  1573         16  de-birth-date                 pic 9(11)  comp-3.
  1574         16  f                             pic x(4).
  1575     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
  1576     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
  1577     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
  1578     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
  1579     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
  1580     12  DE-CLM-CLASS                      PIC XX.
  1581     12  DE-CLM-DEV                        PIC XXX.
  1582     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
  1583     12  de-xycor-cert-seq                 pic x(3).
  1584     12  DE-XYCOR-CHECK-NO                 PIC X(8).
  1585     12  DE-XYCOR-ACTION-CD                PIC XXX.
  1586     12  DE-XYCOR-STATUS                   PIC X.
  1587     12  FILLER                            PIC X(4).              ECSEXT01
  1588                                                                  ECSEXT01
  1589     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEXT01)
  1590                                                                  ECSEXT01
  1591****************************************************************  ECSEXT01
  1592*******               RESERVE EXTRACT                      *****  ECSEXT01
  1593****************************************************************  ECSEXT01
  1594     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
  1595     12  FILLER                            PIC X(334).            ECSEXT01
  1596                                                                  ECSEXT01
  1597     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
  1598         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
  1599         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
  1600                                                                  ECSEXT01
  1601     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
  1602     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
  1603     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
  1604                                                                  ECSEXT01
  1605     12  DE-CLMNO                          PIC X(7).              ECSEXT01
  1606                                                                  ECSEXT01
  1607     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
  1608     12  DE-RSV-REPORTED.                                         ECSEXT01
  1609         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
  1610         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
  1611         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
  1612     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
  1613                                                                  ECSEXT01
  1614     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
  1615     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
  1616     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
  1617                                                                  ECSEXT01
  1618     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
  1619     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1620     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
  1621                                                                  ECSEXT01
  1622     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
  1623                                                                  ECSEXT01
  1624     12  DE-RATE-CLASS                     PIC XX.
  1625     12  DE-DEV-CODE                       PIC XXX.
  1626     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
  1627     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
  1628     12  FILLER                            PIC X(58).             ECSEXT01
  1629                                                                  ECSEXT01
  1630     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
  1631******************************************************************ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS010V.cbl
  1633 FD  SUMMARY-EXTR
  1634     BLOCK CONTAINS 0 RECORDS
  1635     RECORDING MODE F.
  1636
* 1637                             COPY ECSEPC01.
  1638******************************************************************
  1639*                                                                *
  1640*                            ECSEPC01                            *
  1641*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1642*                            VMOD=2.008                          *
  1643*                                                                *
  1644*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
  1645*                                                                *
  1646*   FILE TYPE = SEQUENTIAL                                       *
  1647*   RECORD SIZE = 325  RECFORM = FIXED                           *
  1648*                                                                *
  1649*   KEY DATA =                                  START=5, LEN=31  *
  1650*                                                                *
  1651*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
  1652*                                                                *
  1653******************************************************************
  1654
  1655 01  EP-RECORD.
  1656     02 EP-FILE.
  1657     12  EP-RECORD-ID                      PIC XX.
  1658         88  VALID-EP-ID                      VALUE 'EP'.
  1659
  1660     12  EP-COMPANY-CD                     PIC X.
  1661
  1662     12  EP-REIN                           PIC X.
  1663         88  EP-REIN-EXTRACT                  VALUE 'R'.
  1664
  1665     12  EP-CONTROL.
  1666         16  EP-CNTRL-1.
  1667             20  EP-COMPANY.
  1668                 24  EP-CARRIER            PIC X.
  1669                 24  EP-GROUPING.
  1670                     28  EP-GROUP-PREFIX   PIC XXX.
  1671                     28  EP-GROUP-PRIME    PIC XXX.
  1672             20  EP-STATE                  PIC XX.
  1673             20  EP-ACCOUNT.
  1674                 24  EP-ACCT-PREFIX        PIC X(4).
  1675                 24  EP-ACCT-PRIME         PIC X(6).
  1676         16  EP-CNTRL-2.
  1677             20  EP-DATES.
  1678                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
  1679                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
  1680
  1681     12  EP-REI-CO.
  1682         16  EP-REINCO                     PIC XXX.
  1683         16  EP-REINCO-SUB                 PIC XXX.
  1684
  1685     12  EP-RCD-TYPE                       PIC X.
  1686         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
  1687         88  EP-BEN-TYPE-AH                   VALUE 'A'.
  1688         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
  1689         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1690         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1691         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
  1692     12  EP-BEN-CODE                       PIC XX.
  1693     12  FILLER                            PIC X.
  1694
  1695     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
  1696     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
  1697     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1698
  1699     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
  1700     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
  1701     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
  1702
  1703     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
  1704     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1705     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
  1706     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
  1707
  1708     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
  1709     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
  1710     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
  1711
  1712     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
  1713     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
  1714     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
  1715
  1716     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
  1717     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
  1718     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
  1719     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
  1720     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
  1721
  1722     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
  1723     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
  1724     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
  1725
  1726     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
  1727     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
  1728     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
  1729
  1730     12  EP-SPECIFIC-OPT-RSV-FIELDS.
  1731         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
  1732         16  EP-NEW-DATA-IND               PIC X(01).
  1733             88  EP-NEW-DATA                   VALUE 'Y'.
  1734         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
  1735         16  FILLER                        PIC X(19).
  1736
  1737     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
  1738     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
  1739     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
  1740
  1741     12  FILLER                            PIC XXX.
  1742
  1743     12  EP-UNDERWRITING-CODE              PIC X.
  1744         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
  1745
  1746     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
  1747
  1748     12  FILLER                            PIC X(29).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1749*    12  FILLER                            PIC X(34).
  1750
  1751     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
  1752     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
  1753     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
  1754     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
  1755     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
  1756     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
  1757
  1758     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
  1759
  1760     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
  1761     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
  1762
  1763     12  EP-PURGE                          PIC X.
  1764         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1765
  1766     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
  1767
  1768     02 EC-RECORD     REDEFINES     EP-FILE.
  1769     12  EC-RECORD-ID                      PIC XX.
  1770         88  VALID-EC-ID                      VALUE 'EC'.
  1771
  1772     12  EC-COMPANY-CD                     PIC X.
  1773
  1774     12  EC-REIN                           PIC X.
  1775         88  EC-REIN-EXTRACT                  VALUE 'R'.
  1776
  1777     12  EC-CONTROL.
  1778         16  EC-CARRIER                    PIC X.
  1779         16  EC-GROUPING.
  1780             20  EC-GROUP-PREFIX           PIC XXX.
  1781             20  EC-GROUP-PRIME            PIC XXX.
  1782         16  EC-STATE                      PIC XX.
  1783         16  EC-ACCOUNT.
  1784             20  EC-ACCT-PREFIX            PIC X(4).
  1785             20  EC-ACCT-PRIME             PIC X(6).
  1786         16  EC-DATES.
  1787             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
  1788             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
  1789
  1790     12  EC-REI-CO.
  1791         16  EC-REINCO                     PIC XXX.
  1792         16  EC-REINCO-SUB                 PIC XXX.
  1793
  1794     12  EC-RCD-TYPE                       PIC X.
  1795         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
  1796         88  EC-BEN-TYPE-AH                   VALUE 'A'.
  1797         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
  1798         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
  1799         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
  1800     12  EC-BEN-CODE                       PIC XX.
  1801     12  EC-SEQ-NBR                        PIC X.
  1802         88  EC-COMP-LEVELS-1-5               VALUE '1'.
  1803         88  EC-COMP-LEVELS-6-10              VALUE '2'.
  1804
  1805     12  EC-AGENTS-DATA.
  1806         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSEPC01)
  1807             20  EC-AGT-NO.
  1808                 24  EC-AGT-PREFIX         PIC X(4).
  1809                 24  EC-AGT-PRIME          PIC X(6).
  1810             20  EC-AGT-TYPE               PIC X.
  1811             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
  1812             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
  1813             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
  1814             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
  1815             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
  1816
  1817     12  EC-UNDERWRITING-CODE              PIC X.
  1818         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
  1819
  1820     12  EC-AGENTS-DATA-II.
  1821         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
  1822             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
  1823             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
  1824
  1825     12  FILLER                            PIC X(7).
  1826
  1827     12  EC-PURGE                          PIC X.
  1828         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
  1829
  1830     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
  1831
  1832******************************************************************
  1833
  1834 FD  ERRESC-IN.
* 1835                             COPY ERCRESC.
  1836******************************************************************04/29/98
  1837*                                                                *ERCRESC
  1838*                            ERCRESC                             *   LV002
  1839*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1840*                            VMOD=2.003                          *   CL**2
  1841*                                                                *ERCRESC
  1842*   FILE DESCRIPTION = ACCOUNT RESIDENT STATE COMMISSION         *ERCRESC
  1843*                                                                *ERCRESC
  1844*   FILE TYPE = VSAM,KSDS                                        *ERCRESC
  1845*   RECORD SIZE = 103 RECFORM = FIXED                            *ERCRESC
  1846*                                                                *ERCRESC
  1847*   BASE CLUSTER NAME = ERRESC                    RKP=00,LEN=37  *ERCRESC
  1848*       ALTERNATE PATH1 = NONE                                   *ERCRESC
  1849*                                                                *ERCRESC
  1850*   LOG = NO                                                     *ERCRESC
  1851*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCRESC
  1852*                                                                *ERCRESC
  1853******************************************************************ERCRESC
  1854                                                                  ERCRESC
  1855 01  ACCOUNT-RESIDENT-ST-COMMISSION.                              ERCRESC
  1856                                                                  ERCRESC
  1857     10  ERRESC-RECORD-KEY.                                       ERCRESC
  1858         15  RESC-COMPANY-CD           PIC   X.                   ERCRESC
  1859         15  RESC-CARRIER              PIC   X.                   ERCRESC
  1860         15  RESC-GROUP                PIC   X(6).                ERCRESC
  1861         15  RESC-STATE                PIC   XX.                  ERCRESC
  1862         15  RESC-ACCOUNT              PIC   X(10).               ERCRESC
  1863         15  RESC-AGENT                PIC   X(10).               ERCRESC
  1864         15  RESC-RESIDENT-STATE       PIC   XX.                  ERCRESC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCRESC)
  1865         15  RESC-EXPIRE-DATE          PIC  9(8) COMP-3.          ERCRESC
  1866*                                           YYYYMMDD              ERCRESC
  1867     10  RESC-EFFECTIVE-DATE           PIC  9(8) COMP-3.          ERCRESC
  1868                                                                  ERCRESC
  1869     10  RESC-COMM-RECORD-DATA.                                   ERCRESC
  1870         15  RESC-COMMISSIONS OCCURS 12 TIMES.                    ERCRESC
  1871             20 RESC-COVERAGE-CAT      PIC    X.                  ERCRESC
  1872             20 RESC-COMMISSION-PER    PIC SV9(5) COMP-3.         ERCRESC
  1873             20 RESC-COMMISSION-TAB REDEFINES                     ERCRESC
  1874                RESC-COMMISSION-PER    PIC  XXX.                  ERCRESC
  1875                                                                  ERCRESC
  1876     10  RESC-MAINT-BY                 PIC X(4).                  ERCRESC
  1877     10  RESC-LST-MAINT-TIME           PIC 9(7)   COMP-3.         ERCRESC
  1878     10  RESC-LST-MAINT-DATE           PIC 9(8)   COMP-3.         ERCRESC
  1879*                                          YYYYMMDD               ERCRESC
  1880 FD  ELCRTT.
  1881
* 1882                             COPY ELCCRTT.
  1883******************************************************************
  1884*                                                                *ELCCRTT
  1885*                            ELCCRTT.                            *
  1886*                                                                *ELCCRTT
  1887*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *ELCCRTT
  1888*                                                                *ELCCRTT
  1889*   FILE TYPE = VSAM,KSDS                                        *ELCCRTT
  1890*   RECORD SIZE = 552  RECFORM = FIXED                           *ELCCRTT
  1891*                                                                *ELCCRTT
  1892*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *ELCCRTT
  1893*                                                                *ELCCRTT
  1894*   LOG = YES                                                    *ELCCRTT
  1895*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ELCCRTT
  1896******************************************************************
  1897*                   C H A N G E   L O G
  1898*
  1899* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1900*-----------------------------------------------------------------
  1901*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1902* EFFECTIVE    NUMBER
  1903*-----------------------------------------------------------------
  1904* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  1905* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE DATA
  1906* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLAIM
  1907* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  1908* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1909* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1910* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1911* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  1912******************************************************************
  1913                                                                  ELCCRTT
  1914 01  CERTIFICATE-TRAILERS.                                        ELCCRTT
  1915     12  CS-RECORD-ID                      PIC XX.                ELCCRTT
  1916         88  VALID-CS-ID                      VALUE 'CS'.         ELCCRTT
  1917                                                                  ELCCRTT
  1918     12  CS-CONTROL-PRIMARY.                                      ELCCRTT
  1919         16  CS-COMPANY-CD                 PIC X.                 ELCCRTT
  1920         16  CS-CARRIER                    PIC X.                 ELCCRTT
  1921         16  CS-GROUPING                   PIC X(6).              ELCCRTT
  1922         16  CS-STATE                      PIC XX.                ELCCRTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1923         16  CS-ACCOUNT                    PIC X(10).
  1924         16  CS-CERT-EFF-DT                PIC XX.                ELCCRTT
  1925         16  CS-CERT-NO.                                          ELCCRTT
  1926             20  CS-CERT-PRIME             PIC X(10).             ELCCRTT
  1927             20  CS-CERT-SFX               PIC X.                 ELCCRTT
  1928         16  CS-TRAILER-TYPE               PIC X.
  1929             88  COMM-TRLR           VALUE 'A'.
  1930             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  1931             88  CERT-DATA-TRLR      VALUE 'C'.
  1932                                                                  ELCCRTT
  1933     12  CS-DATA-AREA                      PIC X(516).
  1934
  1935     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  1936         16  CS-BANK-COMMISSION-AREA.
  1937             20  CS-BANK-COMMS       OCCURS 10.
  1938                 24  CS-AGT                PIC X(10).
  1939                 24  CS-COM-TYP            PIC X.
  1940                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  1941                 24  CS-RECALC-LV-INDIC    PIC X.
  1942                 24  FILLER                PIC X(10).
  1943
  1944         16  FILLER                        PIC X(256).
  1945
  1946     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  1947****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  1948
  1949         16  CS-MB-CLAIM-DATA OCCURS 24.
  1950             20  CS-CLAIM-NO               PIC X(7).
  1951             20  CS-CLAIM-TYPE             PIC X.
  1952                 88  CS-AH-CLM               VALUE 'A'.
  1953                 88  CS-IU-CLM               VALUE 'I'.
  1954                 88  CS-GP-CLM               VALUE 'G'.
  1955                 88  CS-LF-CLM               VALUE 'L'.
  1956                 88  CS-PR-CLM               VALUE 'P'.
  1957                 88  CS-FL-CLM               VALUE 'F'.
  1958             20  CS-INSURED-TYPE           PIC X.
  1959                 88  CS-PRIM-INSURED          VALUE 'P'.
  1960                 88  CS-CO-BORROWER           VALUE 'C'.
  1961             20  CS-BENEFIT-PERIOD         PIC 99.
  1962             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  1963             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  1964             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  1965         16  FILLER                        PIC X(12).
  1966
  1967     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  1968         16  CS-VIN-NUMBER                 PIC X(17).
  1969         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  1970         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  1971         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  1972         16  cs-agent-name.
  1973             20  cs-agent-fname            pic x(20).
  1974             20  cs-agent-mi               pic x.
  1975             20  cs-agent-lname            pic x(25).
  1976         16  cs-license-no                 pic x(15).
  1977         16  cs-npn-number                 pic x(10).
  1978         16  cs-agent-edit-status          pic x.
  1979             88  cs-ae-refer-to-manager      value 'M'.
  1980             88  cs-ae-cover-sheet           value 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTT)
  1981             88  cs-ae-sig-form              value 'S'.
  1982             88  cs-ae-verified              value 'V'.
  1983             88  cs-unidentified-signature   value 'U'.
  1984             88  cs-cert-returned            value 'R'.
  1985             88  cs-accept-no-commission     value 'N'.
  1986         16  FILLER                        PIC X(424).
  1987*        16  FILLER                        PIC X(496).
  1988
  1989 FD  ERAGTC.
  1990
* 1991                             COPY ERCAGTC.
  1992******************************************************************
  1993*                                                                *
  1994*                                                                *
  1995*                            ERCAGTC                             *
  1996*                            VMOD=2.001                          *
  1997*                                                                *
  1998*   ONLINE CREDIT SYSTEM                                         *
  1999*                                                                *
  2000*   FILE DESCRIPTION = AGENT COMMISSIONS                         *
  2001*                                                                *
  2002*   FILE TYPE = VSAM,KSDS                                        *
  2003*   RECORD SIZE = 450   RECFORM = FIXED                          *
  2004*                                                                *
  2005*   BASE CLUSTER NAME = ERAGTC                   RKP=2,LEN=21    *
  2006*       ALTERNATE PATH = NONE                                    *
  2007*                                                                *
  2008*   LOG = NO                                                     *
  2009*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2010*                                                                *
  2011******************************************************************
  2012*                   C H A N G E   L O G
  2013*
  2014* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2015*-----------------------------------------------------------------
  2016*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2017* EFFECTIVE    NUMBER
  2018*-----------------------------------------------------------------
  2019* 111004    2004110300005  PEMA  ADD DISTRIBUTION OF ADDENDUM FEE
  2020* 111004                         NEW FILE AND COPYBOOK
  2021* 092205                   PEMA  ADD PROCESSING FOR SPP LEASE
  2022******************************************************************
  2023
  2024 01  AGENT-COMMISSIONS.
  2025     12  AG-RECORD-ID                          PIC XX.
  2026         88  VALID-CO-ID                          VALUE 'AG'.
  2027
  2028     12  AG-CONTROL-PRIMARY.
  2029         16  AG-COMPANY-CD                     PIC X.
  2030         16  AG-CONTROL.
  2031             20  AG-CTL-1.
  2032                 24  AG-CARR-GROUP.
  2033                     28  AG-CARRIER            PIC X.
  2034                     28  AG-GROUPING           PIC X(6).
  2035                 24  AG-BANK                   PIC X(10).
  2036             20  AG-CTL-2.
  2037                 24  AG-EXP-DT                 PIC XX.
  2038         16  AG-TYPE                           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCAGTC)
  2039             88  AG-GEN-AGENT-TYPE                VALUE 'G'.
  2040             88  AG-ACCOUNT-TYPE                  VALUE 'A'.
  2041
  2042     12  AG-MAINT-INFORMATION.
  2043         16  AG-LAST-MAINT-DT                  PIC XX.
  2044         16  AG-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2045         16  AG-LAST-MAINT-USER                PIC X(4).
  2046         16  FILLER                            PIC X(10).
  2047
  2048     12  AG-EFF-DT                             PIC XX.
  2049     12  AG-COMM-STRUCTURE.
  2050         16  AG-AGT-COMMS OCCURS 10.
  2051             20  AG-AGT                PIC X(10).
  2052             20  AG-COM-TYP            PIC X.
  2053             20  AG-SPP-FEES           PIC S9(5)V99   COMP-3.
  2054             20  AG-RECALC-LV-INDIC    PIC X.
  2055             20  AG-SPP-LFEES          PIC S9(5)V99   COMP-3.
  2056             20  AG-LRCALC-LV-INDIC    PIC X.
  2057             20  FILLER                PIC X(05).
  2058
  2059     12  FILLER                  PIC X(145).
  2060******************************************************************
  2061
  2062 FD  ME-ECS010-BALANCE
  2063     RECORDING MODE IS F
  2064     BLOCK CONTAINS 0 RECORDS.
  2065 01  ME-ECS010-BALANCE-REC    PIC X(83).
  2066
  2067 FD  ME50-ECS010-BALANCE
  2068     RECORDING MODE IS F
  2069     BLOCK CONTAINS 0 RECORDS.
  2070 01  ME50-ECS010-BALANCE-REC  PIC X(95).
  2071
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS010V.cbl
  2073 FD  DISK-DATE
* 2074                             COPY ELCDTEFD.
  2075******************************************************************04/15/98
  2076*                                                                *ELCDTEFD
  2077*                                                                *ELCDTEFD
  2078*                            ELCDTEFD.                           *   LV002
  2079*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2080*                            VMOD=2.007                          *   CL**2
  2081*                                                                *ELCDTEFD
  2082******************************************************************ELCDTEFD
  2083     BLOCK CONTAINS 0 RECORDS
  2084     RECORDING MODE F.                                            ELCDTEFD
  2085                                                                  ELCDTEFD
  2086 01  DATE-DISK.                                                   ELCDTEFD
  2087     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  2088     12  FILLER                      PIC  X(14).                  ELCDTEFD
  2089     12  DD-CR1                      PIC  9.                      ELCDTEFD
  2090     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  2091     12  DD-CR2                      PIC  9.                      ELCDTEFD
  2092     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  2093     12  FILLER                      PIC  X(20).                  ELCDTEFD
  2094                                                                  ELCDTEFD
  2095 01  DATE-DISK-R.                                                 ELCDTEFD
  2096     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2097     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  2098                                     PIC  X(32).                  ELCDTEFD
  2099                                                                  ELCDTEFD
  2100 01  DATE-DISK-T.                                                 ELCDTEFD
  2101     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2102     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  2103                                     PIC  X(48).                  ELCDTEFD
  2104                                                                  ELCDTEFD
  2105 01  DATE-DISK-M.                                                 ELCDTEFD
  2106     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2107     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  2108                                     PIC  X(48).                  ELCDTEFD
  2109                                                                  ELCDTEFD
  2110 01  DATE-DISK-P.                                                 ELCDTEFD
  2111     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  2112     12  DD-IDX                      PIC  99.                     ELCDTEFD
  2113     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  2114     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2115         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  2116                                     PIC  X.                      ELCDTEFD
  2117         16  FILLER                  PIC  X(46).                  ELCDTEFD
  2118     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  2119         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  2120             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  2121             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  2122             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  2123             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  2124         16  FILLER                  PIC  X(16).                  ELCDTEFD
  2125                                                                  ELCDTEFD
  2126 01  DATE-DISK-E.                                                 ELCDTEFD
  2127     12  FILLER                      PIC  X(4).                   ELCDTEFD
  2128     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  2129                                     PIC  X(4).                   ELCDTEFD
  2130                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  2131 01  DATE-DISK-C.                                                 ELCDTEFD
  2132     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2133     12  DD-CARR1-SECPAY-SW          PIC  X.
  2134     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2135     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2136     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2137     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  2138     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  2139     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  2140     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  2141     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  2142     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  2143     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2144     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2145     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  2146     12  DD-CARR2-SECPAY-SW          PIC  X.
  2147     12  FILLER                      PIC  X(7).                   ELCDTEFD
  2148                                                                  ELCDTEFD
  2149 01  DATE-DISK-OPT.                                               ELCDTEFD
  2150     12  FILLER                      PIC  X(04).                  ELCDTEFD
  2151     12  DD-TLR-DATA.                                             ELCDTEFD
  2152         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  2153                                     PIC  X(03).                  ELCDTEFD
  2154     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  2155         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  2156                                     PIC  X(06).                  ELCDTEFD
  2157     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  2158         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  2159                                     PIC  X(07).                  ELCDTEFD
  2160         16  FILLER                  PIC  X(05).                  ELCDTEFD
  2161     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  2162                                     PIC  X(96).                  ELCDTEFD
  2163******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS010V.cbl
  2165 FD  PRINT-COPY
* 2166                             COPY ELCPRTFD.
  2167******************************************************************04/15/98
  2168*                                                                *ELCPRTFD
  2169*                                                                *ELCPRTFD
  2170*                            ELCPRTFD.                           *   LV003
  2171*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2172*                            VMOD=2.006                          *ELCPRTFD
  2173******************************************************************ELCPRTFD
  2174     RECORDING MODE F                                             ELCPRTFD
  2175     LABEL RECORDS OMITTED                                        ELCPRTFD
  2176     BLOCK CONTAINS 0 RECORDS
  2177     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
  2178 01  PRT.                                                         ELCPRTFD
  2179     12  P-CTL               PIC  X.                                 CL**2
  2180     12  P-DATA              PIC  X(132).                         ELCPRTFD
  2181******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS010V.cbl
  2183 FD  MISMATCH-REPORT
  2184     RECORDING MODE F.
  2185
  2186 01  MISMATCH-RPT.
  2187     12  MR-CTL              PIC X.
  2188     12  MR-DATA             PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS010V.cbl
  2190 FD  FICH
* 2191                             COPY ELCFCHFD.
  2192******************************************************************04/15/98
  2193*                                                                *ELCFCHFD
  2194*                            ELCFCHFD.                           *   LV003
  2195*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2196*                            VMOD=2.004                          *   CL**3
  2197*                                                                *ELCFCHFD
  2198******************************************************************ELCFCHFD
  2199     BLOCK CONTAINS 0 RECORDS
  2200     RECORDING MODE F.                                            ELCFCHFD
  2201                                                                  ELCFCHFD
  2202 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  2203******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS010V.cbl
  2205 FD  DISPLAY-PRT
  2206     RECORDING MODE IS F
  2207     LABEL RECORDS ARE STANDARD
  2208     BLOCK CONTAINS 0 RECORDS
  2209     RECORD CONTAINS 133 CHARACTERS.
  2210
  2211 01  DISPLAY-REC.
  2212     05  DISPLAY-CC           PIC X.
  2213     05  DISPLAY-INFO         PIC X(132).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS010V.cbl
  2215 WORKING-STORAGE SECTION.
  2216 77  LCP-ASA                       PIC X.
  2217 77  FILLER  PIC X(32)  VALUE '********************************'.
  2218 77  FILLER  PIC X(32)  VALUE '*     ECS010 WORKING-STORAGE    '.
  2219 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.082 ************'.
  2220
  2221 77  WS-DISP-AMT             PIC Z,ZZZ,ZZZ.99    VALUE ZEROS.
  2222 77  ERROR-COUNT             PIC 9(7)            VALUE ZEROS.
  2223 77  DIS-LINE-CNT            PIC 99              VALUE ZEROS.
  2224 77  PGM-SUB                 PIC S999    COMP    VALUE +010.
  2225 77  FIRST-ACCOUNT           PIC S9      COMP-3  VALUE +1.
  2226 77  FIRST-CERT              PIC S9      COMP-3  VALUE +1.
  2227 77  TR-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2228 77  CMIN-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2229 77  CMOT-CNT                PIC S9(7)   COMP-3  VALUE +0.
  2230 77  DE-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2231 77  EP-CNT                  PIC S9(7)   COMP-3  VALUE +0.
  2232 77  LN-CNT                  PIC S999    COMP-3  VALUE +61.
  2233 77  PG-CNT                  PIC S9(5)   COMP-3  VALUE +0.
  2234 77  DUP-CNT                 PIC S9(5)   COMP-3  VALUE +0.
  2235 77  DISABILITY-TBL-MAX      PIC S9              VALUE +5.
  2236 77  DUP-MAX                 PIC S9(5)   COMP-3  VALUE +500.
  2237 77  RANGE-CNT               PIC S999    COMP-3  VALUE +0.
  2238 77  ERACCTT-READS           PIC S9(7)   COMP-3  VALUE +0.
  2239 77  ERAGTC-READS            PIC S9(7)   COMP-3  VALUE +0.
  2240 77  ELCRTT-READS            PIC S9(7)   COMP-3  VALUE +0.
  2241 77  ERRTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2242 77  ERCTBL-READS            PIC S9(7)   COMP-3  VALUE +0.
  2243 77  FLA-CLM-REIN-BASE       PIC S9(9)V99 COMP-3.
  2244 77  WK-RATE                 PIC S99V9(5) COMP-3 VALUE +0.
  2245 77  COMM-CK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
  2246 77  ADJ-FLA-REIN-BASE       PIC S9(9)V9(4) COMP-3.
  2247 77  ISS-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2248 77  CNC-WK                  PIC S9(9)V99 COMP-3 VALUE +0.
  2249 77  CNC-FACT                PIC S9(3)V9(7) COMP-3 VALUE +0.
  2250 77  COMM-WK                 PIC S9(9)V99 COMP-3 VALUE +0.
  2251 77  X                       PIC X.
  2252 77  DD-FLG                  PIC X               VALUE SPACE.
  2253 77  AGT-SW                  PIC X               VALUE SPACE.
  2254 77  RC-COMM-FLG             PIC X               VALUE SPACE.
  2255 77  RECALC-TYPE             PIC X               VALUE SPACE.
  2256 77  LIFE-REFUND             PIC S9(7)V99        COMP-3.
  2257 77  LIFE-REFUND-CALC        PIC S9(7)V99        COMP-3.
  2258 77  A-H-REFUND              PIC S9(7)V99        COMP-3.
  2259 77  A-H-REFUND-CALC         PIC S9(7)V99        COMP-3.
  2260 77  YTD-CANCEL-CNT          PIC S9(3)           COMP-3.
  2261 77  MISMATCH-COUNT          PIC S9(5)           VALUE +0.
  2262 77  MISMATCH-LINE-COUNT     PIC S9(5)           VALUE +99.
  2263 77  MISMATCH-PAGE-NUMBER    PIC S9(5)           VALUE +0.
  2264 77  SV-HI-CERT              PIC 9(11)           VALUE ZEROS.
  2265 77  SV-LO-CERT              PIC 9(11)           VALUE ZEROS.
  2266 77  LST-TRD-CERT            PIC X(11)           VALUE SPACES.
  2267 77  SV-TRD-CERT             PIC X(11).
  2268 77  LST-TRD-ISDT            PIC X(10)           VALUE SPACES.
  2269 77  SV-TRD-ISDT             PIC X(10).
  2270 77  SAVE-EXTRACT            PIC X(510)          VALUE SPACES.
  2271*77  W-TLR                   PIC S9(01)V9(04) COMP-3 VALUE +.40.
  2272*77  W-AH-FACTOR             PIC S9(01)V9(04) COMP-3 VALUE +.50.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS010V.cbl
  2273 77  W-EPEC-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2274 77  W-EPEC-EP-IN            PIC S9(11)V9(02) COMP-3 VALUE +0.
  2275 77  W-EPEC-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2276 77  W-EPEC-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2277 77  W-P-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2278 77  W-M-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2279 77  W-R-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2280 77  W-WY-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2281 77  W-VA-EP                 PIC S9(11)V9(02) COMP-3 VALUE +0.
  2282 77  W-1-EP                  PIC S9(11)V9(02) COMP-3 VALUE +0.
  2283 77  W-OTHERS-COUNT          PIC S9(11)       COMP-3 VALUE +0.
  2284 77  W-AH-CLAIM-EP           PIC S9(11)V9(02) COMP-3 VALUE +0.
  2285 77  W-AH-CLAIM-CTR          PIC S9(11)       COMP-3 VALUE +0.
  2286 77  W-EP-LESS-THAN-0        PIC S9(11)       COMP-3 VALUE +0.
  2287 77  W-CLAIMS-MADE-PAID-IN   PIC S9(11)V9(02) COMP-3 VALUE +0.
  2288 77  W-CLAIMS-MADE-PAID      PIC S9(11)V9(02) COMP-3 VALUE +0.
  2289 77  W-AH-IBNR               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2290 77  W-AH-IBNR-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2291 77  W-AH-IBNR-1-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2292 77  W-AH-IBNR-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2293 77  W-AH-IBNR-2-CNT         PIC S9(11)       COMP-3 VALUE +0.
  2294 77  W-LIFE-IBNR             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2295 77  W-LIFE-IBNR-IN          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2296 77  W-LIFE-REMAINING-AMT    PIC S9(11)V9(02) COMP-3 VALUE +0.
  2297 77  W-RTRM-0-CLMAMT         PIC S9(11)V9(02) COMP-3 VALUE +0.
  2298 77  W-CLM-EXCEPT-CNT        PIC S9(11)       COMP-3 VALUE +0.
  2299 77  W-CLM-EXCEPT-AMT        PIC S9(11)V9(02) COMP-3 VALUE +0.
  2300 77  W-RTRM-0-CNT            PIC S9(11)       COMP-3 VALUE +0.
  2301 77  W-RTRM-EP-1             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2302 77  W-RTRM-EP-2             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2303 77  W-RTRM-EP               PIC S9(11)V9(02) COMP-3 VALUE +0.
  2304 77  W-01-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2305 77  W-01-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2306 77  W-02-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2307 77  W-02-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2308 77  W-03-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2309 77  W-03-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2310 77  W-04-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2311 77  W-04-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2312 77  W-05-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2313 77  W-05-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2314 77  W-06-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2315 77  W-06-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2316 77  W-30-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2317 77  W-30-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2318 77  W-31-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2319 77  W-31-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2320 77  W-XX-REMAMT             PIC S9(11)V9(02) COMP-3 VALUE +0.
  2321 77  WS-TOT-PRM-AMT          PIC S9(11)V9(02) COMP-3 VALUE +0.
  2322 77  W-XX-DATA-USED          PIC S9(11)       COMP-3 VALUE +0.
  2323 77  W-MM-LF-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2324 77  W-MM-AH-PRM             PIC S9(7)V99     COMP-3 VALUE +0.
  2325 77  W-MM-LF-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2326 77  W-MM-AH-RFD             PIC S9(7)V99     COMP-3 VALUE +0.
  2327 77  W-MM-LF-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2328 77  W-MM-AH-CLM             PIC S9(7)V99     COMP-3 VALUE +0.
  2329 77  WS-CEDE-FACT            PIC S9V9(4)      COMP-3 VALUE +0.
  2330 77  WS-SAVE-CARR            PIC X                   VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS010V.cbl
  2331 77  WS-LOOP-MAX             PIC S99          COMP-3 VALUE +10.
  2332 77  WS-CR-PMT-FREQ          PIC 99           VALUE ZEROS.
  2333 77  WS-WE-LFPRM             PIC S9(7)V99    COMP-3 VALUE +0.
  2334 77  WS-FIRST-K              PIC X                  VALUE ' '.
  2335 77  WS-DLR-INC-CHG-BACK     PIC X                  VALUE ' '.
  2336 77  TOT-AH-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2337 77  TOT-AH-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2338 77  TOT-AH-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2339 77  TOT-AH-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2340 77  TOT-LF-IBNR             PIC S9(11)V99 COMP-3 VALUE +0.
  2341 77  TOT-LF-PRM              PIC S9(11)V99 COMP-3 VALUE +0.
  2342 77  TOT-LF-PD-CLMS          PIC S9(11)V99 COMP-3 VALUE +0.
  2343 77  TOT-LF-CLMRSV           PIC S9(11)V99 COMP-3 VALUE +0.
  2344 77  RTOT-AH-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2345 77  RTOT-AH-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2346 77  RTOT-AH-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2347 77  RTOT-AH-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2348 77  RTOT-LF-IBNR            PIC S9(11)V99 COMP-3 VALUE +0.
  2349 77  RTOT-LF-PRM             PIC S9(11)V99 COMP-3 VALUE +0.
  2350 77  RTOT-LF-PD-CLMS         PIC S9(11)V99 COMP-3 VALUE +0.
  2351 77  RTOT-LF-CLMRSV          PIC S9(11)V99 COMP-3 VALUE +0.
  2352 77  IBNR-FACT               PIC S9(3)V9(7) COMP-3 VALUE +0.
  2353
  2354 01  MONTH-END-DATA.
  2355     12  ME-START-DATE.
  2356         16  ME-START-MO         PIC 99.
  2357         16  FILLER              PIC X.
  2358         16  ME-START-DA         PIC 99.
  2359         16  FILLER              PIC X.
  2360         16  ME-START-YR         PIC 99.
  2361     12  ME-CNDS-DATE            PIC 9(6).
  2362     12  ME-CNDS-DATE-R REDEFINES ME-CNDS-DATE.
  2363         16  ME-CNDS-MO          PIC 99.
  2364         16  ME-CNDS-DA          PIC 99.
  2365         16  ME-CNDS-YR          PIC 99.
  2366     12  ME-START-TIME           PIC 9(6).
  2367     12  ME-UPDATE-FLAG          PIC X VALUE 'Y'.
  2368         88  ME-DO-UPDATE        VALUE 'Y'.
  2369         88  ME-NO-UPDATE        VALUE 'N'.
  2370     12  MONTH-END-MOYR          PIC S9(5) COMP-3.
  2371
  2372 01  WS-BALANCE-DESCRIPTION1       PIC X(50)  VALUE
  2373     'Life Claims Paid'.
  2374
  2375 01  WS-BALANCE-DESCRIPTION2       PIC X(50)  VALUE
  2376     'A&H Claims Paid'.
  2377
  2378 01  WS-BALANCE-DESCRIPTION3       PIC X(50)  VALUE
  2379     'Output Certificate Master Records Prior Month'.
  2380
  2381 01  WS-BAL50-DESCRIPTION          PIC X(50)  VALUE
  2382     'ECS010 Out Recs should match EL331 Offline Certs  '.
  2383
  2384 01  WS-ME-BALANCE-REC.
  2385     12  WS-ME-BAL-JOB           PIC X(11)  VALUE SPACES.
  2386     12  WS-ME-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2387     12  WS-ME-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2388     12  WS-ME-BAL-DELIM2        PIC X(01)  VALUE ';'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS010V.cbl
  2389     12  WS-ME-BAL-AMT           PIC ZZZ,ZZZ,ZZ9.
  2390     12  WS-ME-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2391     12  WS-ME-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2392
  2393 01  WS-ME50-BALANCE-REC.
  2394     12  WS-ME50-BAL-JOB           PIC X(11)  VALUE SPACES.
  2395     12  WS-ME50-BAL-DELIM1        PIC X(01)  VALUE ';'.
  2396     12  WS-ME50-BAL-STEP          PIC X(08)  VALUE 'ECS010  '.
  2397     12  WS-ME50-BAL-DELIM2        PIC X(01)  VALUE ';'.
  2398     12  WS-ME50-BAL-AMT-LOW       PIC ZZZ,ZZZ,ZZ9.
  2399     12  WS-ME50-BAL-DELIM3        PIC X(01)  VALUE ';'.
  2400     12  WS-ME50-BAL-AMT-HIGH      PIC ZZZ,ZZZ,ZZ9.
  2401     12  WS-ME50-BAL-DELIM4        PIC X(01)  VALUE ';'.
  2402     12  WS-ME50-BAL-DESCRIP       PIC X(50)  VALUE SPACES.
  2403
  2404 01  WS-PREV-BANK-COMM-KEY       PIC X(21)  VALUE LOW-VALUES.
  2405 01  WS-BANK-INIT                PIC X(260) VALUE SPACES.
  2406 01  WS-BANK-COMMISSIONS.
  2407     12  WS-BANK-COMMS           OCCURS 10.
  2408         16  WS-BNK-AGT          PIC X(10).
  2409         16  WS-BNK-TYPE         PIC X.
  2410         16  WS-BNK-SPP-FEES     PIC S9(5)V99  COMP-3.
  2411         16  WS-BNK-RECALC       PIC X.
  2412         16  FILLER              PIC X(10).
  2413
  2414 01  PENDING-MATCH-CONTROL.
  2415     12  PENDING-ACCOUNT-CONTROL.
  2416         16  PEND-MATCH-CARRIER    PIC X.
  2417         16  PEND-MATCH-GROUPING   PIC X(6).
  2418         16  PEND-MATCH-STATE      PIC XX.
  2419         16  PEND-MATCH-ACCOUNT    PIC X(10).
  2420     12  PEND-MATCH-EFF-DTE        PIC 9(11) COMP-3.
  2421     12  PEND-MATCH-CERT-NO.
  2422         16  PEND-MATCH-CERT       PIC X(10).
  2423         16  PEND-MATCH-CERT-SFX   PIC X.
  2424 01  PENDING-RECORD-TYPE           PIC X.
  2425     88  ISSUE-TRANSACTION            VALUE '1'.
  2426     88  CANCEL-TRANSACTION           VALUE '2'.
  2427     88  CLAIM-TRANSACTION            VALUE '3'.
  2428     88  RESERVE-TRANSACTION          VALUE '4'.
  2429     88  UPDATE-TRANSACTION           VALUE '5'.
  2430
  2431 01  CLM-INCUR-REIN-DATE.
  2432     12  CIRD-CCYY.
  2433         16  CIRD-CC         PIC 99.
  2434         16  CIRD-YR         PIC 99.
  2435     12  CIRD-MO             PIC 99.
  2436
  2437 01  HIGH-CERT               PIC 9(11)           VALUE ZEROS.
  2438
  2439 01  LOW-CERT                PIC 9(11)           VALUE ZEROS.
  2440
  2441 01  REIN-BILLING-TABLE.
  2442     12  REIN-CO-ENTRIES OCCURS 50 TIMES.
  2443         16  RB-COMPANY      PIC X(6).
  2444         16  RB-COUNT        PIC S9(5)   COMP-3.
  2445
  2446 01  B-SUB                   PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS010V.cbl
  2447
  2448 01  BINARY-COUNTERS     COMP      SYNC.
  2449     12  IA                  PIC S999            VALUE +0.
  2450     12  IB                  PIC S999            VALUE +0.
  2451     12  SUB                 PIC S999            VALUE +0.
  2452     12  SUBM                PIC S999            VALUE +0.
  2453     12  SUB3                PIC S999            VALUE +0.
  2454     12  SUB4                PIC S999            VALUE +0.
  2455     12  SUB5                PIC S999            VALUE +0.
  2456     12  SUB6                PIC S999            VALUE +0.
  2457     12  SUB7                PIC S999            VALUE +0.
  2458     12  SUB8                PIC S999            VALUE +0.
  2459     12  SUB9                PIC S999            VALUE +0.
  2460     12  SUB10               PIC S999            VALUE +0.
  2461     12  SUB11               PIC S999            VALUE +0.
  2462     12  SUB12               PIC S999            VALUE +0.
  2463     12  SUB13               PIC S999            VALUE +0.
  2464     12  SUB14               PIC S999            VALUE +0.
  2465     12  SUB15               PIC S999            VALUE +0.
  2466     12  SUB16               PIC S999            VALUE +0.
  2467     12  LEVELS-BUILT        PIC S999            VALUE +0.
  2468 01  WS-SEQ-NBR              PIC 9               VALUE ZERO.
  2469
  2470 01  WS.
  2471     12  WS-RETURN-CODE        PIC S9(4)   COMP   VALUE +0.
  2472     12  WS-ABEND-MESSAGE      PIC X(80)          VALUE SPACES.
  2473     12  WS-ABEND-FILE-STATUS  PIC XX             VALUE ZEROS.
  2474     12  WS-ZERO               PIC S9      COMP-3 VALUE +0.
  2475
  2476     12  WS-ABEND-CODE         PIC 9(4).
  2477     12  ABEND-CODE  REDEFINES  WS-ABEND-CODE.
  2478         16  ABEND-CODE-1    PIC XX.
  2479         16  ABEND-CODE-2.
  2480             20  AC2-ONE     PIC X.
  2481             20  AC2-TWO     PIC X.
  2482
  2483     12  CTBL-SEARCH.
  2484         16  CTBL-COMP-CD    PIC X.
  2485         16  CTBL-TABLE-CD   PIC XXX.
  2486         16  CTBL-BEN-TYPE   PIC X.
  2487         16  CTBL-BEN-CODE   PIC XX.
  2488     12  LAST-CTBL           PIC X(7)            VALUE SPACES.
  2489     12  COMM-OPEN-SW        PIC X               VALUE SPACES.
  2490     12  WS-COMM-TERM        PIC S999            COMP-3.
  2491     12  CTBL-ERROR-SWITCH   PIC X               VALUE SPACE.
  2492         88  CTBL-ERROR         VALUE '*'.
  2493
  2494     12  REIN-SPEC.
  2495         16  REIN-SPEC-A     PIC X.
  2496         16  REIN-SPEC-B     PIC X.
  2497         16  REIN-SPEC-C     PIC X.
  2498
  2499     12  WS-CHECK-NUMBER.
  2500         16  WS-CHECK-NO     PIC X(4).
  2501         16  FILLER          PIC XXX.
  2502
  2503     12  AH-EARN-METHOD      PIC X               VALUE SPACES.
  2504         88  AH-EARN-ANTICIPATION                VALUE 'A' 'C'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS010V.cbl
  2505         88  AH-EARN-NET                         VALUE 'N'.
  2506
  2507 01  ERACCTT-FILE-STATUS     PIC XX VALUE ZEROS.
  2508 01  ERCTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2509 01  ERMEBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2510 01  ERRTBL-FILE-STATUS      PIC XX VALUE ZEROS.
  2511 01  ERRESC-FILE-STATUS      PIC XX VALUE ZEROS.
  2512 01  ERAGTC-FILE-STATUS      PIC XX VALUE ZEROS.
  2513 01  ELCRTT-FILE-STATUS      PIC XX VALUE ZEROS.
  2514
  2515 01  MONTHS-DIFF-LF          PIC S9(05) VALUE +0.
  2516 01  MONTHS-DIFF-AH          PIC S9(05) VALUE +0.
  2517 01  WS-CR-BIN-DATE          PIC XX VALUE LOW-VALUES.
  2518 01  WS-BIN-CANCEL-DATE      PIC XX VALUE LOW-VALUES.
  2519
  2520 01  WS-LEVELS-CHARGEBACK-SWITCHES.
  2521     12  WS-LF-CHARGEBACK-LEVELS.
  2522         16  WS-LF-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2523     12  WS-AH-CHARGEBACK-LEVELS.
  2524         16  WS-AH-CHARGEBACK-SW   PIC X(01) OCCURS 10 TIMES.
  2525*****************************************************************
  2526*        WORKING STORAGE AREA FOR CLIENT-DMD               START*
  2527*****************************************************************
  2528*RESIDENT STATE TAXES MASTER(ERRESC)
  2529*
  2530 01  WORK-AREAS.
  2531     12  WS-ERRESC-KEY.
  2532         16 WS-ERRESC-SEARCH-KEY.
  2533             20  WS-ERRESC-COMPANY-CD PIC  X.
  2534             20  WS-ERRESC-CARRIER    PIC  X.
  2535             20  WS-ERRESC-GROUP      PIC X(6).
  2536             20  WS-ERRESC-STATE      PIC XX.
  2537             20  WS-ERRESC-ACCOUNT    PIC X(10).
  2538         16 WS-ERRESC-RESIDUAL-KEY.
  2539             20  WS-ERRESC-AGENT      PIC X(10).
  2540             20  WS-ERRESC-RES-STATE  PIC XX.
  2541             20  WS-ERRESC-EXPIRE-DT  PIC 9(8) COMP-3.
  2542*                                          YYYYMMDD
  2543     12  WS-YYYYMMDD-DT               PIC 9(8).
  2544     12  WS-COMMISSION                PIC SV9(5) COMP-3.
  2545     12  WS-SUB                       PIC    99  COMP-3.
  2546     12  WS-SUB1                      PIC    99  COMP-3.
  2547*****************************************************************
  2548*        WORKING STORAGE AREA FOR CLIENT-DMD                 END*
  2549*****************************************************************
  2550
  2551 01  COMM-WORK-AREAS.
  2552     12  FILLER              PIC  X(17)
  2553         VALUE 'COMMON WORK AREAS'.
  2554     12  ACCT-COMM-LF        PIC SV9(5)  COMP-3.
  2555     12  ACCT-COMM-AH        PIC SV9(5)  COMP-3.
  2556     12  W-AH-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2557     12  W-AH-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2558     12  W-AH-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2559     12  W-AH-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2560     12  W-AH-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2561     12  W-AH-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2562     12  W-AH-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS010V.cbl
  2563     12  W-AH-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2564     12  W-AH-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2565     12  W-AH-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2566     12  W-AH-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2567     12  W-AHTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2568     12  W-BAL-REMTRM        PIC S9(05)V99  COMP-3.
  2569     12  W-CERT-COUNT        PIC S9(08)  COMP.
  2570     12  W-COUNT             PIC S9(08)  COMP   VALUE +0.
  2571     12  W-CLMAMT            PIC S9(07)V9(02)   VALUE ZEROS.
  2572     12  W-90-DAY-MAX        PIC S9(07)V9(02)   VALUE ZEROS.
  2573
  2574     12  W-EARNED-PREMIUM    PIC S9(07)V9(02)
  2575                                         COMP-3 VALUE ZEROS.
  2576     12  W-EARNED-PREMIUM-1  PIC S9(07)V9(02)
  2577                                         COMP-3 VALUE ZEROS.
  2578     12  W-EARNED-PREMIUM-2  PIC S9(07)V9(02)
  2579                                         COMP-3 VALUE ZEROS.
  2580     12  W-EDIT-FIELD        PIC ----------9.
  2581     12  W-EDIT-FIELD2       PIC ----------9.99.
  2582     12  W-EDIT-7            PIC Z(06)9.
  2583     12  W-FACTOR            PIC S9(09)V9(08)
  2584                                         COMP-3 VALUE ZEROS.
  2585     12  W-IBNR-1            PIC S9(07)V9(02)
  2586                                         COMP-3 VALUE ZEROS.
  2587     12  W-IBNR-2            PIC S9(07)V9(02)
  2588                                         COMP-3 VALUE ZEROS.
  2589     12  W-ISS-BEN           PIC S9(11)V9(02)
  2590                                         COMP-3 VALUE ZEROS.
  2591     12  W-ISS-BEN-GROSS     PIC S9(11)V9(02)
  2592                                         COMP-3 VALUE ZEROS.
  2593     12  W-LF-ACTIVE         PIC S9(13)  COMP-3 VALUE ZEROS.
  2594     12  W-LF-BALLOON        PIC S9(13)  COMP-3 VALUE ZEROS.
  2595     12  W-LF-CLAIMS         PIC S9(13)  COMP-3 VALUE ZEROS.
  2596     12  W-LF-CALC-B         PIC S9(13)  COMP-3 VALUE ZEROS.
  2597     12  W-LF-DATA-USED      PIC S9(13)  COMP-3 VALUE ZEROS.
  2598     12  W-LF-INACTIVE       PIC S9(13)  COMP-3 VALUE ZEROS.
  2599     12  W-LF-ISSUES         PIC S9(13)  COMP-3 VALUE ZEROS.
  2600     12  W-LF-REMAMT-0       PIC S9(13)  COMP-3 VALUE ZEROS.
  2601     12  W-LF-REMTERM-0      PIC S9(13)  COMP-3 VALUE ZEROS.
  2602     12  W-LF-REIN           PIC S9(13)  COMP-3 VALUE ZEROS.
  2603     12  W-LF-REISSUE        PIC S9(13)  COMP-3 VALUE ZEROS.
  2604     12  W-LF-RESERVES       PIC S9(13)  COMP-3 VALUE ZEROS.
  2605     12  W-LF-RESV           PIC S9(13)  COMP-3 VALUE ZEROS.
  2606     12  W-LFTYP-99          PIC S9(13)  COMP-3 VALUE ZEROS.
  2607     12  W-LIFE-YEARS        PIC S9(09)  COMP-3 VALUE ZEROS.
  2608     12  W-LIFE-YEARS-INT    PIC S9(09)V9(06)
  2609                                         COMP-3 VALUE ZEROS.
  2610     12  W-NDX               PIC S9(03)  COMP-3 VALUE ZEROS.
  2611     12  W-ORGTRM-0-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2612     12  W-ORGTRM-0-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2613     12  W-RET-CODE-AH       PIC S9(13)  COMP-3 VALUE ZEROS.
  2614     12  W-RET-CODE-LF       PIC S9(13)  COMP-3 VALUE ZEROS.
  2615     12  W-PENDING-CLMS      PIC S9(13)  COMP-3 VALUE ZEROS.
  2616     12  W-POL-ISSUES        PIC S9(13)  COMP-3 VALUE ZEROS.
  2617     12  W-POLICY-ACTIVE-CTR PIC S9(13)  COMP-3 VALUE ZEROS.
  2618     12  W-POLICY-INACTIVE-CTR
  2619                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2620     12  W-POLICY-REISSUE-CTR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS010V.cbl
  2621                             PIC S9(13)  COMP-3 VALUE ZEROS.
  2622     12  W-POLICY-REIN-CTR   PIC S9(13)  COMP-3 VALUE ZEROS.
  2623     12  W-POLICY-INACTIVE   PIC S9(13)  COMP-3 VALUE ZEROS.
  2624     12  W-TARGET-LOSS-RATIO PIC S9(01)V9(04)
  2625                                         COMP-3 VALUE ZEROS.
  2626     12  W-VAL-SOURCE        PIC S9(03)  COMP-3 VALUE ZEROS.
  2627     12  W-WK-IBNR           PIC S9(07)V9(02)
  2628                                         COMP-3 VALUE ZEROS.
  2629
  2630     12  W-CLAIM-TYPE        PIC  X(01).
  2631         88  W-A-H                              VALUE 'A'.
  2632         88  W-LIFE                             VALUE 'L'.
  2633     12  W-CUTOFF-DATE       PIC  9(08).
  2634     12  W-DIS-DT            PIC  XX.
  2635     12  W-DIS-PTO-DT        PIC  XX.
  2636     12  WK-LEVEL.
  2637         16  WK-AGT          PIC X(10).
  2638         16  WK-A-TYPE       PIC X.
  2639         16  WK-L-RT         PIC SV9(5)  COMP-3.
  2640         16  WK-J-RT         PIC SV9(5)  COMP-3.
  2641         16  WK-A-RT         PIC SV9(5)  COMP-3.
  2642         16  FILLER          PIC X(6).
  2643     12  WK-LEVEL-R REDEFINES WK-LEVEL.
  2644         16  FILLER          PIC X(11).
  2645         16  WK-L-RTX        PIC X(3).
  2646         16  WK-J-RTX        PIC X(3).
  2647         16  WK-A-RTX        PIC X(3).
  2648         16  FILLER          PIC X(6).
  2649     12  WK-NEW-RATES.
  2650         16  WK-N-R      OCCURS 10.
  2651             20  WK-N-AGT    PIC X(10).
  2652             20  WK-N-TYPE   PIC X.
  2653             20  WK-L-RT1    PIC SV9(5)  COMP-3.
  2654             20  WK-A-RT1    PIC SV9(5)  COMP-3.
  2655     12  W-LIFE-YEARS-ZERO.
  2656         16  FILLER          PIC  X(06)         VALUE ZEROS.
  2657         16  FILLER          PIC  X(01)         VALUE SPACES.
  2658         16  FILLER          PIC  X(02)         VALUE ZEROS.
  2659         16  FILLER          PIC  X(01)         VALUE SPACES.
  2660         16  FILLER          PIC  X(01)         VALUE SPACES.
  2661         16  FILLER          PIC  X(01)         VALUE SPACES.
  2662         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2663         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2664         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2665         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2666         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2667         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2668         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2669         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2670         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2671         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2672         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2673         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2674         16  FILLER          PIC S9(09)  COMP-3 VALUE ZEROS.
  2675         16  FILLER          PIC S9(09)V9(02) COMP-3
  2676                                                VALUE ZEROS.
  2677         16  FILLER          PIC S9(09)V9(02) COMP-3
  2678                                                VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS010V.cbl
  2679         16  FILLER          PIC S9(09)V9(02) COMP-3
  2680                                                VALUE ZEROS.
  2681         16  FILLER          PIC S9(09)V9(02) COMP-3
  2682                                                VALUE ZEROS.
  2683         16  FILLER          PIC S9(11)V9(02) COMP-3
  2684                                                VALUE ZEROS.
  2685
  2686     12  W-REIN-PROCESS-IND  PIC  X(01)         VALUE SPACES.
  2687         88 W-REIN-IN-PROCESS                   VALUE 'Y'.
  2688     12  W-REIN-PROCESS-SW   PIC  X(01)         VALUE SPACES.
  2689         88  W-REIN-PROCESS                     VALUE 'Y'.
  2690         88  W-NOT-REIN-PROCESS                 VALUE SPACES.
  2691     12  W-SELECTION-SW      PIC  X(01)         VALUE SPACES.
  2692         88  W-SELECTION-ON                     VALUE 'Y'.
  2693         88  W-SELECTION-OFF                    VALUE SPACES.
  2694     12  W-RTRM-0-SW         PIC  X(01)         VALUE SPACES.
  2695         88  W-RTRM-0                           VALUE 'Y'.
  2696         88  W-RTRM-NOT-0                       VALUE SPACES.
  2697     12  W-SUB-KEY           PIC  X(03)         VALUE SPACES.
  2698     12  W-TABLE-USED-SW     PIC  X(01)         VALUE SPACES.
  2699         88  W-TABLE-USED                       VALUE 'Y'.
  2700         88  W-TABLE-NOT-USED                   VALUE SPACES.
  2701     12  W-UNDERWRITING-SW   PIC  X             VALUE SPACES.
  2702         88  W-UNDERWRITTEN-DATA                VALUE '*'.
  2703
  2704     12  W-VAL-ERRORS.
  2705         16  FILLER          PIC  X(40)
  2706             VALUE 'PENDING CANC PROCESS - CR-LF-CANC-DT - '.
  2707         16  FILLER          PIC  X(40)
  2708             VALUE 'EPEC PROCESS - LIFE - RUN DATE - '.
  2709         16  FILLER          PIC  X(40)
  2710             VALUE 'EPEC CANCEL - LIFE - CR-LF-CANC-DT - '.
  2711         16  FILLER          PIC  X(40)
  2712             VALUE 'EPEC CANCEL LIFE SUM - CR-LF-CANC-DT - '.
  2713         16  FILLER          PIC  X(40)
  2714             VALUE 'EOM RUN DATE - EPEC - COMM - '.
  2715         16  FILLER          PIC  X(40)
  2716             VALUE 'RUN DATE EPEC - A&H - '.
  2717         16  FILLER          PIC  X(40)
  2718             VALUE 'CUTOFF DTE (OPT-MTHD) - '.
  2719         16  FILLER          PIC  X(40)
  2720             VALUE 'EOM RUN DATE - A&H EARNED PREMIUM - '.
  2721         16  FILLER          PIC  X(40)
  2722             VALUE 'EARNINGS START DATE - REIN CO RCD - '.
  2723     12  FILLER REDEFINES W-VAL-ERRORS.
  2724         16  W-VAL-ERROR OCCURS 9 TIMES
  2725                             PIC  X(40).
  2726
  2727     12  W-WORK-DATE         PIC  X(02).
  2728     12  SAVE-WK-NEW-RATES.
  2729         16  FILLER          PIC X(170).
  2730
  2731***   The following data area is for NCL only
  2732*    12  W-WORK-OB-DATA OCCURS 300.
  2733*    12  W-WORK-OB-DATA OCCURS 220.
  2734     12  W-WORK-OB-DATA OCCURS 900.
  2735         16  WS-OB-REIN-CO       PIC X(06).
  2736         16  WS-OB-LF-AH         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS010V.cbl
  2737         16  WS-OB-BENEFIT-CODE  PIC XX.
  2738         16  WS-OB-EARNED OCCURS 3.
  2739             20  WS-EPR-R78   PIC S9(09)V99 COMP-3.
  2740
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS010V.cbl
  2742 01  EPEC-WORK-AREAS.
  2743     12  WE-REIN-CO          PIC X(6).
  2744     12  WE-LF-AH            PIC X.
  2745     12  WE-BEN-TYPE         PIC XX.
  2746     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2747     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2748     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2749     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2750     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2751     12  WE-DTHAMT           PIC S9(9)V99    COMP-3.
  2752     12  WE-DTHEXP           PIC S9(9)V99    COMP-3.
  2753     12  WE-NUM-DTH-CLM      PIC S999        COMP-3.
  2754     12  WE-DTH-IBNR         PIC S9(7)V99    COMP-3.
  2755     12  WE-DTH-PAYCUR       PIC S9(7)V99    COMP-3.
  2756     12  WE-DTH-FUTRSV       PIC S9(7)V99    COMP-3.
  2757     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2758     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2759     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2760     12  WE-DSPY-AMT         PIC S9(9)V99    COMP-3.
  2761     12  WE-DSPY-EXP         PIC S9(9)V99    COMP-3.
  2762     12  WE-NUM-DIS-CLM      PIC S999        COMP-3.
  2763     12  WE-DIS-IBNR         PIC S9(7)V99    COMP-3.
  2764     12  WE-DIS-PAYCUR       PIC S9(7)V99    COMP-3.
  2765     12  WE-DIS-FUTRSV       PIC S9(7)V99    COMP-3.
  2766     12  ISS-BEN             PIC S9(9)V99    COMP-3.
  2767     12  CNC-BEN             PIC S9(9)V99    COMP-3.
  2768     12  ISS-PRM             PIC S9(7)V99    COMP-3.
  2769     12  ISS-PRMTAX          PIC S9(7)V99    COMP-3.
  2770     12  CNC-PRM             PIC S9(7)V99    COMP-3.
  2771     12  GROSS-ISS-BEN-LF    PIC S9(9)V99    COMP-3.
  2772     12  GROSS-CNC-BEN-LF    PIC S9(9)V99    COMP-3.
  2773     12  GROSS-ISS-PRM-LF    PIC S9(7)V99    COMP-3.
  2774     12  GROSS-CNC-PRM-LF    PIC S9(7)V99    COMP-3.
  2775     12  GROSS-ISS-BEN-AH    PIC S9(7)V99    COMP-3.
  2776     12  GROSS-CNC-BEN-AH    PIC S9(7)V99    COMP-3.
  2777     12  GROSS-ISS-PRM-AH    PIC S9(7)V99    COMP-3.
  2778     12  GROSS-CNC-PRM-AH    PIC S9(7)V99    COMP-3.
  2779     12  EARNED-BY-CANCEL    PIC S9(7)V99    COMP-3.
  2780     12  EPR-R78             PIC S9(7)V99    COMP-3.
  2781     12  EPR-PRO             PIC S9(7)V99    COMP-3.
  2782     12  EPR-ST              PIC S9(7)V99    COMP-3.
  2783     12  W-OPT-R78           PIC S9(7)V99    COMP-3.
  2784     12  W-OPT-PRO           PIC S9(7)V99    COMP-3.
  2785     12  W-OPT-ST            PIC S9(7)V99    COMP-3.
  2786     12  WX-ACTIVE-COUNT     PIC S9          COMP-3.
  2787     12  WX-CANC-DT          PIC 9(11)       COMP-3.
  2788     12  WX-CLM-AMT          PIC S9(9)V99    COMP-3.
  2789     12  WX-CLM-EXP          PIC S9(9)V99    COMP-3.
  2790     12  WX-CLM-CNT          PIC S9(7)       COMP-3.
  2791     12  WX-CLM-CRT          PIC S9(7)       COMP-3.
  2792     12  WX-CNC-CNT          PIC S9(7)       COMP-3.
  2793     12  WX-CLAIM-EXIT-DATE  PIC  9(11)      COMP-3.
  2794     12  WX-SETTLEMENT-EXIT-DATE
  2795                             PIC  9(11)      COMP-3.
  2796     12  WX-STATUS-AT-CANCEL PIC  X(1).
  2797     12  WX-STATUS-AT-DEATH  PIC  X(1).
  2798     12  WX-STATUS-AT-SETTLEMENT
  2799                             PIC  X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS010V.cbl
  2800     12  WX-EOM-RUN-DATE     PIC  9(11)      COMP-3.
  2801
  2802 01  EPEC-WORK.
  2803     12  EW-REIN-CO          PIC X(6).
  2804     12  EW-SUB-KEY.
  2805         16  EW-LF-AH        PIC X.
  2806         16  EW-BEN-TYPE     PIC XX.
  2807     12  EW-ISS-BEN          PIC S9(11)V99   COMP-3.
  2808     12  EW-ISS-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2809     12  EW-CNC-BEN          PIC S9(11)V99   COMP-3.
  2810     12  EW-CNC-BEN-GROSS    PIC S9(11)V99   COMP-3.
  2811     12  EW-ISS-PRM          PIC S9(9)V99    COMP-3.
  2812     12  EW-ISS-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2813     12  EW-CNC-PRM          PIC S9(9)V99    COMP-3.
  2814     12  EW-CNC-PRM-GROSS    PIC S9(9)V99    COMP-3.
  2815     12  EW-EPR-R78          PIC S9(9)V99    COMP-3.
  2816     12  EW-EPR-R78-ADJ      PIC S9(9)V99    COMP-3.
  2817     12  EW-EPR-PRO          PIC S9(9)V99    COMP-3.
  2818     12  EW-EPR-PRO-ADJ      PIC S9(9)V99    COMP-3.
  2819     12  EW-EPR-ST           PIC S9(9)V99    COMP-3.
  2820     12  EW-EPR-ST-ADJ       PIC S9(9)V99    COMP-3.
  2821     12  EW-CLM-AMT          PIC S9(9)V99    COMP-3.
  2822     12  EW-CLM-IBNR         PIC S9(7)V99    COMP-3.
  2823     12  EW-CLM-PAYCUR       PIC S9(7)V99    COMP-3.
  2824     12  EW-CLM-FUTRSV       PIC S9(7)V99    COMP-3.
  2825     12  EW-CLM-CNT          PIC S9(7)       COMP-3.
  2826     12  EW-CLM-CRT          PIC S9(7)       COMP-3.
  2827     12  EW-ISS-CNT          PIC S9(7)       COMP-3.
  2828     12  EW-CNC-CNT          PIC S9(7)       COMP-3.
  2829     12  EW-ISS-PRM-TAX      PIC S9(7)V99    COMP-3.
  2830     12  EW-AGENTS       OCCURS 10.
  2831         16  EW-AGT-NO       PIC X(10).
  2832         16  EW-AGT-TYPE     PIC X.
  2833         16  EW-ISS-COM      PIC S9(9)V99    COMP-3.
  2834         16  EW-CNC-COM      PIC S9(9)V99    COMP-3.
  2835         16  EW-ECR-R78      PIC S9(9)V99    COMP-3.
  2836         16  EW-ECR-R78-ADJ  PIC S9(9)V99    COMP-3.
  2837         16  EW-ECR-PRO      PIC S9(9)V99    COMP-3.
  2838         16  EW-ECR-PRO-ADJ  PIC S9(9)V99    COMP-3.
  2839         16  EW-ECR-ST       PIC S9(9)V99    COMP-3.
  2840     12  EW-COV-DTE          PIC 9(11)       COMP-3.
  2841     12  EW-INFORCE-CNT      PIC S9(9)       COMP-3.
  2842     12  EW-ORIG-TERM        PIC S9(9)       COMP-3.
  2843     12  EW-REM-TERM         PIC S9(9)       COMP-3.
  2844     12  EW-AGE              PIC S9(9)       COMP-3.
  2845     12  EW-AGE-BEN          PIC S9(11)      COMP-3.
  2846     12  EW-TERM-BEN         PIC S9(11)      COMP-3.
  2847     12  EW-LEVEL-USED       PIC X.
  2848
  2849 01  EPEC-TOTALS.
  2850     12  EPEC-LEVELS     OCCURS 900.
  2851*    12  EPEC-LEVELS     OCCURS 220.
  2852*    12  EPEC-LEVELS     OCCURS 300.
  2853         16  EPEC-REIN-CO          PIC X(6).
  2854         16  EPEC-SUB-KEY.
  2855             24  EPEC-LF-AH        PIC X.
  2856             24  EPEC-BEN-TYPE     PIC XX.
  2857*        16  FILLER                PIC X(694).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS010V.cbl
  2858         16  FILLER                PIC X(699).
  2859     12  EPEC-LEVELS-END           PIC X(6).
  2860
  2861 01  EPEC-UNDERWRITTEN-TOTALS.
  2862     12  EPEC-LEVELS-II  OCCURS 900.
  2863*    12  EPEC-LEVELS-II  OCCURS 220.
  2864*    12  EPEC-LEVELS-II  OCCURS 300.
  2865         16  EPEC-REIN-CO-II       PIC X(6).
  2866         16  EPEC-SUB-KEY-II.
  2867             24  EPEC-LF-AH-II     PIC X.
  2868             24  EPEC-BEN-TYPE-II  PIC XX.
  2869*        16  FILLER                PIC X(694).
  2870         16  FILLER                PIC X(699).
  2871     12  EPEC-LEVELS-END-II        PIC X(6).
  2872
  2873
  2874 01  FILLER                      PIC  X(11)
  2875                                 VALUE 'OPT RSV TBL'.
  2876*
  2877* THE 'PIC' VALUE OF THE NEXT 2 DATA NAMES IS 300 OCCURANCES
  2878*  TIMES THE SIZE OF THE DATA NAME THAT OCCURS.
  2879*  EX: EPEC-OPT-GRP  (300) TIMES THE TOTAL SIZE OF FIELDS IN
  2880*      EPEC-OPT-GRP  (108)
  2881*
  2882*      300 X 108 = 32400.
  2883*
  2884 01  EPEC-OPT-DATA-TABLE.
  2885*    12  FILLER                  PIC X(32400).
  2886*    12  FILLER                  PIC X(23760).
  2887     12  FILLER                  PIC X(97200).
  2888
  2889 01  FILLER                      PIC  X(16)
  2890                                 VALUE 'OPT RSV TBL UNDW'.
  2891 01  EPEC-UNDW-OPT-DATA-TABLE.
  2892*    12  FILLER                  PIC X(32400).
  2893*    12  FILLER                  PIC X(23760).
  2894     12  FILLER                  PIC X(97200).
  2895
  2896 01  FILLER                      PIC  X(16)
  2897                                 VALUE 'OPT RSV TBL WORK'.
  2898 01  EPEC-OPT-WORK-TABLE.
  2899*    12  EPEC-OPT-GRP        OCCURS 300.
  2900*    12  EPEC-OPT-GRP        OCCURS 220.
  2901     12  EPEC-OPT-GRP        OCCURS 900.
  2902         16  EPEC-REIN-CO-OPT
  2903                             PIC  X(06).
  2904         16  EPEC-SUB-KEY-OPT.
  2905             24  EPEC-LF-AH-OPT
  2906                             PIC  X(01).
  2907             24  EPEC-BEN-TYPE-OPT
  2908                             PIC  X(02).
  2909         16  EPEC-OPT-DATA.
  2910             20  EPEC-REIN-ONLY-IND
  2911                             PIC  X(01).
  2912                 88  EPEC-REIN-ONLY-DATA   VALUE 'R'.
  2913             20  EPEC-LINE-NOT-USED-IND
  2914                             PIC  X(01).
  2915                 88  EPEC-LINE-NOT-USED    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS010V.cbl
  2916             20  EPEC-LIFE-CTR-USED-IND
  2917                             PIC  X(01).
  2918                 88  EPEC-LIFE-CTR-USED    VALUE 'Y'.
  2919                 88  EPEC-LIFE-CTR-NOT-USED
  2920                                           VALUE ' '.
  2921             20  EPEC-LIFE-CTR   OCCURS 13 TIMES
  2922                             PIC S9(09)       COMP-3.
  2923             20  EPEC-EARNED-PREMIUM-AH
  2924                             PIC S9(09)V9(02) COMP-3.
  2925             20  EPEC-CLAIMS-MADE-PAID
  2926                             PIC S9(09)V9(02) COMP-3.
  2927             20  EPEC-CLM-EXP
  2928                             PIC S9(09)V9(02) COMP-3.
  2929             20  EPEC-LIFE-IBNR
  2930                             PIC S9(09)V9(02) COMP-3.
  2931             20  EPEC-REIN-ISS-BEN
  2932                             PIC S9(11)V9(02) COMP-3.
  2933
  2934 01  FILLER                  PIC X(09)
  2935                                 VALUE 'EOM TABLE'.
  2936
  2937 01  EOM-DATE-TABLE.
  2938     12  EOM-DATE            OCCURS 13
  2939                             PIC 9(08).
  2940
  2941 01  EPEC-SUBS.
  2942     12  EPEC-SUB-LEVELS OCCURS 31.
  2943         16  EPEC-SUB-REIN   PIC X(6).
  2944         16  EPEC-SUB-LF     PIC S999  COMP  OCCURS 900.
  2945         16  EPEC-SUB-AH     PIC S999  COMP  OCCURS 900.
  2946     12  EPEC-SUBS-END       PIC X(6).
  2947
  2948 01  SAVE-REIN-WORK.
  2949     12  REIN-SUB-1          PIC S9(4)   COMP    VALUE +0.
  2950     12  REIN-SUB-2          PIC S9(4)   COMP    VALUE +0.
  2951     12  REIN-MAX            PIC S9(4)   COMP    VALUE +32.
  2952     12  REIN-LOW-TIME       PIC 9(6)            VALUE 999999.
  2953     12  REIN-LOW-SUB        PIC S9(4)   COMP    VALUE +1.
  2954
  2955 01  SAVE-REIN-TABLE.
  2956     12  SAVE-REIN-ENTRY     OCCURS 32 TIMES.
  2957         16  SR-TIME         PIC 9(6).
  2958         16  SR-ENTRY.
  2959             20  FILLER      PIC XX.
  2960             20  SR-CONTROL  PIC X(8).
  2961             20  FILLER      PIC X(3990).
  2962
  2963
* 2964                             COPY ECSRITAB.
  2965******************************************************************04/29/98
  2966*                                                                *ECSRITAB
  2967*                            ECSRITAB                            *   LV015
  2968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2969*                            VMOD=2.015                          *ECSRITAB
  2970*                                                                *ECSRITAB
  2971*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2972*                                                                *ECSRITAB
  2973******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2974 01  REIN-WORK-AREAS.                                             ECSRITAB
  2975     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2976     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2977     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2978     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2979     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2980     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2981     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2982     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2983     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2984     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2985     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2986         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2987             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2988             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2989             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2990     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2991     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2992     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2993     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2994     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2995     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2996     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2997     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2998     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2999     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3000     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3001     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3002     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3003     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3004     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3005     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3006     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  3007     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3008     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3009     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3010     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3011     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3012     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  3013                                                                  ECSRITAB
  3014 01  REIN-HOLD-AREAS.                                             ECSRITAB
  3015     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  3016         16  REIN-COMP               PIC X(6).                    ECSRITAB
  3017         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  3018             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  3019             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  3020         16  REIN-WORK-FLDS.                                      ECSRITAB
  3021             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
  3022             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3023             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  3024             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  3025             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3026             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  3027             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3028             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  3029             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3030             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  3031             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3032             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3033             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3034             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3035             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3036             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3037             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  3038             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  3039             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  3040             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  3041             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3042             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  3043             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  3044             20  REIN-REM-SW         PIC X.                       ECSRITAB
  3045             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  3046             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  3047             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  3048             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  3049     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  3050                                                                  ECSRITAB
  3051     12  RWF-FIELDS.                                              ECSRITAB
  3052         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  3053         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3054         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  3055         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  3056         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3057         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  3058         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3059         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  3060         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3061         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  3062         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3063         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3064         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3065         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3066         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3067         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3068         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  3069         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  3070         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  3071         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  3072         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3073         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  3074         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  3075         16  RWF-REM-SW              PIC X.                       ECSRITAB
  3076         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  3077         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  3078         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  3079         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
  3080                                                                  ECSRITAB
  3081     12  WT-COMP-INFO.                                            ECSRITAB
  3082         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  3083         16  WT-LF-QC                PIC X.                       ECSRITAB
  3084         16  WT-AH-QC                PIC X.                       ECSRITAB
  3085         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  3086         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  3087         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  3088         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  3089         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3090         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  3091         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3092         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3093         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  3094         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  3095         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3096         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  3097         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  3098         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  3099         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  3100         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  3101         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3102         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3103         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3104         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3105         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  3106         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  3107         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  3108         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  3109         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  3110         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  3111         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  3112         16  WT-REMAINING            PIC X.                       ECSRITAB
  3113         16  FILLER                  PIC X(21).                   ECSRITAB
  3114                                                                  ECSRITAB
  3115 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  3116     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  3117     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  3118     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  3119     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  3120     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  3121     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  3122     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3123     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3124     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3125     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3126     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  3127     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  3128     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3129     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3130     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3131     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  3132     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3133     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  3134     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3135     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3136     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3137     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3138     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  3139     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  3140                                                                  ECSRITAB
  3141     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3142         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  3143     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  3144         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  3145     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  3146         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  3147     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3148         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  3149     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  3150         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  3151     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  3152         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  3153                                                                  ECSRITAB
  3154     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  3155         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  3156         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  3157         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  3158         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  3159         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  3160         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  3161         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  3162         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  3163         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  3164         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  3165         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  3166         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  3167         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  3168         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  3169         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  3170         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  3171         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  3172         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  3173         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  3174         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  3175         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  3176         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  3177         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  3178     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  3179     12  REIN-SEARCH.                                             ECSRITAB
  3180         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  3181         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  3182         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  3183         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  3184     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  3185     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  3186     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3187     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3188     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  3189     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3190     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3191     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3192     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3193     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3194     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3195     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3196     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3197     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  3198     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3199     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3200     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  3201     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  3202     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  3203     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3204     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3205     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  3206     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3207     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  3208     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  3209                                                                  ECSRITAB
  3210 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  3211* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  3212     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3213         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  3214         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  3215         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  3216         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  3217         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  3218         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3219         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3220         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3221         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  3222                                                                  ECSRITAB
  3223 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  3224     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  3225         16  RC2-REIN-CO.                                         ECSRITAB
  3226             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  3227             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  3228         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3229         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3230         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3231         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  3232         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  3233         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  3234                                                                  ECSRITAB
  3235 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  3236     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  3237         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  3238         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  3239     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  3240                                                                  ECSRITAB
  3241 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  3242     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  3243         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  3244         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  3245         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  3246 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  3247     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  3248         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  3249                                                                  ECSRITAB
  3250 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  3251******************************************************************ECSRITAB
  3252
* 3253                             COPY ELCPSEVR.
  3254******************************************************************04/16/98
  3255*                                                                *ELCPSEVR
  3256*                                                                *ELCPSEVR
  3257*                            ELCPSEVR                            *   LV003
  3258*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3259*                            VMOD=2.001                          *ELCPSEVR
  3260*                                                                *ELCPSEVR
  3261*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3262*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3263*                                                                *ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3264******************************************************************ELCPSEVR
  3265                                                                  ELCPSEVR
  3266 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3267     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3268         10  FILLER               PIC 999.                        ELCPSEVR
  3269         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3270         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3271             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3272             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3273         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3274         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3275     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3276            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3277     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3278         10  FILLER              PIC 999.                         ELCPSEVR
  3279         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3280         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3281             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3282             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3283         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
  3284         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3285     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3286            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3287 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3288     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3289                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3290         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3291             15  FILLER              PIC 999.                     ELCPSEVR
  3292             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3293             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3294                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3295                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3296             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3297             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3298         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3299                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3300         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3301             15  FILLER              PIC 999.                     ELCPSEVR
  3302             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3303             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3304                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3305                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3306             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3307             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3308         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3309                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3310         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3311             15  FILLER              PIC 999.                     ELCPSEVR
  3312             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3313             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3314                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3315                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3316             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3317             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3318         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3319                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3320     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3321         10  FILLER              PIC 999.                         ELCPSEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3322         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3323         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3324             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3325             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3326         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3327         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3328     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3329            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
  3330
* 3331                             COPY ELCEPCVR.
  3332******************************************************************05/15/98
  3333*                                                                *ELCEPCVR
  3334*                                                                *ELCEPCVR
  3335*                            ELCEPCVR                            *   LV003
  3336*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3337*                            VMOD=2.001                          *ELCEPCVR
  3338*                                                                *ELCEPCVR
  3339*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  3340*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  3341*                                                                *ELCEPCVR
  3342******************************************************************ELCEPCVR
  3343 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  3344     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  3345         10  FILLER            PIC 999.                           ELCEPCVR
  3346         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  3347         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  3348             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  3349             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  3350         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  3351         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  3352     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  3353            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  3354     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  3355         10  FILLER            PIC 999.                              CL**5
  3356         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  3357         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  3358             15  EC-EXP-CC     PIC 99.                               CL**5
  3359             15  EC-EXP-YR     PIC 99.                               CL**5
  3360         10  EC-EXP-MO         PIC 99.                               CL**5
  3361         10  EC-EXP-DA         PIC 99.                               CL**5
  3362     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  3363            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  3364     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  3365         10  FILLER            PIC 999.                           ELCEPCVR
  3366         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  3367         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  3368             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  3369             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  3370         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  3371         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  3372     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  3373            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  3374     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  3375         10  FILLER            PIC 999.                              CL**5
  3376         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  3377         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  3378             15  EC-EFF-CC     PIC 99.                               CL**5
  3379             15  EC-EFF-YR     PIC 99.                               CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  3380         10  EC-EFF-MO         PIC 99.                               CL**5
  3381         10  EC-EFF-DA         PIC 99.                               CL**5
  3382     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  3383            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  3384     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  3385         10  FILLER            PIC 999.                           ELCEPCVR
  3386         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  3387         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  3388             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  3389             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  3390         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  3391         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  3392     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  3393            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  3394     05  WS-EP-HI-CERT.                                           ELCEPCVR
  3395         10  FILLER            PIC 999.                           ELCEPCVR
  3396         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  3397         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  3398             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  3399             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  3400         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  3401         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  3402     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  3403            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  3404     05  WS-EP-LO-CERT.                                           ELCEPCVR
  3405         10  FILLER            PIC 999.                           ELCEPCVR
  3406         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  3407         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  3408             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  3409             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  3410         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  3411         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  3412     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  3413            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  3414     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  3415         10  FILLER            PIC 999.                           ELCEPCVR
  3416         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3417         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  3418             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  3419             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  3420         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  3421         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  3422     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  3423            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  3424     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  3425         10  FILLER            PIC 999.                           ELCEPCVR
  3426         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  3427         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  3428             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  3429             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  3430         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  3431         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  3432     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  3433            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  3434
* 3435                             COPY ELCREINV.
  3436******************************************************************04/18/98
  3437*                                                                *ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3438*                                                                *ELCREINV
  3439*                            ELCREINV                            *   LV003
  3440*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3441*                            VMOD=2.001                          *ELCREINV
  3442*                                                                *ELCREINV
  3443*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCREINV
  3444*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCREINV
  3445*                                                                *ELCREINV
  3446******************************************************************ELCREINV
  3447                                                                  ELCREINV
  3448 01  WS-REINSURANCE-RECORD-DATE.                                  ELCREINV
  3449     05  WS-RE-LO-DATE.                                              CL**3
  3450         10 FILLER                     PIC 999.                      CL**3
  3451         10 RE-LO-CCYY                 PIC 9(04).                    CL**3
  3452         10 RE-LO-CCYR  REDEFINES  RE-LO-CCYY.                       CL**3
  3453            15 RE-LO-CC                PIC 99.                       CL**3
  3454            15 RE-LO-YR                PIC 99.                       CL**3
  3455         10 RE-LO-MO                   PIC 99.                       CL**3
  3456         10 RE-LO-DA                   PIC 99.                       CL**3
  3457     05  WS-RE-LO-DATE-N REDEFINES                                   CL**3
  3458            WS-RE-LO-DATE              PIC 9(11).                    CL**3
  3459     05  WS-RE-HI-DATE.                                              CL**3
  3460         10 FILLER                     PIC 999.                      CL**3
  3461         10 RE-HI-CCYY                 PIC 9(04).                    CL**3
  3462         10 RE-HI-CCYR  REDEFINES  RE-HI-CCYY.                       CL**3
  3463            15 RE-HI-CC                PIC 99.                       CL**3
  3464            15 RE-HI-YR                PIC 99.                       CL**3
  3465         10 RE-HI-MO                   PIC 99.                       CL**3
  3466         10 RE-HI-DA                   PIC 99.                       CL**3
  3467     05  WS-RE-HI-DATE-N REDEFINES                                   CL**3
  3468            WS-RE-HI-DATE              PIC 9(11).                    CL**3
  3469     05  WS-RE-CLM-INCURRED-LIM.                                  ELCREINV
  3470         10 FILLER                     PIC 999.                   ELCREINV
  3471         10 RE-CLM-CCYY                PIC 9(04).                 ELCREINV
  3472         10 RE-CLM-CCYR  REDEFINES  RE-CLM-CCYY.                  ELCREINV
  3473            15 RE-CLM-CC               PIC 99.                    ELCREINV
  3474            15 RE-CLM-YR               PIC 99.                    ELCREINV
  3475         10 RE-CLM-MO                  PIC 99.                    ELCREINV
  3476         10 RE-CLM-DA                  PIC 99.                    ELCREINV
  3477     05  WS-RE-CLM-INCURRED-LIM-N REDEFINES                          CL**2
  3478            WS-RE-CLM-INCURRED-LIM     PIC 9(11).                    CL**2
  3479     05  WS-RE-EARNING-START-DT.                                  ELCREINV
  3480         10  FILLER                    PIC 999.                   ELCREINV
  3481         10  RE-EARN-CCYY              PIC 9(04).                 ELCREINV
  3482         10  RE-EARN-CCYR  REDEFINES  RE-EARN-CCYY.               ELCREINV
  3483             15  RE-EARN-CC            PIC 99.                    ELCREINV
  3484             15  RE-EARN-YR            PIC 99.                    ELCREINV
  3485         10  RE-EARN-MO                PIC 99.                    ELCREINV
  3486         10  RE-EARN-DA                PIC 99.                    ELCREINV
  3487     05  WS-RE-EARNING-START-DT-N REDEFINES                          CL**2
  3488            WS-RE-EARNING-START-DT     PIC 9(11).                    CL**2
  3489     05  WS-RE-EARNING-STOP-DT.                                   ELCREINV
  3490         10  FILLER                    PIC 999.                   ELCREINV
  3491         10  RE-EARN-STOP-CCYY         PIC 9(04).                 ELCREINV
  3492         10  RE-EARN-STOP-CCYR  REDEFINES  RE-EARN-STOP-CCYY.     ELCREINV
  3493             15  RE-EARN-STOP-CC       PIC 99.                    ELCREINV
  3494             15  RE-EARN-STOP-YR       PIC 99.                    ELCREINV
  3495         10  RE-EARN-STOP-MO           PIC 99.                    ELCREINV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCREINV)
  3496         10  RE-EARN-STOP-DA           PIC 99.                    ELCREINV
  3497     05  WS-RE-EARNING-STOP-DT-N REDEFINES                           CL**2
  3498            WS-RE-EARNING-STOP-DT      PIC 9(11).                    CL**2
  3499
  3500 01  RC-REIN-HOLD-AREAS.
  3501     12  RC-REIN-LEVELS  OCCURS 30.
  3502         16  RC-REIN-COMP    PIC X(6).
  3503         16  RC-OLD-ISS      PIC X.
  3504         16  RC-NEW-ISS      PIC X.
  3505         16  RC-OLD-CNC      PIC X.
  3506         16  RC-NEW-CNC      PIC X.
  3507         16  RC-OLD-LF-CLM   PIC X.
  3508         16  RC-OLD-AH-CLM   PIC X.
  3509         16  RC-NEW-LF-CLM   PIC X.
  3510         16  RC-NEW-AH-CLM   PIC X.
  3511         16  RC-REIN-LFAMT   PIC S9(9)V99    COMP-3.
  3512         16  RC-REIN-LFPRM   PIC S9(7)V99    COMP-3.
  3513         16  RC-REIN-AHAMT   PIC S9(7)V99    COMP-3.
  3514         16  RC-REIN-AHPRM   PIC S9(7)V99    COMP-3.
  3515         16  RC-REIN-LFRFND  PIC S9(7)V99    COMP-3.
  3516         16  RC-REIN-AHRFND  PIC S9(7)V99    COMP-3.
  3517         16  RC-REIN-LFCLM   PIC S9(9)V99    COMP-3.
  3518         16  RC-REIN-AHCLM   PIC S9(9)V99    COMP-3.
  3519         16  RC-REIN-REM-SW  PIC X.
  3520     12  RC-REIN-LEVELS-END  PIC X(6).
  3521
  3522 01  TOTAL-PAGES-COUNTERS    COMP-3.
  3523     12  TPC-COUNTERS    OCCURS 6.
  3524         16  TPL-ISS-PRM     PIC S9(9)V99.
  3525         16  TPA-ISS-PRM     PIC S9(9)V99.
  3526         16  TPL-CNC-PRM     PIC S9(9)V99.
  3527         16  TPA-CNC-PRM     PIC S9(9)V99.
  3528         16  TPL-ACCT-COM    PIC S9(9)V99.
  3529         16  TPA-ACCT-COM    PIC S9(9)V99.
  3530         16  TPL-CLAIMS      PIC S9(9)V99.
  3531         16  TPA-CLAIMS      PIC S9(9)V99.
  3532
  3533 01  HLD-DTS SYNC.
  3534     12  EOM-RUN-DATE        PIC 9(08).
  3535     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  3536         16  EOM-CCYY.
  3537             20  EOM-CC      PIC 99.
  3538             20  EOM-YR      PIC 99.
  3539         16  EOM-MO          PIC 99.
  3540         16  EOM-DA          PIC 99.
  3541
  3542****   1ST OCCURRENCE IS MONTHEND DATE MINUS ONE MONTH
  3543****   2ND OCCURRENCE IS MONTHEND DATE MINUS TWO MONTHS
  3544     12  OB-RUN-DATES OCCURS 2.
  3545         16  OB-CCYY         PIC 9(4).
  3546         16  OB-MO           PIC 99.
  3547         16  OB-DA           PIC 99.
  3548
  3549     12  OB-DATE-1-SWITCH    PIC X           VALUE SPACE.
  3550         88  OB-DATE-1-USED     VALUE '*'.
  3551     12  OB-DATE-2-SWITCH    PIC X           VALUE SPACE.
  3552         88  OB-DATE-2-USED     VALUE '*'.
  3553     12  OB-DATE-3-SWITCH    PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS010V.cbl
  3554         88  OB-DATE-3-USED     VALUE '*'.
  3555     12  EARNING-START-DATE  PIC 9(08).
  3556     12  EARNING-START-DATE-R REDEFINES  EARNING-START-DATE.
  3557         16  E-ERN-START-CC  PIC 99.
  3558         16  E-ERN-START-YR  PIC 99.
  3559         16  E-ERN-START-MO  PIC 99.
  3560         16  E-ERN-START-DA  PIC 99.
  3561     12  EARNING-STOP-DATE   PIC 9(08).
  3562     12  EARNING-STOP-DATE-R REDEFINES  EARNING-STOP-DATE.
  3563         16  E-ERN-STOP-CC   PIC 99.
  3564         16  E-ERN-STOP-YR   PIC 99.
  3565         16  E-ERN-STOP-MO   PIC 99.
  3566         16  E-ERN-STOP-DA   PIC 99.
  3567     12  STOP-LF-DATE        PIC 9(08).
  3568     12  STOP-LF-DATE-R REDEFINES STOP-LF-DATE.
  3569         16  STOP-LF-CC      PIC 99.
  3570         16  STOP-LF-YR      PIC 99.
  3571         16  STOP-LF-MO      PIC 99.
  3572         16  STOP-LF-DA      PIC 99.
  3573     12  STOP-AH-DATE        PIC 9(08).
  3574     12  STOP-AH-DATE-R REDEFINES STOP-AH-DATE.
  3575         16  STOP-AH-CC      PIC 99.
  3576         16  STOP-AH-YR      PIC 99.
  3577         16  STOP-AH-MO      PIC 99.
  3578         16  STOP-AH-DA      PIC 99.
  3579     12  BIN-VALUATION-DT    PIC XX.
  3580     12  BIN-EOM-RUN-DATE    PIC XX.
  3581     12  LAST-YRS-DATE       PIC 9(08).
  3582     12  LAST-YRS-DATE-R  REDEFINES  LAST-YRS-DATE.
  3583         16  LYD-CCYY        PIC 9(04).
  3584         16  LYD-CCYR REDEFINES LYD-CCYY.
  3585             20  LYD-CC      PIC 99.
  3586             20  LYD-YR      PIC 99.
  3587         16  LYD-MO          PIC 99.
  3588         16  LYD-DA          PIC 99.
  3589     12  VALUATION-DT        PIC 9(08)  VALUE 0.
  3590     12  VALUATION-DT-R REDEFINES VALUATION-DT.
  3591         16  VAL-CC          PIC 99.
  3592         16  VAL-YR          PIC 99.
  3593         16  VAL-MO          PIC 99.
  3594         16  VAL-DA          PIC 99.
  3595     12  INCURRED-DATE       PIC 9(08).
  3596     12  INCURRED-DATE-R REDEFINES INCURRED-DATE.
  3597         16  DTO-CC          PIC 99.
  3598         16  DTO-YR          PIC 99.
  3599         16  DTO-MO          PIC 99.
  3600         16  DTO-DA          PIC 99.
  3601     12  REPORTED-DATE.
  3602         16  RPT-YR          PIC 99.
  3603         16  RPT-MO          PIC 99.
  3604         16  RPT-DA          PIC 99.
  3605     12  PAYMENT-DATE        PIC 9(08).
  3606     12  PAYMENT-DATE-R REDEFINES PAYMENT-DATE.
  3607         16  PAY-CC          PIC 99.
  3608         16  PAY-YR          PIC 99.
  3609         16  PAY-MO          PIC 99.
  3610         16  PAY-DA          PIC 99.
  3611     12  PAY-TO-DATE         PIC 9(8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS010V.cbl
  3612     12  PAY-TO-DATE-R  REDEFINES PAY-TO-DATE.
  3613         16  PAYTO-CC        PIC 99.
  3614         16  PAYTO-YR        PIC 99.
  3615         16  PAYTO-MO        PIC 99.
  3616         16  PAYTO-DA        PIC 99.
  3617
  3618 01  AH-RES-STATE-TABLE.
  3619     12  FILLER              PIC X(42)       VALUE
  3620             'AKALAZCADEGAIDILKSKYLAMDMIMTNVOHORSCSDWIWY'.
  3621     12  FILLER              PIC XX          VALUE HIGH-VALUES.
  3622
  3623 01  AH-RES-STATE-TAB REDEFINES AH-RES-STATE-TABLE.
  3624     12  AH-RES-STATE-ENT    PIC XX      OCCURS 22 TIMES.
  3625
  3626 01  BILLING-COUNTERS    COMP-3.
  3627     12  BC-NET-WRIT         PIC S9(7)V99        VALUE +0.
  3628     12  BC-NET-WRIT-SP      PIC S9(7)V99        VALUE +0.
  3629     12  BC-NET-WRIT-OB      PIC S9(7)V99        VALUE +0.
  3630     12  BC-G-ISS            PIC S9(5)           VALUE +0.
  3631     12  BC-G-CNC            PIC S9(5)           VALUE +0.
  3632     12  BC-G-CLM            PIC S9(5)           VALUE +0.
  3633     12  BC-G-CRS            PIC S9(5)           VALUE +0.
  3634     12  BC-G-CTN            PIC S9(5)           VALUE +0.
  3635     12  BC-R-ISS            PIC S9(5)           VALUE +0.
  3636     12  BC-R-CNC            PIC S9(5)           VALUE +0.
  3637     12  BC-R-CLM            PIC S9(5)           VALUE +0.
  3638     12  BC-R-CRS            PIC S9(5)           VALUE +0.
  3639     12  BC-R-CTN            PIC S9(5)           VALUE +0.
  3640     12  BC-COMM             PIC S9(5)           VALUE +0.
  3641     12  BC-NEW-ACCTS        PIC S9(5)           VALUE +0.
  3642     12  BC-ACCTS            PIC S9(5)           VALUE +0.
  3643     12  BC-ACT-ACCTS        PIC S9(5)           VALUE +0.
  3644     12  BC-G-CERTS          PIC S9(7)           VALUE +0.
  3645     12  BC-G-A-CERTS        PIC S9(7)           VALUE +0.
  3646     12  BC-R-CERTS          PIC S9(7)           VALUE +0.
  3647     12  BC-R-A-CERTS        PIC S9(7)           VALUE +0.
  3648     12  BC-ER-ACCTS         PIC S9(5)           VALUE +0.
  3649     12  BC-CS-ACCTS         PIC S9(5)           VALUE +0.
  3650     12  ACTIVE-COUNT        PIC S9              VALUE +0.
  3651
  3652 01  FLAGS SYNC.
  3653     12  BILLED-SWITCH           PIC X           VALUE 'N'.
  3654         88  CHECK-BILLED                        VALUE 'Y'.
  3655     12  TRANS-EOF-FLAG          PIC X           VALUE SPACE.
  3656         88  EOF-ON-TRANS                        VALUE '*'.
  3657     12  CERT-EOF-FLAG           PIC X           VALUE SPACE.
  3658         88  EOF-ON-CERT                         VALUE '*'.
  3659     12  PROCESSING-FLAG         PIC X           VALUE SPACE.
  3660         88  PROCESSING-COMPLETED                VALUE '*'.
  3661     12  DEATH-VOID-FLAG         PIC X           VALUE SPACE.
  3662         88  DEATH-CLAIM-VOIDED                  VALUE '*'.
  3663     12  CERT-CHANGE-FLAG        PIC X           VALUE SPACE.
  3664         88  PRINTING-CERT-CHANGES               VALUE '*'.
  3665     12  STATUTORY-SWITCH        PIC X           VALUE SPACE.
  3666         88  STATUTORY-REQUIREMENT               VALUE '*'.
  3667     12  STATUTORY-SWITCH-AH     PIC X           VALUE SPACE.
  3668         88  STATUTORY-REQUIREMENT-AH            VALUE '*'.
  3669     12  LIFE-EARNED-SWITCH      PIC X           VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS010V.cbl
  3670         88  LIFE-FULLY-EARNED                   VALUE '*'.
  3671     12  A-H-EARNED-SWITCH       PIC X           VALUE SPACE.
  3672         88  A-H-FULLY-EARNED                    VALUE '*'.
  3673     12  CNCL-FLG            PIC X               VALUE SPACE.
  3674     12  TRANSACTION-FLAG    PIC X               VALUE SPACE.
  3675         88  NO-TRANSACTION-WAS-PROCESSED    VALUE SPACE.
  3676         88  TRANSACTION-WAS-PROCESSED       VALUE '*'.
  3677     12  RISK-REIN-FLAG      PIC X               VALUE SPACE.
  3678         88  REIN-IS-RISK-PREMIUM            VALUE '*'.
  3679     12  RISK-PREM-FLAG      PIC X               VALUE SPACE.
  3680         88  UPDATING-RISK-PREMIUMS          VALUE '*'.
  3681     12  EP-FLG              PIC X               VALUE SPACE.
  3682     12  END-FLG             PIC X               VALUE SPACE.
  3683     12  PRIOR-MATCH-CNTRL   PIC X(36)           VALUE LOW-VALUE.
  3684     12  PRIOR-CERT-IN-CNTRL PIC X(36)           VALUE LOW-VALUE.
  3685     12  ACCT-FLG            PIC X               VALUE SPACE.
  3686     12  STATE-FLG           PIC X               VALUE SPACE.
  3687     12  COMP-FLG            PIC X               VALUE SPACE.
  3688     12  CARR-FLG            PIC X               VALUE SPACE.
  3689     12  FINAL-FLG           PIC X               VALUE SPACE.
  3690     12  LOW-CTL             PIC X(19)           VALUE SPACES.
  3691     12  REIN-FLG            PIC X               VALUE SPACE.
  3692     12  REIN-EP-FLG         PIC X               VALUE SPACE.
  3693     12  REIN-RT-SW          PIC X               VALUE SPACE.
  3694
  3695 01  TEXAS-REG-WORK-AREAS   SYNC.
  3696     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  3697     12  TEX-FACT-2          PIC S999        COMP-3.
  3698     12  TEX-FACT-3          PIC S999        COMP-3.
  3699     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  3700     12  TEX-FACT-5          PIC S999        COMP-3.
  3701     12  TEX-FACT-6          PIC S999        COMP-3.
  3702     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  3703     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  3704     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  3705
  3706 01  NET-PAY-INTERFACE.
  3707     12  NP-APR              PIC S999V9(4)   COMP-3.
  3708     12  NP-ORIG             PIC S999        COMP-3.
  3709     12  NP-REM              PIC S999        COMP-3.
  3710     12  NP-OPT              PIC X.
  3711     12  NP-CAP              PIC S999        COMP-3.
  3712     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  3713     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  3714     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  3715     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  3716     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  3717     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  3718     12  NP-ACCOUNT          PIC X(10).
  3719
  3720 01  HOLDERS SYNC.
  3721     12  DIS-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3722     12  DIS-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3723     12  DIS-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3724     12  DTH-IBNR            PIC S9(7)V99 COMP-3 VALUE +0.
  3725     12  DTH-PAYCUR          PIC S9(7)V99 COMP-3 VALUE +0.
  3726     12  DTH-FUTRSV          PIC S9(7)V99 COMP-3 VALUE +0.
  3727     12  EXCESS-RESERVE      PIC S9(7)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS010V.cbl
  3728     12  H-LFCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3729     12  H-AHCM              PIC S9(9)V99 COMP-3 VALUE +0.
  3730     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  3731     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  3732     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  3733     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  3734     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  3735     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  3736     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  3737     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  3738     12  REM-TRM1            PIC S999V99  COMP-3.
  3739     12  REM-TRM2            PIC S999V99  COMP-3.
  3740     12  REM-TRM3            PIC S999V99  COMP-3.
  3741     12  TEM-TRM1            PIC S999V99  COMP-3.
  3742     12  MAX-REM-TERM        PIC S999V99  COMP-3.
  3743     12  ORIG-TERM           PIC S999V99  COMP-3.
  3744     12  HLD-CONTROL.
  3745         16  HLD-CARRIER     PIC X               VALUE SPACES.
  3746         16  HLD-GROUPING    PIC X(6)            VALUE SPACES.
  3747         16  HLD-STATE       PIC XX              VALUE SPACES.
  3748         16  HLD-ACCT        PIC X(10)           VALUE SPACES.
  3749     12  LN-MX               PIC S999     COMP-3 VALUE +56.
  3750
  3751 01  DISPLAY-IBNR-LINE.
  3752     05  FILLER                  PIC X       VALUE SPACES.
  3753     05  DIL-COMMENT             PIC X(20)   VALUE SPACES.
  3754     05  FILLER                  PIC XX      VALUE SPACES.
  3755     05  DIL-TYPE                PIC X       VALUE SPACES.
  3756     05  FILLER                  PIC X       VALUE SPACES.
  3757     05  DIL-BEN-CODE            PIC ZZ      VALUE SPACES.
  3758     05  FILLER                  PIC XXX     VALUE SPACES.
  3759     05  DIL-AMOUNT              PIC ZZZ9.99999-.
  3760
  3761 01  DISPLAY-HD-1.
  3762     05  FILLER      PIC X       VALUE SPACES.
  3763     05  FILLER      PIC X(50)   VALUE SPACES.
  3764     05  FILLER      PIC X(23)   VALUE 'PROCESSING ERROR REPORT'.
  3765     05  FILLER      PIC X(51)   VALUE SPACES.
  3766     05  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3767
  3768 01  DISPLAY-HD-2.
  3769     05  FILLER                 PIC X       VALUE SPACE.
  3770     05  FILLER                 PIC X(57)   VALUE SPACES.
  3771     05  DIS-DATE               PIC X(8).
  3772     05  FILLER                 PIC X(66)   VALUE SPACES.
  3773
  3774 01  DISPLAY-LINE.
  3775     05  DL-FULL.
  3776         10  FILLER           PIC X       VALUE SPACE.
  3777         10  DIS-LINE-REASON  PIC X(32)   VALUE SPACES.
  3778         10  DIS-LINE-REC     PIC X(100)  VALUE SPACES.
  3779
  3780 01  PRT-HDNGS SYNC.
  3781     12  TR-HD-1.
  3782         16  FILLER      PIC X       VALUE '1'.
  3783         16  FILLER      PIC X(53)   VALUE SPACES.
  3784         16  FILLER      PIC X(18)   VALUE 'TRANSACTION REPORT'.
  3785         16  FILLER      PIC X(48)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS010V.cbl
  3786         16  FILLER      PIC X(8)    VALUE 'ECS010 '.
  3787     12  TR-HD-2.
  3788         16  FILLER      PIC X       VALUE SPACE.
  3789         16  FILLER      PIC X(47)   VALUE SPACES.
  3790         16  TRHDNM      PIC X(30).
  3791         16  FILLER      PIC X(42)   VALUE SPACES.
  3792         16  TR-RN-DT    PIC X(8).
  3793     12  TR-HD-3.
  3794         16  FILLER      PIC X       VALUE SPACE.
  3795         16  FILLER      PIC X(53)   VALUE SPACES.
  3796         16  TR-MODAYR   PIC X(18).
  3797         16  FILLER      PIC X       VALUE SPACE.
  3798         16  TR-YRASK    PIC X       VALUE SPACE.
  3799         16  FILLER      PIC X(46)   VALUE SPACES.
  3800         16  FILLER      PIC X(5)    VALUE 'PAGE '.
  3801         16  TR-PG       PIC ZZ,ZZ9.
  3802     12  TR-HD-4.
  3803         16  FILLER      PIC X       VALUE SPACE.
  3804         16  TR-AGCY     PIC X(30).
  3805     12  TR-HD-5.
  3806         16  FILLER      PIC X       VALUE SPACE.
  3807         16  TR-CARR     PIC X.
  3808         16  FILLER      PIC X       VALUE '-'.
  3809         16  TR-GROUP    PIC X(6).
  3810         16  FILLER      PIC X       VALUE '-'.
  3811         16  TR-ST-NO    PIC X(2).
  3812         16  FILLER      PIC X       VALUE '-'.
  3813         16  TR-AG-NO    PIC X(10).
  3814         16  FILLER      PIC X(23)   VALUE SPACES.
  3815         16  TR5-RP-TYP.
  3816             20  FILLER  PIC X(20)   VALUE
  3817                     '* * * * TRANSACTION '.
  3818             20  FILLER  PIC X(15)   VALUE 'LISTING * * * *'.
  3819     12  TR-HD-6.
  3820         16  FILLER      PIC X       VALUE SPACE.
  3821         16  TR-CE-MO    PIC XX.
  3822         16  FILLER      PIC X       VALUE '-'.
  3823         16  TR-CE-DA    PIC XX.
  3824         16  FILLER      PIC X       VALUE '-'.
  3825         16  TR-CE-YR    PIC XX.
  3826         16  FILLER      PIC X(6)    VALUE '  TO  '.
  3827         16  TR-CX.
  3828             20  TR-CX-MO PIC XX.
  3829             20  HSHR1    PIC X.
  3830             20  TR-CX-DA PIC XX.
  3831             20  HSHR2    PIC X.
  3832             20  TR-CX-YR PIC XX.
  3833     12  TR-HD-7.
  3834         16  FILLER  PIC X      VALUE '0'.
  3835         16  FILLER  PIC X(24)  VALUE SPACES.
  3836         16  FILLER  PIC X(19)  VALUE '*----------------- '.
  3837         16  TR-7-LF PIC X(6).
  3838         16  FILLER  PIC X(9)   VALUE ' COVERAGE'.
  3839         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
  3840         16  FILLER  PIC X(20)  VALUE '  *---------------- '.
  3841         16  TR-7-AH PIC X(6).
  3842         16  FILLER  PIC X(10)  VALUE ' COVERAGE '.
  3843         16  FILLER  PIC X(19)  VALUE ' -----------------*'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS010V.cbl
  3844     12  TR-HD-8.
  3845         16  FILLER  PIC X      VALUE SPACE.
  3846         16  FILLER  PIC X(24)  VALUE '   CERT      ISSUE      '.
  3847         16  FILLER  PIC X(24)  VALUE '        PREMIUM    COMMI'.
  3848         16  FILLER  PIC X(24)  VALUE 'SSION   ACTION          '.
  3849         16  FILLER  PIC X(24)  VALUE '                PREMIUM '.
  3850         16  FILLER  PIC X(22)  VALUE '   COMMISSION   ACTION'.
  3851     12  TR-HD-9.
  3852         16  FILLER  PIC X      VALUE SPACE.
  3853         16  FILLER  PIC X(24)  VALUE '  NUMBER      DATE  AGE '.
  3854         16  FILLER  PIC X(24)  VALUE 'TYP TRM  / REFUND    /  '.
  3855         16  FILLER  PIC X(24)  VALUE 'CLAIM    DATE     ACTION'.
  3856         16  FILLER  PIC X(24)  VALUE '  ST    TYP TRM  / REFUN'.
  3857         16  FILLER  PIC X(24)  VALUE 'D    /  CLAIM    DATE   '.
  3858         16  FILLER  PIC X(12)  VALUE '  ACTION  ST'.
  3859     12  TR-TTL-HD.
  3860         16  FILLER      PIC X       VALUE '0'.
  3861         16  TTL-PT-CNT  PIC ZZZZ,ZZZ,ZZZ,ZZ9.
  3862         16  FILLER      PIC XX      VALUE SPACES.
  3863         16  TTL-HD-DS   PIC X(60)   VALUE
  3864             'ECS010 CONTROL TOTALS'.
  3865
  3866 01  TR-DTL.
  3867     12  FILLER                  PIC X           VALUE SPACE.
  3868     12  TR-DTL1.
  3869         16  TRD-CERT            PIC X(11).
  3870         16  TRD-ISDT.
  3871             20  FILLER          PIC X           VALUE SPACE.
  3872             20  TRD-ISMO        PIC XX.
  3873             20  TRD-IS-S1       PIC X           VALUE '/'.
  3874             20  TRD-ISDA        PIC XX.
  3875             20  TRD-IS-S2       PIC X           VALUE '/'.
  3876             20  TRD-ISYR        PIC XX.
  3877             20  FILLER          PIC X           VALUE SPACE.
  3878         16  TRD-AGE             PIC XX.
  3879     12  TR-DTL2.
  3880         16  FILLER              PIC X           VALUE SPACE.
  3881         16  TRD-LFTYP           PIC XXX.
  3882         16  FILLER              PIC X           VALUE SPACE.
  3883         16  TRD-LFTRM           PIC ZZ9.
  3884         16  TRD-LFPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
  3885         16  TRD-LFCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3886         16  TRD-LFACTDT.
  3887             20  FILLER          PIC X           VALUE SPACE.
  3888             20  TRD-LFACTMO     PIC XX.
  3889             20  TRD-LF-S1       PIC X           VALUE '/'.
  3890             20  TRD-LFACTDA     PIC XX.
  3891             20  TRD-LF-S2       PIC X           VALUE '/'.
  3892             20  TRD-LFACTYR     PIC XX.
  3893             20  FILLER          PIC X           VALUE SPACE.
  3894         16  TRD-LF-ACTION       PIC X(10)       VALUE SPACE.
  3895         16  FILLER              PIC X           VALUE SPACE.
  3896         16  TRD-LF-STATUS       PIC X.
  3897         16  FILLER              PIC X(4)        VALUE SPACE.
  3898         16  TRD-AHTYP           PIC XXX.
  3899         16  FILLER              PIC X           VALUE SPACE.
  3900         16  TRD-AHTRM           PIC ZZ9.
  3901         16  TRD-AHPRM-RFND      PIC ZZZZ,ZZZ.99  BLANK WHEN ZERO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS010V.cbl
  3902         16  TRD-AHCOM-CLM       PIC ZZZZ,ZZZ.99- BLANK WHEN ZERO.
  3903         16  TRD-AHACTDT.
  3904             20  FILLER          PIC X           VALUE SPACE.
  3905             20  TRD-AHACTMO     PIC XX.
  3906             20  TRD-AH-S1       PIC X           VALUE '/'.
  3907             20  TRD-AHACTDA     PIC XX.
  3908             20  TRD-AH-S2       PIC X           VALUE '/'.
  3909             20  TRD-AHACTYR     PIC XX.
  3910             20  FILLER          PIC X           VALUE SPACE.
  3911         16  TRD-AH-ACTION       PIC X(10)       VALUE SPACE.
  3912         16  FILLER              PIC X           VALUE SPACE.
  3913         16  TRD-AH-STATUS       PIC X.
  3914     12  TR-DTL3 REDEFINES TR-DTL2.
  3915         16  FILLER              PIC X(20).
  3916         16  TRD-IBNR            PIC ZZZ,ZZZ.99-.
  3917         16  FILLER              PIC X.
  3918         16  TRD-IBNRX           PIC X(4).
  3919         16  FILLER              PIC X(2).
  3920         16  TRD-PAYCUR          PIC ZZZ,ZZZ.99-.
  3921         16  TRD-PAYCUR-SPACE REDEFINES TRD-PAYCUR
  3922                                 PIC X(11).
  3923         16  FILLER              PIC X.
  3924         16  TRD-PAYCURX         PIC X(8).
  3925         16  FILLER              PIC X(2).
  3926         16  TRD-FUTRSV-DATA.
  3927             20  TRD-FUTRSV      PIC ZZZ,ZZZ.99-.
  3928             20  TRD-FUTRSV-SPACE REDEFINES TRD-FUTRSV
  3929                                 PIC X(11).
  3930             20  FILLER          PIC X.
  3931             20  TRD-FUTRSVX     PIC X(6).
  3932         16  TRD-BENEFIT-DATA REDEFINES TRD-FUTRSV-DATA.
  3933             20  TRD-BENEFIT-X   PIC X(10).
  3934             20  TRD-BENEFIT-CODE
  3935                                 PIC X(02).
  3936             20  FILLER          PIC X(06).
  3937         16  FILLER              PIC X(4).
  3938         16  TRD-RSV-DESC        PIC X(6).
  3939         16  TRD-RSV-ACTION      PIC X(21).
  3940
  3941 01  DET-PR-UREC.
  3942     12  FILLER              PIC X(7)     VALUE ' AGE - '.
  3943     12  DET-AGE             PIC 99         BLANK WHEN ZERO.
  3944     12  FILLER              PIC X(11)    VALUE ' JT. AGE - '.
  3945     12  DET-JT-AGE          PIC 99         BLANK WHEN ZERO.
  3946     12  FILLER              PIC X(7)     VALUE ' SEX - '.
  3947     12  DET-SEX             PIC X.
  3948     12  FILLER              PIC X(9)     VALUE '   APR - '.
  3949     12  DET-PR-APR          PIC Z9.999     BLANK WHEN ZERO.
  3950     12  FILLER              PIC X(9)     VALUE '  MEM# - '.
  3951     12  DET-PR-MEM          PIC X(12).
  3952     12  FILLER              PIC X(9)     VALUE '   SS# - '.
  3953     12  DET-PR-SS           PIC X(11).
  3954     12  FILLER              PIC XXX      VALUE SPACES.
  3955     12  DET-1-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3956
  3957 01  DET-PR-UREC-2.
  3958     12  FILLER              PIC X        VALUE SPACE.
  3959     12  DET-LF-DESC         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS010V.cbl
  3960     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3961     12  DET-O-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3962     12  FILLER              PIC X(4)     VALUE ' TO '.
  3963     12  DET-N-LF-TERM       PIC 999        BLANK WHEN ZERO.
  3964     12  FILLER              PIC X        VALUE SPACE.
  3965     12  DET-AH-DESC         PIC XX.
  3966     12  FILLER              PIC X(10)    VALUE ' TERM CHG '.
  3967     12  DET-O-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3968     12  FILLER              PIC X(4)     VALUE ' TO '.
  3969     12  DET-N-AH-TERM       PIC 999        BLANK WHEN ZERO.
  3970     12  FILLER              PIC X(12)    VALUE ' OLD LIVES -'.
  3971     12  DET-O-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3972     12  FILLER              PIC X(12)    VALUE ' NEW LIVES -'.
  3973     12  DET-N-LIVES         PIC ZZZZ999    BLANK WHEN ZERO.
  3974     12  FILLER              PIC X(5)     VALUE SPACES.
  3975     12  DET-2-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3976
  3977 01  DET-PR-UREC-3.
  3978     12  FILLER              PIC X(7)     VALUE ' I/G - '.
  3979     12  DET-IND-GRP         PIC X.
  3980     12  FILLER              PIC X(13)    VALUE '  PMT FREQ - '.
  3981     12  DET-PMT-FREQ        PIC 99         BLANK WHEN ZERO.
  3982     12  FILLER              PIC X(14)    VALUE '  POL FORM# - '.
  3983     12  DET-POL-FORM        PIC X(12).
  3984     12  FILLER              PIC X(14)    VALUE '  LOAN OFF# - '.
  3985     12  DET-LOAN-OFFICER    PIC XXX.
  3986     12  FILLER              PIC X(14)    VALUE '  USER CODE - '.
  3987     12  DET-USER-CODE       PIC X.
  3988     12  FILLER              PIC X(8)     VALUE SPACES.
  3989     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3990
  3991 01  DET-PR-UREC-4.
  3992     12  FILLER              PIC X(18) VALUE ' CLM DEDUCT AMT - '.
  3993     12  DET-CLM-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3994     12  FILLER              PIC X(18) VALUE ' CAN DEDUCT AMT - '.
  3995     12  DET-CAN-DEDUCT      PIC 99999.99   BLANK WHEN ZERO.
  3996     12  FILLER              PIC X(37)    VALUE SPACES.
  3997     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  3998
  3999 01  DET-PR-UREC-5.
  4000     12  FILLER              PIC X(13) VALUE ' LF BEN CD - '.
  4001     12  DET-LF-BEN-CD       PIC XX.
  4002     12  FILLER              PIC X(11) VALUE ' LF PREM - '.
  4003     12  DET-LF-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4004     12  FILLER              PIC X(11) VALUE ' LF BENE - '.
  4005     12  DET-LF-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4006     12  FILLER              PIC X(30)    VALUE SPACES.
  4007     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
  4008
  4009 01  DET-PR-UREC-6.
  4010     12  FILLER              PIC X(13) VALUE ' AH BEN CD - '.
  4011     12  DET-AH-BEN-CD       PIC XX.
  4012     12  FILLER              PIC X(11) VALUE ' AH PREM - '.
  4013     12  DET-AH-PREM         PIC ZZZZZZZ.99   BLANK WHEN ZERO.
  4014     12  FILLER              PIC X(11) VALUE ' AH BENE - '.
  4015     12  DET-AH-BEN          PIC ZZZZZZZZZ.99   BLANK WHEN ZERO.
  4016     12  FILLER              PIC X(30)    VALUE SPACES.
  4017     12  DET-3-ACTION        PIC X(20)    VALUE ' MAINTENANCE'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS010V.cbl
  4018
  4019 01  WS-CHANGE-REC-SW        PIC X  VALUE 'N'.
  4020     88  WS-CHANGE-REC              VALUE 'Y'.
  4021
  4022 01  TOTAL-PAGE-HD1.
  4023     12  FILLER              PIC X               VALUE SPACE.
  4024     12  TPH1-TYPE           PIC X(8).
  4025     12  TPH1-DESC.
  4026         16  TPH1-ST-CODE    PIC XX.
  4027         16  FILLER          PIC XXX.
  4028         16  TPH1-ST-DESC    PIC X(20).
  4029
  4030 01  TOTAL-PAGE-HD2.
  4031     12  FILLER              PIC X           VALUE SPACE.
  4032     12  TPH2-DESC           PIC X(20)       VALUE SPACES.
  4033     12  FILLER              PIC X(7)        VALUE 'WRITTEN'.
  4034     12  FILLER              PIC X(9)        VALUE SPACES.
  4035     12  FILLER              PIC X(9)        VALUE 'CANCELLED'.
  4036     12  FILLER              PIC X(11)       VALUE SPACES.
  4037     12  FILLER              PIC X(3)        VALUE 'NET'.
  4038     12  FILLER              PIC X(11)       VALUE SPACES.
  4039     12  FILLER              PIC X(7)        VALUE 'ACCOUNT'.
  4040     12  FILLER              PIC X(10)       VALUE SPACES.
  4041     12  FILLER              PIC X(10)       VALUE 'NET PREM -'.
  4042
  4043 01  TOTAL-PAGE-HD3.
  4044     12  FILLER              PIC X           VALUE SPACE.
  4045     12  TPH3-DESC           PIC X(20)       VALUE SPACES.
  4046     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4047     12  FILLER              PIC X(10)       VALUE SPACES.
  4048     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4049     12  FILLER              PIC X(10)       VALUE SPACES.
  4050     12  FILLER              PIC X(7)        VALUE 'PREMIUM'.
  4051     12  FILLER              PIC X(7)        VALUE SPACES.
  4052     12  FILLER              PIC X(10)       VALUE 'COMMISSION'.
  4053     12  FILLER              PIC X(08)       VALUE SPACES.
  4054     12  FILLER              PIC X(09)       VALUE 'ACCT COMP'.
  4055     12  FILLER              PIC X(11)       VALUE SPACES.
  4056     12  FILLER              PIC X(6)        VALUE 'CLAIMS'.
  4057
  4058 01  TOTAL-PAGE-DETAIL.
  4059     12  FILLER              PIC X(5).
  4060     12  TPD-DESC            PIC X(6).
  4061     12  FILLER              PIC X(3).
  4062     12  TPD-ISS-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4063     12  FILLER              PIC X(2).
  4064     12  TPD-CNC-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4065     12  FILLER              PIC X(2).
  4066     12  TPD-NET-PRM         PIC ZZZ,ZZZ,ZZZ.99-.
  4067     12  FILLER              PIC X(2).
  4068     12  TPD-ACCT-COM        PIC ZZZ,ZZZ,ZZZ.99-.
  4069     12  FILLER              PIC X(2).
  4070     12  TPD-PREM-COMP       PIC ZZZ,ZZZ,ZZZ.99-.
  4071     12  FILLER              PIC X(2).
  4072     12  TPD-CLAIMS          PIC ZZZ,ZZZ,ZZZ.99-.
  4073     12  FILLER              PIC X(4).
  4074     12  TPD-LO-CERT         PIC X(6).
  4075     12  FILLER              PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS010V.cbl
  4076     12  TPD-HI-CERT         PIC X(6).
  4077*    12  FILLER              PIC X.
  4078*    12  TPD-LO-CERT         PIC X(8).
  4079*    12  FILLER              PIC X.
  4080*    12  TPD-HI-CERT         PIC X(8).
  4081
  4082 01  DUPE-CERT-TABLE.
  4083     12  DUPE-ENTRIES  OCCURS 1000 TIMES.
  4084         16  DUPE-ENTRY      PIC X(36).
  4085         16  DUPE-STATUS     PIC X(01).
  4086         16  DUPE-LF-PRM     PIC S9(7)V99    COMP-3.
  4087         16  DUPE-AH-PRM     PIC S9(7)V99    COMP-3.
  4088
  4089 01  MISMATCH-HEADING-1.
  4090     12  FILLER              PIC X           VALUE '1'.
  4091     12  FILLER              PIC X(45)       VALUE SPACES.
  4092     12  FILLER              PIC X(42)       VALUE
  4093             'MISMATCHED TRANS AND DUPLICATE CERT REPORT'.
  4094     12  FILLER              PIC X(35)       VALUE SPACES.
  4095     12  FILLER              PIC X(10)       VALUE 'ECS010    '.
  4096
  4097 01  MISMATCH-HEADING-2.
  4098     12  FILLER              PIC X           VALUE '0'.
  4099     12  FILLER              PIC X(44)       VALUE
  4100             ' C  GRP ST  ACCT    EFF DTE  CERT      REC T'.
  4101     12  FILLER              PIC X(44)       VALUE
  4102             'YPE      CERT IN CONTROL                    '.
  4103     12  FILLER              PIC X(44)       VALUE
  4104             '        CERT OUT CONTROL           STATUS   '.
  4105
  4106 01  MISMATCH-DETAIL.
  4107     12  FILLER              PIC X           VALUE '0'.
  4108     12  FILLER              PIC X           VALUE SPACES.
  4109     12  DTL-MATCH-CONTROL   PIC X(36).
  4110     12  FILLER              PIC X(3)        VALUE SPACES.
  4111     12  DTL-REC-TYPE        PIC X.
  4112     12  FILLER              PIC X(2)        VALUE SPACES.
  4113     12  DTL-REC-TYPE-DESC   PIC X(3).
  4114     12  FILLER              PIC X(3)        VALUE SPACES.
  4115     12  DTL-CERT-IN-CONTROL
  4116                             PIC X(36).
  4117     12  FILLER              PIC X           VALUE SPACES.
  4118     12  DTL-CERT-OUT-CONTROL
  4119                             PIC X(36).
  4120     12  FILLER              PIC X           VALUE SPACES.
  4121     12  DTL-STATUS          PIC X(7)        VALUE 'DROPPED'.
  4122     12  FILLER              PIC X(2)        VALUE SPACES.
  4123
  4124 01  MISMATCH-DETAIL-2.
  4125     12  FILLER              PIC X           VALUE ' '.
  4126     12  FILLER              PIC X           VALUE SPACES.
  4127     12  MD2-LF-PREM-DESC    PIC X(16)       VALUE
  4128             ' LIFE PREMIUM = '.
  4129     12  MD2-LF-PREM         PIC Z,ZZZ,ZZZ.99-.
  4130     12  FILLER              PIC X           VALUE SPACES.
  4131     12  MD2-LF-ALT-PREM-DESC PIC X(16)       VALUE
  4132             'LIFE ALT PREM = '.
  4133     12  MD2-LF-ALT-PREM     PIC Z,ZZZ,ZZZ.99-.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS010V.cbl
  4134     12  FILLER              PIC XX          VALUE SPACES.
  4135     12  MD2-AH-PREM-DESC    PIC X(18)       VALUE
  4136             'A/H PREMIUM = '.
  4137     12  MD2-AH-PREM         PIC Z,ZZZ,ZZZ.99-.
  4138     12  FILLER              PIC X(39)       VALUE SPACES.
  4139
  4140 01  MISMATCH-DETAIL-3.
  4141     12  FILLER              PIC X           VALUE ' '.
  4142     12  FILLER              PIC X           VALUE SPACES.
  4143     12  FILLER              PIC X(16)       VALUE
  4144             ' LIFE  REFUND = '.
  4145     12  MD3-LF-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4146     12  FILLER              PIC X           VALUE SPACES.
  4147     12  FILLER              PIC X(16)       VALUE
  4148             'A & H  REFUND = '.
  4149     12  MD3-AH-REFUND       PIC Z,ZZZ,ZZZ.99-.
  4150     12  FILLER              PIC X(72)       VALUE SPACES.
  4151
  4152 01  MISMATCH-DETAIL-4.
  4153     12  FILLER              PIC X           VALUE ' '.
  4154     12  FILLER              PIC X           VALUE SPACES.
  4155     12  FILLER              PIC X(16)       VALUE
  4156             ' LIFE  CLAIM  = '.
  4157     12  MD4-LF-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4158     12  FILLER              PIC X           VALUE SPACES.
  4159     12  FILLER              PIC X(16)       VALUE
  4160             'A & H  CLAIM  = '.
  4161     12  MD4-AH-CLAIM        PIC Z,ZZZ,ZZZ.99-.
  4162     12  FILLER              PIC X(72)       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS010V.cbl
  4164*
  4165*
  4166* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS010V.cbl
  4168 01  PB-STARTS-HERE              PIC X(48)
  4169       VALUE '*****  PENDING BUSINESS RECORD STARTS HERE  ****'.
  4170
* 4171                             COPY ERCPNDB.
  4172******************************************************************
  4173*                                                                *
  4174*                                                                *
  4175*                            ERCPNDB.                            *
  4176*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4177*                            VMOD=2.025                          *
  4178*                                                                *
  4179*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4180*                                                                *
  4181******************************************************************
  4182*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4183*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4184******************************************************************
  4185*                                                                *
  4186*                                                                *
  4187*   FILE TYPE = VSAM,KSDS                                        *
  4188*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4189*                                                                *
  4190*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4191*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4192*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4193*                                                 RKP=13,LEN=36  *
  4194*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4195*                                      AND CHG-SEQ.)             *
  4196*                                                RKP=49,LEN=11   *
  4197*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4198*                                      AND CHG-SEQ.)             *
  4199*                                                RKP=60,LEN=15   *
  4200*                                                                *
  4201*   LOG = NO                                                     *
  4202*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4203******************************************************************
  4204******************************************************************
  4205*                   C H A N G E   L O G
  4206*
  4207* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4208*-----------------------------------------------------------------
  4209*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4210* EFFECTIVE    NUMBER
  4211*-----------------------------------------------------------------
  4212* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4213* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4214* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4215* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4216* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4217* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4218* 032306                   PEMA  ADD BOW LOAN NUMBER
  4219* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4220* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4221* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4222* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4223* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4224* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
  4225* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4226* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4227* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4228******************************************************************
  4229
  4230 01  PENDING-BUSINESS.
  4231     12  PB-RECORD-ID                     PIC XX.
  4232         88  VALID-PB-ID                        VALUE 'PB'.
  4233
  4234     12  PB-CONTROL-PRIMARY.
  4235         16  PB-COMPANY-CD                PIC X.
  4236         16  PB-ENTRY-BATCH               PIC X(6).
  4237         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4238         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4239
  4240     12  PB-CONTROL-BY-ACCOUNT.
  4241         16  PB-COMPANY-CD-A1             PIC X.
  4242         16  PB-CARRIER                   PIC X.
  4243         16  PB-GROUPING.
  4244             20  PB-GROUPING-PREFIX       PIC XXX.
  4245             20  PB-GROUPING-PRIME        PIC XXX.
  4246         16  PB-STATE                     PIC XX.
  4247         16  PB-ACCOUNT.
  4248             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4249             20  PB-ACCOUNT-PRIME         PIC X(6).
  4250         16  PB-CERT-EFF-DT               PIC XX.
  4251         16  PB-CERT-NO.
  4252             20  PB-CERT-PRIME            PIC X(10).
  4253             20  PB-CERT-SFX              PIC X.
  4254         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4255
  4256         16  PB-RECORD-TYPE               PIC X.
  4257             88  PB-MAILING-DATA                VALUE '0'.
  4258             88  PB-ISSUE                       VALUE '1'.
  4259             88  PB-CANCELLATION                VALUE '2'.
  4260             88  PB-BATCH-TRAILER               VALUE '9'.
  4261
  4262     12  PB-CONTROL-BY-ORIG-BATCH.
  4263         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4264         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4265         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4266         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4267
  4268     12  PB-CONTROL-BY-CSR.
  4269         16  PB-CSR-COMPANY-CD            PIC X.
  4270         16  PB-CSR-ID                    PIC X(4).
  4271         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4272         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4273         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4274******************************************************************
  4275*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4276******************************************************************
  4277
  4278     12  PB-LAST-MAINT-DT                 PIC XX.
  4279     12  PB-LAST-MAINT-BY                 PIC X(4).
  4280     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4281
  4282     12  PB-RECORD-BODY                   PIC X(375).
  4283
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4284     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4285         16  PB-CERT-ORIGIN               PIC X.
  4286             88  CLASIC-CREATED-CERT         VALUE '1'.
  4287         16  PB-I-NAME.
  4288             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4289             20  PB-I-INSURED-FIRST-NAME.
  4290                 24  PB-I-INSURED-1ST-INIT PIC X.
  4291                 24  FILLER                PIC X(9).
  4292             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4293         16  PB-I-AGE                     PIC S99   COMP-3.
  4294         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4295         16  PB-I-BIRTHDAY                PIC XX.
  4296         16  PB-I-INSURED-SEX             PIC X.
  4297             88  PB-SEX-MALE     VALUE 'M'.
  4298             88  PB-SEX-FEMALE   VALUE 'F'.
  4299
  4300         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4301         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4302         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4303         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4304         16  PB-I-SKIP-CODE               PIC X.
  4305             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4306             88  PB-SKIP-JULY              VALUE '1'.
  4307             88  PB-SKIP-AUGUST            VALUE '2'.
  4308             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4309             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4310             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4311             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4312             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4313             88  PB-SKIP-JUNE              VALUE '8'.
  4314             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4315             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4316             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4317         16  PB-I-TERM-TYPE               PIC X.
  4318             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4319             88  PB-PAID-WEEKLY            VALUE 'W'.
  4320             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4321             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4322             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4323         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4324         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4325         16  PB-I-DATA-ENTRY-SW           PIC X.
  4326             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4327             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4328             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4329             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4330         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4331         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4332*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4333         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4334         16  FILLER                       PIC X.
  4335
  4336         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4337             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4338             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4339                                                   '90' THRU '99'.
  4340         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4341                                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4342         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4343         16  PB-I-AMOUNT-FINANCED REDEFINES
  4344                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4345         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4346         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4347                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4348         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4349         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4350         16  PB-I-CLP-AMOUNT REDEFINES
  4351                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4352         16  PB-I-LF-CALC-FLAG            PIC X.
  4353             88 PB-COMP-LF-PREM               VALUE '?'.
  4354         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4355         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4356         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4357         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4358         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4359         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4360         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4361         16  PB-I-LF-ABBR                 PIC XXX.
  4362         16  PB-I-LF-INPUT-CD             PIC XX.
  4363
  4364         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4365             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4366             88  PB-INVALID-AH               VALUE '  ' '00'
  4367                                                   '90' THRU '99'.
  4368         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4369         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4370         16  PB-I-AH-CALC-FLAG            PIC X.
  4371             88 PB-COMP-AH-PREM                  VALUE '?'.
  4372         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4373         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4374         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4375         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4376         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4377         16  PB-I-AH-ABBR                 PIC XXX.
  4378         16  PB-I-AH-INPUT-CD             PIC XXX.
  4379
  4380         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4381         16  PB-I-REIN-TABLE              PIC XXX.
  4382         16  PB-I-BUSINESS-TYPE           PIC 99.
  4383         16  PB-I-INDV-GRP-CD             PIC X.
  4384         16  PB-I-MORT-CODE.
  4385             20  PB-I-TABLE               PIC X.
  4386             20  PB-I-INTEREST            PIC XX.
  4387             20  PB-I-MORT-TYP            PIC X.
  4388         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4389         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4390         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4391         16  PB-I-INDV-GRP-OVRD           PIC X.
  4392         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4393         16  PB-I-SIG-SW                  PIC X.
  4394             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4395         16  PB-I-RATE-CLASS              PIC XX.
  4396         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4397         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4398         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4399         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4400         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4401         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4402         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4403         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4404         16  PB-I-OB-FLAG                 PIC X.
  4405             88  PB-I-OB                      VALUE 'B'.
  4406             88  PB-I-SUMMARY                 VALUE 'Z'.
  4407         16  PB-I-ENTRY-STATUS            PIC X.
  4408             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4409                                              'M' '5' '9' '2'.
  4410             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4411             88  PB-I-POLICY-PENDING          VALUE '2'.
  4412             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4413             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4414             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4415             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4416             88  PB-I-REIN-ONLY               VALUE '9'.
  4417             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4418             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4419             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4420             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4421         16  PB-I-INT-CODE                PIC X.
  4422             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4423             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4424         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4425         16  PB-I-SOC-SEC-NO              PIC X(11).
  4426         16  PB-I-MEMBER-NO               PIC X(12).
  4427         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4428*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4429         16  PB-I-OLD-LOF                 PIC XXX.
  4430         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4431         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4432         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4433         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4434         16  PB-I-LIFE-INDICATOR          PIC X.
  4435             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4436         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4437         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4438                                          PIC S9(5)V99    COMP-3.
  4439         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4440             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4441             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4442         16  PB-I-1ST-PMT-DT              PIC XX.
  4443         16  PB-I-JOINT-INSURED.
  4444             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4445             20 PB-I-JOINT-FIRST-NAME.
  4446                24  PB-I-JOINT-FIRST-INIT PIC X.
  4447                24  FILLER                PIC X(9).
  4448             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4449*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4450         16  PB-I-BENEFICIARY-NAME.
  4451             20  PB-I-BANK-NUMBER         PIC X(10).
  4452             20  FILLER                   PIC X(15).
  4453         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4454         16  PB-I-REFERENCE               PIC X(12).
  4455         16  FILLER REDEFINES PB-I-REFERENCE.
  4456             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4457             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4458             20  PB-I-CLP-STATE           PIC XX.
  4459         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4460             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4461             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4462             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4463         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4464         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4465         16  PB-I-RESIDENT-STATE          PIC XX.
  4466         16  PB-I-RATE-CODE               PIC X(4).
  4467         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4468         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4469         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4470         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4471         16  PB-I-BANK-NOCHRGB            PIC 99.
  4472         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4473         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4474
  4475     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4476         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4477             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4478         16  PB-C-CANCEL-ORIGIN           PIC X.
  4479             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4480         16  PB-C-LF-CANCEL-DT            PIC XX.
  4481         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4482         16  PB-C-LF-CALC-REQ             PIC X.
  4483             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4484         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4485         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4486         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4487             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4488         16  PB-C-AH-CANCEL-DT            PIC XX.
  4489         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4490         16  PB-C-AH-CALC-REQ             PIC X.
  4491             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4492         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4493         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4494         16  PB-C-LAST-NAME               PIC X(15).
  4495         16  PB-C-REFUND-SW               PIC X.
  4496             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4497             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4498         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4499         16  PB-C-PAYEE-CODE              PIC X(6).
  4500         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4501         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4502         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4503         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4504         16  PB-C-REFERENCE               PIC X(12).
  4505         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4506         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4507         16  PB-C-POST-CARD-IND           PIC X.
  4508         16  PB-C-CANCEL-REASON           PIC X.
  4509         16  PB-C-REF-INTERFACE-SW        PIC X.
  4510         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4511         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4512         16  FILLER                       PIC X(01).
  4513*        16  FILLER                       PIC X(18).
  4514         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4515*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4516         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4517         16  PB-CANCELED-CERT-DATA.
  4518             20  PB-CI-INSURED-NAME.
  4519                 24  PB-CI-LAST-NAME      PIC X(15).
  4520                 24  PB-CI-INITIALS       PIC XX.
  4521             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4522             20  PB-CI-INSURED-SEX        PIC X.
  4523             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4524             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4525             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4526             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4527             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4528             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4529             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4530             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4531             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4532             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4533             20  PB-CI-RATE-CLASS         PIC XX.
  4534             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4535             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4536             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4537             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4538             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4539             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4540             20  PB-CI-LF-ABBR            PIC X(3).
  4541             20  PB-CI-AH-ABBR            PIC X(3).
  4542             20  PB-CI-OB-FLAG            PIC X.
  4543                 88  PB-CI-OB                VALUE 'B'.
  4544             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4545                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4546                                           'M' '4' '5' '9' '2'.
  4547                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4548                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4549                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4550                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4551                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4552                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4553                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4554                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4555                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4556                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4557                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4558                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4559                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4560             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4561                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4562                                           'M' '4' '5' '9' '2'.
  4563                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4564                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4565                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4566                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4567                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4568                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4569                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4570                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4571                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4572                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4573                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4574                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4575                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4576             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4577             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4578             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4579             20  PB-CI-MEMBER-NO          PIC X(12).
  4580             20  PB-CI-INT-CODE           PIC X.
  4581                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4582                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4583             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4584             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4585             20  PB-CI-COMP-EXCP-SW       PIC X.
  4586                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4587                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4588             20  PB-CI-ENTRY-STATUS       PIC X.
  4589             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4590             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4591             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4592             20  PB-CI-DEATH-DT           PIC XX.
  4593             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4594             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4595             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4596             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4597             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4598             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4599             20  PB-CI-ENTRY-DT              PIC XX.
  4600             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4601             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4602             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4603             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4604             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4605             20  PB-CI-OLD-LOF               PIC XXX.
  4606*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4607             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4608             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4609             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4610             20  PB-CI-INDV-GRP-CD           PIC X.
  4611             20  PB-CI-BENEFICIARY-NAME.
  4612                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4613                 24  FILLER                  PIC X(15).
  4614             20  PB-CI-NOTE-SW               PIC X.
  4615             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4616             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4617             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4618             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4619             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4620             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4621             20  PB-CI-FIRST-NAME            PIC X(10).
  4622             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4623
  4624         16  FILLER                       PIC X(13).
  4625*032306  16  FILLER                       PIC X(27).
  4626*        16  FILLER                       PIC X(46).
  4627
  4628     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4629         16  FILLER                       PIC X(10).
  4630         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4631         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4632         16  PB-M-INSURED-MID-INIT        PIC X.
  4633         16  PB-M-INSURED-AGE             PIC 99.
  4634         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4635         16  PB-M-INSURED-SEX             PIC X.
  4636         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4637         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4638         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4639         16  PB-M-INSURED-CITY-STATE.
  4640             20  PB-M-INSURED-CITY        PIC X(28).
  4641             20  PB-M-INSURED-STATE       PIC XX.
  4642         16  PB-M-INSURED-ZIP-CODE.
  4643             20  PB-M-INSURED-ZIP-PRIME.
  4644                 24  PB-M-INSURED-ZIP-1   PIC X.
  4645                     88  PB-M-CANADIAN-POST-CODE
  4646                                             VALUE 'A' THRU 'Z'.
  4647                 24  FILLER               PIC X(4).
  4648             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4649         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4650                                        PB-M-INSURED-ZIP-CODE.
  4651             20  PM-M-INS-CAN-POST1       PIC XXX.
  4652             20  PM-M-INS-CAN-POST2       PIC XXX.
  4653             20  FILLER                   PIC XXX.
  4654         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4655         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4656         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4657         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4658         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4659         16  PB-M-CRED-BENE-CITYST.
  4660             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4661             20  PB-M-CRED-BENE-STATE     PIC XX.
  4662
  4663         16  FILLER                       PIC X(92).
  4664
  4665     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4666         16  FILLER                       PIC X(10).
  4667         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4668         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4669         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4670         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4671         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4672         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4673         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4674         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4675         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4676         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4677         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4678         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4679         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4680         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4681         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4682         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4683         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4684         16  PB-ACCOUNT-NAME              PIC X(30).
  4685         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4686         16  PB-REFERENCE                 PIC X(12).
  4687         16  PB-B-RECEIVED-DT             PIC XX.
  4688         16  FILLER                       PIC X(234).
  4689
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4690     12  PB-RECORD-STATUS.
  4691         16  PB-CREDIT-SELECT-DT          PIC XX.
  4692         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4693         16  PB-BILLED-DT                 PIC XX.
  4694         16  PB-BILLING-STATUS            PIC X.
  4695             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4696             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4697             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4698         16  PB-RECORD-BILL               PIC X.
  4699             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4700             88  PB-RECORD-RETURNED           VALUE 'R'.
  4701             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4702             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4703             88  PB-OVERRIDE-AH               VALUE 'A'.
  4704             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4705         16  PB-BATCH-ENTRY               PIC X.
  4706             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4707             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4708             88  PB-REISSUED-CERT             VALUE 'E'.
  4709             88  PB-CASH-CERT                 VALUE 'C'.
  4710             88  PB-MONTHLY-CERT              VALUE 'M'.
  4711             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4712             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4713             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4714         16  PB-FORCE-CODE                PIC X.
  4715             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4716             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4717             88  PB-CANCEL-FORCE              VALUE '8'.
  4718             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4719             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4720             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4721             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4722             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4723             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4724             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4725         16  PB-FATAL-FLAG                PIC X.
  4726             88  PB-FATAL-ERRORS              VALUE 'X'.
  4727         16  PB-FORCE-ER-CD               PIC X.
  4728             88  PB-FORCE-ERRORS              VALUE 'F'.
  4729             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4730         16  PB-WARN-ER-CD                PIC X.
  4731             88  PB-WARNING-ERRORS            VALUE 'W'.
  4732         16  FILLER                       PIC X.
  4733         16  PB-OUT-BAL-CD                PIC X.
  4734             88  PB-OUT-OF-BAL                VALUE 'O'.
  4735         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4736         16  PB-AH-OVERRIDE-L1            PIC X.
  4737         16  PB-INPUT-DT                  PIC XX.
  4738         16  PB-INPUT-BY                  PIC X(4).
  4739         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4740         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4741         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4742         16  PB-LF-EARNING-METHOD         PIC X.
  4743         16  PB-AH-EARNING-METHOD         PIC X.
  4744         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4745         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4746         16  PB-REIN-CD                   PIC XXX.
  4747         16  PB-LF-REFUND-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDB)
  4748         16  PB-AH-REFUND-TYPE            PIC X.
  4749         16  PB-ACCT-EFF-DT               PIC XX.
  4750         16  PB-ACCT-EXP-DT               PIC XX.
  4751         16  PB-COMPANY-ID                PIC X(3).
  4752         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4753         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4754         16  PB-SV-CARRIER                PIC X.
  4755         16  PB-SV-GROUPING               PIC X(6).
  4756         16  PB-SV-STATE                  PIC XX.
  4757         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4758         16  PB-GA-BILLING-INFO.
  4759             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4760                                          PIC XX.
  4761         16  PB-SV-REMIT-TO  REDEFINES
  4762             PB-GA-BILLING-INFO           PIC X(10).
  4763         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4764         16  PB-I-LOAN-OFFICER            PIC X(5).
  4765         16  PB-I-VIN                     PIC X(17).
  4766
  4767         16  FILLER                       PIC X(04).
  4768         16  IMNET-BYPASS-SW              PIC X.
  4769
  4770******************************************************************
  4771*                COMMON EDIT ERRORS                              *
  4772******************************************************************
  4773
  4774     12  PB-COMMON-ERRORS.
  4775         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4776                                           PIC S9(4)     COMP.
  4777
  4778******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS010V.cbl
  4780 01  PC-STARTS-HERE              PIC X(48)
  4781       VALUE '*****   PENDING CLAIMS RECORD STARTS HERE   ****'.
  4782
* 4783                             COPY ERCPNDC.
  4784******************************************************************04/29/98
  4785*                                                                *ERCPNDC
  4786*                                                                *ERCPNDC
  4787*                            ERCPNDC                             *   LV003
  4788*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4789*                            VMOD=2.004                          *   CL**2
  4790*                                                                *ERCPNDC
  4791*   FILE DESCRIPTION = PENDING CLAIM TRANSACTIONS                *ERCPNDC
  4792*                      PAYMENTS, RESERVES, EXPENSES              *ERCPNDC
  4793*                                                                *ERCPNDC
  4794*   FILE TYPE = VSAM,KSDS                                        *ERCPNDC
  4795*   RECORD SIZE = 500  RECFORM = FIXED                           *ERCPNDC
  4796*                                                                *ERCPNDC
  4797*   BASE CLUSTER = ERPNDC                         RKP=2,LEN=50   *ERCPNDC
  4798*       ALTERNATE PATHS = NONE                                   *ERCPNDC
  4799*                                                                *ERCPNDC
  4800*   LOG = YES                                                    *ERCPNDC
  4801*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPNDC
  4802******************************************************************ERCPNDC
  4803                                                                  ERCPNDC
  4804 01  PENDING-CLAIMS.                                              ERCPNDC
  4805     12  PC-RECORD-ID                     PIC XX.                 ERCPNDC
  4806         88  VALID-PC-ID                      VALUE 'PC'.         ERCPNDC
  4807                                                                  ERCPNDC
  4808     12  PC-CONTROL-PRIMARY.                                      ERCPNDC
  4809         16  PC-COMPANY-CD                PIC X.                  ERCPNDC
  4810         16  PC-CARRIER                   PIC X.                  ERCPNDC
  4811         16  PC-GROUPING.                                         ERCPNDC
  4812             20  PC-GROUPING-PREFIX       PIC XXX.                ERCPNDC
  4813             20  PC-GROUPING-PRIME        PIC XXX.                ERCPNDC
  4814         16  PC-STATE                     PIC XX.                 ERCPNDC
  4815         16  PC-ACCOUNT.                                          ERCPNDC
  4816             20  PC-ACCOUNT-PREFIX        PIC X(4).               ERCPNDC
  4817             20  PC-ACCOUNT-PRIME         PIC X(6).               ERCPNDC
  4818         16  PC-CERT-EFF-DT               PIC XX.                 ERCPNDC
  4819         16  PC-CERT-NO.                                          ERCPNDC
  4820             20  PC-CERT-PRIME            PIC X(10).              ERCPNDC
  4821             20  PC-CERT-SFX              PIC X.                  ERCPNDC
  4822         16  PC-CLAIM-NO                  PIC X(7).               ERCPNDC
  4823         16  PC-CHECK-NO                  PIC X(7).               ERCPNDC
  4824                                                                  ERCPNDC
  4825         16  PC-RECORD-TYPE               PIC X.                  ERCPNDC
  4826             88  PC-CLAIMS                    VALUE '1'.          ERCPNDC
  4827             88  PC-RESERVES                  VALUE '2'.          ERCPNDC
  4828         16  PC-RECORD-SEQUENCE           PIC S9(4)     COMP.     ERCPNDC
  4829                                                                  ERCPNDC
  4830     12  PC-LAST-MAINT-DT                 PIC XX.                 ERCPNDC
  4831     12  PC-LAST-MAINT-BY                 PIC X(4).               ERCPNDC
  4832     12  PC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCPNDC
  4833                                                                  ERCPNDC
  4834     12  PC-CLAIM-RECORD.                                         ERCPNDC
  4835         16  PC-CLAIM-TYPE                PIC X.                  ERCPNDC
  4836             88  PC-LF-CLAIM                  VALUE '1'.          ERCPNDC
  4837             88  PC-AH-CLAIM                  VALUE '2'.          ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4838             88  PC-OB-LF-CLAIM               VALUE '3'.          ERCPNDC
  4839             88  PC-OB-AH-CLAIM               VALUE '4'.          ERCPNDC
  4840         16  PC-PAYMENT-DT                PIC XX.                 ERCPNDC
  4841         16  PC-PAID-THRU-DT              PIC XX.                 ERCPNDC
  4842         16  PC-REPORTED-DT               PIC XX.                 ERCPNDC
  4843         16  PC-INCURRED-DT               PIC XX.                 ERCPNDC
  4844         16  PC-NO-OF-DAYS-PAID           PIC S9(3)     COMP-3.   ERCPNDC
  4845         16  PC-CLAIM-PAYMENT             PIC S9(7)V99  COMP-3.   ERCPNDC
  4846         16  PC-AGE-AT-CLAIM              PIC 99.                 ERCPNDC
  4847         16  FILLER                       PIC XX.                 ERCPNDC
  4848         16  PC-PAYMENT-TYPE              PIC X.                  ERCPNDC
  4849             88  PC-PARTIAL-PAYMENT           VALUE '1'.          ERCPNDC
  4850             88  PC-FINAL-PAYMENT             VALUE '2'.          ERCPNDC
  4851             88  PC-LUMP-SUM-PAYMENT          VALUE '3'.          ERCPNDC
  4852             88  PC-ADDITIONAL-PAYMENT        VALUE '4'.          ERCPNDC
  4853             88  PC-CHARGEBLE-EXPENSE         VALUE '5'.          ERCPNDC
  4854             88  PC-NON-CHARGEBLE-EXPENSE     VALUE '6'.          ERCPNDC
  4855             88  PC-VOIDED-PAYMENT            VALUE '9'.          ERCPNDC
  4856                                                                  ERCPNDC
  4857         16  PC-FUTURE-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4858         16  PC-IBNR-RESERVE-AMT          PIC S9(7)V99  COMP-3.   ERCPNDC
  4859         16  PC-PTC-RESERVE-AMT           PIC S9(7)V99  COMP-3.   ERCPNDC
  4860         16  PC-MANUAL-RESERVE-AMT        PIC S9(7)V99  COMP-3.   ERCPNDC
  4861                                                                  ERCPNDC
  4862         16  PC-SV-CARRIER                PIC X.                  ERCPNDC
  4863         16  PC-SV-GROUPING               PIC X(6).               ERCPNDC
  4864         16  PC-SV-STATE                  PIC XX.                 ERCPNDC
  4865                                                                  ERCPNDC
  4866         16  PC-VOID-SW                   PIC X.                  ERCPNDC
  4867             88  PC-PUT-CERT-INFORCE          VALUE '1'.          ERCPNDC
  4868                                                                  ERCPNDC
  4869         16  PC-CAUSE-CODE                PIC X(6).               ERCPNDC
  4870         16  FILLER                       PIC X(48).              ERCPNDC
  4871                                                                  ERCPNDC
  4872         16  PC-CLAIMED-CERT-DATA.                                ERCPNDC
  4873             20  PC-CC-INSURED-NAME.                              ERCPNDC
  4874                 24  PC-CC-LAST-NAME      PIC X(15).              ERCPNDC
  4875                 24  PC-CC-INITIALS       PIC XX.                 ERCPNDC
  4876             20  PC-CC-INSURED-AGE        PIC S99.                ERCPNDC
  4877             20  PC-CC-INSURED-SEX        PIC X.                  ERCPNDC
  4878             20  PC-CC-ORIG-TERM          PIC S999        COMP-3. ERCPNDC
  4879             20  PC-CC-LF-BENEFIT-CD      PIC XX.                 ERCPNDC
  4880             20  PC-CC-LIFE-BENEFIT-AMT   PIC S9(9)V99    COMP-3. ERCPNDC
  4881             20  PC-CC-ALT-LF-BENEFIT-AMT PIC S9(9)V99    COMP-3. ERCPNDC
  4882             20  PC-CC-LIFE-PREMIUM       PIC S9(7)V99    COMP-3. ERCPNDC
  4883             20  PC-CC-AH-BENEFIT-CD      PIC XX.                 ERCPNDC
  4884             20  PC-CC-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4885             20  PC-CC-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3. ERCPNDC
  4886             20  PC-CC-RATE-CLASS         PIC XX.                 ERCPNDC
  4887             20  PC-CC-RATE-DEV           PIC XXX.                ERCPNDC
  4888             20  PC-CC-OB-FLAG            PIC X.                  ERCPNDC
  4889                 88  PC-CC-OB                VALUE 'B'.           ERCPNDC
  4890             20  PC-CC-AH-POLICY-STATUS   PIC X.                  ERCPNDC
  4891                 88  PC-CCA-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4892                                               '4' '5' '9' '2'.   ERCPNDC
  4893                 88  PC-CCA-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4894                 88  PC-CCA-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4895                 88  PC-CCA-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4896                 88  PC-CCA-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4897                 88  PC-CCA-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4898                 88  PC-CCA-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4899                 88  PC-CCA-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4900                 88  PC-CCA-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4901                 88  PC-CCA-REIN-ONLY               VALUE '9'.    ERCPNDC
  4902             20  PC-CC-LF-POLICY-STATUS   PIC X.                  ERCPNDC
  4903                 88  PC-CCL-POLICY-IS-ACTIVE        VALUE '1' '3' ERCPNDC
  4904                                               '4' '5' '9' '2'.   ERCPNDC
  4905                 88  PC-CCL-NORMAL-ENTRY            VALUE '1'.    ERCPNDC
  4906                 88  PC-CCL-POLICY-PENDING          VALUE '2'.    ERCPNDC
  4907                 88  PC-CCL-POLICY-IS-RESTORE       VALUE '3'.    ERCPNDC
  4908                 88  PC-CCL-CONVERSION-ENTRY        VALUE '4'.    ERCPNDC
  4909                 88  PC-CCL-POLICY-IS-REISSUE       VALUE '5'.    ERCPNDC
  4910                 88  PC-CCL-LUMP-SUM-DISAB          VALUE '6'.    ERCPNDC
  4911                 88  PC-CCL-DEATH-CLAIM-APPLIED     VALUE '7'.    ERCPNDC
  4912                 88  PC-CCL-CANCEL-APPLIED          VALUE '8'.    ERCPNDC
  4913                 88  PC-CCL-REIN-ONLY               VALUE '9'.    ERCPNDC
  4914             20  PC-CC-PAY-FREQUENCY      PIC 99.                 ERCPNDC
  4915             20  PC-CC-LOAN-APR           PIC 9(3)V9(4)   COMP-3. ERCPNDC
  4916             20  PC-CC-SOC-SEC-NO         PIC X(11).              ERCPNDC
  4917             20  PC-CC-MEMBER-NO          PIC X(12).              ERCPNDC
  4918             20  PC-CC-INT-CODE           PIC X.                  ERCPNDC
  4919                 88  PC-CC-ADD-ON                  VALUE 'A'.     ERCPNDC
  4920                 88  PC-CC-SIMPLE                  VALUE 'S'.     ERCPNDC
  4921             20  PC-CC-CAPPED-TERM        PIC 999.                ERCPNDC
  4922             20  PC-CC-PRIOR-LUMP-PMT     PIC S9(7)V99  COMP-3.   ERCPNDC
  4923             20  PC-CC-PRIOR-DEATH-AMT    PIC S9(9)V99  COMP-3.   ERCPNDC
  4924             20  PC-CC-CANCEL-DT          PIC XX.                 ERCPNDC
  4925             20  PC-CC-DEATH-DT           PIC XX.                 ERCPNDC
  4926             20  PC-CC-SETTLEMENT-DT      PIC XX.                 ERCPNDC
  4927             20  PC-CC-PRIOR-STATUS       PIC X.                  ERCPNDC
  4928             20  PC-CC-CERT-ENTRY-STATUS  PIC X.                  ERCPNDC
  4929         16  PC-TRLR-SEQ-NO               PIC S9(4)     COMP.     ERCPNDC
  4930         16  PC-CC-CLP-STATE              PIC XX.
  4931         16  FILLER                       PIC X(14).              ERCPNDC
  4932         16  PC-REMAINING-BENEFIT         PIC S9(9)V99  COMP-3.   ERCPNDC
  4933         16  PC-REMAINING-TERM            PIC S9(3)     COMP-3.   ERCPNDC
  4934         16  FILLER                       PIC X(34).              ERCPNDC
  4935                                                                  ERCPNDC
  4936     12  PC-RECORD-STATUS.                                        ERCPNDC
  4937         16  PC-CREDIT-SELECT-DT          PIC XX.                 ERCPNDC
  4938         16  PC-CREDIT-ACCEPT-DT          PIC XX.                 ERCPNDC
  4939         16  FILLER                       PIC XX.                 ERCPNDC
  4940         16  PC-FATAL-FLAG                PIC X.                  ERCPNDC
  4941             88  PC-FATAL-ERRORS             VALUE 'X'.           ERCPNDC
  4942         16  PC-FORCE-CODE                PIC X.                  ERCPNDC
  4943             88  PC-FORCE-OFF                VALUE ' ' '0'.       ERCPNDC
  4944             88  PC-CLAIM-FORCE              VALUE '6' '7'        ERCPNDC
  4945                                                     '8'.         ERCPNDC
  4946         16  PC-FORCE-ER-CD               PIC X.                  ERCPNDC
  4947             88  PC-FORCE-ERRORS             VALUE 'F'.           ERCPNDC
  4948             88  PC-UNFORCED-ERRORS          VALUE 'X'.           ERCPNDC
  4949         16  PC-WARN-ER-CD                PIC X.                  ERCPNDC
  4950             88  PC-WARNING-ERRORS           VALUE 'W'.           ERCPNDC
  4951         16  PC-LF-OVERRIDE-L1            PIC X.                  ERCPNDC
  4952         16  PC-AH-OVERRIDE-L1            PIC X.                  ERCPNDC
  4953         16  FILLER                       PIC X(17).              ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCPNDC)
  4954         16  PC-CERT-UPDATE-SW            PIC X.                  ERCPNDC
  4955             88  PC-CERT-DATA-CAPTURED       VALUE '1'.           ERCPNDC
  4956         16  PC-COMPANY-ID                PIC XXX.                ERCPNDC
  4957         16  PC-INPUT-DT                  PIC XX.                 ERCPNDC
  4958                                                                  ERCPNDC
  4959     12  PC-ERROR-FLAGS.                                          ERCPNDC
  4960         16  PC-STANDARD-ERRORS.                                  ERCPNDC
  4961             20  PC-STD-ERROR-FLAGS   OCCURS 25 TIMES PIC X.      ERCPNDC
  4962         16  PC-TRANSACTION-ERRORS.                               ERCPNDC
  4963             20  PC-TRN-ERROR-FLAGS   OCCURS 75 TIMES PIC X.      ERCPNDC
  4964                                                                  ERCPNDC
  4965     12  PC-ERR-FLAGS-R REDEFINES  PC-ERROR-FLAGS.                ERCPNDC
  4966         16  PC-ERR-FLAG              OCCURS 100 TIMES PIC X.     ERCPNDC
  4967                                                                  ERCPNDC
  4968     12  FILLER                           PIC X(25).              ERCPNDC
  4969                                                                  ERCPNDC
  4970******************************************************************ERCPNDC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS010V.cbl
  4972 01  CC-STARTS-HERE              PIC X(48)
  4973       VALUE '***** CERTIFICATE CHANGE RECORD STARTS HERE ****'.
  4974
* 4975                             COPY ERCCRTC.
  4976******************************************************************04/29/98
  4977*                                                                *ERCCRTC
  4978*                                                                *ERCCRTC
  4979*                            ERCCRTC                             *   LV003
  4980*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  4981*                            VMOD=2.005                          *   CL**3
  4982*                                                                *ERCCRTC
  4983*   FILE DESCRIPTION = PENDING CHANGES TO CERTIFICATE RECORD     *ERCCRTC
  4984*                      (MAINTENANCE ONLY - SEE ERCPNDB FOR NEW   *ERCCRTC
  4985*                       ISSUES AND CANCELS)                      *ERCCRTC
  4986*   FILE TYPE = VSAM,KSDS                                        *ERCCRTC
  4987*   RECORD SIZE = 300  RECFORM = FIXED                           *ERCCRTC
  4988*                                                                *ERCCRTC
  4989*   BASE CLUSTER = ERCRTC                         RKP=2,LEN=37   *ERCCRTC
  4990*       ALTERNATE PATHS = NONE                                   *ERCCRTC
  4991*                                                                *ERCCRTC
  4992*   LOG = YES                                                    *ERCCRTC
  4993*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCCRTC
  4994******************************************************************ERCCRTC
  4995*                   C H A N G E   L O G
  4996*
  4997* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4998*-----------------------------------------------------------------
  4999*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5000* EFFECTIVE    NUMBER
  5001*-----------------------------------------------------------------
  5002* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5003******************************************************************
  5004 01  PENDING-MAINT-TO-CERT-FILE.                                  ERCCRTC
  5005     12  CC-RECORD-ID                     PIC XX.                 ERCCRTC
  5006         88  VALID-CC-ID                        VALUE 'CC'.       ERCCRTC
  5007                                                                  ERCCRTC
  5008     12  CC-CONTROL-PRIMARY.                                      ERCCRTC
  5009         16  CC-COMPANY-CD                PIC X.                  ERCCRTC
  5010         16  CC-CARRIER                   PIC X.                  ERCCRTC
  5011         16  CC-GROUPING                  PIC X(6).               ERCCRTC
  5012         16  CC-STATE                     PIC XX.                 ERCCRTC
  5013         16  CC-ACCOUNT                   PIC X(10).              ERCCRTC
  5014         16  CC-CERT-EFF-DT               PIC XX.                 ERCCRTC
  5015         16  CC-CERT-NO.                                          ERCCRTC
  5016             20  CC-CERT-PRIME            PIC X(10).              ERCCRTC
  5017             20  CC-CERT-SFX              PIC X.                  ERCCRTC
  5018                                                                  ERCCRTC
  5019         16  CC-FILE-SEQ-NO               PIC S9(8)     COMP.     ERCCRTC
  5020                                                                  ERCCRTC
  5021     12  CC-LAST-MAINT-DT                 PIC XX.                 ERCCRTC
  5022     12  CC-LAST-MAINT-BY                 PIC X(4).               ERCCRTC
  5023     12  CC-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.   ERCCRTC
  5024                                                                  ERCCRTC
  5025     12  CC-RECORD-BODY                   PIC X(191).             ERCCRTC
  5026                                                                  ERCCRTC
  5027     12  CC-CHANGES-RECORD   REDEFINES CC-RECORD-BODY.            ERCCRTC
  5028         16  FILLER                       PIC X(10).              ERCCRTC
  5029         16  CC-NAME.                                             ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5030             20  CC-INSURED-LAST-NAME     PIC X(15).              ERCCRTC
  5031             20  CC-INSURED-FIRST-NAME.                           ERCCRTC
  5032                 24  CC-INSURED-1ST-INIT  PIC X.                  ERCCRTC
  5033                 24  FILLER               PIC X(9).               ERCCRTC
  5034             20  CC-INSURED-INITIAL2      PIC XX.                 ERCCRTC
  5035         16  CC-AGE                       PIC S99.                ERCCRTC
  5036         16  CC-INSURED-JOINT-AGE         PIC S99.                ERCCRTC
  5037         16  CC-BIRTHDAY                  PIC XX.                 ERCCRTC
  5038         16  CC-INSURED-SEX               PIC X.                  ERCCRTC
  5039             88  CC-SEX-MALE                 VALUE 'M'.           ERCCRTC
  5040             88  CC-SEX-FEMALE               VALUE 'F'.           ERCCRTC
  5041         16  CC-JOINT-INSURED-NAME.                               ERCCRTC
  5042             20  CC-JT-LAST-NAME          PIC X(15).              ERCCRTC
  5043             20  CC-JT-FIRST-NAME.                                ERCCRTC
  5044                 24  CC-JT-1ST-INIT       PIC X.                  ERCCRTC
  5045                 24  FILLER               PIC X(9).               ERCCRTC
  5046             20  CC-JT-INITIAL            PIC X.                  ERCCRTC
  5047         16  CC-LOAN-APR                  PIC 9(3)V9(4).          ERCCRTC
  5048         16  CC-PAY-FREQUENCY             PIC S99.                ERCCRTC
  5049         16  CC-BENEFICIARY               PIC X(25).              ERCCRTC
  5050         16  CC-POLICY-FORM-NO            PIC X(12).              ERCCRTC
  5051         16  CC-PREMIUM-TYPE              PIC X.                  ERCCRTC
  5052         16  CC-IND-GRP-TYPE              PIC X.                  ERCCRTC
  5053         16  CC-LOAN-NUMBER               PIC X(8).               ERCCRTC
  5054         16  CC-LOAN-BALANCE              PIC S9(7)V99  COMP-3.   ERCCRTC
  5055         16  CC-OLD-LOF                   PIC XXX.
  5056*        16  CC-LOAN-OFFICER              PIC XXX.                ERCCRTC
  5057         16  CC-USER-FIELD                PIC X.                  ERCCRTC
  5058         16  CC-SOC-SEC-NO                PIC X(11).              ERCCRTC
  5059         16  CC-MEMBER-NO                 PIC X(12).              ERCCRTC
  5060         16  CC-LF-ORIG-TERM              PIC S9(3).              ERCCRTC
  5061         16  CC-AH-ORIG-TERM              PIC S9(3).              ERCCRTC
  5062         16  FILLER                       PIC X(3).               ERCCRTC
  5063         16  CC-CLAIM-DEDUCT-WITHHELD     PIC S9(5)V99  COMP-3.   ERCCRTC
  5064         16  CC-CANCEL-DEDUCT-WITHHELD    PIC S9(5)V99  COMP-3.   ERCCRTC
  5065         16  CC-LIVES                     PIC S9(7)     COMP-3.   ERCCRTC
  5066         16  CC-BILLED                    PIC S9(7)     COMP-3.   ERCCRTC
  5067         16  CC-LOAN-OFFICER              PIC X(5).
  5068         16  FILLER                       PIC XXX.                ERCCRTC
  5069     12  CC-RECORD-STATUS.                                        ERCCRTC
  5070         16  CC-CREDIT-SELECT-DT          PIC XX.                 ERCCRTC
  5071         16  CC-CREDIT-ACCEPT-DT          PIC XX.                 ERCCRTC
  5072     12  CC-ADDITIONAL-LF-DATA.                                   ERCCRTC
  5073         16  CC-LF-BENEFIT-CD             PIC XX.                 ERCCRTC
  5074         16  CC-LF-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5075         16  CC-LF-BENEFIT-AMT            PIC S9(9)V99  COMP-3.   ERCCRTC
  5076         16  CC-LF-EXPIRY-DT              PIC XX.                 ERCCRTC
  5077     12  CC-INPUT-DT                      PIC XX.                 ERCCRTC
  5078     12  CC-ERROR-FLAGS.                                          ERCCRTC
  5079         16  CC-STANDARD-ERRORS.                                  ERCCRTC
  5080             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5081         16  CC-TRANSACTION-ERRORS.                               ERCCRTC
  5082             20  FILLER                   PIC X    OCCURS 10.     ERCCRTC
  5083     12  CC-ADDITIONAL-AH-DATA.                                   ERCCRTC
  5084         16  CC-AH-BENEFIT-CD             PIC XX.                 ERCCRTC
  5085         16  CC-AH-PREMIUM-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5086         16  CC-AH-BENEFIT-AMT            PIC S9(7)V99  COMP-3.   ERCCRTC
  5087         16  CC-AH-EXPIRY-DT              PIC XX.                 ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS010V.cbl (/apps/prod/cid1p/copy/ERCCRTC)
  5088                                                                  ERCCRTC
  5089     12  FILLER                           PIC X(05).              ERCCRTC
  5090******************************************************************ERCCRTC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS010V.cbl
  5092 01  CR-STARTS-HERE              PIC X(48)
  5093       VALUE '***** CERTIFICATE MASTER RECORD STARTS HERE ****'.
  5094
* 5095                             COPY ECSCRT01.
  5096******************************************************************
  5097*                                                                *
  5098*                            ECSCRT01                            *
  5099*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5100*                            VMOD=2.016                          *
  5101*                                                                *
  5102*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
  5103*                                                                *
  5104*   FILE TYPE = SEQUENTIAL
  5105*   RECORD SIZE = 1056 RECFORM = FIXED                           *
  5106*                                                                *
  5107*   KEY DATA =                         START=4, LEN=36           *
  5108*                                                                *
  5109*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
  5110*                                                                *
  5111******************************************************************
  5112******************************************************************
  5113*                   C H A N G E   L O G
  5114*
  5115* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5116*-----------------------------------------------------------------
  5117*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5118* EFFECTIVE    NUMBER
  5119*-----------------------------------------------------------------
  5120* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  5121* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
  5122* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  5123* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
  5124* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  5125* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
  5126* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5127* 032612  CR2011110200001  PEMA  AHL CHANGES
  5128* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
  5129* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  5130******************************************************************
  5131
  5132 01  CERTIFICATE-RECORD.
  5133     12  CR-RECORD-ID                      PIC XX.
  5134         88  VALID-CR-ID                      VALUE 'CR'.
  5135
  5136     12  CR-COMPANY-CD                     PIC X.
  5137
  5138     12  CR-FULL-CONTROL.
  5139         16  CR-CONTROL-1.
  5140             20  CR-ACCT-CONTROL.
  5141                 24  CR-CARRIER            PIC X.
  5142                 24  CR-GROUPING.
  5143                     28  CR-GROUP-PREFIX   PIC XXX.
  5144                     28  CR-GROUP-PRIME    PIC XXX.
  5145                 24  CR-STATE              PIC XX.
  5146                 24  CR-ACCOUNT.
  5147                     28  CR-ACCT-PREFIX    PIC X(4).
  5148                     28  CR-ACCT-PRIME     PIC X(6).
  5149             20  CR-DT                     PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5150         16  CR-CERT-NO.
  5151             20  CR-CERT.
  5152                 24  CR-CERT-PREFIX        PIC X(3).
  5153                 24  CR-CERT-PRIME         PIC X(7).
  5154             20  CR-CERT-SFX               PIC X.
  5155
  5156     12  CR-INSUREDS-PROFILE.
  5157         16  CR-NAME.
  5158             20  CR-LNAME                  PIC X(15).
  5159             20  CR-FNAME.
  5160                 24  CR-1ST-INITIAL        PIC X.
  5161                 24  FILLER                PIC X(9).
  5162             20  CR-INIT                   PIC X.
  5163         16  CR-AGE                        PIC 99.
  5164         16  CR-SEX                        PIC X.
  5165             88  CR-SEX-MALE                  VALUE 'M'.
  5166             88  CR-SEX-FEMALE                VALUE 'F'.
  5167         16  CR-SOC-SEC                    PIC X(11).
  5168         16  CR-JOINT-NAME.
  5169             20  CR-JT-LNAME               PIC X(15).
  5170             20  CR-JT-FNAME.
  5171                 24  CR-JT-1ST-INIT        PIC X.
  5172                 24  FILLER                PIC X(9).
  5173             20  CR-JT-INIT                PIC X.
  5174         16  CR-JOINT-AGE                  PIC 99.
  5175
  5176         16  cr-ahl-ah-claim-no            pic x(9).
  5177         16  cr-ahl-ah-cert-seq            pic x(3).
  5178         16  cr-hst-proc-lf                pic x.
  5179         16  f                             pic x(7).
  5180
  5181     12  CR-LF-COVERAGE-DATA.
  5182         16  CR-LFTYP                      PIC XX.
  5183         16  CR-LF-TERM                    PIC S999       COMP-3.
  5184         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
  5185         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
  5186         16  CR-LF-DEV-CODE                PIC XXX.
  5187         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5188
  5189         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
  5190         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
  5191         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
  5192         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
  5193
  5194         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
  5195         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
  5196         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
  5197         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
  5198
  5199         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
  5200         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
  5201
  5202         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5203         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5204
  5205         16  CR-LF-REFUND-TYPE             PIC X.
  5206         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5207
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5208         16  CR-LF-COMM-CHARGEBACK         PIC X.
  5209             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
  5210
  5211         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5212
  5213         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5214         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5215         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5216
  5217         16  cr-ahl-lf-claim-no            pic x(9).
  5218         16  cr-ahl-lf-cert-seq            pic x(3).
  5219         16  FILLER                        PIC XX.
  5220
  5221     12  CR-AH-COVERAGE-DATA.
  5222         16  CR-AHTYP                      PIC XX.
  5223         16  CR-AH-TERM                    PIC S999       COMP-3.
  5224         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
  5225         16  CR-AH-DEV-CODE                PIC XXX.
  5226         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
  5227
  5228         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
  5229         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
  5230         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
  5231         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
  5232
  5233         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
  5234         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
  5235
  5236         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
  5237         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
  5238
  5239         16  CR-AH-REFUND-TYPE             PIC X.
  5240         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
  5241
  5242         16  CR-AH-COMM-CHARGEBACK         PIC X.
  5243             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
  5244
  5245         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
  5246
  5247         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
  5248         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
  5249         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
  5250
  5251         16  FILLER                        PIC XX.
  5252*        16  FILLER                        PIC X(8).
  5253
  5254     12  CR-LOAN-DATA.
  5255         16  CR-LIVES                      PIC S9(7)      COMP-3.
  5256         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
  5257                                           PIC S9(5)V99   COMP-3.
  5258         16  CR-BILLED                     PIC S9(7)      COMP-3.
  5259         16  CR-APR                        PIC S999V9(4)  COMP-3.
  5260         16  CR-PMT-FREQ                   PIC 99.
  5261         16  CR-LOAN-TERM                  PIC S999       COMP-3.
  5262         16  CR-RATING-CLASS               PIC XX.
  5263         16  CR-POLICY-FORM-NO             PIC X(12).
  5264         16  CR-GRPTYP                     PIC XX.
  5265         16  CR-IND-GRP                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5266             88  CR-INDIVIDUAL                VALUE '1'.
  5267             88  CR-GROUP                     VALUE '2'.
  5268         16  CR-SKIP                       PIC 99.
  5269             88  NO-MONTHS-SKIPPED            VALUE 00.
  5270             88  SKIP-JULY                    VALUE 01.
  5271             88  SKIP-AUGUST                  VALUE 02.
  5272             88  SKIP-SEPTEMBER               VALUE 03.
  5273             88  SKIP-JULY-AUG                VALUE 04.
  5274             88  SKIP-AUG-SEPT                VALUE 05.
  5275             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  5276             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  5277             88  SKIP-JUNE                    VALUE 08.
  5278             88  SKIP-JUNE-JULY               VALUE 09.
  5279             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  5280             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  5281         16  CR-RESIDENT-STATE             PIC XX.
  5282         16  CR-RATE-CODE.
  5283             20  CR-LF-CLASS-CD            PIC XX.
  5284             20  CR-AH-CLASS-CD            PIC XX.
  5285         16  CR-MORT.
  5286             20  CR-TAB                    PIC X.
  5287             20  CR-INT                    PIC 99.
  5288             20  CR-GRP                    PIC X.
  5289         16  CR-MEMBER-NO                  PIC X(12).
  5290         16  CR-OLD-LOF                    PIC XXX.
  5291*        16  CR-LOAN-OFFICER               PIC XXX.
  5292         16  CR-REIN-TABLE                 PIC XXX.
  5293         16  CR-REIN-SPEC                  PIC X.
  5294         16  CR-LOAN-1ST-PMT-DT.
  5295             20  CR-1ST-PMT-YR             PIC 99.
  5296             20  CR-1ST-PMT-MO             PIC 99.
  5297             20  CR-1ST-PMT-DA             PIC 99.
  5298         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  5299         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  5300         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  5301         16  CR-LAST-ADD-ON-DT             PIC XX.
  5302
  5303         16  CR-UNDERWRITING-CODE          PIC X.
  5304             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5305
  5306         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  5307         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  5308         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  5309         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  5310
  5311     12  CR-STATUS-INFORMATION.
  5312         16  CR-ENTRY-STATUS               PIC X.
  5313             88  CR-NORMAL-ENTRY              VALUE '1'.
  5314             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  5315             88  CR-CONVERSION-ENTRY          VALUE '4'.
  5316             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  5317             88  CR-POLICY-IS-CASH            VALUE 'C'.
  5318             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  5319             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  5320             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  5321             88  CR-POLICY-IS-VOID            VALUE 'V'.
  5322             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  5323             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5324                                                'C' '5' '9' 'P'.
  5325         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  5326
  5327         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  5328         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  5329         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5330
  5331         16  CR-LF-STATUS-AT-DEATH         PIC X.
  5332         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  5333
  5334         16  CR-LF-CURRENT-STATUS          PIC X.
  5335             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  5336             88  CR-LF-POLICY-PENDING         VALUE '2'.
  5337             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  5338             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  5339             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  5340             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5341             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  5342             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5343             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  5344             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  5345             88  CR-LF-IS-DECLINED            VALUE 'D'.
  5346             88  CR-LF-IS-VOID                VALUE 'V'.
  5347             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5348                                                    '4' '5' '9'.
  5349
  5350         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  5351
  5352         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  5353         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  5354
  5355         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  5356         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  5357
  5358         16  CR-AH-CURRENT-STATUS          PIC X.
  5359             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  5360             88  CR-AH-POLICY-PENDING         VALUE '2'.
  5361             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  5362             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  5363             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  5364             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5365             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  5366             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5367             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  5368             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  5369             88  CR-AH-IS-DECLINED            VALUE 'D'.
  5370             88  CR-AH-IS-VOID                VALUE 'V'.
  5371             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5372                                                    '4' '5' '9'.
  5373         16  CR-LOAN-OFFICER               PIC X(5).
  5374         16  CR-CANCEL-REASON              PIC X.
  5375         16  cr-xycor-lf-cov-code          pic x(4).
  5376         16  cr-xycor-ah-cov-code          pic x(4).
  5377         16  cr-temp-epiq                  pic x(4).
  5378         16  FILLER                        PIC XX.
  5379
  5380     12  CR-DEATH-CLAIM-DATA.
  5381         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5382
  5383         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  5384         16  CR-DTH-RPT-DT.
  5385             20  CR-DTH-RPT-YR             PIC 99.
  5386             20  CR-DTH-RPT-MO             PIC 99.
  5387             20  CR-DTH-RPT-DA             PIC 99.
  5388         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  5389
  5390         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  5391         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  5392         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  5393         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  5394         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  5395
  5396         16  CR-DTH-AGE                    PIC 99.
  5397         16  CR-DTH-PAY-CD                 PIC X.
  5398         16  CR-DEATH-CAUSE                PIC X(6).
  5399
  5400         16  FILLER                        PIC X(16).
  5401
  5402     12  CR-DISAB-CLAIM-DATA.
  5403         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  5404
  5405         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  5406         16  CR-DIS-RPT-DT.
  5407             20  CR-DIS-RPT-YR             PIC 99.
  5408             20  CR-DIS-RPT-MO             PIC 99.
  5409             20  CR-DIS-RPT-DA             PIC 99.
  5410         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  5411         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  5412
  5413         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  5414         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  5415         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  5416         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  5417         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  5418
  5419         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  5420         16  CR-DIS-PAY-CD                 PIC X.
  5421         16  FILLER                        PIC XX.
  5422
  5423         16  CR-DISAB-INCURRED-DETAIL.
  5424             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  5425**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  5426                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  5427                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  5428                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  5429
  5430         16  CR-DISAB-CAUSE                PIC X(6).
  5431         16  FILLER                        PIC X(14).
  5432
  5433     12  CR-REMIT-TO                       PIC 99.
  5434
  5435     12  CR-COMPENSATION-LEVELS.
  5436         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  5437             20  CR-COM-AGT.
  5438                 24  CR-COM-AGT-PREFIX     PIC X(4).
  5439                 24  CR-COM-AGT-PRIME      PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  5440             20  CR-AGT-TYPE               PIC X.
  5441             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  5442             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  5443
  5444     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  5445     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  5446     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  5447     12  CR-CLP-STATE                      PIC XX.
  5448     12  CR-POST-CARD-IND                  PIC X.
  5449     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  5450     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  5451     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  5452     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5453     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  5454     12  FILLER                            PIC X(07).
  5455
  5456     12  CR-CSR-CODE                       PIC XXX.
  5457
  5458     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  5459     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  5460
  5461     12  CR-MICROFILM-NUMBERS.
  5462*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  5463         16  FILLER                        PIC X(5).
  5464     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  5465
  5466     12  CR-USER-CODE                      PIC X.
  5467     12  CR-USER-FUTURE                    PIC X(9).
  5468
  5469     12  CR-BENEFICIARY.
  5470         16  CR-BANK-NO                    PIC X(10).
  5471         16  FILLER                        PIC X(15).
  5472
  5473     12  CR-ENTRY-BATCH                    PIC X(6).
  5474     12  CR-LF-EXIT-BATCH                  PIC X(6).
  5475     12  CR-AH-EXIT-BATCH                  PIC X(6).
  5476
  5477     12  CR-NOTE-SW                        PIC X.
  5478
  5479     12  CR-ORIGIN-INDICATOR               PIC X.
  5480         88  CR-ENTERED-MANUALLY              VALUE '1'.
  5481         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  5482
  5483     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5484     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  5485     12  FILLER                            PIC X(33).
  5486
  5487******************************************************************
* 5488                             COPY ELCCRTVR.
  5489***************************************************************** 04/24/98
  5490*                                                                *ELCCRTVR
  5491*                                                                *ELCCRTVR
  5492*                            ELCCRTVR                            *   LV003
  5493*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5494*                            VMOD=2.001                          *ELCCRTVR
  5495*                                                                *ELCCRTVR
  5496*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  5497*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5498*                                                                *ELCCRTVR
  5499******************************************************************ELCCRTVR
  5500                                                                  ELCCRTVR
  5501 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  5502     05  WS-CR-DT.                                                ELCCRTVR
  5503         10  FILLER                PIC 999.                       ELCCRTVR
  5504         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  5505         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  5506             15  CR-CC             PIC 99.                        ELCCRTVR
  5507             15  CR-YR             PIC 99.                        ELCCRTVR
  5508         10  CR-MO                 PIC 99.                        ELCCRTVR
  5509         10  CR-DA                 PIC 99.                        ELCCRTVR
  5510     05  WS-CR-DT-N REDEFINES                                        CL**2
  5511            WS-CR-DT               PIC 9(11).                        CL**2
  5512     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  5513         10  FILLER                    PIC 999.                   ELCCRTVR
  5514         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5515         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  5516             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5517             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5518         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5519         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5520     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  5521            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
  5522     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  5523         10  FILLER                    PIC 999.                   ELCCRTVR
  5524         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  5525         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  5526             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  5527             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  5528         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  5529         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  5530     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  5531            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  5532     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  5533         10  FILLER                    PIC 999.                   ELCCRTVR
  5534         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  5535         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  5536             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  5537             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  5538         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  5539         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  5540     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  5541            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  5542     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  5543         10  FILLER                    PIC 999.                   ELCCRTVR
  5544         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5545         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  5546             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  5547             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  5548         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  5549         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  5550     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  5551            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  5552     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  5553         10  FILLER                    PIC 999.                   ELCCRTVR
  5554         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5555         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5556             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  5557             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  5558         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  5559         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  5560     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5561            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5562     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  5563         10  FILLER                    PIC 999.                   ELCCRTVR
  5564         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5565         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  5566             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  5567             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  5568         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  5569         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  5570     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  5571            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  5572     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  5573         10  FILLER                    PIC 999.                   ELCCRTVR
  5574         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  5575         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  5576             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  5577             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  5578         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  5579         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
  5580     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  5581            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  5582     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  5583         10  FILLER                    PIC 999.                   ELCCRTVR
  5584         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  5585         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  5586             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  5587             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  5588         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  5589         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  5590     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  5591            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  5592     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  5593         10  FILLER                    PIC 999.                   ELCCRTVR
  5594         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  5595         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  5596             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  5597             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  5598         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  5599         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  5600     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  5601          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  5602     05  WS-CR-DTH-DT.                                            ELCCRTVR
  5603         10  FILLER                    PIC 999.                   ELCCRTVR
  5604         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  5605         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  5606             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  5607             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  5608         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  5609         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  5610     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  5611            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  5612     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  5613         10  FILLER                    PIC 999.                   ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  5614         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5615         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  5616             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  5617             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  5618         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  5619         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  5620     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  5621            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  5622     05  WS-CR-DIS-DT.                                            ELCCRTVR
  5623         10  FILLER                    PIC 999.                   ELCCRTVR
  5624         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  5625         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  5626             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  5627             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  5628         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  5629         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  5630     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  5631            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  5632     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  5633         10  FILLER                    PIC 999.                   ELCCRTVR
  5634         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  5635         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  5636             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  5637             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
  5638         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  5639         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  5640     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  5641            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  5642     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  5643         10  FILLER                    PIC 999.                   ELCCRTVR
  5644         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  5645         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  5646             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  5647             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  5648         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  5649         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  5650     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  5651            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  5652     05  COPY-NDX                      PIC 9.                        CL**6
  5653     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  5654         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  5655             15  FILLER                PIC 999.                   ELCCRTVR
  5656             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  5657             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  5658                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  5659                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  5660             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  5661             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  5662         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  5663                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  5664
  5665 01  INITIALIZED-CERTIFICATE     PIC X(1056).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS010V.cbl
* 5667                             COPY ELCDATE.
  5668******************************************************************06/11/98
  5669*                                                                *ELCDATE
  5670*                                                                *ELCDATE
  5671*                            ELCDATE.                            *   LV023
  5672*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  5673*                            VMOD=2.003                           ELCDATE
  5674*                                                                *ELCDATE
  5675*                                                                *ELCDATE
  5676*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  5677*                 LENGTH = 200                                   *   CL*19
  5678******************************************************************ELCDATE
  5679                                                                  ELCDATE
  5680 01  DATE-CONVERSION-DATA.                                        ELCDATE
  5681     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  5682     12  DC-OPTION-CODE                PIC X.                        CL*15
  5683         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  5684         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  5685         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  5686         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  5687         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  5688         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  5689         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  5690         88  FIND-CENTURY               VALUE '7'.                   CL*22
  5691         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  5692         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  5693         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  5694         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  5695         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  5696         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  5697         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  5698         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  5699         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  5700         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  5701         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  5702         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  5703         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  5704         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  5705         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  5706         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  5707         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  5708         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  5709         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  5710         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  5711         88  THREE-CHARACTER-BIN                                  ELCDATE
  5712                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  5713         88  GREGORIAN-TO-BIN                                        CL**2
  5714                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  5715         88  BIN-TO-GREGORIAN                                        CL**2
  5716                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  5717         88  JULIAN-TO-BINARY                                        CL**2
  5718                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  5719     12  DC-ERROR-CODE                 PIC X.                        CL*15
  5720         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  5721         88  DATE-CONVERSION-ERROR                                ELCDATE
  5722                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  5723         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  5724         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5725         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  5726         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  5727         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  5728         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  5729         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  5730         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  5731         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  5732         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  5733     12  DC-END-OF-MONTH               PIC X.                        CL*15
  5734         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  5735     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  5736         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  5737         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  5738         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  5739     12  FILLER                        PIC X.                        CL*15
  5740     12  DC-CONVERSION-DATES.                                        CL*15
  5741         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  5742         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  5743         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  5744         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  5745                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  5746             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  5747             20  SLASH1-1              PIC X.                        CL*15
  5748             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  5749             20  SLASH1-2              PIC X.                        CL*15
  5750             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  5751         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  5752         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  5753                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  5754             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  5755             20  SLASH2-1              PIC X.                        CL*15
  5756             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  5757             20  SLASH2-2              PIC X.                        CL*15
  5758             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  5759         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  5760         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  5761                     DC-GREG-DATE-1-YMD.                          ELCDATE
  5762             20  DC-YMD-YEAR           PIC 99.                       CL*15
  5763             20  DC-YMD-MONTH          PIC 99.                       CL*15
  5764             20  DC-YMD-DAY            PIC 99.                       CL*15
  5765         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  5766         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  5767                      DC-GREG-DATE-1-MDY.                         ELCDATE
  5768             20  DC-MDY-MONTH          PIC 99.                       CL*15
  5769             20  DC-MDY-DAY            PIC 99.                       CL*15
  5770             20  DC-MDY-YEAR           PIC 99.                       CL*15
  5771         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  5772             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  5773             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  5774             20  FILLER                PIC XX.                       CL*15
  5775             20  DC-ALPHA-CENTURY.                                   CL*15
  5776                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  5777             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  5778         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  5779         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  5780         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  5781         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  5782         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5783                                       PIC 9(05).                    CL*20
  5784         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  5785             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  5786             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  5787         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  5788         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  5789         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  5790     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  5791         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  5792         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  5793             20  FILLER                PIC 9(3).                     CL*15
  5794             20  HOLD-CEN-1-CCYY.                                    CL*15
  5795                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  5796                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  5797             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  5798             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  5799         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  5800             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  5801             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  5802             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  5803                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  5804                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  5805             20  FILLER                PIC 9(3).                     CL*15
  5806         16  HOLD-CENTURY-1-X.                                       CL*15
  5807             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  5808             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  5809                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  5810                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  5811             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  5812             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  5813         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  5814             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  5815             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  5816             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  5817                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  5818                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  5819             20  FILLER                PIC XXX.                      CL*23
  5820         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  5821         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  5822         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  5823         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  5824             20  DC-JULIAN-1-CCYY.                                   CL*15
  5825                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  5826                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  5827             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  5828         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  5829         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  5830             20  DC-JULIAN-2-CCYY.                                   CL*15
  5831                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  5832                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  5833             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  5834         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  5835             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  5836             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  5837             20  DC-EDITA-DAY          PIC 99.                       CL*15
  5838             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  5839             20  DC-EDITA-CCYY.                                      CL*15
  5840                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDATE)
  5841                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  5842         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  5843             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  5844             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  5845             20  DC-EDITB-DAY          PIC 99.                       CL*15
  5846             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  5847             20  DC-EDITB-CCYY.                                      CL*15
  5848                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  5849                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  5850         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  5851         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  5852                              DC-GREG-DATE-CYMD.                  ELCDATE
  5853             20  DC-CYMD-CEN           PIC 99.                       CL*15
  5854             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  5855             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  5856             20  DC-CYMD-DAY           PIC 99.                       CL*15
  5857         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  5858         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  5859                              DC-GREG-DATE-MDCY.                  ELCDATE
  5860             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  5861             20  DC-MDCY-DAY           PIC 99.                       CL*15
  5862             20  DC-MDCY-CEN           PIC 99.                       CL*15
  5863             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  5864    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  5865        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  5866    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  5867    12  FILLER                         PIC X(28).                    CL*26
* 5868                             COPY ELCFUNDT.
  5869***************************************************************** 12/03/98
  5870*                                                               * ELCFUNDT
  5871*                            ELCFUNDT.                          *    LV004
  5872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
  5873*                            VMOD=2.001                         * ELCFUNDT
  5874*                                                               * ELCFUNDT
  5875*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
  5876*                                                               * ELCFUNDT
  5877***************************************************************** ELCFUNDT
  5878                                                                  ELCFUNDT
  5879                                                                  ELCFUNDT
  5880 01  FUNCTION-DATE.                                                  CL**2
  5881     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
  5882     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
  5883         10  WS-FN-CCYR            PIC 9(4).                         CL**3
  5884         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
  5885             15  WS-FN-CC          PIC 99.                           CL**3
  5886             15  WS-FN-YR          PIC 99.                           CL**3
  5887         10  WS-FN-MO              PIC 99.                           CL**3
  5888         10  WS-FN-DA              PIC 99.                           CL**3
  5889     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
  5890     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
  5891     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
  5892     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
  5893     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
  5894         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
  5895         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
  5896         88  WS-NO-GMT                         VALUE ZERO.           CL**2
  5897     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
  5898     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS010V.cbl
  5899
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS010V.cbl
  5901 01  CPA-STARTS-HERE             PIC X(48)
  5902       VALUE '***** CALCULATION PASS AREA STARTS HERE ********'.
* 5903                             COPY ELCCALC.
  5904******************************************************************04/15/98
  5905*                                                                *ELCCALC
  5906*                           ELCCALC.                            *    LV003
  5907*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5908*                            VMOD=2.025                          *   CL**3
  5909*                                                                *   CL**2
  5910*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  5911*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  5912*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  5913*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  5914*                                                                *   CL**2
  5915*  PASSED TO ELRTRM                                              *   CL**2
  5916*  -----------------                                             *   CL**2
  5917*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  5918*  ORIGINAL TERM                                                 *   CL**2
  5919*  BEGINNING DATE                                                *   CL**2
  5920*  ENDING DATE                                                   *   CL**2
  5921*  COMPANY I.D.                                                  *   CL**2
  5922*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  5923*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  5924*  FREE LOOK DAYS                                                *   CL**2
  5925*                                                                *   CL**2
  5926*  RETURNED FROM ELRTRM                                          *   CL**2
  5927*  ---------------------                                         *   CL**2
  5928*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  5929*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  5930*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  5931*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  5932*----------------------------------------------------------------*   CL**2
  5933*  PASSED TO ELRAMT                                              *   CL**2
  5934*  ----------------                                              *   CL**2
  5935*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  5936*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5937*  ORIGINAL AMOUNT                                               *   CL**2
  5938*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  5939*  A.P.R. - NET PAY ONLY                                         *   CL**2
  5940*  METHOD                                                            CL**2
  5941*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  5942*  COMPANY I.D.                                                  *   CL**2
  5943*  BENEFIT TYPE                                                  *   CL**2
  5944*                                                                *   CL**2
  5945*  RETURNED FROM ELRAMT                                          *   CL**2
  5946*  --------------------                                          *   CL**2
  5947*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  5948*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  5949*  REMAINING AMOUNT FACTOR                                           CL**2
  5950*----------------------------------------------------------------*   CL**2
  5951*  PASSED TO ELRESV                                              *   CL**2
  5952*  -----------------                                             *   CL**2
  5953*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  5954*  VALUATION DATE                                                *   CL**2
  5955*  PAID THRU DATE                                                *   CL**2
  5956*  BENEFIT                                                       *   CL**2
  5957*  INCURRED DATE                                                 *   CL**2
  5958*  REPORTED DATE                                                 *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  5959*  ISSUE AGE                                                     *   CL**2
  5960*  TERM                                                          *   CL**2
  5961*  CDT PERCENT                                                   *   CL**2
  5962*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  5963* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  5964* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  5965* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  5966*                                                                *   CL**2
  5967*  RETURNED FROM ELRESV                                          *   CL**2
  5968*  --------------------                                          *   CL**2
  5969*  CDT TABLE USED                                                *   CL**2
  5970*  CDT FACTOR USED                                               *   CL**2
  5971*  PAY TO CURRENT RESERVE                                        *   CL**2
  5972*  I.B.N.R. - A/H ONLY                                           *   CL**2
  5973*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  5974*----------------------------------------------------------------*   CL**2
  5975*  PASSED TO ELRATE                                              *   CL**2
  5976*  ----------------                                              *   CL**2
  5977*  CERT ISSUE DATE                                               *   CL**2
  5978*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  5979*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  5980*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  5981*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  5982*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  5983*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  5984*  DEVIATION CODE                                                *   CL**2
  5985*  ISSUE AGE                                                     *   CL**2
  5986*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  5987*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  5988*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  5989*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  5990*  A.P.R.                                                        *   CL**2
  5991*  METHOD                                                            CL**2
  5992*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  5993*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  5994*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  5995*  BENEFIT CODE                                                  *   CL**2
  5996*  BENEFIT OVERRIDE CODE                                         *   CL**2
  5997*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  5998*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  5999*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  6000*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  6001*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  6002*                                                                *   CL**2
  6003*  RETURNED FROM ELRATE                                          *   CL**2
  6004*  --------------------                                          *   CL**2
  6005*  CALCULATED PREMIUM                                            *   CL**2
  6006*  PREMIUM RATE                                                  *   CL**2
  6007*  MORTALITY CODE                                                *   CL**2
  6008*  MAX ATTAINED AGE                                              *   CL**2
  6009*  MAX AGE                                                       *   CL**2
  6010*  MAX TERM                                                      *   CL**2
  6011*  MAX MONTHLY BENEFIT                                           *   CL**2
  6012*  MAX TOTAL BENIFIT                                             *   CL**2
  6013*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  6014*----------------------------------------------------------------*   CL**2
  6015*  PASSED TO ELRFND                                              *   CL**2
  6016*  ----------------                                              *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6017*  CERT ISSUE DATE                                               *   CL**2
  6018*  REFUND DATE                                                   *   CL**2
  6019*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6020*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6021*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  6022*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6023*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6024*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6025*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6026*  DEVIATION CODE                                                *   CL**2
  6027*  ISSUE AGE                                                     *   CL**2
  6028*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6029*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  6030*  PROCESS TYPE (CANCEL)                                         *   CL**2
  6031*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6032*  A.P.R.                                                        *   CL**2
  6033*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  6034*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  6035*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6036*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6037*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6038*  BENEFIT CODE                                                  *   CL**2
  6039*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6040*                                                                *   CL**2
  6041*  RETURNED FROM ELRFND                                          *   CL**2
  6042*  --------------------                                          *   CL**2
  6043*  CALCULATED REFUND                                             *   CL**2
  6044*----------------------------------------------------------------*   CL**2
  6045*  PASSED TO ELEARN                                              *   CL**2
  6046*  ----------------                                              *   CL**2
  6047*  CERT ISSUE DATE                                               *   CL**2
  6048*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  6049*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  6050*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  6051*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  6052*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  6053*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  6054*  DEVIATION CODE                                                *   CL**2
  6055*  ISSUE AGE                                                     *   CL**2
  6056*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  6057*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  6058*  A.P.R.                                                        *   CL**2
  6059*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  6060*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  6061*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  6062*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  6063*  BENEFIT CODE                                                  *   CL**2
  6064*  BENEFIT OVERRIDE CODE                                         *   CL**2
  6065*                                                                *   CL**2
  6066*  RETURNED FROM ELEARN                                          *   CL**2
  6067*  --------------------                                          *   CL**2
  6068*  INDICATED  EARNINGS                                           *   CL**2
  6069*----------------------------------------------------------------*   CL**2
  6070*                 LENGTH = 450                                   *   CL**2
  6071*                                                                *   CL**2
  6072******************************************************************   CL**2
  6073******************************************************************
  6074*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6075*
  6076* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6077*-----------------------------------------------------------------
  6078*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6079* EFFECTIVE    NUMBER
  6080*-----------------------------------------------------------------
  6081* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  6082* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  6083* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  6084* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  6085* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  6086* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  6087* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  6088* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  6089* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6090* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  6091******************************************************************
  6092                                                                     CL**2
  6093 01  CALCULATION-PASS-AREA.                                          CL**2
  6094     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  6095                                     COMP.                           CL**2
  6096                                                                     CL**2
  6097     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  6098       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  6099       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  6100                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  6101       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  6102       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  6103       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  6104       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  6105       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  6106       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  6107       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  6108       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  6109       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  6110       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  6111       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  6112       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  6113       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  6114       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  6115       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  6116       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  6117       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  6118                                                                     CL**2
  6119     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  6120       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  6121***********************  INPUT AREAS ****************************    CL**2
  6122                                                                     CL**2
  6123     12  CP-CALCULATION-AREA.                                        CL**2
  6124         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  6125         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  6126         16  CP-VALUATION-DT       PIC XX.                           CL**2
  6127         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  6128         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  6129           88  CP-AH                               VALUE 'A' 'D'     CL**2
  6130                                                   'I' 'U'.          CL**2
  6131           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  6132           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6133         16  CP-INCURRED-DT        PIC XX.                           CL**2
  6134         16  CP-REPORTED-DT        PIC XX.                           CL**2
  6135         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  6136         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  6137         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  6138                                     COMP-3.                         CL**2
  6139         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  6140                                     COMP-3.                         CL**2
  6141         16  CP-CDT-METHOD         PIC X.                            CL**2
  6142           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  6143           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  6144           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  6145         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  6146           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  6147           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  6148         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  6149                                     COMP-3.                         CL**2
  6150         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  6151                                     COMP-3.                         CL**2
  6152         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  6153                                     COMP-3.                         CL**2
  6154         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  6155                                     COMP-3.                         CL**2
  6156         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6157                                     COMP-3.                         CL**2
  6158         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  6159                                     COMP-3.                         CL**2
  6160         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  6161                                     COMP-3.                         CL**2
  6162         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  6163           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  6164           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  6165           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  6166           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  6167           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  6168           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  6169           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  6170         16  CP-EARNING-METHOD     PIC X.                            CL**2
  6171           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  6172           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  6173           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6174           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6175           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6176           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6177           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  6178           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6179           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  6180           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6181           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  6182           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  6183           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  6184           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  6185         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  6186           88  CP-CLAIM                            VALUE '1'.        CL**2
  6187           88  CP-CANCEL                           VALUE '2'.        CL**2
  6188           88  CP-ISSUE                            VALUE '3'.        CL**2
  6189         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  6190           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6191           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  6192           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
  6193           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  6194           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  6195           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  6196           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  6197           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  6198           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  6199           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  6200           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  6201           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  6202           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  6203           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  6204           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  6205           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  6206           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  6207           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  6208                                                     'W' 'X'.        CL**2
  6209           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  6210           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  6211           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  6212           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  6213           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  6214           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  6215           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  6216           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  6217           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  6218           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  6219           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  6220           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  6221           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  6222                                                                     CL**2
  6223         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  6224                                     COMP-3.                         CL**2
  6225         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  6226         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  6227         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  6228         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  6229         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  6230           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  6231               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  6232         16  CP-R78-OPTION         PIC X.                            CL**2
  6233           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  6234           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  6235                                                                     CL**2
  6236         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  6237         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  6238         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  6239         16  CP-RATE-FILE          PIC X.                            CL**2
  6240         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  6241                                     COMP-3.                         CL**2
  6242                                                                     CL**2
  6243         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  6244         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  6245                                                                     CL**2
  6246         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  6247                                     COMP-3.
  6248         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6249                                   PIC S9(5)V99 COMP-3.
  6250         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
  6251                                     COMP-3.                         CL**2
  6252         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  6253                                     COMP-3.                         CL**2
  6254         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  6255                                     COMP-3.
  6256         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  6257                                  PIC S9(7)V99 COMP-3.
  6258                                                                     CL**2
  6259         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  6260         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  6261         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  6262           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  6263           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  6264           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  6265           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  6266         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  6267         16  CP-CARRIER            PIC X.                            CL**2
  6268         16  CP-REIN-FLAG          PIC X.                            CL**2
  6269         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  6270           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  6271                      '2' '3' '4' '5'.                               CL**2
  6272           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  6273           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  6274           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  6275           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  6276           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  6277           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  6278           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  6279           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  6280         16  CP-SIG-SWITCH         PIC X.                            CL**2
  6281         16  CP-RATING-METHOD      PIC X.                            CL**2
  6282           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  6283           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  6284           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  6285           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  6286           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  6287           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  6288           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  6289           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  6290           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  6291         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  6292                                     COMP-3.                         CL**2
  6293         16  CP-BEN-CATEGORY       PIC X.
  6294         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6295         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  6296                                   PIC S99V9(5) COMP-3.
  6297         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  6298         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  6299                                   PIC S99V9(5) COMP-3.
  6300         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  6301         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  6302         16  CP-EXPIRE-DT          PIC XX.
  6303         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  6304         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  6305         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  6306         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6307         16  CP-DDF-SPEC-CALC      PIC X.
  6308             88  CP-CALC-GROSS-FEE        VALUE 'G'.
  6309             88  CP-CALC-CLP              VALUE 'C'.
  6310         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  6311         16  CP-CANCEL-REASON      PIC X.
  6312         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  6313         16  CP-PMT-MODE           PIC X.
  6314         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  6315         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  6316         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  6317         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  6318         16  FILLER                PIC X.
  6319                                                                     CL**2
  6320***************    OUTPUT FROM ELRESV   ************************     CL**2
  6321                                                                     CL**2
  6322         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  6323                                                                     CL**2
  6324         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  6325                                     COMP-3.                         CL**2
  6326         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  6327                                     COMP-3.                         CL**2
  6328         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  6329                                     COMP-3.                         CL**2
  6330         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  6331                                     COMP-3.                         CL**2
  6332         16  FILLER                PIC X(09).                        CL**2
  6333***************    OUTPUT FROM ELRTRM   *************************    CL**2
  6334                                                                     CL**2
  6335         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  6336                                     COMP-3.                         CL**2
  6337         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  6338                                     COMP-3.                         CL**2
  6339         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  6340                                     COMP-3.                         CL**2
  6341         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  6342                                     COMP-3.                         CL**2
  6343         16  FILLER                PIC X(12).                        CL**2
  6344                                                                     CL**2
  6345***************    OUTPUT FROM ELRAMT   *************************    CL**2
  6346                                                                     CL**2
  6347         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  6348                                     COMP-3.                         CL**2
  6349         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  6350                                     COMP-3.                         CL**2
  6351         16  FILLER                PIC X(12).                        CL**2
  6352                                                                     CL**2
  6353***************    OUTPUT FROM ELRATE   *************************    CL**2
  6354                                                                     CL**2
  6355         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  6356                                     COMP-3.                         CL**2
  6357         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  6358                                     COMP-3.                         CL**2
  6359         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  6360         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  6361             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  6362         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  6363                                     COMP-3.                         CL**2
  6364         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6365         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  6366         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
  6367                                   PIC S9(7)V99 COMP-3.
  6368         16  FILLER                PIC X(07).                        CL**2
  6369                                                                     CL**2
  6370***************    OUTPUT FROM ELRFND   *************************    CL**2
  6371                                                                     CL**2
  6372         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  6373                                     COMP-3.                         CL**2
  6374         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  6375           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  6376           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  6377           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  6378           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  6379           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6380           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  6381           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  6382           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  6383           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6384           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  6385           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  6386           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  6387           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  6388           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  6389         16  FILLER                PIC X(12).                        CL**2
  6390                                                                     CL**2
  6391***************    OUTPUT FROM ELEARN   *************************    CL**2
  6392                                                                     CL**2
  6393         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  6394                                     COMP-3.                         CL**2
  6395         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  6396                                     COMP-3.                         CL**2
  6397         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  6398                                     COMP-3.                         CL**2
  6399         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  6400                                     COMP-3.                         CL**2
  6401         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  6402                                     COMP-3.                         CL**2
  6403         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  6404                                     COMP-3.                         CL**2
  6405         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  6406           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  6407           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  6408           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  6409           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  6410           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  6411           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  6412           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  6413           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  6414           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  6415         16  FILLER                PIC X(12).                        CL**2
  6416                                                                     CL**2
  6417***************    OUTPUT FROM ELPMNT   *************************    CL**2
  6418                                                                     CL**2
  6419         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  6420                                     COMP-3.                         CL**2
  6421         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  6422                                     COMP-3.                         CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6423         16  FILLER                PIC X(12).                        CL**2
  6424                                                                     CL**2
  6425***************   MISC WORK AREAS    *****************************   CL**2
  6426         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  6427                                     COMP-3.                         CL**2
  6428         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  6429                                     COMP-3.                         CL**2
  6430         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  6431                                     COMP-3.                         CL**2
  6432         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  6433                                     COMP-3.                         CL**2
  6434         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6435                                     COMP-3.                         CL**2
  6436         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  6437                                     COMP-3.                         CL**2
  6438         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  6439             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  6440             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  6441             88  IO-ERROR                         VALUE 'E'.         CL**2
  6442                                                                     CL**2
  6443         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  6444                                                                     CL**2
  6445         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  6446                                                                     CL**2
  6447         16  CP-RESERVE-REMAINING-TERM                               CL**2
  6448                                   PIC S9(4)V9    VALUE ZERO         CL**2
  6449                                     COMP-3.                         CL**2
  6450                                                                     CL**2
  6451         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  6452                                                                     CL**2
  6453         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  6454                                     COMP-3.                         CL**2
  6455                                                                     CL**2
  6456         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  6457                                     COMP-3.                         CL**2
  6458                                                                     CL**2
  6459         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  6460                                     COMP-3.                         CL**2
  6461                                                                     CL**2
  6462         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  6463                                     COMP-3.                         CL**2
  6464                                                                     CL**2
  6465         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  6466                                     COMP-3.                         CL**2
  6467                                                                     CL**2
  6468         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  6469                                     COMP-3.                         CL**2
  6470                                                                     CL**2
  6471         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  6472                                     COMP-3.                         CL**2
  6473                                                                     CL**2
  6474         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  6475             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  6476                                                                     CL**2
  6477         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  6478                                     COMP-3.                         CL**2
  6479         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  6480                                     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCALC)
  6481         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  6482         16  cp-extra-periods      pic 9 value zeros.
  6483         16  cp-net-only-state     pic x value spaces.
  6484         16  FILLER                PIC X(13).                        CL**2
  6485******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS010V.cbl
* 6487                             COPY ELCDTECX.
  6488******************************************************************06/05/98
  6489*                                                                *ELCDTECX
  6490*                            ELCDTECX.                           *   LV005
  6491*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6492*                            VMOD=2.015                          *ELCDTECX
  6493*                                                                *ELCDTECX
  6494*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  6495*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  6496*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  6497*                                                                *ELCDTECX
  6498******************************************************************ELCDTECX
  6499******************************************************************
  6500*                   C H A N G E   L O G
  6501*
  6502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6503*-----------------------------------------------------------------
  6504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6505* EFFECTIVE    NUMBER
  6506*-----------------------------------------------------------------
  6507* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  6508*                                  BENEFIT CODES FROM 300 TO 900
  6509* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  6510* 051304    2003080800002  SMVA  ADD REFUND METHOD
  6511* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  6512******************************************************************
  6513 01  DATE-CARD.                                                   ELCDTECX
  6514     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  6515     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  6516     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  6517     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  6518     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  6519     12  EP-SW                       PIC  X.                      ELCDTECX
  6520         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  6521     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  6522         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  6523     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  6524     12  RUN-CENTURY.                                             ELCDTECX
  6525         16 RUN-CENTURY-N            PIC  99.                        CL**4
  6526     12  FILLER                      PIC  X.                         CL**4
  6527     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  6528     12  FILLER                      PIC  XXX.                    ELCDTECX
  6529     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  6530                                                                  ELCDTECX
  6531 01  FILLER                          PIC  X(7)                       CL**6
  6532                                          VALUE 'OPTIONS'.        ELCDTECX
  6533 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  6534     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  6535     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  6536     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  6537         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  6538         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  6539     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  6540     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  6541     12  FILLER                      PIC  X.                      ELCDTECX
  6542     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  6543     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  6544     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6545     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  6546     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  6547     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  6548     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  6549     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  6550     12  FILLER                      PIC  X.                      ELCDTECX
  6551     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  6552     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  6553     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  6554     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  6555     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  6556     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  6557     12  FILLER                      PIC  X.                      ELCDTECX
  6558     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  6559     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  6560     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  6561     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  6562     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  6563     12  DTE-R78                     PIC  X.                      ELCDTECX
  6564     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  6565     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  6566     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  6567     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  6568     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  6569     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  6570     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  6571                                     PIC  X.                      ELCDTECX
  6572         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  6573                                                 ' '.             ELCDTECX
  6574         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  6575         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  6576     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  6577         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  6578         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  6579     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  6580     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  6581                                     PIC  9.                         CL**4
  6582     12  DTE-SYSTEM.                                              ELCDTECX
  6583         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  6584         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  6585         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  6586         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  6587         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  6588         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  6589         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  6590         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  6591         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  6592         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  6593         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  6594         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  6595         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  6596         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  6597         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  6598         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  6599         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  6600         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  6601         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  6602         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6603         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  6604         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  6605         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  6606         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  6607         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  6608         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  6609     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  6610         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  6611                                     PIC  X.                      ELCDTECX
  6612     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  6613                                                                  ELCDTECX
  6614 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  6615     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  6616     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  6617     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  6618*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  6619     12  FILLER                      PIC  X.                      ELCDTECX
  6620     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  6621     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  6622     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  6623     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  6624     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  6625     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  6626     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  6627                                                                  ELCDTECX
  6628     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  6629     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  6630     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  6631     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  6632                                                                  ELCDTECX
  6633     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  6634     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  6635     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  6636     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  6637                                                                  ELCDTECX
  6638     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  6639     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  6640                                                                  ELCDTECX
  6641     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  6642     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  6643                                                                  ELCDTECX
  6644     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  6645                                                                  ELCDTECX
  6646 01  DATE-CARD-FACTORS.                                           ELCDTECX
  6647     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  6648     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  6649     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  6650     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  6651     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  6652     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  6653     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  6654                                                                  ELCDTECX
  6655 01  FILLER                          PIC  X(12)                   ELCDTECX
  6656                                          VALUE 'COMPANY NAME'.   ELCDTECX
  6657 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  6658     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  6659         16  CNT-ID                  PIC  X.                      ELCDTECX
  6660         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6661                                                                  ELCDTECX
  6662 01  FILLER                          PIC  X(11)                   ELCDTECX
  6663                                          VALUE 'STATE NAMES'.    ELCDTECX
  6664 01  STATE-NAMES.                                                 ELCDTECX
  6665     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  6666         16  STATE-SUB               PIC  XX.                     ELCDTECX
  6667         16  STATE-PIC1.                                          ELCDTECX
  6668             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  6669             20  FILLER              PIC  XXX.                    ELCDTECX
  6670             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  6671             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  6672             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  6673             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  6674                                                                  ELCDTECX
  6675 01  FILLER                          PIC  X(13)                   ELCDTECX
  6676                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  6677 01  CARRIER-NAMES.                                               ELCDTECX
  6678     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  6679         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  6680         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  6681         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  6682         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6683         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6684         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  6685*        16  FILLER                  PIC  X.                      ELCDTECX
  6686         16  CARRIER-SEC-PAY         PIC  X.
  6687             88  SEC-PAY-CARRIER          VALUE 'Y'.
  6688                                                                  ELCDTECX
  6689 01  FILLER                          PIC  X(9)                       CL**6
  6690                                          VALUE 'INS TYPES'.      ELCDTECX
  6691 01  CLAS-INS-TYPES.                                              ELCDTECX
  6692*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  6693     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  6694         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  6695         16  CLAS-I-AB3.                                          ELCDTECX
  6696             20  FILLER              PIC  X.                      ELCDTECX
  6697             20  CLAS-I-AB2.                                      ELCDTECX
  6698                 24  FILLER          PIC  X.                      ELCDTECX
  6699                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  6700         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  6701             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  6702             20  FILLER              PIC  X.                         CL**4
  6703         16  CLAS-I-AB10.                                         ELCDTECX
  6704             20  FILLER              PIC  X(9).                   ELCDTECX
  6705             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  6706         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  6707         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  6708         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  6709         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  6710             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  6711         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  6712         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  6713         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  6714         16  CLAS-I-BEN-CATEGORY     PIC  X.
  6715         16  CLAS-I-REFUND-METHOD    PIC  X.
  6716         16  CLAS-I-MAX-BENEFITS     PIC 99.
  6717         16  FILLER                  PIC  XXX.
  6718                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6719 01  FILLER                          PIC  X(16)                   ELCDTECX
  6720                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  6721 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  6722     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  6723                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  6724         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  6725         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  6726         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  6727         16  CLAS-MORT-DESC.                                      ELCDTECX
  6728             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  6729             20  FILLER              PIC  XX.                        CL**5
  6730             20  CLAS-YEAR           PIC  X(4).                      CL**6
  6731             20  FILLER              PIC  X.                         CL**5
  6732             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  6733             20  FILLER              PIC  X.                         CL**5
  6734             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  6735             20  FILLER              PIC  X.                         CL**5
  6736             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  6737             20  FILLER              PIC  X(5).                      CL**6
  6738                                                                  ELCDTECX
  6739 01  FILLER                          PIC  X(15)                   ELCDTECX
  6740                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  6741 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  6742     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  6743         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  6744         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  6745         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  6746         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  6747         16  FILLER                  PIC  X(4).                      CL**6
  6748                                                                  ELCDTECX
  6749 01  FILLER                          PIC  X(7)                       CL**6
  6750                                     VALUE 'INDEXES'.             ELCDTECX
  6751 01  CLAS-INDEX-TBL.                                              ELCDTECX
  6752     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  6753     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  6754     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  6755     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  6756     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  6757     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  6758     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  6759     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  6760     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  6761     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  6762     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  6763     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  6764     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  6765     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  6766     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  6767     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  6768     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  6769                                                                  ELCDTECX
  6770 01  CLAS-TYPE-MISC.                                              ELCDTECX
  6771     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  6772     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  6773     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  6774     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  6775     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  6776     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6777     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  6778     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  6779     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  6780     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  6781     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  6782                                                                  ELCDTECX
  6783 01  FILLER                          PIC  X(13)                   ELCDTECX
  6784                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  6785 01  CLAS-MISC.                                                   ELCDTECX
  6786     12  DTE-FICH                    PIC  X.                      ELCDTECX
  6787         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  6788         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  6789         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  6790     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  6791     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  6792     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  6793     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  6794     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  6795     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  6796     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  6797     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  6798     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  6799     12  STATE-L                     PIC  XX.                     ELCDTECX
  6800     12  CLAS-CN                     PIC  99.                     ELCDTECX
  6801     12  CLAS-CO                     PIC  99.                     ELCDTECX
  6802     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  6803         16  DTE-F-1                 PIC  X.                      ELCDTECX
  6804         16  DTE-F-2                 PIC  X.                      ELCDTECX
  6805     12  DTE-ABEND-WORK.                                          ELCDTECX
  6806         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  6807         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  6808                                                                  ELCDTECX
  6809 01  FILLER                          PIC  X(12)                   ELCDTECX
  6810                                     VALUE 'WORKING DATE'.        ELCDTECX
  6811 01  WS-DATE-AND-TIME.                                            ELCDTECX
  6812     12  WS-ACCEPT-DATE.                                          ELCDTECX
  6813         16  WS-AD-YY                PIC  99.                     ELCDTECX
  6814         16  WS-AD-MM                PIC  99.                     ELCDTECX
  6815         16  WS-AD-DD                PIC  99.                     ELCDTECX
  6816     12  WS-CURRENT-DATE.                                         ELCDTECX
  6817         16  WS-CD-MM                PIC  99.                     ELCDTECX
  6818         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6819         16  WS-CD-DD                PIC  99.                     ELCDTECX
  6820         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  6821         16  WS-CD-YY                PIC  99.                     ELCDTECX
  6822     12  WS-TIME-OF-DAY.                                          ELCDTECX
  6823         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  6824         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  6825                                                                  ELCDTECX
  6826 01  FILLER                          PIC  X(12)                   ELCDTECX
  6827                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  6828 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  6829     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  6830         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  6831         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  6832         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  6833                                                                  ELCDTECX
  6834 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  6835                                     VALUE 'STATE TLRS'.          ELCDTECX
  6836 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  6837     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  6838         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  6839         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  6840                                                                  ELCDTECX
  6841 01  FILLER                          PIC  X(13)                   ELCDTECX
  6842                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  6843 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  6844     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  6845         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  6846                                                                  ELCDTECX
  6847 01  FILLER                          PIC  X(13)                   ELCDTECX
  6848                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  6849 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  6850     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  6851     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  6852     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  6853                                     PIC  X.                         CL**5
  6854     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  6855     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  6856     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  6857     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  6858     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  6859     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  6860     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  6861     12  FILLER                      PIC  X(75).                  ELCDTECX
  6862******************************************************************ELCDTECX
  6863*01  MISC-CARR-PCT-DATA.                                          00001521
  6864*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6865*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6866*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6867*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  6868*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  6869*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  6870******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS010V.cbl
* 6872                             COPY ELCDTEVR.
  6873***************************************************************** 04/15/98
  6874*                                                                *ELCDTEVR
  6875*                                                                *ELCDTEVR
  6876*                            ELCDTEVR.                           *   LV003
  6877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  6878*                            VMOD=2.001                          *   CL**2
  6879*                                                                *ELCDTEVR
  6880*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  6881*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  6882*                                                                *ELCDTEVR
  6883******************************************************************ELCDTEVR
  6884 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  6885     05  WS-RUN-DATE.                                             ELCDTEVR
  6886         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6887         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  6888         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  6889             15  RUN-CC              PIC  99.                     ELCDTEVR
  6890             15  RUN-YR              PIC  99.                     ELCDTEVR
  6891         10  RUN-MO                  PIC  99.                     ELCDTEVR
  6892         10  RUN-DA                  PIC  99.                     ELCDTEVR
  6893     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  6894            WS-RUN-DATE              PIC 9(11).                      CL**2
  6895     05  WS-EP-DT.                                                ELCDTEVR
  6896         10  FILLER                  PIC  9(03).                  ELCDTEVR
  6897         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  6898         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  6899             15  EP-CC               PIC  99.                     ELCDTEVR
  6900             15  EP-YR               PIC  99.                     ELCDTEVR
  6901         10  EP-MO                   PIC  99.                     ELCDTEVR
  6902         10  EP-DA                   PIC  99.                     ELCDTEVR
  6903     05  WS-EP-DT-N REDEFINES                                        CL**2
  6904            WS-EP-DT                 PIC 9(11).                      CL**2
  6905     05  WS-DTE-CONV-DT.                                             CL**4
  6906         10  FILLER                  PIC  9(03).                     CL**4
  6907         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  6908         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  6909             15  DTE-CONV-CC         PIC  99.                        CL**4
  6910             15  DTE-CONV-YR         PIC  99.                        CL**4
  6911         10  DTE-CONV-MO             PIC  99.                        CL**4
  6912         10  DTE-CONV-DA             PIC  99.                        CL**4
  6913     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  6914            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  6915 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  6916     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  6917         10  FILLER                            PIC 999.           ELCDTEVR
  6918         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  6919         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  6920             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  6921             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  6922         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  6923         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  6924     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  6925            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  6926     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  6927         10  FILLER                            PIC 999.           ELCDTEVR
  6928         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  6929         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  6930         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  6931         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  6932     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  6933            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  6934 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  6935     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  6936         10  FILLER                            PIC 999.           ELCDTEVR
  6937         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  6938         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  6939             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  6940             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  6941         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  6942         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  6943     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  6944            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  6945     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  6946         10  FILLER                            PIC 999.           ELCDTEVR
  6947         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  6948         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  6949             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  6950             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  6951         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  6952         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  6953     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  6954            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  6955     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  6956         10  FILLER                            PIC 999.           ELCDTEVR
  6957         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  6958         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  6959             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  6960             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  6961         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  6962         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  6963     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  6964            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  6965 01  WS-RATE-RECORD.                                              ELCDTEVR
  6966         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  6967             10  FILLER                        PIC 999.           ELCDTEVR
  6968             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  6969             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  6970                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  6971                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  6972             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  6973             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  6974         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  6975                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS010V.cbl
* 6977                             COPY ELCACCTV.
  6978******************************************************************04/14/98
  6979*                                                                *ELCACCTV
  6980*                            ELCACCTV                            *   LV002
  6981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  6982*                            VMOD=2.001                          *ELCACCTV
  6983*                                                                *ELCACCTV
  6984*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  6985*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  6986*                                                                *ELCACCTV
  6987*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  6988*                                                                *ELCACCTV
  6989******************************************************************ELCACCTV
  6990                                                                  ELCACCTV
  6991 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  6992                                                                  ELCACCTV
  6993     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  6994         10  FILLER            PIC 999.                           ELCACCTV
  6995         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  6996         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  6997             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  6998             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  6999         10  AM-EXP-MO         PIC 99.                               CL**5
  7000         10  AM-EXP-DA         PIC 99.                               CL**5
  7001     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  7002            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  7003     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  7004         10  FILLER                    PIC 999.                   ELCACCTV
  7005         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  7006         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
  7007             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  7008             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  7009         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  7010         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  7011     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  7012            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  7013     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  7014         10  FILLER                    PIC 999.                   ELCACCTV
  7015         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  7016         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  7017             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  7018             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  7019         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  7020         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  7021     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  7022            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  7023     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  7024         10 FILLER                     PIC 999.                   ELCACCTV
  7025         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  7026         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  7027            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  7028            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  7029         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  7030         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  7031     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  7032            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  7033     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  7034         10 FILLER                     PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  7035         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  7036         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  7037            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  7038            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  7039         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  7040         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  7041     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  7042            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  7043     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  7044         10  FILLER                    PIC 999.                   ELCACCTV
  7045         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  7046         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  7047             15  AM-AN-CC              PIC 99.                    ELCACCTV
  7048             15  AM-AN-YR              PIC 99.                    ELCACCTV
  7049         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  7050         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  7051     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  7052            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  7053     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  7054         10  FILLER                    PIC 999.                   ELCACCTV
  7055         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  7056         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  7057             15  AM-HI-CC              PIC 99.                    ELCACCTV
  7058             15  AM-HI-YR              PIC 99.                    ELCACCTV
  7059         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  7060         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  7061     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  7062            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  7063     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  7064         10  FILLER                    PIC 999.                   ELCACCTV
  7065         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  7066         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  7067             15  AM-LO-CC              PIC 99.                    ELCACCTV
  7068             15  AM-LO-YR              PIC 99.                    ELCACCTV
  7069         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  7070         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  7071     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  7072            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  7073     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  7074         10  FILLER                    PIC 999.                   ELCACCTV
  7075         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  7076         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  7077             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  7078             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  7079         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  7080         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  7081     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  7082            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS010V.cbl
* 7084                             COPY ELCEXTVR.
  7085******************************************************************04/15/98
  7086*                                                                *ELCEXTVR
  7087*                                                                *ELCEXTVR
  7088*                             ELCEXTVR                           *   LV002
  7089*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7090*                            VMOD=2.001                          *ELCEXTVR
  7091*                                                                *ELCEXTVR
  7092*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEXTVR
  7093*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTVR
  7094*                                                                *ELCEXTVR
  7095******************************************************************ELCEXTVR
  7096 01  WS-CALL-EXTRACT-DATE.                                        ELCEXTVR
  7097     05  WS-EX-EFF-DATE.                                          ELCEXTVR
  7098         10  FILLER              PIC 999.                         ELCEXTVR
  7099         10  EX-EFF-DATE-CCYY    PIC 9(04).                       ELCEXTVR
  7100         10  EX-EFF-DATE-CCYR  REDEFINES  EX-EFF-DATE-CCYY.       ELCEXTVR
  7101             15  EX-EFF-DATE-CC  PIC 99.                          ELCEXTVR
  7102             15  EX-EFF-DATE-YR  PIC 99.                          ELCEXTVR
  7103         10  EX-EFF-DATE-MO      PIC 99.                          ELCEXTVR
  7104         10  EX-EFF-DATE-DA      PIC 99.                          ELCEXTVR
  7105     05  WS-EX-EFF-DATE-N REDEFINES                                  CL**2
  7106            WS-EX-EFF-DATE       PIC 9(11).                          CL**2
  7107 01  WS-DETAIL-EXTRACT-DATE.                                      ELCEXTVR
  7108     05  WS-DE-EFF.                                               ELCEXTVR
  7109         10  FILLER              PIC 999.                         ELCEXTVR
  7110         10  DE-EF-CCYY          PIC 9(04).                       ELCEXTVR
  7111         10  DE-EF-CCYR  REDEFINES  DE-EF-CCYY.                   ELCEXTVR
  7112             15  DE-EF-CC        PIC 99.                          ELCEXTVR
  7113             15  DE-EF-YR        PIC 99.                          ELCEXTVR
  7114         10  DE-EF-MO            PIC 99.                          ELCEXTVR
  7115         10  DE-EF-DA            PIC 99.                          ELCEXTVR
  7116     05  WS-DE-EFF-N REDEFINES                                       CL**2
  7117            WS-DE-EFF            PIC 9(11).                          CL**2
  7118     05  WS-DE-LF-CANC-DTE.                                       ELCEXTVR
  7119         10  FILLER              PIC 999.                         ELCEXTVR
  7120         10  DE-LF-CANC-CCYY     PIC 9(04).                       ELCEXTVR
  7121         10  DE-LF-CANC-CCYR  REDEFINES  DE-LF-CANC-CCYY.         ELCEXTVR
  7122             15  DE-LF-CANC-CC   PIC 99.                          ELCEXTVR
  7123             15  DE-LF-CANC-YR   PIC 99.                          ELCEXTVR
  7124         10  DE-LF-CANC-MO       PIC 99.                          ELCEXTVR
  7125         10  DE-LF-CANC-DA       PIC 99.                          ELCEXTVR
  7126     05  WS-DE-LF-CANC-DTE-N REDEFINES                               CL**2
  7127            WS-DE-LF-CANC-DTE       PIC 9(11).                       CL**2
  7128     05  WS-DE-LF-CANC-EXIT-DT.                                   ELCEXTVR
  7129         10  FILLER                 PIC 999.                      ELCEXTVR
  7130         10  DE-LF-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7131         10  DE-LF-CANC-EXIT-CCYR REDEFINES DE-LF-CANC-EXIT-CCYY. ELCEXTVR
  7132             15  DE-LF-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7133             15  DE-LF-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7134         10  DE-LF-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7135         10  DE-LF-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7136     05  WS-DE-LF-CANC-EXIT-DT-N REDEFINES                           CL**3
  7137            WS-DE-LF-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7138     05  WS-DE-AH-CANC-DTE.                                       ELCEXTVR
  7139         10  FILLER                 PIC 999.                      ELCEXTVR
  7140         10  DE-AH-CANC-CCYY        PIC 9(04).                    ELCEXTVR
  7141         10  DE-AH-CANC-CCYR  REDEFINES  DE-AH-CANC-CCYY.         ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7142             15  DE-AH-CANC-CC      PIC 99.                       ELCEXTVR
  7143             15  DE-AH-CANC-YR      PIC 99.                       ELCEXTVR
  7144         10  DE-AH-CANC-MO          PIC 99.                       ELCEXTVR
  7145         10  DE-AH-CANC-DA          PIC 99.                       ELCEXTVR
  7146     05  WS-DE-AH-CANC-DTE-N REDEFINES                               CL**4
  7147            WS-DE-AH-CANC-DTE       PIC 9(11).                       CL**2
  7148     05  WS-DE-AH-CANC-EXIT-DT.                                   ELCEXTVR
  7149         10  FILLER                 PIC 999.                      ELCEXTVR
  7150         10  DE-AH-CANC-EXIT-CCYY   PIC 9(04).                    ELCEXTVR
  7151         10  DE-AH-CANC-EXIT-CCYR REDEFINES DE-AH-CANC-EXIT-CCYY. ELCEXTVR
  7152             15  DE-AH-CANC-EXIT-CC PIC 99.                       ELCEXTVR
  7153             15  DE-AH-CANC-EXIT-YR PIC 99.                       ELCEXTVR
  7154         10  DE-AH-CANC-EXIT-MO     PIC 99.                       ELCEXTVR
  7155         10  DE-AH-CANC-EXIT-DA     PIC 99.                       ELCEXTVR
  7156     05  WS-DE-AH-CANC-EXIT-DT-N REDEFINES                           CL**2
  7157            WS-DE-AH-CANC-EXIT-DT   PIC 9(11).                       CL**2
  7158     05  WS-DE-ENTRY-DTE.                                         ELCEXTVR
  7159         10  FILLER                 PIC 999.                      ELCEXTVR
  7160         10  DE-ENTRY-CCYY          PIC 9(04).                    ELCEXTVR
  7161         10  DE-ENTRY-CCYR  REDEFINES  DE-ENTRY-CCYY.             ELCEXTVR
  7162             15  DE-ENTRY-CC        PIC 99.                       ELCEXTVR
  7163             15  DE-ENTRY-YR        PIC 99.                       ELCEXTVR
  7164         10  DE-ENTRY-MO            PIC 99.                       ELCEXTVR
  7165         10  DE-ENTRY-DA            PIC 99.                       ELCEXTVR
  7166     05  WS-DE-ENTRY-DTE-N REDEFINES                                 CL**2
  7167            WS-DE-ENTRY-DTE         PIC 9(11).                       CL**2
  7168     05  WS-DE-PROC-DT.                                           ELCEXTVR
  7169         10  FILLER                 PIC 999.                      ELCEXTVR
  7170         10  DE-PD-CCYY             PIC 9(04).                    ELCEXTVR
  7171         10  DE-PD-CCYR  REDEFINES  DE-PD-CCYY.                   ELCEXTVR
  7172             15  DE-PD-CC           PIC 99.                       ELCEXTVR
  7173             15  DE-PD-YR           PIC 99.                       ELCEXTVR
  7174         10  DE-PD-MO               PIC 99.                       ELCEXTVR
  7175         10  DE-PD-DA               PIC 99.                       ELCEXTVR
  7176     05  WS-DE-PROC-DT-N REDEFINES                                   CL**2
  7177            WS-DE-PROC-DT           PIC 9(11).                       CL**2
  7178     05  WS-DE-CLM-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7179         10  FILLER                 PIC 999.                         CL**5
  7180         10  DE-CP-CCYY             PIC 9(04).                       CL**5
  7181         10  DE-CP-CCYR  REDEFINES  DE-CP-CCYY.                      CL**6
  7182             15  DE-CP-CC           PIC 99.                          CL**5
  7183             15  DE-CP-YR           PIC 99.                          CL**5
  7184         10  DE-CP-MO               PIC 99.                          CL**5
  7185         10  DE-CP-DA               PIC 99.                          CL**5
  7186     05  WS-DE-CLM-PROC-DT-N REDEFINES                               CL**5
  7187            WS-DE-CLM-PROC-DT              PIC 9(11).                CL**5
  7188     05  WS-DE-RSV-PROC-DT REDEFINES WS-DE-PROC-DT.                  CL**5
  7189         10  FILLER                 PIC 999.                         CL**5
  7190         10  DE-RP-CCYY             PIC 9(04).                       CL**5
  7191         10  DE-RP-CCYR  REDEFINES  DE-RP-CCYY.                      CL**6
  7192             15  DE-RP-CC           PIC 99.                          CL**5
  7193             15  DE-RP-YR           PIC 99.                          CL**5
  7194         10  DE-RP-MO                      PIC 99.                   CL**5
  7195         10  DE-RP-DA                      PIC 99.                   CL**5
  7196     05  WS-DE-RSV-PROC-DT-N REDEFINES                               CL**5
  7197            WS-DE-RSV-PROC-DT              PIC 9(11).                CL**5
  7198     05  WS-DE-INCUR.                                             ELCEXTVR
  7199         10  FILLER                 PIC 999.                      ELCEXTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7200         10  DE-INCUR-CCYY          PIC 9(04).                    ELCEXTVR
  7201         10  DE-INCUR-CCYR  REDEFINES  DE-INCUR-CCYY.             ELCEXTVR
  7202             15  DE-INCUR-CC        PIC 99.                       ELCEXTVR
  7203             15  DE-INCUR-YR        PIC 99.                       ELCEXTVR
  7204         10  DE-INCUR-MO            PIC 99.                       ELCEXTVR
  7205         10  DE-INCUR-DA            PIC 99.                       ELCEXTVR
  7206     05  WS-DE-INCUR-N REDEFINES                                     CL**2
  7207            WS-DE-INCUR             PIC 9(11).                       CL**2
  7208     05  WS-DE-PAY.                                               ELCEXTVR
  7209         10  FILLER                 PIC 999.                      ELCEXTVR
  7210         10  DE-PAY-CCYY            PIC 9(04).                    ELCEXTVR
  7211         10  DE-PAY-CCYR  REDEFINES  DE-PAY-CCYY.                 ELCEXTVR
  7212             15  DE-PAY-CC          PIC 99.                       ELCEXTVR
  7213             15  DE-PAY-YR          PIC 99.                       ELCEXTVR
  7214         10  DE-PAY-MO              PIC 99.                       ELCEXTVR
  7215         10  DE-PAY-DA              PIC 99.                       ELCEXTVR
  7216     05  WS-DE-PAY-N REDEFINES                                       CL**2
  7217            WS-DE-PAY               PIC 9(11).                       CL**2
  7218     05  WS-DE-PAID-TO.                                           ELCEXTVR
  7219         10  FILLER                 PIC 999.                      ELCEXTVR
  7220         10  DE-PTO-CCYY            PIC 9(04).                    ELCEXTVR
  7221         10  DE-PTO-CCYR  REDEFINES  DE-PTO-CCYY.                 ELCEXTVR
  7222             15  DE-PTO-CC          PIC 99.                       ELCEXTVR
  7223             15  DE-PTO-YR          PIC 99.                       ELCEXTVR
  7224         10  DE-PTO-MO              PIC 99.                       ELCEXTVR
  7225         10  DE-PTO-DA              PIC 99.                       ELCEXTVR
  7226     05  WS-DE-PAID-TO-N REDEFINES                                   CL**2
  7227            WS-DE-PAID-TO           PIC 9(11).                       CL**2
  7228     05  WS-DE-ACC-EXP-DTE.                                       ELCEXTVR
  7229         10 FILLER                  PIC 999.                      ELCEXTVR
  7230         10 DE-ACC-EXP-CCYY         PIC 9(04).                    ELCEXTVR
  7231         10 DE-ACC-EXP-CCYR  REDEFINES  DE-ACC-EXP-CCYY.          ELCEXTVR
  7232            15 DE-ACC-EXP-CC        PIC 99.                       ELCEXTVR
  7233            15 DE-ACC-EXP-YR        PIC 99.                       ELCEXTVR
  7234         10 DE-ACC-EXP-MO           PIC 99.                       ELCEXTVR
  7235         10 DE-ACC-EXP-DA           PIC 99.                       ELCEXTVR
  7236     05  WS-DE-ACC-EXP-DTE-N REDEFINES                               CL**2
  7237            WS-DE-ACC-EXP-DTE       PIC 9(11).                       CL**2
  7238     05  WS-DE-ACC-EFF-DTE.                                       ELCEXTVR
  7239         10 FILLER                  PIC 999.                      ELCEXTVR
  7240         10 DE-ACC-EFF-CCYY         PIC 9(04).                    ELCEXTVR
  7241         10 DE-ACC-EFF-CCYR  REDEFINES  DE-ACC-EFF-CCYY.          ELCEXTVR
  7242            15 DE-ACC-EFF-CC        PIC 99.                       ELCEXTVR
  7243            15 DE-ACC-EFF-YR        PIC 99.                       ELCEXTVR
  7244         10 DE-ACC-EFF-MO           PIC 99.                       ELCEXTVR
  7245         10 DE-ACC-EFF-DA           PIC 99.                       ELCEXTVR
  7246     05  WS-DE-ACC-EFF-DTE-N REDEFINES                               CL**2
  7247            WS-DE-ACC-EFF-DTE       PIC 9(11).                       CL**2
  7248     05  WS-DE-RSV-INCUR.                                         ELCEXTVR
  7249         10  FILLER                 PIC 999.                      ELCEXTVR
  7250         10  DE-RSV-INCUR-CCYY      PIC 9(04).                    ELCEXTVR
  7251         10  DE-RSV-INCUR-CCYR  REDEFINES  DE-RSV-INCUR-CCYY.     ELCEXTVR
  7252             15  DE-RSV-INCUR-CC    PIC 99.                       ELCEXTVR
  7253             15  DE-RSV-INCUR-YR    PIC 99.                       ELCEXTVR
  7254         10  DE-RSV-INCUR-MO        PIC 99.                       ELCEXTVR
  7255         10  DE-RSV-INCUR-DA        PIC 99.                       ELCEXTVR
  7256     05  WS-DE-RSV-INCUR-N REDEFINES                                 CL**2
  7257            WS-DE-RSV-INCUR         PIC 9(11).                       CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEXTVR)
  7258     05  WS-DE-RSV-PAYTO.                                         ELCEXTVR
  7259         10  FILLER                 PIC 999.                      ELCEXTVR
  7260         10  DE-RSV-PAYTO-CCYY      PIC 9(04).                    ELCEXTVR
  7261         10  DE-RSV-PAYTO-CCYR  REDEFINES  DE-RSV-PAYTO-CCYY.     ELCEXTVR
  7262             15  DE-RSV-PAYTO-CC    PIC 99.                       ELCEXTVR
  7263             15  DE-RSV-PAYTO-YR    PIC 99.                       ELCEXTVR
  7264         10  DE-RSV-PAYTO-MO        PIC 99.                       ELCEXTVR
  7265         10  DE-RSV-PAYTO-DA        PIC 99.                       ELCEXTVR
  7266     05  WS-DE-RSV-PAYTO-N REDEFINES                                 CL**2
  7267            WS-DE-RSV-PAYTO         PIC 9(11).                       CL**2
  7268     05  WS-DE-ACC-EXP-DTE-RSV.                                   ELCEXTVR
  7269         10  FILLER                        PIC 999.               ELCEXTVR
  7270         10  DE-ACC-EXP-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7271         10  DE-ACC-EXP-DTE-RSV-CCYR REDEFINES                    ELCEXTVR
  7272                             DE-ACC-EXP-DTE-RSV-CCYY.             ELCEXTVR
  7273             15  DE-ACC-EXP-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7274             15  DE-ACC-EXP-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7275         10  DE-ACC-EXP-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7276         10  DE-ACC-EXP-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7277     05  WS-DE-ACC-EXP-DTE-RSV-N REDEFINES                           CL**2
  7278            WS-DE-ACC-EXP-DTE-RSV          PIC 9(11).                CL**2
  7279     05  WS-DE-ACC-EFF-DTE-RSV.                                   ELCEXTVR
  7280         10  FILLER                        PIC 999.               ELCEXTVR
  7281         10  DE-ACC-EFF-DTE-RSV-CCYY       PIC 9(04).             ELCEXTVR
  7282         10  DE-ACC-EFF-DTE-RSV-CCYR  REDEFINES                   ELCEXTVR
  7283                                DE-ACC-EFF-DTE-RSV-CCYY.          ELCEXTVR
  7284             15  DE-ACC-EFF-DTE-RSV-CC     PIC 99.                ELCEXTVR
  7285             15  DE-ACC-EFF-DTE-RSV-YR     PIC 99.                ELCEXTVR
  7286         10  DE-ACC-EFF-DTE-RSV-MO         PIC 99.                ELCEXTVR
  7287         10  DE-ACC-EFF-DTE-RSV-DA         PIC 99.                ELCEXTVR
  7288     05  WS-DE-ACC-EFF-DTE-RSV-N REDEFINES                           CL**2
  7289            WS-DE-ACC-EFF-DTE-RSV          PIC 9(11).                CL**2
  7290                                                                     CL**5
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS010V.cbl
  7292 PROCEDURE DIVISION.
  7293
  7294 0000-START.
  7295
  7296******************************************************************
  7297***        D A T E   C A R D   L O A D   R O U T I N E         ***
  7298******************************************************************
  7299
  7300*0003-LOAD-DATE-CARD.
* 7301                             COPY ELCDTERX.
  7302******************************************************************04/15/98
  7303*                                                                *ELCDTERX
  7304*                                                                *ELCDTERX
  7305*                            ELCDTERX.                           *   LV002
  7306*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  7307*                            VMOD=2.007                          *ELCDTERX
  7308*                                                                *ELCDTERX
  7309*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  7310*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  7311*      = ELCDTEFD)                                               *ELCDTERX
  7312*                                                                *ELCDTERX
  7313******************************************************************ELCDTERX
  7314                                                                  ELCDTERX
  7315     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  7316                                                                  ELCDTERX
  7317     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  7318     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  7319     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  7320                                                                  ELCDTERX
  7321     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  7322                                                                  ELCDTERX
  7323******************************************************************ELCDTERX
  7324*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  7325*          WARNING MESSAGES.                                      ELCDTERX
  7326******************************************************************ELCDTERX
  7327     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  7328         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  7329                                                                  ELCDTERX
  7330     OPEN INPUT DISK-DATE.                                        ELCDTERX
  7331                                                                  ELCDTERX
  7332     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  7333                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  7334                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  7335                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  7336                   CLAX-ID           CLAS-MISC                    ELCDTERX
  7337                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  7338                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  7339                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  7340                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  7341                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  7342                                                                  ELCDTERX
  7343     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  7344                                                                  ELCDTERX
  7345     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  7346                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  7347                                                                  ELCDTERX
  7348     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  7349     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7350     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  7351     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  7352                                                                  ELCDTERX
  7353     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  7354         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  7355     ELSE                                                         ELCDTERX
  7356         ADD +1                 TO CLAS-CN.                       ELCDTERX
  7357                                                                  ELCDTERX
  7358     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  7359         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  7360     ELSE                                                         ELCDTERX
  7361         ADD +1                 TO CLAS-CO.                       ELCDTERX
  7362                                                                  ELCDTERX
  7363 0005-READ--CARD.                                                 ELCDTERX
  7364     READ DISK-DATE                                               ELCDTERX
  7365         AT END CLOSE DISK-DATE                                   ELCDTERX
  7366             GO TO 0060-READ--TEST.                               ELCDTERX
  7367                                                                  ELCDTERX
  7368     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  7369                                                                  ELCDTERX
  7370     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  7371         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  7372         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  7373         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  7374         GO TO 0005-READ--CARD.                                   ELCDTERX
  7375                                                                  ELCDTERX
  7376     IF DD-ID = 'CLAD'                                            ELCDTERX
  7377         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  7378         GO TO 0005-READ--CARD.                                   ELCDTERX
  7379                                                                  ELCDTERX
  7380     IF DD-ID = 'CLAX'                                            ELCDTERX
  7381         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  7382         GO TO 0005-READ--CARD.                                   ELCDTERX
  7383                                                                  ELCDTERX
  7384     IF DD-ID = 'CLAF'                                            ELCDTERX
  7385         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  7386         GO TO 0005-READ--CARD.                                   ELCDTERX
  7387                                                                  ELCDTERX
  7388     IF DD-ID = 'CLAC'                                            ELCDTERX
  7389         GO TO 0010-READ--CLAC.                                   ELCDTERX
  7390                                                                  ELCDTERX
  7391     IF DD-ID = 'CARR'                                            ELCDTERX
  7392         GO TO 0015-READ--CARR.                                   ELCDTERX
  7393                                                                  ELCDTERX
  7394     IF DD-ID = 'STAT'                                            ELCDTERX
  7395         GO TO 0020-READ--STAT.                                   ELCDTERX
  7396                                                                  ELCDTERX
  7397     IF DD-ID = 'BUSC'                                            ELCDTERX
  7398         GO TO 0025-READ--BUSC.                                   ELCDTERX
  7399                                                                  ELCDTERX
  7400     IF DD-ID = 'MORT'                                            ELCDTERX
  7401         GO TO 0030-READ--MORT.                                   ELCDTERX
  7402                                                                  ELCDTERX
  7403     IF DD-ID = 'CLAI'                                            ELCDTERX
  7404         GO TO 0040-READ--CLAI.                                   ELCDTERX
  7405                                                                  ELCDTERX
  7406     IF DD-ID = 'COLC'                                            ELCDTERX
  7407         GO TO 0065-READ--COLC.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7408                                                                  ELCDTERX
  7409     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7410        DD-IDA = 'CL'                                             ELCDTERX
  7411         GO TO 0035-READ--CLXX.                                   ELCDTERX
  7412                                                                  ELCDTERX
  7413     IF DD-IDX NUMERIC AND                                        ELCDTERX
  7414        DD-IDA = 'PO'                                             ELCDTERX
  7415         GO TO 0050-READ--POXX.                                   ELCDTERX
  7416                                                                  ELCDTERX
  7417     IF DD-ID = 'OPCA'                                            ELCDTERX
  7418         GO TO 0070-READ--OPCA.                                   ELCDTERX
  7419                                                                  ELCDTERX
  7420     IF DD-ID = 'OPST'                                            ELCDTERX
  7421         GO TO 0072-READ--OPST.                                   ELCDTERX
  7422                                                                  ELCDTERX
  7423     IF DD-ID = 'OPBS'                                            ELCDTERX
  7424         GO TO 0074-READ--OPBS.                                   ELCDTERX
  7425                                                                  ELCDTERX
  7426     IF DD-ID = 'OPMS'                                            ELCDTERX
  7427         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  7428                                                                  ELCDTERX
  7429     GO TO 0005-READ--CARD.                                       ELCDTERX
  7430                                                                  ELCDTERX
  7431 0010-READ--CLAC.                                                 ELCDTERX
  7432     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7433     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7434     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7435     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  7436     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  7437     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  7438     GO TO 0005-READ--CARD.                                       ELCDTERX
  7439                                                                  ELCDTERX
  7440 0015-READ--CARR.                                                 ELCDTERX
  7441     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7442     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7443        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  7444        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7445        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  7446        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7447        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7448        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7449        MOVE DD-CARR1-SECPAY-SW
  7450                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7451     END-IF
  7452                                                                  ELCDTERX
  7453     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  7454     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  7455        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  7456        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  7457        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  7458        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  7459        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  7460        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  7461        MOVE DD-CARR2-SECPAY-SW
  7462                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  7463     END-IF
  7464                                                                  ELCDTERX
  7465                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7466     GO TO 0005-READ--CARD.                                       ELCDTERX
  7467                                                                  ELCDTERX
  7468 0020-READ--STAT.                                                 ELCDTERX
  7469     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7470     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7471        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7472         GO TO 0005-READ--CARD.                                   ELCDTERX
  7473                                                                  ELCDTERX
  7474     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  7475     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  7476     GO TO 0020-READ--STAT.                                       ELCDTERX
  7477                                                                  ELCDTERX
  7478 0025-READ--BUSC.                                                 ELCDTERX
  7479     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7480     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  7481        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  7482         GO TO 0005-READ--CARD.                                   ELCDTERX
  7483                                                                  ELCDTERX
  7484     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  7485     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  7486     GO TO 0025-READ--BUSC.                                       ELCDTERX
  7487                                                                  ELCDTERX
  7488 0030-READ--MORT.                                                 ELCDTERX
  7489     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7490     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7491        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  7492         GO TO 0005-READ--CARD.                                   ELCDTERX
  7493                                                                  ELCDTERX
  7494     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  7495     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  7496     GO TO 0030-READ--MORT.                                       ELCDTERX
  7497                                                                  ELCDTERX
  7498 0035-READ--CLXX.                                                 ELCDTERX
  7499     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  7500          GO TO 0005-READ--CARD.                                  ELCDTERX
  7501                                                                  ELCDTERX
  7502     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  7503         DISPLAY '***********************************************'ELCDTERX
  7504         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  7505         DISPLAY '***********************************************'ELCDTERX
  7506         GO TO 0055-READ--STOP.                                   ELCDTERX
  7507                                                                  ELCDTERX
  7508     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  7509        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  7510         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  7511                                                                  ELCDTERX
  7512     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  7513        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  7514         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  7515                                                                  ELCDTERX
  7516*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  7517     GO TO 0005-READ--CARD.                                       ELCDTERX
  7518                                                                  ELCDTERX
  7519 0040-READ--CLAI.                                                 ELCDTERX
  7520     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7521     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  7522        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  7523         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7524                                                                  ELCDTERX
  7525     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  7526     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  7527     GO TO 0040-READ--CLAI.                                       ELCDTERX
  7528                                                                  ELCDTERX
  7529 0045-READ--DUMP.                                                 ELCDTERX
  7530     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  7531     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  7532                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  7533     PERFORM ABEND-PGM.                                           ELCDTERX
  7534                                                                  ELCDTERX
  7535 0050-READ--POXX.                                                 ELCDTERX
  7536     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  7537         GO TO 0005-READ--CARD.                                   ELCDTERX
  7538                                                                  ELCDTERX
  7539     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  7540         DISPLAY '***********************************************'ELCDTERX
  7541         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  7542         DISPLAY '***********************************************'ELCDTERX
  7543         GO TO 0055-READ--STOP.                                   ELCDTERX
  7544                                                                  ELCDTERX
  7545     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  7546     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  7547     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  7548     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  7549                                                                  ELCDTERX
  7550     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  7551         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  7552     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  7553         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  7554                                                                  ELCDTERX
  7555     GO TO 0005-READ--CARD.                                       ELCDTERX
  7556                                                                  ELCDTERX
  7557 0055-READ--STOP.                                                 ELCDTERX
  7558     GOBACK.                                                      ELCDTERX
  7559                                                                  ELCDTERX
  7560 0060-READ--TEST.                                                 ELCDTERX
  7561     IF DATX-COD        = SPACE  OR                               ELCDTERX
  7562        CLAX-ID         = SPACE  OR                               ELCDTERX
  7563        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  7564         GO TO 0045-READ--DUMP.                                   ELCDTERX
  7565                                                                  ELCDTERX
  7566     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  7567     GO TO 0079-READ--EXIT.                                       ELCDTERX
  7568                                                                  ELCDTERX
  7569 0065-READ--COLC.                                                 ELCDTERX
  7570     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  7571     GO TO 0005-READ--CARD.                                       ELCDTERX
  7572                                                                  ELCDTERX
  7573 0070-READ--OPCA.                                                 ELCDTERX
  7574                                                                  ELCDTERX
  7575     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7576                                                                  ELCDTERX
  7577     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  7578             OR                                                   ELCDTERX
  7579         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  7580         GO TO 0005-READ--CARD.                                   ELCDTERX
  7581                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  7582     ADD 1                       TO INDEXCA.                      ELCDTERX
  7583     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  7584                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  7585     GO TO 0070-READ--OPCA.                                       ELCDTERX
  7586                                                                  ELCDTERX
  7587 0072-READ--OPST.                                                 ELCDTERX
  7588                                                                  ELCDTERX
  7589     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7590                                                                  ELCDTERX
  7591     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  7592             OR                                                   ELCDTERX
  7593         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7594         GO TO 0005-READ--CARD.                                   ELCDTERX
  7595                                                                  ELCDTERX
  7596     ADD 1                       TO INDEXST.                      ELCDTERX
  7597     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  7598                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  7599     GO TO 0072-READ--OPST.                                       ELCDTERX
  7600                                                                  ELCDTERX
  7601 0074-READ--OPBS.                                                 ELCDTERX
  7602                                                                  ELCDTERX
  7603     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  7604                                                                  ELCDTERX
  7605     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  7606             OR                                                   ELCDTERX
  7607         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  7608         GO TO 0005-READ--CARD.                                   ELCDTERX
  7609                                                                  ELCDTERX
  7610     ADD 1                       TO INDEXBS.                      ELCDTERX
  7611     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  7612     GO TO 0074-READ--OPBS.                                       ELCDTERX
  7613                                                                  ELCDTERX
  7614 0079-READ--EXIT.                                                 ELCDTERX
  7615*    EXIT.                                                        ELCDTERX
  7616******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS010V.cbl
  7618******************************************************************
  7619***           O P E N   F I L E S   R O U T I N E              ***
  7620******************************************************************
  7621
  7622     DISPLAY ' '.
  7623     DISPLAY '****** THE FOLLOWING MESSAGES WERE CREATED BY '
  7624         'ECS010 ******'
  7625     DISPLAY ' '.
  7626
  7627     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  7628     MOVE 'Y'                    TO DC-FORCE-EL310-DATE-SW
  7629     MOVE FUNCTION-DATE          TO DC-EL310-DATE
  7630     .
  7631 0080-OPEN-FILES.
  7632*    IF DTE-PGM-OPT = '1'
  7633*       open output detail-extr
  7634*    end-if
  7635     OPEN INPUT  PENDING-EXTRACT
  7636                 CERT-MASTER-IN
  7637                 ERACCTT-IN
  7638                 ERAGTC
  7639
  7640          I-O    ERMEBL-INOUT
  7641                 ELCRTT
  7642
  7643          OUTPUT SUMMARY-EXTR
  7644                 ME-ECS010-BALANCE
  7645                 ME50-ECS010-BALANCE
  7646                 DISPLAY-PRT
  7647                 MISMATCH-REPORT
  7648                 PRINT-COPY.
  7649
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS010V.cbl
  7651*START*************CUSTOM CODE FOR CLIENT "DMD"*************
  7652     IF DTE-CLIENT NOT = 'DMD'
  7653         NEXT SENTENCE
  7654     ELSE
  7655         OPEN INPUT ERRESC-IN
  7656            IF ERRESC-FILE-STATUS   = '00' OR '97'
  7657                NEXT SENTENCE
  7658            ELSE
  7659                MOVE ERRESC-FILE-STATUS TO WS-ABEND-FILE-STATUS
  7660                MOVE 'ERROR OPENING ERRESC FILE'
  7661                                        TO WS-ABEND-MESSAGE
  7662                GO TO ABEND-PGM.
  7663*END***************CUSTOM CODE FOR CLIENT "DMD"*************
  7664
  7665     IF ERACCTT-FILE-STATUS  = '00'  OR  '97'
  7666         NEXT SENTENCE
  7667       ELSE
  7668         MOVE '11'                    TO ABEND-CODE-1
  7669         MOVE ERACCTT-FILE-STATUS     TO ABEND-CODE-2
  7670         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  7671         GO TO ABEND-PGM.
  7672
  7673     IF ELCRTT-FILE-STATUS  = '00'  OR  '97'
  7674        CONTINUE
  7675     ELSE
  7676        DISPLAY ' OPEN ERROR ELCRTT '
  7677        MOVE '31'                TO ABEND-CODE-1
  7678        MOVE ELCRTT-FILE-STATUS  TO ABEND-CODE-2
  7679        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7680        GO TO ABEND-PGM
  7681     END-IF
  7682
  7683     IF ERAGTC-FILE-STATUS  = '00'  OR  '97'
  7684        CONTINUE
  7685     ELSE
  7686        DISPLAY ' OPEN ERROR ERAGTC '
  7687        MOVE '41'                TO ABEND-CODE-1
  7688        MOVE ERAGTC-FILE-STATUS  TO ABEND-CODE-2
  7689        MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  7690        GO TO ABEND-PGM
  7691     END-IF
  7692
  7693     IF ERMEBL-FILE-STATUS  = '00'  OR  '97'
  7694         NEXT SENTENCE
  7695       ELSE
  7696         MOVE 'N'                     TO ME-UPDATE-FLAG.
  7697
  7698     IF DTE-PGM-OPT = '1'
  7699         OPEN OUTPUT  CERT-MASTER-OUT
  7700                      DETAIL-EXTR
  7701     ELSE
  7702         MOVE HIGH-VALUES             TO PENDING-MATCH-CONTROL
  7703         MOVE '*'                     TO TRANS-EOF-FLAG.
  7704
  7705     MOVE 'R'                         TO CP-RATE-FILE.
  7706     MOVE 'O'                         TO CP-IO-FUNCTION.
  7707     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
  7708     IF IO-ERROR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS010V.cbl
  7709         MOVE 'ERROR OCCURED OPENING - ELRATE'
  7710                                      TO WS-ABEND-MESSAGE
  7711         MOVE 0302                    TO WS-RETURN-CODE
  7712         GO TO ABEND-PGM.
  7713
  7714******************************************************************
  7715***       I N I T I A L I Z A T I O N   R O U T I N E          ***
  7716******************************************************************
  7717
  7718 0090-INITIALIZATION-ROUTINE.
  7719
  7720     ACCEPT WS-TIME-OF-DAY   FROM TIME.
  7721     MOVE WS-TIME                     TO ME-START-TIME.
  7722     MOVE WS-CURRENT-DATE             TO ME-START-DATE
  7723                                         TR-RN-DT.
  7724     MOVE ME-START-MO                 TO ME-CNDS-MO.
  7725     MOVE ME-START-DA                 TO ME-CNDS-DA.
  7726     MOVE ME-START-YR                 TO ME-CNDS-YR.
  7727     COMPUTE MONTH-END-MOYR = (RUN-CCYY * 12) + RUN-MO.
  7728     MOVE COMPANY-NAME                TO TRHDNM.
  7729     MOVE ALPH-DATE                   TO TR-MODAYR.
  7730     MOVE RUN-DATE                    TO EOM-RUN-DATE.
  7731     MOVE BIN-RUN-DATE                TO BIN-EOM-RUN-DATE.
  7732
  7733     MOVE EOM-RUN-DATE                TO  LAST-YRS-DATE.
  7734     COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7735     COMPUTE LYD-MO = LYD-MO - 1.
  7736     IF LYD-MO = ZERO
  7737         MOVE 12                      TO LYD-MO
  7738         COMPUTE LYD-CCYY = LYD-CCYY - 1.
  7739
  7740     MOVE BIN-EOM-RUN-DATE       TO BIN-VALUATION-DT.
  7741
  7742
  7743     IF DTE-CLIENT = 'CID'
  7744         MOVE 'CILGM15'          TO  WS-ME-BAL-JOB
  7745         MOVE 'CILGM15'          TO  WS-ME50-BAL-JOB
  7746     ELSE
  7747         MOVE 'CIDCLGM15'        TO  WS-ME-BAL-JOB
  7748         MOVE 'CIDCLGM15'        TO  WS-ME50-BAL-JOB
  7749     END-IF.
  7750
  7751     IF  NOT DTE-OPT-RESERVE-METHOD-AUTH
  7752         GO TO 0090-CONTINUE.
  7753
  7754     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7755     MOVE -12                    TO DC-ELAPSED-MONTHS.
  7756     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7757     MOVE '6'                    TO DC-OPTION-CODE.
  7758     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7759
  7760     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7761         MOVE '**** WORK DATE CALC ERROR ****'
  7762                                 TO WS-ABEND-MESSAGE
  7763         MOVE '90'               TO ABEND-CODE-1
  7764         MOVE '0'                TO AC2-ONE
  7765         MOVE DC-ERROR-CODE      TO AC2-TWO
  7766         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS010V.cbl
  7767         GO TO ABEND-PGM.
  7768
  7769     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE.
  7770
  7771     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (01).
  7772     MOVE EOM-RUN-DATE           TO  EOM-DATE (13).
  7773
  7774     PERFORM 0095-GET-EOM-DATES THRU 0095-EXIT
  7775             VARYING
  7776         SUBM FROM +2 BY +1
  7777             UNTIL
  7778         SUBM GREATER THAN +12.
  7779
  7780     DISPLAY 'END OF MONTH TABLE VALUES USED BY ECS010 - '.
  7781
  7782     PERFORM 0096-DISPLAY-EOM-DATES THRU 0096-EXIT
  7783             VARYING
  7784         SUBM FROM +1 BY +1
  7785             UNTIL
  7786         SUBM GREATER THAN +13.
  7787
  7788     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7789*    MOVE -90                    TO DC-ELAPSED-DAYS.
  7790     MOVE ZEROS                  TO DC-ELAPSED-DAYS
  7791                                    DC-ELAPSED-MONTHS.
  7792     SUBTRACT COMPANY-IBNR-LAG-MONTH FROM DC-ELAPSED-MONTHS.
  7793     MOVE 1                      TO DC-END-OF-MONTH.
  7794     MOVE '6'                    TO DC-OPTION-CODE.
  7795     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7796
  7797     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7798         MOVE '**** CUT OFF DATE ERROR ****'
  7799                                 TO WS-ABEND-MESSAGE
  7800         MOVE '90'               TO ABEND-CODE-1
  7801         MOVE '0'                TO AC2-ONE
  7802         MOVE DC-ERROR-CODE      TO AC2-TWO
  7803         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7804         GO TO ABEND-PGM.
  7805
  7806     MOVE DC-GREG-DATE-CYMD      TO W-CUTOFF-DATE.
  7807     DISPLAY ' CUT OFF DATE - '  W-CUTOFF-DATE.
  7808
  7809 0090-CONTINUE.
  7810
  7811     MOVE BIN-VALUATION-DT       TO DC-BIN-DATE-1.
  7812     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7813     MOVE +0                     TO DC-ELAPSED-DAYS.
  7814     MOVE '6'                    TO DC-OPTION-CODE.
  7815     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7816
  7817     IF NO-CONVERSION-ERROR
  7818        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (1).
  7819
  7820     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
  7821     MOVE -1                     TO DC-ELAPSED-MONTHS.
  7822     MOVE +0                     TO DC-ELAPSED-DAYS.
  7823     MOVE '6'                    TO DC-OPTION-CODE.
  7824     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS010V.cbl
  7825
  7826     IF NO-CONVERSION-ERROR
  7827        MOVE DC-GREG-DATE-CYMD   TO OB-RUN-DATES (2).
  7828
  7829     MOVE +0                     TO DC-ELAPSED-MONTHS
  7830                                    DC-ELAPSED-DAYS.
  7831
  7832     MOVE SPACES                 TO CERTIFICATE-RECORD.
  7833     MOVE 'CR'                   TO CR-RECORD-ID.
  7834     MOVE ZEROS                  TO
  7835               CR-AGE                  CR-JOINT-AGE
  7836               CR-LFTYP                CR-AHTYP
  7837               CR-LF-TERM              CR-AH-TERM
  7838               CR-LF-CRIT-PERIOD       CR-AH-CRIT-PERIOD
  7839               CR-LF-TERM-IN-DAYS
  7840               CR-LF-DEV-PCT           CR-AH-DEV-PCT
  7841               CR-LFAMT                CR-AHAMT
  7842               CR-LFPRM                CR-AHPRM
  7843               CR-LF-POLICY-FEE        CR-AH-POLICY-FEE
  7844               CR-LFPRM-CALC           CR-AHPRM-CALC
  7845               CR-LFPRM-RATE           CR-AHPRM-RATE
  7846               CR-LFAMT-ALT
  7847               CR-LFPRM-ALT            CR-ISS-MICROFILM-NO
*  12-S*********************************************************       (   0)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  7848               CR-LFPRM-CALC-ALT       CR-CAN-MICROFILM-NO
  7849               CR-LFPRM-RATE-ALT
  7850               CR-LFRFND               CR-AHRFND
  7851               CR-LFRFND-CALC          CR-AHRFND-CALC
  7852               CR-LF-NSP-PRM           CR-AH-NSP-PRM
  7853               CR-LF-NSP-PRM-RATE      CR-AH-NSP-PRM-RATE
  7854               CR-LF-REI-RISK-PRM      CR-AH-REI-RISK-PRM
  7855               CR-LF-EXPIRE-DATE       CR-AH-EXPIRE-DATE
  7856               CR-LIVES                CR-APR
  7857               CR-BILLED
  7858               CR-LF-ISS-PREM-TAX      CR-AH-ISS-PREM-TAX
  7859               CR-LF-CNC-PREM-TAX      CR-AH-CNC-PREM-TAX
  7860               CR-PMT-FREQ             CR-LOAN-TERM
  7861               CR-SKIP                 CR-LOAN-1ST-PMT-DT
  7862               CR-SUM-CAN-CNT-ITD      CR-SUM-CAN-CNT-YTD
  7863               CR-PMT-EXTENSION-DAYS   CR-ENTRY-DATE
  7864               CR-LF-CANC-DT           CR-AH-CANC-DT
  7865               CR-LF-CANCEL-EXIT-DATE  CR-AH-CANCEL-EXIT-DATE
  7866               CR-LF-CLAIM-EXIT-DATE   CR-AH-SETTLEMENT-EXIT-DATE
  7867               CR-NUM-DTH-CLM          CR-NUM-DIS-CLM
  7868               CR-DTH-DT               CR-DIS-DT
  7869               CR-DTH-RPT-DT           CR-DIS-RPT-DT
  7870               CR-DTH-PAY-DT           CR-DIS-PAY-DT
  7871                                       CR-DIS-PTO-DT
  7872               CR-DTHAMT               CR-DISAMT
  7873               CR-DTHAMT-YTD           CR-DISAMT-YTD
  7874               CR-DTHAMT-LAST          CR-DISAMT-LAST
  7875               CR-DTHEXP               CR-DISEXP
  7876               CR-DTHEXP-YTD           CR-DISEXP-YTD
  7877               CR-DTH-AGE              CR-DAYS-DISAB
  7878               CR-DIS-INCUR-DT (1)     CR-CLAIM-DEDUCT-WITHHELD
  7879               CR-INCUR-DISAMT (1)     CR-CANCEL-DEDUCT-WITHHELD
  7880               CR-INCUR-DISEXP (1)     CR-REMIT-TO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS010V.cbl
  7881               CR-CANCEL-STATE-TAX     CR-CANCEL-MUNI-TAX
  7882               CR-MOB-NET-TOT-FEES
  7883               CR-ADDL-CLP.
  7884
  7885     MOVE CR-DISAB-DETAIL-DATA (1)  TO CR-DISAB-DETAIL-DATA (2)
  7886                                       CR-DISAB-DETAIL-DATA (3)
  7887                                       CR-DISAB-DETAIL-DATA (4)
  7888                                       CR-DISAB-DETAIL-DATA (5).
  7889
  7890     MOVE CERTIFICATE-RECORD     TO INITIALIZED-CERTIFICATE.
  7891
  7892     MOVE SPACES                 TO WS-BANK-COMMISSIONS
  7893     PERFORM VARYING IA FROM +1 BY +1 UNTIL
  7894        IA > +10
  7895        MOVE ZEROS               TO WS-BNK-SPP-FEES (IA)
  7896     END-PERFORM
  7897     MOVE WS-BANK-COMMISSIONS    TO WS-BANK-INIT
  7898
  7899     MOVE LOW-VALUES   TO ACCOUNT-MASTER   CERTIFICATE-RECORD.
  7900
  7901     MOVE HIGH-VALUES  TO REIN-HOLD-AREAS  RC-REIN-HOLD-AREAS
  7902                          EPEC-TOTALS      EPEC-SUBS
  7903                          EPEC-UNDERWRITTEN-TOTALS.
  7904
  7905     MOVE ZEROS        TO EPEC-LEVELS-END  EPEC-SUBS-END
  7906                          EPEC-LEVELS-END-II.
  7907     MOVE SPACES       TO REIN-LEVELS-END  RC-REIN-LEVELS-END
  7908                          DUPE-CERT-TABLE.
  7909
  7910     PERFORM CLEAR-REIN-HOLD        THRU CLEAR-REIN-HOLD-X.
  7911     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
  7912     PERFORM 5900-CLEAR-TOTAL-PAGES THRU 5999-CLEAR-TOTAL-PAGES-X
  7913                VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 6.
  7914     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
  7915                VARYING B-SUB FROM 1 BY 1 UNTIL B-SUB GREATER 50.
  7916
  7917     IF RUN-DATE NOT = EP-DT
  7918         MOVE '*'                     TO TR-YRASK.
  7919     MOVE LIFE-OVERRIDE-L6            TO TR-7-LF.
  7920     MOVE LIFE-OVERRIDE-L2            TO DET-LF-DESC.
  7921     MOVE AH-OVERRIDE-L6              TO TR-7-AH.
  7922     MOVE AH-OVERRIDE-L2              TO DET-AH-DESC.
  7923
  7924     IF DTE-CLIENT = 'FIA' OR 'TAO' OR 'PEK'
  7925         MOVE +1000                   TO DUP-MAX.
  7926
  7927     MOVE DTE-CLIENT                  TO ME-COMPANY.
  7928     MOVE MONTH-END-MOYR              TO ME-MOYR.
  7929     IF ME-DO-UPDATE
  7930         READ ERMEBL-INOUT INVALID KEY
  7931                       CLOSE ERMEBL-INOUT
  7932                       MOVE 'N'       TO ME-UPDATE-FLAG.
  7933
  7934     GO TO 0150-READ-ACCOUNT-MASTER.
  7935
  7936 0090-EXIT.
  7937     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS010V.cbl
  7939 0095-GET-EOM-DATES.
  7940
  7941     MOVE W-WORK-DATE            TO DC-BIN-DATE-1.
  7942     MOVE '6'                    TO DC-OPTION-CODE.
  7943     MOVE 1                      TO DC-ELAPSED-MONTHS
  7944                                    DC-END-OF-MONTH.
  7945     MOVE ZEROS                  TO DC-ELAPSED-DAYS.
  7946     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7947
  7948     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7949         MOVE '**** EOM PLUS 1 DATE CALC ERROR ****'
  7950                                 TO WS-ABEND-MESSAGE
  7951         MOVE '90'               TO ABEND-CODE-1
  7952         MOVE '0'                TO AC2-ONE
  7953         MOVE DC-ERROR-CODE      TO AC2-TWO
  7954         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7955         GO TO ABEND-PGM.
  7956
  7957     MOVE DC-BIN-DATE-2          TO  W-WORK-DATE
  7958                                     DC-BIN-DATE-1.
  7959     MOVE SPACES                 TO  DC-BIN-DATE-2.
  7960     MOVE ' '                    TO  DC-OPTION-CODE.
  7961     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  7962
  7963     IF  DC-ERROR-CODE NOT EQUAL SPACES
  7964         MOVE '**** YMD EOM DATE CALC ERROR ****'
  7965                                 TO WS-ABEND-MESSAGE
  7966         MOVE '90'               TO ABEND-CODE-1
  7967         MOVE '0'                TO AC2-ONE
  7968         MOVE DC-ERROR-CODE      TO AC2-TWO
  7969         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  7970         GO TO ABEND-PGM.
  7971
  7972     MOVE DC-GREG-DATE-CYMD      TO  EOM-DATE (SUBM).
  7973
  7974 0095-EXIT.
  7975     EXIT.
  7976
  7977 0096-DISPLAY-EOM-DATES.
  7978
  7979     DISPLAY SUBM '. ' EOM-DATE (SUBM).
  7980
  7981 0096-EXIT.
  7982     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS010V.cbl
  7984******************************************************************
  7985***    R E A D   A C C O U N T   M A S T E R   R O U T I N E   ***
  7986******************************************************************
  7987
  7988 0100-ACCT-MASTER-READ-ROUTINE.
  7989
  7990     IF EP-FLG = '1'
  7991        ADD +1                   TO BC-ACT-ACCTS
  7992        IF DTE-OPT-RESERVE-METHOD-AUTH
  7993           PERFORM 4700-CALC-OPT-IBNR
  7994                                 THRU 4700-EXIT
  7995        END-IF
  7996        PERFORM 4500-BUILD-EPEC-EXTRACT
  7997                                 THRU 4599-BUILD-EPEC-EXTRACT-X
  7998     END-IF
  7999
  8000     IF TRANSACTION-WAS-PROCESSED
  8001         MOVE '1'                     TO ACCT-FLG
  8002                                         STATE-FLG
  8003                                         COMP-FLG
  8004                                         CARR-FLG
  8005                                         FINAL-FLG.
  8006
  8007 0150-READ-ACCOUNT-MASTER.
  8008
  8009     READ ERACCTT-IN AT END
  8010         GO TO 9930-EOJ-3.
  8011
  8012     ADD +1                            TO ERACCTT-READS.
  8013
* 8014     COPY ELCACCTI.
  8015******************************************************************04/14/98
  8016*                                                                *ELCACCTI
  8017*                            ELCACCTI                            *   LV003
  8018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8019*                            VMOD=2.001                          *ELCACCTI
  8020*                                                                *ELCACCTI
  8021*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  8022*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  8023*                                                                *ELCACCTI
  8024*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  8025*                                                                *ELCACCTI
  8026******************************************************************ELCACCTI
  8027     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  8028     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  8029     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  8030     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  8031     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  8032     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  8033     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  8034     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  8035     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  8036
  8037     IF FIRST-ACCOUNT EQUAL +1
  8038        MOVE +0                  TO FIRST-ACCOUNT
  8039        GO TO 0190-PROCESS-NEW-ACCOUNT.
  8040
  8041     IF AM-CARRIER NOT = HLD-CARRIER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS010V.cbl
  8042         PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X
  8043     ELSE
  8044     IF AM-GROUPING NOT = HLD-GROUPING
  8045         PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X
  8046     ELSE
  8047     IF AM-STATE NOT = HLD-STATE
  8048         PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X
  8049     ELSE
  8050     IF AM-ACCOUNT NOT = HLD-ACCT
  8051         PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X
  8052     ELSE
  8053     PERFORM 5000-DATE-RANGE-BREAK THRU 5099-DATE-RANGE-BREAK-X.
  8054
  8055     IF (AM-CARRIER NOT = HLD-CARRIER) OR
  8056        (AM-GROUPING NOT = HLD-GROUPING)
  8057         PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
  8058
  8059 0190-PROCESS-NEW-ACCOUNT.
  8060
  8061     IF AM-CARRIER NOT = HLD-CARRIER
  8062         PERFORM 0199A-CARRIER-TABLE-LOOKUP THRU 0199A-LOOKUP-XIT.
  8063
  8064     MOVE AM-CONTROL-A          TO HLD-CONTROL.
  8065     MOVE AM-CARRIER            TO TR-CARR.
  8066     MOVE AM-GROUPING           TO TR-GROUP.
  8067     MOVE AM-ACCOUNT            TO TR-AG-NO.
  8068     MOVE AM-NAME               TO TR-AGCY.
  8069     MOVE AM-EFF-MO             TO TR-CE-MO.
  8070     MOVE AM-EFF-DA             TO TR-CE-DA.
  8071     MOVE AM-EFF-YR             TO TR-CE-YR.
  8072     MOVE AM-STATE              TO TR-ST-NO.
  8073     IF AM-EXPIRE-DT =  99999999999
  8074         MOVE 'CURRENT '        TO TR-CX
  8075     ELSE
  8076         MOVE AM-EXP-MO         TO TR-CX-MO
  8077         MOVE AM-EXP-DA         TO TR-CX-DA
  8078         MOVE AM-EXP-YR         TO TR-CX-YR
  8079         MOVE '-'               TO HSHR1  HSHR2.
  8080
  8081     ADD +1 TO BC-ACCTS.
  8082
  8083     IF AM-RECORD-ID = '**'
  8084         ADD +1 TO BC-NEW-ACCTS.
  8085     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  8086         ADD +1 TO BC-ER-ACCTS.
  8087
  8088     MOVE ZEROS                 TO SV-LO-CERT
  8089                                   SV-HI-CERT.
  8090     MOVE SPACE                 TO TRANSACTION-FLAG
  8091                                   LST-TRD-CERT
  8092                                   LST-TRD-ISDT
  8093                                   OB-DATE-1-SWITCH
  8094                                   OB-DATE-2-SWITCH
  8095                                   OB-DATE-3-SWITCH.
  8096     MOVE +81                   TO LN-CNT.
  8097
  8098 0199-READ-ACCOUNT-X.
  8099     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS010V.cbl
  8100
  8101 0199A-CARRIER-TABLE-LOOKUP.
  8102
  8103     PERFORM 0199B-SEARCH-CARRIER-TABLE
  8104            VARYING CLAS-INDEXCN FROM 1 BY 1
  8105         UNTIL AM-CARRIER = CARRIER-SUB (CLAS-INDEXCN)  OR
  8106               CLAS-INDEXCN GREATER CLAS-MAXCN.
  8107
  8108     IF CLAS-INDEXCN GREATER CLAS-MAXCN
  8109         DISPLAY 'CARRIER NOT IN CARRIER NAME TABLE: ' AM-CARRIER
  8110         MOVE '** CARRIER NOT IN CARRIER NAME TABLE **'
  8111                                 TO WS-ABEND-MESSAGE
  8112         MOVE 4004               TO WS-ABEND-CODE
  8113         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
  8114         GO TO ABEND-PGM.
  8115
  8116 0199A-LOOKUP-XIT.
  8117     EXIT.
  8118 0199B-SEARCH-CARRIER-TABLE.
  8119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS010V.cbl
  8121******************************************************************
  8122***       R E A D   C E R T   M A S T E R   R O U T I N E      ***
  8123******************************************************************
  8124
  8125 0200-CERT-MASTER-READ-ROUTINE.
  8126
  8127     IF EOF-ON-CERT
  8128         GO TO 0299-READ-CERT-X.
  8129
  8130     IF FIRST-CERT EQUAL +1
  8131        MOVE +0                  TO FIRST-CERT
  8132        GO TO 0250-READ-CERT-MASTER.
  8133
  8134     MOVE CERT-IN-RECORD             TO CERTIFICATE-RECORD.
  8135
  8136     PERFORM CERT-DATE-LOAD.
  8137
  8138     IF CR-IND-GRP = 'I'  OR  '1'
  8139         MOVE '1'                    TO CR-IND-GRP
  8140     ELSE
  8141         MOVE '2'                    TO CR-IND-GRP.
  8142
  8143     IF CR-LF-REI-RISK-PRM NOT NUMERIC
  8144         MOVE ZEROS                TO CR-LF-REI-RISK-PRM.
  8145     IF CR-AH-REI-RISK-PRM NOT NUMERIC
  8146         MOVE ZEROS                TO CR-AH-REI-RISK-PRM.
  8147
  8148************ TEMP CODE TO INITIALIZE RISK PREM FIELDS ************
  8149     IF DTE-CLIENT NOT = 'NSL'
  8150         MOVE ZEROS                TO CR-LF-REI-RISK-PRM
  8151                                      CR-AH-REI-RISK-PRM.
  8152******************************************************************
  8153
  8154     IF CR-CLAIM-DEDUCT-WITHHELD NOT NUMERIC
  8155         MOVE ZEROS                TO CR-CLAIM-DEDUCT-WITHHELD.
  8156     IF CR-CANCEL-DEDUCT-WITHHELD NOT NUMERIC
  8157         MOVE ZEROS                TO CR-CANCEL-DEDUCT-WITHHELD.
  8158
  8159     MOVE CR-STATE                   TO STATE-L.
  8160     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  8161
  8162     IF CR-LFTYP NOT = ZERO
  8163         MOVE CR-LFTYP               TO CLAS-LOOK
  8164         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8165
  8166     IF CR-AHTYP NOT = ZERO
  8167         MOVE CR-AHTYP               TO CLAS-LOOK
  8168         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8169
  8170     MOVE CR-DT                  TO DC-GREG-DATE-CYMD
  8171     MOVE 'L'                    TO DC-OPTION-CODE
  8172     MOVE +0                     TO DC-ELAPSED-MONTHS
  8173                                    DC-ELAPSED-DAYS
  8174     PERFORM 8000-DATE-CONVERT-ROUTINE
  8175                                 THRU 8099-DATE-CONVERT-X
  8176     MOVE DC-BIN-DATE-1          TO WS-CR-BIN-DATE
  8177
  8178     IF (DTE-CLIENT = 'DCC')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS010V.cbl
  8179        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  8180        PERFORM 0395-GET-CERT-TRLRS
  8181                                 THRU 0395-EXIT
  8182     END-IF
  8183
  8184     IF RUN-MO NOT = 01
  8185         GO TO 0250-READ-CERT-MASTER.
  8186
  8187     MOVE ZERO                 TO CR-DTHAMT-YTD  CR-DISAMT-YTD
  8188                                  CR-DTHEXP-YTD  CR-DISEXP-YTD.
  8189
  8190     IF ((CR-LFTYP NOT = ZERO)  AND
  8191         (CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'))  OR
  8192        ((CR-AHTYP NOT = ZERO)  AND
  8193         (CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'))
  8194           MOVE ZERO           TO CR-SUM-CAN-CNT-YTD.
  8195
  8196     .
  8197 0250-READ-CERT-MASTER.
  8198
  8199     READ CERT-MASTER-IN
  8200               AT END GO TO 9920-EOJ-2.
  8201
  8202     ADD +1 TO CMIN-CNT.
  8203
  8204     IF CIR-CONTROL LESS THAN PRIOR-CERT-IN-CNTRL
  8205         DISPLAY 'SEQUENCE ERROR ON CERT MASTER'
  8206         DISPLAY 'FIRST  - '  PRIOR-CERT-IN-CNTRL
  8207         DISPLAY 'SECOND - '  CIR-CONTROL
  8208         MOVE 0612                    TO WS-ABEND-CODE
  8209         MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
  8210         GO TO ABEND-PGM.
  8211
  8212     IF CIR-CONTROL = PRIOR-CERT-IN-CNTRL
  8213         DISPLAY 'DUPLICATE CERT ON FILE'  PRIOR-CERT-IN-CNTRL
  8214         IF DTE-CLIENT EQUAL 'SEN'
  8215            GO TO 0250-READ-CERT-MASTER
  8216         ELSE
  8217            MOVE 'DUPLICATE CERT ON FILE'
  8218                                      TO WS-ABEND-MESSAGE
  8219            MOVE 0302                 TO WS-ABEND-CODE
  8220            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8221            GO TO ABEND-PGM.
  8222
  8223******************************************************
  8224*   THIS LOGIC WAS ADDED TO ACCOMMODATE THE EXECUTION
  8225*   OF A "MID MONTH" BILLING REPORT (EL562) FOR
  8226*   COMMERCIAL FEDERAL BANK AND PEOPLES TRUST
  8227******************************************************
  8228     IF DTE-CLIENT = 'CID'
  8229        IF COMPANY-NAME = '      COMMERCIAL FEDERAL'
  8230           IF (CF-THIRD-AGENT  = '0000713100') OR
  8231              (CF-FOURTH-AGENT = '0000713100')
  8232              CONTINUE
  8233           ELSE
  8234              GO TO 0250-READ-CERT-MASTER
  8235           END-IF
  8236        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS010V.cbl
  8237           IF COMPANY-NAME = '        PEOPLES TRUST'
  8238              IF CI-ACCOUNT = '0000845800'
  8239                 CONTINUE
  8240              ELSE
  8241                 GO TO 0250-READ-CERT-MASTER
  8242              END-IF
  8243           ELSE
  8244              IF COMPANY-NAME = '        SUNFLOWER BANK'
  8245                 IF (CF-THIRD-AGENT  = '0000681700') OR
  8246                    (CF-FOURTH-AGENT = '0000681700')
  8247                    CONTINUE
  8248                 ELSE
  8249                    GO TO 0250-READ-CERT-MASTER
  8250                 END-IF
  8251              ELSE
  8252                 IF COMPANY-NAME = '      FIRST PREMIER BANK'
  8253                    IF CI-ACCOUNT = '0001107200'
  8254                       CONTINUE
  8255                    ELSE
  8256                       GO TO 0250-READ-CERT-MASTER
  8257                    END-IF
  8258                 END-IF
  8259              END-IF
  8260           END-IF
  8261        END-IF
  8262     END-IF
  8263
  8264******************************************************
  8265     MOVE CIR-CONTROL                 TO PRIOR-CERT-IN-CNTRL.
  8266
  8267 0299-READ-CERT-X.
  8268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS010V.cbl
  8270******************************************************************
  8271***     R E A D   P E N D I N G   F I L E   R O U T I N E      ***
  8272******************************************************************
  8273
  8274 0300-READ-PENDING-TRANSACTIONS.
  8275
  8276     READ PENDING-EXTRACT
  8277                   AT END GO TO 9910-EOJ-1.
  8278
  8279     MOVE SPACE                    TO PENDING-RECORD-TYPE.
  8280
  8281     IF NOT ED-PENDING-BUSINESS  AND
  8282        NOT ED-PENDING-CLAIMS  AND
  8283        NOT ED-CERT-CHANGES
  8284           DISPLAY 'INVALID EXTRACT TYPE INTO ECS010 - TYPE = '
  8285                                               ED-RECORD-TYPE
  8286           MOVE 0301                        TO WS-ABEND-CODE
  8287           MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8288           GO TO ABEND-PGM.
  8289
  8290     PERFORM 0310-SET-UP-MATCHING-KEY THRU 0310-EXIT.
  8291
  8292     IF DTE-CLIENT = 'NCL'
  8293         IF PEND-MATCH-EFF-DTE LESS THAN 19400101
  8294             DISPLAY 'TRANS DROPPED: ' PENDING-MATCH-CONTROL
  8295                     '  TRANS TYPE: ' PENDING-RECORD-TYPE
  8296             GO TO 0300-READ-PENDING-TRANSACTIONS.
  8297
  8298     IF PENDING-MATCH-CONTROL  LESS THAN  PRIOR-MATCH-CNTRL
  8299         DISPLAY 'SEQUENCE ERROR ON TRANSACTION FILE'
  8300         DISPLAY ' PRIOR SEQ.   = '  PRIOR-MATCH-CNTRL
  8301         DISPLAY ' CURRENT SEQ. = '  PENDING-MATCH-CONTROL
  8302         MOVE 0603                    TO WS-ABEND-CODE
  8303         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8304         GO TO ABEND-PGM.
  8305
  8306     ADD +1 TO TR-CNT.
  8307
  8308     IF ISSUE-TRANSACTION   OR
  8309        CANCEL-TRANSACTION  OR
  8310        CLAIM-TRANSACTION   OR
  8311        RESERVE-TRANSACTION OR
  8312        UPDATE-TRANSACTION
  8313         MOVE PENDING-MATCH-CONTROL   TO PRIOR-MATCH-CNTRL
  8314         GO TO 0330-MATCH-PENDING-TO-CERT.
  8315
  8316     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8317
  8318     DISPLAY 'INVALID TRANSACTION INTO ECS010 '.
  8319     DISPLAY '  MATCH CONTROL: ' PENDING-MATCH-CONTROL ' TYPE: ('
  8320             PENDING-RECORD-TYPE ')'.
  8321
  8322     MOVE 0301                   TO WS-ABEND-CODE.
  8323     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8324     GO TO ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS010V.cbl
  8326 0310-SET-UP-MATCHING-KEY.
  8327
  8328     IF ED-PENDING-BUSINESS
  8329         MOVE ED-DATA-AREAS      TO PENDING-BUSINESS
  8330         MOVE PB-CARRIER         TO PEND-MATCH-CARRIER
  8331         MOVE PB-GROUPING        TO PEND-MATCH-GROUPING
  8332         MOVE PB-STATE           TO PEND-MATCH-STATE
  8333         MOVE PB-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8334         MOVE PB-CERT-EFF-DT     TO DC-BIN-DATE-1
  8335         MOVE PB-CERT-NO         TO PEND-MATCH-CERT-NO
  8336         MOVE PB-RECORD-TYPE     TO PENDING-RECORD-TYPE.
  8337
  8338     IF ED-PENDING-CLAIMS
  8339         ADD +1                  TO W-PENDING-CLMS
  8340         MOVE ED-DATA-AREAS      TO PENDING-CLAIMS
  8341         MOVE PC-CARRIER         TO PEND-MATCH-CARRIER
  8342         MOVE PC-GROUPING        TO PEND-MATCH-GROUPING
  8343         MOVE PC-STATE           TO PEND-MATCH-STATE
  8344         MOVE PC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8345         MOVE PC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8346         MOVE PC-CERT-NO         TO PEND-MATCH-CERT-NO
  8347         IF PC-CLAIMS
  8348             MOVE '3'            TO PENDING-RECORD-TYPE
  8349         ELSE
  8350             IF PC-RESERVES
  8351                 MOVE '4'        TO PENDING-RECORD-TYPE.
  8352
  8353     IF ED-CERT-CHANGES
  8354         MOVE ED-DATA-AREAS      TO PENDING-MAINT-TO-CERT-FILE
  8355         MOVE CC-CARRIER         TO PEND-MATCH-CARRIER
  8356         MOVE CC-GROUPING        TO PEND-MATCH-GROUPING
  8357         MOVE CC-STATE           TO PEND-MATCH-STATE
  8358         MOVE CC-ACCOUNT         TO PEND-MATCH-ACCOUNT
  8359         MOVE CC-CERT-EFF-DT     TO DC-BIN-DATE-1
  8360         MOVE CC-CERT-NO         TO PEND-MATCH-CERT-NO
  8361         MOVE '5'                TO PENDING-RECORD-TYPE.
  8362
  8363     MOVE ' '                    TO DC-OPTION-CODE.
  8364     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8365     MOVE DC-GREG-DATE-CYMD      TO PEND-MATCH-EFF-DTE.
  8366
  8367 0310-EXIT.
  8368     EXIT.
  8369
  8370******************************************************************
  8371***    M A T C H   P E N D I N G   F I L E   T O   C E R T     ***
  8372******************************************************************
  8373
  8374 0330-MATCH-PENDING-TO-CERT.
  8375
  8376     IF PENDING-MATCH-CONTROL  LESS THAN  CR-FULL-CONTROL
  8377         GO TO 0390-CERT-MISMATCH-ERROR.
  8378
  8379     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8380       IF CLAIM-TRANSACTION
  8381         IF NOT PC-CHARGEBLE-EXPENSE  AND
  8382            NOT PC-NON-CHARGEBLE-EXPENSE
  8383             IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS010V.cbl
  8384                                      OR
  8385                ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8386                  GO TO 0390-CERT-MISMATCH-ERROR.
  8387
  8388     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8389       IF RESERVE-TRANSACTION
  8390         IF ((PC-CLAIM-TYPE = '1' OR '3') AND CR-LFTYP = '00')
  8391                                  OR
  8392            ((PC-CLAIM-TYPE = '2' OR '4') AND CR-AHTYP = '00')
  8393              GO TO 0390-CERT-MISMATCH-ERROR.
  8394
  8395     IF PENDING-MATCH-CONTROL  EQUAL   CR-FULL-CONTROL
  8396         IF ISSUE-TRANSACTION
  8397             GO TO 0380-DUPLICATE-CERT-ERROR
  8398         ELSE
  8399             GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8400
  8401     IF PENDING-MATCH-CONTROL  NOT LESS THAN  CIR-CONTROL
  8402         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8403         PERFORM 0200-CERT-MASTER-READ-ROUTINE THRU
  8404                                               0299-READ-CERT-X
  8405         GO TO 0330-MATCH-PENDING-TO-CERT.
  8406
  8407     IF ISSUE-TRANSACTION
  8408         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
  8409     ELSE
  8410         GO TO 0390-CERT-MISMATCH-ERROR.
  8411
  8412 0350-MATCH-PENDING-TO-ACCOUNT.
  8413
  8414     IF PENDING-ACCOUNT-CONTROL LESS THAN AM-CONTROL-A
  8415       ADD +1  TO ERROR-COUNT
  8416         MOVE    '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8417           TO  DL-FULL
  8418             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8419         MOVE    ' PENDING CONTROL = '
  8420           TO  DIS-LINE-REASON
  8421         MOVE  PENDING-MATCH-CONTROL
  8422           TO  DIS-LINE-REC
  8423             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8424         MOVE    ' KEY OF PENDING REC BYPASSED - '
  8425           TO  DIS-LINE-REASON
  8426         MOVE  PENDING-MATCH-CONTROL
  8427           TO  DIS-LINE-REC
  8428             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8429         MOVE  SPACES
  8430           TO  DISPLAY-LINE
  8431             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8433         DISPLAY '*** MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8434         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
  8435         DISPLAY 'PENDING REC BYPASSED - ' PENDING-MATCH-CONTROL
  8436         DISPLAY 'TRAN TYPE =   '  PENDING-RECORD-TYPE
  8437         DISPLAY '  TYPE  1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8438         DISPLAY '    ACCOUNT CONTROL = '
  8439         AM-MSTR-CNTRL AM-EFFECT-DT
  8440         IF DTE-CLIENT = 'UAL'  OR  'NCL' OR 'CID'
  8441            DISPLAY 'TRANS BYPASSED.... CLIENT = ' DTE-CLIENT
  8442            GO TO 0300-READ-PENDING-TRANSACTIONS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS010V.cbl
  8443         ELSE
  8444            MOVE 'MISMATCH BETWEEN PENDING TRAN AND ACCOUNT'
  8445                                      TO WS-ABEND-MESSAGE
  8446            MOVE 0302 TO WS-ABEND-CODE
  8447            MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8448            GO TO ABEND-PGM.
  8449
  8450     IF PENDING-ACCOUNT-CONTROL GREATER AM-CONTROL-A
  8451         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8452                                              0199-READ-ACCOUNT-X
  8453         GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8454
  8455     IF PEND-MATCH-EFF-DTE NOT LESS THAN AM-EFFECT-DT  AND
  8456        PEND-MATCH-EFF-DTE LESS THAN AM-EXPIRE-DT
  8457         GO TO 0500-APPLY-PENDING-BUSINESS.
  8458
  8459     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8460                                       0199-READ-ACCOUNT-X.
  8461     GO TO 0350-MATCH-PENDING-TO-ACCOUNT.
  8462
  8463
  8464 0370-ACCOUNT-MISMATCH-ERROR.
  8465
  8466     DISPLAY 'MISMATCH ACCOUNT ERROR'
  8467     DISPLAY '    ACCOUNT CONTROL = ' AM-MSTR-CNTRL AM-EFFECT-DT.
  8468     MOVE 'MISMATCH ACCOUNT ERROR'
  8469                               TO WS-ABEND-MESSAGE.
  8470     MOVE 0302 TO WS-ABEND-CODE.
  8471         DISPLAY '******************************'
  8472         DISPLAY '***** ERROR LOCATION 009 *****'
  8473         DISPLAY '******************************'
  8474     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8475     GO TO ABEND-PGM.
  8476
  8477
  8478 0380-DUPLICATE-CERT-ERROR.
  8479
  8480     IF PB-I-OB  OR  PB-I-SUMMARY
  8481         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8482
  8483     ADD +1 TO DUP-CNT.
  8484
  8485     IF DUP-CNT NOT GREATER THAN DUP-MAX
  8486         MOVE CR-FULL-CONTROL           TO DUPE-ENTRY (DUP-CNT)
  8487         COMPUTE DUPE-LF-PRM (DUP-CNT) = PB-I-LF-PREMIUM-AMT +
  8488                                         PB-I-LF-ALT-PREMIUM-AMT
  8489         MOVE  PB-I-AH-PREMIUM-AMT      TO  DUPE-AH-PRM (DUP-CNT)
  8490         MOVE  PB-I-ENTRY-STATUS        TO  DUPE-STATUS (DUP-CNT)
  8491         GO TO 0300-READ-PENDING-TRANSACTIONS.
  8492
  8493     DISPLAY 'MORE THAN ' DUP-MAX ' DUPLICATE ISSUES PROCESSED'.
  8494     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8495
  8496*    MOVE 0301 TO WS-ABEND-CODE.
  8497*    MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  8498*    GO TO ABEND-PGM.
  8499
  8500
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS010V.cbl
  8501 0390-CERT-MISMATCH-ERROR.
  8502
  8503     IF ISSUE-TRANSACTION  OR
  8504        CANCEL-TRANSACTION  OR
  8505        CLAIM-TRANSACTION
  8506         ADD +1                  TO  MISMATCH-COUNT.
  8507
  8508     IF DTE-CLIENT  =  'CID'  OR  'CSO'
  8509       ADD  +1  TO  ERROR-COUNT
  8510         MOVE    '*** MISMATCH BETWEEN CERT AND TRANS'
  8511           TO  DL-FULL
  8512             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8513         MOVE    ' TRANS CONTROL = '
  8514           TO  DIS-LINE-REASON
  8515         MOVE  PENDING-MATCH-CONTROL
  8516           TO  DIS-LINE-REC
  8517             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8518         MOVE    ' TRANS TYPE    = '
  8519           TO  DIS-LINE-REASON
  8520         MOVE  PENDING-RECORD-TYPE
  8521           TO  DIS-LINE-REC
  8522             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8523         MOVE '  TYPE: 1=ISS   2=CAN   3=CLM   4=RSV   5=CHG'
  8524           TO  DL-FULL
  8525             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8526         MOVE    ' CERT IN CTL   = '
  8527           TO  DIS-LINE-REASON
  8528         MOVE  CIR-CONTROL
  8529           TO  DIS-LINE-REC
  8530             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8531         MOVE    ' BYPASSED TRANS  = '
  8532           TO  DIS-LINE-REASON
  8533         MOVE  PENDING-MATCH-CONTROL
  8534           TO  DIS-LINE-REC
  8535             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8536         MOVE  SPACES
  8537           TO  DISPLAY-LINE
  8538             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8539         DISPLAY 'BYPASSED TRANS = ' PENDING-MATCH-CONTROL.
  8540
  8541     MOVE PENDING-MATCH-CONTROL  TO  DTL-MATCH-CONTROL.
  8542     MOVE PENDING-RECORD-TYPE    TO  DTL-REC-TYPE.
  8543
  8544     IF ISSUE-TRANSACTION
  8545         MOVE 'ISS'              TO  DTL-REC-TYPE-DESC
  8546     ELSE
  8547         IF CANCEL-TRANSACTION
  8548             MOVE 'CAN'          TO  DTL-REC-TYPE-DESC
  8549         ELSE
  8550             IF CLAIM-TRANSACTION
  8551                 MOVE 'CLM'      TO  DTL-REC-TYPE-DESC
  8552             ELSE
  8553                 IF RESERVE-TRANSACTION
  8554                     MOVE 'RES'  TO  DTL-REC-TYPE-DESC
  8555                 ELSE
  8556                     IF UPDATE-TRANSACTION
  8557                         MOVE 'CHG'
  8558                                 TO  DTL-REC-TYPE-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS010V.cbl
  8559
  8560     MOVE CIR-CONTROL            TO  DTL-CERT-IN-CONTROL.
  8561     MOVE CR-FULL-CONTROL        TO  DTL-CERT-OUT-CONTROL.
  8562     MOVE 'DROPPED'              TO  DTL-STATUS.
  8563
  8564     IF ISSUE-TRANSACTION
  8565         MOVE PB-I-LF-PREMIUM-AMT
  8566                                 TO  MD2-LF-PREM
  8567         MOVE PB-I-LF-ALT-PREMIUM-AMT
  8568                                 TO  MD2-LF-ALT-PREM
  8569         MOVE PB-I-AH-PREMIUM-AMT
  8570                                 TO  MD2-AH-PREM
  8571         ADD PB-I-LF-PREMIUM-AMT TO W-MM-LF-PRM
  8572         ADD PB-I-LF-ALT-PREMIUM-AMT TO W-MM-LF-PRM
  8573         ADD PB-I-AH-PREMIUM-AMT TO W-MM-AH-PRM
  8574     ELSE
  8575         IF CANCEL-TRANSACTION
  8576             MOVE PB-C-LF-CANCEL-AMT
  8577                                 TO  MD3-LF-REFUND
  8578             MOVE PB-C-AH-CANCEL-AMT
  8579                                 TO  MD3-AH-REFUND
  8580             ADD PB-C-LF-CANCEL-AMT TO W-MM-LF-RFD
  8581             ADD PB-C-AH-CANCEL-AMT TO W-MM-AH-RFD
  8582         ELSE
  8583             IF CLAIM-TRANSACTION
  8584                 IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
  8585                     MOVE PC-CLAIM-PAYMENT  TO MD4-LF-CLAIM
  8586                     MOVE ZEROS             TO MD4-AH-CLAIM
  8587                     ADD PC-CLAIM-PAYMENT TO W-MM-LF-CLM
  8588                 ELSE
  8589                     MOVE ZEROS             TO MD4-LF-CLAIM
  8590                     MOVE PC-CLAIM-PAYMENT  TO MD4-AH-CLAIM
  8591                     ADD PC-CLAIM-PAYMENT TO W-MM-AH-CLM.
  8592
  8593     IF  MISMATCH-LINE-COUNT GREATER THAN +56
  8594         ADD +1                  TO  MISMATCH-PAGE-NUMBER
  8595         MOVE MISMATCH-PAGE-NUMBER
  8596                                 TO  TR-PG
  8597         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
  8598         MOVE MR-CTL             TO  X
  8599         MOVE X TO LCP-ASA
  8600         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8601             THRU LCP-WRITE-END-MISMATCH-RPT
  8602         MOVE TR-HD-2            TO  MISMATCH-RPT
  8603         MOVE MR-CTL             TO  X
  8604         MOVE X TO LCP-ASA
  8605         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8606             THRU LCP-WRITE-END-MISMATCH-RPT
  8607         MOVE TR-HD-3            TO  MISMATCH-RPT
  8608         MOVE MR-CTL             TO  X
  8609         MOVE X TO LCP-ASA
  8610         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8611             THRU LCP-WRITE-END-MISMATCH-RPT
  8612         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
  8613         MOVE MR-CTL             TO  X
  8614         MOVE X TO LCP-ASA
  8615         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8616             THRU LCP-WRITE-END-MISMATCH-RPT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS010V.cbl
  8617         MOVE +6                 TO  MISMATCH-LINE-COUNT.
  8618
  8619     MOVE MISMATCH-DETAIL        TO  MISMATCH-RPT.
  8620     MOVE MR-CTL                 TO  X.
  8621     ADD +2                      TO  MISMATCH-LINE-COUNT.
  8622
  8623     MOVE X TO LCP-ASA
  8624     PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8625         THRU LCP-WRITE-END-MISMATCH-RPT.
  8626
  8627     IF ISSUE-TRANSACTION
  8628         MOVE MISMATCH-DETAIL-2  TO  MISMATCH-RPT
  8629         MOVE MR-CTL             TO  X
  8630         ADD +1                  TO  MISMATCH-LINE-COUNT
  8631         MOVE X TO LCP-ASA
  8632         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8633             THRU LCP-WRITE-END-MISMATCH-RPT.
  8634
  8635     IF CANCEL-TRANSACTION
  8636         MOVE MISMATCH-DETAIL-3  TO  MISMATCH-RPT
  8637         MOVE MR-CTL             TO  X
  8638         ADD +1                  TO  MISMATCH-LINE-COUNT
  8639         MOVE X TO LCP-ASA
  8640         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8641             THRU LCP-WRITE-END-MISMATCH-RPT.
  8642
  8643     IF CLAIM-TRANSACTION
  8644         MOVE MISMATCH-DETAIL-4  TO  MISMATCH-RPT
  8645         MOVE MR-CTL             TO  X
  8646         ADD +1                  TO  MISMATCH-LINE-COUNT
  8647         MOVE X TO LCP-ASA
  8648         PERFORM LCP-WRITE-POS-MISMATCH-RPT
  8649             THRU LCP-WRITE-END-MISMATCH-RPT.
  8650
  8651     MOVE SPACES                 TO  MISMATCH-RPT.
  8652
  8653     GO TO 0300-READ-PENDING-TRANSACTIONS.
  8654
  8655 0395-GET-CERT-TRLRS.
  8656
  8657     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
  8658     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
  8659     MOVE CR-CARRIER             TO CS-CARRIER
  8660     MOVE CR-GROUPING            TO CS-GROUPING
  8661     MOVE CR-STATE               TO CS-STATE
  8662     MOVE CR-ACCOUNT             TO CS-ACCOUNT
  8663     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
  8664     MOVE CR-CERT-NO             TO CS-CERT-NO
  8665     MOVE 'A'                    TO CS-TRAILER-TYPE
  8666
  8667     READ ELCRTT
  8668
  8669     IF ELCRTT-FILE-STATUS = '00'
  8670        MOVE CS-BANK-COMMISSION-AREA
  8671                                 TO WS-BANK-COMMISSIONS
  8672     ELSE
  8673        IF ELCRTT-FILE-STATUS NOT = '10' AND '23'
  8674           DISPLAY ' BAD READ    ELCRTT ' ELCRTT-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS010V.cbl
  8675           PERFORM ABEND-PGM
  8676        END-IF
  8677     END-IF
  8678
  8679     .
  8680 0395-EXIT.
  8681     EXIT.
  8682
  8683******************************************************************
  8684***       W R I T E   C E R T I F I C A T E   R E C O R D      ***
  8685******************************************************************
  8686
  8687 0400-WRITE-CERT-RECORD.
  8688
  8689     IF CERTIFICATE-RECORD = LOW-VALUES
  8690         GO TO 0499-WRITE-CERT-X.
  8691
  8692     IF CR-ACCT-CONTROL LESS THAN AM-CONTROL-A
  8693         DISPLAY '*** MISMATCH BETWEEN CERT MASTER AND ACCOUNT'
  8694         DISPLAY '    CERT. CONTROL = ' CR-FULL-CONTROL
  8695         ADD  +1  TO  ERROR-COUNT
  8696         MOVE    '*** CERT ACCT LESS THAN TRANS ACCT'
  8697           TO  DL-FULL
  8698             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8699         MOVE    ' CERT. CONTROL = '
  8700           TO  DIS-LINE-REASON
  8701         MOVE  CR-FULL-CONTROL
  8702           TO  DIS-LINE-REC
  8703             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8704         MOVE  SPACES
  8705           TO  DISPLAY-LINE
  8706             PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT
  8707            WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8708            ADD +1 TO CMOT-CNT
  8709            PERFORM 0200-CERT-MASTER-READ-ROUTINE
  8710               GO TO 0400-WRITE-CERT-RECORD.
  8711
  8712*          GO TO 0370-ACCOUNT-MISMATCH-ERROR.
  8713
  8714     IF CR-ACCT-CONTROL GREATER THAN AM-CONTROL-A
  8715         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8716                                              0199-READ-ACCOUNT-X
  8717         GO TO 0400-WRITE-CERT-RECORD.
  8718
  8719     IF CR-DT LESS THAN AM-EFFECT-DT  OR
  8720        CR-DT NOT LESS THAN AM-EXPIRE-DT
  8721         PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
  8722                                              0199-READ-ACCOUNT-X
  8723         GO TO 0400-WRITE-CERT-RECORD.
  8724
  8725     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  8726
  8727     IF CR-LFTYP = ZEROS  AND
  8728        CR-DTHEXP NOT = ZEROS
  8729         ADD +1                     TO W-LFTYP-99
  8730         MOVE '99'                  TO CR-LFTYP  CLAS-LOOK
  8731         PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  8732
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS010V.cbl
  8733     IF CR-AHTYP = ZEROS  AND
  8734        CR-DISEXP NOT = ZEROS
  8735         ADD +1                     TO W-AHTYP-99
  8736         MOVE '99'                  TO CR-AHTYP  CLAS-LOOK
  8737         PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  8738
  8739     PERFORM 4000-EP-BUMP-RTN THRU 4099-EP-BUMP-RTN-X.
  8740
  8741     IF CR-LFTYP = '99'
  8742         MOVE '00'                  TO CR-LFTYP.
  8743     IF CR-AHTYP = '99'
  8744         MOVE '00'                  TO CR-AHTYP.
  8745
  8746     IF CR-ISS-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 153)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8747         MOVE ZEROS                 TO CR-ISS-MICROFILM-NO.
*  12-S*********************************************************       ( 170)**
**    Operand CR-ISS-MICROFILM-NO is not declared
  8748
  8749     IF CR-CAN-MICROFILM-NO NOT NUMERIC
*  12-S**************************                                      ( 170)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8750         MOVE ZEROS                 TO CR-CAN-MICROFILM-NO.
*  12-S*********************************************************       ( 170)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  8751
  8752     IF  CR-POLICY-IS-ACTIVE
  8753         ADD +1                  TO W-POLICY-ACTIVE-CTR
  8754         IF  CR-POLICY-IS-REISSUE
  8755             OR CR-POLICY-IS-MONTHLY
  8756             ADD +1              TO W-POLICY-REISSUE-CTR
  8757         ELSE
  8758             IF  CR-POLICY-IS-REIN-ONLY
  8759                 ADD +1          TO W-POLICY-REIN-CTR
  8760             ELSE
  8761                 NEXT SENTENCE
  8762     ELSE
  8763         ADD +1                  TO W-POLICY-INACTIVE-CTR.
  8764
  8765     IF DTE-PGM-OPT = '1'
  8766       IF REIN-IS-RISK-PREMIUM  AND
  8767          CR-ENTRY-DATE NOT = EOM-RUN-DATE
  8768         IF NOT CR-POLICY-IS-REISSUE  AND
  8769            NOT CR-POLICY-IS-DECLINED  AND
  8770            NOT CR-POLICY-IS-VOID
  8771            AND NOT CR-POLICY-IS-MONTHLY
  8772             MOVE '*'            TO RISK-PREM-FLAG
  8773             PERFORM 3100-REINSURE-ISSUE THRU
  8774                     3199-REINSURE-ISSUE-X.
  8775
* 8776     COPY ELCCRTM2.
  8777******************************************************************04/16/98
  8778*                                                                *ELCCRTM2
  8779*                                                                *ELCCRTM2
  8780*                            ELCCRTM2                            *   LV004
  8781*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8782*                            VMOD=2.001                          *ELCCRTM2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCCRTM2)
  8783*                                                                *ELCCRTM2
  8784*   COPY WORKING STORAGE TO FILE VARIABLES                       *ELCCRTM2
  8785*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM2
  8786*                                                                *ELCCRTM2
  8787******************************************************************ELCCRTM2
  8788     MOVE WS-CR-DT-N                 TO  CR-DT.                      CL**2
  8789     MOVE WS-CR-LF-EXPIRE-DATE-N     TO  CR-LF-EXPIRE-DATE.          CL**2
  8790     MOVE WS-CR-AH-EXPIRE-DATE-N     TO  CR-AH-EXPIRE-DATE.          CL**2
  8791     MOVE WS-CR-ENTRY-DATE-N         TO  CR-ENTRY-DATE.              CL**2
  8792     MOVE WS-CR-LF-CANC-DT-N         TO  CR-LF-CANC-DT.              CL**2
  8793     MOVE WS-CR-LF-CANCEL-EXIT-DATE-N TO                             CL**2
  8794                                     CR-LF-CANCEL-EXIT-DATE.         CL**2
  8795     MOVE WS-CR-LF-CLAIM-EXIT-DATE-N TO  CR-LF-CLAIM-EXIT-DATE.      CL**2
  8796     MOVE WS-CR-AH-CANC-DT-N         TO  CR-AH-CANC-DT.              CL**2
  8797     MOVE WS-CR-AH-CANCEL-EXIT-DATE-N TO CR-AH-CANCEL-EXIT-DATE.     CL**2
  8798     MOVE WS-CR-AH-SETTLEMENT-EXIT-DATEN TO                          CL**2
  8799                                  CR-AH-SETTLEMENT-EXIT-DATE.     ELCCRTM2
  8800     MOVE WS-CR-DTH-DT-N             TO  CR-DTH-DT.                  CL**2
  8801     MOVE WS-CR-DTH-PAY-DT-N         TO  CR-DTH-PAY-DT.              CL**2
  8802     MOVE WS-CR-DIS-DT-N             TO  CR-DIS-DT.                  CL**2
  8803     MOVE WS-CR-DIS-PAY-DT-N         TO  CR-DIS-PAY-DT.              CL**2
  8804     MOVE WS-CR-DIS-PTO-DT-N         TO  CR-DIS-PTO-DT.              CL**2
  8805                                                                     CL**4
  8806     PERFORM  VARYING COPY-NDX FROM 1 BY 1                           CL**4
  8807                UNTIL COPY-NDX > 5                                   CL**4
  8808           MOVE WS-CR-DIS-INCUR-DT-N (COPY-NDX)   TO                 CL**2
  8809                                  CR-DIS-INCUR-DT (COPY-NDX)      ELCCRTM2
  8810     END-PERFORM.                                                 ELCCRTM2
  8811                                                                  ELCCRTM2
  8812
  8813     IF DTE-PGM-OPT = '1'
  8814         WRITE CERT-OUT-RECORD FROM CERTIFICATE-RECORD
  8815         ADD +1 TO CMOT-CNT.
  8816
  8817     MOVE SPACE                  TO REIN-FLG
  8818                                    RISK-REIN-FLAG
  8819                                    RISK-PREM-FLAG
  8820                                    RC-COMM-FLG.
  8821
  8822 0499-WRITE-CERT-X.
  8823     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS010V.cbl
  8825******************************************************************
  8826***     A P P L Y   P E N D I N G   T R A N S A C T I O N S    ***
  8827******************************************************************
  8828
  8829 0500-APPLY-PENDING-BUSINESS.
  8830
  8831     IF CANCEL-TRANSACTION
  8832         GO TO 0600-PROCESS-CANCELLATIONS.
  8833
  8834     IF CLAIM-TRANSACTION
  8835         GO TO 0700-PROCESS-CLAIMS.
  8836
  8837     IF RESERVE-TRANSACTION
  8838         GO TO 0800-PROCESS-RESERVES.
  8839
  8840     IF UPDATE-TRANSACTION
  8841         GO TO 0900-PROCESS-CERT-CHANGES.
  8842
  8843******************************************************************
  8844***     P R O C E S S   I S S U E   T R A N S A C T I O N S    ***
  8845******************************************************************
  8846
  8847 0505-PROCESS-ISSUES.
  8848
  8849     MOVE INITIALIZED-CERTIFICATE TO CERTIFICATE-RECORD.
  8850     PERFORM CERT-DATE-LOAD.
  8851
  8852     ADD +1                      TO  W-POL-ISSUES.
  8853
  8854     MOVE PB-COMPANY-CD          TO  CR-COMPANY-CD.
  8855     MOVE PB-CARRIER             TO  CR-CARRIER.
  8856     MOVE PB-GROUPING            TO  CR-GROUPING.
  8857     MOVE PB-STATE               TO  CR-STATE.
  8858     MOVE PB-ACCOUNT             TO  CR-ACCOUNT.
  8859     MOVE PB-CERT-EFF-DT         TO  DC-BIN-DATE-1
  8860                                     WS-CR-BIN-DATE
  8861     MOVE ' '                    TO  DC-OPTION-CODE.
  8862     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8863     MOVE DC-GREG-DATE-CYMD      TO  CR-DT
  8864                                     WS-CR-DT-N.
  8865     MOVE PB-CERT-NO             TO  CR-CERT-NO.
  8866
  8867     MOVE PB-I-NAME              TO  CR-NAME.
  8868     MOVE PB-I-AGE               TO  CR-AGE.
  8869     MOVE PB-I-INSURED-SEX       TO  CR-SEX.
  8870     MOVE PB-I-SOC-SEC-NO        TO  CR-SOC-SEC.
  8871
  8872     IF PB-I-JOINT-COVERAGE
  8873         MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME
  8874         MOVE PB-I-JOINT-AGE     TO  CR-JOINT-AGE
  8875     ELSE
  8876        IF (DTE-CLIENT EQUAL 'BOA')  AND
  8877           (PB-I-JOINT-INSURED NOT EQUAL SPACES)
  8878             MOVE PB-I-JOINT-INSURED TO  CR-JOINT-NAME.
  8879
  8880     IF PB-I-SUMMARY  OR
  8881        DTE-CLIENT = 'DMD'
  8882         MOVE PB-I-LIVES         TO  CR-LIVES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS010V.cbl
  8883
  8884     IF PB-I-NUM-BILLED NOT NUMERIC
  8885        MOVE ZEROS               TO PB-I-NUM-BILLED.
  8886
  8887     IF PB-I-STATE-TAX NOT NUMERIC
  8888        MOVE ZEROS               TO PB-I-STATE-TAX.
  8889
  8890     IF PB-I-MUNI-TAX NOT NUMERIC
  8891        MOVE ZEROS               TO PB-I-MUNI-TAX.
  8892     IF PB-I-TOT-FEES NOT NUMERIC
  8893        MOVE ZEROS               TO PB-I-TOT-FEES
  8894     END-IF
  8895     IF PB-I-ADDL-CLP NOT NUMERIC
  8896        MOVE ZEROS               TO PB-I-ADDL-CLP
  8897     END-IF
  8898
  8899     MOVE PB-I-TOT-FEES          TO  CR-MOB-NET-TOT-FEES
  8900     MOVE PB-I-ADDL-CLP          TO  CR-ADDL-CLP
  8901     MOVE PB-I-CLP-STATE         TO  CR-CLP-STATE
  8902     MOVE PB-I-NUM-BILLED        TO  CR-BILLED.
  8903     MOVE PB-I-STATE-TAX         TO  CR-STATE-TAX.
  8904     MOVE PB-I-RESIDENT-STATE    TO  CR-RESIDENT-STATE.
  8905     MOVE PB-I-RATE-CODE         TO  CR-RATE-CODE.
  8906     MOVE PB-I-MUNI-TAX          TO  CR-MUNI-TAX.
  8907     MOVE PB-I-LOAN-APR          TO  CR-APR.
  8908     MOVE PB-I-PAY-FREQUENCY     TO  CR-PMT-FREQ.
  8909     MOVE PB-I-LOAN-TERM         TO  CR-LOAN-TERM.
  8910
  8911     IF PB-I-RATE-CLASS-OVRD = SPACES
  8912         MOVE PB-I-RATE-CLASS    TO  CR-RATING-CLASS
  8913     ELSE
  8914         MOVE PB-I-RATE-CLASS-OVRD TO CR-RATING-CLASS.
  8915
  8916     MOVE PB-I-POLICY-FORM-NO    TO  CR-POLICY-FORM-NO.
  8917     MOVE PB-I-BUSINESS-TYPE     TO  CR-GRPTYP.
  8918
  8919     IF PB-I-INDV-GRP-OVRD = SPACES
  8920         MOVE PB-I-INDV-GRP-CD   TO  CR-IND-GRP
  8921     ELSE
  8922         MOVE PB-I-INDV-GRP-OVRD TO  CR-IND-GRP.
  8923
  8924     IF CR-IND-GRP = 'I'  OR  '1'
  8925         MOVE '1'                TO  CR-IND-GRP
  8926     ELSE
  8927         MOVE '2'                TO  CR-IND-GRP.
  8928
  8929     IF PB-I-SKIP-CODE = '1'
  8930         MOVE 01                 TO  CR-SKIP.
  8931     IF PB-I-SKIP-CODE = '2'
  8932         MOVE 02                 TO  CR-SKIP.
  8933     IF PB-I-SKIP-CODE = '3'
  8934         MOVE 03                 TO  CR-SKIP.
  8935     IF PB-I-SKIP-CODE = '4'
  8936         MOVE 04                 TO  CR-SKIP.
  8937     IF PB-I-SKIP-CODE = '5'
  8938         MOVE 05                 TO  CR-SKIP.
  8939     IF PB-I-SKIP-CODE = '6'
  8940         MOVE 06                 TO  CR-SKIP.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS010V.cbl
  8941     IF PB-I-SKIP-CODE = '7'
  8942         MOVE 07                 TO  CR-SKIP.
  8943     IF PB-I-SKIP-CODE = '8'
  8944         MOVE 08                 TO  CR-SKIP.
  8945     IF PB-I-SKIP-CODE = '9'
  8946         MOVE 09                 TO  CR-SKIP.
  8947     IF PB-I-SKIP-CODE = 'A'
  8948         MOVE 10                 TO  CR-SKIP.
  8949     IF PB-I-SKIP-CODE = 'X'
  8950         MOVE 11                 TO  CR-SKIP.
  8951
  8952     MOVE PB-I-MORT-CODE         TO  CR-MORT.
  8953     MOVE PB-I-MEMBER-NO         TO  CR-MEMBER-NO.
  8954     MOVE PB-I-LOAN-OFFICER      TO  CR-LOAN-OFFICER.
  8955
  8956     IF PB-I-SPECIAL-REIN-CODE NOT = SPACE
  8957         MOVE PB-I-SPECIAL-REIN-CODE TO CR-REIN-SPEC
  8958                                        REIN-SPEC-A
  8959                                        REIN-SPEC-B
  8960                                        REIN-SPEC-C
  8961         MOVE REIN-SPEC          TO CR-REIN-TABLE
  8962     ELSE
  8963         MOVE AM-REI-TABLE       TO CR-REIN-TABLE.
  8964
  8965     MOVE PB-I-1ST-PMT-DT        TO  DC-BIN-DATE-1.
  8966     MOVE ' '                    TO  DC-OPTION-CODE.
  8967     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  8968     MOVE DC-GREG-DATE-1-YMD     TO  CR-LOAN-1ST-PMT-DT.
  8969
  8970     MOVE PB-I-EXTENTION-DAYS    TO  CR-PMT-EXTENSION-DAYS.
  8971
  8972     IF PB-I-LAST-ADD-ON-DT  =  ZEROS  OR  SPACES
  8973         MOVE LOW-VALUES          TO CR-LAST-ADD-ON-DT
  8974     ELSE
  8975         MOVE PB-I-LAST-ADD-ON-DT TO CR-LAST-ADD-ON-DT.
  8976
  8977     IF PB-I-UNDERWRITING-STATUS = 'A'  OR  'D'
  8978         MOVE 'Y'                TO  CR-UNDERWRITING-CODE.
  8979
  8980     IF PB-BATCH-ENTRY = SPACE  OR
  8981        (PB-I-ENTRY-STATUS = '2'  OR  'U')
  8982         MOVE '1'                TO  CR-ENTRY-STATUS
  8983     ELSE
  8984         MOVE PB-I-ENTRY-STATUS  TO  CR-ENTRY-STATUS.
  8985
  8986     IF PB-POLICY-IS-DECLINED
  8987         MOVE 'D'                TO  CR-ENTRY-STATUS.
  8988
  8989     IF PB-POLICY-IS-VOIDED
  8990         MOVE 'V'                TO  CR-ENTRY-STATUS.
  8991
  8992***  IF DTE-CLIENT NOT = 'CRI'
  8993***      IF PB-I-PREM-ACCTNG-ONLY
  8994***          MOVE '1'            TO  CR-ENTRY-STATUS.
  8995
  8996     MOVE EOM-RUN-DATE           TO  CR-ENTRY-DATE
  8997                                     WS-CR-ENTRY-DATE-N.
  8998
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS010V.cbl
  8999     IF PB-I-MICROFILM-NO NUMERIC
*  12-S************************                                        ( 170)**
**    Operand PB-I-MICROFILM-NO is not declared
  9000         MOVE PB-I-MICROFILM-NO  TO CR-ISS-MICROFILM-NO.
*  12-S******************************                                  ( 175)**
**    Operand PB-I-MICROFILM-NO is not declared
  9001
  9002     IF DTE-CLIENT = 'TIH' OR 'FLA' OR 'TII' OR
  9003        'TMS' OR 'NCL' OR 'HER' OR 'CID' OR 'DCC'
  9004         MOVE PB-I-SIG-SW        TO CR-USER-CODE
  9005     END-IF
  9006
  9007*************************************************
  9008***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9009***  WAS CONVERTED TO 1056 BYTES.             ***
  9010*************************************************
  9011     MOVE PB-ENTRY-BATCH         TO  CR-ENTRY-BATCH.
  9012     MOVE PB-I-BENEFICIARY-NAME  TO  CR-BENEFICIARY.
  9013
  9014     MOVE PB-LAST-MAINT-BY       TO  CR-CSR-CODE.
  9015
  9016     MOVE CR-STATE               TO STATE-L.
  9017
  9018     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
  9019
  9020     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9021
  9022***************************************************
  9023***  WHEN AN ISSUE WAS PROCESSED THAT HAD       ***
  9024***  INVALID BENEFIT CODES LOCATED IN BOTH      ***
  9025***  BENEFITS,  THE 'ACTION' ON THE DETAIL LIST ***
  9026***  LINE WAS BYPASSED - ONLY THE CERTIFICATE,  ***
  9027***  THE EFFECTIVE DATE AND THE AGE PRINTED.    ***
  9028***************************************************
  9029     IF (PB-INVALID-LIFE AND PB-INVALID-AH)
  9030         IF CR-LF-POLICY-IS-RESTORE
  9031             MOVE 'RESTORED  '          TO TRD-LF-ACTION
  9032             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9033         ELSE
  9034         IF CR-LF-POLICY-IS-REISSUE
  9035             MOVE 'RE-ISSUED '          TO TRD-LF-ACTION
  9036             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9037         ELSE
  9038         IF CR-LF-IS-REIN-ONLY
  9039             MOVE 'REIN. ONLY'          TO TRD-LF-ACTION
  9040             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9041         ELSE
  9042         IF CR-LF-IS-DECLINED
  9043             MOVE 'DECLINED  '          TO TRD-LF-ACTION
  9044             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9045         ELSE
  9046         IF CR-LF-IS-VOID
  9047             MOVE 'VOIDED    '          TO TRD-LF-ACTION
  9048             GO TO 0530-PROCESS-ISSUE-CONTINUED
  9049         ELSE
  9050         IF CR-LF-POLICY-IS-MONTHLY
  9051            MOVE 'MONTHLY'       TO TRD-LF-ACTION
  9052            GO TO 0530-PROCESS-ISSUE-CONTINUED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS010V.cbl
  9053
  9054
  9055 0510-PROCESS-LIFE-ISSUE.
  9056
  9057     IF PB-INVALID-LIFE
  9058         GO TO 0520-PROCESS-A-H-ISSUE.
  9059
  9060     MOVE PB-I-LF-BENEFIT-CD     TO  CLAS-LOOK.
  9061     PERFORM 8300-LIFE-TYPE-LOOKUP THRU 8399-LIFE-LOOKUP-X.
  9062     MOVE CLAS-LOOK              TO  PB-I-LF-BENEFIT-CD.
  9063
  9064     MOVE PB-I-LF-BENEFIT-CD     TO  CR-LFTYP.
  9065     MOVE PB-I-LF-TERM           TO  CR-LF-TERM.
  9066     MOVE PB-I-LF-CRIT-PER       TO  CR-LF-CRIT-PERIOD.
  9067     MOVE PB-I-TERM-IN-DAYS      TO  CR-LF-TERM-IN-DAYS.
  9068     MOVE PB-I-RATE-DEVIATION-LF TO  CR-LF-DEV-CODE.
  9069     MOVE PB-I-RATE-DEV-PCT-LF   TO  CR-LF-DEV-PCT.
  9070
  9071     MOVE PB-I-LF-BENEFIT-AMT    TO  CR-LFAMT.
  9072     MOVE PB-I-LF-PREMIUM-AMT    TO  CR-LFPRM.
  9073     IF PB-I-LF-POLICY-FEE  NUMERIC
  9074         MOVE PB-I-LF-POLICY-FEE TO  CR-LF-POLICY-FEE.
  9075     MOVE PB-I-LF-PREM-CALC      TO  CR-LFPRM-CALC.
  9076     MOVE PB-I-LF-RATE           TO  CR-LFPRM-RATE.
  9077
  9078     IF PB-I-LF-PREM-TAX NUMERIC
  9079        MOVE PB-I-LF-PREM-TAX    TO CR-LF-ISS-PREM-TAX
  9080     END-IF
  9081
  9082
  9083     IF PB-I-LF-REI-RATE NOT = ZEROS
  9084        IF DTE-CLIENT = 'DCC'
  9085           CONTINUE
  9086*          PERFORM 0795-DCC-NSP-LF  THRU 0795-EXIT
  9087        ELSE
  9088           MOVE PB-I-LF-REI-RATE TO CR-LF-NSP-PRM-RATE
  9089           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9090                          (CR-LFAMT / 100) * PB-I-LF-REI-RATE
  9091        END-IF
  9092     END-IF
  9093
  9094     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  9095         MOVE PB-I-LF-ALT-BENEFIT-AMT TO CR-LFAMT-ALT
  9096         MOVE PB-I-LF-ALT-PREMIUM-AMT TO CR-LFPRM-ALT
  9097         MOVE PB-I-LF-ALT-PREM-CALC   TO CR-LFPRM-CALC-ALT
  9098         MOVE PB-I-LF-ALT-RATE        TO CR-LFPRM-RATE-ALT
  9099         IF PB-I-LF-ALT-REI-RATE NOT = ZEROS
  9100             COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
  9101                 ((CR-LFAMT-ALT / 100) * PB-I-LF-ALT-REI-RATE).
  9102
  9103     MOVE PB-I-LF-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9104     MOVE ' '                    TO  DC-OPTION-CODE.
  9105     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9106     MOVE DC-GREG-DATE-CYMD      TO  CR-LF-EXPIRE-DATE
  9107                                     WS-CR-LF-EXPIRE-DATE-N.
  9108
  9109     IF CR-ENTRY-STATUS = 'P'
  9110         MOVE '1'                TO  CR-LF-CURRENT-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS010V.cbl
  9111     ELSE
  9112         MOVE CR-ENTRY-STATUS    TO  CR-LF-CURRENT-STATUS.
  9113
  9114     MOVE CLAS-I-AB3 (CLAS-INDEXL)  TO TRD-LFTYP.
  9115     MOVE CR-LF-TERM                TO TRD-LFTRM.
  9116     COMPUTE TRD-LFPRM-RFND = CR-LFPRM + CR-LFPRM-ALT.
  9117     MOVE 'ISSUE     '              TO TRD-LF-ACTION.
  9118     MOVE CR-LF-CURRENT-STATUS      TO TRD-LF-STATUS.
  9119
  9120     IF CR-LF-POLICY-IS-RESTORE
  9121         MOVE 'RESTORED  '          TO TRD-LF-ACTION.
  9122     IF CR-LF-POLICY-IS-REISSUE
  9123         MOVE 'RE-ISSUED '          TO TRD-LF-ACTION.
  9124     IF CR-LF-IS-REIN-ONLY
  9125         MOVE 'REIN. ONLY'          TO TRD-LF-ACTION.
  9126
  9127     IF CR-LF-IS-DECLINED
  9128         MOVE 'DECLINED  '          TO TRD-LF-ACTION.
  9129
  9130     IF CR-LF-IS-VOID
  9131         MOVE 'VOIDED    '          TO TRD-LF-ACTION.
  9132     IF CR-LF-POLICY-IS-MONTHLY
  9133         MOVE 'MONTHLY   '          TO TRD-LF-ACTION.
  9134
  9135     ADD +1                      TO  W-LF-ISSUES.
  9136
  9137 0520-PROCESS-A-H-ISSUE.
  9138
  9139     IF PB-INVALID-AH
  9140         GO TO 0530-PROCESS-ISSUE-CONTINUED.
  9141
  9142     MOVE PB-I-AH-BENEFIT-CD     TO CLAS-LOOK.
  9143     PERFORM 8400-A-H-TYPE-LOOKUP THRU 8499-A-H-LOOKUP-X.
  9144     MOVE CLAS-LOOK              TO  PB-I-AH-BENEFIT-CD.
  9145
  9146     MOVE PB-I-AH-BENEFIT-CD     TO  CR-AHTYP.
  9147     MOVE PB-I-AH-TERM           TO  CR-AH-TERM.
  9148     MOVE PB-I-AH-CRIT-PER       TO  CR-AH-CRIT-PERIOD.
  9149     MOVE PB-I-RATE-DEVIATION-AH TO  CR-AH-DEV-CODE.
  9150     MOVE PB-I-RATE-DEV-PCT-AH   TO  CR-AH-DEV-PCT.
  9151
  9152     MOVE PB-I-AH-BENEFIT-AMT    TO  CR-AHAMT.
  9153     MOVE PB-I-AH-PREMIUM-AMT    TO  CR-AHPRM.
  9154     IF PB-I-AH-POLICY-FEE  NUMERIC
  9155         MOVE PB-I-AH-POLICY-FEE TO  CR-AH-POLICY-FEE.
  9156     MOVE PB-I-AH-PREM-CALC      TO  CR-AHPRM-CALC.
  9157     MOVE PB-I-AH-RATE           TO  CR-AHPRM-RATE.
  9158
  9159     IF PB-I-AH-PREM-TAX NUMERIC
  9160        MOVE PB-I-AH-PREM-TAX    TO CR-AH-ISS-PREM-TAX
  9161     END-IF
  9162
  9163     IF PB-I-AH-REI-RATE NOT = ZEROS
  9164        IF DTE-CLIENT = 'DCC'
  9165           CONTINUE
  9166        ELSE
  9167           MOVE PB-I-AH-REI-RATE   TO  CR-AH-NSP-PRM-RATE
  9168           COMPUTE CR-AH-NSP-PRM ROUNDED =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS010V.cbl
  9169             ((CR-AHAMT * CR-AH-TERM) / 100) * PB-I-AH-REI-RATE
  9170        END-IF
  9171     END-IF
  9172
  9173     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9174        MOVE PB-I-AMOUNT-FINANCED TO CR-LFAMT
  9175        MOVE PB-I-UNPAID-CASH-PRICE TO CR-LFAMT-ALT
  9176        MOVE PB-I-CLP-AMOUNT     TO CR-LFPRM-ALT
  9177     END-IF
  9178     MOVE PB-I-AH-EXPIRE-DT      TO  DC-BIN-DATE-1.
  9179     MOVE ' '                    TO  DC-OPTION-CODE.
  9180     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9181     MOVE DC-GREG-DATE-CYMD      TO  CR-AH-EXPIRE-DATE
  9182                                     WS-CR-AH-EXPIRE-DATE-N.
  9183
  9184     IF CR-ENTRY-STATUS = 'P'
  9185         MOVE '1'                TO  CR-AH-CURRENT-STATUS
  9186     ELSE
  9187         MOVE CR-ENTRY-STATUS    TO  CR-AH-CURRENT-STATUS.
  9188
  9189     MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP.
  9190     MOVE CR-AH-TERM                TO TRD-AHTRM.
  9191     MOVE CR-AHPRM                  TO TRD-AHPRM-RFND.
  9192     MOVE 'ISSUE     '              TO TRD-AH-ACTION.
  9193     MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9194
  9195     IF CR-AH-POLICY-IS-RESTORE
  9196         MOVE 'RESTORED  '          TO TRD-AH-ACTION.
  9197     IF CR-AH-POLICY-IS-REISSUE
  9198         MOVE 'RE-ISSUED '          TO TRD-AH-ACTION.
  9199     IF CR-AH-IS-REIN-ONLY
  9200         MOVE 'REIN. ONLY'          TO TRD-AH-ACTION.
  9201
  9202     IF CR-AH-IS-DECLINED
  9203         MOVE 'DECLINED  '          TO TRD-AH-ACTION.
  9204
  9205     IF CR-AH-IS-VOID
  9206         MOVE 'VOIDED    '          TO TRD-AH-ACTION.
  9207     IF CR-AH-POLICY-IS-MONTHLY
  9208         MOVE 'MONTHLY   '          TO TRD-AH-ACTION.
  9209
  9210     ADD +1                      TO  W-AH-ISSUES.
  9211
  9212 0530-PROCESS-ISSUE-CONTINUED.
  9213
  9214     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
  9215     MOVE WK-NEW-RATES           TO CR-COMPENSATION-LEVELS.
  9216     MOVE  SPACES                TO WS-LEVELS-CHARGEBACK-SWITCHES.
  9217     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9218
  9219     IF (DTE-CLIENT = 'DCC')
  9220        AND (CR-AHTYP NOT = '00' AND '  ')
  9221        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9222           PERFORM 0920-GET-BANK-FEES
  9223                                 THRU 0920-EXIT
  9224           PERFORM 0930-BUILD-CERT-TRLR
  9225                                 THRU 0930-EXIT
  9226           PERFORM 0395-GET-CERT-TRLRS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS010V.cbl
  9227                                 THRU 0395-EXIT
  9228        END-IF
  9229     END-IF
  9230
  9231     IF DTE-CLIENT = 'DCC'
  9232        IF CR-LF-DEV-PCT NOT = +0 AND +1
  9233           COMPUTE CR-LF-NSP-PRM ROUNDED =
  9234              (CR-LFPRM + CR-LFPRM-ALT) -
  9235              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
  9236*             ((CR-LFPRM + CR-LFPRM-ALT) * WK-L-RT1 (1))
  9237        END-IF
  9238     END-IF
  9239
  9240     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9241        MOVE CR-LFPRM-ALT        TO CR-AH-NSP-PRM
  9242     ELSE
  9243        IF DTE-CLIENT = 'DCC'
  9244           IF CR-AH-DEV-PCT NOT = +0 AND +1
  9245              COMPUTE CR-AH-NSP-PRM ROUNDED =
  9246              CR-AHPRM -
  9247              (CR-AHPRM * CR-LCOM-AH (1))
  9248*             (CR-AHPRM * WK-A-RT1 (1))
  9249           END-IF
  9250        END-IF
  9251     END-IF
  9252
  9253     IF CR-ENTRY-STATUS = 'P'
  9254         MOVE '1'                   TO CR-ENTRY-STATUS.
  9255
  9256     IF CR-POLICY-IS-REISSUE  OR
  9257        CR-POLICY-IS-REIN-ONLY OR
  9258        CR-POLICY-IS-DECLINED OR
  9259        CR-POLICY-IS-VOID
  9260        OR CR-POLICY-IS-MONTHLY
  9261         GO TO 0590-END-ISSUE-PROCESSING.
  9262
  9263     ADD CR-LFPRM TO TPL-ISS-PRM (1).
  9264     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9265        ADD CR-LFPRM-ALT TO TPL-ISS-PRM (1)
  9266     END-IF
  9267     ADD CR-AHPRM TO TPA-ISS-PRM (1).
  9268
  9269     IF NOT PB-INVALID-LIFE
  9270         COMPUTE H-LFCM ROUNDED =
  9271                    (CR-LFPRM + CR-LFPRM-ALT) * ACCT-COMM-LF
  9272         MOVE H-LFCM                   TO TRD-LFCOM-CLM
  9273         ADD H-LFCM                    TO TPL-ACCT-COM (1).
  9274
  9275     IF NOT PB-INVALID-AH
  9276        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9277           COMPUTE H-AHCM ROUNDED = CR-AHPRM - (CR-LFPRM-ALT
  9278           + CR-ADDL-CLP)
  9279        ELSE
  9280           COMPUTE H-AHCM ROUNDED = CR-AHPRM * ACCT-COMM-AH
  9281        END-IF
  9282        MOVE H-AHCM                   TO TRD-AHCOM-CLM
  9283        ADD H-AHCM                    TO TPA-ACCT-COM (1)
  9284     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 180
* ECS010V.cbl
  9285
  9286     ADD +1 TO BC-G-ISS.
  9287     ADD +1 TO BC-COMM.
  9288     ADD CR-LFPRM TO BC-NET-WRIT.
  9289     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9290        ADD CR-LFPRM-ALT TO BC-NET-WRIT
  9291     END-IF
  9292     ADD CR-AHPRM TO BC-NET-WRIT.
  9293
  9294     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9295        ADD CR-LFPRM             TO BC-NET-WRIT-OB
  9296        ADD CR-LFPRM-ALT         TO BC-NET-WRIT-OB
  9297     ELSE
  9298        ADD CR-LFPRM             TO BC-NET-WRIT-SP
  9299        IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) NOT = 'G' AND 'L'
  9300           ADD CR-LFPRM-ALT      TO BC-NET-WRIT-SP
  9301        END-IF
  9302     END-IF
  9303
  9304     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9305         ADD CR-AHPRM            TO BC-NET-WRIT-OB
  9306     ELSE
  9307         ADD CR-AHPRM            TO BC-NET-WRIT-SP.
  9308
  9309 0590-END-ISSUE-PROCESSING.
  9310
  9311     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9312
  9313     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9314
  9315     IF NOT CR-POLICY-IS-REIN-ONLY  AND
  9316        NOT CR-POLICY-IS-DECLINED  AND
  9317        NOT CR-POLICY-IS-VOID
  9318         MOVE 'Y' TO BILLED-SWITCH
  9319         PERFORM 2100-BUILD-ISSUE-EXTRACT THRU 2199-BLD-ISSUE-X.
  9320
  9321     IF NOT CR-POLICY-IS-REISSUE  AND
  9322        NOT CR-POLICY-IS-DECLINED  AND
  9323        NOT CR-POLICY-IS-VOID
  9324        AND NOT CR-POLICY-IS-MONTHLY
  9325         PERFORM 3100-REINSURE-ISSUE THRU 3199-REINSURE-ISSUE-X.
  9326
  9327     MOVE '*'                   TO TRANSACTION-FLAG.
  9328     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 181
* ECS010V.cbl
  9330******************************************************************
  9331***    P R O C E S S   C A N C E L   T R A N S A C T I O N S   ***
  9332******************************************************************
  9333
  9334 0600-PROCESS-CANCELLATIONS.
  9335
  9336     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9337
  9338     IF AM-RECALC-COMM = ('Y' OR '1')
  9339        PERFORM 1600-RECALC-COMM-EXTR
  9340                                 THRU 1899-RECALC-COMM-EXTR-X
  9341        MOVE ' '                 TO RECALC-TYPE
  9342     END-IF
  9343
  9344     MOVE CR-LFRFND               TO LIFE-REFUND.
  9345     MOVE CR-LFRFND-CALC          TO LIFE-REFUND-CALC.
  9346     MOVE CR-AHRFND               TO A-H-REFUND.
  9347     MOVE CR-AHRFND-CALC          TO A-H-REFUND-CALC.
  9348     MOVE CR-SUM-CAN-CNT-YTD      TO YTD-CANCEL-CNT.
  9349
  9350     MOVE PB-C-LF-CANCEL-AMT      TO CR-LFRFND.
  9351     IF CR-LFRFND-CALC = ZEROS
  9352         MOVE PB-C-LF-REF-CALC    TO CR-LFRFND-CALC
  9353                                     LIFE-REFUND-CALC
  9354     ELSE
  9355         MOVE PB-C-LF-CANCEL-AMT  TO CR-LFRFND-CALC.
  9356
  9357     MOVE PB-C-AH-CANCEL-AMT      TO CR-AHRFND.
  9358     IF CR-AHRFND-CALC = ZEROS
  9359         MOVE PB-C-AH-REF-CALC    TO CR-AHRFND-CALC
  9360                                     A-H-REFUND-CALC
  9361     ELSE
  9362         MOVE PB-C-AH-CANCEL-AMT  TO CR-AHRFND-CALC.
  9363
  9364*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9365*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9366*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9367*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9368
  9369     IF PB-C-MICROFILM-NO NUMERIC  AND
*  12-S************************                                        ( 175)**
**    Operand PB-C-MICROFILM-NO is not declared
  9370        PB-C-MICROFILM-NO NOT = ZEROS
  9371         MOVE PB-C-MICROFILM-NO  TO CR-CAN-MICROFILM-NO.
*  12-S******************************                                  ( 181)**
**    Operand PB-C-MICROFILM-NO is not declared
  9372
  9373     IF PB-CI-STATE-TAX NOT NUMERIC
  9374        MOVE ZEROS               TO PB-CI-STATE-TAX.
  9375
  9376     IF PB-CI-MUNI-TAX NOT NUMERIC
  9377        MOVE ZEROS               TO PB-CI-MUNI-TAX.
  9378
  9379     IF CR-CANCEL-STATE-TAX NUMERIC
  9380         ADD PB-CI-STATE-TAX  TO CR-CANCEL-STATE-TAX
  9381       ELSE
  9382         MOVE PB-CI-STATE-TAX TO CR-CANCEL-STATE-TAX.
  9383
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 182
* ECS010V.cbl
  9384     IF CR-CANCEL-MUNI-TAX NUMERIC
  9385         ADD PB-CI-MUNI-TAX   TO CR-CANCEL-MUNI-TAX
  9386       ELSE
  9387         MOVE PB-CI-MUNI-TAX  TO CR-CANCEL-MUNI-TAX.
  9388
  9389     MOVE ZEROS                  TO MONTHS-DIFF-LF
  9390                                    MONTHS-DIFF-AH.
  9391
  9392     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9393
  9394 0630-PROCESS-LIFE-CANCEL.
  9395
  9396     IF CR-LFTYP = ZERO  OR
  9397        PB-C-LF-CANCEL-DT = LOW-VALUES  OR  SPACES
  9398         MOVE ZEROS               TO H-LFCM
  9399         GO TO 0650-PROCESS-A-H-CANCEL.
  9400
  9401     IF PB-C-LF-PREM-TAX NUMERIC
  9402        MOVE PB-C-LF-PREM-TAX    TO CR-LF-CNC-PREM-TAX
  9403     END-IF
  9404     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-1.
  9405     MOVE ' '                     TO  DC-OPTION-CODE.
  9406     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9407     MOVE DC-GREG-DATE-CYMD       TO  CR-LF-CANC-DT
  9408                                      WS-CR-LF-CANC-DT-N.
  9409
  9410     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9411     MOVE PB-C-LF-CANCEL-DT       TO  DC-BIN-DATE-2.
  9412     MOVE '1'                     TO  DC-OPTION-CODE.
  9413     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9414     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9415                                      DC-ODD-DAYS-OVER
  9416                                      DC-ELAPSED-DAYS.
  9417     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9418     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
  9419
  9420     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
  9421         ADD  +1                  TO  MONTHS-DIFF-LF.
  9422
  9423     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
  9424
  9425     MOVE  ZEROS                  TO  SUB.
  9426
  9427 0635-LIFE-CHARGEBACK-LOOP.
  9428
  9429     ADD    +1                    TO  SUB.
  9430
  9431     IF  SUB  GREATER THAN  +10
  9432         GO TO  0640-CONTINUE-LIFE-CANCEL.
  9433
  9434     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9435         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9436         GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9437
  9438     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9439         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
  9440
  9441     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 183
* ECS010V.cbl
  9442         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
  9443
  9444     GO TO  0635-LIFE-CHARGEBACK-LOOP.
  9445
  9446
  9447 0640-CONTINUE-LIFE-CANCEL.
  9448
  9449     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9450        SUBTRACT +1 FROM MONTHS-DIFF-LF.
  9451
  9452     PERFORM 1500-GET-ACCT-LEVEL-LF-COMM THRU 1519-ACCT-LF-COMM-X.
  9453
  9454     IF DTE-CLIENT = 'GIC'
  9455         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  9456             MOVE CR-LFPRM-CALC   TO CR-LFRFND-CALC
  9457                                     LIFE-REFUND-CALC.
  9458
  9459*    IF DTE-CLIENT = 'TMS'
  9460     MOVE PB-LF-REFUND-TYPE      TO CR-LF-REFUND-TYPE
  9461
  9462     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  9463         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9464     ELSE
  9465         IF CR-LF-CANCEL-EXIT-DATE = ZEROS
  9466             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-CANCEL
  9467             MOVE '8'                  TO CR-LF-CURRENT-STATUS
  9468             MOVE PB-C-LF-COMM-CHARGEBACK TO CR-LF-COMM-CHARGEBACK
  9469             MOVE EOM-RUN-DATE      TO CR-LF-CANCEL-EXIT-DATE
  9470                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9471         ELSE
  9472             IF CR-LF-CURRENT-STATUS = '6'
  9473                 MOVE '8'              TO CR-LF-CURRENT-STATUS
  9474                 MOVE PB-C-LF-COMM-CHARGEBACK
  9475                                       TO CR-LF-COMM-CHARGEBACK
  9476                 MOVE EOM-RUN-DATE TO CR-LF-CANCEL-EXIT-DATE
  9477                                      WS-CR-LF-CANCEL-EXIT-DATE-N.
  9478
  9479*************************************************
  9480***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
  9481***  WAS CONVERTED TO 1056 BYTES.             ***
  9482*************************************************
  9483     MOVE PB-ENTRY-BATCH               TO CR-LF-EXIT-BATCH.
  9484
  9485     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9486     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9487     MOVE CR-LFRFND                    TO TRD-LFPRM-RFND.
  9488
  9489     COMPUTE H-LFCM ROUNDED =
  9490                              (CR-LFRFND * ACCT-COMM-LF) * (-1).
  9491     MOVE H-LFCM                       TO TRD-LFCOM-CLM.
  9492
  9493     MOVE CR-LF-CNC-MO                 TO TRD-LFACTMO.
  9494     MOVE CR-LF-CNC-DA                 TO TRD-LFACTDA.
  9495     MOVE CR-LF-CNC-YR                 TO TRD-LFACTYR.
  9496     MOVE '/'                          TO TRD-LF-S1  TRD-LF-S2.
  9497
  9498     MOVE 'CANCEL    '                 TO TRD-LF-ACTION.
  9499     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 184
* ECS010V.cbl
  9500
  9501 0650-PROCESS-A-H-CANCEL.
  9502
  9503     IF CR-AHTYP = ZERO  OR
  9504        PB-C-AH-CANCEL-DT = LOW-VALUES  OR  SPACES
  9505         MOVE ZEROS               TO H-AHCM
  9506         GO TO 0660-PROCESS-CANCEL-CONTINUE.
  9507
  9508*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
  9509*    MOVE 'L'                   TO  DC-OPTION-CODE.
  9510*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9511*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
  9512
  9513     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-1.
  9514     MOVE ' '                     TO  DC-OPTION-CODE.
  9515     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9516     MOVE DC-GREG-DATE-CYMD       TO  CR-AH-CANC-DT
  9517                                      WS-CR-AH-CANC-DT-N.
  9518
  9519     IF PB-C-AH-PREM-TAX NUMERIC
  9520        MOVE PB-C-AH-PREM-TAX    TO CR-AH-CNC-PREM-TAX
  9521     END-IF
  9522     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
  9523     MOVE PB-C-AH-CANCEL-DT       TO  DC-BIN-DATE-2.
  9524     MOVE '1'                     TO  DC-OPTION-CODE.
  9525     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
  9526     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
  9527                                      DC-ODD-DAYS-OVER
  9528                                      DC-ELAPSED-DAYS.
  9529     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9530     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
  9531
  9532     IF  DC-ODD-DAYS-OVER   GREATER THAN   ZERO
  9533          ADD  +1                 TO  MONTHS-DIFF-AH.
  9534
  9535     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
  9536     IF CR-BANK-NOCHRGB-MONTHS NOT NUMERIC
  9537        MOVE ZEROS               TO CR-BANK-NOCHRGB-MONTHS
  9538     END-IF
  9539*    IF DTE-CLIENT = 'DCC'
  9540*       IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
  9541*          AND (CR-BANK-NOCHRGB-MONTHS > ZEROS)
  9542*          PERFORM VARYING SUB FROM +1 BY +1 UNTIL
  9543*             (CR-BANK-NO = CR-COM-AGT (SUB))
  9544*             OR (SUB > +10)
  9545*          END-PERFORM
  9546*          IF CR-BANK-NO = CR-COM-AGT (SUB)
  9547*             MOVE CR-BANK-NOCHRGB-MONTHS
  9548*                                TO AM-COMM-CHARGEBACK (SUB)
  9549*          END-IF
  9550*       END-IF
  9551*    END-IF
  9552
  9553
  9554     MOVE 'Y'                     TO WS-FIRST-K
  9555     MOVE ' '                     TO WS-DLR-INC-CHG-BACK
  9556     MOVE  ZEROS                  TO  SUB.
  9557
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 185
* ECS010V.cbl
  9558 0653-A-H-CHARGEBACK-LOOP.
  9559
  9560     ADD    +1                    TO  SUB.
  9561
  9562     IF  SUB  GREATER THAN  +10
  9563         GO TO  0655-CONTINUE-A-H-CANCEL.
  9564
  9565     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
  9566         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
  9567         GO TO  0653-A-H-CHARGEBACK-LOOP.
  9568
  9569     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
  9570         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
  9571
  9572     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
  9573         OR ((DTE-CLIENT = 'DCC')
  9574             AND (CR-AHRFND = ZEROS))
  9575         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB).
  9576
  9577     GO TO  0653-A-H-CHARGEBACK-LOOP.
  9578
  9579
  9580 0655-CONTINUE-A-H-CANCEL.
  9581
  9582     IF DC-ODD-DAYS-OVER GREATER THAN ZEROS
  9583        SUBTRACT +1 FROM MONTHS-DIFF-AH.
  9584
  9585     PERFORM 1550-GET-ACCT-LEVEL-AH-COMM THRU 1599-ACCT-AH-COMM-X.
  9586
  9587     IF DTE-CLIENT = 'GIC'
  9588         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  9589             MOVE CR-AHPRM-CALC   TO CR-AHRFND-CALC
  9590                                     A-H-REFUND-CALC.
  9591
  9592*    IF DTE-CLIENT = 'TMS'
  9593     MOVE PB-AH-REFUND-TYPE      TO CR-AH-REFUND-TYPE
  9594*    DISPLAY ' PEND AH REF TYPE ' PB-AH-REFUND-TYPE
  9595
  9596
  9597     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  9598         MOVE PB-C-LIVES               TO CR-SUM-CAN-CNT-YTD
  9599     ELSE
  9600         IF CR-AH-CANCEL-EXIT-DATE = ZEROS
  9601             MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-CANCEL
  9602             MOVE '8'                  TO CR-AH-CURRENT-STATUS
  9603             MOVE PB-C-AH-COMM-CHARGEBACK TO CR-AH-COMM-CHARGEBACK
  9604             MOVE EOM-RUN-DATE    TO CR-AH-CANCEL-EXIT-DATE
  9605                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9606         ELSE
  9607             IF CR-AH-CURRENT-STATUS = '7'
  9608                 MOVE '8'              TO CR-AH-CURRENT-STATUS
  9609                 MOVE PB-C-AH-COMM-CHARGEBACK
  9610                                       TO CR-AH-COMM-CHARGEBACK
  9611                 MOVE EOM-RUN-DATE TO CR-AH-CANCEL-EXIT-DATE
  9612                                      WS-CR-AH-CANCEL-EXIT-DATE-N.
  9613
  9614*************************************************
  9615***  ADDED IN 06/93 WHEN CERTIFICATE-RECORD   ***
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 186
* ECS010V.cbl
  9616***  WAS CONVERTED TO 1056 BYTES.             ***
  9617*************************************************
  9618     MOVE PB-ENTRY-BATCH               TO CR-AH-EXIT-BATCH.
  9619
  9620     MOVE CLAS-I-AB3 (CLAS-INDEXA)     TO TRD-AHTYP.
  9621     MOVE CR-AH-TERM                   TO TRD-AHTRM.
  9622     MOVE CR-AHRFND                    TO TRD-AHPRM-RFND.
  9623
  9624     IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
  9625        COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
  9626        COMPUTE H-AHCM ROUNDED = CNC-FACT *
  9627           (CR-AHPRM - (CR-LFPRM-ALT
  9628           + CR-ADDL-CLP)) * -1
  9629     ELSE
  9630        COMPUTE H-AHCM ROUNDED =
  9631          (CR-AHRFND * ACCT-COMM-AH) * (-1)
  9632     END-IF
  9633
  9634     MOVE H-AHCM                       TO TRD-AHCOM-CLM.
  9635
  9636     MOVE CR-AH-CNC-MO                 TO TRD-AHACTMO.
  9637     MOVE CR-AH-CNC-DA                 TO TRD-AHACTDA.
  9638     MOVE CR-AH-CNC-YR                 TO TRD-AHACTYR
  9639     MOVE '/'                          TO TRD-AH-S1  TRD-AH-S2.
  9640
  9641     MOVE 'CANCEL    '                 TO TRD-AH-ACTION.
  9642     MOVE CR-AH-CURRENT-STATUS         TO TRD-AH-STATUS.
  9643
  9644 0660-PROCESS-CANCEL-CONTINUE.
  9645
  9646     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9647
  9648     IF CR-POLICY-IS-REIN-ONLY
  9649        GO TO 0660-CONT.
  9650
  9651     MOVE 'Y'                    TO BILLED-SWITCH.
  9652     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2299-BLD-CANCEL-X.
  9653
  9654     IF CR-POLICY-IS-MONTHLY
  9655        GO TO 0660-CONT
  9656     END-IF
  9657
  9658     ADD +1                      TO BC-G-CNC.
  9659     ADD +1                      TO BC-COMM.
  9660     SUBTRACT CR-LFRFND FROM BC-NET-WRIT.
  9661     SUBTRACT CR-AHRFND FROM BC-NET-WRIT.
  9662     ADD CR-LFRFND               TO TPL-CNC-PRM (1).
  9663     ADD H-LFCM                  TO TPL-ACCT-COM (1).
  9664     ADD CR-AHRFND               TO TPA-CNC-PRM (1).
  9665     ADD H-AHCM                  TO TPA-ACCT-COM (1).
  9666
  9667     IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
  9668         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-OB
  9669     ELSE
  9670         SUBTRACT CR-LFRFND FROM BC-NET-WRIT-SP.
  9671
  9672     IF  CLAS-I-BAL (CLAS-INDEXA) = 'B'
  9673         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-OB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 187
* ECS010V.cbl
  9674     ELSE
  9675         SUBTRACT CR-AHRFND FROM BC-NET-WRIT-SP.
  9676
  9677
  9678 0660-CONT.
  9679
  9680     MOVE MONTHS-DIFF-LF            TO REIN-LCNC-EARN-TERM.
  9681     MOVE MONTHS-DIFF-AH            TO REIN-ACNC-EARN-TERM.
  9682
  9683     IF CR-LFRFND NEGATIVE
  9684       IF CR-LFRFND + LIFE-REFUND = ZEROS
  9685           MOVE '*'                 TO REIN-VOID-LF-SW.
  9686     IF CR-AHRFND NEGATIVE
  9687       IF CR-AHRFND + A-H-REFUND = ZEROS
  9688           MOVE '*'                 TO REIN-VOID-AH-SW.
  9689
  9690     IF CR-LFRFND NOT = ZEROS
  9691       IF CR-LF-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9692           MOVE '*'                 TO REIN-ADDL-LF-SW.
  9693     IF CR-AHRFND NOT = ZEROS
  9694       IF CR-AH-CANCEL-EXIT-DATE NOT = EOM-RUN-DATE
  9695           MOVE '*'                 TO REIN-ADDL-AH-SW.
  9696
  9697     IF CR-DT = CR-LF-CANC-DT
  9698       MOVE '*'                     TO REIN-CANCEL-LF-SW.
  9699     IF CR-DT = CR-AH-CANC-DT
  9700       MOVE '*'                     TO REIN-CANCEL-AH-SW.
  9701
  9702     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
  9703
  9704     MOVE SPACES                    TO REIN-VOID-LF-SW
  9705                                       REIN-VOID-AH-SW
  9706                                       REIN-ADDL-LF-SW
  9707                                       REIN-ADDL-AH-SW.
  9708
  9709     COMPUTE CR-LFRFND = LIFE-REFUND + PB-C-LF-CANCEL-AMT.
  9710     MOVE LIFE-REFUND-CALC          TO CR-LFRFND-CALC.
  9711
  9712     COMPUTE CR-AHRFND = A-H-REFUND  + PB-C-AH-CANCEL-AMT.
  9713     MOVE A-H-REFUND-CALC           TO CR-AHRFND-CALC.
  9714
  9715     IF (CR-LFTYP NOT = ZERO  AND
  9716        CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
  9717        (CR-AHTYP NOT = ZERO  AND
  9718        CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
  9719         ADD PB-C-LIVES                TO CR-SUM-CAN-CNT-ITD
  9720         COMPUTE CR-SUM-CAN-CNT-YTD = YTD-CANCEL-CNT + PB-C-LIVES.
  9721
  9722 0670-LIFE-CANCEL-VOID.
  9723
  9724     IF CR-LFTYP NOT = ZERO  AND
  9725        CR-LFRFND = ZERO  AND
  9726        PB-C-LF-CANCEL-AMT NEGATIVE
  9727         NEXT SENTENCE
  9728     ELSE
  9729         GO TO 0680-A-H-CANCEL-VOID.
  9730
  9731     MOVE ZEROS                        TO CR-LF-CANCEL-EXIT-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 188
* ECS010V.cbl
  9732                                       WS-CR-LF-CANCEL-EXIT-DATE-N
  9733                                          CR-LF-CANC-DT
  9734                                          WS-CR-LF-CANC-DT-N
  9735                                          CR-LFRFND-CALC.
  9736
  9737     MOVE SPACES                       TO CR-LF-COMM-CHARGEBACK.
  9738
  9739     IF CR-LF-CANCEL-APPLIED
  9740         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-CURRENT-STATUS
  9741         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL
  9742     ELSE
  9743         MOVE CR-LF-STATUS-AT-CANCEL   TO CR-LF-STATUS-AT-DEATH
  9744         MOVE ' '                      TO CR-LF-STATUS-AT-CANCEL.
  9745
  9746     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9747
  9748     MOVE 'VOID CANCL'                 TO TRD-LF-ACTION.
  9749     MOVE CR-LF-CURRENT-STATUS         TO TRD-LF-STATUS.
  9750
  9751     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9752
  9753 0680-A-H-CANCEL-VOID.
  9754
  9755     IF CR-AHTYP NOT = ZERO  AND
  9756        CR-AHRFND = ZERO  AND
  9757        PB-C-AH-CANCEL-AMT NEGATIVE
  9758         NEXT SENTENCE
  9759     ELSE
  9760         GO TO 0690-END-CANCEL-PROCESSING.
  9761
  9762     MOVE ZEROS                      TO CR-AH-CANCEL-EXIT-DATE
  9763                                     WS-CR-AH-CANCEL-EXIT-DATE-N
  9764                                        CR-AH-CANC-DT
  9765                                        WS-CR-AH-CANC-DT-N
  9766                                        CR-AHRFND-CALC.
  9767
  9768     MOVE SPACES                        TO CR-AH-COMM-CHARGEBACK.
  9769
  9770     IF CR-AH-CANCEL-APPLIED
  9771         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9772         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9773     ELSE
  9774         MOVE CR-AH-STATUS-AT-CANCEL
  9775                                    TO CR-AH-STATUS-AT-SETTLEMENT
  9776         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL.
  9777
  9778     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9779
  9780     MOVE 'VOID CANCL'                  TO TRD-AH-ACTION.
  9781     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9782
  9783     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
  9784
  9785 0690-END-CANCEL-PROCESSING.
  9786
  9787     IF CR-LF-CANC-DT = ZEROS  AND
  9788        CR-AH-CANC-DT = ZEROS
  9789         MOVE ZEROS             TO CR-CAN-MICROFILM-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 189
* ECS010V.cbl
*  12-S*****************************************************           ( 181)**
**    Operand CR-CAN-MICROFILM-NO is not declared
  9790
  9791     IF LIFE-REFUND = ZERO  AND  A-H-REFUND = ZERO
  9792         NEXT SENTENCE
  9793     ELSE
  9794         MOVE 'X'               TO REIN-RT-SW
  9795         PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X
  9796         MOVE ' '               TO REIN-RT-SW.
  9797
  9798     MOVE '*'                   TO TRANSACTION-FLAG.
  9799     GO TO 0300-READ-PENDING-TRANSACTIONS.
  9800
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 190
* ECS010V.cbl
  9802******************************************************************
  9803***    P R O C E S S   C L A I M S   T R A N S A C T I O N S   ***
  9804******************************************************************
  9805
  9806 0700-PROCESS-CLAIMS.
  9807
  9808     IF NOT PC-LF-CLAIM  AND  NOT  PC-OB-LF-CLAIM  AND
  9809        NOT PC-AH-CLAIM  AND  NOT  PC-OB-AH-CLAIM
  9810         DISPLAY 'INVALID CLAIM TYPE TO ECS010 '
  9811             PENDING-MATCH-CONTROL
  9812         MOVE 0301 TO WS-ABEND-CODE
  9813         DISPLAY '******************************'
  9814         DISPLAY '***** ERROR LOCATION 011 *****'
  9815         DISPLAY '******************************'
  9816         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
  9817         GO TO ABEND-PGM.
  9818
  9819     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
  9820
  9821     ADD +1                       TO  W-LF-CLAIMS.
  9822
  9823     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
  9824     MOVE ' '                     TO  DC-OPTION-CODE.
  9825     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9826     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
  9827
  9828     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
  9829     MOVE ' '                     TO  DC-OPTION-CODE.
  9830     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9831     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
  9832
  9833     MOVE PC-PAYMENT-DT           TO  DC-BIN-DATE-1.
  9834     MOVE ' '                     TO  DC-OPTION-CODE.
  9835     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9836     MOVE DC-GREG-DATE-CYMD       TO  PAYMENT-DATE.
  9837
  9838     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
  9839     MOVE ' '                     TO  DC-OPTION-CODE.
  9840     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
  9841     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
  9842
  9843     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
  9844
  9845     IF DTE-CLIENT = 'LAP'  OR  'RMC'
  9846       MOVE PC-CHECK-NO            TO WS-CHECK-NUMBER
  9847       IF WS-CHECK-NO = 'DEDU'  OR  ' DED'  OR  '0DED'
  9848         IF CR-CLAIM-DEDUCT-WITHHELD = +99999.99
  9849             MOVE PC-CLAIM-PAYMENT TO CR-CLAIM-DEDUCT-WITHHELD
  9850         ELSE
  9851             ADD PC-CLAIM-PAYMENT  TO CR-CLAIM-DEDUCT-WITHHELD.
  9852
  9853     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
  9854         GO TO 0750-PROCESS-DISABILITY-CLAIM.
  9855
  9856******************************************************************
  9857***           P R O C E S S   D E A T H   C L A I M            ***
  9858******************************************************************
  9859
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 191
* ECS010V.cbl
  9860     IF REIN-IS-RISK-PREMIUM
  9861       IF CR-DTH-DT = ZEROS
  9862           MOVE INCURRED-DATE      TO DC-GREG-DATE-CYMD
  9863           PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
  9864           MOVE DC-ELAPSED-MONTHS  TO REIN-LF-CLM-MONTHS.
  9865
  9866     MOVE INCURRED-DATE            TO CR-DTH-DT
  9867                                      WS-CR-DTH-DT-N.
  9868
  9869     IF PC-CHARGEBLE-EXPENSE  OR
  9870        PC-NON-CHARGEBLE-EXPENSE
  9871         IF CR-LFTYP = '00'
  9872             MOVE '99'             TO CR-LFTYP  CLAS-LOOK
  9873             PERFORM 8300-LIFE-TYPE-LOOKUP THRU
  9874                     8399-LIFE-LOOKUP-X.
  9875
  9876     IF PC-CHARGEBLE-EXPENSE  OR
  9877        PC-NON-CHARGEBLE-EXPENSE
  9878         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP
  9879         ADD PC-CLAIM-PAYMENT      TO CR-DTHEXP-YTD
  9880         ADD PC-CLAIM-PAYMENT      TO TPL-CLAIMS (1)
  9881         MOVE PC-CLAIM-PAYMENT     TO TRD-LFCOM-CLM
  9882         MOVE 'CLAIM EXP '         TO TRD-LF-ACTION
  9883         GO TO 0780-END-CLAIMS-PROCESSING.
  9884
  9885     ADD +1                       TO  CR-NUM-DTH-CLM.
  9886     MOVE REPORTED-DATE           TO  CR-DTH-RPT-DT.
  9887     MOVE PAYMENT-DATE            TO  CR-DTH-PAY-DT
  9888                                      WS-CR-DTH-PAY-DT-N.
  9889
  9890     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT.
  9891     ADD PC-CLAIM-PAYMENT         TO  CR-DTHAMT-YTD.
  9892     MOVE PC-CLAIM-PAYMENT        TO  CR-DTHAMT-LAST.
  9893     MOVE PC-AGE-AT-CLAIM         TO  CR-DTH-AGE.
  9894     IF CR-DTH-PAY-CD NOT = 'F'
  9895         MOVE PC-PAYMENT-TYPE     TO  CR-DTH-PAY-CD.
  9896     INSPECT CR-DTH-PAY-CD
  9897         CONVERTING '12349' TO 'PFSXV'.
  9898     MOVE PC-CAUSE-CODE           TO  CR-DEATH-CAUSE.
  9899
  9900     IF (LIFE-OVERRIDE-L1 EQUAL 'P'  OR
  9901         CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P')
  9902       AND
  9903       (CR-DTHAMT LESS THAN (CR-LFAMT + CR-LFAMT-ALT)
  9904       OR
  9905        DTE-CLIENT = 'ACC' OR 'FDL')
  9906        NEXT SENTENCE
  9907     ELSE
  9908     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z')
  9909         IF CR-LF-CLAIM-EXIT-DATE = ZEROS
  9910             MOVE CR-LF-CURRENT-STATUS TO CR-LF-STATUS-AT-DEATH
  9911             MOVE '7'            TO CR-LF-CURRENT-STATUS
  9912             MOVE EOM-RUN-DATE   TO CR-LF-CLAIM-EXIT-DATE
  9913                                    WS-CR-LF-CLAIM-EXIT-DATE-N.
  9914
  9915     MOVE CLAS-I-AB3 (CLAS-INDEXL)     TO TRD-LFTYP.
  9916     MOVE CR-LF-TERM                   TO TRD-LFTRM.
  9917     MOVE PC-CLAIM-PAYMENT        TO  TRD-LFCOM-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 192
* ECS010V.cbl
  9918     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'P'
  9919         MOVE 'PROPERTY  '       TO TRD-LF-ACTION
  9920     ELSE
  9921         MOVE 'CLAIM PYMT'       TO TRD-LF-ACTION.
  9922     MOVE CR-LF-CURRENT-STATUS   TO TRD-LF-STATUS.
  9923
  9924     IF NOT CR-POLICY-IS-REIN-ONLY
  9925         ADD PC-CLAIM-PAYMENT    TO TPL-CLAIMS (1).
  9926
  9927 0720-CANCEL-AH-COVERAGE.
  9928
  9929     IF CR-AHTYP = ZEROS  OR
  9930        NOT CR-AH-POLICY-IS-ACTIVE
  9931         GO TO 0740-DEATH-CLAIM-VOID.
  9932
  9933     MOVE CR-AH-CURRENT-STATUS          TO CR-AH-STATUS-AT-CANCEL.
  9934     MOVE '7'                           TO CR-AH-CURRENT-STATUS.
  9935     MOVE CR-DTH-DT                     TO CR-AH-CANC-DT
  9936                                           WS-CR-AH-CANC-DT-N.
  9937     MOVE EOM-RUN-DATE               TO CR-AH-CANCEL-EXIT-DATE
  9938                                     WS-CR-AH-CANCEL-EXIT-DATE-N.
  9939
  9940     MOVE CLAS-I-AB3 (CLAS-INDEXA)      TO TRD-AHTYP.
  9941     MOVE CR-AH-TERM                    TO TRD-AHTRM.
  9942     MOVE CR-DTH-MO                     TO TRD-AHACTMO.
  9943     MOVE CR-DTH-DA                     TO TRD-AHACTDA.
  9944     MOVE CR-DTH-YR                     TO TRD-AHACTYR.
  9945     MOVE '/'                           TO TRD-AH-S1  TRD-AH-S2.
  9946     MOVE 'CLAIM CANC'                  TO TRD-AH-ACTION.
  9947     MOVE CR-AH-CURRENT-STATUS          TO TRD-AH-STATUS.
  9948
  9949 0740-DEATH-CLAIM-VOID.
  9950
  9951     IF CR-DTHAMT = ZERO  AND
  9952        PC-CLAIM-PAYMENT NEGATIVE
  9953         NEXT SENTENCE
  9954     ELSE
  9955         GO TO 0780-END-CLAIMS-PROCESSING.
  9956
  9957     MOVE '*'                           TO DEATH-VOID-FLAG.
  9958
  9959     MOVE ZEROS                         TO CR-LF-CLAIM-EXIT-DATE
  9960                                        WS-CR-LF-CLAIM-EXIT-DATE-N
  9961                                           CR-NUM-DTH-CLM
  9962                                           CR-DTH-RPT-DT
  9963                                           CR-DTH-PAY-DT
  9964                                           WS-CR-DTH-PAY-DT-N
  9965*                                          CR-DTHAMT-YTD
  9966*                                          CR-DTHAMT-LAST
  9967                                           CR-DTH-AGE.
  9968     MOVE ' '                           TO CR-DTH-PAY-CD.
  9969
  9970     IF CR-LF-DEATH-CLAIM-APPLIED
  9971         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-CURRENT-STATUS
  9972         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH
  9973     ELSE
  9974         MOVE CR-LF-STATUS-AT-DEATH     TO CR-LF-STATUS-AT-CANCEL
  9975         MOVE ' '                       TO CR-LF-STATUS-AT-DEATH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 193
* ECS010V.cbl
  9976
  9977     MOVE 'VOID CLAIM'                  TO TRD-LF-ACTION.
  9978     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
  9979
  9980     IF CR-AH-DEATH-CLAIM-APPLIED
  9981         MOVE CR-AH-STATUS-AT-CANCEL    TO CR-AH-CURRENT-STATUS
  9982         MOVE ' '                       TO CR-AH-STATUS-AT-CANCEL
  9983         MOVE ZEROS                     TO CR-AH-CANC-DT
  9984                                           WS-CR-AH-CANC-DT-N
  9985                                           CR-AH-CANCEL-EXIT-DATE
  9986                                       WS-CR-AH-CANCEL-EXIT-DATE-N
  9987         MOVE CLAS-I-AB3 (CLAS-INDEXA)  TO TRD-AHTYP
  9988         MOVE CR-AH-TERM                TO TRD-AHTRM
  9989         MOVE 'VOID CANCL'              TO TRD-AH-ACTION
  9990         MOVE CR-AH-CURRENT-STATUS      TO TRD-AH-STATUS.
  9991
  9992     GO TO 0780-END-CLAIMS-PROCESSING.
  9993
  9994******************************************************************
  9995***       P R O C E S S   D I S A B I L I T Y   C L A I M      ***
  9996******************************************************************
  9997
  9998 0750-PROCESS-DISABILITY-CLAIM.
  9999
 10000     ADD +1                       TO W-AH-CLAIMS.
 10001
 10002     MOVE INCURRED-DATE           TO CR-DIS-DT
 10003                                     WS-CR-DIS-DT-N.
 10004
 10005     PERFORM 0790-TABLE-DISAB-PERIODS THRU 0791-TABLE-AH-EXIT.
 10006
 10007     IF REIN-AH-CLM-MONTHS = +1
 10008         MOVE REIN-AH-CLM-MTH-1        TO REIN-AH-CLM-MONTHS
 10009     ELSE
 10010       IF REIN-AH-CLM-MONTHS = +2
 10011           MOVE REIN-AH-CLM-MTH-2      TO REIN-AH-CLM-MONTHS
 10012       ELSE
 10013         IF REIN-AH-CLM-MONTHS = +3
 10014             MOVE REIN-AH-CLM-MTH-3    TO REIN-AH-CLM-MONTHS
 10015         ELSE
 10016           IF REIN-AH-CLM-MONTHS = +4
 10017               MOVE REIN-AH-CLM-MTH-4  TO REIN-AH-CLM-MONTHS
 10018           ELSE
 10019               MOVE REIN-AH-CLM-MTH-5  TO REIN-AH-CLM-MONTHS.
 10020
 10021     IF PC-CHARGEBLE-EXPENSE  OR
 10022        PC-NON-CHARGEBLE-EXPENSE
 10023         IF CR-AHTYP = '00'
 10024             MOVE '99'             TO CR-AHTYP  CLAS-LOOK
 10025             PERFORM 8400-A-H-TYPE-LOOKUP THRU
 10026                     8499-A-H-LOOKUP-X.
 10027
 10028     IF PC-CHARGEBLE-EXPENSE  OR
 10029        PC-NON-CHARGEBLE-EXPENSE
 10030         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP
 10031         ADD PC-CLAIM-PAYMENT      TO CR-DISEXP-YTD
 10032         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1)
 10033         MOVE PC-CLAIM-PAYMENT     TO TRD-AHCOM-CLM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 194
* ECS010V.cbl
 10034         MOVE 'CLAIM EXP '         TO TRD-AH-ACTION
 10035         GO TO 0780-END-CLAIMS-PROCESSING.
 10036
 10037     ADD +1                       TO CR-NUM-DIS-CLM.
 10038
 10039     MOVE REPORTED-DATE           TO  CR-DIS-RPT-DT.
 10040     MOVE PAYMENT-DATE            TO  CR-DIS-PAY-DT
 10041                                      WS-CR-DIS-PAY-DT-N.
 10042     MOVE PAY-TO-DATE             TO  CR-DIS-PTO-DT
 10043                                      WS-CR-DIS-PTO-DT-N.
 10044
 10045     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT.
 10046     ADD  PC-CLAIM-PAYMENT         TO CR-DISAMT-YTD.
 10047     MOVE PC-CLAIM-PAYMENT         TO CR-DISAMT-LAST.
 10048
 10049     MOVE PC-NO-OF-DAYS-PAID       TO CR-DAYS-DISAB.
 10050     IF CR-DIS-PAY-CD NOT = 'S'
 10051         MOVE PC-PAYMENT-TYPE      TO CR-DIS-PAY-CD.
 10052     INSPECT CR-DIS-PAY-CD
 10053         CONVERTING '12349' TO 'PFSXV'.
 10054     MOVE PC-CAUSE-CODE            TO CR-DISAB-CAUSE.
 10055
 10056     IF PC-LUMP-SUM-PAYMENT
 10057         IF CR-AH-SETTLEMENT-EXIT-DATE = ZEROS
 10058           MOVE CR-AH-CURRENT-STATUS TO CR-AH-STATUS-AT-SETTLEMENT
 10059           MOVE '6'                  TO CR-AH-CURRENT-STATUS
 10060           MOVE EOM-RUN-DATE    TO CR-AH-SETTLEMENT-EXIT-DATE
 10061                                   WS-CR-AH-SETTLEMENT-EXIT-DATEN.
 10062
 10063     MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP.
 10064     MOVE CR-AH-TERM               TO TRD-AHTRM.
 10065     MOVE PC-CLAIM-PAYMENT         TO TRD-AHCOM-CLM.
 10066     MOVE 'CLAIM PYMT'             TO TRD-AH-ACTION.
 10067     MOVE CR-AH-CURRENT-STATUS     TO TRD-AH-STATUS.
 10068
 10069     IF NOT CR-POLICY-IS-REIN-ONLY
 10070         ADD PC-CLAIM-PAYMENT      TO TPA-CLAIMS (1).
 10071
 10072     IF NOT PC-LUMP-SUM-PAYMENT
 10073         GO TO 0780-END-CLAIMS-PROCESSING.
 10074
 10075 0770-CANCEL-LF-COVERAGE.
 10076
 10077     IF CR-LFTYP = ZEROS  OR
 10078        NOT CR-LF-POLICY-IS-ACTIVE
 10079         GO TO 0780-END-CLAIMS-PROCESSING.
 10080
 10081     MOVE CR-LF-CURRENT-STATUS          TO CR-LF-STATUS-AT-CANCEL.
 10082     MOVE '6'                           TO CR-LF-CURRENT-STATUS.
 10083     MOVE CR-DIS-PAY-DT                 TO CR-LF-CANC-DT
 10084                                           WS-CR-LF-CANC-DT-N.
 10085     MOVE EOM-RUN-DATE               TO CR-LF-CANCEL-EXIT-DATE
 10086                                     WS-CR-LF-CANCEL-EXIT-DATE-N.
 10087
 10088     MOVE CLAS-I-AB3 (CLAS-INDEXL)      TO TRD-LFTYP.
 10089     MOVE CR-LF-TERM                    TO TRD-LFTRM.
 10090     MOVE CR-DIS-PAY-MO                 TO TRD-LFACTMO.
 10091     MOVE CR-DIS-PAY-DA                 TO TRD-LFACTDA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 195
* ECS010V.cbl
 10092     MOVE CR-DIS-PAY-YR                 TO TRD-LFACTYR.
 10093     MOVE '/'                           TO TRD-LF-S1  TRD-LF-S2.
 10094     MOVE 'CLAIM CANC'                  TO TRD-LF-ACTION.
 10095     MOVE CR-LF-CURRENT-STATUS          TO TRD-LF-STATUS.
 10096
 10097 0780-END-CLAIMS-PROCESSING.
 10098
 10099     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10100         MOVE DTO-MO               TO TRD-LFACTMO
 10101         MOVE DTO-DA               TO TRD-LFACTDA
 10102         MOVE DTO-YR               TO TRD-LFACTYR
 10103         MOVE '/'                  TO TRD-LF-S1  TRD-LF-S2
 10104     ELSE
 10105         MOVE PAY-MO               TO TRD-AHACTMO
 10106         MOVE PAY-DA               TO TRD-AHACTDA
 10107         MOVE PAY-YR               TO TRD-AHACTYR
 10108         MOVE '/'                  TO TRD-AH-S1  TRD-AH-S2.
 10109
 10110     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10111
 10112     IF NOT CR-POLICY-IS-REIN-ONLY
 10113         PERFORM 2300-BUILD-CLAIM-EXTRACT THRU 2399-BLD-CLAIM-X
 10114         ADD +1                    TO BC-G-CLM.
 10115
 10116     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 10117
 10118     IF DEATH-CLAIM-VOIDED
 10119         MOVE ZEROS                TO CR-DTH-DT
 10120                                      WS-CR-DTH-DT-N.
 10121     MOVE SPACE                    TO DEATH-VOID-FLAG.
 10122
 10123     MOVE '*'                      TO TRANSACTION-FLAG.
 10124     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10125
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 196
* ECS010V.cbl
 10127 0790-TABLE-DISAB-PERIODS.
 10128
 10129     MOVE +1                       TO SUB14.
 10130     PERFORM 0794-REVIEW-TABLE     THRU 0794-REVIEW-TABLE-EXIT.
 10131
 10132     MOVE +1                       TO SUB14.
 10133
 10134**************************************************************
 10135**                                                          **
 10136**   THIS ROUTINE SEARCHES THROUGH THE DISAB-DETAIL-DATA    **
 10137**  AND MATCHES INCURRED DATE.  IT THEN ADDS THE AMOUNT OF  **
 10138**  THE CLAIM TO THAT OCCURRENCE.  IF THE INCURRED DATE     **
 10139**  DOES NOT MATCH ANY PREVIOUS INCURRED DATE,  IT WILL     **
 10140**  INITIALIZE THE NEXT OCCURRENCE.  (OLDEST TO MOST RECENT)**
 10141**                                                          **
 10142**    IF ALL 5 OCCURRENCES ARE FILLED,  THE TWO OLDEST      **
 10143**  AMOUNTS ARE COMBINED LEAVING THE LAST OCCURRENCE OPEN   **
 10144**  FOR THE MOST RECENT CLAIM INFORMATION.                  **
 10145**                                                          **
 10146**************************************************************
 10147
 10148 0791-TABLE-AH-AMOUNT.
 10149
 10150     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10151         PERFORM 0792-MOVE-TABLE  THRU 0792-MOVE-TABLE-EXIT.
 10152
 10153     IF CR-DIS-INCUR-DT (SUB14)  EQUAL ZEROS
 10154         MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10155                                      WS-CR-DIS-INCUR-DT-N (SUB14)
 10156         IF REIN-IS-RISK-PREMIUM
 10157             MOVE INCURRED-DATE     TO DC-GREG-DATE-CYMD
 10158             PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 10159             IF SUB14 = +1
 10160               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-1
 10161             ELSE
 10162             IF SUB14 = +2
 10163               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-2
 10164             ELSE
 10165             IF SUB14 = +3
 10166               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-3
 10167             ELSE
 10168             IF SUB14 = +4
 10169               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-4
 10170             ELSE
 10171               MOVE DC-ELAPSED-MONTHS TO REIN-AH-CLM-MTH-5.
 10172
 10173
 10174     IF INCURRED-DATE EQUAL CR-DIS-INCUR-DT (SUB14)
 10175         MOVE SUB14                TO REIN-AH-CLM-MONTHS
 10176         COMPUTE REIN-AH-PRIOR-CLMS-PAID = CR-INCUR-DISAMT (SUB14)
 10177                                        +  CR-INCUR-DISEXP (SUB14)
 10178         IF PC-CHARGEBLE-EXPENSE  OR
 10179            PC-NON-CHARGEBLE-EXPENSE
 10180             ADD PC-CLAIM-PAYMENT  TO CR-INCUR-DISEXP (SUB14)
 10181             GO TO 0791-TABLE-AH-EXIT
 10182         ELSE
 10183             ADD  PC-CLAIM-PAYMENT TO CR-INCUR-DISAMT (SUB14)
 10184             GO TO 0791-TABLE-AH-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 197
* ECS010V.cbl
 10185
 10186     ADD +1                       TO SUB14.
 10187
 10188     GO TO 0791-TABLE-AH-AMOUNT.
 10189
 10190 0791-TABLE-AH-EXIT.
 10191     EXIT.
 10192
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 198
* ECS010V.cbl
 10194**************************************************************
 10195**                                                          **
 10196** THIS ROUTINE IS PERFORMED WHEN THERE HAVE BEEN MORE THAN **
 10197** 5 DISABILITY PERIODS ATTACHED TO THE SAME CERTIFICATE.   **
 10198**                                                          **
 10199** THE SECOND OCCURRENCE IS ADDED TO THE 1ST OCCURRENCE     **
 10200** COMBINING THE TWO OLDEST OCCURRENCES INTO ONE BUCKET     **
 10201** THE NEWEST CLAIM INFORMATION IS MOVED INTO THE LAST      **
 10202** OCCURRENCE.                                              **
 10203**************************************************************
 10204 0792-MOVE-TABLE.
 10205
 10206     MOVE CR-DIS-INCUR-DT (2)  TO CR-DIS-INCUR-DT (1)
 10207                                  WS-CR-DIS-INCUR-DT-N (1).
 10208     ADD  CR-INCUR-DISAMT (2)  TO CR-INCUR-DISAMT (1).
 10209     ADD  CR-INCUR-DISEXP (2)  TO CR-INCUR-DISEXP (1).
 10210
 10211     MOVE +2                   TO SUB14.
 10212     MOVE +3                   TO SUB15.
 10213     PERFORM 0794A-BUMP-TBL    THRU 0794A-BUMP-TBL-EXIT.
 10214
 10215     MOVE DISABILITY-TBL-MAX   TO SUB14.
 10216
 10217     MOVE INCURRED-DATE        TO CR-DIS-INCUR-DT (SUB14)
 10218                                  WS-CR-DIS-INCUR-DT-N (SUB14).
 10219
 10220 0792-MOVE-TABLE-EXIT.
 10221     EXIT.
 10222
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 199
* ECS010V.cbl
 10224**************************************************************
 10225**                                                          **
 10226**  A REVIEW OF ALL OCCURRENCES IS PERFORMED TO ELIMINATE   **
 10227** ANY WITH NO PAYMENTS OR EXPENSES ATTACHED. THESE CAN     **
 10228** OCCUR WHEN DISABILITY PAYMENTS HAVE BEEN VOIDED, BECAUSE **
 10229** CLAIM ATTACHED TO WRONG CERTIFICATE, OR WRONG CLAIM TYPE **
 10230** PAID, OR A CHANGE IN THE INCURRED DATE OF A CLAIM.       **
 10231**************************************************************
 10232
 10233 0794-REVIEW-TABLE.
 10234
 10235     IF SUB14 GREATER THAN DISABILITY-TBL-MAX
 10236         GO TO 0794-REVIEW-TABLE-EXIT.
 10237
 10238     IF CR-DIS-INCUR-DT (SUB14) EQUAL ZEROS
 10239         GO TO 0794-REVIEW-TABLE-EXIT.
 10240
 10241     IF CR-INCUR-DISAMT (SUB14) EQUAL ZEROS  AND
 10242        CR-INCUR-DISEXP (SUB14) EQUAL ZEROS
 10243         DISPLAY CR-ACCOUNT ' ' CR-CERT-NO ' ' SUB14
 10244         MOVE ZEROS            TO CR-DIS-INCUR-DT (SUB14)
 10245                                  WS-CR-DIS-INCUR-DT-N (SUB14)
 10246         MOVE SUB14            TO SUB15
 10247         ADD +1                TO SUB15
 10248         PERFORM 0794A-BUMP-TBL   THRU 0794A-BUMP-TBL-EXIT
 10249         MOVE +1               TO SUB14
 10250         GO TO 0794-REVIEW-TABLE.
 10251
 10252     ADD +1                    TO SUB14.
 10253
 10254     GO TO 0794-REVIEW-TABLE.
 10255
 10256 0794-REVIEW-TABLE-EXIT.
 10257     EXIT.
 10258
 10259 0794A-BUMP-TBL.
 10260
 10261     IF SUB15 GREATER THAN DISABILITY-TBL-MAX
 10262         GO TO 0794A-BUMP-TBL-EXIT.
 10263
 10264     MOVE CR-DISAB-DETAIL-DATA (SUB15)  TO
 10265                             CR-DISAB-DETAIL-DATA (SUB14).
 10266
 10267     MOVE ZEROS                TO CR-DIS-INCUR-DT (SUB15)
 10268                                  WS-CR-DIS-INCUR-DT-N (SUB15)
 10269                                  CR-INCUR-DISAMT (SUB15)
 10270                                  CR-INCUR-DISEXP (SUB15).
 10271
 10272     ADD +1                    TO SUB14
 10273                                  SUB15.
 10274     GO TO 0794A-BUMP-TBL.
 10275
 10276 0794A-BUMP-TBL-EXIT.
 10277     EXIT.
 10278
 10279 0795-DCC-NSP-LF.
 10280
 10281     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 200
* ECS010V.cbl
 10282     MOVE 'L'                        TO DC-OPTION-CODE.
 10283     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10284     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 10285     MOVE SPACES                     TO CP-ACCT-FLD-5.
 10286     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 10287     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 10288     MOVE CR-APR                     TO CP-LOAN-APR.
 10289     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 10290     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 10291     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 10292     MOVE CR-RATING-CLASS            TO CP-CLASS-CODE.
 10293
 10294     MOVE '3'                        TO CP-PROCESS-TYPE.
 10295     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 10296     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 10297
 10298     IF CR-LFTYP = ZERO
 10299         GO TO 0795-EXIT
 10300     END-IF
 10301
 10302     IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 10303         GO TO 0795-EXIT
 10304     END-IF
 10305     MOVE CR-LFPRM                   TO CP-ORIGINAL-PREMIUM
 10306     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 10307     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 10308     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 10309                                        CP-RATING-BENEFIT-AMT.
 10310     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 10311     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 10312     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
 10313     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 10314     MOVE ZEROS                      TO CP-RATE-DEV-PCT.
 10315     MOVE CR-STATE                   TO CP-STATE.
 10316     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 10317
 10318     IF CP-STATE-STD-ABBRV = 'OR'
 10319         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 10320
 10321     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 10322
 10323     IF CP-ERROR-RATE-NOT-FOUND  OR
 10324        CP-ERROR-RATE-IS-ZERO
 10325         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 10326                                     TO WS-ABEND-MESSAGE
 10327         MOVE 0302                   TO WS-ABEND-CODE
 10328         DISPLAY '******************************'
 10329         DISPLAY '***** ERROR LOCATION 018 *****'
 10330         DISPLAY '******************************'
 10331         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 10332         GO TO ABEND-PGM.
 10333
 10334     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 10335
 10336*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 10337*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 10338
 10339     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 201
* ECS010V.cbl
 10340                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 10341
 10342     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 10343
 10344 0795-exit.
 10345     exit.
 10346
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 202
* ECS010V.cbl
 10348******************************************************************
 10349***   P R O C E S S   R E S E R V E   T R A N S A C T I O N S  ***
 10350******************************************************************
 10351
 10352 0800-PROCESS-RESERVES.
 10353
 10354     IF PC-AH-CLAIM  OR  PC-OB-AH-CLAIM
 10355       IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 10356           MOVE ZEROS             TO  PC-IBNR-RESERVE-AMT.
 10357
 10358     PERFORM 3000-REINSURE-ROUTINE THRU 3099-REINSURE-ROUTINE-X.
 10359
 10360     MOVE PC-INCURRED-DT          TO  DC-BIN-DATE-1.
 10361     MOVE ' '                     TO  DC-OPTION-CODE.
 10362     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10363     MOVE DC-GREG-DATE-CYMD       TO  INCURRED-DATE.
 10364
 10365     MOVE PC-REPORTED-DT          TO  DC-BIN-DATE-1.
 10366     MOVE ' '                     TO  DC-OPTION-CODE.
 10367     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10368     MOVE DC-GREG-DATE-1-YMD      TO  REPORTED-DATE.
 10369
 10370     MOVE PC-PAID-THRU-DT         TO  DC-BIN-DATE-1.
 10371     MOVE ' '                     TO  DC-OPTION-CODE.
 10372     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 10373     MOVE DC-GREG-DATE-CYMD       TO  PAY-TO-DATE.
 10374
 10375     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10376
 10377     IF PC-LF-CLAIM  OR  PC-OB-LF-CLAIM
 10378         ADD +1                     TO W-LF-RESERVES
 10379         ADD PC-IBNR-RESERVE-AMT    TO DTH-IBNR
 10380         ADD PC-PTC-RESERVE-AMT     TO DTH-PAYCUR
 10381         ADD PC-FUTURE-RESERVE-AMT  TO DTH-FUTRSV
 10382         ADD PC-MANUAL-RESERVE-AMT  TO DTH-FUTRSV
 10383         MOVE INCURRED-DATE         TO CR-DTH-DT
 10384                                       WS-CR-DTH-DT-N
 10385         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 10386
 10387     ELSE
 10388         ADD +1                     TO W-AH-RESERVES
 10389         ADD PC-IBNR-RESERVE-AMT    TO DIS-IBNR
 10390         ADD PC-PTC-RESERVE-AMT     TO DIS-PAYCUR
 10391         ADD PC-FUTURE-RESERVE-AMT  TO DIS-FUTRSV
 10392         ADD PC-MANUAL-RESERVE-AMT  TO DIS-FUTRSV
 10393         MOVE INCURRED-DATE         TO CR-DIS-DT
 10394                                       WS-CR-DIS-DT-N
 10395         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 10396
 10397     MOVE PC-IBNR-RESERVE-AMT       TO TRD-IBNR.
 10398     MOVE 'IBNR'                    TO TRD-IBNRX.
 10399     MOVE PC-PTC-RESERVE-AMT        TO TRD-PAYCUR.
 10400     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 10401     COMPUTE TRD-FUTRSV EQUAL
 10402            (PC-FUTURE-RESERVE-AMT + PC-MANUAL-RESERVE-AMT).
 10403     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 10404     MOVE ' CLAIM RESERVES      '   TO TRD-RSV-ACTION.
 10405
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 203
* ECS010V.cbl
 10406 0820-END-RESERVE-PROCESSING.
 10407
 10408     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10409
 10410     IF NOT CR-POLICY-IS-REIN-ONLY
 10411         PERFORM 2400-BUILD-RESERVE-EXTRACT THRU
 10412                                            2499-BLD-RESERVE-X
 10413         ADD +1 TO BC-G-CRS.
 10414
 10415     PERFORM 3400-REINSURE-RESERVE THRU 3499-REINSURE-RESERVE-X.
 10416
 10417     MOVE '*'                    TO TRANSACTION-FLAG.
 10418     GO TO 0300-READ-PENDING-TRANSACTIONS.
 10419
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 204
* ECS010V.cbl
 10421******************************************************************
 10422***    P R O C E S S   C H A N G E   T R A N S A C T I O N S   ***
 10423******************************************************************
 10424
 10425 0900-PROCESS-CERT-CHANGES.
 10426
 10427     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 10428
 10429     IF CC-AGE NOT NUMERIC  OR
 10430        CC-AGE = CR-AGE
 10431         MOVE ZEROS TO CC-AGE.
 10432
 10433     IF CC-INSURED-JOINT-AGE NOT NUMERIC  OR
 10434        CC-INSURED-JOINT-AGE = CR-JOINT-AGE
 10435         MOVE ZEROS TO CC-INSURED-JOINT-AGE.
 10436
 10437     IF CC-INSURED-SEX NOT = 'M'  AND
 10438        CC-INSURED-SEX NOT = 'F'
 10439         MOVE SPACES TO CC-INSURED-SEX.
 10440
 10441     IF CC-LOAN-APR NOT NUMERIC  OR
 10442        CC-LOAN-APR = CR-APR
 10443         MOVE ZEROS TO CC-LOAN-APR.
 10444
 10445     IF CC-PAY-FREQUENCY NOT NUMERIC  OR
 10446        CC-PAY-FREQUENCY = CR-PMT-FREQ
 10447         MOVE ZEROS TO CC-PAY-FREQUENCY.
 10448
 10449     IF CC-IND-GRP-TYPE NOT = '1'  AND
 10450        CC-IND-GRP-TYPE NOT = '2'
 10451         MOVE SPACES TO CC-IND-GRP-TYPE.
 10452
 10453     IF CC-CLAIM-DEDUCT-WITHHELD NOT NUMERIC  OR
 10454        CC-CLAIM-DEDUCT-WITHHELD = CR-CLAIM-DEDUCT-WITHHELD
 10455         MOVE ZEROS TO CC-CLAIM-DEDUCT-WITHHELD.
 10456
 10457     IF CC-CANCEL-DEDUCT-WITHHELD NOT NUMERIC  OR
 10458        CC-CANCEL-DEDUCT-WITHHELD = CR-CANCEL-DEDUCT-WITHHELD
 10459         MOVE ZEROS TO CC-CANCEL-DEDUCT-WITHHELD.
 10460
 10461     IF CC-LF-ORIG-TERM NOT NUMERIC  OR
 10462        CC-LF-ORIG-TERM = CR-LF-TERM  OR
 10463        CR-LFTYP = ZEROS
 10464         MOVE ZEROS TO CC-LF-ORIG-TERM.
 10465
 10466     IF CC-AH-ORIG-TERM NOT NUMERIC  OR
 10467        CC-AH-ORIG-TERM = CR-AH-TERM  OR
 10468        CR-AHTYP = ZEROS
 10469         MOVE ZEROS TO CC-AH-ORIG-TERM.
 10470
 10471     IF CR-BILLED NOT NUMERIC
 10472         MOVE ZEROS TO CR-BILLED.
 10473
 10474     IF CR-LIVES NOT NUMERIC
 10475         MOVE ZEROS TO CR-LIVES.
 10476
 10477     IF CC-LIVES NOT NUMERIC  OR
 10478        CC-LIVES = CR-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 205
* ECS010V.cbl
 10479         MOVE ZEROS TO CC-LIVES.
 10480
 10481     IF CC-BILLED NOT NUMERIC  OR
 10482        CC-BILLED = CR-BILLED
 10483         MOVE ZEROS TO CC-BILLED.
 10484
 10485     IF CC-INSURED-LAST-NAME NOT = SPACES
 10486         MOVE CC-INSURED-LAST-NAME   TO CR-LNAME.
 10487     IF CC-INSURED-FIRST-NAME NOT = SPACES
 10488         MOVE CC-INSURED-FIRST-NAME  TO CR-FNAME.
 10489     IF CC-INSURED-INITIAL2 NOT = SPACES
 10490         MOVE CC-INSURED-INITIAL2    TO CR-INIT.
 10491     IF CC-JT-LAST-NAME NOT = SPACES
 10492         MOVE CC-JT-LAST-NAME        TO CR-JT-LNAME.
 10493     IF CC-JT-FIRST-NAME NOT = SPACES
 10494         MOVE CC-JT-FIRST-NAME       TO CR-JT-FNAME.
 10495     IF CC-JT-INITIAL NOT = SPACES
 10496         MOVE CC-JT-INITIAL          TO CR-JT-INIT.
 10497
 10498     IF CC-AGE NOT = ZEROS
 10499         MOVE CC-AGE                 TO CR-AGE
 10500                                        DET-AGE
 10501     ELSE
 10502         MOVE ZEROS                  TO DET-AGE.
 10503
 10504     IF CC-INSURED-JOINT-AGE NOT = ZEROS
 10505         MOVE CC-INSURED-JOINT-AGE   TO CR-JOINT-AGE
 10506                                        DET-JT-AGE
 10507     ELSE
 10508         MOVE ZEROS                  TO DET-JT-AGE.
 10509
 10510     IF CC-INSURED-SEX NOT = SPACES
 10511         MOVE CC-INSURED-SEX         TO CR-SEX
 10512                                        DET-SEX
 10513     ELSE
 10514         MOVE SPACE                  TO DET-SEX.
 10515
 10516     IF CC-MEMBER-NO NOT = SPACES
 10517         MOVE CC-MEMBER-NO           TO CR-MEMBER-NO
 10518                                        DET-PR-MEM
 10519     ELSE
 10520         MOVE SPACES                 TO DET-PR-MEM.
 10521
 10522     IF CC-SOC-SEC-NO NOT = SPACES
 10523         MOVE CC-SOC-SEC-NO          TO CR-SOC-SEC
 10524                                        DET-PR-SS
 10525     ELSE
 10526         MOVE SPACES                 TO DET-PR-SS.
 10527
 10528     IF CC-LOAN-APR NOT = ZEROS
 10529         MOVE CC-LOAN-APR            TO CR-APR
 10530                                        DET-PR-APR
 10531     ELSE
 10532         MOVE ZEROS                  TO DET-PR-APR.
 10533
 10534     IF CC-AGE NOT = ZERO  OR
 10535        CC-INSURED-JOINT-AGE NOT = ZERO  OR
 10536        CC-INSURED-SEX NOT = SPACE  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 206
* ECS010V.cbl
 10537        CC-MEMBER-NO NOT = SPACES  OR
 10538        CC-SOC-SEC-NO NOT = SPACES  OR
 10539        CC-LOAN-APR NOT = ZERO
 10540         MOVE DET-PR-UREC            TO TR-DTL2
 10541         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10542         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10543
 10544     IF CC-LF-ORIG-TERM NOT = ZEROS
 10545         MOVE CR-LF-TERM             TO DET-O-LF-TERM
 10546         MOVE CC-LF-ORIG-TERM        TO CR-LF-TERM
 10547                                        DET-N-LF-TERM
 10548     ELSE
 10549         MOVE ZEROS                  TO DET-O-LF-TERM
 10550                                        DET-N-LF-TERM.
 10551
 10552     IF CC-AH-ORIG-TERM NOT = ZEROS
 10553         MOVE CR-AH-TERM             TO DET-O-AH-TERM
 10554         MOVE CC-AH-ORIG-TERM        TO CR-AH-TERM
 10555                                        DET-N-AH-TERM
 10556     ELSE
 10557         MOVE ZEROS                  TO DET-O-AH-TERM
 10558                                        DET-N-AH-TERM.
 10559
 10560     IF CC-LIVES NOT = ZEROS
 10561         MOVE CR-LIVES               TO DET-O-LIVES
 10562         MOVE CC-LIVES               TO CR-LIVES
 10563                                        DET-N-LIVES
 10564     ELSE
 10565         MOVE ZEROS                  TO DET-O-LIVES
 10566                                        DET-N-LIVES.
 10567
 10568     IF CC-BILLED NOT  = ZEROES
 10569         MOVE CC-BILLED              TO CR-BILLED.
 10570
 10571     IF CC-LF-ORIG-TERM NOT = ZERO  OR
 10572        CC-AH-ORIG-TERM NOT = ZERO  OR
 10573        CC-LIVES NOT = ZERO
 10574         MOVE DET-PR-UREC-2          TO TR-DTL2
 10575         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10576         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10577
 10578     IF CC-IND-GRP-TYPE NOT = SPACES
 10579         MOVE CC-IND-GRP-TYPE        TO CR-IND-GRP
 10580                                        DET-IND-GRP
 10581     ELSE
 10582         MOVE SPACE                  TO DET-IND-GRP.
 10583
 10584     IF CC-PAY-FREQUENCY NOT = ZEROS
 10585         MOVE CC-PAY-FREQUENCY       TO CR-PMT-FREQ
 10586                                        DET-PMT-FREQ
 10587     ELSE
 10588         MOVE ZEROS                  TO DET-PMT-FREQ.
 10589
 10590     IF CC-POLICY-FORM-NO NOT = SPACES
 10591         MOVE CC-POLICY-FORM-NO      TO CR-POLICY-FORM-NO
 10592                                        DET-POL-FORM
 10593     ELSE
 10594         MOVE SPACES                 TO DET-POL-FORM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 207
* ECS010V.cbl
 10595
 10596     IF CC-LOAN-OFFICER NOT = SPACES
 10597         MOVE CC-LOAN-OFFICER        TO CR-LOAN-OFFICER
 10598                                        DET-LOAN-OFFICER
 10599     ELSE
 10600         MOVE SPACES                 TO DET-LOAN-OFFICER.
 10601
 10602     IF CC-USER-FIELD NOT = SPACES
 10603         MOVE CC-USER-FIELD          TO CR-USER-CODE
 10604                                        DET-USER-CODE
 10605     ELSE
 10606         MOVE SPACE                  TO DET-USER-CODE.
 10607
 10608     IF CC-IND-GRP-TYPE NOT = SPACE  OR
 10609        CC-PAY-FREQUENCY NOT = ZEROS  OR
 10610        CC-POLICY-FORM-NO NOT = SPACES  OR
 10611        CC-LOAN-OFFICER NOT = SPACES  OR
 10612        CC-USER-FIELD NOT = SPACES
 10613         MOVE DET-PR-UREC-3          TO TR-DTL2
 10614         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10615         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10616
 10617     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS
 10618         MOVE CC-CLAIM-DEDUCT-WITHHELD
 10619                                     TO CR-CLAIM-DEDUCT-WITHHELD
 10620                                        DET-CLM-DEDUCT
 10621     ELSE
 10622         MOVE ZEROS                  TO DET-CLM-DEDUCT.
 10623
 10624     IF CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10625         MOVE CC-CANCEL-DEDUCT-WITHHELD
 10626                                     TO CR-CANCEL-DEDUCT-WITHHELD
 10627                                        DET-CAN-DEDUCT
 10628     ELSE
 10629         MOVE ZEROS                  TO DET-CAN-DEDUCT.
 10630
 10631     IF CC-CLAIM-DEDUCT-WITHHELD NOT = ZEROS  OR
 10632        CC-CANCEL-DEDUCT-WITHHELD NOT = ZEROS
 10633         MOVE DET-PR-UREC-4          TO TR-DTL2
 10634         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10635         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10636
 10637     IF CC-LF-PREMIUM-AMT NOT NUMERIC
 10638         MOVE ZEROS              TO  CC-LF-PREMIUM-AMT.
 10639
 10640     IF CC-LF-BENEFIT-AMT NOT NUMERIC
 10641         MOVE ZEROS              TO  CC-LF-BENEFIT-AMT.
 10642
 10643     IF CC-AH-PREMIUM-AMT NOT NUMERIC
 10644         MOVE ZEROS              TO  CC-AH-PREMIUM-AMT.
 10645
 10646     IF CC-AH-BENEFIT-AMT NOT NUMERIC
 10647         MOVE ZEROS              TO  CC-AH-BENEFIT-AMT.
 10648
 10649     IF CC-LF-BENEFIT-CD NOT = SPACES
 10650         MOVE CC-LF-BENEFIT-CD   TO  CR-LFTYP
 10651                                     DET-LF-BEN-CD
 10652     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 208
* ECS010V.cbl
 10653         MOVE SPACES             TO DET-LF-BEN-CD.
 10654
 10655     IF CC-LF-PREMIUM-AMT NOT = ZEROS
 10656         MOVE CC-LF-PREMIUM-AMT  TO  CR-LFPRM
 10657                                     DET-LF-PREM
 10658     ELSE
 10659         MOVE ZEROS              TO DET-LF-PREM.
 10660
 10661     IF CC-LF-BENEFIT-AMT NOT = ZEROS
 10662         MOVE CC-LF-BENEFIT-AMT  TO  CR-LFAMT
 10663                                     DET-LF-BEN
 10664     ELSE
 10665         MOVE ZEROS              TO DET-LF-BEN.
 10666
 10667     IF (CC-LF-BENEFIT-CD NOT = SPACES)  OR
 10668        (CC-LF-PREMIUM-AMT NOT = ZEROS)  OR
 10669        (CC-LF-BENEFIT-AMT NOT = ZEROS)
 10670         MOVE DET-PR-UREC-5          TO TR-DTL2
 10671         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10672         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10673
 10674     IF CC-AH-BENEFIT-CD NOT = SPACES
 10675         MOVE CC-AH-BENEFIT-CD   TO  CR-AHTYP
 10676                                     DET-AH-BEN-CD
 10677     ELSE
 10678         MOVE SPACES             TO DET-AH-BEN-CD.
 10679
 10680     IF CC-AH-PREMIUM-AMT NOT = ZEROS
 10681         MOVE CC-AH-PREMIUM-AMT  TO  CR-AHPRM
 10682                                     DET-AH-PREM
 10683     ELSE
 10684         MOVE ZEROS              TO DET-AH-PREM.
 10685
 10686     IF CC-AH-BENEFIT-AMT NOT = ZEROS
 10687         MOVE CC-AH-BENEFIT-AMT  TO  CR-AHAMT
 10688                                     DET-AH-BEN
 10689     ELSE
 10690         MOVE ZEROS              TO DET-AH-BEN.
 10691
 10692     IF CC-AH-BENEFIT-CD NOT = SPACES OR
 10693        CC-AH-PREMIUM-AMT NOT = ZEROS OR
 10694        CC-AH-BENEFIT-AMT NOT = ZEROS
 10695         MOVE DET-PR-UREC-6          TO TR-DTL2
 10696         MOVE 'Y'                    TO WS-CHANGE-REC-SW
 10697         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 10698
 10699 0910-END-CHANGE-PROCESSING.
 10700
 10701     IF CR-LNAME = ALL '*'
 10702         MOVE SPACES                 TO CR-LNAME.
 10703     IF CR-FNAME = ALL '*'
 10704         MOVE SPACES                 TO CR-FNAME.
 10705     IF CR-INIT = '*'
 10706         MOVE SPACES                 TO CR-INIT.
 10707     IF CR-SOC-SEC = ALL '*'
 10708         MOVE SPACES                 TO CR-SOC-SEC.
 10709     IF CR-JT-LNAME = ALL '*'
 10710         MOVE SPACES                 TO CR-JT-LNAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 209
* ECS010V.cbl
 10711     IF CR-JT-FNAME = ALL '*'
 10712         MOVE SPACES                 TO CR-JT-FNAME.
 10713     IF CR-JT-INIT = '*'
 10714         MOVE SPACES                 TO CR-JT-INIT.
 10715     IF CR-POLICY-FORM-NO = ALL '*'
 10716         MOVE SPACES                 TO CR-POLICY-FORM-NO.
 10717     IF CR-MEMBER-NO = ALL '*'
 10718         MOVE SPACES                 TO CR-MEMBER-NO.
 10719     IF CR-LOAN-OFFICER = ALL '*'
 10720         MOVE SPACES                 TO CR-LOAN-OFFICER.
 10721     IF CR-USER-CODE = ALL '*'
 10722         MOVE SPACES                 TO CR-USER-CODE.
 10723
 10724     ADD +1 TO BC-G-CTN.
 10725     GO TO 0300-READ-PENDING-TRANSACTIONS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 210
* ECS010V.cbl
 10727 0920-GET-BANK-FEES.
 10728
 10729     IF CR-CERT-NO = '0008771354 '
 10730        DISPLAY ' MADE IT TO 0920 '
 10731     END-IF
 10732
 10733     MOVE DTE-CLASIC-COMPANY-CD  TO AG-COMPANY-CD
 10734     MOVE CR-CARRIER             TO AG-CARRIER
 10735     MOVE CR-GROUPING            TO AG-GROUPING
 10736     MOVE CR-BANK-NO             TO AG-BANK
 10737     MOVE WS-CR-BIN-DATE         TO AG-EXP-DT
 10738     MOVE 'B'                    TO AG-TYPE
 10739
 10740*    IF WS-PREV-BANK-COMM-KEY = AG-CONTROL-PRIMARY
 10741*       PERFORM 0925-BUILD-WORK-BNK-COMM
 10742*                                THRU 0925-EXIT
 10743*       GO TO 0920-EXIT
 10744*    END-IF
 10745
 10746     START ERAGTC KEY NOT < AG-CONTROL-PRIMARY
 10747
 10748     IF CR-CERT-NO = '0008771354 '
 10749        DISPLAY ' MADE IT AFTER START '
 10750     END-IF
 10751
 10752     .
 10753 0920-READ-ERAGTC.
 10754
 10755     IF ERAGTC-FILE-STATUS = '00'
 10756        READ ERAGTC NEXT RECORD
 10757     IF CR-CERT-NO = '0008771354 '
 10758        DISPLAY ' MADE ONE READ '
 10759     END-IF
 10760
 10761        IF ERAGTC-FILE-STATUS = '00'
 10762           IF (CR-CARRIER         = AG-CARRIER)
 10763              AND (CR-GROUPING    = AG-GROUPING)
 10764              AND (CR-BANK-NO     = AG-BANK)
 10765              IF WS-CR-BIN-DATE  = AG-EXP-DT
 10766                 GO TO 0920-READ-ERAGTC
 10767              ELSE
 10768                 IF (WS-CR-BIN-DATE NOT < AG-EFF-DT)
 10769                    AND (WS-CR-BIN-DATE < AG-EXP-DT)
 10770                    PERFORM 0925-BUILD-WORK-BNK-COMM
 10771                                 THRU 0925-EXIT
 10772                    MOVE AG-CONTROL-PRIMARY
 10773                                 TO WS-PREV-BANK-COMM-KEY
 10774                    GO TO 0920-EXIT
 10775                 END-IF
 10776              END-IF
 10777           END-IF
 10778        END-IF
 10779     END-IF
 10780
 10781     MOVE WS-BANK-INIT           TO WS-BANK-COMMISSIONS
 10782     PERFORM 0925-BUILD-WORK-BNK-COMM
 10783
 10784     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 211
* ECS010V.cbl
 10785 0920-EXIT.
 10786     EXIT.
 10787
 10788 0925-BUILD-WORK-BNK-COMM.
 10789
 10790     IF CR-CERT-NO = '0008771354 '
 10791        DISPLAY ' MADE IT TO 0925 '
 10792     END-IF
 10793
 10794     MOVE +1                     TO IA IB
 10795
 10796     IF (CR-BANK-NO NOT = SPACES AND ZEROS)
 10797        AND (PB-I-BANK-FEE NOT = ZEROS)
 10798        MOVE CR-BANK-NO          TO WS-BNK-AGT (IB)
 10799        MOVE 'B'                 TO WS-BNK-TYPE (IB)
 10800        MOVE PB-I-BANK-FEE       TO WS-BNK-SPP-FEES (IB)
 10801        MOVE ' '                 TO WS-BNK-RECALC (IB)
 10802        ADD +1                   TO IB
 10803     END-IF
 10804     .
 10805 0925-BUILD-CONTINUE.
 10806
 10807     IF CR-CERT-NO = '00087735841'
 10808        DISPLAY ' WS-BNK-AGT ' WS-BNK-AGT (1)
 10809        MOVE WS-BNK-SPP-FEES (1) TO WS-DISP-AMT
 10810        DISPLAY ' WS-BNK-FEE ' WS-DISP-AMT
 10811     END-IF
 10812
 10813     PERFORM VARYING IA FROM +2 BY +1 UNTIL
 10814        (IA > +10)
 10815        OR (IB > +10)
 10816        IF AG-AGT (IA) NOT = SPACES AND ZEROS
 10817           MOVE AG-AGT (IA)      TO WS-BNK-AGT (IB)
 10818           MOVE 'B'              TO WS-BNK-TYPE (IB)
 10819*          MOVE AG-COM-TYP (IA)  TO WS-BNK-TYPE (IB)
 10820           IF AG-SPP-FEES (IA) NOT NUMERIC
 10821              MOVE ZEROS         TO AG-SPP-FEES (IA)
 10822           END-IF
 10823           MOVE AG-SPP-FEES (IA) TO WS-BNK-SPP-FEES (IB)
 10824           MOVE AG-RECALC-LV-INDIC (IA)
 10825                                 TO WS-BNK-RECALC (IB)
 10826        ELSE
 10827           MOVE SPACES           TO WS-BNK-AGT (IB)
 10828                                    WS-BNK-TYPE (IB)
 10829                                    WS-BNK-RECALC (IB)
 10830           MOVE ZEROS            TO WS-BNK-SPP-FEES (IB)
 10831        END-IF
 10832        ADD +1                   TO IB
 10833     END-PERFORM
 10834
 10835     .
 10836 0925-EXIT.
 10837     EXIT.
 10838
 10839 0930-BUILD-CERT-TRLR.
 10840
 10841     MOVE SPACES                 TO CERTIFICATE-TRAILERS
 10842     MOVE 'CS'                   TO CS-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 212
* ECS010V.cbl
 10843     MOVE DTE-CLASIC-COMPANY-CD  TO CS-COMPANY-CD
 10844     MOVE CR-CARRIER             TO CS-CARRIER
 10845     MOVE CR-GROUPING            TO CS-GROUPING
 10846     MOVE CR-STATE               TO CS-STATE
 10847     MOVE CR-ACCOUNT             TO CS-ACCOUNT
 10848     MOVE WS-CR-BIN-DATE         TO CS-CERT-EFF-DT
 10849     MOVE CR-CERT-NO             TO CS-CERT-NO
 10850     MOVE 'A'                    TO CS-TRAILER-TYPE
 10851
 10852     MOVE WS-BANK-COMMISSIONS    TO CS-BANK-COMMISSION-AREA
 10853
 10854     IF CS-AGT (1) NOT = SPACES AND ZEROS
 10855        WRITE CERTIFICATE-TRAILERS
 10856        IF ELCRTT-FILE-STATUS = '00'
 10857           CONTINUE
 10858        ELSE
 10859           IF ELCRTT-FILE-STATUS = '22'
 10860              READ ELCRTT
 10861              IF ELCRTT-FILE-STATUS = '00'
 10862                 MOVE WS-BANK-COMMISSIONS
 10863                                 TO CS-BANK-COMMISSION-AREA
 10864                 REWRITE CERTIFICATE-TRAILERS
 10865                 IF ELCRTT-FILE-STATUS NOT = '00'
 10866                    DISPLAY ' BAD REWRITE ELCRTT '
 10867                                 ELCRTT-FILE-STATUS
 10868                    PERFORM ABEND-PGM
 10869                 END-IF
 10870              ELSE
 10871                 DISPLAY ' BAD READ    ELCRTT '
 10872                                  ELCRTT-FILE-STATUS
 10873                 PERFORM ABEND-PGM
 10874              END-IF
 10875           ELSE
 10876              DISPLAY ' BAD WRITE ELCRTT '
 10877                                 ELCRTT-FILE-STATUS
 10878              PERFORM ABEND-PGM
 10879           END-IF
 10880        END-IF
 10881     END-IF
 10882
 10883     .
 10884 0930-EXIT.
 10885     EXIT.
 10886
 10887******************************************************************
 10888***      S E T   C O M M I S S I O N   S T R U C T U R E       ***
 10889******************************************************************
 10890
 10891 1000-SET-COMMISSION-STRUCTURE.
 10892
 10893     MOVE +1                     TO IA
 10894                                    IB.
 10895
 10896 1100-GET-COMMISSION-LEVEL.
 10897
 10898     MOVE AM-AGT-COMMS (IA)      TO WK-LEVEL.
 10899
 10900     IF WK-AGT = '0000000000' OR SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 213
* ECS010V.cbl
 10901         MOVE +0                 TO WK-L-RT
 10902                                    WK-J-RT
 10903                                    WK-A-RT
 10904         GO TO 1200-SET-COMMISSION-LEVEL.
 10905
 10906 1110-LIFE-COMMISSION.
 10907
 10908     IF CR-LFTYP = ZERO  OR
 10909       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10910         MOVE +0 TO WK-L-RT
 10911                    WK-J-RT
 10912         GO TO 1130-A-H-COMMISSION.
 10913
 10914     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 10915         GO TO 1120-JOINT-LIFE-COMMISSION.
 10916
 10917     IF WK-L-RT NUMERIC
 10918        AND (WK-L-RTX (3:1) NOT = 'L' AND 'M')
 10919         MOVE WK-L-RT                TO WS-COMMISSION
 10920         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10921         MOVE WS-COMMISSION          TO WK-L-RT
 10922         GO TO 1130-A-H-COMMISSION.
 10923
 10924     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10925     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10926     MOVE ZEROS                      TO WS-SUB1.
 10927     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10928
 10929     IF WS-SUB1 = ZEROS
 10930         MOVE WK-L-RTX               TO CTBL-TABLE-CD
 10931     ELSE
 10932         MOVE WK-RATE                TO WK-L-RT
 10933         GO TO 1130-A-H-COMMISSION.
 10934
 10935     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10936
 10937     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10938     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10939     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10940     MOVE WK-RATE                    TO WK-L-RT.
 10941
 10942     GO TO 1130-A-H-COMMISSION.
 10943
 10944 1120-JOINT-LIFE-COMMISSION.
 10945
 10946     IF WK-J-RT NUMERIC
 10947        AND (WK-J-RTX (3:1) NOT = 'L' AND 'M')
 10948         MOVE WK-J-RT                TO WS-COMMISSION
 10949         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10950         MOVE WS-COMMISSION          TO WK-J-RT
 10951         GO TO 1130-A-H-COMMISSION.
 10952
 10953     MOVE LIFE-OVERRIDE-L1           TO CTBL-BEN-TYPE.
 10954     MOVE CR-LFTYP                   TO CTBL-BEN-CODE.
 10955     MOVE ZEROS                      TO WS-SUB1.
 10956     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10957
 10958     IF WS-SUB1 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 214
* ECS010V.cbl
 10959         MOVE WK-J-RTX               TO CTBL-TABLE-CD
 10960     ELSE
 10961         MOVE WK-RATE                TO WK-J-RT
 10962         GO TO 1130-A-H-COMMISSION.
 10963
 10964     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10965
 10966     MOVE CR-LFAMT                   TO COMM-CK-AMT.
 10967     MOVE CR-LF-TERM                 TO WS-COMM-TERM.
 10968     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 10969     MOVE WK-RATE                    TO WK-J-RT.
 10970
 10971 1130-A-H-COMMISSION.
 10972
 10973     IF CR-AHTYP = ZERO  OR
 10974       (CR-ENTRY-STATUS = 'P' OR 'D' OR 'V')
 10975         MOVE +0 TO WK-A-RT
 10976         GO TO 1200-SET-COMMISSION-LEVEL.
 10977
 10978     IF WK-A-RT NUMERIC
 10979        AND (WK-A-RTX (3:1) NOT = 'L' AND 'M')
 10980         MOVE WK-A-RT                TO WS-COMMISSION
 10981         PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10982         MOVE WS-COMMISSION          TO WK-A-RT
 10983         GO TO 1200-SET-COMMISSION-LEVEL.
 10984
 10985     MOVE AH-OVERRIDE-L1             TO CTBL-BEN-TYPE.
 10986     MOVE CR-AHTYP                   TO CTBL-BEN-CODE.
 10987     MOVE ZEROS                      TO WS-SUB1.
 10988     PERFORM 6650-GET-RES-STATE-COMM  THRU 6700-COMM-EXIT
 10989
 10990     IF WS-SUB1 = ZEROS
 10991         MOVE WK-A-RTX               TO CTBL-TABLE-CD
 10992     ELSE
 10993         MOVE WK-RATE                TO WK-A-RT
 10994         GO TO 1200-SET-COMMISSION-LEVEL.
 10995
 10996     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 10997
 10998     COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM.
 10999     MOVE CR-AH-TERM                 TO WS-COMM-TERM.
 11000     PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X.
 11001     MOVE WK-RATE                    TO WK-A-RT.
 11002
 11003 1200-SET-COMMISSION-LEVEL.
 11004
 11005     MOVE WK-AGT                      TO WK-N-AGT  (IA).
 11006     IF WK-AGT = '0000000000' OR SPACES
 11007         MOVE SPACE                   TO WK-N-TYPE (IA)
 11008     ELSE
 11009         MOVE WK-A-TYPE               TO WK-N-TYPE (IA).
 11010
 11011     IF CR-LFTYP = ZERO
 11012         MOVE +0                      TO WK-L-RT1  (IA)
 11013     ELSE
 11014         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
 11015             MOVE WK-J-RT             TO WK-L-RT1 (IA)
 11016         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 215
* ECS010V.cbl
 11017             MOVE WK-L-RT             TO WK-L-RT1 (IA).
 11018
 11019     MOVE WK-A-RT                     TO WK-A-RT1 (IA).
 11020
 11021     IF RC-COMM-FLG = 'X'
 11022        IF (AM-RECALC-LV-INDIC (IA) = 'N')
 11023*          OR ((CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11024*             AND (IA = +5))
 11025            MOVE CR-COM-AGT  (IA)         TO WK-N-AGT  (IA)
 11026            MOVE CR-AGT-TYPE (IA)         TO WK-N-TYPE (IA)
 11027            MOVE CR-LCOM-L   (IA)         TO WK-L-RT1  (IA)
 11028            MOVE CR-LCOM-AH  (IA)         TO WK-A-RT1  (IA).
 11029
 11030     IF IA LESS THAN +10
 11031         ADD +1 TO IA
 11032         GO TO 1100-GET-COMMISSION-LEVEL.
 11033
 11034     GO TO 1499-SET-COMM-X.
 11035
 11036 1300-READ-ERCTBL-FILE.
 11037
 11038     IF CTBL-SEARCH = LAST-CTBL
 11039         GO TO 1399-READ-ERCTBL-X.
 11040
 11041     MOVE SPACE                          TO CTBL-ERROR-SWITCH.
 11042
 11043     IF COMM-OPEN-SW = ' '
 11044         MOVE 'X'                        TO COMM-OPEN-SW
 11045         MOVE DTE-CLASIC-COMPANY-CD      TO CTBL-COMP-CD
 11046         OPEN INPUT ERCTBL
 11047         IF ERCTBL-FILE-STATUS = '00'  OR  '97'
 11048             NEXT SENTENCE
 11049            ELSE
 11050             MOVE '41'                   TO ABEND-CODE-1
 11051             MOVE ERCTBL-FILE-STATUS     TO ABEND-CODE-2
 11052             DISPLAY '******************************'
 11053             DISPLAY '***** ERROR LOCATION 012 *****'
 11054             DISPLAY '******************************'
 11055             DISPLAY '******************************'
 11056             MOVE WS-ABEND-CODE          TO WS-RETURN-CODE
 11057             GO TO ABEND-PGM.
 11058
 11059     MOVE CTBL-SEARCH                    TO CT-CONTROL-PRIMARY
 11060                                            LAST-CTBL.
 11061     READ ERCTBL.
 11062
 11063     IF ERCTBL-FILE-STATUS = '23'
 11064         DISPLAY 'INVALID COMM TABLE CODE FOR: ' CR-FULL-CONTROL
 11065                 ' ENTERED: ' CR-ENTRY-STATUS '-' CR-ENTRY-DATE
 11066                 ' CTBL: ' CTBL-SEARCH
 11067         MOVE '*'                TO CTBL-ERROR-SWITCH
 11068         MOVE '44'               TO ABEND-CODE-1
 11069         MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11070         DISPLAY 'CT-CONTROL-PRIMARY = ' CT-CONTROL-PRIMARY
 11071         DISPLAY '******************************'
 11072         DISPLAY '***** ERROR LOCATION 013 *****'
 11073         DISPLAY '******************************'
 11074         MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 216
* ECS010V.cbl
 11075*        IF DTE-CLIENT NOT = 'NCL'
 11076         IF DTE-CLIENT NOT = 'NCL' AND 'CID' AND 'CSO'
 11077             GO TO ABEND-PGM
 11078         ELSE
 11079             NEXT SENTENCE
 11080     ELSE
 11081         IF ERCTBL-FILE-STATUS NOT = '00'
 11082             MOVE 'READ ERROR ON ERCTBL' TO WS-ABEND-MESSAGE
 11083             MOVE '44'               TO ABEND-CODE-1
 11084             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 11085             DISPLAY '******************************'
 11086             DISPLAY '***** ERROR LOCATION 014 *****'
 11087             DISPLAY '******************************'
 11088             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 11089             GO TO ABEND-PGM.
 11090
 11091     ADD +1                            TO ERCTBL-READS.
 11092
 11093 1399-READ-ERCTBL-X.
 11094     EXIT.
 11095
 11096 1400-GET-COMM-PERCENT.
 11097
 11098     IF CTBL-ERROR
 11099         MOVE ZEROS                      TO WK-RATE
 11100         GO TO 1489-GET-PERCENT-X.
 11101
 11102     MOVE +1 TO IB.
 11103     IF (COMM-CK-AMT GREATER CT-TBF (1)) AND
 11104        (CT-TBF (1) NOT EQUAL +9999999.99)
 11105         ADD +9 TO IB
 11106         IF (COMM-CK-AMT GREATER CT-TBF (2)) AND
 11107            (CT-TBF (2) NOT EQUAL +9999999.99)
 11108             ADD +9 TO IB.
 11109
 11110     IF CR-AGE GREATER CT-AGE (1)
 11111         ADD +3 TO IB
 11112         IF CR-AGE GREATER CT-AGE (2)
 11113             ADD +3 TO IB.
 11114
 11115     IF WS-COMM-TERM GREATER CT-TRM (1)
 11116         ADD +1 TO IB
 11117         IF WS-COMM-TERM GREATER CT-TRM (2)
 11118             ADD +1 TO IB.
 11119
 11120     IF CT-RT (IB) NOT NUMERIC
 11121         MOVE LAST-CTBL     TO CT-CONTROL-PRIMARY
 11122         MOVE CT-RT-R (IB)  TO CTBL-TABLE-CD
 11123         GO TO 1300-READ-ERCTBL-FILE.
 11124
 11125     MOVE CT-RT (IB) TO WK-RATE.
 11126
 11127 1489-GET-PERCENT-X.
 11128     EXIT.
 11129
 11130 1499-SET-COMM-X.
 11131     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 217
* ECS010V.cbl
 11133******************************************************************
 11134***  C O M P U T E   A C C T   L E V E L   C O M M I S S I O N ***
 11135******************************************************************
 11136
 11137 1500-GET-ACCT-LEVEL-LF-COMM.
 11138
 11139     MOVE ZEROS                      TO ACCT-COMM-LF
 11140                                        ACCT-COMM-AH.
 11141
 11142     MOVE +1                         TO IA.
 11143
 11144 1510-ACCT-LEVEL-LOOP.
 11145
 11146     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11147         IF WS-LEVELS-CHARGEBACK-SWITCHES = SPACES
 11148             ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF
 11149             ADD CR-LCOM-AH (IA) TO ACCT-COMM-AH
 11150         ELSE
 11151             IF WS-LF-CHARGEBACK-SW (IA)  =  'Y'
 11152                 ADD CR-LCOM-L (IA)  TO ACCT-COMM-LF.
 11153
 11154     IF IA LESS THAN +10
 11155         ADD +1 TO IA
 11156         GO TO 1510-ACCT-LEVEL-LOOP.
 11157
 11158 1519-ACCT-LF-COMM-X.
 11159     EXIT.
 11160
 11161
 11162 1550-GET-ACCT-LEVEL-AH-COMM.
 11163
 11164     MOVE ZEROS                      TO ACCT-COMM-AH.
 11165
 11166     MOVE +1                         TO IA.
 11167
 11168 1555-ACCT-LEVEL-LOOP.
 11169
 11170     IF CR-AGT-TYPE (IA) = 'C'  OR  'D' OR 'F' OR 'S'
 11171         IF WS-AH-CHARGEBACK-SW (IA)  =  'Y'
 11172             ADD CR-LCOM-AH (IA)  TO ACCT-COMM-AH.
 11173
 11174     IF IA LESS THAN +10
 11175         ADD +1 TO IA
 11176         GO TO 1555-ACCT-LEVEL-LOOP.
 11177
 11178 1599-ACCT-AH-COMM-X.
 11179     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 218
* ECS010V.cbl
 11181******************************************************************
 11182***      C O M M I S S I O N   R E C A L C   R O U T I N E     ***
 11183******************************************************************
 11184
 11185 1600-RECALC-COMM-EXTR.
 11186
 11187     IF RC-COMM-FLG = 'X'  OR
 11188        (DTE-PGM-OPT = '2'  OR  '3')  OR
 11189        CR-POLICY-IS-DECLINED  OR
 11190        CR-POLICY-IS-VOID
 11191         GO TO 1899-RECALC-COMM-EXTR-X.
 11192
 11193     MOVE 'X'                           TO RC-COMM-FLG.
 11194
 11195     IF CR-ENTRY-DATE = EOM-RUN-DATE
 11196         GO TO 1899-RECALC-COMM-EXTR-X.
 11197
 11198     PERFORM 1000-SET-COMMISSION-STRUCTURE THRU 1499-SET-COMM-X.
 11199
 11200     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11201         GO TO 1899-RECALC-COMM-EXTR-X.
 11202
 11203     MOVE WK-NEW-RATES                  TO SAVE-WK-NEW-RATES.
 11204
 11205     PERFORM 1610-CK-DUPLICATE-ENTRIES
 11206         THRU 1619-CK-DUPLICATE-ENTRIES-XIT
 11207             VARYING SUB11 FROM 1 BY 1 UNTIL SUB11 GREATER 10.
 11208
 11209     IF CR-COMPENSATION-LEVELS = WK-NEW-RATES
 11210         MOVE SAVE-WK-NEW-RATES         TO CR-COMPENSATION-LEVELS
 11211                                           WK-NEW-RATES
 11212         GO TO 1899-RECALC-COMM-EXTR-X.
 11213
 11214     MOVE +1                            TO SUB8.
 11215     GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11216
 11217 1610-CK-DUPLICATE-ENTRIES.
 11218     PERFORM 1620-CK-DUPL-ENTR-NEW
 11219         THRU 1629-CK-DUPL-ENTR-NEW-XIT
 11220             VARYING SUB12 FROM 1 BY 1 UNTIL SUB12 GREATER 10.
 11221
 11222 1619-CK-DUPLICATE-ENTRIES-XIT.
 11223     EXIT.
 11224
 11225 1620-CK-DUPL-ENTR-NEW.
 11226     IF CR-AGT-LEVELS (SUB11) = WK-N-R (SUB12)
 11227         MOVE SPACES                    TO CR-COM-AGT (SUB11)
 11228         MOVE SPACE                     TO CR-AGT-TYPE (SUB11)
 11229         MOVE +0                        TO CR-LCOM-L (SUB11)
 11230                                           CR-LCOM-AH (SUB11)
 11231         MOVE CR-AGT-LEVELS (SUB11)     TO WK-N-R (SUB12)
 11232         MOVE 11                        TO SUB12.
 11233
 11234 1629-CK-DUPL-ENTR-NEW-XIT.
 11235     EXIT.
 11236
 11237 1700-REVERSE-OLD-COMM-LOOP.
 11238     COMPUTE CR-LCOM-L (SUB8) = CR-LCOM-L (SUB8) * -1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 219
* ECS010V.cbl
 11239     COMPUTE CR-LCOM-AH (SUB8) = CR-LCOM-AH (SUB8) * -1.
 11240
 11241     IF SUB8 LESS THAN +10
 11242         ADD +1 TO SUB8
 11243         GO TO 1700-REVERSE-OLD-COMM-LOOP.
 11244
 11245     MOVE 'O' TO RECALC-TYPE.
 11246
 11247     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11248
 11249     GO TO 1800-MOVE-NEW-COMM-RATES.
 11250
 11251 1710-DO-R-C-EXTRACTS.
 11252
 11253     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11254
 11255     PERFORM 1720-CHECK-COMM-LEVELS
 11256         THRU 1729-CHECK-COMM-LEVELS-EXIT
 11257             VARYING SUB13 FROM +1 BY +1
 11258                 UNTIL SUB13 GREATER THAN 10.
 11259
 11260     MOVE '8'                           TO DE-TRANS.
 11261     MOVE RECALC-TYPE                   TO DE-RECALC-TYPE.
 11262*****PERFORM EXTRACT-DATE-RELOAD.
 11263     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11264     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11265     MOVE SAVE-EXTRACT                  TO DETAIL-EXTRACT.
 11266     PERFORM EXTRACT-DATE-LOAD.
 11267     MOVE 'R'                           TO DE-REIN.
 11268     MOVE DETAIL-EXTRACT                TO SAVE-EXTRACT.
 11269     MOVE +1                            TO SUB1.
 11270     PERFORM 3110-REINSURE-ISSUE-LOOP
 11271         THRU 3119-REINSURE-ISSUE-LOOP-END.
 11272
 11273     IF CR-LF-CANCEL-APPLIED  OR  CR-AH-CANCEL-APPLIED
 11274         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 11275                                       2259-END-CANCEL-BUILD
 11276         PERFORM 1720-CHECK-COMM-LEVELS
 11277             THRU 1729-CHECK-COMM-LEVELS-EXIT
 11278                 VARYING SUB13 FROM +1 BY +1
 11279                     UNTIL SUB13 GREATER THAN 10
 11280         MOVE '7'                       TO DE-TRANS
 11281         MOVE RECALC-TYPE               TO DE-RECALC-TYPE
 11282*********PERFORM EXTRACT-DATE-RELOAD
 11283         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11284         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X
 11285         MOVE SAVE-EXTRACT              TO DETAIL-EXTRACT
 11286         PERFORM EXTRACT-DATE-LOAD
 11287         MOVE 'R'                       TO DE-REIN
 11288         MOVE DETAIL-EXTRACT            TO SAVE-EXTRACT
 11289         MOVE +1                        TO SUB1
 11290         PERFORM 3210-REINSURE-CANCEL-LOOP
 11291             THRU 3219-REINSURE-CANCEL-LOOP-END.
 11292
 11293 1719-DO-R-C-EXTRACTS-X.
 11294     EXIT.
 11295
 11296 1720-CHECK-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 220
* ECS010V.cbl
 11297
 11298     IF  DE-AGT (SUB13)       =  SPACES  AND
 11299         DE-AGT-TYPE (SUB13)  =  SPACES  AND
 11300         DE-L-PC (SUB13)      =  ZEROS   AND
 11301         DE-A-PC (SUB13)      =  ZEROS
 11302         MOVE '0000000000'        TO  DE-AGT (SUB13).
 11303
 11304 1729-CHECK-COMM-LEVELS-EXIT.
 11305     EXIT.
 11306
 11307 1800-MOVE-NEW-COMM-RATES.
 11308     MOVE WK-NEW-RATES                  TO CR-COMPENSATION-LEVELS.
 11309     MOVE 'N'                           TO RECALC-TYPE.
 11310     PERFORM 1710-DO-R-C-EXTRACTS THRU 1719-DO-R-C-EXTRACTS-X.
 11311     MOVE SAVE-WK-NEW-RATES             TO WK-NEW-RATES
 11312                                           CR-COMPENSATION-LEVELS.
 11313     IF DTE-CLIENT = 'DCC'
 11314        IF CR-LF-NSP-PRM NOT = ZEROS
 11315           COMPUTE CR-LF-NSP-PRM ROUNDED =
 11316              (CR-LFPRM + CR-LFPRM-ALT) -
 11317              ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 11318        END-IF
 11319        IF (CR-AH-NSP-PRM NOT = ZEROS)
 11320           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 11321                                        NOT = 'G' AND 'L')
 11322           COMPUTE CR-AH-NSP-PRM ROUNDED =
 11323           CR-AHPRM -
 11324           (CR-AHPRM * CR-LCOM-AH (1))
 11325        END-IF
 11326     END-IF
 11327     .
 11328
 11329 1899-RECALC-COMM-EXTR-X.
 11330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 221
* ECS010V.cbl
 11332******************************************************************
 11333***      I N I T I A L I Z E   D E T A I L   E X T R A C T     ***
 11334******************************************************************
 11335
 11336 2000-INITIALIZE-DETAIL-EXTRACT.
 11337
 11338     MOVE SPACES                   TO DETAIL-EXTRACT.
 11339
 11340     MOVE 'DE'                     TO DE-RECORD-ID.
 11341     MOVE CR-COMPANY-CD            TO DE-COMPANY-CD.
 11342     MOVE CR-FULL-CONTROL          TO DE-CONTROL.
 11343
 11344     MOVE AM-REPORT-CODE-1         TO DE-REPORT-CODE-1.
 11345     MOVE AM-REPORT-CODE-2         TO DE-REPORT-CODE-2.
 11346
 11347     MOVE CR-NAME                  TO DE-NAME.
 11348     MOVE CR-AGE                   TO DE-AGE.
 11349     MOVE CR-SEX                   TO DE-SEX.
 11350     MOVE CR-SOC-SEC               TO DE-SOC-SEC-NO.
 11351
 11352     MOVE CR-LFTYP                 TO DE-LF-TYPE.
 11353     MOVE CR-LF-TERM               TO DE-LF-TERM.
 11354     MOVE CR-LFAMT                 TO DE-LF-BEN.
 11355     MOVE ZEROS                    TO DE-LF-CNBEN.
 11356     MOVE CR-LFPRM                 TO DE-LF-PRM.
 11357     MOVE CR-LFAMT-ALT             TO DE-LF-BEN-ALT.
 11358     MOVE ZEROS                    TO DE-LF-CNBEN-ALT.
 11359     MOVE CR-LFPRM-ALT             TO DE-LF-PRM-ALT.
 11360     MOVE ZEROS                    TO DE-LF-RFND.
 11361
 11362     MOVE CR-LF-CURRENT-STATUS     TO DE-LF-STAT-CDE.
 11363     MOVE ZEROS                    TO DE-LF-CANC-DTE
 11364                                      DE-LF-CANC-EXIT-DT.
 11365
 11366     MOVE CR-AHTYP                 TO DE-AH-TYPE.
 11367     MOVE CR-AH-TERM               TO DE-AH-TERM.
 11368     MOVE CR-AHAMT                 TO DE-AH-BEN.
 11369     MOVE CR-AHPRM                 TO DE-AH-PRM.
 11370     MOVE ZEROS                    TO DE-AH-RFND.
 11371
 11372     MOVE CR-AH-CURRENT-STATUS     TO DE-AH-STAT-CDE.
 11373     MOVE ZEROS                    TO DE-AH-CANC-DTE
 11374                                      DE-AH-CANC-EXIT-DT.
 11375     MOVE CR-MOB-NET-TOT-FEES      TO DE-MOB-NET-TOT-FEES.
 11376
 11377     IF DTE-CLIENT = 'DCC'
 11378        MOVE CR-ADDL-CLP         TO DE-ADDL-CLP
 11379        MOVE CR-CLP-STATE        TO DE-CLP-STATE
 11380     ELSE
 11381        IF (CR-LFTYP NOT = ZERO   AND
 11382           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z')  OR
 11383           (CR-AHTYP NOT = ZERO  AND
 11384           CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z')
 11385           MOVE CR-LIVES           TO DE-LIVES
 11386           MOVE ZERO               TO DE-CANCEL-CNT-ITD
 11387                                      DE-CANCEL-CNT-YTD
 11388        END-IF
 11389     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 222
* ECS010V.cbl
 11390
 11391     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11392     IF AM-ZIP-PRIME NUMERIC
 11393        MOVE AM-ZIP-PRIME          TO DE-ZIP
 11394      ELSE
 11395        MOVE ZEROS                 TO DE-ZIP.
 11396     MOVE CR-LOAN-OFFICER          TO DE-LN-OFFICER.
 11397
 11398     MOVE CR-APR                   TO DE-APR.
 11399     MOVE CR-PMT-FREQ              TO DE-PMT-FREQ.
 11400     MOVE CR-GRPTYP                TO DE-ACC-GPCD.
 11401     MOVE CR-IND-GRP               TO DE-IG.
 11402     MOVE AM-REMIT-TO              TO DE-REMIT-TO.
 11403     MOVE CR-MEMBER-NO             TO DE-MEMBER-NO.
 11404
 11405     MOVE CR-ENTRY-STATUS          TO DE-ENTRY-STATUS.
 11406     MOVE CR-ENTRY-DATE            TO DE-ENTRY-DTE.
 11407     MOVE CR-UNDERWRITING-CODE     TO DE-UNDERWRITING-CODE.
 11408
 11409     IF (CR-ENTRY-BATCH (1:2) = 'VA')
 11410        OR (CR-LF-EXIT-BATCH (1:2) = 'VA')
 11411        OR (CR-AH-EXIT-BATCH (1:2) = 'VA')
 11412        MOVE 'VA '                 TO DE-NCL-POOL-CODE
 11413     END-IF
 11414
 11415*    MOVE AM-POOL-PRIME            TO DE-NCL-POOL-CODE.
 11416
 11417     MOVE ZEROS                    TO DE-REI-LFAMT  DE-REI-LFPRM
 11418                                      DE-REI-AHAMT  DE-REI-AHPRM
 11419                                      DE-REI-LFRFND DE-REI-AHRFND
 11420                                      DE-REI-CNAMT.
 11421
 11422     MOVE +1                       TO SUB1.
 11423
 11424     PERFORM EXTRACT-DATE-LOAD.
 11425
 11426     MOVE ZEROS                    TO WS-DE-PROC-DT-N
 11427                                      WS-DE-INCUR-N
 11428                                      WS-DE-PAY-N
 11429                                      WS-DE-PAID-TO-N
 11430                                      WS-DE-ACC-EXP-DTE-N
 11431                                      WS-DE-ACC-EFF-DTE-N
 11432                                      WS-DE-RSV-INCUR-N
 11433                                      WS-DE-RSV-PAYTO-N
 11434                                      WS-DE-ACC-EXP-DTE-RSV-N
 11435                                      WS-DE-ACC-EFF-DTE-RSV-N.
 11436
 11437 2090-GL-CODE-LOOP.
 11438
 11439     MOVE AM-GL-CODES (SUB1)       TO DE-GL-CODES (SUB1).
 11440
 11441     IF SUB1 LESS THAN +10
 11442         ADD +1 TO SUB1
 11443         GO TO 2090-GL-CODE-LOOP.
 11444
 11445     MOVE AM-RECALC-COMM           TO DE-RECALC-CODE.
 11446
 11447     MOVE CR-COMPENSATION-LEVELS   TO DE-COMM-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 223
* ECS010V.cbl
 11448
 11449     IF (DTE-CLIENT = 'DCC')
 11450        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 11451        AND (RECALC-TYPE = SPACES)
 11452        MOVE +1                  TO IA
 11453        IF CR-CERT-NO = '0008773536 '
 11454           DISPLAY ' MADE IT TO 2000 '
 11455           DISPLAY ' CERT AREA  REIN ' DE-REIN
 11456           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11457              (IB > +10)
 11458              IF CR-COM-AGT (IB) NOT = SPACES AND ZEROS
 11459                 MOVE IB TO DIL-BEN-CODE
 11460                 MOVE CR-LCOM-AH (IB) TO DIL-AMOUNT
 11461                 MOVE CR-COM-AGT (IB) TO DIL-COMMENT
 11462                 DISPLAY DISPLAY-IBNR-LINE
 11463              END-IF
 11464           END-PERFORM
 11465           DISPLAY ' TRLR AREA  '
 11466           DISPLAY ' CS CERT NO ' CS-CERT-NO
 11467           PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11468              (IB > +10)
 11469              IF WS-BNK-AGT (IB) NOT = SPACES AND ZEROS
 11470                 MOVE IB TO DIL-BEN-CODE
 11471                 MOVE WS-BNK-SPP-FEES (IB) TO DIL-AMOUNT
 11472                 MOVE WS-BNK-AGT (IB) TO DIL-COMMENT
 11473                 DISPLAY DISPLAY-IBNR-LINE
 11474              END-IF
 11475           END-PERFORM
 11476        END-IF
 11477        PERFORM VARYING IB FROM +1 BY +1 UNTIL
 11478           IB > +10
 11479           IF DE-AGT (IB) NOT = SPACES AND ZEROS
 11480              CONTINUE
 11481           ELSE
 11482              IF WS-BNK-AGT (IA) NOT = SPACES AND ZEROS
 11483                 MOVE WS-BNK-AGT (IA)  TO DE-AGT (IB)
 11484                 MOVE WS-BNK-TYPE (IA) TO DE-AGT-TYPE (IB)
 11485                 COMPUTE DE-A-PC (IB) =
 11486                        WS-BNK-SPP-FEES (IA) / +1000
 11487                 MOVE +0              TO DE-L-PC (IB)
 11488                 ADD +1               TO IA
 11489              END-IF
 11490*             IF CS-AGT (IA) NOT = SPACES AND ZEROS
 11491*                MOVE CS-AGT (IA)     TO DE-AGT (IB)
 11492*                MOVE CS-COM-TYP (IA) TO DE-AGT-TYPE (IB)
 11493*                COMPUTE DE-A-PC (IB) = CS-SPP-FEES (IA) / +1000
 11494*                MOVE +0              TO DE-L-PC (IB)
 11495*                ADD +1               TO IA
 11496*             END-IF
 11497           END-IF
 11498        END-PERFORM
 11499     END-IF
 11500
 11501
 11502
 11503     .
 11504 2099-INIT-DTL-X.
 11505     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 224
* ECS010V.cbl
 11506
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 225
* ECS010V.cbl
 11508******************************************************************
 11509***            B U I L D   I S S U E   E X T R A C T           ***
 11510******************************************************************
 11511
 11512 2100-BUILD-ISSUE-EXTRACT.
 11513
 11514     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11515
 11516     MOVE 'I'                      TO DE-TRANS.
 11517
 11518     IF CHECK-BILLED
 11519         MOVE 'N' TO BILLED-SWITCH
 11520     ELSE
 11521         GO TO 2190-WRITE-ISSUE-EXTRACT.
 11522
 11523     MOVE +1                        TO SUB1.
 11524 2150-GA-BILL-LOOP.
 11525
 11526     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11527         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11528
 11529     IF SUB1 LESS THAN +5
 11530         ADD +1 TO SUB1
 11531         GO TO 2150-GA-BILL-LOOP.
 11532
 11533     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11534     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11535                                       DE-BILLED-LFRFND
 11536                                       DE-BILLED-AHPRM
 11537                                       DE-BILLED-AHRFND.
 11538
 11539     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11540         IF PB-LF-BILLED-AMTS = ZERO  AND
 11541            PB-AH-BILLED-AMTS = ZERO
 11542             MOVE ' '                    TO DE-BILL-STATUS
 11543         ELSE
 11544             IF PB-LF-BILLED-AMTS = PB-I-LF-PREMIUM-AMT  AND
 11545                PB-AH-BILLED-AMTS = PB-I-AH-PREMIUM-AMT
 11546                 MOVE 'B'                TO DE-BILL-STATUS
 11547             ELSE
 11548                 MOVE 'R'                TO DE-BILL-STATUS
 11549                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFPRM
 11550                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHPRM
 11551     ELSE
 11552         MOVE 'B'                        TO DE-BILL-STATUS.
 11553
 11554 2190-WRITE-ISSUE-EXTRACT.
 11555
 11556     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11557
 11558 2199-BLD-ISSUE-X.
 11559     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 226
* ECS010V.cbl
 11561******************************************************************
 11562***           B U I L D   C A N C E L   E X T R A C T          ***
 11563******************************************************************
 11564
 11565 2200-BUILD-CANCEL-EXTRACT.
 11566
 11567     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11568
 11569     MOVE 'C'                           TO DE-TRANS.
 11570
 11571     IF CR-LFTYP = ZERO
 11572         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11573
 11574     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 11575         IF (CR-LF-STATUS-AT-CANCEL = ' ' OR '7')  AND
 11576             CR-LFRFND = +0
 11577              MOVE +0                   TO TEMP-5
 11578              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11579
 11580     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11581          IF CR-LFRFND = +0
 11582              GO TO 2250-CONTINUE-CANCEL-BUILD.
 11583
 11584     MOVE +1 TO TEMP-5.
 11585     MOVE CR-LF-TERM             TO ORIG-TERM.
 11586     MOVE CR-LF-CANC-DT          TO VALUATION-DT.
 11587     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 11588     MOVE '1'                    TO W-VAL-SOURCE.
 11589     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 11590
 11591     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11592         MOVE CR-LFAMT TO DE-LF-CNBEN
 11593         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11594
 11595     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11596         GO TO 2220-BLD-DE-CANCEL-SUM.
 11597
 11598     IF REM-TRM3 = CR-LF-TERM
 11599         MOVE CR-LFAMT TO DE-LF-CNBEN
 11600         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11601
 11602     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 11603         GO TO 2210-BLD-DE-CANCEL-TEX.
 11604
 11605     IF DTE-CLIENT = 'NCL'
 11606         IF CR-DT LESS THAN 19910101
 11607             GO TO 2205-BLD-DE-CANCEL-BEN.
 11608
 11609     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 11610         GO TO 2230-BLD-DE-CANCEL-NP.
 11611
 11612     IF DTE-CLIENT = 'FUL'
 11613         GO TO 2240-BLD-DE-CANCEL-FUL.
 11614
 11615*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 11616     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 11617        (CR-RATING-CLASS NOT = 'L ')
 11618         IF (CR-APR GREATER THAN ZERO)  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 227
* ECS010V.cbl
 11619            (CR-LF-TERM GREATER THAN 060)  AND
 11620            (CR-DT GREATER THAN 19831031)
 11621              GO TO 2230-BLD-DE-CANCEL-NP.
 11622
 11623     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 11624         IF (CR-APR GREATER THAN ZERO)  AND
 11625            (CR-LF-TERM GREATER THAN 061)  AND
 11626            (CR-DT GREATER THAN 19830318)
 11627              GO TO 2230-BLD-DE-CANCEL-NP.
 11628
 11629     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 11630         IF (CR-APR GREATER THAN ZERO)  AND
 11631            (CR-LF-TERM GREATER THAN 062)  AND
 11632            (CR-DT GREATER THAN 19810831)  AND
 11633            (CR-DT LESS THAN 19830901)
 11634              GO TO 2230-BLD-DE-CANCEL-NP.
 11635
 11636     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 11637         IF (CR-APR GREATER THAN ZERO)  AND
 11638            (CR-LF-TERM GREATER THAN 060)  AND
 11639            (CR-DT GREATER THAN 19831231)
 11640              GO TO 2230-BLD-DE-CANCEL-NP.
 11641
 11642 2205-BLD-DE-CANCEL-BEN.
 11643
 11644     IF CR-LF-TERM EQUAL +0
 11645         MOVE +0          TO TEMP-5
 11646     ELSE
 11647         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM.
 11648
 11649     COMPUTE DE-LF-CNBEN = CR-LFAMT * TEMP-5.
 11650
 11651     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11652
 11653 2210-BLD-DE-CANCEL-TEX.
 11654
 11655     DIVIDE CR-LFAMT BY CR-LF-TERM
 11656         GIVING TEX-FACT-1.
 11657     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 11658         GIVING TEX-FACT-2
 11659             REMAINDER TEX-FACT-3.
 11660     IF TEX-FACT-3 NOT = ZERO
 11661         ADD +1 TO TEX-FACT-2.
 11662     COMPUTE DE-LF-CNBEN =
 11663         (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 11664
 11665     IF CR-LFAMT EQUAL +0
 11666         MOVE +0                  TO TEMP-5
 11667     ELSE
 11668         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11669
 11670     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11671
 11672 2220-BLD-DE-CANCEL-SUM.
 11673
 11674     MOVE CR-SUM-CAN-CNT-YTD      TO DE-CANCEL-CNT-YTD.
 11675     MOVE CR-SUM-CAN-CNT-ITD      TO DE-CANCEL-CNT-ITD.
 11676
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 228
* ECS010V.cbl
 11677     IF CR-LFRFND NOT LESS CR-LFPRM
 11678         MOVE CR-LFAMT           TO DE-LF-CNBEN
 11679          GO TO 2250-CONTINUE-CANCEL-BUILD.
 11680
 11681     COMPUTE TEMP-6 ROUNDED = CR-LFRFND / CR-LFPRM.
 11682     COMPUTE TEMP-7 ROUNDED = TEMP-6 * CR-LFAMT.
 11683     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 11684         MOVE TEMP-7             TO DE-LF-CNBEN
 11685       ELSE
 11686         COMPUTE TEMP-5 = REM-TRM3 / CR-LF-TERM
 11687         COMPUTE DE-LF-CNBEN = TEMP-7 * TEMP-5.
 11688
 11689     IF CR-LFAMT EQUAL +0
 11690         MOVE +0                  TO TEMP-5
 11691     ELSE
 11692         COMPUTE TEMP-5 ROUNDED =  DE-LF-CNBEN / CR-LFAMT.
 11693
 11694     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 11695         GO TO 2250-CONTINUE-CANCEL-BUILD.
 11696
 11697 2230-BLD-DE-CANCEL-NP.
 11698
 11699     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 11700     MOVE 'L'                        TO  DC-OPTION-CODE.
 11701     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 11702     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 11703
 11704     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
 11705       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 11706       MOVE '3'                      TO  DC-OPTION-CODE
 11707       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11708       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 11709     ELSE
 11710       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 11711       MOVE '6'                      TO  DC-OPTION-CODE
 11712       MOVE +1                       TO  DC-ELAPSED-MONTHS
 11713       MOVE +0                       TO  DC-ELAPSED-DAYS
 11714       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 11715       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 11716
 11717     MOVE CR-RATING-CLASS            TO  CP-CLASS-CODE
 11718     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 11719     MOVE CR-APR                     TO  CP-LOAN-APR.
 11720     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 11721     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 11722     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 11723     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 11724     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 11725     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 11726
 11727     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 11728
 11729     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 11730         COMPUTE DE-LF-CNBEN =
 11731                 CP-REMAMT-FACTOR * (TEMP-7 / +1000)
 11732      ELSE
 11733          COMPUTE DE-LF-CNBEN =
 11734                  CP-REMAMT-FACTOR * (CR-LFAMT / +1000).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 229
* ECS010V.cbl
 11735
 11736     IF CR-LFAMT EQUAL +0
 11737         MOVE +0                  TO TEMP-5
 11738     ELSE
 11739         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11740
 11741     GO TO 2250-CONTINUE-CANCEL-BUILD.
 11742
 11743 2240-BLD-DE-CANCEL-FUL.
 11744
 11745     MOVE CR-APR                  TO NP-APR.
 11746     MOVE CR-LF-TERM              TO NP-ORIG.
 11747     MOVE REM-TRM3                TO NP-REM.
 11748     MOVE '2'                     TO NP-OPT.
 11749     MOVE CR-AHPRM                TO NP-AHPRM.
 11750     MOVE CR-ACCOUNT              TO NP-ACCOUNT.
 11751     MOVE CR-LFAMT                TO NP-BENEFIT.
 11752
 11753*    CALL 'FULNETRM'
 11754*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 11755*              NP-ACCOUNT NP-REMAINING.
 11756
 11757     MOVE NP-REMAINING            TO DE-LF-CNBEN.
 11758
 11759     IF CR-LFAMT EQUAL +0
 11760         MOVE +0                  TO TEMP-5
 11761     ELSE
 11762         COMPUTE TEMP-5 = DE-LF-CNBEN / CR-LFAMT.
 11763
 11764 2250-CONTINUE-CANCEL-BUILD.
 11765
 11766     MOVE CR-LFRFND                   TO DE-LF-RFND.
 11767     MOVE CR-LF-STATUS-AT-CANCEL      TO DE-LF-PREV-STAT.
 11768     MOVE CR-LF-CANC-DT               TO DE-LF-CANC-DTE
 11769                                         WS-DE-LF-CANC-DTE-N.
 11770     MOVE CR-LF-CANCEL-EXIT-DATE      TO DE-LF-CANC-EXIT-DT
 11771                                         WS-DE-LF-CANC-EXIT-DT-N.
 11772     MOVE CR-LF-COMM-CHARGEBACK       TO DE-LF-COMM-CHARGEBACK.
 11773
 11774     MOVE CR-AHRFND                   TO DE-AH-RFND.
 11775
 11776     IF DTE-CLIENT = 'DCC'
 11777        IF DE-AH-RFND = ZEROS
 11778           MOVE ZEROS                 TO DE-ADDL-CLP
 11779        END-IF
 11780     END-IF
 11781
 11782     MOVE CR-AH-STATUS-AT-CANCEL      TO DE-AH-PREV-STAT.
 11783     MOVE CR-AH-CANC-DT               TO DE-AH-CANC-DTE
 11784                                         WS-DE-AH-CANC-DTE-N.
 11785     MOVE CR-AH-CANCEL-EXIT-DATE      TO DE-AH-CANC-EXIT-DT
 11786                                         WS-DE-AH-CANC-EXIT-DT-N.
 11787     MOVE CR-AH-COMM-CHARGEBACK       TO DE-AH-COMM-CHARGEBACK.
 11788
 11789     IF PB-LAST-MAINT-BY = 'E570'
 11790         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11791
 11792     IF CHECK-BILLED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 230
* ECS010V.cbl
 11793         MOVE 'N' TO BILLED-SWITCH
 11794     ELSE
 11795         GO TO 2259-END-CANCEL-BUILD.
 11796
 11797     MOVE +1                        TO SUB1.
 11798 2255-GA-BILL-LOOP.
 11799
 11800     IF PB-GA-BILL-DT (SUB1) NOT = LOW-VALUES  AND  SPACES
 11801         MOVE 'B'                   TO DE-GA-BILL-STATUS (SUB1).
 11802
 11803     IF SUB1 LESS THAN +5
 11804         ADD +1 TO SUB1
 11805         GO TO 2255-GA-BILL-LOOP.
 11806
 11807     MOVE PB-RECORD-BILL            TO DE-BILL-SW.
 11808     MOVE PB-C-REFUND-SW            TO DE-REFUND-SW.
 11809     MOVE ZEROS                     TO DE-BILLED-LFPRM
 11810                                       DE-BILLED-LFRFND
 11811                                       DE-BILLED-AHPRM
 11812                                       DE-BILLED-AHRFND.
 11813
 11814     IF PB-BILLED-DT = LOW-VALUES  OR  SPACES
 11815         IF PB-LF-BILLED-AMTS = ZERO  AND
 11816            PB-AH-BILLED-AMTS = ZERO
 11817             MOVE ' '                    TO DE-BILL-STATUS
 11818         ELSE
 11819             IF PB-LF-BILLED-AMTS = PB-C-LF-CANCEL-AMT  AND
 11820                PB-AH-BILLED-AMTS = PB-C-AH-CANCEL-AMT
 11821                 MOVE 'B'                TO DE-BILL-STATUS
 11822             ELSE
 11823                 MOVE 'R'                TO DE-BILL-STATUS
 11824                 MOVE PB-LF-BILLED-AMTS  TO DE-BILLED-LFRFND
 11825                 MOVE PB-AH-BILLED-AMTS  TO DE-BILLED-AHRFND
 11826     ELSE
 11827         MOVE 'B'                        TO DE-BILL-STATUS.
 11828
 11829 2259-END-CANCEL-BUILD.
 11830     EXIT.
 11831
 11832 2290-WRITE-CANCEL-EXTRACT.
 11833
 11834     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11835
 11836 2299-BLD-CANCEL-X.
 11837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 231
* ECS010V.cbl
 11839******************************************************************
 11840***            B U I L D   C L A I M   E X T R A C T           ***
 11841******************************************************************
 11842
 11843 2300-BUILD-CLAIM-EXTRACT.
 11844
 11845     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11846
 11847     MOVE 'X'                       TO DE-TRANS.
 11848
 11849     MOVE PC-CLAIM-TYPE             TO DE-TYPE.
 11850
 11851     MOVE PC-CLAIM-PAYMENT          TO DE-CLAIM-AMT.
 11852     MOVE ZEROS                     TO DE-REI-CLAIM-AMT.
 11853
 11854     MOVE INCURRED-DATE             TO DE-INCUR
 11855                                       WS-DE-INCUR-N.
 11856     MOVE REPORTED-DATE             TO DE-REPORTED.
 11857     MOVE PAYMENT-DATE              TO DE-PAY
 11858                                       WS-DE-PAY-N.
 11859     MOVE PAY-TO-DATE               TO DE-PAID-TO
 11860                                       WS-DE-PAID-TO-N.
 11861
 11862     MOVE PC-CLAIM-NO               TO DE-CNUM.
 11863     MOVE PC-CHECK-NO               TO DE-CHECK.
 11864     MOVE PC-TRLR-SEQ-NO            TO DE-PMT-TRAILER-SEQ.
 11865     MOVE PC-NO-OF-DAYS-PAID        TO DE-DAYS-DISAB.
 11866     MOVE PC-AGE-AT-CLAIM           TO DE-CLM-AGE.
 11867     MOVE PC-PAYMENT-TYPE           TO DE-PAY-CODE.
 11868     INSPECT DE-PAY-CODE
 11869         CONVERTING '1234569' TO 'PFSXEEV'.
 11870
 11871     MOVE AM-NAME                   TO DE-ACC-NAME.
 11872     MOVE AM-EXPIRE-DT              TO DE-ACC-EXP-DTE
 11873                                       WS-DE-ACC-EXP-DTE-N.
 11874     MOVE AM-EFFECT-DT              TO DE-ACC-EFF-DTE
 11875                                       WS-DE-ACC-EFF-DTE-N.
 11876     MOVE PC-CAUSE-CODE             TO DE-CLM-CAUSE.
 11877     MOVE CR-LOAN-OFFICER           TO DE-LOAN-OFFICER.
 11878
 11879     IF DE-DTH  OR  DE-OB-DTH
 11880         MOVE CR-LF-STATUS-AT-DEATH TO DE-LF-PREV-STAT
 11881     ELSE
 11882         IF CR-AH-LUMP-SUM-DISAB
 11883             MOVE CR-AH-STATUS-AT-SETTLEMENT
 11884                                    TO DE-AH-PREV-STAT.
 11885
 11886     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11887         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11888
 11889 2390-WRITE-CLAIM-EXTRACT.
 11890
 11891     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11892
 11893 2399-BLD-CLAIM-X.
 11894     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 232
* ECS010V.cbl
 11896******************************************************************
 11897***          B U I L D   R E S E R V E   E X T R A C T         ***
 11898******************************************************************
 11899
 11900 2400-BUILD-RESERVE-EXTRACT.
 11901
 11902     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 11903
 11904     MOVE 'Y'                         TO DE-TRANS.
 11905     MOVE PC-CLAIM-TYPE               TO DE-RESERVE-TYPE.
 11906
 11907     MOVE PC-IBNR-RESERVE-AMT         TO DE-IBNR.
 11908     MOVE PC-PTC-RESERVE-AMT          TO DE-PAYCUR.
 11909     MOVE PC-FUTURE-RESERVE-AMT       TO DE-FUTRSV.
 11910     ADD  PC-MANUAL-RESERVE-AMT       TO DE-FUTRSV.
 11911
 11912     IF DTE-CLIENT  =  'NCL'
 11913        IF PC-MANUAL-RESERVE-AMT  GREATER THAN   ZEROS
 11914            MOVE 'Y'                  TO DE-MANUAL-RSV-SWITCH.
 11915
 11916     MOVE PC-CLAIM-NO                 TO DE-CLMNO.
 11917
 11918     MOVE AM-EXPIRE-DT                TO DE-ACC-EXP-DTE-RSV
 11919                                         WS-DE-ACC-EXP-DTE-RSV-N.
 11920
 11921     MOVE AM-EFFECT-DT                TO DE-ACC-EFF-DTE-RSV
 11922                                         WS-DE-ACC-EFF-DTE-RSV-N.
 11923
 11924     MOVE INCURRED-DATE               TO DE-RSV-INCUR
 11925                                         WS-DE-RSV-INCUR-N.
 11926     MOVE REPORTED-DATE               TO DE-RSV-REPORTED.
 11927     MOVE PAY-TO-DATE                 TO DE-RSV-PAYTO
 11928                                         WS-DE-RSV-PAYTO-N.
 11929
 11930     MOVE ZEROS                       TO DE-REI-IBNR
 11931                                         DE-REI-PAYCUR
 11932                                         DE-REI-FUTRSV.
 11933
 11934     MOVE AM-NAME                     TO DE-RSV-ACC-NAME.
 11935
 11936     IF PC-LAST-MAINT-BY EQUAL 'E570'
 11937         MOVE 'R'                     TO DE-AUTO-GEND-IND.
 11938
 11939 2490-WRITE-RESERVE-EXTRACT.
 11940
 11941     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 11942
 11943 2499-BLD-RESERVE-X.
 11944     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 233
* ECS010V.cbl
 11946******************************************************************
 11947***          W R I T E   D E T A I L   E X T R A C T S         ***
 11948******************************************************************
 11949
 11950 2500-WRITE-DETAIL-EXTRACTS.
 11951
 11952
 11953     MOVE  ZEROS            TO  SUB.
 11954
 11955     IF  NOT  DE-CANCEL  AND   NOT  DE-RC-CANCEL
 11956         GO TO 2520-WRITE-CONTINUE.
 11957
 11958 2510-ZERO-CHARGEBACK-LOOP.
 11959
 11960     ADD  +1                TO  SUB.
 11961
 11962     IF  SUB    GREATER  THAN     +10
 11963         GO TO  2520-WRITE-CONTINUE.
 11964
 11965*    DISPLAY ' CERT NO ' CR-CERT-NO
 11966*    DISPLAY ' REFUND TYPE ' CR-AH-REFUND-TYPE
 11967*    DISPLAY '  SUB  ' SUB '   ' WS-AH-CHARGEBACK-SW (SUB)
 11968
 11969
 11970     IF  WS-LF-CHARGEBACK-SW (SUB)  = 'N'
 11971         MOVE  ZEROS            TO  DE-L-PC (SUB).
 11972
 11973     IF  (WS-AH-CHARGEBACK-SW (SUB)  = 'N')
 11974                   OR
 11975         ((CR-AH-REFUND-TYPE = 'G')
 11976         AND (CR-AHRFND = ZEROS))
 11977         MOVE  ZEROS             TO DE-A-PC (SUB)
 11978     END-IF
 11979
 11980     GO TO 2510-ZERO-CHARGEBACK-LOOP.
 11981
 11982 2520-WRITE-CONTINUE.
 11983
 11984     IF DTE-CLIENT NOT = 'HER'
 11985         GO TO 2590-WRITE-EXTRACTS.
 11986
 11987     IF DE-REINCO NOT = 'LNL'
 11988         GO TO 2590-WRITE-EXTRACTS.
 11989
 11990     IF DE-CLAIM  OR  DE-RESERVE  OR  DE-RR-RC-CLM
 11991         GO TO 2590-WRITE-EXTRACTS.
 11992
 11993     IF DE-AGT-TYPE (1)  = 'D'   MOVE 'C'    TO DE-AGT-TYPE (1).
 11994     IF DE-AGT-TYPE (2)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (2).
 11995     IF DE-AGT-TYPE (3)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (3).
 11996     IF DE-AGT-TYPE (4)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (4).
 11997     IF DE-AGT-TYPE (5)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (5).
 11998     IF DE-AGT-TYPE (6)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (6).
 11999     IF DE-AGT-TYPE (7)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (7).
 12000     IF DE-AGT-TYPE (8)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (8).
 12001     IF DE-AGT-TYPE (9)  = 'P'   MOVE 'O'    TO DE-AGT-TYPE (9).
 12002     IF DE-AGT-TYPE (10) = 'P'   MOVE 'O'    TO DE-AGT-TYPE (10).
 12003
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 234
* ECS010V.cbl
 12004     IF DE-AGT-TYPE (1)  = 'S'   MOVE 'F'    TO DE-AGT-TYPE (1).
 12005     IF DE-AGT-TYPE (2)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (2).
 12006     IF DE-AGT-TYPE (3)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (3).
 12007     IF DE-AGT-TYPE (4)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (4).
 12008     IF DE-AGT-TYPE (5)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (5).
 12009     IF DE-AGT-TYPE (6)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (6).
 12010     IF DE-AGT-TYPE (7)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (7).
 12011     IF DE-AGT-TYPE (8)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (8).
 12012     IF DE-AGT-TYPE (9)  = 'B'   MOVE 'G'    TO DE-AGT-TYPE (9).
 12013     IF DE-AGT-TYPE (10) = 'B'   MOVE 'G'    TO DE-AGT-TYPE (10).
 12014
 12015
 12016 2590-WRITE-EXTRACTS.
 12017
 12018     MOVE EOM-RUN-DATE            TO DE-PROC-DT
 12019                                     WS-DE-PROC-DT-N.
 12020
 12021     IF DTE-PGM-OPT = '1'
 12022         ADD +1                   TO DE-CNT
 12023*********PERFORM EXTRACT-DATE-RELOAD
 12024         WRITE DETAIL-EXTRACT.
 12025
 12026
 12027 2599-WRT-DETAIL-X.
 12028     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 235
* ECS010V.cbl
 12030******************************************************************
 12031***         R E I N S U R A N C E   P R O C E S S I N G        ***
 12032******************************************************************
 12033
 12034 3000-REINSURE-ROUTINE.
 12035
 12036     IF (CR-POLICY-IS-DECLINED) OR
 12037        (CR-POLICY-IS-VOID)
 12038        GO TO 3099-REINSURE-ROUTINE-X.
 12039
 12040     IF REIN-FLG = 'X'
 12041         GO TO 3099-REINSURE-ROUTINE-X.
 12042
 12043     MOVE 'X' TO REIN-FLG.
 12044
 12045     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 12046
 12047     IF CR-REIN-TABLE = SPACES OR ZEROS
 12048         GO TO 3030-RE-CALCULATE-REINSURANCE.
 12049
 12050******************************************************************
 12051***    R E A D   R E I N S U R A N C E   T A B L E   F I L E   ***
 12052******************************************************************
 12053
 12054 3010-RR-READ-REIN.
 12055
 12056     IF REIN-OPEN-SW = ' '
 12057         MOVE 'X'                       TO REIN-OPEN-SW
 12058         MOVE DTE-CLASIC-COMPANY-CD     TO REIN-SRCH-COMP-CD
 12059         MOVE 'A'                       TO REIN-SRCH-CODE
 12060         OPEN INPUT ERRTBL-IN
 12061         IF ERRTBL-FILE-STATUS = '00'  OR  '97'
 12062             PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
 12063          ELSE
 12064             MOVE '21'                  TO ABEND-CODE-1
 12065             MOVE ERRTBL-FILE-STATUS    TO ABEND-CODE-2
 12066             DISPLAY '******************************'
 12067             DISPLAY '***** ERROR LOCATION 015 *****'
 12068             DISPLAY '******************************'
 12069             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12070             GO TO ABEND-PGM.
 12071
 12072     IF CR-REIN-TABLE = REIN-SRCH
 12073         GO TO 3019-RR-READ-REIN-X.
 12074
 12075     MOVE +0                            TO REIN-SUB-1.
 12076     MOVE 999999                        TO REIN-LOW-TIME.
 12077     MOVE CR-REIN-TABLE                 TO REIN-SRCH.
 12078
 12079 3011-RR-CHECK-REIN-SAVE-TABLE.
 12080
 12081     ADD +1                             TO REIN-SUB-1.
 12082     IF REIN-SUB-1 GREATER THAN REIN-MAX  OR
 12083        REIN-SUB-1 GREATER THAN REIN-SUB-2
 12084         GO TO 3015-RR-READ-ERRTBL.
 12085
 12086     IF REIN-SEARCH = SR-CONTROL (REIN-SUB-1)
 12087         MOVE SR-ENTRY (REIN-SUB-1)     TO REINSURANCE-RECORD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 236
* ECS010V.cbl
 12088         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12089         MOVE WS-TIME                   TO SR-TIME (REIN-SUB-1)
 12090         GO TO 3019-RR-READ-REIN-X.
 12091
 12092     IF SR-TIME (REIN-SUB-1) LESS THAN REIN-LOW-TIME
 12093         MOVE SR-TIME (REIN-SUB-1)      TO REIN-LOW-TIME
 12094         MOVE REIN-SUB-1                TO REIN-LOW-SUB.
 12095
 12096     GO TO 3011-RR-CHECK-REIN-SAVE-TABLE.
 12097
 12098 3015-RR-READ-ERRTBL.
 12099
 12100     MOVE REIN-SEARCH                   TO RE-CONTROL-PRIMARY.
 12101
 12102     READ ERRTBL-IN.
 12103
 12104     IF ERRTBL-FILE-STATUS  = '23'
 12105         DISPLAY 'INVALID REINSURANCE TABLE CODE - ' REIN-SRCH
 12106                                           ' ' CR-FULL-CONTROL
 12107         MOVE '24'                      TO ABEND-CODE-1
 12108         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12109         DISPLAY '******************************'
 12110         DISPLAY '***** ERROR LOCATION 016 *****'
 12111         DISPLAY '******************************'
 12112         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12113         GO TO ABEND-PGM.
 12114
 12115     IF ERRTBL-FILE-STATUS  = '00'  OR  '97'
 12116         NEXT SENTENCE
 12117       ELSE
 12118         MOVE '24'                      TO ABEND-CODE-1
 12119         MOVE ERRTBL-FILE-STATUS        TO ABEND-CODE-2
 12120         DISPLAY '******************************'
 12121         DISPLAY '***** ERROR LOCATION 017 *****'
 12122         DISPLAY '******************************'
 12123         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 12124         GO TO ABEND-PGM.
 12125
 12126     ADD +1                            TO ERRTBL-READS.
 12127
 12128     IF REIN-SUB-1 GREATER THAN REIN-MAX
 12129         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-LOW-SUB)
 12130         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12131         MOVE WS-TIME                  TO SR-TIME (REIN-LOW-SUB)
 12132     ELSE
 12133         MOVE REINSURANCE-RECORD       TO SR-ENTRY (REIN-SUB-1)
 12134         ACCEPT WS-TIME-OF-DAY   FROM TIME
 12135         MOVE WS-TIME                  TO SR-TIME (REIN-SUB-1)
 12136         MOVE REIN-SUB-1               TO REIN-SUB-2.
 12137
 12138 3019-RR-READ-REIN-X.
 12139     EXIT.
 12140
 12141 3020-CALCULATE-REINSURANCE.
 12142
 12143*    IF DTE-CLIENT = '???'  AND
 12144*       (CR-REIN-TABLE = 'SE1')
 12145*        PERFORM 3640-NSP-REIN-RATING-ROUTINE THRU 3669-NSP-REIN-X
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 237
* ECS010V.cbl
 12146*        IF CR-STATE NOT = STATE-L
 12147*            MOVE CR-STATE             TO STATE-L
 12148*            PERFORM 8200-STATE-CODE-LOOKUP
 12149*                         THRU 8299-STATE-LOOKUP-X.
 12150
 12151
 12152*    IF DTE-CLIENT = 'DCC'
 12153*       IF CR-LF-NSP-PRM NOT = ZEROS
 12154*          COMPUTE CR-LF-NSP-PRM ROUNDED =
 12155*             (CR-LFPRM + CR-LFPRM-ALT) -
 12156*             ((CR-LFPRM + CR-LFPRM-ALT) * CR-LCOM-L (1))
 12157*       END-IF
 12158*       IF CR-AH-NSP-PRM NOT = ZEROS
 12159*          COMPUTE CR-AH-NSP-PRM ROUNDED =
 12160*          CR-AHPRM -
 12161*          (CR-AHPRM * CR-LCOM-AH (1))
 12162*       END-IF
 12163*    END-IF
 12164
 12165
 12166     IF RE-REMAINING (1) = 'I'
 12167         MOVE '*'                      TO RISK-REIN-FLAG
 12168     ELSE
 12169         GO TO 3029-CONTINUE-REIN-CALC.
 12170
 12171     MOVE SPACE                        TO REIN-CANCEL-LF-SW
 12172                                          REIN-CANCEL-AH-SW.
 12173     MOVE ZEROS                        TO REIN-EARN-LF-TERM
 12174                                          REIN-LCNC-EARN-TERM
 12175                                          REIN-LF-CLM-MONTHS
 12176                                          REIN-EARN-AH-TERM
 12177                                          REIN-ACNC-EARN-TERM
 12178                                          REIN-AH-PRIOR-CLMS-PAID
 12179                                          REIN-AH-CLM-MONTHS
 12180                                          REIN-AH-CLM-MTH-1
 12181                                          REIN-AH-CLM-MTH-2
 12182                                          REIN-AH-CLM-MTH-3
 12183                                          REIN-AH-CLM-MTH-4
 12184                                          REIN-AH-CLM-MTH-5.
 12185
 12186*    MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
 12187*    MOVE 'L'                          TO DC-OPTION-CODE.
 12188*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12189*    MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
 12190
 12191     IF CR-LFTYP = ZEROS  OR  SPACES
 12192         GO TO 3023-CONTINUE.
 12193
 12194     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12195
 12196     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
 12197       IF CR-LF-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12198           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
 12199
 12200     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
 12201       IF CR-LF-CLAIM-EXIT-DATE LESS THAN VALUATION-DT
 12202           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
 12203
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 238
* ECS010V.cbl
 12204     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12205     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12206
 12207     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
 12208         MOVE CR-LF-TERM               TO MONTHS-DIFF-LF
 12209     ELSE
 12210         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-LF.
 12211
 12212     IF CR-LF-CANC-DT NOT = ZEROS
 12213         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
 12214         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12215         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
 12216         IF CR-DT = CR-LF-CANC-DT
 12217             MOVE '*'                  TO REIN-CANCEL-LF-SW.
 12218
 12219     IF CR-DTH-DT NOT = ZEROS
 12220         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
 12221         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12222         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
 12223
 12224     MOVE MONTHS-DIFF-LF               TO REIN-EARN-LF-TERM.
 12225
 12226
 12227 3023-CONTINUE.
 12228
 12229     IF CR-AHTYP = ZEROS  OR  SPACES
 12230        GO TO 3029-CONTINUE-REIN-CALC.
 12231
 12232     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
 12233
 12234     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
 12235       IF CR-AH-CANCEL-EXIT-DATE LESS THAN VALUATION-DT
 12236           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
 12237
 12238     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
 12239       IF CR-AH-SETTLEMENT-EXIT-DATE LESS THAN VALUATION-DT
 12240           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
 12241
 12242     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
 12243     PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT.
 12244
 12245     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
 12246         MOVE CR-AH-TERM               TO MONTHS-DIFF-AH
 12247     ELSE
 12248         MOVE DC-ELAPSED-MONTHS        TO MONTHS-DIFF-AH.
 12249
 12250     IF CR-AH-CANC-DT NOT = ZEROS
 12251         MOVE CR-AH-CANC-DT           TO DC-GREG-DATE-CYMD
 12252         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12253         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
 12254         IF CR-DT = CR-AH-CANC-DT
 12255             MOVE '*'                  TO REIN-CANCEL-AH-SW.
 12256
 12257     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
 12258         MOVE CR-DIS-INCUR-DT (1)    TO DC-GREG-DATE-CYMD
 12259         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12260         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
 12261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 239
* ECS010V.cbl
 12262     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
 12263         MOVE CR-DIS-INCUR-DT (2)    TO DC-GREG-DATE-CYMD
 12264         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12265         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
 12266
 12267     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
 12268         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
 12269         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12270         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
 12271
 12272     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
 12273         MOVE CR-DIS-INCUR-DT (4)    TO DC-GREG-DATE-CYMD
 12274         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12275         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
 12276
 12277     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
 12278         MOVE CR-DIS-INCUR-DT (5)    TO DC-GREG-DATE-CYMD
 12279         PERFORM 3025-CALC-ELAPSED-MONTHS THRU 3026-CALC-EXIT
 12280         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
 12281
 12282     MOVE MONTHS-DIFF-AH               TO REIN-EARN-AH-TERM.
 12283
 12284
 12285     GO TO 3029-CONTINUE-REIN-CALC.
 12286
 12287
 12288 3025-CALC-ELAPSED-MONTHS.
 12289
 12290     MOVE 'L'                          TO DC-OPTION-CODE.
 12291     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12292     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
 12293     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
 12294     MOVE '1'                          TO DC-OPTION-CODE.
 12295     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
 12296     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
 12297                                          DC-ODD-DAYS-OVER
 12298                                          DC-ELAPSED-DAYS.
 12299     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 12300
 12301 3026-CALC-EXIT.
 12302     EXIT.
 12303
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 240
* ECS010V.cbl
 12305 3029-CONTINUE-REIN-CALC.
 12306
*12307                             COPY ECSRTPFM.
 12308******************************************************************07/10/97
 12309*                                                                *ECSRTPFM
 12310*                            ECSRTPFM                            *   LV001
 12311*                            VMOD=2.002                          *ECSRTPFM
 12312*                                                                *ECSRTPFM
 12313******************************************************************ECSRTPFM
 12314                                                                  ECSRTPFM
 12315     IF    CR-LFAMT  NUMERIC                                      00000072
 12316           NEXT SENTENCE                                          00000073
 12317        ELSE                                                      00000074
 12318           MOVE ZEROS TO CR-LFAMT.                                00000075
 12319                                                                  00000076
 12320     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 12321           NEXT SENTENCE                                          00000078
 12322        ELSE                                                      00000079
 12323           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 12324                                                                  00000081
 12325                                                                  00000082
 12326     IF    CR-LFPRM  NUMERIC                                      00000083
 12327           NEXT SENTENCE                                          00000084
 12328        ELSE                                                      00000085
 12329           MOVE ZEROS TO CR-LFPRM.                                00000086
 12330                                                                  00000087
 12331     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 12332           NEXT SENTENCE                                          00000089
 12333        ELSE                                                      00000090
 12334           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 12335                                                                  00000092
 12336                                                                  00000093
 12337     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 12338           NEXT SENTENCE                                          00000095
 12339        ELSE                                                      00000096
 12340           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 12341                                                                  00000098
 12342     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 12343           NEXT SENTENCE                                          00000100
 12344        ELSE                                                      00000101
 12345           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 12346                                                                  00000103
 12347     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 12348           NEXT SENTENCE                                          00000105
 12349        ELSE                                                      00000106
 12350           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 12351                                                                  00000108
 12352     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 12353     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 12354     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 12355         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 12356     ELSE                                                         ECSRTPFM
 12357         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 12358     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
 12359                                                                  ECSRTPFM
 12360     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 12361     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 12362     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 241
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 12363         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 12364     ELSE                                                         ECSRTPFM
 12365         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 12366     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 12367                                                                  ECSRTPFM
 12368     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 12369         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 12370             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 12371                                                                  ECSRTPFM
 12372
 12373     MOVE 'X'                  TO REIN-RT-SW.
 12374     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 12375     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 12376     MOVE ' '                  TO REIN-RT-SW.
 12377
 12378 3030-RE-CALCULATE-REINSURANCE.
 12379
 12380     IF AM-RECALC-REIN = 'Y'
 12381         IF CR-REIN-TABLE NOT = AM-REI-TABLE  AND
 12382            CR-REIN-SPEC = SPACE  AND
 12383            CR-ENTRY-DATE NOT = EOM-RUN-DATE
 12384             PERFORM 3600-RC-REINSURANCE
 12385                 THRU 3799-RC-REINSURANCE-X.
 12386
 12387     PERFORM 3040-REIN-REC-CNT THRU 3049-RRC-XIT
 12388         VARYING SUB1 FROM 1 BY 1
 12389             UNTIL REIN-COMP (SUB1) = SPACES.
 12390
 12391     GO TO 3099-REINSURE-ROUTINE-X.
 12392
 12393 3040-REIN-REC-CNT.
 12394
 12395     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 12396         GO TO 3049-RRC-XIT.
 12397
 12398     PERFORM 3050-REIN-COMP-ADD THRU 3059-RCA-XIT
 12399         VARYING B-SUB FROM 1 BY 1
 12400             UNTIL B-SUB GREATER THAN 50.
 12401
 12402 3049-RRC-XIT.
 12403     EXIT.
 12404
 12405 3050-REIN-COMP-ADD.
 12406
 12407     IF RB-COMPANY (B-SUB) = SPACES
 12408         MOVE REIN-COMP (SUB1) TO RB-COMPANY (B-SUB).
 12409     IF RB-COMPANY (B-SUB) = REIN-COMP (SUB1)
 12410         MOVE 1   TO RB-COUNT (B-SUB)
 12411         MOVE +50 TO B-SUB.
 12412
 12413 3059-RCA-XIT.
 12414     EXIT.
 12415
 12416 3099-REINSURE-ROUTINE-X.
 12417     EXIT.
 12418
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 242
* ECS010V.cbl
 12420******************************************************************
 12421***                R E I N S U R E   I S S U E S               ***
 12422******************************************************************
 12423
 12424 3100-REINSURE-ISSUE.
 12425
 12426     IF  REIN-COMP (1) = SPACES
 12427         GO TO 3199-REINSURE-ISSUE-X.
 12428
 12429     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 12430     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12431     MOVE 'I'      TO DE-TRANS.
 12432     MOVE 'R'      TO DE-REIN.
 12433*****PERFORM EXTRACT-DATE-RELOAD.
 12434     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12435     MOVE +1       TO SUB1.
 12436
 12437 3110-REINSURE-ISSUE-LOOP.
 12438
 12439     IF REIN-COMP (SUB1) = SPACES
 12440         GO TO 3119-REINSURE-ISSUE-LOOP-END.
 12441
 12442     IF UPDATING-RISK-PREMIUMS
 12443       IF REIN-REM-SW (SUB1) NOT = 'I'
 12444         ADD +1 TO SUB1
 12445         GO TO 3110-REINSURE-ISSUE-LOOP.
 12446
 12447     IF REIN-REM-SW (SUB1) = 'Z'
 12448         ADD +1 TO SUB1
 12449         GO TO 3110-REINSURE-ISSUE-LOOP.
 12450
 12451     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12452     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12453     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12454     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12455     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12456     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12457
 12458     IF REIN-REM-SW (SUB1) NOT = 'I'
 12459         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12460
 12461     IF RWF-LFPRM = ZEROS  AND
 12462        RWF-AHPRM = ZEROS
 12463         GO TO 3115-CONTINUE-ISSUE-LOOP.
 12464
 12465     IF RWF-LFPRM NOT = ZEROS
 12466         COMPUTE DE-REI-LFPRM = RWF-LFPRM - CR-LF-REI-RISK-PRM
 12467         MOVE RWF-LFPRM         TO CR-LF-REI-RISK-PRM.
 12468
 12469     IF RWF-AHPRM NOT = ZEROS
 12470         COMPUTE DE-REI-AHPRM = RWF-AHPRM - CR-AH-REI-RISK-PRM
 12471         MOVE RWF-AHPRM         TO CR-AH-REI-RISK-PRM.
 12472
 12473 3115-CONTINUE-ISSUE-LOOP.
 12474
 12475     ADD DE-REI-LFPRM           TO RW-ACCUM-LF.
 12476     ADD DE-REI-AHPRM           TO RW-ACCUM-AH.
 12477
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 243
* ECS010V.cbl
 12478     IF DE-REI-LFAMT NOT = ZERO
 12479        OR DE-REI-LFPRM NOT = ZERO
 12480        OR DE-REI-AHAMT NOT = ZERO
 12481        OR DE-REI-AHPRM NOT = ZERO
 12482         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12483                 2599-WRT-DETAIL-X
 12484         ADD +1 TO BC-R-ISS.
 12485
 12486     ADD +1 TO SUB1.
 12487     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12488     PERFORM EXTRACT-DATE-LOAD.
 12489
 12490     GO TO 3110-REINSURE-ISSUE-LOOP.
 12491
 12492 3119-REINSURE-ISSUE-LOOP-END.
 12493     EXIT.
 12494
 12495 3190-REINSURE-ISSUE-PRINT.
 12496
 12497     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12498     IF RW-ACCUM-LF NOT = ZERO
 12499         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12500         MOVE CR-LF-TERM               TO TRD-LFTRM
 12501         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12502         MOVE 'REIN CEDED'        TO TRD-LF-ACTION.
 12503     IF RW-ACCUM-AH NOT = ZERO
 12504         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12505         MOVE CR-AH-TERM               TO TRD-AHTRM
 12506         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12507         MOVE 'REIN CEDED'        TO TRD-AH-ACTION.
 12508     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
 12509         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12510
 12511 3199-REINSURE-ISSUE-X.
 12512     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 244
* ECS010V.cbl
 12514******************************************************************
 12515***               R E I N S U R E   C A N C E L S              ***
 12516******************************************************************
 12517
 12518 3200-REINSURE-CANCEL.
 12519
 12520     IF REIN-COMP (1) = SPACES
 12521         GO TO 3299-REINSURE-CANCEL-X.
 12522
 12523     IF CR-LFRFND = ZERO
 12524        AND CR-AHRFND = ZERO
 12525         GO TO 3299-REINSURE-CANCEL-X.
 12526
 12527     PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X
 12528             VARYING SUB1 FROM +1 BY +1 UNTIL
 12529                       REIN-COMP (SUB1) = SPACES.
 12530
 12531     IF REIN-RT-SW = 'X'
 12532         GO TO 3299-REINSURE-CANCEL-X.
 12533
 12534     PERFORM 2200-BUILD-CANCEL-EXTRACT THRU 2259-END-CANCEL-BUILD.
 12535     MOVE ZEROS    TO RW-ACCUM-LF  RW-ACCUM-AH.
 12536     MOVE 'R'      TO DE-REIN.
 12537*****PERFORM EXTRACT-DATE-RELOAD.
 12538     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12539     MOVE +1       TO SUB1.
 12540
 12541 3210-REINSURE-CANCEL-LOOP.
 12542
 12543     IF REIN-COMP (SUB1) = SPACES
 12544         GO TO 3219-REINSURE-CANCEL-LOOP-END.
 12545
 12546     IF REIN-REM-SW (SUB1) = 'Z'
 12547         ADD +1        TO SUB1
 12548         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12549         PERFORM EXTRACT-DATE-LOAD
 12550         GO TO 3210-REINSURE-CANCEL-LOOP.
 12551
 12552     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12553     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12554
 12555     MOVE RWF-LFRFND            TO DE-REI-LFRFND.
 12556     MOVE RWF-AHRFND            TO DE-REI-AHRFND.
 12557     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12558     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12559     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12560     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12561     ADD RWF-LFRFND             TO RW-ACCUM-LF.
 12562     ADD RWF-AHRFND             TO RW-ACCUM-AH.
 12563     COMPUTE DE-REI-CNAMT = RWF-LFAMT * TEMP-5.
 12564
 12565     IF REIN-REM-SW (SUB1) NOT = 'I'
 12566         GO TO 3215-CONTINUE-CANCEL-LOOP.
 12567
 12568     IF CR-LF-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12569        VOIDING-LF-CANCEL
 12570         NEXT SENTENCE
 12571     ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 245
* ECS010V.cbl
 12572         MOVE ZEROS             TO DE-REI-LFRFND.
 12573
 12574     IF CR-AH-CANCEL-EXIT-DATE = EOM-RUN-DATE  OR
 12575        VOIDING-AH-CANCEL
 12576         NEXT SENTENCE
 12577     ELSE
 12578         MOVE ZEROS             TO DE-REI-AHRFND.
 12579
 12580 3215-CONTINUE-CANCEL-LOOP.
 12581
 12582     IF RWF-LF-RUNOFF-SW = 'N'
 12583         IF DE-LF-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12584             MOVE ZEROS         TO DE-LF-TYPE
 12585                                   DE-REI-LFAMT
 12586                                   DE-REI-LFPRM
 12587                                   DE-REI-LFRFND
 12588                                   DE-REI-CNAMT.
 12589
 12590     IF RWF-AH-RUNOFF-SW = 'N'
 12591         IF DE-AH-CANC-DTE NOT LESS THAN RWF-EP-STOP-DATE
 12592             MOVE ZEROS         TO DE-AH-TYPE
 12593                                   DE-REI-AHAMT
 12594                                   DE-REI-AHPRM
 12595                                   DE-REI-AHRFND.
 12596
 12597     IF DE-REI-LFAMT NOT = ZERO
 12598        OR DE-REI-LFPRM NOT = ZERO
 12599        OR DE-REI-AHAMT NOT = ZERO
 12600        OR DE-REI-AHPRM NOT = ZERO
 12601        OR DE-REI-LFRFND NOT = ZERO
 12602        OR DE-REI-AHRFND NOT = ZERO
 12603        OR DE-REI-CNAMT NOT = ZERO
 12604         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12605                                            2599-WRT-DETAIL-X
 12606         ADD +1 TO BC-R-CNC.
 12607
 12608     ADD +1 TO SUB1.
 12609     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 12610     PERFORM EXTRACT-DATE-LOAD.
 12611     GO TO 3210-REINSURE-CANCEL-LOOP.
 12612
 12613 3219-REINSURE-CANCEL-LOOP-END.
 12614     EXIT.
 12615
 12616 3290-REINSURE-CANCEL-PRINT.
 12617
 12618     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12619     IF RW-ACCUM-LF NOT = ZERO
 12620         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12621         MOVE CR-LF-TERM               TO TRD-LFTRM
 12622         MOVE RW-ACCUM-LF         TO TRD-LFPRM-RFND
 12623         MOVE 'REIN CANCL'        TO TRD-LF-ACTION.
 12624     IF RW-ACCUM-AH NOT = ZERO
 12625         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12626         MOVE CR-AH-TERM               TO TRD-AHTRM
 12627         MOVE RW-ACCUM-AH         TO TRD-AHPRM-RFND
 12628         MOVE 'REIN CANCL'        TO TRD-AH-ACTION.
 12629     IF RW-ACCUM-LF NOT = ZERO  OR  RW-ACCUM-AH NOT = ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 246
* ECS010V.cbl
 12630         PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12631
 12632 3299-REINSURE-CANCEL-X.
 12633     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 247
* ECS010V.cbl
 12635******************************************************************
 12636***                R E I N S U R E   C L A I M S               ***
 12637******************************************************************
 12638
 12639 3300-REINSURE-CLAIM.
 12640
 12641*    IF DTE-CLIENT = '???'
 12642*       IF (REIN-RT-SW NOT = 'X')  AND
 12643*          (PC-PAYMENT-TYPE = '5' OR '6')
 12644*        GO TO 3399-REINSURE-CLAIM-X.
 12645
 12646     IF REIN-COMP (1) = SPACES
 12647         GO TO 3399-REINSURE-CLAIM-X.
 12648
 12649     IF REIN-RT-SW = 'X'
 12650         MOVE CR-DTHAMT   TO RW-LFCLMWK
 12651         ADD  CR-DTHEXP   TO RW-LFCLMWK
 12652         MOVE CR-DISAMT   TO RW-AHCLMWK
 12653         ADD  CR-DISEXP   TO RW-AHCLMWK
 12654     ELSE
 12655         IF PC-CLAIM-TYPE  = 1 OR 3
 12656             MOVE PC-CLAIM-PAYMENT    TO RW-LFCLMWK
 12657             MOVE +0                  TO RW-AHCLMWK
 12658         ELSE
 12659             MOVE PC-CLAIM-PAYMENT    TO RW-AHCLMWK
 12660             MOVE +0                  TO RW-LFCLMWK.
 12661
 12662     MOVE +0                          TO RW-LFCLM
 12663                                         RW-AHCLM.
 12664     IF RW-LFCLMWK = ZERO
 12665        AND RW-AHCLMWK = ZERO
 12666         GO TO 3399-REINSURE-CLAIM-X.
 12667
 12668     PERFORM REINSURE-CALC-CLAIM THRU REINSURE-CALC-CLAIM-X
 12669         VARYING SUB1 FROM +1 BY +1
 12670             UNTIL REIN-COMP (SUB1) = SPACES.
 12671
 12672     IF REIN-RT-SW = 'X'
 12673         GO TO 3399-REINSURE-CLAIM-X.
 12674
 12675     PERFORM 2300-BUILD-CLAIM-EXTRACT.
 12676     MOVE ZEROS                TO RW-ACCUM-CLM.
 12677     MOVE 'R'                  TO DE-REIN.
 12678*****PERFORM EXTRACT-DATE-RELOAD.
 12679     MOVE DETAIL-EXTRACT       TO SAVE-EXTRACT.
 12680     MOVE +1                   TO SUB1.
 12681
 12682 3310-REINSURE-CLAIM-LOOP.
 12683
 12684     IF REIN-COMP (SUB1) = SPACES
 12685         GO TO 3390-REINSURE-CLAIM-PRINT.
 12686
 12687     IF REIN-REM-SW (SUB1) = 'Z'
 12688         ADD +1        TO SUB1
 12689         MOVE SAVE-EXTRACT TO DETAIL-EXTRACT
 12690         PERFORM EXTRACT-DATE-LOAD
 12691         GO TO 3310-REINSURE-CLAIM-LOOP.
 12692
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 248
* ECS010V.cbl
 12693     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12694     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12695
 12696     IF PC-CLAIM-TYPE  = 1 OR 3
 12697         IF RWF-LF-RUNOFF-SW = 'N'
 12698           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12699               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12700
 12701     IF PC-CLAIM-TYPE  = 2 OR 4
 12702         IF RWF-AH-RUNOFF-SW = 'N'
 12703           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12704               GO TO 3330-REINSURE-CLAIM-LOOP-ADD.
 12705
 12706     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12707     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12708     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12709     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12710
 12711     IF PC-CLAIM-TYPE  = 1 OR 3
 12712         MOVE RWF-LFCLML TO DE-REI-CLAIM-AMT
 12713         ADD RWF-LFCLML  TO RW-ACCUM-CLM
 12714     ELSE
 12715         MOVE RWF-AHCLML TO DE-REI-CLAIM-AMT
 12716         ADD RWF-AHCLML  TO RW-ACCUM-CLM.
 12717
 12718     IF PC-CLAIM-TYPE = 1 OR 3
 12719         IF +0 = DE-REI-LFPRM AND DE-REI-LFAMT
 12720            AND DE-REI-CLAIM-AMT
 12721             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12722         ELSE
 12723             GO TO 3320-REINSURE-CLAIM-LOOP-GO
 12724     ELSE
 12725         IF +0 = DE-REI-AHPRM AND DE-REI-AHAMT
 12726            AND DE-REI-CLAIM-AMT
 12727             GO TO 3330-REINSURE-CLAIM-LOOP-ADD
 12728         ELSE
 12729             GO TO 3320-REINSURE-CLAIM-LOOP-GO.
 12730
 12731 3320-REINSURE-CLAIM-LOOP-GO.
 12732
 12733     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 12734     ADD +1                     TO BC-R-CLM.
 12735
 12736 3330-REINSURE-CLAIM-LOOP-ADD.
 12737
 12738     ADD +1                     TO SUB1.
 12739     MOVE SAVE-EXTRACT          TO DETAIL-EXTRACT.
 12740     PERFORM EXTRACT-DATE-LOAD.
 12741     GO TO 3310-REINSURE-CLAIM-LOOP.
 12742
 12743 3390-REINSURE-CLAIM-PRINT.
 12744
 12745     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12746     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12747         MOVE CLAS-I-AB3 (CLAS-INDEXL) TO TRD-LFTYP
 12748         MOVE CR-LF-TERM               TO TRD-LFTRM
 12749         MOVE RW-ACCUM-CLM     TO TRD-LFCOM-CLM
 12750         MOVE 'REIN CLAIM'     TO TRD-LF-ACTION
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 249
* ECS010V.cbl
 12751     ELSE
 12752         MOVE CLAS-I-AB3 (CLAS-INDEXA) TO TRD-AHTYP
 12753         MOVE CR-AH-TERM               TO TRD-AHTRM
 12754         MOVE RW-ACCUM-CLM     TO TRD-AHCOM-CLM
 12755         MOVE CR-DIS-MO        TO TRD-AHACTMO
 12756         MOVE CR-DIS-DA        TO TRD-AHACTDA
 12757         MOVE CR-DIS-YR        TO TRD-AHACTYR
 12758         MOVE '/'              TO TRD-AH-S1  TRD-AH-S2
 12759         MOVE 'REIN CLAIM'     TO TRD-AH-ACTION.
 12760     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12761
 12762 3399-REINSURE-CLAIM-X.
 12763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 250
* ECS010V.cbl
 12765******************************************************************
 12766***              R E I N S U R E   R E S E R V E S             ***
 12767******************************************************************
 12768
 12769 3400-REINSURE-RESERVE.
 12770
 12771     IF REIN-COMP (1) = SPACES
 12772         GO TO 3499-REINSURE-RESERVE-X.
 12773
 12774     IF PC-CLAIM-TYPE = '1' OR '3'
 12775         MOVE PC-IBNR-RESERVE-AMT    TO RW-LFIBNRWK
 12776         MOVE PC-PTC-RESERVE-AMT     TO RW-LFPAYCURWK
 12777         MOVE PC-FUTURE-RESERVE-AMT  TO RW-LFFUTRSVWK
 12778         ADD  PC-MANUAL-RESERVE-AMT  TO RW-LFFUTRSVWK
 12779         MOVE +0 TO RW-AHIBNRWK  RW-AHPAYCURWK  RW-AHFUTRSVWK
 12780     ELSE
 12781         MOVE PC-IBNR-RESERVE-AMT    TO RW-AHIBNRWK
 12782         MOVE PC-PTC-RESERVE-AMT     TO RW-AHPAYCURWK
 12783         MOVE PC-FUTURE-RESERVE-AMT  TO RW-AHFUTRSVWK
 12784         ADD  PC-MANUAL-RESERVE-AMT  TO RW-AHFUTRSVWK
 12785         MOVE +0 TO RW-LFIBNRWK  RW-LFPAYCURWK  RW-LFFUTRSVWK.
 12786
 12787     MOVE +0 TO RW-LFIBNR  RW-LFPAYCUR  RW-LFFUTRSV
 12788                RW-AHIBNR  RW-AHPAYCUR  RW-AHFUTRSV.
 12789     IF +0 = RW-LFIBNRWK AND RW-LFPAYCURWK AND RW-LFFUTRSVWK
 12790         AND RW-AHIBNRWK AND RW-AHPAYCURWK AND RW-AHFUTRSVWK
 12791          GO TO 3499-REINSURE-RESERVE-X.
 12792
 12793     IF DTE-CLIENT NOT = 'MIC'
 12794         GO TO 3405-REINSURE-RESERVE-CONT.
 12795
 12796     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12797         GO TO 3405-REINSURE-RESERVE-CONT.
 12798
 12799     MOVE PC-CERT-EFF-DT             TO CP-CERT-EFF-DT.
 12800     MOVE BIN-VALUATION-DT           TO CP-VALUATION-DT.
 12801     MOVE PC-PAID-THRU-DT            TO CP-PAID-THRU-DT.
 12802     MOVE 'A'                        TO CP-BENEFIT-TYPE
 12803                                        CP-CLAIM-TYPE.
 12804     MOVE PC-INCURRED-DT             TO CP-INCURRED-DT.
 12805     MOVE PC-REPORTED-DT             TO CP-REPORTED-DT.
 12806     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 12807     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 12808     MOVE ZEROS                      TO CP-CDT-PERCENT.
 12809     MOVE '3'                        TO CP-CDT-METHOD.
 12810     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 12811     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 12812                                        CP-RATING-BENEFIT-AMT.
 12813     MOVE PC-REMAINING-TERM          TO CP-REMAINING-TERM.
 12814     MOVE 'O'                        TO CP-CLAIM-STATUS.
 12815
 12816 3405-REINSURE-RESERVE-CONT.
 12817
 12818     PERFORM 3500-REINSURE-CALC-RESERVE
 12819         THRU 3599-REINSURE-CALC-RESERVE-X
 12820             VARYING SUB1 FROM +1 BY +1
 12821                 UNTIL REIN-COMP (SUB1) = SPACES.
 12822
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 251
* ECS010V.cbl
 12823     PERFORM 2400-BUILD-RESERVE-EXTRACT.
 12824     MOVE +0 TO RW-ACCUM-IBNR  RW-ACCUM-PAYCUR  RW-ACCUM-FUTRSV.
 12825     MOVE 'R'            TO DE-REIN.
 12826*****PERFORM EXTRACT-DATE-RELOAD.
 12827     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 12828     MOVE +1             TO SUB1.
 12829
 12830 3410-REINSURE-RESERVE-LOOP.
 12831
 12832     IF REIN-COMP (SUB1) = SPACES
 12833         GO TO 3490-REINSURE-RESERVE-PRINT.
 12834
 12835     IF REIN-REM-SW (SUB1) = 'Z'
 12836         ADD +1 TO SUB1
 12837         GO TO 3410-REINSURE-RESERVE-LOOP.
 12838
 12839     MOVE REIN-COMP (SUB1)      TO DE-REI-COMP.
 12840     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12841
 12842     IF PC-CLAIM-TYPE  = 1 OR 3
 12843         IF RWF-LF-RUNOFF-SW = 'N'
 12844           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12845               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12846
 12847     IF PC-CLAIM-TYPE  = 2 OR 4
 12848         IF RWF-AH-RUNOFF-SW = 'N'
 12849           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12850               GO TO 3415-REINSURE-RESERVE-LOOP-ADD.
 12851
 12852     MOVE RWF-LFAMT             TO DE-REI-LFAMT.
 12853     MOVE RWF-LFPRM             TO DE-REI-LFPRM.
 12854     MOVE RWF-AHAMT             TO DE-REI-AHAMT.
 12855     MOVE RWF-AHPRM             TO DE-REI-AHPRM.
 12856
 12857     IF PC-CLAIM-TYPE = 1 OR 3
 12858         MOVE RWF-DTH-IBNRL   TO DE-REI-IBNR
 12859         MOVE RWF-DTH-PAYCURL TO DE-REI-PAYCUR
 12860         MOVE RWF-DTH-FUTRSVL TO DE-REI-FUTRSV
 12861     ELSE
 12862         MOVE RWF-DIS-IBNRL   TO DE-REI-IBNR
 12863         MOVE RWF-DIS-PAYCURL TO DE-REI-PAYCUR
 12864         MOVE RWF-DIS-FUTRSVL TO DE-REI-FUTRSV.
 12865
 12866     ADD DE-REI-IBNR            TO RW-ACCUM-IBNR.
 12867     ADD DE-REI-PAYCUR          TO RW-ACCUM-PAYCUR.
 12868     ADD DE-REI-FUTRSV          TO RW-ACCUM-FUTRSV.
 12869
 12870     IF +0 NOT = DE-REI-LFAMT OR DE-REI-LFPRM OR DE-REI-AHAMT
 12871        OR DE-REI-AHPRM OR DE-REI-IBNR OR DE-REI-PAYCUR
 12872        OR DE-REI-FUTRSV
 12873         PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU
 12874                                            2599-WRT-DETAIL-X
 12875         ADD +1 TO BC-R-CRS.
 12876
 12877 3415-REINSURE-RESERVE-LOOP-ADD.
 12878
 12879     ADD +1 TO SUB1.
 12880     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 252
* ECS010V.cbl
 12881     PERFORM EXTRACT-DATE-LOAD.
 12882     GO TO 3410-REINSURE-RESERVE-LOOP.
 12883
 12884 3490-REINSURE-RESERVE-PRINT.
 12885
 12886     IF RW-ACCUM-IBNR   = ZERO  AND
 12887        RW-ACCUM-PAYCUR = ZERO  AND
 12888        RW-ACCUM-FUTRSV = ZERO
 12889         GO TO 3499-REINSURE-RESERVE-X.
 12890
 12891     PERFORM 8600-SETUP-DETAIL-LINE THRU 8689-SETUP-DETAIL-X.
 12892     MOVE RW-ACCUM-IBNR             TO TRD-IBNR.
 12893     MOVE 'IBNR'                    TO TRD-IBNRX.
 12894     MOVE RW-ACCUM-PAYCUR           TO TRD-PAYCUR.
 12895     MOVE 'PAY CURR'                TO TRD-PAYCURX.
 12896     MOVE RW-ACCUM-FUTRSV           TO TRD-FUTRSV.
 12897     MOVE 'FUTURE'                  TO TRD-FUTRSVX.
 12898
 12899     IF PC-CLAIM-TYPE = 1
 12900         MOVE LIFE-OVERRIDE-L6      TO TRD-RSV-DESC
 12901     ELSE
 12902         MOVE AH-OVERRIDE-L6        TO TRD-RSV-DESC.
 12903     MOVE ' REIN. CLAIM RESERVES'   TO TRD-RSV-ACTION.
 12904
 12905     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 12906
 12907 3499-REINSURE-RESERVE-X.
 12908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 253
* ECS010V.cbl
 12910******************************************************************
 12911***        C A L C U L A T E   R E I N   R E S E R V E S       ***
 12912******************************************************************
 12913
 12914 3500-REINSURE-CALC-RESERVE.
 12915
 12916     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.
 12917     MOVE +0 TO RWF-DTH-IBNRL RWF-DTH-PAYCURL  RWF-DTH-FUTRSVL
 12918                RWF-DIS-IBNRL  RWF-DIS-PAYCURL  RWF-DIS-FUTRSVL.
 12919
 12920     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 12921        VARYING CO-SUB FROM 1 BY 1 UNTIL
 12922          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))
 12923       OR (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT).
 12924
 12925     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT
 12926        MOVE ZERO TO CO-SUB.
 12927
 12928     IF CO-SUB NOT = ZERO
 12929        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12930           IF PC-CLAIM-TYPE = '1' OR '3'
 12931             IF CR-DTH-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12932                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12933
 12934     IF PC-CLAIM-TYPE  = 1 OR 3
 12935         IF RWF-LF-RUNOFF-SW = 'N'
 12936           IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE
 12937               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12938
 12939     IF CO-SUB NOT = ZERO
 12940        IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO
 12941           IF PC-CLAIM-TYPE = '2' OR '4'
 12942             IF CR-DIS-DT LESS THAN RCT-CLM-CUTOFF-DT (CO-SUB)
 12943                 GO TO 3540-CONT-REIN-CALC-RESERVE.
 12944
 12945     IF PC-CLAIM-TYPE  = 2 OR 4
 12946         IF RWF-AH-RUNOFF-SW = 'N'
 12947           IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE
 12948               GO TO 3540-CONT-REIN-CALC-RESERVE.
 12949
 12950     IF DTE-CLIENT NOT = 'MIC'
 12951         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12952
 12953     IF PC-CLAIM-TYPE = '1'  OR  '3'
 12954         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12955
 12956     MOVE PC-FUTURE-RESERVE-AMT        TO RW-AHFUTRSVWK.
 12957
 12958     IF CR-AHTYP = ZERO  OR
 12959        CO-SUB = ZERO
 12960         GO TO 3505-REIN-CALC-RESERVE-CONT
 12961     ELSE
 12962         IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 12963             GO TO 3505-REIN-CALC-RESERVE-CONT.
 12964
 12965     COMPUTE MAX-REM-TERM ROUNDED =
 12966                         RCT-AH-CLM-MAX (CO-SUB) / CR-AHAMT.
 12967
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 254
* ECS010V.cbl
 12968     IF MAX-REM-TERM NOT LESS THAN CP-REMAINING-TERM
 12969         GO TO 3505-REIN-CALC-RESERVE-CONT.
 12970
 12971     COMPUTE CP-ORIGINAL-TERM =
 12972                 CR-AH-TERM - CP-REMAINING-TERM + MAX-REM-TERM.
 12973
 12974     CALL 'ELRESVX' USING CALCULATION-PASS-AREA.
 12975
 12976     IF  CP-RETURN-CODE = ZERO
 12977         MOVE CP-FUTURE-RESERVE    TO RW-AHFUTRSVWK.
 12978
 12979 3505-REIN-CALC-RESERVE-CONT.
 12980
 12981     IF SUB1 = RE-100-COMP
 12982         GO TO 3520-REIN-REMAINDER-RSRV.
 12983
 12984     IF CR-LFAMT NOT = ZERO  AND
 12985        RWF-LFAMT NOT = ZERO
 12986         IF DTE-CLIENT NOT = 'MIC'
 12987             COMPUTE RWF-DTH-IBNRL = (RW-LFIBNRWK *
 12988                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12989             COMPUTE RWF-DTH-PAYCURL = (RW-LFPAYCURWK *
 12990                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12991             COMPUTE RWF-DTH-FUTRSVL = (RW-LFFUTRSVWK *
 12992                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 12993         ELSE
 12994             MOVE RW-LFIBNRWK         TO RWF-DTH-IBNRL
 12995             MOVE RW-LFPAYCURWK       TO RWF-DTH-PAYCURL
 12996             MOVE RW-LFFUTRSVWK       TO RWF-DTH-FUTRSVL.
 12997
 12998     IF CR-AHAMT NOT = ZERO  AND
 12999        RWF-AHAMT NOT = ZERO
 13000         IF DTE-CLIENT NOT = 'MIC'
 13001             COMPUTE RWF-DIS-IBNRL = (RW-AHIBNRWK *
 13002                         RWF-AHAMT) / CR-AHAMT
 13003             COMPUTE RWF-DIS-PAYCURL = (RW-AHPAYCURWK *
 13004                         RWF-AHAMT) / CR-AHAMT
 13005             COMPUTE RWF-DIS-FUTRSVL = (RW-AHFUTRSVWK *
 13006                         RWF-AHAMT) / CR-AHAMT
 13007         ELSE
 13008             MOVE RW-AHIBNRWK         TO RWF-DIS-IBNRL
 13009             MOVE RW-AHPAYCURWK       TO RWF-DIS-PAYCURL
 13010             MOVE RW-AHFUTRSVWK       TO RWF-DIS-FUTRSVL.
 13011
 13012 3510-REINSURE-CALC-RESERVE-ADD.
 13013
 13014     ADD RWF-DTH-IBNRL   TO RWF-DTH-IBNR.
 13015     ADD RWF-DTH-PAYCURL TO RWF-DTH-PAYCUR.
 13016     ADD RWF-DTH-FUTRSVL TO RWF-DTH-FUTRSV.
 13017     ADD RWF-DIS-IBNRL   TO RWF-DIS-IBNR.
 13018     ADD RWF-DIS-PAYCURL TO RWF-DIS-PAYCUR.
 13019     ADD RWF-DIS-FUTRSVL TO RWF-DIS-FUTRSV.
 13020
 13021     IF DTE-CLIENT NOT = 'MIC'  AND  'MCC'
 13022         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13023
 13024     IF CO-SUB = ZERO
 13025         GO TO 3519-REINSURE-CALC-RESERVE-END.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 255
* ECS010V.cbl
 13026
 13027 3513-REIN-CHK-LF-RSRV-LIMIT.
 13028     IF RCT-LF-CLM-MAX (CO-SUB) = ZERO
 13029         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13030
 13031     IF RWF-DTH-IBNR GREATER THAN RCT-LF-CLM-MAX (CO-SUB)
 13032         MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-DTH-IBNR.
 13033
 13034     COMPUTE EXCESS-RESERVE = RCT-LF-CLM-MAX (CO-SUB) -
 13035                                      (RWF-LFCLM +
 13036                                       RWF-DTH-PAYCUR +
 13037                                       RWF-DTH-FUTRSV).
 13038
 13039     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13040         GO TO 3515-REIN-CHK-AH-RSRV-LIMIT.
 13041
 13042     ADD EXCESS-RESERVE TO RWF-DTH-PAYCURL.
 13043
 13044     IF RWF-DTH-PAYCURL LESS THAN ZERO
 13045         ADD RWF-DTH-PAYCURL TO RWF-DTH-FUTRSVL
 13046         MOVE ZEROS TO RWF-DTH-PAYCURL.
 13047     IF RWF-DTH-FUTRSVL LESS THAN ZERO
 13048         MOVE ZEROS TO RWF-DTH-FUTRSVL.
 13049
 13050     ADD EXCESS-RESERVE TO RWF-DTH-PAYCUR.
 13051
 13052     IF RWF-DTH-PAYCUR LESS THAN ZERO
 13053         ADD RWF-DTH-PAYCUR TO RWF-DTH-FUTRSV
 13054         MOVE ZEROS TO RWF-DTH-PAYCUR.
 13055     IF RWF-DTH-FUTRSV LESS THAN ZERO
 13056         MOVE ZEROS TO RWF-DTH-FUTRSV.
 13057
 13058 3515-REIN-CHK-AH-RSRV-LIMIT.
 13059     IF RCT-AH-CLM-MAX (CO-SUB) = ZERO
 13060         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13061
 13062     IF RWF-DIS-IBNR GREATER THAN RCT-AH-CLM-MAX (CO-SUB)
 13063         MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-DIS-IBNR.
 13064
 13065     COMPUTE EXCESS-RESERVE = RCT-AH-CLM-MAX (CO-SUB) -
 13066                                      (RWF-AHCLM +
 13067                                       RWF-DIS-PAYCUR +
 13068                                       RWF-DIS-FUTRSV).
 13069
 13070     IF EXCESS-RESERVE NOT LESS THAN ZERO
 13071         GO TO 3519-REINSURE-CALC-RESERVE-END.
 13072
 13073     ADD EXCESS-RESERVE TO RWF-DIS-PAYCURL.
 13074
 13075     IF RWF-DIS-PAYCURL LESS THAN ZERO
 13076         ADD RWF-DIS-PAYCURL TO RWF-DIS-FUTRSVL
 13077         MOVE ZEROS TO RWF-DIS-PAYCURL.
 13078     IF RWF-DIS-FUTRSVL LESS THAN ZERO
 13079         MOVE ZEROS TO RWF-DIS-FUTRSVL.
 13080
 13081     ADD EXCESS-RESERVE TO RWF-DIS-PAYCUR.
 13082
 13083     IF RWF-DIS-PAYCUR LESS THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 256
* ECS010V.cbl
 13084         ADD RWF-DIS-PAYCUR TO RWF-DIS-FUTRSV
 13085         MOVE ZEROS TO RWF-DIS-PAYCUR.
 13086     IF RWF-DIS-FUTRSV LESS THAN ZERO
 13087         MOVE ZEROS TO RWF-DIS-FUTRSV.
 13088
 13089 3519-REINSURE-CALC-RESERVE-END.
 13090
 13091     IF +0 NOT = RWF-DTH-IBNR OR RWF-DTH-PAYCUR
 13092        OR RWF-DTH-FUTRSV
 13093         MOVE 'X' TO REIN-LF-FLG (SUB1).
 13094
 13095     IF +0 NOT = RWF-DIS-IBNR OR RWF-DIS-PAYCUR
 13096        OR RWF-DIS-FUTRSV
 13097         MOVE 'X' TO REIN-AH-FLG (SUB1).
 13098
 13099     GO TO 3540-CONT-REIN-CALC-RESERVE.
 13100
 13101 3520-REIN-REMAINDER-RSRV.
 13102
 13103     MOVE RW-LFIBNRWK   TO RWF-DTH-IBNRL.
 13104     MOVE RW-LFPAYCURWK TO RWF-DTH-PAYCURL.
 13105     MOVE RW-LFFUTRSVWK TO RWF-DTH-FUTRSVL.
 13106     MOVE RW-AHIBNRWK   TO RWF-DIS-IBNRL.
 13107     MOVE RW-AHPAYCURWK TO RWF-DIS-PAYCURL.
 13108     MOVE RW-AHFUTRSVWK TO RWF-DIS-FUTRSVL.
 13109
 13110     PERFORM 3530-REIN-SUB-RSRV
 13111         THRU 3539-REIN-SUB-RSRV-X
 13112             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.
 13113
 13114     GO TO 3510-REINSURE-CALC-RESERVE-ADD.
 13115
 13116 3530-REIN-SUB-RSRV.
 13117
 13118     SUBTRACT REIN-DTH-IBNRL (SUB2)   FROM RWF-DTH-IBNRL.
 13119     SUBTRACT REIN-DTH-PAYCURL (SUB2) FROM RWF-DTH-PAYCURL.
 13120     SUBTRACT REIN-DTH-FUTRSVL (SUB2) FROM RWF-DTH-FUTRSVL.
 13121     SUBTRACT REIN-DIS-IBNRL (SUB2)   FROM RWF-DIS-IBNRL.
 13122     SUBTRACT REIN-DIS-PAYCURL (SUB2) FROM RWF-DIS-PAYCURL.
 13123     SUBTRACT REIN-DIS-FUTRSVL (SUB2) FROM RWF-DIS-FUTRSVL.
 13124
 13125 3539-REIN-SUB-RSRV-X.
 13126     EXIT.
 13127
 13128 3540-CONT-REIN-CALC-RESERVE.
 13129
 13130     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 13131         MOVE 'X' TO REIN-BUS-FLAG.
 13132     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).
 13133
 13134 3599-REINSURE-CALC-RESERVE-X.
 13135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 257
* ECS010V.cbl
 13137******************************************************************
 13138***       R E I N S U R A N C E   C A L C U L A T I O N S      ***
 13139******************************************************************
 13140
 13141*REINSURANCE-CALCULATIONS.
*13142                             COPY ECSRIRTN.
 13143******************************************************************04/30/98
 13144*                                                                *ECSRIRTN
 13145*                            ECSRIRTN                            *   LV012
 13146*                            VMOD=2.025.                         *ECSRIRTN
 13147*                                                                *ECSRIRTN
 13148******************************************************************ECSRIRTN
 13149******************************************************************
 13150*                   C H A N G E   L O G
 13151*
 13152* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
 13153*-----------------------------------------------------------------
 13154*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
 13155* EFFECTIVE    NUMBER
 13156*-----------------------------------------------------------------
 13157* 062703                   PEMA  ADD DCC CLIENT ID TO
 13158*                                SPECIAL CEDED CLAIM CALC
 13159* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
 13160* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
 13161                                                                  ECSRIRTN
 13162 REINSURE-CALC.                                                   ECSRIRTN
 13163                                                                  ECSRIRTN
 13164     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
 13165     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13166     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
 13167     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
 13168                                   REIN-REM-SW (SUB1).            ECSRIRTN
 13169                                                                  ECSRIRTN
 13170     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
 13171                                   WS-RWF-EP-STOP-DATE-N             CL*12
 13172                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
 13173                                                                  ECSRIRTN
 13174     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13175                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
 13176                                   RWF-AH-RUNOFF-SW               ECSRIRTN
 13177                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13178                                                                  ECSRIRTN
 13179     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 13180        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 13181          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 13182          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 13183          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 13184                                                                  ECSRIRTN
 13185     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 13186        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 13187         GO TO CALC-CONTINUED.                                    ECSRIRTN
 13188                                                                  ECSRIRTN
 13189     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
 13190                                          WS-RWF-EP-STOP-DATE-N      CL*12
 13191                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
 13192                                                                  ECSRIRTN
 13193     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
 13194         GO TO CALC-CONTINUED.                                    ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 258
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13195                                                                  ECSRIRTN
 13196     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
 13197         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
 13198                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
 13199                                                                  ECSRIRTN
 13200     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
 13201         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
 13202                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
 13203                                                                  ECSRIRTN
 13204 CALC-CONTINUED.                                                  ECSRIRTN
 13205                                                                  ECSRIRTN
 13206     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
 13207     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
 13208                                                                  ECSRIRTN
 13209     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
 13210         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
 13211     ELSE                                                         ECSRIRTN
 13212         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
 13213     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
 13214                                                                  ECSRIRTN
 13215     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
 13216     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
 13217     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
 13218         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
 13219     ELSE                                                         ECSRIRTN
 13220         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
 13221     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
 13222                                                                  ECSRIRTN
 13223     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
 13224         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
 13225         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
 13226         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
 13227         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
 13228         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
 13229         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
 13230                                                                  ECSRIRTN
 13231     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13232         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
 13233                                                                  ECSRIRTN
 13234     IF CR-DT LESS WT-LO-DATE                                        CL**2
 13235         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13236                                                                  ECSRIRTN
 13237     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
 13238         GO TO REINSURE-CALC-X.                                   ECSRIRTN
 13239                                                                  ECSRIRTN
 13240     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
 13241     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
 13242                                                                  ECSRIRTN
 13243     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
 13244         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
 13245                                                                  ECSRIRTN
 13246     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
 13247       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13248        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
 13249        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
 13250           NEXT SENTENCE                                          ECSRIRTN
 13251       ELSE                                                       ECSRIRTN
 13252           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 259
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13253                       REIN-AH-FLG (SUB1).                        ECSRIRTN
 13254                                                                  ECSRIRTN
 13255     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13256         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13257            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
 13258             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
 13259                                                                  ECSRIRTN
 13260     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
 13261         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
 13262            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
 13263             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
 13264                                                                  ECSRIRTN
 13265     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
 13266         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
 13267             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
 13268                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
 13269             ELSE                                                 ECSRIRTN
 13270                 NEXT SENTENCE                                    ECSRIRTN
 13271         ELSE                                                     ECSRIRTN
 13272             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13273                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13274                                                                  ECSRIRTN
 13275     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
 13276         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
 13277             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
 13278                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
 13279             ELSE                                                 ECSRIRTN
 13280                 NEXT SENTENCE                                    ECSRIRTN
 13281         ELSE                                                     ECSRIRTN
 13282             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
 13283                         REIN-AH-FLG (SUB1).                      ECSRIRTN
 13284                                                                  ECSRIRTN
 13285     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
 13286         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
 13287                                                                  ECSRIRTN
 13288     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
 13289         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
 13290         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 13291                                                                  ECSRIRTN
 13292     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
 13293         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
 13294                                                                  ECSRIRTN
 13295     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
 13296         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
 13297         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
 13298                                                                  ECSRIRTN
 13299     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13300         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13301                                                                  ECSRIRTN
 13302     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13303         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13304                                                                  ECSRIRTN
 13305     GO TO REINSURE-CALC-X.                                       ECSRIRTN
 13306                                                                  ECSRIRTN
 13307 REINSURE-CK-LIFE.                                                ECSRIRTN
 13308                                                                  ECSRIRTN
 13309     IF CR-LFTYP = ZERO                                           ECSRIRTN
 13310         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 260
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13311                                                                  ECSRIRTN
 13312     IF WT-LF-PCT = ZERO                                          ECSRIRTN
 13313         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13314                                                                  ECSRIRTN
 13315     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13316         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
 13317             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13318                                                                  ECSRIRTN
 13319     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13320                                                                  ECSRIRTN
 13321     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
 13322         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
 13323             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13324         ELSE                                                     ECSRIRTN
 13325             NEXT SENTENCE                                        ECSRIRTN
 13326     ELSE                                                         ECSRIRTN
 13327         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
 13328             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13329                                                                  ECSRIRTN
 13330     IF CEDING-AD-D-ONLY                                          ECSRIRTN
 13331         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
 13332             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
 13333         ELSE                                                     ECSRIRTN
 13334             NEXT SENTENCE                                        ECSRIRTN
 13335     ELSE                                                         ECSRIRTN
 13336         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
 13337             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13338                                                                  ECSRIRTN
 13339     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13340         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
 13341             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13342                                                                  ECSRIRTN
 13343     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13344         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
 13345            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13346                                                                  ECSRIRTN
 13347     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
 13348         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
 13349             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13350                                                                  ECSRIRTN
 13351     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
 13352         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
 13353            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13354                                                                  ECSRIRTN
 13355     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13356         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13357             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13358                                                                  ECSRIRTN
 13359     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
 13360         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13361            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
 13362            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
 13363             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13364                                                                  ECSRIRTN
 13365     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
 13366         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
 13367            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
 13368             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 261
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13369                                                                  ECSRIRTN
 13370     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13371         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13372             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13373                                                                  ECSRIRTN
 13374     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13375         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
 13376             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13377                                                                  ECSRIRTN
 13378     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
 13379        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
 13380           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
 13381            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13382                                                                  ECSRIRTN
 13383     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13384         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13385            CR-IND-GRP = '1'                                      ECSRIRTN
 13386             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13387                                                                  ECSRIRTN
 13388     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
 13389         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13390            CR-IND-GRP = '1'                                      ECSRIRTN
 13391             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13392                                                                  ECSRIRTN
 13393     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
 13394         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13395            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
 13396            CR-IND-GRP = '1'                                      ECSRIRTN
 13397             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13398                                                                  ECSRIRTN
 13399     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
 13400         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
 13401            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
 13402            CR-IND-GRP = '1'                                      ECSRIRTN
 13403             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
 13404                                                                  ECSRIRTN
 13405     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13406         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
 13407            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
 13408                                                                  ECSRIRTN
 13409     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13410        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
 13411                                                                  ECSRIRTN
 13412     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
 13413         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13414                                                                  ECSRIRTN
 13415     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
 13416         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13417                                                                  ECSRIRTN
 13418     IF CR-LF-TERM  NUMERIC                                       00002331
 13419        NEXT SENTENCE                                             00002332
 13420     ELSE                                                         00002333
 13421        MOVE ZEROS               TO CR-LF-TERM                    00002334
 13422     END-IF
 13423                                                                  00002335
 13424     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
 13425         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13426                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 262
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13427     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
 13428         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13429                                                                  ECSRIRTN
 13430     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13431                                                                  ECSRIRTN
 13432     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
 13433         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13434                                                                  ECSRIRTN
 13435     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
 13436         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
 13437                                                                  ECSRIRTN
 13438     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
 13439                                                                  ECSRIRTN
 13440 REINSURE-CK-LIFE-X.                                              ECSRIRTN
 13441     EXIT.                                                        ECSRIRTN
 13442                                                                  ECSRIRTN
 13443 REINSURE-CK-AH.                                                  ECSRIRTN
 13444                                                                  ECSRIRTN
 13445     IF CR-AHTYP = ZERO                                           ECSRIRTN
 13446         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13447                                                                  ECSRIRTN
 13448     IF WT-AH-PCT = ZERO                                          ECSRIRTN
 13449         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13450                                                                  ECSRIRTN
 13451     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
 13452         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
 13453             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13454                                                                  ECSRIRTN
 13455     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
 13456                                                                  ECSRIRTN
 13457     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
 13458         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
 13459             GO TO REINSURE-CK-AH-X                               ECSRIRTN
 13460         ELSE                                                     ECSRIRTN
 13461             NEXT SENTENCE                                        ECSRIRTN
 13462     ELSE                                                         ECSRIRTN
 13463         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
 13464             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13465                                                                  ECSRIRTN
 13466     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
 13467         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
 13468             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13469                                                                  ECSRIRTN
 13470     IF CEDING-JOINT-ONLY                                         ECSRIRTN
 13471         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
 13472             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13473                                                                  ECSRIRTN
 13474     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
 13475         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
 13476             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13477                                                                  ECSRIRTN
 13478     IF CEDING-GROUP-ONLY                                         ECSRIRTN
 13479         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
 13480             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13481                                                                  ECSRIRTN
 13482     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
 13483         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
 13484            CR-IND-GRP = '1'                                      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 263
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13485             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13486                                                                  ECSRIRTN
 13487     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
 13488         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
 13489             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13490                                                                  ECSRIRTN
 13491     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
 13492         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
 13493            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13494                                                                  ECSRIRTN
 13495     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
 13496         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
 13497            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
 13498                                                                  ECSRIRTN
 13499     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
 13500         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
 13501             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
 13502                                                                  ECSRIRTN
 13503     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
 13504        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
 13505                                                                  ECSRIRTN
 13506     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
 13507         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13508                                                                  ECSRIRTN
 13509     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
 13510         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13511                                                                  ECSRIRTN
 13512     IF CR-AH-TERM  NUMERIC                                       00002331
 13513        NEXT SENTENCE                                             00002332
 13514     ELSE                                                         00002333
 13515        MOVE ZEROS               TO CR-AH-TERM                    00002334
 13516     END-IF
 13517                                                                  00002335
 13518     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
 13519         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13520                                                                  ECSRIRTN
 13521     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
 13522         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13523                                                                  ECSRIRTN
 13524     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13525                                                                  ECSRIRTN
 13526     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
 13527         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
 13528             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
 13529                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
 13530                                                                  ECSRIRTN
 13531     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
 13532         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
 13533             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
 13534                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
 13535                                                                  ECSRIRTN
 13536     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
 13537     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
 13538                                                                  ECSRIRTN
 13539     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
 13540         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
 13541                                                                  ECSRIRTN
 13542     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 264
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13543         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
 13544                                                                  ECSRIRTN
 13545     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
 13546                                                                  ECSRIRTN
 13547     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13548                                                                  ECSRIRTN
 13549     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
 13550         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13551                                                                  ECSRIRTN
 13552     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13553         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
 13554                                                                  ECSRIRTN
 13555     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
 13556                                                                  ECSRIRTN
 13557 REINSURE-CK-AH-X.                                                ECSRIRTN
 13558     EXIT.                                                        ECSRIRTN
 13559                                                                  ECSRIRTN
 13560 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
 13561                                                                  ECSRIRTN
 13562     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
 13563        RS-AH-BEN = ZERO                                          ECSRIRTN
 13564         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13565                                                                  ECSRIRTN
 13566     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
 13567        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13568         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
 13569                                                                  ECSRIRTN
 13570     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13571                                    REIN-AH-FLG (SUB1).           ECSRIRTN
 13572                                                                  ECSRIRTN
 13573     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13574         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13575             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
 13576                                     WT-AHBEN-HI.                 ECSRIRTN
 13577     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13578         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13579             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
 13580                                     WT-AHMOA-HI.                 ECSRIRTN
 13581                                                                  ECSRIRTN
 13582     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13583     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13584                                                                  ECSRIRTN
 13585     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13586         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
 13587                                                                  ECSRIRTN
 13588     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13589         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
 13590                                                                  ECSRIRTN
 13591     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
 13592                                                                  ECSRIRTN
 13593     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13594         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
 13595                                                                  ECSRIRTN
 13596     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
 13597         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
 13598                                       / RW-AHWRK                 ECSRIRTN
 13599       ELSE                                                       ECSRIRTN
 13600         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 265
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13601                                                                  ECSRIRTN
 13602     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
 13603         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
 13604                                       / RS-LIFE-BEN              ECSRIRTN
 13605       ELSE                                                       ECSRIRTN
 13606         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
 13607                                                                  ECSRIRTN
 13608     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
 13609        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
 13610          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13611          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13612                                      / CR-AH-TERM.               ECSRIRTN
 13613                                                                  ECSRIRTN
 13614     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13615        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
 13616          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13617          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13618               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13619            ELSE                                                  ECSRIRTN
 13620                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13621                                                                  ECSRIRTN
 13622     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
 13623        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
 13624        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
 13625          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
 13626          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
 13627                                      / CR-AH-TERM                ECSRIRTN
 13628         ELSE                                                     ECSRIRTN
 13629          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
 13630          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
 13631               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
 13632            ELSE                                                  ECSRIRTN
 13633                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
 13634                                                                  ECSRIRTN
 13635 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
 13636     EXIT.                                                        ECSRIRTN
 13637                                                                  ECSRIRTN
 13638                                                                  ECSRIRTN
 13639 REIN-CALC-LIFE.                                                  ECSRIRTN
 13640                                                                  ECSRIRTN
 13641     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
 13642         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
 13643     ELSE                                                         ECSRIRTN
 13644         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
 13645                                                                  ECSRIRTN
 13646     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
 13647         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
 13648     ELSE                                                         ECSRIRTN
 13649         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
 13650           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
 13651               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
 13652           ELSE                                                   ECSRIRTN
 13653               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
 13654                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
 13655                                                                  ECSRIRTN
 13656 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
 13657                                                                  ECSRIRTN
 13658     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 266
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13659                                                                  ECSRIRTN
 13660     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13661         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
 13662                                                                  ECSRIRTN
 13663     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13664         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
 13665         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13666                                                                  ECSRIRTN
 13667     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
 13668         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
 13669                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13670         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
 13671                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
 13672     ELSE                                                         ECSRIRTN
 13673         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13674             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
 13675             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
 13676                                                                  ECSRIRTN
 13677     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
 13678         (WT-LF-QC = '2' AND                                         CL**8
 13679          PGM-SUB = +50  AND                                         CL**8
 13680          DTE-CLIENT = 'LAP'))                                       CL**8
 13681          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
 13682     ELSE                                                         ECSRIRTN
 13683         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
 13684                                                                  ECSRIRTN
 13685     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13686         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
 13687         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
 13688         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
 13689                                                                  ECSRIRTN
 13690     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
 13691                                                                  ECSRIRTN
 13692 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
 13693                                                                  ECSRIRTN
 13694     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 13695         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
 13696         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
 13697                                                                  ECSRIRTN
 13698     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
 13699     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13700     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
 13701                                       RW-LFPRM.                  ECSRIRTN
 13702                                                                  ECSRIRTN
 13703 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
 13704                                                                  ECSRIRTN
 13705     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
 13706                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13707                                                                  ECSRIRTN
 13708     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13709        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13710                                                                  ECSRIRTN
 13711     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
 13712        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13713         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
 13714     ELSE                                                         ECSRIRTN
 13715         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13716         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 267
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13717                                                                  ECSRIRTN
 13718                                                                  ECSRIRTN
 13719 REIN-CALC-LIFE-X.                                                ECSRIRTN
 13720     EXIT.                                                        ECSRIRTN
 13721                                                                  ECSRIRTN
 13722 REIN-CALC-AH.                                                    ECSRIRTN
 13723                                                                  ECSRIRTN
 13724     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
 13725         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
 13726             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
 13727                                 WT-AHBEN-HI.                     ECSRIRTN
 13728                                                                  ECSRIRTN
 13729     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
 13730         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
 13731             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
 13732                                 WT-AHMOA-HI.                     ECSRIRTN
 13733                                                                  ECSRIRTN
 13734     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
 13735     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
 13736                                                                  ECSRIRTN
 13737     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
 13738         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
 13739                                                                  ECSRIRTN
 13740     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
 13741         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
 13742                                                                  ECSRIRTN
 13743     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
 13744         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
 13745                                                                  ECSRIRTN
 13746     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
 13747         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
 13748     ELSE                                                         ECSRIRTN
 13749         IF WT-REMAINING = 'L'                                    ECSRIRTN
 13750             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
 13751         ELSE                                                     ECSRIRTN
 13752             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
 13753             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
 13754                                                                  ECSRIRTN
 13755 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
 13756                                                                  ECSRIRTN
 13757     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13758         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
 13759                                                                  ECSRIRTN
 13760     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13761         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
 13762         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13763                                                                  ECSRIRTN
 13764     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
 13765         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
 13766                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13767         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
 13768                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
 13769     ELSE                                                         ECSRIRTN
 13770         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
 13771             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
 13772             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
 13773                                                                  ECSRIRTN
 13774     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 268
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13775         (WT-AH-QC = '2' AND                                         CL**8
 13776          PGM-SUB = +50  AND                                         CL**8
 13777          DTE-CLIENT = 'LAP'))                                       CL**8
 13778         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
 13779     ELSE                                                         ECSRIRTN
 13780         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
 13781                                                                  ECSRIRTN
 13782     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
 13783         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
 13784            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
 13785                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
 13786                                                                  ECSRIRTN
 13787     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
 13788         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
 13789         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
 13790         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
 13791                                                                  ECSRIRTN
 13792     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
 13793                                                                  ECSRIRTN
 13794 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
 13795                                                                  ECSRIRTN
 13796     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 13797         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
 13798         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
 13799                                                                  ECSRIRTN
 13800     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 13801     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 13802     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 13803                                    RW-AHPRM.                     ECSRIRTN
 13804                                                                  ECSRIRTN
 13805 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
 13806                                                                  ECSRIRTN
 13807     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
 13808                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 13809                                                                  ECSRIRTN
 13810     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 13811                                                                  ECSRIRTN
 13812     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
 13813        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13814         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
 13815     ELSE                                                         ECSRIRTN
 13816         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13817         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
 13818                                                                  ECSRIRTN
 13819                                                                  ECSRIRTN
 13820 REIN-CALC-AH-X.                                                  ECSRIRTN
 13821     EXIT.                                                        ECSRIRTN
 13822                                                                  ECSRIRTN
 13823 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
 13824                                                                  ECSRIRTN
 13825     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
 13826     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
 13827     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
 13828     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
 13829                                                                  ECSRIRTN
 13830     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
 13831         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
 13832                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 269
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13833     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
 13834        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
 13835           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
 13836                                                                  ECSRIRTN
 13837     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
 13838        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
 13839           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
 13840                                                                  ECSRIRTN
 13841 REINSURE-CALC-X.                                                 ECSRIRTN
 13842                                                                  ECSRIRTN
 13843     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 13844         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 13845                                                                  ECSRIRTN
 13846     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 13847                                                                  ECSRIRTN
 13848 REINSURE-SUBTRACT.                                               ECSRIRTN
 13849                                                                  ECSRIRTN
 13850     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
 13851     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
 13852     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
 13853     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
 13854                                                                  ECSRIRTN
 13855 REINSURE-SUBTRACT-X.                                             ECSRIRTN
 13856     EXIT.                                                        ECSRIRTN
 13857                                                                  ECSRIRTN
 13858 REINSURE-CALC-CANCEL.                                            ECSRIRTN
 13859                                                                  ECSRIRTN
 13860     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 13861     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 13862                                                                  ECSRIRTN
 13863     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 13864         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
 13865                                                                  ECSRIRTN
 13866     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13867         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13868                                                                  ECSRIRTN
 13869     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 13870         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
 13871             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
 13872                                                                  ECSRIRTN
 13873     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13874         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
 13875                                                                  ECSRIRTN
 13876     IF WT-REMAINING = 'L'                                        ECSRIRTN
 13877         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
 13878         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13879                                                                  ECSRIRTN
 13880     IF CR-LFPRM = ZERO                                           ECSRIRTN
 13881        MOVE ZERO                TO REIN-FACTOR
 13882     ELSE                                                         ECSRIRTN
 13883        IF DTE-CLIENT = 'GIC'  AND
 13884           CLAS-I-BAL (CLAS-INDEXL) = 'B'
 13885           MOVE +1.0             TO REIN-FACTOR
 13886        ELSE
 13887           IF DTE-CLIENT = 'DCC'
 13888              COMPUTE REIN-FACTOR = CR-LFRFND /
 13889                 (CR-LFPRM + CR-LFPRM-ALT)
 13890           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 270
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13891              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 13892                 (CR-LFPRM + CR-LFPRM-ALT)
 13893            END-IF
 13894         END-IF
 13895     END-IF
 13896                                                                  ECSRIRTN
 13897     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 13898         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 13899             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13900                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
 13901                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13902             ELSE                                                 ECSRIRTN
 13903                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13904                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13905                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
 13906                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 13907         ELSE                                                     ECSRIRTN
 13908             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13909                 compute rein-factor rounded =
 13910                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 13911                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
 13912                    rein-factor
 13913             ELSE                                                 ECSRIRTN
 13914*                COMPUTE RWF-LFRFND = REIN-FACTOR
 13915*                   * REIN-CALCED-LIFE *
 13916*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
 13917                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13918                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13919                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
 13920                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
 13921                                                                  ECSRIRTN
 13922     IF CR-LFAMT = ZERO                                           ECSRIRTN
 13923         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 13924             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
 13925                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13926                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
 13927             ELSE                                                 ECSRIRTN
 13928                 COMPUTE RWF-LFRFND =                             ECSRIRTN
 13929                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
 13930                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
 13931                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
 13932                                                                  ECSRIRTN
 13933     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
 13934                                                                  ECSRIRTN
 13935                                                                  ECSRIRTN
 13936 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
 13937                                                                  ECSRIRTN
 13938     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 13939       (CR-LF-CANC-DT = ZEROS)                                       CL*10
 13940         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13941         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13942                                                                  ECSRIRTN
 13943     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 13944       IF VOIDING-LF-CANCEL                                       ECSRIRTN
 13945           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
 13946           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
 13947       ELSE                                                       ECSRIRTN
 13948           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 271
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 13949               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
 13950                                                                  ECSRIRTN
 13951     IF FLAT-CANCEL-LF                                            ECSRIRTN
 13952         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
 13953         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13954                                                                  ECSRIRTN
 13955     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
 13956         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
 13957         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
 13958                                                                  ECSRIRTN
 13959     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
 13960     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
 13961     MOVE +0                          TO REIN-WORKA               ECSRIRTN
 13962                                         RW-LFRFND.               ECSRIRTN
 13963                                                                  ECSRIRTN
 13964 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
 13965                                                                  ECSRIRTN
 13966     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
 13967                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
 13968                                                                  ECSRIRTN
 13969     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
 13970        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
 13971                                                                  ECSRIRTN
 13972     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
 13973        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 13974         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
 13975     ELSE                                                         ECSRIRTN
 13976         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 13977         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
 13978                                                                  ECSRIRTN
 13979                                                                  ECSRIRTN
 13980 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
 13981                                                                  ECSRIRTN
 13982     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 13983         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13984                                                                  ECSRIRTN
 13985     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 13986         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
 13987             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
 13988                                                                  ECSRIRTN
 13989     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 13990         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
 13991         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
 13992             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
 13993                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 13994         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 13995                                                                  ECSRIRTN
 13996     IF WT-REMAINING = 'I'                                        ECSRIRTN
 13997         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
 13998                                                                  ECSRIRTN
 13999     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14000         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
 14001         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14002                                                                  ECSRIRTN
 14003     IF CR-AHPRM = ZERO                                           ECSRIRTN
 14004        MOVE ZERO                TO REIN-FACTOR
 14005     ELSE
 14006        IF DTE-CLIENT = 'GIC'  AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 272
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14007           CLAS-I-BAL (CLAS-INDEXA) = 'B'
 14008            MOVE +1.0            TO REIN-FACTOR
 14009        ELSE
 14010           IF DTE-CLIENT = 'DCC'
 14011              COMPUTE REIN-FACTOR =
 14012                 CR-AHRFND / CR-AHPRM
 14013           ELSE
 14014              COMPUTE REIN-FACTOR ROUNDED =
 14015                                CR-AHRFND-CALC / CR-AHPRM
 14016           END-IF
 14017        END-IF
 14018     END-IF
 14019
 14020     IF CR-AHAMT NOT = ZERO
 14021        IF (DTE-CLIENT = 'DCC')
 14022           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
 14023           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
 14024        ELSE
 14025           IF WT-AH-QC = ('1' OR '4')
 14026              compute rein-factor rounded = rwf-ahamt / cr-ahamt
 14027              compute rwf-ahrfnd rounded =
 14028                 cr-ahrfnd * rein-factor
 14029           ELSE
 14030              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
 14031              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
 14032                       RWF-AHAMT) / CR-AHAMT
 14033           END-IF
 14034        END-IF
 14035     ELSE
 14036        IF RWF-AH-LIMIT = ZERO
 14037           IF WT-AH-QC = ('1' OR '4')
 14038              COMPUTE RWF-AHRFND ROUNDED =
 14039                       CR-AHRFND * WT-AH-PCT
 14040           ELSE
 14041              COMPUTE RWF-AHRFND =
 14042                            REIN-FACTOR * REIN-CALCED-AH
 14043              COMPUTE RWF-AHRFND ROUNDED =
 14044                       RWF-AHRFND * WT-AH-PCT
 14045           END-IF
 14046        END-IF
 14047     END-IF
 14048
 14049     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
 14050                                                                  ECSRIRTN
 14051                                                                  ECSRIRTN
 14052 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
 14053                                                                  ECSRIRTN
 14054     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
 14055       (CR-AH-CANC-DT = ZEROS)                                       CL*10
 14056         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14057         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14058                                                                  ECSRIRTN
 14059     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14060       IF VOIDING-AH-CANCEL                                       ECSRIRTN
 14061           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
 14062           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
 14063       ELSE                                                       ECSRIRTN
 14064           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 273
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14065               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
 14066                                                                  ECSRIRTN
 14067     IF FLAT-CANCEL-AH                                            ECSRIRTN
 14068         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
 14069         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14070                                                                  ECSRIRTN
 14071     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
 14072         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
 14073         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
 14074                                                                  ECSRIRTN
 14075     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
 14076     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
 14077     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
 14078                                    RW-AHRFND.                    ECSRIRTN
 14079                                                                  ECSRIRTN
 14080 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
 14081                                                                  ECSRIRTN
 14082     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
 14083                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
 14084                                                                  ECSRIRTN
 14085     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
 14086                                                                  ECSRIRTN
 14087     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
 14088        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
 14089         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
 14090     ELSE                                                         ECSRIRTN
 14091         ADD +1 TO REIN-WORKA                                     ECSRIRTN
 14092         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
 14093                                                                  ECSRIRTN
 14094                                                                  ECSRIRTN
 14095 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
 14096                                                                  ECSRIRTN
 14097     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14098         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14099                                                                  ECSRIRTN
 14100     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14101         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14102                                                                  ECSRIRTN
 14103     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
 14104                                                                  ECSRIRTN
 14105 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
 14106                                                                  ECSRIRTN
 14107     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
 14108     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
 14109                                                                  ECSRIRTN
 14110     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
 14111         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
 14112             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14113                                                                  ECSRIRTN
 14114     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
 14115         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14116                                                                  ECSRIRTN
 14117     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
 14118         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14119                                                                  ECSRIRTN
 14120 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
 14121                                                                  ECSRIRTN
 14122     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 274
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14123         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14124                                                                  ECSRIRTN
 14125     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14126                                                                  ECSRIRTN
 14127 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
 14128                                                                  ECSRIRTN
 14129     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
 14130     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
 14131                                                                  ECSRIRTN
 14132 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
 14133     EXIT.                                                        ECSRIRTN
 14134                                                                  ECSRIRTN
 14135 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
 14136                                                                  ECSRIRTN
 14137     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14138         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
 14139                                                                  ECSRIRTN
 14140 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
 14141     EXIT.                                                        ECSRIRTN
 14142                                                                  ECSRIRTN
 14143 REINSURE-CALC-CLAIM.                                             ECSRIRTN
 14144                                                                  ECSRIRTN
 14145     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
 14146     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
 14147                                                                  ECSRIRTN
 14148     IF SUB1 = RE-100-COMP                                        ECSRIRTN
 14149         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
 14150                                                                  ECSRIRTN
 14151     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
 14152        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
 14153          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
 14154          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
 14155          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
 14156                                                                  ECSRIRTN
 14157     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
 14158        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
 14159          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
 14160                                                                  ECSRIRTN
 14161     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
 14162                                  RWF-AHCLML.                     ECSRIRTN
 14163                                                                  ECSRIRTN
 14164     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14165         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14166                                                                  ECSRIRTN
 14167     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
 14168         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14169                                                                  ECSRIRTN
 14170     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14171         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14172             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
 14173                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14174                                                                  ECSRIRTN
 14175     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
 14176         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14177                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
 14178                                                                  ECSRIRTN
 14179     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14180         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 275
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14181                                                                  ECSRIRTN
 14182     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14183         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14184             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
 14185                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14186             ELSE                                                 ECSRIRTN
 14187                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
 14188         ELSE                                                     ECSRIRTN
 14189             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
 14190                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
 14191                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
 14192             ELSE                                                 ECSRIRTN
 14193                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
 14194                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
 14195                                                                  ECSRIRTN
 14196     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14197         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14198                                                                  ECSRIRTN
 14199     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
 14200         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
 14201            OR 'DCC'
 14202             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
 14203                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
 14204         ELSE                                                     ECSRIRTN
 14205             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
 14206                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
 14207                                                                  ECSRIRTN
 14208     IF CR-LFAMT = ZERO                                           ECSRIRTN
 14209         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
 14210             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14211                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
 14212                                                                  ECSRIRTN
 14213     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14214         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14215             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
 14216                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
 14217                                                                  ECSRIRTN
 14218     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14219         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14220             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14221               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
 14222                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14223                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14224                  ELSE                                            ECSRIRTN
 14225                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
 14226                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
 14227              ELSE                                                ECSRIRTN
 14228                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
 14229                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
 14230                     COMPUTE RWF-LFCLML =                         ECSRIRTN
 14231                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
 14232                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
 14233                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
 14234                                                                  ECSRIRTN
 14235     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14236                                                                  ECSRIRTN
 14237     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
 14238                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 276
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14239                                                                  ECSRIRTN
 14240 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
 14241                                                                  ECSRIRTN
 14242     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
 14243         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14244                                                                  ECSRIRTN
 14245     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
 14246         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
 14247     ELSE                                                         ECSRIRTN
 14248         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
 14249                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
 14250                                                                  ECSRIRTN
 14251     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14252         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
 14253                                                                  ECSRIRTN
 14254     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14255         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
 14256             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14257         ELSE                                                     ECSRIRTN
 14258             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
 14259     ELSE                                                         ECSRIRTN
 14260         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
 14261             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
 14262             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
 14263         ELSE                                                     ECSRIRTN
 14264             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
 14265             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
 14266                                                                  ECSRIRTN
 14267                                                                  ECSRIRTN
 14268 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
 14269                                                                  ECSRIRTN
 14270     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
 14271         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
 14272                                                                  ECSRIRTN
 14273     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14274         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14275                                                                  ECSRIRTN
 14276     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
 14277         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
 14278                                                                  ECSRIRTN
 14279     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
 14280     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
 14281                                                                  ECSRIRTN
 14282     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
 14283             VARYING                                              ECSRIRTN
 14284         INC-SUB FROM +1 BY +1                                    ECSRIRTN
 14285             UNTIL                                                ECSRIRTN
 14286         INC-SUB GREATER THAN +5.                                 ECSRIRTN
 14287                                                                  ECSRIRTN
 14288     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14289         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
 14290     ELSE                                                         ECSRIRTN
 14291         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
 14292                                                                  ECSRIRTN
 14293 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
 14294                                                                  ECSRIRTN
 14295     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
 14296         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 277
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14297                                                                  ECSRIRTN
 14298     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14299       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
 14300           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
 14301                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
 14302               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14303                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14304               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
 14305                                                                  ECSRIRTN
 14306     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14307       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
 14308           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
 14309                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
 14310           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
 14311                                                                  ECSRIRTN
 14312     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
 14313         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14314                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14315                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
 14316         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14317                                                                  ECSRIRTN
 14318     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14319         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14320                                                                  ECSRIRTN
 14321     IF INC-SUB = +1                                              ECSRIRTN
 14322         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14323     IF INC-SUB = +2                                              ECSRIRTN
 14324         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14325     IF INC-SUB = +3                                              ECSRIRTN
 14326         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14327     IF INC-SUB = +4                                              ECSRIRTN
 14328         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14329     IF INC-SUB = +5                                              ECSRIRTN
 14330         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
 14331                                                                  ECSRIRTN
 14332     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14333                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14334                                                                  ECSRIRTN
 14335     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14336         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
 14337                                                                  ECSRIRTN
 14338     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
 14339              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
 14340         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
 14341     ELSE                                                         ECSRIRTN
 14342         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
 14343                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
 14344                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
 14345                                                                  ECSRIRTN
 14346 CHECK-DISABS-EXIT.                                               ECSRIRTN
 14347      EXIT.                                                       ECSRIRTN
 14348                                                                  ECSRIRTN
 14349 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
 14350                                                                  ECSRIRTN
 14351     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
 14352         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14353                                                                  ECSRIRTN
 14354     IF CO-SUB NOT = ZERO                                         ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 278
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14355         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
 14356             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
 14357                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
 14358                                                                  ECSRIRTN
 14359     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
 14360         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
 14361             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
 14362                                                                  ECSRIRTN
 14363 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
 14364                                                                  ECSRIRTN
 14365     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
 14366         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
 14367         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
 14368             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
 14369                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
 14370         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
 14371         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14372                                                                  ECSRIRTN
 14373     IF WT-REMAINING = 'I'                                        ECSRIRTN
 14374         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
 14375                                                                  ECSRIRTN
 14376     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14377         IF REIN-RT-SW = 'X'                                      ECSRIRTN
 14378             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
 14379                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14380             ELSE                                                 ECSRIRTN
 14381                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
 14382         ELSE                                                     ECSRIRTN
 14383             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
 14384                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
 14385                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
 14386             ELSE                                                 ECSRIRTN
 14387                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
 14388                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
 14389                                                                  ECSRIRTN
 14390     IF WT-REMAINING = 'L'                                        ECSRIRTN
 14391         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14392                                                                  ECSRIRTN
 14393     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14394         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
 14395                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
 14396     ELSE                                                         ECSRIRTN
 14397         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
 14398             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14399                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
 14400                                                                  ECSRIRTN
 14401     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14402         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
 14403             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
 14404                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
 14405                                                                  ECSRIRTN
 14406     IF CO-SUB NOT = ZERO                                         ECSRIRTN
 14407         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
 14408             IF REIN-RT-SW = 'X'                                  ECSRIRTN
 14409               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
 14410                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14411                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14412                  ELSE                                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 279
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14413                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
 14414                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
 14415              ELSE                                                ECSRIRTN
 14416                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
 14417                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
 14418                     COMPUTE RWF-AHCLML =                         ECSRIRTN
 14419                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
 14420                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
 14421                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
 14422                                                                  ECSRIRTN
 14423                                                                  ECSRIRTN
 14424     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
 14425        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
 14426                               '220000' OR '230000')              ECSRIRTN
 14427           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
 14428               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
 14429                                                                  ECSRIRTN
 14430     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14431                                                                  ECSRIRTN
 14432     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
 14433                                                                  ECSRIRTN
 14434                                                                  ECSRIRTN
 14435 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
 14436                                                                  ECSRIRTN
 14437     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
 14438         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14439                                                                  ECSRIRTN
 14440     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14441         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
 14442         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14443                                                                  ECSRIRTN
 14444     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
 14445                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
 14446                                                                  ECSRIRTN
 14447     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
 14448         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14449                                                                  ECSRIRTN
 14450     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14451         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
 14452                                                                  ECSRIRTN
 14453     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
 14454                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
 14455         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
 14456                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
 14457         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
 14458     ELSE                                                         ECSRIRTN
 14459         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
 14460         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
 14461                                                                  ECSRIRTN
 14462                                                                  ECSRIRTN
 14463 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
 14464                                                                  ECSRIRTN
 14465     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14466         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14467                                                                  ECSRIRTN
 14468     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14469         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14470                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 280
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14471     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
 14472                                                                  ECSRIRTN
 14473 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
 14474                                                                  ECSRIRTN
 14475     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
 14476     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
 14477                                                                  ECSRIRTN
 14478     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
 14479         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
 14480             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
 14481                                                                  ECSRIRTN
 14482     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
 14483     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
 14484                                                                  ECSRIRTN
 14485     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
 14486         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
 14487                                                                  ECSRIRTN
 14488     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
 14489         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
 14490                                                                  ECSRIRTN
 14491 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
 14492                                                                  ECSRIRTN
 14493     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
 14494         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
 14495                                                                  ECSRIRTN
 14496     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
 14497                                                                  ECSRIRTN
 14498 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
 14499                                                                  ECSRIRTN
 14500     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
 14501     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
 14502                                                                  ECSRIRTN
 14503 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
 14504     EXIT.                                                        ECSRIRTN
 14505                                                                  ECSRIRTN
 14506 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
 14507                                                                  ECSRIRTN
 14508     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
 14509         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
 14510                                                                  ECSRIRTN
 14511 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
 14512     EXIT.                                                        ECSRIRTN
 14513                                                                  ECSRIRTN
 14514                                                                  ECSRIRTN
 14515 CLEAR-REIN-HOLD.                                                 ECSRIRTN
 14516                                                                  ECSRIRTN
 14517     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
 14518     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
 14519     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
 14520     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
 14521                                                                  ECSRIRTN
 14522     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
 14523         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
 14524         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
 14525         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
 14526         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
 14527         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
 14528         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 281
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14529         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
 14530         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
 14531         REIN-AH-LIMIT (1).                                       ECSRIRTN
 14532                                                                  ECSRIRTN
 14533     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
 14534         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
 14535                                                                  ECSRIRTN
 14536     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
 14537                                                                  ECSRIRTN
 14538 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
 14539                                                                  ECSRIRTN
 14540     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
 14541                                                                  ECSRIRTN
 14542 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
 14543     EXIT.                                                        ECSRIRTN
 14544                                                                  ECSRIRTN
 14545 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
 14546                                                                  ECSRIRTN
 14547     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
 14548                                                                  ECSRIRTN
 14549     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
 14550         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
 14551                                                                  ECSRIRTN
 14552     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
 14553         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
 14554             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
 14555                                                                  ECSRIRTN
 14556     IF REIN-RT-SW = 'X'                                          ECSRIRTN
 14557         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
 14558         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
 14559         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
 14560     ELSE                                                         ECSRIRTN
 14561         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
 14562         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
 14563         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
 14564                                                                  ECSRIRTN
 14565     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
 14566                                                                  ECSRIRTN
 14567     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
 14568        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
 14569         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
 14570                                                                  ECSRIRTN
 14571     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
 14572         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
 14573                                                                  ECSRIRTN
 14574 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
 14575     EXIT.                                                        ECSRIRTN
 14576                                                                  ECSRIRTN
 14577 REIN-FIND-CO-LOOP.                                               ECSRIRTN
 14578                                                                  ECSRIRTN
 14579     CONTINUE.                                                    ECSRIRTN
 14580*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
 14581 FIND-REI-CO-EXIT.                                                ECSRIRTN
 14582     EXIT.                                                        ECSRIRTN
 14583                                                                  ECSRIRTN
 14584 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
 14585                                                                  ECSRIRTN
 14586     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 282
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14587         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14588                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14589                                                                  ECSRIRTN
 14590     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
 14591         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
 14592                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
 14593                                                                  ECSRIRTN
 14594     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
 14595                                                                  ECSRIRTN
 14596     START ERRTBL-IN                                              ECSRIRTN
 14597           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
 14598             INVALID KEY                                          ECSRIRTN
 14599               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
 14600                                                                  ECSRIRTN
 14601     MOVE 0 TO CO-SUB.                                            ECSRIRTN
 14602     MOVE 0 TO SUB1.                                              ECSRIRTN
 14603 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
 14604                                                                  ECSRIRTN
 14605     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
 14606                                                                  ECSRIRTN
 14607     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
 14608        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
 14609                                                                  ECSRIRTN
 14610     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
 14611        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
 14612        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
 14613                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14614        GO TO ABEND-PGM.                                          ECSRIRTN
 14615                                                                  ECSRIRTN
 14616     IF RE-CODE NOT = 'B'                                         ECSRIRTN
 14617        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
 14618                                                                  ECSRIRTN
 14619     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
 14620        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
 14621                                                                  ECSRIRTN
 14622     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
 14623        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
 14624                                                                  ECSRIRTN
 14625     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
 14626        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
 14627                                                                  ECSRIRTN
 14628     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
 14629        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         ( 188)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14630                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
 14631        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 282)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14632                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
 14633        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 282)**
**    Index-name belongs to different table - unexpected behaviour may occur
 14634                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
 14635     END-PERFORM.                                                 ECSRIRTN
 14636     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
 14637                                                                  ECSRIRTN
 14638     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 283
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14639        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
 14640                                                                  ECSRIRTN
 14641     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
 14642        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
 14643                                                                  ECSRIRTN
 14644     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14645        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
 14646                                                                  ECSRIRTN
 14647     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
 14648        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
 14649                                                                  ECSRIRTN
 14650     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
 14651        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
 14652        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
 14653        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
 14654        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
 14655        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
 14656        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
 14657          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
 14658                                                                  ECSRIRTN
 14659     ADD +1 TO CO-SUB.                                            ECSRIRTN
 14660                                                                  ECSRIRTN
 14661     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
 14662        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
 14663        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
 14664        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
 14665        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14666                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14667        GO TO ABEND-PGM.                                          ECSRIRTN
 14668                                                                  ECSRIRTN
 14669     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
 14670                                                                  ECSRIRTN
 14671     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
 14672                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
 14673     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
 14674                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
 14675     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
 14676                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
 14677                                                                  ECSRIRTN
 14678     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
 14679         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
 14680     ELSE                                                         ECSRIRTN
 14681         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
 14682                                                                  ECSRIRTN
 14683     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
 14684     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
 14685     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
 14686     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
 14687                                                                  ECSRIRTN
 14688 REIN-CO-BUILD-EPR.                                               ECSRIRTN
 14689                                                                  ECSRIRTN
 14690     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
 14691        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
 14692                                                                  ECSRIRTN
 14693     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14694        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
 14695                                                                  ECSRIRTN
 14696     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 284
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14697        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
 14698                                                                  ECSRIRTN
 14699     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
 14700        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
 14701                                                                  ECSRIRTN
 14702     ADD +1 TO SUB1.                                              ECSRIRTN
 14703                                                                  ECSRIRTN
 14704     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
 14705        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
 14706        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
 14707                                  TO WS-ABEND-MESSAGE             ECSRIRTN
 14708        GO TO ABEND-PGM.                                          ECSRIRTN
 14709                                                                  ECSRIRTN
 14710     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
 14711     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
 14712     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
 14713     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
 14714     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
 14715     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
 14716     if re-state-exhibit-opt-f = 'Y'
 14717        move 'Y'         to rc2-ecs152-rpt (sub1)
 14718     else
 14719        move 'N'         to rc2-ecs152-rpt (sub1)
 14720     end-if
 14721                                                                  ECSRIRTN
 14722     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
 14723                                                                  ECSRIRTN
 14724 REIN-BUILD-EXIT.                                                 ECSRIRTN
 14725     EXIT.                                                        ECSRIRTN
 14726                                                                  ECSRIRTN
 14727 ZERO-RCT-ENTRIES.                                                ECSRIRTN
 14728                                                                  ECSRIRTN
 14729     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
 14730                                                                  ECSRIRTN
 14731     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
 14732                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
 14733                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
 14734                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
 14735                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
 14736                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
 14737                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14738                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
 14739                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
 14740                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
 14741                                                                  ECSRIRTN
 14742 ZERO-RCT-EXIT.                                                   ECSRIRTN
 14743     EXIT.                                                        ECSRIRTN
 14744                                                                  ECSRIRTN
 14745 ZERO-RC2-ENTRIES.                                                ECSRIRTN
 14746                                                                  ECSRIRTN
 14747     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
 14748                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
 14749     move spaces      to rc2-ecs152-rpt (co-sub)
 14750                                                                  ECSRIRTN
 14751     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
 14752                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
 14753                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
 14754                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 285
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
 14755                                                                  ECSRIRTN
 14756 ZERO-RC2-EXIT.                                                   ECSRIRTN
 14757     EXIT.                                                        ECSRIRTN
 14758******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 286
* ECS010V.cbl
 14760******************************************************************
 14761***   R E C A L C U L A T I O N   O F   R E I N S U R A N C E  ***
 14762******************************************************************
 14763
 14764 3600-RC-REINSURANCE.
 14765
 14766     IF DTE-PGM-OPT NOT = '1'
 14767         GO TO 3799-RC-REINSURANCE-X.
 14768
 14769     IF DTE-CLIENT = 'WSL'
 14770         IF CR-REIN-TABLE = '00A'
 14771             GO TO 3799-RC-REINSURANCE-X.
 14772
 14773     IF CR-REIN-TABLE = SPACES OR ZEROS
 14774         PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14775
 14776 3610-CLEAR-RC-REIN.
 14777
 14778     MOVE SPACES TO RC-REIN-LEVELS (1).
 14779     MOVE ZEROS  TO RC-REIN-LFAMT (1)
 14780                    RC-REIN-LFPRM (1)
 14781                    RC-REIN-AHAMT (1)
 14782                    RC-REIN-AHPRM (1)
 14783                    RC-REIN-LFRFND (1)
 14784                    RC-REIN-AHRFND (1)
 14785                    RC-REIN-LFCLM (1)
 14786                    RC-REIN-AHCLM (1).
 14787
 14788     PERFORM 3620-CLEAR-RC-LEVELS VARYING SUB1 FROM +2 BY +1
 14789         UNTIL RC-REIN-COMP (SUB1) = SPACES.
 14790
 14791     MOVE +1 TO SUB1.
 14792     MOVE +0 TO SUB2.
 14793
 14794     GO TO 3630-RC-REIN-LOOP-1.
 14795
 14796 3620-CLEAR-RC-LEVELS.
 14797
 14798     MOVE RC-REIN-LEVELS (1) TO RC-REIN-LEVELS (SUB1).
 14799
 14800
 14801 3630-RC-REIN-LOOP-1.
 14802
 14803     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES
 14804         ADD +1 TO SUB2
 14805         MOVE REIN-COMP (SUB1)   TO RC-REIN-COMP (SUB2)
 14806         MOVE REIN-LFAMT (SUB1)  TO RC-REIN-LFAMT (SUB2)
 14807         MOVE REIN-LFPRM (SUB1)  TO RC-REIN-LFPRM (SUB2)
 14808         MOVE REIN-AHAMT (SUB1)  TO RC-REIN-AHAMT (SUB2)
 14809         MOVE REIN-AHPRM (SUB1)  TO RC-REIN-AHPRM (SUB2)
 14810         MOVE REIN-LFRFND (SUB1) TO RC-REIN-LFRFND (SUB2)
 14811         MOVE REIN-AHRFND (SUB1) TO RC-REIN-AHRFND (SUB2)
 14812         MOVE REIN-LFCLM (SUB1)  TO RC-REIN-LFCLM (SUB2)
 14813         MOVE REIN-AHCLM (SUB1)  TO RC-REIN-AHCLM (SUB2)
 14814         MOVE REIN-REM-SW (SUB1) TO RC-REIN-REM-SW (SUB2).
 14815
 14816     ADD +1 TO SUB1.
 14817     IF REIN-COMP (SUB1) NOT = SPACES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 287
* ECS010V.cbl
 14818         GO TO 3630-RC-REIN-LOOP-1.
 14819
 14820     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
 14821
 14822     MOVE AM-REI-TABLE TO CR-REIN-TABLE.
 14823     IF CR-REIN-TABLE = SPACES OR ZEROS
 14824         MOVE +1                     TO SUB1
 14825         GO TO 3710-RC-REIN-LOOP-2.
 14826
 14827     PERFORM 3010-RR-READ-REIN THRU 3019-RR-READ-REIN-X.
 14828
 14829 3640-NSP-REIN-RATING-ROUTINE.
 14830
 14831     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 14832     MOVE 'L'                        TO DC-OPTION-CODE.
 14833     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 14834     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 14835     MOVE SPACES                     TO CP-ACCT-FLD-5.
 14836     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 14837     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 14838     MOVE CR-APR                     TO CP-LOAN-APR.
 14839     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 14840     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 14841     MOVE ZEROS                      TO CP-DEVIATION-CODE.
 14842     MOVE ZEROS                      TO CP-CLASS-CODE.
 14843
 14844     IF DTE-CLIENT = 'TIC'
 14845        IF CR-REIN-TABLE = '01T' OR '02T' OR '03T'
 14846            MOVE ZERO                TO CP-CLASS-CODE
 14847        ELSE
 14848            MOVE CR-RATING-CLASS     TO CP-CLASS-CODE.
 14849
 14850     MOVE '3'                        TO CP-PROCESS-TYPE.
 14851     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 14852     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 14853
 14854 3650-NSP-REIN-LIFE.
 14855
 14856     IF CR-LFTYP = ZERO
 14857         GO TO 3660-NSP-REIN-AH.
 14858     IF (RE-NSP-ST-CD-LF = ZEROS OR SPACES)
 14859        OR (DTE-CLIENT = 'DCC')
 14860         GO TO 3660-NSP-REIN-AH.
 14861     IF DTE-CLIENT NOT = 'LBL'
 14862         IF (CLAS-I-BAL (CLAS-INDEXL) = 'B')
 14863             GO TO 3660-NSP-REIN-AH.
 14864
 14865     IF RE-NSP-ST-CD-LF NOT = STATE-L
 14866         MOVE RE-NSP-ST-CD-LF        TO STATE-L
 14867         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14868
 14869     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 14870     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM.
 14871     MOVE CR-LFAMT                   TO CP-ORIGINAL-BENEFIT
 14872                                        CP-RATING-BENEFIT-AMT.
 14873     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 14874     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 14875     MOVE CR-LFTYP                   TO CP-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 288
* ECS010V.cbl
 14876     MOVE LIFE-OVERRIDE-L1           TO CP-LIFE-OVERRIDE-CODE.
 14877     MOVE AM-LF-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14878     MOVE RE-NSP-ST-CD-LF            TO CP-STATE.
 14879     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14880
 14881     IF CP-STATE-STD-ABBRV = 'OR'
 14882         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 14883
 14884     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14885
 14886     IF CP-ERROR-RATE-NOT-FOUND  OR
 14887        CP-ERROR-RATE-IS-ZERO
 14888         MOVE 'LIFE NET SINGLE PREMIUM RATE NOT FOUND'
 14889                                     TO WS-ABEND-MESSAGE
 14890         MOVE 0302                   TO WS-ABEND-CODE
 14891         DISPLAY '******************************'
 14892         DISPLAY '***** ERROR LOCATION 018 *****'
 14893         DISPLAY '******************************'
 14894         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14895         GO TO ABEND-PGM.
 14896
 14897     MOVE CP-CALC-PREMIUM          TO CR-LF-NSP-PRM.
 14898
 14899*    COMPUTE CR-LF-NSP-PRM ROUNDED =
 14900*                      (CR-LFAMT / 100) * CP-PREMIUM-RATE.
 14901
 14902     COMPUTE CR-LF-NSP-PRM ROUNDED =  CR-LF-NSP-PRM +
 14903                   ((CR-LFAMT-ALT / 100) * CP-PREMIUM-RATE).
 14904
 14905     MOVE CP-PREMIUM-RATE            TO CR-LF-NSP-PRM-RATE.
 14906
 14907 3660-NSP-REIN-AH.
 14908
 14909     IF CR-AHTYP = ZERO
 14910         GO TO 3669-NSP-REIN-X.
 14911     IF (RE-NSP-ST-CD-AH = ZEROS OR SPACES)
 14912        OR (DTE-CLIENT = 'DCC')
 14913         GO TO 3669-NSP-REIN-X.
 14914     IF DTE-CLIENT NOT = 'LBL'
 14915         IF (CLAS-I-BAL (CLAS-INDEXA) = 'B')
 14916             GO TO 3669-NSP-REIN-X.
 14917
 14918     IF RE-NSP-ST-CD-AH NOT = STATE-L
 14919         MOVE RE-NSP-ST-CD-AH        TO STATE-L
 14920         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 14921
 14922     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 14923     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM.
 14924     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 14925                                        CP-RATING-BENEFIT-AMT.
 14926     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 14927     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 14928     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 14929     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 14930     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 14931     MOVE RE-NSP-ST-CD-AH            TO CP-STATE.
 14932     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 14933
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 289
* ECS010V.cbl
 14934     IF CP-STATE-STD-ABBRV = 'OR'
 14935         COMPUTE CP-RATING-BENEFIT-AMT = CR-AHAMT * CR-AH-TERM.
 14936
 14937     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 14938
 14939     IF CP-ERROR-RATE-NOT-FOUND  OR
 14940        CP-ERROR-RATE-IS-ZERO
 14941         MOVE 'A&H NET SINGLE PREMIUM RATE NOT FOUND'
 14942                                     TO WS-ABEND-MESSAGE
 14943         MOVE 0302                   TO WS-ABEND-CODE
 14944         DISPLAY '******************************'
 14945         DISPLAY '***** ERROR LOCATION 019 *****'
 14946         DISPLAY '******************************'
 14947         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 14948         GO TO ABEND-PGM.
 14949
 14950     COMPUTE CR-AH-NSP-PRM ROUNDED =
 14951             ((CR-AHAMT * CR-AH-TERM) / 100) * CP-PREMIUM-RATE.
 14952
 14953     MOVE CP-PREMIUM-RATE            TO CR-AH-NSP-PRM-RATE.
 14954
 14955 3669-NSP-REIN-X.
 14956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 290
* ECS010V.cbl
 14958******************************************************************
 14959***        R E C A L C U L A T E   R E I N S U R A N C E       ***
 14960******************************************************************
 14961
 14962 3700-RC-REIN-PERF-CALC.
 14963
*14964                             COPY ECSRTPFM.
 14965******************************************************************07/10/97
 14966*                                                                *ECSRTPFM
 14967*                            ECSRTPFM                            *   LV001
 14968*                            VMOD=2.002                          *ECSRTPFM
 14969*                                                                *ECSRTPFM
 14970******************************************************************ECSRTPFM
 14971                                                                  ECSRTPFM
 14972     IF    CR-LFAMT  NUMERIC                                      00000072
 14973           NEXT SENTENCE                                          00000073
 14974        ELSE                                                      00000074
 14975           MOVE ZEROS TO CR-LFAMT.                                00000075
 14976                                                                  00000076
 14977     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
 14978           NEXT SENTENCE                                          00000078
 14979        ELSE                                                      00000079
 14980           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
 14981                                                                  00000081
 14982                                                                  00000082
 14983     IF    CR-LFPRM  NUMERIC                                      00000083
 14984           NEXT SENTENCE                                          00000084
 14985        ELSE                                                      00000085
 14986           MOVE ZEROS TO CR-LFPRM.                                00000086
 14987                                                                  00000087
 14988     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
 14989           NEXT SENTENCE                                          00000089
 14990        ELSE                                                      00000090
 14991           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
 14992                                                                  00000092
 14993                                                                  00000093
 14994     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
 14995           NEXT SENTENCE                                          00000095
 14996        ELSE                                                      00000096
 14997           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
 14998                                                                  00000098
 14999     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
 15000           NEXT SENTENCE                                          00000100
 15001        ELSE                                                      00000101
 15002           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
 15003                                                                  00000103
 15004     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
 15005           NEXT SENTENCE                                          00000105
 15006        ELSE                                                      00000106
 15007           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
 15008                                                                  00000108
 15009     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
 15010     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
 15011     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
 15012         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
 15013     ELSE                                                         ECSRTPFM
 15014         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
 15015     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 291
* ECS010V.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
 15016                                                                  ECSRTPFM
 15017     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
 15018     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
 15019     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
 15020         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
 15021     ELSE                                                         ECSRTPFM
 15022         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
 15023     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
 15024                                                                  ECSRTPFM
 15025     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
 15026         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
 15027             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
 15028                                                                  ECSRTPFM
 15029
 15030     IF CR-STATE NOT = STATE-L
 15031         MOVE CR-STATE               TO STATE-L
 15032         PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 15033
 15034     MOVE 'X'                     TO REIN-RT-SW.
 15035     PERFORM 3200-REINSURE-CANCEL THRU 3299-REINSURE-CANCEL-X.
 15036     PERFORM 3300-REINSURE-CLAIM THRU 3399-REINSURE-CLAIM-X.
 15037     MOVE ' '                     TO REIN-RT-SW.
 15038
 15039 3710-RC-REIN-LOOP-2.
 15040
 15041     IF REIN-COMP (SUB1) = SPACES
 15042         GO TO 3730-RC-REIN-EXTRACTS.
 15043
 15044     IF REIN-LF-AH-FLGS (SUB1) = SPACES
 15045        ADD +1 TO SUB1
 15046         GO TO 3710-RC-REIN-LOOP-2.
 15047
 15048     MOVE +1 TO SUB2.
 15049
 15050 3720-RC-REIN-LOOP-3.
 15051
 15052     IF RC-REIN-COMP (SUB2) = SPACES
 15053         ADD +1 TO SUB1
 15054         GO TO 3710-RC-REIN-LOOP-2.
 15055
 15056     IF REIN-COMP (SUB1) NOT = RC-REIN-COMP (SUB2)
 15057         ADD +1 TO SUB2
 15058         GO TO 3720-RC-REIN-LOOP-3.
 15059
 15060     IF REIN-LFAMT (SUB1) = RC-REIN-LFAMT (SUB2)
 15061        AND REIN-LFPRM (SUB1) = RC-REIN-LFPRM (SUB2)
 15062        AND REIN-AHAMT (SUB1) = RC-REIN-AHAMT (SUB2)
 15063        AND REIN-AHPRM (SUB1) = RC-REIN-AHPRM (SUB2)
 15064         MOVE 'X' TO RC-OLD-ISS (SUB2)
 15065         MOVE 'X' TO RC-NEW-ISS (SUB1).
 15066
 15067     IF REIN-LFRFND (SUB1) = RC-REIN-LFRFND (SUB2)
 15068        AND REIN-AHRFND (SUB1) = RC-REIN-AHRFND (SUB2)
 15069         MOVE 'X' TO RC-OLD-CNC (SUB2)
 15070         MOVE 'X' TO RC-NEW-CNC (SUB1).
 15071
 15072     IF REIN-LFCLM (SUB1) = RC-REIN-LFCLM (SUB2)
 15073         MOVE 'X' TO RC-OLD-LF-CLM (SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 292
* ECS010V.cbl
 15074         MOVE 'X' TO RC-NEW-LF-CLM (SUB1).
 15075
 15076     IF REIN-AHCLM (SUB1) = RC-REIN-AHCLM (SUB2)
 15077         MOVE 'X' TO RC-OLD-AH-CLM (SUB2)
 15078         MOVE 'X' TO RC-NEW-AH-CLM (SUB1).
 15079
 15080     ADD +1 TO SUB2.
 15081     GO TO 3720-RC-REIN-LOOP-3.
 15082
 15083 3730-RC-REIN-EXTRACTS.
 15084
 15085     PERFORM 2000-INITIALIZE-DETAIL-EXTRACT THRU 2099-INIT-DTL-X.
 15086     MOVE 'R' TO DE-REIN.
 15087     MOVE 'J' TO DE-TRANS.
 15088*****PERFORM EXTRACT-DATE-RELOAD.
 15089     MOVE DETAIL-EXTRACT TO SAVE-EXTRACT.
 15090     MOVE +1 TO SUB1.
 15091
 15092 3740-RC-REIN-OLD-ISSUE.
 15093
 15094     IF RC-REIN-COMP (SUB1) = SPACES
 15095         MOVE +1 TO SUB1
 15096         GO TO 3745-RC-REIN-NEW-ISSUE.
 15097
 15098     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15099         ADD +1 TO SUB1
 15100         GO TO 3740-RC-REIN-OLD-ISSUE.
 15101
 15102     IF RC-OLD-ISS (SUB1) = 'X'
 15103         ADD +1 TO SUB1
 15104         GO TO 3740-RC-REIN-OLD-ISSUE.
 15105
 15106     IF RC-REIN-LFAMT (SUB1) = ZERO
 15107        AND RC-REIN-LFPRM (SUB1) = ZERO
 15108        AND RC-REIN-AHAMT (SUB1) = ZERO
 15109        AND RC-REIN-AHPRM (SUB1) = ZERO
 15110         ADD +1 TO SUB1
 15111         GO TO 3740-RC-REIN-OLD-ISSUE.
 15112
 15113     MOVE SAVE-EXTRACT TO DETAIL-EXTRACT.
 15114     PERFORM EXTRACT-DATE-LOAD.
 15115     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15116     MULTIPLY RC-REIN-LFAMT (SUB1) BY -1 GIVING DE-REI-LFAMT.
 15117     MULTIPLY RC-REIN-LFPRM (SUB1) BY -1 GIVING DE-REI-LFPRM.
 15118     MULTIPLY RC-REIN-AHAMT (SUB1) BY -1 GIVING DE-REI-AHAMT.
 15119     MULTIPLY RC-REIN-AHPRM (SUB1) BY -1 GIVING DE-REI-AHPRM.
 15120     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15121
 15122     ADD +1 TO BC-R-ISS.
 15123     ADD +1 TO SUB1.
 15124     GO TO 3740-RC-REIN-OLD-ISSUE.
 15125
 15126 3745-RC-REIN-NEW-ISSUE.
 15127
 15128     IF REIN-COMP (SUB1) = SPACES
 15129         PERFORM 2200-BUILD-CANCEL-EXTRACT THRU
 15130                                         2259-END-CANCEL-BUILD
 15131         MOVE 'R'      TO DE-REIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 293
* ECS010V.cbl
 15132         MOVE 'K'      TO DE-TRANS
 15133*********PERFORM EXTRACT-DATE-RELOAD
 15134         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15135         MOVE +1       TO SUB1
 15136         GO TO 3750-RC-REIN-OLD-CANCEL.
 15137
 15138     IF REIN-REM-SW (SUB1) = 'Z'
 15139         ADD +1 TO SUB1
 15140         GO TO 3745-RC-REIN-NEW-ISSUE.
 15141
 15142     IF RC-NEW-ISS (SUB1) = 'X'
 15143         ADD +1 TO SUB1
 15144         GO TO 3745-RC-REIN-NEW-ISSUE.
 15145
 15146     IF REIN-LFAMT (SUB1) = ZERO
 15147        AND REIN-LFPRM (SUB1) = ZERO
 15148        AND REIN-AHAMT (SUB1) = ZERO
 15149        AND REIN-AHPRM (SUB1) = ZERO
 15150         ADD +1 TO SUB1
 15151         GO TO 3745-RC-REIN-NEW-ISSUE.
 15152
 15153     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15154     PERFORM EXTRACT-DATE-LOAD.
 15155     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15156     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15157     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15158     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15159     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15160     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15161
 15162     ADD +1 TO BC-R-ISS.
 15163     ADD +1 TO SUB1.
 15164     GO TO 3745-RC-REIN-NEW-ISSUE.
 15165
 15166 3750-RC-REIN-OLD-CANCEL.
 15167
 15168     IF RC-REIN-COMP (SUB1) = SPACES
 15169         MOVE +1 TO SUB1
 15170         GO TO 3755-RC-REIN-NEW-CANCEL.
 15171
 15172     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15173         ADD +1 TO SUB1
 15174         GO TO 3750-RC-REIN-OLD-CANCEL.
 15175
 15176     IF RC-OLD-CNC (SUB1) = 'X'
 15177         ADD +1 TO SUB1
 15178         GO TO 3750-RC-REIN-OLD-CANCEL.
 15179
 15180     IF RC-REIN-LFRFND (SUB1) = ZERO
 15181        AND RC-REIN-AHRFND (SUB1) = ZERO
 15182         ADD +1 TO SUB1
 15183         GO TO 3750-RC-REIN-OLD-CANCEL.
 15184
 15185     MOVE SAVE-EXTRACT        TO DETAIL-EXTRACT.
 15186     PERFORM EXTRACT-DATE-LOAD.
 15187     MOVE RC-REIN-COMP (SUB1) TO DE-REI-COMP.
 15188     MULTIPLY RC-REIN-LFRFND (SUB1) BY -1 GIVING DE-REI-LFRFND.
 15189     MULTIPLY RC-REIN-AHRFND (SUB1) BY -1 GIVING DE-REI-AHRFND.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 294
* ECS010V.cbl
 15190     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15191
 15192     ADD +1 TO BC-R-CNC.
 15193     ADD +1 TO SUB1.
 15194     GO TO 3750-RC-REIN-OLD-CANCEL.
 15195
 15196 3755-RC-REIN-NEW-CANCEL.
 15197
 15198     IF REIN-COMP (SUB1) = SPACES
 15199         PERFORM 2000-INITIALIZE-DETAIL-EXTRACT
 15200         MOVE 'R' TO DE-REIN
 15201         MOVE 'L' TO DE-TRANS
 15202*********PERFORM EXTRACT-DATE-RELOAD
 15203         MOVE DETAIL-EXTRACT TO SAVE-EXTRACT
 15204         MOVE +1 TO SUB1
 15205         GO TO 3760-RC-REIN-OLD-CLAIM.
 15206
 15207     IF REIN-REM-SW (SUB1) = 'Z'
 15208         ADD +1 TO SUB1
 15209         GO TO 3755-RC-REIN-NEW-CANCEL.
 15210
 15211     IF RC-NEW-CNC (SUB1) = 'X'
 15212         ADD +1 TO SUB1
 15213         GO TO 3755-RC-REIN-NEW-CANCEL.
 15214
 15215     IF REIN-LFRFND (SUB1) = ZERO
 15216        AND REIN-AHRFND (SUB1) = ZERO
 15217         ADD +1 TO SUB1
 15218         GO TO 3755-RC-REIN-NEW-CANCEL.
 15219
 15220     MOVE SAVE-EXTRACT       TO DETAIL-EXTRACT.
 15221     PERFORM EXTRACT-DATE-LOAD.
 15222     MOVE REIN-COMP (SUB1)   TO DE-REI-COMP.
 15223     MOVE REIN-LFRFND (SUB1) TO DE-REI-LFRFND.
 15224     MOVE REIN-AHRFND (SUB1) TO DE-REI-AHRFND.
 15225     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15226
 15227     ADD +1 TO BC-R-CNC.
 15228     ADD +1 TO SUB1.
 15229     GO TO 3755-RC-REIN-NEW-CANCEL.
 15230
 15231 3760-RC-REIN-OLD-CLAIM.
 15232
 15233     IF RC-REIN-COMP (SUB1) = SPACES
 15234         MOVE +1 TO SUB1
 15235         GO TO 3780-RC-REIN-NEW-CLAIM.
 15236
 15237     IF RC-REIN-REM-SW (SUB1) = 'Z'
 15238         ADD +1 TO SUB1
 15239         GO TO 3760-RC-REIN-OLD-CLAIM.
 15240
 15241     IF RC-OLD-LF-CLM (SUB1) = 'X'
 15242         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15243
 15244     IF RC-REIN-LFCLM (SUB1) = ZERO
 15245         GO TO 3770-RC-REIN-OLD-AH-CLM.
 15246
 15247     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 295
* ECS010V.cbl
 15248     PERFORM EXTRACT-DATE-LOAD.
 15249     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15250     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15251     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15252     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15253     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15254     MULTIPLY RC-REIN-LFCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15255     MOVE CR-DTHAMT     TO DE-CLAIM-AMT.
 15256     ADD  CR-DTHEXP     TO DE-CLAIM-AMT.
 15257     MOVE CR-DTH-PAY-DT TO DE-PAY
 15258                           WS-DE-PAY-N.
 15259
 15260     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15261         MOVE '3' TO DE-TYPE
 15262     ELSE
 15263         MOVE '1' TO DE-TYPE.
 15264
 15265     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15266
 15267     ADD +1 TO BC-R-CLM.
 15268
 15269 3770-RC-REIN-OLD-AH-CLM.
 15270
 15271     IF RC-OLD-AH-CLM (SUB1) = 'X'
 15272         ADD +1 TO SUB1
 15273         GO TO 3760-RC-REIN-OLD-CLAIM.
 15274
 15275     IF RC-REIN-AHCLM (SUB1) = ZERO
 15276         ADD +1 TO SUB1
 15277         GO TO 3760-RC-REIN-OLD-CLAIM.
 15278
 15279     MOVE SAVE-EXTRACT         TO DETAIL-EXTRACT.
 15280     PERFORM EXTRACT-DATE-LOAD.
 15281     MOVE RC-REIN-COMP (SUB1)  TO DE-REI-COMP.
 15282     MOVE RC-REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15283     MOVE RC-REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15284     MOVE RC-REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15285     MOVE RC-REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15286     MULTIPLY RC-REIN-AHCLM (SUB1) BY -1 GIVING DE-REI-CLAIM-AMT.
 15287     MOVE CR-DISAMT     TO DE-CLAIM-AMT.
 15288     ADD  CR-DISEXP     TO DE-CLAIM-AMT.
 15289     MOVE CR-DIS-PAY-DT TO DE-PAY
 15290                           WS-DE-PAY-N.
 15291
 15292     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15293         MOVE '4' TO DE-TYPE
 15294     ELSE
 15295         MOVE '2' TO DE-TYPE.
 15296
 15297     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15298
 15299     ADD +1 TO BC-R-CLM.
 15300     ADD +1 TO SUB1.
 15301
 15302     GO TO 3760-RC-REIN-OLD-CLAIM.
 15303
 15304 3780-RC-REIN-NEW-CLAIM.
 15305
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 296
* ECS010V.cbl
 15306     IF REIN-COMP (SUB1) = SPACES
 15307         GO TO 3799-RC-REINSURANCE-X.
 15308
 15309     IF REIN-REM-SW (SUB1) = 'Z'
 15310         ADD +1 TO SUB1
 15311         GO TO 3780-RC-REIN-NEW-CLAIM.
 15312
 15313     IF RC-NEW-LF-CLM (SUB1) = 'X'
 15314         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15315
 15316     IF REIN-LFCLM (SUB1) = ZERO
 15317         GO TO 3790-RC-REIN-NEW-AH-CLM.
 15318
 15319     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15320     PERFORM EXTRACT-DATE-LOAD.
 15321     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15322     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15323     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15324     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15325     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15326     MOVE REIN-LFCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15327     MOVE CR-DTHAMT         TO DE-CLAIM-AMT.
 15328     ADD  CR-DTHEXP         TO DE-CLAIM-AMT.
 15329     MOVE CR-DTH-PAY-DT     TO DE-PAY
 15330                               WS-DE-PAY-N.
 15331
 15332     IF CLAS-I-BAL (CLAS-INDEXL) = 'B'
 15333         MOVE '3' TO DE-TYPE
 15334     ELSE
 15335         MOVE '1' TO DE-TYPE.
 15336
 15337     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15338
 15339     ADD +1 TO BC-R-CLM.
 15340
 15341 3790-RC-REIN-NEW-AH-CLM.
 15342
 15343     IF RC-NEW-AH-CLM (SUB1) = 'X'
 15344         ADD +1 TO SUB1
 15345         GO TO 3780-RC-REIN-NEW-CLAIM.
 15346
 15347     IF REIN-AHCLM (SUB1) = ZERO
 15348         ADD +1 TO SUB1
 15349         GO TO 3780-RC-REIN-NEW-CLAIM.
 15350
 15351     MOVE SAVE-EXTRACT      TO DETAIL-EXTRACT.
 15352     PERFORM EXTRACT-DATE-LOAD.
 15353     MOVE REIN-COMP (SUB1)  TO DE-REI-COMP.
 15354     MOVE REIN-LFAMT (SUB1) TO DE-REI-LFAMT.
 15355     MOVE REIN-LFPRM (SUB1) TO DE-REI-LFPRM.
 15356     MOVE REIN-AHAMT (SUB1) TO DE-REI-AHAMT.
 15357     MOVE REIN-AHPRM (SUB1) TO DE-REI-AHPRM.
 15358     MOVE REIN-AHCLM (SUB1) TO DE-REI-CLAIM-AMT.
 15359     MOVE CR-DISAMT         TO DE-CLAIM-AMT.
 15360     ADD  CR-DISEXP         TO DE-CLAIM-AMT.
 15361     MOVE CR-DIS-PAY-DT     TO DE-PAY
 15362                               WS-DE-PAY-N.
 15363
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 297
* ECS010V.cbl
 15364     IF CLAS-I-BAL (CLAS-INDEXA) = 'B'
 15365         MOVE '4' TO DE-TYPE
 15366     ELSE
 15367         MOVE '2' TO DE-TYPE.
 15368
 15369     PERFORM 2500-WRITE-DETAIL-EXTRACTS THRU 2599-WRT-DETAIL-X.
 15370
 15371     ADD +1 TO BC-R-CLM.
 15372     ADD +1 TO SUB1.
 15373
 15374     GO TO 3780-RC-REIN-NEW-CLAIM.
 15375
 15376 3799-RC-REINSURANCE-X.
 15377     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 298
* ECS010V.cbl
 15379******************************************************************
 15380***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
 15381******************************************************************
 15382
 15383 4000-EP-BUMP-RTN.
 15384
 15385     IF AM-RECALC-COMM = ('Y' OR '1')
 15386        PERFORM 1600-RECALC-COMM-EXTR
 15387                                 THRU 1899-RECALC-COMM-EXTR-X
 15388        MOVE ' '                 TO RECALC-TYPE
 15389     END-IF
 15390
 15391     MOVE '1'    TO EP-FLG.
 15392     ADD +1      TO BC-G-CERTS.
 15393
 15394     MOVE CR-DT               TO HIGH-CERT.
 15395     IF CR-ACCT-CONTROL NOT = LOW-CTL
 15396         MOVE CR-DT           TO LOW-CERT
 15397         MOVE CR-ACCT-CONTROL TO LOW-CTL.
 15398
 15399     IF CR-POLICY-IS-REIN-ONLY
 15400         MOVE +0           TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15401                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15402                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15403                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15404                              DTH-IBNR           DIS-IBNR
 15405                              DTH-PAYCUR         DIS-PAYCUR
 15406                              DTH-FUTRSV         DIS-FUTRSV
 15407         GO TO 4050-EP-DO-REINSURE.
 15408
 15409     MOVE CR-LFAMT       TO WE-LFAMT.
 15410     MOVE CR-LFPRM       TO WE-LFPRM.
 15411     IF CR-LFTYP NOT = ZEROS
 15412         IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 15413             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
 15414             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
 15415         ELSE
 15416             MOVE ZEROS               TO WE-LFAMT-ALT
 15417                                         WE-LFPRM-ALT.
 15418
 15419     MOVE SPACES         TO REIN-EP-FLG
 15420                            WE-REIN-CO.
 15421     MOVE CR-LFRFND      TO WE-LFRFND.
 15422     MOVE CR-DTHAMT      TO WE-DTHAMT.
 15423     ADD  CR-DTHEXP      TO WE-DTHAMT.
 15424     MOVE CR-DTHEXP      TO WE-DTHEXP.
 15425     MOVE CR-NUM-DTH-CLM TO WE-NUM-DTH-CLM.
 15426     MOVE DTH-IBNR       TO WE-DTH-IBNR.
 15427     MOVE DTH-PAYCUR     TO WE-DTH-PAYCUR.
 15428     MOVE DTH-FUTRSV     TO WE-DTH-FUTRSV.
 15429
 15430     MOVE CR-AHPRM       TO WE-AHPRM.
 15431     MOVE CR-AHAMT       TO WE-AHAMT.
 15432     MOVE CR-AHRFND      TO WE-AHRFND.
 15433     MOVE CR-DISAMT      TO WE-DSPY-AMT.
 15434     ADD  CR-DISEXP      TO WE-DSPY-AMT.
 15435     MOVE CR-DISEXP      TO WE-DSPY-EXP.
 15436     MOVE CR-NUM-DIS-CLM TO WE-NUM-DIS-CLM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 299
* ECS010V.cbl
 15437     MOVE DIS-IBNR       TO WE-DIS-IBNR.
 15438     MOVE DIS-PAYCUR     TO WE-DIS-PAYCUR.
 15439     MOVE DIS-FUTRSV     TO WE-DIS-FUTRSV.
 15440
 15441     IF CR-POLICY-IS-RESTORE  OR
 15442        CR-POLICY-IS-REISSUE
 15443        OR CR-POLICY-IS-MONTHLY
 15444         MOVE ZEROS      TO WE-LFPRM
 15445                            WE-LFPRM-ALT
 15446                            WE-AHPRM.
 15447
 15448     MOVE +0               TO GROSS-ISS-BEN-LF   GROSS-ISS-BEN-AH
 15449                              GROSS-CNC-BEN-LF   GROSS-CNC-BEN-AH
 15450                              GROSS-ISS-PRM-LF   GROSS-ISS-PRM-AH
 15451                              GROSS-CNC-PRM-LF   GROSS-CNC-PRM-AH
 15452                              DTH-IBNR           DIS-IBNR
 15453                              DTH-PAYCUR         DIS-PAYCUR
 15454                              DTH-FUTRSV         DIS-FUTRSV.
 15455
 15456     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15457
 15458     IF CR-POLICY-IS-DECLINED  OR
 15459        CR-POLICY-IS-VOID
 15460         GO TO 4099-EP-BUMP-RTN-X.
 15461
 15462 4050-EP-DO-REINSURE.
 15463
 15464     MOVE 'R' TO REIN-EP-FLG.
 15465     MOVE +1  TO SUB5.
 15466
 15467 4090-EP-DO-REINSURE-LOOP.
 15468
 15469     IF REIN-COMP (SUB5) = SPACES
 15470         MOVE SPACE TO REIN-EP-FLG
 15471         GO TO 4099-EP-BUMP-RTN-X.
 15472
 15473     IF REIN-REM-SW (SUB5) = 'Z'  OR
 15474        REIN-LF-AH-FLGS (SUB5) = SPACES
 15475         ADD +1 TO SUB5
 15476         GO TO 4090-EP-DO-REINSURE-LOOP.
 15477
 15478     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT
 15479        VARYING CO-SUB FROM 1 BY 1 UNTIL
 15480          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB5))  OR
 15481          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR
 15482          (RCT-REIN-CO (CO-SUB) = SPACES).
 15483
 15484     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR
 15485        (RCT-REIN-CO (CO-SUB) = SPACES)
 15486        MOVE ZERO TO CO-SUB.
 15487
 15488     ADD +1 TO BC-R-CERTS.
 15489     MOVE REIN-COMP (SUB5)      TO WE-REIN-CO.
 15490     MOVE REIN-WORK-FLDS (SUB5) TO RWF-FIELDS.
 15491     MOVE RE-COMP-INFO (SUB5)   TO WT-COMP-INFO
 15492
 15493     IF DTE-CLIENT = 'DCC'
 15494        COMPUTE WS-CEDE-FACT =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 300
* ECS010V.cbl
 15495           RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15496        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15497           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15498                                     NOT = 'G' AND 'L')
 15499           COMPUTE RWF-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15500*          COMPUTE RWF-LFRFND ROUNDED = CR-LF-NSP-PRM
 15501*          / (CR-LFPRM + CR-LFPRM-ALT) * CR-LFRFND
 15502           COMPUTE RWF-LFRFND ROUNDED = (CR-LFRFND
 15503           / (CR-LFPRM + CR-LFPRM-ALT)) * CR-LF-NSP-PRM
 15504        END-IF
 15505     END-IF
 15506
 15507     MOVE RWF-LFPRM      TO WE-LFPRM.
 15508     MOVE RWF-LFAMT      TO WE-LFAMT.
 15509     MOVE RWF-LFRFND     TO WE-LFRFND.
 15510     MOVE RWF-LFCLM      TO WE-DTHAMT.
 15511     MOVE RWF-DTH-IBNR   TO WE-DTH-IBNR.
 15512     MOVE RWF-DTH-PAYCUR TO WE-DTH-PAYCUR.
 15513     MOVE RWF-DTH-FUTRSV TO WE-DTH-FUTRSV.
 15514     MOVE +0             TO WE-LFAMT-ALT
 15515                            WE-LFPRM-ALT
 15516                            WE-DTHEXP
 15517                            WE-NUM-DTH-CLM.
 15518
 15519     IF (DTE-CLIENT EQUAL 'NSL') AND
 15520        (CR-REIN-TABLE EQUAL 'NAR')
 15521        CONTINUE
 15522     ELSE
 15523      IF CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 15524       IF (CR-LFAMT + CR-LFAMT-ALT) GREATER THAN +0
 15525        COMPUTE WS-CEDE-FACT ROUNDED EQUAL
 15526            RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15527        COMPUTE WE-LFAMT ROUNDED EQUAL
 15528                           CR-LFAMT * WS-CEDE-FACT
 15529        COMPUTE WE-LFAMT-ALT ROUNDED EQUAL
 15530                           CR-LFAMT-ALT * WS-CEDE-FACT
 15531        IF (DTE-CLIENT = 'CID')
 15532           AND (CR-LF-NSP-PRM > +0)
 15533           AND (CR-ENTRY-DATE > 20031130)
 15534           AND (WT-LF-QC NOT = '1' AND '3')
 15535           COMPUTE WE-LFPRM ROUNDED = (CR-LF-NSP-PRM *
 15536              RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15537           MOVE +0            TO WE-LFPRM-ALT
 15538        ELSE
 15539          IF (DTE-CLIENT = 'CID')
 15540             AND (CR-LF-NSP-PRM > +0)
 15541             AND (CR-ENTRY-DATE > 20030430)
 15542             AND (WT-LF-QC NOT = '1' AND '3')
 15543             COMPUTE WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15544             MOVE +0            TO WE-LFPRM-ALT
 15545          ELSE
 15546             COMPUTE WE-LFPRM ROUNDED EQUAL
 15547                           CR-LFPRM * WS-CEDE-FACT
 15548             COMPUTE WE-LFPRM-ALT ROUNDED EQUAL
 15549                           CR-LFPRM-ALT * WS-CEDE-FACT
 15550          END-IF
 15551        END-IF
 15552        IF (DTE-CLIENT = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 301
* ECS010V.cbl
 15553           AND (CR-LF-NSP-PRM > +0)
 15554           AND (CR-LFRFND-CALC > +0)
 15555           AND (CR-LF-CANCEL-EXIT-DATE > 20031130)
 15556           AND (WT-LF-QC NOT = '1' AND '4')
 15557           COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
 15558              (CR-LFPRM + CR-LFPRM-ALT)
 15559           COMPUTE WE-LFRFND =
 15560              REIN-FACTOR * REIN-CALCED-LIFE
 15561           COMPUTE WE-LFRFND ROUNDED =  (WE-LFRFND
 15562              * RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT)
 15563*          COMPUTE WE-LFRFND = CR-LFRFND-CALC / (CR-LFPRM
 15564*             + CR-LFPRM-ALT) * CR-LF-NSP-PRM
 15565*             * RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
 15566        ELSE
 15567
 15568          IF (DTE-CLIENT = 'CID')
 15569           AND (CR-LF-NSP-PRM > +0)
 15570           AND (CR-LFRFND-CALC > +0)
 15571           AND (CR-LF-CANCEL-EXIT-DATE > 20030430)
 15572           AND (WT-LF-QC NOT = '1' AND '4')
 15573           COMPUTE WS-WE-LFPRM = CR-LF-NSP-PRM * WS-CEDE-FACT
 15574           COMPUTE WE-LFRFND = (CR-LFRFND-CALC / (CR-LFPRM
 15575              + CR-LFPRM-ALT)) * (WS-WE-LFPRM)
 15576
 15577          END-IF
 15578        END-IF
 15579       ELSE
 15580         MOVE +0 TO WS-CEDE-FACT
 15581       END-IF
 15582      END-IF
 15583     END-IF
 15584
 15585     IF DTE-CLIENT = 'DCC'
 15586        IF (AM-RECALC-COMM = ('Y' OR '1'))
 15587           AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)
 15588                                   NOT = 'G' AND 'L')
 15589           COMPUTE WS-CEDE-FACT =
 15590               RWF-AHAMT / CR-AHAMT
 15591           COMPUTE RWF-AHPRM = CR-AH-NSP-PRM * WS-CEDE-FACT
 15592*          COMPUTE RWF-AHRFND ROUNDED = CR-AH-NSP-PRM
 15593*          / CR-AHPRM * CR-AHRFND
 15594           COMPUTE RWF-AHRFND ROUNDED = (CR-AHRFND
 15595           / CR-AHPRM) * CR-AH-NSP-PRM
 15596        END-IF
 15597     END-IF
 15598
 15599     MOVE RWF-AHPRM      TO WE-AHPRM.
 15600
 15601     MOVE RWF-AHAMT      TO WE-AHAMT
 15602     MOVE RWF-AHRFND     TO WE-AHRFND.
 15603     MOVE RWF-AHCLM      TO WE-DSPY-AMT.
 15604     MOVE +0             TO WE-DSPY-EXP
 15605                            WE-NUM-DIS-CLM.
 15606     MOVE RWF-DIS-IBNR   TO WE-DIS-IBNR.
 15607     MOVE RWF-DIS-PAYCUR TO WE-DIS-PAYCUR.
 15608     MOVE RWF-DIS-FUTRSV TO WE-DIS-FUTRSV.
 15609
 15610     IF  RWF-LF-RUNOFF-SW = 'N'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 302
* ECS010V.cbl
 15611             OR
 15612         RWF-AH-RUNOFF-SW = 'N'
 15613         PERFORM 8000R-CONVERT-STOP-DATE THRU 8099R-STOP-DATE-X.
 15614
 15615     IF  RWF-LF-RUNOFF-SW = 'N'
 15616         MOVE EARNING-STOP-DATE    TO STOP-LF-DATE
 15617     ELSE
 15618         MOVE 99999999             TO STOP-LF-DATE.
 15619
 15620     IF  RWF-AH-RUNOFF-SW = 'N'
 15621         MOVE EARNING-STOP-DATE    TO STOP-AH-DATE
 15622     ELSE
 15623         MOVE 99999999             TO STOP-AH-DATE.
 15624
 15625     IF CR-POLICY-IS-RESTORE  OR
 15626        CR-POLICY-IS-REISSUE
 15627        OR CR-POLICY-IS-MONTHLY
 15628         MOVE ZEROS      TO WE-LFPRM
 15629                            WE-LFPRM-ALT
 15630                            WE-AHPRM.
 15631
 15632     PERFORM 4100-EP-DO-LF THRU 4299-EPBX.
 15633
 15634     IF CO-SUB NOT = ZERO
 15635       IF RCT-EARNING-START-DT (CO-SUB) NOT = ZERO
 15636         IF CR-DT LESS THAN RCT-EARNING-START-DT (CO-SUB)
 15637             PERFORM S-4100-EP-DO-LF THRU S-4299-EPBX.
 15638
 15639     ADD +1 TO SUB5.
 15640     GO TO 4090-EP-DO-REINSURE-LOOP.
 15641
 15642 4099-EP-BUMP-RTN-X.
 15643     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 303
* ECS010V.cbl
 15645******************************************************************
 15646***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
 15647******************************************************************
 15648
 15649 4100-EP-DO-LF.
 15650
 15651     MOVE +0                         TO ISS-BEN  EPR-R78
 15652                                        CNC-BEN  EPR-PRO
 15653                                        ISS-PRM  EPR-ST
 15654                                        ISS-PRMTAX
 15655                                        CNC-PRM  ACTIVE-COUNT.
 15656     MOVE SPACE                      TO LIFE-EARNED-SWITCH.
 15657
 15658     IF CR-LFTYP = ZERO
 15659         GO TO 4200-EP-DO-AH.
 15660
 15661     IF REIN-EP-FLG = 'R'
 15662         IF REIN-LF-FLG (SUB5) = SPACE
 15663             GO TO 4200-EP-DO-AH.
 15664
 15665     IF CR-APR NOT NUMERIC
 15666         MOVE ZERO TO CR-APR.
 15667
 15668     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 15669     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 15670     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 15671
 15672     IF CR-POLICY-IS-DECLINED  OR
 15673        CR-POLICY-IS-VOID
 15674         GO TO 4191-CONTINUE.
 15675
 15676     MOVE CR-LF-TERM             TO ORIG-TERM.
 15677     MOVE CLAS-INDEXL            TO W-NDX.
 15678
 15679     IF CR-DT GREATER EW-COV-DTE
 15680         MOVE CR-DT              TO EW-COV-DTE.
 15681
 15682     IF (NOT CR-POLICY-IS-RESTORE) AND
 15683        (NOT CR-POLICY-IS-REISSUE)
 15684        AND (NOT CR-POLICY-IS-MONTHLY)
 15685         COMPUTE ISS-BEN = WE-LFAMT + WE-LFAMT-ALT
 15686         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15687             ADD CR-LIVES TO EW-ISS-CNT
 15688             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 15689                                    (ORIG-TERM * CR-LIVES)
 15690             COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 15691             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15692             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15693                                   (ORIG-TERM * ISS-BEN)
 15694         ELSE
 15695             ADD +1 TO EW-ISS-CNT
 15696             COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 15697             COMPUTE EW-AGE = EW-AGE + CR-AGE
 15698             COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 15699             COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 15700                                   (ORIG-TERM * ISS-BEN).
 15701
 15702     MOVE RUN-DATE        TO VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 304
* ECS010V.cbl
 15703     MOVE '2'             TO W-VAL-SOURCE.
 15704
 15705     IF REIN-EP-FLG = 'R'
 15706         IF REIN-LF-RUNOFF-SW (SUB5) = 'N' AND
 15707            EARNING-STOP-DATE LESS THAN VALUATION-DT
 15708             MOVE EARNING-STOP-DATE TO VALUATION-DT
 15709             MOVE '10'              TO W-VAL-SOURCE.
 15710
 15711     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15712
 15713     IF (CR-LF-CURRENT-STATUS = '1' OR '4') AND
 15714        (REM-TRM3 GREATER ZERO)
 15715        IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15716            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 15717                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 15718            COMPUTE EW-REM-TERM = EW-REM-TERM +
 15719                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 15720          ELSE
 15721            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 15722            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 15723
 15724     COMPUTE ISS-PRM = WE-LFPRM + WE-LFPRM-ALT.
 15725
 15726     IF DTE-CLIENT = 'GIC'
 15727         IF REIN-EP-FLG NOT = 'R'  AND
 15728            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  AND
 15729            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 15730            MOVE CR-LFPRM-CALC TO ISS-PRM.
 15731
 15732     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 15733         GO TO 4105-EP-DO-LF-REIN-CHK.
 15734
 15735     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 15736             AND
 15737         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 15738             AND
 15739         (CR-LF-CANC-DT GREATER THAN EOM-DATE (1)
 15740                 OR
 15741             CR-LF-CANC-DT EQUAL ZEROS)
 15742             AND
 15743         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (1)
 15744                 OR
 15745             CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 15746         MOVE 'Y'               TO  EPEC-LIFE-CTR-USED-IND (SUB3)
 15747         PERFORM 4194-SLOT-INTO-EFFECTED-MONTHS THRU 4194-EXIT
 15748                 VARYING
 15749             SUBM FROM +1 BY +1
 15750                 UNTIL
 15751             SUBM GREATER THAN +13.
 15752
 15753     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 15754     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 15755
 15756 4105-EP-DO-LF-REIN-CHK.
 15757
 15758     IF REIN-EP-FLG = 'R'  AND
 15759        REIN-LF-RUNOFF-SW (SUB5) = 'N'
 15760         NEXT SENTENCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 305
* ECS010V.cbl
 15761     ELSE
 15762         GO TO 4110-EP-DO-LF-CLM.
 15763
 15764     IF CR-LF-STATUS-AT-CANCEL NOT = ' '
 15765         IF CR-LF-CANC-DT GREATER THAN EARNING-STOP-DATE
 15766             GO TO 4130-EP-DO-LF-EP.
 15767
 15768     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15769         IF CR-DTH-DT GREATER THAN EARNING-STOP-DATE
 15770             GO TO 4130-EP-DO-LF-EP.
 15771
 15772 4110-EP-DO-LF-CLM.
 15773
 15774     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
 15775         NEXT  SENTENCE
 15776       ELSE
 15777         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 15778
 15779     ADD WE-DTHAMT      TO EW-CLM-AMT.
 15780     ADD WE-DTHEXP      TO EPEC-CLM-EXP (SUB3).
 15781
 15782     IF CR-LF-STATUS-AT-DEATH = ' '
 15783         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'
 15784             GO TO 4115-EP-DO-LF-CLM-EPR.
 15785
 15786     ADD WE-NUM-DTH-CLM TO EW-CLM-CNT.
 15787     ADD +1             TO EW-CLM-CRT.
 15788
 15789 4115-EP-DO-LF-CLM-EPR.
 15790
 15791     IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15792         COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 15793         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 15794     END-IF
 15795     .
 15796 4120-EP-DO-LF-CNCL.
 15797
 15798     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 15799        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 15800         IF CR-LF-STATUS-AT-DEATH NOT = ' '
 15801             GO TO 4190-EP-DO-LF-COMM
 15802         ELSE
 15803             GO TO 4130-EP-DO-LF-EP.
 15804
 15805     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 15806         ADD CR-SUM-CAN-CNT-ITD TO EW-CNC-CNT
 15807         GO TO 4124-EP-DO-LF-CNCL-SUM.
 15808
 15809     ADD +1                       TO EW-CNC-CNT.
 15810
 15811     MOVE WE-LFRFND               TO CNC-PRM.
 15812
 15813     IF DTE-CLIENT = 'GIC'
 15814         IF REIN-EP-FLG NOT = 'R'  AND
 15815            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 15816             MOVE CR-LFRFND-CALC TO CNC-PRM.
 15817
 15818*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 306
* ECS010V.cbl
 15819*    MOVE 'L'                   TO  DC-OPTION-CODE.
 15820*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15821*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 15822
 15823     MOVE CR-LF-CANC-DT         TO  DC-GREG-DATE-CYMD.
 15824     MOVE 'L'                   TO  DC-OPTION-CODE.
 15825     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15826     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 15827
 15828     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 15829     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 15830     MOVE '1'                     TO  DC-OPTION-CODE.
 15831     MOVE ZEROS                   TO  MONTHS-DIFF-LF.
 15832     MOVE ' '                     TO  DC-CENTURY-ADJUSTMENT.
 15833     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 15834                                      DC-ODD-DAYS-OVER
 15835                                      DC-ELAPSED-DAYS.
 15836     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15837     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-LF.
 15838
 15839     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 15840         ADD  +1                  TO  MONTHS-DIFF-LF.
 15841
 15842     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15843
 15844     IF DTE-CLIENT = 'ACE'
 15845         GO TO 4120-CONTINUE-LIFE-CANCEL.
 15846
 15847     MOVE  ZEROS                  TO  SUB.
 15848
 15849 4120-LIFE-CHARGEBACK-LOOP.
 15850
 15851     ADD    +1                    TO  SUB.
 15852
 15853     IF  SUB  GREATER THAN  +10
 15854         GO TO  4120-CONTINUE-LIFE-CANCEL.
 15855
 15856     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
 15857         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 15858         GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15859
 15860     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 15861         MOVE  'N'    TO  WS-LF-CHARGEBACK-SW (SUB).
 15862
 15863     IF  MONTHS-DIFF-LF GREATER THAN AM-COMM-CHARGEBACK (SUB)
 15864         MOVE  'N'        TO  WS-LF-CHARGEBACK-SW (SUB).
 15865
 15866     GO TO  4120-LIFE-CHARGEBACK-LOOP.
 15867
 15868
 15869 4120-CONTINUE-LIFE-CANCEL.
 15870
 15871     COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 15872     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 15873
 15874     IF WE-LFRFND = +0 AND WE-DTHAMT NOT = +0
 15875         GO TO 4190-EP-DO-LF-COMM.
 15876
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 307
* ECS010V.cbl
 15877     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15878         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15879         GO TO 4190-EP-DO-LF-COMM.
 15880
 15881     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15882     MOVE '3'           TO W-VAL-SOURCE.
 15883     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15884
 15885     IF REM-TRM3 = CR-LF-TERM
 15886         COMPUTE CNC-BEN = WE-LFAMT + WE-LFAMT-ALT
 15887         GO TO 4190-EP-DO-LF-COMM.
 15888
 15889     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 15890         GO TO 4122-EP-DO-LF-CNCL-TEX.
 15891
 15892     IF DTE-CLIENT = 'NCL'
 15893         IF CR-DT LESS THAN 19910101
 15894             GO TO 4121-EP-DO-LF-CNC-BEN.
 15895
 15896     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 15897         GO TO 4126-EP-DO-LF-CNCL-NP.
 15898
 15899     IF DTE-CLIENT = 'FUL'
 15900         GO TO 4128-EP-DO-LF-CNCL-FUL.
 15901
 15902*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 15903     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 15904        (CR-RATING-CLASS NOT = 'L ')
 15905         IF (CR-APR GREATER THAN ZERO)  AND
 15906            (CR-LF-TERM GREATER THAN 060)  AND
 15907            (CR-DT GREATER THAN 19831031)
 15908              GO TO 4126-EP-DO-LF-CNCL-NP.
 15909
 15910     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 15911         IF (CR-APR GREATER THAN ZERO)  AND
 15912            (CR-LF-TERM GREATER THAN 061)  AND
 15913            (CR-DT GREATER THAN 19830318)
 15914              GO TO 4126-EP-DO-LF-CNCL-NP.
 15915
 15916     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 15917         IF (CR-APR GREATER THAN ZERO)  AND
 15918            (CR-LF-TERM GREATER THAN 062)  AND
 15919            (CR-DT GREATER THAN 19810831)  AND
 15920            (CR-DT LESS THAN 19830901)
 15921              GO TO 4126-EP-DO-LF-CNCL-NP.
 15922
 15923     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 15924         IF (CR-APR GREATER THAN ZERO)  AND
 15925            (CR-LF-TERM GREATER THAN 060)  AND
 15926            (CR-DT GREATER THAN 19831231)
 15927              GO TO 4126-EP-DO-LF-CNCL-NP.
 15928
 15929 4121-EP-DO-LF-CNC-BEN.
 15930
 15931     COMPUTE TEMP-4 ROUNDED EQUAL REM-TRM3 / CR-LF-TERM.
 15932
 15933     COMPUTE TEMP-3 ROUNDED EQUAL
 15934         (WE-LFAMT + WE-LFAMT-ALT) * TEMP-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 308
* ECS010V.cbl
 15935
 15936     MOVE TEMP-3                 TO CNC-BEN.
 15937
 15938     GO TO 4190-EP-DO-LF-COMM.
 15939
 15940 4122-EP-DO-LF-CNCL-TEX.
 15941
 15942     DIVIDE WE-LFAMT BY CR-LF-TERM
 15943         GIVING TEX-FACT-1.
 15944     DIVIDE REM-TRM3 BY CR-PMT-FREQ
 15945         GIVING TEX-FACT-2
 15946             REMAINDER TEX-FACT-3.
 15947     IF TEX-FACT-3 NOT = ZERO
 15948         ADD +1 TO TEX-FACT-2.
 15949
 15950     COMPUTE CNC-BEN = (TEX-FACT-1 * (TEX-FACT-2 * CR-PMT-FREQ)).
 15951
 15952     GO TO 4190-EP-DO-LF-COMM.
 15953
 15954 4124-EP-DO-LF-CNCL-SUM.
 15955
 15956     IF WE-LFRFND = ZERO
 15957         GO TO 4130-EP-DO-LF-EP.
 15958
 15959     MOVE WE-LFRFND TO CNC-PRM.
 15960
 15961     MOVE  'YYYYYYYYYY'           TO  WS-LF-CHARGEBACK-LEVELS.
 15962
 15963     IF WE-LFRFND NOT LESS WE-LFPRM
 15964         MOVE WE-LFAMT TO CNC-BEN
 15965          GO TO 4130-EP-DO-LF-EP.
 15966
 15967
 15968     COMPUTE TEMP-7 ROUNDED = WE-LFAMT * (WE-LFRFND / WE-LFPRM).
 15969
 15970     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'
 15971         MOVE TEMP-7 TO CNC-BEN
 15972          GO TO 4130-EP-DO-LF-EP.
 15973
 15974     MOVE CR-LF-CANC-DT TO VALUATION-DT.
 15975     MOVE '4'           TO W-VAL-SOURCE.
 15976     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 15977
 15978     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'N'
 15979         COMPUTE CNC-BEN = TEMP-7 * (REM-TRM3 / CR-LF-TERM)
 15980         GO TO 4130-EP-DO-LF-EP.
 15981
 15982 4126-EP-DO-LF-CNCL-NP.
 15983
 15984     IF WE-LFAMT = ZERO
 15985        GO TO 4190-EP-DO-LF-COMM.
 15986
 15987     MOVE CR-DT                      TO  DC-GREG-DATE-CYMD.
 15988     MOVE 'L'                        TO  DC-OPTION-CODE.
 15989     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 15990     MOVE DC-BIN-DATE-1              TO  CP-CERT-EFF-DT.
 15991
 15992     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 309
* ECS010V.cbl
 15993       MOVE CR-LOAN-1ST-PMT-DT       TO  DC-GREG-DATE-1-YMD
 15994       MOVE '3'                      TO  DC-OPTION-CODE
 15995       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 15996       MOVE DC-BIN-DATE-1            TO  CP-FIRST-PAY-DATE
 15997     ELSE
 15998       MOVE CP-CERT-EFF-DT           TO  DC-BIN-DATE-1
 15999       MOVE '6'                      TO  DC-OPTION-CODE
 16000       MOVE +1                       TO  DC-ELAPSED-MONTHS
 16001       MOVE +0                       TO  DC-ELAPSED-DAYS
 16002       PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X
 16003       MOVE DC-BIN-DATE-2            TO  CP-FIRST-PAY-DATE.
 16004
 16005     MOVE CR-LFAMT                   TO  CP-ORIGINAL-BENEFIT.
 16006     MOVE CR-APR                     TO  CP-LOAN-APR.
 16007     MOVE CR-LF-TERM                 TO  CP-ORIGINAL-TERM.
 16008     MOVE CR-LOAN-TERM               TO  CP-LOAN-TERM.
 16009     MOVE REM-TRM3                   TO  CP-REMAINING-TERM.
 16010     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO  CP-SPECIAL-CALC-CD.
 16011     MOVE CLAS-I-RL-AH     (CLAS-INDEXL) TO  CP-BENEFIT-TYPE.
 16012     MOVE CLAS-I-EP        (CLAS-INDEXL) TO  CP-EARNING-METHOD.
 16013
 16014     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA.
 16015
 16016     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16017       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (TEMP-7 / +1000))
 16018       GO TO 4130-EP-DO-LF-EP
 16019     ELSE
 16020       COMPUTE CNC-BEN = (CP-REMAMT-FACTOR * (WE-LFAMT / +1000)).
 16021
 16022     GO TO 4190-EP-DO-LF-COMM.
 16023
 16024 4128-EP-DO-LF-CNCL-FUL.
 16025
 16026     IF WE-LFAMT = ZERO
 16027        GO TO 4190-EP-DO-LF-COMM.
 16028
 16029     MOVE CR-APR              TO NP-APR.
 16030     MOVE CR-LF-TERM          TO NP-ORIG.
 16031     MOVE REM-TRM3            TO NP-REM.
 16032     MOVE '2'                 TO NP-OPT.
 16033     MOVE CR-AHPRM            TO NP-AHPRM.
 16034     MOVE CR-ACCOUNT          TO NP-ACCOUNT.
 16035     MOVE CR-LFAMT            TO NP-BENEFIT.
 16036
 16037*    CALL 'FULNETRM'
 16038*        USING NP-APR NP-ORIG NP-REM NP-OPT NP-BENEFIT NP-AHPRM
 16039*              NP-ACCOUNT NP-REMAINING.
 16040
 16041     MOVE NP-REMAINING TO CNC-BEN.
 16042
 16043     GO TO 4190-EP-DO-LF-COMM.
 16044
 16045 4130-EP-DO-LF-EP.
 16046
 16047     MOVE SPACE                  TO STATUTORY-SWITCH.
 16048
 16049     MOVE EOM-RUN-DATE TO VALUATION-DT.
 16050     MOVE '5'           TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 310
* ECS010V.cbl
 16051
 16052     IF REIN-EP-FLG = 'R'
 16053       IF REIN-REM-SW (SUB5) = 'I'
 16054           COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16055           MOVE EPR-R78             TO EPR-PRO  EPR-ST
 16056           GO TO 4190-EP-DO-LF-COMM.
 16057
 16058     IF REIN-EP-FLG = 'R'
 16059         IF REIN-LF-RUNOFF-SW (SUB5) = 'N'  AND
 16060            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16061             MOVE '*'               TO LIFE-EARNED-SWITCH
 16062             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16063             MOVE '10'              TO W-VAL-SOURCE.
 16064
 16065     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16066
 16067     IF REM-TRM2 GREATER CR-LF-TERM
 16068         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16069         GO TO 4190-EP-DO-LF-COMM.
 16070
 16071     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16072         GO TO 4180-EP-DO-LF-EP-SUM.
 16073
 16074     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 16075         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 16076             IF REM-TRM2 NOT GREATER THAN +0
 16077                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16078                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16079                 GO TO 4190-EP-DO-LF-COMM
 16080             ELSE
 16081                 NEXT SENTENCE
 16082         ELSE
 16083             IF W-BAL-REMTRM NOT GREATER +0
 16084                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 16085                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16086                 GO TO 4190-EP-DO-LF-COMM
 16087             ELSE
 16088                 NEXT SENTENCE
 16089     ELSE
 16090        IF DTE-CLIENT = 'NCL'  AND
 16091           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16092            MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16093        ELSE
 16094         IF REM-TRM2 NOT GREATER +0  OR
 16095            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 16096             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 16097             GO TO 4190-EP-DO-LF-COMM.
 16098
 16099     MOVE +1 TO ACTIVE-COUNT.
 16100
 16101     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 16102         GO TO 4140-EP-DO-LF-EP-TEX.
 16103
 16104     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 16105         GO TO 4150-EP-DO-LF-EP-NP.
 16106
 16107*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 16108     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 311
* ECS010V.cbl
 16109        (CR-RATING-CLASS NOT = 'L ')
 16110         IF (CR-APR GREATER THAN ZERO)  AND
 16111            (CR-LF-TERM GREATER THAN 060)  AND
 16112            (CR-DT GREATER THAN 19831031)
 16113             MOVE '*'             TO STATUTORY-SWITCH
 16114              GO TO 4150-EP-DO-LF-EP-NP.
 16115
 16116     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 16117         IF (CR-APR GREATER THAN ZERO)  AND
 16118            (CR-LF-TERM GREATER THAN 061)  AND
 16119            (CR-DT GREATER THAN 19830318)
 16120             MOVE '*'             TO STATUTORY-SWITCH
 16121              GO TO 4150-EP-DO-LF-EP-NP.
 16122
 16123     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 16124         IF (CR-APR GREATER THAN ZERO)  AND
 16125            (CR-LF-TERM GREATER THAN 062)  AND
 16126            (CR-DT GREATER THAN 19810831)  AND
 16127            (CR-DT LESS THAN 19830901)
 16128             MOVE '*'             TO STATUTORY-SWITCH
 16129              GO TO 4150-EP-DO-LF-EP-NP.
 16130
 16131     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 16132         IF (CR-APR GREATER THAN ZERO)  AND
 16133            (CR-LF-TERM GREATER THAN 060)  AND
 16134            (CR-DT GREATER THAN 19831231)
 16135             MOVE '*'             TO STATUTORY-SWITCH
 16136              GO TO 4150-EP-DO-LF-EP-NP.
 16137
 16138     GO TO 4160-EP-DO-LF-EP-R78.
 16139
 16140 4140-EP-DO-LF-EP-TEX.
 16141
 16142     IF CR-PMT-FREQ = 0
 16143       DISPLAY '*************************************'
 16144       DISPLAY '***** CR-PMT-FREQ EQUAL TO ZERO *****'
 16145       DISPLAY '*************************************'
 16146       DISPLAY '***** CR-FULL-CONTROL -->' CR-FULL-CONTROL
 16147       DISPLAY '*************************************'
 16148       COMPUTE TEX-FACT-4 =
 16149          (CR-LF-TERM * CR-LF-TERM) +
 16150                               (WS-CR-PMT-FREQ * CR-LF-TERM)
 16151     ELSE
 16152        COMPUTE TEX-FACT-4 =
 16153         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 16154
 16155     IF CR-PMT-FREQ = 0
 16156       DIVIDE REM-TRM1 BY WS-CR-PMT-FREQ
 16157           GIVING TEX-FACT-5
 16158               REMAINDER TEX-FACT-6
 16159     ELSE
 16160        DIVIDE REM-TRM1 BY CR-PMT-FREQ
 16161            GIVING TEX-FACT-5
 16162                REMAINDER TEX-FACT-6.
 16163
 16164     IF CR-PMT-FREQ > 0
 16165        MOVE CR-PMT-FREQ TO WS-CR-PMT-FREQ.
 16166
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 312
* ECS010V.cbl
 16167     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 16168     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 16169         (TEX-FACT-5 * CR-PMT-FREQ) +
 16170         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 16171     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 16172
 16173     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 16174
 16175     GO TO 4170-EP-DO-LF-EP-PRO.
 16176
 16177 4150-EP-DO-LF-EP-NP.
 16178
 16179     IF WE-LFPRM = ZERO
 16180         GO TO 4160-EP-DO-LF-EP-R78.
 16181
 16182     IF DTE-CLIENT = 'CRI'
 16183       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 16184             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 16185           GO TO 4160-EP-DO-LF-EP-R78.
 16186
 16187     IF DTE-CLIENT = 'NCL'
 16188       IF CR-DT LESS THAN 19910101
 16189           GO TO 4160-EP-DO-LF-EP-R78.
 16190
 16191     IF REM-TRM1 = CR-LF-TERM
 16192         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 16193         GO TO 4190-EP-DO-LF-COMM.
 16194
 16195     MOVE CR-APR TO NP-APR.
 16196     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 16197     MOVE REM-TRM1 TO NP-REM.
 16198     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 16199     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 16200         MOVE CR-LOAN-TERM TO NP-ORIG.
 16201
 16202     MOVE 'R' TO NP-OPT.
 16203     CALL 'ECSNETRM'
 16204         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 16205
 16206     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 16207
 16208     IF STATUTORY-REQUIREMENT
 16209         MOVE EPR-R78                TO EPR-ST.
 16210
 16211 4160-EP-DO-LF-EP-R78.
 16212
 16213     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 16214        (DTE-CLIENT EQUAL 'NCL')
 16215        IF (CR-CCYY EQUAL EOM-CCYY) AND
 16216           (CR-MO EQUAL EOM-MO)
 16217           MOVE '*'            TO OB-DATE-1-SWITCH
 16218           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16219           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16220           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16221           COMPUTE WS-EPR-R78 (SUB3 1) =
 16222                   WS-EPR-R78 (SUB3 1) + (WE-LFPRM * .5)
 16223           GO TO 4190-EP-DO-LF-COMM
 16224        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 313
* ECS010V.cbl
 16225        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 16226           (CR-MO EQUAL OB-MO (1))
 16227           MOVE '*'            TO OB-DATE-2-SWITCH
 16228           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16229           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16230           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16231           COMPUTE WS-EPR-R78 (SUB3 2) =
 16232                   WS-EPR-R78 (SUB3 2) + (WE-LFPRM * .5)
 16233           GO TO 4190-EP-DO-LF-COMM
 16234        ELSE
 16235        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 16236           (CR-MO EQUAL OB-MO (2))
 16237           MOVE '*'            TO OB-DATE-3-SWITCH
 16238           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 16239           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 16240           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 16241           COMPUTE WS-EPR-R78 (SUB3 3) =
 16242                   WS-EPR-R78 (SUB3 3) + (WE-LFPRM * .5)
 16243           GO TO 4190-EP-DO-LF-COMM
 16244        ELSE
 16245           GO TO 4190-EP-DO-LF-COMM.
 16246
 16247     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16248
 16249     IF DTE-R78 = '1'
 16250         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 16251     ELSE
 16252         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16253
 16254     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16255
 16256     IF REM-TRM1 GREATER THAN +0
 16257         COMPUTE TEMP-7 ROUNDED EQUAL
 16258             WE-LFPRM - (WE-LFPRM * TEMP-4)
 16259     ELSE
 16260         MOVE WE-LFPRM                TO TEMP-7.
 16261
 16262     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16263         MOVE ZEROS                  TO TEMP-8
 16264         GO TO 4165-END-LF-EP-R78.
 16265
 16266     IF EPR-ST = ZEROS
 16267         MOVE TEMP-7                 TO EPR-ST.
 16268
 16269     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16270         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 16271         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 16272         IF DTE-R78 = '1'
 16273             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 16274
 16275     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 16276
 16277     COMPUTE TEMP-8 ROUNDED =
 16278               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 16279
 16280 4165-END-LF-EP-R78.
 16281
 16282     IF EPR-R78 = ZEROS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 314
* ECS010V.cbl
 16283         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 16284     ELSE
 16285         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 16286
 16287 4170-EP-DO-LF-EP-PRO.
 16288
 16289     IF DTE-CLIENT = 'MIC' OR 'MCC'
 16290         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 16291     ELSE
 16292         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16293
 16294     IF REM-TRM1 GREATER THAN +0
 16295         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 16296     ELSE
 16297         MOVE WE-LFPRM                  TO TEMP-7.
 16298
 16299     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16300         MOVE ZEROS                     TO TEMP-8
 16301         GO TO 4175-END-LF-EP-PRO.
 16302
 16303     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 16304         IF DTE-CLIENT = 'MIC' OR 'MCC'
 16305             COMPUTE TEMP-5 ROUNDED =
 16306                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 16307         ELSE
 16308             COMPUTE TEMP-5 ROUNDED =
 16309                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 16310
 16311     COMPUTE TEMP-8 ROUNDED =
 16312                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 16313
 16314     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 16315
 16316 4175-END-LF-EP-PRO.
 16317
 16318     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 16319
 16320     GO TO 4185-EP-DO-LF-STATUTORY.
 16321
 16322 4180-EP-DO-LF-EP-SUM.
 16323
 16324     IF REM-TRM1 NOT GREATER +0
 16325         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 16326         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 16327         GO TO 4190-EP-DO-LF-COMM.
 16328
 16329     COMPUTE ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 16330
 16331     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16332         MOVE ZEROS                 TO TEMP-7
 16333     ELSE
 16334         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 16335                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 16336
 16337     IF TEMP-7 NOT GREATER ZERO
 16338         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16339             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 16340             GO TO 4190-EP-DO-LF-COMM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 315
* ECS010V.cbl
 16341         ELSE
 16342             MOVE ZEROS             TO TEMP-7.
 16343
 16344     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 16345     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 16346     IF DTE-R78 = '1'
 16347         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 16348
 16349     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 16350     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 16351
 16352     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 16353
 16354     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 16355
 16356     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 16357         GO TO 4185-EP-DO-LF-STATUTORY.
 16358
 16359     MOVE EPR-R78                  TO EPR-ST.
 16360
 16361     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 16362         MOVE ZEROS                 TO TEMP-8
 16363     ELSE
 16364         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 16365                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 16366
 16367     IF TEMP-8 NOT GREATER ZERO
 16368         GO TO 4185-EP-DO-LF-STATUTORY.
 16369
 16370     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 16371                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 16372
 16373     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 16374                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 16375
 16376     COMPUTE EPR-ST ROUNDED = EPR-ST +
 16377                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 16378
 16379 4185-EP-DO-LF-STATUTORY.
 16380
 16381     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 16382         MOVE EPR-R78                TO EPR-ST.
 16383     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 16384         MOVE EPR-PRO                TO EPR-ST.
 16385
 16386     IF EPR-ST NOT = ZEROS
 16387         GO TO 4190-EP-DO-LF-COMM.
 16388
 16389     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
 16390         MOVE EPR-R78                TO EPR-ST
 16391     ELSE
 16392         MOVE EPR-PRO                TO EPR-ST.
 16393
 16394 4190-EP-DO-LF-COMM.
 16395
 16396     MOVE +0 TO SUB1.
 16397     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16398         10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 316
* ECS010V.cbl
 16399
 16400     IF REIN-EP-FLG NOT = 'R'  OR
 16401        CR-POLICY-IS-REIN-ONLY
 16402         MOVE ISS-BEN TO GROSS-ISS-BEN-LF
 16403         MOVE CNC-BEN TO GROSS-CNC-BEN-LF
 16404         MOVE ISS-PRM TO GROSS-ISS-PRM-LF
 16405         MOVE CNC-PRM TO GROSS-CNC-PRM-LF.
 16406
 16407     ADD ISS-BEN TO EW-ISS-BEN.
 16408     ADD GROSS-ISS-BEN-LF TO EW-ISS-BEN-GROSS.
 16409     ADD CNC-BEN TO EW-CNC-BEN.
 16410     ADD GROSS-CNC-BEN-LF TO EW-CNC-BEN-GROSS.
 16411     ADD ISS-PRM TO EW-ISS-PRM.
 16412     ADD GROSS-ISS-PRM-LF TO EW-ISS-PRM-GROSS.
 16413     ADD CNC-PRM TO EW-CNC-PRM.
 16414     ADD GROSS-CNC-PRM-LF TO EW-CNC-PRM-GROSS.
 16415
 16416     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16417     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16418     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16419
 16420     IF CR-LF-ISS-PREM-TAX NOT NUMERIC
 16421        MOVE +0                  TO CR-LF-ISS-PREM-TAX
 16422     END-IF
 16423     IF CR-LF-CNC-PREM-TAX NOT NUMERIC
 16424        MOVE +0                  TO CR-LF-CNC-PREM-TAX
 16425     END-IF
 16426
 16427     COMPUTE ISS-PRMTAX =
 16428        (ISS-PRM * CR-LF-ISS-PREM-TAX) -
 16429        (CNC-PRM * CR-LF-CNC-PREM-TAX)
 16430
 16431     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16432
 16433     IF LIFE-FULLY-EARNED
 16434         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16435                                            (ISS-PRM - EPR-R78)
 16436         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16437                                            (ISS-PRM - EPR-PRO)
 16438         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16439                                            (ISS-PRM - EPR-ST).
 16440
 16441     IF  DTE-OPT-RESERVE-METHOD-AUTH
 16442         IF  REIN-EP-FLG NOT = 'R'
 16443                 OR
 16444             CR-POLICY-IS-REIN-ONLY
 16445             MOVE 'L'      TO W-CLAIM-TYPE
 16446             MOVE EPR-R78  TO W-OPT-R78
 16447             MOVE EPR-PRO  TO W-OPT-PRO
 16448             MOVE EPR-ST   TO W-OPT-ST
 16449             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16450             MOVE ZEROS    TO EW-CLM-IBNR
 16451         ELSE
 16452             IF  STOP-LF-DATE LESS THAN EOM-RUN-DATE
 16453                 MOVE 'N'        TO EPEC-LINE-NOT-USED-IND (SUB3)
 16454                 MOVE ZEROS      TO EW-CLM-IBNR
 16455             ELSE
 16456                 MOVE ZEROS      TO EW-CLM-IBNR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 317
* ECS010V.cbl
 16457     ELSE
 16458         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16459             ADD WE-DTH-IBNR
 16460                       TO EW-CLM-IBNR
 16461         ELSE
 16462             IF  CLAS-I-BAL (CLAS-INDEXL) = 'B'
 16463                     AND
 16464                 CR-DT GREATER THAN LAST-YRS-DATE
 16465                 COMPUTE  EW-CLM-IBNR
 16466                     = EW-CLM-IBNR + (WE-LFAMT * .0000500).
 16467
 16468     ADD WE-DTH-PAYCUR TO EW-CLM-PAYCUR.
 16469     ADD WE-DTH-FUTRSV TO EW-CLM-FUTRSV.
 16470
 16471 4191-CONTINUE.
 16472
 16473     MOVE 'Y'          TO EW-LEVEL-USED.
 16474
 16475     IF CR-POLICY-UNDERWRITTEN
 16476         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16477         MOVE EPEC-OPT-WORK-TABLE
 16478                              TO EPEC-UNDW-OPT-DATA-TABLE
 16479     ELSE
 16480         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16481         MOVE EPEC-OPT-WORK-TABLE
 16482                              TO EPEC-OPT-DATA-TABLE.
 16483
 16484     GO TO 4200-EP-DO-AH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 318
* ECS010V.cbl
 16486 4194-SLOT-INTO-EFFECTED-MONTHS.
 16487
 16488     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16489             AND
 16490         CR-LF-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16491             AND
 16492         (CR-LF-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16493                 OR
 16494          CR-LF-CANC-DT EQUAL ZEROS)
 16495             AND
 16496         (CR-LF-CLAIM-EXIT-DATE GREATER THAN EOM-DATE (SUBM)
 16497                 OR
 16498          CR-LF-CLAIM-EXIT-DATE EQUAL ZEROS)
 16499         MOVE 'Y'                 TO W-TABLE-USED-SW
 16500         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16501             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16502                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16503                 + CR-LIVES
 16504         ELSE
 16505             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16506                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16507
 16508 4194-EXIT.
 16509     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 319
* ECS010V.cbl
 16511******************************************************************
 16512***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
 16513******************************************************************
 16514
 16515 4200-EP-DO-AH.
 16516
 16517     MOVE +0                         TO ISS-BEN  EPR-R78
 16518                                        CNC-BEN  EPR-PRO
 16519                                        ISS-PRM  EPR-ST
 16520                                        CNC-PRM
 16521                                        WX-CLM-AMT
 16522                                        WX-CLM-EXP
 16523                                        WX-CLM-CNT
 16524                                        WX-CLM-CRT
 16525                                        WX-ACTIVE-COUNT
 16526                                        ISS-PRMTAX
 16527                                        WX-CNC-CNT.
 16528     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 16529
 16530     IF CR-AHTYP = ZERO
 16531         GO TO 4295-EP-DO-COUNT.
 16532
 16533     IF REIN-EP-FLG = 'R'
 16534         IF REIN-AH-FLG (SUB5) = SPACE
 16535             GO TO 4295-EP-DO-COUNT.
 16536
 16537     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 16538     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 16539     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 16540
 16541     IF CR-POLICY-IS-DECLINED  OR
 16542        CR-POLICY-IS-VOID
 16543         GO TO 4290-CONTINUE.
 16544
 16545     MOVE CR-AH-TERM           TO ORIG-TERM.
 16546
 16547     IF CR-DT GREATER EW-COV-DTE
 16548         MOVE CR-DT            TO EW-COV-DTE.
 16549
 16550     IF NOT CR-POLICY-IS-RESTORE  AND
 16551        NOT CR-POLICY-IS-REISSUE
 16552        AND NOT CR-POLICY-IS-MONTHLY
 16553         MOVE WE-AHAMT         TO ISS-BEN
 16554         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM + ORIG-TERM
 16555         COMPUTE EW-AGE = EW-AGE + CR-AGE
 16556         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16557         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16558                                   (ORIG-TERM * ISS-BEN).
 16559
 16560     MOVE CLAS-INDEXA     TO W-NDX.
 16561     MOVE RUN-DATE        TO VALUATION-DT
 16562     MOVE '6'             TO W-VAL-SOURCE.
 16563
 16564     IF REIN-EP-FLG = 'R'
 16565         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 16566            EARNING-STOP-DATE LESS THAN VALUATION-DT
 16567             MOVE EARNING-STOP-DATE TO VALUATION-DT
 16568             MOVE '10'              TO W-VAL-SOURCE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 320
* ECS010V.cbl
 16569
 16570     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 16571
 16572     IF (CR-AH-CURRENT-STATUS = '1' OR '4') AND
 16573        (REM-TRM3 GREATER ZERO)
 16574        IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16575            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT +
 16576                                  (CR-LIVES - CR-SUM-CAN-CNT-ITD)
 16577            COMPUTE EW-REM-TERM = EW-REM-TERM +
 16578                     (REM-TRM3 * (CR-LIVES - CR-SUM-CAN-CNT-ITD))
 16579          ELSE
 16580            COMPUTE EW-INFORCE-CNT = EW-INFORCE-CNT + 1
 16581            COMPUTE EW-REM-TERM = EW-REM-TERM + REM-TRM3.
 16582
 16583     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 16584         GO TO 4210-BY-OPT-LOGIC.
 16585
 16586     IF  CR-DT NOT GREATER THAN EOM-DATE (13)
 16587             AND
 16588         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (1)
 16589             AND
 16590         (CR-AH-CANC-DT GREATER THAN EOM-DATE (1)
 16591                 OR
 16592          CR-AH-CANC-DT EQUAL ZEROS)
 16593         MOVE 'Y'                TO EPEC-LIFE-CTR-USED-IND (SUB3)
 16594         PERFORM 4296-SLOT-INTO-EFFECTED-MONTHS THRU 4296-EXIT
 16595                 VARYING
 16596             SUBM FROM +1 BY +1
 16597                 UNTIL
 16598             SUBM GREATER THAN +13.
 16599
 16600     MOVE EW-SUB-KEY             TO EPEC-SUB-KEY-OPT (SUB3).
 16601     MOVE EW-REIN-CO             TO EPEC-REIN-CO-OPT (SUB3).
 16602
 16603 4210-BY-OPT-LOGIC.
 16604
 16605     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 16606         ADD CR-LIVES TO EW-ISS-CNT
 16607         MOVE WE-AHPRM TO ISS-PRM
 16608         COMPUTE EW-ORIG-TERM = EW-ORIG-TERM +
 16609                                (ORIG-TERM * CR-LIVES)
 16610         COMPUTE EW-AGE = EW-AGE + (CR-AGE * CR-LIVES)
 16611         COMPUTE EW-AGE-BEN = EW-AGE-BEN + (CR-AGE * ISS-BEN)
 16612         COMPUTE EW-TERM-BEN = EW-TERM-BEN +
 16613                                   (ORIG-TERM * ISS-BEN)
 16614         PERFORM 4825-EP-DO-AH-CNCL-SUM THRU 4899-EXIT
 16615         GO TO 4225-CONTINUE.
 16616
 16617     IF (NOT CR-POLICY-IS-RESTORE) AND
 16618        (NOT CR-POLICY-IS-REISSUE)
 16619        AND (NOT CR-POLICY-IS-MONTHLY)
 16620        ADD +1 TO EW-ISS-CNT.
 16621
 16622     PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT.
 16623
 16624 4225-CONTINUE.
 16625
 16626     IF  EPEC-CLM-EXP (SUB3)  NUMERIC
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 321
* ECS010V.cbl
 16627         NEXT  SENTENCE
 16628       ELSE
 16629         MOVE ZEROS TO EPEC-CLM-EXP (SUB3).
 16630
 16631     ADD WX-CLM-AMT              TO EW-CLM-AMT.
 16632     ADD WX-CLM-EXP              TO EPEC-CLM-EXP (SUB3).
 16633     ADD WX-CLM-CNT              TO EW-CLM-CNT.
 16634     ADD WX-CLM-CRT              TO EW-CLM-CRT.
 16635     ADD WX-ACTIVE-COUNT         TO ACTIVE-COUNT.
 16636     ADD WX-CNC-CNT              TO EW-CNC-CNT.
 16637
 16638     MOVE +0           TO SUB1.
 16639     PERFORM 4300-EP-COMM-LOOP THRU 4350-EP-COMM-LOOP-X
 16640         10 TIMES.
 16641     MOVE +0                     TO SUB16
 16642     PERFORM 4375-EP-BANK-COMM   THRU 4375-EXIT VARYING
 16643        WS-SUB1 FROM +1 BY +1 UNTIL WS-SUB1 > +10
 16644
 16645     IF REIN-EP-FLG NOT = 'R'  OR
 16646        CR-POLICY-IS-REIN-ONLY
 16647         MOVE ISS-BEN TO GROSS-ISS-BEN-AH
 16648         MOVE CNC-BEN TO GROSS-CNC-BEN-AH
 16649         MOVE ISS-PRM TO GROSS-ISS-PRM-AH
 16650         MOVE CNC-PRM TO GROSS-CNC-PRM-AH.
 16651
 16652     ADD ISS-BEN TO EW-ISS-BEN.
 16653     ADD GROSS-ISS-BEN-AH TO EW-ISS-BEN-GROSS.
 16654     ADD CNC-BEN TO EW-CNC-BEN.
 16655     ADD GROSS-CNC-BEN-AH TO EW-CNC-BEN-GROSS.
 16656     ADD ISS-PRM TO EW-ISS-PRM.
 16657     ADD GROSS-ISS-PRM-AH TO EW-ISS-PRM-GROSS.
 16658     ADD CNC-PRM TO EW-CNC-PRM.
 16659     ADD GROSS-CNC-PRM-AH TO EW-CNC-PRM-GROSS.
 16660
 16661     COMPUTE EW-EPR-R78 = EW-EPR-R78 + EPR-R78.
 16662     COMPUTE EW-EPR-PRO = EW-EPR-PRO + EPR-PRO.
 16663     COMPUTE EW-EPR-ST  = EW-EPR-ST  + EPR-ST.
 16664
 16665     IF CR-AH-ISS-PREM-TAX NOT NUMERIC
 16666        MOVE ZEROS               TO CR-AH-ISS-PREM-TAX
 16667     END-IF
 16668     IF CR-AH-CNC-PREM-TAX NOT NUMERIC
 16669        MOVE ZEROS               TO CR-AH-CNC-PREM-TAX
 16670     END-IF
 16671     COMPUTE ISS-PRMTAX =
 16672        (ISS-PRM * CR-AH-ISS-PREM-TAX) -
 16673        (CNC-PRM * CR-AH-CNC-PREM-TAX)
 16674     COMPUTE EW-ISS-PRM-TAX = EW-ISS-PRM-TAX + ISS-PRMTAX
 16675
 16676     IF A-H-FULLY-EARNED
 16677         COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ +
 16678                                            (ISS-PRM - EPR-R78)
 16679         COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ +
 16680                                            (ISS-PRM - EPR-PRO)
 16681         COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ +
 16682                                            (ISS-PRM - EPR-ST).
 16683
 16684     IF  DTE-OPT-RESERVE-METHOD-AUTH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 322
* ECS010V.cbl
 16685         IF  REIN-EP-FLG NOT = 'R'
 16686                 OR
 16687             CR-POLICY-IS-REIN-ONLY
 16688             MOVE 'A'      TO W-CLAIM-TYPE
 16689             MOVE EPR-R78  TO W-OPT-R78
 16690             MOVE EPR-PRO  TO W-OPT-PRO
 16691             MOVE EPR-ST   TO W-OPT-ST
 16692             PERFORM 4600-GET-OPT-IBNR THRU 4600-EXIT
 16693             MOVE ZEROS    TO EW-CLM-IBNR
 16694         ELSE
 16695             IF  STOP-AH-DATE LESS THAN EOM-RUN-DATE
 16696                 MOVE 'N'   TO EPEC-LINE-NOT-USED-IND (SUB3)
 16697                 MOVE ZEROS TO EW-CLM-IBNR
 16698             ELSE
 16699                 MOVE ZEROS TO EW-CLM-IBNR
 16700     ELSE
 16701         IF  DTE-CLIENT NOT EQUAL 'ITG'
 16702             ADD WE-DIS-IBNR     TO EW-CLM-IBNR
 16703         ELSE
 16704             IF  CLAS-I-BAL (CLAS-INDEXA) NOT EQUAL 'B'
 16705                 IF  CR-AH-POLICY-IS-ACTIVE
 16706                     COMPUTE  EW-CLM-IBNR  =  EW-CLM-IBNR
 16707                              + ((WE-AHPRM - EPR-PRO) * .0730000)
 16708                 ELSE
 16709                     NEXT SENTENCE
 16710             ELSE
 16711                 IF  CR-DT GREATER THAN LAST-YRS-DATE
 16712                     COMPUTE  EW-CLM-IBNR
 16713                         = EW-CLM-IBNR + (WE-AHPRM * .0600000).
 16714
 16715     ADD WE-DIS-PAYCUR TO EW-CLM-PAYCUR.
 16716     ADD WE-DIS-FUTRSV TO EW-CLM-FUTRSV.
 16717
 16718 4290-CONTINUE.
 16719
 16720     MOVE 'Y'          TO EW-LEVEL-USED.
 16721
 16722     IF CR-POLICY-UNDERWRITTEN
 16723         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 16724         MOVE EPEC-OPT-WORK-TABLE
 16725                              TO EPEC-UNDW-OPT-DATA-TABLE
 16726     ELSE
 16727         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3)
 16728         MOVE EPEC-OPT-WORK-TABLE
 16729                              TO EPEC-OPT-DATA-TABLE.
 16730
 16731
 16732 4295-EP-DO-COUNT.
 16733
 16734     IF REIN-EP-FLG = 'R'
 16735         ADD ACTIVE-COUNT TO BC-R-A-CERTS
 16736     ELSE
 16737         ADD ACTIVE-COUNT TO BC-G-A-CERTS.
 16738
 16739     GO TO 4299-EPBX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 323
* ECS010V.cbl
 16741 4296-SLOT-INTO-EFFECTED-MONTHS.
 16742
 16743     IF  CR-DT NOT GREATER THAN EOM-DATE (SUBM)
 16744             AND
 16745         CR-AH-EXPIRE-DATE GREATER THAN EOM-DATE (SUBM)
 16746             AND
 16747         (CR-AH-CANC-DT GREATER THAN EOM-DATE (SUBM)
 16748                 OR
 16749          CR-AH-CANC-DT EQUAL ZEROS)
 16750         MOVE 'Y'                 TO W-TABLE-USED-SW
 16751         IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 16752             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM) ROUNDED
 16753                 = EPEC-LIFE-CTR (SUB3 SUBM)
 16754                 + CR-LIVES
 16755         ELSE
 16756             COMPUTE EPEC-LIFE-CTR (SUB3 SUBM)
 16757                 = EPEC-LIFE-CTR (SUB3 SUBM) + 1.
 16758
 16759 4296-EXIT.
 16760     EXIT.
 16761
 16762 4299-EPBX.
 16763     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 324
* ECS010V.cbl
 16765******************************************************************
 16766***    C A L C U L A T E   E A R N E D   C O M M I S S I O N   ***
 16767******************************************************************
 16768
 16769 4300-EP-COMM-LOOP.
 16770     IF DTE-CLIENT = 'DMD'
 16771         GO TO 4350-EP-COMM-LOOP-X.
 16772
 16773     ADD +1                         TO SUB1.
 16774     MOVE ZEROS                     TO SUB16.
 16775
 16776     IF CR-ADDL-CLP NOT NUMERIC
 16777        MOVE ZEROS               TO CR-ADDL-CLP
 16778     END-IF
 16779     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 16780         GO TO 4350-EP-COMM-LOOP-X.
 16781
 16782 4300-AGENT-LOOP.
 16783
 16784     ADD +1                         TO SUB16.
 16785
 16786     IF SUB16 GREATER THAN WS-LOOP-MAX
 16787         DISPLAY 'ERROR OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16788         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 16789         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 16790                                     TO WS-ABEND-MESSAGE
 16791         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 16792         MOVE 4001                   TO WS-ABEND-CODE
 16793         GO TO ABEND-PGM.
 16794
 16795     IF EW-AGT-NO (SUB16) = SPACES
 16796         MOVE CR-COM-AGT  (SUB1)     TO EW-AGT-NO   (SUB16)
 16797         MOVE CR-AGT-TYPE (SUB1)     TO EW-AGT-TYPE (SUB16)
 16798     ELSE
 16799         IF (CR-COM-AGT (SUB1)  = EW-AGT-NO   (SUB16)) AND
 16800            (CR-AGT-TYPE (SUB1) = EW-AGT-TYPE (SUB16))
 16801             NEXT SENTENCE
 16802         ELSE
 16803             GO TO 4300-AGENT-LOOP.
 16804
 16805     IF EW-LF-AH = AH-OVERRIDE-L1
 16806         GO TO 4350-EP-COMM-LOOP-A.
 16807
 16808     IF (DTE-CLIENT = 'DCC')
 16809        AND (REIN-EP-FLG = 'R')
 16810        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16811        AND (WE-LFPRM NOT = ZEROS)
 16812        COMPUTE WS-CEDE-FACT = RWF-LFAMT /
 16813            (CR-LFAMT + CR-LFAMT-ALT)
 16814*       COMPUTE ISS-WK ROUNDED = ((WE-LFPRM + WE-LFPRM-ALT)
 16815        COMPUTE ISS-WK ROUNDED = ((CR-LFPRM + CR-LFPRM-ALT)
 16816           * WS-CEDE-FACT) * CR-LCOM-L (SUB1)
 16817     ELSE
 16818        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L'
 16819                             OR 'J'
 16820           COMPUTE ISS-WK = CR-LCOM-L (SUB1) * +1000
 16821        ELSE
 16822           COMPUTE ISS-WK  ROUNDED = ISS-PRM * CR-LCOM-L (SUB1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 325
* ECS010V.cbl
 16823        END-IF
 16824     END-IF
 16825
 16826     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 16827
 16828     MOVE ZEROS                  TO CNC-WK
 16829                                    CNC-FACT
 16830     IF DTE-CLIENT EQUAL 'XXX'
 16831         IF NOT CR-NO-LF-CHARGEBACK
 16832            COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-L (SUB1)
 16833            COMPUTE EW-CNC-COM (SUB16) = EW-CNC-COM (SUB16)
 16834                                + CNC-WK
 16835            GO TO 4300-CONTINUE-LOOP.
 16836
 16837
 16838     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16839        (WS-LF-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16840        IF (CR-AGT-TYPE (SUB1) = 'K')
 16841           AND (CNC-PRM > +0)
 16842           COMPUTE CNC-WK = CR-LCOM-L (SUB1) * +1000
 16843        ELSE
 16844           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L' OR 'J')
 16845              AND (CNC-PRM > +0)
 16846              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16847              COMPUTE CNC-WK = CNC-FACT *
 16848                 (CR-LCOM-L (SUB1) * +1000)
 16849           ELSE
 16850             IF (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 16851                AND (CR-AGT-TYPE (SUB1) = 'C' OR 'D')
 16852                COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16853                COMPUTE CNC-WK = CNC-FACT *
 16854                   (CR-AHPRM - (CR-LFPRM-ALT
 16855                   + CR-ADDL-CLP))
 16856             ELSE
 16857                COMPUTE CNC-WK  ROUNDED =
 16858                   CNC-PRM * CR-LCOM-L (SUB1)
 16859             END-IF
 16860           END-IF
 16861        END-IF
 16862        COMPUTE EW-CNC-COM (SUB16) =
 16863                                  EW-CNC-COM (SUB16) + CNC-WK
 16864     END-IF
 16865     .
 16866 4300-CONTINUE-LOOP.
 16867
 16868     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16869               OR
 16870        ((ISS-WK - CNC-WK) = ZEROS)
 16871        MOVE ZEROS              TO COMM-WK
 16872     ELSE
 16873        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 16874        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16875     END-IF
 16876
 16877     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 16878
 16879     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16880               OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 326
* ECS010V.cbl
 16881        ((ISS-WK - CNC-WK) = ZEROS)
 16882        MOVE ZEROS              TO COMM-WK
 16883     ELSE
 16884        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 16885        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16886     END-IF
 16887     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 16888
 16889     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16890               OR
 16891        ((ISS-WK - CNC-WK) = ZEROS)
 16892        MOVE ZEROS              TO COMM-WK
 16893     ELSE
 16894        COMPUTE COMM-WK ROUNDED = EPR-ST /
 16895        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16896     END-IF
 16897
 16898     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 16899
 16900     IF LIFE-FULLY-EARNED
 16901         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 16902                                                CR-LCOM-L (SUB1)
 16903         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 16904                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 16905         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 16906                                                CR-LCOM-L (SUB1)
 16907         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 16908                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 16909
 16910     GO TO 4350-EP-COMM-LOOP-X.
 16911
 16912 4350-EP-COMM-LOOP-A.
 16913
 16914     IF (DTE-CLIENT = 'DCC')
 16915        AND (REIN-EP-FLG = 'R')
 16916        AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16917        AND (WE-AHPRM NOT = ZEROS)
 16918        COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16919        COMPUTE ISS-WK ROUNDED = (CR-AHPRM * WS-CEDE-FACT)
 16920*       COMPUTE ISS-WK ROUNDED = (WE-AHPRM * WS-CEDE-FACT)
 16921           * CR-LCOM-AH (SUB1)
 16922     ELSE
 16923        IF CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'K' OR 'L' OR 'J'
 16924           COMPUTE ISS-WK = CR-LCOM-AH (SUB1) * +1000
 16925        ELSE
 16926           IF (CR-AGT-TYPE (SUB1) = 'D' OR 'C')
 16927             AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA)) = 'G' OR 'L'
 16928              COMPUTE ISS-WK = CR-AHPRM - (CR-LFPRM-ALT
 16929              + CR-ADDL-CLP)
 16930           ELSE
 16931              COMPUTE ISS-WK  ROUNDED =
 16932                    ISS-PRM * CR-LCOM-AH (SUB1)
 16933           END-IF
 16934        END-IF
 16935     END-IF
 16936
 16937     COMPUTE EW-ISS-COM (SUB16) =
 16938             EW-ISS-COM (SUB16) + ISS-WK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 327
* ECS010V.cbl
 16939
 16940     MOVE ZEROS                  TO CNC-WK
 16941     IF DTE-CLIENT EQUAL 'XXX'
 16942         IF NOT CR-NO-LF-CHARGEBACK
 16943           COMPUTE CNC-WK  ROUNDED = CNC-PRM * CR-LCOM-AH (SUB1)
 16944           COMPUTE EW-CNC-COM (SUB16) =
 16945                   EW-CNC-COM (SUB16) + CNC-WK
 16946           GO TO 4300-CONTINUE-LOOP-AH.
 16947
 16948
 16949     IF (WS-LEVELS-CHARGEBACK-SWITCHES = SPACES) OR
 16950        (WS-AH-CHARGEBACK-SW (SUB1) EQUAL 'Y')
 16951      IF (DTE-CLIENT = 'DCC')
 16952         AND (REIN-EP-FLG = 'R')
 16953         AND (CR-AGT-TYPE (SUB1) = 'P' OR 'T')
 16954         AND (WE-AHRFND NOT = ZEROS)
 16955         COMPUTE WS-CEDE-FACT = RWF-AHAMT / CR-AHAMT
 16956         COMPUTE CNC-WK ROUNDED = (CR-AHRFND * WS-CEDE-FACT)
 16957            * CR-LCOM-AH (SUB1)
 16958      ELSE
 16959
 16960
 16961
 16962        IF (CR-AGT-TYPE (SUB1) = 'K')
 16963           AND (CNC-PRM > +0)
 16964           COMPUTE CNC-WK = CR-LCOM-AH (SUB1) * +1000
 16965        ELSE
 16966           IF (CR-AGT-TYPE (SUB1) = 'B' OR 'I' OR 'L' OR 'J')
 16967              AND (CNC-PRM > +0)
 16968              COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 16969              COMPUTE CNC-WK = CNC-FACT *
 16970                 (CR-LCOM-AH (SUB1) * +1000)
 16971           ELSE
 16972              IF CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L'
 16973                 COMPUTE CNC-FACT = CR-AHRFND / CR-AHPRM
 16974                 COMPUTE CNC-WK = CNC-FACT *
 16975                    (CR-AHPRM - (CR-LFPRM-ALT
 16976                    + CR-ADDL-CLP))
 16977              ELSE
 16978                 COMPUTE CNC-WK  ROUNDED =
 16979                    CNC-PRM * CR-LCOM-AH (SUB1)
 16980              END-IF
 16981           END-IF
 16982        END-IF
 16983      END-IF
 16984        COMPUTE EW-CNC-COM (SUB16) =
 16985                   EW-CNC-COM (SUB16) + CNC-WK
 16986     END-IF
 16987
 16988     .
 16989 4300-CONTINUE-LOOP-AH.
 16990
 16991     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 16992                OR
 16993        ((ISS-WK - CNC-WK) = ZEROS)
 16994        MOVE ZEROS          TO COMM-WK
 16995     ELSE
 16996        COMPUTE COMM-WK ROUNDED = EPR-R78 /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 328
* ECS010V.cbl
 16997        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 16998     END-IF
 16999
 17000     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17001
 17002     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17003                OR
 17004        ((ISS-WK - CNC-WK) = ZEROS)
 17005        MOVE ZEROS          TO COMM-WK
 17006     ELSE
 17007        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17008        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17009     END-IF
 17010
 17011     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17012
 17013     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17014                OR
 17015        ((ISS-WK - CNC-WK) = ZEROS)
 17016        MOVE ZEROS          TO COMM-WK
 17017     ELSE
 17018        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17019        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17020     END-IF
 17021
 17022     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17023
 17024     IF A-H-FULLY-EARNED
 17025         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-R78) *
 17026                                                CR-LCOM-AH (SUB1)
 17027         COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17028                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17029         COMPUTE COMM-WK ROUNDED = (ISS-PRM - EPR-PRO) *
 17030                                                CR-LCOM-AH (SUB1)
 17031         COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17032                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK.
 17033
 17034 4350-EP-COMM-LOOP-X.
 17035     EXIT.
 17036
 17037
 17038
 17039
 17040******************************************************************
 17041***    C A L C U L A T E   E A R N E D  BANK COMMISSION        ***
 17042******************************************************************
 17043
 17044 4375-EP-BANK-COMM.
 17045
 17046     IF CS-AGT (SUB1) = SPACES OR ZEROS
 17047        GO TO 4375-EXIT
 17048     END-IF
 17049     .
 17050 4375-BANK-LOOP.
 17051
 17052     ADD +1                      TO SUB16
 17053
 17054     IF EW-LF-AH NOT = AH-OVERRIDE-L1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 329
* ECS010V.cbl
 17055        GO TO 4375-EXIT
 17056     END-IF
 17057
 17058     IF SUB16 GREATER THAN WS-LOOP-MAX
 17059         DISPLAY 'ERROR OCCURRED - MAXIMUM BANK  LEVELS EXCEEDED'
 17060         DISPLAY 'CONTROL= ' CR-FULL-CONTROL
 17061         MOVE 'ERR0R OCCURRED - MAXIMUM AGENT LEVELS EXCEEDED'
 17062                                     TO WS-ABEND-MESSAGE
 17063         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17064         MOVE 4001                   TO WS-ABEND-CODE
 17065         PERFORM ABEND-PGM
 17066     END-IF
 17067
 17068     IF EW-AGT-NO (SUB16) = SPACES
 17069        MOVE CS-AGT (SUB1)       TO EW-AGT-NO   (SUB16)
 17070        MOVE CS-COM-TYP (SUB1)   TO EW-AGT-TYPE (SUB16)
 17071     ELSE
 17072        IF (CS-AGT (SUB1) = EW-AGT-NO   (SUB16)) AND
 17073           (CS-COM-TYP (SUB1) = EW-AGT-TYPE (SUB16))
 17074           CONTINUE
 17075        ELSE
 17076           GO TO 4375-BANK-LOOP
 17077        END-IF
 17078     END-IF
 17079
 17080     IF CS-COM-TYP  (SUB1) = 'B'
 17081        MOVE CS-SPP-FEES (SUB1)  TO ISS-WK
 17082     END-IF
 17083
 17084     COMPUTE EW-ISS-COM (SUB16) = EW-ISS-COM (SUB16) + ISS-WK.
 17085
 17086     MOVE ZEROS                  TO CNC-WK
 17087                                    CNC-FACT
 17088
 17089     IF (CS-COM-TYP (SUB1) = 'B')
 17090        AND (CNC-PRM > +0)
 17091        COMPUTE CNC-FACT = CNC-PRM / ISS-PRM
 17092        COMPUTE CNC-WK = CNC-FACT * CS-SPP-FEES (SUB1)
 17093     END-IF
 17094
 17095     COMPUTE EW-CNC-COM (SUB16) =
 17096                  EW-CNC-COM (SUB16) + CNC-WK
 17097
 17098     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17099                OR
 17100        ((ISS-WK - CNC-WK) = ZEROS)
 17101        MOVE ZEROS          TO COMM-WK
 17102     ELSE
 17103        COMPUTE COMM-WK ROUNDED = EPR-R78 /
 17104        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17105     END-IF
 17106
 17107     COMPUTE EW-ECR-R78 (SUB16) = EW-ECR-R78 (SUB16) + COMM-WK.
 17108
 17109     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17110                OR
 17111        ((ISS-WK - CNC-WK) = ZEROS)
 17112        MOVE ZEROS          TO COMM-WK
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 330
* ECS010V.cbl
 17113     ELSE
 17114        COMPUTE COMM-WK ROUNDED = EPR-PRO /
 17115        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17116     END-IF
 17117
 17118     COMPUTE EW-ECR-PRO (SUB16) = EW-ECR-PRO (SUB16) + COMM-WK.
 17119
 17120     IF ((ISS-PRM - CNC-PRM) = ZEROS)
 17121                OR
 17122        ((ISS-WK - CNC-WK) = ZEROS)
 17123        MOVE ZEROS          TO COMM-WK
 17124     ELSE
 17125        COMPUTE COMM-WK ROUNDED = EPR-ST  /
 17126        (ISS-PRM - CNC-PRM) * (ISS-WK - CNC-WK)
 17127     END-IF
 17128
 17129     COMPUTE EW-ECR-ST (SUB16) = EW-ECR-ST (SUB16) + COMM-WK.
 17130
 17131     IF A-H-FULLY-EARNED
 17132        MOVE CS-SPP-FEES (SUB1)  TO COMM-WK
 17133        COMPUTE EW-ECR-R78-ADJ (SUB16) =
 17134                               EW-ECR-R78-ADJ (SUB16) + COMM-WK
 17135        COMPUTE EW-ECR-PRO-ADJ (SUB16) =
 17136                               EW-ECR-PRO-ADJ (SUB16) + COMM-WK
 17137     END-IF
 17138
 17139     .
 17140 4375-EXIT.
 17141     EXIT.
 17142
 17143******************************************************************
 17144******************************************************************
 17145******************************************************************
 17146******************************************************************
 17147******************************************************************
 17148******************************************************************
 17149******************************************************************
 17150******************************************************************
 17151******************************************************************
 17152******************************************************************
 17153***  C A L C U L A T E   L I F E   S T A R T I N G  E A R N E D***
 17154******************************************************************
 17155
 17156 S-4100-EP-DO-LF.
 17157
 17158     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17159                                        EPR-PRO
 17160                                        EPR-ST.
 17161
 17162     MOVE RCT-EARNING-START-DT (CO-SUB) TO DC-GREG-DATE-CYMD.
 17163     MOVE 'L'                    TO DC-OPTION-CODE.
 17164     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17165
 17166     MOVE +0                     TO DC-ELAPSED-MONTHS.
 17167     MOVE -1                     TO DC-ELAPSED-DAYS.
 17168     MOVE '6'                    TO DC-OPTION-CODE.
 17169     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17170
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 331
* ECS010V.cbl
 17171     MOVE +0                     TO DC-ELAPSED-MONTHS
 17172                                    DC-ELAPSED-DAYS.
 17173
 17174     MOVE DC-BIN-DATE-2          TO DC-BIN-DATE-1.
 17175     MOVE ' '                    TO DC-OPTION-CODE.
 17176     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17177
 17178     IF NO-CONVERSION-ERROR
 17179        MOVE DC-GREG-DATE-CYMD   TO EARNING-START-DATE
 17180     ELSE
 17181         DISPLAY 'ERROR OCCURED CONVERTING EARNING START DATE '
 17182                 'FOR REIN. CO. ' RCT-REIN-CO (CO-SUB)
 17183                 '  START DATE:' RCT-EARNING-START-DT (CO-SUB)
 17184         MOVE 'ERROR OCCURED CONVERTING EARNING START DATE '
 17185                                     TO WS-ABEND-MESSAGE
 17186         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 17187         MOVE 4001                   TO WS-ABEND-CODE
 17188         GO TO ABEND-PGM.
 17189
 17190     IF CR-LFTYP = ZERO
 17191         GO TO S-4200-EP-DO-AH.
 17192
 17193     IF REIN-LF-FLG (SUB5) = SPACE
 17194         GO TO S-4200-EP-DO-AH.
 17195
 17196     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
 17197     MOVE CR-LFTYP               TO WE-BEN-TYPE.
 17198     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17199
 17200     MOVE CR-LF-TERM             TO ORIG-TERM.
 17201     MOVE CLAS-INDEXL            TO W-NDX.
 17202
 17203 S-4120-EP-DO-LF-CNCL.
 17204
 17205     IF CR-LF-STATUS-AT-CANCEL = ' '  AND
 17206        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
 17207         GO TO S-4130-EP-DO-LF-EP.
 17208
 17209     COMPUTE EARNED-BY-CANCEL =
 17210                       (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
 17211
 17212 S-4130-EP-DO-LF-EP.
 17213
 17214     MOVE SPACE                  TO STATUTORY-SWITCH.
 17215
 17216     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17217     MOVE '9'                    TO W-VAL-SOURCE.
 17218     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17219
 17220     IF REM-TRM2 GREATER CR-LF-TERM
 17221         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17222         GO TO S-4190-EP-DO-LF-COMM.
 17223
 17224     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
 17225         GO TO S-4180-EP-DO-LF-EP-SUM.
 17226
 17227     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
 17228         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 332
* ECS010V.cbl
 17229             IF REM-TRM2 NOT GREATER THAN +0
 17230                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17231                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17232                 GO TO S-4190-EP-DO-LF-COMM
 17233             ELSE
 17234                 NEXT SENTENCE
 17235         ELSE
 17236             IF W-BAL-REMTRM NOT GREATER +0
 17237                 COMPUTE EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
 17238                 MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17239                 GO TO S-4190-EP-DO-LF-COMM
 17240             ELSE
 17241                 NEXT SENTENCE
 17242     ELSE
 17243        IF (DTE-CLIENT EQUAL 'NCL') AND
 17244           (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B')
 17245             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17246        ELSE
 17247         IF REM-TRM2 NOT GREATER +0  OR
 17248            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 17249             MOVE WE-LFPRM TO EPR-R78  EPR-PRO  EPR-ST
 17250             GO TO S-4190-EP-DO-LF-COMM.
 17251
 17252     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
 17253         GO TO S-4140-EP-DO-LF-EP-TEX.
 17254
 17255     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
 17256         GO TO S-4150-EP-DO-LF-EP-NP.
 17257
 17258*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
 17259     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
 17260        (CR-RATING-CLASS NOT = 'L ')
 17261         IF (CR-APR GREATER THAN ZERO)  AND
 17262            (CR-LF-TERM GREATER THAN 060)  AND
 17263            (CR-DT GREATER THAN 19831031)
 17264             MOVE '*'             TO STATUTORY-SWITCH
 17265              GO TO S-4150-EP-DO-LF-EP-NP.
 17266
 17267     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
 17268         IF (CR-APR GREATER THAN ZERO)  AND
 17269            (CR-LF-TERM GREATER THAN 061)  AND
 17270            (CR-DT GREATER THAN 19830318)
 17271             MOVE '*'             TO STATUTORY-SWITCH
 17272              GO TO S-4150-EP-DO-LF-EP-NP.
 17273
 17274     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
 17275         IF (CR-APR GREATER THAN ZERO)  AND
 17276            (CR-LF-TERM GREATER THAN 062)  AND
 17277            (CR-DT GREATER THAN 19810831)  AND
 17278            (CR-DT LESS THAN 19830901)
 17279             MOVE '*'             TO STATUTORY-SWITCH
 17280              GO TO S-4150-EP-DO-LF-EP-NP.
 17281
 17282     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
 17283         IF (CR-APR GREATER THAN ZERO)  AND
 17284            (CR-LF-TERM GREATER THAN 060)  AND
 17285            (CR-DT GREATER THAN 19831231)
 17286             MOVE '*'             TO STATUTORY-SWITCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 333
* ECS010V.cbl
 17287              GO TO S-4150-EP-DO-LF-EP-NP.
 17288
 17289     GO TO S-4160-EP-DO-LF-EP-R78.
 17290
 17291 S-4140-EP-DO-LF-EP-TEX.
 17292
 17293     COMPUTE TEX-FACT-4 =
 17294         (CR-LF-TERM * CR-LF-TERM) + (CR-PMT-FREQ * CR-LF-TERM).
 17295     DIVIDE REM-TRM1 BY CR-PMT-FREQ
 17296         GIVING TEX-FACT-5
 17297             REMAINDER TEX-FACT-6.
 17298     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
 17299     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
 17300         (TEX-FACT-5 * CR-PMT-FREQ) +
 17301         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CR-PMT-FREQ))).
 17302     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
 17303
 17304     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
 17305
 17306     GO TO S-4170-EP-DO-LF-EP-PRO.
 17307
 17308 S-4150-EP-DO-LF-EP-NP.
 17309
 17310     IF WE-LFPRM = ZERO
 17311         GO TO S-4160-EP-DO-LF-EP-R78.
 17312
 17313     IF DTE-CLIENT = 'CRI'
 17314       IF STATE-ABBR (CLAS-INDEXS) = ('AB' OR 'BC' OR 'MB' OR
 17315             'NS' OR 'ON' OR 'NB' OR 'NF' OR 'QB' OR 'SK' OR 'PE')
 17316           GO TO S-4160-EP-DO-LF-EP-R78.
 17317
 17318     IF DTE-CLIENT = 'NCL'
 17319       IF CR-DT LESS THAN 19910101
 17320           GO TO S-4160-EP-DO-LF-EP-R78.
 17321
 17322     IF REM-TRM1 = CR-LF-TERM
 17323         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17324         GO TO S-4190-EP-DO-LF-COMM.
 17325
 17326     MOVE CR-APR TO NP-APR.
 17327     MOVE CR-LF-TERM TO NP-ORIG  NP-CAP.
 17328     MOVE REM-TRM1 TO NP-REM.
 17329     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
 17330     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17331         MOVE CR-LOAN-TERM TO NP-ORIG.
 17332     MOVE 'R' TO NP-OPT.
 17333     CALL 'ECSNETRM'
 17334         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17335
 17336     COMPUTE EPR-R78 ROUNDED = WE-LFPRM - (NP-FACTOR * WE-LFPRM).
 17337
 17338     IF STATUTORY-REQUIREMENT
 17339         MOVE EPR-R78                TO EPR-ST.
 17340
 17341 S-4160-EP-DO-LF-EP-R78.
 17342
 17343     IF (CLAS-I-CALC-TYPE (CLAS-INDEXL) EQUAL 'B') AND
 17344        (DTE-CLIENT EQUAL 'NCL')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 334
* ECS010V.cbl
 17345        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17346           (CR-MO EQUAL EOM-MO)
 17347           MOVE '*'            TO OB-DATE-1-SWITCH
 17348           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17349           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17350           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17351           COMPUTE WS-EPR-R78 (SUB3 1) =
 17352                   WS-EPR-R78 (SUB3 1) - (WE-LFPRM * .5)
 17353           GO TO S-4190-EP-DO-LF-COMM
 17354        ELSE
 17355        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17356           (CR-MO EQUAL OB-MO (1))
 17357           MOVE '*'            TO OB-DATE-2-SWITCH
 17358           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17359           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17360           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17361           COMPUTE WS-EPR-R78 (SUB3 2) =
 17362                   WS-EPR-R78 (SUB3 2) - (WE-LFPRM * .5)
 17363           GO TO S-4190-EP-DO-LF-COMM
 17364        ELSE
 17365        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17366           (CR-MO EQUAL OB-MO (2))
 17367           MOVE '*'            TO OB-DATE-3-SWITCH
 17368           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17369           MOVE LIFE-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17370           MOVE CR-LFTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17371           COMPUTE WS-EPR-R78 (SUB3 3) =
 17372                   WS-EPR-R78 (SUB3 3) - (WE-LFPRM * .5)
 17373           GO TO S-4190-EP-DO-LF-COMM
 17374        ELSE
 17375           GO TO S-4190-EP-DO-LF-COMM.
 17376
 17377     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17378
 17379     IF DTE-R78 = '1'
 17380         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1
 17381     ELSE
 17382         COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17383
 17384     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17385
 17386     IF REM-TRM1 GREATER THAN +0
 17387         COMPUTE TEMP-7 ROUNDED EQUAL
 17388             WE-LFPRM - (WE-LFPRM * TEMP-4)
 17389     ELSE
 17390         MOVE WE-LFPRM                TO TEMP-7.
 17391
 17392     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17393         MOVE ZEROS                  TO TEMP-8
 17394         GO TO S-4165-END-LF-EP-R78.
 17395
 17396     IF EPR-ST NOT = ZEROS
 17397         MOVE TEMP-7                 TO EPR-ST.
 17398
 17399     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17400         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
 17401         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
 17402         IF DTE-R78 = '1'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 335
* ECS010V.cbl
 17403             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
 17404
 17405     COMPUTE TEMP-4 ROUNDED EQUAL TEMP-2 / TEMP-1.
 17406
 17407     COMPUTE TEMP-8 ROUNDED =
 17408               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
 17409
 17410 S-4165-END-LF-EP-R78.
 17411
 17412     IF EPR-R78 = ZEROS
 17413         COMPUTE EPR-R78 = TEMP-7 + TEMP-8
 17414     ELSE
 17415         COMPUTE EPR-R78 = EPR-R78 + TEMP-8.
 17416
 17417 S-4170-EP-DO-LF-EP-PRO.
 17418
 17419     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17420         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
 17421     ELSE
 17422         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17423
 17424     IF REM-TRM1 GREATER THAN +0
 17425         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
 17426     ELSE
 17427         MOVE WE-LFPRM                  TO TEMP-7.
 17428
 17429     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17430         MOVE ZEROS                     TO TEMP-8
 17431         GO TO S-4175-END-LF-EP-PRO.
 17432
 17433     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 17434         IF DTE-CLIENT = 'MIC' OR 'MCC'
 17435             COMPUTE TEMP-5 ROUNDED =
 17436                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
 17437         ELSE
 17438             COMPUTE TEMP-5 ROUNDED =
 17439                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
 17440
 17441     COMPUTE TEMP-8 ROUNDED =
 17442                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
 17443
 17444     COMPUTE EPR-ST = EPR-ST + TEMP-8.
 17445
 17446 S-4175-END-LF-EP-PRO.
 17447
 17448     COMPUTE EPR-PRO = TEMP-7 + TEMP-8.
 17449
 17450     GO TO S-4185-EP-DO-LF-STATUTORY.
 17451
 17452 S-4180-EP-DO-LF-EP-SUM.
 17453
 17454     IF REM-TRM1 NOT GREATER +0
 17455         COMPUTE EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
 17456         MOVE EPR-R78 TO EPR-PRO  EPR-ST
 17457         GO TO S-4190-EP-DO-LF-COMM.
 17458
 17459     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17460         MOVE ZEROS                 TO TEMP-7
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 336
* ECS010V.cbl
 17461     ELSE
 17462         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
 17463                       (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
 17464
 17465     IF TEMP-7 NOT GREATER ZERO
 17466         IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17467             MOVE ZEROS             TO EPR-R78  EPR-PRO  EPR-ST
 17468             GO TO S-4190-EP-DO-LF-COMM
 17469         ELSE
 17470             MOVE ZEROS             TO TEMP-7.
 17471
 17472     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
 17473     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17474     IF DTE-R78 = '1'
 17475         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17476
 17477     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17478     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
 17479
 17480     COMPUTE EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
 17481
 17482     COMPUTE EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
 17483
 17484     IF CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 17485         GO TO S-4185-EP-DO-LF-STATUTORY.
 17486
 17487     MOVE EPR-R78                  TO EPR-ST.
 17488
 17489     IF WE-LFPRM = ZERO  AND  WE-LFPRM-ALT = ZERO
 17490         MOVE ZEROS                 TO TEMP-8
 17491     ELSE
 17492         COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
 17493                     (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
 17494
 17495     IF TEMP-8 NOT GREATER ZERO
 17496         GO TO S-4185-EP-DO-LF-STATUTORY.
 17497
 17498     COMPUTE EPR-R78 ROUNDED = EPR-R78 +
 17499                              (TEMP-8 - (TEMP-8 * TEMP-4)).
 17500
 17501     COMPUTE EPR-PRO ROUNDED = EPR-PRO +
 17502                              (TEMP-8 - (TEMP-8 * TEMP-5)).
 17503
 17504     COMPUTE EPR-ST ROUNDED = EPR-ST +
 17505                             (TEMP-8 - (TEMP-8 * TEMP-5)).
 17506
 17507 S-4185-EP-DO-LF-STATUTORY.
 17508
 17509     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
 17510         MOVE EPR-R78                TO EPR-ST.
 17511
 17512     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
 17513         MOVE EPR-PRO                TO EPR-ST.
 17514
 17515     IF EPR-ST NOT = ZEROS
 17516         GO TO S-4190-EP-DO-LF-COMM.
 17517
 17518     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 337
* ECS010V.cbl
 17519         MOVE EPR-R78                TO EPR-ST
 17520     ELSE
 17521         MOVE EPR-PRO                TO EPR-ST.
 17522
 17523 S-4190-EP-DO-LF-COMM.
 17524
 17525     IF EARNED-BY-CANCEL = ZEROS
 17526         GO TO S-4195-LF-COMM-CONTINUE.
 17527
 17528     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17529         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17530
 17531     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17532         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17533
 17534     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17535         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17536
 17537 S-4195-LF-COMM-CONTINUE.
 17538
 17539     MOVE +0 TO SUB1.
 17540     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17541         10 TIMES.
 17542
 17543     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17544     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17545     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17546
 17547     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17548     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17549     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17550
 17551     MOVE 'Y'          TO EW-LEVEL-USED.
 17552
 17553     IF CR-POLICY-UNDERWRITTEN
 17554         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17555
 17556     ELSE
 17557         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17558
 17559     GO TO S-4200-EP-DO-AH.
 17560
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 338
* ECS010V.cbl
 17562******************************************************************
 17563***  C A L C U L A T E   A & H   S T A R T   E A R N E D       ***
 17564******************************************************************
 17565
 17566 S-4200-EP-DO-AH.
 17567
 17568     MOVE +0                         TO EPR-R78  EARNED-BY-CANCEL
 17569                                        EPR-PRO
 17570                                        EPR-ST.
 17571
 17572     IF CR-AHTYP = ZERO
 17573         GO TO S-4299-EPBX.
 17574
 17575     IF REIN-AH-FLG (SUB5) = SPACE
 17576         GO TO S-4299-EPBX.
 17577
 17578     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
 17579     MOVE CR-AHTYP             TO WE-BEN-TYPE.
 17580     PERFORM 4400-EP-FIND-TAB-ENT THRU 4499-EP-FIND-TAB-ENT-X.
 17581
 17582     MOVE CR-AH-TERM           TO ORIG-TERM.
 17583     MOVE CLAS-INDEXA          TO W-NDX.
 17584
 17585     MOVE EARNING-START-DATE     TO VALUATION-DT.
 17586     MOVE '9'                    TO W-VAL-SOURCE.
 17587     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 17588
 17589 S-4220-EP-DO-AH-CNCL.
 17590
 17591     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 17592         COMPUTE EARNED-BY-CANCEL = WE-AHPRM - WE-AHRFND.
 17593
 17594 S-4230-EP-DO-AH-EP.
 17595
 17596     IF REM-TRM2 GREATER CR-AH-TERM
 17597         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17598         GO TO S-4290-EP-DO-AH-COMM.
 17599
 17600     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 17601         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 17602
 17603 S-4235-CHECK-OB-AH-NCL.
 17604
 17605     IF (DTE-CLIENT EQUAL 'NCL') AND
 17606        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 17607           MOVE WE-AHPRM         TO EPR-R78
 17608                                    EPR-PRO
 17609                                    EPR-ST
 17610        IF (CR-CCYY EQUAL EOM-CCYY) AND
 17611           (CR-MO EQUAL EOM-MO)
 17612           MOVE '*'            TO OB-DATE-1-SWITCH
 17613           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17614           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17615           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17616           COMPUTE WS-EPR-R78 (SUB3 1) =
 17617                   WS-EPR-R78 (SUB3 1) - (WE-AHPRM * .5)
 17618            GO TO S-4290-EP-DO-AH-COMM
 17619        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 339
* ECS010V.cbl
 17620        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 17621           (CR-MO EQUAL OB-MO (1))
 17622           MOVE '*'            TO OB-DATE-2-SWITCH
 17623           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17624           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17625           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17626           COMPUTE WS-EPR-R78 (SUB3 2) =
 17627                   WS-EPR-R78 (SUB3 2) - (WE-AHPRM * .5)
 17628            GO TO S-4290-EP-DO-AH-COMM
 17629        ELSE
 17630        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 17631           (CR-MO EQUAL OB-MO (2))
 17632           MOVE '*'            TO OB-DATE-3-SWITCH
 17633           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 17634           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 17635           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 17636           COMPUTE WS-EPR-R78 (SUB3 3) =
 17637                   WS-EPR-R78 (SUB3 3) - (WE-AHPRM * .5)
 17638            GO TO S-4290-EP-DO-AH-COMM
 17639        ELSE
 17640            GO TO S-4290-EP-DO-AH-COMM.
 17641
 17642     IF REM-TRM2 NOT GREATER +0
 17643         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17644         GO TO S-4290-EP-DO-AH-COMM.
 17645
 17646     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 17647         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 17648         GO TO S-4290-EP-DO-AH-COMM.
 17649
 17650     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 17651     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 17652     IF DTE-R78 = '1'
 17653         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 17654     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 17655
 17656     IF DTE-CLIENT = 'MIC' OR 'MCC'
 17657         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 17658     ELSE
 17659         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 17660
 17661     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 17662     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17663
 17664     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 17665     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 17666
 17667     MOVE  CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 17668
 17669*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 17670*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 17671
 17672     MOVE SPACES TO STATUTORY-SWITCH-AH.
 17673
 17674     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 17675        (CR-DT GREATER THAN  19921231)
 17676         IF CR-AH-TERM GREATER THAN  +61
 17677             MOVE 'A' TO AH-EARN-METHOD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 340
* ECS010V.cbl
 17678             MOVE '*' TO STATUTORY-SWITCH-AH
 17679             GO TO S-4245-EP-DO-AH-EP-AN
 17680         ELSE
 17681             GO TO S-4250-EP-DO-AH-STATUTORY.
 17682
 17683     IF AH-EARN-METHOD EQUAL 'N'
 17684         GO TO S-4240-EP-DO-AH-EP-NP.
 17685
 17686     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 17687         MOVE 'A' TO AH-EARN-METHOD
 17688         GO TO S-4245-EP-DO-AH-EP-AN.
 17689
 17690     GO TO S-4250-EP-DO-AH-STATUTORY.
 17691
 17692 S-4240-EP-DO-AH-EP-NP.
 17693
 17694     IF WE-AHPRM = ZERO
 17695         GO TO S-4250-EP-DO-AH-STATUTORY.
 17696
 17697     IF CR-APR GREATER THAN +0
 17698         NEXT SENTENCE
 17699     ELSE
 17700         GO TO S-4250-EP-DO-AH-STATUTORY.
 17701
 17702     IF DTE-CLIENT = 'NCL'
 17703       IF CR-DT LESS THAN 19910101
 17704           GO TO S-4250-EP-DO-AH-STATUTORY.
 17705
 17706     IF REM-TRM1 = CR-AH-TERM
 17707         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 17708         GO TO S-4290-EP-DO-AH-COMM.
 17709
 17710     MOVE CR-APR TO NP-APR.
 17711     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 17712     MOVE REM-TRM1 TO NP-REM.
 17713     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 17714     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 17715         MOVE CR-LOAN-TERM TO NP-ORIG.
 17716     MOVE 'R' TO NP-OPT.
 17717     CALL 'ECSNETRM'
 17718         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 17719
 17720     COMPUTE EPR-R78 ROUNDED = WE-AHPRM - (NP-FACTOR * WE-AHPRM).
 17721
 17722     GO TO S-4250-EP-DO-AH-STATUTORY.
 17723
 17724 S-4245-EP-DO-AH-EP-AN.
 17725     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 17726     MOVE 'L'                        TO DC-OPTION-CODE.
 17727     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 17728     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 17729     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 17730     MOVE SPACES                     TO CP-ACCT-FLD-5.
 17731     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 17732     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 17733     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 17734     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 17735     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 341
* ECS010V.cbl
 17736     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 17737                                        CP-RATING-BENEFIT-AMT.
 17738     IF CP-STATE-STD-ABBRV = 'OR'
 17739         COMPUTE CP-RATING-BENEFIT-AMT =
 17740                                  CR-AHAMT * REM-TRM1.
 17741     MOVE CR-APR                     TO CP-LOAN-APR.
 17742     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 17743     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 17744     MOVE '3'                        TO CP-PROCESS-TYPE.
 17745     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 17746     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 17747
 17748     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 17749         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 17750     ELSE
 17751         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 17752
 17753     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 17754     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 17755     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 17756     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 17757     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 17758     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 17759
 17760     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 17761
 17762     IF CP-ERROR-RATE-NOT-FOUND  OR
 17763        CP-ERROR-RATE-IS-ZERO  OR
 17764        CP-ERROR-IN-DATES
 17765         GO TO S-4250-EP-DO-AH-STATUTORY.
 17766
 17767     COMPUTE EPR-R78 ROUNDED =
 17768             ((REM-TRM1 * WE-AHAMT) / +100) *
 17769               CP-PREMIUM-RATE.
 17770
 17771     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 17772
 17773     IF STATUTORY-REQUIREMENT-AH
 17774         MOVE EPR-R78                TO EPR-ST
 17775         GO TO S-4290-EP-DO-AH-COMM.
 17776
 17777 S-4250-EP-DO-AH-STATUTORY.
 17778     MOVE EPR-R78                    TO EPR-ST.
 17779
 17780     MOVE +0                         TO SUB1.
 17781
 17782 S-4255-EP-AH-STAT-LOOP.
 17783     ADD +1 TO SUB1.
 17784
 17785     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 17786         MOVE EPR-PRO                TO EPR-ST
 17787     ELSE
 17788         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 17789             GO TO S-4255-EP-AH-STAT-LOOP.
 17790
 17791     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 17792         CR-DT GREATER THAN 19831031)
 17793                    OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 342
* ECS010V.cbl
 17794        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 17795         CR-DT GREATER THAN 19820629)
 17796                    OR
 17797        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 17798         CR-DT GREATER THAN 19830831)
 17799             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17800
 17801     IF DTE-CLIENT = 'CSO'  OR  'CID'
 17802       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 17803         IF CR-DT LESS THAN 19970101
 17804             MOVE EPR-R78            TO EPR-ST
 17805         ELSE
 17806             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 17807
 17808 S-4290-EP-DO-AH-COMM.
 17809
 17810     IF EARNED-BY-CANCEL = ZEROS
 17811         GO TO S-4295-AH-COMM-CONTINUE.
 17812
 17813     IF EPR-R78 GREATER THAN EARNED-BY-CANCEL
 17814         MOVE EARNED-BY-CANCEL     TO EPR-R78.
 17815
 17816     IF EPR-PRO GREATER THAN EARNED-BY-CANCEL
 17817         MOVE EARNED-BY-CANCEL     TO EPR-PRO.
 17818
 17819     IF EPR-ST  GREATER THAN EARNED-BY-CANCEL
 17820         MOVE EARNED-BY-CANCEL     TO EPR-ST.
 17821
 17822 S-4295-AH-COMM-CONTINUE.
 17823
 17824     MOVE +0           TO SUB1.
 17825     PERFORM S-4300-EP-COMM-LOOP THRU S-4399-EP-COMM-LOOP-X
 17826         10 TIMES.
 17827
 17828     COMPUTE EW-EPR-R78 = EW-EPR-R78 - EPR-R78.
 17829     COMPUTE EW-EPR-PRO = EW-EPR-PRO - EPR-PRO.
 17830     COMPUTE EW-EPR-ST  = EW-EPR-ST  - EPR-ST.
 17831
 17832     COMPUTE EW-EPR-R78-ADJ = EW-EPR-R78-ADJ + EPR-R78.
 17833     COMPUTE EW-EPR-PRO-ADJ = EW-EPR-PRO-ADJ + EPR-PRO.
 17834     COMPUTE EW-EPR-ST-ADJ  = EW-EPR-ST-ADJ  + EPR-ST.
 17835
 17836     MOVE 'Y'          TO EW-LEVEL-USED.
 17837
 17838     IF CR-POLICY-UNDERWRITTEN
 17839         MOVE EPEC-WORK       TO EPEC-LEVELS-II (SUB3)
 17840     ELSE
 17841         MOVE EPEC-WORK       TO EPEC-LEVELS (SUB3).
 17842
 17843
 17844 S-4299-EPBX.
 17845     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 343
* ECS010V.cbl
 17847******************************************************************
 17848***    C A L C U L A T E   S T A R T   E A R N E D   C O M M   ***
 17849******************************************************************
 17850
 17851 S-4300-EP-COMM-LOOP.
 17852
 17853     ADD +1 TO SUB1.
 17854     IF CR-COM-AGT (SUB1) = SPACES OR ZEROS
 17855         GO TO S-4399-EP-COMM-LOOP-X.
 17856
 17857     IF EW-LF-AH = AH-OVERRIDE-L1
 17858         GO TO S-4350-EP-COMM-LOOP-A.
 17859
 17860*    IF CR-AGT-TYPE (SUB1) = 'K'
 17861*       COMPUTE COMM-WK =
 17862     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-L (SUB1).
 17863     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17864     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17865                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17866
 17867     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-L (SUB1).
 17868     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17869     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17870                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17871
 17872     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-L (SUB1).
 17873     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17874
 17875     GO TO S-4399-EP-COMM-LOOP-X.
 17876
 17877 S-4350-EP-COMM-LOOP-A.
 17878
 17879     COMPUTE COMM-WK ROUNDED = EPR-R78 * CR-LCOM-AH (SUB1).
 17880     COMPUTE EW-ECR-R78 (SUB1) = EW-ECR-R78 (SUB1) - COMM-WK.
 17881     COMPUTE EW-ECR-R78-ADJ (SUB1) =
 17882                                 EW-ECR-R78-ADJ (SUB1) + COMM-WK.
 17883
 17884     COMPUTE COMM-WK ROUNDED = EPR-PRO * CR-LCOM-AH (SUB1).
 17885     COMPUTE EW-ECR-PRO (SUB1) = EW-ECR-PRO (SUB1) - COMM-WK.
 17886     COMPUTE EW-ECR-PRO-ADJ (SUB1) =
 17887                                 EW-ECR-PRO-ADJ (SUB1) + COMM-WK.
 17888
 17889     COMPUTE COMM-WK ROUNDED = EPR-ST * CR-LCOM-AH (SUB1).
 17890     COMPUTE EW-ECR-ST (SUB1) = EW-ECR-ST (SUB1) - COMM-WK.
 17891
 17892 S-4399-EP-COMM-LOOP-X.
 17893     EXIT.
 17894
 17895******************************************************************
 17896******************************************************************
 17897******************************************************************
 17898******************************************************************
 17899******************************************************************
 17900******************************************************************
 17901******************************************************************
 17902******************************************************************
 17903******************************************************************
 17904******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 344
* ECS010V.cbl
 17906******************************************************************
 17907***     F I N D   R E I N S U R A N C E   T A B L E   S U B    ***
 17908******************************************************************
 17909
 17910 4400-EP-FIND-TAB-ENT.
 17911
 17912     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17913         GO TO 4490-EP-FIND-TAB-SUB.
 17914     MOVE +1 TO SUB9.
 17915
 17916 4450-EP-FIND-TAB-LOOP.
 17917
 17918     IF WE-REIN-CO = EPEC-SUB-REIN (SUB9)
 17919         GO TO 4490-EP-FIND-TAB-SUB.
 17920     IF EPEC-SUB-REIN (SUB9) = ZEROS
 17921         MOVE WE-REIN-CO TO EPEC-SUB-REIN (SUB9)
 17922         GO TO 4490-EP-FIND-TAB-SUB.
 17923
 17924     ADD +1 TO SUB9.
 17925     IF SUB9 GREATER THAN +31
 17926         DISPLAY 'EPEC SUBSCRIPT TABLE FULL ' AM-MSTR-CNTRL
 17927         MOVE 0201 TO WS-ABEND-CODE
 17928         DISPLAY '******************************'
 17929         DISPLAY '***** ERROR LOCATION 020 *****'
 17930         DISPLAY '******************************'
 17931         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 17932         GO TO ABEND-PGM.
 17933
 17934     GO TO 4450-EP-FIND-TAB-LOOP.
 17935
 17936 4490-EP-FIND-TAB-SUB.
 17937
 17938     IF WE-LF-AH = LIFE-OVERRIDE-L1
 17939         IF EPEC-SUB-LF (SUB9 CLAS-INDEXL) = ZERO
 17940             ADD +1 TO SUB10
 17941             MOVE SUB10 TO SUB3
 17942             MOVE SUB10 TO EPEC-SUB-LF (SUB9 CLAS-INDEXL)
 17943         ELSE
 17944             MOVE EPEC-SUB-LF (SUB9 CLAS-INDEXL) TO SUB3.
 17945
 17946     IF WE-LF-AH = AH-OVERRIDE-L1
 17947         IF EPEC-SUB-AH (SUB9 CLAS-INDEXA) = ZERO
 17948             ADD +1 TO SUB10
 17949             MOVE SUB10 TO SUB3
 17950             MOVE SUB10 TO EPEC-SUB-AH (SUB9 CLAS-INDEXA)
 17951         ELSE
 17952             MOVE EPEC-SUB-AH (SUB9 CLAS-INDEXA) TO SUB3.
 17953
 17954*    IF SUB3 GREATER THAN +220
 17955*    IF SUB3 GREATER THAN +300
 17956     IF SUB3 GREATER THAN +900
 17957         DISPLAY 'SUB3 VALUE IS - ' SUB3
 17958         DISPLAY 'EPEC WORK TABLE FULL ' AM-MSTR-CNTRL
 17959         MOVE 0202 TO WS-ABEND-CODE
 17960         DISPLAY '******************************'
 17961         DISPLAY '***** ERROR LOCATION 021 *****'
 17962         DISPLAY '******************************'
 17963         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 345
* ECS010V.cbl
 17964         GO TO ABEND-PGM.
 17965
 17966     IF CR-POLICY-UNDERWRITTEN
 17967         MOVE EPEC-LEVELS-II (SUB3)  TO EPEC-WORK
 17968         MOVE EPEC-UNDW-OPT-DATA-TABLE
 17969                                     TO EPEC-OPT-WORK-TABLE
 17970     ELSE
 17971         MOVE EPEC-LEVELS (SUB3)     TO EPEC-WORK
 17972         MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 17973
 17974     MOVE WE-REIN-CO         TO EW-REIN-CO
 17975                                EPEC-REIN-CO (SUB3)
 17976                                EPEC-REIN-CO-II (SUB3).
 17977     MOVE WE-LF-AH           TO EW-LF-AH
 17978                                EPEC-LF-AH (SUB3)
 17979                                EPEC-LF-AH-II (SUB3).
 17980     MOVE WE-BEN-TYPE        TO EW-BEN-TYPE
 17981                                EPEC-BEN-TYPE (SUB3)
 17982                                EPEC-BEN-TYPE-II (SUB3).
 17983
 17984 4499-EP-FIND-TAB-ENT-X.
 17985     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 346
* ECS010V.cbl
 17987******************************************************************
 17988***         B U I L D   S U M M A R Y   E X T R A C T S        ***
 17989******************************************************************
 17990
 17991 4500-BUILD-EPEC-EXTRACT.
 17992
 17993     IF DTE-CLIENT = 'DCC'
 17994        PERFORM 4541-CALC-IBNR   THRU 4541-EXIT
 17995     END-IF
 17996
 17997     PERFORM 4510-BUILD-EPEC-EXT THRU 4519-BUILD-EPEC-EXT-X
 17998         VARYING SUB2 FROM +1 BY +1
 17999             UNTIL EPEC-REIN-CO (SUB2) = ZEROS.
 18000
 18001     PERFORM 4550-CLEAR-EPEC-TOTALS THRU 4589-CLEAR-EPEC-TOTALS-X.
 18002
 18003     GO TO 4599-BUILD-EPEC-EXTRACT-X.
 18004
 18005
 18006 4510-BUILD-EPEC-EXT.
 18007
 18008     MOVE EPEC-LEVELS (SUB2)            TO EPEC-WORK.
 18009     MOVE EPEC-OPT-DATA-TABLE           TO EPEC-OPT-WORK-TABLE.
 18010     IF EW-LEVEL-USED = 'Y'
 18011         MOVE SPACE                     TO W-UNDERWRITING-SW
 18012         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18013                 4518-BUILD-EPEC-RCD-X.
 18014
 18015     MOVE EPEC-LEVELS-II (SUB2)         TO EPEC-WORK.
 18016     MOVE EPEC-UNDW-OPT-DATA-TABLE      TO EPEC-OPT-WORK-TABLE.
 18017     IF EW-LEVEL-USED = 'Y'
 18018         MOVE '*'                       TO W-UNDERWRITING-SW
 18019         PERFORM 4511-BUILD-EPEC-RECORD THRU
 18020                 4518-BUILD-EPEC-RCD-X.
 18021
 18022     GO TO 4519-BUILD-EPEC-EXT-X.
 18023
 18024 4511-BUILD-EPEC-RECORD.
 18025
 18026     MOVE SPACES                        TO EP-RECORD.
 18027     MOVE 'EP'                          TO EP-RECORD-ID.
 18028     MOVE DTE-CLASIC-COMPANY-CD         TO EP-COMPANY-CD.
 18029     MOVE AM-MSTR-CNTRL                 TO EP-CONTROL.
 18030     MOVE AM-EXPIRE-DT                  TO WS-EP-EXP-DTE-N.
 18031     MOVE AM-EFFECT-DT                  TO EP-EFF-DTE
 18032                                           WS-EP-EFF-DTE-N.
 18033     MOVE EW-REIN-CO                    TO EP-REI-CO.
 18034     IF EP-REI-CO NOT = SPACES
 18035         MOVE 'R'                       TO EP-REIN.
 18036     MOVE EW-LF-AH                      TO EP-RCD-TYPE.
 18037     MOVE EW-BEN-TYPE                   TO EP-BEN-CODE.
 18038
 18039     MOVE EW-ISS-CNT                    TO EP-ISS-CNT.
 18040     MOVE EW-ISS-BEN                    TO EP-ISS-BEN.
 18041     MOVE EW-ISS-BEN-GROSS              TO EP-ISS-BEN-GROSS.
 18042
 18043     MOVE EW-CNC-CNT                    TO EP-CNC-CNT.
 18044     MOVE EW-CNC-BEN                    TO EP-CNC-BEN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 347
* ECS010V.cbl
 18045     MOVE EW-CNC-BEN-GROSS              TO EP-CNC-BEN-GROSS.
 18046
 18047     MOVE EW-ISS-PRM                    TO EP-ISS-PRM.
 18048     MOVE EW-ISS-PRM-GROSS              TO EP-ISS-PRM-GROSS.
 18049     MOVE EW-CNC-PRM                    TO EP-CNC-PRM.
 18050     MOVE EW-CNC-PRM-GROSS              TO EP-CNC-PRM-GROSS.
 18051
 18052     IF DTE-CLIENT NOT = 'NCL'
 18053         GO TO 4512-BUILD-EPEC-CONTINUE.
 18054
 18055     IF W-UNDERWRITTEN-DATA
 18056         GO TO 4512-BUILD-EPEC-CONTINUE.
 18057
 18058     IF AM-EXPIRE-DT NOT GREATER THAN EOM-RUN-DATE
 18059         GO TO 4512-BUILD-EPEC-CONTINUE.
 18060
 18061     IF WS-OB-REIN-CO (SUB2) = EW-REIN-CO  AND
 18062        WS-OB-LF-AH (SUB2) = EW-LF-AH  AND
 18063        WS-OB-BENEFIT-CODE (SUB2) = EW-BEN-TYPE
 18064         NEXT SENTENCE
 18065     ELSE
 18066         GO TO 4512-BUILD-EPEC-CONTINUE.
 18067
 18068     IF OB-DATE-1-USED  OR
 18069        OB-DATE-2-USED  OR
 18070        OB-DATE-3-USED
 18071         NEXT SENTENCE
 18072     ELSE
 18073         GO TO 4512-BUILD-EPEC-CONTINUE.
 18074
 18075     IF OB-DATE-1-USED
 18076         IF WS-EPR-R78 (SUB2 1) NOT EQUAL +0
 18077             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18078                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 1)
 18079             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18080                                   EW-EPR-ST
 18081             GO TO 4512-BUILD-EPEC-CONTINUE
 18082         ELSE
 18083             GO TO 4512-BUILD-EPEC-CONTINUE.
 18084
 18085     IF OB-DATE-2-USED
 18086         IF WS-EPR-R78 (SUB2 2) NOT EQUAL +0
 18087             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18088                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 2)
 18089             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18090                                   EW-EPR-ST
 18091             GO TO 4512-BUILD-EPEC-CONTINUE
 18092         ELSE
 18093             GO TO 4512-BUILD-EPEC-CONTINUE.
 18094
 18095     IF OB-DATE-3-USED
 18096         IF WS-EPR-R78 (SUB2 3) NOT EQUAL +0
 18097             COMPUTE EW-EPR-R78 = EW-ISS-PRM - EW-CNC-PRM -
 18098                           EW-EPR-R78-ADJ - WS-EPR-R78 (SUB2 3)
 18099             MOVE EW-EPR-R78    TO EW-EPR-PRO
 18100                                   EW-EPR-ST
 18101             GO TO 4512-BUILD-EPEC-CONTINUE
 18102         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 348
* ECS010V.cbl
 18103             GO TO 4512-BUILD-EPEC-CONTINUE.
 18104
 18105 4512-BUILD-EPEC-CONTINUE.
 18106
 18107     MOVE EW-EPR-R78                    TO EP-PRM-78.
 18108     MOVE EW-EPR-PRO                    TO EP-PRM-PR.
 18109     MOVE EW-EPR-ST                     TO EP-PRM-ST.
 18110
 18111     MOVE EW-EPR-R78-ADJ                TO EP-PRM-78-ADJ.
 18112     MOVE EW-EPR-PRO-ADJ                TO EP-PRM-PR-ADJ.
 18113     MOVE EW-EPR-ST-ADJ                 TO EP-PRM-ST-ADJ.
 18114
 18115     MOVE EW-ISS-PRM-TAX                TO EP-PRM-TAX
 18116
 18117     MOVE EW-CLM-AMT                    TO EP-CLM-AMT.
 18118     MOVE EW-CLM-CNT                    TO EP-CLM-CNT.
 18119     MOVE EW-CLM-CRT                    TO EP-CLM-CRT.
 18120
 18121     MOVE EW-CLM-PAYCUR                 TO EP-CLM-DU.
 18122     MOVE ZEROS                         TO EP-CLM-PV.
 18123
 18124     IF EP-RCD-TYPE = 'A' OR 'U'
 18125         IF CARRIER-UEP-PCT (CLAS-INDEXCN) NOT = ZEROS
 18126             PERFORM 4599A-CALC-IBNR THRU 4599A-CALC-EXIT.
 18127
 18128     MOVE EW-CLM-IBNR                   TO EP-CLM-IBNR.
 18129
 18130     MOVE EW-CLM-FUTRSV                 TO EP-LOSS-RESV.
 18131     MOVE ZEROS                         TO EP-CLAIM-ADJ.
 18132
 18133     MOVE EW-INFORCE-CNT                TO EP-INFORCE-CNT.
 18134
 18135     IF EW-ISS-CNT = ZERO
 18136         MOVE ZERO                      TO EP-AVG-ORIG-TERM
 18137                                           EP-AVG-AGE
 18138       ELSE
 18139         COMPUTE EP-AVG-ORIG-TERM ROUNDED =
 18140                                EW-ORIG-TERM / EW-ISS-CNT
 18141         COMPUTE EP-AVG-AGE ROUNDED = EW-AGE / EW-ISS-CNT.
 18142
 18143     IF EW-INFORCE-CNT = ZERO
 18144         MOVE ZERO                      TO EP-AVG-REM-TERM
 18145       ELSE
 18146         COMPUTE EP-AVG-REM-TERM ROUNDED =
 18147                             EW-REM-TERM / EW-INFORCE-CNT.
 18148
 18149     IF EW-ISS-BEN = ZERO
 18150         MOVE ZERO                      TO EP-WEIGHTED-ORIG-TERM
 18151                                           EP-WEIGHTED-AGE
 18152       ELSE
 18153         COMPUTE EP-WEIGHTED-ORIG-TERM ROUNDED =
 18154                                  EW-TERM-BEN / EW-ISS-BEN
 18155         COMPUTE EP-WEIGHTED-AGE ROUNDED =
 18156                                   EW-AGE-BEN / EW-ISS-BEN.
 18157
 18158     MOVE ZEROS                         TO
 18159         EP-RETRO-EXPENSES  EP-RETRO-PAYMENTS  EP-RETRO-OTH-COMM
 18160         EP-MORT-RESV       EP-IN-FORCE        EP-ADJUST.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 349
* ECS010V.cbl
 18161
 18162     MOVE EW-COV-DTE                    TO EP-HI-COV-DT
 18163                                           WS-EP-HI-COV-DT-N.
 18164     MOVE HIGH-CERT                     TO EP-HI-CERT
 18165                                           WS-EP-HI-CERT-N.
 18166     MOVE LOW-CERT                      TO EP-LO-CERT
 18167                                           WS-EP-LO-CERT-N.
 18168     IF DTE-PGM-OPT = '3'
 18169         MOVE 'P'                       TO EP-PURGE.
 18170
 18171     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 18172         GO TO 4514-CONTINUE.
 18173
 18174     MOVE EPEC-CLM-EXP (SUB2)    TO EP-CLM-EXP.
 18175
 18176     IF  EPEC-LIFE-CTR-NOT-USED (SUB2)
 18177         MOVE +1                 TO EP-LIFE-YEARS
 18178     ELSE
 18179         MOVE ZEROS              TO W-LIFE-YEARS
 18180         PERFORM 4515-DETERMINE-LIFE-YEARS THRU 4515-EXIT
 18181                 VARYING
 18182             SUBM FROM +1 BY +1
 18183                 UNTIL
 18184             SUBM GREATER THAN +13
 18185         COMPUTE W-LIFE-YEARS-INT ROUNDED
 18186             = W-LIFE-YEARS / 12
 18187             - (EPEC-LIFE-CTR (SUB2 1)
 18188             + EPEC-LIFE-CTR (SUB2 13)) / 24
 18189         COMPUTE EP-LIFE-YEARS ROUNDED = W-LIFE-YEARS-INT
 18190         IF  EP-LIFE-YEARS LESS THAN +1
 18191             MOVE +1             TO EP-LIFE-YEARS.
 18192
 18193 4514-CONTINUE.
 18194
 18195     PERFORM 4900-WRITE-SUMMARY-EXTRACTS THRU 4999-WRT-SUMMARY-X.
 18196
 18197     MOVE SPACES                        TO EC-RECORD.
 18198     MOVE '1'                           TO WS-SEQ-NBR.
 18199     MOVE +0                            TO SUB3.
 18200     MOVE +0                            TO SUB4.
 18201     PERFORM 4520-BUILD-EPEC-LOAD-COMM
 18202         THRU 4539-BUILD-EPEC-LOAD-COMM-X
 18203         UNTIL SUB4  GREATER THAN WS-LOOP-MAX.
 18204
 18205     GO TO 4518-BUILD-EPEC-RCD-X.
 18206
 18207 4515-DETERMINE-LIFE-YEARS.
 18208
 18209     ADD EPEC-LIFE-CTR (SUB2 SUBM)      TO W-LIFE-YEARS.
 18210
 18211 4515-EXIT.
 18212     EXIT.
 18213
 18214 4518-BUILD-EPEC-RCD-X.
 18215     EXIT.
 18216
 18217 4519-BUILD-EPEC-EXT-X.
 18218     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 350
* ECS010V.cbl
 18219
 18220 4520-BUILD-EPEC-LOAD-COMM.
 18221
 18222     PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X.
 18223
 18224     ADD +1 TO SUB3  SUB4.
 18225     MOVE ZEROS                  TO LEVELS-BUILT.
 18226
 18227 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18228
 18229     IF SUB4 GREATER THAN WS-LOOP-MAX
 18230         IF AGT-SW = 'X'
 18231             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18232                 THRU 4999-WRT-SUMMARY-X
 18233             MOVE ' '            TO AGT-SW
 18234             MOVE WS-LOOP-MAX    TO  SUB4
 18235             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18236         ELSE
 18237             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18238
 18239     IF LEVELS-BUILT EQUAL +5
 18240         IF AGT-SW = 'X'
 18241             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18242                 THRU 4999-WRT-SUMMARY-X
 18243             MOVE ' '            TO AGT-SW
 18244             MOVE ZEROS          TO LEVELS-BUILT
 18245             ADD 1 TO WS-SEQ-NBR
 18246             PERFORM 4545-BUILD-BASE  THRU  4545-BUILD-BASE-X
 18247             PERFORM 4540-BUILD-EPEC-CLEAR  THRU
 18248                     4540-BUILD-CLEAR-X
 18249                 VARYING SUB3 FROM +1 BY +1
 18250                 UNTIL SUB3 GREATER THAN +5
 18251             MOVE +1             TO SUB3
 18252             GO TO 4531-BUILD-EPEC-LOAD-COMM
 18253         ELSE
 18254             MOVE +1             TO SUB3
 18255             MOVE ZEROS          TO LEVELS-BUILT
 18256             GO TO 4531-BUILD-EPEC-LOAD-COMM.
 18257
 18258     IF SUB4 GREATER THAN WS-LOOP-MAX
 18259         IF AGT-SW = 'X'
 18260             PERFORM 4900-WRITE-SUMMARY-EXTRACTS
 18261                 THRU 4999-WRT-SUMMARY-X
 18262             MOVE ' '                   TO AGT-SW
 18263             GO TO 4539-BUILD-EPEC-LOAD-COMM-X
 18264         ELSE
 18265             GO TO 4539-BUILD-EPEC-LOAD-COMM-X.
 18266
 18267 4531-BUILD-EPEC-LOAD-COMM.
 18268
 18269     IF (EW-AGT-NO (SUB4) = SPACES)
 18270                  OR
 18271        ((EW-ISS-COM (SUB4) = ZEROS) AND
 18272         (EW-CNC-COM (SUB4) = ZEROS) AND
 18273         (EW-ECR-R78 (SUB4) = ZEROS) AND
 18274         (EW-ECR-R78-ADJ (SUB4) = ZEROS) AND
 18275         (EW-ECR-PRO (SUB4) = ZEROS) AND
 18276         (EW-ECR-PRO-ADJ (SUB4) = ZEROS) AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 351
* ECS010V.cbl
 18277         (EW-ECR-ST (SUB4) = ZEROS))
 18278         PERFORM 4540-BUILD-EPEC-CLEAR
 18279             THRU 4540-BUILD-CLEAR-X
 18280         ADD +1 TO SUB4
 18281         GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18282
 18283     MOVE 'X'                           TO AGT-SW.
 18284     MOVE EW-AGT-NO (SUB4)              TO EC-AGT-NO (SUB3).
 18285     MOVE EW-AGT-TYPE (SUB4)            TO EC-AGT-TYPE (SUB3).
 18286     MOVE EW-ISS-COM (SUB4)             TO EC-ISS-COMM (SUB3).
 18287     MOVE EW-CNC-COM (SUB4)             TO EC-CNC-COMM (SUB3).
 18288     MOVE EW-ECR-R78 (SUB4)             TO EC-COMM-78 (SUB3).
 18289     MOVE EW-ECR-PRO (SUB4)             TO EC-COMM-PR (SUB3).
 18290     MOVE EW-ECR-ST (SUB4)              TO EC-COMM-ST (SUB3).
 18291     MOVE EW-ECR-R78-ADJ (SUB4)         TO EC-COMM-78-ADJ (SUB3).
 18292     MOVE EW-ECR-PRO-ADJ (SUB4)         TO EC-COMM-PR-ADJ (SUB3).
 18293
 18294     ADD +1 TO SUB3 SUB4 LEVELS-BUILT.
 18295
 18296     GO TO 4530-BUILD-EPEC-LOAD-COMM-LOOP.
 18297
 18298 4539-BUILD-EPEC-LOAD-COMM-X.
 18299     EXIT.
 18300
 18301 4540-BUILD-EPEC-CLEAR.
 18302
 18303     MOVE ZEROS                         TO EC-AGT-NO (SUB3).
 18304     MOVE SPACE                         TO EC-AGT-TYPE (SUB3).
 18305     MOVE ZEROS                         TO EC-ISS-COMM (SUB3)
 18306                                           EC-CNC-COMM (SUB3)
 18307                                           EC-COMM-78 (SUB3)
 18308                                           EC-COMM-PR (SUB3)
 18309                                           EC-COMM-ST (SUB3)
 18310                                           EC-COMM-78-ADJ (SUB3)
 18311                                           EC-COMM-PR-ADJ (SUB3).
 18312
 18313 4540-BUILD-CLEAR-X.
 18314     EXIT.
 18315
 18316 4541-CALC-IBNR.
 18317
 18318     MOVE +0                    TO TOT-AH-IBNR
 18319                                   TOT-AH-PRM
 18320                                   TOT-AH-PD-CLMS
 18321                                   TOT-AH-CLMRSV
 18322                                   TOT-LF-IBNR
 18323                                   TOT-LF-PRM
 18324                                   TOT-LF-PD-CLMS
 18325                                   TOT-LF-CLMRSV
 18326
 18327     MOVE +0                    TO RTOT-AH-IBNR
 18328                                   RTOT-AH-PRM
 18329                                   RTOT-AH-PD-CLMS
 18330                                   RTOT-AH-CLMRSV
 18331                                   RTOT-LF-IBNR
 18332                                   RTOT-LF-PRM
 18333                                   RTOT-LF-PD-CLMS
 18334                                   RTOT-LF-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 352
* ECS010V.cbl
 18335
 18336     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18337        (SUB2 > +900)
 18338        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18339*       IF W-UNDERWRITTEN-DATA
 18340*          MOVE EPEC-LEVELS-II (SUB2)
 18341*                                TO EPEC-WORK
 18342*       ELSE
 18343           MOVE EPEC-LEVELS (SUB2)
 18344                                 TO EPEC-WORK
 18345*       END-IF
 18346        IF EW-REIN-CO = SPACES
 18347           IF EW-LF-AH = 'L'
 18348              COMPUTE TOT-LF-PRM = TOT-LF-PRM
 18349                 + EW-EPR-ST
 18350              COMPUTE TOT-LF-PD-CLMS = TOT-LF-PD-CLMS
 18351                 + EW-CLM-AMT
 18352              COMPUTE TOT-LF-CLMRSV = TOT-LF-CLMRSV
 18353                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18354           ELSE
 18355              COMPUTE TOT-AH-PRM = TOT-AH-PRM
 18356                 + EW-EPR-ST
 18357              COMPUTE TOT-AH-PD-CLMS = TOT-AH-PD-CLMS
 18358                 + EW-CLM-AMT
 18359              COMPUTE TOT-AH-CLMRSV = TOT-AH-CLMRSV
 18360                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18361        ELSE
 18362           IF EW-LF-AH = 'L'
 18363              COMPUTE RTOT-LF-PRM = RTOT-LF-PRM
 18364                 + EW-EPR-ST
 18365              COMPUTE RTOT-LF-PD-CLMS = RTOT-LF-PD-CLMS
 18366                 + EW-CLM-AMT
 18367              COMPUTE RTOT-LF-CLMRSV = RTOT-LF-CLMRSV
 18368                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18369           ELSE
 18370              COMPUTE RTOT-AH-PRM = RTOT-AH-PRM
 18371                 + EW-EPR-ST
 18372              COMPUTE RTOT-AH-PD-CLMS = RTOT-AH-PD-CLMS
 18373                 + EW-CLM-AMT
 18374              COMPUTE RTOT-AH-CLMRSV = RTOT-AH-CLMRSV
 18375                 + EW-CLM-PAYCUR + EW-CLM-FUTRSV
 18376           END-IF
 18377        END-IF
 18378     END-PERFORM
 18379
 18380     COMPUTE TOT-AH-IBNR = (TOT-AH-PRM * .6)
 18381        - TOT-AH-PD-CLMS - TOT-AH-CLMRSV
 18382     IF TOT-AH-IBNR < ZEROS
 18383        COMPUTE TOT-AH-IBNR = TOT-AH-PRM * .15
 18384     END-IF
 18385     COMPUTE TOT-LF-IBNR = (TOT-LF-PRM * .6)
 18386        - TOT-LF-PD-CLMS - TOT-LF-CLMRSV
 18387     IF TOT-LF-IBNR < ZEROS
 18388        COMPUTE TOT-LF-IBNR = TOT-LF-PRM * .15
 18389     END-IF
 18390
 18391     COMPUTE RTOT-AH-IBNR = (RTOT-AH-PRM * .6)
 18392        - RTOT-AH-PD-CLMS - RTOT-AH-CLMRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 353
* ECS010V.cbl
 18393     IF RTOT-AH-IBNR < ZEROS
 18394        COMPUTE RTOT-AH-IBNR = RTOT-AH-PRM * .15
 18395     END-IF
 18396     COMPUTE RTOT-LF-IBNR = (RTOT-LF-PRM * .6)
 18397        - RTOT-LF-PD-CLMS - RTOT-LF-CLMRSV
 18398     IF RTOT-LF-IBNR < ZEROS
 18399        COMPUTE RTOT-LF-IBNR = RTOT-LF-PRM * .15
 18400     END-IF
 18401
 18402     PERFORM VARYING SUB2 FROM +1 BY +1 UNTIL
 18403        (SUB2 > +900)
 18404        OR (EPEC-REIN-CO (SUB2) = ZEROS)
 18405*       IF W-UNDERWRITTEN-DATA
 18406*          MOVE EPEC-LEVELS-II (SUB2)
 18407*                                TO EPEC-WORK
 18408*       ELSE
 18409           MOVE EPEC-LEVELS (SUB2)
 18410                                 TO EPEC-WORK
 18411*       END-IF
 18412        IF EW-REIN-CO = SPACES
 18413           IF EW-LF-AH = 'L'
 18414              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18415                 / TOT-LF-PRM
 18416              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18417                 * RTOT-LF-IBNR
 18418*                * TOT-LF-IBNR
 18419           ELSE
 18420              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18421                 / TOT-AH-PRM
 18422              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18423                 * RTOT-AH-IBNR
 18424*                * TOT-AH-IBNR
 18425           END-IF
 18426        ELSE
 18427           IF EW-LF-AH = 'L'
 18428              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18429                 / RTOT-LF-PRM
 18430              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18431                 * RTOT-LF-IBNR
 18432           ELSE
 18433              COMPUTE IBNR-FACT ROUNDED = EW-EPR-ST
 18434                 / RTOT-AH-PRM
 18435              COMPUTE EW-CLM-IBNR ROUNDED = IBNR-FACT
 18436                 * RTOT-AH-IBNR
 18437           END-IF
 18438        END-IF
 18439*       IF W-UNDERWRITTEN-DATA
 18440*          MOVE EPEC-WORK        TO EPEC-LEVELS-II (SUB2)
 18441*       ELSE
 18442           MOVE EPEC-WORK        TO EPEC-LEVELS (SUB2)
 18443*       END-IF
 18444     END-PERFORM
 18445
 18446     .
 18447 4541-EXIT.
 18448     EXIT.
 18449
 18450 4545-BUILD-BASE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 354
* ECS010V.cbl
 18451
 18452     MOVE 'EC'                   TO EC-RECORD-ID.
 18453     MOVE DTE-CLASIC-COMPANY-CD  TO EP-COMPANY-CD.
 18454     MOVE AM-MSTR-CNTRL          TO EC-CONTROL.
 18455     MOVE AM-EXPIRE-DT           TO WS-EC-EXP-DTE-N.
 18456     MOVE AM-EFFECT-DT           TO EC-EFF-DTE
 18457                                    WS-EC-EFF-DTE.
 18458     MOVE EW-REIN-CO             TO EC-REI-CO.
 18459     IF EC-REI-CO NOT = SPACES
 18460         MOVE 'R'                TO EC-REIN.
 18461     MOVE EW-LF-AH               TO EC-RCD-TYPE.
 18462     MOVE EW-BEN-TYPE            TO EC-BEN-CODE.
 18463     IF DTE-PGM-OPT = '3'
 18464         MOVE 'P'                TO EC-PURGE.
 18465     MOVE WS-SEQ-NBR             TO EC-SEQ-NBR.
 18466
 18467 4545-BUILD-BASE-X.
 18468     EXIT.
 18469
 18470******************************************************************
 18471***        CLEAR EARNED PREMIUM  AND  REINSURANCE TOTALS       ***
 18472******************************************************************
 18473
 18474 4550-CLEAR-EPEC-TOTALS.
 18475
 18476     MOVE LOW-CERT             TO SV-LO-CERT.
 18477     MOVE HIGH-CERT            TO SV-HI-CERT.
 18478     MOVE SPACES               TO LOW-CTL.
 18479     MOVE ZEROS                TO LOW-CERT  HIGH-CERT.
 18480
 18481     MOVE +1                   TO SUB9.
 18482     MOVE +0                   TO SUB10.
 18483     MOVE ZERO                 TO EW-REIN-CO
 18484                                  EW-BEN-TYPE.
 18485     MOVE SPACE                TO EP-FLG
 18486                                  EW-LF-AH
 18487                                  EW-LEVEL-USED
 18488                                  W-TABLE-USED-SW.
 18489
 18490     MOVE +0                   TO EW-ISS-BEN     EW-ISS-BEN-GROSS
 18491                                  EW-CNC-BEN     EW-CNC-BEN-GROSS
 18492                                  EW-ISS-PRM     EW-ISS-PRM-GROSS
 18493                                  EW-CNC-PRM     EW-CNC-PRM-GROSS
 18494                                  EW-EPR-R78     EW-EPR-R78-ADJ
 18495                                  EW-EPR-PRO     EW-EPR-PRO-ADJ
 18496                                  EW-EPR-ST      EW-EPR-ST-ADJ
 18497                                  EW-CLM-AMT     EW-COV-DTE
 18498                                  EW-CLM-IBNR    EW-CLM-PAYCUR
 18499                                  EW-CLM-FUTRSV  EW-CLM-CNT
 18500                                  EW-CLM-CRT     EW-ISS-CNT
 18501                                  EW-CNC-CNT     EW-AGE
 18502                                  EW-ORIG-TERM   EW-INFORCE-CNT
 18503                                  EW-AGE-BEN     EW-TERM-BEN
 18504                                  EW-ISS-PRM-TAX
 18505                                  EW-REM-TERM.
 18506
 18507     MOVE +1 TO SUB1.
 18508     PERFORM 4555-CLEAR-EPEC-COMM WS-LOOP-MAX TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 355
* ECS010V.cbl
 18509     PERFORM 4560-CLEAR-EPEC-ALL VARYING SUB1 FROM +1 BY +1
 18510         UNTIL EPEC-REIN-CO (SUB1) = ZEROS.
 18511     MOVE EPEC-OPT-WORK-TABLE    TO EPEC-OPT-DATA-TABLE
 18512                                    EPEC-UNDW-OPT-DATA-TABLE.
 18513     PERFORM 4570-CLEAR-EPEC-SUB-A VARYING SUB1 FROM +1 BY +1
 18514         UNTIL EPEC-SUB-REIN (SUB1) = ZEROS.
 18515
 18516     PERFORM 4590-INIT-OB THRU 4590-EXIT
 18517         VARYING SUB3 FROM +1 BY +1
 18518*        UNTIL SUB3 GREATER THAN +300.
 18519*        UNTIL SUB3 GREATER THAN +220.
 18520         UNTIL SUB3 GREATER THAN +900.
 18521
 18522     GO TO 4589-CLEAR-EPEC-TOTALS-X.
 18523
 18524 4555-CLEAR-EPEC-COMM.
 18525
 18526     MOVE +0 TO EW-ISS-COM (SUB1)  EW-CNC-COM (SUB1)
 18527                EW-ECR-R78 (SUB1)  EW-ECR-R78-ADJ (SUB1)
 18528                EW-ECR-PRO (SUB1)  EW-ECR-PRO-ADJ (SUB1)
 18529                EW-ECR-ST  (SUB1).
 18530     MOVE SPACES                 TO EW-AGT-NO (SUB1)
 18531                                    EW-AGT-TYPE (SUB1).
 18532
 18533     ADD +1 TO SUB1.
 18534
 18535 4560-CLEAR-EPEC-ALL.
 18536
 18537     MOVE EPEC-WORK              TO EPEC-LEVELS (SUB1)
 18538                                    EPEC-LEVELS-II (SUB1).
 18539     MOVE W-LIFE-YEARS-ZERO      TO EPEC-OPT-GRP (SUB1).
 18540
 18541 4570-CLEAR-EPEC-SUB-A.
 18542
 18543     MOVE ZEROS TO EPEC-SUB-REIN (SUB1).
 18544     PERFORM 4580-CLEAR-EPEC-SUB-B VARYING SUB2 FROM +1 BY +1
 18545*        UNTIL SUB2 GREATER +300.
 18546         UNTIL SUB2 GREATER +900.
 18547
 18548 4580-CLEAR-EPEC-SUB-B.
 18549
 18550     MOVE ZEROS TO EPEC-SUB-LF (SUB1 SUB2).
 18551     MOVE ZEROS TO EPEC-SUB-AH (SUB1 SUB2).
 18552
 18553 4589-CLEAR-EPEC-TOTALS-X.
 18554     EXIT.
 18555
 18556 4590-INIT-OB.
 18557
 18558     MOVE +0 TO WS-EPR-R78 (SUB3 1).
 18559     MOVE +0 TO WS-EPR-R78 (SUB3 2).
 18560     MOVE +0 TO WS-EPR-R78 (SUB3 3).
 18561
 18562 4590-EXIT.
 18563     EXIT.
 18564
 18565 4599-BUILD-EPEC-EXTRACT-X.
 18566     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 356
* ECS010V.cbl
 18567
 18568*********************************************************
 18569*  THIS ROUTINE IS USED TO CALCULATE THE A&H IBNR       *
 18570*  RESERVES USING A PERCENTAGE OF THE UNEARNED PREMIUM. *
 18571*  THESE PERCENTAGES ARE ENTERED THROUGH SCREEN EL105A  *
 18572*  (CARRIER CONTROLS) AND PASSED THROUGHOUT THE SYSTEM  *
 18573*  IN THE DATE CARD.                                    *
 18574*  'CARRIER-UEP-PCT' IS THE ACTUAL PERCENT PER CARRIER. *
 18575*********************************************************
 18576
 18577 4599A-CALC-IBNR.
 18578
 18579     COMPUTE EW-CLM-IBNR =  ((EP-ISS-PRM - EP-CNC-PRM) -
 18580        (((EP-PRM-78 + EP-PRM-78-ADJ)
 18581                              * CARRIER-R78-PCT (CLAS-INDEXCN)) +
 18582         ((EP-PRM-PR + EP-PRM-PR-ADJ)
 18583                              * CARRIER-PRO-PCT (CLAS-INDEXCN))))
 18584                         * CARRIER-UEP-PCT (CLAS-INDEXCN).
 18585
 18586     IF EW-CLM-IBNR NOT GREATER THAN ZEROS
 18587         MOVE ZEROS                 TO EW-CLM-IBNR
 18588         GO TO 4599A-CALC-EXIT.
 18589
 18590     IF EP-REIN = 'R'
 18591         MOVE 'Y'                   TO W-REIN-PROCESS-IND.
 18592
 18593     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 18594
 18595 4599A-CALC-EXIT.
 18596      EXIT.
 18597 4599B-SEARCH.
 18598      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 357
* ECS010V.cbl
 18600******************************************************************
 18601***         CALCULATE OPTIONAL METHOD I B N R                  ***
 18602******************************************************************
 18603
 18604 4600-GET-OPT-IBNR.
 18605
 18606     IF  CR-POLICY-IS-ACTIVE
 18607         IF  CR-POLICY-IS-REISSUE
 18608             OR CR-POLICY-IS-MONTHLY
 18609             IF  W-LIFE
 18610                 GO TO 4600-EXIT
 18611             ELSE
 18612                 NEXT SENTENCE
 18613         ELSE
 18614             NEXT SENTENCE
 18615     ELSE
 18616         IF  W-LIFE
 18617             GO TO 4600-EXIT.
 18618
 18619     IF  W-LIFE
 18620         PERFORM 4620-DETERMINE-LIFE-IBNR THRU 4620-EXIT
 18621     ELSE
 18622         PERFORM 4640-GET-A-H-EARNED-PREMIUM THRU 4640-EXIT.
 18623
 18624 4600-EXIT.
 18625     EXIT.
 18626
 18627 4620-DETERMINE-LIFE-IBNR.
 18628
 18629     IF  CR-LF-POLICY-IS-ACTIVE
 18630         ADD +1                  TO W-LF-ACTIVE
 18631         IF  CR-LF-POLICY-IS-REISSUE
 18632             OR CR-LF-POLICY-IS-MONTHLY
 18633             MOVE ZEROS          TO W-WK-IBNR
 18634             ADD +1              TO W-LF-REISSUE
 18635             GO TO 4620-EXIT
 18636         ELSE
 18637             NEXT SENTENCE
 18638     ELSE
 18639         ADD +1                  TO W-LF-INACTIVE
 18640         MOVE ZEROS              TO W-WK-IBNR
 18641         GO TO 4620-EXIT.
 18642
 18643     IF  CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
 18644         MOVE ZEROS              TO W-WK-IBNR
 18645         ADD +1                  TO W-LF-CALC-B
 18646         GO TO 4620-EXIT.
 18647
 18648     IF  (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18649                 AND
 18650             CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
 18651                 AND
 18652             W-BAL-REMTRM NOT GREATER THAN ZERO)
 18653             OR
 18654         (CLAS-I-EP (CLAS-INDEXL) = 'B'
 18655                 AND
 18656             CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
 18657                 AND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 358
* ECS010V.cbl
 18658             REM-TRM2 NOT GREATER THAN ZERO)
 18659         MOVE ZEROS              TO W-WK-IBNR
 18660         ADD +1                  TO W-LF-BALLOON
 18661         GO TO 4620-EXIT
 18662     ELSE
 18663         IF  (CLAS-I-EP (CLAS-INDEXL) NOT = 'B'
 18664                 AND
 18665             REM-TRM2 NOT GREATER THAN ZERO)
 18666             ADD +1              TO W-LF-REMTERM-0
 18667             MOVE ZEROS          TO W-WK-IBNR
 18668             GO TO 4620-EXIT.
 18669
 18670     PERFORM 4680-CALC-REMAINING-AMT-LF THRU 4680-EXIT.
 18671
 18672     IF  CP-REMAINING-AMT NOT GREATER THAN ZEROS
 18673         ADD +1                  TO W-LF-REMAMT-0
 18674         MOVE ZEROS              TO W-WK-IBNR
 18675         GO TO 4620-EXIT.
 18676
 18677     IF  AM-LIFE-IBNR-PCT NUMERIC
 18678             AND
 18679         AM-LIFE-IBNR-PCT GREATER THAN ZEROS
 18680         COMPUTE W-WK-IBNR ROUNDED
 18681             = CP-REMAINING-AMT
 18682             / 1000
 18683             * AM-LIFE-IBNR-PCT
 18684     ELSE
 18685         COMPUTE W-WK-IBNR ROUNDED
 18686             = CP-REMAINING-AMT
 18687             / 1000
 18688             * COMPANY-IBNR-LIFE-FACTOR.
 18689
 18690     IF  CR-LF-IS-REIN-ONLY
 18691         ADD +1                  TO W-LF-REIN
 18692     ELSE
 18693         ADD +1                  TO W-LF-DATA-USED
 18694         ADD W-WK-IBNR           TO W-LIFE-IBNR-IN
 18695         ADD CP-REMAINING-AMT    TO W-LIFE-REMAINING-AMT
 18696         IF  CR-LFTYP = '01'
 18697             ADD CP-REMAINING-AMT
 18698                                 TO W-01-REMAMT
 18699             ADD +1              TO W-01-DATA-USED
 18700         ELSE
 18701         IF  CR-LFTYP = '02'
 18702             ADD CP-REMAINING-AMT
 18703                                 TO W-02-REMAMT
 18704             ADD +1              TO W-02-DATA-USED
 18705         ELSE
 18706         IF  CR-LFTYP = '03'
 18707             ADD CP-REMAINING-AMT
 18708                                 TO W-03-REMAMT
 18709             ADD +1              TO W-03-DATA-USED
 18710         ELSE
 18711         IF  CR-LFTYP = '04'
 18712             ADD CP-REMAINING-AMT
 18713                                 TO W-04-REMAMT
 18714             ADD +1              TO W-04-DATA-USED
 18715         ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 359
* ECS010V.cbl
 18716         IF  CR-LFTYP = '05'
 18717             ADD CP-REMAINING-AMT
 18718                                 TO W-05-REMAMT
 18719             ADD +1              TO W-05-DATA-USED
 18720         ELSE
 18721         IF  CR-LFTYP = '06'
 18722             ADD CP-REMAINING-AMT
 18723                                 TO W-06-REMAMT
 18724             ADD +1              TO W-06-DATA-USED
 18725         ELSE
 18726         IF  CR-LFTYP = '30'
 18727             ADD CP-REMAINING-AMT
 18728                                 TO W-30-REMAMT
 18729             ADD +1              TO W-30-DATA-USED
 18730         ELSE
 18731         IF  CR-LFTYP = '31'
 18732             ADD CP-REMAINING-AMT
 18733                                 TO W-31-REMAMT
 18734             ADD +1              TO W-31-DATA-USED
 18735         ELSE
 18736             ADD CP-REMAINING-AMT
 18737                                 TO W-XX-REMAMT
 18738             ADD +1              TO W-XX-DATA-USED.
 18739
 18740     IF  CR-POLICY-IS-REIN-ONLY
 18741             OR
 18742         CR-LF-IS-REIN-ONLY
 18743         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18744         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18745         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3)
 18746     ELSE
 18747         ADD W-WK-IBNR           TO EPEC-LIFE-IBNR (SUB3).
 18748
 18749 4620-EXIT.
 18750     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 360
* ECS010V.cbl
 18752 4640-GET-A-H-EARNED-PREMIUM.
 18753
 18754     IF  CR-AH-POLICY-IS-ACTIVE
 18755         ADD +1                  TO W-AH-ACTIVE
 18756         IF  CR-AH-POLICY-IS-REISSUE
 18757             OR CR-AH-POLICY-IS-MONTHLY
 18758             ADD +1              TO W-AH-REISSUE
 18759         ELSE
 18760             NEXT SENTENCE
 18761     ELSE
 18762         ADD +1                  TO W-AH-INACTIVE.
 18763
 18764     IF  CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 18765         ADD +1                  TO W-AH-CALC-B
 18766         GO TO 4640-EXIT.
 18767
 18768     IF  REM-TRM2 NOT GREATER THAN ZEROS
 18769         MOVE 'Y'                TO W-RTRM-0-SW
 18770     ELSE
 18771         MOVE SPACES             TO W-RTRM-0-SW.
 18772
 18773     PERFORM 4660-DETERMINE-EARNED-PREMIUM THRU 4660-EXIT.
 18774
 18775****** NOTE:  THERE IS AN ASSUMPTION THAT STATISTICALLY ONLY ONE
 18776******        ACTUALLY CLAIM PER 90 DAY PERIOD AND THAT THE CLAIM
 18777******        ITD FIELD (CR-DISAMT) CONTAINS ONLY THE AMOUNT OF
 18778******        THAT CLAIM.
 18779
 18780     PERFORM 4650-DETERMINE-CLM-AMT-AH THRU 4650-EXIT.
 18781
 18782     IF  CR-POLICY-IS-REIN-ONLY
 18783              OR
 18784         CR-AH-IS-REIN-ONLY
 18785         ADD +1                  TO W-AH-REIN
 18786         ADD ISS-BEN             TO EPEC-REIN-ISS-BEN (SUB3)
 18787         MOVE 'R'                TO EPEC-REIN-ONLY-IND (SUB3)
 18788         ADD W-CLMAMT            TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18789         ADD W-EARNED-PREMIUM    TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18790         GO TO 4640-EXIT.
 18791
 18792     ADD W-EARNED-PREMIUM        TO EPEC-EARNED-PREMIUM-AH (SUB3)
 18793                                    W-EPEC-EP-IN.
 18794     ADD W-CLMAMT                TO EPEC-CLAIMS-MADE-PAID (SUB3)
 18795                                    W-CLAIMS-MADE-PAID-IN.
 18796     ADD +1                      TO W-AH-DATA-USED.
 18797     ADD W-EARNED-PREMIUM-1      TO W-EPEC-EP-1.
 18798     ADD W-EARNED-PREMIUM-2      TO W-EPEC-EP-2.
 18799
 18800     IF  W-CLMAMT GREATER THAN ZEROS
 18801         ADD +1                  TO W-AH-CLAIM-CTR
 18802         ADD W-EARNED-PREMIUM    TO W-AH-CLAIM-EP.
 18803
 18804     IF  W-RTRM-0
 18805             AND
 18806         NOT CR-POLICY-IS-REIN-ONLY
 18807             AND
 18808         NOT CR-AH-IS-REIN-ONLY
 18809         ADD W-CLMAMT            TO W-RTRM-0-CLMAMT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 361
* ECS010V.cbl
 18810         ADD W-EARNED-PREMIUM-1  TO W-RTRM-EP-1
 18811         ADD W-EARNED-PREMIUM-2  TO W-RTRM-EP-2
 18812         ADD W-EARNED-PREMIUM    TO W-RTRM-EP
 18813         ADD +1                  TO W-AH-REMTERM-0.
 18814
 18815 4640-EXIT.
 18816     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 362
* ECS010V.cbl
 18818 4650-DETERMINE-CLM-AMT-AH.
 18819
 18820     MOVE ZEROS                  TO W-CLMAMT.
 18821
 18822     IF  CR-DIS-DT NOT GREATER THAN ZEROS
 18823             OR
 18824         CR-DIS-DT NOT GREATER THAN W-CUTOFF-DATE
 18825         GO TO 4650-EXIT.
 18826
 18827     IF  CR-DIS-PTO-DT GREATER THAN ZEROS
 18828             AND
 18829         CR-DIS-PTO-DT GREATER THAN CR-DIS-DT
 18830         MOVE CR-DIS-DT              TO DC-GREG-DATE-CYMD
 18831         MOVE 'L'                    TO DC-OPTION-CODE
 18832         PERFORM 8000-DATE-CONVERT-ROUTINE
 18833             THRU 8099-DATE-CONVERT-X
 18834         MOVE DC-BIN-DATE-1          TO W-DIS-DT
 18835         MOVE CR-DIS-PTO-DT          TO DC-GREG-DATE-CYMD
 18836         MOVE 'L'                    TO DC-OPTION-CODE
 18837         PERFORM 8000-DATE-CONVERT-ROUTINE
 18838             THRU 8099-DATE-CONVERT-X
 18839         MOVE DC-BIN-DATE-1          TO W-DIS-PTO-DT
 18840         IF  DATE-CONVERSION-ERROR
 18841             DISPLAY 'CERT DATES ERROR' CR-FULL-CONTROL
 18842             MOVE 'CERT DATES ERROR' TO WS-ABEND-MESSAGE
 18843             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 18844             MOVE 0303               TO WS-ABEND-CODE
 18845             MOVE WS-ABEND-CODE      TO WS-RETURN-CODE
 18846             GO TO ABEND-PGM
 18847         ELSE
 18848             MOVE W-DIS-DT           TO DC-BIN-DATE-1
 18849             MOVE W-DIS-PTO-DT       TO DC-BIN-DATE-2
 18850             MOVE '1'                TO DC-OPTION-CODE
 18851             MOVE ZEROS              TO DC-ELAPSED-MONTHS
 18852                                        DC-ELAPSED-DAYS
 18853             PERFORM 8000-DATE-CONVERT-ROUTINE
 18854                 THRU 8099-DATE-CONVERT-X
 18855             IF  DATE-CONVERSION-ERROR
 18856                 DISPLAY 'DIS TO PTO DATE ERROR '
 18857                     CR-FULL-CONTROL
 18858                 MOVE 'DIS TO PTO DATE ERROR '
 18859                                     TO WS-ABEND-MESSAGE
 18860                 MOVE DC-ERROR-CODE  TO WS-ABEND-FILE-STATUS
 18861                 MOVE 0303           TO WS-ABEND-CODE
 18862                 MOVE WS-ABEND-CODE  TO WS-RETURN-CODE
 18863                 GO TO ABEND-PGM
 18864             ELSE
 18865                 COMPUTE W-CLMAMT ROUNDED
 18866                     = CR-AHAMT
 18867                     * (DC-ELAPSED-DAYS / 30)
 18868                 GO TO 4650-EXIT.
 18869
 18870     IF  CR-DIS-PAY-DT NOT GREATER THAN ZEROS
 18871             OR
 18872         CR-DIS-PAY-DT LESS THAN CR-DIS-DT
 18873         GO TO 4650-EXIT.
 18874
 18875     COMPUTE W-90-DAY-MAX ROUNDED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 363
* ECS010V.cbl
 18876         = CR-AHAMT * 3.
 18877
 18878     IF  CR-DISAMT NOT GREATER THAN W-90-DAY-MAX
 18879         MOVE CR-DISAMT          TO W-CLMAMT
 18880     ELSE
 18881         MOVE W-90-DAY-MAX       TO W-CLMAMT.
 18882
 18883     IF  NOT CR-POLICY-IS-REIN-ONLY
 18884              AND
 18885         NOT CR-AH-IS-REIN-ONLY
 18886         ADD +1          TO W-CLM-EXCEPT-CNT
 18887         ADD W-CLMAMT    TO W-CLM-EXCEPT-AMT.
 18888
 18889 4650-EXIT.
 18890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 364
* ECS010V.cbl
 18892 4660-DETERMINE-EARNED-PREMIUM.
 18893
 18894     MOVE ZEROS                  TO W-EARNED-PREMIUM.
 18895
 18896     PERFORM 4670-CALC-EP THRU 4670-EXIT.
 18897
 18898     MOVE W-EARNED-PREMIUM       TO W-EARNED-PREMIUM-1.
 18899
 18900     IF  CR-ENTRY-DATE NOT GREATER THAN W-CUTOFF-DATE
 18901         MOVE ZEROS              TO W-EARNED-PREMIUM
 18902         MOVE W-CUTOFF-DATE      TO VALUATION-DT
 18903         MOVE '7'                TO W-VAL-SOURCE
 18904         PERFORM 8500-REMAINING-TERM-ROUTINE
 18905             THRU 8599-REM-TERM-X
 18906         PERFORM 4666-SAVE-AHCR-DATA THRU 4666-EXIT
 18907         PERFORM 4800-CALC-EARNED-PREMIUM-AH THRU 4899-EXIT
 18908         PERFORM 4668-RESTORE-AHCR-DATA THRU 4668-EXIT
 18909         MOVE EPR-R78            TO W-OPT-R78
 18910         MOVE EPR-PRO            TO W-OPT-PRO
 18911         MOVE EPR-ST             TO W-OPT-ST
 18912         PERFORM 4670-CALC-EP THRU 4670-EXIT
 18913         MOVE W-EARNED-PREMIUM   TO W-EARNED-PREMIUM-2
 18914     ELSE
 18915         MOVE ZEROS              TO W-EARNED-PREMIUM-2.
 18916
 18917     COMPUTE W-EARNED-PREMIUM ROUNDED
 18918         = W-EARNED-PREMIUM-1 - W-EARNED-PREMIUM-2.
 18919
 18920     IF  W-EARNED-PREMIUM LESS THAN ZERO
 18921         ADD +1                  TO W-EP-LESS-THAN-0
 18922         MOVE ZERO               TO W-EARNED-PREMIUM.
 18923
 18924 4660-EXIT.
 18925     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 365
* ECS010V.cbl
 18927 4666-SAVE-AHCR-DATA.
 18928
 18929     MOVE SPACES                 TO WX-STATUS-AT-CANCEL
 18930                                    WX-STATUS-AT-SETTLEMENT.
 18931
 18932     MOVE ZEROS                  TO WX-CANC-DT
 18933                                    WX-EOM-RUN-DATE
 18934                                    WX-SETTLEMENT-EXIT-DATE.
 18935
 18936     IF  CR-AH-CANC-DT GREATER THAN W-CUTOFF-DATE
 18937         MOVE CR-AH-CANC-DT      TO WX-CANC-DT
 18938         MOVE CR-AH-STATUS-AT-CANCEL
 18939                                 TO WX-STATUS-AT-CANCEL
 18940         MOVE ZEROS              TO CR-AH-CANC-DT
 18941                                    WS-CR-AH-CANC-DT-N
 18942         MOVE SPACES             TO CR-AH-STATUS-AT-CANCEL.
 18943
 18944     IF  CR-AH-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18945         MOVE CR-AH-SETTLEMENT-EXIT-DATE
 18946                                 TO WX-SETTLEMENT-EXIT-DATE
 18947         MOVE CR-AH-STATUS-AT-SETTLEMENT
 18948                                 TO WX-STATUS-AT-SETTLEMENT
 18949         MOVE ZEROS              TO CR-AH-SETTLEMENT-EXIT-DATE
 18950                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18951         MOVE SPACES             TO CR-AH-STATUS-AT-SETTLEMENT.
 18952
 18953     MOVE EOM-RUN-DATE           TO WX-EOM-RUN-DATE.
 18954     MOVE W-CUTOFF-DATE          TO EOM-RUN-DATE.
 18955
 18956 4666-EXIT.
 18957     EXIT.
 18958
 18959 4668-RESTORE-AHCR-DATA.
 18960
 18961     IF  WX-CANC-DT GREATER THAN W-CUTOFF-DATE
 18962         MOVE WX-CANC-DT         TO CR-AH-CANC-DT
 18963                                    WS-CR-AH-CANC-DT-N
 18964         MOVE WX-STATUS-AT-CANCEL
 18965                                 TO CR-AH-STATUS-AT-CANCEL.
 18966
 18967     IF  WX-SETTLEMENT-EXIT-DATE GREATER THAN W-CUTOFF-DATE
 18968         MOVE WX-SETTLEMENT-EXIT-DATE
 18969                                 TO CR-AH-SETTLEMENT-EXIT-DATE
 18970                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN
 18971         MOVE WX-STATUS-AT-SETTLEMENT
 18972                                 TO CR-AH-STATUS-AT-SETTLEMENT.
 18973
 18974     MOVE WX-EOM-RUN-DATE        TO EOM-RUN-DATE.
 18975
 18976 4668-EXIT.
 18977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 366
* ECS010V.cbl
 18979 4670-CALC-EP.
 18980
 18981     IF  STATE-ABBR (CLAS-INDEXS) = 'WY'
 18982         MOVE W-OPT-PRO          TO W-EARNED-PREMIUM
 18983         ADD W-EARNED-PREMIUM    TO W-WY-EP
 18984         GO TO 4670-EXIT.
 18985
 18986     IF  STATE-ABBR (CLAS-INDEXS) = 'VA'
 18987         MOVE W-OPT-ST           TO W-EARNED-PREMIUM
 18988         ADD W-EARNED-PREMIUM    TO W-VA-EP
 18989         GO TO 4670-EXIT.
 18990
 18991***** NOTE THIS ASSUMES THAT ONLY A&H COVERAGES ARE PROCESSED HERE
 18992
 18993     IF  CLAS-I-EP (CLAS-INDEXA) = 'M'
 18994         COMPUTE W-EARNED-PREMIUM
 18995             = (W-OPT-PRO + W-OPT-R78) / +2
 18996         ADD W-EARNED-PREMIUM    TO W-M-EP
 18997     ELSE
 18998         IF  CLAS-I-EP (CLAS-INDEXA) = 'R'
 18999             MOVE W-OPT-R78      TO W-EARNED-PREMIUM
 19000             ADD W-EARNED-PREMIUM
 19001                                 TO W-R-EP
 19002         ELSE
 19003             IF  CLAS-I-EP (CLAS-INDEXA) = 'P'
 19004                 MOVE W-OPT-PRO  TO W-EARNED-PREMIUM
 19005                 ADD W-EARNED-PREMIUM
 19006                                 TO W-P-EP
 19007             ELSE
 19008                 IF  CLAS-I-EP (CLAS-INDEXA) = '1'
 19009                     COMPUTE W-EARNED-PREMIUM ROUNDED
 19010                         = (W-OPT-PRO * +.6667)
 19011                         + (W-OPT-R78 * +.3333)
 19012                     ADD W-EARNED-PREMIUM
 19013                                 TO W-1-EP
 19014                 ELSE
 19015                     ADD +1      TO W-OTHERS-COUNT
 19016                     MOVE ZEROS  TO W-EARNED-PREMIUM.
 19017
 19018 4670-EXIT.
 19019     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 367
* ECS010V.cbl
 19021 4680-CALC-REMAINING-AMT-LF.
 19022
 19023     MOVE LOW-VALUES             TO CP-INSURED-BIRTH-DT.
 19024     MOVE CR-AGE                 TO CP-ISSUE-AGE.
 19025     MOVE CR-APR                 TO CP-LOAN-APR.
 19026     MOVE CR-LOAN-TERM           TO CP-LOAN-TERM.
 19027
 19028     IF  CR-PMT-FREQ NOT GREATER THAN ZERO
 19029         MOVE +1                 TO CR-PMT-FREQ.
 19030
 19031     MOVE CR-PMT-FREQ            TO CP-PAY-FREQUENCY.
 19032
 19033     MOVE REM-TRM2               TO CP-REMAINING-TERM.
 19034     MOVE CR-LFAMT               TO CP-ORIGINAL-BENEFIT
 19035                                    CP-RATING-BENEFIT-AMT.
 19036     IF CP-STATE-STD-ABBRV = 'OR'
 19037         COMPUTE CP-RATING-BENEFIT-AMT = CR-LFAMT + CR-LFAMT-ALT.
 19038     MOVE CR-LFAMT-ALT           TO CP-ALTERNATE-BENEFIT.
 19039     MOVE CR-LFPRM               TO CP-ORIGINAL-PREMIUM.
 19040     MOVE ZEROS                  TO CP-REMAINING-AMT
 19041                                    CP-REMAINING-AMT-PRV
 19042                                    CP-RETURN-CODE
 19043                                    CP-RETURN-CODE-2.
 19044
 19045
 19046     CALL 'ELRAMTX' USING CALCULATION-PASS-AREA
 19047
 19048     IF  CP-RETURN-CODE NOT = ZERO
 19049         MOVE 'ERROR OCCURED REMAINING AMT CALCULATIONS'
 19050                             TO WS-ABEND-MESSAGE
 19051         MOVE CP-RETURN-CODE TO WS-ABEND-FILE-STATUS
 19052         MOVE 2001           TO WS-ABEND-CODE
 19053         GO TO ABEND-PGM.
 19054
 19055 4680-EXIT.
 19056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 368
* ECS010V.cbl
 19058******************************************************************
 19059***  BUILDS ACCOUNT LEVEL IBNR (DIRECT AND REIN)               ***
 19060******************************************************************
 19061
 19062 4700-CALC-OPT-IBNR.
 19063
 19064     MOVE EPEC-OPT-DATA-TABLE    TO EPEC-OPT-WORK-TABLE.
 19065     MOVE SPACE                  TO W-UNDERWRITING-SW.
 19066
 19067     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19068             VARYING
 19069         SUB2 FROM +1 BY +1
 19070             UNTIL
 19071*        SUB2 GREATER THAN 300.
 19072*        SUB2 GREATER THAN 220.
 19073         SUB2 GREATER THAN 900.
 19074
 19075     MOVE EPEC-UNDW-OPT-DATA-TABLE
 19076                                 TO EPEC-OPT-WORK-TABLE.
 19077     MOVE '*'                    TO W-UNDERWRITING-SW.
 19078
 19079     PERFORM 4710-PROCESS-THRU-EPEC-TABLE THRU 4710-EXIT
 19080             VARYING
 19081         SUB2 FROM +1 BY +1
 19082             UNTIL
 19083*        SUB2 GREATER THAN 300.
 19084*        SUB2 GREATER THAN 220.
 19085         SUB2 GREATER THAN 900.
 19086
 19087 4700-EXIT.
 19088     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 369
* ECS010V.cbl
 19090 4710-PROCESS-THRU-EPEC-TABLE.
 19091
 19092     IF  EPEC-REIN-CO-OPT (SUB2) = ZEROS
 19093         GO TO 4710-EXIT.
 19094
 19095     IF  W-UNDERWRITTEN-DATA
 19096         MOVE EPEC-LEVELS-II (SUB2)  TO EPEC-WORK
 19097     ELSE
 19098         MOVE EPEC-LEVELS (SUB2)     TO EPEC-WORK.
 19099
 19100     IF EW-LEVEL-USED NOT = 'Y'
 19101         GO TO 4710-EXIT.
 19102
 19103     IF  EW-REIN-CO GREATER THAN SPACES
 19104         MOVE 'Y'                TO W-REIN-PROCESS-SW
 19105         IF  EPEC-REIN-ONLY-DATA (SUB2)
 19106             PERFORM 4760-PROCESS-REIN-ONLY THRU 4760-EXIT
 19107             IF  W-WK-IBNR GREATER THAN ZEROS
 19108                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19109                 GO TO 4710-EXIT
 19110             ELSE
 19111                 GO TO 4710-EXIT
 19112         ELSE
 19113             IF  EW-CLM-IBNR GREATER THAN ZEROS
 19114                 PERFORM 4770-CREATE-REIN-DETAIL THRU 4770-EXIT
 19115                 GO TO 4710-EXIT
 19116             ELSE
 19117                 GO TO 4710-EXIT.
 19118
 19119     MOVE SPACES                 TO W-REIN-PROCESS-SW.
 19120
 19121     IF  EW-LF-AH EQUAL 'L'
 19122         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19123             GO TO 4710-EXIT
 19124         ELSE
 19125             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19126             ADD W-WK-IBNR       TO W-LIFE-IBNR
 19127     ELSE
 19128         IF  EPEC-EARNED-PREMIUM-AH (SUB2)
 19129                 GREATER THAN ZEROS
 19130             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19131             ADD W-WK-IBNR       TO W-AH-IBNR
 19132         ELSE
 19133             GO TO 4710-EXIT.
 19134
 19135     MOVE W-WK-IBNR              TO EW-CLM-IBNR.
 19136     MOVE EW-ISS-BEN             TO W-ISS-BEN.
 19137     MOVE EW-ISS-BEN-GROSS       TO W-ISS-BEN-GROSS.
 19138
 19139     IF  W-UNDERWRITTEN-DATA
 19140         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB2)
 19141     ELSE
 19142         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB2).
 19143
 19144
 19145     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19146     PERFORM 4750-UPDATE-REIN THRU 4750-EXIT.
 19147
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 370
* ECS010V.cbl
 19148 4710-EXIT.
 19149     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 371
* ECS010V.cbl
 19151 4720-PROCESS-LIFE.
 19152
 19153     MOVE EPEC-LIFE-IBNR (SUB2)  TO W-WK-IBNR.
 19154
 19155 4720-EXIT.
 19156     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 372
* ECS010V.cbl
 19158 4730-PROCESS-A-H.
 19159
 19160     IF  AM-TARGET-LOSS-RATIO NUMERIC
 19161             AND
 19162         AM-TARGET-LOSS-RATIO NOT EQUAL ZERO
 19163         MOVE AM-TARGET-LOSS-RATIO
 19164                                 TO W-TARGET-LOSS-RATIO
 19165     ELSE
 19166         IF  CLAS-INDEXS NOT GREATER THAN CLAS-MAXS
 19167             MOVE STATE-TARGET-LOSS-RATIO (CLAS-INDEXS)
 19168                                 TO W-TARGET-LOSS-RATIO
 19169             PERFORM 4735-GET-BUSINESS-ADJUSTMENT THRU 4735-EXIT.
 19170
 19171     IF  W-NOT-REIN-PROCESS
 19172         ADD EPEC-EARNED-PREMIUM-AH (SUB2) TO W-EPEC-EP
 19173         ADD EPEC-CLAIMS-MADE-PAID (SUB2)  TO W-CLAIMS-MADE-PAID.
 19174
 19175     COMPUTE W-IBNR-1 ROUNDED
 19176         = EPEC-EARNED-PREMIUM-AH (SUB2)
 19177         * COMPANY-IBNR-AH-FACTOR
 19178         * W-TARGET-LOSS-RATIO.
 19179
 19180     COMPUTE W-IBNR-2 ROUNDED
 19181         = (EPEC-EARNED-PREMIUM-AH (SUB2)
 19182         * W-TARGET-LOSS-RATIO)
 19183         - EPEC-CLAIMS-MADE-PAID (SUB2).
 19184
 19185     IF  W-IBNR-1 GREATER THAN W-IBNR-2
 19186         MOVE W-IBNR-1           TO W-WK-IBNR
 19187         IF  W-NOT-REIN-PROCESS
 19188             ADD +1              TO W-AH-IBNR-1-CNT
 19189             ADD W-IBNR-1        TO W-AH-IBNR-1
 19190         ELSE
 19191             NEXT SENTENCE
 19192     ELSE
 19193         MOVE W-IBNR-2           TO W-WK-IBNR
 19194         IF  W-NOT-REIN-PROCESS
 19195             ADD +1              TO W-AH-IBNR-2-CNT
 19196             ADD W-IBNR-2        TO W-AH-IBNR-2.
 19197
 19198 4730-EXIT.
 19199     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 373
* ECS010V.cbl
 19201 4735-GET-BUSINESS-ADJUSTMENT.
 19202
 19203     IF  CR-GRPTYP NOT NUMERIC
 19204         MOVE '99'               TO INDEXBS
 19205     ELSE
 19206         MOVE CR-GRPTYP          TO INDEXBS.
 19207
 19208     IF  BUS-TRGT-LOSS-RATIO-MOD (INDEXBS) NUMERIC
 19209             AND
 19210         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19211             NOT EQUAL ZEROS
 19212             AND
 19213         BUS-TRGT-LOSS-RATIO-MOD (INDEXBS)
 19214             NOT EQUAL +1.0000
 19215         MOVE INDEXBS           TO W-EDIT-7
 19216         COMPUTE W-TARGET-LOSS-RATIO ROUNDED
 19217             = W-TARGET-LOSS-RATIO
 19218             * BUS-TRGT-LOSS-RATIO-MOD (INDEXBS).
 19219
 19220 4735-EXIT.
 19221     EXIT.
 19222
 19223 4740-CREATE-DETAIL-EXTR.
 19224
 19225     IF DTE-PGM-OPT NOT = '1'
 19226         GO TO 4740-EXIT.
 19227
 19228     IF  EW-CLM-IBNR NOT GREATER THAN ZEROS
 19229         GO TO 4740-EXIT.
 19230
 19231     MOVE EOM-RUN-DATE           TO INCURRED-DATE.
 19232     MOVE ZEROS                  TO REPORTED-DATE
 19233                                    PAY-TO-DATE.
 19234
 19235     MOVE SPACES                 TO TR-DTL2.
 19236     MOVE 'ACTBENIBNR'           TO TRD-CERT.
 19237
 19238     MOVE EOM-YR                 TO TRD-ISYR.
 19239     MOVE EOM-MO                 TO TRD-ISMO.
 19240     MOVE EOM-DA                 TO TRD-ISDA.
 19241     MOVE ZERO                   TO TRD-AGE.
 19242
 19243     IF  EW-LF-AH EQUAL 'L'
 19244         MOVE LIFE-OVERRIDE-L6   TO TRD-RSV-DESC
 19245     ELSE
 19246         MOVE AH-OVERRIDE-L6     TO TRD-RSV-DESC.
 19247
 19248     MOVE SPACES                 TO TRD-PAYCURX
 19249                                    TRD-PAYCUR-SPACE
 19250                                    TRD-FUTRSV-SPACE
 19251                                    TRD-FUTRSVX.
 19252
 19253     MOVE EW-CLM-IBNR            TO TRD-IBNR.
 19254     MOVE 'IBNR'                 TO TRD-IBNRX.
 19255     MOVE EW-BEN-TYPE            TO TRD-BENEFIT-CODE.
 19256     MOVE 'BENEFIT - '           TO TRD-BENEFIT-X.
 19257
 19258     IF  W-UNDERWRITTEN-DATA
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 374
* ECS010V.cbl
 19259         IF  W-REIN-IN-PROCESS
 19260             MOVE ' ACCT/BEN REIN RSV UW'
 19261                                 TO TRD-RSV-ACTION
 19262         ELSE
 19263             MOVE ' ACCT/BEN RESERVES UW'
 19264                                 TO TRD-RSV-ACTION
 19265     ELSE
 19266         IF  W-REIN-IN-PROCESS
 19267             MOVE ' ACCT/BEN REIN RSV'
 19268                                 TO TRD-RSV-ACTION
 19269         ELSE
 19270             MOVE ' ACCT/BEN RESERVES'
 19271                                 TO TRD-RSV-ACTION.
 19272
 19273     PERFORM 8690-PRINT-DETAIL-LINE THRU 8699-PRT-DETAIL-X.
 19274
 19275     MOVE SPACES                 TO DETAIL-EXTRACT.
 19276
 19277     IF  W-REIN-IN-PROCESS
 19278         MOVE EW-REIN-CO         TO DE-REI-COMP
 19279         MOVE 'R'                TO DE-REIN
 19280         MOVE EW-CLM-IBNR        TO DE-REI-IBNR
 19281         MOVE ZEROS              TO DE-IBNR
 19282     ELSE
 19283         MOVE EW-CLM-IBNR        TO DE-IBNR
 19284         MOVE ZEROS              TO DE-REI-IBNR.
 19285
 19286     MOVE 'DE'                   TO DE-RECORD-ID.
 19287     MOVE 'Y'                    TO DE-TRANS.
 19288     MOVE 'IBNRRSV'              TO DE-CLMNO.
 19289     MOVE '1'                    TO DE-ENTRY-STATUS.
 19290     MOVE 'ACTBENIBNR'           TO DE-CERT.
 19291
 19292     MOVE EOM-RUN-DATE           TO DE-EFF
 19293                                    WS-DE-EFF-N
 19294                                    DE-ENTRY-DTE
 19295                                    WS-DE-ENTRY-DTE-N.
 19296     MOVE INCURRED-DATE          TO DE-RSV-INCUR
 19297                                    WS-DE-RSV-INCUR-N.
 19298
 19299     MOVE AM-COMPANY-CD          TO DE-COMPANY-CD.
 19300     MOVE AM-MSTR-CNTRL          TO DE-CNTRL1.
 19301     MOVE AM-EXPIRE-DT           TO DE-ACC-EXP-DTE-RSV
 19302                                    WS-DE-ACC-EXP-DTE-RSV-N.
 19303     MOVE AM-EFFECT-DT           TO DE-ACC-EFF-DTE-RSV
 19304                                    WS-DE-ACC-EFF-DTE-RSV-N.
 19305
 19306     MOVE AM-NAME                TO DE-RSV-ACC-NAME.
 19307     MOVE AM-RECALC-COMM         TO DE-RECALC-CODE.
 19308     MOVE AM-REMIT-TO            TO DE-REMIT-TO.
 19309     MOVE AM-REPORT-CODE-1       TO DE-REPORT-CODE-1.
 19310     MOVE AM-REPORT-CODE-2       TO DE-REPORT-CODE-2.
 19311
 19312     IF (CR-ENTRY-BATCH (1:2) = 'VA')
 19313        OR (CR-LF-EXIT-BATCH (1:2) = 'VA')
 19314        OR (CR-AH-EXIT-BATCH (1:2) = 'VA')
 19315        MOVE 'VA '                 TO DE-NCL-POOL-CODE
 19316     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 375
* ECS010V.cbl
 19317
 19318*    MOVE AM-POOL-PRIME          TO DE-NCL-POOL-CODE.
 19319     MOVE AM-IG                  TO DE-IG.
 19320
 19321     IF W-UNDERWRITTEN-DATA
 19322         MOVE 'Y'                TO DE-UNDERWRITING-CODE
 19323     ELSE
 19324         MOVE 'N'                TO DE-UNDERWRITING-CODE.
 19325
 19326     IF  EW-LF-AH EQUAL 'L'
 19327         MOVE EW-BEN-TYPE        TO DE-LF-TYPE
 19328         MOVE '1'                TO DE-RESERVE-TYPE
 19329         MOVE ZEROS              TO DE-AH-TYPE
 19330     ELSE
 19331         MOVE EW-BEN-TYPE        TO DE-AH-TYPE
 19332         MOVE '2'                TO DE-RESERVE-TYPE
 19333         MOVE ZEROS              TO DE-LF-TYPE.
 19334
 19335     MOVE SPACES                 TO DE-NAME
 19336                                    DE-ACC-GPCD
 19337                                    DE-AH-STAT-CDE
 19338                                    DE-LF-STAT-CDE
 19339                                    DE-MEMBER-NO
 19340                                    DE-NAME
 19341                                    DE-SEX.
 19342     MOVE ZEROS                  TO DE-AGE
 19343                                    DE-AH-BEN
 19344                                    DE-AH-CANC-DTE
 19345                                    WS-DE-AH-CANC-DTE-N
 19346                                    DE-AH-CANC-EXIT-DT
 19347                                    WS-DE-AH-CANC-EXIT-DT-N
 19348                                    DE-AH-PRM
 19349                                    DE-AH-RFND
 19350                                    DE-AH-TERM
 19351                                    DE-APR
 19352                                    DE-CANCEL-CNT-ITD
 19353                                    DE-CANCEL-CNT-YTD
 19354                                    DE-FUTRSV
 19355                                    DE-LF-BEN
 19356                                    DE-LF-BEN-ALT
 19357                                    DE-LF-CANC-DTE
 19358                                    WS-DE-LF-CANC-DTE-N
 19359                                    DE-LF-CANC-EXIT-DT
 19360                                    WS-DE-LF-CANC-EXIT-DT-N
 19361                                    DE-LF-CNBEN
 19362                                    DE-LF-CNBEN-ALT
 19363                                    DE-LF-PRM
 19364                                    DE-LF-PRM-ALT
 19365                                    DE-LF-RFND
 19366                                    DE-LF-TERM
 19367                                    DE-LIVES
 19368                                    DE-PAYCUR
 19369                                    DE-PMT-FREQ
 19370                                    DE-REI-AHAMT
 19371                                    DE-REI-AHPRM
 19372                                    DE-REI-AHRFND
 19373                                    DE-REI-CNAMT
 19374                                    DE-REI-FUTRSV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 376
* ECS010V.cbl
 19375                                    DE-REI-LFAMT
 19376                                    DE-REI-LFPRM
 19377                                    DE-REI-LFRFND
 19378                                    DE-REI-PAYCUR
 19379                                    DE-RSV-REPORTED
 19380                                    DE-RSV-PAYTO
 19381                                    WS-DE-RSV-PAYTO-N
 19382                                    DE-MOB-NET-TOT-FEES
 19383                                    DE-SOC-SEC-NO.
 19384
 19385     MOVE SPACES                 TO W-REIN-PROCESS-IND.
 19386
 19387     PERFORM 2500-WRITE-DETAIL-EXTRACTS
 19388         THRU 2599-WRT-DETAIL-X.
 19389     ADD +1                      TO BC-G-CRS.
 19390
 19391 4740-EXIT.
 19392     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 377
* ECS010V.cbl
 19394 4750-UPDATE-REIN.
 19395
 19396     COMPUTE SUB3 = SUB2 + 1.
 19397
 19398     IF  W-UNDERWRITTEN-DATA
 19399         MOVE EPEC-SUB-KEY-II (SUB2)
 19400                                 TO W-SUB-KEY
 19401     ELSE
 19402         MOVE EPEC-SUB-KEY (SUB2)
 19403                                 TO W-SUB-KEY.
 19404
 19405     PERFORM 4755-MATCH-REIN-EPEC THRU 4755-EXIT
 19406             VARYING
 19407         SUB3 FROM SUB3 BY +1
 19408             UNTIL
 19409         SUB3 GREATER THAN +900
 19410*        SUB3 GREATER THAN +220
 19411*        SUB3 GREATER THAN +300
 19412             OR
 19413         EPEC-LF-AH-OPT (SUB3) EQUAL SPACES.
 19414
 19415 4750-EXIT.
 19416     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 378
* ECS010V.cbl
 19418 4755-MATCH-REIN-EPEC.
 19419
 19420     IF  W-UNDERWRITTEN-DATA
 19421         MOVE EPEC-LEVELS-II (SUB3)
 19422                                 TO EPEC-WORK
 19423     ELSE
 19424         MOVE EPEC-LEVELS (SUB3) TO EPEC-WORK.
 19425
 19426     IF  EPEC-LINE-NOT-USED (SUB3)
 19427         GO TO 4755-EXIT.
 19428
 19429     IF  EW-SUB-KEY NOT EQUAL W-SUB-KEY
 19430             OR
 19431         EW-REIN-CO EQUAL SPACES
 19432         GO TO 4755-EXIT.
 19433
 19434     IF  W-ISS-BEN GREATER THAN ZEROS
 19435         IF  EPEC-REIN-ONLY-DATA (SUB3)
 19436             COMPUTE W-FACTOR ROUNDED
 19437                 = (EW-ISS-BEN
 19438                 - EPEC-REIN-ISS-BEN (SUB3))
 19439                 / W-ISS-BEN
 19440         ELSE
 19441             COMPUTE W-FACTOR ROUNDED
 19442                 = EW-ISS-BEN
 19443                 / W-ISS-BEN.
 19444
 19445     COMPUTE EW-CLM-IBNR ROUNDED
 19446         = EW-CLM-IBNR
 19447         + (W-WK-IBNR * W-FACTOR).
 19448
 19449     IF  W-UNDERWRITTEN-DATA
 19450         MOVE EPEC-WORK          TO EPEC-LEVELS-II (SUB3)
 19451     ELSE
 19452         MOVE EPEC-WORK          TO EPEC-LEVELS (SUB3).
 19453
 19454 4755-EXIT.
 19455     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 379
* ECS010V.cbl
 19457 4760-PROCESS-REIN-ONLY.
 19458
 19459     MOVE ZEROS                  TO W-WK-IBNR.
 19460
 19461     IF  EPEC-LINE-NOT-USED (SUB2)
 19462         GO TO 4760-EXIT.
 19463
 19464     IF  EW-LF-AH EQUAL 'L'
 19465         IF  EPEC-LIFE-IBNR (SUB2) EQUAL ZEROS
 19466             GO TO 4760-EXIT
 19467         ELSE
 19468             PERFORM 4720-PROCESS-LIFE THRU 4720-EXIT
 19469             ADD W-WK-IBNR       TO EW-CLM-IBNR
 19470     ELSE
 19471         IF  EPEC-EARNED-PREMIUM-AH (SUB2) EQUAL ZEROS
 19472             GO TO 4760-EXIT
 19473         ELSE
 19474             PERFORM 4730-PROCESS-A-H THRU 4730-EXIT
 19475             ADD W-WK-IBNR       TO EW-CLM-IBNR.
 19476
 19477 4760-EXIT.
 19478     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 380
* ECS010V.cbl
 19480 4770-CREATE-REIN-DETAIL.
 19481
 19482     MOVE 'Y'                    TO W-REIN-PROCESS-IND.
 19483     PERFORM 4740-CREATE-DETAIL-EXTR THRU 4740-EXIT.
 19484
 19485 4770-EXIT.
 19486     EXIT.
 19487
 19488 4799-EXIT.
 19489     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 381
* ECS010V.cbl
 19491 4800-CALC-EARNED-PREMIUM-AH.
 19492
 19493     MOVE +0                         TO CNC-BEN  EPR-R78
 19494                                        ISS-PRM  EPR-PRO
 19495                                        CNC-PRM  EPR-ST
 19496                                        WX-CLM-AMT
 19497                                        WX-CLM-EXP
 19498                                        WX-CLM-CNT
 19499                                        WX-CLM-CRT
 19500                                        WX-CNC-CNT
 19501                                        ISS-PRMTAX
 19502                                        WX-ACTIVE-COUNT.
 19503     MOVE SPACE                      TO A-H-EARNED-SWITCH.
 19504
 19505     MOVE WE-AHPRM TO ISS-PRM.
 19506
 19507     IF DTE-CLIENT = 'GIC'
 19508         IF REIN-EP-FLG NOT = 'R'  AND
 19509            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  AND
 19510            (CR-ENTRY-STATUS NOT = '5' AND '3' AND 'M')
 19511            MOVE CR-AHPRM-CALC TO ISS-PRM.
 19512
 19513     IF REIN-EP-FLG = 'R'  AND
 19514        REIN-AH-RUNOFF-SW (SUB5) = 'N'
 19515         NEXT SENTENCE
 19516     ELSE
 19517         GO TO 4810-EP-DO-AH-CLM.
 19518
 19519     IF CR-DIS-DT NOT GREATER THAN EARNING-STOP-DATE
 19520         IF WE-DSPY-AMT NOT = +0
 19521             ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19522             ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19523             ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19524             ADD +1             TO WX-CLM-CNT.
 19525
 19526     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19527         IF CR-DIS-DT GREATER THAN EARNING-STOP-DATE
 19528             GO TO 4830-EP-DO-AH-EP.
 19529
 19530     IF CR-AH-STATUS-AT-CANCEL NOT = ' '
 19531         IF CR-AH-CANC-DT GREATER THAN EARNING-STOP-DATE
 19532             GO TO 4830-EP-DO-AH-EP.
 19533
 19534     GO TO 4815-EP-DO-AH-CLM-EPR.
 19535
 19536 4810-EP-DO-AH-CLM.
 19537
 19538     IF WE-DSPY-AMT NOT = +0
 19539         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19540         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19541         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19542         ADD +1             TO WX-CLM-CNT.
 19543
 19544 4815-EP-DO-AH-CLM-EPR.
 19545
 19546     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
 19547         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST.
 19548
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 382
* ECS010V.cbl
 19549 4820-EP-DO-AH-CNCL.
 19550
 19551     IF CR-AH-STATUS-AT-CANCEL = ' '
 19552         IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '  AND
 19553            CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19554             GO TO 4899-EXIT
 19555         ELSE
 19556             GO TO 4830-EP-DO-AH-EP.
 19557
 19558     IF (DTE-CLIENT = 'DCC')
 19559        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19560        IF CR-AHRFND NOT = ZEROS
 19561           ADD +1                TO WX-CNC-CNT
 19562        END-IF
 19563     ELSE
 19564        ADD +1                   TO WX-CNC-CNT
 19565     END-IF
 19566
 19567     MOVE WE-AHRFND TO CNC-PRM.
 19568
 19569*    MOVE CR-DT                 TO  DC-GREG-DATE-CYMD.
 19570*    MOVE 'L'                   TO  DC-OPTION-CODE.
 19571*    PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19572*    MOVE DC-BIN-DATE-1         TO  WS-CR-BIN-DATE.
 19573
 19574     MOVE CR-AH-CANC-DT         TO DC-GREG-DATE-CYMD.
 19575     MOVE 'L'                   TO  DC-OPTION-CODE.
 19576     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19577     MOVE DC-BIN-DATE-1         TO  WS-BIN-CANCEL-DATE.
 19578
 19579     MOVE WS-CR-BIN-DATE          TO  DC-BIN-DATE-1.
 19580     MOVE WS-BIN-CANCEL-DATE      TO  DC-BIN-DATE-2.
 19581     MOVE '1'                     TO  DC-OPTION-CODE.
 19582     MOVE ZEROS                   TO  MONTHS-DIFF-AH.
 19583     MOVE ZEROS                   TO  DC-ELAPSED-MONTHS
 19584                                      DC-ODD-DAYS-OVER
 19585                                      DC-ELAPSED-DAYS.
 19586     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19587     MOVE DC-ELAPSED-MONTHS       TO  MONTHS-DIFF-AH.
 19588
 19589     IF DC-ODD-DAYS-OVER   GREATER THAN  ZERO
 19590         ADD  +1                  TO  MONTHS-DIFF-AH.
 19591
 19592     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19593
 19594     IF DTE-CLIENT = 'ACE'
 19595         GO TO 4820-CONTINUE-AH-CANCEL.
 19596
 19597     MOVE  ZEROS                  TO  SUB.
 19598
 19599 4820-AH-CHARGEBACK-LOOP.
 19600
 19601     ADD    +1                    TO  SUB.
 19602
 19603     IF  SUB  GREATER THAN  +10
 19604         GO TO  4820-CONTINUE-AH-CANCEL.
 19605
 19606     IF  AM-COMM-CHARGEBACK (SUB)  NOT  NUMERIC  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 383
* ECS010V.cbl
 19607         AM-COMM-CHARGEBACK (SUB)  =  ZEROS
 19608         GO TO  4820-AH-CHARGEBACK-LOOP.
 19609
 19610     IF  AM-COMM-CHARGEBACK (SUB)  EQUAL    '99'
 19611         MOVE  'N'    TO  WS-AH-CHARGEBACK-SW (SUB).
 19612
 19613     IF  (MONTHS-DIFF-AH GREATER THAN AM-COMM-CHARGEBACK (SUB))
 19614         OR (CR-AHRFND = ZEROS)
 19615         MOVE  'N'        TO  WS-AH-CHARGEBACK-SW (SUB)
 19616     END-IF
 19617
 19618     GO TO  4820-AH-CHARGEBACK-LOOP.
 19619
 19620
 19621 4820-CONTINUE-AH-CANCEL.
 19622
 19623     IF DTE-CLIENT = 'GIC'
 19624         IF REIN-EP-FLG NOT = 'R'  AND
 19625            CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19626            MOVE CR-AHRFND-CALC TO CNC-PRM.
 19627
 19628     COMPUTE EPR-R78 = WE-AHPRM - WE-AHRFND.
 19629     MOVE EPR-R78 TO EPR-PRO  EPR-ST.
 19630
 19631     IF CR-AH-LUMP-SUM-DISAB
 19632         GO TO 4899-EXIT.
 19633
 19634     MOVE WE-AHAMT TO CNC-BEN.
 19635
 19636     GO TO 4899-EXIT.
 19637
 19638 4825-EP-DO-AH-CNCL-SUM.
 19639
 19640     IF WE-DSPY-AMT NOT = +0
 19641         ADD WE-DSPY-AMT    TO WX-CLM-AMT
 19642         ADD WE-DSPY-EXP    TO WX-CLM-EXP
 19643         ADD CR-NUM-DIS-CLM TO WX-CLM-CNT
 19644         ADD +1             TO WX-CLM-CNT.
 19645
 19646     IF WE-AHRFND = ZERO
 19647        GO TO 4830-EP-DO-AH-EP.
 19648
 19649     MOVE WE-AHRFND TO CNC-PRM.
 19650
 19651     ADD CR-SUM-CAN-CNT-ITD TO WX-CNC-CNT.
 19652
 19653     MOVE  'YYYYYYYYYY'           TO  WS-AH-CHARGEBACK-LEVELS.
 19654
 19655     IF WE-AHRFND NOT LESS WE-AHPRM
 19656         MOVE WE-AHAMT TO CNC-BEN
 19657          GO TO 4830-EP-DO-AH-EP.
 19658
 19659     COMPUTE TEMP-6 ROUNDED = WE-AHRFND / WE-AHPRM.
 19660     COMPUTE TEMP-7 ROUNDED = TEMP-6 * WE-AHAMT.
 19661     MOVE TEMP-7 TO CNC-BEN.
 19662
 19663 4830-EP-DO-AH-EP.
 19664
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 384
* ECS010V.cbl
 19665     MOVE EOM-RUN-DATE TO VALUATION-DT.
 19666     MOVE '8'           TO W-VAL-SOURCE.
 19667
 19668     IF REIN-EP-FLG = 'R'
 19669       IF REIN-REM-SW (SUB5) = 'I'
 19670           MOVE WE-AHPRM            TO EPR-R78  EPR-PRO  EPR-ST
 19671           GO TO 4899-EXIT.
 19672
 19673     IF REIN-EP-FLG = 'R'
 19674         IF REIN-AH-RUNOFF-SW (SUB5) = 'N'  AND
 19675            EARNING-STOP-DATE LESS THAN VALUATION-DT
 19676             MOVE '*'               TO A-H-EARNED-SWITCH
 19677             MOVE EARNING-STOP-DATE TO VALUATION-DT
 19678             MOVE '10'              TO W-VAL-SOURCE.
 19679
 19680     PERFORM 8500-REMAINING-TERM-ROUTINE THRU 8599-REM-TERM-X.
 19681
 19682     IF REM-TRM2 GREATER CR-AH-TERM
 19683         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19684         GO TO 4899-EXIT.
 19685
 19686     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
 19687         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
 19688*
 19689 4835-CHECK-OB-AH-NCL.
 19690
 19691     IF (DTE-CLIENT EQUAL 'NCL') AND
 19692        (CLAS-I-CALC-TYPE (CLAS-INDEXA) EQUAL 'B')
 19693           MOVE WE-AHPRM         TO EPR-R78
 19694                                    EPR-PRO
 19695                                    EPR-ST
 19696        IF (CR-CCYY EQUAL EOM-CCYY) AND
 19697           (CR-MO EQUAL EOM-MO)
 19698           MOVE '*'            TO OB-DATE-1-SWITCH
 19699           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19700           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19701           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19702           COMPUTE WS-EPR-R78 (SUB3 1) =
 19703                   WS-EPR-R78 (SUB3 1) + (WE-AHPRM * .5)
 19704           GO TO 4899-EXIT
 19705        ELSE
 19706        IF (CR-CCYY EQUAL OB-CCYY (1)) AND
 19707           (CR-MO EQUAL OB-MO (1))
 19708           MOVE '*'            TO OB-DATE-2-SWITCH
 19709           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19710           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19711           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19712           COMPUTE WS-EPR-R78 (SUB3 2) =
 19713                   WS-EPR-R78 (SUB3 2) + (WE-AHPRM * .5)
 19714           GO TO 4899-EXIT
 19715        ELSE
 19716        IF (CR-CCYY EQUAL OB-CCYY (2)) AND
 19717           (CR-MO EQUAL OB-MO (2))
 19718           MOVE '*'            TO OB-DATE-3-SWITCH
 19719           MOVE EW-REIN-CO     TO WS-OB-REIN-CO (SUB3)
 19720           MOVE AH-OVERRIDE-L1 TO WS-OB-LF-AH (SUB3)
 19721           MOVE CR-AHTYP       TO WS-OB-BENEFIT-CODE (SUB3)
 19722           COMPUTE WS-EPR-R78 (SUB3 3) =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 385
* ECS010V.cbl
 19723                   WS-EPR-R78 (SUB3 3) + (WE-AHPRM * .5)
 19724           GO TO 4899-EXIT
 19725        ELSE
 19726           GO TO 4899-EXIT.
 19727
 19728     IF REM-TRM2 NOT GREATER +0
 19729         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19730         GO TO 4899-EXIT.
 19731
 19732     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
 19733         MOVE WE-AHPRM TO EPR-R78  EPR-PRO  EPR-ST
 19734         GO TO 4899-EXIT.
 19735
 19736     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
 19737         MOVE +1 TO WX-ACTIVE-COUNT
 19738     ELSE
 19739         COMPUTE WX-ACTIVE-COUNT = CR-LIVES - CR-SUM-CAN-CNT-ITD.
 19740
 19741     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
 19742     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
 19743     IF DTE-R78 = '1'
 19744         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
 19745     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
 19746
 19747     IF DTE-CLIENT = 'MIC' OR 'MCC'
 19748         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
 19749     ELSE
 19750         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
 19751
 19752     COMPUTE EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
 19753     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19754
 19755     COMPUTE EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
 19756     COMPUTE EPR-PRO = WE-AHPRM - EPR-PRO.
 19757
 19758     MOVE CLAS-I-EP (CLAS-INDEXA) TO AH-EARN-METHOD.
 19759
 19760*    IF AM-EARN-METHOD-A NOT EQUAL SPACES AND ZEROS
 19761*        MOVE AM-EARN-METHOD-A TO AH-EARN-METHOD.
 19762
 19763     MOVE SPACES TO STATUTORY-SWITCH-AH.
 19764
 19765     IF (STATE-ABBR (CLAS-INDEXS) = 'VA') AND
 19766        (CR-DT GREATER THAN  19921231)
 19767        AND (DTE-CLIENT NOT = 'DCC')
 19768         IF CR-AH-TERM GREATER THAN  +61
 19769             MOVE 'A' TO AH-EARN-METHOD
 19770             MOVE '*' TO STATUTORY-SWITCH-AH
 19771             GO TO 4845-EP-DO-AH-EP-AN
 19772         ELSE
 19773             GO TO 4860-EP-DO-AH-STATUTORY.
 19774
 19775     IF (AH-EARN-METHOD EQUAL 'N')
 19776                  OR
 19777        ((DTE-CLIENT = 'DCC')
 19778         AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19779         AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) NOT = 'G'))
 19780         GO TO 4840-EP-DO-AH-EP-NP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 386
* ECS010V.cbl
 19781     END-IF
 19782
 19783     IF AH-EARN-METHOD EQUAL 'A' OR 'C'
 19784         MOVE 'A' TO AH-EARN-METHOD
 19785         GO TO 4845-EP-DO-AH-EP-AN.
 19786
 19787     GO TO 4860-EP-DO-AH-STATUTORY.
 19788
 19789 4840-EP-DO-AH-EP-NP.
 19790
 19791     IF WE-AHPRM = ZERO
 19792         GO TO 4860-EP-DO-AH-STATUTORY.
 19793
 19794     IF CR-APR GREATER THAN +0
 19795         NEXT SENTENCE
 19796     ELSE
 19797         GO TO 4860-EP-DO-AH-STATUTORY.
 19798
 19799     IF DTE-CLIENT = 'NCL'
 19800       IF CR-DT LESS THAN 19910101
 19801           GO TO 4860-EP-DO-AH-STATUTORY.
 19802
 19803     IF REM-TRM1 = CR-AH-TERM
 19804         MOVE +0 TO EPR-R78  EPR-PRO  EPR-ST
 19805         GO TO 4899-EXIT.
 19806
 19807     MOVE CR-APR TO NP-APR.
 19808     MOVE CR-AH-TERM TO NP-ORIG  NP-CAP.
 19809     MOVE REM-TRM1 TO NP-REM.
 19810     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXA) TO NP-OPT.
 19811     IF NP-OPT = 'T' OR 'U' OR 'V' OR 'W' OR 'X'
 19812         MOVE CR-LOAN-TERM TO NP-ORIG.
 19813
 19814     IF (DTE-CLIENT = 'DCC')
 19815        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19816        MOVE 'S'                 TO NP-OPT
 19817     ELSE
 19818        MOVE 'R'                 TO NP-OPT
 19819     END-IF
 19820
 19821
 19822*    MOVE 'R' TO NP-OPT.
 19823     CALL 'ECSNETRM'
 19824         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
 19825
 19826     IF (DTE-CLIENT = 'DCC')
 19827        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19828        COMPUTE EPR-ST ROUNDED =
 19829           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19830        GO TO 4899-EXIT
 19831     ELSE
 19832        COMPUTE EPR-R78 ROUNDED =
 19833           WE-AHPRM - (NP-FACTOR * WE-AHPRM)
 19834     END-IF
 19835
 19836     GO TO 4860-EP-DO-AH-STATUTORY.
 19837
 19838 4845-EP-DO-AH-EP-AN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 387
* ECS010V.cbl
 19839     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 19840     MOVE 'L'                        TO DC-OPTION-CODE.
 19841     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 19842     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
 19843     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 19844     MOVE SPACES                     TO CP-ACCT-FLD-5.
 19845     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 19846     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 19847     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 19848     MOVE CR-AGE                     TO CP-ISSUE-AGE.
 19849     MOVE REM-TRM1                   TO CP-ORIGINAL-TERM.
 19850     MOVE CR-AHAMT                   TO CP-ORIGINAL-BENEFIT
 19851                                        CP-RATING-BENEFIT-AMT.
 19852     IF CP-STATE-STD-ABBRV = 'OR'
 19853         COMPUTE CP-RATING-BENEFIT-AMT =
 19854                                  CR-AHAMT * REM-TRM1.
 19855     MOVE CR-APR                     TO CP-LOAN-APR.
 19856     MOVE CR-PMT-FREQ                TO CP-PAY-FREQUENCY.
 19857     MOVE AH-EARN-METHOD             TO CP-EARNING-METHOD.
 19858     MOVE '3'                        TO CP-PROCESS-TYPE.
 19859     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 19860     MOVE CR-LOAN-TERM               TO CP-LOAN-TERM.
 19861     IF CR-RATING-CLASS NOT = SPACE AND ZERO
 19862         MOVE CR-RATING-CLASS        TO CP-CLASS-CODE
 19863     ELSE
 19864         MOVE AM-CAL-TABLE           TO CP-CLASS-CODE.
 19865     MOVE AM-AH-DEVIATION            TO CP-DEVIATION-CODE.
 19866     MOVE CR-AHTYP                   TO CP-BENEFIT-CD.
 19867     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 19868     MOVE CR-PMT-EXTENSION-DAYS      TO CP-TERM-OR-EXT-DAYS.
 19869     MOVE AH-OVERRIDE-L1             TO CP-AH-OVERRIDE-CODE.
 19870     MOVE AM-AH-DEVIATION-PCT        TO CP-RATE-DEV-PCT.
 19871
 19872     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 19873
 19874     IF CP-ERROR-RATE-NOT-FOUND  OR
 19875        CP-ERROR-RATE-IS-ZERO  OR
 19876        CP-ERROR-IN-DATES
 19877         GO TO 4860-EP-DO-AH-STATUTORY.
 19878
 19879     COMPUTE EPR-R78 ROUNDED =
 19880             ((REM-TRM1 * WE-AHAMT) / +100) *
 19881               CP-PREMIUM-RATE.
 19882
 19883     COMPUTE EPR-R78 = WE-AHPRM - EPR-R78.
 19884
 19885     IF STATUTORY-REQUIREMENT-AH
 19886         MOVE EPR-R78                TO EPR-ST
 19887         GO TO 4899-EXIT.
 19888
 19889 4860-EP-DO-AH-STATUTORY.
 19890
 19891     IF (DTE-CLIENT = 'DCC')
 19892        AND (CLAS-I-BEN-CATEGORY (CLAS-INDEXA) = 'G' OR 'L')
 19893        AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'G')
 19894        MOVE EPR-R78             TO EPR-ST
 19895        GO TO 4899-EXIT
 19896     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 388
* ECS010V.cbl
 19897
 19898     MOVE EPR-R78                    TO EPR-ST.
 19899
 19900     MOVE +0                         TO SUB1.
 19901
 19902 4865-EP-AH-STAT-LOOP.
 19903     ADD +1 TO SUB1.
 19904
 19905     IF STATE-ABBR (CLAS-INDEXS) = AH-RES-STATE-ENT (SUB1)
 19906         MOVE EPR-PRO                TO EPR-ST
 19907     ELSE
 19908         IF AH-RES-STATE-ENT (SUB1) NOT = HIGH-VALUES
 19909             GO TO 4865-EP-AH-STAT-LOOP.
 19910
 19911     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
 19912         CR-DT GREATER THAN 19831031)  OR
 19913
 19914        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
 19915         CR-DT GREATER THAN 19820629)  OR
 19916
 19917        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
 19918         CR-DT GREATER THAN 19830831)
 19919
 19920         COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19921
 19922     IF DTE-CLIENT = 'CSO'  OR  'CID'
 19923       IF STATE-ABBR (CLAS-INDEXS) = 'CO'
 19924         IF CR-DT LESS THAN 19970101
 19925             MOVE EPR-R78            TO EPR-ST
 19926         ELSE
 19927             COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2.
 19928
 19929     IF DTE-CLIENT = 'DCC'
 19930        IF CLAS-I-BAL (CLAS-INDEXA) = 'C'
 19931           MOVE EPR-PRO          TO EPR-ST
 19932        ELSE
 19933           COMPUTE EPR-ST = (EPR-R78 + EPR-PRO) / 2
 19934        END-IF
 19935     END-IF
 19936     .
 19937 4899-EXIT.
 19938     EXIT.
 19939******************************************************************
 19940***         W R I T E   S U M M A R Y   E X T R A C T S        ***
 19941******************************************************************
 19942
 19943 4900-WRITE-SUMMARY-EXTRACTS.
 19944
 19945     IF DTE-CLIENT = 'HER'
 19946         IF EP-RECORD-ID = 'EC'  AND
 19947            EP-REINCO = 'LNL'
 19948             GO TO 4999-WRT-SUMMARY-X.
 19949
 19950     MOVE EOM-RUN-DATE            TO EP-RUN-DTE
 19951                                     WS-EP-RUN-DTE-N.
 19952
 19953     IF W-UNDERWRITTEN-DATA
 19954         MOVE 'Y'                 TO EP-UNDERWRITING-CODE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 389
* ECS010V.cbl
 19955     ELSE
 19956         MOVE 'N'                 TO EP-UNDERWRITING-CODE.
 19957
 19958     IF  DTE-OPT-RESERVE-METHOD-AUTH
 19959         IF VALID-EP-ID
 19960             MOVE 'Y'             TO EP-NEW-DATA-IND.
 19961
 19962     WRITE EP-RECORD.
 19963
 19964     ADD +1                       TO EP-CNT.
 19965
 19966 4999-WRT-SUMMARY-X.
 19967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 390
* ECS010V.cbl
 19969******************************************************************
 19970***       T O T A L   P A G E   S E T U P   R O U T I N E      ***
 19971******************************************************************
 19972
 19973 5000-DATE-RANGE-BREAK.
 19974
 19975     IF NO-TRANSACTION-WAS-PROCESSED
 19976         GO TO 5099-DATE-RANGE-BREAK-X.
 19977
 19978     ADD +1  TO RANGE-CNT.
 19979     MOVE +1 TO SUB6.
 19980     MOVE +2 TO SUB7.
 19981     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 19982     IF LN-CNT GREATER +50
 19983         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 19984                 8750-PRT-RANGE-HEADING.
 19985
 19986     MOVE SPACES                     TO PRT.
 19987     PERFORM 8800-PRINT-ROUTINE.
 19988     MOVE 'DATE RANGE'               TO TPH2-DESC.
 19989     MOVE '  TOTALS'                 TO TPH3-DESC.
 19990     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 19991     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 19992     PERFORM 5900-CLEAR-TOTAL-PAGES
 19993         THRU 5999-CLEAR-TOTAL-PAGES-X
 19994             VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 19995
 19996 5099-DATE-RANGE-BREAK-X.
 19997     EXIT.
 19998
 19999 5100-ACCOUNT-BREAK.
 20000
 20001     IF RANGE-CNT NOT = +0
 20002         PERFORM 5000-DATE-RANGE-BREAK
 20003             THRU 5099-DATE-RANGE-BREAK-X
 20004     ELSE
 20005         MOVE +1 TO SUB6
 20006         MOVE +2 TO SUB7
 20007         PERFORM 5800-ADD-PAGES-LEVELS
 20008             THRU 5899-ADD-PAGES-LEVELS-X
 20009         PERFORM 5900-CLEAR-TOTAL-PAGES
 20010             THRU 5999-CLEAR-TOTAL-PAGES-X
 20011                 VARYING SUB6 FROM 1 BY 1 UNTIL SUB6 GREATER 1.
 20012
 20013     MOVE +0 TO RANGE-CNT.
 20014     PERFORM 7500-ADD-UP-REIN-CO THRU 7599-ADD-UP-REIN-X
 20015         VARYING B-SUB FROM 1 BY 1
 20016             UNTIL B-SUB GREATER THAN 50  OR
 20017                   RB-COMPANY (B-SUB) = SPACES.
 20018     PERFORM 7900-CLEAR-BILLING-TABLE THRU 7999-CLEAR-BILLING-X
 20019         VARYING B-SUB FROM 1 BY 1
 20020             UNTIL B-SUB GREATER THAN 50.
 20021
 20022     IF ACCT-FLG = SPACE
 20023         GO TO 5199-ACCOUNT-BREAK-X.
 20024
 20025     MOVE SPACE TO ACCT-FLG.
 20026     MOVE +2 TO SUB6.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 391
* ECS010V.cbl
 20027     MOVE +3 TO SUB7.
 20028     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20029     IF LN-CNT GREATER +50
 20030         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20031                 8725-PRT-ACCT-HEADING.
 20032
 20033     MOVE SPACES                     TO PRT.
 20034     PERFORM 8800-PRINT-ROUTINE.
 20035     MOVE 'ACCOUNT'                  TO TPH2-DESC.
 20036     MOVE ' TOTALS'                  TO TPH3-DESC.
 20037     PERFORM 6100-ACCT-TOTAL-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20038     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20039     PERFORM 5900-CLEAR-TOTAL-PAGES
 20040         THRU 5999-CLEAR-TOTAL-PAGES-X
 20041             VARYING SUB6 FROM 2 BY 1 UNTIL SUB6 GREATER 2.
 20042
 20043 5199-ACCOUNT-BREAK-X.
 20044     EXIT.
 20045
 20046 5200-STATE-BREAK.
 20047
 20048     PERFORM 5100-ACCOUNT-BREAK THRU 5199-ACCOUNT-BREAK-X.
 20049     MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20050     MOVE +3 TO SUB6.
 20051     MOVE +4 TO SUB7.
 20052     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20053
 20054     IF STATE-FLG = SPACE
 20055         GO TO 5299-STATE-BREAK-X.
 20056
 20057     MOVE SPACE         TO STATE-FLG.
 20058     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20059     MOVE 'STATE'       TO TPH1-TYPE.
 20060     MOVE HLD-STATE     TO STATE-L.
 20061
 20062     PERFORM 8200-STATE-CODE-LOOKUP THRU 8299-STATE-LOOKUP-X.
 20063
 20064     IF HLD-STATE NOT = STATE-SUB (CLAS-INDEXS)
 20065         MOVE SPACES          TO TPH1-DESC
 20066         MOVE HLD-STATE       TO TPH1-ST-CODE
 20067         MOVE 'UNKNOWN STATE' TO TPH1-ST-DESC
 20068     ELSE
 20069         MOVE SPACES TO TPH1-DESC
 20070         MOVE STATE-SUB (CLAS-INDEXS) TO TPH1-ST-CODE
 20071         MOVE STATE-PIC (CLAS-INDEXS) TO TPH1-ST-DESC.
 20072
 20073     MOVE 'STATE'  TO TPH2-DESC.
 20074     MOVE 'TOTALS' TO TPH3-DESC.
 20075     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20076     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20077     PERFORM 5900-CLEAR-TOTAL-PAGES
 20078         THRU 5999-CLEAR-TOTAL-PAGES-X
 20079             VARYING SUB6 FROM 3 BY 1 UNTIL SUB6 GREATER 3.
 20080
 20081 5299-STATE-BREAK-X.
 20082     EXIT.
 20083
 20084 5300-COMP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 392
* ECS010V.cbl
 20085
 20086     PERFORM 5200-STATE-BREAK THRU 5299-STATE-BREAK-X.
 20087     MOVE +4 TO SUB6.
 20088     MOVE +5 TO SUB7.
 20089     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20090
 20091     IF COMP-FLG = SPACE
 20092         GO TO 5399-COMP-BREAK-X.
 20093
 20094     MOVE ' ' TO COMP-FLG.
 20095     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20096     MOVE 'COMPANY'                   TO TPH1-TYPE.
 20097     MOVE HLD-GROUPING                TO TPH1-DESC.
 20098     MOVE 'COMPANY'                   TO TPH2-DESC.
 20099     MOVE ' TOTALS'                   TO TPH3-DESC.
 20100     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20101     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20102     PERFORM 5900-CLEAR-TOTAL-PAGES
 20103         THRU 5999-CLEAR-TOTAL-PAGES-X
 20104             VARYING SUB6 FROM 4 BY 1 UNTIL SUB6 GREATER 4.
 20105
 20106 5399-COMP-BREAK-X.
 20107     EXIT.
 20108
 20109 5400-CARR-BREAK.
 20110
 20111     PERFORM 5300-COMP-BREAK THRU 5399-COMP-BREAK-X.
 20112     MOVE +5 TO SUB6.
 20113     MOVE +6 TO SUB7.
 20114     PERFORM 5800-ADD-PAGES-LEVELS THRU 5899-ADD-PAGES-LEVELS-X.
 20115
 20116     IF CARR-FLG = SPACE
 20117         GO TO 5499-CARR-BREAK-X.
 20118
 20119     MOVE ' ' TO CARR-FLG.
 20120     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20121     MOVE 'CARRIER'               TO TPH1-TYPE.
 20122     MOVE HLD-CARRIER             TO TPH1-DESC.
 20123     MOVE 'CARRIER'               TO TPH2-DESC.
 20124     MOVE ' TOTALS'               TO TPH3-DESC.
 20125     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20126     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20127     PERFORM 5900-CLEAR-TOTAL-PAGES
 20128         THRU 5999-CLEAR-TOTAL-PAGES-X
 20129             VARYING SUB6 FROM 5 BY 1 UNTIL SUB6 GREATER 5.
 20130
 20131 5499-CARR-BREAK-X.
 20132     EXIT.
 20133
 20134 5500-FINAL-BREAK.
 20135
 20136     PERFORM 5400-CARR-BREAK THRU 5499-CARR-BREAK-X.
 20137
 20138     IF FINAL-FLG = SPACE
 20139         GO TO 5599-FINAL-BREAK-X.
 20140
 20141     IF DTE-FICH = '1'
 20142         MOVE '2'  TO  DTE-FICH.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 393
* ECS010V.cbl
 20143     MOVE +6 TO SUB6.
 20144     PERFORM 8700-PRINT-REPORT-HEADINGS.
 20145     MOVE SPACES   TO TPH1-TYPE.
 20146     MOVE SPACES   TO TPH1-DESC.
 20147     MOVE 'FINAL'  TO TPH2-DESC.
 20148     MOVE 'TOTALS' TO TPH3-DESC.
 20149     PERFORM 6000-TOTAL-PAGE-HEADINGS THRU 6199-PAGE-HEADINGS-X.
 20150     PERFORM 6500-PRINT-TOTAL-PAGE THRU 6599-TOTAL-PAGE-PRINT-X.
 20151
 20152 5599-FINAL-BREAK-X.
 20153     EXIT.
 20154
 20155 5800-ADD-PAGES-LEVELS.
 20156
 20157     ADD TPL-ISS-PRM (SUB6)  TO TPL-ISS-PRM (SUB7).
 20158     ADD TPA-ISS-PRM (SUB6)  TO TPA-ISS-PRM (SUB7).
 20159     ADD TPL-CNC-PRM (SUB6)  TO TPL-CNC-PRM (SUB7).
 20160     ADD TPA-CNC-PRM (SUB6)  TO TPA-CNC-PRM (SUB7).
 20161     ADD TPL-ACCT-COM (SUB6) TO TPL-ACCT-COM (SUB7).
 20162     ADD TPA-ACCT-COM (SUB6) TO TPA-ACCT-COM (SUB7).
 20163     ADD TPL-CLAIMS (SUB6)   TO TPL-CLAIMS (SUB7).
 20164     ADD TPA-CLAIMS (SUB6)   TO TPA-CLAIMS (SUB7).
 20165
 20166 5899-ADD-PAGES-LEVELS-X.
 20167     EXIT.
 20168
 20169 5900-CLEAR-TOTAL-PAGES.
 20170
 20171     MOVE +0 TO TPL-ISS-PRM (SUB6)  TPA-ISS-PRM (SUB6)
 20172             TPL-CNC-PRM (SUB6)     TPA-CNC-PRM (SUB6)
 20173             TPL-ACCT-COM (SUB6)    TPA-ACCT-COM (SUB6)
 20174             TPL-CLAIMS (SUB6)      TPA-CLAIMS (SUB6).
 20175
 20176 5999-CLEAR-TOTAL-PAGES-X.
 20177     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 394
* ECS010V.cbl
 20179******************************************************************
 20180***       T O T A L   P A G E   P R I N T   R O U T I N E      ***
 20181******************************************************************
 20182
 20183 6000-TOTAL-PAGE-HEADINGS.
 20184
 20185     MOVE TOTAL-PAGE-HD1 TO PRT.
 20186     PERFORM 8800-PRINT-ROUTINE.
 20187
 20188 6100-ACCT-TOTAL-HEADINGS.
 20189
 20190     MOVE TOTAL-PAGE-HD2 TO PRT.
 20191     MOVE '0' TO P-CTL.
 20192     PERFORM 8800-PRINT-ROUTINE.
 20193     MOVE TOTAL-PAGE-HD3 TO PRT.
 20194     MOVE ' ' TO P-CTL.
 20195     PERFORM 8800-PRINT-ROUTINE.
 20196     PERFORM 8800-PRINT-ROUTINE.
 20197     MOVE +81 TO LN-CNT.
 20198
 20199 6199-PAGE-HEADINGS-X.
 20200     EXIT.
 20201
 20202 6500-PRINT-TOTAL-PAGE.
 20203
 20204     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20205     MOVE LIFE-OVERRIDE-L6   TO TPD-DESC.
 20206     MOVE TPL-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20207
 20208     IF SUB6 = 6 AND ME-DO-UPDATE
 20209         MOVE TPL-ISS-PRM (6) TO ME-010-PREM-L.
 20210
 20211     MOVE TPL-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20212
 20213     IF SUB6 = 6 AND ME-DO-UPDATE
 20214         MOVE TPL-CNC-PRM (6) TO ME-010-REF-L.
 20215
 20216     COMPUTE TPD-NET-PRM =
 20217         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6).
 20218
 20219     IF SUB6 = 6 AND ME-DO-UPDATE
 20220         SUBTRACT TPL-CNC-PRM (6) FROM TPL-ISS-PRM (6)
 20221         GIVING ME-010-NET-L.
 20222
 20223     MOVE TPL-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20224
 20225     IF SUB6 = 6 AND ME-DO-UPDATE
 20226         MOVE TPL-ACCT-COM (6) TO ME-010-COMM-L.
 20227
 20228     COMPUTE TPD-PREM-COMP =
 20229         TPL-ISS-PRM (SUB6) - TPL-CNC-PRM (SUB6)
 20230                            - TPL-ACCT-COM (SUB6).
 20231     MOVE TPL-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20232
 20233     IF SUB6 = 6 AND ME-DO-UPDATE
 20234         MOVE TPL-CLAIMS (6) TO ME-010-PMT-L.
 20235
 20236     IF SUB6 = 6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 395
* ECS010V.cbl
 20237         MOVE TPL-CLAIMS (6)          TO WS-ME-BAL-AMT
 20238         MOVE WS-BALANCE-DESCRIPTION1 TO WS-ME-BAL-DESCRIP
 20239         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20240     END-IF.
 20241
 20242     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20243     PERFORM 8800-PRINT-ROUTINE.
 20244     MOVE SPACES             TO TOTAL-PAGE-DETAIL.
 20245     MOVE AH-OVERRIDE-L6     TO TPD-DESC.
 20246     MOVE TPA-ISS-PRM (SUB6) TO TPD-ISS-PRM.
 20247     MOVE TPA-CNC-PRM (SUB6) TO TPD-CNC-PRM.
 20248
 20249     IF SUB6 = 6 AND ME-DO-UPDATE
 20250         MOVE TPA-ISS-PRM (6) TO ME-010-PREM-AH
 20251         MOVE TPA-CNC-PRM (6) TO ME-010-REF-AH.
 20252
 20253     COMPUTE TPD-NET-PRM =
 20254         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20255
 20256     IF SUB6 = 6 AND ME-DO-UPDATE
 20257         SUBTRACT TPA-CNC-PRM (6) FROM TPA-ISS-PRM (6)
 20258         GIVING ME-010-NET-AH.
 20259
 20260     MOVE TPA-ACCT-COM (SUB6) TO TPD-ACCT-COM.
 20261
 20262     IF SUB6 = 6 AND ME-DO-UPDATE
 20263         MOVE TPA-ACCT-COM (6) TO ME-010-COMM-AH.
 20264
 20265     COMPUTE TPD-PREM-COMP =
 20266         TPA-ISS-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20267                            - TPA-ACCT-COM (SUB6).
 20268     MOVE TPA-CLAIMS (SUB6)   TO TPD-CLAIMS.
 20269
 20270     IF SUB6 = 6 AND ME-DO-UPDATE
 20271         MOVE TPA-CLAIMS (6) TO ME-010-PMT-AH.
 20272
 20273     IF SUB6 = 6
 20274         MOVE TPA-CLAIMS (6)          TO WS-ME-BAL-AMT
 20275         MOVE WS-BALANCE-DESCRIPTION2 TO WS-ME-BAL-DESCRIP
 20276         WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC
 20277     END-IF.
 20278
 20279     MOVE TOTAL-PAGE-DETAIL   TO PRT.
 20280     PERFORM 8800-PRINT-ROUTINE.
 20281
 20282     MOVE 'TOTAL' TO TPD-DESC.
 20283
 20284     COMPUTE TPD-ISS-PRM =
 20285         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6).
 20286
 20287     COMPUTE TPD-CNC-PRM =
 20288         TPL-CNC-PRM (SUB6) + TPA-CNC-PRM (SUB6).
 20289
 20290     COMPUTE TPD-NET-PRM =
 20291         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20292         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6).
 20293
 20294     COMPUTE TPD-ACCT-COM =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 396
* ECS010V.cbl
 20295         TPL-ACCT-COM (SUB6) + TPA-ACCT-COM (SUB6).
 20296
 20297     COMPUTE TPD-PREM-COMP =
 20298         TPL-ISS-PRM (SUB6) + TPA-ISS-PRM (SUB6)
 20299         - TPL-CNC-PRM (SUB6) - TPA-CNC-PRM (SUB6)
 20300         - TPL-ACCT-COM (SUB6) - TPA-ACCT-COM (SUB6).
 20301
 20302     COMPUTE TPD-CLAIMS =
 20303         TPL-CLAIMS (SUB6) + TPA-CLAIMS (SUB6).
 20304
 20305     IF SV-LO-CERT = ZEROS  AND  SV-HI-CERT = ZEROS
 20306         NEXT SENTENCE
 20307     ELSE
 20308         MOVE SV-LO-CERT (6:6) TO TPD-LO-CERT
 20309         MOVE SV-HI-CERT (6:6) TO TPD-HI-CERT
 20310         MOVE ZEROS TO SV-LO-CERT  SV-HI-CERT.
 20311*        MOVE SV-LO-CERT (4:8)    TO TPD-LO-CERT
 20312*        MOVE SV-HI-CERT (4:8)    TO TPD-HI-CERT
 20313*        MOVE ZEROS               TO SV-LO-CERT
 20314*                                    SV-HI-CERT.
 20315
 20316     MOVE TOTAL-PAGE-DETAIL       TO PRT.
 20317     MOVE '0'                     TO P-CTL.
 20318     PERFORM 8800-PRINT-ROUTINE.
 20319     PERFORM 8800-PRINT-ROUTINE.
 20320
 20321 6599-TOTAL-PAGE-PRINT-X.
 20322     EXIT.
 20323*
 20324*
 20325*
 20326**START***********************************************************
 20327*      CUSTOM CODING FOR CLIENT "DMD"            PROJECT# 6475
 20328*            PARAGRAPHS  XXXX THRU 6700-COMM-EXIT
 20329******************************************************************
 20330*
 20331 6650-GET-RES-STATE-COMM.
 20332*6650-BROWSE-FORWARD.
 20333
 20334     IF DTE-CLIENT NOT = 'DMD'
 20335         GO TO 6700-COMM-EXIT.
 20336
 20337     MOVE CR-COMPANY-CD       TO WS-ERRESC-COMPANY-CD.
 20338     MOVE CR-CARRIER          TO WS-ERRESC-CARRIER.
 20339     MOVE CR-GROUPING         TO WS-ERRESC-GROUP.
 20340     MOVE CR-STATE            TO WS-ERRESC-STATE.
 20341     MOVE CR-ACCOUNT          TO WS-ERRESC-ACCOUNT.
 20342     MOVE WK-AGT              TO WS-ERRESC-AGENT.
 20343     MOVE CR-CERT-NO (1:2)    TO WS-ERRESC-RES-STATE.
 20344     MOVE CR-DT               TO WS-YYYYMMDD-DT.
 20345
 20346     MOVE WS-YYYYMMDD-DT      TO WS-ERRESC-EXPIRE-DT.
 20347
 20348*POSITION FILE AT STARTING KEY RECORD(COMPANY, CARRIER, GROUP, STA
 20349*ACCOUNT,AGENT, RESIDENT STATE) AND RESC-EXPIRE-DATE SET BY THE
 20350*VALUE OF PB-CERT-EFF-DT
 20351*
 20352     MOVE WS-ERRESC-KEY        TO ERRESC-RECORD-KEY.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 397
* ECS010V.cbl
 20353
 20354     START ERRESC-IN KEY NOT LESS THAN ERRESC-RECORD-KEY.
 20355
 20356     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20357         GO TO 6700-COMM-EXIT.
 20358
 20359*GET RECORD WHERE POSITIONED
 20360
 20361 6650-READ-ERRESC-NEXT.
 20362     READ ERRESC-IN NEXT RECORD.
 20363
 20364     IF ERRESC-FILE-STATUS NOT EQUAL '00'
 20365         GO TO 6700-COMM-EXIT.
 20366
 20367*GOT GOOD RECORD ??    FIRST 32 POSITIONS MUST MATCH  !!!!!!
 20368
 20369     IF ERRESC-RECORD-KEY (1:32) EQUAL TO WS-ERRESC-KEY (1:32)
 20370        NEXT SENTENCE
 20371     ELSE
 20372         GO TO 6700-COMM-EXIT.
 20373
 20374     IF WS-YYYYMMDD-DT < RESC-EXPIRE-DATE
 20375         NEXT SENTENCE
 20376     ELSE
 20377         GO TO 6650-READ-ERRESC-NEXT.
 20378
 20379*  CR-DT  = WS-YYYYMMDD-DT
 20380*CHECK TO SEE IF CERTIFICATE EFFECTIVE DATE IS WITHIN ACCOUNT
 20381*RESIDENT STATE COMMISSION RECORD'S EFFECTIVE TIME PERIOD???
 20382
 20383     IF WS-YYYYMMDD-DT IS LESS THAN RESC-EFFECTIVE-DATE
 20384         GO TO 6700-COMM-EXIT.
 20385
 20386* SEARCH FOR MATCHING CATEGORY CODE ENTRY
 20387
 20388     MOVE ZEROS               TO WS-SUB WS-SUB1.
 20389
 20390     PERFORM 6680-SEARCH-CATEGORY THRU 6680-EXIT.
 20391
 20392     IF WS-SUB1 IS GREATER THAN ZERO
 20393         IF RESC-COMMISSION-PER (WS-SUB) NOT NUMERIC
 20394             PERFORM 6680-SET-TABLE-CODE
 20395         ELSE
 20396             PERFORM 6680-SET-COMMISSION.
 20397
 20398     GO TO 6700-COMM-EXIT.
 20399
 20400 6680-SET-TABLE-CODE.
 20401     IF RESC-COMMISSION-TAB (WS-SUB) EQUAL SPACES
 20402        MOVE ZEROS             TO WS-SUB1
 20403     ELSE
 20404* DEFAULT TO AH-COVERAGE TO READ COMMISSION TABLE(CTBL)
 20405* TO COMPUTE AH COMMISSION.
 20406        MOVE CR-AHTYP          TO CTBL-BEN-CODE
 20407        MOVE CR-AH-TERM        TO WS-COMM-TERM
 20408        MOVE AH-OVERRIDE-L1    TO CTBL-BEN-TYPE
 20409        MOVE RESC-COMMISSION-TAB (WS-SUB)
 20410                               TO CTBL-TABLE-CD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 398
* ECS010V.cbl
 20411        PERFORM 6680-READ-CTBL-TABLE
 20412        IF ERCTBL-FILE-STATUS NOT EQUAL '00'
 20413           MOVE ZEROS          TO WS-SUB1.
 20414
 20415 6680-READ-CTBL-TABLE.
 20416*
 20417* WHEN CR-AHTYP = ZEROS READ COMMISSION TABLE(CTBL)
 20418* TO COMPUTE LIFE COMMISSION
 20419
 20420     IF CR-AHTYP = ZERO
 20421        MOVE LIFE-OVERRIDE-L1  TO CTBL-BEN-TYPE
 20422        MOVE CR-LFTYP          TO CTBL-BEN-CODE
 20423        MOVE CR-LF-TERM        TO WS-COMM-TERM.
 20424
 20425     PERFORM 1300-READ-ERCTBL-FILE THRU 1399-READ-ERCTBL-X.
 20426
 20427     IF ERCTBL-FILE-STATUS EQUAL '00'
 20428* COMPUTE A-H COMMISSION WHEN CR-AHTYP IS NOT ZEROS
 20429        IF CR-AHTYP NOT = ZERO
 20430             COMPUTE COMM-CK-AMT = CR-AHAMT * CR-AH-TERM
 20431             MOVE CR-AH-TERM        TO WS-COMM-TERM
 20432             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20433             MOVE WK-RATE           TO WS-COMMISSION
 20434                                       PB-I-AH-COMMISSION
 20435        ELSE
 20436* COMPUTE LIFE COMMISSION WHEN CR-AHTYP IS ZEROS
 20437             MOVE CR-LFAMT    TO COMM-CK-AMT
 20438             MOVE CR-LF-TERM  TO WS-COMM-TERM
 20439             PERFORM 1400-GET-COMM-PERCENT THRU 1489-GET-PERCENT-X
 20440             MOVE WK-RATE     TO WS-COMMISSION
 20441                                 PB-I-LIFE-COMMISSION.
 20442
 20443 6680-SET-COMMISSION.
 20444     IF RESC-COMMISSION-PER (WS-SUB) EQUAL ZEROS
 20445           MOVE ZEROS         TO WS-SUB1
 20446       ELSE
 20447           MOVE RESC-COMMISSION-PER (WS-SUB)
 20448                              TO WS-COMMISSION WK-RATE
 20449           IF CR-AHTYP NOT = ZERO
 20450                MOVE WS-COMMISSION TO PB-I-AH-COMMISSION
 20451           ELSE
 20452                MOVE WS-COMMISSION TO PB-I-LIFE-COMMISSION.
 20453
 20454 6680-SEARCH-CATEGORY.
 20455     ADD +1 TO WS-SUB.
 20456
 20457     IF WS-SUB IS GREATER THAN +12
 20458         GO TO 6680-EXIT.
 20459
 20460     IF CR-CERT-NO (4:1) = RESC-COVERAGE-CAT (WS-SUB)
 20461          MOVE WS-SUB         TO WS-SUB1
 20462          GO TO 6680-EXIT.
 20463
 20464     GO TO 6680-SEARCH-CATEGORY.
 20465
 20466 6680-EXIT.
 20467     EXIT.
 20468
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 399
* ECS010V.cbl
 20469 6700-COMM-EXIT.
 20470     EXIT.
 20471*
 20472*END***************CUSTOM CODE FOR CLIENT "DMD"*************
 20473
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 400
* ECS010V.cbl
 20475******************************************************************
 20476***         C L I E N T   B I L L I N G   R O U T I N E        ***
 20477******************************************************************
 20478
 20479 7000-CLIENT-BILLING-ROUTINE.
 20480*
 20481*
 20482* LEAVE THE ABOVE 2 LINES IN TO PREVENT LOSING THE LINE ABOVE
 20483
 20484     MOVE +0 TO BC-NET-WRIT BC-NET-WRIT-OB BC-NET-WRIT-SP
 20485                BC-G-ISS      BC-G-CNC   BC-G-CLM
 20486                BC-G-CRS      BC-G-CTN   BC-R-ISS      BC-R-CNC
 20487                BC-R-CLM      BC-R-CRS   BC-R-CTN      BC-COMM
 20488                BC-NEW-ACCTS  BC-ACCTS   BC-ACT-ACCTS
 20489                BC-G-CERTS    BC-G-A-CERTS  BC-R-CERTS
 20490                BC-R-A-CERTS  BC-ER-ACCTS   BC-CS-ACCTS.
 20491
 20492 7099-BILL-X.
 20493     EXIT.
 20494
 20495
 20496 7500-ADD-UP-REIN-CO.
 20497
 20498     IF RB-COMPANY (B-SUB) NOT = SPACES
 20499         ADD RB-COUNT (B-SUB) TO BC-CS-ACCTS.
 20500
 20501 7599-ADD-UP-REIN-X.
 20502     EXIT.
 20503
 20504 7900-CLEAR-BILLING-TABLE.
 20505
 20506     MOVE SPACES TO RB-COMPANY (B-SUB).
 20507     MOVE 0      TO RB-COUNT (B-SUB).
 20508
 20509 7999-CLEAR-BILLING-X.
 20510     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 401
* ECS010V.cbl
 20512******************************************************************
 20513***         M I S C E L L A N E O U S   R O U T I N E S        ***
 20514******************************************************************
 20515
 20516 8000-DATE-CONVERT-ROUTINE.
 20517
 20518     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
 20519
 20520 8099-DATE-CONVERT-X.
 20521     EXIT.
 20522
 20523 8000R-CONVERT-STOP-DATE.
 20524
 20525     MOVE RWF-EP-STOP-DATE        TO DC-GREG-DATE-CYMD.
 20526     MOVE 'L'                     TO DC-OPTION-CODE.
 20527     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20528     MOVE +0                      TO DC-ELAPSED-MONTHS.
 20529     MOVE -1                      TO DC-ELAPSED-DAYS.
 20530     MOVE '6'                     TO DC-OPTION-CODE.
 20531     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20532     MOVE +0                      TO DC-ELAPSED-MONTHS
 20533                                     DC-ELAPSED-DAYS.
 20534     MOVE DC-BIN-DATE-2           TO DC-BIN-DATE-1.
 20535     MOVE ' '                     TO DC-OPTION-CODE.
 20536     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20537
 20538     IF NO-CONVERSION-ERROR
 20539         MOVE DC-GREG-DATE-CYMD   TO EARNING-STOP-DATE
 20540     ELSE
 20541         DISPLAY 'ERROR OCCURED CONVERTING EARNING STOP '
 20542                 'DATE IN REIN TABLE: ' CR-REIN-TABLE
 20543                 '  STOP DATE: ' RWF-EP-STOP-DATE
 20544         MOVE 'ERROR OCCURED CONVERTING EARNING STOP DATE '
 20545                                  TO WS-ABEND-MESSAGE
 20546         MOVE DC-ERROR-CODE       TO WS-ABEND-FILE-STATUS
 20547         MOVE 4002                TO WS-ABEND-CODE
 20548         GO TO ABEND-PGM.
 20549
 20550 8099R-STOP-DATE-X.
 20551     EXIT.
 20552
 20553
 20554 8100-GET-RATE.
 20555
 20556     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
 20557
 20558 8199-GET-RATE-X.
 20559     EXIT.
 20560
 20561
 20562 8200-STATE-CODE-LOOKUP.
 20563
 20564     IF CLAS-INDEXS NOT GREATER CLAS-MAXS  AND
 20565        CLAS-INDEXS NOT = ZERO
 20566         IF STATE-L = STATE-SUB (CLAS-INDEXS)
 20567             GO TO 8299-STATE-LOOKUP-X.
 20568
 20569     MOVE CLAS-STARTS TO CLAS-INDEXS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 402
* ECS010V.cbl
 20570
 20571 8250-STATE-LOOKUP-LOOP.
 20572
 20573     IF CLAS-INDEXS GREATER CLAS-MAXS  OR  CLAS-INDEXS = ZERO
 20574         MOVE 0302 TO WS-ABEND-CODE
 20575         DISPLAY 'STATE CODE ' STATE-L ' NOT IN STATE TABLE'
 20576         DISPLAY '******************************'
 20577         DISPLAY '***** ERROR LOCATION 022 *****'
 20578         DISPLAY '******************************'
 20579         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20580         GO TO ABEND-PGM.
 20581
 20582     IF STATE-L NOT = STATE-SUB (CLAS-INDEXS)
 20583         ADD +1 TO CLAS-INDEXS
 20584         GO TO 8250-STATE-LOOKUP-LOOP.
 20585
 20586 8299-STATE-LOOKUP-X.
 20587     EXIT.
 20588
 20589
 20590 8300-LIFE-TYPE-LOOKUP.
 20591
 20592     IF CLAS-INDEXL NOT GREATER CLAS-MAXL  AND
 20593        CLAS-INDEXL NOT = ZERO
 20594         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXL)
 20595             GO TO 8399-LIFE-LOOKUP-X.
 20596
 20597     MOVE CLAS-STARTL TO CLAS-INDEXL.
 20598
 20599 8350-LIFE-LOOKUP-LOOP.
 20600
 20601     IF CLAS-INDEXL GREATER CLAS-MAXL  OR  CLAS-INDEXL = ZERO
 20602         MOVE 0401 TO WS-ABEND-CODE
 20603         DISPLAY 'LIFE TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20604         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20605         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20606         DISPLAY '******************************'
 20607         DISPLAY '***** ERROR LOCATION 023 *****'
 20608         DISPLAY '******************************'
 20609         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20610         IF DTE-CLIENT = 'NCL'
 20611                      OR 'CID'
 20612             MOVE CLAS-STARTL      TO CLAS-INDEXL
 20613             MOVE '05'             TO CLAS-LOOK
 20614             GO TO 8350-LIFE-LOOKUP-LOOP
 20615         ELSE
 20616             GO TO ABEND-PGM.
 20617
 20618     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXL)
 20619         ADD +1 TO CLAS-INDEXL
 20620         GO TO 8350-LIFE-LOOKUP-LOOP.
 20621
 20622     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
 20623         MOVE 'R'                    TO CLAS-I-EP (CLAS-INDEXL).
 20624
 20625 8399-LIFE-LOOKUP-X.
 20626     EXIT.
 20627
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 403
* ECS010V.cbl
 20628
 20629 8400-A-H-TYPE-LOOKUP.
 20630
 20631     IF CLAS-INDEXA NOT GREATER CLAS-MAXA  AND
 20632        CLAS-INDEXA NOT = ZERO
 20633         IF CLAS-LOOK = CLAS-I-BEN (CLAS-INDEXA)
 20634             GO TO 8499-A-H-LOOKUP-X.
 20635
 20636     MOVE CLAS-STARTA TO CLAS-INDEXA.
 20637
 20638 8450-A-H-LOOKUP-LOOP.
 20639
 20640     IF CLAS-INDEXA GREATER CLAS-MAXA  OR  CLAS-INDEXA = ZERO
 20641         MOVE 0402 TO WS-ABEND-CODE
 20642         DISPLAY 'A&H TYPE ' CLAS-LOOK ' NOT IN TYPE TABLE'
 20643         DISPLAY '    PENDING CONTROL = ' PENDING-MATCH-CONTROL
 20644         DISPLAY '       CERT CONTROL = ' CR-FULL-CONTROL
 20645         DISPLAY '******************************'
 20646         DISPLAY '***** ERROR LOCATION 024 *****'
 20647         DISPLAY '******************************'
 20648         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 20649         IF DTE-CLIENT = 'NCL'
 20650             MOVE CLAS-STARTA      TO CLAS-INDEXA
 20651             MOVE '05'             TO CLAS-LOOK
 20652             GO TO 8450-A-H-LOOKUP-LOOP
 20653         ELSE
 20654             GO TO ABEND-PGM.
 20655
 20656     IF CLAS-LOOK NOT = CLAS-I-BEN (CLAS-INDEXA)
 20657         ADD +1 TO CLAS-INDEXA
 20658         GO TO 8450-A-H-LOOKUP-LOOP.
 20659
 20660 8499-A-H-LOOKUP-X.
 20661     EXIT.
 20662
 20663 8500-REMAINING-TERM-ROUTINE.
 20664
 20665     MOVE ZEROS                      TO CP-REMAINING-TERM
 20666                                        CP-REMAINING-TERM-1
 20667                                        CP-REMAINING-TERM-2
 20668                                        CP-REMAINING-TERM-3
 20669                                        CP-RETURN-CODE
 20670                                        CP-RETURN-CODE-2
 20671                                        REM-TRM1
 20672                                        REM-TRM2
 20673                                        REM-TRM3
 20674                                        TEM-TRM1.
 20675     MOVE SPACES                     TO CP-REM-TERM-METHOD.
 20676
 20677     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
 20678     MOVE 'L'                        TO DC-OPTION-CODE.
 20679     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20680
 20681     IF  NO-CONVERSION-ERROR
 20682         MOVE DC-BIN-DATE-1          TO CP-CERT-EFF-DT
 20683     ELSE
 20684         MOVE 'ERROR OCCURED CONVERTING CR-DT'
 20685                                     TO WS-ABEND-MESSAGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 404
* ECS010V.cbl
 20686         MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20687         MOVE 3001                   TO WS-ABEND-CODE
 20688         GO TO ABEND-PGM.
 20689
 20690     MOVE LOW-VALUES                 TO CP-FIRST-PAY-DATE
 20691
 20692     IF  CR-LOAN-1ST-PMT-DT NOT NUMERIC
 20693         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20694
 20695     IF  CR-LOAN-1ST-PMT-DT NOT = ZEROS
 20696         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
 20697         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
 20698                                        DC-ELAPSED-DAYS
 20699         MOVE '3'                    TO DC-OPTION-CODE
 20700         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20701                 8099-DATE-CONVERT-X
 20702         IF  NO-CONVERSION-ERROR
 20703             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
 20704         ELSE
 20705             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
 20706
 20707     IF  CP-FIRST-PAY-DATE LESS THAN CP-CERT-EFF-DT
 20708         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
 20709
 20710     IF  CR-LOAN-1ST-PMT-DT = ZEROS
 20711         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
 20712         MOVE +1                     TO DC-ELAPSED-MONTHS
 20713         MOVE ZEROS                  TO DC-ELAPSED-DAYS
 20714         MOVE '6'                    TO DC-OPTION-CODE
 20715         PERFORM 8000-DATE-CONVERT-ROUTINE THRU
 20716                 8099-DATE-CONVERT-X
 20717         IF  NO-CONVERSION-ERROR
 20718             MOVE DC-BIN-DATE-2      TO CP-FIRST-PAY-DATE
 20719             MOVE DC-GREG-DATE-1-YMD TO CR-LOAN-1ST-PMT-DT
 20720         ELSE
 20721             MOVE 'ERROR OCCURED DETERMINING 1ST PAY DATE '
 20722                                     TO WS-ABEND-MESSAGE
 20723             MOVE DC-ERROR-CODE      TO WS-ABEND-FILE-STATUS
 20724             MOVE 3002               TO WS-ABEND-CODE
 20725             GO TO ABEND-PGM.
 20726
 20727     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
 20728     MOVE 'L'                        TO DC-OPTION-CODE.
 20729     PERFORM 8000-DATE-CONVERT-ROUTINE THRU 8099-DATE-CONVERT-X.
 20730
 20731     IF  NO-CONVERSION-ERROR
 20732         MOVE DC-BIN-DATE-1          TO CP-VALUATION-DT
 20733     ELSE
 20734         DISPLAY 'ERROR CONVERTING VALUATION DATE, SOURCE - '
 20735             W-VAL-ERROR (W-VAL-SOURCE)
 20736         DISPLAY '   KEY - ' CR-FULL-CONTROL
 20737             ' VALUATION DT - ' VALUATION-DT ' ERROR - '
 20738             DC-ERROR-CODE
 20739         DISPLAY '   STATUS: ' CR-ENTRY-STATUS ' LF: ' CR-LFTYP
 20740         ' ' CR-LF-CURRENT-STATUS '-' CR-LF-STATUS-AT-CANCEL '-'
 20741             CR-LF-STATUS-AT-DEATH ' AH: ' CR-AHTYP ' '
 20742             CR-AH-CURRENT-STATUS '-' CR-AH-STATUS-AT-CANCEL '-'
 20743             CR-AH-STATUS-AT-SETTLEMENT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 405
* ECS010V.cbl
 20744*        MOVE 'ERROR OCCURED CONVERTING VALUATION DATE'
 20745*                                    TO WS-ABEND-MESSAGE
 20746*        MOVE DC-ERROR-CODE          TO WS-ABEND-FILE-STATUS
 20747*        MOVE 3003                   TO WS-ABEND-CODE
 20748*        GO TO ABEND-PGM.
 20749
 20750     MOVE STATE-SUB (CLAS-INDEXS)    TO CP-STATE.
 20751     MOVE STATE-ABBR (CLAS-INDEXS)   TO CP-STATE-STD-ABBRV.
 20752     MOVE '3'                        TO CP-PROCESS-TYPE.
 20753     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
 20754     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
 20755     MOVE SPACES                     TO CP-ACCT-FLD-5.
 20756
 20757*    MOVE CLAS-CO-REM-TERM-CALC (W-NDX)
 20758*                                    TO CP-REM-TERM-METHOD.
 20759
 20760     IF  DTE-CLIENT = 'FIM'
 20761         MOVE '5'                    TO CP-REM-TERM-METHOD.
 20762
 20763     IF DTE-CLIENT = 'FLI' OR 'FLU'
 20764         IF WE-LF-AH = AH-OVERRIDE-L1
 20765             MOVE '2'                TO CP-REM-TERM-METHOD
 20766         ELSE
 20767             IF CR-LFTYP = '01' OR '03'
 20768                 MOVE '4'            TO CP-REM-TERM-METHOD
 20769             ELSE
 20770                 IF CR-LFTYP = '02' OR '04'
 20771                     MOVE '2'        TO CP-REM-TERM-METHOD.
 20772
 20773     IF  DTE-CLIENT = 'CSL'
 20774         IF  CR-CARRIER = '2'
 20775             IF  CR-LFTYP = '07' OR  '08'
 20776                 MOVE '4'            TO CP-REM-TERM-METHOD.
 20777
 20778     IF  DTE-CLIENT = 'POS'
 20779         IF  CR-CARRIER = '1'
 20780             MOVE '1'                TO CP-REM-TERM-METHOD
 20781         ELSE
 20782             MOVE '2'                TO CP-REM-TERM-METHOD.
 20783
 20784     IF  CP-REM-TERM-METHOD = SPACES OR LOW-VALUES
 20785         MOVE DTE-REM-TRM            TO CP-REM-TERM-METHOD.
 20786
 20787     IF  WE-LF-AH EQUAL AH-OVERRIDE-L1
 20788         GO TO 8540-CALC-REM-TERM-AH.
 20789
 20790 8520-CALC-REM-TERM-LIFE.
 20791
 20792     MOVE CLAS-I-EP (CLAS-INDEXL)    TO CP-EARNING-METHOD.
 20793     MOVE CLAS-I-RL-AH (CLAS-INDEXL) TO CP-BENEFIT-TYPE.
 20794     MOVE CLAS-I-BAL (CLAS-INDEXL)   TO CP-SPECIAL-CALC-CD.
 20795*    MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
 20796     MOVE CR-LF-TERM                 TO CP-ORIGINAL-TERM
 20797                                        CP-LOAN-TERM.
 20798
 20799     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20800             AND
 20801         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 406
* ECS010V.cbl
 20802         ADD +1                      TO CP-ORIGINAL-TERM
 20803                                        CP-LOAN-TERM.
 20804
 20805     IF  CP-TERM-IS-DAYS
 20806         MOVE CR-LF-TERM-IN-DAYS     TO CP-TERM-OR-EXT-DAYS
 20807     ELSE
 20808         MOVE ZEROS                  TO CP-TERM-OR-EXT-DAYS.
 20809
 20810     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20811
 20812     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20813         ADD +1                      TO W-ORGTRM-0-LF
 20814         DISPLAY 'LF TRM NOT GREATER THAN +0 - '
 20815             CR-FULL-CONTROL
 20816         GO TO 8599-REM-TERM-X.
 20817
 20818     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20819
 20820     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20821         ADD +1                      TO W-RET-CODE-LF
 20822         GO TO 8599-REM-TERM-X.
 20823*
 20824*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - LF'
 20825*                                    TO WS-ABEND-MESSAGE
 20826*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20827*        MOVE 2002                   TO WS-ABEND-CODE
 20828*        GO TO ABEND-PGM.
 20829
 20830     IF  CLAS-I-EP (CLAS-INDEXL) EQUAL 'B'
 20831             AND
 20832         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT EQUAL 'L'
 20833         MOVE CP-REMAINING-TERM-2    TO W-BAL-REMTRM
 20834         COMPUTE CP-REMAINING-TERM-1 = CP-REMAINING-TERM-1 - 1
 20835         COMPUTE CP-REMAINING-TERM-2 = CP-REMAINING-TERM-2 - 1.
 20836
 20837     IF  CP-REMAINING-TERM-1 NEGATIVE
 20838         MOVE ZEROS                  TO CP-REMAINING-TERM-1.
 20839
 20840     IF  CP-REMAINING-TERM-2 NEGATIVE
 20841         MOVE ZEROS                  TO CP-REMAINING-TERM-2.
 20842
 20843     IF DTE-CLIENT = 'NCL'
 20844         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20845                                        CP-REMAINING-TERM-3.
 20846
 20847     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20848     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20849     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20850     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20851
 20852     GO TO 8599-REM-TERM-X.
 20853
 20854 8520-EXIT.
 20855     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 407
* ECS010V.cbl
 20857 8540-CALC-REM-TERM-AH.
 20858
 20859     MOVE CLAS-I-EP (CLAS-INDEXA)    TO CP-EARNING-METHOD.
 20860     MOVE CLAS-I-RL-AH (CLAS-INDEXA) TO CP-BENEFIT-TYPE.
 20861     MOVE CLAS-I-BAL (CLAS-INDEXA)   TO CP-SPECIAL-CALC-CD.
 20862     MOVE CR-AH-TERM                 TO CP-ORIGINAL-TERM
 20863                                        CP-LOAN-TERM.
 20864     MOVE ZEROS                      TO CP-TERM-OR-EXT-DAYS.
 20865
 20866     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
 20867
 20868     IF  CP-ORIGINAL-TERM NOT GREATER THAN ZEROS
 20869         DISPLAY 'AH TRM NOT GREATER THAN +0 - '
 20870             CR-FULL-CONTROL
 20871         ADD +1                      TO W-ORGTRM-0-AH
 20872         GO TO 8599-REM-TERM-X.
 20873
 20874     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
 20875
 20876     IF  CP-RETURN-CODE NOT EQUAL ZEROS
 20877         ADD +1                      TO W-RET-CODE-AH
 20878         GO TO 8599-REM-TERM-X.
 20879*
 20880*        MOVE 'ERROR OCCURED REMAINING TERM CALCULATION - AH'
 20881*                                    TO WS-ABEND-MESSAGE
 20882*        MOVE CP-RETURN-CODE         TO WS-ABEND-FILE-STATUS
 20883*        MOVE 2001                   TO WS-ABEND-CODE
 20884*        GO TO ABEND-PGM.
 20885
 20886     IF DTE-CLIENT = 'NCL'
 20887         MOVE CP-REMAINING-TERM-1    TO CP-REMAINING-TERM-2
 20888                                        CP-REMAINING-TERM-3.
 20889
 20890     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
 20891     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
 20892     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
 20893     MOVE CP-ODD-DAYS                TO TEM-TRM1.
 20894
 20895 8599-REM-TERM-X.
 20896     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 408
* ECS010V.cbl
 20898
 20899******************************************************************
 20900***     " D I S P L A Y "  P R I N T   R O U T I N E           ***
 20901******************************************************************
 20902
 20903 8600-DISPLAY-PRT.
 20904
 20905     IF  DIS-LINE-CNT GREATER THAN 59
 20906         PERFORM 8600-DISPLAY-HD THRU
 20907             8600-HD-EXIT.
 20908
 20909     ADD  1  TO DIS-LINE-CNT.
 20910     WRITE DISPLAY-REC FROM DISPLAY-LINE.
 20911     MOVE  SPACES TO DISPLAY-REC
 20912                     DISPLAY-LINE.
 20913
 20914 8600-DISPLAY-EXIT.
 20915     EXIT.
 20916
 20917
 20918 8600-DISPLAY-HD.
 20919
 20920     MOVE '1'  TO  DISPLAY-CC.
 20921     MOVE ZEROS TO DIS-LINE-CNT.
 20922     WRITE DISPLAY-REC FROM DISPLAY-HD-1.
 20923     ADD +1 TO DIS-LINE-CNT.
 20924     MOVE ' '  TO  DISPLAY-CC.
 20925     MOVE SPACES TO DISPLAY-REC.
 20926     WRITE DISPLAY-REC.
 20927     ADD +1 TO DIS-LINE-CNT.
 20928     MOVE WS-CURRENT-DATE  TO  DIS-DATE.
 20929     WRITE DISPLAY-REC FROM DISPLAY-HD-2.
 20930     ADD +1 TO DIS-LINE-CNT.
 20931     MOVE SPACES TO DISPLAY-REC.
 20932     ADD +1 TO DIS-LINE-CNT.
 20933     WRITE DISPLAY-REC.
 20934
 20935 8600-HD-EXIT.
 20936     EXIT.
 20937
 20938******************************************************************
 20939***      T R A N S A C T I O N   P R I N T   R O U T I N E     ***
 20940******************************************************************
 20941
 20942 8600-SETUP-DETAIL-LINE.
 20943
 20944     MOVE SPACES                TO TR-DTL2.
 20945
 20946     MOVE CR-CERT-NO            TO TRD-CERT.
 20947     MOVE CR-YR                 TO TRD-ISYR.
 20948     MOVE CR-MO                 TO TRD-ISMO.
 20949     MOVE CR-DA                 TO TRD-ISDA.
 20950     MOVE CR-AGE                TO TRD-AGE.
 20951
 20952 8689-SETUP-DETAIL-X.
 20953     EXIT.
 20954
 20955 8690-PRINT-DETAIL-LINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 409
* ECS010V.cbl
 20956
 20957     IF LN-CNT GREATER THAN LN-MX
 20958         PERFORM 8700-PRINT-REPORT-HEADINGS THRU
 20959                 8799-PRT-HEADINGS-X.
 20960     MOVE TRD-CERT TO SV-TRD-CERT.
 20961     MOVE TRD-ISDT TO SV-TRD-ISDT.
 20962
 20963     IF TRD-CERT = LST-TRD-CERT  AND  TRD-ISDT = LST-TRD-ISDT
 20964         MOVE SPACES TO TRD-CERT  TRD-ISDT  TRD-AGE.
 20965
 20966     MOVE SV-TRD-CERT TO LST-TRD-CERT.
 20967     MOVE SV-TRD-ISDT TO LST-TRD-ISDT.
 20968     MOVE TR-DTL TO PRT.
 20969
 20970     IF NOT WS-CHANGE-REC
 20971         MOVE '/'                TO TRD-IS-S1  TRD-IS-S2
 20972     ELSE
 20973         MOVE 'N'                TO  WS-CHANGE-REC-SW.
 20974
 20975     PERFORM 8800-PRINT-ROUTINE.
 20976
 20977 8699-PRT-DETAIL-X.
 20978     EXIT.
 20979
 20980 8700-PRINT-REPORT-HEADINGS.
 20981     ADD +1 TO PG-CNT.
 20982     MOVE PG-CNT TO TR-PG.
 20983     MOVE +0 TO LN-CNT.
 20984     MOVE TR-HD-1 TO PRT.
 20985     PERFORM 8800-PRINT-ROUTINE.
 20986     MOVE TR-HD-2 TO PRT.
 20987     PERFORM 8800-PRINT-ROUTINE.
 20988     MOVE TR-HD-3 TO PRT.
 20989     PERFORM 8800-PRINT-ROUTINE.
 20990     ADD +1 TO LN-CNT.
 20991
 20992 8725-PRT-ACCT-HEADING.
 20993     MOVE TR-HD-4 TO PRT.
 20994     PERFORM 8800-PRINT-ROUTINE.
 20995     MOVE TR-HD-5 TO PRT.
 20996     PERFORM 8800-PRINT-ROUTINE.
 20997
 20998 8750-PRT-RANGE-HEADING.
 20999     MOVE TR-HD-6 TO PRT.
 21000     PERFORM 8800-PRINT-ROUTINE.
 21001
 21002 8775-PRT-COLUMN-HEADINGS.
 21003     MOVE TR-HD-7 TO PRT.
 21004     PERFORM 8800-PRINT-ROUTINE.
 21005     MOVE TR-HD-8 TO PRT.
 21006     PERFORM 8800-PRINT-ROUTINE.
 21007     MOVE TR-HD-9 TO PRT.
 21008     PERFORM 8800-PRINT-ROUTINE.
 21009     PERFORM 8800-PRINT-ROUTINE.
 21010
 21011 8799-PRT-HEADINGS-X.
 21012     EXIT.
 21013
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 410
* ECS010V.cbl
 21014 8800-PRINT-ROUTINE.
 21015     MOVE P-CTL TO X.
 21016     PERFORM 8900-PRINT-A-LINE THRU 8999-PRT-LINE-X.
 21017     ADD +1 TO LN-CNT.
 21018     MOVE SPACES TO PRT.
 21019
 21020 8900-PRINT-A-LINE.
*21021                             COPY ELCPRT2.
 21022******************************************************************04/15/98
 21023*                                                                *ELCPRT2
 21024*                                                                *ELCPRT2
 21025*                            ELCPRT2                             *   LV005
 21026*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
 21027*                            VMOD=2.002                          *   CL**5
 21028*                                                                *   CL**4
 21029******************************************************************   CL**4
 21030                                                                     CL**4
 21031     IF DTE-FICH NOT = SPACE AND                                     CL**4
 21032        FICH-OPEN    = SPACE                                         CL**4
 21033         MOVE 'X'                TO  FICH-OPEN                       CL**4
 21034         OPEN OUTPUT FICH.                                           CL**4
 21035                                                                     CL**4
 21036     IF DTE-FICH NOT = SPACE                                         CL**4
 21037         MOVE X                  TO  P-CTL                           CL**4
 21038         WRITE FICH-REC FROM PRT.                                    CL**4
 21039                                                                     CL**4
 21040     IF DTE-FICH = SPACE OR '2'                                      CL**4
 21041       MOVE X                    TO  P-CTL                           CL**4
 21042       IF P-CTL = ' '                                                CL**4
 21043         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
 21044       ELSE                                                          CL**4
 21045         IF P-CTL = '0'                                              CL**4
 21046           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
 21047         ELSE                                                        CL**4
 21048           IF P-CTL = '-'                                            CL**4
 21049             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
 21050           ELSE                                                      CL**4
 21051             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
 21052                                                                     CL**4
 21053******************************************************************   CL**4
 21054
 21055 8999-PRT-LINE-X.
 21056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 411
* ECS010V.cbl
 21058******************************************************************
 21059***          E N D   O F   J O B   P R O C E S S I N G         ***
 21060******************************************************************
 21061
 21062 9910-EOJ-1.
 21063     IF TR-CNT = ZERO
 21064         IF (DTE-PGM-OPT = '2' OR '3') OR
 21065            (DTE-CLIENT = 'LGX' OR 'FNA' OR 'HER' OR 'NCL' OR
 21066                          'ITY' OR 'DAC' OR 'FLC')
 21067             NEXT SENTENCE
 21068         ELSE
 21069             MOVE 'NO INPUT TRANSACTIONS' TO WS-ABEND-MESSAGE
 21070             MOVE 0703                    TO WS-ABEND-CODE
 21071             DISPLAY '******************************'
 21072             DISPLAY '***** ERROR LOCATION 025 *****'
 21073             DISPLAY '******************************'
 21074             MOVE WS-ABEND-CODE           TO WS-RETURN-CODE
 21075             GO TO ABEND-PGM.
 21076
 21077     MOVE '*'         TO TRANS-EOF-FLAG.
 21078     MOVE HIGH-VALUES TO PENDING-MATCH-CONTROL.
 21079
 21080     IF EOF-ON-CERT
 21081         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21082         GO TO 9940-EOJ-FIN.
 21083
 21084     GO TO 0330-MATCH-PENDING-TO-CERT.
 21085
 21086 9920-EOJ-2.
 21087     MOVE '*'         TO CERT-EOF-FLAG.
 21088     MOVE HIGH-VALUES TO CIR-CONTROL.
 21089
 21090     IF EOF-ON-TRANS
 21091         PERFORM 0400-WRITE-CERT-RECORD THRU 0499-WRITE-CERT-X
 21092         MOVE HIGH-VALUES TO CERTIFICATE-RECORD
 21093         GO TO 9940-EOJ-FIN.
 21094
 21095     GO TO 0299-READ-CERT-X.
 21096
 21097 9930-EOJ-3.
 21098     IF PROCESSING-COMPLETED
 21099         GO TO 9950-EOJ-FIN-GO.
 21100
 21101     DISPLAY 'MISSING ACCOUNT MASTER - '  CR-ACCT-CONTROL.
 21102     MOVE 'MISSING ACCOUNT MASTER'
 21103                               TO WS-ABEND-MESSAGE.
 21104     MOVE 0302                 TO WS-ABEND-CODE.
 21105     DISPLAY '******************************'
 21106     DISPLAY '***** ERROR LOCATION 026 *****'
 21107     DISPLAY '******************************'
 21108     MOVE WS-ABEND-CODE        TO WS-RETURN-CODE.
 21109     GO TO ABEND-PGM.
 21110
 21111 9940-EOJ-FIN.
 21112     MOVE '*'        TO PROCESSING-FLAG.
 21113     MOVE LOW-VALUES TO CERTIFICATE-RECORD.
 21114
 21115     PERFORM 0100-ACCT-MASTER-READ-ROUTINE THRU
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 412
* ECS010V.cbl
 21116             0199-READ-ACCOUNT-X.
 21117     GO TO 9940-EOJ-FIN.
 21118
 21119 9950-EOJ-FIN-GO.
 21120     PERFORM 5500-FINAL-BREAK THRU 5599-FINAL-BREAK-X.
 21121     MOVE HIGH-VALUES TO ACCOUNT-MASTER.
 21122*
 21123*
 21124* LEAVE THE ABOVE 2 LINE IN TO PREVENT LOSING THE LINE ABOVE
 21125     PERFORM 7000-CLIENT-BILLING-ROUTINE THRU 7099-BILL-X.
 21126
 21127 9960-NO-TOTS.
 21128
 21129     MOVE +15                    TO LN-CNT.
 21130     MOVE CMIN-CNT               TO TTL-PT-CNT.
 21131     IF ME-DO-UPDATE
 21132         MOVE CMIN-CNT           TO ME-010-CERT-IN.
 21133
 21134     MOVE CMIN-CNT                TO WS-ME-BAL-AMT.
 21135     MOVE WS-BALANCE-DESCRIPTION3 TO WS-ME-BAL-DESCRIP.
 21136     WRITE ME-ECS010-BALANCE-REC  FROM WS-ME-BALANCE-REC.
 21137
 21138
 21139     MOVE 'INPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21140     MOVE TR-TTL-HD              TO PRT.
 21141     PERFORM 8800-PRINT-ROUTINE.
 21142     ADD +1 TO LN-CNT.
 21143     MOVE TR-CNT                TO TTL-PT-CNT.
 21144     MOVE 'TRANSACTION RECORDS' TO TTL-HD-DS.
 21145     MOVE TR-TTL-HD             TO PRT.
 21146     PERFORM 8800-PRINT-ROUTINE.
 21147     ADD +1 TO LN-CNT.
 21148
 21149     IF DUP-CNT = ZERO
 21150         GO TO 9969-CHECK-MISMATCHED-TOTS.
 21151
 21152     MOVE DUP-CNT                 TO TTL-PT-CNT.
 21153
 21154     IF ME-DO-UPDATE
 21155         MOVE DUP-CNT            TO ME-010-DUP-ISS.
 21156
 21157     MOVE 'DUPE ISSUES DROPPED  ' TO TTL-HD-DS.
 21158     MOVE TR-TTL-HD               TO PRT.
 21159     PERFORM 8800-PRINT-ROUTINE.
 21160     PERFORM 8800-PRINT-ROUTINE.
 21161     ADD +1 TO LN-CNT.
 21162
 21163     MOVE '1'                           TO  DTL-REC-TYPE.
 21164     MOVE 'ISS'                         TO  DTL-REC-TYPE-DESC.
 21165     MOVE SPACES                        TO  DTL-CERT-IN-CONTROL.
 21166     MOVE 'DUPLICATE CERTIFICATE RECORD WILL BE'
 21167                                        TO  DTL-CERT-OUT-CONTROL.
 21168     MOVE SPACES                        TO  MISMATCH-DETAIL-2.
 21169     MOVE ' LIFE PREMIUM = '            TO  MD2-LF-PREM-DESC.
 21170     MOVE ' A&H  PREMIUM = '            TO  MD2-LF-ALT-PREM-DESC.
 21171
 21172     MOVE +1 TO SUB3.
 21173 9965-PRT-DUPES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 413
* ECS010V.cbl
 21174
 21175     IF  MISMATCH-LINE-COUNT GREATER THAN +56
 21176         ADD +1                  TO  MISMATCH-PAGE-NUMBER
 21177         MOVE MISMATCH-PAGE-NUMBER
 21178                                 TO  TR-PG
 21179         MOVE MISMATCH-HEADING-1 TO  MISMATCH-RPT
 21180         MOVE MR-CTL             TO  X
 21181         MOVE X TO LCP-ASA
 21182         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21183             THRU LCP-WRITE-END-MISMATCH-RPT
 21184         MOVE TR-HD-2            TO  MISMATCH-RPT
 21185         MOVE MR-CTL             TO  X
 21186         MOVE X TO LCP-ASA
 21187         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21188             THRU LCP-WRITE-END-MISMATCH-RPT
 21189         MOVE TR-HD-3            TO  MISMATCH-RPT
 21190         MOVE MR-CTL             TO  X
 21191         MOVE X TO LCP-ASA
 21192         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21193             THRU LCP-WRITE-END-MISMATCH-RPT
 21194         MOVE MISMATCH-HEADING-2 TO  MISMATCH-RPT
 21195         MOVE MR-CTL             TO  X
 21196         MOVE X TO LCP-ASA
 21197         PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21198             THRU LCP-WRITE-END-MISMATCH-RPT
 21199         MOVE +6                 TO  MISMATCH-LINE-COUNT.
 21200
 21201     MOVE DUPE-ENTRY (SUB3)             TO  DTL-MATCH-CONTROL.
 21202
 21203     MOVE MISMATCH-DETAIL               TO  MISMATCH-RPT.
 21204     MOVE MR-CTL                        TO  X.
 21205     ADD +2                             TO  MISMATCH-LINE-COUNT.
 21206
 21207     MOVE X TO LCP-ASA
 21208     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21209         THRU LCP-WRITE-END-MISMATCH-RPT.
 21210
 21211     MOVE  DUPE-LF-PRM (SUB3)           TO  MD2-LF-PREM.
 21212     MOVE  DUPE-AH-PRM (SUB3)           TO  MD2-LF-ALT-PREM.
 21213
 21214     ADD  DUPE-LF-PRM (SUB3)            TO  W-MM-LF-PRM.
 21215     ADD  DUPE-AH-PRM (SUB3)            TO  W-MM-AH-PRM.
 21216
 21217     MOVE DUPE-STATUS (SUB3)            TO  MD2-AH-PREM-DESC.
 21218     IF  DUPE-STATUS (SUB3)  =  '2'
 21219         MOVE  'POLICY IS PENDING '     TO  MD2-AH-PREM-DESC.
 21220     IF  DUPE-STATUS (SUB3)  =  '5'
 21221         MOVE  'POLICY IS REISSUE '     TO  MD2-AH-PREM-DESC.
 21222     IF  DUPE-STATUS (SUB3)  =  'M'
 21223         MOVE  'POLICY IS MONTHLY '     TO  MD2-AH-PREM-DESC.
 21224     IF  DUPE-STATUS (SUB3)  =  '9'
 21225         MOVE  'POLICY REIN ONLY  '     TO  MD2-AH-PREM-DESC.
 21226     IF  DUPE-STATUS (SUB3)  =  'D'
 21227         MOVE  'POLICY IS DECLINED'     TO  MD2-AH-PREM-DESC.
 21228     IF  DUPE-STATUS (SUB3)  =  'V'
 21229         MOVE  'POLICY IS VOIDED  '     TO  MD2-AH-PREM-DESC.
 21230     IF  DUPE-STATUS (SUB3)  =  'P'
 21231         MOVE  'POLICY PREM ACCTNG'     TO  MD2-AH-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 414
* ECS010V.cbl
 21232
 21233     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21234     MOVE MR-CTL                        TO  X.
 21235     ADD +1                             TO  MISMATCH-LINE-COUNT.
 21236
 21237     MOVE X TO LCP-ASA
 21238     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21239         THRU LCP-WRITE-END-MISMATCH-RPT.
 21240
 21241     IF SUB3 LESS THAN DUP-CNT
 21242         ADD +1 TO SUB3
 21243         GO TO 9965-PRT-DUPES.
 21244
 21245 9969-CHECK-MISMATCHED-TOTS.
 21246
 21247     IF W-MM-LF-PRM = ZEROS  AND
 21248        W-MM-AH-PRM = ZEROS  AND
 21249        W-MM-LF-RFD = ZEROS  AND
 21250        W-MM-AH-RFD = ZEROS  AND
 21251        W-MM-LF-CLM = ZEROS  AND
 21252        W-MM-AH-CLM = ZEROS
 21253         GO TO 9970-FIN-TOTS.
 21254
 21255     MOVE SPACES                        TO  MISMATCH-RPT.
 21256     MOVE '0'                           TO  MR-CTL  X.
 21257     MOVE X TO LCP-ASA
 21258     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21259         THRU LCP-WRITE-END-MISMATCH-RPT.
 21260
 21261     MOVE 'TOT LF PREMS  = '            TO  MD2-LF-PREM-DESC.
 21262     MOVE 'TOT AH PREMS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21263     MOVE ' TOTAL PREMIUMS = '          TO  MD2-AH-PREM-DESC.
 21264
 21265     MOVE W-MM-LF-PRM                   TO MD2-LF-PREM.
 21266     MOVE W-MM-AH-PRM                   TO MD2-LF-ALT-PREM.
 21267     COMPUTE MD2-AH-PREM = W-MM-LF-PRM + W-MM-AH-PRM.
 21268
 21269     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21270     MOVE '0'                           TO  MR-CTL  X.
 21271     MOVE X TO LCP-ASA
 21272     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21273         THRU LCP-WRITE-END-MISMATCH-RPT.
 21274
 21275     MOVE 'TOT LF RFNDS  = '            TO  MD2-LF-PREM-DESC.
 21276     MOVE 'TOT AH RFNDS  = '            TO  MD2-LF-ALT-PREM-DESC.
 21277     MOVE ' TOTAL REFUNDS  = '          TO  MD2-AH-PREM-DESC.
 21278
 21279     MOVE W-MM-LF-RFD                   TO MD2-LF-PREM.
 21280     MOVE W-MM-AH-RFD                   TO MD2-LF-ALT-PREM.
 21281     COMPUTE MD2-AH-PREM = W-MM-LF-RFD + W-MM-AH-RFD.
 21282
 21283     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21284     MOVE '0'                           TO  MR-CTL  X.
 21285     MOVE X TO LCP-ASA
 21286     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21287         THRU LCP-WRITE-END-MISMATCH-RPT.
 21288
 21289     MOVE 'TOT LF CLAIMS = '            TO  MD2-LF-PREM-DESC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 415
* ECS010V.cbl
 21290     MOVE 'TOT AH CLAIMS = '            TO  MD2-LF-ALT-PREM-DESC.
 21291     MOVE ' TOTAL CLAIMS   = '          TO  MD2-AH-PREM-DESC.
 21292
 21293     MOVE W-MM-LF-CLM                   TO MD2-LF-PREM.
 21294     MOVE W-MM-AH-CLM                   TO MD2-LF-ALT-PREM.
 21295     COMPUTE MD2-AH-PREM = W-MM-LF-CLM + W-MM-AH-CLM.
 21296
 21297     MOVE MISMATCH-DETAIL-2             TO  MISMATCH-RPT.
 21298     MOVE '0'                           TO  MR-CTL  X.
 21299     MOVE X TO LCP-ASA
 21300     PERFORM LCP-WRITE-POS-MISMATCH-RPT
 21301         THRU LCP-WRITE-END-MISMATCH-RPT.
 21302
 21303 9970-FIN-TOTS.
 21304
 21305     MOVE CMOT-CNT                TO TTL-PT-CNT.
 21306
 21307     IF ME-DO-UPDATE
 21308         MOVE CMOT-CNT           TO ME-010-CERT-OUT.
 21309
 21310     MOVE 'OUTPUT CERTIFICATE MASTER RECORDS' TO TTL-HD-DS.
 21311     MOVE TR-TTL-HD               TO PRT.
 21312     PERFORM 8800-PRINT-ROUTINE.
 21313
 21314     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-LOW.
 21315     MOVE CMOT-CNT                TO WS-ME50-BAL-AMT-HIGH.
 21316     MOVE WS-BAL50-DESCRIPTION    TO WS-ME50-BAL-DESCRIP.
 21317     WRITE ME50-ECS010-BALANCE-REC FROM WS-ME50-BALANCE-REC.
 21318
 21319     MOVE DE-CNT                  TO TTL-PT-CNT.
 21320     MOVE 'DETAIL EXTRACT RECORDS' TO TTL-HD-DS.
 21321     MOVE TR-TTL-HD               TO PRT.
 21322     PERFORM 8800-PRINT-ROUTINE.
 21323
 21324     MOVE EP-CNT                  TO TTL-PT-CNT.
 21325     MOVE 'SUMMARY EXTRACTS RECORDS' TO TTL-HD-DS.
 21326     MOVE TR-TTL-HD               TO PRT.
 21327     PERFORM 8800-PRINT-ROUTINE.
 21328     PERFORM 8800-PRINT-ROUTINE.
 21329
 21330     MOVE ERACCTT-READS           TO TTL-PT-CNT.
 21331     MOVE 'VSAM ACCOUNT MASTER FILE READS' TO TTL-HD-DS.
 21332     MOVE TR-TTL-HD               TO PRT.
 21333     PERFORM 8800-PRINT-ROUTINE.
 21334
 21335     MOVE ERRTBL-READS            TO TTL-PT-CNT.
 21336     MOVE 'VSAM REINSURANCE TABLE FILE READS' TO TTL-HD-DS.
 21337     MOVE TR-TTL-HD               TO PRT.
 21338     PERFORM 8800-PRINT-ROUTINE.
 21339
 21340     MOVE ERCTBL-READS            TO TTL-PT-CNT.
 21341     MOVE 'VSAM COMMISSION TABLE FILE READS' TO TTL-HD-DS.
 21342     MOVE TR-TTL-HD               TO PRT.
 21343     PERFORM 8800-PRINT-ROUTINE.
 21344
 21345     IF  DTE-OPT-RESERVE-METHOD-UNAUTH
 21346         GO TO 9990-FINAL-CLOSE.
 21347
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 416
* ECS010V.cbl
 21348**** MOST OF THE LINES WRITTEN BELOW ARE USED TO VERIFY
 21349**** REPORT TOTALS, ETC, THAT CANNOT BE VERIFIED ANY OTHER
 21350**** WAY.  MOST OF THESE FIELDS WILL BE DELETED WHEN ALL
 21351**** PILOT COMPANIES HAVE BEEN SUCCESSFULLY PROCESSED.
 21352
 21353     MOVE W-POLICY-ACTIVE-CTR     TO TTL-PT-CNT.
 21354     MOVE 'ACTIVE POLICIES'       TO TTL-HD-DS.
 21355     MOVE TR-TTL-HD               TO PRT.
 21356     PERFORM 8800-PRINT-ROUTINE.
 21357
 21358     MOVE W-POLICY-INACTIVE-CTR   TO TTL-PT-CNT.
 21359     MOVE 'INACTIVE POLICIES'     TO TTL-HD-DS.
 21360     MOVE TR-TTL-HD               TO PRT.
 21361     PERFORM 8800-PRINT-ROUTINE.
 21362
 21363     MOVE W-POLICY-REISSUE-CTR    TO TTL-PT-CNT.
 21364     MOVE 'REISSUE POLICIES'      TO TTL-HD-DS.
 21365     MOVE TR-TTL-HD               TO PRT.
 21366     PERFORM 8800-PRINT-ROUTINE.
 21367
 21368     MOVE W-POLICY-REIN-CTR       TO TTL-PT-CNT.
 21369     MOVE 'REINSURANCE ONLY POLICIES' TO TTL-HD-DS.
 21370     MOVE TR-TTL-HD               TO PRT.
 21371     PERFORM 8800-PRINT-ROUTINE.
 21372
 21373     MOVE W-POL-ISSUES            TO TTL-PT-CNT.
 21374     MOVE 'ISSUE TRANSACTIONS'    TO TTL-HD-DS.
 21375     MOVE TR-TTL-HD               TO PRT.
 21376     PERFORM 8800-PRINT-ROUTINE.
 21377
 21378     MOVE W-AH-ISSUES             TO TTL-PT-CNT.
 21379     MOVE 'AH ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21380     MOVE TR-TTL-HD               TO PRT.
 21381     PERFORM 8800-PRINT-ROUTINE.
 21382
 21383     MOVE W-LF-ISSUES             TO TTL-PT-CNT.
 21384     MOVE 'LF ISSUE TRANSACTIONS' TO TTL-HD-DS.
 21385     MOVE TR-TTL-HD               TO PRT.
 21386     PERFORM 8800-PRINT-ROUTINE.
 21387
 21388     MOVE W-PENDING-CLMS          TO TTL-PT-CNT.
 21389     MOVE 'CLAIM TRANSACTIONS'    TO TTL-HD-DS.
 21390     MOVE TR-TTL-HD               TO PRT.
 21391     PERFORM 8800-PRINT-ROUTINE.
 21392
 21393     MOVE W-AH-CLAIMS             TO TTL-PT-CNT.
 21394     MOVE 'AH CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21395     MOVE TR-TTL-HD               TO PRT.
 21396     PERFORM 8800-PRINT-ROUTINE.
 21397
 21398     MOVE W-LF-CLAIMS             TO TTL-PT-CNT.
 21399     MOVE 'LF CLAIMS TRANSACTIONS' TO TTL-HD-DS.
 21400     MOVE TR-TTL-HD               TO PRT.
 21401     PERFORM 8800-PRINT-ROUTINE.
 21402
 21403     MOVE W-AH-RESERVES           TO TTL-PT-CNT.
 21404     MOVE 'AH RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21405     MOVE TR-TTL-HD               TO PRT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 417
* ECS010V.cbl
 21406     PERFORM 8800-PRINT-ROUTINE.
 21407
 21408     MOVE W-LF-RESERVES           TO TTL-PT-CNT.
 21409     MOVE 'LF RESERVES TRANSACTIONS' TO TTL-HD-DS.
 21410     MOVE TR-TTL-HD               TO PRT.
 21411     PERFORM 8800-PRINT-ROUTINE.
 21412
 21413     MOVE W-AH-ACTIVE             TO TTL-PT-CNT.
 21414     MOVE 'AH RECORDS ACTIVE '    TO TTL-HD-DS.
 21415     MOVE TR-TTL-HD               TO PRT.
 21416     PERFORM 8800-PRINT-ROUTINE.
 21417
 21418     MOVE W-AH-INACTIVE           TO TTL-PT-CNT.
 21419     MOVE 'AH RECORDS INACTIVE'   TO TTL-HD-DS.
 21420     MOVE TR-TTL-HD               TO PRT.
 21421     PERFORM 8800-PRINT-ROUTINE.
 21422
 21423     MOVE W-AH-REISSUE            TO TTL-PT-CNT.
 21424     MOVE 'AH REISSUE REJECTS'    TO TTL-HD-DS.
 21425     MOVE TR-TTL-HD               TO PRT.
 21426     PERFORM 8800-PRINT-ROUTINE.
 21427
 21428     MOVE W-AH-REIN               TO TTL-PT-CNT.
 21429     MOVE 'AH REIN ONLY      '    TO TTL-HD-DS.
 21430     MOVE TR-TTL-HD               TO PRT.
 21431     PERFORM 8800-PRINT-ROUTINE.
 21432
 21433     MOVE W-AH-CALC-B             TO TTL-PT-CNT.
 21434     MOVE 'AH CALC B REJECTS'     TO TTL-HD-DS.
 21435     MOVE TR-TTL-HD               TO PRT.
 21436     PERFORM 8800-PRINT-ROUTINE.
 21437
 21438     MOVE W-AHTYP-99              TO TTL-PT-CNT.
 21439     MOVE 'AH TYPE CHANGED TO 99' TO TTL-HD-DS.
 21440     MOVE TR-TTL-HD               TO PRT.
 21441     PERFORM 8800-PRINT-ROUTINE.
 21442
 21443     MOVE W-ORGTRM-0-AH           TO TTL-PT-CNT.
 21444     MOVE 'AH ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21445     MOVE TR-TTL-HD               TO PRT.
 21446     PERFORM 8800-PRINT-ROUTINE.
 21447
 21448     MOVE W-RET-CODE-AH           TO TTL-PT-CNT.
 21449     MOVE 'AH RET CODE TERM = 0 ' TO TTL-HD-DS.
 21450     MOVE TR-TTL-HD               TO PRT.
 21451     PERFORM 8800-PRINT-ROUTINE.
 21452
 21453     MOVE W-AH-REMTERM-0          TO TTL-PT-CNT.
 21454     MOVE 'AH REMAINING TERM = 0' TO TTL-HD-DS.
 21455     MOVE TR-TTL-HD               TO PRT.
 21456     PERFORM 8800-PRINT-ROUTINE.
 21457
 21458     MOVE W-AH-DATA-USED          TO TTL-PT-CNT.
 21459     MOVE 'AH RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21460     MOVE TR-TTL-HD               TO PRT.
 21461     PERFORM 8800-PRINT-ROUTINE.
 21462
 21463     MOVE W-LF-ACTIVE             TO TTL-PT-CNT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 418
* ECS010V.cbl
 21464     MOVE 'LF RECORDS ACTIVE '    TO TTL-HD-DS.
 21465     MOVE TR-TTL-HD               TO PRT.
 21466     PERFORM 8800-PRINT-ROUTINE.
 21467
 21468     MOVE W-LF-INACTIVE           TO TTL-PT-CNT.
 21469     MOVE 'LF RECORDS INACTIVE'   TO TTL-HD-DS.
 21470     MOVE TR-TTL-HD               TO PRT.
 21471     PERFORM 8800-PRINT-ROUTINE.
 21472
 21473     MOVE W-LF-BALLOON            TO TTL-PT-CNT.
 21474     MOVE 'LF BALLOON REJECTS'    TO TTL-HD-DS.
 21475     MOVE TR-TTL-HD               TO PRT.
 21476     PERFORM 8800-PRINT-ROUTINE.
 21477
 21478     MOVE W-LF-REISSUE            TO TTL-PT-CNT.
 21479     MOVE 'LF REISSUE REJECTS'    TO TTL-HD-DS.
 21480     MOVE TR-TTL-HD               TO PRT.
 21481     PERFORM 8800-PRINT-ROUTINE.
 21482
 21483     MOVE W-LF-REIN               TO TTL-PT-CNT.
 21484     MOVE 'LF REIN ONLY      '    TO TTL-HD-DS.
 21485     MOVE TR-TTL-HD               TO PRT.
 21486     PERFORM 8800-PRINT-ROUTINE.
 21487
 21488     MOVE W-LF-CALC-B             TO TTL-PT-CNT.
 21489     MOVE 'LF CALC B REJECTS'     TO TTL-HD-DS.
 21490     MOVE TR-TTL-HD               TO PRT.
 21491     PERFORM 8800-PRINT-ROUTINE.
 21492
 21493     MOVE W-ORGTRM-0-LF           TO TTL-PT-CNT.
 21494     MOVE 'LF ORIGINAL TERM = 0 ' TO TTL-HD-DS.
 21495     MOVE TR-TTL-HD               TO PRT.
 21496     PERFORM 8800-PRINT-ROUTINE.
 21497
 21498     MOVE W-RET-CODE-LF           TO TTL-PT-CNT.
 21499     MOVE 'LF RET CODE TERM = 0 ' TO TTL-HD-DS.
 21500     MOVE TR-TTL-HD               TO PRT.
 21501     PERFORM 8800-PRINT-ROUTINE.
 21502
 21503     MOVE W-LF-REMTERM-0          TO TTL-PT-CNT.
 21504     MOVE 'LF REMTERM = 0 REJECTS' TO TTL-HD-DS.
 21505     MOVE TR-TTL-HD               TO PRT.
 21506     PERFORM 8800-PRINT-ROUTINE.
 21507
 21508     MOVE W-LF-REMAMT-0           TO TTL-PT-CNT.
 21509     MOVE 'LF REMAMT = 0 REJECTS' TO TTL-HD-DS.
 21510     MOVE TR-TTL-HD               TO PRT.
 21511     PERFORM 8800-PRINT-ROUTINE.
 21512
 21513     MOVE W-LFTYP-99              TO TTL-PT-CNT.
 21514     MOVE 'LF TYPE CHANGED TO 99' TO TTL-HD-DS.
 21515     MOVE TR-TTL-HD               TO PRT.
 21516     PERFORM 8800-PRINT-ROUTINE.
 21517
 21518     MOVE W-LF-DATA-USED          TO TTL-PT-CNT.
 21519     MOVE 'LF RECORDS ACCEPTED DURING PROCESSING' TO TTL-HD-DS.
 21520     MOVE TR-TTL-HD               TO PRT.
 21521     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 419
* ECS010V.cbl
 21522
 21523     MOVE W-EPEC-EP-IN            TO TTL-PT-CNT.
 21524     MOVE 'AH EARNED PREMIUM LAST 90 DAYS - DET ' TO TTL-HD-DS.
 21525     MOVE TR-TTL-HD               TO PRT.
 21526     PERFORM 8800-PRINT-ROUTINE.
 21527
 21528     MOVE W-EPEC-EP               TO TTL-PT-CNT.
 21529     MOVE 'AH EARNED PREMIUM LAST 90 DAYS       ' TO TTL-HD-DS.
 21530     MOVE TR-TTL-HD               TO PRT.
 21531     PERFORM 8800-PRINT-ROUTINE.
 21532
 21533     MOVE W-EPEC-EP-2             TO TTL-PT-CNT.
 21534     MOVE 'AH EARNED PREMIUM 90 DAYS AGO        ' TO TTL-HD-DS.
 21535     MOVE TR-TTL-HD               TO PRT.
 21536     PERFORM 8800-PRINT-ROUTINE.
 21537
 21538     MOVE W-EP-LESS-THAN-0        TO TTL-PT-CNT.
 21539     MOVE 'AH RECORDS WITH 90 DAY EP < +0       ' TO TTL-HD-DS.
 21540     MOVE TR-TTL-HD               TO PRT.
 21541     PERFORM 8800-PRINT-ROUTINE.
 21542
 21543     MOVE W-EPEC-EP-1             TO TTL-PT-CNT.
 21544     MOVE 'AH EARNED PREMIUM TODAY              ' TO TTL-HD-DS.
 21545     MOVE TR-TTL-HD               TO PRT.
 21546     PERFORM 8800-PRINT-ROUTINE.
 21547
 21548     MOVE W-AH-CLAIM-CTR          TO TTL-PT-CNT.
 21549     MOVE 'AH COVERAGES WITH QUALIFIED CLAIMS'
 21550                                  TO TTL-HD-DS.
 21551     MOVE TR-TTL-HD               TO PRT.
 21552     PERFORM 8800-PRINT-ROUTINE.
 21553
 21554     MOVE W-AH-CLAIM-EP           TO TTL-PT-CNT.
 21555     MOVE 'AH EARNED PREM WITH QUALIFIED CLAIMS'
 21556                                  TO TTL-HD-DS.
 21557     MOVE TR-TTL-HD               TO PRT.
 21558     PERFORM 8800-PRINT-ROUTINE.
 21559
 21560     MOVE W-CLAIMS-MADE-PAID-IN   TO TTL-PT-CNT.
 21561     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS- DET'
 21562                                  TO TTL-HD-DS.
 21563     MOVE TR-TTL-HD               TO PRT.
 21564     PERFORM 8800-PRINT-ROUTINE.
 21565
 21566     MOVE W-CLAIMS-MADE-PAID      TO TTL-PT-CNT.
 21567     MOVE 'AH CLAIMS MADE AND PAID LAST 90 DAYS'
 21568                                  TO TTL-HD-DS.
 21569     MOVE TR-TTL-HD               TO PRT.
 21570     PERFORM 8800-PRINT-ROUTINE.
 21571
 21572     MOVE W-CLM-EXCEPT-CNT        TO TTL-PT-CNT.
 21573     MOVE 'AH CLAIMS CALCD. USING ITD AMOUNT'
 21574                                  TO TTL-HD-DS.
 21575     MOVE TR-TTL-HD               TO PRT.
 21576     PERFORM 8800-PRINT-ROUTINE.
 21577
 21578     MOVE W-CLM-EXCEPT-AMT        TO TTL-PT-CNT.
 21579     MOVE 'AH CLAIMS AMT USING ITD AMOUNT'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 420
* ECS010V.cbl
 21580                                  TO TTL-HD-DS.
 21581     MOVE TR-TTL-HD               TO PRT.
 21582     PERFORM 8800-PRINT-ROUTINE.
 21583
 21584     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21585     MOVE 'A&H IBNR-1'            TO TTL-HD-DS.
 21586     MOVE TR-TTL-HD               TO PRT.
 21587     PERFORM 8800-PRINT-ROUTINE.
 21588
 21589     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21590     MOVE 'A&H IBNR-2'            TO TTL-HD-DS.
 21591     MOVE TR-TTL-HD               TO PRT.
 21592     PERFORM 8800-PRINT-ROUTINE.
 21593
 21594     MOVE W-LIFE-IBNR-IN          TO TTL-PT-CNT.
 21595     MOVE 'LIFE IBNR - DETAIL'    TO TTL-HD-DS.
 21596     MOVE TR-TTL-HD               TO PRT.
 21597     PERFORM 8800-PRINT-ROUTINE.
 21598
 21599     MOVE W-LIFE-IBNR             TO TTL-PT-CNT.
 21600     MOVE 'LIFE IBNR'             TO TTL-HD-DS.
 21601     MOVE TR-TTL-HD               TO PRT.
 21602     PERFORM 8800-PRINT-ROUTINE.
 21603
 21604     MOVE W-LIFE-REMAINING-AMT    TO TTL-PT-CNT.
 21605     MOVE 'LIFE REMAINING-AMT '   TO TTL-HD-DS.
 21606     MOVE TR-TTL-HD               TO PRT.
 21607     PERFORM 8800-PRINT-ROUTINE.
 21608
 21609     MOVE W-01-REMAMT             TO TTL-PT-CNT.
 21610     MOVE '01 REMAINING-AMT '     TO TTL-HD-DS.
 21611     MOVE TR-TTL-HD               TO PRT.
 21612     PERFORM 8800-PRINT-ROUTINE.
 21613
 21614     MOVE W-01-DATA-USED          TO TTL-PT-CNT.
 21615     MOVE '01 CERT COUNT    '     TO TTL-HD-DS.
 21616     MOVE TR-TTL-HD               TO PRT.
 21617     PERFORM 8800-PRINT-ROUTINE.
 21618
 21619     MOVE W-02-REMAMT             TO TTL-PT-CNT.
 21620     MOVE '02 REMAINING-AMT '     TO TTL-HD-DS.
 21621     MOVE TR-TTL-HD               TO PRT.
 21622     PERFORM 8800-PRINT-ROUTINE.
 21623
 21624     MOVE W-02-DATA-USED          TO TTL-PT-CNT.
 21625     MOVE '02 CERT COUNT    '     TO TTL-HD-DS.
 21626     MOVE TR-TTL-HD               TO PRT.
 21627     PERFORM 8800-PRINT-ROUTINE.
 21628
 21629     MOVE W-03-REMAMT             TO TTL-PT-CNT.
 21630     MOVE '03 REMAINING-AMT '     TO TTL-HD-DS.
 21631     MOVE TR-TTL-HD               TO PRT.
 21632     PERFORM 8800-PRINT-ROUTINE.
 21633
 21634     MOVE W-03-DATA-USED          TO TTL-PT-CNT.
 21635     MOVE '03 CERT COUNT    '     TO TTL-HD-DS.
 21636     MOVE TR-TTL-HD               TO PRT.
 21637     PERFORM 8800-PRINT-ROUTINE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 421
* ECS010V.cbl
 21638
 21639     MOVE W-04-REMAMT             TO TTL-PT-CNT.
 21640     MOVE '04 REMAINING-AMT '     TO TTL-HD-DS.
 21641     MOVE TR-TTL-HD               TO PRT.
 21642     PERFORM 8800-PRINT-ROUTINE.
 21643
 21644     MOVE W-04-DATA-USED          TO TTL-PT-CNT.
 21645     MOVE '04 CERT COUNT    '     TO TTL-HD-DS.
 21646     MOVE TR-TTL-HD               TO PRT.
 21647     PERFORM 8800-PRINT-ROUTINE.
 21648
 21649     MOVE W-05-REMAMT             TO TTL-PT-CNT.
 21650     MOVE '05 REMAINING-AMT '     TO TTL-HD-DS.
 21651     MOVE TR-TTL-HD               TO PRT.
 21652     PERFORM 8800-PRINT-ROUTINE.
 21653
 21654     MOVE W-05-DATA-USED          TO TTL-PT-CNT.
 21655     MOVE '05 CERT COUNT    '     TO TTL-HD-DS.
 21656     MOVE TR-TTL-HD               TO PRT.
 21657     PERFORM 8800-PRINT-ROUTINE.
 21658
 21659     MOVE W-06-REMAMT             TO TTL-PT-CNT.
 21660     MOVE '06 REMAINING-AMT '     TO TTL-HD-DS.
 21661     MOVE TR-TTL-HD               TO PRT.
 21662     PERFORM 8800-PRINT-ROUTINE.
 21663
 21664     MOVE W-06-DATA-USED          TO TTL-PT-CNT.
 21665     MOVE '06 CERT COUNT    '     TO TTL-HD-DS.
 21666     MOVE TR-TTL-HD               TO PRT.
 21667     PERFORM 8800-PRINT-ROUTINE.
 21668
 21669     MOVE W-30-REMAMT             TO TTL-PT-CNT.
 21670     MOVE '30 REMAINING-AMT '     TO TTL-HD-DS.
 21671     MOVE TR-TTL-HD               TO PRT.
 21672     PERFORM 8800-PRINT-ROUTINE.
 21673
 21674     MOVE W-30-DATA-USED          TO TTL-PT-CNT.
 21675     MOVE '30 CERT COUNT    '     TO TTL-HD-DS.
 21676     MOVE TR-TTL-HD               TO PRT.
 21677     PERFORM 8800-PRINT-ROUTINE.
 21678
 21679     MOVE W-31-REMAMT             TO TTL-PT-CNT.
 21680     MOVE '31 REMAINING-AMT '     TO TTL-HD-DS.
 21681     MOVE TR-TTL-HD               TO PRT.
 21682     PERFORM 8800-PRINT-ROUTINE.
 21683
 21684     MOVE W-31-DATA-USED          TO TTL-PT-CNT.
 21685     MOVE '31 CERT COUNT    '     TO TTL-HD-DS.
 21686     MOVE TR-TTL-HD               TO PRT.
 21687     PERFORM 8800-PRINT-ROUTINE.
 21688
 21689     MOVE W-XX-REMAMT             TO TTL-PT-CNT.
 21690     MOVE 'XX REMAINING-AMT '     TO TTL-HD-DS.
 21691     MOVE TR-TTL-HD               TO PRT.
 21692     PERFORM 8800-PRINT-ROUTINE.
 21693
 21694     MOVE W-XX-DATA-USED          TO TTL-PT-CNT.
 21695     MOVE 'XX CERT COUNT    '     TO TTL-HD-DS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 422
* ECS010V.cbl
 21696     MOVE TR-TTL-HD               TO PRT.
 21697     PERFORM 8800-PRINT-ROUTINE.
 21698
 21699     MOVE W-1-EP                  TO TTL-PT-CNT.
 21700     MOVE 'TYPE 1 EP        '     TO TTL-HD-DS.
 21701     MOVE TR-TTL-HD               TO PRT.
 21702     PERFORM 8800-PRINT-ROUTINE.
 21703
 21704     MOVE W-P-EP                  TO TTL-PT-CNT.
 21705     MOVE 'TYPE P EP        '     TO TTL-HD-DS.
 21706     MOVE TR-TTL-HD               TO PRT.
 21707     PERFORM 8800-PRINT-ROUTINE.
 21708
 21709     MOVE W-M-EP                  TO TTL-PT-CNT.
 21710     MOVE 'TYPE M EP        '     TO TTL-HD-DS.
 21711     MOVE TR-TTL-HD               TO PRT.
 21712     PERFORM 8800-PRINT-ROUTINE.
 21713
 21714     MOVE W-R-EP                  TO TTL-PT-CNT.
 21715     MOVE 'TYPE R EP        '     TO TTL-HD-DS.
 21716     MOVE TR-TTL-HD               TO PRT.
 21717     PERFORM 8800-PRINT-ROUTINE.
 21718
 21719     MOVE W-WY-EP                 TO TTL-PT-CNT.
 21720     MOVE 'EP FOR STATE WY  '     TO TTL-HD-DS.
 21721     MOVE TR-TTL-HD               TO PRT.
 21722     PERFORM 8800-PRINT-ROUTINE.
 21723
 21724     MOVE W-VA-EP                 TO TTL-PT-CNT.
 21725     MOVE 'EP FOR STATE VA  '     TO TTL-HD-DS.
 21726     MOVE TR-TTL-HD               TO PRT.
 21727     PERFORM 8800-PRINT-ROUTINE.
 21728
 21729     MOVE W-OTHERS-COUNT          TO TTL-PT-CNT.
 21730     MOVE 'AH COUNT OF OTHERS'    TO TTL-HD-DS.
 21731     MOVE TR-TTL-HD               TO PRT.
 21732     PERFORM 8800-PRINT-ROUTINE.
 21733
 21734     MOVE W-RTRM-0-CLMAMT         TO TTL-PT-CNT.
 21735     MOVE 'CLM AMT OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21736     MOVE TR-TTL-HD               TO PRT.
 21737     PERFORM 8800-PRINT-ROUTINE.
 21738
 21739     MOVE W-RTRM-EP-1             TO TTL-PT-CNT.
 21740     MOVE 'EP1 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21741     MOVE TR-TTL-HD               TO PRT.
 21742     PERFORM 8800-PRINT-ROUTINE.
 21743
 21744     MOVE W-RTRM-EP-2             TO TTL-PT-CNT.
 21745     MOVE 'EP2 OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21746     MOVE TR-TTL-HD               TO PRT.
 21747     PERFORM 8800-PRINT-ROUTINE.
 21748
 21749     MOVE W-RTRM-EP               TO TTL-PT-CNT.
 21750     MOVE 'EP OF THOSE CERTS WITH RTRM=0'    TO TTL-HD-DS.
 21751     MOVE TR-TTL-HD               TO PRT.
 21752     PERFORM 8800-PRINT-ROUTINE.
 21753
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 423
* ECS010V.cbl
 21754     MOVE W-AH-IBNR-1             TO TTL-PT-CNT.
 21755     MOVE 'IBNR1 FROM EQUATION 1' TO TTL-HD-DS.
 21756     MOVE TR-TTL-HD               TO PRT.
 21757     PERFORM 8800-PRINT-ROUTINE.
 21758
 21759     MOVE W-AH-IBNR-1-CNT         TO TTL-PT-CNT.
 21760     MOVE 'REC CNT FROM EQUATION 1' TO TTL-HD-DS.
 21761     MOVE TR-TTL-HD               TO PRT.
 21762     PERFORM 8800-PRINT-ROUTINE.
 21763
 21764     MOVE W-AH-IBNR-2             TO TTL-PT-CNT.
 21765     MOVE 'IBNR2 FROM EQUATION 2' TO TTL-HD-DS.
 21766     MOVE TR-TTL-HD               TO PRT.
 21767     PERFORM 8800-PRINT-ROUTINE.
 21768
 21769     MOVE W-AH-IBNR-2-CNT         TO TTL-PT-CNT.
 21770     MOVE 'REC CNT FROM EQUATION 2' TO TTL-HD-DS.
 21771     MOVE TR-TTL-HD               TO PRT.
 21772     PERFORM 8800-PRINT-ROUTINE.
 21773
 21774 9990-FINAL-CLOSE.
*21775                             COPY ELCPRTC.
 21776******************************************************************04/15/98
 21777*                                                                *ELCPRTC
 21778*                                                                *ELCPRTC
 21779*                            ELCPRTC.                            *   LV003
 21780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21781*                            VMOD=2.002                          *   CL**2
 21782*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
 21783*                                                                *ELCPRTC
 21784* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
 21785******************************************************************ELCPRTC
 21786                                                                  ELCPRTC
 21787      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
 21788          CLOSE FICH.                                             ELCPRTC
 21789                                                                  ELCPRTC
 21790******************************************************************ELCPRTC
 21791
 21792     IF DTE-CLIENT = 'DMD'
 21793         CLOSE ERRESC-IN.
 21794
 21795     PERFORM 8600-DISPLAY-HD   THRU  8600-HD-EXIT.
 21796
 21797     DISPLAY ' '.
 21798     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21799     DISPLAY ' DISPLAY ERROR COUNT = '  ERROR-COUNT.
 21800     DISPLAY '* * * * * * * * * * * * * * * * * *'.
 21801     DISPLAY ' '.
 21802
 21803     MOVE    ' DISPLAY ERROR COUNT = '
 21804       TO  DIS-LINE-REASON.
 21805     MOVE  ERROR-COUNT
 21806       TO  DIS-LINE-REC.
 21807         PERFORM 8600-DISPLAY-PRT  THRU  8600-DISPLAY-EXIT.
 21808
 21809     CLOSE ERACCTT-IN  CERT-MASTER-IN  PRINT-COPY  MISMATCH-REPORT
 21810           DISPLAY-PRT
 21811           ME-ECS010-BALANCE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 424
* ECS010V.cbl
 21812           ME50-ECS010-BALANCE
 21813           PENDING-EXTRACT  SUMMARY-EXTR.
 21814
 21815     IF DTE-PGM-OPT = '1'
 21816         CLOSE CERT-MASTER-OUT
 21817               DETAIL-EXTR.
 21818
 21819     IF ERACCTT-FILE-STATUS NOT = '00'
 21820         MOVE '12'                TO ABEND-CODE-1
 21821         MOVE ERACCTT-FILE-STATUS TO ABEND-CODE-2
 21822         DISPLAY '******************************'
 21823         DISPLAY '***** ERROR LOCATION 027 *****'
 21824         DISPLAY '******************************'
 21825         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21826           GO TO ABEND-PGM.
 21827
 21828     IF COMM-OPEN-SW = 'X'
 21829         CLOSE ERCTBL
 21830         IF ERCTBL-FILE-STATUS NOT = '00'
 21831             MOVE '42'               TO ABEND-CODE-1
 21832             MOVE ERCTBL-FILE-STATUS TO ABEND-CODE-2
 21833             DISPLAY '******************************'
 21834             DISPLAY '***** ERROR LOCATION 028 *****'
 21835             DISPLAY '******************************'
 21836             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21837             GO TO ABEND-PGM.
 21838
 21839     IF REIN-OPEN-SW = 'X'
 21840         CLOSE ERRTBL-IN
 21841         IF ERRTBL-FILE-STATUS NOT = '00'
 21842             MOVE '22'               TO ABEND-CODE-1
 21843             MOVE ERRTBL-FILE-STATUS TO ABEND-CODE-2
 21844             DISPLAY '******************************'
 21845             DISPLAY '***** ERROR LOCATION 029 *****'
 21846             DISPLAY '******************************'
 21847             MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21848             GO TO ABEND-PGM.
 21849
 21850     MOVE 'C'                         TO CP-IO-FUNCTION.
 21851     PERFORM 8100-GET-RATE THRU 8199-GET-RATE-X.
 21852     IF IO-ERROR
 21853         MOVE 'ERROR OCCURED CLOSING - ELRATE'
 21854                                      TO WS-ABEND-MESSAGE
 21855         MOVE 0302                    TO WS-RETURN-CODE
 21856         DISPLAY '******************************'
 21857         DISPLAY '***** ERROR LOCATION 030 *****'
 21858         DISPLAY '******************************'
 21859         MOVE WS-ABEND-CODE        TO WS-RETURN-CODE
 21860         GO TO ABEND-PGM.
 21861
 21862     IF ME-DO-UPDATE
 21863           MOVE ME-START-TIME        TO ME-010-START
*  12-S***************************************************             ( 282)**
**    Operand ME-010-START is not declared
 21864           MOVE ME-CNDS-DATE         TO ME-010-RUN-DT
 21865           ACCEPT WS-TIME-OF-DAY   FROM TIME
 21866           MOVE WS-TIME              TO ME-010-END
*  12-S*************************************************               ( 424)**
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 425
* ECS010V.cbl
**    Operand ME-010-END is not declared
 21867           ADD 1 TO ME-010-RUN-CT
 21868           REWRITE MONTH-END-BALANCES
 21869           DISPLAY 'MONTH-END BALANCES POSTED'
 21870           CLOSE ERMEBL-INOUT
 21871     ELSE
 21872         DISPLAY 'MONTH-END BALANCES NOT POSTED'.
 21873
 21874     GO TO 9999-END-THE-JOB.
 21875
 21876 CERT-DATE-LOAD.
*21877     COPY ELCCRTM1.
 21878******************************************************************04/15/98
 21879*                                                                *ELCCRTM1
 21880*                                                                *ELCCRTM1
 21881*                            ELCCRTM1                            *   LV003
 21882*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 21883*                            VMOD=2.001                          *ELCCRTM1
 21884*                                                                *ELCCRTM1
 21885*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
 21886*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
 21887*                                                                *ELCCRTM1
 21888******************************************************************ELCCRTM1
 21889     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
 21890     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
 21891     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
 21892     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
 21893     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
 21894     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
 21895     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
 21896     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
 21897     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
 21898                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
 21899     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
 21900                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
 21901     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
 21902     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
 21903     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
 21904     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
 21905     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
 21906     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
 21907           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
 21908                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
 21909     END-PERFORM.                                                 ELCCRTM1
 21910                                                                  ELCCRTM1
 21911
 21912 EXTRACT-DATE-LOAD.
*21913     COPY ELCEXTM1.
 21914******************************************************************04/15/98
 21915*                                                                *ELCEXTM1
 21916*                                                                *ELCEXTM1
 21917*                            ELCEXTM1                            *   LV010
 21918*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*10
 21919*                            VMOD=2.001                          *ELCEXTM1
 21920*                                                                *ELCEXTM1
 21921*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEXTM1
 21922*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM1
 21923*                                                                *ELCEXTM1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 426
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEXTM1)
 21924******************************************************************ELCEXTM1
 21925                                                                  ELCEXTM1
 21926     MOVE DE-EFF                     TO  WS-DE-EFF-N.                CL**9
 21927     MOVE DE-LF-CANC-DTE             TO  WS-DE-LF-CANC-DTE-N.        CL**9
 21928     MOVE DE-LF-CANC-EXIT-DT         TO  WS-DE-LF-CANC-EXIT-DT-N.    CL**9
 21929     MOVE DE-AH-CANC-DTE             TO  WS-DE-AH-CANC-DTE-N.        CL**9
 21930     MOVE DE-AH-CANC-EXIT-DT         TO  WS-DE-AH-CANC-EXIT-DT-N.    CL**9
 21931     MOVE DE-ENTRY-DTE               TO  WS-DE-ENTRY-DTE-N.          CL**9
 21932                                                                     CL**9
 21933     EVALUATE TRUE                                                   CL**5
 21934        WHEN DE-ISSUE      OR                                        CL**8
 21935             DE-RC-ISSUE   OR                                        CL**8
 21936             DE-RR-RC-ISS  OR                                        CL**8
 21937             DE-CANCEL     OR                                        CL**8
 21938             DE-RC-CANCEL  OR                                        CL**8
 21939             DE-RR-RC-CNC                                            CL**8
 21940           MOVE DE-PROC-DT           TO  WS-DE-PROC-DT-N             CL**9
 21941                                                                     CL**9
 21942        WHEN DE-CLAIM      OR                                        CL**8
 21943             DE-RR-RC-CLM                                            CL**6
 21944           MOVE DE-INCUR             TO  WS-DE-INCUR-N               CL**9
 21945           MOVE DE-PAY               TO  WS-DE-PAY-N                 CL**9
 21946           MOVE DE-PAID-TO           TO  WS-DE-PAID-TO-N             CL**9
 21947           MOVE DE-ACC-EXP-DTE       TO  WS-DE-ACC-EXP-DTE-N         CL**9
 21948           MOVE DE-ACC-EFF-DTE       TO  WS-DE-ACC-EFF-DTE-N         CL**9
 21949           MOVE DE-CLM-PROC-DT       TO  WS-DE-CLM-PROC-DT-N         CL**9
 21950                                                                     CL**9
 21951        WHEN DE-RESERVE                                              CL**9
 21952           MOVE DE-RSV-INCUR         TO  WS-DE-RSV-INCUR-N           CL**9
 21953           MOVE DE-RSV-PAYTO         TO  WS-DE-RSV-PAYTO-N           CL**9
 21954           MOVE DE-ACC-EXP-DTE-RSV                                   CL**5
 21955                                     TO  WS-DE-ACC-EXP-DTE-RSV-N     CL**9
 21956           MOVE DE-ACC-EFF-DTE-RSV                                   CL**9
 21957                                     TO  WS-DE-ACC-EFF-DTE-RSV-N     CL**9
 21958           MOVE DE-RSV-PROC-DT       TO  WS-DE-RSV-PROC-DT-N         CL**9
 21959     END-EVALUATE.                                                   CL**9
 21960                                                                     CL**9
 21961
 21962 EXTRACT-DATE-RELOAD.
*21963     COPY ELCEXTM2.
 21964******************************************************************04/15/98
 21965*                                                                *ELCEXTM2
 21966*                                                                *ELCEXTM2
 21967*                            ELCEXTM2                            *   LV011
 21968*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*11
 21969*                            VMOD=2.001                          *ELCEXTM2
 21970*                                                                *ELCEXTM2
 21971*   COPY WORKING STORAGE TO  FILE VARIABLES                      *ELCEXTM2
 21972*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEXTM2
 21973*                                                                *   CL**9
 21974******************************************************************ELCEXTM2
 21975                                                                  ELCEXTM2
 21976     MOVE WS-DE-EFF-N                TO  DE-EFF.                     CL*10
 21977     MOVE WS-DE-LF-CANC-DTE-N        TO  DE-LF-CANC-DTE.             CL*10
 21978     MOVE WS-DE-LF-CANC-EXIT-DT-N    TO  DE-LF-CANC-EXIT-DT.         CL*10
 21979     MOVE WS-DE-AH-CANC-DTE-N        TO  DE-AH-CANC-DTE.             CL*10
 21980     MOVE WS-DE-AH-CANC-EXIT-DT-N    TO  DE-AH-CANC-EXIT-DT.         CL*10
 21981     MOVE WS-DE-ENTRY-DTE-N          TO  DE-ENTRY-DTE.               CL*10
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 427
* ECS010V.cbl (/apps/prod/cid1p/copy/ELCEXTM2)
 21982                                                                     CL*10
 21983     EVALUATE TRUE                                                   CL*10
 21984        WHEN DE-ISSUE      OR                                        CL*10
 21985             DE-RC-ISSUE   OR                                        CL*10
 21986             DE-RR-RC-ISS  OR                                        CL*10
 21987             DE-CANCEL     OR                                        CL*10
 21988             DE-RC-CANCEL  OR                                        CL*10
 21989             DE-RR-RC-CNC                                            CL*10
 21990           MOVE WS-DE-PROC-DT-N      TO  DE-PROC-DT                  CL*10
 21991                                                                     CL*10
 21992        WHEN DE-CLAIM      OR                                        CL*10
 21993             DE-RR-RC-CLM                                            CL**7
 21994           MOVE WS-DE-INCUR-N        TO  DE-INCUR                    CL*10
 21995           MOVE WS-DE-PAY-N          TO  DE-PAY                      CL*10
 21996           MOVE WS-DE-PAID-TO-N      TO  DE-PAID-TO                  CL*10
 21997           MOVE WS-DE-ACC-EXP-DTE-N  TO  DE-ACC-EXP-DTE              CL*10
 21998           MOVE WS-DE-ACC-EFF-DTE-N  TO  DE-ACC-EFF-DTE              CL*10
 21999           MOVE WS-DE-CLM-PROC-DT-N  TO  DE-CLM-PROC-DT              CL*10
 22000                                                                     CL*10
 22001        WHEN DE-RESERVE                                              CL**7
 22002            MOVE WS-DE-RSV-INCUR-N   TO  DE-RSV-INCUR                CL*10
 22003            MOVE WS-DE-RSV-PAYTO-N   TO  DE-RSV-PAYTO                CL*10
 22004            MOVE WS-DE-ACC-EXP-DTE-RSV-N                             CL*10
 22005                                     TO  DE-ACC-EXP-DTE-RSV          CL*10
 22006            MOVE WS-DE-ACC-EFF-DTE-RSV-N                             CL**4
 22007                                     TO  DE-ACC-EFF-DTE-RSV          CL*10
 22008            MOVE WS-DE-RSV-PROC-DT-N TO  DE-RSV-PROC-DT              CL*10
 22009     END-EVALUATE.                                                   CL**5
 22010                                                                  ELCEXTM2
 22011
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 428
* ECS010V.cbl
 22013 ABEND-PGM.
 22014     DISPLAY '******************************'
 22015     DISPLAY '***** ABEND PGM **************'
 22016     DISPLAY '******************************'
*22017                             COPY ELCABEND.
 22018***************************************************************** 04/14/98
 22019*                                                               * ELCABEND
 22020*                            ELCABEND.                          *    LV003
 22021*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
 22022*                            VMOD 2.002                              CL**2
 22023*                                                               * ELCABEND
 22024*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
 22025*            AND THEN ABENDS.                                   * ELCABEND
 22026*                                                               * ELCABEND
 22027*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
 22028*                                                               * ELCABEND
 22029***************************************************************** ELCABEND
 22030*APS-010.                                                         ELCABEND
 22031     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
 22032     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
 22033                                                                  ELCABEND
 22034     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
 22035         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22036         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
 22037                                 UPON CONSOLE.                    ELCABEND
 22038                                                                  ELCABEND
 22039     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
 22040         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22041         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
 22042                                 UPON CONSOLE.                    ELCABEND
 22043                                                                  ELCABEND
 22044     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22045     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
 22046                                 UPON CONSOLE.                    ELCABEND
 22047                                                                  ELCABEND
 22048     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
 22049     CALL 'ABORTME'.
 22050                                                                  ELCABEND
 22051 APS-EXIT.                                                        ELCABEND
 22052     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 429
* ECS010V.cbl
 22054 9999-END-THE-JOB.
 22055
 22056     DISPLAY ' '.
 22057     DISPLAY '****** THE END OF MESSAGES CREATED BY '
 22058         'ECS010 ******'
 22059     DISPLAY ' '.
 22060     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 430
* ECS010V.cbl
 22061/
 22062 LCP-WRITE-POS-MISMATCH-RPT SECTION.
 22063     IF LCP-ASA = '+'
 22064         WRITE MISMATCH-RPT AFTER 0 LINE
 22065     ELSE
 22066     IF LCP-ASA = ' '
 22067         WRITE MISMATCH-RPT AFTER ADVANCING 1 LINE
 22068     ELSE
 22069     IF LCP-ASA = '0'
 22070         WRITE MISMATCH-RPT AFTER ADVANCING 2 LINE
 22071     ELSE
 22072     IF LCP-ASA = '-'
 22073         WRITE MISMATCH-RPT AFTER ADVANCING 3 LINE
 22074     ELSE
 22075     IF LCP-ASA = '1'
 22076         WRITE MISMATCH-RPT AFTER ADVANCING PAGE
 22077     ELSE
 22078     IF LCP-ASA = '2'
 22079         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH2
 22080     ELSE
 22081     IF LCP-ASA = '3'
 22082         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH3
 22083     ELSE
 22084     IF LCP-ASA = '4'
 22085         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH4
 22086     ELSE
 22087     IF LCP-ASA = '5'
 22088         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH5
 22089     ELSE
 22090     IF LCP-ASA = '6'
 22091         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH6
 22092     ELSE
 22093     IF LCP-ASA = '7'
 22094         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH7
 22095     ELSE
 22096     IF LCP-ASA = '8'
 22097         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH8
 22098     ELSE
 22099     IF LCP-ASA = '9'
 22100         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH9
 22101     ELSE
 22102     IF LCP-ASA = 'A'
 22103         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH10
 22104     ELSE
 22105     IF LCP-ASA = 'B'
 22106         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH11
 22107     ELSE
 22108     IF LCP-ASA = 'C'
 22109         WRITE MISMATCH-RPT AFTER ADVANCING LCP-CH12
 22110     ELSE
 22111     IF LCP-ASA = 'V'
 22112         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P01
 22113     ELSE
 22114     IF LCP-ASA = 'W'
 22115         WRITE MISMATCH-RPT AFTER ADVANCING LCP-P02
 22116     ELSE
 22117     DISPLAY 'ASA CODE ERROR'.
 22118 LCP-WRITE-END-MISMATCH-RPT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 431
* ECS010V.cbl
 22119     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  424
* Total Messages:    15
* Unrecoverable :     0                    Severe  :    12
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:     2176749     Code:           0
