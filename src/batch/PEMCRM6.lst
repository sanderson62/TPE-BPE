* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMCRM6.cbl
* Options: int("PEMCRM6.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMCRM6.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMCRM6.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"PEMCRM6.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                PEMCRM6.
     3*AUTHOR.     PABLO.
     4*REMARKS.
     5*     THIS PROGRAM READS THE RESV, MATCHES TO THE CERT, UPDATES
     6*       THE RESV AND WRITES OUT A NEW RESV
     7 ENVIRONMENT DIVISION.
     8 INPUT-OUTPUT SECTION.
     9 FILE-CONTROL.
    10     SELECT RESV-IN              ASSIGN TO SYS010.
    11
    12     SELECT CERT-IN              ASSIGN TO SYS011.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMCRM6.cbl
    14     SELECT RESV-OUT             ASSIGN TO SYS013.
    15
    16 DATA DIVISION.
    17
    18 FILE SECTION.
    19
    20 FD  CERT-IN
    21     RECORDING MODE IS F
    22     LABEL RECORDS ARE STANDARD
    23     BLOCK CONTAINS 0 RECORDS.
    24
*   25                                COPY ECSCRT01.
    26******************************************************************
    27*                                                                *
    28*                            ECSCRT01                            *
    29*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    30*                            VMOD=2.016                          *
    31*                                                                *
    32*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
    33*                                                                *
    34*   FILE TYPE = SEQUENTIAL
    35*   RECORD SIZE = 1056 RECFORM = FIXED                           *
    36*                                                                *
    37*   KEY DATA =                         START=4, LEN=36           *
    38*                                                                *
    39*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
    40*                                                                *
    41******************************************************************
    42******************************************************************
    43*                   C H A N G E   L O G
    44*
    45* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    46*-----------------------------------------------------------------
    47*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    48* EFFECTIVE    NUMBER
    49*-----------------------------------------------------------------
    50* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
    51* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    52* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
    53* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
    54* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
    55* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
    56* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    57* 032612  CR2011110200001  PEMA  AHL CHANGES
    58* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    59* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
    60******************************************************************
    61
    62 01  CERTIFICATE-RECORD.
    63     12  CR-RECORD-ID                      PIC XX.
    64         88  VALID-CR-ID                      VALUE 'CR'.
    65
    66     12  CR-COMPANY-CD                     PIC X.
    67
    68     12  CR-FULL-CONTROL.
    69         16  CR-CONTROL-1.
    70             20  CR-ACCT-CONTROL.
    71                 24  CR-CARRIER            PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
    72                 24  CR-GROUPING.
    73                     28  CR-GROUP-PREFIX   PIC XXX.
    74                     28  CR-GROUP-PRIME    PIC XXX.
    75                 24  CR-STATE              PIC XX.
    76                 24  CR-ACCOUNT.
    77                     28  CR-ACCT-PREFIX    PIC X(4).
    78                     28  CR-ACCT-PRIME     PIC X(6).
    79             20  CR-DT                     PIC 9(11)  COMP-3.
    80         16  CR-CERT-NO.
    81             20  CR-CERT.
    82                 24  CR-CERT-PREFIX        PIC X(3).
    83                 24  CR-CERT-PRIME         PIC X(7).
    84             20  CR-CERT-SFX               PIC X.
    85
    86     12  CR-INSUREDS-PROFILE.
    87         16  CR-NAME.
    88             20  CR-LNAME                  PIC X(15).
    89             20  CR-FNAME.
    90                 24  CR-1ST-INITIAL        PIC X.
    91                 24  FILLER                PIC X(9).
    92             20  CR-INIT                   PIC X.
    93         16  CR-AGE                        PIC 99.
    94         16  CR-SEX                        PIC X.
    95             88  CR-SEX-MALE                  VALUE 'M'.
    96             88  CR-SEX-FEMALE                VALUE 'F'.
    97         16  CR-SOC-SEC                    PIC X(11).
    98         16  CR-JOINT-NAME.
    99             20  CR-JT-LNAME               PIC X(15).
   100             20  CR-JT-FNAME.
   101                 24  CR-JT-1ST-INIT        PIC X.
   102                 24  FILLER                PIC X(9).
   103             20  CR-JT-INIT                PIC X.
   104         16  CR-JOINT-AGE                  PIC 99.
   105
   106         16  cr-ahl-ah-claim-no            pic x(9).
   107         16  cr-ahl-ah-cert-seq            pic x(3).
   108         16  cr-hst-proc-lf                pic x.
   109         16  f                             pic x(7).
   110
   111     12  CR-LF-COVERAGE-DATA.
   112         16  CR-LFTYP                      PIC XX.
   113         16  CR-LF-TERM                    PIC S999       COMP-3.
   114         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   115         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   116         16  CR-LF-DEV-CODE                PIC XXX.
   117         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   118
   119         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   120         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   121         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   122         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   123
   124         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   125         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   126         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   127         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   128
   129         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   130         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   131
   132         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   133         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   134
   135         16  CR-LF-REFUND-TYPE             PIC X.
   136         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   137
   138         16  CR-LF-COMM-CHARGEBACK         PIC X.
   139             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   140
   141         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   142
   143         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   144         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   145         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   146
   147         16  cr-ahl-lf-claim-no            pic x(9).
   148         16  cr-ahl-lf-cert-seq            pic x(3).
   149         16  FILLER                        PIC XX.
   150
   151     12  CR-AH-COVERAGE-DATA.
   152         16  CR-AHTYP                      PIC XX.
   153         16  CR-AH-TERM                    PIC S999       COMP-3.
   154         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   155         16  CR-AH-DEV-CODE                PIC XXX.
   156         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   157
   158         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   159         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   160         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   161         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   162
   163         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   164         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   165
   166         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   167         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   168
   169         16  CR-AH-REFUND-TYPE             PIC X.
   170         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   171
   172         16  CR-AH-COMM-CHARGEBACK         PIC X.
   173             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   174
   175         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   176
   177         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   178         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   179         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   180
   181         16  FILLER                        PIC XX.
   182*        16  FILLER                        PIC X(8).
   183
   184     12  CR-LOAN-DATA.
   185         16  CR-LIVES                      PIC S9(7)      COMP-3.
   186         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   187                                           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   188         16  CR-BILLED                     PIC S9(7)      COMP-3.
   189         16  CR-APR                        PIC S999V9(4)  COMP-3.
   190         16  CR-PMT-FREQ                   PIC 99.
   191         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   192         16  CR-RATING-CLASS               PIC XX.
   193         16  CR-POLICY-FORM-NO             PIC X(12).
   194         16  CR-GRPTYP                     PIC XX.
   195         16  CR-IND-GRP                    PIC X.
   196             88  CR-INDIVIDUAL                VALUE '1'.
   197             88  CR-GROUP                     VALUE '2'.
   198         16  CR-SKIP                       PIC 99.
   199             88  NO-MONTHS-SKIPPED            VALUE 00.
   200             88  SKIP-JULY                    VALUE 01.
   201             88  SKIP-AUGUST                  VALUE 02.
   202             88  SKIP-SEPTEMBER               VALUE 03.
   203             88  SKIP-JULY-AUG                VALUE 04.
   204             88  SKIP-AUG-SEPT                VALUE 05.
   205             88  SKIP-JULY-AUG-SEPT           VALUE 06.
   206             88  SKIP-JUNE-JULY-AUG           VALUE 07.
   207             88  SKIP-JUNE                    VALUE 08.
   208             88  SKIP-JUNE-JULY               VALUE 09.
   209             88  SKIP-AUG-SEPT-OCT            VALUE 10.
   210             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
   211         16  CR-RESIDENT-STATE             PIC XX.
   212         16  CR-RATE-CODE.
   213             20  CR-LF-CLASS-CD            PIC XX.
   214             20  CR-AH-CLASS-CD            PIC XX.
   215         16  CR-MORT.
   216             20  CR-TAB                    PIC X.
   217             20  CR-INT                    PIC 99.
   218             20  CR-GRP                    PIC X.
   219         16  CR-MEMBER-NO                  PIC X(12).
   220         16  CR-OLD-LOF                    PIC XXX.
   221*        16  CR-LOAN-OFFICER               PIC XXX.
   222         16  CR-REIN-TABLE                 PIC XXX.
   223         16  CR-REIN-SPEC                  PIC X.
   224         16  CR-LOAN-1ST-PMT-DT.
   225             20  CR-1ST-PMT-YR             PIC 99.
   226             20  CR-1ST-PMT-MO             PIC 99.
   227             20  CR-1ST-PMT-DA             PIC 99.
   228         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
   229         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
   230         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
   231         16  CR-LAST-ADD-ON-DT             PIC XX.
   232
   233         16  CR-UNDERWRITING-CODE          PIC X.
   234             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
   235
   236         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
   237         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
   238         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
   239         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
   240
   241     12  CR-STATUS-INFORMATION.
   242         16  CR-ENTRY-STATUS               PIC X.
   243             88  CR-NORMAL-ENTRY              VALUE '1'.
   244             88  CR-POLICY-IS-RESTORE         VALUE '3'.
   245             88  CR-CONVERSION-ENTRY          VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   246             88  CR-POLICY-IS-REISSUE         VALUE '5'.
   247             88  CR-POLICY-IS-CASH            VALUE 'C'.
   248             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
   249             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
   250             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
   251             88  CR-POLICY-IS-VOID            VALUE 'V'.
   252             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
   253             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
   254                                                'C' '5' '9' 'P'.
   255         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
   256
   257         16  CR-LF-STATUS-AT-CANCEL        PIC X.
   258         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
   259         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   260
   261         16  CR-LF-STATUS-AT-DEATH         PIC X.
   262         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
   263
   264         16  CR-LF-CURRENT-STATUS          PIC X.
   265             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
   266             88  CR-LF-POLICY-PENDING         VALUE '2'.
   267             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
   268             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
   269             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
   270             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   271             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
   272             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   273             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
   274             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
   275             88  CR-LF-IS-DECLINED            VALUE 'D'.
   276             88  CR-LF-IS-VOID                VALUE 'V'.
   277             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   278                                                    '4' '5' '9'.
   279
   280         16  CR-AH-STATUS-AT-CANCEL        PIC X.
   281
   282         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
   283         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
   284
   285         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
   286         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
   287
   288         16  CR-AH-CURRENT-STATUS          PIC X.
   289             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
   290             88  CR-AH-POLICY-PENDING         VALUE '2'.
   291             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
   292             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
   293             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
   294             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   295             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
   296             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   297             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
   298             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
   299             88  CR-AH-IS-DECLINED            VALUE 'D'.
   300             88  CR-AH-IS-VOID                VALUE 'V'.
   301             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   302                                                    '4' '5' '9'.
   303         16  CR-LOAN-OFFICER               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   304         16  CR-CANCEL-REASON              PIC X.
   305         16  cr-xycor-lf-cov-code          pic x(4).
   306         16  cr-xycor-ah-cov-code          pic x(4).
   307         16  cr-temp-epiq                  pic x(4).
   308         16  FILLER                        PIC XX.
   309
   310     12  CR-DEATH-CLAIM-DATA.
   311         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
   312
   313         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
   314         16  CR-DTH-RPT-DT.
   315             20  CR-DTH-RPT-YR             PIC 99.
   316             20  CR-DTH-RPT-MO             PIC 99.
   317             20  CR-DTH-RPT-DA             PIC 99.
   318         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
   319
   320         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
   321         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
   322         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
   323         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
   324         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
   325
   326         16  CR-DTH-AGE                    PIC 99.
   327         16  CR-DTH-PAY-CD                 PIC X.
   328         16  CR-DEATH-CAUSE                PIC X(6).
   329
   330         16  FILLER                        PIC X(16).
   331
   332     12  CR-DISAB-CLAIM-DATA.
   333         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
   334
   335         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
   336         16  CR-DIS-RPT-DT.
   337             20  CR-DIS-RPT-YR             PIC 99.
   338             20  CR-DIS-RPT-MO             PIC 99.
   339             20  CR-DIS-RPT-DA             PIC 99.
   340         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
   341         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
   342
   343         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
   344         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
   345         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
   346         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
   347         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
   348
   349         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
   350         16  CR-DIS-PAY-CD                 PIC X.
   351         16  FILLER                        PIC XX.
   352
   353         16  CR-DISAB-INCURRED-DETAIL.
   354             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
   355**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
   356                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
   357                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
   358                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
   359
   360         16  CR-DISAB-CAUSE                PIC X(6).
   361         16  FILLER                        PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   362
   363     12  CR-REMIT-TO                       PIC 99.
   364
   365     12  CR-COMPENSATION-LEVELS.
   366         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
   367             20  CR-COM-AGT.
   368                 24  CR-COM-AGT-PREFIX     PIC X(4).
   369                 24  CR-COM-AGT-PRIME      PIC X(6).
   370             20  CR-AGT-TYPE               PIC X.
   371             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
   372             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
   373
   374     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
   375     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   376     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
   377     12  CR-CLP-STATE                      PIC XX.
   378     12  CR-POST-CARD-IND                  PIC X.
   379     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
   380     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
   381     12  CR-DCC-PRODUCT-CODE               PIC XXX.
   382     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
   383     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
   384     12  FILLER                            PIC X(07).
   385
   386     12  CR-CSR-CODE                       PIC XXX.
   387
   388     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
   389     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
   390
   391     12  CR-MICROFILM-NUMBERS.
   392*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
   393         16  FILLER                        PIC X(5).
   394     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
   395
   396     12  CR-USER-CODE                      PIC X.
   397     12  CR-USER-FUTURE                    PIC X(9).
   398
   399     12  CR-BENEFICIARY.
   400         16  CR-BANK-NO                    PIC X(10).
   401         16  FILLER                        PIC X(15).
   402
   403     12  CR-ENTRY-BATCH                    PIC X(6).
   404     12  CR-LF-EXIT-BATCH                  PIC X(6).
   405     12  CR-AH-EXIT-BATCH                  PIC X(6).
   406
   407     12  CR-NOTE-SW                        PIC X.
   408
   409     12  CR-ORIGIN-INDICATOR               PIC X.
   410         88  CR-ENTERED-MANUALLY              VALUE '1'.
   411         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
   412
   413     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   414     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
   415     12  FILLER                            PIC X(33).
   416
   417******************************************************************
   418
   419 FD  RESV-OUT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMCRM6.cbl
   420     RECORDING MODE IS F
   421     LABEL RECORDS ARE STANDARD
   422     BLOCK CONTAINS 0 RECORDS.
   423
   424 01  RESV-OUT-RECORD            PIC X(510).
   425
   426 FD  RESV-IN
   427     RECORDING MODE IS F
   428     LABEL RECORDS ARE STANDARD
   429     BLOCK CONTAINS 0 RECORDS.
   430
*  431                                 COPY ECSEXT01.
   432******************************************************************04/29/98
   433*                                                                *ECSEXT01
   434*                            ECSEXT01                            *   LV015
   435*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
   436*                            VMOD=2.015                          *ECSEXT01
   437*                                                                *ECSEXT01
   438*   FILE DESCRIPTION =  DETAIL EXTRACTS                          *ECSEXT01
   439*                       (PREMIUM, COMM., CLAIMS, AND RESERVES)   *ECSEXT01
   440*                                                                *ECSEXT01
   441*   FILE TYPE = SEQUENTIAL                                       *ECSEXT01
   442*   RECORD SIZE = 510  RECFORM = FIXED                           *ECSEXT01
   443*                                                                *ECSEXT01
   444*   KEY DATA =                                   START=5, LEN=36 *ECSEXT01
   445*                                                                *ECSEXT01
   446******************************************************************ECSEXT01
   447******************************************************************
   448*                   C H A N G E   L O G
   449*
   450* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   451*-----------------------------------------------------------------
   452*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   453* EFFECTIVE    NUMBER
   454*-----------------------------------------------------------------
   455* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   456* 042110  CR2010010400006  PEMA  ADD FIELDS FOR EMERALD 032
   457* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   458* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   459* 112911  CR2011083000003  PEMA  ADD SPPDDF TRUNCATED
   460* 032612  CR2011110200001  PEMA  AHL CHANGES
   461******************************************************************
   462                                                                  ECSEXT01
   463 01  DETAIL-EXTRACT.                                              ECSEXT01
   464     02 DETAIL-FILE.                                              ECSEXT01
   465     12  DE-RECORD-ID                      PIC XX.                ECSEXT01
   466         88  VALID-DE-ID                      VALUE 'DE'.         ECSEXT01
   467                                                                  ECSEXT01
   468     12  DE-COMPANY-CD                     PIC X.                 ECSEXT01
   469                                                                  ECSEXT01
   470     12  DE-REIN                           PIC X.                 ECSEXT01
   471                                                                  ECSEXT01
   472     12  DE-CONTROL.                                              ECSEXT01
   473         16  DE-CNTRL1.                                           ECSEXT01
   474             20  DE-CARRIER                PIC X.                 ECSEXT01
   475             20  DE-GROUPING.                                     ECSEXT01
   476                 24  DE-GROUP-PREFIX       PIC XXX.               ECSEXT01
   477                 24  DE-GROUP-PRIME        PIC XXX.               ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   478             20  DE-STATE                  PIC XX.                ECSEXT01
   479             20  DE-ACCOUNT.                                      ECSEXT01
   480                 24  DE-ACCT-PREFIX        PIC X(4).              ECSEXT01
   481                 24  DE-ACCT-PRIME         PIC X(6).              ECSEXT01
   482         16  DE-CNTRL2.                                           ECSEXT01
   483             20  DE-EFF                    PIC 9(11)  COMP-3.     ECSEXT01
   484             20  DE-CERT.                                         ECSEXT01
   485                 24 DE-CERT-NO.                                   ECSEXT01
   486                     28  DE-CRT-PREFIX     PIC XXX.               ECSEXT01
   487                     28  DE-CRT-PRIME      PIC X(7).              ECSEXT01
   488                 24  DE-CRT-SUF            PIC X.                 ECSEXT01
   489                                                                  ECSEXT01
   490     12  DE-TRANS                          PIC X.                 ECSEXT01
   491         88  DE-ISSUE                         VALUE 'I'.          ECSEXT01
   492         88  DE-RC-ISSUE                      VALUE '8'.          ECSEXT01
   493         88  DE-CANCEL                        VALUE 'C'.          ECSEXT01
   494         88  DE-RC-CANCEL                     VALUE '7'.          ECSEXT01
   495         88  DE-CLAIM                         VALUE 'X'.          ECSEXT01
   496         88  DE-RESTORE                       VALUE 'R'.          ECSEXT01
   497         88  DE-RESERVE                       VALUE 'Y'.          ECSEXT01
   498         88  DE-RR-RC-ISS                     VALUE 'J'.          ECSEXT01
   499         88  DE-RR-RC-CNC                     VALUE 'K'.          ECSEXT01
   500         88  DE-RR-RC-CLM                     VALUE 'L'.          ECSEXT01
   501                                                                  ECSEXT01
   502     12  DE-REPORT-CODE-1                  PIC X(10).             ECSEXT01
   503     12  DE-REPORT-CODE-2                  PIC X(10).             ECSEXT01
   504                                                                  ECSEXT01
   505     12  DE-NAME.                                                 ECSEXT01
   506         16  DE-LNAME                      PIC X(15).             ECSEXT01
   507         16  DE-FNAME.                                            ECSEXT01
   508             20  DE-1ST-INIT-FNAME         PIC X.                 ECSEXT01
   509             20  FILLER                    PIC X(9).              ECSEXT01
   510         16  DE-INIT                       PIC X.                 ECSEXT01
   511     12  DE-AGE                            PIC 99.                ECSEXT01
   512     12  DE-SEX                            PIC X.                 ECSEXT01
   513     12  DE-SOC-SEC-NO                     PIC X(11).             ECSEXT01
   514                                                                  ECSEXT01
   515     12  DE-LF-TYPE                        PIC XX.                ECSEXT01
   516     12  DE-LF-TERM                        PIC 999        COMP-3. ECSEXT01
   517     12  DE-LF-BEN                         PIC S9(9)V99   COMP-3. ECSEXT01
   518     12  DE-LF-CNBEN                       PIC S9(9)V99   COMP-3. ECSEXT01
   519     12  DE-LF-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   520     12  DE-LF-BEN-ALT                     PIC S9(9)V99   COMP-3. ECSEXT01
   521     12  DE-LF-CNBEN-ALT                   PIC S9(9)V99   COMP-3. ECSEXT01
   522     12  DE-LF-PRM-ALT                     PIC S9(7)V99   COMP-3. ECSEXT01
   523     12  DE-LF-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   524                                                                  ECSEXT01
   525     12  DE-LF-STAT-CDE                    PIC X.                 ECSEXT01
   526     12  DE-LF-PREV-STAT                   PIC X.                 ECSEXT01
   527     12  DE-LF-CANC-DTE                    PIC 9(11)      COMP-3. ECSEXT01
   528     12  DE-LF-CANC-EXIT-DT                PIC 9(11)      COMP-3. ECSEXT01
   529                                                                  ECSEXT01
   530     12  DE-AH-TYPE                        PIC XX.                ECSEXT01
   531     12  DE-AH-TERM                        PIC 999        COMP-3. ECSEXT01
   532     12  DE-AH-BEN                         PIC S9(7)V99   COMP-3. ECSEXT01
   533     12  DE-AH-PRM                         PIC S9(7)V99   COMP-3. ECSEXT01
   534     12  DE-AH-RFND                        PIC S9(7)V99   COMP-3. ECSEXT01
   535                                                                  ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   536     12  DE-AH-STAT-CDE                    PIC X.                 ECSEXT01
   537     12  DE-AH-PREV-STAT                   PIC X.                 ECSEXT01
   538     12  DE-AH-CANC-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   539     12  DE-AH-CANC-EXIT-DT                PIC 9(11)  COMP-3.     ECSEXT01
   540                                                                  ECSEXT01
   541     12  DE-LIVES                          PIC S9(7)      COMP-3. ECSEXT01
   542     12  DE-ADDL-CLP REDEFINES DE-LIVES
   543                                           PIC S9(5)V99   COMP-3.
   544     12  DE-NUM-BILLED                     PIC S9(7)      COMP-3. ECSEXT01
   545     12  FILLER REDEFINES DE-NUM-BILLED.
   546         16  DE-CLP-STATE                  PIC XX.
   547         16  DE-DCC-DDF-REM-TRM3           PIC S999       COMP-3.
   548     12  DE-CANCEL-CNT-ITD                 PIC S999       COMP-3. ECSEXT01
   549     12  DE-CANCEL-CNT-YTD                 PIC S999       COMP-3. ECSEXT01
   550                                                                  ECSEXT01
   551     12  DE-APR                            PIC S999V9(4)  COMP-3. ECSEXT01
   552     12  DE-PMT-FREQ                       PIC 99.                ECSEXT01
   553     12  DE-ACC-GPCD                       PIC XX.                ECSEXT01
   554     12  DE-IG                             PIC X.                 ECSEXT01
   555     12  DE-REMIT-TO                       PIC XX.                ECSEXT01
   556*    12  DE-MEMBER-NO                      PIC X(12).             ECSEXT01
   557     12  DE-MEMBER-NO.                                            ECSEXT01
   558         16  DE-MASTER-POLICY              PIC X(06).             ECSEXT01
   559         16  DE-ZIP                        PIC 9(05)    COMP-3.   ECSEXT01
   560         16  FILLER                        PIC X(03).             ECSEXT01
   561     12  DE-LN-OFFICER                     PIC XXX.               ECSEXT01
   562                                                                  ECSEXT01
   563     12  DE-AUTO-GEND-IND                  PIC X.                 ECSEXT01
   564         88  DE-AUTO-GEND-REINS            VALUE 'R'.             ECSEXT01
   565                                                                  ECSEXT01
   566     12  DE-ENTRY-STATUS                   PIC X.                 ECSEXT01
   567     12  DE-ENTRY-DTE                      PIC 9(11)      COMP-3. ECSEXT01
   568                                                                  ECSEXT01
   569     12  DE-REI-AREA.                                             ECSEXT01
   570         16  DE-REI-COMP.                                         ECSEXT01
   571             20  DE-REINCO                 PIC XXX.               ECSEXT01
   572             20  DE-REINCO-SUB             PIC XXX.               ECSEXT01
   573         16  DE-REI-LFAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   574         16  DE-REI-LFPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   575         16  DE-REI-LFRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   576         16  DE-REI-AHAMT                  PIC S9(7)V99   COMP-3. ECSEXT01
   577         16  DE-REI-AHPRM                  PIC S9(7)V99   COMP-3. ECSEXT01
   578         16  DE-REI-AHRFND                 PIC S9(7)V99   COMP-3. ECSEXT01
   579         16  DE-REI-CNAMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   580                                                                  ECSEXT01
   581     12  DE-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
   582     12  FILLER REDEFINES DE-MOB-NET-TOT-FEES.
   583         16  DE-IU-RATE-UP                 PIC S9(5)V99 COMP-3.
   584         16  F                             PIC X.
   585*    12  FILLER                            PIC X(5).              ECSEXT01
   586                                                                  ECSEXT01
   587     12  DE-BILLED-AREA.                                          ECSEXT01
   588         16  DE-GL-INTERFACE-CODES.                               ECSEXT01
   589             20  DE-GL-CODES               PIC X  OCCURS 10 TIMES.ECSEXT01
   590                                                                  ECSEXT01
   591         16  DE-BILL-SW                    PIC X.                 ECSEXT01
   592             88  DE-RECORD-ON-HOLD            VALUE 'H'.          ECSEXT01
   593             88  DE-RECORD-RETURNED           VALUE 'R'.          ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   594             88  DE-RECORD-ENDORSED           VALUE 'E'.          ECSEXT01
   595             88  DE-OVERRIDE-LIFE             VALUE 'L'.          ECSEXT01
   596             88  DE-OVERRIDE-AH               VALUE 'A'.          ECSEXT01
   597             88  DE-OVERRIDE-BOTH             VALUE 'B'.          ECSEXT01
   598                                                                  ECSEXT01
   599         16  DE-REFUND-SW                  PIC X.                 ECSEXT01
   600             88  DE-REFUND-CREATED            VALUE 'Y'.          ECSEXT01
   601                                                                  ECSEXT01
   602         16  DE-BILLED-LFPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   603         16  DE-BILLED-LFRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   604         16  DE-BILLED-AHPRM               PIC S9(7)V99   COMP-3. ECSEXT01
   605         16  DE-BILLED-AHRFND              PIC S9(7)V99   COMP-3. ECSEXT01
   606                                                                  ECSEXT01
   607         16  DE-GA-BILL-STATUS             PIC X  OCCURS 5 TIMES. ECSEXT01
   608*            88  DE-NO-PRE-BILL-GA            VALUE ' '.          ECSEXT01
   609*            88  DE-BILLED-GA                 VALUE 'B'.          ECSEXT01
   610                                                                  ECSEXT01
   611     12  DE-BILL-STATUS                    PIC X.                 ECSEXT01
   612         88  DE-NO-PRE-BILL                   VALUE ' '.          ECSEXT01
   613         88  DE-BILLED                        VALUE 'B'.          ECSEXT01
   614         88  DE-REVERSE                       VALUE 'R'.          ECSEXT01
   615                                                                  ECSEXT01
   616     12  DE-REVERSE-REASONS.                                      ECSEXT01
   617         16  DE-REVERSE-REASON-1           PIC X.                 ECSEXT01
   618         16  DE-REVERSE-REASON-2           PIC X.                 ECSEXT01
   619     12  DE-CANCEL-REASON                  PIC X.
   620                                                                  ECSEXT01
   621     12  DE-RECALC-CODE                    PIC X.                 ECSEXT01
   622     12  DE-RECALC-TYPE                    PIC X.                 ECSEXT01
   623                                                                  ECSEXT01
   624     12  DE-CHARGEBACK-CODES.                                     ECSEXT01
   625         16  DE-LF-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   626             88  DE-NO-LF-CHARGEBACK          VALUE 'N'.          ECSEXT01
   627         16  DE-AH-COMM-CHARGEBACK         PIC X.                 ECSEXT01
   628             88  DE-NO-AH-CHARGEBACK          VALUE 'N'.          ECSEXT01
   629                                                                  ECSEXT01
   630     12  DE-UNDERWRITING-CODE              PIC X.                 ECSEXT01
   631         88  DE-POLICY-UNDERWRITTEN           VALUE 'Y'.          ECSEXT01
   632                                                                  ECSEXT01
   633     12  DE-NCL-POOL-CODE                  PIC XXX.               ECSEXT01
   634     12  FILLER REDEFINES DE-NCL-POOL-CODE.
   635         16  DE-LOAN-TERM                  PIC S999 COMP-3.
   636         16  FILLER                        PIC X.
   637                                                                  ECSEXT01
   638****************************************************************  ECSEXT01
   639**** CLAIM EXTRACT AND RESERVE EXTRACT IS REDEFINED AT THIS POINT ECSEXT01
   640****************************************************************  ECSEXT01
   641     12  DE-COMM-LEVELS.                                          ECSEXT01
   642         16  DE-AGT-LEVELS     OCCURS  10  TIMES.                 ECSEXT01
   643             20  DE-AGT.                                          ECSEXT01
   644                 24  DE-AGT-PREFIX         PIC X(4).              ECSEXT01
   645                 24  DE-AGT-PRIME          PIC X(6).              ECSEXT01
   646             20  DE-AGT-TYPE               PIC X.                 ECSEXT01
   647             20  DE-L-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   648             20  DE-A-PC                   PIC SV9(5)     COMP-3. ECSEXT01
   649                                                                  ECSEXT01
   650     12  DE-PROC-DT                        PIC 9(11)      COMP-3. ECSEXT01
   651****************************************************************  ECSEXT01
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   652*******                 CLAIM EXTRACT                      *****  ECSEXT01
   653****************************************************************  ECSEXT01
   654     02 DE-CLAIM-EXTRACT     REDEFINES     DETAIL-FILE.           ECSEXT01
   655     12  FILLER                            PIC X(334).            ECSEXT01
   656     12  DE-TYPE                           PIC X.                 ECSEXT01
   657         88  DE-DTH                           VALUE '1'.          ECSEXT01
   658         88  DE-AH                            VALUE '2'.          ECSEXT01
   659         88  DE-OB-DTH                        VALUE '3'.          ECSEXT01
   660         88  DE-OB-AH                         VALUE '4'.          ECSEXT01
   661         88  DE-DEATH                         VALUES '1' '3'.     ECSEXT01
   662         88  DE-DISABILITY                    VALUES '2' '4'.     ECSEXT01
   663                                                                  ECSEXT01
   664     12  DE-CLAIM-AMT                      PIC S9(9)V99   COMP-3. ECSEXT01
   665     12  DE-REI-CLAIM-AMT                  PIC S9(9)V99   COMP-3. ECSEXT01
   666                                                                  ECSEXT01
   667     12  DE-INCUR                          PIC 9(11)      COMP-3. ECSEXT01
   668     12  DE-REPORTED.                                             ECSEXT01
   669         16  DE-RPT-YR                     PIC 99.                ECSEXT01
   670         16  DE-RPT-MO                     PIC 99.                ECSEXT01
   671         16  DE-RPT-DA                     PIC 99.                ECSEXT01
   672     12  DE-PAY                            PIC 9(11)      COMP-3. ECSEXT01
   673     12  DE-PAID-TO                        PIC 9(11)      COMP-3. ECSEXT01
   674                                                                  ECSEXT01
   675     12  DE-CNUM                           PIC X(7).              ECSEXT01
   676     12  DE-CHECK                          PIC X(7).              ECSEXT01
   677     12  DE-PMT-TRAILER-SEQ                PIC S9(4)       COMP.  ECSEXT01
   678     12  DE-DAYS-DISAB                     PIC 999.               ECSEXT01
   679     12  DE-CLM-AGE                        PIC 99.                ECSEXT01
   680     12  DE-PAY-CODE                       PIC X.                 ECSEXT01
   681         88  DE-PARTIAL-PAYMENT               VALUE 'P'.          ECSEXT01
   682         88  DE-FINAL-PAYMENT                 VALUE 'F'.          ECSEXT01
   683         88  DE-LUMP-SUM-PAYMENT              VALUE 'S'.          ECSEXT01
   684         88  DE-ADDITIONAL-PAYMENT            VALUE 'X'.          ECSEXT01
   685         88  DE-CHARGEABLE-EXPENSE            VALUE 'E'.          ECSEXT01
   686         88  DE-NON-CHARGEABLE-EXPENSE        VALUE 'E'.          ECSEXT01
   687         88  DE-VOIDED-PAYMENT                VALUE 'V'.          ECSEXT01
   688                                                                  ECSEXT01
   689     12  DE-CLM-ERR                        PIC XX.                ECSEXT01
   690                                                                  ECSEXT01
   691     12  DE-ACC-NAME                       PIC X(30).             ECSEXT01
   692     12  DE-ACC-EXP-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   693     12  DE-ACC-EFF-DTE                    PIC 9(11)  COMP-3.     ECSEXT01
   694     12  FILLER                            PIC XX.                ECSEXT01
   695     12  DE-LOAN-OFFICER                   PIC XXX.               ECSEXT01
   696                                                                  ECSEXT01
   697     12  DE-LOAN-TYPE                      PIC X(02).             ECSEXT01
   698     12  DE-BENEFICIARY                    PIC X(10).
   699     12  filler redefines de-beneficiary.
   700         16  de-birth-date                 pic 9(11)  comp-3.
   701         16  f                             pic x(4).
   702     12  DE-LOAN-CLASS                     PIC X(02).             ECSEXT01
   703     12  DE-LOSS-CODE                      PIC X(06).             ECSEXT01
   704     12  DE-ASSOCIATES                     PIC X(01).             ECSEXT01
   705     12  DE-LEGAL-STATE                    PIC X(02).             ECSEXT01
   706     12  DE-CLM-CAUSE                      PIC X(6).              ECSEXT01
   707     12  DE-CLM-CLASS                      PIC XX.
   708     12  DE-CLM-DEV                        PIC XXX.
   709     12  DE-XYCOR-CLAIM-NO                 PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ECSEXT01)
   710     12  de-xycor-cert-seq                 pic x(3).
   711     12  DE-XYCOR-CHECK-NO                 PIC X(8).
   712     12  DE-XYCOR-ACTION-CD                PIC XXX.
   713     12  DE-XYCOR-STATUS                   PIC X.
   714     12  FILLER                            PIC X(4).              ECSEXT01
   715                                                                  ECSEXT01
   716     12  DE-CLM-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   717                                                                  ECSEXT01
   718****************************************************************  ECSEXT01
   719*******               RESERVE EXTRACT                      *****  ECSEXT01
   720****************************************************************  ECSEXT01
   721     02 DE-RESERVE-EXTRACT     REDEFINES     DETAIL-FILE.         ECSEXT01
   722     12  FILLER                            PIC X(334).            ECSEXT01
   723                                                                  ECSEXT01
   724     12  DE-RESERVE-TYPE                   PIC X.                 ECSEXT01
   725         88  DE-LIFE-RSV                      VALUE '1' '3'.      ECSEXT01
   726         88  DE-AH-RSV                        VALUE '2' '4'.      ECSEXT01
   727                                                                  ECSEXT01
   728     12  DE-IBNR                           PIC S9(7)V99   COMP-3. ECSEXT01
   729     12  DE-PAYCUR                         PIC S9(7)V99   COMP-3. ECSEXT01
   730     12  DE-FUTRSV                         PIC S9(7)V99   COMP-3. ECSEXT01
   731                                                                  ECSEXT01
   732     12  DE-CLMNO                          PIC X(7).              ECSEXT01
   733                                                                  ECSEXT01
   734     12  DE-RSV-INCUR                      PIC 9(11)      COMP-3. ECSEXT01
   735     12  DE-RSV-REPORTED.                                         ECSEXT01
   736         16  DE-RSV-RPT-YR                 PIC 99.                ECSEXT01
   737         16  DE-RSV-RPT-MO                 PIC 99.                ECSEXT01
   738         16  DE-RSV-RPT-DA                 PIC 99.                ECSEXT01
   739     12  DE-RSV-PAYTO                      PIC 9(11)      COMP-3. ECSEXT01
   740                                                                  ECSEXT01
   741     12  DE-REI-IBNR                       PIC S9(7)V99   COMP-3. ECSEXT01
   742     12  DE-REI-PAYCUR                     PIC S9(7)V99   COMP-3. ECSEXT01
   743     12  DE-REI-FUTRSV                     PIC S9(7)V99   COMP-3. ECSEXT01
   744                                                                  ECSEXT01
   745     12  DE-RSV-ACC-NAME                   PIC X(30).             ECSEXT01
   746     12  DE-ACC-EXP-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   747     12  DE-ACC-EFF-DTE-RSV                PIC 9(11)      COMP-3. ECSEXT01
   748                                                                  ECSEXT01
   749     12  DE-MANUAL-RSV-SWITCH              PIC X.                 ECSEXT01
   750                                                                  ECSEXT01
   751     12  DE-RATE-CLASS                     PIC XX.
   752     12  DE-DEV-CODE                       PIC XXX.
   753     12  DE-RSV-REM-TERM                   PIC S999       COMP-3.
   754     12  DE-RSV-REM-BENEFIT                PIC S9(9)V99   COMP-3.
   755     12  FILLER                            PIC X(58).             ECSEXT01
   756                                                                  ECSEXT01
   757     12  DE-RSV-PROC-DT                    PIC 9(11)  COMP-3.        CL**2
   758******************************************************************ECSEXT01
   759
   760 WORKING-STORAGE SECTION.
   761 77  FILLER  PIC X(32) VALUE '********************************'.
   762 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.
   763 77  FILLER  PIC X(32) VALUE '********************************'.
   764
   765 01  WS-CERT-DT                PIC 9(8)  VALUE ZEROS.
   766 01  WS-EXTR-DT                PIC 9(8)  VALUE ZEROS.
   767 01  W-MISC.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMCRM6.cbl
   768     05  WS-DATE-ALPH.
   769         10  FILLER             PIC XXX VALUE '000'.
   770         10  WS-WORK-CENT       PIC XX.
   771         10  WS-WORK-YR         PIC XX.
   772         10  WS-WORK-MO         PIC XX.
   773         10  WS-WORK-DA         PIC XX.
   774     05  WS-DATE-NUM REDEFINES WS-DATE-ALPH
   775                                PIC 9(11).
   776
   777     05  RESV-IN-CNT             PIC 9(9) VALUE ZEROS.
   778     05  CERT-IN-CNT             PIC 9(9) VALUE ZEROS.
   779     05  RESV-FIX-CNT            PIC 9(9) VALUE ZEROS.
   780     05  RESV-OT-CNT             PIC 9(9) VALUE ZEROS.
   781     05  RESV-SEL-CNT            PIC 9(9) VALUE ZEROS.
   782     05  WS-EOF-SW              PIC X VALUE SPACES.
   783         88  END-OF-RESV              VALUE 'Y'.
   784     05  WS-CRT-SW              PIC X VALUE ' '.
   785         88  END-OF-CERT              VALUE 'Y'.
   786
*  787                                 COPY ELCDATE.
   788******************************************************************06/11/98
   789*                                                                *ELCDATE
   790*                                                                *ELCDATE
   791*                            ELCDATE.                            *   LV023
   792*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   793*                            VMOD=2.003                           ELCDATE
   794*                                                                *ELCDATE
   795*                                                                *ELCDATE
   796*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   797*                 LENGTH = 200                                   *   CL*19
   798******************************************************************ELCDATE
   799                                                                  ELCDATE
   800 01  DATE-CONVERSION-DATA.                                        ELCDATE
   801     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   802     12  DC-OPTION-CODE                PIC X.                        CL*15
   803         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   804         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   805         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   806         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   807         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   808         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   809         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   810         88  FIND-CENTURY               VALUE '7'.                   CL*22
   811         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   812         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   813         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   814         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   815         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   816         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   817         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   818         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   819         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   820         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   821         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   822         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   823         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   824         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   825         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ELCDATE)
   826         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   827         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   828         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   829         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   830         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   831         88  THREE-CHARACTER-BIN                                  ELCDATE
   832                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   833         88  GREGORIAN-TO-BIN                                        CL**2
   834                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   835         88  BIN-TO-GREGORIAN                                        CL**2
   836                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   837         88  JULIAN-TO-BINARY                                        CL**2
   838                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   839     12  DC-ERROR-CODE                 PIC X.                        CL*15
   840         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   841         88  DATE-CONVERSION-ERROR                                ELCDATE
   842                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   843         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   844         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   845         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   846         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   847         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   848         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   849         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   850         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   851         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   852         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   853     12  DC-END-OF-MONTH               PIC X.                        CL*15
   854         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   855     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   856         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   857         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   858         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   859     12  FILLER                        PIC X.                        CL*15
   860     12  DC-CONVERSION-DATES.                                        CL*15
   861         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   862         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   863         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   864         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   865                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   866             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   867             20  SLASH1-1              PIC X.                        CL*15
   868             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   869             20  SLASH1-2              PIC X.                        CL*15
   870             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   871         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   872         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   873                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   874             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   875             20  SLASH2-1              PIC X.                        CL*15
   876             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   877             20  SLASH2-2              PIC X.                        CL*15
   878             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   879         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   880         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   881                     DC-GREG-DATE-1-YMD.                          ELCDATE
   882             20  DC-YMD-YEAR           PIC 99.                       CL*15
   883             20  DC-YMD-MONTH          PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ELCDATE)
   884             20  DC-YMD-DAY            PIC 99.                       CL*15
   885         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   886         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   887                      DC-GREG-DATE-1-MDY.                         ELCDATE
   888             20  DC-MDY-MONTH          PIC 99.                       CL*15
   889             20  DC-MDY-DAY            PIC 99.                       CL*15
   890             20  DC-MDY-YEAR           PIC 99.                       CL*15
   891         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   892             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   893             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   894             20  FILLER                PIC XX.                       CL*15
   895             20  DC-ALPHA-CENTURY.                                   CL*15
   896                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   897             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   898         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   899         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   900         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   901         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   902         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   903                                       PIC 9(05).                    CL*20
   904         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   905             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   906             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   907         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   908         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   909         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   910     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   911         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   912         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   913             20  FILLER                PIC 9(3).                     CL*15
   914             20  HOLD-CEN-1-CCYY.                                    CL*15
   915                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   916                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   917             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   918             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   919         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   920             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   921             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   922             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   923                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   924                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   925             20  FILLER                PIC 9(3).                     CL*15
   926         16  HOLD-CENTURY-1-X.                                       CL*15
   927             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   928             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   929                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   930                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   931             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   932             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   933         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   934             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   935             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   936             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   937                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   938                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   939             20  FILLER                PIC XXX.                      CL*23
   940         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   941         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* PEMCRM6.cbl (/apps/prod/cid1p/copy/ELCDATE)
   942         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   943         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   944             20  DC-JULIAN-1-CCYY.                                   CL*15
   945                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   946                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   947             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   948         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   949         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   950             20  DC-JULIAN-2-CCYY.                                   CL*15
   951                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   952                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   953             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   954         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   955             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   956             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   957             20  DC-EDITA-DAY          PIC 99.                       CL*15
   958             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   959             20  DC-EDITA-CCYY.                                      CL*15
   960                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   961                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   962         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   963             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   964             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   965             20  DC-EDITB-DAY          PIC 99.                       CL*15
   966             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   967             20  DC-EDITB-CCYY.                                      CL*15
   968                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   969                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   970         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   971         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   972                              DC-GREG-DATE-CYMD.                  ELCDATE
   973             20  DC-CYMD-CEN           PIC 99.                       CL*15
   974             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   975             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   976             20  DC-CYMD-DAY           PIC 99.                       CL*15
   977         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   978         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   979                              DC-GREG-DATE-MDCY.                  ELCDATE
   980             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   981             20  DC-MDCY-DAY           PIC 99.                       CL*15
   982             20  DC-MDCY-CEN           PIC 99.                       CL*15
   983             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   984    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   985        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   986    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   987    12  FILLER                         PIC X(28).                    CL*26
   988 PROCEDURE DIVISION.
   989
   990     OPEN INPUT    RESV-IN    CERT-IN
   991
   992     OPEN OUTPUT      RESV-OUT
   993
   994     PERFORM 0010-READ-RESV      THRU 0010-EXIT
   995     PERFORM 0015-READ-CERT      THRU 0015-EXIT
   996
   997     PERFORM 0020-PROCESS THRU 0020-EXIT UNTIL
   998        END-OF-RESV
   999
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* PEMCRM6.cbl
  1000     CLOSE   RESV-IN   CERT-IN  RESV-OUT
  1001
  1002     DISPLAY ' CERT RECS READ ' CERT-IN-CNT
  1003     DISPLAY ' RESV RECS READ ' RESV-IN-CNT
  1004     DISPLAY ' RESV RECS SEL  ' RESV-SEL-CNT
  1005     DISPLAY ' RESV RECS OUT  ' RESV-OT-CNT
  1006     DISPLAY ' RESV RECS FIX  ' RESV-FIX-CNT
  1007
  1008     GOBACK
  1009
  1010     .
  1011 0010-READ-RESV.
  1012
  1013     READ RESV-IN AT END
  1014        SET END-OF-RESV TO TRUE
  1015     END-READ
  1016
  1017     IF NOT END-OF-RESV
  1018        ADD  1    TO RESV-IN-CNT
  1019        IF (DE-REIN NOT = 'R')
  1020           AND (DE-TRANS = 'X' OR 'Y')
  1021           AND (DE-CERT NOT = 'ACTBENIBNR')
  1022           ADD  1                TO RESV-SEL-CNT
  1023        ELSE
  1024           GO TO 0010-READ-RESV
  1025        END-IF
  1026     END-IF
  1027
  1028     .
  1029 0010-EXIT.
  1030     EXIT.
  1031
  1032 0015-READ-CERT.
  1033
  1034     READ CERT-IN AT END
  1035        SET END-OF-CERT TO TRUE
  1036     END-READ
  1037
  1038     IF NOT END-OF-CERT
  1039        ADD  1    TO CERT-IN-CNT
  1040     END-IF
  1041
  1042     .
  1043 0015-EXIT.
  1044     EXIT.
  1045
  1046 0020-PROCESS.
  1047
  1048*    DISPLAY ' EXT KEY = ' EXT-KEY
  1049*    DISPLAY 'CERT KEY = ' CERT-KEY
  1050     IF DE-CONTROL = CR-FULL-CONTROL
  1051        PERFORM 0030-MATCHED     THRU 0030-EXIT
  1052        PERFORM 0010-READ-RESV   THRU 0010-EXIT
  1053     ELSE
  1054        IF DE-CONTROL > CR-FULL-CONTROL
  1055           PERFORM 0015-READ-CERT
  1056                                 THRU 0015-EXIT
  1057        ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* PEMCRM6.cbl
  1058           MOVE CR-DT            TO WS-CERT-DT
  1059           MOVE DE-EFF           TO WS-EXTR-DT
  1060           DISPLAY ' NO MATCH ' DE-CONTROL (1:19) ' ' WS-EXTR-DT
  1061              ' ' DE-CERT '**' CR-FULL-CONTROL (1:19) ' '
  1062              WS-CERT-DT ' ' CR-CERT-NO
  1063           PERFORM 0010-READ-RESV THRU 0010-EXIT
  1064        END-IF
  1065     END-IF
  1066
  1067     .
  1068 0020-EXIT.
  1069      EXIT.
  1070
  1071 0030-MATCHED.
  1072
  1073     ADD 1 TO RESV-FIX-CNT
  1074
  1075     IF DE-TRANS = 'Y'
  1076        MOVE CR-RATING-CLASS     TO DE-RATE-CLASS
  1077        IF DE-LIFE-RSV
  1078           MOVE CR-LF-DEV-CODE   TO DE-DEV-CODE
  1079        ELSE
  1080           MOVE CR-AH-DEV-CODE   TO DE-DEV-CODE
  1081        END-IF
  1082     ELSE
  1083        MOVE CR-RATING-CLASS     TO DE-CLM-CLASS
  1084        IF DE-DEATH
  1085           MOVE CR-LF-DEV-CODE   TO DE-CLM-DEV
  1086        ELSE
  1087           MOVE CR-AH-DEV-CODE   TO DE-CLM-DEV
  1088        END-IF
  1089     END-IF
  1090     PERFORM 0040-WRITE-RESV     THRU 0040-EXIT
  1091
  1092     .
  1093 0030-EXIT.
  1094      EXIT.
  1095
  1096 0040-WRITE-RESV.
  1097
  1098     WRITE RESV-OUT-RECORD FROM DETAIL-EXTRACT
  1099     ADD 1 TO RESV-OT-CNT
  1100
  1101     .
  1102 0040-EXIT.
  1103     EXIT.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4268     Code:        1152
