* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS0633.cbl
* Options: int("ECS0633.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS0633.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS0633.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS0633.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    ECS0633.
     3 AUTHOR.        AJRA.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5******************************************************************
     6*                   C H A N G E   L O G
     7*
     8* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     9*-----------------------------------------------------------------
    10*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    11* EFFECTIVE    NUMBER
    12*-----------------------------------------------------------------
    13* 032806  CR2006022800001  AJRA  NEW WRITING ACCOUNT REPORT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS0633.cbl
    14* 031811 CR2011012700001   PEMA  ADD ACCT STATUS S - SUSPENDED
    15* 091911 IR2011090700001   PEMA  REMOVE 'B' PROCESSING
    16******************************************************************
    17 ENVIRONMENT DIVISION.
    18 INPUT-OUTPUT SECTION.
    19 FILE-CONTROL.
    20
    21     SELECT PRNTR            ASSIGN TO SYS008.
    22
    23     SELECT COMM-MSTR-IN     ASSIGN TO SYS010.
    24
    25     SELECT DISK-DATE        ASSIGN TO SYS019.
    26
    27     SELECT SORT-WORK        ASSIGN TO SYS001.
    28
    29     SELECT ERACCT3          ASSIGN TO SYS016
    30                               ORGANIZATION  INDEXED
    31                               ACCESS        DYNAMIC
    32                               RECORD KEY    AM-VG-KEY3
    33                               FILE STATUS   ACCT-STATUS.
    34
    35
    36
    37 DATA DIVISION.
    38 FILE SECTION.
    39
    40 FD  PRNTR
*   41                             COPY ELCPRTFD.
    42******************************************************************04/15/98
    43*                                                                *ELCPRTFD
    44*                                                                *ELCPRTFD
    45*                            ELCPRTFD.                           *   LV003
    46*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    47*                            VMOD=2.006                          *ELCPRTFD
    48******************************************************************ELCPRTFD
    49     RECORDING MODE F                                             ELCPRTFD
    50     LABEL RECORDS OMITTED                                        ELCPRTFD
    51     BLOCK CONTAINS 0 RECORDS
    52     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    53 01  PRT.                                                         ELCPRTFD
    54     12  P-CTL               PIC  X.                                 CL**2
    55     12  P-DATA              PIC  X(132).                         ELCPRTFD
    56******************************************************************ELCPRTFD
    57
    58 FD  COMM-MSTR-IN
*   59                             COPY ECSCOIFD.
    60******************************************************************07/10/97
    61*                                                                *ECSCOIFD
    62*                            ECSCOIFD                            *   LV001
    63*                            VMOD=2.005                          *ECSCOIFD
    64*                                                                *ECSCOIFD
    65* NO CID  MODS IN  COPYBOOK  ECSCOIFD.                           *ECSCOIFD
    66*                                                                *ECSCOIFD
    67******************************************************************ECSCOIFD
    68     BLOCK CONTAINS 0 RECORDS
    69     RECORDING MODE F.                                            ECSCOIFD
    70                                                                  ECSCOIFD
    71 01  COMP-IN-RECORD.                                              ECSCOIFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS0633.cbl (/apps/prod/cid1p/copy/ECSCOIFD)
    72     12  COI-ID                            PIC XX.                ECSCOIFD
    73                                                                  ECSCOIFD
    74     12  COI-CONTROL.                                             ECSCOIFD
    75         16  COI-COMPANY-CD                PIC X.                 ECSCOIFD
    76         16  COI-CTL-1.                                           ECSCOIFD
    77             20  COI-CARR-GROUP.                                  ECSCOIFD
    78                 24  COI-CARRIER           PIC X.                 ECSCOIFD
    79                 24  COI-GROUPING.                                ECSCOIFD
    80                     28  COI-GRP-PREFIX    PIC XXX.               ECSCOIFD
    81                     28  COI-GRP-PRIME     PIC XXX.               ECSCOIFD
    82             20  COI-RESP-NO.                                     ECSCOIFD
    83                 24  COI-RESP-PREFIX       PIC X(4).              ECSCOIFD
    84                 24  COI-RESP-PRIME        PIC X(6).              ECSCOIFD
    85         16  COI-CTL-2.                                           ECSCOIFD
    86             20  COI-ACCOUNT.                                     ECSCOIFD
    87                 24  COI-ACCT-PREFIX       PIC X(4).              ECSCOIFD
    88                 24  COI-ACCT-PRIME        PIC X(6).              ECSCOIFD
    89         16  COI-TYPE                      PIC X.                 ECSCOIFD
    90             88  COI-COMPANY-RECORD           VALUE 'C'.          ECSCOIFD
    91             88  COI-GENERAL-AGENT-RECORD     VALUE 'G'.          ECSCOIFD
    92             88  COI-ACCOUNT-RECORD           VALUE 'A'.          ECSCOIFD
    93                                                                  ECSCOIFD
    94     12  FILLER                            PIC X(20).             ECSCOIFD
    95                                                                  ECSCOIFD
    96     12  COI-BALANCE-CONTROL               PIC X.                 ECSCOIFD
    97         88  COI-CARRY-BALANCE                VALUE 'Y'.          ECSCOIFD
    98         88  COI-NO-BALANCE                   VALUE 'N'.          ECSCOIFD
    99                                                                  ECSCOIFD
   100     12  COI-INTERNAL-CONTROL-1            PIC X.                 ECSCOIFD
   101         88  COI-AUTO-GENERATED-THIS-RUN      VALUE 'X'.          ECSCOIFD
   102         88  COI-AUTO-GENERATED               VALUE 'Y'.          ECSCOIFD
   103         88  COI-NOT-AUTO-GENERATED           VALUE 'N'.          ECSCOIFD
   104                                                                  ECSCOIFD
   105     12  COI-INTERNAL-CONTROL-2            PIC X.                 ECSCOIFD
   106         88  COI-STATEMENT-THIS-RUN           VALUE 'Y'.          ECSCOIFD
   107         88  COI-NO-STATEMENT-THIS-RUN        VALUE 'N'.          ECSCOIFD
   108                                                                  ECSCOIFD
   109     12  COI-FUTURE-SPACE                  PIC X(5).              ECSCOIFD
   110         88  COI-FUTURE-NOT-USED              VALUE '     '.      ECSCOIFD
   111                                                                  ECSCOIFD
   112     12  COI-DATA                          PIC X(641).            ECSCOIFD
   113                                                                  ECSCOIFD
   114******************************************************************ECSCOIFD
   115
   116 FD  DISK-DATE
*  117                             COPY ELCDTEFD.
   118******************************************************************04/15/98
   119*                                                                *ELCDTEFD
   120*                                                                *ELCDTEFD
   121*                            ELCDTEFD.                           *   LV002
   122*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   123*                            VMOD=2.007                          *   CL**2
   124*                                                                *ELCDTEFD
   125******************************************************************ELCDTEFD
   126     BLOCK CONTAINS 0 RECORDS
   127     RECORDING MODE F.                                            ELCDTEFD
   128                                                                  ELCDTEFD
   129 01  DATE-DISK.                                                   ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   131     12  FILLER                      PIC  X(14).                  ELCDTEFD
   132     12  DD-CR1                      PIC  9.                      ELCDTEFD
   133     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   134     12  DD-CR2                      PIC  9.                      ELCDTEFD
   135     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   136     12  FILLER                      PIC  X(20).                  ELCDTEFD
   137                                                                  ELCDTEFD
   138 01  DATE-DISK-R.                                                 ELCDTEFD
   139     12  FILLER                      PIC  X(4).                   ELCDTEFD
   140     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   141                                     PIC  X(32).                  ELCDTEFD
   142                                                                  ELCDTEFD
   143 01  DATE-DISK-T.                                                 ELCDTEFD
   144     12  FILLER                      PIC  X(4).                   ELCDTEFD
   145     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   146                                     PIC  X(48).                  ELCDTEFD
   147                                                                  ELCDTEFD
   148 01  DATE-DISK-M.                                                 ELCDTEFD
   149     12  FILLER                      PIC  X(4).                   ELCDTEFD
   150     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   151                                     PIC  X(48).                  ELCDTEFD
   152                                                                  ELCDTEFD
   153 01  DATE-DISK-P.                                                 ELCDTEFD
   154     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   155     12  DD-IDX                      PIC  99.                     ELCDTEFD
   156     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   157     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   158         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   159                                     PIC  X.                      ELCDTEFD
   160         16  FILLER                  PIC  X(46).                  ELCDTEFD
   161     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   162         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   163             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   164             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   165             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   166             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   167         16  FILLER                  PIC  X(16).                  ELCDTEFD
   168                                                                  ELCDTEFD
   169 01  DATE-DISK-E.                                                 ELCDTEFD
   170     12  FILLER                      PIC  X(4).                   ELCDTEFD
   171     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   172                                     PIC  X(4).                   ELCDTEFD
   173                                                                  ELCDTEFD
   174 01  DATE-DISK-C.                                                 ELCDTEFD
   175     12  FILLER                      PIC  X(7).                   ELCDTEFD
   176     12  DD-CARR1-SECPAY-SW          PIC  X.
   177     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   178     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   179     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   180     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   181     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   182     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   183     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   184     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   185     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   186     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   187     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   188     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   189     12  DD-CARR2-SECPAY-SW          PIC  X.
   190     12  FILLER                      PIC  X(7).                   ELCDTEFD
   191                                                                  ELCDTEFD
   192 01  DATE-DISK-OPT.                                               ELCDTEFD
   193     12  FILLER                      PIC  X(04).                  ELCDTEFD
   194     12  DD-TLR-DATA.                                             ELCDTEFD
   195         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   196                                     PIC  X(03).                  ELCDTEFD
   197     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   198         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   199                                     PIC  X(06).                  ELCDTEFD
   200     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   201         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   202                                     PIC  X(07).                  ELCDTEFD
   203         16  FILLER                  PIC  X(05).                  ELCDTEFD
   204     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   205                                     PIC  X(96).                  ELCDTEFD
   206******************************************************************ELCDTEFD
   207
   208 SD  SORT-WORK.
   209 01  SORT-REC.
   210     12  SORT-KEY             PIC  X(13).
   211     12  SORT-DETAIL          PIC  X(30).
   212
   213 FD  ERACCT3.
   214
   215*     COPY ERCACCT.
   216******************************************************************04/19/98
   217*                                                                *ERCACCT
   218*                                                                *ERCACCT
   219*                            ERCACCT                             *   LV031
   220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   221*                            VMOD=2.031                          *ERCACCT
   222*                                                                *ERCACCT
   223*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   224*                                                                *ERCACCT
   225*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   226*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   227*                                                                *ERCACCT
   228*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   229*                                                                *ERCACCT
   230*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   231*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   232*                                                                *ERCACCT
   233*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   234*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   235*                                                                *ERCACCT
   236*   LOG = NO                                                     *ERCACCT
   237*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   238*                                                                *ERCACCT
   239*                                                                *ERCACCT
   240******************************************************************ERCACCT
   241*                   C H A N G E   L O G
   242*
   243* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   244*-----------------------------------------------------------------
   245*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS0633.cbl
   246* EFFECTIVE    NUMBER
   247*-----------------------------------------------------------------
   248* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   249* 092705    2005050300006  PEMA  ADD SPP LEASES
   250******************************************************************
   251                                                                  ERCACCT
   252 01  ACCOUNT-MASTER.                                              ERCACCT
   253     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   254         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   255                                                                  ERCACCT
   256     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   257         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   258         16  AM-MSTR-CNTRL.                                       ERCACCT
   259             20  AM-CONTROL-A.                                    ERCACCT
   260                 24  AM-CARRIER            PIC X.                 ERCACCT
   261                 24  AM-GROUPING.                                 ERCACCT
   262                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   263                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   264                 24  AM-STATE              PIC XX.                ERCACCT
   265                 24  AM-ACCOUNT.                                  ERCACCT
   266                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   267                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   268             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   269                                           PIC X(19).             ERCACCT
   270             20  AM-CNTRL-B.                                      ERCACCT
   271                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   272                 24  FILLER                PIC X(4).              ERCACCT
   273             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   274                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   275                                                                  ERCACCT
   276     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   277         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   278         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   279         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   280         16  AM-VG-STATE                   PIC XX.                ERCACCT
   281         16  AM-VG-KEY2-END.
   282           18  AM-VG-ACCOUNT               PIC X(10).             ERCACCT
   283           18  AM-VG-DATE.                                        ERCACCT
   284             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   285             20  FILLER                    PIC X(4).              ERCACCT
   286           18  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                ERCACCT
   287                                           PIC 9(11)      COMP-3. ERCACCT
   288         16  AM-VG-KEY3-R REDEFINES AM-VG-KEY2-END.
   289             20  AM-VG-KEY3.
   290                 25  AM-VG-KEY3-ACCOUNT    PIC X(10).
   291                 25  AM-VG-KEY3-EXP-DT     PIC X(2).
   292             20  FILLER                    PIC X(4).
   293
   294     12  AM-MAINT-INFORMATION.                                    ERCACCT
   295         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   296         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   297         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   298         16  FILLER                        PIC XX.                ERCACCT
   299                                                                  ERCACCT
   300     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   301     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   302                                                                  ERCACCT
   303     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS0633.cbl
   304         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   305         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   306                                                                  ERCACCT
   307     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   308     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   309                                                                  ERCACCT
   310     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   311     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   312                                                                  ERCACCT
   313     12  AM-NAME                           PIC X(30).             ERCACCT
   314     12  AM-PERSON                         PIC X(30).             ERCACCT
   315     12  AM-ADDRS                          PIC X(30).             ERCACCT
   316     12  AM-CITY                           PIC X(30).             ERCACCT
   317     12  AM-ZIP.                                                  ERCACCT
   318         16  AM-ZIP-PRIME.                                        ERCACCT
   319             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   320                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   321             20  FILLER                    PIC X(4).              ERCACCT
   322         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   323     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   324         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   325         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   326         16  FILLER                        PIC XXX.               ERCACCT
   327     12  AM-TEL-NO.                                               ERCACCT
   328         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   329         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   330         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   331     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   332         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   333         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   334                                                                  ERCACCT
   335     12  AM-COMM-STRUCTURE.                                       ERCACCT
   336         16  AM-DEFN-1.                                           ERCACCT
   337             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   338                 24  AM-AGT.                                      ERCACCT
   339                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   340                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   341                 24  AM-COM-TYP            PIC X.                 ERCACCT
   342                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   343                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   344                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   345                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   346                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   347                 24  AM-GL-CODES           PIC X.                 ERCACCT
   348                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   349                 24  FILLER                PIC X(01).             ERCACCT
   350         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   351             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   352                 24  FILLER                PIC X(11).             ERCACCT
   353                 24  AM-L-COMA             PIC XXX.               ERCACCT
   354                 24  AM-J-COMA             PIC XXX.               ERCACCT
   355                 24  AM-A-COMA             PIC XXX.               ERCACCT
   356                 24  FILLER                PIC X(6).              ERCACCT
   357                                                                  ERCACCT
   358     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   359         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   360                                                                  ERCACCT
   361     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS0633.cbl
   362                                                                  ERCACCT
   363     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   364         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   365         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   366     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   367         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   368         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   369     12  AM-GPCD                           PIC 99.                ERCACCT
   370     12  AM-IG                             PIC X.                 ERCACCT
   371         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   372         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   373     12  AM-STATUS                         PIC X.                 ERCACCT
   374         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   375         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   376         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   377         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   378         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   379         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   380     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   381     12  AM-ID-NO                          PIC X(11).             ERCACCT
   382                                                                  ERCACCT
   383     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   384     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   385     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   386     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   387     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   388     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   389     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   390     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   391     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   392                                                                  ERCACCT
   393     12  AM-USER-FIELDS.                                          ERCACCT
   394         16  AM-FLD-1                      PIC XX.                ERCACCT
   395         16  AM-FLD-2                      PIC XX.                ERCACCT
   396         16  AM-FLD-3                      PIC XX.                ERCACCT
   397         16  AM-FLD-4                      PIC XX.                ERCACCT
   398         16  AM-FLD-5                      PIC XX.                ERCACCT
   399                                                                  ERCACCT
   400     12  AM-1ST-PROD-DATE.                                        ERCACCT
   401         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   402         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   403         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   404     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   405     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   406         16  AM-PUR-YR                     PIC XX.                ERCACCT
   407         16  AM-PUR-MO                     PIC XX.                ERCACCT
   408         16  AM-PUR-DA                     PIC XX.                ERCACCT
   409     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   410     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   411     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   412     12  AM-INACTIVE-DATE.                                        ERCACCT
   413         16  AM-INA-MO                     PIC 99.                ERCACCT
   414         16  AM-INA-DA                     PIC 99.                ERCACCT
   415         16  AM-INA-YR                     PIC 99.                ERCACCT
   416     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   417                                                                  ERCACCT
   418     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   419     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS0633.cbl
   420                                                                  ERCACCT
   421     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   422         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   423         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   424         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   425         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   426                                                                  ERCACCT
   427     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   428         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   429         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   430                                                                  ERCACCT
   431     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   432                                                                  ERCACCT
   433     12  AM-OVER-SHORT.                                           ERCACCT
   434         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   435         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   436                                                                  ERCACCT
   437     12  FILLER                            PIC X(05).             ERCACCT
   438                                                                  ERCACCT
   439     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   440     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   441                                                                  ERCACCT
   442     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   443     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   444     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   445     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   446     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   447     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   448     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   449     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   450     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   451     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   452     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   453     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   454     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   455     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   456     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   457     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   458                                                                  ERCACCT
   459     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   460                                                                  ERCACCT
   461     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   462     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   463                                                                  ERCACCT
   464     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   465     12  AM-EARN-METHODS.                                         ERCACCT
   466         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   467             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   468             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   469             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   470             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   471         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   472             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   473             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   474             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   475             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   476         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   477             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS0633.cbl
   478             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   479             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   480             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   481             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   482             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   483                                                                  ERCACCT
   484     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   485     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   486     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   487                                                                  ERCACCT
   488     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   489     12  AM-RET-P-E                        PIC X.                 ERCACCT
   490     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   491     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   492     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   493     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   494         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   495         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   496     12  AM-RETRO-EARNINGS.                                       ERCACCT
   497         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   498         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   499         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   500     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   501         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   502         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   503     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   504         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   505         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   506         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   507     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   508     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   509                                                                  ERCACCT
   510     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   511         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   512         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   513         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   514         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   515         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   516                                                                  ERCACCT
   517     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   518                                                                  ERCACCT
   519     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   520                                                                  ERCACCT
   521     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   522         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   523                                                                  ERCACCT
   524     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   525         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   526         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   527                                                                  ERCACCT
   528     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   529         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   530                                                                  ERCACCT
   531     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   532         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   533         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   534                                                                  ERCACCT
   535     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS0633.cbl
   536                                                                  ERCACCT
   537     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   538     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   539     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   540     12  FILLER                            PIC X(18).
   541*    12  FILLER                            PIC X(22).             ERCACCT
   542                                                                  ERCACCT
   543     12  AM-RESERVE-DATE.                                         ERCACCT
   544         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   545         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   546         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   547                                                                  ERCACCT
   548     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   549     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   550         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   551         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   552         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   553         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   554                                                                  ERCACCT
   555     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   556         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   557         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   558         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   559         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   560                                                                  ERCACCT
   561     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   562         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   563             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   564             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   565             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   566             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   567             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   568             20  FILLER                    PIC XX.                ERCACCT
   569         16  FILLER                        PIC X(80).             ERCACCT
   570                                                                  ERCACCT
   571     12  AM-TRANSFER-DATA.                                        ERCACCT
   572         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   573             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   574             20  AM-TRNFROM-GROUPING.                             ERCACCT
   575                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   576                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   577             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   578             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   579                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   580                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   581             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   582         16  AM-TRANSFERRED-TO.                                   ERCACCT
   583             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   584             20  AM-TRNTO-GROUPING.                               ERCACCT
   585                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   586                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   587             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   588             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   589                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   590                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   591             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   592         16  FILLER                        PIC X(10).             ERCACCT
   593                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS0633.cbl
   594     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   595                                                                  ERCACCT
   596     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   597         16  AM-DEFN-1-SAVED.                                     ERCACCT
   598             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   599                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   600                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   601                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   602                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   603                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   604                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   605                 24  FILLER                PIC X.                 ERCACCT
   606                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   607                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   608                 24  FILLER                PIC X.                 ERCACCT
   609         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   610             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   611                 24  FILLER                PIC X(11).             ERCACCT
   612                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   613                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   614                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   615                 24  FILLER                PIC X(6).              ERCACCT
   616                                                                  ERCACCT
   617     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   618         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   619            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   620            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   621            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   622                                                                  ERCACCT
   623     12  FILLER                            PIC X(130).            ERCACCT
   624                                                                  ERCACCT
   625     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   626         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   627         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   628             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   629             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   630                                                          COMP-3. ERCACCT
   631             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   632                                                          COMP-3. ERCACCT
   633         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   634             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   635             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   636                                                          COMP-3. ERCACCT
   637             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   638                                                          COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   641         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   642         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   643         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   644         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   645             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   646                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   647                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   648             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   649                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   650                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   651             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS0633.cbl
   652                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   653                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   654         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   655             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   656                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   657                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   658                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   659             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   660                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   661                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   662             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   663                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   664                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   665                                                                  ERCACCT
   666     12  AM-COMMENTS.                                             ERCACCT
   667         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   668                                                                  ERCACCT
   669     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   670         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   671         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   672         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   673         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   674         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   675             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   676             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   677             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   678             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   679         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   680             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   681             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   682             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   683         16  FILLER                        PIC X(102).            ERCACCT
   684                                                                  ERCACCT
   685     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   686         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   687             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   688             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   689             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   690             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   691             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   692         16  FILLER                          PIC X(10).           ERCACCT
   693******************************************************************ERCACCT
   694
   695
   696 WORKING-STORAGE SECTION.
   697 77  FILLER  PIC X(32) VALUE '********************************'.
   698 77  FILLER  PIC X(32) VALUE '   ECS0633  WORKING STORAGE     '.
   699 77  FILLER  PIC X(32) VALUE '********************************'.
   700 77  S1                          PIC S999 VALUE +0 COMP-3.
   701
   702 01  ACCT-STATUS              PIC XX             VALUE '00'.
   703 01  WS-HOLD-STATE            PIC XX             VALUE SPACES.
   704 01  WS-LINE-COUNT            COMP-3  PIC S9(03) VALUE +60.
   705 01  WS-LINE-COUNT-MAX        COMP-3  PIC S9(03) VALUE +55.
   706 01  WS-PAGE                  COMP-3  PIC S9(05) VALUE +0.
   707 01  WS-RELEASE-SORT-COUNT    COMP-3  PIC S9(05) VALUE +0.
   708 01  WS-RETURN-SORT-COUNT     COMP-3  PIC S9(05) VALUE +0.
   709 01  WS-EOF-SW                        PIC  X(01) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS0633.cbl
   710     88  END-OF-COMM-IN                          VALUE 'Y'.
   711
   712 01  WS-EOF-SW2                       PIC  X(01) VALUE SPACE.
   713     88  END-OF-SORT-FILE                        VALUE 'Y'.
   714 01  WS-ACCT-REC-FOUND                PIC  X(01) VALUE 'N'.
   715     88  ACCT-REC-FOUND                          VALUE 'Y'.
   716
   717 01  COMM-RECS-IN                     PIC  9(09) VALUE ZEROS.
   718 01  SUB1                             PIC S9(05) VALUE +0 COMP-3.
   719 01  PGM-SUB                   COMP-3 PIC S9(03) VALUE +0.
   720
   721 01  WS-ABEND-FIELDS.
   722     05  WS-RETURN-CODE               PIC S9(04) VALUE ZERO.
   723     05  WS-ZERO                      PIC S9(01) VALUE ZERO.
   724     05  WS-ABEND-MESSAGE             PIC  X(80) VALUE SPACES.
   725     05  WS-ABEND-FILE-STATUS         PIC  X(02) VALUE ZERO.
   726
   727***** SORT WORK AREA  *****
   728 01  WS-SORT-REC.
   729     05  WS-SORT-KEY.
   730         10  WS-SORT-CARRIER          PIC  X(01) VALUE SPACE.
   731         10  WS-SORT-STATE            PIC  X(02) VALUE SPACES.
   732         10  WS-SORT-ACCOUNT-NUM      PIC  X(10) VALUE SPACES.
   733     05  WS-SORT-ACCOUNT-NAME         PIC  X(30) VALUE SPACES.
   734
   735 01  HD1.
   736     12  FILLER              PIC  X(01)      VALUE '1'.
   737     12  FILLER              PIC  X(43)      VALUE SPACES.
   738     12  FILLER              PIC  X(44)      VALUE
   739             '      ACCOUNTS WRITING FOR FIRST TIME       '.
   740     12  FILLER              PIC  X(26)      VALUE SPACES.
   741     12  FILLER              PIC  X(08)      VALUE 'ECS0633'.
   742     12  FILLER              PIC  X(05)      VALUE SPACES.
   743
   744 01  HD2.
   745     12  FILLER              PIC  X(51)      VALUE SPACES.
   746     12  HD-CO               PIC  X(30).
   747     12  FILLER              PIC  X(33)      VALUE SPACES.
   748     12  HD-RUN-DT           PIC  X(08)      VALUE SPACES.
   749     12  FILLER              PIC  X(05)      VALUE SPACES.
   750
   751 01  HD3.
   752     12  FILLER              PIC  X(57)      VALUE SPACES.
   753     12  HD-DT               PIC  X(18).
   754     12  FILLER              PIC  X(39)      VALUE SPACES.
   755     12  FILLER              PIC  X(05)      VALUE 'PAGE '.
   756     12  HD-PG               PIC ZZ,ZZ9.
   757     12  FILLER              PIC  X(05)      VALUE SPACES.
   758
   759 01  HD4.
   760     12  FILLER              PIC  X(01)   VALUE '0'.
   761     12  FILLER              PIC  X(31)   VALUE SPACES.
   762     12  FILLER              PIC  X(07)   VALUE 'CARRIER'.
   763     12  FILLER              PIC  X(02)   VALUE SPACES.
   764     12  FILLER              PIC  X(05)   VALUE 'STATE'.
   765     12  FILLER              PIC  X(03)   VALUE SPACES.
   766     12  FILLER              PIC  X(11)   VALUE 'ACCOUNT NUM'.
   767     12  FILLER              PIC  X(05)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS0633.cbl
   768     12  FILLER              PIC  X(12)   VALUE 'ACCOUNT NAME'.
   769     12  FILLER              PIC  X(56)   VALUE SPACES.
   770
   771 01  DETAIL-LINE.
   772     05  FILLER              PIC  X(35)      VALUE SPACES.
   773     05  DET-CARRIER         PIC  X(01).
   774     05  FILLER              PIC  X(07)      VALUE SPACES.
   775     05  DET-STATE           PIC  X(02).
   776     05  FILLER              PIC  X(05)      VALUE SPACES.
   777     05  DET-ACCOUNT-NUM     PIC  X(10).
   778     05  FILLER              PIC  X(05)      VALUE SPACES.
   779     05  DET-ACCOUNT-NAME    PIC  X(30).
   780     05  FILLER              PIC  X(40)      VALUE SPACES.
   781
   782 01  DET-NO-NEW.
   783     05  FILLER              PIC X(35)       VALUE SPACES.
   784     05  FILLER              PIC X(50)       VALUE
   785          'NO ACCOUNTS WRITING FOR THE FIRST TIME THIS MONTH'.
   786     05  FILLER              PIC X(48)       VALUE SPACES.
   787
   788 01  BLANK-LINE              PIC  X(133)     VALUE SPACES.
   789
*  790 COPY ERCCOMP.
   791******************************************************************
   792*                                                                *
   793*                                                                *
   794*                            ERCCOMP                             *
   795*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   796*                            VMOD=2.019                          *
   797*                                                                *
   798*   ONLINE CREDIT SYSTEM                                         *
   799*                                                                *
   800*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   801*                                                                *
   802*   FILE TYPE = VSAM,KSDS                                        *
   803*   RECORD SIZE = 700   RECFORM = FIXED                          *
   804*                                                                *
   805*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   806*       ALTERNATE PATH = NONE                                    *
   807*                                                                *
   808*   LOG = NO                                                     *
   809*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   810*                                                                *
   811******************************************************************
   812*                   C H A N G E   L O G
   813*
   814* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   815*-----------------------------------------------------------------
   816*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   817* EFFECTIVE    NUMBER
   818*-----------------------------------------------------------------
   819* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   820* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   821* 092205    2005050300006  PEMA  ADD LEASE FEE
   822* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   823* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   824* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   825* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS0633.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   826* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   827* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   828******************************************************************
   829
   830 01  COMPENSATION-MASTER.
   831     12  CO-RECORD-ID                          PIC XX.
   832         88  VALID-CO-ID                          VALUE 'CO'.
   833
   834     12  CO-CONTROL-PRIMARY.
   835         16  CO-COMPANY-CD                     PIC X.
   836         16  CO-CONTROL.
   837             20  CO-CTL-1.
   838                 24  CO-CARR-GROUP.
   839                     28  CO-CARRIER            PIC X.
   840                     28  CO-GROUPING.
   841                         32  CO-GROUP-PREFIX   PIC XXX.
   842                         32  CO-GROUP-PRIME    PIC XXX.
   843                 24  CO-RESP-NO.
   844                     28  CO-RESP-PREFIX        PIC X(4).
   845                     28  CO-RESP-PRIME         PIC X(6).
   846             20  CO-CTL-2.
   847                 24  CO-ACCOUNT.
   848                     28  CO-ACCT-PREFIX        PIC X(4).
   849                     28  CO-ACCT-PRIME         PIC X(6).
   850         16  CO-TYPE                           PIC X.
   851             88  CO-COMPANY-TYPE                  VALUE 'C'.
   852             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   853             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   854
   855     12  CO-MAINT-INFORMATION.
   856         16  CO-LAST-MAINT-DT                  PIC XX.
   857         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   858         16  CO-LAST-MAINT-USER                PIC X(4).
   859     12  FILLER                                PIC XX.
   860     12  CO-STMT-TYPE                          PIC XXX.
   861     12  CO-COMP-TYPE                          PIC X.
   862         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   863     12  CO-STMT-OWNER                         PIC X(4).
   864     12  CO-BALANCE-CONTROL                    PIC X.
   865         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   866         88  CO-NO-BALANCE                        VALUE 'N'.
   867
   868     12  CO-INTERNAL-CONTROL-1                 PIC X.
   869         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   870         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   871         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   872
   873     12  CO-INTERNAL-CONTROL-2                 PIC X.
   874         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   875         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   876
   877     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   878     12  CO-GA-DIRECT-DEP                      PIC X.
   879     12  CO-FUTURE-SPACE                       PIC X.
   880         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   881
   882     12  CO-ACCT-NAME                          PIC X(30).
   883     12  CO-MAIL-NAME                          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS0633.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   884     12  CO-ADDR-1                             PIC X(30).
   885     12  CO-ADDR-2                             PIC X(30).
   886     12  CO-ADDR-3.
   887         16  CO-ADDR-CITY                      PIC X(27).
   888         16  CO-ADDR-STATE                     PIC XX.
   889     12  CO-CSO-1099                           PIC X.
   890     12  CO-ZIP.
   891         16  CO-ZIP-PRIME.
   892             20  CO-ZIP-PRI-1ST                PIC X.
   893                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   894             20  FILLER                        PIC X(4).
   895         16  CO-ZIP-PLUS4                      PIC X(4).
   896     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   897         16  CO-CAN-POSTAL-1                   PIC XXX.
   898         16  CO-CAN-POSTAL-2                   PIC XXX.
   899         16  FILLER                            PIC XXX.
   900     12  CO-SOC-SEC                            PIC X(13).
   901     12  CO-TELEPHONE.
   902         16  CO-AREA-CODE                      PIC XXX.
   903         16  CO-PREFIX                         PIC XXX.
   904         16  CO-PHONE                          PIC X(4).
   905
   906     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   907
   908     12  CO-AR-BAL-LEVEL                       PIC X.
   909         88  CO-AR-REF-LVL                        VALUE '1'.
   910         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   911         88  CO-AR-BILL-LVL                       VALUE '2'.
   912         88  CO-AR-AGT-LVL                        VALUE '3'.
   913         88  CO-AR-FR-LVL                         VALUE '4'.
   914
   915     12  CO-AR-NORMAL-PRINT                    PIC X.
   916         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   917         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   918
   919     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   920
   921     12  CO-AR-REPORTING                       PIC X.
   922         88  CO-AR-NET-REPORT                     VALUE 'N'.
   923         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   924
   925     12  CO-AR-PULL-CHECK                      PIC X.
   926         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   927         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   928
   929     12  CO-AR-BALANCE-PRINT                   PIC X.
   930         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   931
   932     12  CO-AR-LAST-RUN-CODE                   PIC X.
   933         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   934         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   935         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   936
   937     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   938
   939     12  CO-USER-CODE                          PIC X.
   940     12  CO-REPORT-GROUP-ID                    PIC X(12).
   941
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS0633.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   942******************************************************************
   943*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   944*    THE LAST MONTH END RUN.
   945******************************************************************
   946
   947     12  CO-LAST-ACTIVITY-DATE.
   948         16  CO-ACT-YEAR                       PIC 99.
   949         16  CO-ACT-MONTH                      PIC 99.
   950         16  CO-ACT-DAY                        PIC 99.
   951
   952     12  CO-LAST-STMT-DT.
   953         16  CO-LAST-STMT-YEAR                 PIC 99.
   954         16  CO-LAST-STMT-MONTH                PIC 99.
   955         16  CO-LAST-STMT-DAY                  PIC 99.
   956
   957     12  CO-MO-END-TOTALS.
   958         16  CO-MONTHLY-TOTALS.
   959             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   960             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   961             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   962             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   963             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   964
   965         16  CO-AGING-TOTALS.
   966             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   967             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   968             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   969             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   970
   971         16  CO-YTD-TOTALS.
   972             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   973             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   974
   975         16  CO-OVER-UNDER-TOTALS.
   976             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   977             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   978
   979     12  CO-MISCELLANEOUS-TOTALS.
   980         16  CO-FICA-TOTALS.
   981             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   982             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   983
   984         16  CO-CLAIM-TOTALS.
   985             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   986             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   987
   988******************************************************************
   989*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   990*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   991******************************************************************
   992
   993     12  CO-CURRENT-TOTALS.
   994         16  CO-CURRENT-LAST-STMT-DT.
   995             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   996             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   997             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   998
   999         16  CO-CURRENT-MONTHLY-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS0633.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1000             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1001             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1002             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1003             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1004             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1005
  1006         16  CO-CURRENT-AGING-TOTALS.
  1007             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1008             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1009             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1010             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1011
  1012         16  CO-CURRENT-YTD-TOTALS.
  1013             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1014             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1015
  1016     12  CO-PAID-COMM-TOTALS.
  1017         16  CO-YTD-PAID-COMMS.
  1018             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1019             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1020
  1021     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1022         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1023         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1024
  1025     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1026         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1027         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1028         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1029         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1030         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1031         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1032         88  CO-FINAL-LETTER                  VALUE 'F'.
  1033         88  CO-RECONCILING                   VALUE 'R'.
  1034         88  CO-PHONE-CALL                    VALUE 'P'.
  1035         88  CO-LEGAL                         VALUE 'L'.
  1036         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1037         88  CO-WRITE-OFF                     VALUE 'W'.
  1038         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1039
  1040     12  CO-CSR-CODE                       PIC X(4).
  1041
  1042     12  CO-GA-STATUS-INFO.
  1043         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1044         16  CO-GA-TERMINATION-DT          PIC XX.
  1045         16  CO-GA-STATUS-CODE             PIC X.
  1046             88  CO-GA-ACTIVE                 VALUE 'A'.
  1047             88  CO-GA-INACTIVE               VALUE 'I'.
  1048             88  CO-GA-PENDING                VALUE 'P'.
  1049         16  CO-GA-COMMENTS.
  1050             20  CO-GA-COMMENT-1           PIC X(40).
  1051             20  CO-GA-COMMENT-2           PIC X(40).
  1052             20  CO-GA-COMMENT-3           PIC X(40).
  1053             20  CO-GA-COMMENT-4           PIC X(40).
  1054
  1055     12  CO-RPTCD2                         PIC X(10).
  1056     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1057         16  CO-OV120                      PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS0633.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1058         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1059
  1060     12  CO-TYPE-AGENT                     PIC X(01).
  1061         88  CO-CORPORATION                   VALUE 'C'.
  1062         88  CO-PARTNERSHIP                   VALUE 'P'.
  1063         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1064         88  CO-TRUST                         VALUE 'T'.
  1065         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1066
  1067     12  CO-FAXNO.
  1068         16  CO-FAX-AREA-CODE                  PIC XXX.
  1069         16  CO-FAX-PREFIX                     PIC XXX.
  1070         16  CO-FAX-PHONE                      PIC X(4).
  1071
  1072     12  CO-BANK-INFORMATION.
  1073         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1074         16  CO-BANK-TRANSIT-NON REDEFINES
  1075             CO-BANK-TRANSIT-NO                PIC 9(8).
  1076
  1077         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1078     12  CO-MISC-DEDUCT-INFO REDEFINES
  1079                  CO-BANK-INFORMATION.
  1080         16  CO-MD-GL-ACCT                     PIC X(10).
  1081         16  CO-MD-DIV                         PIC XX.
  1082         16  CO-MD-CENTER                      PIC X(4).
  1083         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1084         16  CO-CREATE-AP-CHECK                PIC X.
  1085         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1086         16  FILLER                            PIC XXX.
  1087     12  CO-ACH-STATUS                         PIC X.
  1088         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1089         88  CO-ACH-PENDING                        VALUE 'P'.
  1090
  1091     12  CO-BILL-SW                            PIC X.
  1092     12  CO-CONTROL-NAME                       PIC X(30).
  1093     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1094     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1095     12  CO-CLP-STATE                          PIC XX.
  1096     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1097     12  CO-SPP-REFUND-EDIT                    PIC X.
  1098
  1099******************************************************************
* 1100 COPY ELCDATE.
  1101******************************************************************06/11/98
  1102*                                                                *ELCDATE
  1103*                                                                *ELCDATE
  1104*                            ELCDATE.                            *   LV023
  1105*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1106*                            VMOD=2.003                           ELCDATE
  1107*                                                                *ELCDATE
  1108*                                                                *ELCDATE
  1109*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1110*                 LENGTH = 200                                   *   CL*19
  1111******************************************************************ELCDATE
  1112                                                                  ELCDATE
  1113 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1114     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1115     12  DC-OPTION-CODE                PIC X.                        CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1116         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1117         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1118         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1119         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1120         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1121         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1122         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1123         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1124         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1125         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1126         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1127         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1128         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1129         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1130         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1131         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1132         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1133         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1134         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1135         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1136         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1137         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1138         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1139         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1140         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1141         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1142         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1143         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1144         88  THREE-CHARACTER-BIN                                  ELCDATE
  1145                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1146         88  GREGORIAN-TO-BIN                                        CL**2
  1147                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1148         88  BIN-TO-GREGORIAN                                        CL**2
  1149                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1150         88  JULIAN-TO-BINARY                                        CL**2
  1151                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1152     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1153         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1154         88  DATE-CONVERSION-ERROR                                ELCDATE
  1155                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1156         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1157         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1158         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1159         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1160         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1161         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1162         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1163         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1164         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1165         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1166     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1167         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1168     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1169         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1170         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1171         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1172     12  FILLER                        PIC X.                        CL*15
  1173     12  DC-CONVERSION-DATES.                                        CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1174         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1175         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1176         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1177         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1178                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1179             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1180             20  SLASH1-1              PIC X.                        CL*15
  1181             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1182             20  SLASH1-2              PIC X.                        CL*15
  1183             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1184         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1185         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1186                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1187             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1188             20  SLASH2-1              PIC X.                        CL*15
  1189             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1190             20  SLASH2-2              PIC X.                        CL*15
  1191             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1192         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1193         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1194                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1195             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1196             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1197             20  DC-YMD-DAY            PIC 99.                       CL*15
  1198         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1199         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1200                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1201             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1202             20  DC-MDY-DAY            PIC 99.                       CL*15
  1203             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1204         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1205             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1206             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1207             20  FILLER                PIC XX.                       CL*15
  1208             20  DC-ALPHA-CENTURY.                                   CL*15
  1209                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1210             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1211         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1212         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1213         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1214         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1215         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1216                                       PIC 9(05).                    CL*20
  1217         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1218             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1219             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1220         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1221         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1222         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1223     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1224         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1225         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1226             20  FILLER                PIC 9(3).                     CL*15
  1227             20  HOLD-CEN-1-CCYY.                                    CL*15
  1228                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1229                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1230             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1231             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1233             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1234             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1235             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1236                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1237                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1238             20  FILLER                PIC 9(3).                     CL*15
  1239         16  HOLD-CENTURY-1-X.                                       CL*15
  1240             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1241             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1242                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1243                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1244             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1245             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1246         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1247             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1248             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1249             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1250                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1251                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1252             20  FILLER                PIC XXX.                      CL*23
  1253         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1254         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1255         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1256         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1257             20  DC-JULIAN-1-CCYY.                                   CL*15
  1258                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1259                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1260             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1261         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1262         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1263             20  DC-JULIAN-2-CCYY.                                   CL*15
  1264                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1265                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1266             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1267         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1268             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1269             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1270             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1271             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1272             20  DC-EDITA-CCYY.                                      CL*15
  1273                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1274                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1275         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1276             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1277             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1278             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1279             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1280             20  DC-EDITB-CCYY.                                      CL*15
  1281                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1282                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1283         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1284         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1285                              DC-GREG-DATE-CYMD.                  ELCDATE
  1286             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1287             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1288             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1289             20  DC-CYMD-DAY           PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1290         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1291         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1292                              DC-GREG-DATE-MDCY.                  ELCDATE
  1293             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1294             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1295             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1296             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1297    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1298        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1299    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1300    12  FILLER                         PIC X(28).                    CL*26
* 1301 COPY ELCDTECX.
  1302******************************************************************06/05/98
  1303*                                                                *ELCDTECX
  1304*                            ELCDTECX.                           *   LV005
  1305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1306*                            VMOD=2.015                          *ELCDTECX
  1307*                                                                *ELCDTECX
  1308*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1309*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1310*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1311*                                                                *ELCDTECX
  1312******************************************************************ELCDTECX
  1313******************************************************************
  1314*                   C H A N G E   L O G
  1315*
  1316* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1317*-----------------------------------------------------------------
  1318*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1319* EFFECTIVE    NUMBER
  1320*-----------------------------------------------------------------
  1321* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1322*                                  BENEFIT CODES FROM 300 TO 900
  1323* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1324* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1325* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1326******************************************************************
  1327 01  DATE-CARD.                                                   ELCDTECX
  1328     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1329     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1330     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1331     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1332     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1333     12  EP-SW                       PIC  X.                      ELCDTECX
  1334         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1335     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1336         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1337     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1338     12  RUN-CENTURY.                                             ELCDTECX
  1339         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1340     12  FILLER                      PIC  X.                         CL**4
  1341     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1342     12  FILLER                      PIC  XXX.                    ELCDTECX
  1343     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1344                                                                  ELCDTECX
  1345 01  FILLER                          PIC  X(7)                       CL**6
  1346                                          VALUE 'OPTIONS'.        ELCDTECX
  1347 01  DATE-CARD-OPTIONS.                                           ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1349     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1350     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1351         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1352         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1353     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1354     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1355     12  FILLER                      PIC  X.                      ELCDTECX
  1356     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1357     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1358     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1359     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1360     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1361     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1362     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1363     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1364     12  FILLER                      PIC  X.                      ELCDTECX
  1365     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1366     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1367     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1368     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1369     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1370     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1371     12  FILLER                      PIC  X.                      ELCDTECX
  1372     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1373     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1374     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1375     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1376     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1377     12  DTE-R78                     PIC  X.                      ELCDTECX
  1378     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1379     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1380     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1381     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1382     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1383     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1384     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1385                                     PIC  X.                      ELCDTECX
  1386         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1387                                                 ' '.             ELCDTECX
  1388         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1389         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1390     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1391         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1392         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1393     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1394     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1395                                     PIC  9.                         CL**4
  1396     12  DTE-SYSTEM.                                              ELCDTECX
  1397         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1398         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1399         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1400         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1401         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1402         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1403         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1404         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1405         16  DTE-SYS-I               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1407         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1408         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1409         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1410         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1411         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1412         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1413         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1414         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1415         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1416         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1417         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1418         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1419         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1420         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1421         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1422         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1423     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1424         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1425                                     PIC  X.                      ELCDTECX
  1426     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1427                                                                  ELCDTECX
  1428 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1429     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1430     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1431     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1432*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1433     12  FILLER                      PIC  X.                      ELCDTECX
  1434     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1435     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1436     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1437     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1438     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1439     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1440     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1441                                                                  ELCDTECX
  1442     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1443     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1444     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1445     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1446                                                                  ELCDTECX
  1447     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1448     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1449     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1450     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1451                                                                  ELCDTECX
  1452     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1453     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1454                                                                  ELCDTECX
  1455     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1456     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1457                                                                  ELCDTECX
  1458     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1459                                                                  ELCDTECX
  1460 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1461     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1462     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1463     12  FAC-2                       PIC S999V9(5).               ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1465     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1466     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1467     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1468                                                                  ELCDTECX
  1469 01  FILLER                          PIC  X(12)                   ELCDTECX
  1470                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1471 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1472     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1473         16  CNT-ID                  PIC  X.                      ELCDTECX
  1474         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1475                                                                  ELCDTECX
  1476 01  FILLER                          PIC  X(11)                   ELCDTECX
  1477                                          VALUE 'STATE NAMES'.    ELCDTECX
  1478 01  STATE-NAMES.                                                 ELCDTECX
  1479     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1480         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1481         16  STATE-PIC1.                                          ELCDTECX
  1482             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1483             20  FILLER              PIC  XXX.                    ELCDTECX
  1484             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1485             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1486             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1487             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1488                                                                  ELCDTECX
  1489 01  FILLER                          PIC  X(13)                   ELCDTECX
  1490                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1491 01  CARRIER-NAMES.                                               ELCDTECX
  1492     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1493         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1494         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1495         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1496         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1497         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1498         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1499*        16  FILLER                  PIC  X.                      ELCDTECX
  1500         16  CARRIER-SEC-PAY         PIC  X.
  1501             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1502                                                                  ELCDTECX
  1503 01  FILLER                          PIC  X(9)                       CL**6
  1504                                          VALUE 'INS TYPES'.      ELCDTECX
  1505 01  CLAS-INS-TYPES.                                              ELCDTECX
  1506*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1507     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1508         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1509         16  CLAS-I-AB3.                                          ELCDTECX
  1510             20  FILLER              PIC  X.                      ELCDTECX
  1511             20  CLAS-I-AB2.                                      ELCDTECX
  1512                 24  FILLER          PIC  X.                      ELCDTECX
  1513                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1514         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1515             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1516             20  FILLER              PIC  X.                         CL**4
  1517         16  CLAS-I-AB10.                                         ELCDTECX
  1518             20  FILLER              PIC  X(9).                   ELCDTECX
  1519             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1520         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1521         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1522         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1523         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1524             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1525         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1526         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1527         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1528         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1529         16  CLAS-I-REFUND-METHOD    PIC  X.
  1530         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1531         16  FILLER                  PIC  XXX.
  1532                                                                  ELCDTECX
  1533 01  FILLER                          PIC  X(16)                   ELCDTECX
  1534                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1535 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1536     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1537                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1538         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1539         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1540         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1541         16  CLAS-MORT-DESC.                                      ELCDTECX
  1542             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1543             20  FILLER              PIC  XX.                        CL**5
  1544             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1545             20  FILLER              PIC  X.                         CL**5
  1546             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1547             20  FILLER              PIC  X.                         CL**5
  1548             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1549             20  FILLER              PIC  X.                         CL**5
  1550             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1551             20  FILLER              PIC  X(5).                      CL**6
  1552                                                                  ELCDTECX
  1553 01  FILLER                          PIC  X(15)                   ELCDTECX
  1554                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1555 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1556     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1557         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1558         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1559         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1560         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1561         16  FILLER                  PIC  X(4).                      CL**6
  1562                                                                  ELCDTECX
  1563 01  FILLER                          PIC  X(7)                       CL**6
  1564                                     VALUE 'INDEXES'.             ELCDTECX
  1565 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1566     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1567     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1568     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1569     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1570     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1571     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1572     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1573     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1574     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1575     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1576     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1577     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1578     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1579     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1580     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1581     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1582     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1583                                                                  ELCDTECX
  1584 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1585     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1586     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1587     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1588     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1589     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1590     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1591     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1592     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1593     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1594     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1595     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1596                                                                  ELCDTECX
  1597 01  FILLER                          PIC  X(13)                   ELCDTECX
  1598                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1599 01  CLAS-MISC.                                                   ELCDTECX
  1600     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1601         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1602         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1603         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1604     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1605     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1606     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1607     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1608     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1609     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1610     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1611     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1612     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1613     12  STATE-L                     PIC  XX.                     ELCDTECX
  1614     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1615     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1616     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1617         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1618         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1619     12  DTE-ABEND-WORK.                                          ELCDTECX
  1620         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1621         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1622                                                                  ELCDTECX
  1623 01  FILLER                          PIC  X(12)                   ELCDTECX
  1624                                     VALUE 'WORKING DATE'.        ELCDTECX
  1625 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1626     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1627         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1628         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1629         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1630     12  WS-CURRENT-DATE.                                         ELCDTECX
  1631         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1632         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1633         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1634         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1635         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1636     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1637         16  WS-TIME                 PIC  9(6).                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1638         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1639                                                                  ELCDTECX
  1640 01  FILLER                          PIC  X(12)                   ELCDTECX
  1641                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1642 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1643     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1644         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1645         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1646         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1647                                                                  ELCDTECX
  1648 01  FILLER                          PIC  X(10)                   ELCDTECX
  1649                                     VALUE 'STATE TLRS'.          ELCDTECX
  1650 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1651     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1652         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1653         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1654                                                                  ELCDTECX
  1655 01  FILLER                          PIC  X(13)                   ELCDTECX
  1656                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1657 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1658     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1659         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1660                                                                  ELCDTECX
  1661 01  FILLER                          PIC  X(13)                   ELCDTECX
  1662                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1663 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1664     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1665     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1666     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1667                                     PIC  X.                         CL**5
  1668     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1669     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1670     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1671     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1672     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1673     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1674     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1675     12  FILLER                      PIC  X(75).                  ELCDTECX
  1676******************************************************************ELCDTECX
  1677*01  MISC-CARR-PCT-DATA.                                          00001521
  1678*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1679*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1680*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1681*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1682*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1683*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1684******************************************************************ELCDTECX
* 1685 COPY ELCDTEVR.
  1686***************************************************************** 04/15/98
  1687*                                                                *ELCDTEVR
  1688*                                                                *ELCDTEVR
  1689*                            ELCDTEVR.                           *   LV003
  1690*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1691*                            VMOD=2.001                          *   CL**2
  1692*                                                                *ELCDTEVR
  1693*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1694*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1695*                                                                *ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1696******************************************************************ELCDTEVR
  1697 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1698     05  WS-RUN-DATE.                                             ELCDTEVR
  1699         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1700         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1701         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1702             15  RUN-CC              PIC  99.                     ELCDTEVR
  1703             15  RUN-YR              PIC  99.                     ELCDTEVR
  1704         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1705         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1706     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1707            WS-RUN-DATE              PIC 9(11).                      CL**2
  1708     05  WS-EP-DT.                                                ELCDTEVR
  1709         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1710         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1711         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1712             15  EP-CC               PIC  99.                     ELCDTEVR
  1713             15  EP-YR               PIC  99.                     ELCDTEVR
  1714         10  EP-MO                   PIC  99.                     ELCDTEVR
  1715         10  EP-DA                   PIC  99.                     ELCDTEVR
  1716     05  WS-EP-DT-N REDEFINES                                        CL**2
  1717            WS-EP-DT                 PIC 9(11).                      CL**2
  1718     05  WS-DTE-CONV-DT.                                             CL**4
  1719         10  FILLER                  PIC  9(03).                     CL**4
  1720         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1721         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1722             15  DTE-CONV-CC         PIC  99.                        CL**4
  1723             15  DTE-CONV-YR         PIC  99.                        CL**4
  1724         10  DTE-CONV-MO             PIC  99.                        CL**4
  1725         10  DTE-CONV-DA             PIC  99.                        CL**4
  1726     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1727            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1728 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1729     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1730         10  FILLER                            PIC 999.           ELCDTEVR
  1731         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1732         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1733             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1734             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1735         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1736         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1737     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1738            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1739     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1740         10  FILLER                            PIC 999.           ELCDTEVR
  1741         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1742         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1743         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1744         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1745     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1746            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1747 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1748     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1749         10  FILLER                            PIC 999.           ELCDTEVR
  1750         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1751         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1752             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1753             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1754         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1755         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1756     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1757            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1758     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1759         10  FILLER                            PIC 999.           ELCDTEVR
  1760         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1761         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1762             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1763             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1764         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1765         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1766     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1767            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1768     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1769         10  FILLER                            PIC 999.           ELCDTEVR
  1770         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1771         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1772             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1773             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1774         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1775         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1776     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1777            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1778 01  WS-RATE-RECORD.                                              ELCDTEVR
  1779         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1780             10  FILLER                        PIC 999.           ELCDTEVR
  1781             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1782             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1783                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1784                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1785             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1786             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1787         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1788                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1789
  1790 PROCEDURE DIVISION.
  1791
  1792******************************************************************
  1793***        D A T E   C A R D   L O A D   R O U T I N E         ***
  1794******************************************************************
  1795
* 1796     COPY ELCDTERX.
  1797******************************************************************04/15/98
  1798*                                                                *ELCDTERX
  1799*                                                                *ELCDTERX
  1800*                            ELCDTERX.                           *   LV002
  1801*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1802*                            VMOD=2.007                          *ELCDTERX
  1803*                                                                *ELCDTERX
  1804*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1805*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1806*      = ELCDTEFD)                                               *ELCDTERX
  1807*                                                                *ELCDTERX
  1808******************************************************************ELCDTERX
  1809                                                                  ELCDTERX
  1810     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1811                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1812     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1813     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1814     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1815                                                                  ELCDTERX
  1816     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1817                                                                  ELCDTERX
  1818******************************************************************ELCDTERX
  1819*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1820*          WARNING MESSAGES.                                      ELCDTERX
  1821******************************************************************ELCDTERX
  1822     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1823         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1824                                                                  ELCDTERX
  1825     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1826                                                                  ELCDTERX
  1827     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1828                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1829                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1830                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1831                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1832                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1833                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1834                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1835                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1836                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1837                                                                  ELCDTERX
  1838     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1839                                                                  ELCDTERX
  1840     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1841                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1842                                                                  ELCDTERX
  1843     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1844     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1845     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1846     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1847                                                                  ELCDTERX
  1848     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1849         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1850     ELSE                                                         ELCDTERX
  1851         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1852                                                                  ELCDTERX
  1853     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1854         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1855     ELSE                                                         ELCDTERX
  1856         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1857                                                                  ELCDTERX
  1858 0005-READ--CARD.                                                 ELCDTERX
  1859     READ DISK-DATE                                               ELCDTERX
  1860         AT END CLOSE DISK-DATE                                   ELCDTERX
  1861             GO TO 0060-READ--TEST.                               ELCDTERX
  1862                                                                  ELCDTERX
  1863     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1864                                                                  ELCDTERX
  1865     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1866         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1867         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1868         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1869         GO TO 0005-READ--CARD.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1870                                                                  ELCDTERX
  1871     IF DD-ID = 'CLAD'                                            ELCDTERX
  1872         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1873         GO TO 0005-READ--CARD.                                   ELCDTERX
  1874                                                                  ELCDTERX
  1875     IF DD-ID = 'CLAX'                                            ELCDTERX
  1876         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1877         GO TO 0005-READ--CARD.                                   ELCDTERX
  1878                                                                  ELCDTERX
  1879     IF DD-ID = 'CLAF'                                            ELCDTERX
  1880         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1881         GO TO 0005-READ--CARD.                                   ELCDTERX
  1882                                                                  ELCDTERX
  1883     IF DD-ID = 'CLAC'                                            ELCDTERX
  1884         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1885                                                                  ELCDTERX
  1886     IF DD-ID = 'CARR'                                            ELCDTERX
  1887         GO TO 0015-READ--CARR.                                   ELCDTERX
  1888                                                                  ELCDTERX
  1889     IF DD-ID = 'STAT'                                            ELCDTERX
  1890         GO TO 0020-READ--STAT.                                   ELCDTERX
  1891                                                                  ELCDTERX
  1892     IF DD-ID = 'BUSC'                                            ELCDTERX
  1893         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1894                                                                  ELCDTERX
  1895     IF DD-ID = 'MORT'                                            ELCDTERX
  1896         GO TO 0030-READ--MORT.                                   ELCDTERX
  1897                                                                  ELCDTERX
  1898     IF DD-ID = 'CLAI'                                            ELCDTERX
  1899         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1900                                                                  ELCDTERX
  1901     IF DD-ID = 'COLC'                                            ELCDTERX
  1902         GO TO 0065-READ--COLC.                                   ELCDTERX
  1903                                                                  ELCDTERX
  1904     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1905        DD-IDA = 'CL'                                             ELCDTERX
  1906         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1907                                                                  ELCDTERX
  1908     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1909        DD-IDA = 'PO'                                             ELCDTERX
  1910         GO TO 0050-READ--POXX.                                   ELCDTERX
  1911                                                                  ELCDTERX
  1912     IF DD-ID = 'OPCA'                                            ELCDTERX
  1913         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1914                                                                  ELCDTERX
  1915     IF DD-ID = 'OPST'                                            ELCDTERX
  1916         GO TO 0072-READ--OPST.                                   ELCDTERX
  1917                                                                  ELCDTERX
  1918     IF DD-ID = 'OPBS'                                            ELCDTERX
  1919         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1920                                                                  ELCDTERX
  1921     IF DD-ID = 'OPMS'                                            ELCDTERX
  1922         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1923                                                                  ELCDTERX
  1924     GO TO 0005-READ--CARD.                                       ELCDTERX
  1925                                                                  ELCDTERX
  1926 0010-READ--CLAC.                                                 ELCDTERX
  1927     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1928     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1929     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1930     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1931     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1932     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1933     GO TO 0005-READ--CARD.                                       ELCDTERX
  1934                                                                  ELCDTERX
  1935 0015-READ--CARR.                                                 ELCDTERX
  1936     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1937     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1938        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1939        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1940        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1941        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1942        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1943        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1944        MOVE DD-CARR1-SECPAY-SW
  1945                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1946     END-IF
  1947                                                                  ELCDTERX
  1948     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1949     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1950        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1951        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1952        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1953        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1954        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1955        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1956        MOVE DD-CARR2-SECPAY-SW
  1957                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1958     END-IF
  1959                                                                  ELCDTERX
  1960                                                                  ELCDTERX
  1961     GO TO 0005-READ--CARD.                                       ELCDTERX
  1962                                                                  ELCDTERX
  1963 0020-READ--STAT.                                                 ELCDTERX
  1964     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1965     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1966        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1967         GO TO 0005-READ--CARD.                                   ELCDTERX
  1968                                                                  ELCDTERX
  1969     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1970     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1971     GO TO 0020-READ--STAT.                                       ELCDTERX
  1972                                                                  ELCDTERX
  1973 0025-READ--BUSC.                                                 ELCDTERX
  1974     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1975     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1976        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1977         GO TO 0005-READ--CARD.                                   ELCDTERX
  1978                                                                  ELCDTERX
  1979     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1980     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1981     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1982                                                                  ELCDTERX
  1983 0030-READ--MORT.                                                 ELCDTERX
  1984     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1985     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1986        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1987         GO TO 0005-READ--CARD.                                   ELCDTERX
  1988                                                                  ELCDTERX
  1989     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1990     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1991     GO TO 0030-READ--MORT.                                       ELCDTERX
  1992                                                                  ELCDTERX
  1993 0035-READ--CLXX.                                                 ELCDTERX
  1994     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1995          GO TO 0005-READ--CARD.                                  ELCDTERX
  1996                                                                  ELCDTERX
  1997     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1998         DISPLAY '***********************************************'ELCDTERX
  1999         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2000         DISPLAY '***********************************************'ELCDTERX
  2001         GO TO 0055-READ--STOP.                                   ELCDTERX
  2002                                                                  ELCDTERX
  2003     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2004        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2005         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2006                                                                  ELCDTERX
  2007     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2008        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2009         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2010                                                                  ELCDTERX
  2011*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2012     GO TO 0005-READ--CARD.                                       ELCDTERX
  2013                                                                  ELCDTERX
  2014 0040-READ--CLAI.                                                 ELCDTERX
  2015     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2016     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2017        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2018         GO TO 0005-READ--CARD.                                   ELCDTERX
  2019                                                                  ELCDTERX
  2020     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2021     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2022     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2023                                                                  ELCDTERX
  2024 0045-READ--DUMP.                                                 ELCDTERX
  2025     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2026     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2027                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2028     PERFORM ABEND-PGM.                                           ELCDTERX
  2029                                                                  ELCDTERX
  2030 0050-READ--POXX.                                                 ELCDTERX
  2031     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2032         GO TO 0005-READ--CARD.                                   ELCDTERX
  2033                                                                  ELCDTERX
  2034     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2035         DISPLAY '***********************************************'ELCDTERX
  2036         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2037         DISPLAY '***********************************************'ELCDTERX
  2038         GO TO 0055-READ--STOP.                                   ELCDTERX
  2039                                                                  ELCDTERX
  2040     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2041     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2042     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2043     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2044                                                                  ELCDTERX
  2045     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2046         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2047     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2048         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2049                                                                  ELCDTERX
  2050     GO TO 0005-READ--CARD.                                       ELCDTERX
  2051                                                                  ELCDTERX
  2052 0055-READ--STOP.                                                 ELCDTERX
  2053     GOBACK.                                                      ELCDTERX
  2054                                                                  ELCDTERX
  2055 0060-READ--TEST.                                                 ELCDTERX
  2056     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2057        CLAX-ID         = SPACE  OR                               ELCDTERX
  2058        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2059         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2060                                                                  ELCDTERX
  2061     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2062     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2063                                                                  ELCDTERX
  2064 0065-READ--COLC.                                                 ELCDTERX
  2065     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2066     GO TO 0005-READ--CARD.                                       ELCDTERX
  2067                                                                  ELCDTERX
  2068 0070-READ--OPCA.                                                 ELCDTERX
  2069                                                                  ELCDTERX
  2070     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2071                                                                  ELCDTERX
  2072     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2073             OR                                                   ELCDTERX
  2074         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2075         GO TO 0005-READ--CARD.                                   ELCDTERX
  2076                                                                  ELCDTERX
  2077     ADD 1                       TO INDEXCA.                      ELCDTERX
  2078     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2079                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2080     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2081                                                                  ELCDTERX
  2082 0072-READ--OPST.                                                 ELCDTERX
  2083                                                                  ELCDTERX
  2084     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2085                                                                  ELCDTERX
  2086     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2087             OR                                                   ELCDTERX
  2088         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2089         GO TO 0005-READ--CARD.                                   ELCDTERX
  2090                                                                  ELCDTERX
  2091     ADD 1                       TO INDEXST.                      ELCDTERX
  2092     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2093                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2094     GO TO 0072-READ--OPST.                                       ELCDTERX
  2095                                                                  ELCDTERX
  2096 0074-READ--OPBS.                                                 ELCDTERX
  2097                                                                  ELCDTERX
  2098     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2099                                                                  ELCDTERX
  2100     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2101             OR                                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2102         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2103         GO TO 0005-READ--CARD.                                   ELCDTERX
  2104                                                                  ELCDTERX
  2105     ADD 1                       TO INDEXBS.                      ELCDTERX
  2106     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2107     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2108                                                                  ELCDTERX
  2109 0079-READ--EXIT.                                                 ELCDTERX
  2110*    EXIT.                                                        ELCDTERX
  2111******************************************************************ELCDTERX
  2112******************************************************************
  2113
  2114     PERFORM 0400-OPEN-FILES       THRU 0400-EXIT
  2115     PERFORM 0600-INITIALIZE       THRU 0600-EXIT
  2116
  2117     SORT SORT-WORK ASCENDING KEY  SORT-KEY
  2118         INPUT PROCEDURE
  2119             0100-INPUT-ROUTINE    THRU 0100-EXIT
  2120         OUTPUT PROCEDURE
  2121             0200-OUTPUT-ROUTINE   THRU 0200-EXIT
  2122
  2123     IF SORT-RETURN NOT = ZERO
  2124         MOVE 'SORT FAILED'        TO WS-ABEND-MESSAGE
  2125         MOVE SORT-RETURN          TO WS-RETURN-CODE
  2126         PERFORM ABEND-PGM         THRU APS-EXIT
  2127     END-IF
  2128
  2129     PERFORM 0500-CLOSE-FILES      THRU 0500-EXIT
  2130
  2131     DISPLAY ' COMM RECORDS READ    '  COMM-RECS-IN
  2132     DISPLAY ' SORT RECORDS RELEASED '  WS-RELEASE-SORT-COUNT
  2133     DISPLAY ' SORT RECORDS RETURNED '  WS-RETURN-SORT-COUNT
  2134     DISPLAY ' WS LINE COUNT '  WS-LINE-COUNT
  2135
  2136     GOBACK
  2137
  2138     .
  2139 0100-INPUT-ROUTINE.
  2140
  2141     PERFORM 0110-PROCESS-COMM-MSTR-IN     THRU 0110-EXIT
  2142         UNTIL END-OF-COMM-IN
  2143
  2144     .
  2145 0100-EXIT.
  2146     EXIT.
  2147
  2148
  2149 0110-PROCESS-COMM-MSTR-IN.
  2150
  2151     READ COMM-MSTR-IN
  2152         AT END
  2153             SET END-OF-COMM-IN  TO TRUE
  2154             GO TO 0110-EXIT
  2155     END-READ
  2156
  2157     ADD +1                      TO COMM-RECS-IN
  2158
  2159     MOVE COMP-IN-RECORD TO COMPENSATION-MASTER
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS0633.cbl
  2160
  2161     IF CO-TYPE = 'A'
  2162        CONTINUE
  2163     ELSE
  2164        GO TO 0110-EXIT
  2165     END-IF
  2166
  2167     IF CO-FIRST-WRITTEN-DT <> BIN-RUN-DATE
  2168         GO TO 0110-EXIT
  2169     END-IF
  2170
  2171     PERFORM 0150-GET-ACCT-STATE THRU 0150-EXIT
  2172
  2173     IF WS-ACCT-REC-FOUND = 'N'
  2174         DISPLAY "ACCOUNT REC NOT FOUND ON ACCT MSTR - "
  2175                  CO-RESP-NO
  2176         GO TO 0110-EXIT
  2177     END-IF
  2178
  2179     MOVE CO-CARRIER             TO WS-SORT-CARRIER
  2180     MOVE WS-HOLD-STATE          TO WS-SORT-STATE
  2181*     MOVE CO-ACCOUNT             TO WS-SORT-ACCOUNT-NUM
  2182     MOVE CO-RESP-NO             TO WS-SORT-ACCOUNT-NUM
  2183     MOVE CO-ACCT-NAME           TO WS-SORT-ACCOUNT-NAME
  2184
  2185     RELEASE SORT-REC            FROM WS-SORT-REC
  2186     ADD +1                      TO WS-RELEASE-SORT-COUNT
  2187
  2188     .
  2189 0110-EXIT.
  2190     EXIT.
  2191
  2192 0150-GET-ACCT-STATE.
  2193
  2194     MOVE CO-RESP-NO  TO AM-VG-KEY3-ACCOUNT
  2195     MOVE LOW-VALUES  TO AM-VG-KEY3-EXP-DT
  2196
  2197     START ERACCT3 KEY IS NOT < AM-VG-KEY3
  2198     EVALUATE ACCT-STATUS
  2199         WHEN '00'
  2200           CONTINUE
  2201         WHEN '23'
  2202           DISPLAY "ACCT MSTR REC NOT FOUND ON START - "
  2203                   CO-RESP-NO
  2204           MOVE 'N' TO WS-ACCT-REC-FOUND
  2205           GO TO 0150-EXIT
  2206         WHEN OTHER
  2207           MOVE ACCT-STATUS TO WS-ABEND-FILE-STATUS
  2208           MOVE 'START ERROR ON ERACCT FILE' TO WS-ABEND-MESSAGE
  2209           PERFORM ABEND-PGM
  2210     END-EVALUATE
  2211
  2212     READ ERACCT3 NEXT RECORD
  2213     EVALUATE ACCT-STATUS
  2214         WHEN '00'
  2215           CONTINUE
  2216         WHEN '10'
  2217           DISPLAY "ACCT MSTR NOT FOUND ON READ - " CO-RESP-NO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS0633.cbl
  2218           MOVE 'N' TO WS-ACCT-REC-FOUND
  2219           GO TO 0150-EXIT
  2220         WHEN OTHER
  2221           MOVE ACCT-STATUS TO WS-ABEND-FILE-STATUS
  2222           MOVE 'READ NEXT ERROR ON ERACCT FILE'
  2223                 TO WS-ABEND-MESSAGE
  2224           PERFORM ABEND-PGM
  2225     END-EVALUATE
  2226
  2227     IF (AM-COMPANY-CD NOT = DTE-CLASIC-COMPANY-CD)
  2228        OR (AM-CARRIER    NOT = CO-CARRIER)
  2229        OR (AM-GROUPING   NOT = CO-GROUPING)
  2230        OR (AM-ACCOUNT    NOT = CO-RESP-NO)
  2231            DISPLAY "ACCT NOT MATCHED - AM=" AM-ACCOUNT
  2232                    " CO=" CO-RESP-NO
  2233            MOVE 'N' TO WS-ACCT-REC-FOUND
  2234     ELSE
  2235         MOVE AM-STATE TO WS-HOLD-STATE
  2236         MOVE 'Y' TO WS-ACCT-REC-FOUND
  2237     END-IF
  2238
  2239     .
  2240 0150-EXIT.
  2241     EXIT.
  2242
  2243
  2244
  2245
  2246 0200-OUTPUT-ROUTINE.
  2247
  2248     PERFORM 0210-RETURN-SORT    THRU 0210-EXIT
  2249         UNTIL END-OF-SORT-FILE
  2250
  2251     IF WS-RETURN-SORT-COUNT = 0
  2252         MOVE DET-NO-NEW        TO DETAIL-LINE
  2253         PERFORM 0300-PRINT  THRU 0300-EXIT
  2254     END-IF
  2255
  2256     .
  2257 0200-EXIT.
  2258     EXIT.
  2259
  2260
  2261 0210-RETURN-SORT.
  2262
  2263     RETURN SORT-WORK                INTO WS-SORT-REC
  2264         AT END
  2265             SET END-OF-SORT-FILE    TO TRUE
  2266             GO TO 0210-EXIT
  2267     END-RETURN
  2268
  2269     ADD +1                          TO WS-RETURN-SORT-COUNT
  2270
  2271     MOVE WS-SORT-CARRIER            TO DET-CARRIER
  2272     MOVE WS-SORT-STATE              TO DET-STATE
  2273     MOVE WS-SORT-ACCOUNT-NUM        TO DET-ACCOUNT-NUM
  2274     MOVE WS-SORT-ACCOUNT-NAME       TO DET-ACCOUNT-NAME
  2275
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS0633.cbl
  2276     PERFORM 0300-PRINT              THRU 0300-EXIT
  2277
  2278     .
  2279 0210-EXIT.
  2280     EXIT.
  2281
  2282 0300-PRINT.
  2283
  2284     IF WS-LINE-COUNT > WS-LINE-COUNT-MAX
  2285         MOVE +0                     TO WS-LINE-COUNT
  2286         ADD +1                      TO WS-PAGE
  2287         MOVE WS-PAGE                TO HD-PG
  2288         WRITE PRT                   FROM HD1
  2289         WRITE PRT                   FROM HD2
  2290         WRITE PRT                   FROM HD3
  2291         WRITE PRT                   FROM HD4
  2292         WRITE PRT                   FROM BLANK-LINE
  2293         ADD +7                      TO WS-LINE-COUNT
  2294     END-IF
  2295
  2296     WRITE PRT                       FROM DETAIL-LINE
  2297     ADD +1                          TO WS-LINE-COUNT
  2298
  2299     .
  2300 0300-EXIT.
  2301     EXIT.
  2302
  2303 0400-OPEN-FILES.
  2304
  2305     OPEN INPUT COMM-MSTR-IN
  2306         OUTPUT PRNTR
  2307
  2308     OPEN INPUT ERACCT3
  2309     IF ACCT-STATUS = '00' OR '97'
  2310        CONTINUE
  2311     ELSE
  2312        MOVE ACCT-STATUS TO WS-ABEND-FILE-STATUS
  2313        MOVE 'OPEN ERROR ON ERACCT FILE' TO WS-ABEND-MESSAGE
  2314        PERFORM ABEND-PGM
  2315     END-IF
  2316
  2317     .
  2318
  2319 0400-EXIT.
  2320     EXIT.
  2321
  2322 0500-CLOSE-FILES.
  2323
  2324     CLOSE COMM-MSTR-IN
  2325           ERACCT3
  2326           PRNTR
  2327     .
  2328
  2329 0500-EXIT.
  2330     EXIT.
  2331
  2332 0600-INITIALIZE.
  2333
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS0633.cbl
  2334     MOVE COMPANY-NAME           TO HD-CO
  2335
  2336     ACCEPT WS-ACCEPT-DATE       FROM DATE
  2337     MOVE WS-AD-MM               TO WS-CD-MM
  2338     MOVE WS-AD-DD               TO WS-CD-DD
  2339     MOVE WS-AD-YY               TO WS-CD-YY
  2340     MOVE WS-CURRENT-DATE        TO HD-RUN-DT
  2341
  2342     MOVE ALPH-DATE              TO HD-DT
  2343
  2344     .
  2345 0600-EXIT.
  2346     EXIT.
  2347
  2348
  2349 8510-DATE-CONVERSION.
  2350
  2351     CALL 'ELDATCX' USING DATE-CONVERSION-DATA
  2352
  2353     .
  2354
  2355 8590-EXIT.
  2356     EXIT.
  2357
  2358 ABEND-PGM SECTION.
* 2359                               COPY ELCABEND.
  2360***************************************************************** 04/14/98
  2361*                                                               * ELCABEND
  2362*                            ELCABEND.                          *    LV003
  2363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2364*                            VMOD 2.002                              CL**2
  2365*                                                               * ELCABEND
  2366*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2367*            AND THEN ABENDS.                                   * ELCABEND
  2368*                                                               * ELCABEND
  2369*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2370*                                                               * ELCABEND
  2371***************************************************************** ELCABEND
  2372*APS-010.                                                         ELCABEND
  2373     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2374     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2375                                                                  ELCABEND
  2376     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2377         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2378         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2379                                 UPON CONSOLE.                    ELCABEND
  2380                                                                  ELCABEND
  2381     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2382         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2383         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2384                                 UPON CONSOLE.                    ELCABEND
  2385                                                                  ELCABEND
  2386     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2387     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2388                                 UPON CONSOLE.                    ELCABEND
  2389                                                                  ELCABEND
  2390     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2391     CALL 'ABORTME'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS0633.cbl (/apps/prod/cid1p/copy/ELCABEND)
  2392                                                                  ELCABEND
  2393 APS-EXIT.                                                        ELCABEND
  2394     EXIT.                                                        ELCABEND
  2395
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       52676     Code:        5458
