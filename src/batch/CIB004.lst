* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIB004.cbl
* Options: int("CIB004.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIB004.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIB004.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIB004.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    CIB004.
     3 DATE-WRITTEN.  MAY, 2000.
     4
     5*****************************************************************
     6*                                                               *
     7*                                                               *
     8*****************************************************************
     9
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIB004.cbl
    10/
    11 ENVIRONMENT DIVISION.
    12
    13 INPUT-OUTPUT SECTION.
    14
    15 FILE-CONTROL.
    16
    17     SELECT PRINT-LINES-IN
    18         ASSIGN TO SYS010
    19         FILE STATUS IS SYS010-STATUS.
    20
    21     SELECT STATE-TOTALS
    22        organization is line sequential
    23         ASSIGN TO SYS011.
    24
    25     SELECT FINAL-TOTALS
    26        organization is line sequential
    27         ASSIGN TO SYS012.
    28
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIB004.cbl
    29/
    30 DATA DIVISION.
    31
    32 FILE SECTION.
    33
    34 FD  PRINT-LINES-IN
    35     LABEL RECORDS ARE STANDARD
    36     RECORDING MODE IS F
    37     BLOCK CONTAINS 0 RECORDS.
    38 01  FILLER.
    39     05  CC            PIC X.
    40     05  INPUT-RECORD  PIC X(132).
    41
    42 FD  STATE-TOTALS
    43     LABEL RECORDS ARE STANDARD
    44     RECORDING MODE IS F
    45     BLOCK CONTAINS 0 RECORDS.
    46 01  STATE-RECORD      PIC X(132).
    47
    48 FD  FINAL-TOTALS
    49     LABEL RECORDS ARE STANDARD
    50     RECORDING MODE IS F
    51     BLOCK CONTAINS 0 RECORDS.
    52 01  FINAL-RECORD      PIC X(132).
    53
    54
    55
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIB004.cbl
    57
    58 WORKING-STORAGE SECTION.
    59
    60 01  FILLER.
    61     05  S0C7                PIC X       VALUE SPACE.
    62     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
    63     05  SYS010-STATUS       PIC X(2)    VALUE SPACE.
    64         88  EOF                         VALUE '10'.
    65     05  PRINT-SW            PIC X       VALUE SPACE.
    66         88  DO-NOT-PRINT-PAGE           VALUE ' '.
    67         88  STATE-PAGE                  VALUE 'S'.
    68         88  FINAL-PAGE                  VALUE 'F'.
    69     05  SAVE-RECORD         PIC X(132)  VALUE SPACE.
    70
    71
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIB004.cbl
    72/
    73 PROCEDURE DIVISION.
    74
    75     PERFORM 0000-INIT-ROUTINE
    76        THRU 0000-EXIT
    77
    78     PERFORM 1000-PROCESS-FILE
    79        THRU 1000-EXIT UNTIL EOF
    80
    81     STOP RUN.
    82
    83
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIB004.cbl
    84/
    85 0000-INIT-ROUTINE.
    86*
    87     OPEN INPUT PRINT-LINES-IN
    88     IF SYS010-STATUS NOT = '00'
    89        DISPLAY 'OPEN ERROR ' SYS010-STATUS ' ON SYS010'
    90        ADD +1 TO FORCE-DUMP.
    91
    92     OPEN OUTPUT STATE-TOTALS
    93                 FINAL-TOTALS.
    94
    95 0000-EXIT.
    96     EXIT.
    97
    98
    99
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIB004.cbl
   100/
   101 1000-PROCESS-FILE.
   102*
   103     READ PRINT-LINES-IN
   104          AT END GO TO 1000-EXIT.
   105
   106     IF CC = '1'
   107        PERFORM 2000-NEW-PAGE THRU 2000-EXIT.
   108
   109     IF PRINT-SW = 'S'
   110        WRITE STATE-RECORD FROM INPUT-RECORD
   111     ELSE
   112     IF PRINT-SW = 'F'
   113        WRITE FINAL-RECORD FROM INPUT-RECORD.
   114
   115 1000-EXIT.
   116     EXIT.
   117
   118
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIB004.cbl
   119/
   120 2000-NEW-PAGE.
   121*
   122     MOVE INPUT-RECORD TO SAVE-RECORD
   123     READ PRINT-LINES-IN
   124     IF INPUT-RECORD(12:5) = 'STATE'
   125        MOVE 'S' TO PRINT-SW
   126        WRITE STATE-RECORD FROM SAVE-RECORD
   127     ELSE
   128        IF INPUT-RECORD(1:12) = 'FINAL TOTALS'
   129           MOVE 'F' TO PRINT-SW
   130           WRITE FINAL-RECORD FROM SAVE-RECORD
   131        ELSE
   132           MOVE ' ' TO PRINT-SW
   133        END-IF
   134     END-IF
   135     .
   136 2000-EXIT.
   137     EXIT.
   138
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2340     Code:         806
