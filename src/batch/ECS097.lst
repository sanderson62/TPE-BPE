* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS097.cbl
* Options: int("ECS097.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS097.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS097.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS097.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         10/03/97
     2                                                                  ECS097
     3 PROGRAM-ID.                 ECS097.                                 LV001
     4*              PROGRAM CONVERTED BY                               ECS097
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ECS097
     6*              CONVERSION DATE 02/09/96 09:36:31.                 ECS097
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS097
     8*                            VMOD=2.006.                          ECS097
     9                                                                  ECS097
    10*AUTHOR.        LOGIC, INC.                                       ECS097
    11*               DALLAS, TEXAS.                                    ECS097
    12                                                                  ECS097
    13*DATE-COMPILED.                                                   ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS097.cbl
    14                                                                  ECS097
    15*SECURITY.   *****************************************************ECS097
    16*            *                                                   *ECS097
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS097
    18*            *                                                   *ECS097
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS097
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS097
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ECS097
    22*            *                                                   *ECS097
    23*            *****************************************************ECS097
    24                                                                  ECS097
    25*REMARKS.                                                         ECS097
    26*        PRINT RESERVE FACTOR TAPE.                               ECS097
    27                                                                  ECS097
    28 ENVIRONMENT DIVISION.                                            ECS097
    29 INPUT-OUTPUT SECTION.                                            ECS097
    30 FILE-CONTROL.                                                    ECS097
    31                                                                  ECS097
    32     SELECT PRNTR            ASSIGN TO SYS008-UR-1403-S-SYS008.   ECS097
    33     SELECT RESV-TP          ASSIGN TO SYS014-UT-2400-S-SYS014.   ECS097
    34     SELECT DISK-DATE        ASSIGN TO SYS019-UT-FBA1-S-SYS019.   ECS097
    35     SELECT FICH             ASSIGN TO SYS020-UT-2400-S-SYS020.   ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS097.cbl
    37 DATA DIVISION.                                                   ECS097
    38 FILE SECTION.                                                    ECS097
    39                                                                  ECS097
    40 FD  PRNTR                                                        ECS097
*   41                             COPY ELCPRTFD.                       ECS097
    42******************************************************************04/15/98
    43*                                                                *ELCPRTFD
    44*                                                                *ELCPRTFD
    45*                            ELCPRTFD.                           *   LV003
    46*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    47*                            VMOD=2.006                          *ELCPRTFD
    48******************************************************************ELCPRTFD
    49     RECORDING MODE F                                             ELCPRTFD
    50     LABEL RECORDS OMITTED                                        ELCPRTFD
    51     BLOCK CONTAINS 0 RECORDS
    52     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    53 01  PRT.                                                         ELCPRTFD
    54     12  P-CTL               PIC  X.                                 CL**2
    55     12  P-DATA              PIC  X(132).                         ELCPRTFD
    56******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS097.cbl
    58 FD  RESV-TP                                                      ECS097
    59     BLOCK CONTAINS 0 RECORDS
    60     RECORDING MODE IS F.                                         ECS097
    61                                                                  ECS097
    62 01  RF-REC.                                                      ECS097
    63     12  RF-ID               PIC  XX.                             ECS097
    64     12  RF-CTL.                                                  ECS097
    65         16  RF-CODE.                                             ECS097
    66             20  RF-TBL      PIC  X.                              ECS097
    67             20  RF-INT      PIC  XX.                             ECS097
    68             20  RF-TYPE     PIC  X.                              ECS097
    69     12  RF-INT-ADJ          PIC S9V9(4)     COMP-3.              ECS097
    70     12  RF-RESV-ADJ         PIC S9V9(4)     COMP-3.              ECS097
    71     12  RF-JOINT-ADJ        PIC S9V9(4)     COMP-3.              ECS097
    72     12  RF-PLUS-MINUS       PIC  X.                              ECS097
    73     12  FILLER              PIC  X(24).                          ECS097
    74     12  CX-DX-FACTORS.                                           ECS097
    75         16  RF-CX-FACTOR        OCCURS  100  TIMES               ECS097
    76                             PIC S9(9)V99 COMP-3.                 ECS097
    77         16  RF-DX-FACTOR        OCCURS  100  TIMES               ECS097
    78                             PIC S9(9)V99 COMP-3.                 ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS097.cbl
    80 FD  DISK-DATE                                                    ECS097
*   81                             COPY ELCDTEFD.                       ECS097
    82******************************************************************04/15/98
    83*                                                                *ELCDTEFD
    84*                                                                *ELCDTEFD
    85*                            ELCDTEFD.                           *   LV002
    86*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    87*                            VMOD=2.007                          *   CL**2
    88*                                                                *ELCDTEFD
    89******************************************************************ELCDTEFD
    90     BLOCK CONTAINS 0 RECORDS
    91     RECORDING MODE F.                                            ELCDTEFD
    92                                                                  ELCDTEFD
    93 01  DATE-DISK.                                                   ELCDTEFD
    94     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    95     12  FILLER                      PIC  X(14).                  ELCDTEFD
    96     12  DD-CR1                      PIC  9.                      ELCDTEFD
    97     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    98     12  DD-CR2                      PIC  9.                      ELCDTEFD
    99     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   100     12  FILLER                      PIC  X(20).                  ELCDTEFD
   101                                                                  ELCDTEFD
   102 01  DATE-DISK-R.                                                 ELCDTEFD
   103     12  FILLER                      PIC  X(4).                   ELCDTEFD
   104     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   105                                     PIC  X(32).                  ELCDTEFD
   106                                                                  ELCDTEFD
   107 01  DATE-DISK-T.                                                 ELCDTEFD
   108     12  FILLER                      PIC  X(4).                   ELCDTEFD
   109     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   110                                     PIC  X(48).                  ELCDTEFD
   111                                                                  ELCDTEFD
   112 01  DATE-DISK-M.                                                 ELCDTEFD
   113     12  FILLER                      PIC  X(4).                   ELCDTEFD
   114     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   115                                     PIC  X(48).                  ELCDTEFD
   116                                                                  ELCDTEFD
   117 01  DATE-DISK-P.                                                 ELCDTEFD
   118     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   119     12  DD-IDX                      PIC  99.                     ELCDTEFD
   120     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   121     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   122         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   123                                     PIC  X.                      ELCDTEFD
   124         16  FILLER                  PIC  X(46).                  ELCDTEFD
   125     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   126         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   127             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   128             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   129             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   130             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   131         16  FILLER                  PIC  X(16).                  ELCDTEFD
   132                                                                  ELCDTEFD
   133 01  DATE-DISK-E.                                                 ELCDTEFD
   134     12  FILLER                      PIC  X(4).                   ELCDTEFD
   135     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   136                                     PIC  X(4).                   ELCDTEFD
   137                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   138 01  DATE-DISK-C.                                                 ELCDTEFD
   139     12  FILLER                      PIC  X(7).                   ELCDTEFD
   140     12  DD-CARR1-SECPAY-SW          PIC  X.
   141     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   142     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   143     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   144     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   145     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   146     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   147     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   148     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   149     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   150     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   151     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   152     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   153     12  DD-CARR2-SECPAY-SW          PIC  X.
   154     12  FILLER                      PIC  X(7).                   ELCDTEFD
   155                                                                  ELCDTEFD
   156 01  DATE-DISK-OPT.                                               ELCDTEFD
   157     12  FILLER                      PIC  X(04).                  ELCDTEFD
   158     12  DD-TLR-DATA.                                             ELCDTEFD
   159         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   160                                     PIC  X(03).                  ELCDTEFD
   161     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   162         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   163                                     PIC  X(06).                  ELCDTEFD
   164     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   165         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   166                                     PIC  X(07).                  ELCDTEFD
   167         16  FILLER                  PIC  X(05).                  ELCDTEFD
   168     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   169                                     PIC  X(96).                  ELCDTEFD
   170******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS097.cbl
   172 FD  FICH                                                         ECS097
*  173                             COPY ELCFCHFD.                       ECS097
   174******************************************************************04/15/98
   175*                                                                *ELCFCHFD
   176*                            ELCFCHFD.                           *   LV003
   177*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   178*                            VMOD=2.004                          *   CL**3
   179*                                                                *ELCFCHFD
   180******************************************************************ELCFCHFD
   181     BLOCK CONTAINS 0 RECORDS
   182     RECORDING MODE F.                                            ELCFCHFD
   183                                                                  ELCFCHFD
   184 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   185******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS097.cbl
   187 WORKING-STORAGE SECTION.                                         ECS097
   188 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      ECS097
   189 01  LCP-CURRENT-DATE-68.                                         ECS097
   190     05  LCP-MONTH                 PIC XX.                        ECS097
   191     05  FILLER                    PIC X VALUE '/'.               ECS097
   192     05  LCP-DAY1                  PIC XX.                        ECS097
   193     05  FILLER                    PIC X VALUE '/'.               ECS097
   194     05  LCP-YEAR                  PIC XX.                        ECS097
   195 01  LCP-DATE-NEW-74.                                             ECS097
   196     05  LCP-YEAR                  PIC XX.                        ECS097
   197     05  LCP-MONTH                 PIC XX.                        ECS097
   198     05  LCP-DAY1                  PIC XX.                        ECS097
   199 77  FILLER  PIC  X(32) VALUE '********************************'. ECS097
   200 77  FILLER  PIC  X(32) VALUE '     ECS097 WORKING-STORAGE     '. ECS097
   201 77  FILLER  PIC  X(32) VALUE '***********VMOD=2.006***********'. ECS097
   202                                                                  ECS097
   203 01  REQUIRED-STORAGE.                                            ECS097
   204     12  WS-RETURN-CODE          PIC S9(4)              COMP.     ECS097
   205     12  WS-ABEND-MESSAGE        PIC  X(80).                      ECS097
   206     12  WS-ABEND-FILE-STATUS    PIC  XX     VALUE ZEROS.         ECS097
   207     12  WS-ZERO                 PIC S9      VALUE ZERO COMP-3.   ECS097
   208                                                                  ECS097
   209 01  MISC.                                                        ECS097
   210     12  X                   PIC  X.                              ECS097
   211     12  W-CTL.                                                   ECS097
   212         16  W-VAL           PIC  X(4).                           ECS097
   213         16  W-PG            PIC S9(5)  COMP-3.                   ECS097
   214         16  W-AGE           PIC  99.                             ECS097
   215         16  W-LT            PIC S999   COMP-3.                   ECS097
   216     12  WS-MORT-CODE.                                            ECS097
   217         16  FILLER          PIC  XXX.                            ECS097
   218         16  WS-MORT-TYPE    PIC  X.                              ECS097
   219     12  SV-DESC             PIC  X(26).                          ECS097
   220     12  ERR-SW              PIC  X              VALUE SPACE.     ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS097.cbl
   222 01  HDR-1.                                                       ECS097
   223     12  FILLER              PIC  X(50)          VALUE SPACE.     ECS097
   224     12  FILLER              PIC  X(25)          VALUE            ECS097
   225             'MORTALITY RESERVE FACTORS'.                         ECS097
   226     12  FILLER              PIC  X(45)          VALUE SPACE.     ECS097
   227     12  FILLER              PIC  X(8)           VALUE 'ECS097'.  ECS097
   228                                                                  ECS097
   229 01  HDR-2.                                                       ECS097
   230     12  FILLER              PIC  X(47)          VALUE SPACE.     ECS097
   231     12  H2-COMP             PIC  X(30).                          ECS097
   232     12  FILLER              PIC  X(43)          VALUE SPACE.     ECS097
   233     12  H2-DATE             PIC  X(8).                           ECS097
   234                                                                  ECS097
   235 01  HDR-3.                                                       ECS097
   236     12  FILLER              PIC  X(53)          VALUE SPACE.     ECS097
   237     12  H3-DATE             PIC  X(18).                          ECS097
   238     12  FILLER              PIC  X(49)          VALUE SPACE.     ECS097
   239     12  FILLER              PIC  X(5)           VALUE 'PAGE '.   ECS097
   240     12  H3-PAGE             PIC ZZ,ZZ9.                          ECS097
   241     12  FILLER              PIC  X(9)           VALUE SPACE.     ECS097
   242                                                                  ECS097
   243 01  HDR-4.                                                       ECS097
   244     12  FILLER              PIC  X.                              ECS097
   245     12  H4-MORT-CODE        PIC  X(4).                           ECS097
   246     12  H4-SLASH            PIC  X              VALUE '/'.       ECS097
   247     12  H4-MORT-CODE-RF     PIC  X(4).                           ECS097
   248     12  FILLER              PIC  X(5)           VALUE SPACE.     ECS097
   249     12  H4-MORT-DESC        PIC  X(26).                          ECS097
   250     12  FILLER              PIC  X(11)          VALUE SPACE.     ECS097
   251     12  H4-TYPE-MSG         PIC  X(30).                          ECS097
   252     12  FILLER              PIC  X(14)          VALUE SPACE.     ECS097
   253     12  H4-PER-MSG          PIC  X(30).                          ECS097
   254     12  FILLER              PIC  X(7)           VALUE SPACE.     ECS097
   255                                                                  ECS097
   256 01  HDR-4-10                PIC  X(30)          VALUE            ECS097
   257         '    COMPUTATION FUNCTIONS     '.                        ECS097
   258                                                                  ECS097
   259 01  DTL-1.                                                       ECS097
   260     12  FILLER              PIC  X(4).                           ECS097
   261     12  D1-AGE              PIC  99.                             ECS097
   262     12  FILLER              PIC  X(4).                           ECS097
   263     12  D1-CX               PIC ZZZ,ZZZ,ZZ9.99.                  ECS097
   264     12  FILLER              PIC  X(6).                           ECS097
   265     12  D1-DX               PIC ZZZ,ZZZ,ZZ9.99.                  ECS097
   266     12  FILLER              PIC  X(6).                           ECS097
   267                                                                  ECS097
   268 01  DTL-2.                                                       ECS097
   269     12  D2-COM              PIC  X(30).                          ECS097
   270     12  D2-AMT              PIC 9.9999-.                         ECS097
   271                                                                  ECS097
   272 01  DTL-3.                                                       ECS097
   273     12  D3-COM              PIC  X(30).                          ECS097
   274     12  D3-CODE             PIC  X.                              ECS097
   275                                                                  ECS097
   276 01  ERR-MESS-1.                                                  ECS097
   277     12  FILLER              PIC  X(30)          VALUE            ECS097
   278             ' INVALID MORTALITY TABLE'.                          ECS097
   279                                                                  ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS097.cbl
   280 01  ERR-MESS-2.                                                  ECS097
   281     12  FILLER              PIC  X(30)          VALUE            ECS097
   282             ' ****CHECK DATE FILE****'.                          ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS097.cbl
   284 01  BINARY-AREA         COMP.                                    ECS097
   285     12  X1                  PIC S999            VALUE +0.        ECS097
   286     12  X2                  PIC S999            VALUE +0.        ECS097
   287     12  X3                  PIC S999            VALUE +0.        ECS097
   288     12  X4                  PIC S999            VALUE +0.        ECS097
   289     12  X5                  PIC S999            VALUE +0.        ECS097
   290     12  X6                  PIC S999            VALUE +0.        ECS097
   291     12  B0                  PIC S999            VALUE +0.        ECS097
   292     12  B1                  PIC S999            VALUE +1.        ECS097
   293                                                                  ECS097
   294 01  COMP-3-AREA         COMP-3.                                  ECS097
   295     12  PG-NO               PIC S9(5)           VALUE +1.        ECS097
   296     12  K1                  PIC S9(5)           VALUE +1.        ECS097
   297     12  LT                  PIC S999            VALUE +1.        ECS097
   298     12  WT                  PIC S999            VALUE +1.        ECS097
   299     12  HT                  PIC S999            VALUE +0.        ECS097
   300     12  K9                  PIC S999            VALUE +9.        ECS097
   301     12  LST-PG              PIC S9(5)           VALUE +0.        ECS097
   302     12  LN-CT               PIC S999            VALUE +0.        ECS097
   303     12  LN-MX               PIC S999            VALUE +44.       ECS097
   304     12  K0                  PIC S999            VALUE +0.        ECS097
   305     12  PGM-SUB             PIC S999            VALUE +097.      ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS097.cbl
   307                                                                  ECS097
*  308                             COPY ELCDTECX.                       ECS097
   309******************************************************************06/05/98
   310*                                                                *ELCDTECX
   311*                            ELCDTECX.                           *   LV005
   312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   313*                            VMOD=2.015                          *ELCDTECX
   314*                                                                *ELCDTECX
   315*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   316*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   317*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   318*                                                                *ELCDTECX
   319******************************************************************ELCDTECX
   320******************************************************************
   321*                   C H A N G E   L O G
   322*
   323* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   324*-----------------------------------------------------------------
   325*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   326* EFFECTIVE    NUMBER
   327*-----------------------------------------------------------------
   328* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   329*                                  BENEFIT CODES FROM 300 TO 900
   330* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   331* 051304    2003080800002  SMVA  ADD REFUND METHOD
   332* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   333******************************************************************
   334 01  DATE-CARD.                                                   ELCDTECX
   335     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   336     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   337     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   338     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   339     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   340     12  EP-SW                       PIC  X.                      ELCDTECX
   341         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   342     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   343         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   344     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   345     12  RUN-CENTURY.                                             ELCDTECX
   346         16 RUN-CENTURY-N            PIC  99.                        CL**4
   347     12  FILLER                      PIC  X.                         CL**4
   348     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   349     12  FILLER                      PIC  XXX.                    ELCDTECX
   350     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   351                                                                  ELCDTECX
   352 01  FILLER                          PIC  X(7)                       CL**6
   353                                          VALUE 'OPTIONS'.        ELCDTECX
   354 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   355     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   356     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   357     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   358         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   359         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   360     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   361     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   362     12  FILLER                      PIC  X.                      ELCDTECX
   363     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   364     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   365     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   366     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   367     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   368     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   369     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   370     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   371     12  FILLER                      PIC  X.                      ELCDTECX
   372     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   373     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   374     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   375     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   376     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   377     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   378     12  FILLER                      PIC  X.                      ELCDTECX
   379     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   380     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   381     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   382     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   383     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   384     12  DTE-R78                     PIC  X.                      ELCDTECX
   385     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   386     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   387     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   388     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   389     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   390     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   391     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   392                                     PIC  X.                      ELCDTECX
   393         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   394                                                 ' '.             ELCDTECX
   395         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   396         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   397     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   398         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   399         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   400     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   401     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   402                                     PIC  9.                         CL**4
   403     12  DTE-SYSTEM.                                              ELCDTECX
   404         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   405         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   406         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   407         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   408         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   409         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   410         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   411         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   412         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   413         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   414         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   415         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   416         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   417         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   418         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   419         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   420         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   421         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   422         16  DTE-SYS-S               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   423         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   424         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   425         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   426         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   427         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   428         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   429         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   430     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   431         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   432                                     PIC  X.                      ELCDTECX
   433     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   434                                                                  ELCDTECX
   435 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   436     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   437     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   438     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   439*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   440     12  FILLER                      PIC  X.                      ELCDTECX
   441     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   442     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   443     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   444     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   445     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   446     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   447     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   448                                                                  ELCDTECX
   449     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   450     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   451     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   452     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   453                                                                  ELCDTECX
   454     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   455     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   456     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   457     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   458                                                                  ELCDTECX
   459     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   460     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   461                                                                  ELCDTECX
   462     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   463     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   464                                                                  ELCDTECX
   465     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   466                                                                  ELCDTECX
   467 01  DATE-CARD-FACTORS.                                           ELCDTECX
   468     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   469     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   470     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   471     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   472     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   473     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   474     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   475                                                                  ELCDTECX
   476 01  FILLER                          PIC  X(12)                   ELCDTECX
   477                                          VALUE 'COMPANY NAME'.   ELCDTECX
   478 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   479     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   480         16  CNT-ID                  PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   481         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   482                                                                  ELCDTECX
   483 01  FILLER                          PIC  X(11)                   ELCDTECX
   484                                          VALUE 'STATE NAMES'.    ELCDTECX
   485 01  STATE-NAMES.                                                 ELCDTECX
   486     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   487         16  STATE-SUB               PIC  XX.                     ELCDTECX
   488         16  STATE-PIC1.                                          ELCDTECX
   489             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   490             20  FILLER              PIC  XXX.                    ELCDTECX
   491             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   492             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   493             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   494             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   495                                                                  ELCDTECX
   496 01  FILLER                          PIC  X(13)                   ELCDTECX
   497                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   498 01  CARRIER-NAMES.                                               ELCDTECX
   499     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   500         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   501         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   502         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   503         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   504         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   505         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   506*        16  FILLER                  PIC  X.                      ELCDTECX
   507         16  CARRIER-SEC-PAY         PIC  X.
   508             88  SEC-PAY-CARRIER          VALUE 'Y'.
   509                                                                  ELCDTECX
   510 01  FILLER                          PIC  X(9)                       CL**6
   511                                          VALUE 'INS TYPES'.      ELCDTECX
   512 01  CLAS-INS-TYPES.                                              ELCDTECX
   513*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   514     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   515         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   516         16  CLAS-I-AB3.                                          ELCDTECX
   517             20  FILLER              PIC  X.                      ELCDTECX
   518             20  CLAS-I-AB2.                                      ELCDTECX
   519                 24  FILLER          PIC  X.                      ELCDTECX
   520                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   521         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   522             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   523             20  FILLER              PIC  X.                         CL**4
   524         16  CLAS-I-AB10.                                         ELCDTECX
   525             20  FILLER              PIC  X(9).                   ELCDTECX
   526             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   527         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   528         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   529         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   530         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   531             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   532         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   533         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   534         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   535         16  CLAS-I-BEN-CATEGORY     PIC  X.
   536         16  CLAS-I-REFUND-METHOD    PIC  X.
   537         16  CLAS-I-MAX-BENEFITS     PIC 99.
   538         16  FILLER                  PIC  XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   539                                                                  ELCDTECX
   540 01  FILLER                          PIC  X(16)                   ELCDTECX
   541                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   542 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   543     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   544                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   545         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   546         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   547         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   548         16  CLAS-MORT-DESC.                                      ELCDTECX
   549             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   550             20  FILLER              PIC  XX.                        CL**5
   551             20  CLAS-YEAR           PIC  X(4).                      CL**6
   552             20  FILLER              PIC  X.                         CL**5
   553             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   554             20  FILLER              PIC  X.                         CL**5
   555             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   556             20  FILLER              PIC  X.                         CL**5
   557             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   558             20  FILLER              PIC  X(5).                      CL**6
   559                                                                  ELCDTECX
   560 01  FILLER                          PIC  X(15)                   ELCDTECX
   561                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   562 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   563     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   564         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   565         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   566         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   567         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   568         16  FILLER                  PIC  X(4).                      CL**6
   569                                                                  ELCDTECX
   570 01  FILLER                          PIC  X(7)                       CL**6
   571                                     VALUE 'INDEXES'.             ELCDTECX
   572 01  CLAS-INDEX-TBL.                                              ELCDTECX
   573     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   574     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   575     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   576     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   577     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   578     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   579     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   580     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   581     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   582     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   583     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   584     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   585     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   586     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   587     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   588     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   589     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   590                                                                  ELCDTECX
   591 01  CLAS-TYPE-MISC.                                              ELCDTECX
   592     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   593     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   594     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   595     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   596     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   597     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   598     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   599     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   600     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   601     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   602     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   603                                                                  ELCDTECX
   604 01  FILLER                          PIC  X(13)                   ELCDTECX
   605                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   606 01  CLAS-MISC.                                                   ELCDTECX
   607     12  DTE-FICH                    PIC  X.                      ELCDTECX
   608         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   609         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   610         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   611     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   612     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   613     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   614     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   615     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   616     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   617     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   618     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   619     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   620     12  STATE-L                     PIC  XX.                     ELCDTECX
   621     12  CLAS-CN                     PIC  99.                     ELCDTECX
   622     12  CLAS-CO                     PIC  99.                     ELCDTECX
   623     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   624         16  DTE-F-1                 PIC  X.                      ELCDTECX
   625         16  DTE-F-2                 PIC  X.                      ELCDTECX
   626     12  DTE-ABEND-WORK.                                          ELCDTECX
   627         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   628         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   629                                                                  ELCDTECX
   630 01  FILLER                          PIC  X(12)                   ELCDTECX
   631                                     VALUE 'WORKING DATE'.        ELCDTECX
   632 01  WS-DATE-AND-TIME.                                            ELCDTECX
   633     12  WS-ACCEPT-DATE.                                          ELCDTECX
   634         16  WS-AD-YY                PIC  99.                     ELCDTECX
   635         16  WS-AD-MM                PIC  99.                     ELCDTECX
   636         16  WS-AD-DD                PIC  99.                     ELCDTECX
   637     12  WS-CURRENT-DATE.                                         ELCDTECX
   638         16  WS-CD-MM                PIC  99.                     ELCDTECX
   639         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   640         16  WS-CD-DD                PIC  99.                     ELCDTECX
   641         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   642         16  WS-CD-YY                PIC  99.                     ELCDTECX
   643     12  WS-TIME-OF-DAY.                                          ELCDTECX
   644         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   645         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   646                                                                  ELCDTECX
   647 01  FILLER                          PIC  X(12)                   ELCDTECX
   648                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   649 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   650     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   651         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   652         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   653         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   654                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   655 01  FILLER                          PIC  X(10)                   ELCDTECX
   656                                     VALUE 'STATE TLRS'.          ELCDTECX
   657 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   658     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   659         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   660         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   661                                                                  ELCDTECX
   662 01  FILLER                          PIC  X(13)                   ELCDTECX
   663                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   664 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   665     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   666         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   667                                                                  ELCDTECX
   668 01  FILLER                          PIC  X(13)                   ELCDTECX
   669                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   670 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   671     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   672     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   673     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   674                                     PIC  X.                         CL**5
   675     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   676     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   677     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   678     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   679     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   680     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   681     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   682     12  FILLER                      PIC  X(75).                  ELCDTECX
   683******************************************************************ELCDTECX
   684*01  MISC-CARR-PCT-DATA.                                          00001521
   685*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   686*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   687*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   688*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   689*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   690*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   691******************************************************************ELCDTECX
   692                                                                  ECS097
*  693                             COPY ELCDTEVR.                       ECS097
   694***************************************************************** 04/15/98
   695*                                                                *ELCDTEVR
   696*                                                                *ELCDTEVR
   697*                            ELCDTEVR.                           *   LV003
   698*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   699*                            VMOD=2.001                          *   CL**2
   700*                                                                *ELCDTEVR
   701*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   702*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   703*                                                                *ELCDTEVR
   704******************************************************************ELCDTEVR
   705 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   706     05  WS-RUN-DATE.                                             ELCDTEVR
   707         10  FILLER                  PIC  9(03).                  ELCDTEVR
   708         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   709         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   710             15  RUN-CC              PIC  99.                     ELCDTEVR
   711             15  RUN-YR              PIC  99.                     ELCDTEVR
   712         10  RUN-MO                  PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   713         10  RUN-DA                  PIC  99.                     ELCDTEVR
   714     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   715            WS-RUN-DATE              PIC 9(11).                      CL**2
   716     05  WS-EP-DT.                                                ELCDTEVR
   717         10  FILLER                  PIC  9(03).                  ELCDTEVR
   718         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   719         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   720             15  EP-CC               PIC  99.                     ELCDTEVR
   721             15  EP-YR               PIC  99.                     ELCDTEVR
   722         10  EP-MO                   PIC  99.                     ELCDTEVR
   723         10  EP-DA                   PIC  99.                     ELCDTEVR
   724     05  WS-EP-DT-N REDEFINES                                        CL**2
   725            WS-EP-DT                 PIC 9(11).                      CL**2
   726     05  WS-DTE-CONV-DT.                                             CL**4
   727         10  FILLER                  PIC  9(03).                     CL**4
   728         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   729         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   730             15  DTE-CONV-CC         PIC  99.                        CL**4
   731             15  DTE-CONV-YR         PIC  99.                        CL**4
   732         10  DTE-CONV-MO             PIC  99.                        CL**4
   733         10  DTE-CONV-DA             PIC  99.                        CL**4
   734     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   735            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   736 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   737     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   738         10  FILLER                            PIC 999.           ELCDTEVR
   739         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   740         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   741             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   742             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   743         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   744         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   745     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   746            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   747     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   748         10  FILLER                            PIC 999.           ELCDTEVR
   749         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   750         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   751         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   752         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   753     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   754            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   755 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   756     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   757         10  FILLER                            PIC 999.           ELCDTEVR
   758         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   759         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   760             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   761             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   762         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   763         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   764     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   765            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   766     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   767         10  FILLER                            PIC 999.           ELCDTEVR
   768         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   769         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   770             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   771             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   772         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   773         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   774     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   775            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   776     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   777         10  FILLER                            PIC 999.           ELCDTEVR
   778         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   779         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   780             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   781             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   782         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   783         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   784     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   785            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   786 01  WS-RATE-RECORD.                                              ELCDTEVR
   787         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   788             10  FILLER                        PIC 999.           ELCDTEVR
   789             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   790             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   791                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   792                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   793             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   794             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   795         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   796                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS097.cbl
   798 PROCEDURE DIVISION.                                              ECS097
   799                                                                  ECS097
   800 0100-SET-START.                                                  ECS097
*  801                             COPY ELCDTERX.                       ECS097
   802******************************************************************04/15/98
   803*                                                                *ELCDTERX
   804*                                                                *ELCDTERX
   805*                            ELCDTERX.                           *   LV002
   806*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   807*                            VMOD=2.007                          *ELCDTERX
   808*                                                                *ELCDTERX
   809*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   810*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   811*      = ELCDTEFD)                                               *ELCDTERX
   812*                                                                *ELCDTERX
   813******************************************************************ELCDTERX
   814                                                                  ELCDTERX
   815     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   816                                                                  ELCDTERX
   817     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   818     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   819     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   820                                                                  ELCDTERX
   821     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   822                                                                  ELCDTERX
   823******************************************************************ELCDTERX
   824*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
   825*          WARNING MESSAGES.                                      ELCDTERX
   826******************************************************************ELCDTERX
   827     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
   828         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
   829                                                                  ELCDTERX
   830     OPEN INPUT DISK-DATE.                                        ELCDTERX
   831                                                                  ELCDTERX
   832     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
   833                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
   834                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
   835                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
   836                   CLAX-ID           CLAS-MISC                    ELCDTERX
   837                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
   838                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
   839                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
   840                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
   841                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
   842                                                                  ELCDTERX
   843     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
   844                                                                  ELCDTERX
   845     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
   846                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
   847                                                                  ELCDTERX
   848     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
   849     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
   850     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
   851     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
   852                                                                  ELCDTERX
   853     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
   854         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
   855     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   856         ADD +1                 TO CLAS-CN.                       ELCDTERX
   857                                                                  ELCDTERX
   858     IF CLAS-INDEXON = ZERO                                       ELCDTERX
   859         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
   860     ELSE                                                         ELCDTERX
   861         ADD +1                 TO CLAS-CO.                       ELCDTERX
   862                                                                  ELCDTERX
   863 0005-READ--CARD.                                                 ELCDTERX
   864     READ DISK-DATE                                               ELCDTERX
   865         AT END CLOSE DISK-DATE                                   ELCDTERX
   866             GO TO 0060-READ--TEST.                               ELCDTERX
   867                                                                  ELCDTERX
   868     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
   869                                                                  ELCDTERX
   870     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
   871         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
   872         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
   873         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
   874         GO TO 0005-READ--CARD.                                   ELCDTERX
   875                                                                  ELCDTERX
   876     IF DD-ID = 'CLAD'                                            ELCDTERX
   877         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
   878         GO TO 0005-READ--CARD.                                   ELCDTERX
   879                                                                  ELCDTERX
   880     IF DD-ID = 'CLAX'                                            ELCDTERX
   881         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
   882         GO TO 0005-READ--CARD.                                   ELCDTERX
   883                                                                  ELCDTERX
   884     IF DD-ID = 'CLAF'                                            ELCDTERX
   885         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
   886         GO TO 0005-READ--CARD.                                   ELCDTERX
   887                                                                  ELCDTERX
   888     IF DD-ID = 'CLAC'                                            ELCDTERX
   889         GO TO 0010-READ--CLAC.                                   ELCDTERX
   890                                                                  ELCDTERX
   891     IF DD-ID = 'CARR'                                            ELCDTERX
   892         GO TO 0015-READ--CARR.                                   ELCDTERX
   893                                                                  ELCDTERX
   894     IF DD-ID = 'STAT'                                            ELCDTERX
   895         GO TO 0020-READ--STAT.                                   ELCDTERX
   896                                                                  ELCDTERX
   897     IF DD-ID = 'BUSC'                                            ELCDTERX
   898         GO TO 0025-READ--BUSC.                                   ELCDTERX
   899                                                                  ELCDTERX
   900     IF DD-ID = 'MORT'                                            ELCDTERX
   901         GO TO 0030-READ--MORT.                                   ELCDTERX
   902                                                                  ELCDTERX
   903     IF DD-ID = 'CLAI'                                            ELCDTERX
   904         GO TO 0040-READ--CLAI.                                   ELCDTERX
   905                                                                  ELCDTERX
   906     IF DD-ID = 'COLC'                                            ELCDTERX
   907         GO TO 0065-READ--COLC.                                   ELCDTERX
   908                                                                  ELCDTERX
   909     IF DD-IDX NUMERIC AND                                        ELCDTERX
   910        DD-IDA = 'CL'                                             ELCDTERX
   911         GO TO 0035-READ--CLXX.                                   ELCDTERX
   912                                                                  ELCDTERX
   913     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   914        DD-IDA = 'PO'                                             ELCDTERX
   915         GO TO 0050-READ--POXX.                                   ELCDTERX
   916                                                                  ELCDTERX
   917     IF DD-ID = 'OPCA'                                            ELCDTERX
   918         GO TO 0070-READ--OPCA.                                   ELCDTERX
   919                                                                  ELCDTERX
   920     IF DD-ID = 'OPST'                                            ELCDTERX
   921         GO TO 0072-READ--OPST.                                   ELCDTERX
   922                                                                  ELCDTERX
   923     IF DD-ID = 'OPBS'                                            ELCDTERX
   924         GO TO 0074-READ--OPBS.                                   ELCDTERX
   925                                                                  ELCDTERX
   926     IF DD-ID = 'OPMS'                                            ELCDTERX
   927         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
   928                                                                  ELCDTERX
   929     GO TO 0005-READ--CARD.                                       ELCDTERX
   930                                                                  ELCDTERX
   931 0010-READ--CLAC.                                                 ELCDTERX
   932     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   933     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   934     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   935     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
   936     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
   937     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
   938     GO TO 0005-READ--CARD.                                       ELCDTERX
   939                                                                  ELCDTERX
   940 0015-READ--CARR.                                                 ELCDTERX
   941     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   942     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   943        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
   944        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   945        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
   946        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   947        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   948        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   949        MOVE DD-CARR1-SECPAY-SW
   950                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   951     END-IF
   952                                                                  ELCDTERX
   953     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
   954     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
   955        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
   956        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
   957        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
   958        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
   959        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
   960        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
   961        MOVE DD-CARR2-SECPAY-SW
   962                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
   963     END-IF
   964                                                                  ELCDTERX
   965                                                                  ELCDTERX
   966     GO TO 0005-READ--CARD.                                       ELCDTERX
   967                                                                  ELCDTERX
   968 0020-READ--STAT.                                                 ELCDTERX
   969     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   970     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   971        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTERX)
   972         GO TO 0005-READ--CARD.                                   ELCDTERX
   973                                                                  ELCDTERX
   974     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
   975     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
   976     GO TO 0020-READ--STAT.                                       ELCDTERX
   977                                                                  ELCDTERX
   978 0025-READ--BUSC.                                                 ELCDTERX
   979     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   980     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
   981        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
   982         GO TO 0005-READ--CARD.                                   ELCDTERX
   983                                                                  ELCDTERX
   984     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
   985     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
   986     GO TO 0025-READ--BUSC.                                       ELCDTERX
   987                                                                  ELCDTERX
   988 0030-READ--MORT.                                                 ELCDTERX
   989     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
   990     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
   991        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
   992         GO TO 0005-READ--CARD.                                   ELCDTERX
   993                                                                  ELCDTERX
   994     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
   995     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
   996     GO TO 0030-READ--MORT.                                       ELCDTERX
   997                                                                  ELCDTERX
   998 0035-READ--CLXX.                                                 ELCDTERX
   999     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1000          GO TO 0005-READ--CARD.                                  ELCDTERX
  1001                                                                  ELCDTERX
  1002     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1003         DISPLAY '***********************************************'ELCDTERX
  1004         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1005         DISPLAY '***********************************************'ELCDTERX
  1006         GO TO 0055-READ--STOP.                                   ELCDTERX
  1007                                                                  ELCDTERX
  1008     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1009        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1010         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1011                                                                  ELCDTERX
  1012     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1013        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1014         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1015                                                                  ELCDTERX
  1016*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1017     GO TO 0005-READ--CARD.                                       ELCDTERX
  1018                                                                  ELCDTERX
  1019 0040-READ--CLAI.                                                 ELCDTERX
  1020     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1021     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1022        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1023         GO TO 0005-READ--CARD.                                   ELCDTERX
  1024                                                                  ELCDTERX
  1025     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1026     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1027     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1028                                                                  ELCDTERX
  1029 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1030     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1031     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1032                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1033     PERFORM ABEND-PGM.                                           ELCDTERX
  1034                                                                  ELCDTERX
  1035 0050-READ--POXX.                                                 ELCDTERX
  1036     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1037         GO TO 0005-READ--CARD.                                   ELCDTERX
  1038                                                                  ELCDTERX
  1039     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1040         DISPLAY '***********************************************'ELCDTERX
  1041         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1042         DISPLAY '***********************************************'ELCDTERX
  1043         GO TO 0055-READ--STOP.                                   ELCDTERX
  1044                                                                  ELCDTERX
  1045     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1046     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1047     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1048     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1049                                                                  ELCDTERX
  1050     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1051         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1052     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1053         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1054                                                                  ELCDTERX
  1055     GO TO 0005-READ--CARD.                                       ELCDTERX
  1056                                                                  ELCDTERX
  1057 0055-READ--STOP.                                                 ELCDTERX
  1058     GOBACK.                                                      ELCDTERX
  1059                                                                  ELCDTERX
  1060 0060-READ--TEST.                                                 ELCDTERX
  1061     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1062        CLAX-ID         = SPACE  OR                               ELCDTERX
  1063        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1064         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1065                                                                  ELCDTERX
  1066     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1067     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1068                                                                  ELCDTERX
  1069 0065-READ--COLC.                                                 ELCDTERX
  1070     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1071     GO TO 0005-READ--CARD.                                       ELCDTERX
  1072                                                                  ELCDTERX
  1073 0070-READ--OPCA.                                                 ELCDTERX
  1074                                                                  ELCDTERX
  1075     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1076                                                                  ELCDTERX
  1077     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1078             OR                                                   ELCDTERX
  1079         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1080         GO TO 0005-READ--CARD.                                   ELCDTERX
  1081                                                                  ELCDTERX
  1082     ADD 1                       TO INDEXCA.                      ELCDTERX
  1083     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1084                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1085     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1086                                                                  ELCDTERX
  1087 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS097.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1088                                                                  ELCDTERX
  1089     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1090                                                                  ELCDTERX
  1091     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1092             OR                                                   ELCDTERX
  1093         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1094         GO TO 0005-READ--CARD.                                   ELCDTERX
  1095                                                                  ELCDTERX
  1096     ADD 1                       TO INDEXST.                      ELCDTERX
  1097     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1098                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1099     GO TO 0072-READ--OPST.                                       ELCDTERX
  1100                                                                  ELCDTERX
  1101 0074-READ--OPBS.                                                 ELCDTERX
  1102                                                                  ELCDTERX
  1103     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1104                                                                  ELCDTERX
  1105     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1106             OR                                                   ELCDTERX
  1107         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1108         GO TO 0005-READ--CARD.                                   ELCDTERX
  1109                                                                  ELCDTERX
  1110     ADD 1                       TO INDEXBS.                      ELCDTERX
  1111     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1112     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1113                                                                  ELCDTERX
  1114 0079-READ--EXIT.                                                 ELCDTERX
  1115*    EXIT.                                                        ELCDTERX
  1116******************************************************************ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS097.cbl
  1118 0220-PRINT-FACTORS SECTION.                                      ECS097
  1119     OPEN INPUT  RESV-TP                                          ECS097
  1120          OUTPUT PRNTR.                                           ECS097
  1121                                                                  ECS097
  1122     MOVE COMPANY-NAME           TO  H2-COMP.                     ECS097
  1123     ACCEPT  LCP-DATE-NEW-74 FROM DATE                            ECS097
  1124     MOVE CORRESPONDING LCP-DATE-NEW-74 TO LCP-CURRENT-DATE-68    ECS097
  1125     MOVE  LCP-CURRENT-DATE-68 TO H2-DATE.                        ECS097
  1126     MOVE ALPH-DATE              TO  H3-DATE.                     ECS097
  1127     MOVE K0                     TO  LN-CT PG-NO.                 ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS097.cbl
  1129 0240-GET-REC.                                                    ECS097
  1130     READ RESV-TP  AT END                                         ECS097
  1131         GO TO 0385-END-JOB.                                      ECS097
  1132                                                                  ECS097
  1133     MOVE +1                     TO  X1.                          ECS097
  1134                                                                  ECS097
  1135 0260-SET-NEW.                                                    ECS097
  1136     MOVE RF-CODE                TO  W-CTL.                       ECS097
  1137     MOVE CLAS-STARTM            TO  CLAS-INDEXM.                 ECS097
  1138     MOVE RF-CODE                TO  WS-MORT-CODE.                ECS097
  1139     MOVE '0'                    TO  WS-MORT-TYPE.                ECS097
  1140                                                                  ECS097
  1141 0270-FIND-MORT-LOOP.                                             ECS097
  1142     IF CLAS-INDEXM  IS GREATER THAN  CLAS-MAXM                   ECS097
  1143         MOVE 'UNKNOWN'          TO  SV-DESC                      ECS097
  1144         MOVE 'X'                TO  ERR-SW                       ECS097
  1145         GO TO 0280-PRINT.                                        ECS097
  1146                                                                  ECS097
  1147     IF WS-MORT-CODE  IS NOT EQUAL TO                             ECS097
  1148         CLAS-MORT-CODE (CLAS-INDEXM)                             ECS097
  1149             ADD +1             TO  CLAS-INDEXM                   ECS097
  1150             GO TO 0270-FIND-MORT-LOOP.                           ECS097
  1151                                                                  ECS097
  1152     MOVE CLAS-MORT-DESC (CLAS-INDEXM)                            ECS097
  1153                                TO  SV-DESC.                      ECS097
  1154                                                                  ECS097
  1155 0280-PRINT.                                                      ECS097
  1156     MOVE SPACES                 TO  HDR-4.                       ECS097
  1157     MOVE SV-DESC                TO  H4-MORT-DESC.                ECS097
  1158     MOVE WS-MORT-CODE           TO  H4-MORT-CODE.                ECS097
  1159     MOVE '/'                    TO  H4-SLASH.                    ECS097
  1160     MOVE RF-CODE                TO  H4-MORT-CODE-RF.             ECS097
  1161     MOVE HDR-4-10               TO  H4-PER-MSG                   ECS097
  1162     MOVE ' CX AND DX FACTORS '  TO  H4-TYPE-MSG.                 ECS097
  1163                                                                  ECS097
  1164 0290-PT-HDNG.                                                    ECS097
  1165     ADD +1                      TO  PG-NO.                       ECS097
  1166                                                                  ECS097
  1167     MOVE PG-NO                  TO  H3-PAGE.                     ECS097
  1168     MOVE HDR-1                  TO  PRT.                         ECS097
  1169     MOVE '1'                    TO  X.                           ECS097
  1170                                                                  ECS097
  1171     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1172                                                                  ECS097
  1173     MOVE HDR-2                  TO  PRT.                         ECS097
  1174     MOVE ' '                    TO  X.                           ECS097
  1175                                                                  ECS097
  1176     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1177                                                                  ECS097
  1178     MOVE HDR-3                  TO  PRT.                         ECS097
  1179     MOVE ' '                    TO  X.                           ECS097
  1180                                                                  ECS097
  1181     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1182                                                                  ECS097
  1183     MOVE HDR-4                  TO  PRT.                         ECS097
  1184     MOVE '0'                    TO  X.                           ECS097
  1185                                                                  ECS097
  1186     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS097.cbl
  1187                                                                  ECS097
  1188     MOVE '    .AGE.   ......CX......      ......DX......'        ECS097
  1189                                 TO  PRT.                         ECS097
  1190     MOVE ' '                    TO  X.                           ECS097
  1191                                                                  ECS097
  1192     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1193                                                                  ECS097
  1194     MOVE SPACES                 TO  PRT.                         ECS097
  1195     MOVE ' '                    TO  X.                           ECS097
  1196                                                                  ECS097
  1197     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1198                                                                  ECS097
  1199     MOVE K0                     TO  LN-CT.                       ECS097
  1200     MOVE SPACES                 TO  DTL-1.                       ECS097
  1201                                                                  ECS097
  1202 0310-MAIN-PRINT.                                                 ECS097
  1203     IF LN-CT  IS GREATER THAN  44                                ECS097
  1204         GO TO 0290-PT-HDNG.                                      ECS097
  1205                                                                  ECS097
  1206     MOVE RF-CX-FACTOR (X1)      TO  D1-CX.                       ECS097
  1207     MOVE RF-DX-FACTOR (X1)      TO  D1-DX.                       ECS097
  1208                                                                  ECS097
  1209     COMPUTE X2 = X1 - +1.                                        ECS097
  1210                                                                  ECS097
  1211     MOVE X2                     TO  D1-AGE.                      ECS097
  1212     MOVE DTL-1                  TO  PRT.                         ECS097
  1213     MOVE ' '                    TO  X.                           ECS097
  1214                                                                  ECS097
  1215     PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.                 ECS097
  1216                                                                  ECS097
  1217     ADD B1                      TO  X1.                          ECS097
  1218                                                                  ECS097
  1219     IF X1  IS GREATER THAN  +100                                 ECS097
  1220         MOVE SPACES             TO  PRT                          ECS097
  1221         MOVE ' '                TO  X                            ECS097
  1222         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT              ECS097
  1223         MOVE '  INTEREST ADJUSTMENT FACTOR -'                    ECS097
  1224                                 TO  D2-COM                       ECS097
  1225         MOVE RF-INT-ADJ         TO  D2-AMT                       ECS097
  1226         MOVE DTL-2              TO  PRT                          ECS097
  1227         MOVE ' '                TO  X                            ECS097
  1228         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT              ECS097
  1229         MOVE '  RESERVE TABLE ADJUSTMENT   -'                    ECS097
  1230                                 TO  D2-COM                       ECS097
  1231         MOVE RF-RESV-ADJ        TO  D2-AMT                       ECS097
  1232         MOVE DTL-2              TO  PRT                          ECS097
  1233         MOVE ' '                TO  X                            ECS097
  1234         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT              ECS097
  1235         MOVE '  JOINT ADJUSTMENT FACTOR    -'                    ECS097
  1236                                 TO  D2-COM                       ECS097
  1237         MOVE RF-JOINT-ADJ       TO  D2-AMT                       ECS097
  1238         MOVE DTL-2              TO  PRT                          ECS097
  1239         MOVE ' '                TO  X                            ECS097
  1240         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT              ECS097
  1241         MOVE '  PLUS OR MINUS FACTOR       -'                    ECS097
  1242                                 TO  D3-COM                       ECS097
  1243         MOVE RF-PLUS-MINUS      TO  D3-CODE                      ECS097
  1244         MOVE DTL-3              TO  PRT                          ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS097.cbl
  1245         MOVE ' '                TO  X                            ECS097
  1246         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT              ECS097
  1247         GO TO 0240-GET-REC.                                      ECS097
  1248                                                                  ECS097
  1249     ADD K1                      TO  LN-CT.                       ECS097
  1250                                                                  ECS097
  1251     IF LN-CT  IS EQUAL TO   5  OR  10  OR  15  OR  20            ECS097
  1252                        OR  25  OR  30  OR  35  OR  40            ECS097
  1253         MOVE SPACES             TO  PRT                          ECS097
  1254         PERFORM 0350-PRT-RTN THRU 0360-PRT-RTN-EXIT.             ECS097
  1255                                                                  ECS097
  1256     GO TO 0310-MAIN-PRINT.                                       ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS097.cbl
  1258 0350-PRT-RTN.                                                    ECS097
* 1259                             COPY ELCPRT2.                        ECS097
  1260******************************************************************04/15/98
  1261*                                                                *ELCPRT2
  1262*                                                                *ELCPRT2
  1263*                            ELCPRT2                             *   LV005
  1264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  1265*                            VMOD=2.002                          *   CL**5
  1266*                                                                *   CL**4
  1267******************************************************************   CL**4
  1268                                                                     CL**4
  1269     IF DTE-FICH NOT = SPACE AND                                     CL**4
  1270        FICH-OPEN    = SPACE                                         CL**4
  1271         MOVE 'X'                TO  FICH-OPEN                       CL**4
  1272         OPEN OUTPUT FICH.                                           CL**4
  1273                                                                     CL**4
  1274     IF DTE-FICH NOT = SPACE                                         CL**4
  1275         MOVE X                  TO  P-CTL                           CL**4
  1276         WRITE FICH-REC FROM PRT.                                    CL**4
  1277                                                                     CL**4
  1278     IF DTE-FICH = SPACE OR '2'                                      CL**4
  1279       MOVE X                    TO  P-CTL                           CL**4
  1280       IF P-CTL = ' '                                                CL**4
  1281         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  1282       ELSE                                                          CL**4
  1283         IF P-CTL = '0'                                              CL**4
  1284           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  1285         ELSE                                                        CL**4
  1286           IF P-CTL = '-'                                            CL**4
  1287             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  1288           ELSE                                                      CL**4
  1289             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  1290                                                                     CL**4
  1291******************************************************************   CL**4
  1292                                                                  ECS097
  1293 0360-PRT-RTN-EXIT.                                               ECS097
  1294     EXIT.                                                        ECS097
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS097.cbl
  1296 0385-END-JOB.                                                    ECS097
* 1297                             COPY ELCPRTC.                        ECS097
  1298******************************************************************04/15/98
  1299*                                                                *ELCPRTC
  1300*                                                                *ELCPRTC
  1301*                            ELCPRTC.                            *   LV003
  1302*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1303*                            VMOD=2.002                          *   CL**2
  1304*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  1305*                                                                *ELCPRTC
  1306* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  1307******************************************************************ELCPRTC
  1308                                                                  ELCPRTC
  1309      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  1310          CLOSE FICH.                                             ELCPRTC
  1311                                                                  ELCPRTC
  1312******************************************************************ELCPRTC
  1313                                                                  ECS097
  1314     CLOSE RESV-TP  PRNTR.                                        ECS097
  1315                                                                  ECS097
  1316 0390-END.                                                        ECS097
  1317     GOBACK.                                                      ECS097
  1318                                                                  ECS097
  1319 ABEND-PGM SECTION.                                               ECS097
* 1320                             COPY ELCABEND.                       ECS097
  1321***************************************************************** 04/14/98
  1322*                                                               * ELCABEND
  1323*                            ELCABEND.                          *    LV003
  1324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1325*                            VMOD 2.002                              CL**2
  1326*                                                               * ELCABEND
  1327*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1328*            AND THEN ABENDS.                                   * ELCABEND
  1329*                                                               * ELCABEND
  1330*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1331*                                                               * ELCABEND
  1332***************************************************************** ELCABEND
  1333*APS-010.                                                         ELCABEND
  1334     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1335     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1336                                                                  ELCABEND
  1337     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1338         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1339         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1340                                 UPON CONSOLE.                    ELCABEND
  1341                                                                  ELCABEND
  1342     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1343         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1344         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1345                                 UPON CONSOLE.                    ELCABEND
  1346                                                                  ELCABEND
  1347     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1348     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1349                                 UPON CONSOLE.                    ELCABEND
  1350                                                                  ELCABEND
  1351     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  1352     CALL 'ABORTME'.
  1353                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS097.cbl (/apps/prod/cid1p/copy/ELCABEND)
  1354 APS-EXIT.                                                        ELCABEND
  1355     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       49640     Code:        4733
