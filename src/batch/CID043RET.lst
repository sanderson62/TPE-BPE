* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CID043RET.cbl
* Options: int("CID043RET.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CID043RET.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CID043RET.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CID043RET.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    CIDRETRO.
     3 AUTHOR.        AJR.
     4 DATE-COMPILED. 06-Oct-15 17:18.
     5*REMARKS.
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CID043RET.cbl
    14* 081408   2008073000002   AJRA  COMBINE ECS043 EXTRACT FILES INTO
    15*                                ONE DELIMITED FILE.
    16* 020409   2008073000002   AJRA  ADD RETRP PAYMENTS
    17******************************************************************
    19 ENVIRONMENT DIVISION.
    20 INPUT-OUTPUT SECTION.
    21 FILE-CONTROL.
    22
    23     SELECT  FILECUR-IN      ASSIGN TO SYS011-UT-2400-S-SYS011
    24                             ORGANIZATION IS LINE SEQUENTIAL.
    25     SELECT  FILEYTD-IN      ASSIGN TO SYS012-UT-2400-S-SYS012
    26                             ORGANIZATION IS LINE SEQUENTIAL.
    27     SELECT  FILEL12-IN      ASSIGN TO SYS013-UT-2400-S-SYS013
    28                             ORGANIZATION IS LINE SEQUENTIAL.
    29     SELECT  FILE-OUT        ASSIGN TO SYS020-UT-FBA1-S-SYS020
    30                             ORGANIZATION IS LINE SEQUENTIAL.
    31
    32 DATA DIVISION.
    33 FILE SECTION.
    34
    35 FD  FILECUR-IN
    36     RECORDING MODE F
    37     BLOCK CONTAINS 0 RECORDS.
    38
    39 01  FILECUR-IN-REC               PIC X(1413).
    40
    41 FD  FILEYTD-IN
    42     RECORDING MODE F
    43     BLOCK CONTAINS 0 RECORDS.
    44
    45 01  FILEYTD-IN-REC               PIC X(1413).
    46
    47 FD  FILEL12-IN
    48     RECORDING MODE F
    49     BLOCK CONTAINS 0 RECORDS.
    50
    51 01  FILEL12-IN-REC               PIC X(1413).
    52
    53 FD  FILE-OUT
    54     RECORDING MODE F
    55     BLOCK CONTAINS 0 RECORDS.
    56
    57 01  FILE-OUT-REC                 PIC X(2649).
    58
    59
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CID043RET.cbl
    61 WORKING-STORAGE SECTION.
    62 77  FILLER  PIC X(32) VALUE '********************************'.
    63 77  FILLER  PIC X(32) VALUE '     AJRCODT WORKING STORAGE    '.
    64 77  FILLER  PIC X(32) VALUE '********************************'.
    65
    66
    67 01  WS-MISC.
    68     05  WS-EOFCUR-SW            PIC X      VALUE SPACES.
    69         88  END-OF-CUR                     VALUE 'Y'.
    70     05  WS-EOFYTD-SW            PIC X      VALUE SPACES.
    71         88  END-OF-YTD                     VALUE 'Y'.
    72     05  WS-EOFL12-SW            PIC X      VALUE SPACES.
    73         88  END-OF-L12                     VALUE 'Y'.
    74     05  WS-SUB          COMP-3  PIC S9(3)  VALUE +0.
    75     05  WS-CUR-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    76     05  WS-YTD-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    77     05  WS-L12-IN-CNT   COMP-3  PIC S9(7)  VALUE +0.
    78     05  WS-OUT-CNT      COMP-3  PIC S9(7)  VALUE +0.
    79
    80 01  WS-CUR-IN-RECORD.
    81     05  WS-CUR-KEY.
    82         10  WS-CUR-ME-DATE       PIC X(10).
    83         10  WS-CUR-CARRIER       PIC X(1).
    84         10  WS-CUR-COMP          PIC X(6).
    85         10  WS-CUR-STATE         PIC X(2).
    86         10  WS-CUR-ACCOUNT-NUM   PIC X(10).
    87         10  WS-CUR-GROUP         PIC X(10).
    88         10  WS-CUR-EXP-DATE      PIC X(10).
    89     05  WS-CUR-EFF-DATE          PIC X(10).
    90     05  WS-CUR-ACCOUNT-NAME      PIC X(30).
    91     05  WS-CUR-PERIOD            PIC X(3).
    92     05  WS-CUR-ACCUMULATORS OCCURS 9 TIMES.
    93         10  WS-CUR-DESCR         PIC X(28).
    94         10  WS-CUR-PERLFP        PIC X(14).
    95         10  WS-CUR-PERLFE        PIC X(14).
    96         10  WS-CUR-ITDLFP        PIC X(14).
    97         10  WS-CUR-ITDLFE        PIC X(14).
    98         10  WS-CUR-PERAHP        PIC X(14).
    99         10  WS-CUR-PERAHE        PIC X(14).
   100         10  WS-CUR-ITDAHP        PIC X(14).
   101         10  WS-CUR-ITDAHE        PIC X(14).
   102     05  WS-CUR-PREM-P-E          PIC X(1).
   103     05  WS-CUR-CLAIM-P-I         PIC X(1).
   104     05  WS-CUR-RETRO-Y-N         PIC X(1).
   105     05  WS-CUR-RETRO-P-E         PIC X(1).
   106     05  WS-CUR-TAX-P-E           PIC X(1).
   107     05  WS-CUR-PERLF-RETRO-PMT   PIC X(14).
   108     05  WS-CUR-ITDLF-RETRO-PMT   PIC X(14).
   109     05  WS-CUR-PERAH-RETRO-PMT   PIC X(14).
   110     05  WS-CUR-ITDAH-RETRO-PMT   PIC X(14).
   111
   112
   113 01  WS-YTD-IN-RECORD.
   114     05  WS-YTD-KEY.
   115         10  WS-YTD-ME-DATE       PIC X(10).
   116         10  WS-YTD-CARRIER       PIC X(1).
   117         10  WS-YTD-COMP          PIC X(6).
   118         10  WS-YTD-STATE         PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CID043RET.cbl
   119         10  WS-YTD-ACCOUNT-NUM   PIC X(10).
   120         10  WS-YTD-GROUP         PIC X(10).
   121         10  WS-YTD-EXP-DATE      PIC X(10).
   122     05  WS-YTD-EFF-DATE          PIC X(10).
   123     05  WS-YTD-ACCOUNT-NAME      PIC X(30).
   124     05  WS-YTD-PERIOD            PIC X(3).
   125     05  WS-YTD-ACCUMULATORS OCCURS 9 TIMES.
   126         10  WS-YTD-DESCR         PIC X(28).
   127         10  WS-YTD-PERLFP        PIC X(14).
   128         10  WS-YTD-PERLFE        PIC X(14).
   129         10  WS-YTD-ITDLFP        PIC X(14).
   130         10  WS-YTD-ITDLFE        PIC X(14).
   131         10  WS-YTD-PERAHP        PIC X(14).
   132         10  WS-YTD-PERAHE        PIC X(14).
   133         10  WS-YTD-ITDAHP        PIC X(14).
   134         10  WS-YTD-ITDAHE        PIC X(14).
   135     05  WS-YTD-PREM-P-E          PIC X(1).
   136     05  WS-YTD-CLAIM-P-I         PIC X(1).
   137     05  WS-YTD-RETRO-Y-N         PIC X(1).
   138     05  WS-YTD-RETRO-P-E         PIC X(1).
   139     05  WS-YTD-TAX-P-E           PIC X(1).
   140     05  WS-YTD-PERLF-RETRO-PMT   PIC X(14).
   141     05  WS-YTD-ITDLF-RETRO-PMT   PIC X(14).
   142     05  WS-YTD-PERAH-RETRO-PMT   PIC X(14).
   143     05  WS-YTD-ITDAH-RETRO-PMT   PIC X(14).
   144
   145
   146 01  WS-L12-IN-RECORD.
   147     05  WS-L12-KEY.
   148         10  WS-L12-ME-DATE       PIC X(10).
   149         10  WS-L12-CARRIER       PIC X(1).
   150         10  WS-L12-COMP          PIC X(6).
   151         10  WS-L12-STATE         PIC X(2).
   152         10  WS-L12-ACCOUNT-NUM   PIC X(10).
   153         10  WS-L12-GROUP         PIC X(10).
   154         10  WS-L12-EXP-DATE      PIC X(10).
   155     05  WS-L12-EFF-DATE          PIC X(10).
   156     05  WS-L12-ACCOUNT-NAME      PIC X(30).
   157     05  WS-L12-PERIOD            PIC X(3).
   158     05  WS-L12-ACCUMULATORS OCCURS 9 TIMES.
   159         10  WS-L12-DESCR         PIC X(28).
   160         10  WS-L12-PERLFP        PIC X(14).
   161         10  WS-L12-PERLFE        PIC X(14).
   162         10  WS-L12-ITDLFP        PIC X(14).
   163         10  WS-L12-ITDLFE        PIC X(14).
   164         10  WS-L12-PERAHP        PIC X(14).
   165         10  WS-L12-PERAHE        PIC X(14).
   166         10  WS-L12-ITDAHP        PIC X(14).
   167         10  WS-L12-ITDAHE        PIC X(14).
   168     05  WS-L12-PREM-P-E          PIC X(1).
   169     05  WS-L12-CLAIM-P-I         PIC X(1).
   170     05  WS-L12-RETRO-Y-N         PIC X(1).
   171     05  WS-L12-RETRO-P-E         PIC X(1).
   172     05  WS-L12-TAX-P-E           PIC X(1).
   173     05  WS-L12-PERLF-RETRO-PMT   PIC X(14).
   174     05  WS-L12-ITDLF-RETRO-PMT   PIC X(14).
   175     05  WS-L12-PERAH-RETRO-PMT   PIC X(14).
   176     05  WS-L12-ITDAH-RETRO-PMT   PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CID043RET.cbl
   177
   178
   179 01  WS-FILE-OUT-RECORD.
   180     05  WS-FO-KEY.
   181         10  WS-FO-ME-DATE       PIC X(10).
   182         10  FILLER              PIC X(1) VALUE ';'.
   183         10  WS-FO-CARRIER       PIC X(1).
   184         10  FILLER              PIC X(1) VALUE ';'.
   185         10  WS-FO-COMP          PIC X(6).
   186         10  FILLER              PIC X(1) VALUE ';'.
   187         10  WS-FO-STATE         PIC X(2).
   188         10  FILLER              PIC X(1) VALUE ';'.
   189         10  WS-FO-ACCOUNT-NUM   PIC X(10).
   190         10  FILLER              PIC X(1) VALUE ';'.
   191         10  WS-FO-GROUP         PIC X(10).
   192         10  FILLER              PIC X(1) VALUE ';'.
   193         10  WS-FO-EXP-DATE      PIC X(10).
   194         10  FILLER              PIC X(1) VALUE ';'.
   195     05  WS-FO-EFF-DATE          PIC X(10).
   196     05  FILLER                  PIC X(1) VALUE ';'.
   197     05  WS-FO-ACCOUNT-NAME      PIC X(30).
   198     05  FILLER                  PIC X(1) VALUE ';'.
   199     05  WS-FO-ACCUMULATORS OCCURS 9 TIMES.
   200         10  WS-FO-DESCR         PIC X(28).
   201         10  FILLER              PIC X(1) VALUE ';'.
   202         10  WS-FO-CURLFP        PIC X(14).
   203         10  FILLER              PIC X(1) VALUE ';'.
   204         10  WS-FO-CURLFE        PIC X(14).
   205         10  FILLER              PIC X(1) VALUE ';'.
   206         10  WS-FO-YTDLFP        PIC X(14).
   207         10  FILLER              PIC X(1) VALUE ';'.
   208         10  WS-FO-YTDLFE        PIC X(14).
   209         10  FILLER              PIC X(1) VALUE ';'.
   210         10  WS-FO-L12LFP        PIC X(14).
   211         10  FILLER              PIC X(1) VALUE ';'.
   212         10  WS-FO-L12LFE        PIC X(14).
   213         10  FILLER              PIC X(1) VALUE ';'.
   214         10  WS-FO-ITDLFP        PIC X(14).
   215         10  FILLER              PIC X(1) VALUE ';'.
   216         10  WS-FO-ITDLFE        PIC X(14).
   217         10  FILLER              PIC X(1) VALUE ';'.
   218         10  WS-FO-CURAHP        PIC X(14).
   219         10  FILLER              PIC X(1) VALUE ';'.
   220         10  WS-FO-CURAHE        PIC X(14).
   221         10  FILLER              PIC X(1) VALUE ';'.
   222         10  WS-FO-YTDAHP        PIC X(14).
   223         10  FILLER              PIC X(1) VALUE ';'.
   224         10  WS-FO-YTDAHE        PIC X(14).
   225         10  FILLER              PIC X(1) VALUE ';'.
   226         10  WS-FO-L12AHP        PIC X(14).
   227         10  FILLER              PIC X(1) VALUE ';'.
   228         10  WS-FO-L12AHE        PIC X(14).
   229         10  FILLER              PIC X(1) VALUE ';'.
   230         10  WS-FO-ITDAHP        PIC X(14).
   231         10  FILLER              PIC X(1) VALUE ';'.
   232         10  WS-FO-ITDAHE        PIC X(14).
   233         10  FILLER              PIC X(1) VALUE ';'.
   234     05  WS-FO-PREM-P-E          PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CID043RET.cbl
   235     05  FILLER                  PIC X(1) VALUE ';'.
   236     05  WS-FO-CLAIM-P-I         PIC X(1).
   237     05  FILLER                  PIC X(1) VALUE ';'.
   238     05  WS-FO-RETRO-Y-N         PIC X(1).
   239     05  FILLER                  PIC X(1) VALUE ';'.
   240     05  WS-FO-RETRO-P-E         PIC X(1).
   241     05  FILLER                  PIC X(1) VALUE ';'.
   242     05  WS-FO-TAX-P-E           PIC X(1).
   243     05  FILLER                  PIC X(1) VALUE ';'.
   244     05  WS-FO-CURLFRETROPMT     PIC X(14).
   245     05  FILLER                  PIC X(1) VALUE ';'.
   246     05  WS-FO-YTDLFRETROPMT     PIC X(14).
   247     05  FILLER                  PIC X(1) VALUE ';'.
   248     05  WS-FO-L12LFRETROPMT     PIC X(14).
   249     05  FILLER                  PIC X(1) VALUE ';'.
   250     05  WS-FO-ITDLFRETROPMT     PIC X(14).
   251     05  FILLER                  PIC X(1) VALUE ';'.
   252     05  WS-FO-CURAHRETROPMT     PIC X(14).
   253     05  FILLER                  PIC X(1) VALUE ';'.
   254     05  WS-FO-YTDAHRETROPMT     PIC X(14).
   255     05  FILLER                  PIC X(1) VALUE ';'.
   256     05  WS-FO-L12AHRETROPMT     PIC X(14).
   257     05  FILLER                  PIC X(1) VALUE ';'.
   258     05  WS-FO-ITDAHRETROPMT     PIC X(14).
   259     05  FILLER                  PIC X(1) VALUE ';'.
   260
   261 01  WS-DUMMY-RECORD.
   262     05  WS-DMY-CARRIER           PIC X(1)    VALUE SPACES.
   263     05  WS-DMY-COMP              PIC X(6)    VALUE SPACES.
   264     05  WS-DMY-STATE             PIC X(2)    VALUE SPACES.
   265     05  WS-DMY-ACCOUNT-NUM       PIC X(10)   VALUE SPACES.
   266     05  WS-DMY-GROUP             PIC X(10)   VALUE SPACES.
   267     05  WS-DMY-ACCOUNT-NAME      PIC X(30)   VALUE SPACES.
   268     05  WS-DMY-PERIOD            PIC X(3)    VALUE SPACES.
   269     05  WS-DMY-ACCUMULATORS OCCURS 9 TIMES.
   270         10  WS-DMY-DESCR         PIC X(28).
   271         10  WS-DMY-PERLFP        PIC X(14).
   272         10  WS-DMY-PERLFE        PIC X(14).
   273         10  WS-DMY-ITDLFP        PIC X(14).
   274         10  WS-DMY-ITDLFE        PIC X(14).
   275         10  WS-DMY-PERAHP        PIC X(14).
   276         10  WS-DMY-PERAHE        PIC X(14).
   277         10  WS-DMY-ITDAHP        PIC X(14).
   278         10  WS-DMY-ITDAHE        PIC X(14).
   279     05  WS-DMY-PREM-P-E          PIC X(1)    VALUE SPACES.
   280     05  WS-DMY-CLAIM-P-I         PIC X(1)    VALUE SPACES.
   281     05  WS-DMY-RETRO-Y-N         PIC X(1).
   282     05  WS-DMY-RETRO-P-E         PIC X(1).
   283     05  WS-DMY-TAX-P-E           PIC X(1).
   284     05  WS-DMY-PERLF-RETRO-PMT   PIC X(14).
   285     05  WS-DMY-ITDLF-RETRO-PMT   PIC X(14).
   286     05  WS-DMY-PERAH-RETRO-PMT   PIC X(14).
   287     05  WS-DMY-ITDAH-RETRO-PMT   PIC X(14).
   288
   289 PROCEDURE DIVISION.
   290
   291 0000-BEGIN.
   292
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CID043RET.cbl
   293     PERFORM 0020-OPEN-FILES     THRU 0020-EXIT
   294     PERFORM 0040-INIT           THRU 0040-EXIT
   295
   296     PERFORM 0050-PROCESS-FILE   THRU 0050-EXIT UNTIL
   297          (END-OF-CUR AND END-OF-YTD AND END-OF-L12)
   298
   299     PERFORM 0030-CLOSE-FILES    THRU 0030-EXIT
   300
   301     DISPLAY ' CUR RECORDS IN ' WS-CUR-IN-CNT
   302     DISPLAY ' YTD RECORDS IN ' WS-YTD-IN-CNT
   303     DISPLAY ' L12 RECORDS IN ' WS-L12-IN-CNT
   304     DISPLAY ' RECORDS OUT    ' WS-OUT-CNT
   305     GOBACK
   306     .
   307 0002-EXIT.
   308     EXIT.
   309
   310 0020-OPEN-FILES.
   311
   312     OPEN INPUT FILECUR-IN
   313                FILEYTD-IN
   314                FILEL12-IN.
   315     OPEN OUTPUT FILE-OUT.
   316
   317 0020-EXIT.
   318     EXIT.
   319
   320 0030-CLOSE-FILES.
   321
   322     CLOSE FILECUR-IN
   323           FILEYTD-IN
   324           FILEL12-IN.
   325     CLOSE FILE-OUT.
   326
   327 0030-EXIT.
   328     EXIT.
   329
   330 0040-INIT.
   331
   332     MOVE +0 TO WS-SUB.
   333     PERFORM 9 TIMES
   334        ADD +1 TO WS-SUB
   335        MOVE SPACES TO WS-DMY-DESCR (WS-SUB)
   336        MOVE '           .00' TO WS-DMY-PERLFP (WS-SUB)
   337        MOVE '           .00' TO WS-DMY-PERLFE (WS-SUB)
   338        MOVE '           .00' TO WS-DMY-ITDLFP (WS-SUB)
   339        MOVE '           .00' TO WS-DMY-ITDLFE (WS-SUB)
   340        MOVE '           .00' TO WS-DMY-PERAHP (WS-SUB)
   341        MOVE '           .00' TO WS-DMY-PERAHE (WS-SUB)
   342        MOVE '           .00' TO WS-DMY-ITDAHP (WS-SUB)
   343        MOVE '           .00' TO WS-DMY-ITDAHE (WS-SUB)
   344        MOVE '           .00' TO WS-DMY-PERLF-RETRO-PMT
   345        MOVE '           .00' TO WS-DMY-ITDLF-RETRO-PMT
   346        MOVE '           .00' TO WS-DMY-PERAH-RETRO-PMT
   347        MOVE '           .00' TO WS-DMY-ITDAH-RETRO-PMT
   348     END-PERFORM.
   349
   350     PERFORM 0100-READ-FILECUR    THRU 0100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CID043RET.cbl
   351     PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT.
   352     PERFORM 0120-READ-FILEL12    THRU 0120-EXIT.
   353
   354 0040-EXIT.
   355     EXIT.
   356
   357 0050-PROCESS-FILE.
   358
   359     IF WS-CUR-KEY EQUAL WS-YTD-KEY AND
   360        WS-CUR-KEY EQUAL WS-L12-KEY
   361           PERFORM 2000-MOVE-AMOUNTS THRU 2000-EXIT
   362           PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   363           PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   364           PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   365           GO TO 0050-EXIT
   366     END-IF.
   367
   368     IF WS-CUR-KEY EQUAL WS-YTD-KEY
   369         IF WS-CUR-KEY LESS THAN WS-L12-KEY
   370             PERFORM 2010-MOVE-CUR-YTD-AMTS THRU 2010-EXIT
   371             PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   372             PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   373             GO TO 0050-EXIT
   374         ELSE
   375             PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   376             PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   377             GO TO 0050-EXIT
   378         END-IF
   379     END-IF.
   380
   381     IF WS-CUR-KEY LESS THAN WS-YTD-KEY
   382         IF WS-CUR-KEY EQUAL WS-L12-KEY
   383             PERFORM 2030-MOVE-CUR-L12-AMTS THRU 2030-EXIT
   384             PERFORM 0100-READ-FILECUR    THRU 0100-EXIT
   385             PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   386             GO TO 0050-EXIT
   387         ELSE
   388             IF WS-CUR-KEY LESS THAN WS-L12-KEY
   389                 PERFORM 2040-MOVE-CUR-AMTS THRU 2040-EXIT
   390                 PERFORM 0100-READ-FILECUR  THRU 0100-EXIT
   391                 GO TO 0050-EXIT
   392             ELSE
   393                 PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   394                 PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   395                 GO TO 0050-EXIT
   396             END-IF
   397         END-IF
   398     END-IF.
   399
   400     IF WS-CUR-KEY GREATER THAN WS-YTD-KEY
   401         IF WS-YTD-KEY EQUAL WS-L12-KEY
   402             PERFORM 2050-MOVE-YTD-L12-AMTS THRU 2050-EXIT
   403             PERFORM 0110-READ-FILEYTD    THRU 0110-EXIT
   404             PERFORM 0120-READ-FILEL12    THRU 0120-EXIT
   405             GO TO 0050-EXIT
   406         ELSE
   407             IF WS-YTD-KEY LESS THAN WS-L12-KEY
   408                 PERFORM 2060-MOVE-YTD-AMTS THRU 2060-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CID043RET.cbl
   409                 PERFORM 0110-READ-FILEYTD  THRU 0110-EXIT
   410                 GO TO 0050-EXIT
   411             ELSE
   412                 PERFORM 2020-MOVE-L12-AMTS THRU 2020-EXIT
   413                 PERFORM 0120-READ-FILEL12  THRU 0120-EXIT
   414                 GO TO 0050-EXIT
   415             END-IF
   416         END-IF
   417     END-IF.
   418
   419
   420 0050-EXIT.
   421     EXIT.
   422
   423
   424 0100-READ-FILECUR.
   425
   426     READ FILECUR-IN
   427        AT END
   428        SET END-OF-CUR        TO TRUE
   429     END-READ.
   430
   431     IF NOT END-OF-CUR
   432         ADD +1              TO WS-CUR-IN-CNT
   433         MOVE FILECUR-IN-REC TO WS-CUR-IN-RECORD
   434     ELSE
   435         MOVE WS-DUMMY-RECORD TO WS-CUR-IN-RECORD
   436     END-IF.
   437
   438 0100-EXIT.
   439     EXIT.
   440
   441
   442 0110-READ-FILEYTD.
   443
   444     READ FILEYTD-IN
   445        AT END
   446        SET END-OF-YTD        TO TRUE
   447     END-READ.
   448
   449     IF NOT END-OF-YTD
   450         ADD +1              TO WS-YTD-IN-CNT
   451         MOVE FILEYTD-IN-REC TO WS-YTD-IN-RECORD
   452     ELSE
   453         MOVE WS-DUMMY-RECORD TO WS-YTD-IN-RECORD
   454     END-IF.
   455
   456 0110-EXIT.
   457     EXIT.
   458
   459 0120-READ-FILEL12.
   460
   461     READ FILEL12-IN
   462        AT END
   463        SET END-OF-L12        TO TRUE
   464     END-READ.
   465
   466     IF NOT END-OF-L12
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CID043RET.cbl
   467         ADD +1              TO WS-L12-IN-CNT
   468         MOVE FILEL12-IN-REC TO WS-L12-IN-RECORD
   469     ELSE
   470         MOVE WS-DUMMY-RECORD TO WS-L12-IN-RECORD
   471     END-IF.
   472
   473 0120-EXIT.
   474     EXIT.
   475
   476
   477 2000-MOVE-AMOUNTS.
   478
   479 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   480 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   481 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   482 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   483 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   484 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   485 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   486 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   487 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   488 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   489 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   490 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   491 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   492 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   493 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   494 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   495 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   496 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   497 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   498 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   499 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   500 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   501
   502 MOVE +0 TO WS-SUB.
   503 PERFORM 9 TIMES
   504     ADD +1 TO WS-SUB
   505     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   506     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   507     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   508     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   509     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   510     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   511     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   512     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   513     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   514     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   515     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   516     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   517     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   518     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   519     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   520     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   521     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   522 END-PERFORM.
   523
   524 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CID043RET.cbl
   525 ADD +1 TO WS-OUT-CNT.
   526
   527 2000-EXIT.
   528     EXIT.
   529
   530
   531 2010-MOVE-CUR-YTD-AMTS.
   532
   533 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   534 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   535 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   536 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   537 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   538 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   539 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   540 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   541 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   542 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   543 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   544 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   545 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   546 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   547 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   548 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   549 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   550 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   551 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   552 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   553 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   554 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   555
   556 MOVE +0 TO WS-SUB.
   557 PERFORM 9 TIMES
   558     ADD +1 TO WS-SUB
   559     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   560     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   561     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   562     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   563     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   564     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   565     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   566     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   567     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   568     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   569     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   570     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   571     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   572     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   573     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   574     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   575     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   576 END-PERFORM.
   577
   578 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   579 ADD +1 TO WS-OUT-CNT.
   580
   581 2010-EXIT.
   582     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CID043RET.cbl
   583
   584
   585 2020-MOVE-L12-AMTS.
   586
   587 MOVE WS-L12-ME-DATE      TO WS-FO-ME-DATE.
   588 MOVE WS-L12-CARRIER      TO WS-FO-CARRIER.
   589 MOVE WS-L12-COMP         TO WS-FO-COMP.
   590 MOVE WS-L12-STATE        TO WS-FO-STATE.
   591 MOVE WS-L12-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   592 MOVE WS-L12-GROUP        TO WS-FO-GROUP.
   593 MOVE WS-L12-EXP-DATE     TO WS-FO-EXP-DATE.
   594 MOVE WS-L12-EFF-DATE     TO WS-FO-EFF-DATE.
   595 MOVE WS-L12-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   596 MOVE WS-L12-PREM-P-E     TO WS-FO-PREM-P-E.
   597 MOVE WS-L12-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   598 MOVE WS-L12-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   599 MOVE WS-L12-RETRO-P-E    TO WS-FO-RETRO-P-E.
   600 MOVE WS-L12-TAX-P-E      TO WS-FO-TAX-P-E.
   601 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   602 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   603 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   604 MOVE WS-L12-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   605 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   606 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   607 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   608 MOVE WS-L12-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   609
   610 MOVE +0 TO WS-SUB.
   611 PERFORM 9 TIMES
   612     ADD +1 TO WS-SUB
   613     MOVE WS-L12-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   614     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   615     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   616     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   617     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   618     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   619     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   620     MOVE WS-L12-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   621     MOVE WS-L12-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   622     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   623     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   624     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   625     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   626     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   627     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   628     MOVE WS-L12-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   629     MOVE WS-L12-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   630 END-PERFORM.
   631
   632 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   633 ADD +1 TO WS-OUT-CNT.
   634
   635 2020-EXIT.
   636     EXIT.
   637
   638
   639 2030-MOVE-CUR-L12-AMTS.
   640
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CID043RET.cbl
   641 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   642 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   643 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   644 MOVE WS-CUR-STATE        TO WS-FO-STATE.
   645 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   646 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   647 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   648 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   649 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   650 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   651 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   652 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   653 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   654 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   655 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   656 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   657 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   658 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   659 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   660 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   661 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   662 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   663
   664 MOVE +0 TO WS-SUB.
   665 PERFORM 9 TIMES
   666     ADD +1 TO WS-SUB
   667     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   668     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   669     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   670     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   671     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   672     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   673     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   674     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   675     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   676     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   677     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   678     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   679     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   680     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   681     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   682     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   683     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   684 END-PERFORM.
   685
   686 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   687 ADD +1 TO WS-OUT-CNT.
   688
   689 2030-EXIT.
   690     EXIT.
   691
   692
   693 2040-MOVE-CUR-AMTS.
   694
   695 MOVE WS-CUR-ME-DATE      TO WS-FO-ME-DATE.
   696 MOVE WS-CUR-CARRIER      TO WS-FO-CARRIER.
   697 MOVE WS-CUR-COMP         TO WS-FO-COMP.
   698 MOVE WS-CUR-STATE        TO WS-FO-STATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CID043RET.cbl
   699 MOVE WS-CUR-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   700 MOVE WS-CUR-GROUP        TO WS-FO-GROUP.
   701 MOVE WS-CUR-EXP-DATE     TO WS-FO-EXP-DATE.
   702 MOVE WS-CUR-EFF-DATE     TO WS-FO-EFF-DATE.
   703 MOVE WS-CUR-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   704 MOVE WS-CUR-PREM-P-E     TO WS-FO-PREM-P-E.
   705 MOVE WS-CUR-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   706 MOVE WS-CUR-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   707 MOVE WS-CUR-RETRO-P-E    TO WS-FO-RETRO-P-E.
   708 MOVE WS-CUR-TAX-P-E      TO WS-FO-TAX-P-E.
   709 MOVE WS-CUR-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   710 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   711 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   712 MOVE WS-CUR-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   713 MOVE WS-CUR-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   714 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   715 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   716 MOVE WS-CUR-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   717
   718 MOVE +0 TO WS-SUB.
   719 PERFORM 9 TIMES
   720     ADD +1 TO WS-SUB
   721     MOVE WS-CUR-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   722     MOVE WS-CUR-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   723     MOVE WS-CUR-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   724     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   725     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   726     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   727     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   728     MOVE WS-CUR-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   729     MOVE WS-CUR-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   730     MOVE WS-CUR-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   731     MOVE WS-CUR-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   732     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   733     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   734     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   735     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   736     MOVE WS-CUR-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   737     MOVE WS-CUR-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   738 END-PERFORM.
   739
   740 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   741 ADD +1 TO WS-OUT-CNT.
   742
   743 2040-EXIT.
   744     EXIT.
   745
   746
   747 2050-MOVE-YTD-L12-AMTS.
   748
   749 MOVE WS-YTD-ME-DATE      TO WS-FO-ME-DATE.
   750 MOVE WS-YTD-CARRIER      TO WS-FO-CARRIER.
   751 MOVE WS-YTD-COMP         TO WS-FO-COMP.
   752 MOVE WS-YTD-STATE        TO WS-FO-STATE.
   753 MOVE WS-YTD-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   754 MOVE WS-YTD-GROUP        TO WS-FO-GROUP.
   755 MOVE WS-YTD-EXP-DATE     TO WS-FO-EXP-DATE.
   756 MOVE WS-YTD-EFF-DATE     TO WS-FO-EFF-DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CID043RET.cbl
   757 MOVE WS-YTD-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   758 MOVE WS-YTD-PREM-P-E     TO WS-FO-PREM-P-E.
   759 MOVE WS-YTD-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
   760 MOVE WS-YTD-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   761 MOVE WS-YTD-RETRO-P-E    TO WS-FO-RETRO-P-E.
   762 MOVE WS-YTD-TAX-P-E      TO WS-FO-TAX-P-E.
   763 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   764 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   765 MOVE WS-L12-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   766 MOVE WS-YTD-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   767 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   768 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   769 MOVE WS-L12-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   770 MOVE WS-YTD-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   771
   772 MOVE +0 TO WS-SUB.
   773 PERFORM 9 TIMES
   774     ADD +1 TO WS-SUB
   775     MOVE WS-YTD-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   776     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   777     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   778     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   779     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   780     MOVE WS-L12-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   781     MOVE WS-L12-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   782     MOVE WS-YTD-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   783     MOVE WS-YTD-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   784     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   785     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   786     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   787     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   788     MOVE WS-L12-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   789     MOVE WS-L12-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   790     MOVE WS-YTD-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   791     MOVE WS-YTD-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   792 END-PERFORM.
   793
   794 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   795 ADD +1 TO WS-OUT-CNT.
   796
   797 2050-EXIT.
   798     EXIT.
   799
   800
   801
   802 2060-MOVE-YTD-AMTS.
   803
   804 MOVE WS-YTD-ME-DATE      TO WS-FO-ME-DATE.
   805 MOVE WS-YTD-CARRIER      TO WS-FO-CARRIER.
   806 MOVE WS-YTD-COMP         TO WS-FO-COMP.
   807 MOVE WS-YTD-STATE        TO WS-FO-STATE.
   808 MOVE WS-YTD-ACCOUNT-NUM  TO WS-FO-ACCOUNT-NUM.
   809 MOVE WS-YTD-GROUP        TO WS-FO-GROUP.
   810 MOVE WS-YTD-EXP-DATE     TO WS-FO-EXP-DATE.
   811 MOVE WS-YTD-EFF-DATE     TO WS-FO-EFF-DATE.
   812 MOVE WS-YTD-ACCOUNT-NAME TO WS-FO-ACCOUNT-NAME.
   813 MOVE WS-YTD-PREM-P-E     TO WS-FO-PREM-P-E.
   814 MOVE WS-YTD-CLAIM-P-I    TO WS-FO-CLAIM-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CID043RET.cbl
   815 MOVE WS-YTD-RETRO-Y-N    TO WS-FO-RETRO-Y-N.
   816 MOVE WS-YTD-RETRO-P-E    TO WS-FO-RETRO-P-E.
   817 MOVE WS-YTD-TAX-P-E      TO WS-FO-TAX-P-E.
   818 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-CURLFRETROPMT.
   819 MOVE WS-YTD-PERLF-RETRO-PMT TO WS-FO-YTDLFRETROPMT.
   820 MOVE WS-DMY-PERLF-RETRO-PMT TO WS-FO-L12LFRETROPMT.
   821 MOVE WS-YTD-ITDLF-RETRO-PMT TO WS-FO-ITDLFRETROPMT.
   822 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-CURAHRETROPMT.
   823 MOVE WS-YTD-PERAH-RETRO-PMT TO WS-FO-YTDAHRETROPMT.
   824 MOVE WS-DMY-PERAH-RETRO-PMT TO WS-FO-L12AHRETROPMT.
   825 MOVE WS-YTD-ITDAH-RETRO-PMT TO WS-FO-ITDAHRETROPMT.
   826
   827 MOVE +0 TO WS-SUB.
   828 PERFORM 9 TIMES
   829     ADD +1 TO WS-SUB
   830     MOVE WS-YTD-DESCR (WS-SUB) TO WS-FO-DESCR (WS-SUB)
   831     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-CURLFP (WS-SUB)
   832     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-CURLFE (WS-SUB)
   833     MOVE WS-YTD-PERLFP (WS-SUB) TO WS-FO-YTDLFP (WS-SUB)
   834     MOVE WS-YTD-PERLFE (WS-SUB) TO WS-FO-YTDLFE (WS-SUB)
   835     MOVE WS-DMY-PERLFP (WS-SUB) TO WS-FO-L12LFP (WS-SUB)
   836     MOVE WS-DMY-PERLFE (WS-SUB) TO WS-FO-L12LFE (WS-SUB)
   837     MOVE WS-YTD-ITDLFP (WS-SUB) TO WS-FO-ITDLFP (WS-SUB)
   838     MOVE WS-YTD-ITDLFE (WS-SUB) TO WS-FO-ITDLFE (WS-SUB)
   839     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-CURAHP (WS-SUB)
   840     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-CURAHE (WS-SUB)
   841     MOVE WS-YTD-PERAHP (WS-SUB) TO WS-FO-YTDAHP (WS-SUB)
   842     MOVE WS-YTD-PERAHE (WS-SUB) TO WS-FO-YTDAHE (WS-SUB)
   843     MOVE WS-DMY-PERAHP (WS-SUB) TO WS-FO-L12AHP (WS-SUB)
   844     MOVE WS-DMY-PERAHE (WS-SUB) TO WS-FO-L12AHE (WS-SUB)
   845     MOVE WS-YTD-ITDAHP (WS-SUB) TO WS-FO-ITDAHP (WS-SUB)
   846     MOVE WS-YTD-ITDAHE (WS-SUB) TO WS-FO-ITDAHE (WS-SUB)
   847 END-PERFORM.
   848
   849 WRITE FILE-OUT-REC FROM WS-FILE-OUT-RECORD.
   850 ADD +1 TO WS-OUT-CNT.
   851
   852 2060-EXIT.
   853     EXIT.
   854
   855
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       17564     Code:        6246
