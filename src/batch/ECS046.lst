* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS046.cbl
* Options: int("ECS046.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS046.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS046.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS046.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         03/09/98
     2                                                                  ECS046
     3 PROGRAM-ID.                ECS046.                                  LV009
     4*              PROGRAM CONVERTED BY                               ECS046
     5*              COBOL CONVERSION AID PO 5785-ABJ                   ECS046
     6*              CONVERSION DATE 02/20/96 19:03:05.                 ECS046
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE          ECS046
     8*                           VMOD=2.014.                           ECS046
     9                                                                  ECS046
    10*AUTHOR.        LOGIC, INC.                                       ECS046
    11*               DALLAS, TEXAS.                                    ECS046
    12                                                                  ECS046
    13*DATE-COMPILED.                                                   ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS046.cbl
    14                                                                  ECS046
    15*SECURITY.   *****************************************************ECS046
    16*            *                                                   *ECS046
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *ECS046
    18*            *                                                   *ECS046
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *ECS046
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *ECS046
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *ECS046
    22*            *                                                   *ECS046
    23*            *****************************************************ECS046
    24                                                                  ECS046
    25*REMARKS.                                                         ECS046
    26*            THIS PROGRAM WILL READ THE EP-EC FILE AND PRINT THE  ECS046
    27*            ACCOUNT PROFIT SUMMARY REPORT.                       ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS046.cbl
    29******************************************************************
    30*                   C H A N G E   L O G
    31*
    32* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    33*-----------------------------------------------------------------
    34*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    35* EFFECTIVE    NUMBER
    36*-----------------------------------------------------------------
    37* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    38******************************************************************
    39 ENVIRONMENT DIVISION.                                            ECS046
    40 INPUT-OUTPUT SECTION.                                            ECS046
    41 FILE-CONTROL.                                                    ECS046
    42                                                                  ECS046
    43     SELECT  SORT-WORK-A     ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.  ECS046
    44     SELECT  SORT-WORK-B     ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.  ECS046
    45     SELECT  WORK-FILE       ASSIGN TO SYS011-UT-FBA1-S-SYS011.   ECS046
    46     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.   ECS046
    47     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.   ECS046
    48     SELECT  ACC-MSTR        ASSIGN TO SYS015-FBA1-SYS015         ECS046
    49                             ACCESS        SEQUENTIAL             ECS046
    50                             ORGANIZATION  INDEXED                ECS046
    51                             FILE STATUS   ERACCT-FILE-STATUS     ECS046
    52                             RECORD KEY    AM-CONTROL-PRIMARY.    ECS046
    53     SELECT  COMP-FILE       ASSIGN TO SYS014-UT-FBA1-ERCOMP      ECS046
    54                             ORGANIZATION IS INDEXED              ECS046
    55                             ACCESS IS RANDOM                     ECS046
    56                             RECORD KEY IS CO-CONTROL-PRIMARY     ECS046
    57                             FILE STATUS IS ERCOMP-FILE-STATUS.   ECS046
    58     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.   ECS046
    59     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.   ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS046.cbl
    61 DATA DIVISION.                                                   ECS046
    62 FILE SECTION.                                                    ECS046
    63                                                                  ECS046
    64*    THE FOLLOWING SORT WORK FILE IS FOR SORTING REPORT-A RECORDS ECS046
    65*    SEE SWA-REC IN WORKING STORAGE FOR LAYOUT AND SORT CONTROL   ECS046
    66 SD  SORT-WORK-A.                                                    CL**9
    67                                                                  ECS046
    68 01  SWA-REC-OUT.                                                 ECS046
    69     12  SWA-CONTROL-OUT     PIC X(31).                           ECS046
    70     12  FILLER              PIC X(60).                           ECS046
    71     12  SWA-AMTS   COMP-3 OCCURS 2.                              ECS046
    72         16 SW-NP            PIC S9(9)V99.                        ECS046
    73         16 SW-EP            PIC S9(9)V99.                        ECS046
    74         16 SW-CI            PIC S9(9)V99.                        ECS046
    75         16 SW-EC            PIC S9(9)V99.                        ECS046
    76         16 SW-RT            PIC S9(9)V99.                        ECS046
    77         16 SW-PT            PIC S9(9)V99.                        ECS046
    78     12  SWA-SAVE-GROUPING   PIC X(6).                            ECS046
    79                                                                  ECS046
    80*    THE FOLLOWING SORT WORK FILE IS FOR SORTING REPORT-B RECORDS ECS046
    81*    SEE SWB-REC IN WORKING STORAGE FOR LAYOUT AND SORT CONTROL   ECS046
    82 SD  SORT-WORK-B.                                                    CL**9
    83                                                                  ECS046
    84 01  SWB-REC-OUT.                                                 ECS046
    85     12  SWB-CONTROL-OUT     PIC S9(9)V99  COMP-3.                ECS046
    86     12  FILLER              PIC X(80).                           ECS046
    87                                                                  ECS046
    88*    THE FOLLOWING WORK FILE IS USED TO STORE REPORT-B RECORDS    ECS046
    89*    UNTIL THEY CAN BE SORTED PRIOR TO BUILDING THE B REPORT.     ECS046
    90*    THESE RECORDS ARE CREATED IN THE PRINT-REPORT-A SECTION.     ECS046
    91*    SEE PARAGRAPH 3300- IN THE PROCEDURE DIVISION                ECS046
    92 FD  WORK-FILE                                                    ECS046
    93     RECORDING MODE F.                                               CL**9
    94                                                                  ECS046
    95 01  WORK-REC                PIC X(86).                           ECS046
    96                                                                  ECS046
    97 FD  PRNTR                                                        ECS046
*   98                             COPY ELCPRTFD.                       ECS046
    99******************************************************************04/15/98
   100*                                                                *ELCPRTFD
   101*                                                                *ELCPRTFD
   102*                            ELCPRTFD.                           *   LV003
   103*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   104*                            VMOD=2.006                          *ELCPRTFD
   105******************************************************************ELCPRTFD
   106     RECORDING MODE F                                             ELCPRTFD
   107     LABEL RECORDS OMITTED                                        ELCPRTFD
   108     BLOCK CONTAINS 0 RECORDS
   109     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   110 01  PRT.                                                         ELCPRTFD
   111     12  P-CTL               PIC  X.                                 CL**2
   112     12  P-DATA              PIC  X(132).                         ELCPRTFD
   113******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS046.cbl
   115 FD  EPEC-FILE                                                    ECS046
*  116                             COPY ECSEPCFD.                       ECS046
   117******************************************************************07/10/97
   118*                                                                *ECSEPCFD
   119*                            ECSEPCFD                            *   LV001
   120*                            VMOD=2.002                          *ECSEPCFD
   121*                                                                *ECSEPCFD
   122*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   123*                                                                *ECSEPCFD
   124******************************************************************ECSEPCFD
   125     RECORDING MODE F                                             ECSEPCFD
   126     LABEL RECORDS STANDARD                                       ECSEPCFD
   127     BLOCK CONTAINS 0 RECORDS
   128     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   129******************************************************************ECSEPCFD
   130                                                                  ECS046
*  131                             COPY ECSEPC01.                       ECS046
   132******************************************************************
   133*                                                                *
   134*                            ECSEPC01                            *
   135*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   136*                            VMOD=2.008                          *
   137*                                                                *
   138*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   139*                                                                *
   140*   FILE TYPE = SEQUENTIAL                                       *
   141*   RECORD SIZE = 325  RECFORM = FIXED                           *
   142*                                                                *
   143*   KEY DATA =                                  START=5, LEN=31  *
   144*                                                                *
   145*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   146*                                                                *
   147******************************************************************
   148
   149 01  EP-RECORD.
   150     02 EP-FILE.
   151     12  EP-RECORD-ID                      PIC XX.
   152         88  VALID-EP-ID                      VALUE 'EP'.
   153
   154     12  EP-COMPANY-CD                     PIC X.
   155
   156     12  EP-REIN                           PIC X.
   157         88  EP-REIN-EXTRACT                  VALUE 'R'.
   158
   159     12  EP-CONTROL.
   160         16  EP-CNTRL-1.
   161             20  EP-COMPANY.
   162                 24  EP-CARRIER            PIC X.
   163                 24  EP-GROUPING.
   164                     28  EP-GROUP-PREFIX   PIC XXX.
   165                     28  EP-GROUP-PRIME    PIC XXX.
   166             20  EP-STATE                  PIC XX.
   167             20  EP-ACCOUNT.
   168                 24  EP-ACCT-PREFIX        PIC X(4).
   169                 24  EP-ACCT-PRIME         PIC X(6).
   170         16  EP-CNTRL-2.
   171             20  EP-DATES.
   172                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   173                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
   174
   175     12  EP-REI-CO.
   176         16  EP-REINCO                     PIC XXX.
   177         16  EP-REINCO-SUB                 PIC XXX.
   178
   179     12  EP-RCD-TYPE                       PIC X.
   180         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   181         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   182         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   183         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   184         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   185         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   186     12  EP-BEN-CODE                       PIC XX.
   187     12  FILLER                            PIC X.
   188
   189     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   190     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   191     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   192
   193     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   194     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   195     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   196
   197     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   198     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   199     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   200     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   201
   202     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   203     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   204     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   205
   206     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   207     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   208     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   209
   210     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   211     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   212     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   213     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   214     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   215
   216     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   217     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   218     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   219
   220     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   221     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   222     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   223
   224     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   225         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   226         16  EP-NEW-DATA-IND               PIC X(01).
   227             88  EP-NEW-DATA                   VALUE 'Y'.
   228         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   229         16  FILLER                        PIC X(19).
   230
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   231     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
   232     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   233     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   234
   235     12  FILLER                            PIC XXX.
   236
   237     12  EP-UNDERWRITING-CODE              PIC X.
   238         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   239
   240     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   241
   242     12  FILLER                            PIC X(29).
   243*    12  FILLER                            PIC X(34).
   244
   245     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   246     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   247     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   248     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   249     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   250     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   251
   252     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   253
   254     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   255     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   256
   257     12  EP-PURGE                          PIC X.
   258         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   259
   260     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   261
   262     02 EC-RECORD     REDEFINES     EP-FILE.
   263     12  EC-RECORD-ID                      PIC XX.
   264         88  VALID-EC-ID                      VALUE 'EC'.
   265
   266     12  EC-COMPANY-CD                     PIC X.
   267
   268     12  EC-REIN                           PIC X.
   269         88  EC-REIN-EXTRACT                  VALUE 'R'.
   270
   271     12  EC-CONTROL.
   272         16  EC-CARRIER                    PIC X.
   273         16  EC-GROUPING.
   274             20  EC-GROUP-PREFIX           PIC XXX.
   275             20  EC-GROUP-PRIME            PIC XXX.
   276         16  EC-STATE                      PIC XX.
   277         16  EC-ACCOUNT.
   278             20  EC-ACCT-PREFIX            PIC X(4).
   279             20  EC-ACCT-PRIME             PIC X(6).
   280         16  EC-DATES.
   281             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   282             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   283
   284     12  EC-REI-CO.
   285         16  EC-REINCO                     PIC XXX.
   286         16  EC-REINCO-SUB                 PIC XXX.
   287
   288     12  EC-RCD-TYPE                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS046.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   289         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
   290         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   291         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   292         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   293         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   294     12  EC-BEN-CODE                       PIC XX.
   295     12  EC-SEQ-NBR                        PIC X.
   296         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   297         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   298
   299     12  EC-AGENTS-DATA.
   300         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   301             20  EC-AGT-NO.
   302                 24  EC-AGT-PREFIX         PIC X(4).
   303                 24  EC-AGT-PRIME          PIC X(6).
   304             20  EC-AGT-TYPE               PIC X.
   305             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   306             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   307             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   308             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   309             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   310
   311     12  EC-UNDERWRITING-CODE              PIC X.
   312         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   313
   314     12  EC-AGENTS-DATA-II.
   315         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   316             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   317             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   318
   319     12  FILLER                            PIC X(7).
   320
   321     12  EC-PURGE                          PIC X.
   322         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   323
   324     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   325
   326******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS046.cbl
   328 FD  ACC-MSTR.                                                       CL**9
   329                                                                  ECS046
*  330                             COPY ERCACCT.                        ECS046
   331******************************************************************04/19/98
   332*                                                                *ERCACCT
   333*                                                                *ERCACCT
   334*                            ERCACCT                             *   LV031
   335*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   336*                            VMOD=2.031                          *ERCACCT
   337*                                                                *ERCACCT
   338*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   339*                                                                *ERCACCT
   340*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   341*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   342*                                                                *ERCACCT
   343*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   344*                                                                *ERCACCT
   345*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   346*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   347*                                                                *ERCACCT
   348*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   349*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   350*                                                                *ERCACCT
   351*   LOG = NO                                                     *ERCACCT
   352*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   353*                                                                *ERCACCT
   354*                                                                *ERCACCT
   355******************************************************************ERCACCT
   356*                   C H A N G E   L O G
   357*
   358* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   359*-----------------------------------------------------------------
   360*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   361* EFFECTIVE    NUMBER
   362*-----------------------------------------------------------------
   363* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   364* 092705    2005050300006  PEMA  ADD SPP LEASES
   365* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   366* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   367* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   368* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   369* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   370******************************************************************
   371                                                                  ERCACCT
   372 01  ACCOUNT-MASTER.                                              ERCACCT
   373     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   374         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   375                                                                  ERCACCT
   376     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   377         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   378         16  AM-MSTR-CNTRL.                                       ERCACCT
   379             20  AM-CONTROL-A.                                    ERCACCT
   380                 24  AM-CARRIER            PIC X.                 ERCACCT
   381                 24  AM-GROUPING.                                 ERCACCT
   382                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   383                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   384                 24  AM-STATE              PIC XX.                ERCACCT
   385                 24  AM-ACCOUNT.                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   386                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
   387                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   388             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   389                                           PIC X(19).             ERCACCT
   390             20  AM-CNTRL-B.                                      ERCACCT
   391                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   392                 24  FILLER                PIC X(4).              ERCACCT
   393             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   394                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   395                                                                  ERCACCT
   396     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   397         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   398         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   399         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   400         16  AM-VG-STATE                   PIC XX.                ERCACCT
   401         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   402         16  AM-VG-DATE.                                          ERCACCT
   403             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   404             20  FILLER                    PIC X(4).              ERCACCT
   405         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   406                                           PIC 9(11)      COMP-3. ERCACCT
   407     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   408         16  FILLER                        PIC X(10).
   409         16  AM-VG-KEY3.
   410             20  AM-VG3-ACCOUNT            PIC X(10).
   411             20  AM-VG3-EXP-DT             PIC XX.
   412         16  FILLER                        PIC X(4).
   413     12  AM-MAINT-INFORMATION.                                    ERCACCT
   414         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   415         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   416         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   417         16  FILLER                        PIC XX.                ERCACCT
   418                                                                  ERCACCT
   419     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   420     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   421                                                                  ERCACCT
   422     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   423         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   424         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   425                                                                  ERCACCT
   426     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   427     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   428                                                                  ERCACCT
   429     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   430     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   431                                                                  ERCACCT
   432     12  AM-NAME                           PIC X(30).             ERCACCT
   433     12  AM-PERSON                         PIC X(30).             ERCACCT
   434     12  AM-ADDRS                          PIC X(30).             ERCACCT
   435     12  AM-CITY.
   436         16  AM-ADDR-CITY                  PIC X(28).
   437         16  AM-ADDR-STATE                 PIC XX.
   438     12  AM-ZIP.                                                  ERCACCT
   439         16  AM-ZIP-PRIME.                                        ERCACCT
   440             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   441                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   442             20  FILLER                    PIC X(4).              ERCACCT
   443         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   444     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
   445         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   446         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   447         16  FILLER                        PIC XXX.               ERCACCT
   448     12  AM-TEL-NO.                                               ERCACCT
   449         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   450         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   451         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   452     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   453         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   454         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   455                                                                  ERCACCT
   456     12  AM-COMM-STRUCTURE.                                       ERCACCT
   457         16  AM-DEFN-1.                                           ERCACCT
   458             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   459                 24  AM-AGT.                                      ERCACCT
   460                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   461                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   462                 24  AM-COM-TYP            PIC X.                 ERCACCT
   463                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   464                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   465                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   466                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   467                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   468                 24  AM-GL-CODES           PIC X.                 ERCACCT
   469                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   470                 24  FILLER                PIC X(01).             ERCACCT
   471         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   472             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   473                 24  FILLER                PIC X(11).             ERCACCT
   474                 24  AM-L-COMA             PIC XXX.               ERCACCT
   475                 24  AM-J-COMA             PIC XXX.               ERCACCT
   476                 24  AM-A-COMA             PIC XXX.               ERCACCT
   477                 24  FILLER                PIC X(6).              ERCACCT
   478                                                                  ERCACCT
   479     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   480         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   481                                                                  ERCACCT
   482     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   483                                                                  ERCACCT
   484     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   485         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   486         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   487     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   488         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   489         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   490     12  AM-GPCD                           PIC 99.                ERCACCT
   491     12  AM-IG                             PIC X.                 ERCACCT
   492         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   493         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   494     12  AM-STATUS                         PIC X.                 ERCACCT
   495         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   496         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   497         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   498         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   499         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   500         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   501     12  AM-REMIT-TO                       PIC 99.                ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   502     12  AM-ID-NO                          PIC X(11).             ERCACCT
   503                                                                  ERCACCT
   504     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   505     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   506     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   507     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   508     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   509     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   510     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   511     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   512     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   513                                                                  ERCACCT
   514     12  AM-USER-FIELDS.                                          ERCACCT
   515         16  AM-FLD-1                      PIC XX.                ERCACCT
   516         16  AM-FLD-2                      PIC XX.                ERCACCT
   517         16  AM-FLD-3                      PIC XX.                ERCACCT
   518         16  AM-FLD-4                      PIC XX.                ERCACCT
   519         16  AM-FLD-5                      PIC XX.                ERCACCT
   520                                                                  ERCACCT
   521     12  AM-1ST-PROD-DATE.                                        ERCACCT
   522         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   523         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   524         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   525     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   526     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   527         16  AM-PUR-YR                     PIC XX.                ERCACCT
   528         16  AM-PUR-MO                     PIC XX.                ERCACCT
   529         16  AM-PUR-DA                     PIC XX.                ERCACCT
   530     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   531     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   532     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   533     12  AM-INACTIVE-DATE.                                        ERCACCT
   534         16  AM-INA-MO                     PIC 99.                ERCACCT
   535         16  AM-INA-DA                     PIC 99.                ERCACCT
   536         16  AM-INA-YR                     PIC 99.                ERCACCT
   537     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   538                                                                  ERCACCT
   539     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   540     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   541                                                                  ERCACCT
   542     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   543         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   544         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   545         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   546         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   547                                                                  ERCACCT
   548     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   549         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   550         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   551                                                                  ERCACCT
   552     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   553                                                                  ERCACCT
   554     12  AM-OVER-SHORT.                                           ERCACCT
   555         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   556         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   557                                                                  ERCACCT
   558     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   559     12  AM-DCC-CLP-STATE                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   560                                                                  ERCACCT
   561     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   562     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   563                                                                  ERCACCT
   564     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   565     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   566     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   567     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   568     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   569     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   570     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   571     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   572     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   573     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   574     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   575     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   576     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   577     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   578     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   579     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   580                                                                  ERCACCT
   581     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   582                                                                  ERCACCT
   583     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   584     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   585                                                                  ERCACCT
   586     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   587     12  AM-EARN-METHODS.                                         ERCACCT
   588         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   589             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   590             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   591             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   592             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   593         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   594             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   595             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   596             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   597             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   598         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   599             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   600             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   601             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   602             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   603             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   604             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   605                                                                  ERCACCT
   606     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   607     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   608     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   609                                                                  ERCACCT
   610     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   611     12  AM-RET-P-E                        PIC X.                 ERCACCT
   612     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   613     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   614     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   615     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   616         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   617         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   618     12  AM-RETRO-EARNINGS.                                       ERCACCT
   619         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   620         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   621         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   622     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   623         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   624         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   625     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   626         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   627         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   628         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   629     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   630     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   631                                                                  ERCACCT
   632     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   633         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   634         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   635         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   636         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   637         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   638                                                                  ERCACCT
   639     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   640                                                                  ERCACCT
   641     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   642                                                                  ERCACCT
   643     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   644         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   645                                                                  ERCACCT
   646     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   647         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   648         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   649                                                                  ERCACCT
   650     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   651         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   652                                                                  ERCACCT
   653     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   654         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   655         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   656                                                                  ERCACCT
   657     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   658                                                                  ERCACCT
   659     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   660     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   661     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   662     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   663     12  AM-DCC-UEF-STATE                  PIC XX.
   664     12  FILLER                            PIC XXX.
   665     12  AM-REPORT-CODE-3                  PIC X(10).
   666*    12  FILLER                            PIC X(22).             ERCACCT
   667                                                                  ERCACCT
   668     12  AM-RESERVE-DATE.                                         ERCACCT
   669         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   670         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   671         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   672                                                                  ERCACCT
   673     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   674     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   675         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   676         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
   677         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   678         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   679                                                                  ERCACCT
   680     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   681         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   682         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   683         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   684         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   685                                                                  ERCACCT
   686     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   687         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   688             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   689             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   690             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   691             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   692             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   693             20  FILLER                    PIC XX.                ERCACCT
   694         16  FILLER                        PIC X(80).             ERCACCT
   695                                                                  ERCACCT
   696     12  AM-TRANSFER-DATA.                                        ERCACCT
   697         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   698             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   699             20  AM-TRNFROM-GROUPING.                             ERCACCT
   700                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   701                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   702             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   703             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   704                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   705                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   706             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   707         16  AM-TRANSFERRED-TO.                                   ERCACCT
   708             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   709             20  AM-TRNTO-GROUPING.                               ERCACCT
   710                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   711                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   712             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   713             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   714                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   715                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   716             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   717         16  FILLER                        PIC X(10).             ERCACCT
   718                                                                  ERCACCT
   719     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   720                                                                  ERCACCT
   721     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   722         16  AM-DEFN-1-SAVED.                                     ERCACCT
   723             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   724                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   725                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   726                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   727                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   728                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   729                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   730                 24  FILLER                PIC X.                 ERCACCT
   731                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   732                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   733                 24  FILLER                PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   734         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
   735             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   736                 24  FILLER                PIC X(11).             ERCACCT
   737                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   738                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   739                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   740                 24  FILLER                PIC X(6).              ERCACCT
   741                                                                  ERCACCT
   742     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   743         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   744            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   745            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   746            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   747                                                                  ERCACCT
   748     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   749     12  FILLER                            PIC X(120).            ERCACCT
   750                                                                  ERCACCT
   751     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   752         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   753         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   754             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   755             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   756                                                          COMP-3. ERCACCT
   757             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   758                                                          COMP-3. ERCACCT
   759         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   760             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   761             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   762                                                          COMP-3. ERCACCT
   763             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   764                                                          COMP-3. ERCACCT
   765                                                                  ERCACCT
   766     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   767         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   768         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   769         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   770         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   771             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   772                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   773                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   774             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   775                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   776                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   777             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   778                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   779                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   780         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   781             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   782                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   783                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   784                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   785             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   786                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   787                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   788             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   789                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   790                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   791                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS046.cbl (/apps/prod/cid1p/copy/ERCACCT)
   792     12  AM-COMMENTS.                                             ERCACCT
   793         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   794                                                                  ERCACCT
   795     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   796         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   797         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   798         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   799         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   800         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   801             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   802             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   803             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   804             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   805         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   806             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   807             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   808             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   809         16  FILLER                        PIC X(102).            ERCACCT
   810                                                                  ERCACCT
   811     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   812         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   813             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   814             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   815             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   816             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   817             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   818         16  FILLER                          PIC X(10).           ERCACCT
   819******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS046.cbl
   821 FD  COMP-FILE.                                                      CL**9
   822                                                                  ECS046
*  823                             COPY ERCCOMP.                        ECS046
   824******************************************************************
   825*                                                                *
   826*                                                                *
   827*                            ERCCOMP                             *
   828*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   829*                            VMOD=2.019                          *
   830*                                                                *
   831*   ONLINE CREDIT SYSTEM                                         *
   832*                                                                *
   833*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   834*                                                                *
   835*   FILE TYPE = VSAM,KSDS                                        *
   836*   RECORD SIZE = 700   RECFORM = FIXED                          *
   837*                                                                *
   838*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   839*       ALTERNATE PATH = NONE                                    *
   840*                                                                *
   841*   LOG = NO                                                     *
   842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   843*                                                                *
   844******************************************************************
   845*                   C H A N G E   L O G
   846*
   847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   848*-----------------------------------------------------------------
   849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   850* EFFECTIVE    NUMBER
   851*-----------------------------------------------------------------
   852* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   853* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   854* 092205    2005050300006  PEMA  ADD LEASE FEE
   855* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   856* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   857* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   858* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   859* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   860* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   861******************************************************************
   862
   863 01  COMPENSATION-MASTER.
   864     12  CO-RECORD-ID                          PIC XX.
   865         88  VALID-CO-ID                          VALUE 'CO'.
   866
   867     12  CO-CONTROL-PRIMARY.
   868         16  CO-COMPANY-CD                     PIC X.
   869         16  CO-CONTROL.
   870             20  CO-CTL-1.
   871                 24  CO-CARR-GROUP.
   872                     28  CO-CARRIER            PIC X.
   873                     28  CO-GROUPING.
   874                         32  CO-GROUP-PREFIX   PIC XXX.
   875                         32  CO-GROUP-PRIME    PIC XXX.
   876                 24  CO-RESP-NO.
   877                     28  CO-RESP-PREFIX        PIC X(4).
   878                     28  CO-RESP-PRIME         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   879             20  CO-CTL-2.
   880                 24  CO-ACCOUNT.
   881                     28  CO-ACCT-PREFIX        PIC X(4).
   882                     28  CO-ACCT-PRIME         PIC X(6).
   883         16  CO-TYPE                           PIC X.
   884             88  CO-COMPANY-TYPE                  VALUE 'C'.
   885             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   886             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   887
   888     12  CO-MAINT-INFORMATION.
   889         16  CO-LAST-MAINT-DT                  PIC XX.
   890         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   891         16  CO-LAST-MAINT-USER                PIC X(4).
   892     12  FILLER                                PIC XX.
   893     12  CO-STMT-TYPE                          PIC XXX.
   894     12  CO-COMP-TYPE                          PIC X.
   895         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   896     12  CO-STMT-OWNER                         PIC X(4).
   897     12  CO-BALANCE-CONTROL                    PIC X.
   898         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   899         88  CO-NO-BALANCE                        VALUE 'N'.
   900
   901     12  CO-INTERNAL-CONTROL-1                 PIC X.
   902         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   903         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   904         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   905
   906     12  CO-INTERNAL-CONTROL-2                 PIC X.
   907         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   908         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   909
   910     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   911     12  CO-GA-DIRECT-DEP                      PIC X.
   912     12  CO-FUTURE-SPACE                       PIC X.
   913         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   914
   915     12  CO-ACCT-NAME                          PIC X(30).
   916     12  CO-MAIL-NAME                          PIC X(30).
   917     12  CO-ADDR-1                             PIC X(30).
   918     12  CO-ADDR-2                             PIC X(30).
   919     12  CO-ADDR-3.
   920         16  CO-ADDR-CITY                      PIC X(27).
   921         16  CO-ADDR-STATE                     PIC XX.
   922     12  CO-CSO-1099                           PIC X.
   923     12  CO-ZIP.
   924         16  CO-ZIP-PRIME.
   925             20  CO-ZIP-PRI-1ST                PIC X.
   926                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   927             20  FILLER                        PIC X(4).
   928         16  CO-ZIP-PLUS4                      PIC X(4).
   929     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   930         16  CO-CAN-POSTAL-1                   PIC XXX.
   931         16  CO-CAN-POSTAL-2                   PIC XXX.
   932         16  FILLER                            PIC XXX.
   933     12  CO-SOC-SEC                            PIC X(13).
   934     12  CO-TELEPHONE.
   935         16  CO-AREA-CODE                      PIC XXX.
   936         16  CO-PREFIX                         PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   937         16  CO-PHONE                          PIC X(4).
   938
   939     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   940
   941     12  CO-AR-BAL-LEVEL                       PIC X.
   942         88  CO-AR-REF-LVL                        VALUE '1'.
   943         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   944         88  CO-AR-BILL-LVL                       VALUE '2'.
   945         88  CO-AR-AGT-LVL                        VALUE '3'.
   946         88  CO-AR-FR-LVL                         VALUE '4'.
   947
   948     12  CO-AR-NORMAL-PRINT                    PIC X.
   949         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   950         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   951
   952     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   953
   954     12  CO-AR-REPORTING                       PIC X.
   955         88  CO-AR-NET-REPORT                     VALUE 'N'.
   956         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   957
   958     12  CO-AR-PULL-CHECK                      PIC X.
   959         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   960         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   961
   962     12  CO-AR-BALANCE-PRINT                   PIC X.
   963         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   964
   965     12  CO-AR-LAST-RUN-CODE                   PIC X.
   966         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   967         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   968         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   969
   970     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   971
   972     12  CO-USER-CODE                          PIC X.
   973     12  CO-REPORT-GROUP-ID                    PIC X(12).
   974
   975******************************************************************
   976*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   977*    THE LAST MONTH END RUN.
   978******************************************************************
   979
   980     12  CO-LAST-ACTIVITY-DATE.
   981         16  CO-ACT-YEAR                       PIC 99.
   982         16  CO-ACT-MONTH                      PIC 99.
   983         16  CO-ACT-DAY                        PIC 99.
   984
   985     12  CO-LAST-STMT-DT.
   986         16  CO-LAST-STMT-YEAR                 PIC 99.
   987         16  CO-LAST-STMT-MONTH                PIC 99.
   988         16  CO-LAST-STMT-DAY                  PIC 99.
   989
   990     12  CO-MO-END-TOTALS.
   991         16  CO-MONTHLY-TOTALS.
   992             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   993             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   994             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
   995             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   996             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   997
   998         16  CO-AGING-TOTALS.
   999             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1000             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1001             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1002             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1003
  1004         16  CO-YTD-TOTALS.
  1005             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1006             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1007
  1008         16  CO-OVER-UNDER-TOTALS.
  1009             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1010             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1011
  1012     12  CO-MISCELLANEOUS-TOTALS.
  1013         16  CO-FICA-TOTALS.
  1014             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1015             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1016
  1017         16  CO-CLAIM-TOTALS.
  1018             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1019             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1020
  1021******************************************************************
  1022*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1023*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1024******************************************************************
  1025
  1026     12  CO-CURRENT-TOTALS.
  1027         16  CO-CURRENT-LAST-STMT-DT.
  1028             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1029             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1030             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1031
  1032         16  CO-CURRENT-MONTHLY-TOTALS.
  1033             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1034             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1035             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1036             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1037             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1038
  1039         16  CO-CURRENT-AGING-TOTALS.
  1040             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1041             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1042             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1043             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1044
  1045         16  CO-CURRENT-YTD-TOTALS.
  1046             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1047             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1048
  1049     12  CO-PAID-COMM-TOTALS.
  1050         16  CO-YTD-PAID-COMMS.
  1051             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1052             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1053
  1054     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1055         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1056         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1057
  1058     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1059         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1060         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1061         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1062         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1063         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1064         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1065         88  CO-FINAL-LETTER                  VALUE 'F'.
  1066         88  CO-RECONCILING                   VALUE 'R'.
  1067         88  CO-PHONE-CALL                    VALUE 'P'.
  1068         88  CO-LEGAL                         VALUE 'L'.
  1069         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1070         88  CO-WRITE-OFF                     VALUE 'W'.
  1071         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1072
  1073     12  CO-CSR-CODE                       PIC X(4).
  1074
  1075     12  CO-GA-STATUS-INFO.
  1076         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1077         16  CO-GA-TERMINATION-DT          PIC XX.
  1078         16  CO-GA-STATUS-CODE             PIC X.
  1079             88  CO-GA-ACTIVE                 VALUE 'A'.
  1080             88  CO-GA-INACTIVE               VALUE 'I'.
  1081             88  CO-GA-PENDING                VALUE 'P'.
  1082         16  CO-GA-COMMENTS.
  1083             20  CO-GA-COMMENT-1           PIC X(40).
  1084             20  CO-GA-COMMENT-2           PIC X(40).
  1085             20  CO-GA-COMMENT-3           PIC X(40).
  1086             20  CO-GA-COMMENT-4           PIC X(40).
  1087
  1088     12  CO-RPTCD2                         PIC X(10).
  1089     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1090         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1091         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1092
  1093     12  CO-TYPE-AGENT                     PIC X(01).
  1094         88  CO-CORPORATION                   VALUE 'C'.
  1095         88  CO-PARTNERSHIP                   VALUE 'P'.
  1096         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1097         88  CO-TRUST                         VALUE 'T'.
  1098         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1099
  1100     12  CO-FAXNO.
  1101         16  CO-FAX-AREA-CODE                  PIC XXX.
  1102         16  CO-FAX-PREFIX                     PIC XXX.
  1103         16  CO-FAX-PHONE                      PIC X(4).
  1104
  1105     12  CO-BANK-INFORMATION.
  1106         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1107         16  CO-BANK-TRANSIT-NON REDEFINES
  1108             CO-BANK-TRANSIT-NO                PIC 9(8).
  1109
  1110         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS046.cbl (/apps/prod/cid1p/copy/ERCCOMP)
  1111     12  CO-MISC-DEDUCT-INFO REDEFINES
  1112                  CO-BANK-INFORMATION.
  1113         16  CO-MD-GL-ACCT                     PIC X(10).
  1114         16  CO-MD-DIV                         PIC XX.
  1115         16  CO-MD-CENTER                      PIC X(4).
  1116         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1117         16  CO-CREATE-AP-CHECK                PIC X.
  1118         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1119         16  FILLER                            PIC XXX.
  1120     12  CO-ACH-STATUS                         PIC X.
  1121         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1122         88  CO-ACH-PENDING                        VALUE 'P'.
  1123
  1124     12  CO-BILL-SW                            PIC X.
  1125     12  CO-CONTROL-NAME                       PIC X(30).
  1126     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1127     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1128     12  CO-CLP-STATE                          PIC XX.
  1129     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1130     12  CO-SPP-REFUND-EDIT                    PIC X.
  1131
  1132******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS046.cbl
  1134 FD  DISK-DATE                                                    ECS046
* 1135                             COPY ELCDTEFD.                       ECS046
  1136******************************************************************04/15/98
  1137*                                                                *ELCDTEFD
  1138*                                                                *ELCDTEFD
  1139*                            ELCDTEFD.                           *   LV002
  1140*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1141*                            VMOD=2.007                          *   CL**2
  1142*                                                                *ELCDTEFD
  1143******************************************************************ELCDTEFD
  1144     BLOCK CONTAINS 0 RECORDS
  1145     RECORDING MODE F.                                            ELCDTEFD
  1146                                                                  ELCDTEFD
  1147 01  DATE-DISK.                                                   ELCDTEFD
  1148     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1149     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1150     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1151     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1152     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1153     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1154     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1155                                                                  ELCDTEFD
  1156 01  DATE-DISK-R.                                                 ELCDTEFD
  1157     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1158     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1159                                     PIC  X(32).                  ELCDTEFD
  1160                                                                  ELCDTEFD
  1161 01  DATE-DISK-T.                                                 ELCDTEFD
  1162     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1163     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1164                                     PIC  X(48).                  ELCDTEFD
  1165                                                                  ELCDTEFD
  1166 01  DATE-DISK-M.                                                 ELCDTEFD
  1167     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1168     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1169                                     PIC  X(48).                  ELCDTEFD
  1170                                                                  ELCDTEFD
  1171 01  DATE-DISK-P.                                                 ELCDTEFD
  1172     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1173     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1174     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1175     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1176         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1177                                     PIC  X.                      ELCDTEFD
  1178         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1179     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1180         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1181             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1182             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1183             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1184             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1185         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1186                                                                  ELCDTEFD
  1187 01  DATE-DISK-E.                                                 ELCDTEFD
  1188     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1189     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1190                                     PIC  X(4).                   ELCDTEFD
  1191                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1192 01  DATE-DISK-C.                                                 ELCDTEFD
  1193     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1194     12  DD-CARR1-SECPAY-SW          PIC  X.
  1195     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1196     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1197     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1198     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1199     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1200     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1201     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1202     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1203     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1204     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1205     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1206     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1207     12  DD-CARR2-SECPAY-SW          PIC  X.
  1208     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1209                                                                  ELCDTEFD
  1210 01  DATE-DISK-OPT.                                               ELCDTEFD
  1211     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1212     12  DD-TLR-DATA.                                             ELCDTEFD
  1213         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1214                                     PIC  X(03).                  ELCDTEFD
  1215     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1216         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1217                                     PIC  X(06).                  ELCDTEFD
  1218     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1219         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1220                                     PIC  X(07).                  ELCDTEFD
  1221         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1222     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1223                                     PIC  X(96).                  ELCDTEFD
  1224******************************************************************ELCDTEFD
  1225                                                                  ECS046
  1226 FD  FICH                                                         ECS046
* 1227                             COPY ELCFCHFD.                       ECS046
  1228******************************************************************04/15/98
  1229*                                                                *ELCFCHFD
  1230*                            ELCFCHFD.                           *   LV003
  1231*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1232*                            VMOD=2.004                          *   CL**3
  1233*                                                                *ELCFCHFD
  1234******************************************************************ELCFCHFD
  1235     BLOCK CONTAINS 0 RECORDS
  1236     RECORDING MODE F.                                            ELCFCHFD
  1237                                                                  ELCFCHFD
  1238 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1239******************************************************************ELCFCHFD
  1240                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS046.cbl
  1242 WORKING-STORAGE SECTION.                                         ECS046
  1243 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.      ECS046
  1244 77  FILLER  PIC X(32) VALUE '********************************'.  ECS046
  1245 77  FILLER  PIC X(32) VALUE '     ECS046 WORKING STORAGE     '.  ECS046
  1246 77  FILLER  PIC X(32) VALUE '***********VMOD=2.014 **********'.  ECS046
  1247                                                                  ECS046
  1248 77  NO-OF-RECORDS-RELEASED    PIC S9(9)      COMP-3  VALUE +0.   ECS046
  1249 77  SA                        PIC S999       COMP.               ECS046
  1250 77  SB                        PIC S999       COMP.               ECS046
  1251 77  SC                        PIC S999       COMP.               ECS046
  1252 77  SE                        PIC S999       COMP.               ECS046
  1253 77  CL                        PIC S999       COMP.               ECS046
  1254 77  PAGE-CNT                  PIC S9(5)      COMP-3 VALUE +0.    ECS046
  1255 77  LINE-CNT                  PIC S999       COMP-3 VALUE +0.    ECS046
  1256 77  PGM-SUB                   PIC S999       COMP-3 VALUE +46.   ECS046
  1257 77  X                         PIC X.                             ECS046
  1258 77  WS-BREAK-SW               PIC X       VALUE SPACES.          ECS046
  1259 77  WS-EP-CODE                PIC X.                             ECS046
  1260 77  WS-FIN-RESP-AGT           PIC X(10).                         ECS046
  1261 77  SAVE-STATE                PIC XX.                            ECS046
  1262 77  SAVE-LF-BEN               PIC XX.                            ECS046
  1263 77  SAVE-EP-CODE              PIC X.                             ECS046
  1264                                                                  ECS046
  1265 01  WS-ABEND-STORAGE.                                            ECS046
  1266     12  WS-RETURN-CODE        PIC S9(4)  VALUE ZERO COMP.        ECS046
  1267     12  WS-ABEND-MESSAGE      PIC X(80)  VALUE SPACES.           ECS046
  1268     12  WS-ABEND-FILE-STATUS  PIC XX     VALUE ZERO.             ECS046
  1269     12  WS-ZERO               PIC S9     VALUE ZERO COMP-3.      ECS046
  1270                                                                  ECS046
  1271     12  ERACCT-FILE-STATUS    PIC XX     VALUE ZERO.             ECS046
  1272     12  ERCOMP-FILE-STATUS    PIC XX     VALUE ZERO.             ECS046
  1273                                                                  ECS046
  1274 01  WS-ACTIVE-PARM.                                              ECS046
  1275     12  WS-ACTIVE-INDIC       PIC X(6).                          ECS046
  1276     12  FILLER                PIC X(74).                         ECS046
  1277                                                                  ECS046
  1278 01  HOLD-COMP-KEY.                                               ECS046
  1279     12  HOLD-COMPANY-CD       PIC X.                             ECS046
  1280     12  HOLD-CARRIER          PIC X.                             ECS046
  1281     12  HOLD-GROUPING         PIC X(6).                          ECS046
  1282     12  HOLD-GA-NUMBER        PIC X(10).                         ECS046
  1283     12  HOLD-ACCT             PIC X(10).                         ECS046
  1284     12  HOLD-RECORD-TYPE      PIC X.                             ECS046
  1285                                                                  ECS046
  1286 01  MISC-FIELDS.                                                 ECS046
  1287     12  HOLD-GA-NAME          PIC X(30)  VALUE SPACES.           ECS046
  1288     12  HOLD-ACTIVE-DESC      PIC X(15)  VALUE                   ECS046
  1289             'ACTIVE ACCOUNTS'.                                   ECS046
  1290     12  HOLD-ALL-DESC         PIC X(15)  VALUE                   ECS046
  1291             'ALL ACCOUNTS   '.                                   ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS046.cbl
  1293*    THE FOLLOWING RECORD CONTAINS REPORT DATA FOR THE A REPORT.  ECS046
  1294*    NOT ALL THE INDIVIDUAL FIELDS IN THE CONTROL AREA ARE USED   ECS046
  1295*    DEPENDING ON THE TOTAL-OPTION FOR THE PROGRAM (SEE ECS046    ECS046
  1296*    TOTAL-OPTIONS IN THE PROGRAM OPTIONS FILE).  THOSE FIELDS    ECS046
  1297*    THAT AREN'T USED ARE PRIMED WITH BLANKS ON ALL RECORDS.      ECS046
  1298                                                                  ECS046
  1299 01  SWA-REC.                                                     ECS046
  1300     12  SWA-CONTROL.                                             ECS046
  1301         16  SWA-CONTROL-1.                                       ECS046
  1302             20  SWA-BUS-TYPE        PIC XX.                      ECS046
  1303             20  SWA-CARR            PIC X.                       ECS046
  1304             20  SWA-GROUP           PIC X(6).                    ECS046
  1305             20  SWA-GA-OR-RPT-CD    PIC X(10).                   ECS046
  1306             20  SWA-STATE           PIC XX.                      ECS046
  1307         16  SWA-CONTROL-R REDEFINES SWA-CONTROL-1.               ECS046
  1308             20  SWA-RPT-CD-1        PIC X(10).                   ECS046
  1309             20  SWA-RPT-CD-2        PIC X(11).                   ECS046
  1310         16  SWA-ACCT                PIC X(10).                   ECS046
  1311     12  SWA-NAME                    PIC X(30).                   ECS046
  1312     12  SWA-CITY                    PIC X(30).                   ECS046
  1313     12  SWA-AMOUNTS COMP-3 OCCURS 2.                             ECS046
  1314*  OCCURRENCE 1 = LIFE, 2 = A&H                                   ECS046
  1315         16 SWA-NET-PREM             PIC S9(9)V99.                ECS046
  1316         16 SWA-EARN-PREM            PIC S9(9)V99.                ECS046
  1317         16 SWA-CLMS-INCUR           PIC S9(9)V99.                ECS046
  1318         16 SWA-EARN-COMP            PIC S9(9)V99.                ECS046
  1319         16 SWA-RETENTION            PIC S9(9)V99.                ECS046
  1320         16 SWA-PREM-TAX             PIC S9(9)V99.                ECS046
  1321     12  SWA-SAVE-GROUP              PIC X(6).                    ECS046
  1322                                                                  ECS046
  1323*    THE FOLLOWING RECORD CONTAINS REPORT DATA FOR THE B REPORT.  ECS046
  1324*    NOT ALL THE INDIVIDUAL FIELDS IN THE RECORD FOLLOWING THE    ECS046
  1325*    AMOUNT FIELDS HAVE DATA, DEPENDING ON THE TOTAL OPTIONS FOR  ECS046
  1326*    THIS PROGRAM.  THE SORT CONTROL FIELD (SWB-SORT-AMT) CONTAINSECS046
  1327*    THE AMOUNT THAT DETERMINES THE SEQUENCE OF THE B REPORT (SEE ECS046
  1328*    THE FORMAT-OPTION IN THE PROGRAM OPTIONS FILE).              ECS046
  1329                                                                  ECS046
  1330 01  SWB-REC.                                                     ECS046
  1331     12  SWB-CONTROL.                                             ECS046
  1332         16  SWB-SORT-AMT           PIC S9(9)V99  COMP-3.         ECS046
  1333     12  SWB-LOSS-RATIO             PIC S9(4)V99  COMP-3.         ECS046
  1334     12  SWB-NET-PREM               PIC S9(9)V99  COMP-3.         ECS046
  1335     12  SWB-TOT-CHARGES            PIC S9(3)V99  COMP-3.         ECS046
  1336     12  SWB-PREM-PROFIT            PIC S9(8)V99  COMP-3.         ECS046
  1337     12  SWB-BUS-TYPE               PIC XX.                       ECS046
  1338     12  SWB-CARR                   PIC X.                        ECS046
  1339     12  SWB-GROUP                  PIC X(6).                     ECS046
  1340     12  SWB-STATE                  PIC XX.                       ECS046
  1341     12  SWB-GA-OR-RPT-CD           PIC X(10).                    ECS046
  1342     12  SWB-ACCT                   PIC X(10).                    ECS046
  1343     12  SWB-NAME                   PIC X(30).                    ECS046
  1344                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS046.cbl
  1346 01  WS-ACCT-CONTROL.                                             ECS046
  1347     12  WS-MSTR-CNTRL              PIC X(25) VALUE LOW-VALUES.   ECS046
  1348     12  WS-EFFECT                  PIC 9(11) COMP-3 VALUE 0.        CL**8
  1349                                                                  ECS046
  1350 01  WS-SAVE-CONTROL.                                             ECS046
  1351     12  WS-SAVE-CNTRL-1.                                         ECS046
  1352         16 WS-SAVE-CARR            PIC X.                        ECS046
  1353         16 WS-SAVE-GROUP           PIC X(6).                     ECS046
  1354         16 WS-SAVE-STATE           PIC XX.                       ECS046
  1355         16 WS-SAVE-ACCT            PIC X(10).                    ECS046
  1356     12  WS-SAVE-EXP-DATE           PIC 9(11)  COMP-3.               CL**2
  1357     12  WS-SAVE-EFF-DATE           PIC 9(11)  COMP-3.               CL**2
  1358                                                                  ECS046
  1359 01  SAVE-SWA-CONTROL.                                            ECS046
  1360     12  SAVE-SWA-CONTROL-1.                                      ECS046
  1361         16  SAVE-SWA-BUS-TYPE      PIC XX.                       ECS046
  1362         16  SAVE-SWA-CARR          PIC X.                        ECS046
  1363         16  SAVE-SWA-GROUP         PIC X(6).                     ECS046
  1364         16  SAVE-SWA-GA-OR-RPT-CD  PIC X(10).                    ECS046
  1365         16  SAVE-SWA-STATE         PIC XX.                       ECS046
  1366      12 SAVE-SWA-CONTROL-R REDEFINES SAVE-SWA-CONTROL-1.         ECS046
  1367         16  SAVE-SWA-RPT-CD-1      PIC X(10).                    ECS046
  1368         16  SAVE-SWA-RPT-CD-2      PIC X(11).                    ECS046
  1369      12  SAVE-SWA-ACCT             PIC X(10).                    ECS046
  1370                                                                  ECS046
  1371 01  MISC-AMTS    COMP-3.                                         ECS046
  1372     12 WS-RETENTION-PCT            PIC S9V9(5).                  ECS046
  1373     12 WS-TAX-RATE                 PIC S9V9(4).                  ECS046
  1374     12 WS-DA-EARN-PREM             PIC S9(9)V99.                 ECS046
  1375     12 WS-LF-SURPLUS               PIC S9(9)V99.                 ECS046
  1376     12 WS-LF-PREM-PROFIT           PIC S9(9)V99.                 ECS046
  1377     12 WS-LF-UW-INCOME             PIC S9(9)V99.                 ECS046
  1378     12 WS-AH-SURPLUS               PIC S9(9)V99.                 ECS046
  1379     12 WS-AH-PREM-PROFIT           PIC S9(9)V99.                 ECS046
  1380     12 WS-AH-UW-INCOME             PIC S9(9)V99.                 ECS046
  1381     12 WS-LOSS-RATIO               PIC S9(4)V9(4).               ECS046
  1382     12 WS-COMP-RATIO               PIC S9(3)V9(4).               ECS046
  1383     12 WS-TOT-CHARGES              PIC S9(3)V9(4).               ECS046
  1384     12 WS-SEQUENCE                 PIC S9(5)     VALUE +0.       ECS046
  1385                                                                  ECS046
  1386 01  BEG-DATE                PIC 9(11).                              CL**2
  1387 01  BEG-DATE-R REDEFINES BEG-DATE.                                  CL**2
  1388     12 FILLER               PIC 999.                             ECS046
  1389     12  BD-CCYY             PIC 9(04).                           ECS046
  1390     12  BD-CCYR REDEFINES BD-CCYY.                               ECS046
  1391         16  BD-CC           PIC 99.                              ECS046
  1392         16  BD-YR           PIC 99.                              ECS046
  1393     12  BD-MO               PIC 99.                              ECS046
  1394     12  BD-DA               PIC 99.                              ECS046
  1395                                                                  ECS046
  1396 01  RUN-DT                  PIC 9(11).                              CL**2
  1397 01  RUN-DT-R REDEFINES RUN-DT.                                      CL**2
  1398     12  FILLER              PIC 999.                             ECS046
  1399     12  RD-CCYY             PIC 9(04).                           ECS046
  1400     12  RD-CCYR REDEFINES RD-CCYY.                               ECS046
  1401         16  RD-CC           PIC 99.                              ECS046
  1402         16  RD-YR           PIC 99.                              ECS046
  1403     12  RD-MO               PIC 99.                              ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS046.cbl
  1404     12  RD-DA               PIC 99.                              ECS046
  1405                                                                  ECS046
  1406 01  WS-SAVE-EXP-DATE-R      PIC 9(11).                              CL**3
  1407 01  WS-SAVE-EXP-DATE-R-N REDEFINES WS-SAVE-EXP-DATE-R.              CL**5
  1408     12  FILLER                 PIC 999.                          ECS046
  1409     12  WS-SAVE-EXP-CCYY       PIC 9(04).                        ECS046
  1410     12  WS-SAVE-EXP-CCYR REDEFINES WS-SAVE-EXP-CCYY.             ECS046
  1411         16  WS-SAVE-EXP-CC     PIC 99.                           ECS046
  1412         16  WS-SAVE-EXP-YR     PIC 99.                           ECS046
  1413     12  WS-SAVE-EXP-MO         PIC 99.                           ECS046
  1414     12  WS-SAVE-EXP-DA         PIC 99.                           ECS046
  1415                                                                  ECS046
  1416 01  WS-SAVE-EFF-DATE-R      PIC 9(11).                              CL**3
  1417 01  WS-SAVE-EFF-DATE-R-N  REDEFINES WS-SAVE-EFF-DATE-R.             CL**3
  1418     12  FILLER              PIC 999.                             ECS046
  1419     12  WS-SAVE-EFF-CCYY    PIC 9(04).                           ECS046
  1420     12  WS-SAVE-EFF-CCYR REDEFINES WS-SAVE-EFF-CCYY.             ECS046
  1421         16  WS-SAVE-EFF-CC  PIC 99.                              ECS046
  1422         16  WS-SAVE-EFF-YR  PIC 99.                              ECS046
  1423     12  WS-SAVE-EFF-MO      PIC 99.                              ECS046
  1424     12  WS-SAVE-EFF-DA      PIC 99.                              ECS046
  1425                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS046.cbl
  1427*                                                                 ECS046
  1428* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS          ECS046
  1429*                                                                 ECS046
  1430*    OCCURRENCE 1 = LIFE BEGINNING DATA                           ECS046
  1431*    OCCURRENCE 2 = A&H BEGINNING DATA                            ECS046
  1432*    OCCURRENCE 3 = LIFE CURRENT DATA                             ECS046
  1433*    OCCURRENCE 4 = A&H CURRENT DATA                              ECS046
  1434*                                                                 ECS046
  1435 01  DETAIL-ACCUMULATORS     COMP-3.                              ECS046
  1436     12  DETAIL-ACCUMS   OCCURS 4.                                ECS046
  1437         16  DA-NET-PREM            PIC S9(9)V99.                 ECS046
  1438         16  DA-EARN-PREM           PIC S9(9)V99.                 ECS046
  1439         16  DA-CLAIM-AMT           PIC S9(9)V99.                 ECS046
  1440         16  DA-LOSS-RSRV           PIC S9(9)V99.                 ECS046
  1441         16  DA-EARN-COMP           PIC S9(9)V99.                 ECS046
  1442         16  DA-RETENTION           PIC S9(9)V99.                 ECS046
  1443         16  DA-PREM-TAX            PIC S9(9)V99.                 ECS046
  1444*                                                                 ECS046
  1445* THE BREAK ACCUMULATORS ARE USED AS FOLLOWS                      ECS046
  1446*                                                                 ECS046
  1447*    A SET CONSISTS OF 2 ACCUMULATORS FOR EACH ITEM.              ECS046
  1448*        OCCURRENCE 1 = LIFE TOTAL PERIOD                         ECS046
  1449*        OCCURRENCE 2 = A&H TOTAL PERIOD                          ECS046
  1450*                                                                 ECS046
  1451*    THERE ARE 6 SETS                                             ECS046
  1452*        SET 1 = LEVEL 1 (STATE TOTALS)                           ECS046
  1453*        SET 2 = LEVEL 2 (REPORT CODE OR G.A. TOTALS)             ECS046
  1454*        SET 3 = LEVEL 3 (GROUP TOTALS)                           ECS046
  1455*        SET 4 = LEVEL 4 (CARRIER TOTALS)                         ECS046
  1456*        SET 5 = LEVEL 5 (BUSINESS TYPE TOTALS)                   ECS046
  1457*        SET 6 = LEVEL 6 (FINAL TOTALS)                           ECS046
  1458*                                                                 ECS046
  1459 01  BREAK-ACCUMULATORS      COMP-3.                              ECS046
  1460     12  BREAK-ACCUMS    OCCURS 2.                                ECS046
  1461         16  BREAK-ACCUMS-SL    OCCURS 6.                         ECS046
  1462             20  BA-NET-PREM     PIC S9(9)V99.                    ECS046
  1463             20  BA-EARN-PREM    PIC S9(9)V99.                    ECS046
  1464             20  BA-CLMS-INCUR   PIC S9(9)V99.                    ECS046
  1465             20  BA-EARN-COMP    PIC S9(9)V99.                    ECS046
  1466             20  BA-RETENTION    PIC S9(9)V99.                    ECS046
  1467             20  BA-PREM-PROFIT  PIC S9(9)V99.                    ECS046
  1468             20  BA-PREM-TAX     PIC S9(9)V99.                    ECS046
  1469                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS046.cbl
  1471 01  HEAD-1.                                                      ECS046
  1472     12  FILLER          PIC X(52)   VALUE SPACES.                ECS046
  1473     12  FILLER          PIC X(22)   VALUE                        ECS046
  1474                                     'ACCOUNT PROFIT SUMMARY'.    ECS046
  1475     12  FILLER          PIC X(4)    VALUE SPACES.                ECS046
  1476     12  HD-RPT-TYPE     PIC X(25)   VALUE SPACES.                ECS046
  1477     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1478     12  HD-STATUS-DESC  PIC X(15)   VALUE SPACES.                ECS046
  1479*    12  FILLER          PIC X(5)    VALUE SPACES.                ECS046
  1480     12  FILLER          PIC X(6)    VALUE 'ECS046'.              ECS046
  1481     12  H1-REPORT-SUF   PIC X       VALUE SPACES.                ECS046
  1482                                                                  ECS046
  1483 01  HEAD-2.                                                      ECS046
  1484     12  FILLER          PIC X(48)   VALUE SPACES.                ECS046
  1485     12  HD-COMP         PIC X(30)   VALUE SPACES.                ECS046
  1486     12  FILLER          PIC X(41)   VALUE SPACES.                ECS046
  1487     12  HD-RUN-DATE     PIC X(8)    VALUE SPACES.                ECS046
  1488                                                                  ECS046
  1489 01  HEAD-3.                                                      ECS046
  1490     12  FILLER          PIC X(53)   VALUE SPACES.                ECS046
  1491     12  HD-ALPHA-DATE   PIC X(18)   VALUE SPACES.                ECS046
  1492     12  FILLER          PIC X(48)   VALUE SPACES.                ECS046
  1493     12  FILLER          PIC X(5)    VALUE 'PAGE'.                ECS046
  1494     12  HD-PAGE-NO      PIC ZZZ9.                                ECS046
  1495                                                                  ECS046
  1496 01  HEAD-CARR.                                                   ECS046
  1497     12  FILLER          PIC X(13)   VALUE 'CARRIER    -'.        ECS046
  1498     12  HC-CARRIER      PIC X       VALUE SPACES.                ECS046
  1499     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1500     12  HC-CARRIER-NAME PIC X(30)   VALUE SPACES.                ECS046
  1501                                                                  ECS046
  1502 01  HEAD-BUS-TYPE.                                               ECS046
  1503     12  FILLER          PIC X(13)   VALUE 'BUS. TYPE  -'.        ECS046
  1504     12  HB-BUS-TYPE     PIC XX      VALUE SPACES.                ECS046
  1505     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1506     12  HB-BUS-DESC     PIC X(24)   VALUE SPACES.                ECS046
  1507                                                                  ECS046
  1508 01  HEAD-RPT-CODE.                                               ECS046
  1509     12  HR-CAPTION      PIC X(10)   VALUE SPACES.                ECS046
  1510     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1511     12  HR-RPT-CODE     PIC X(10)   VALUE SPACES.                ECS046
  1512                                                                  ECS046
  1513 01  HEAD-RPT2-CODE.                                              ECS046
  1514     12  HR2-CAPTION     PIC X(10)   VALUE SPACES.                ECS046
  1515     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1516     12  HR2-RPT-CODE1   PIC X(10)   VALUE SPACES.                ECS046
  1517     12  FILLER          PIC XXX     VALUE ' -'.                  ECS046
  1518     12  HR2-RPT-CODE2   PIC X(10)   VALUE SPACES.                ECS046
  1519                                                                  ECS046
  1520 01  HEAD-GROUP.                                                  ECS046
  1521     12  FILLER          PIC X(13)   VALUE 'GROUP      -'.        ECS046
  1522     12  HG-GROUP        PIC X(6)    VALUE SPACES.                ECS046
  1523                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS046.cbl
  1525 01  HEAD-G-A.                                                    ECS046
  1526     12  FILLER          PIC X(13)   VALUE 'GENL AGENT -'.        ECS046
  1527     12  HGA-AGENT       PIC X(10)   VALUE SPACES.                ECS046
  1528     12  FILLER          PIC X(5)    VALUE SPACES.                ECS046
  1529     12  HGA-GA-NAME     PIC X(30)   VALUE SPACES.                ECS046
  1530                                                                  ECS046
  1531 01  HEAD-STATE.                                                  ECS046
  1532     12  FILLER          PIC X(13)   VALUE 'STATE      -'.        ECS046
  1533     12  HS-STATE        PIC XX      VALUE SPACES.                ECS046
  1534                                                                  ECS046
  1535 01  HEAD-ACCT.                                                   ECS046
  1536     12  FILLER          PIC X(13)   VALUE 'ACCOUNT    -'.        ECS046
  1537     12  HA-ACCOUNT      PIC X(10)   VALUE SPACES.                ECS046
  1538     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1539     12  HA-ACCT-NAME    PIC X(30)   VALUE SPACES.                ECS046
  1540     12  FILLER          PIC XX      VALUE SPACES.                ECS046
  1541     12  HA-ACCT-CITY    PIC X(30)   VALUE SPACES.                ECS046
  1542                                                                  ECS046
  1543 01  HD-BRK-TYPE.                                                 ECS046
  1544     12  HD-RPT-CAPTION  PIC X(10)   VALUE SPACES.                ECS046
  1545     12  FILLER          PIC X(7)    VALUE ' TOTALS'.             ECS046
  1546                                                                  ECS046
  1547 01  HEAD-4A.                                                     ECS046
  1548     12  FILLER          PIC X(50)   VALUE                        ECS046
  1549         '          NET       EARNED     CLAIMS       EARNED'.    ECS046
  1550     12  HEAD-4A-FIL1    PIC X(27)   VALUE SPACES.                ECS046
  1551     12  FILLER          PIC X(12)   VALUE                        ECS046
  1552         'PREMIUM     '.                                          ECS046
  1553     12  HEAD-4A-FIL2    PIC X(8)    VALUE 'PREMIUM '.            ECS046
  1554     12  FILLER          PIC X(33)   VALUE                        ECS046
  1555         'UNDERWRITE  LOSS   COMP    TOTAL '.                     ECS046
  1556                                                                  ECS046
  1557 01  HEAD-4A-DESC.                                                ECS046
  1558     12  FIL1-DESC       PIC X(27)   VALUE                        ECS046
  1559             '                RETRO      '.                       ECS046
  1560     12  FIL2-DESC       PIC X(8)    VALUE                        ECS046
  1561             'MINIMUM '.                                          ECS046
  1562                                                                  ECS046
  1563 01  HEAD-5A.                                                     ECS046
  1564     12  FILLER          PIC X(50)   VALUE                        ECS046
  1565         '        PREMIUM     PREMIUM   INCURRED       COMP'.     ECS046
  1566     12  FILLER          PIC X(27)   VALUE                        ECS046
  1567         '    SURPLUS   RETENTION'.                               ECS046
  1568     12  FILLER          PIC X(12)   VALUE                        ECS046
  1569         'PROFIT      '.                                          ECS046
  1570     12  HEAD-5A-FILL1   PIC X(6)    VALUE  ' TAXES'.             ECS046
  1571     12  FILLER          PIC X(35)   VALUE                        ECS046
  1572         '    INCOME    RATIO  RATIO  CHARGES'.                   ECS046
  1573                                                                  ECS046
  1574 01  HEAD-5A-DESC.                                                ECS046
  1575     12  FILLER          PIC X(6)    VALUE                        ECS046
  1576         'MARGIN'.                                                ECS046
  1577                                                                  ECS046
  1578 01  HEAD-4B.                                                     ECS046
  1579     12  FILLER          PIC X(50)   VALUE                        ECS046
  1580         '        LOSS          NET      TOTAL      PREMIUM'.     ECS046
  1581     12  FILLER          PIC X(12).                               ECS046
  1582     12  H4B-BUS         PIC XXX.                                 ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS046.cbl
  1583     12  FILLER          PIC X(10).                               ECS046
  1584     12  H4B-GENERAL     PIC X(7).                                ECS046
  1585     12  FILLER          PIC X(50).                               ECS046
  1586                                                                  ECS046
  1587 01  HEAD-5B.                                                     ECS046
  1588     12  FILLER          PIC X(50)   VALUE                        ECS046
  1589         ' SEQ    RATIO       PREMIUM   CHARGES     PROFIT'.      ECS046
  1590     12  FILLER          PIC X(9)    VALUE SPACES.                ECS046
  1591     12  H5B-CTL-HDA     PIC X(15).                               ECS046
  1592     12  H5B-CTL-HDB     PIC X(16).                               ECS046
  1593     12  FILLER          PIC X(44)   VALUE                        ECS046
  1594         ' ACCOUNT     ACCOUNT NAME'.                             ECS046
  1595                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS046.cbl
  1597 01  DTL-NO-ACCT.                                                 ECS046
  1598     12  DNA-CARR        PIC X       VALUE SPACES.                ECS046
  1599     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1600     12  DNA-GROUP       PIC X(6)    VALUE SPACES.                ECS046
  1601     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1602     12  DNA-ST          PIC XX      VALUE SPACES.                ECS046
  1603     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1604     12  DNA-ACCT        PIC X(10)   VALUE SPACES.                ECS046
  1605     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1606     12  DNA-FMO         PIC XX      VALUE SPACES.                ECS046
  1607     12  DNA-FS1         PIC X       VALUE '-'.                   ECS046
  1608     12  DNA-FDA         PIC XX      VALUE SPACES.                ECS046
  1609     12  DNA-FS2         PIC X       VALUE '-'.                   ECS046
  1610     12  DNA-FYR         PIC XX      VALUE SPACES.                ECS046
  1611     12  FILLER          PIC X       VALUE SPACES.                ECS046
  1612     12  DNA-TMO         PIC XX      VALUE SPACES.                ECS046
  1613     12  DNA-TS1         PIC X       VALUE '-'.                   ECS046
  1614     12  DNA-TDA         PIC XX      VALUE SPACES.                ECS046
  1615     12  DNA-TS2         PIC X       VALUE '-'.                   ECS046
  1616     12  DNA-TYR         PIC XX      VALUE SPACES.                ECS046
  1617     12  FILLER          PIC X(4)    VALUE SPACES.                ECS046
  1618     12  DNA-MESSAGE     PIC X(40)   VALUE SPACES.                ECS046
  1619                                                                  ECS046
  1620 01  DTL-LINE-A.                                                  ECS046
  1621     12  DLA-BEN-DESC    PIC XXX.                                 ECS046
  1622     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1623     12  DLA-NET-PREM    PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1624     12  DLA-EARN-PREM   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1625     12  DLA-CLMS-INCUR  PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1626     12  DLA-EARN-COMP   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1627     12  DLA-SURPLUS     PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1628     12  DLA-RETENTION   PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1629     12  DLA-PREM-PROFIT PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1630     12  DLA-PREM-TAX    PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1631     12  DLA-UW-INCOME   PIC  ZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1632     12  DLA-LOSS-RATIO  PIC ZZZ9.99-.                            ECS046
  1633     12  DLA-LOSS-RATIO-RD REDEFINES DLA-LOSS-RATIO  PIC X(8).    ECS046
  1634     12  DLA-COMP-RATIO  PIC  Z9.99-.                             ECS046
  1635     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1636     12  DLA-TOT-CHARGES PIC ZZ9.99-.                             ECS046
  1637     12  DLA-TOT-CHARGES-RD REDEFINES DLA-TOT-CHARGES  PIC X(7).  ECS046
  1638     12  FILLER          PIC XXX         VALUE SPACES.            ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS046.cbl
  1640 01  DTL-LINE-B.                                                  ECS046
  1641     12  DLB-SEQ-NO      PIC ZZZZ9.                               ECS046
  1642     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1643     12  DLB-LOSS-RATIO  PIC ZZZ9.99-.                            ECS046
  1644     12  FILLER          PIC XX          VALUE SPACES.            ECS046
  1645     12  DLB-NET-PREM    PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1646     12  FILLER          PIC XX          VALUE SPACES.            ECS046
  1647     12  DLB-TOT-CHARGES PIC ZZ9.99-.                             ECS046
  1648     12  FILLER          PIC X           VALUE SPACES.            ECS046
  1649     12  DLB-PREM-PROFIT PIC ZZZ,ZZZ,ZZZ-   BLANK WHEN ZERO.      ECS046
  1650     12  DLB-DESC.                                                ECS046
  1651         16  FILLER          PIC X(13).                           ECS046
  1652         16  DLB-BUS-TYPE    PIC XX.                              ECS046
  1653         16  FILLER          PIC X(4).                            ECS046
  1654         16  DLB-CARRIER     PIC X.                               ECS046
  1655         16  FILLER          PIC X(4).                            ECS046
  1656         16  DLB-GROUP       PIC X(6).                            ECS046
  1657         16  FILLER          PIC X(4).                            ECS046
  1658         16  DLB-STATE       PIC XX.                              ECS046
  1659         16  FILLER          PIC X(4).                            ECS046
  1660     12  DLB-DESC2  REDEFINES  DLB-DESC.                          ECS046
  1661         16  FILLER          PIC X(10).                           ECS046
  1662         16  DLB2-CARRIER    PIC X.                               ECS046
  1663         16  FILLER          PIC X(4).                            ECS046
  1664         16  DLB2-GROUP      PIC X(6).                            ECS046
  1665         16  FILLER          PIC XXX.                             ECS046
  1666         16  DLB2-GA-OR-RPT-CD PIC X(10).                         ECS046
  1667         16  FILLER          PIC X(6).                            ECS046
  1668     12  DLB-ACCOUNT         PIC X(10)       VALUE SPACES.        ECS046
  1669     12  FILLER              PIC XX          VALUE SPACES.        ECS046
  1670     12  DLB-ACCT-NAME       PIC X(30)       VALUE SPACES.        ECS046
  1671                                                                  ECS046
* 1672                             COPY ELCDTECX.                       ECS046
  1673******************************************************************06/05/98
  1674*                                                                *ELCDTECX
  1675*                            ELCDTECX.                           *   LV005
  1676*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1677*                            VMOD=2.015                          *ELCDTECX
  1678*                                                                *ELCDTECX
  1679*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1680*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1681*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1682*                                                                *ELCDTECX
  1683******************************************************************ELCDTECX
  1684******************************************************************
  1685*                   C H A N G E   L O G
  1686*
  1687* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1688*-----------------------------------------------------------------
  1689*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1690* EFFECTIVE    NUMBER
  1691*-----------------------------------------------------------------
  1692* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1693*                                  BENEFIT CODES FROM 300 TO 900
  1694* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1695* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1696* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1697******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1698 01  DATE-CARD.                                                   ELCDTECX
  1699     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1700     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1701     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1702     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1703     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1704     12  EP-SW                       PIC  X.                      ELCDTECX
  1705         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1706     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1707         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1708     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1709     12  RUN-CENTURY.                                             ELCDTECX
  1710         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1711     12  FILLER                      PIC  X.                         CL**4
  1712     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1713     12  FILLER                      PIC  XXX.                    ELCDTECX
  1714     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1715                                                                  ELCDTECX
  1716 01  FILLER                          PIC  X(7)                       CL**6
  1717                                          VALUE 'OPTIONS'.        ELCDTECX
  1718 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1719     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1720     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1721     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1722         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1723         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1724     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1725     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1726     12  FILLER                      PIC  X.                      ELCDTECX
  1727     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1728     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1729     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1730     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1731     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1732     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1733     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1734     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1735     12  FILLER                      PIC  X.                      ELCDTECX
  1736     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1737     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1738     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1739     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1740     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1741     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1742     12  FILLER                      PIC  X.                      ELCDTECX
  1743     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1744     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1745     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1746     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1747     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1748     12  DTE-R78                     PIC  X.                      ELCDTECX
  1749     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1750     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1751     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1752     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1753     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1754     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1755     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1756                                     PIC  X.                      ELCDTECX
  1757         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1758                                                 ' '.             ELCDTECX
  1759         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1760         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1761     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1762         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1763         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1764     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1765     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1766                                     PIC  9.                         CL**4
  1767     12  DTE-SYSTEM.                                              ELCDTECX
  1768         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1769         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1770         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1771         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1772         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1773         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1774         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1775         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1776         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1777         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1778         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1779         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1780         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1781         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1782         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1783         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1784         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1785         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1786         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1787         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1788         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1789         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1790         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1791         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1792         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1793         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1794     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1795         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1796                                     PIC  X.                      ELCDTECX
  1797     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1798                                                                  ELCDTECX
  1799 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1800     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1801     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1802     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1803*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1804     12  FILLER                      PIC  X.                      ELCDTECX
  1805     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1806     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1807     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1808     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1809     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1810     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1811     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1812                                                                  ELCDTECX
  1813     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1814     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1815     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1816     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1817                                                                  ELCDTECX
  1818     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1819     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1820     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1821     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1822                                                                  ELCDTECX
  1823     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1824     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1825                                                                  ELCDTECX
  1826     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1827     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1828                                                                  ELCDTECX
  1829     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1830                                                                  ELCDTECX
  1831 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1832     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1833     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1834     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1835     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1836     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1837     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1838     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1839                                                                  ELCDTECX
  1840 01  FILLER                          PIC  X(12)                   ELCDTECX
  1841                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1842 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1843     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1844         16  CNT-ID                  PIC  X.                      ELCDTECX
  1845         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1846                                                                  ELCDTECX
  1847 01  FILLER                          PIC  X(11)                   ELCDTECX
  1848                                          VALUE 'STATE NAMES'.    ELCDTECX
  1849 01  STATE-NAMES.                                                 ELCDTECX
  1850     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1851         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1852         16  STATE-PIC1.                                          ELCDTECX
  1853             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1854             20  FILLER              PIC  XXX.                    ELCDTECX
  1855             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1856             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1857             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1858             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1859                                                                  ELCDTECX
  1860 01  FILLER                          PIC  X(13)                   ELCDTECX
  1861                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1862 01  CARRIER-NAMES.                                               ELCDTECX
  1863     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1864         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1865         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1866         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1867         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1868         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1869         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1870*        16  FILLER                  PIC  X.                      ELCDTECX
  1871         16  CARRIER-SEC-PAY         PIC  X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1872             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1873                                                                  ELCDTECX
  1874 01  FILLER                          PIC  X(9)                       CL**6
  1875                                          VALUE 'INS TYPES'.      ELCDTECX
  1876 01  CLAS-INS-TYPES.                                              ELCDTECX
  1877*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1878     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1879         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1880         16  CLAS-I-AB3.                                          ELCDTECX
  1881             20  FILLER              PIC  X.                      ELCDTECX
  1882             20  CLAS-I-AB2.                                      ELCDTECX
  1883                 24  FILLER          PIC  X.                      ELCDTECX
  1884                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1885         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1886             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1887             20  FILLER              PIC  X.                         CL**4
  1888         16  CLAS-I-AB10.                                         ELCDTECX
  1889             20  FILLER              PIC  X(9).                   ELCDTECX
  1890             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1891         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1892         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1893         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1894         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1895             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1896         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1897         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1898         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1899         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1900         16  CLAS-I-REFUND-METHOD    PIC  X.
  1901         16  CLAS-I-MAX-BENEFITS     PIC 99.
  1902         16  FILLER                  PIC  XXX.
  1903                                                                  ELCDTECX
  1904 01  FILLER                          PIC  X(16)                   ELCDTECX
  1905                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1906 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1907     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1908                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1909         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1910         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1911         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1912         16  CLAS-MORT-DESC.                                      ELCDTECX
  1913             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1914             20  FILLER              PIC  XX.                        CL**5
  1915             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1916             20  FILLER              PIC  X.                         CL**5
  1917             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1918             20  FILLER              PIC  X.                         CL**5
  1919             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1920             20  FILLER              PIC  X.                         CL**5
  1921             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1922             20  FILLER              PIC  X(5).                      CL**6
  1923                                                                  ELCDTECX
  1924 01  FILLER                          PIC  X(15)                   ELCDTECX
  1925                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1926 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1927     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1928         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1929         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1930         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1931         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1932         16  FILLER                  PIC  X(4).                      CL**6
  1933                                                                  ELCDTECX
  1934 01  FILLER                          PIC  X(7)                       CL**6
  1935                                     VALUE 'INDEXES'.             ELCDTECX
  1936 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1937     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1938     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  1939     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1940     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1941     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1942     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1943     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1944     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1945     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1946     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1947     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1948     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1949     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1950     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1951     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1952     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1953     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1954                                                                  ELCDTECX
  1955 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1956     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1957     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1958     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1959     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1960     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1961     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1962     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1963     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1964     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1965     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1966     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1967                                                                  ELCDTECX
  1968 01  FILLER                          PIC  X(13)                   ELCDTECX
  1969                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1970 01  CLAS-MISC.                                                   ELCDTECX
  1971     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1972         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1973         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1974         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1975     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1976     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1977     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1978     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1979     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1980     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1981     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1982     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1983     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1984     12  STATE-L                     PIC  XX.                     ELCDTECX
  1985     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1986     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1987     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1988         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1989         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1990     12  DTE-ABEND-WORK.                                          ELCDTECX
  1991         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1992         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1993                                                                  ELCDTECX
  1994 01  FILLER                          PIC  X(12)                   ELCDTECX
  1995                                     VALUE 'WORKING DATE'.        ELCDTECX
  1996 01  WS-DATE-AND-TIME.                                            ELCDTECX
  1997     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1998         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1999         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2000         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2001     12  WS-CURRENT-DATE.                                         ELCDTECX
  2002         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2003         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2004         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2005         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2006         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2007     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2008         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2009         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2010                                                                  ELCDTECX
  2011 01  FILLER                          PIC  X(12)                   ELCDTECX
  2012                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2013 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2014     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2015         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2016         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2017         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  2018                                                                  ELCDTECX
  2019 01  FILLER                          PIC  X(10)                   ELCDTECX
  2020                                     VALUE 'STATE TLRS'.          ELCDTECX
  2021 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2022     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2023         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2024         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2025                                                                  ELCDTECX
  2026 01  FILLER                          PIC  X(13)                   ELCDTECX
  2027                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2028 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2029     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2030         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2031                                                                  ELCDTECX
  2032 01  FILLER                          PIC  X(13)                   ELCDTECX
  2033                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2034 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2035     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2036     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2037     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2038                                     PIC  X.                         CL**5
  2039     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2040     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2041     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2042     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2043     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2044     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2045     12  INDEXST                     PIC S9(4)   COMP.               CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS046.cbl
  2046     12  FILLER                      PIC  X(75).                  ELCDTECX
  2047******************************************************************ELCDTECX
  2048*01  MISC-CARR-PCT-DATA.                                          00001521
  2049*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2050*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2051*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2052*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2053*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2054*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2055******************************************************************ELCDTECX
  2056                                                                  ECS046
* 2057                             COPY ELCDTEVR.                       ECS046
  2058***************************************************************** 04/15/98
  2059*                                                                *ELCDTEVR
  2060*                                                                *ELCDTEVR
  2061*                            ELCDTEVR.                           *   LV003
  2062*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2063*                            VMOD=2.001                          *   CL**2
  2064*                                                                *ELCDTEVR
  2065*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2066*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2067*                                                                *ELCDTEVR
  2068******************************************************************ELCDTEVR
  2069 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2070     05  WS-RUN-DATE.                                             ELCDTEVR
  2071         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2072         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2073         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2074             15  RUN-CC              PIC  99.                     ELCDTEVR
  2075             15  RUN-YR              PIC  99.                     ELCDTEVR
  2076         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2077         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2078     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2079            WS-RUN-DATE              PIC 9(11).                      CL**2
  2080     05  WS-EP-DT.                                                ELCDTEVR
  2081         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2082         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2083         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2084             15  EP-CC               PIC  99.                     ELCDTEVR
  2085             15  EP-YR               PIC  99.                     ELCDTEVR
  2086         10  EP-MO                   PIC  99.                     ELCDTEVR
  2087         10  EP-DA                   PIC  99.                     ELCDTEVR
  2088     05  WS-EP-DT-N REDEFINES                                        CL**2
  2089            WS-EP-DT                 PIC 9(11).                      CL**2
  2090     05  WS-DTE-CONV-DT.                                             CL**4
  2091         10  FILLER                  PIC  9(03).                     CL**4
  2092         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2093         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2094             15  DTE-CONV-CC         PIC  99.                        CL**4
  2095             15  DTE-CONV-YR         PIC  99.                        CL**4
  2096         10  DTE-CONV-MO             PIC  99.                        CL**4
  2097         10  DTE-CONV-DA             PIC  99.                        CL**4
  2098     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2099            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2100 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2101     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2102         10  FILLER                            PIC 999.           ELCDTEVR
  2103         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2104         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2105             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2106             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2107         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2108         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2109     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2110            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2111     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2112         10  FILLER                            PIC 999.           ELCDTEVR
  2113         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2114         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2115         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2116         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2117     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2118            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2119 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2120     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2121         10  FILLER                            PIC 999.           ELCDTEVR
  2122         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2123         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2124             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2125             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2126         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2127         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2128     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2129            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2130     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2131         10  FILLER                            PIC 999.           ELCDTEVR
  2132         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2133         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  2134             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2135             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2136         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2137         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2138     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2139            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2140     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2141         10  FILLER                            PIC 999.           ELCDTEVR
  2142         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2143         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2144             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2145             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2146         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2147         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2148     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2149            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2150 01  WS-RATE-RECORD.                                              ELCDTEVR
  2151         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2152             10  FILLER                        PIC 999.           ELCDTEVR
  2153             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2154             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2155                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2156                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2157             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2158             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2159         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2160                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2161                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS046.cbl
* 2162                             COPY ELCEPCVR.                       ECS046
  2163******************************************************************05/15/98
  2164*                                                                *ELCEPCVR
  2165*                                                                *ELCEPCVR
  2166*                            ELCEPCVR                            *   LV003
  2167*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2168*                            VMOD=2.001                          *ELCEPCVR
  2169*                                                                *ELCEPCVR
  2170*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2171*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2172*                                                                *ELCEPCVR
  2173******************************************************************ELCEPCVR
  2174 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2175     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2176         10  FILLER            PIC 999.                           ELCEPCVR
  2177         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2178         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2179             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2180             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2181         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2182         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2183     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2184            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2185     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2186         10  FILLER            PIC 999.                              CL**5
  2187         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2188         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2189             15  EC-EXP-CC     PIC 99.                               CL**5
  2190             15  EC-EXP-YR     PIC 99.                               CL**5
  2191         10  EC-EXP-MO         PIC 99.                               CL**5
  2192         10  EC-EXP-DA         PIC 99.                               CL**5
  2193     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2194            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2195     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2196         10  FILLER            PIC 999.                           ELCEPCVR
  2197         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2198         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2199             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2200             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
  2201         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2202         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2203     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2204            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2205     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2206         10  FILLER            PIC 999.                              CL**5
  2207         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2208         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2209             15  EC-EFF-CC     PIC 99.                               CL**5
  2210             15  EC-EFF-YR     PIC 99.                               CL**5
  2211         10  EC-EFF-MO         PIC 99.                               CL**5
  2212         10  EC-EFF-DA         PIC 99.                               CL**5
  2213     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2214            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2215     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2216         10  FILLER            PIC 999.                           ELCEPCVR
  2217         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2218         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2219             15  EP-COV-CC     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS046.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2220             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2221         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2222         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2223     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2224            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2225     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2226         10  FILLER            PIC 999.                           ELCEPCVR
  2227         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2228         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2229             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2230             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2231         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2232         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2233     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2234            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2235     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2236         10  FILLER            PIC 999.                           ELCEPCVR
  2237         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2238         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2239             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2240             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2241         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2242         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2243     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2244            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2245     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2246         10  FILLER            PIC 999.                           ELCEPCVR
  2247         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2248         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2249             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2250             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2251         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2252         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2253     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2254            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2255     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2256         10  FILLER            PIC 999.                           ELCEPCVR
  2257         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2258         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
  2259             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2260             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2261         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2262         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2263     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2264            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2265                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS046.cbl
  2267 PROCEDURE DIVISION.                                              ECS046
  2268                                                                  ECS046
  2269 0100-START.                                                      ECS046
* 2270                             COPY ELCDTERX.                       ECS046
  2271******************************************************************04/15/98
  2272*                                                                *ELCDTERX
  2273*                                                                *ELCDTERX
  2274*                            ELCDTERX.                           *   LV002
  2275*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2276*                            VMOD=2.007                          *ELCDTERX
  2277*                                                                *ELCDTERX
  2278*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  2279*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  2280*      = ELCDTEFD)                                               *ELCDTERX
  2281*                                                                *ELCDTERX
  2282******************************************************************ELCDTERX
  2283                                                                  ELCDTERX
  2284     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  2285                                                                  ELCDTERX
  2286     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  2287     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  2288     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  2289                                                                  ELCDTERX
  2290     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  2291                                                                  ELCDTERX
  2292******************************************************************ELCDTERX
  2293*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  2294*          WARNING MESSAGES.                                      ELCDTERX
  2295******************************************************************ELCDTERX
  2296     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  2297         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  2298                                                                  ELCDTERX
  2299     OPEN INPUT DISK-DATE.                                        ELCDTERX
  2300                                                                  ELCDTERX
  2301     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  2302                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  2303                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  2304                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  2305                   CLAX-ID           CLAS-MISC                    ELCDTERX
  2306                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  2307                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  2308                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  2309                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  2310                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  2311                                                                  ELCDTERX
  2312     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  2313                                                                  ELCDTERX
  2314     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  2315                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  2316                                                                  ELCDTERX
  2317     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  2318     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  2319     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  2320     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  2321                                                                  ELCDTERX
  2322     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  2323         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  2324     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2325         ADD +1                 TO CLAS-CN.                       ELCDTERX
  2326                                                                  ELCDTERX
  2327     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  2328         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  2329     ELSE                                                         ELCDTERX
  2330         ADD +1                 TO CLAS-CO.                       ELCDTERX
  2331                                                                  ELCDTERX
  2332 0005-READ--CARD.                                                 ELCDTERX
  2333     READ DISK-DATE                                               ELCDTERX
  2334         AT END CLOSE DISK-DATE                                   ELCDTERX
  2335             GO TO 0060-READ--TEST.                               ELCDTERX
  2336                                                                  ELCDTERX
  2337     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  2338                                                                  ELCDTERX
  2339     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  2340         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  2341         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  2342         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  2343         GO TO 0005-READ--CARD.                                   ELCDTERX
  2344                                                                  ELCDTERX
  2345     IF DD-ID = 'CLAD'                                            ELCDTERX
  2346         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  2347         GO TO 0005-READ--CARD.                                   ELCDTERX
  2348                                                                  ELCDTERX
  2349     IF DD-ID = 'CLAX'                                            ELCDTERX
  2350         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  2351         GO TO 0005-READ--CARD.                                   ELCDTERX
  2352                                                                  ELCDTERX
  2353     IF DD-ID = 'CLAF'                                            ELCDTERX
  2354         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  2355         GO TO 0005-READ--CARD.                                   ELCDTERX
  2356                                                                  ELCDTERX
  2357     IF DD-ID = 'CLAC'                                            ELCDTERX
  2358         GO TO 0010-READ--CLAC.                                   ELCDTERX
  2359                                                                  ELCDTERX
  2360     IF DD-ID = 'CARR'                                            ELCDTERX
  2361         GO TO 0015-READ--CARR.                                   ELCDTERX
  2362                                                                  ELCDTERX
  2363     IF DD-ID = 'STAT'                                            ELCDTERX
  2364         GO TO 0020-READ--STAT.                                   ELCDTERX
  2365                                                                  ELCDTERX
  2366     IF DD-ID = 'BUSC'                                            ELCDTERX
  2367         GO TO 0025-READ--BUSC.                                   ELCDTERX
  2368                                                                  ELCDTERX
  2369     IF DD-ID = 'MORT'                                            ELCDTERX
  2370         GO TO 0030-READ--MORT.                                   ELCDTERX
  2371                                                                  ELCDTERX
  2372     IF DD-ID = 'CLAI'                                            ELCDTERX
  2373         GO TO 0040-READ--CLAI.                                   ELCDTERX
  2374                                                                  ELCDTERX
  2375     IF DD-ID = 'COLC'                                            ELCDTERX
  2376         GO TO 0065-READ--COLC.                                   ELCDTERX
  2377                                                                  ELCDTERX
  2378     IF DD-IDX NUMERIC AND                                        ELCDTERX
  2379        DD-IDA = 'CL'                                             ELCDTERX
  2380         GO TO 0035-READ--CLXX.                                   ELCDTERX
  2381                                                                  ELCDTERX
  2382     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2383        DD-IDA = 'PO'                                             ELCDTERX
  2384         GO TO 0050-READ--POXX.                                   ELCDTERX
  2385                                                                  ELCDTERX
  2386     IF DD-ID = 'OPCA'                                            ELCDTERX
  2387         GO TO 0070-READ--OPCA.                                   ELCDTERX
  2388                                                                  ELCDTERX
  2389     IF DD-ID = 'OPST'                                            ELCDTERX
  2390         GO TO 0072-READ--OPST.                                   ELCDTERX
  2391                                                                  ELCDTERX
  2392     IF DD-ID = 'OPBS'                                            ELCDTERX
  2393         GO TO 0074-READ--OPBS.                                   ELCDTERX
  2394                                                                  ELCDTERX
  2395     IF DD-ID = 'OPMS'                                            ELCDTERX
  2396         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  2397                                                                  ELCDTERX
  2398     GO TO 0005-READ--CARD.                                       ELCDTERX
  2399                                                                  ELCDTERX
  2400 0010-READ--CLAC.                                                 ELCDTERX
  2401     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2402     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2403     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2404     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  2405     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  2406     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  2407     GO TO 0005-READ--CARD.                                       ELCDTERX
  2408                                                                  ELCDTERX
  2409 0015-READ--CARR.                                                 ELCDTERX
  2410     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2411     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2412        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  2413        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2414        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  2415        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2416        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2417        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2418        MOVE DD-CARR1-SECPAY-SW
  2419                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2420     END-IF
  2421                                                                  ELCDTERX
  2422     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  2423     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  2424        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  2425        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  2426        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  2427        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  2428        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  2429        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  2430        MOVE DD-CARR2-SECPAY-SW
  2431                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  2432     END-IF
  2433                                                                  ELCDTERX
  2434                                                                  ELCDTERX
  2435     GO TO 0005-READ--CARD.                                       ELCDTERX
  2436                                                                  ELCDTERX
  2437 0020-READ--STAT.                                                 ELCDTERX
  2438     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2439     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2440        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2441         GO TO 0005-READ--CARD.                                   ELCDTERX
  2442                                                                  ELCDTERX
  2443     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  2444     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  2445     GO TO 0020-READ--STAT.                                       ELCDTERX
  2446                                                                  ELCDTERX
  2447 0025-READ--BUSC.                                                 ELCDTERX
  2448     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2449     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  2450        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  2451         GO TO 0005-READ--CARD.                                   ELCDTERX
  2452                                                                  ELCDTERX
  2453     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  2454     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  2455     GO TO 0025-READ--BUSC.                                       ELCDTERX
  2456                                                                  ELCDTERX
  2457 0030-READ--MORT.                                                 ELCDTERX
  2458     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2459     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2460        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  2461         GO TO 0005-READ--CARD.                                   ELCDTERX
  2462                                                                  ELCDTERX
  2463     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  2464     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  2465     GO TO 0030-READ--MORT.                                       ELCDTERX
  2466                                                                  ELCDTERX
  2467 0035-READ--CLXX.                                                 ELCDTERX
  2468     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  2469          GO TO 0005-READ--CARD.                                  ELCDTERX
  2470                                                                  ELCDTERX
  2471     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  2472         DISPLAY '***********************************************'ELCDTERX
  2473         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  2474         DISPLAY '***********************************************'ELCDTERX
  2475         GO TO 0055-READ--STOP.                                   ELCDTERX
  2476                                                                  ELCDTERX
  2477     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  2478        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  2479         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  2480                                                                  ELCDTERX
  2481     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  2482        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  2483         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  2484                                                                  ELCDTERX
  2485*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  2486     GO TO 0005-READ--CARD.                                       ELCDTERX
  2487                                                                  ELCDTERX
  2488 0040-READ--CLAI.                                                 ELCDTERX
  2489     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2490     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  2491        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  2492         GO TO 0005-READ--CARD.                                   ELCDTERX
  2493                                                                  ELCDTERX
  2494     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  2495     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  2496     GO TO 0040-READ--CLAI.                                       ELCDTERX
  2497                                                                  ELCDTERX
  2498 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2499     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  2500     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  2501                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  2502     PERFORM ABEND-PGM.                                           ELCDTERX
  2503                                                                  ELCDTERX
  2504 0050-READ--POXX.                                                 ELCDTERX
  2505     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  2506         GO TO 0005-READ--CARD.                                   ELCDTERX
  2507                                                                  ELCDTERX
  2508     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  2509         DISPLAY '***********************************************'ELCDTERX
  2510         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  2511         DISPLAY '***********************************************'ELCDTERX
  2512         GO TO 0055-READ--STOP.                                   ELCDTERX
  2513                                                                  ELCDTERX
  2514     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  2515     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  2516     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  2517     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  2518                                                                  ELCDTERX
  2519     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  2520         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  2521     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  2522         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2523                                                                  ELCDTERX
  2524     GO TO 0005-READ--CARD.                                       ELCDTERX
  2525                                                                  ELCDTERX
  2526 0055-READ--STOP.                                                 ELCDTERX
  2527     GOBACK.                                                      ELCDTERX
  2528                                                                  ELCDTERX
  2529 0060-READ--TEST.                                                 ELCDTERX
  2530     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2531        CLAX-ID         = SPACE  OR                               ELCDTERX
  2532        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2533         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2534                                                                  ELCDTERX
  2535     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2536     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2537                                                                  ELCDTERX
  2538 0065-READ--COLC.                                                 ELCDTERX
  2539     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2540     GO TO 0005-READ--CARD.                                       ELCDTERX
  2541                                                                  ELCDTERX
  2542 0070-READ--OPCA.                                                 ELCDTERX
  2543                                                                  ELCDTERX
  2544     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2545                                                                  ELCDTERX
  2546     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2547             OR                                                   ELCDTERX
  2548         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2549         GO TO 0005-READ--CARD.                                   ELCDTERX
  2550                                                                  ELCDTERX
  2551     ADD 1                       TO INDEXCA.                      ELCDTERX
  2552     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2553                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2554     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2555                                                                  ELCDTERX
  2556 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS046.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2557                                                                  ELCDTERX
  2558     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2559                                                                  ELCDTERX
  2560     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2561             OR                                                   ELCDTERX
  2562         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2563         GO TO 0005-READ--CARD.                                   ELCDTERX
  2564                                                                  ELCDTERX
  2565     ADD 1                       TO INDEXST.                      ELCDTERX
  2566     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  2567                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2568     GO TO 0072-READ--OPST.                                       ELCDTERX
  2569                                                                  ELCDTERX
  2570 0074-READ--OPBS.                                                 ELCDTERX
  2571                                                                  ELCDTERX
  2572     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2573                                                                  ELCDTERX
  2574     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2575             OR                                                   ELCDTERX
  2576         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2577         GO TO 0005-READ--CARD.                                   ELCDTERX
  2578                                                                  ELCDTERX
  2579     ADD 1                       TO INDEXBS.                      ELCDTERX
  2580     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2581     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2582                                                                  ELCDTERX
  2583 0079-READ--EXIT.                                                 ELCDTERX
  2584*    EXIT.                                                        ELCDTERX
  2585******************************************************************ELCDTERX
  2586                                                                  ECS046
  2587     MOVE WS-CURRENT-DATE        TO HD-RUN-DATE.                  ECS046
  2588     MOVE ALPH-DATE              TO HD-ALPHA-DATE.                ECS046
  2589     MOVE COMPANY-NAME           TO HD-COMP.                      ECS046
  2590     MOVE RUN-DATE               TO BEG-DATE                      ECS046
  2591                                    RUN-DT.                       ECS046
  2592 0200-BUILD-SELECT-DATES.                                         ECS046
  2593     IF DTE-PGM-OPT = '1'                                         ECS046
  2594*                           SET BEGIN DATE FOR YTD REPORT         ECS046
  2595         SUBTRACT 1 FROM BD-CCYY                                  ECS046
  2596         MOVE 12                 TO BD-MO                         ECS046
  2597         MOVE 31                 TO BD-DA.                        ECS046
  2598                                                                  ECS046
  2599     IF DTE-PGM-OPT = '2'                                         ECS046
  2600*                           SET BEGIN DATE FOR 12 MO. REPORT      ECS046
  2601         SUBTRACT 1 FROM BD-CCYY.                                 ECS046
  2602                                                                  ECS046
  2603     IF DTE-PGM-OPT = '3'                                         ECS046
  2604*                           SET BEGIN DATE FOR ITD REPORT         ECS046
  2605         MOVE ZEROS              TO BEG-DATE.                     ECS046
  2606                                                                  ECS046
  2607     IF DTE-PGM-OPT = 4                                           ECS046
  2608*                         SET BEGIN DATE FOR CURRENT MONTH REPORT ECS046
  2609         MOVE 31                 TO BD-DA                         ECS046
  2610         IF BD-MO = 01                                            ECS046
  2611             SUBTRACT 1 FROM BD-CCYY                              ECS046
  2612             MOVE 12             TO BD-MO                         ECS046
  2613           ELSE                                                   ECS046
  2614             SUBTRACT 1 FROM BD-MO.                               ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS046.cbl
  2615                                                                  ECS046
  2616 0500-SORT-CONTROL.                                               ECS046
  2617     SORT SORT-WORK-A ON ASCENDING                                ECS046
  2618                         SWA-CONTROL-OUT                          ECS046
  2619         INPUT PROCEDURE   1000-BUILD-EXTRACTS                    ECS046
  2620         OUTPUT PROCEDURE  3000-PRINT-REPORT-A.                   ECS046
  2621                                                                  ECS046
  2622     IF SORT-RETURN NOT = ZERO AND 4                              ECS046
  2623         MOVE SORT-RETURN                  TO WS-RETURN-CODE      ECS046
  2624         MOVE 'UNSUCCESSFUL SORT - SORT 1' TO WS-ABEND-MESSAGE    ECS046
  2625         GO TO ABEND-PGM.                                         ECS046
  2626                                                                  ECS046
  2627     IF DTE-FMT-OPT NOT = 1                                       ECS046
  2628         SORT SORT-WORK-B                                         ECS046
  2629             DESCENDING        SWB-CONTROL-OUT                    ECS046
  2630             USING WORK-FILE                                      ECS046
  2631             OUTPUT PROCEDURE  5000-PRINT-REPORT-B                ECS046
  2632         IF SORT-RETURN NOT = ZERO AND 4                          ECS046
  2633             MOVE SORT-RETURN        TO WS-RETURN-CODE            ECS046
  2634             MOVE 'UNSUCCESSFUL SORT - SORT 2'                    ECS046
  2635                                     TO WS-ABEND-MESSAGE          ECS046
  2636             GO TO ABEND-PGM.                                     ECS046
  2637                                                                  ECS046
  2638     GOBACK.                                                      ECS046
  2639                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS046.cbl
  2641 1000-BUILD-EXTRACTS SECTION.                                     ECS046
  2642                                                                  ECS046
  2643 1100-BEGIN-PROCESSING.                                           ECS046
  2644     OPEN INPUT ACC-MSTR                                          ECS046
  2645                EPEC-FILE                                         ECS046
  2646         OUTPUT PRNTR.                                            ECS046
  2647                                                                  ECS046
  2648     IF ERACCT-FILE-STATUS   = '00' OR '97'                       ECS046
  2649         NEXT SENTENCE                                            ECS046
  2650     ELSE                                                         ECS046
  2651         MOVE ERACCT-FILE-STATUS TO WS-ABEND-FILE-STATUS          ECS046
  2652         MOVE 'OPEN ERROR - ERACCT' TO WS-ABEND-MESSAGE           ECS046
  2653         GO TO ABEND-PGM.                                         ECS046
  2654                                                                  ECS046
  2655     IF DTE-CLIENT  =  'MON'                                      ECS046
  2656         MOVE FIL1-DESC          TO  HEAD-4A-FIL1                 ECS046
  2657         MOVE FIL2-DESC          TO  HEAD-4A-FIL2                 ECS046
  2658         MOVE HEAD-5A-DESC       TO  HEAD-5A-FILL1.               ECS046
  2659                                                                  ECS046
  2660     PERFORM 2400-ZERO-DETAIL-ACCUMULATORS                        ECS046
  2661         VARYING SA FROM 1 BY 1 UNTIL SA GREATER 4.               ECS046
  2662                                                                  ECS046
  2663     PERFORM 2100-READ-EXTRACT THRU 2140-EXIT.                    ECS046
  2664     PERFORM 2200-READ-ACCT    THRU 2240-EXIT.                    ECS046
  2665                                                                  ECS046
  2666     MOVE AM-COMPANY-CD          TO  HOLD-COMPANY-CD.             ECS046
  2667     MOVE EP-CONTROL             TO WS-SAVE-CONTROL.              ECS046
  2668     GO TO 1800-CHECK-ACCT-MSTR.                                  ECS046
  2669                                                                  ECS046
  2670 1200-CHECK-CONTROL.                                              ECS046
  2671                                                                  ECS046
  2672* ALL PURGE RECORDS FROM THE EPEC FILE ARE INCLUDED.              ECS046
  2673* THOSE WITH A DATE GREATER THAN THE PERIOD BEGIN DATE            ECS046
  2674* ARE ADDED TO THE PERIOD ENDING DATE TOTALS.                     ECS046
  2675* THOSE WITH A DATE LESS THAN OR EQUAL TO THE PERIOD ENDING DATE  ECS046
  2676* ARE ADDED TO THE PERIOD BEGINNING AND ENDING DATE TOTALS.       ECS046
  2677                                                                  ECS046
  2678     IF EP-PURGE = 'P'                                            ECS046
  2679         IF WS-EP-RUN-DTE GREATER BEG-DATE                        ECS046
  2680             MOVE 'Q'            TO EP-PURGE                      ECS046
  2681             GO TO 1250-TEST-ACCUM                                ECS046
  2682         ELSE                                                     ECS046
  2683             GO TO 1250-TEST-ACCUM.                               ECS046
  2684                                                                  ECS046
  2685     IF EP-RUN-YR = BD-YR AND                                     ECS046
  2686        EP-RUN-MO = BD-MO                                         ECS046
  2687         MOVE '1'                TO EP-PURGE                      ECS046
  2688         GO TO 1250-TEST-ACCUM.                                   ECS046
  2689                                                                  ECS046
  2690     MOVE '2'                    TO EP-PURGE.                     ECS046
  2691                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS046.cbl
  2693 1250-TEST-ACCUM.                                                 ECS046
  2694     IF EP-RECORD-ID = 'EP'                                       ECS046
  2695         IF EP-PURGE = ('1' OR 'P')                               ECS046
  2696             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2697                 MOVE +1         TO SA                            ECS046
  2698                 PERFORM 1300-EP-ADD THRU 1350-EXIT               ECS046
  2699             ELSE                                                 ECS046
  2700                 MOVE +2         TO SA                            ECS046
  2701                 PERFORM 1300-EP-ADD THRU 1350-EXIT.              ECS046
  2702                                                                  ECS046
  2703     IF EP-RECORD-ID = 'EP'                                       ECS046
  2704         IF EP-PURGE = ('2' OR 'P' OR 'Q')                        ECS046
  2705             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2706                 MOVE +3         TO SA                            ECS046
  2707                 PERFORM 1300-EP-ADD THRU 1350-EXIT               ECS046
  2708             ELSE                                                 ECS046
  2709                 MOVE +4         TO SA                            ECS046
  2710                 PERFORM 1300-EP-ADD THRU 1350-EXIT.              ECS046
  2711                                                                  ECS046
  2712     IF EP-RECORD-ID = 'EC'                                       ECS046
  2713         IF EP-PURGE = ('1' OR 'P')                               ECS046
  2714             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2715                 MOVE +1         TO SA                            ECS046
  2716                 PERFORM 1400-EC-ADD THRU 1440-EXIT               ECS046
  2717             ELSE                                                 ECS046
  2718                 MOVE +2         TO SA                            ECS046
  2719                 PERFORM 1400-EC-ADD THRU 1440-EXIT.              ECS046
  2720                                                                  ECS046
  2721     IF EP-RECORD-ID = 'EC'                                       ECS046
  2722         IF EP-PURGE = ('2' OR 'P' OR 'Q')                        ECS046
  2723             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                    ECS046
  2724                 MOVE +3         TO SA                            ECS046
  2725                 PERFORM 1400-EC-ADD THRU 1440-EXIT               ECS046
  2726             ELSE                                                 ECS046
  2727                 MOVE +4         TO SA                            ECS046
  2728                 PERFORM 1400-EC-ADD THRU 1440-EXIT.              ECS046
  2729                                                                  ECS046
  2730     GO TO 1500-GET-NEXT-EXTRACT.                                 ECS046
  2731                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS046.cbl
  2733 1300-EP-ADD.                                                     ECS046
  2734                                                                  ECS046
  2735* TOTALS FOR EARNED PREMIUM RECORDS ARE ACCUMULATED IN A          ECS046
  2736* TOTAL TABLE FOR THE GIVEN ACCOUNT                               ECS046
  2737                                                                  ECS046
  2738     ADD EP-ISS-PRM              TO DA-NET-PREM (SA).             ECS046
  2739     SUBTRACT EP-CNC-PRM         FROM DA-NET-PREM (SA).           ECS046
  2740     ADD EP-CLM-AMT              TO DA-CLAIM-AMT (SA).            ECS046
  2741     ADD EP-CLM-DU               TO DA-LOSS-RSRV (SA).            ECS046
  2742     ADD EP-CLM-IBNR             TO DA-LOSS-RSRV (SA).            ECS046
  2743     ADD EP-LOSS-RESV            TO DA-LOSS-RSRV (SA).            ECS046
  2744     ADD EP-CLAIM-ADJ            TO DA-CLAIM-AMT (SA).            ECS046
  2745     MOVE ZERO                   TO WS-DA-EARN-PREM.              ECS046
  2746                                                                  ECS046
  2747     IF WS-EP-CODE = 'P'                                          ECS046
  2748         MOVE EP-PRM-PR          TO WS-DA-EARN-PREM               ECS046
  2749     ELSE                                                         ECS046
  2750     IF WS-EP-CODE = 'M'                                          ECS046
  2751         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2752                (EP-PRM-PR + EP-PRM-78) * .5                      ECS046
  2753     ELSE                                                         ECS046
  2754     IF WS-EP-CODE = '1'                                          ECS046
  2755         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2756              (EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)         ECS046
  2757     ELSE                                                         ECS046
  2758     IF WS-EP-CODE = '2'                                          ECS046
  2759         COMPUTE WS-DA-EARN-PREM ROUNDED =                        ECS046
  2760              (EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)             ECS046
  2761     ELSE                                                         ECS046
  2762         MOVE EP-PRM-78          TO WS-DA-EARN-PREM.              ECS046
  2763                                                                  ECS046
  2764     COMPUTE DA-EARN-PREM (SA) ROUNDED = DA-EARN-PREM (SA) +      ECS046
  2765                                         WS-DA-EARN-PREM.         ECS046
  2766                                                                  ECS046
  2767     COMPUTE DA-RETENTION (SA) ROUNDED = DA-RETENTION (SA) +      ECS046
  2768                       (WS-RETENTION-PCT * WS-DA-EARN-PREM).      ECS046
  2769                                                                  ECS046
  2770     COMPUTE DA-PREM-TAX (SA) ROUNDED = DA-PREM-TAX (SA) +        ECS046
  2771                          (WS-TAX-RATE * WS-DA-EARN-PREM).        ECS046
  2772                                                                  ECS046
  2773 1350-EXIT.                                                       ECS046
  2774      EXIT.                                                       ECS046
  2775                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS046.cbl
  2777 1400-EC-ADD.                                                     ECS046
  2778                                                                  ECS046
  2779* TOTALS FOR EARNED COMMISSION RECORDS ARE ACCUMULATED IN A       ECS046
  2780* TOTAL TABLE FOR THE GIVEN ACCOUNT                               ECS046
  2781                                                                  ECS046
  2782     PERFORM 1420-ACCT-EC-ADD THRU 1430-EXIT                      ECS046
  2783         VARYING CL FROM 1 BY 1 UNTIL CL GREATER 5.               ECS046
  2784                                                                  ECS046
  2785     GO TO 1440-EXIT.                                             ECS046
  2786                                                                  ECS046
  2787 1420-ACCT-EC-ADD.                                                ECS046
  2788     IF EC-AGT-TYPE (CL) = 'C' OR 'D' OR 'O' OR 'P'               ECS046
  2789         NEXT SENTENCE                                            ECS046
  2790      ELSE                                                        ECS046
  2791          GO TO 1430-EXIT.                                        ECS046
  2792                                                                  ECS046
  2793     IF WS-EP-CODE = 'P'                                          ECS046
  2794         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2795                                             EC-COMM-PR (CL)      ECS046
  2796     ELSE                                                         ECS046
  2797     IF WS-EP-CODE = 'M'                                          ECS046
  2798         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2799                                             ((EC-COMM-PR (CL) +  ECS046
  2800                                           EC-COMM-78 (CL)) * .5) ECS046
  2801     ELSE                                                         ECS046
  2802     IF WS-EP-CODE = '1'                                          ECS046
  2803         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2804                                   ((EC-COMM-PR (CL) * +.6667) +  ECS046
  2805                                    (EC-COMM-78 (CL) * +.3333))   ECS046
  2806     ELSE                                                         ECS046
  2807     IF WS-EP-CODE = '2'                                          ECS046
  2808         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2809                                     ((EC-COMM-PR (CL) * +.80) +  ECS046
  2810                                      (EC-COMM-78 (CL) * +.20))   ECS046
  2811     ELSE                                                         ECS046
  2812         COMPUTE DA-EARN-COMP (SA) ROUNDED = DA-EARN-COMP (SA) +  ECS046
  2813                                             EC-COMM-78 (CL).     ECS046
  2814                                                                  ECS046
  2815 1430-EXIT.                                                       ECS046
  2816      EXIT.                                                       ECS046
  2817                                                                  ECS046
  2818 1440-EXIT.                                                       ECS046
  2819      EXIT.                                                       ECS046
  2820                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS046.cbl
  2822 1500-GET-NEXT-EXTRACT.                                           ECS046
  2823     PERFORM 2100-READ-EXTRACT THRU 2140-EXIT.                    ECS046
  2824                                                                  ECS046
  2825     IF EP-CONTROL = WS-SAVE-CONTROL                              ECS046
  2826         GO TO 1200-CHECK-CONTROL.                                ECS046
  2827                                                                  ECS046
  2828* CONTROL BREAKS OCCUR AT THE ACCOUNT LEVEL, FOR TOT-OPT 1 AND 2  ECS046
  2829* ALLOW DATE RANGE LEVEL BREAK ( TOT-OPT 3 THRU 6)                ECS046
  2830                                                                  ECS046
  2831     IF DTE-TOT-OPT = 1  OR  2                                    ECS046
  2832         IF EP-CNTRL-1 = WS-SAVE-CNTRL-1                          ECS046
  2833             MOVE EP-CONTROL         TO WS-SAVE-CONTROL           ECS046
  2834             GO TO 1200-CHECK-CONTROL.                            ECS046
  2835                                                                  ECS046
  2836     MOVE AM-ACCOUNT             TO SWA-ACCT.                     ECS046
  2837     MOVE AM-NAME                TO SWA-NAME.                     ECS046
  2838     MOVE AM-CITY                TO SWA-CITY.                     ECS046
  2839                                                                  ECS046
  2840* DEPENDING ON THE TOTAL OPTION, SORT CONTROL FIELDS ARE PRIMED   ECS046
  2841                                                                  ECS046
  2842     IF DTE-TOT-OPT = 1                                           ECS046
  2843         MOVE SPACES             TO SWA-BUS-TYPE                  ECS046
  2844         MOVE AM-CARRIER         TO SWA-CARR                      ECS046
  2845         MOVE AM-GROUPING        TO SWA-GROUP                     ECS046
  2846         MOVE AM-STATE           TO SWA-STATE                     ECS046
  2847         MOVE SPACES             TO SWA-GA-OR-RPT-CD.             ECS046
  2848                                                                  ECS046
  2849     IF DTE-TOT-OPT = 2                                           ECS046
  2850         MOVE AM-GPCD            TO SWA-BUS-TYPE                  ECS046
  2851         MOVE AM-CARRIER         TO SWA-CARR                      ECS046
  2852         MOVE AM-GROUPING        TO SWA-GROUP                     ECS046
  2853         MOVE AM-STATE           TO SWA-STATE                     ECS046
  2854         MOVE SPACES             TO SWA-GA-OR-RPT-CD.             ECS046
  2855                                                                  ECS046
  2856* IF A GIVEN ACCOUNT DOESN'T HAVE ALTERNATE REPORT CODES,         ECS046
  2857* THAT ACCOUNT DOESN'T APPEAR ON THE REPORT FOR TOTAL OPTIONS     ECS046
  2858* 3 AND 4.                                                        ECS046
  2859                                                                  ECS046
  2860     IF DTE-TOT-OPT = 3                                           ECS046
  2861         IF AM-REPORT-CODE-1 = SPACES OR LOW-VALUES               ECS046
  2862             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2863         ELSE                                                     ECS046
  2864             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2865                                      SWA-CARR                    ECS046
  2866                                      SWA-GROUP                   ECS046
  2867                                      SWA-STATE                   ECS046
  2868             MOVE AM-REPORT-CODE-1 TO SWA-GA-OR-RPT-CD.           ECS046
  2869                                                                  ECS046
  2870     IF DTE-TOT-OPT = 4                                           ECS046
  2871         IF AM-REPORT-CODE-2 = SPACES OR LOW-VALUES               ECS046
  2872             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2873         ELSE                                                     ECS046
  2874             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2875             MOVE AM-CARRIER       TO SWA-CARR                    ECS046
  2876             MOVE AM-GROUPING      TO SWA-GROUP                   ECS046
  2877             MOVE SPACES           TO SWA-STATE                   ECS046
  2878             MOVE AM-REPORT-CODE-2 TO SWA-GA-OR-RPT-CD.           ECS046
  2879                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS046.cbl
  2880     IF DTE-TOT-OPT = 6                                           ECS046
  2881         IF AM-REPORT-CODE-1 = SPACES OR LOW-VALUES               ECS046
  2882             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2883         ELSE                                                     ECS046
  2884             MOVE AM-REPORT-CODE-1 TO SWA-RPT-CD-1                ECS046
  2885             MOVE AM-REPORT-CODE-2 TO SWA-RPT-CD-2.               ECS046
  2886                                                                  ECS046
  2887* IF A GIVEN ACCOUNT DOESN'T HAVE A FINANCIAL RESPONSIBLE G-A,    ECS046
  2888* THAT ACCOUNT DOESN'T APPEAR ON THE REPORT FOR TOTAL OPTION 5.   ECS046
  2889                                                                  ECS046
  2890     IF DTE-TOT-OPT = 5                                           ECS046
  2891         IF WS-FIN-RESP-AGT = SPACES  OR  ZEROS                   ECS046
  2892             GO TO 1600-PERFORM-ZERO-ACCUM                        ECS046
  2893         ELSE                                                     ECS046
  2894             MOVE SPACES           TO SWA-BUS-TYPE                ECS046
  2895             MOVE AM-CARRIER       TO SWA-CARR                    ECS046
  2896             MOVE AM-GROUPING      TO SWA-SAVE-GROUP              ECS046
  2897             MOVE SPACES           TO SWA-GROUP                   ECS046
  2898                                      SWA-STATE                   ECS046
  2899             MOVE WS-FIN-RESP-AGT  TO SWA-GA-OR-RPT-CD.           ECS046
  2900                                                                  ECS046
  2901     COMPUTE SWA-NET-PREM (1) = DA-NET-PREM (3) - DA-NET-PREM (1).ECS046
  2902     COMPUTE SWA-EARN-PREM (1) =                                  ECS046
  2903                             DA-EARN-PREM (3) - DA-EARN-PREM (1). ECS046
  2904     COMPUTE SWA-CLMS-INCUR (1) =                                 ECS046
  2905                          (DA-CLAIM-AMT (3) - DA-CLAIM-AMT (1)) + ECS046
  2906                          (DA-LOSS-RSRV (3) - DA-LOSS-RSRV (1)).  ECS046
  2907     COMPUTE SWA-EARN-COMP (1) =                                  ECS046
  2908                             DA-EARN-COMP (3) - DA-EARN-COMP (1). ECS046
  2909     COMPUTE SWA-RETENTION (1) =                                  ECS046
  2910                             DA-RETENTION (3) - DA-RETENTION (1). ECS046
  2911     COMPUTE SWA-PREM-TAX (1) = DA-PREM-TAX (3) - DA-PREM-TAX (1).ECS046
  2912                                                                  ECS046
  2913     COMPUTE SWA-NET-PREM (2) = DA-NET-PREM (4) - DA-NET-PREM (2).ECS046
  2914     COMPUTE SWA-EARN-PREM (2) =                                  ECS046
  2915                             DA-EARN-PREM (4) - DA-EARN-PREM (2). ECS046
  2916     COMPUTE SWA-CLMS-INCUR (2) =                                 ECS046
  2917                          (DA-CLAIM-AMT (4) - DA-CLAIM-AMT (2)) + ECS046
  2918                          (DA-LOSS-RSRV (4) - DA-LOSS-RSRV (2)).  ECS046
  2919     COMPUTE SWA-EARN-COMP (2) =                                  ECS046
  2920                             DA-EARN-COMP (4) - DA-EARN-COMP (2). ECS046
  2921     COMPUTE SWA-RETENTION (2) =                                  ECS046
  2922                             DA-RETENTION (4) - DA-RETENTION (2). ECS046
  2923     COMPUTE SWA-PREM-TAX (2) = DA-PREM-TAX (4) - DA-PREM-TAX (2).ECS046
  2924                                                                  ECS046
  2925     RELEASE SWA-REC-OUT FROM SWA-REC.                            ECS046
  2926                                                                  ECS046
  2927     ADD +1 TO NO-OF-RECORDS-RELEASED.                            ECS046
  2928                                                                  ECS046
  2929 1600-PERFORM-ZERO-ACCUM.                                         ECS046
  2930     PERFORM 2400-ZERO-DETAIL-ACCUMULATORS                        ECS046
  2931         VARYING SA FROM 1 BY 1 UNTIL SA GREATER 4.               ECS046
  2932                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS046.cbl
  2934 1700-PROCESS-NEXT-EPEC.                                          ECS046
  2935     IF EP-CONTROL = HIGH-VALUES                                  ECS046
  2936         GO TO 1990-EXIT.                                         ECS046
  2937                                                                  ECS046
  2938     MOVE EP-CONTROL             TO WS-SAVE-CONTROL.              ECS046
  2939                                                                  ECS046
  2940 1800-CHECK-ACCT-MSTR.                                            ECS046
  2941     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL                      ECS046
  2942         PERFORM 2200-READ-ACCT THRU 2240-EXIT                    ECS046
  2943         GO TO 1800-CHECK-ACCT-MSTR.                              ECS046
  2944                                                                  ECS046
  2945 1820-NO-ACCT-MSTR.                                               ECS046
  2946     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL                   ECS046
  2947         PERFORM 2300-NO-ACCT-MSG                                 ECS046
  2948         PERFORM 2100-READ-EXTRACT THRU 2140-EXIT                 ECS046
  2949           GO TO 1700-PROCESS-NEXT-EPEC.                          ECS046
  2950                                                                  ECS046
  2951 1840-ACCT-MSTR-MATCHED.                                          ECS046
  2952                                                                  ECS046
  2953     IF DTE-CLIENT  =  'MON'                                      ECS046
  2954         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  2955             IF AM-STATUS  =  '1'                                 ECS046
  2956                 PERFORM 2100-READ-EXTRACT THRU 2140-EXIT         ECS046
  2957                 GO TO 1700-PROCESS-NEXT-EPEC.                    ECS046
  2958                                                                  ECS046
  2959     IF DTE-CLIENT = 'CSO'                                        ECS046
  2960         IF AM-STATUS NOT = 'A'  AND  '0'                         ECS046
  2961             PERFORM 2100-READ-EXTRACT THRU 2140-EXIT             ECS046
  2962             GO TO 1700-PROCESS-NEXT-EPEC.                        ECS046
  2963                                                                  ECS046
  2964 1950-SAVE-ACCT-DATA.                                             ECS046
  2965                                                                  ECS046
  2966     MOVE SPACES                 TO WS-FIN-RESP-AGT.              ECS046
  2967                                                                  ECS046
  2968* RETENTION AND TAX PERCENTS ARE FOUND IN THE ACCOUNT MASTER      ECS046
  2969                                                                  ECS046
  2970     IF AM-LF-RET NOT NUMERIC                                     ECS046
  2971         MOVE ZERO               TO AM-LF-RET.                    ECS046
  2972                                                                  ECS046
  2973     IF AM-AH-RET NOT NUMERIC                                     ECS046
  2974         MOVE ZERO               TO AM-AH-RET.                    ECS046
  2975                                                                  ECS046
  2976     IF AM-REI-LF-TAX NOT NUMERIC                                 ECS046
  2977         MOVE ZERO               TO AM-REI-LF-TAX.                ECS046
  2978                                                                  ECS046
  2979     IF AM-REI-AH-TAX NOT NUMERIC                                 ECS046
  2980         MOVE ZERO               TO AM-REI-AH-TAX.                ECS046
  2981                                                                  ECS046
  2982     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                            ECS046
  2983         MOVE AM-LF-RET          TO WS-RETENTION-PCT              ECS046
  2984         MOVE AM-REI-LF-TAX      TO WS-TAX-RATE                   ECS046
  2985     ELSE                                                         ECS046
  2986         MOVE AM-AH-RET          TO WS-RETENTION-PCT              ECS046
  2987         MOVE AM-REI-AH-TAX      TO WS-TAX-RATE.                  ECS046
  2988                                                                  ECS046
  2989     MOVE +0                     TO CL.                           ECS046
  2990                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS046.cbl
  2992 1970-PROCESS-COMM-STRUCT.                                        ECS046
  2993                                                                  ECS046
  2994* THIS ROUTINE LOCATES G-A'S IN THE COMMISSION STRUCTURE OF THE   ECS046
  2995* ACCOUNT MASTER AND SUBTRACTS THE G-A'S COMMISSION PERCENT FROM  ECS046
  2996* THE ACCOUNT RETENTION, IF NECESSARY.  THIS ROUTINE ALSO LOCATES ECS046
  2997* THE FINANCIALLY RESPONSIBLE G-A FOR THIS ACCOUNT (THE FIRST     ECS046
  2998* G-A IN THE COMMISSION STRUCTURE).  THE FINANCIALLY RESPONSIBLE  ECS046
  2999* G-A IS USED FOR TOTAL OPTION 5.                                 ECS046
  3000                                                                  ECS046
  3001     IF DTE-CLIENT  =  'MON'                                      ECS046
  3002         NEXT SENTENCE                                            ECS046
  3003     ELSE                                                         ECS046
  3004         GO TO 1975-BYPASS-MON-CODE.                              ECS046
  3005                                                                  ECS046
  3006     MOVE +9                     TO  CL.                          ECS046
  3007                                                                  ECS046
  3008     IF AM-RETRO-LV-INDIC (CL)  =  'Y'                            ECS046
  3009         IF AM-J-COM (CL)  NOT NUMERIC                            ECS046
  3010             MOVE ZERO           TO  AM-J-COM (CL).               ECS046
  3011                                                                  ECS046
  3012     IF AM-L-COM (CL)  NOT NUMERIC                                ECS046
  3013         MOVE ZERO               TO  AM-L-COM (CL).               ECS046
  3014                                                                  ECS046
  3015     IF AM-A-COM (CL)  NOT NUMERIC                                ECS046
  3016         MOVE ZERO               TO  AM-A-COM (CL).               ECS046
  3017                                                                  ECS046
  3018     IF EP-RCD-TYPE  =  LIFE-OVERRIDE-L1                          ECS046
  3019         IF CLAS-I-JOINT (CLAS-INDEXL)  =  'J'                    ECS046
  3020             SUBTRACT AM-J-COM (CL)  FROM  WS-RETENTION-PCT       ECS046
  3021         ELSE                                                     ECS046
  3022             SUBTRACT AM-L-COM (CL)  FROM  WS-RETENTION-PCT       ECS046
  3023     ELSE                                                         ECS046
  3024         SUBTRACT AM-A-COM (CL)  FROM  WS-RETENTION-PCT.          ECS046
  3025                                                                  ECS046
  3026     IF AM-RET-Y-N  =  'N'  OR  ' '                               ECS046
  3027         MOVE ZEROS              TO  WS-RETENTION-PCT.            ECS046
  3028                                                                  ECS046
  3029     ADD +.06                    TO  WS-TAX-RATE.                 ECS046
  3030                                                                  ECS046
  3031     GO TO 1980-EXIT.                                             ECS046
  3032                                                                  ECS046
  3033 1975-BYPASS-MON-CODE.                                            ECS046
  3034     ADD +1 TO CL.                                                ECS046
  3035                                                                  ECS046
  3036     IF CL GREATER +10                                            ECS046
  3037         GO TO 1980-EXIT.                                         ECS046
  3038                                                                  ECS046
  3039     IF AM-COM-TYP (CL) = 'O' OR 'P' or 'S'
  3040         NEXT SENTENCE                                            ECS046
  3041     ELSE                                                         ECS046
  3042         GO TO 1970-PROCESS-COMM-STRUCT.                          ECS046
  3043                                                                  ECS046
  3044     IF AM-J-COM (CL) NOT NUMERIC                                 ECS046
  3045         MOVE ZERO               TO AM-J-COM (CL).                ECS046
  3046                                                                  ECS046
  3047     IF AM-L-COM (CL) NOT NUMERIC                                 ECS046
  3048         MOVE ZERO               TO AM-L-COM (CL).                ECS046
  3049                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS046.cbl
  3050     IF AM-A-COM (CL) NOT NUMERIC                                 ECS046
  3051         MOVE ZERO               TO AM-A-COM (CL).                ECS046
  3052                                                                  ECS046
  3053     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1                            ECS046
  3054         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECS046
  3055             SUBTRACT AM-J-COM (CL) FROM WS-RETENTION-PCT         ECS046
  3056         ELSE                                                     ECS046
  3057             SUBTRACT AM-L-COM (CL) FROM WS-RETENTION-PCT         ECS046
  3058     ELSE                                                         ECS046
  3059         SUBTRACT AM-A-COM (CL) FROM WS-RETENTION-PCT.            ECS046
  3060                                                                  ECS046
  3061     GO TO 1970-PROCESS-COMM-STRUCT.                              ECS046
  3062                                                                  ECS046
  3063 1980-EXIT.                                                       ECS046
  3064     MOVE SPACES                 TO WS-FIN-RESP-AGT.              ECS046
  3065                                                                  ECS046
  3066     IF DTE-CLIENT = 'MON'                                        ECS046
  3067         MOVE AM-AGT (9)         TO WS-FIN-RESP-AGT               ECS046
  3068     ELSE                                                         ECS046
  3069         IF AM-COM-TYP (AM-REMIT-TO) = 'O' OR 'P' or 'S'
  3070             MOVE AM-AGT (AM-REMIT-TO)  TO WS-FIN-RESP-AGT.       ECS046
  3071                                                                  ECS046
  3072     IF WS-RETENTION-PCT LESS ZERO                                ECS046
  3073         MOVE ZERO               TO WS-RETENTION-PCT.             ECS046
  3074                                                                  ECS046
  3075     IF DTE-CLIENT = 'CSO'                                        ECS046
  3076         MOVE ZERO               TO WS-RETENTION-PCT.             ECS046
  3077                                                                  ECS046
  3078     GO TO 1200-CHECK-CONTROL.                                    ECS046
  3079                                                                  ECS046
  3080 1990-EXIT.                                                       ECS046
  3081     CLOSE ACC-MSTR                                               ECS046
  3082           EPEC-FILE.                                             ECS046
  3083                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS046.cbl
  3085 2000-PERFORMED-INPUT-ROUTINES SECTION.                           ECS046
  3086                                                                  ECS046
  3087 2100-READ-EXTRACT.                                               ECS046
  3088                                                                  ECS046
  3089     READ EPEC-FILE AT END                                        ECS046
  3090         MOVE HIGH-VALUES        TO EP-CONTROL                    ECS046
  3091         GO TO 2140-EXIT.                                         ECS046
  3092                                                                  ECS046
  3093     IF EP-RECORD-ID NOT = 'EP' AND 'EC'                          ECS046
  3094         GO TO 2100-READ-EXTRACT.                                 ECS046
  3095                                                                  ECS046
* 3096     COPY ELCEPCM1.                                               ECS046
  3097******************************************************************05/15/98
  3098*                                                                *ELCEPCM1
  3099*                                                                *ELCEPCM1
  3100*                            ELCEPCM1                            *   LV007
  3101*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3102*                            VMOD=2.001                          *ELCEPCM1
  3103*                                                                *ELCEPCM1
  3104*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3105*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3106*                                                                *ELCEPCM1
  3107******************************************************************ELCEPCM1
  3108                                                                     CL**7
  3109     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3110                                 WS-EC-EXP-DTE-N.                    CL**7
  3111     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3112                                 WS-EC-EFF-DTE-N.                    CL**7
  3113     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3114                                 WS-EC-RUN-DTE-N.                    CL**7
  3115                                                                     CL**7
  3116     IF VALID-EP-ID                                                  CL**7
  3117         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3118         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3119         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3120                                                                     CL**7
  3121                                                                  ECS046
  3122* REINSURANCE RECORDS IN THE EPEC FILE ARE BYPASSED.              ECS046
  3123     IF EP-REIN = 'R'                                             ECS046
  3124         GO TO 2100-READ-EXTRACT.                                 ECS046
  3125                                                                  ECS046
  3126     IF WS-EP-RUN-DTE GREATER RUN-DT                              ECS046
  3127         GO TO 2100-READ-EXTRACT.                                 ECS046
  3128                                                                  ECS046
  3129     IF EP-PURGE = 'P'  OR                                        ECS046
  3130       (EP-RUN-YR = RD-YR AND EP-RUN-MO = RD-MO)  OR              ECS046
  3131       (EP-RUN-YR = BD-YR AND EP-RUN-MO = BD-MO)                  ECS046
  3132        NEXT SENTENCE                                             ECS046
  3133     ELSE                                                         ECS046
  3134         GO TO 2100-READ-EXTRACT.                                 ECS046
  3135                                                                  ECS046
  3136     IF EP-STATE EQUAL SAVE-STATE                                 ECS046
  3137        GO TO 2105-BENE-SEARCH.                                   ECS046
  3138                                                                  ECS046
  3139     MOVE SPACES                 TO SAVE-LF-BEN.                  ECS046
  3140     MOVE CLAS-STARTS            TO CLAS-INDEXS.                  ECS046
  3141                                                                  ECS046
  3142 2110-STATE-LOOK-UP.                                              ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS046.cbl
  3143                                                                  ECS046
  3144* THE GIVEN STATE THAT THE ACCOUNT IS LOCATED IN IS FOUND         ECS046
  3145* IN THE STATE TABLE IN THE DATE CARD WORKING STORAGE AREA        ECS046
  3146* TO DETERMINE IF THE STATE CODE IS FOR WYOMING.  THIS            ECS046
  3147* IS DONE BECAUSE ALL WYOMING ACCOUNTS MUST USE THE PRO-RATA      ECS046
  3148* METHOD FOR DETERMINING EARNED PREMIUM.                          ECS046
  3149                                                                  ECS046
  3150     IF EP-STATE = STATE-SUB (CLAS-INDEXS)                        ECS046
  3151        MOVE EP-STATE    TO SAVE-STATE                            ECS046
  3152     ELSE                                                         ECS046
  3153         ADD +1 TO CLAS-INDEXS                                    ECS046
  3154         IF CLAS-INDEXS NOT GREATER CLAS-MAXS                     ECS046
  3155             GO TO 2110-STATE-LOOK-UP                             ECS046
  3156         ELSE                                                     ECS046
  3157             DISPLAY ' INVALID STATE CODE -' AM-STATE             ECS046
  3158             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE  ECS046
  3159             MOVE 0402           TO WS-RETURN-CODE                ECS046
  3160             GO TO ABEND-PGM.                                     ECS046
  3161                                                                  ECS046
  3162 2105-BENE-SEARCH.                                                ECS046
  3163                                                                  ECS046
  3164     IF EP-RCD-TYPE = AH-OVERRIDE-L1                              ECS046
  3165         GO TO 2120-EP-EARN-AH.                                   ECS046
  3166                                                                  ECS046
  3167     IF EP-BEN-CODE EQUAL SAVE-LF-BEN                             ECS046
  3168         MOVE SAVE-EP-CODE       TO WS-EP-CODE                    ECS046
  3169         GO TO 2140-EXIT.                                         ECS046
  3170                                                                  ECS046
  3171     MOVE CLAS-STARTL            TO CLAS-INDEXL.                  ECS046
  3172                                                                  ECS046
  3173 2110-FIND-BENE.                                                  ECS046
  3174                                                                  ECS046
  3175     IF CLAS-INDEXL GREATER CLAS-MAXL OR                          ECS046
  3176        CLAS-INDEXL = ZERO                                        ECS046
  3177         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE       ECS046
  3178         MOVE   ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGEECS046
  3179         MOVE 0401               TO WS-RETURN-CODE                ECS046
  3180         GO TO ABEND-PGM.                                         ECS046
  3181                                                                  ECS046
  3182     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)                ECS046
  3183         ADD +1 TO CLAS-INDEXL                                    ECS046
  3184         GO TO 2110-FIND-BENE.                                    ECS046
  3185                                                                  ECS046
  3186     MOVE EP-BEN-CODE             TO SAVE-LF-BEN.                 ECS046
  3187     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE                   ECS046
  3188                                     SAVE-EP-CODE.                ECS046
  3189                                                                  ECS046
  3190     IF STATE-ABBR (CLAS-INDEXS) = 'WY'                           ECS046
  3191         MOVE 'P'                 TO WS-EP-CODE                   ECS046
  3192                                     SAVE-EP-CODE.                ECS046
  3193                                                                  ECS046
  3194     IF DTE-CLIENT  =  'MON'                                      ECS046
  3195         IF WS-EP-CODE  NOT =  'P'                                ECS046
  3196             MOVE 'R'            TO  WS-EP-CODE.                  ECS046
  3197                                                                  ECS046
  3198     GO TO 2140-EXIT.                                             ECS046
  3199                                                                  ECS046
  3200 2120-EP-EARN-AH.                                                 ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS046.cbl
  3201                                                                  ECS046
  3202* THIS REPORT DEFAULTS TO THE MEAN EARNING METHOD FOR A & H.      ECS046
  3203                                                                  ECS046
  3204     MOVE SPACES                 TO  SAVE-LF-BEN.                 ECS046
  3205                                                                  ECS046
  3206     IF DTE-CLIENT  =  'MON'                                      ECS046
  3207         MOVE 'R'                TO  WS-EP-CODE                   ECS046
  3208     ELSE                                                         ECS046
  3209         MOVE 'M'                TO  WS-EP-CODE.                  ECS046
  3210                                                                  ECS046
  3211 2140-EXIT.                                                       ECS046
  3212     EXIT.                                                        ECS046
  3213                                                                  ECS046
  3214 2200-READ-ACCT.                                                  ECS046
  3215     READ ACC-MSTR AT END                                         ECS046
  3216             MOVE ZEROS          TO AM-MSTR-CNTRL                    CL**9
  3217                                    AM-EFFECT-DT.                 ECS046
  3218                                                                  ECS046
  3219     MOVE AM-MSTR-CNTRL          TO WS-MSTR-CNTRL.                ECS046
  3220     MOVE AM-EFFECT-DT           TO WS-EFFECT.                    ECS046
  3221                                                                  ECS046
  3222 2240-EXIT.                                                       ECS046
  3223      EXIT.                                                       ECS046
  3224                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS046.cbl
  3226 2300-NO-ACCT-MSG.                                                ECS046
  3227     IF DTE-CLIENT  =  'MON'                                      ECS046
  3228         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  3229             MOVE HOLD-ACTIVE-DESC                                ECS046
  3230                                 TO  HD-STATUS-DESC               ECS046
  3231         ELSE                                                     ECS046
  3232             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  3233     ELSE                                                         ECS046
  3234         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  3235                                                                  ECS046
  3236     IF LINE-CNT GREATER +55                                      ECS046
  3237         MOVE ZERO               TO LINE-CNT                      ECS046
  3238         MOVE '1'                TO X                             ECS046
  3239         MOVE HEAD-1             TO P-DATA                        ECS046
  3240         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3241         MOVE ' '                TO X                             ECS046
  3242         MOVE HEAD-2             TO P-DATA                        ECS046
  3243         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3244         MOVE ' '                TO X                             ECS046
  3245         MOVE HEAD-3             TO P-DATA                        ECS046
  3246         PERFORM 4600-PRINT-ROUTINE.                              ECS046
  3247                                                                  ECS046
  3248     MOVE WS-SAVE-CARR           TO DNA-CARR.                     ECS046
  3249     MOVE WS-SAVE-GROUP          TO DNA-GROUP.                    ECS046
  3250     MOVE WS-SAVE-STATE          TO DNA-ST.                       ECS046
  3251     MOVE WS-SAVE-ACCT           TO DNA-ACCT.                     ECS046
  3252     MOVE WS-SAVE-EXP-DATE       TO WS-SAVE-EXP-DATE-R.           ECS046
  3253     MOVE WS-SAVE-EXP-YR         TO DNA-TYR.                      ECS046
  3254     MOVE WS-SAVE-EXP-MO         TO DNA-TMO.                      ECS046
  3255     MOVE WS-SAVE-EXP-DA         TO DNA-TDA.                      ECS046
  3256     MOVE WS-SAVE-EFF-DATE       TO WS-SAVE-EFF-DATE-R.           ECS046
  3257     MOVE WS-SAVE-EFF-YR         TO DNA-FYR.                      ECS046
  3258     MOVE WS-SAVE-EFF-MO         TO DNA-FMO.                      ECS046
  3259     MOVE WS-SAVE-EFF-DA         TO DNA-FDA.                      ECS046
  3260     MOVE ' NO MATCHING ACCOUNT MASTER' TO DNA-MESSAGE.           ECS046
  3261     MOVE ' '                    TO X.                            ECS046
  3262     MOVE DTL-NO-ACCT            TO P-DATA.                       ECS046
  3263     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3264                                                                  ECS046
  3265 2400-ZERO-DETAIL-ACCUMULATORS.                                   ECS046
  3266     MOVE +0                     TO DA-NET-PREM  (SA)             ECS046
  3267                                    DA-EARN-PREM (SA)             ECS046
  3268                                    DA-CLAIM-AMT (SA)             ECS046
  3269                                    DA-LOSS-RSRV (SA)             ECS046
  3270                                    DA-EARN-COMP (SA)             ECS046
  3271                                    DA-RETENTION (SA)             ECS046
  3272                                    DA-PREM-TAX  (SA).            ECS046
  3273                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS046.cbl
  3275 3000-PRINT-REPORT-A   SECTION.                                   ECS046
  3276                                                                  ECS046
  3277     OPEN INPUT  COMP-FILE                                        ECS046
  3278          OUTPUT WORK-FILE.                                       ECS046
  3279                                                                  ECS046
  3280     IF NO-OF-RECORDS-RELEASED = +0                               ECS046
  3281         GO TO 3990-PRINT-RPT-A-EXIT.                             ECS046
  3282                                                                  ECS046
  3283     MOVE ZERO                   TO NO-OF-RECORDS-RELEASED.       ECS046
  3284                                                                  ECS046
  3285     MOVE +1                     TO SB.                           ECS046
  3286     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3287         VARYING SE FROM 1 BY 1 UNTIL SE GREATER 6.               ECS046
  3288                                                                  ECS046
  3289     MOVE +2                     TO SB.                           ECS046
  3290     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3291         VARYING SE FROM 1 BY 1 UNTIL SE GREATER 6.               ECS046
  3292                                                                  ECS046
  3293     PERFORM 3100-RETURN-SORT-WORK-A.                             ECS046
  3294                                                                  ECS046
  3295     MOVE SWA-REC-OUT            TO SWA-REC.                      ECS046
  3296     MOVE SWA-CONTROL            TO SAVE-SWA-CONTROL.             ECS046
  3297                                                                  ECS046
  3298     PERFORM 3500-GET-GA-NAME THRU 3500-EXIT.                     ECS046
  3299                                                                  ECS046
  3300     IF DTE-PGM-OPT = 1                                           ECS046
  3301         MOVE '- YEAR TO DATE'   TO HD-RPT-TYPE.                  ECS046
  3302                                                                  ECS046
  3303     IF DTE-PGM-OPT = 2                                           ECS046
  3304         MOVE '- LAST 12 MONTHS' TO HD-RPT-TYPE.                  ECS046
  3305                                                                  ECS046
  3306     IF DTE-PGM-OPT = 3                                           ECS046
  3307         MOVE '- INCEPTION TO DATE' TO HD-RPT-TYPE.               ECS046
  3308                                                                  ECS046
  3309     IF DTE-PGM-OPT = 4                                           ECS046
  3310         MOVE '- CURRENT MONTH'  TO HD-RPT-TYPE.                  ECS046
  3311                                                                  ECS046
  3312     IF DTE-TOT-OPT = 3                                           ECS046
  3313         MOVE CLAS-REPORT-CD1-CAPTION TO HD-RPT-CAPTION.          ECS046
  3314                                                                  ECS046
  3315     IF DTE-TOT-OPT = 4                                           ECS046
  3316         MOVE CLAS-REPORT-CD2-CAPTION TO HD-RPT-CAPTION.          ECS046
  3317                                                                  ECS046
  3318     MOVE 'A'                    TO H1-REPORT-SUF.                ECS046
  3319     PERFORM 4500-PRINT-HEADINGS THRU 4580-DTL-HDRS.              ECS046
  3320                                                                  ECS046
  3321                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS046.cbl
  3323 3100-RETURN-SORT-WORK-A.                                         ECS046
  3324     RETURN SORT-WORK-A                                           ECS046
  3325                AT END  MOVE HIGH-VALUES   TO SWA-CONTROL-OUT.    ECS046
  3326                                                                  ECS046
  3327 3150-CHECK-FOR-CTL-BREAK.                                        ECS046
  3328                                                                  ECS046
  3329     IF SWA-CONTROL-OUT = SWA-CONTROL                             ECS046
  3330       COMPUTE SWA-NET-PREM (1) = SWA-NET-PREM (1) + SW-NP (1)    ECS046
  3331       COMPUTE SWA-EARN-PREM (1) = SWA-EARN-PREM (1) + SW-EP (1)  ECS046
  3332       COMPUTE SWA-CLMS-INCUR (1) = SWA-CLMS-INCUR (1) + SW-CI (1)ECS046
  3333       COMPUTE SWA-EARN-COMP (1) = SWA-EARN-COMP (1) + SW-EC (1)  ECS046
  3334       COMPUTE SWA-RETENTION (1) = SWA-RETENTION (1) + SW-RT (1)  ECS046
  3335       COMPUTE SWA-PREM-TAX (1) = SWA-PREM-TAX (1) + SW-PT (1)    ECS046
  3336       COMPUTE SWA-NET-PREM (2) = SWA-NET-PREM (2) + SW-NP (2)    ECS046
  3337       COMPUTE SWA-EARN-PREM (2) = SWA-EARN-PREM (2) + SW-EP (2)  ECS046
  3338       COMPUTE SWA-CLMS-INCUR (2) = SWA-CLMS-INCUR (2) + SW-CI (2)ECS046
  3339       COMPUTE SWA-EARN-COMP (2) = SWA-EARN-COMP (2) + SW-EC (2)  ECS046
  3340       COMPUTE SWA-RETENTION (2) = SWA-RETENTION (2) + SW-RT (2)  ECS046
  3341       COMPUTE SWA-PREM-TAX (2) = SWA-PREM-TAX (2) + SW-PT (2)    ECS046
  3342           GO TO 3100-RETURN-SORT-WORK-A.                         ECS046
  3343                                                                  ECS046
  3344     IF SWA-CONTROL-1 NOT = SAVE-SWA-CONTROL-1                    ECS046
  3345         PERFORM 4200-SWA-CONTROL-BREAK                           ECS046
  3346         PERFORM 3500-GET-GA-NAME THRU 3500-EXIT.                 ECS046
  3347                                                                  ECS046
  3348     MOVE SWA-CONTROL            TO SAVE-SWA-CONTROL.             ECS046
  3349                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS046.cbl
  3351 3200-BUILD-DTL-LINE-A.                                           ECS046
  3352     IF WS-BREAK-SW = 'Y'                                         ECS046
  3353         MOVE ZERO               TO LINE-CNT                      ECS046
  3354         MOVE 'N'                TO WS-BREAK-SW                   ECS046
  3355         PERFORM 4510-BUS-TYPE-HDR THRU 4580-DTL-HDRS.            ECS046
  3356                                                                  ECS046
  3357     IF LINE-CNT GREATER +48                                      ECS046
  3358         MOVE ZERO               TO LINE-CNT                      ECS046
  3359         PERFORM 4500-PRINT-HEADINGS THRU 4580-DTL-HDRS.          ECS046
  3360                                                                  ECS046
  3361     MOVE ' '                    TO X.                            ECS046
  3362     MOVE ALL '-'                TO P-DATA.                       ECS046
  3363     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3364                                                                  ECS046
  3365     MOVE SWA-ACCT               TO HA-ACCOUNT.                   ECS046
  3366     MOVE SWA-NAME               TO HA-ACCT-NAME.                 ECS046
  3367     MOVE SWA-CITY               TO HA-ACCT-CITY.                 ECS046
  3368     MOVE ' '                    TO X.                            ECS046
  3369     MOVE HEAD-ACCT              TO P-DATA.                       ECS046
  3370     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3371                                                                  ECS046
  3372     MOVE LIFE-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3373                                                                  ECS046
  3374     COMPUTE  DLA-NET-PREM ROUNDED   = SWA-NET-PREM   (1).        ECS046
  3375     COMPUTE  DLA-EARN-PREM ROUNDED  = SWA-EARN-PREM  (1).        ECS046
  3376     COMPUTE  DLA-CLMS-INCUR ROUNDED = SWA-CLMS-INCUR (1).        ECS046
  3377     COMPUTE  DLA-EARN-COMP ROUNDED  = SWA-EARN-COMP  (1).        ECS046
  3378     COMPUTE WS-LF-SURPLUS ROUNDED   = SWA-EARN-PREM  (1) -       ECS046
  3379                  (SWA-CLMS-INCUR (1) + SWA-EARN-COMP (1)).       ECS046
  3380     COMPUTE  DLA-SURPLUS ROUNDED    = WS-LF-SURPLUS.             ECS046
  3381     COMPUTE  DLA-RETENTION ROUNDED  = SWA-RETENTION  (1).        ECS046
  3382                                                                  ECS046
  3383     IF SWA-RETENTION (1) = ZERO     OR                           ECS046
  3384        SWA-RETENTION (1) GREATER WS-LF-SURPLUS                   ECS046
  3385         MOVE WS-LF-SURPLUS      TO WS-LF-PREM-PROFIT             ECS046
  3386     ELSE                                                         ECS046
  3387         MOVE SWA-RETENTION (1)  TO WS-LF-PREM-PROFIT.            ECS046
  3388                                                                  ECS046
  3389     COMPUTE  DLA-PREM-PROFIT ROUNDED = WS-LF-PREM-PROFIT.        ECS046
  3390     COMPUTE  DLA-PREM-TAX ROUNDED    = SWA-PREM-TAX (1).         ECS046
  3391     COMPUTE WS-LF-UW-INCOME ROUNDED  =                           ECS046
  3392                WS-LF-PREM-PROFIT - SWA-PREM-TAX (1).             ECS046
  3393     COMPUTE  DLA-UW-INCOME ROUNDED   = WS-LF-UW-INCOME.          ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS046.cbl
  3395     IF SWA-EARN-PREM (1) = ZERO                                  ECS046
  3396         MOVE '*******'          TO DLA-LOSS-RATIO-RD             ECS046
  3397                                    DLA-TOT-CHARGES-RD            ECS046
  3398         MOVE ZERO               TO DLA-COMP-RATIO                ECS046
  3399     ELSE                                                         ECS046
  3400         COMPUTE WS-LOSS-RATIO ROUNDED   =                        ECS046
  3401                   (SWA-CLMS-INCUR (1) / SWA-EARN-PREM (1)) * +100ECS046
  3402         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3403         COMPUTE WS-COMP-RATIO ROUNDED   =                        ECS046
  3404                    (SWA-EARN-COMP (1) / SWA-EARN-PREM (1)) * +100ECS046
  3405         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3406         COMPUTE WS-TOT-CHARGES ROUNDED  =                        ECS046
  3407              (+1 - (WS-LF-UW-INCOME / SWA-EARN-PREM (1))) * +100 ECS046
  3408         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3409                                                                  ECS046
  3410     MOVE '0'                    TO X.                            ECS046
  3411     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3412     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3413     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3414                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS046.cbl
  3416     MOVE AH-OVERRIDE-L2         TO DLA-BEN-DESC.                 ECS046
  3417     COMPUTE  DLA-NET-PREM ROUNDED   = SWA-NET-PREM   (2).        ECS046
  3418     COMPUTE  DLA-EARN-PREM ROUNDED  = SWA-EARN-PREM  (2).        ECS046
  3419     COMPUTE  DLA-CLMS-INCUR ROUNDED = SWA-CLMS-INCUR (2).        ECS046
  3420     COMPUTE  DLA-EARN-COMP ROUNDED  = SWA-EARN-COMP  (2).        ECS046
  3421     COMPUTE WS-AH-SURPLUS ROUNDED   = SWA-EARN-PREM  (2) -       ECS046
  3422                  (SWA-CLMS-INCUR (2) + SWA-EARN-COMP (2)).       ECS046
  3423     COMPUTE  DLA-SURPLUS ROUNDED    = WS-AH-SURPLUS.             ECS046
  3424     COMPUTE  DLA-RETENTION ROUNDED  = SWA-RETENTION  (2).        ECS046
  3425                                                                  ECS046
  3426     IF SWA-RETENTION (2) = ZERO     OR                           ECS046
  3427        SWA-RETENTION (2) GREATER WS-AH-SURPLUS                   ECS046
  3428         MOVE WS-AH-SURPLUS      TO WS-AH-PREM-PROFIT             ECS046
  3429     ELSE                                                         ECS046
  3430         MOVE SWA-RETENTION (2)  TO WS-AH-PREM-PROFIT.            ECS046
  3431                                                                  ECS046
  3432     COMPUTE  DLA-PREM-PROFIT ROUNDED = WS-AH-PREM-PROFIT.        ECS046
  3433     COMPUTE  DLA-PREM-TAX ROUNDED    = SWA-PREM-TAX (2).         ECS046
  3434     COMPUTE WS-AH-UW-INCOME =                                    ECS046
  3435                WS-AH-PREM-PROFIT - SWA-PREM-TAX (2).             ECS046
  3436     COMPUTE  DLA-UW-INCOME ROUNDED   = WS-AH-UW-INCOME.          ECS046
  3437                                                                  ECS046
  3438     IF SWA-EARN-PREM (2) = ZERO                                  ECS046
  3439         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3440                                    DLA-COMP-RATIO                ECS046
  3441                                    DLA-TOT-CHARGES               ECS046
  3442     ELSE                                                         ECS046
  3443         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3444                   (SWA-CLMS-INCUR (2) / SWA-EARN-PREM (2)) * +100ECS046
  3445         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3446         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3447                    (SWA-EARN-COMP (2) / SWA-EARN-PREM (2)) * +100ECS046
  3448         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3449         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3450              (+1 - (WS-AH-UW-INCOME / SWA-EARN-PREM (2))) * +100 ECS046
  3451         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3452                                                                  ECS046
  3453     MOVE ' '                    TO X.                            ECS046
  3454     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3455     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3456     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3457                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS046.cbl
  3459     MOVE 'TOT'                  TO DLA-BEN-DESC.                 ECS046
  3460     COMPUTE DLA-NET-PREM ROUNDED =                               ECS046
  3461                SWA-NET-PREM (1) + SWA-NET-PREM (2).              ECS046
  3462     COMPUTE DLA-EARN-PREM ROUNDED =                              ECS046
  3463                SWA-EARN-PREM (1) + SWA-EARN-PREM (2).            ECS046
  3464     COMPUTE DLA-CLMS-INCUR ROUNDED =                             ECS046
  3465                SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2).          ECS046
  3466     COMPUTE DLA-EARN-COMP ROUNDED =                              ECS046
  3467                SWA-EARN-COMP (1) + SWA-EARN-COMP (2).            ECS046
  3468     COMPUTE DLA-SURPLUS ROUNDED = WS-AH-SURPLUS + WS-LF-SURPLUS. ECS046
  3469     COMPUTE DLA-RETENTION ROUNDED =                              ECS046
  3470                SWA-RETENTION (1) + SWA-RETENTION (2).            ECS046
  3471     COMPUTE DLA-PREM-PROFIT ROUNDED =                            ECS046
  3472                WS-LF-PREM-PROFIT + WS-AH-PREM-PROFIT.            ECS046
  3473     COMPUTE DLA-PREM-TAX ROUNDED =                               ECS046
  3474                SWA-PREM-TAX (1) + SWA-PREM-TAX (2).              ECS046
  3475     COMPUTE DLA-UW-INCOME ROUNDED =                              ECS046
  3476                WS-LF-UW-INCOME + WS-AH-UW-INCOME.                ECS046
  3477                                                                  ECS046
  3478     IF SWA-EARN-PREM (1) = ZERO AND SWA-EARN-PREM (2) = ZERO     ECS046
  3479         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3480                                    DLA-COMP-RATIO                ECS046
  3481                                    DLA-TOT-CHARGES               ECS046
  3482     ELSE                                                         ECS046
  3483         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3484                ((SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2)) /      ECS046
  3485                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3486         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3487                ((SWA-EARN-COMP (1) + SWA-EARN-COMP (2)) /        ECS046
  3488                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3489         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3490           (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /            ECS046
  3491                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3492         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3493         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3494         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3495                                                                  ECS046
  3496     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3497     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3498     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3499                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS046.cbl
  3501 3300-BUILD-SORT-WORK-B.                                          ECS046
  3502     IF DTE-FMT-OPT = 1                                           ECS046
  3503         GO TO 3400-ACCUMULATE-BREAK-TOTALS.                      ECS046
  3504                                                                  ECS046
  3505     IF SWA-EARN-PREM (1) = ZERO AND                              ECS046
  3506        SWA-EARN-PREM (2) = ZERO                                  ECS046
  3507         MOVE ZERO               TO SWB-LOSS-RATIO                ECS046
  3508                                    SWB-TOT-CHARGES               ECS046
  3509     ELSE                                                         ECS046
  3510         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3511                ((SWA-CLMS-INCUR (1) + SWA-CLMS-INCUR (2)) /      ECS046
  3512                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3513         COMPUTE SWB-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3514         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3515                 (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /      ECS046
  3516                 (SWA-EARN-PREM (1) + SWA-EARN-PREM (2))) * +100  ECS046
  3517         COMPUTE SWB-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3518                                                                  ECS046
  3519     COMPUTE SWB-NET-PREM ROUNDED =                               ECS046
  3520                SWA-NET-PREM (1) + SWA-NET-PREM (2).              ECS046
  3521     COMPUTE SWB-PREM-PROFIT ROUNDED =                            ECS046
  3522                WS-LF-PREM-PROFIT + WS-AH-PREM-PROFIT.            ECS046
  3523                                                                  ECS046
  3524     IF DTE-FMT-OPT = 2                                           ECS046
  3525         MOVE SWB-LOSS-RATIO     TO SWB-SORT-AMT.                 ECS046
  3526                                                                  ECS046
  3527     IF DTE-FMT-OPT = 3                                           ECS046
  3528         MOVE SWB-TOT-CHARGES    TO SWB-SORT-AMT.                 ECS046
  3529                                                                  ECS046
  3530     IF DTE-FMT-OPT = 4                                           ECS046
  3531         MOVE SWB-NET-PREM       TO SWB-SORT-AMT.                 ECS046
  3532                                                                  ECS046
  3533     IF DTE-FMT-OPT = 5                                           ECS046
  3534         MOVE SWB-PREM-PROFIT    TO SWB-SORT-AMT.                 ECS046
  3535                                                                  ECS046
  3536     MOVE SWA-BUS-TYPE           TO SWB-BUS-TYPE.                 ECS046
  3537     MOVE SWA-CARR               TO SWB-CARR.                     ECS046
  3538     MOVE SWA-GROUP              TO SWB-GROUP.                    ECS046
  3539     MOVE SWA-STATE              TO SWB-STATE.                    ECS046
  3540     MOVE SWA-GA-OR-RPT-CD       TO SWB-GA-OR-RPT-CD.             ECS046
  3541     MOVE SWA-ACCT               TO SWB-ACCT.                     ECS046
  3542     MOVE SWA-NAME               TO SWB-NAME.                     ECS046
  3543                                                                  ECS046
  3544     WRITE WORK-REC    FROM SWB-REC.                              ECS046
  3545     ADD +1 TO NO-OF-RECORDS-RELEASED.                            ECS046
  3546                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS046.cbl
  3548 3400-ACCUMULATE-BREAK-TOTALS.                                    ECS046
  3549     PERFORM 4100-ACCUMULATE                                      ECS046
  3550         VARYING SC FROM 1 BY 1 UNTIL SC GREATER 6.               ECS046
  3551                                                                  ECS046
  3552     MOVE SWA-REC-OUT            TO SWA-REC.                      ECS046
  3553                                                                  ECS046
  3554     IF SWA-CONTROL = HIGH-VALUES                                 ECS046
  3555         PERFORM 4200-SWA-CONTROL-BREAK                           ECS046
  3556         GO TO 3990-PRINT-RPT-A-EXIT.                             ECS046
  3557                                                                  ECS046
  3558     GO TO 3100-RETURN-SORT-WORK-A.                               ECS046
  3559                                                                  ECS046
  3560 3500-GET-GA-NAME.                                                ECS046
  3561     MOVE SWA-CARR               TO  HOLD-CARRIER.                ECS046
  3562     MOVE SWA-SAVE-GROUP         TO  HOLD-GROUPING.               ECS046
  3563     MOVE SWA-GA-OR-RPT-CD       TO  HOLD-GA-NUMBER.              ECS046
  3564     MOVE LOW-VALUES             TO  HOLD-ACCT.                   ECS046
  3565     MOVE SWA-GA-OR-RPT-CD       TO  HOLD-ACCT.                   ECS046
  3566     MOVE 'G'                    TO  HOLD-RECORD-TYPE.            ECS046
  3567     MOVE HOLD-COMP-KEY          TO  CO-CONTROL-PRIMARY.          ECS046
  3568                                                                  ECS046
  3569     READ COMP-FILE.                                              ECS046
  3570                                                                  ECS046
  3571     IF ERCOMP-FILE-STATUS  =  '00'                               ECS046
  3572         NEXT SENTENCE                                            ECS046
  3573     ELSE                                                         ECS046
  3574         MOVE 'NOT FOUND'        TO  CO-MAIL-NAME  CO-ACCT-NAME.  ECS046
  3575                                                                  ECS046
  3576     IF DTE-CLIENT = 'MON'                                        ECS046
  3577         MOVE CO-MAIL-NAME       TO  HOLD-GA-NAME                 ECS046
  3578     ELSE                                                         ECS046
  3579         MOVE CO-ACCT-NAME       TO  HOLD-GA-NAME.                ECS046
  3580                                                                  ECS046
  3581 3500-EXIT.                                                       ECS046
  3582     EXIT.                                                        ECS046
  3583                                                                  ECS046
  3584 3990-PRINT-RPT-A-EXIT.                                           ECS046
  3585     CLOSE COMP-FILE  WORK-FILE.                                  ECS046
  3586                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS046.cbl
  3588 4000-PERFORMED-RPT-A-ROUTINES SECTION.                           ECS046
  3589                                                                  ECS046
  3590 4100-ACCUMULATE.                                                 ECS046
  3591     ADD SWA-NET-PREM   (1)      TO BA-NET-PREM    (1, SC).       ECS046
  3592     ADD SWA-EARN-PREM  (1)      TO BA-EARN-PREM   (1, SC).       ECS046
  3593     ADD SWA-CLMS-INCUR (1)      TO BA-CLMS-INCUR  (1, SC).       ECS046
  3594     ADD SWA-EARN-COMP  (1)      TO BA-EARN-COMP   (1, SC).       ECS046
  3595     ADD SWA-RETENTION  (1)      TO BA-RETENTION   (1, SC).       ECS046
  3596     ADD SWA-PREM-TAX   (1)      TO BA-PREM-TAX    (1, SC).       ECS046
  3597     ADD WS-LF-PREM-PROFIT       TO BA-PREM-PROFIT (1, SC)        ECS046
  3598     ADD SWA-NET-PREM   (2)      TO BA-NET-PREM    (2, SC).       ECS046
  3599     ADD SWA-EARN-PREM  (2)      TO BA-EARN-PREM   (2, SC).       ECS046
  3600     ADD SWA-CLMS-INCUR (2)      TO BA-CLMS-INCUR  (2, SC).       ECS046
  3601     ADD SWA-EARN-COMP  (2)      TO BA-EARN-COMP   (2, SC).       ECS046
  3602     ADD SWA-RETENTION  (2)      TO BA-RETENTION   (2, SC).       ECS046
  3603     ADD SWA-PREM-TAX   (2)      TO BA-PREM-TAX    (2, SC).       ECS046
  3604     ADD WS-AH-PREM-PROFIT       TO BA-PREM-PROFIT (2, SC).       ECS046
  3605                                                                  ECS046
  3606 4200-SWA-CONTROL-BREAK.                                          ECS046
  3607     MOVE ZERO                   TO LINE-CNT.                     ECS046
  3608     PERFORM 4500-PRINT-HEADINGS.                                 ECS046
  3609                                                                  ECS046
  3610     IF DTE-TOT-OPT = 1                                           ECS046
  3611         PERFORM 4210-STATE-BREAK                                 ECS046
  3612         PERFORM 4240-GROUP-BREAK                                 ECS046
  3613         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3614                                                                  ECS046
  3615     IF DTE-TOT-OPT = 2                                           ECS046
  3616         PERFORM 4210-STATE-BREAK                                 ECS046
  3617         PERFORM 4240-GROUP-BREAK                                 ECS046
  3618         PERFORM 4250-CARRIER-BREAK                               ECS046
  3619         PERFORM 4260-BUS-TYPE-BREAK.                             ECS046
  3620                                                                  ECS046
  3621     IF DTE-TOT-OPT = 3                                           ECS046
  3622         PERFORM 4220-RPT-CODE-BREAK.                             ECS046
  3623                                                                  ECS046
  3624     IF DTE-TOT-OPT = 4                                           ECS046
  3625         PERFORM 4220-RPT-CODE-BREAK                              ECS046
  3626         PERFORM 4240-GROUP-BREAK                                 ECS046
  3627         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3628                                                                  ECS046
  3629     IF DTE-TOT-OPT = 5                                           ECS046
  3630         PERFORM 4230-GNL-AGT-BREAK                               ECS046
  3631         PERFORM 4250-CARRIER-BREAK.                              ECS046
  3632                                                                  ECS046
  3633     IF DTE-TOT-OPT = 6                                           ECS046
  3634         PERFORM 4225-RPT2-CODE-BREAK.                            ECS046
  3635                                                                  ECS046
  3636     IF SWA-CONTROL = HIGH-VALUES                                 ECS046
  3637         MOVE 'F'              TO WS-BREAK-SW                     ECS046
  3638         PERFORM 4270-FINAL-TOT-BREAK.                            ECS046
  3639                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS046.cbl
  3641 4210-STATE-BREAK.                                                ECS046
  3642     IF SWA-STATE    = SAVE-SWA-STATE AND                         ECS046
  3643        SWA-GROUP    = SAVE-SWA-GROUP AND                         ECS046
  3644        SWA-CARR     = SAVE-SWA-CARR  AND                         ECS046
  3645        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3646         NEXT SENTENCE                                            ECS046
  3647     ELSE                                                         ECS046
  3648         PERFORM 4510-BUS-TYPE-HDR THRU 4540-STATE-HDR            ECS046
  3649         MOVE '0'                TO X                             ECS046
  3650         MOVE 'STATE TOTALS'     TO P-DATA                        ECS046
  3651         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3652         PERFORM 4580-DTL-HDRS                                    ECS046
  3653         MOVE +1                 TO SC                            ECS046
  3654         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3655                                                                  ECS046
  3656 4220-RPT-CODE-BREAK.                                             ECS046
  3657     IF SWA-GA-OR-RPT-CD = SAVE-SWA-GA-OR-RPT-CD AND              ECS046
  3658        SWA-GROUP        = SAVE-SWA-GROUP        AND              ECS046
  3659        SWA-CARR         = SAVE-SWA-CARR                          ECS046
  3660         NEXT SENTENCE                                            ECS046
  3661     ELSE                                                         ECS046
  3662         PERFORM 4520-CARR-HDR THRU 4570-G-A-HDR                  ECS046
  3663         MOVE '0'                TO X                             ECS046
  3664         MOVE HD-BRK-TYPE        TO P-DATA                        ECS046
  3665         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3666         PERFORM 4580-DTL-HDRS                                    ECS046
  3667         MOVE +2                 TO SC                            ECS046
  3668         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3669                                                                  ECS046
  3670 4225-RPT2-CODE-BREAK.                                            ECS046
  3671     IF SWA-RPT-CD-1 = SAVE-SWA-RPT-CD-1 AND                      ECS046
  3672        SWA-RPT-CD-2 = SAVE-SWA-RPT-CD-2                          ECS046
  3673         NEXT SENTENCE                                            ECS046
  3674     ELSE                                                         ECS046
  3675         PERFORM 4575-RPT-CD1-2-HDR                               ECS046
  3676         MOVE '0'                TO X                             ECS046
  3677         MOVE HD-BRK-TYPE        TO P-DATA                        ECS046
  3678         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3679         PERFORM 4580-DTL-HDRS                                    ECS046
  3680         MOVE +2                 TO SC                            ECS046
  3681         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3682                                                                  ECS046
  3683 4230-GNL-AGT-BREAK.                                              ECS046
  3684     IF SWA-GA-OR-RPT-CD = SAVE-SWA-GA-OR-RPT-CD AND              ECS046
  3685        SWA-CARR         = SAVE-SWA-CARR                          ECS046
  3686         NEXT SENTENCE                                            ECS046
  3687     ELSE                                                         ECS046
  3688         PERFORM 4520-CARR-HDR                                    ECS046
  3689         PERFORM 4570-G-A-HDR                                     ECS046
  3690         MOVE '0'                TO X                             ECS046
  3691         MOVE 'GENERAL AGENT TOTALS' TO P-DATA                    ECS046
  3692         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3693         PERFORM 4580-DTL-HDRS                                    ECS046
  3694         MOVE +2                 TO SC                            ECS046
  3695         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3696                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS046.cbl
  3698 4240-GROUP-BREAK.                                                ECS046
  3699     IF SWA-GROUP    = SAVE-SWA-GROUP AND                         ECS046
  3700        SWA-CARR     = SAVE-SWA-CARR  AND                         ECS046
  3701        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3702         NEXT SENTENCE                                            ECS046
  3703     ELSE                                                         ECS046
  3704         PERFORM 4510-BUS-TYPE-HDR THRU 4530-GROUP-HDR            ECS046
  3705         MOVE '0'                TO X                             ECS046
  3706         MOVE 'GROUP TOTALS'     TO P-DATA                        ECS046
  3707         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3708         PERFORM 4580-DTL-HDRS                                    ECS046
  3709         MOVE +3                 TO SC                            ECS046
  3710         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3711                                                                  ECS046
  3712 4250-CARRIER-BREAK.                                              ECS046
  3713     IF SWA-CARR     = SAVE-SWA-CARR AND                          ECS046
  3714        SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3715         NEXT SENTENCE                                            ECS046
  3716     ELSE                                                         ECS046
  3717         PERFORM 4510-BUS-TYPE-HDR THRU 4520-CARR-HDR             ECS046
  3718         MOVE '0'                TO X                             ECS046
  3719         MOVE 'CARRIER TOTALS'   TO P-DATA                        ECS046
  3720         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3721         PERFORM 4580-DTL-HDRS                                    ECS046
  3722         MOVE +4                 TO SC                            ECS046
  3723         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3724                                                                  ECS046
  3725 4260-BUS-TYPE-BREAK.                                             ECS046
  3726     IF SWA-BUS-TYPE = SAVE-SWA-BUS-TYPE                          ECS046
  3727         NEXT SENTENCE                                            ECS046
  3728     ELSE                                                         ECS046
  3729         PERFORM 4510-BUS-TYPE-HDR                                ECS046
  3730         MOVE '0'                TO X                             ECS046
  3731         MOVE 'BUSINESS TYPE TOTALS'   TO P-DATA                  ECS046
  3732         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3733         PERFORM 4580-DTL-HDRS                                    ECS046
  3734         MOVE +5                 TO SC                            ECS046
  3735         PERFORM 4280-PRINT-TOTAL-LINES.                          ECS046
  3736                                                                  ECS046
  3737 4270-FINAL-TOT-BREAK.                                            ECS046
  3738     MOVE '0'                    TO X.                            ECS046
  3739     MOVE 'FINAL TOTALS'         TO P-DATA.                       ECS046
  3740     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3741     PERFORM 4580-DTL-HDRS.                                       ECS046
  3742     MOVE +6                     TO SC.                           ECS046
  3743     PERFORM 4280-PRINT-TOTAL-LINES.                              ECS046
  3744                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS046.cbl
  3746 4280-PRINT-TOTAL-LINES.                                          ECS046
  3747     MOVE LIFE-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3748     COMPUTE DLA-NET-PREM ROUNDED   = BA-NET-PREM (1, SC).        ECS046
  3749     COMPUTE DLA-EARN-PREM ROUNDED  = BA-EARN-PREM (1, SC).       ECS046
  3750     COMPUTE DLA-CLMS-INCUR ROUNDED = BA-CLMS-INCUR (1, SC).      ECS046
  3751     COMPUTE DLA-EARN-COMP ROUNDED  = BA-EARN-COMP (1, SC).       ECS046
  3752     COMPUTE WS-LF-SURPLUS = BA-EARN-PREM (1, SC) -               ECS046
  3753                  (BA-CLMS-INCUR (1, SC) + BA-EARN-COMP (1, SC)). ECS046
  3754     COMPUTE DLA-SURPLUS ROUNDED    = WS-LF-SURPLUS.              ECS046
  3755     COMPUTE DLA-RETENTION ROUNDED  = BA-RETENTION (1, SC).       ECS046
  3756     COMPUTE DLA-PREM-PROFIT ROUNDED = BA-PREM-PROFIT (1, SC).    ECS046
  3757     COMPUTE DLA-PREM-TAX ROUNDED    = BA-PREM-TAX (1, SC).       ECS046
  3758     COMPUTE WS-LF-UW-INCOME =                                    ECS046
  3759                BA-PREM-PROFIT (1, SC) - BA-PREM-TAX (1, SC).     ECS046
  3760     COMPUTE DLA-UW-INCOME ROUNDED = WS-LF-UW-INCOME.             ECS046
  3761                                                                  ECS046
  3762     IF BA-EARN-PREM (1, SC) = ZERO                               ECS046
  3763         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3764                                    DLA-COMP-RATIO                ECS046
  3765                                    DLA-TOT-CHARGES               ECS046
  3766     ELSE                                                         ECS046
  3767         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3768          (BA-CLMS-INCUR (1, SC) / BA-EARN-PREM (1, SC)) * +100   ECS046
  3769         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3770         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3771          (BA-EARN-COMP (1, SC) / BA-EARN-PREM (1, SC)) * +100    ECS046
  3772         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3773         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3774          (+1 - (WS-LF-UW-INCOME / BA-EARN-PREM (1, SC))) * +100  ECS046
  3775         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3776                                                                  ECS046
  3777     MOVE '0'                    TO X.                            ECS046
  3778     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3779     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3780     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3781                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS046.cbl
  3783     MOVE   AH-OVERRIDE-L2       TO DLA-BEN-DESC.                 ECS046
  3784     COMPUTE DLA-NET-PREM ROUNDED    = BA-NET-PREM   (2, SC).     ECS046
  3785     COMPUTE DLA-EARN-PREM ROUNDED   = BA-EARN-PREM  (2, SC).     ECS046
  3786     COMPUTE DLA-CLMS-INCUR ROUNDED  = BA-CLMS-INCUR (2, SC).     ECS046
  3787     COMPUTE DLA-EARN-COMP ROUNDED   = BA-EARN-COMP  (2, SC).     ECS046
  3788     COMPUTE WS-AH-SURPLUS = BA-EARN-PREM  (2, SC) -              ECS046
  3789                            (BA-CLMS-INCUR (2, SC) +              ECS046
  3790                             BA-EARN-COMP  (2, SC)).              ECS046
  3791     COMPUTE DLA-SURPLUS ROUNDED     = WS-AH-SURPLUS.             ECS046
  3792     COMPUTE DLA-RETENTION ROUNDED   = BA-RETENTION   (2, SC).    ECS046
  3793     COMPUTE DLA-PREM-PROFIT ROUNDED = BA-PREM-PROFIT (2, SC).    ECS046
  3794     COMPUTE DLA-PREM-TAX ROUNDED    = BA-PREM-TAX    (2, SC).    ECS046
  3795     COMPUTE WS-AH-UW-INCOME = BA-PREM-PROFIT (2, SC) -           ECS046
  3796                               BA-PREM-TAX    (2, SC).            ECS046
  3797     COMPUTE DLA-UW-INCOME ROUNDED   = WS-AH-UW-INCOME.           ECS046
  3798                                                                  ECS046
  3799     IF BA-EARN-PREM (2, SC) = ZERO                               ECS046
  3800         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3801                                    DLA-COMP-RATIO                ECS046
  3802                                    DLA-TOT-CHARGES               ECS046
  3803     ELSE                                                         ECS046
  3804         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3805          (BA-CLMS-INCUR (2, SC) / BA-EARN-PREM (2, SC)) * +100   ECS046
  3806         COMPUTE DLA-LOSS-RATIO ROUNDED = WS-LOSS-RATIO           ECS046
  3807         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3808          (BA-EARN-COMP (2, SC) / BA-EARN-PREM (2, SC)) * +100    ECS046
  3809         COMPUTE DLA-COMP-RATIO ROUNDED = WS-COMP-RATIO           ECS046
  3810         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3811          (+1 - (WS-AH-UW-INCOME / BA-EARN-PREM (2, SC))) * +100  ECS046
  3812         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3813                                                                  ECS046
  3814     MOVE ' '                    TO X.                            ECS046
  3815     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3816     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3817     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3818                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS046.cbl
  3820     MOVE 'TOT'                  TO DLA-BEN-DESC.                 ECS046
  3821     COMPUTE DLA-NET-PREM ROUNDED =                               ECS046
  3822                BA-NET-PREM (1, SC) + BA-NET-PREM (2, SC).        ECS046
  3823     COMPUTE DLA-EARN-PREM ROUNDED =                              ECS046
  3824                BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC).      ECS046
  3825     COMPUTE DLA-CLMS-INCUR ROUNDED =                             ECS046
  3826                BA-CLMS-INCUR (1, SC) + BA-CLMS-INCUR (2, SC).    ECS046
  3827     COMPUTE DLA-EARN-COMP ROUNDED =                              ECS046
  3828                BA-EARN-COMP (1, SC) + BA-EARN-COMP (2, SC).      ECS046
  3829     COMPUTE DLA-SURPLUS ROUNDED = WS-AH-SURPLUS + WS-LF-SURPLUS. ECS046
  3830     COMPUTE DLA-RETENTION ROUNDED =                              ECS046
  3831                BA-RETENTION (1, SC) + BA-RETENTION (2, SC).      ECS046
  3832     COMPUTE DLA-PREM-PROFIT ROUNDED =                            ECS046
  3833                BA-PREM-PROFIT (1, SC) + BA-PREM-PROFIT (2, SC).  ECS046
  3834     COMPUTE DLA-PREM-TAX ROUNDED =                               ECS046
  3835                BA-PREM-TAX (1, SC) + BA-PREM-TAX (2, SC).        ECS046
  3836     COMPUTE DLA-UW-INCOME ROUNDED =                              ECS046
  3837                WS-LF-UW-INCOME + WS-AH-UW-INCOME.                ECS046
  3838                                                                  ECS046
  3839     IF BA-EARN-PREM (1, SC) = ZERO     AND                       ECS046
  3840        BA-EARN-PREM (2, SC) = ZERO                               ECS046
  3841         MOVE ZERO               TO DLA-LOSS-RATIO                ECS046
  3842                                    DLA-COMP-RATIO                ECS046
  3843                                    DLA-TOT-CHARGES               ECS046
  3844     ELSE                                                         ECS046
  3845         COMPUTE WS-LOSS-RATIO ROUNDED =                          ECS046
  3846          ((BA-CLMS-INCUR (1, SC) + BA-CLMS-INCUR (2, SC)) /      ECS046
  3847           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3848         COMPUTE WS-COMP-RATIO ROUNDED =                          ECS046
  3849          ((BA-EARN-COMP (1, SC) + BA-EARN-COMP (2, SC)) /        ECS046
  3850           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3851         COMPUTE WS-TOT-CHARGES ROUNDED =                         ECS046
  3852           (+1 - (WS-LF-UW-INCOME + WS-AH-UW-INCOME) /            ECS046
  3853           (BA-EARN-PREM (1, SC) + BA-EARN-PREM (2, SC))) * +100  ECS046
  3854         COMPUTE DLA-LOSS-RATIO ROUNDED  = WS-LOSS-RATIO          ECS046
  3855         COMPUTE DLA-COMP-RATIO ROUNDED  = WS-COMP-RATIO          ECS046
  3856         COMPUTE DLA-TOT-CHARGES ROUNDED = WS-TOT-CHARGES.        ECS046
  3857                                                                  ECS046
  3858     MOVE ' '                    TO X.                            ECS046
  3859     MOVE DTL-LINE-A             TO P-DATA.                       ECS046
  3860     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3861     MOVE SPACES                 TO DTL-LINE-A   P-DATA.          ECS046
  3862                                                                  ECS046
  3863     MOVE +1                     TO SB.                           ECS046
  3864     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3865         VARYING SE FROM 1 BY 1 UNTIL SE GREATER SC.              ECS046
  3866                                                                  ECS046
  3867     MOVE +2                     TO SB.                           ECS046
  3868     PERFORM 4400-ZERO-BREAK-ACCUMULATORS                         ECS046
  3869         VARYING SE FROM 1 BY 1 UNTIL SE GREATER SC.              ECS046
  3870                                                                  ECS046
  3871     MOVE ZERO                   TO LINE-CNT.                     ECS046
  3872                                                                  ECS046
  3873     IF WS-BREAK-SW NOT = 'F'                                     ECS046
  3874         PERFORM 4500-PRINT-HEADINGS.                             ECS046
  3875                                                                  ECS046
  3876     MOVE 'Y'                    TO WS-BREAK-SW.                  ECS046
  3877                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS046.cbl
  3879 4400-ZERO-BREAK-ACCUMULATORS.                                    ECS046
  3880     MOVE +0                     TO BA-NET-PREM      (SB, SE)     ECS046
  3881                                    BA-EARN-PREM     (SB, SE)     ECS046
  3882                                    BA-CLMS-INCUR    (SB, SE)     ECS046
  3883                                    BA-EARN-COMP     (SB, SE)     ECS046
  3884                                    BA-RETENTION     (SB, SE)     ECS046
  3885                                    BA-PREM-PROFIT   (SB, SE)     ECS046
  3886                                    BA-PREM-TAX      (SB, SE).    ECS046
  3887                                                                  ECS046
  3888 4500-PRINT-HEADINGS.                                             ECS046
  3889     IF DTE-CLIENT  =  'MON'                                      ECS046
  3890         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  3891             MOVE HOLD-ACTIVE-DESC                                ECS046
  3892                                 TO  HD-STATUS-DESC               ECS046
  3893         ELSE                                                     ECS046
  3894             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  3895     ELSE                                                         ECS046
  3896         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  3897                                                                  ECS046
  3898     MOVE '1'                    TO X.                            ECS046
  3899     MOVE HEAD-1                 TO P-DATA.                       ECS046
  3900     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3901     MOVE ' '                    TO X.                            ECS046
  3902     MOVE HEAD-2                 TO P-DATA.                       ECS046
  3903     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3904     ADD +1                      TO PAGE-CNT.                     ECS046
  3905     MOVE PAGE-CNT               TO HD-PAGE-NO.                   ECS046
  3906     MOVE HEAD-3                 TO P-DATA.                       ECS046
  3907     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3908                                                                  ECS046
  3909 4510-BUS-TYPE-HDR.                                               ECS046
  3910     IF DTE-TOT-OPT = 2                                           ECS046
  3911         MOVE SAVE-SWA-BUS-TYPE  TO HB-BUS-TYPE                   ECS046
  3912         PERFORM 4595-GET-BUS-DESC THRU 4595-EXIT                 ECS046
  3913         MOVE HEAD-BUS-TYPE      TO P-DATA                        ECS046
  3914         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3915         MOVE SPACES             TO P-DATA.                       ECS046
  3916                                                                  ECS046
  3917 4520-CARR-HDR.                                                   ECS046
  3918     IF DTE-TOT-OPT = 1 OR 2 OR 4 OR 5                            ECS046
  3919         PERFORM 4590-GET-CARRIER-NAME THRU 4590-EXIT             ECS046
  3920         MOVE HEAD-CARR          TO P-DATA                        ECS046
  3921         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3922         MOVE SPACES             TO P-DATA.                       ECS046
  3923                                                                  ECS046
  3924 4530-GROUP-HDR.                                                  ECS046
  3925     IF DTE-TOT-OPT = 1 OR 2 OR 4                                 ECS046
  3926         MOVE SAVE-SWA-GROUP     TO HG-GROUP                      ECS046
  3927         MOVE HEAD-GROUP         TO P-DATA                        ECS046
  3928         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3929         MOVE SPACES             TO P-DATA.                       ECS046
  3930                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS046.cbl
  3932 4540-STATE-HDR.                                                  ECS046
  3933     IF DTE-TOT-OPT = 1 OR 2                                      ECS046
  3934         MOVE SAVE-SWA-STATE     TO HS-STATE                      ECS046
  3935         MOVE HEAD-STATE         TO P-DATA                        ECS046
  3936         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3937         MOVE SPACES             TO P-DATA.                       ECS046
  3938                                                                  ECS046
  3939 4550-RPT-CD1-HDR.                                                ECS046
  3940     IF DTE-TOT-OPT = 3                                           ECS046
  3941         MOVE CLAS-REPORT-CD1-CAPTION TO HR-CAPTION               ECS046
  3942         MOVE SAVE-SWA-GA-OR-RPT-CD   TO HR-RPT-CODE              ECS046
  3943         MOVE HEAD-RPT-CODE           TO P-DATA                   ECS046
  3944         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3945         MOVE SPACES                  TO P-DATA.                  ECS046
  3946                                                                  ECS046
  3947 4560-RPT-CD2-HDR.                                                ECS046
  3948     IF DTE-TOT-OPT = 4                                           ECS046
  3949         MOVE CLAS-REPORT-CD2-CAPTION TO HR-CAPTION               ECS046
  3950         MOVE SAVE-SWA-GA-OR-RPT-CD   TO HR-RPT-CODE              ECS046
  3951         MOVE HEAD-RPT-CODE           TO P-DATA                   ECS046
  3952         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3953         MOVE SPACES                  TO P-DATA.                  ECS046
  3954                                                                  ECS046
  3955 4570-G-A-HDR.                                                    ECS046
  3956     IF DTE-TOT-OPT = 5                                           ECS046
  3957         MOVE SAVE-SWA-GA-OR-RPT-CD TO HGA-AGENT                  ECS046
  3958         MOVE HOLD-GA-NAME          TO  HGA-GA-NAME               ECS046
  3959         MOVE HEAD-G-A              TO P-DATA                     ECS046
  3960         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3961         MOVE SPACES                TO P-DATA.                    ECS046
  3962                                                                  ECS046
  3963 4575-RPT-CD1-2-HDR.                                              ECS046
  3964     IF DTE-TOT-OPT = 6                                           ECS046
  3965         MOVE SAVE-SWA-RPT-CD-1       TO HR2-RPT-CODE1            ECS046
  3966         MOVE SAVE-SWA-RPT-CD-2       TO HR2-RPT-CODE2            ECS046
  3967         MOVE HEAD-RPT2-CODE          TO P-DATA                   ECS046
  3968         PERFORM 4600-PRINT-ROUTINE                               ECS046
  3969         MOVE SPACES                  TO P-DATA.                  ECS046
  3970                                                                  ECS046
  3971 4580-DTL-HDRS.                                                   ECS046
  3972     MOVE '0'                    TO X.                            ECS046
  3973     MOVE HEAD-4A                TO P-DATA.                       ECS046
  3974     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3975     MOVE ' '                    TO X.                            ECS046
  3976     MOVE HEAD-5A                TO P-DATA.                       ECS046
  3977     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  3978                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS046.cbl
  3980 4590-GET-CARRIER-NAME.                                           ECS046
  3981     IF SAVE-SWA-CARR = HC-CARRIER                                ECS046
  3982         GO TO 4590-EXIT.                                         ECS046
  3983                                                                  ECS046
  3984     MOVE SAVE-SWA-CARR          TO HC-CARRIER.                   ECS046
  3985     PERFORM 4591-SRCH VARYING CLAS-INDEXCN FROM 1 BY 1           ECS046
  3986         UNTIL CLAS-INDEXCN GREATER CLAS-MAXCN OR                 ECS046
  3987               SAVE-SWA-CARR = CARRIER-SUB (CLAS-INDEXCN).        ECS046
  3988                                                                  ECS046
  3989     IF CLAS-INDEXCN GREATER CLAS-MAXCN                           ECS046
  3990         MOVE SPACE                      TO HC-CARRIER-NAME       ECS046
  3991     ELSE                                                         ECS046
  3992         MOVE CARRIER-PIC (CLAS-INDEXCN) TO HC-CARRIER-NAME.      ECS046
  3993                                                                  ECS046
  3994 4590-EXIT.                                                       ECS046
  3995      EXIT.                                                       ECS046
  3996                                                                  ECS046
  3997 4591-SRCH.                                                       ECS046
  3998      EXIT.                                                       ECS046
  3999                                                                  ECS046
  4000 4595-GET-BUS-DESC.                                               ECS046
  4001     IF SAVE-SWA-BUS-TYPE = HB-BUS-TYPE                           ECS046
  4002         GO TO 4595-EXIT.                                         ECS046
  4003                                                                  ECS046
  4004     MOVE SAVE-SWA-BUS-TYPE      TO HB-BUS-TYPE.                  ECS046
  4005     PERFORM 4596-SRCH VARYING CLAS-INDEXB FROM 1 BY 1            ECS046
  4006         UNTIL CLAS-INDEXB GREATER CLAS-MAXB OR                   ECS046
  4007               SAVE-SWA-BUS-TYPE = CLAS-BUSC-CODE (CLAS-INDEXB).  ECS046
  4008                                                                  ECS046
  4009     IF CLAS-INDEXB GREATER CLAS-MAXB                             ECS046
  4010         MOVE SPACE                        TO HB-BUS-DESC         ECS046
  4011     ELSE                                                         ECS046
  4012         MOVE CLAS-BUSC-DESC (CLAS-INDEXB) TO HB-BUS-DESC.        ECS046
  4013                                                                  ECS046
  4014 4595-EXIT.                                                       ECS046
  4015      EXIT.                                                       ECS046
  4016                                                                  ECS046
  4017 4596-SRCH.                                                       ECS046
  4018      EXIT.                                                       ECS046
  4019                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS046.cbl
  4021 4600-PRINT-ROUTINE.                                              ECS046
* 4022                             COPY ELCPRT2.                        ECS046
  4023******************************************************************04/15/98
  4024*                                                                *ELCPRT2
  4025*                                                                *ELCPRT2
  4026*                            ELCPRT2                             *   LV005
  4027*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  4028*                            VMOD=2.002                          *   CL**5
  4029*                                                                *   CL**4
  4030******************************************************************   CL**4
  4031                                                                     CL**4
  4032     IF DTE-FICH NOT = SPACE AND                                     CL**4
  4033        FICH-OPEN    = SPACE                                         CL**4
  4034         MOVE 'X'                TO  FICH-OPEN                       CL**4
  4035         OPEN OUTPUT FICH.                                           CL**4
  4036                                                                     CL**4
  4037     IF DTE-FICH NOT = SPACE                                         CL**4
  4038         MOVE X                  TO  P-CTL                           CL**4
  4039         WRITE FICH-REC FROM PRT.                                    CL**4
  4040                                                                     CL**4
  4041     IF DTE-FICH = SPACE OR '2'                                      CL**4
  4042       MOVE X                    TO  P-CTL                           CL**4
  4043       IF P-CTL = ' '                                                CL**4
  4044         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  4045       ELSE                                                          CL**4
  4046         IF P-CTL = '0'                                              CL**4
  4047           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  4048         ELSE                                                        CL**4
  4049           IF P-CTL = '-'                                            CL**4
  4050             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  4051           ELSE                                                      CL**4
  4052             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  4053                                                                     CL**4
  4054******************************************************************   CL**4
  4055                                                                  ECS046
  4056     IF X = '0'                                                   ECS046
  4057         ADD +2                  TO LINE-CNT                      ECS046
  4058     ELSE                                                         ECS046
  4059         ADD +1                  TO LINE-CNT.                     ECS046
  4060                                                                  ECS046
  4061     MOVE SPACES                 TO P-DATA.                       ECS046
  4062                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS046.cbl
  4064 5000-PRINT-REPORT-B   SECTION.                                   ECS046
  4065                                                                  ECS046
  4066     IF NO-OF-RECORDS-RELEASED = +0                               ECS046
  4067         GO TO 5990-PRINT-RPT-B-EXIT.                             ECS046
  4068                                                                  ECS046
  4069     MOVE ZERO                   TO PAGE-CNT.                     ECS046
  4070                                                                  ECS046
  4071     IF DTE-FMT-OPT = 2                                           ECS046
  4072         MOVE '- LOSS RATIO SEQUENCE'    TO HD-RPT-TYPE.          ECS046
  4073                                                                  ECS046
  4074     IF DTE-FMT-OPT = 3                                           ECS046
  4075         MOVE '- TOTAL CHARGES SEQUENCE' TO HD-RPT-TYPE.          ECS046
  4076                                                                  ECS046
  4077     IF DTE-FMT-OPT = 4                                           ECS046
  4078         MOVE '- WRITTEN SEQUENCE'       TO HD-RPT-TYPE.          ECS046
  4079                                                                  ECS046
  4080     IF DTE-FMT-OPT = 5                                           ECS046
  4081         MOVE '- PROFIT SEQUENCE'        TO HD-RPT-TYPE.          ECS046
  4082                                                                  ECS046
  4083     MOVE 'B'                            TO H1-REPORT-SUF.        ECS046
  4084                                                                  ECS046
  4085     PERFORM 6500-PRINT-HEADINGS.                                 ECS046
  4086                                                                  ECS046
  4087 5100-RETURN-SORT-WORK-B.                                         ECS046
  4088     RETURN SORT-WORK-B  INTO SWB-REC  AT END                     ECS046
  4089         GO TO 5990-PRINT-RPT-B-EXIT.                             ECS046
  4090                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS046.cbl
  4092 5200-BUILD-DTL-LINE-B.                                           ECS046
  4093     IF LINE-CNT GREATER +54                                      ECS046
  4094         MOVE ZERO               TO LINE-CNT                      ECS046
  4095         PERFORM 6500-PRINT-HEADINGS.                             ECS046
  4096                                                                  ECS046
  4097     ADD +1                      TO WS-SEQUENCE.                  ECS046
  4098     MOVE WS-SEQUENCE            TO DLB-SEQ-NO.                   ECS046
  4099     MOVE SWB-LOSS-RATIO         TO DLB-LOSS-RATIO.               ECS046
  4100     COMPUTE DLB-NET-PREM ROUNDED = SWB-NET-PREM.                 ECS046
  4101     MOVE SWB-TOT-CHARGES        TO DLB-TOT-CHARGES.              ECS046
  4102     COMPUTE DLB-PREM-PROFIT ROUNDED = SWB-PREM-PROFIT.           ECS046
  4103                                                                  ECS046
  4104     MOVE SWB-ACCT               TO DLB-ACCOUNT.                  ECS046
  4105     MOVE SWB-NAME               TO DLB-ACCT-NAME.                ECS046
  4106                                                                  ECS046
  4107     IF DTE-TOT-OPT = 1                                           ECS046
  4108         MOVE SWB-CARR           TO DLB-CARRIER                   ECS046
  4109         MOVE SWB-GROUP          TO DLB-GROUP                     ECS046
  4110         MOVE SWB-STATE          TO DLB-STATE.                    ECS046
  4111                                                                  ECS046
  4112     IF DTE-TOT-OPT = 2                                           ECS046
  4113         MOVE SWB-BUS-TYPE       TO DLB-BUS-TYPE                  ECS046
  4114         MOVE SWB-CARR           TO DLB-CARRIER                   ECS046
  4115         MOVE SWB-GROUP          TO DLB-GROUP                     ECS046
  4116         MOVE SWB-STATE          TO DLB-STATE.                    ECS046
  4117                                                                  ECS046
  4118     IF DTE-TOT-OPT = 3                                           ECS046
  4119         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4120                                                                  ECS046
  4121     IF DTE-TOT-OPT = 4                                           ECS046
  4122         MOVE SWB-CARR           TO DLB2-CARRIER                  ECS046
  4123         MOVE SWB-GROUP          TO DLB2-GROUP                    ECS046
  4124         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4125                                                                  ECS046
  4126     IF DTE-TOT-OPT = 5                                           ECS046
  4127         MOVE SWB-CARR           TO DLB2-CARRIER                  ECS046
  4128         MOVE SWB-GA-OR-RPT-CD   TO DLB2-GA-OR-RPT-CD.            ECS046
  4129                                                                  ECS046
  4130     MOVE ' '                    TO X.                            ECS046
  4131     MOVE DTL-LINE-B             TO P-DATA.                       ECS046
  4132     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4133     MOVE SPACES                 TO DTL-LINE-B   P-DATA.          ECS046
  4134                                                                  ECS046
  4135     GO TO 5100-RETURN-SORT-WORK-B.                               ECS046
  4136                                                                  ECS046
  4137 5990-PRINT-RPT-B-EXIT.                                           ECS046
  4138     CLOSE PRNTR.                                                 ECS046
  4139                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS046.cbl
  4141 6000-PERFORMED-RPT-B-ROUTINES   SECTION.                         ECS046
  4142                                                                  ECS046
  4143 6500-PRINT-HEADINGS.                                             ECS046
  4144     IF DTE-CLIENT  =  'MON'                                      ECS046
  4145         IF WS-ACTIVE-INDIC  =  'ACTIVE'                          ECS046
  4146             MOVE HOLD-ACTIVE-DESC                                ECS046
  4147                                 TO  HD-STATUS-DESC               ECS046
  4148         ELSE                                                     ECS046
  4149             MOVE HOLD-ALL-DESC  TO  HD-STATUS-DESC               ECS046
  4150     ELSE                                                         ECS046
  4151         MOVE SPACES             TO  HD-STATUS-DESC.              ECS046
  4152                                                                  ECS046
  4153     MOVE '1'                    TO X.                            ECS046
  4154     MOVE HEAD-1                 TO P-DATA.                       ECS046
  4155     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4156     MOVE ' '                    TO X.                            ECS046
  4157     MOVE HEAD-2                 TO P-DATA.                       ECS046
  4158     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4159     ADD +1                      TO PAGE-CNT.                     ECS046
  4160     MOVE PAGE-CNT               TO HD-PAGE-NO.                   ECS046
  4161     MOVE HEAD-3                 TO P-DATA.                       ECS046
  4162     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4163     MOVE SPACES                 TO H4B-BUS                       ECS046
  4164                                    H4B-GENERAL.                  ECS046
  4165                                                                  ECS046
  4166     IF DTE-TOT-OPT = 1                                           ECS046
  4167         MOVE '         CARR'    TO H5B-CTL-HDA                   ECS046
  4168         MOVE 'GROUP    STATE'   TO H5B-CTL-HDB.                  ECS046
  4169                                                                  ECS046
  4170     IF DTE-TOT-OPT = 2                                           ECS046
  4171         MOVE 'BUS'              TO H4B-BUS                       ECS046
  4172         MOVE '   TYPE  CARR'    TO H5B-CTL-HDA                   ECS046
  4173         MOVE 'GROUP    STATE'   TO H5B-CTL-HDB.                  ECS046
  4174                                                                  ECS046
  4175     IF DTE-TOT-OPT = 3                                           ECS046
  4176         MOVE SPACES                  TO H5B-CTL-HDA              ECS046
  4177         MOVE CLAS-REPORT-CD1-CAPTION TO H5B-CTL-HDB.             ECS046
  4178                                                                  ECS046
  4179     IF DTE-TOT-OPT = 4                                           ECS046
  4180         MOVE 'CARR  GROUP'           TO H5B-CTL-HDA              ECS046
  4181         MOVE CLAS-REPORT-CD2-CAPTION TO H5B-CTL-HDB.             ECS046
  4182                                                                  ECS046
  4183     IF DTE-TOT-OPT = 5                                           ECS046
  4184         MOVE 'GENERAL'          TO H4B-GENERAL                   ECS046
  4185         MOVE 'CARR'             TO H5B-CTL-HDA                   ECS046
  4186         MOVE '  AGENT'          TO H5B-CTL-HDB.                  ECS046
  4187                                                                  ECS046
  4188     MOVE '0'                    TO X.                            ECS046
  4189     MOVE HEAD-4B                TO P-DATA.                       ECS046
  4190     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4191     MOVE ' '                    TO X.                            ECS046
  4192     MOVE HEAD-5B                TO P-DATA.                       ECS046
  4193     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4194     MOVE ' '                    TO X.                            ECS046
  4195     MOVE SPACES                 TO P-DATA.                       ECS046
  4196     PERFORM 4600-PRINT-ROUTINE.                                  ECS046
  4197                                                                  ECS046
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS046.cbl
  4199 9000-JOB-CLEANUP  SECTION.                                       ECS046
  4200                                                                  ECS046
  4201 9100-E-O-J.                                                      ECS046
  4202     CLOSE PRNTR.                                                 ECS046
  4203                                                                  ECS046
  4204 9200-CLOSE-FICH.                                                 ECS046
* 4205                             COPY ELCPRTC.                        ECS046
  4206******************************************************************04/15/98
  4207*                                                                *ELCPRTC
  4208*                                                                *ELCPRTC
  4209*                            ELCPRTC.                            *   LV003
  4210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4211*                            VMOD=2.002                          *   CL**2
  4212*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  4213*                                                                *ELCPRTC
  4214* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  4215******************************************************************ELCPRTC
  4216                                                                  ELCPRTC
  4217      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  4218          CLOSE FICH.                                             ELCPRTC
  4219                                                                  ELCPRTC
  4220******************************************************************ELCPRTC
  4221                                                                  ECS046
  4222 ABEND-PGM SECTION.                                               ECS046
* 4223                             COPY ELCABEND.                       ECS046
  4224***************************************************************** 04/14/98
  4225*                                                               * ELCABEND
  4226*                            ELCABEND.                          *    LV003
  4227*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  4228*                            VMOD 2.002                              CL**2
  4229*                                                               * ELCABEND
  4230*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  4231*            AND THEN ABENDS.                                   * ELCABEND
  4232*                                                               * ELCABEND
  4233*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  4234*                                                               * ELCABEND
  4235***************************************************************** ELCABEND
  4236*APS-010.                                                         ELCABEND
  4237     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  4238     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  4239                                                                  ELCABEND
  4240     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  4241         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4242         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  4243                                 UPON CONSOLE.                    ELCABEND
  4244                                                                  ELCABEND
  4245     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  4246         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4247         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  4248                                 UPON CONSOLE.                    ELCABEND
  4249                                                                  ELCABEND
  4250     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4251     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  4252                                 UPON CONSOLE.                    ELCABEND
  4253                                                                  ELCABEND
  4254     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  4255     CALL 'ABORTME'.
  4256                                                                  ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS046.cbl (/apps/prod/cid1p/copy/ELCABEND)
  4257 APS-EXIT.                                                        ELCABEND
  4258     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       56456     Code:       17391
