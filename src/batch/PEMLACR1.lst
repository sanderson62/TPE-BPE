* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMLACR1.cbl
* Options: int("PEMLACR1.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMLACR1.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMLACR1.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "PEMLACR1.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    PEMLACR1.
     3*AUTHOR.        PABLO.
     4*               COLLEYVILE TEXAS.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT REPORT-EXT           ASSIGN TO SYS011
    10            ORGANIZATION IS LINE SEQUENTIAL.
    11     SELECT ERARCH-IN ASSIGN TO ARCHIN.
    12
    13 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMLACR1.cbl
    14 FILE SECTION.
    15
    16 FD  REPORT-EXT
    17     BLOCK CONTAINS 0 RECORDS
    18     RECORDING MODE IS F.
    19
    20 01  REPORT-RECORD               PIC X(90).
    21
    22 FD  ERARCH-IN
    23     BLOCK CONTAINS 0 RECORDS
    24     RECORDING MODE F.
    25
*   26                                 COPY ERCARCH.
    27******************************************************************04/19/98
    28*                                                                *ERCARCH
    29*                            ERCARCH.                            *   LV002
    30*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    31*                            VMOD=2.002                          *   CL**2
    32*                                                                *ERCARCH
    33*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *ERCARCH
    34*                                                                *ERCARCH
    35*   FILE TYPE = VSAM,KSDS                                        *ERCARCH
    36*   RECORD SIZE = 250  RECFORM = FIXED                           *ERCARCH
    37*                                                                *ERCARCH
    38*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *ERCARCH
    39*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *ERCARCH
    40*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *ERCARCH
    41*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *ERCARCH
    42*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *ERCARCH
    43*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *ERCARCH
    44*                                                                *ERCARCH
    45*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCARCH
    46******************************************************************ERCARCH
    47*                   C H A N G E   L O G
    48*
    49* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    50*-----------------------------------------------------------------
    51*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    52* EFFECTIVE    NUMBER
    53*-----------------------------------------------------------------
    54* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    55* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
    56* 110612    2012101700002  AJRA  ADD NEW FIELDS
    57******************************************************************
    58 01  LETTER-ARCHIVE.                                              ERCARCH
    59     12  LA-RECORD-ID                PIC  X(02).                  ERCARCH
    60         88  LA-VALID-ID                VALUE 'LA'.               ERCARCH
    61                                                                  ERCARCH
    62     12  LA-CONTROL-PRIMARY.                                      ERCARCH
    63         16  LA-COMPANY-CD           PIC  X(01).                  ERCARCH
    64         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.          ERCARCH
    65                                                                  ERCARCH
    66     12  LA-CONTROL-BY-CERT-RESP.                                 ERCARCH
    67         16  LA-COMPANY-CD-A2        PIC  X(01).                  ERCARCH
    68         16  LA-CERT-NO-A2.                                       ERCARCH
    69             20  LA-CERT-PRIME-A2    PIC  X(10).                  ERCARCH
    70             20  LA-CERT-SUFFIX-A2   PIC  X(01).                  ERCARCH
    71         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.            ERCARCH
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ERCARCH)
    72             20  LA-RESP-PERSON-A2   PIC  X(10).                  ERCARCH
    73             20  LA-TYPE-A2          PIC  X(01).                  ERCARCH
    74         16  LA-CARRIER-A2           PIC  X(01).                  ERCARCH
    75         16  LA-GROUPING-A2          PIC  X(06).                  ERCARCH
    76         16  LA-STATE-A2             PIC  X(02).                  ERCARCH
    77         16  LA-ACCOUNT-A2           PIC  X(10).                  ERCARCH
    78         16  LA-EFFECT-DATE-A2       PIC  X(02).                  ERCARCH
    79         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.          ERCARCH
    80                                                                  ERCARCH
    81     12  LA-CONTROL-BY-FORM.                                      ERCARCH
    82         16  LA-COMPANY-CD-A3        PIC  X(01).                  ERCARCH
    83         16  LA-FORM-A3              PIC  X(04).                  ERCARCH
    84         16  LA-CARRIER-A3           PIC  X(01).                  ERCARCH
    85         16  LA-GROUPING-A3          PIC  X(06).                  ERCARCH
    86         16  LA-STATE-A3             PIC  X(02).                  ERCARCH
    87         16  LA-ACCOUNT-A3           PIC  X(10).                  ERCARCH
    88         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.          ERCARCH
    89                                                                  ERCARCH
    90     12  LA-CONTROL-BY-PROCESSOR.                                 ERCARCH
    91         16  LA-COMPANY-CD-A4        PIC  X(01).                  ERCARCH
    92         16  LA-PROCESSOR-CD         PIC  X(04).                  ERCARCH
    93         16  LA-CARRIER-A4           PIC  X(01).                  ERCARCH
    94         16  LA-GROUPING-A4          PIC  X(06).                  ERCARCH
    95         16  LA-STATE-A4             PIC  X(02).                  ERCARCH
    96         16  LA-ACCOUNT-A4           PIC  X(10).                  ERCARCH
    97         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.          ERCARCH
    98                                                                  ERCARCH
    99     12  LA-CONTROL-BY-KEY-FIELDS.                                ERCARCH
   100         16  LA-COMPANY-CD-A5        PIC  X(01).                  ERCARCH
   101         16  LA-CARRIER-A5           PIC  X(01).                  ERCARCH
   102         16  LA-GROUPING-A5          PIC  X(06).                  ERCARCH
   103         16  LA-STATE-A5             PIC  X(02).                  ERCARCH
   104         16  LA-ACCOUNT-A5           PIC  X(10).                  ERCARCH
   105         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.          ERCARCH
   106                                                                  ERCARCH
   107     12  LA-CONTROL-BY-GROUP-CODE.                                ERCARCH
   108         16  LA-COMPANY-CD-A6        PIC  X(01).                  ERCARCH
   109         16  LA-ENTRY-A6.                                         ERCARCH
   110             20  LA-FILLER           PIC  X(02).                  ERCARCH
   111             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.          ERCARCH
   112         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.          ERCARCH
   113                                                                  ERCARCH
   114     12  FILLER                      PIC  X(09).                  ERCARCH
   115                                                                  ERCARCH
   116     12  LA-HEADER-RECORD.                                        ERCARCH
   117         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.          ERCARCH
   118         16  LA-CREATION-DATE        PIC  X(02).                  ERCARCH
   119         16  LA-FOLLOW-UP-DATE       PIC  X(02).                  ERCARCH
   120         16  LA-FINAL-ACT-DATE       REDEFINES
   121               LA-FOLLOW-UP-DATE     PIC  X(02).
   122         16  LA-INITIAL-PRINT-DATE   PIC  X(02).                  ERCARCH
   123         16  LA-NO-OF-COPIES         PIC S9(01).                  ERCARCH
   124         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.          ERCARCH
   125         16  LA-REPLY-DATE           PIC  X(02).                  ERCARCH
   126         16  LA-RESEND-DATES.                                     ERCARCH
   127             20  LA-RESEND-DATE      PIC  X(02).                  ERCARCH
   128             20  LA-SENT-DATE        PIC  X(02).                  ERCARCH
   129             20  FILLER              PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ERCARCH)
   130         16  LA-SOURCE-INFORMATION.                               ERCARCH
   131             20  LA-DATA-SOURCE      PIC  X(01).                  ERCARCH
   132             20  LA-ADDR-SOURCE      PIC  X(01).                  ERCARCH
   133         16  LA-STATUS               PIC  X(01).                  ERCARCH
   134             88  LA-STATUS-ACTIVE         VALUE 'A'.              ERCARCH
   135             88  LA-STATUS-COMPLETED      VALUE 'C'.              ERCARCH
   136             88  LA-STATUS-ON-HOLD        VALUE 'H'.              ERCARCH
   137             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.              ERCARCH
   138             88  LA-STATUS-PURGED         VALUE 'P'.              ERCARCH
   139             88  LA-STATUS-VOIDED         VALUE 'V'.              ERCARCH
   140         16  LA-LAST-RESENT-PRINT-DATE                            ERCARCH
   141                                     PIC  X(02).                  ERCARCH
   142         16  LA-PRINT-RESTRICTION    PIC  X(01).                  ERCARCH
   143             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN                    ERCARCH
   144                                          VALUE 'C'.              ERCARCH
   145             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN                    ERCARCH
   146                                          VALUE 'F'.              ERCARCH
   147             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN                    ERCARCH
   148                                          VALUE 'P'.              ERCARCH
   149         16  LA-PURGED-DATE          PIC  X(02).                  ERCARCH
   150         16  LA-VOIDED-DATE          PIC  X(02).
   151         16  LA-RESEND-LETR          PIC  X(4).
   152         16  FILLER                  PIC  X(08).
   153*        16  LA-RESEND-LETR-2        PIC  X(4).
   154*        16  LA-RESEND-LETR-3        PIC  X(4).
   155*        16  FILLER                  PIC  X(59).
   156         16  LA-ARCHIVE-STATUS       PIC  X.
   157             88  LA-TEMP                VALUE 'T'.
   158             88  LA-QWS                 VALUE 'Q'.
   159             88  LA-BATCH               VALUE 'B'.
   160         16  LA-FINAL-ACT-IND        PIC  X(1).
   161         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
   162         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
   163         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
   164                                     PIC X(4).
   165         16  FILLER                  PIC  X(42).
   166*        16  FILLER                  PIC  X(71).                  ERCARCH
   167         16  LA-LAST-MAINT-DATE      PIC  X(2).
   168         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
   169         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
   170                                     PIC  X(4).
   171         16  LA-LAST-UPDATED-BY      PIC  X(4).
   172                                                                  ERCARCH
   173******************************************************************ERCARCH
   174
   175 WORKING-STORAGE SECTION.
   176 77  FILLER  PIC X(32) VALUE '********************************'.
   177 77  FILLER  PIC X(32) VALUE '   PEMLACR1  WORKING STORAGE    '.
   178 77  FILLER  PIC X(32) VALUE '*********VMOD=2.001*************'.
   179 77  WS-NOV-PRINT                PIC 9(7) VALUE ZEROS.
   180 77  WS-NOV-REPRINT              PIC 9(7) VALUE ZEROS.
   181 77  WS-DEC-PRINT                PIC 9(7) VALUE ZEROS.
   182 77  WS-DEC-REPRINT              PIC 9(7) VALUE ZEROS.
   183 77  WS-JAN-PRINT                PIC 9(7) VALUE ZEROS.
   184 77  WS-JAN-REPRINT              PIC 9(7) VALUE ZEROS.
   185
   186 01  WS-HEAD-LINE.
   187     05  FILLER                  PIC X(25) VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* PEMLACR1.cbl
   188      ' CAR  CLM NO   CERT NO   '.
   189     05  FILLER                  PIC X(35) VALUE
   190      ' NC  RE DT   PROC   CR DT   PRT DT '.
   191     05  FILLER                  PIC X(29) VALUE
   192      '  RES PRT   TRLR ARCH NO  CNT'.
   193
   194
   195 01  WS-DETAIL-LINE.
   196     05  FILLER                  PIC XX   VALUE SPACES.
   197     05  D1-CARRIER              PIC XXX.
   198     05  D1-ACCT-NO              PIC X(8).
   199     05  D1-CERT-NO              PIC X(12).
   200     05  D1-NOC                  PIC ZZ9.
   201     05  FILLER                  PIC XX.
   202     05  D1-RESENT1-DATE         PIC X(9).
   203     05  D1-PROCESSOR-CD         PIC X(5).
   204     05  D1-CREATION-DT          PIC X(9).
   205     05  D1-INITIAL-PRINT-DATE   PIC X(9).
   206     05  D1-RESEND-PRINT-DATE    PIC X(9).
   207     05  D1-CORR-TRLR-SEQ        PIC Z9999.
   208     05  D1-ARCH-NO              PIC Z9999999.
   209     05  D1-ARCH-CNT             PIC ZZ99.
   210
   211 01  WS-FORM-INFO.
   212     05  WS-CARRIER              PIC X.
   213     05  WS-CLAIM-NO             PIC X(7).
   214     05  WS-CERT-NO              PIC X(11).
   215     05  WS-NO-OF-COPIES         PIC S9.
   216     05  WS-RESEND-DATE          PIC XX.
   217     05  WS-PROCESSOR-CD         PIC X(4).
   218     05  WS-CREATION-DT          PIC XX.
   219     05  WS-INITIAL-PRINT-DATE   PIC XX.
   220     05  WS-RESEND-PRINT-DATE    PIC XX.
   221     05  WS-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   222     05  WS-1ST-RESEND-PRINT-DT  PIC XX.
   223
   224 01  SV-FORM-INFO.
   225     05  SV-CARRIER              PIC X.
   226     05  SV-CLAIM-NO             PIC X(7).
   227     05  SV-CERT-NO              PIC X(11).
   228     05  SV-NO-OF-COPIES         PIC S9.
   229     05  SV-RESEND-DATE          PIC XX.
   230     05  SV-PROCESSOR-CD         PIC X(4).
   231     05  SV-CREATION-DT          PIC XX.
   232     05  SV-INITIAL-PRINT-DATE   PIC XX.
   233     05  SV-RESEND-PRINT-DATE    PIC XX.
   234     05  SV-CORR-TRLR-SEQ        PIC S9(4)    COMP.
   235     05  SV-1ST-RESEND-PRINT-DT  PIC XX.
   236
   237 01  MISC.
   238     12  WS-SPACES               PIC X(5)  VALUE SPACES.
   239     12  QSAM-IN-CNT             PIC 9(11) VALUE ZEROS.
   240     12  WS-ARCH-CNT             PIC S9(5) COMP-3 VALUE +0.
   241     12  REC-1-CNT               PIC 9(9) VALUE ZEROS.
   242     12  REC-2-CNT               PIC 9(9) VALUE ZEROS.
   243     12  REC-3-CNT               PIC 9(9) VALUE ZEROS.
   244     12  REC-4-CNT               PIC 9(9) VALUE ZEROS.
   245     12  REC-O-CNT               PIC 9(9) VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* PEMLACR1.cbl
   246     12  WS-DISPLAY-ARCH-CNT     PIC ZZ,Z99 VALUE ZEROS.
   247     12  WS-DISPLAY-ARCH-NO      PIC 9(7) VALUE ZEROS.
   248     12  WS-SAVE-ARCH-NO         PIC S9(8) COMP VALUE +0.
   249     12  WS-ERARCH-SW            PIC X VALUE ' '.
   250         88  END-OF-ERARCH             VALUE 'Y'.
   251
   252     12  WS-RETURN-CODE      PIC X(4)            VALUE ZEROS.     EL545
   253     12  ABEND-OPTION        PIC X               VALUE 'Y'.       EL545
   254     12  WS-ABEND-MESSAGE    PIC X(80)           VALUE SPACES.    EL545
   255     12  WS-ABEND-FILE-STATUS PIC XX             VALUE SPACES.    EL545
   256     12  WS-ZERO             PIC S9              VALUE ZERO.      EL545
   257     12  PGM-SUB             PIC S999    COMP-3  VALUE +545.      EL545
   258
*  259                                 COPY ELCDATE.
   260******************************************************************06/11/98
   261*                                                                *ELCDATE
   262*                                                                *ELCDATE
   263*                            ELCDATE.                            *   LV023
   264*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   265*                            VMOD=2.003                           ELCDATE
   266*                                                                *ELCDATE
   267*                                                                *ELCDATE
   268*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   269*                 LENGTH = 200                                   *   CL*19
   270******************************************************************ELCDATE
   271                                                                  ELCDATE
   272 01  DATE-CONVERSION-DATA.                                        ELCDATE
   273     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   274     12  DC-OPTION-CODE                PIC X.                        CL*15
   275         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   276         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   277         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   278         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   279         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   280         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   281         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   282         88  FIND-CENTURY               VALUE '7'.                   CL*22
   283         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   284         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   285         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   286         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   287         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   288         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   289         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   290         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   291         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   292         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   293         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   294         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   295         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   296         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   297         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   298         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   299         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   300         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   301         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   302         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   303         88  THREE-CHARACTER-BIN                                  ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   304                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   305         88  GREGORIAN-TO-BIN                                        CL**2
   306                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   307         88  BIN-TO-GREGORIAN                                        CL**2
   308                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   309         88  JULIAN-TO-BINARY                                        CL**2
   310                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   311     12  DC-ERROR-CODE                 PIC X.                        CL*15
   312         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   313         88  DATE-CONVERSION-ERROR                                ELCDATE
   314                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   315         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   316         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   317         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   318         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   319         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   320         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   321         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   322         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   323         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   324         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   325     12  DC-END-OF-MONTH               PIC X.                        CL*15
   326         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   327     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   328         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   329         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   330         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   331     12  FILLER                        PIC X.                        CL*15
   332     12  DC-CONVERSION-DATES.                                        CL*15
   333         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   334         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   335         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   336         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   337                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   338             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   339             20  SLASH1-1              PIC X.                        CL*15
   340             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   341             20  SLASH1-2              PIC X.                        CL*15
   342             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   343         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   344         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   345                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   346             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   347             20  SLASH2-1              PIC X.                        CL*15
   348             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   349             20  SLASH2-2              PIC X.                        CL*15
   350             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   351         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   352         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   353                     DC-GREG-DATE-1-YMD.                          ELCDATE
   354             20  DC-YMD-YEAR           PIC 99.                       CL*15
   355             20  DC-YMD-MONTH          PIC 99.                       CL*15
   356             20  DC-YMD-DAY            PIC 99.                       CL*15
   357         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   358         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   359                      DC-GREG-DATE-1-MDY.                         ELCDATE
   360             20  DC-MDY-MONTH          PIC 99.                       CL*15
   361             20  DC-MDY-DAY            PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   362             20  DC-MDY-YEAR           PIC 99.                       CL*15
   363         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   364             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   365             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   366             20  FILLER                PIC XX.                       CL*15
   367             20  DC-ALPHA-CENTURY.                                   CL*15
   368                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   369             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   370         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   371         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   372         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   373         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   374         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   375                                       PIC 9(05).                    CL*20
   376         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   377             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   378             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   379         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   380         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   381         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   382     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   383         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   384         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   385             20  FILLER                PIC 9(3).                     CL*15
   386             20  HOLD-CEN-1-CCYY.                                    CL*15
   387                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   388                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   389             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   390             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   391         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   392             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   393             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   394             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   395                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   396                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   397             20  FILLER                PIC 9(3).                     CL*15
   398         16  HOLD-CENTURY-1-X.                                       CL*15
   399             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   400             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   401                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   402                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   403             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   404             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   405         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   406             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   407             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   408             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   409                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   410                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   411             20  FILLER                PIC XXX.                      CL*23
   412         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   413         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   414         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   415         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   416             20  DC-JULIAN-1-CCYY.                                   CL*15
   417                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   418                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   419             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ELCDATE)
   420         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   421         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   422             20  DC-JULIAN-2-CCYY.                                   CL*15
   423                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   424                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   425             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   426         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   427             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   428             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   429             20  DC-EDITA-DAY          PIC 99.                       CL*15
   430             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   431             20  DC-EDITA-CCYY.                                      CL*15
   432                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   433                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   434         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   435             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   436             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   437             20  DC-EDITB-DAY          PIC 99.                       CL*15
   438             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   439             20  DC-EDITB-CCYY.                                      CL*15
   440                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   441                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   442         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   443         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   444                              DC-GREG-DATE-CYMD.                  ELCDATE
   445             20  DC-CYMD-CEN           PIC 99.                       CL*15
   446             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   447             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   448             20  DC-CYMD-DAY           PIC 99.                       CL*15
   449         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   450         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   451                              DC-GREG-DATE-MDCY.                  ELCDATE
   452             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   453             20  DC-MDCY-DAY           PIC 99.                       CL*15
   454             20  DC-MDCY-CEN           PIC 99.                       CL*15
   455             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   456    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   457        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   458    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   459    12  FILLER                         PIC X(28).                    CL*26
   460
   461 PROCEDURE DIVISION.
   462
   463 0000-BEGIN-PROGRAM.
   464
   465     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
   466     PERFORM 0020-INIT           THRU 0020-EXIT
   467
   468     PERFORM 0140-PROCESS        THRU 0140-EXIT UNTIL
   469        (END-OF-ERARCH)
   470*       OR (REC-3-CNT > 1000000)
   471
   472     PERFORM 0200-CLOSE-FILES    THRU 0200-EXIT
   473
   474     DISPLAY ' TOTAL RECORDS READ   ' QSAM-IN-CNT
   475     DISPLAY ' HEADER RECORDS   1   ' REC-1-CNT
   476     DISPLAY ' ADDRESS RECORDS  2   ' REC-2-CNT
   477     DISPLAY ' TEXT RECORDS     3   ' REC-3-CNT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* PEMLACR1.cbl
   478     DISPLAY ' FORM CNTRL HDR   4   ' REC-4-CNT
   479     DISPLAY ' ULAR             ?   ' REC-O-CNT
   480
   481     DISPLAY SPACES
   482     DISPLAY ' NOV 08 PRINT         ' WS-NOV-PRINT
   483     DISPLAY ' NOV 08 REPRINTS      ' WS-NOV-REPRINT
   484     DISPLAY ' DEC 08 PRINT         ' WS-DEC-PRINT
   485     DISPLAY ' DEC 08 REPRINTS      ' WS-DEC-REPRINT
   486     DISPLAY ' JAN 09 PRINT         ' WS-JAN-PRINT
   487     DISPLAY ' JAN 09 REPRINTS      ' WS-JAN-REPRINT
   488
   489     GOBACK
   490
   491     .
   492 0010-OPEN-FILES.
   493
   494     OPEN  INPUT ERARCH-IN
   495          OUTPUT REPORT-EXT
   496
   497     .
   498 0010-EXIT.
   499     EXIT.
   500
   501 0020-INIT.
   502
   503     MOVE ZEROS                  TO QSAM-IN-CNT
   504
   505     WRITE REPORT-RECORD         FROM WS-HEAD-LINE
   506
   507     WRITE REPORT-RECORD         FROM WS-SPACES
   508     WRITE REPORT-RECORD         FROM WS-SPACES
   509     PERFORM 0146-READ-ERARCH    THRU 0146-EXIT
   510
   511     .
   512 0020-EXIT.
   513     EXIT.
   514
   515 0140-PROCESS.
   516
   517     IF ((LA-INITIAL-PRINT-DATE >= X'A341')
   518        AND (LA-INITIAL-PRINT-DATE < X'A3A1'))
   519                       OR
   520        ((LA-SENT-DATE-1 >= X'A341')
*  12-S***********************                                         (   0)**
**    Operand LA-SENT-DATE-1 is not declared
   521        AND (LA-SENT-DATE-1 < X'A3A1'))
   522                       OR
   523        ((LA-SENT-DATE-2 >= X'A341')
   524        AND (LA-SENT-DATE-2 < X'A3A1'))
   525                       OR
   526        ((LA-SENT-DATE-3 >= X'A341')
   527        AND (LA-SENT-DATE-3 < X'A3A1'))
   528        PERFORM 0150-PRINT-REPORT
   529                              THRU 0150-EXIT
   530     END-IF
* 564-S**********                                                      (  10)**
**    A scope-delimiter did not have a matching verb and was discarded.
   531
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* PEMLACR1.cbl
   532     PERFORM 0146-READ-ERARCH    THRU 0146-EXIT
   533
   534     .
   535 0140-EXIT.
   536     EXIT.
   537
   538 0146-READ-ERARCH.
   539
   540     READ ERARCH-IN              AT END
   541        SET END-OF-ERARCH        TO TRUE
   542     END-READ
   543
   544     IF NOT END-OF-ERARCH
   545        ADD 1                    TO QSAM-IN-CNT
   546     END-IF
   547
   548     .
   549 0146-EXIT.
   550     EXIT.
   551
   552 0150-PRINT-REPORT.
   553
   554     EVALUATE TRUE
   555        WHEN (LA-INITIAL-PRINT-DATE >= X'A341')
   556           AND (LA-INITIAL-PRINT-DATE < X'A361')
   557           ADD 1                 TO WS-NOV-PRINT
   558        WHEN (LA-INITIAL-PRINT-DATE >= X'A361')
   559           AND (LA-INITIAL-PRINT-DATE < X'A381')
   560           ADD 1                 TO WS-DEC-PRINT
   561        WHEN (LA-INITIAL-PRINT-DATE >= X'A381')
   562           AND (LA-INITIAL-PRINT-DATE < X'A3A1')
   563           ADD 1                 TO WS-JAN-PRINT
   564     END-EVALUATE
   565
   566     EVALUATE TRUE
   567        WHEN (LA-SENT-DATE-1 >= X'A341')
*  12-S***************************                                     (  10)**
**    Operand LA-SENT-DATE-1 is not declared
   568           AND (LA-SENT-DATE-1 < X'A361')
   569           ADD 1                 TO WS-NOV-REPRINT
   570        WHEN (LA-SENT-DATE-1 >= X'A361')
* 368-S***********                                                     (  11)**
**    Exception phrase inappropriate
   571           AND (LA-SENT-DATE-1 < X'A381')
   572           ADD 1                 TO WS-DEC-REPRINT
   573        WHEN (LA-SENT-DATE-1 >= X'A381')
* 368-S***********                                                     (  11)**
**    Exception phrase inappropriate
   574           AND (LA-SENT-DATE-1 < X'A3A1')
   575           ADD 1                 TO WS-JAN-REPRINT
   576     END-EVALUATE
* 564-S****************                                                (  11)**
**    A scope-delimiter did not have a matching verb and was discarded.
   577
   578     EVALUATE TRUE
   579        WHEN (LA-SENT-DATE-2 >= X'A341')
*  12-S***************************                                     (  11)**
**    Operand LA-SENT-DATE-2 is not declared
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* PEMLACR1.cbl
   580           AND (LA-SENT-DATE-2 < X'A361')
   581           ADD 1                 TO WS-NOV-REPRINT
   582        WHEN (LA-SENT-DATE-2 >= X'A361')
* 368-S***********                                                     (  11)**
**    Exception phrase inappropriate
   583           AND (LA-SENT-DATE-2 < X'A381')
   584           ADD 1                 TO WS-DEC-REPRINT
   585        WHEN (LA-SENT-DATE-2 >= X'A381')
* 368-S***********                                                     (  12)**
**    Exception phrase inappropriate
   586           AND (LA-SENT-DATE-2 < X'A3A1')
   587           ADD 1                 TO WS-JAN-REPRINT
   588     END-EVALUATE
* 564-S****************                                                (  12)**
**    A scope-delimiter did not have a matching verb and was discarded.
   589
   590     EVALUATE TRUE
   591        WHEN (LA-SENT-DATE-3 >= X'A341')
*  12-S***************************                                     (  12)**
**    Operand LA-SENT-DATE-3 is not declared
   592           AND (LA-SENT-DATE-3 < X'A361')
   593           ADD 1                 TO WS-NOV-REPRINT
   594        WHEN (LA-SENT-DATE-3 >= X'A361')
* 368-S***********                                                     (  12)**
**    Exception phrase inappropriate
   595           AND (LA-SENT-DATE-3 < X'A381')
   596           ADD 1                 TO WS-DEC-REPRINT
   597        WHEN (LA-SENT-DATE-3 >= X'A381')
* 368-S***********                                                     (  12)**
**    Exception phrase inappropriate
   598           AND (LA-SENT-DATE-3 < X'A3A1')
   599           ADD 1                 TO WS-JAN-REPRINT
   600     END-EVALUATE
* 564-S****************                                                (  12)**
**    A scope-delimiter did not have a matching verb and was discarded.
   601
   602     MOVE ZEROS                  TO D1-CORR-TRLR-SEQ
   603     MOVE LA-CARRIER-A2          TO D1-CARRIER
   604     MOVE LA-ACCOUNT-A2          TO D1-ACCT-NO
   605     MOVE LA-CERT-NO-A2          TO D1-CERT-NO
   606     MOVE LA-ARCHIVE-NO          TO D1-ARCH-NO
   607     MOVE WS-ARCH-CNT            TO D1-ARCH-CNT
   608     MOVE LA-NO-OF-COPIES        TO D1-NOC
   609     MOVE LA-PROCESSOR-CD        TO D1-PROCESSOR-CD
   610
   611     IF LA-SENT-DATE-1 NOT = LOW-VALUES
*  12-S*********************                                           (  12)**
**    Operand LA-SENT-DATE-1 is not declared
   612        MOVE LA-SENT-DATE-1      TO DC-BIN-DATE-1
*  12-S**************************                                      (  12)**
**    Operand LA-SENT-DATE-1 is not declared
   613        PERFORM 8500-DATE-CONVERSION
   614                                 THRU 8590-EXIT
   615        IF NO-CONVERSION-ERROR
   616           MOVE DC-GREG-DATE-1-EDIT
   617                                 TO D1-RESENT1-DATE
   618        ELSE
   619           MOVE '00/00/00'       TO D1-RESENT1-DATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* PEMLACR1.cbl
   620        END-IF
   621     END-IF
* 564-S**********                                                      (  12)**
**    A scope-delimiter did not have a matching verb and was discarded.
   622
   623     IF LA-CREATION-DATE NOT = LOW-VALUES
   624        MOVE LA-CREATION-DATE    TO DC-BIN-DATE-1
   625        PERFORM 8500-DATE-CONVERSION
   626                                 THRU 8590-EXIT
   627        IF NO-CONVERSION-ERROR
   628           MOVE DC-GREG-DATE-1-EDIT
   629                                 TO D1-CREATION-DT
   630        ELSE
   631           MOVE '00/00/00'       TO D1-CREATION-DT
   632        END-IF
   633     END-IF
   634
   635     IF LA-INITIAL-PRINT-DATE NOT = LOW-VALUES
   636        MOVE LA-INITIAL-PRINT-DATE
   637                                 TO DC-BIN-DATE-1
   638        PERFORM 8500-DATE-CONVERSION
   639                                 THRU 8590-EXIT
   640        IF NO-CONVERSION-ERROR
   641           MOVE DC-GREG-DATE-1-EDIT
   642                                 TO D1-INITIAL-PRINT-DATE
   643        ELSE
   644           MOVE '00/00/00'       TO D1-INITIAL-PRINT-DATE
   645        END-IF
   646     END-IF
   647
   648     IF LA-SENT-DATE-2 NOT = LOW-VALUES
*  12-S*********************                                           (  13)**
**    Operand LA-SENT-DATE-2 is not declared
   649        MOVE LA-SENT-DATE-2      TO DC-BIN-DATE-1
*  12-S**************************                                      (  13)**
**    Operand LA-SENT-DATE-2 is not declared
   650        PERFORM 8500-DATE-CONVERSION
   651                                 THRU 8590-EXIT
   652        IF NO-CONVERSION-ERROR
   653           MOVE DC-GREG-DATE-1-EDIT
   654                                 TO D1-RESEND-PRINT-DATE
   655        ELSE
   656           MOVE '00/00/00'       TO D1-RESEND-PRINT-DATE
   657        END-IF
   658     END-IF
* 564-S**********                                                      (  13)**
**    A scope-delimiter did not have a matching verb and was discarded.
   659
   660     WRITE REPORT-RECORD         FROM WS-DETAIL-LINE
   661     WRITE REPORT-RECORD         FROM WS-SPACES
   662
   663     MOVE ZEROS                  TO WS-ARCH-CNT
   664
   665     .
   666 0150-EXIT.
   667     EXIT.
   668
   669 0200-CLOSE-FILES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* PEMLACR1.cbl
   670
   671     CLOSE ERARCH-IN
   672           REPORT-EXT
   673
   674     .
   675 0200-EXIT.
   676     EXIT.
   677
   678 8500-DATE-CONVERSION.
*                            COPY ELCDCS.
   679****************************************************************  04/15/98
   680*                                                              *  ELCDCS
   681*                                                              *  ELCDCS
   682*                            ELCDCS.                           *     LV003
   683*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   684*                            VMOD=2.002                        *     CL**3
   685*                                                              *  ELCDCS
   686*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
   687****************************************************************. ELCDCS
   688                                                                  ELCDCS
   689 8510-DATE-CONVERSION.                                            ELCDCS
   690     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
   691                                                                  ELCDCS
   692 8590-EXIT.                                                       ELCDCS
   693     EXIT.                                                        ELCDCS
   694                                                                  ELCDCS
   695
   696 ABEND-PGM SECTION.
*  697                          COPY ELCABEND.
   698***************************************************************** 04/14/98
   699*                                                               * ELCABEND
   700*                            ELCABEND.                          *    LV003
   701*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   702*                            VMOD 2.002                              CL**2
   703*                                                               * ELCABEND
   704*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
   705*            AND THEN ABENDS.                                   * ELCABEND
   706*                                                               * ELCABEND
   707*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
   708*                                                               * ELCABEND
   709***************************************************************** ELCABEND
   710*APS-010.                                                         ELCABEND
   711     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
   712     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
   713                                                                  ELCABEND
   714     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
   715         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   716         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
   717                                 UPON CONSOLE.                    ELCABEND
   718                                                                  ELCABEND
   719     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
   720         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   721         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
   722                                 UPON CONSOLE.                    ELCABEND
   723                                                                  ELCABEND
   724     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   725     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
   726                                 UPON CONSOLE.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* PEMLACR1.cbl (/apps/prod/cid1p/copy/ELCABEND)
   727                                                                  ELCABEND
   728     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
   729     CALL 'ABORTME'.
   730                                                                  ELCABEND
   731 APS-EXIT.                                                        ELCABEND
   732     EXIT.                                                        ELCABEND
   733
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:   13
* Total Messages:    20
* Unrecoverable :     0                    Severe  :    20
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:        2393     Code:           0
