* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* PEMEXCVT.cbl
* Options: int("PEMEXCVT.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("PEMEXCVT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"PEMEXCVT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "PEMEXCVT.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. PEMEXCVT.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 06-Oct-15 17:19.
     5 ENVIRONMENT DIVISION.
     6 INPUT-OUTPUT SECTION.
     7 FILE-CONTROL.
     8
     9     SELECT  FILE-IN             ASSIGN TO SYS010.
    10     SELECT  FILE-OUT            ASSIGN TO SYS011.
    11
    12 DATA DIVISION.
    13 FILE SECTION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* PEMEXCVT.cbl
    14
    15 FD  FILE-IN
    16     RECORDING MODE F
    17     LABEL RECORDS STANDARD
    18     BLOCK CONTAINS 0 RECORDS.
    19
    20 01  IN-RECORD.
    21     05  IN-CARRIER              PIC X.
    22     05  IN-GROUP                PIC X(6).
    23     05  IN-STATE                PIC XX.
    24     05  IN-ACCOUNT              PIC X(10).
    25     05  IN-IG                   PIC X.
    26     05  IN-TYPE                 PIC XXX.
    27     05  FILLER                  PIC X(42).
    28
    29 FD  FILE-OUT
    30     RECORDING MODE F
    31     LABEL RECORDS STANDARD
    32     BLOCK CONTAINS 0 RECORDS.
    33
    34 01  OUT-RECORD                  PIC X(165).
    35
    36 WORKING-STORAGE SECTION.
    37 77  FILLER  PIC X(32) VALUE '********************************'.
    38 77  FILLER  PIC X(32) VALUE '   PEMEXCVT WORKING-STORAGE     '.
    39 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.001. ********'.
    40
    41 77  WS-EOF-SW                   PIC X VALUE SPACES.
    42     88  END-OF-INPUT                  VALUE 'Y'.
    43 77  RECS-IN                     PIC 9(9) VALUE ZEROS.
    44 77  RECS-OUT                    PIC 9(9) VALUE ZEROS.
    45 77  RECS-CVT                    PIC 9(9) VALUE ZEROS.
    46
    47 01  X-REC.
    48     12  X-CARRIER           PIC X.
    49     12  X-GROUPING          PIC X(6).
    50     12  X-ST                PIC XX.
    51     12  X-ACCT              PIC X(10).
    52     12  X-IG                PIC X.
    53     12  X-TYPE.
    54         16  X-TYP           PIC XX.
    55         16  X-OB            PIC X.
    56     12  X-CODE              PIC 9.
    57***      VALUE 1 - ISSUE OR RECALC ISSUE
    58***      VALUE 2 - CANCEL OR RECALC CANCEL
    59***      VALUE 3 - CLAIM
    60     12  X-AMT               PIC S9(9)V99   COMP-3.
    61     12  X-BASE              PIC S9(7)V99   COMP-3.
    62     12  X-OVER              PIC S9(7)V99   COMP-3.
    63     12  X-DLR-INC           PIC S9(7)V99   COMP-3.
    64     12  X-LF-LMBA-FEE       PIC S9(7)V99   COMP-3.
    65     12  X-AH-LMBA-FEE       PIC S9(7)V99   COMP-3.
    66     12  X-BANK-FEE          PIC S9(7)V99   COMP-3.
    67     12  X-PROCESSED         PIC 9(07)      COMP-3.
    68     12  X-RECALC            PIC X.
    69     12  X-ACCT-COM-TYPE     PIC X.
    70     12  X-OWRT-COM-TYPE     PIC X.
    71     12  X-DMD-RESIDENT-ST   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* PEMEXCVT.cbl
    72     12  FILLER              PIC X.
    73     12  X-SPPDD-CLP         PIC S9(7)V99   COMP-3.
    74     12  FILLER              PIC X(90).
    75
    76 PROCEDURE DIVISION.
    77
    78 0000-MAIN.
    79
    80     PERFORM 0010-OPEN-FILES     THRU 0010-EXIT
    81
    82     PERFORM 0020-INITIALIZE     THRU 0020-EXIT
    83
    84     PERFORM 0100-PROCESS-FILE   THRU 0100-EXIT UNTIL
    85        END-OF-INPUT
    86
    87     PERFORM 0500-CLOSE-FILES    THRU 0500-EXIT
    88
    89     DISPLAY ' RECORDS READ      ' RECS-IN
    90     DISPLAY ' RECORDS WRITTEN   ' RECS-OUT
    91     DISPLAY ' RECORDS CONVERTED ' RECS-CVT
    92     GOBACK
    93
    94      .
    95 0010-OPEN-FILES.
    96
    97     OPEN INPUT  FILE-IN
    98          OUTPUT FILE-OUT
    99
   100     .
   101 0010-EXIT.
   102     EXIT.
   103
   104 0020-INITIALIZE.
   105
   106     PERFORM 0200-READ-INPUT     THRU 0200-EXIT
   107
   108     .
   109 0020-EXIT.
   110     EXIT.
   111
   112 0100-PROCESS-FILE.
   113
   114     MOVE IN-RECORD              TO X-REC
   115     MOVE ZEROS                  TO X-SPPDD-CLP
   116
   117     PERFORM 0300-WRITE-OUTPUT   THRU 0300-EXIT
   118     PERFORM 0200-READ-INPUT     THRU 0200-EXIT
   119
   120     .
   121 0100-EXIT.
   122     EXIT.
   123
   124 0200-READ-INPUT.
   125
   126     READ FILE-IN AT END
   127        SET END-OF-INPUT         TO TRUE
   128     END-READ
   129
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* PEMEXCVT.cbl
   130     IF NOT END-OF-INPUT
   131        ADD 1                    TO RECS-IN
   132     END-IF
   133
   134     .
   135 0200-EXIT.
   136     EXIT.
   137
   138 0300-WRITE-OUTPUT.
   139
   140     WRITE OUT-RECORD            FROM X-REC
   141     ADD 1                       TO RECS-OUT
   142
   143     .
   144 0300-EXIT.
   145     EXIT.
   146
   147 0500-CLOSE-FILES.
   148
   149     CLOSE FILE-IN FILE-OUT
   150
   151     .
   152 0500-EXIT.
   153     EXIT.
   154
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1948     Code:         650
