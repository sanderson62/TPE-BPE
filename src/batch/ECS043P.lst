* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS043P.cbl
* Options: int("ECS043P.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS043P.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS043P.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS043P.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS043.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 16:43:46.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS043P.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND PRINT
    23*            EARNED REVIEW STATEMENTS.
    24
    25*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    26*        FORMAT OTHER THAN YTD AND ITD.
    27
    28*        FORMAT OF INPUT IS -
    29*         CC 1-2    CARD I.D. 'RF'
    30*            3-5    CLIENT-ID
    31*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    32
    33*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    34*                      1  YTD
    35*                      2  QTD
    36*                      3  LAST 3 MOS.
    37*                      4  LAST 6 MOS.
    38*                      5  LAST 12 MOS.
    39*                      6  LAST MONTH
    40
    41*            7-14   BEGINNING DATE  (CCYYMMDD)
    42
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    52* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    53******************************************************************
    54
    55
    56 ENVIRONMENT DIVISION.
    57 INPUT-OUTPUT SECTION.
    58 FILE-CONTROL.
    59
    60     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    61     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    62     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    63     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
    64                             ACCESS IS SEQUENTIAL
    65                             ORGANIZATION IS INDEXED
    66                             FILE STATUS IS ERACCTT-FILE-STATUS
    67                             RECORD KEY IS AM-CONTROL-PRIMARY.
    68     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    69                             ORGANIZATION IS INDEXED
    70                             ACCESS IS DYNAMIC
    71                             FILE STATUS IS ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS043P.cbl
    72                             RECORD KEY IS PL-CONTROL-PRIMARY.
    73     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    74     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    75     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    76
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS043P.cbl
    78 DATA DIVISION.
    79 FILE SECTION.
    80
    81 SD  SORT-WORK.
    82
    83 01  SW-REC-OUT.
    84     12  SW-RPT-TYPE-ID-OUT  PIC X.
    85     12  SW-CTL-OUT          PIC X(35).
    86     12  FILLER              PIC X(1090).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS043P.cbl
    88 FD  CONTROL-CARD
    89     BLOCK CONTAINS 0 RECORDS
    90     RECORDING MODE F.
    91
    92 01  CARD-IN-AREA            PIC X(80).
    93
    94 FD  PRNTR
*   95                             COPY ELCPRTFD.
    96******************************************************************04/15/98
    97*                                                                *ELCPRTFD
    98*                                                                *ELCPRTFD
    99*                            ELCPRTFD.                           *   LV003
   100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   101*                            VMOD=2.006                          *ELCPRTFD
   102******************************************************************ELCPRTFD
   103     RECORDING MODE F                                             ELCPRTFD
   104     LABEL RECORDS OMITTED                                        ELCPRTFD
   105     BLOCK CONTAINS 0 RECORDS
   106     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   107 01  PRT.                                                         ELCPRTFD
   108     12  P-CTL               PIC  X.                                 CL**2
   109     12  P-DATA              PIC  X(132).                         ELCPRTFD
   110******************************************************************ELCPRTFD
   111
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS043P.cbl
   113 FD  EPEC-FILE
*  114                             COPY ECSEPCFD.
   115******************************************************************07/10/97
   116*                                                                *ECSEPCFD
   117*                            ECSEPCFD                            *   LV001
   118*                            VMOD=2.002                          *ECSEPCFD
   119*                                                                *ECSEPCFD
   120*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   121*                                                                *ECSEPCFD
   122******************************************************************ECSEPCFD
   123     RECORDING MODE F                                             ECSEPCFD
   124     LABEL RECORDS STANDARD                                       ECSEPCFD
   125     BLOCK CONTAINS 0 RECORDS
   126     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   127******************************************************************ECSEPCFD
*  128                             COPY ECSEPC01.
   129******************************************************************
   130*                                                                *
   131*                            ECSEPC01                            *
   132*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   133*                            VMOD=2.008                          *
   134*                                                                *
   135*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   136*                                                                *
   137*   FILE TYPE = SEQUENTIAL                                       *
   138*   RECORD SIZE = 325  RECFORM = FIXED                           *
   139*                                                                *
   140*   KEY DATA =                                  START=5, LEN=31  *
   141*                                                                *
   142*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   143*                                                                *
   144******************************************************************
   145
   146 01  EP-RECORD.
   147     02 EP-FILE.
   148     12  EP-RECORD-ID                      PIC XX.
   149         88  VALID-EP-ID                      VALUE 'EP'.
   150
   151     12  EP-COMPANY-CD                     PIC X.
   152
   153     12  EP-REIN                           PIC X.
   154         88  EP-REIN-EXTRACT                  VALUE 'R'.
   155
   156     12  EP-CONTROL.
   157         16  EP-CNTRL-1.
   158             20  EP-COMPANY.
   159                 24  EP-CARRIER            PIC X.
   160                 24  EP-GROUPING.
   161                     28  EP-GROUP-PREFIX   PIC XXX.
   162                     28  EP-GROUP-PRIME    PIC XXX.
   163             20  EP-STATE                  PIC XX.
   164             20  EP-ACCOUNT.
   165                 24  EP-ACCT-PREFIX        PIC X(4).
   166                 24  EP-ACCT-PRIME         PIC X(6).
   167         16  EP-CNTRL-2.
   168             20  EP-DATES.
   169                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   170                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS043P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   171
   172     12  EP-REI-CO.
   173         16  EP-REINCO                     PIC XXX.
   174         16  EP-REINCO-SUB                 PIC XXX.
   175
   176     12  EP-RCD-TYPE                       PIC X.
   177         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   178         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   179         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   180         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   181         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   182         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   183     12  EP-BEN-CODE                       PIC XX.
   184     12  FILLER                            PIC X.
   185
   186     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   187     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   188     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   189
   190     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   191     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   192     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   193
   194     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   195     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   196     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   197     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   198
   199     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   200     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   201     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   202
   203     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   204     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   205     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   206
   207     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   208     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   209     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   210     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   211     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   212
   213     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   214     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   215     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   216
   217     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   218     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   219     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   220
   221     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   222         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   223         16  EP-NEW-DATA-IND               PIC X(01).
   224             88  EP-NEW-DATA                   VALUE 'Y'.
   225         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   226         16  FILLER                        PIC X(19).
   227
   228     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS043P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   229     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   230     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   231
   232     12  FILLER                            PIC XXX.
   233
   234     12  EP-UNDERWRITING-CODE              PIC X.
   235         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   236
   237     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   238
   239     12  FILLER                            PIC X(29).
   240*    12  FILLER                            PIC X(34).
   241
   242     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   243     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   244     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   245     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   246     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   247     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   248
   249     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   250
   251     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   252     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   253
   254     12  EP-PURGE                          PIC X.
   255         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   256
   257     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   258
   259     02 EC-RECORD     REDEFINES     EP-FILE.
   260     12  EC-RECORD-ID                      PIC XX.
   261         88  VALID-EC-ID                      VALUE 'EC'.
   262
   263     12  EC-COMPANY-CD                     PIC X.
   264
   265     12  EC-REIN                           PIC X.
   266         88  EC-REIN-EXTRACT                  VALUE 'R'.
   267
   268     12  EC-CONTROL.
   269         16  EC-CARRIER                    PIC X.
   270         16  EC-GROUPING.
   271             20  EC-GROUP-PREFIX           PIC XXX.
   272             20  EC-GROUP-PRIME            PIC XXX.
   273         16  EC-STATE                      PIC XX.
   274         16  EC-ACCOUNT.
   275             20  EC-ACCT-PREFIX            PIC X(4).
   276             20  EC-ACCT-PRIME             PIC X(6).
   277         16  EC-DATES.
   278             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   279             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   280
   281     12  EC-REI-CO.
   282         16  EC-REINCO                     PIC XXX.
   283         16  EC-REINCO-SUB                 PIC XXX.
   284
   285     12  EC-RCD-TYPE                       PIC X.
   286         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS043P.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   287         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   288         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   289         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   290         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   291     12  EC-BEN-CODE                       PIC XX.
   292     12  EC-SEQ-NBR                        PIC X.
   293         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   294         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   295
   296     12  EC-AGENTS-DATA.
   297         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   298             20  EC-AGT-NO.
   299                 24  EC-AGT-PREFIX         PIC X(4).
   300                 24  EC-AGT-PRIME          PIC X(6).
   301             20  EC-AGT-TYPE               PIC X.
   302             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   303             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   304             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   305             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   306             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   307
   308     12  EC-UNDERWRITING-CODE              PIC X.
   309         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   310
   311     12  EC-AGENTS-DATA-II.
   312         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   313             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   314             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   315
   316     12  FILLER                            PIC X(7).
   317
   318     12  EC-PURGE                          PIC X.
   319         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   320
   321     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   322
   323******************************************************************
   324
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS043P.cbl
   326 FD  ACC-MSTR.
*  327                             COPY ERCACCT.
   328******************************************************************04/19/98
   329*                                                                *ERCACCT
   330*                                                                *ERCACCT
   331*                            ERCACCT                             *   LV031
   332*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   333*                            VMOD=2.031                          *ERCACCT
   334*                                                                *ERCACCT
   335*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   336*                                                                *ERCACCT
   337*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   338*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   339*                                                                *ERCACCT
   340*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   341*                                                                *ERCACCT
   342*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   343*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   344*                                                                *ERCACCT
   345*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   346*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   347*                                                                *ERCACCT
   348*   LOG = NO                                                     *ERCACCT
   349*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   350*                                                                *ERCACCT
   351*                                                                *ERCACCT
   352******************************************************************ERCACCT
   353*                   C H A N G E   L O G
   354*
   355* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   356*-----------------------------------------------------------------
   357*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   358* EFFECTIVE    NUMBER
   359*-----------------------------------------------------------------
   360* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   361* 092705    2005050300006  PEMA  ADD SPP LEASES
   362* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   363* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   364* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   365* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   366* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   367******************************************************************
   368                                                                  ERCACCT
   369 01  ACCOUNT-MASTER.                                              ERCACCT
   370     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   371         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   372                                                                  ERCACCT
   373     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   374         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   375         16  AM-MSTR-CNTRL.                                       ERCACCT
   376             20  AM-CONTROL-A.                                    ERCACCT
   377                 24  AM-CARRIER            PIC X.                 ERCACCT
   378                 24  AM-GROUPING.                                 ERCACCT
   379                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   380                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   381                 24  AM-STATE              PIC XX.                ERCACCT
   382                 24  AM-ACCOUNT.                                  ERCACCT
   383                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   384                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   385             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   386                                           PIC X(19).             ERCACCT
   387             20  AM-CNTRL-B.                                      ERCACCT
   388                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   389                 24  FILLER                PIC X(4).              ERCACCT
   390             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   391                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   392                                                                  ERCACCT
   393     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   394         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   395         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   396         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   397         16  AM-VG-STATE                   PIC XX.                ERCACCT
   398         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   399         16  AM-VG-DATE.                                          ERCACCT
   400             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   401             20  FILLER                    PIC X(4).              ERCACCT
   402         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   403                                           PIC 9(11)      COMP-3. ERCACCT
   404     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   405         16  FILLER                        PIC X(10).
   406         16  AM-VG-KEY3.
   407             20  AM-VG3-ACCOUNT            PIC X(10).
   408             20  AM-VG3-EXP-DT             PIC XX.
   409         16  FILLER                        PIC X(4).
   410     12  AM-MAINT-INFORMATION.                                    ERCACCT
   411         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   412         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   413         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   414         16  FILLER                        PIC XX.                ERCACCT
   415                                                                  ERCACCT
   416     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   417     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   418                                                                  ERCACCT
   419     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   420         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   421         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   422                                                                  ERCACCT
   423     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   424     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   425                                                                  ERCACCT
   426     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   427     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   428                                                                  ERCACCT
   429     12  AM-NAME                           PIC X(30).             ERCACCT
   430     12  AM-PERSON                         PIC X(30).             ERCACCT
   431     12  AM-ADDRS                          PIC X(30).             ERCACCT
   432     12  AM-CITY.
   433         16  AM-ADDR-CITY                  PIC X(28).
   434         16  AM-ADDR-STATE                 PIC XX.
   435     12  AM-ZIP.                                                  ERCACCT
   436         16  AM-ZIP-PRIME.                                        ERCACCT
   437             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   438                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   439             20  FILLER                    PIC X(4).              ERCACCT
   440         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   441     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   442         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   443         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   444         16  FILLER                        PIC XXX.               ERCACCT
   445     12  AM-TEL-NO.                                               ERCACCT
   446         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   447         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   448         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   449     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   450         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   451         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   452                                                                  ERCACCT
   453     12  AM-COMM-STRUCTURE.                                       ERCACCT
   454         16  AM-DEFN-1.                                           ERCACCT
   455             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   456                 24  AM-AGT.                                      ERCACCT
   457                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   458                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   459                 24  AM-COM-TYP            PIC X.                 ERCACCT
   460                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   461                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   462                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   463                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   464                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   465                 24  AM-GL-CODES           PIC X.                 ERCACCT
   466                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   467                 24  FILLER                PIC X(01).             ERCACCT
   468         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   469             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   470                 24  FILLER                PIC X(11).             ERCACCT
   471                 24  AM-L-COMA             PIC XXX.               ERCACCT
   472                 24  AM-J-COMA             PIC XXX.               ERCACCT
   473                 24  AM-A-COMA             PIC XXX.               ERCACCT
   474                 24  FILLER                PIC X(6).              ERCACCT
   475                                                                  ERCACCT
   476     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   477         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   478                                                                  ERCACCT
   479     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   480                                                                  ERCACCT
   481     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   482         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   483         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   484     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   485         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   486         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   487     12  AM-GPCD                           PIC 99.                ERCACCT
   488     12  AM-IG                             PIC X.                 ERCACCT
   489         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   490         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   491     12  AM-STATUS                         PIC X.                 ERCACCT
   492         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   493         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   494         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   495         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   496         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   497         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   498     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   499     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   500                                                                  ERCACCT
   501     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   502     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   503     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   504     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   505     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   506     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   507     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   508     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   509     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   510                                                                  ERCACCT
   511     12  AM-USER-FIELDS.                                          ERCACCT
   512         16  AM-FLD-1                      PIC XX.                ERCACCT
   513         16  AM-FLD-2                      PIC XX.                ERCACCT
   514         16  AM-FLD-3                      PIC XX.                ERCACCT
   515         16  AM-FLD-4                      PIC XX.                ERCACCT
   516         16  AM-FLD-5                      PIC XX.                ERCACCT
   517                                                                  ERCACCT
   518     12  AM-1ST-PROD-DATE.                                        ERCACCT
   519         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   520         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   521         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   522     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   523     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   524         16  AM-PUR-YR                     PIC XX.                ERCACCT
   525         16  AM-PUR-MO                     PIC XX.                ERCACCT
   526         16  AM-PUR-DA                     PIC XX.                ERCACCT
   527     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   528     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   529     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   530     12  AM-INACTIVE-DATE.                                        ERCACCT
   531         16  AM-INA-MO                     PIC 99.                ERCACCT
   532         16  AM-INA-DA                     PIC 99.                ERCACCT
   533         16  AM-INA-YR                     PIC 99.                ERCACCT
   534     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   535                                                                  ERCACCT
   536     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   537     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   538                                                                  ERCACCT
   539     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   540         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   541         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   542         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   543         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   544                                                                  ERCACCT
   545     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   546         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   547         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   548                                                                  ERCACCT
   549     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   550                                                                  ERCACCT
   551     12  AM-OVER-SHORT.                                           ERCACCT
   552         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   553         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   554                                                                  ERCACCT
   555     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   556     12  AM-DCC-CLP-STATE                  PIC XX.
   557                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   558     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   559     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   560                                                                  ERCACCT
   561     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   562     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   563     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   564     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   565     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   566     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   567     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   568     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   569     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   570     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   571     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   572     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   573     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   574     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   575     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   576     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   577                                                                  ERCACCT
   578     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   579                                                                  ERCACCT
   580     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   581     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   582                                                                  ERCACCT
   583     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   584     12  AM-EARN-METHODS.                                         ERCACCT
   585         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   586             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   587             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   588             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   589             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   590         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   591             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   592             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   593             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   594             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   595         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   596             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   597             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   598             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   599             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   600             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   601             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   602                                                                  ERCACCT
   603     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   604     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   605     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   606                                                                  ERCACCT
   607     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   608     12  AM-RET-P-E                        PIC X.                 ERCACCT
   609     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   610     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   611     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   612     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   613         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   614         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   615     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   616         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   617         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   618         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   619     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   620         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   621         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   622     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   623         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   624         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   625         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   626     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   627     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   628                                                                  ERCACCT
   629     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   630         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   631         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   632         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   633         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   634         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   635                                                                  ERCACCT
   636     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   637                                                                  ERCACCT
   638     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   641         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   642                                                                  ERCACCT
   643     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   644         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   645         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   646                                                                  ERCACCT
   647     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   648         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   649                                                                  ERCACCT
   650     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   651         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   652         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   653                                                                  ERCACCT
   654     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   655                                                                  ERCACCT
   656     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   657     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   658     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   659     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   660     12  AM-DCC-UEF-STATE                  PIC XX.
   661     12  FILLER                            PIC XXX.
   662     12  AM-REPORT-CODE-3                  PIC X(10).
   663*    12  FILLER                            PIC X(22).             ERCACCT
   664                                                                  ERCACCT
   665     12  AM-RESERVE-DATE.                                         ERCACCT
   666         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   667         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   668         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   669                                                                  ERCACCT
   670     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   671     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   672         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   673         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   674         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   675         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   676                                                                  ERCACCT
   677     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   678         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   679         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   680         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   681         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   682                                                                  ERCACCT
   683     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   684         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   685             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   686             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   687             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   688             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   689             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   690             20  FILLER                    PIC XX.                ERCACCT
   691         16  FILLER                        PIC X(80).             ERCACCT
   692                                                                  ERCACCT
   693     12  AM-TRANSFER-DATA.                                        ERCACCT
   694         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   695             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   696             20  AM-TRNFROM-GROUPING.                             ERCACCT
   697                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   698                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   699             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   700             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   701                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   702                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   703             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   704         16  AM-TRANSFERRED-TO.                                   ERCACCT
   705             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   706             20  AM-TRNTO-GROUPING.                               ERCACCT
   707                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   708                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   709             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   710             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   711                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   712                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   713             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   714         16  FILLER                        PIC X(10).             ERCACCT
   715                                                                  ERCACCT
   716     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   717                                                                  ERCACCT
   718     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   719         16  AM-DEFN-1-SAVED.                                     ERCACCT
   720             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   721                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   722                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   723                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   724                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   725                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   726                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   727                 24  FILLER                PIC X.                 ERCACCT
   728                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   729                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   730                 24  FILLER                PIC X.                 ERCACCT
   731         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   732             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   733                 24  FILLER                PIC X(11).             ERCACCT
   734                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   735                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   736                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   737                 24  FILLER                PIC X(6).              ERCACCT
   738                                                                  ERCACCT
   739     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   740         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   741            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   742            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   743            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   744                                                                  ERCACCT
   745     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   746     12  FILLER                            PIC X(120).            ERCACCT
   747                                                                  ERCACCT
   748     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   749         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   750         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   751             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   752             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   753                                                          COMP-3. ERCACCT
   754             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   755                                                          COMP-3. ERCACCT
   756         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   757             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   758             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   759                                                          COMP-3. ERCACCT
   760             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   761                                                          COMP-3. ERCACCT
   762                                                                  ERCACCT
   763     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   764         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   765         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   766         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   767         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   768             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   769                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   770                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   771             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   772                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   773                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   774             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   775                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   776                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   777         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   778             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   779                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   780                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   781                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   782             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   783                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   784                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   785             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   786                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   787                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   788                                                                  ERCACCT
   789     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   790         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   791                                                                  ERCACCT
   792     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   793         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   794         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   795         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   796         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   797         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   798             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   799             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   800             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   801             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   802         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   803             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   804             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   805             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   806         16  FILLER                        PIC X(102).            ERCACCT
   807                                                                  ERCACCT
   808     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   809         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   810             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   811             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   812             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   813             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   814             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   815         16  FILLER                          PIC X(10).           ERCACCT
   816******************************************************************ERCACCT
   817
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS043P.cbl
   819 FD  ERPLAN-IN.
*  820                             COPY ERCPLAN.
   821******************************************************************04/29/98
   822*                                                                *ERCPLAN
   823*                                                                *ERCPLAN
   824*                            ERCPLAN                             *   LV003
   825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   826*                            VMOD=2.003                          *   CL**2
   827*                                                                *ERCPLAN
   828*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   829*                                                                *ERCPLAN
   830*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   831*   PLAN MASTER                                                  *ERCPLAN
   832*                                                                *ERCPLAN
   833*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   834*                                                                *ERCPLAN
   835*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   836*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   837*                                                                *ERCPLAN
   838*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   839*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   840*                                                                *ERCPLAN
   841*   LOG = NO                                                     *ERCPLAN
   842*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   843*                                                                *ERCPLAN
   844*                                                                *ERCPLAN
   845******************************************************************ERCPLAN
   846                                                                  ERCPLAN
   847 01  PLAN-MASTER.                                                 ERCPLAN
   848     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   849         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   850                                                                  ERCPLAN
   851     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   852         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   853         16  PL-MSTR-CNTRL.                                       ERCPLAN
   854             20  PL-CONTROL-A.                                    ERCPLAN
   855                 24  PL-CARRIER            PIC X.                 ERCPLAN
   856                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   857                 24  PL-STATE              PIC XX.                ERCPLAN
   858                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   859             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   860             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   861             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   862                                                                  ERCPLAN
   863     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   864         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   865         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   866         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   867         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   868         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   869         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   870         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   871         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   872                                                                  ERCPLAN
   873     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   874         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   875         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   876         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS043P.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   877         16  FILLER                        PIC XX.                ERCPLAN
   878                                                                  ERCPLAN
   879     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   880         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   881         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   882             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   883             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   884             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   885             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   886                                                                  ERCPLAN
   887     12  FILLER                            PIC X(30).             ERCPLAN
   888                                                                  ERCPLAN
   889     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   890         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   891         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   892         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   893     12  FILLER                            PIC X(24).             ERCPLAN
   894     12  PL-TOLERANCES.                                           ERCPLAN
   895         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   896         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   897         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   898         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   899         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   900         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   901     12  PL-OVER-SHORT.                                           ERCPLAN
   902         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   903         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   904     12  FILLER                            PIC X(24).             ERCPLAN
   905     12  PLAN-MISC.                                               ERCPLAN
   906         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   907         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   908         16  PL-IG                         PIC X.                 ERCPLAN
   909         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   910         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   911         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   912         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   913         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   914         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   915         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   916         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   917                                                                  ERCPLAN
   918         16  FILLER                        PIC X(99).             ERCPLAN
   919******************************************************************ERCPLAN
   920
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS043P.cbl
   922 FD  DISK-DATE
*  923                             COPY ELCDTEFD.
   924******************************************************************04/15/98
   925*                                                                *ELCDTEFD
   926*                                                                *ELCDTEFD
   927*                            ELCDTEFD.                           *   LV002
   928*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   929*                            VMOD=2.007                          *   CL**2
   930*                                                                *ELCDTEFD
   931******************************************************************ELCDTEFD
   932     BLOCK CONTAINS 0 RECORDS
   933     RECORDING MODE F.                                            ELCDTEFD
   934                                                                  ELCDTEFD
   935 01  DATE-DISK.                                                   ELCDTEFD
   936     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   937     12  FILLER                      PIC  X(14).                  ELCDTEFD
   938     12  DD-CR1                      PIC  9.                      ELCDTEFD
   939     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   940     12  DD-CR2                      PIC  9.                      ELCDTEFD
   941     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   942     12  FILLER                      PIC  X(20).                  ELCDTEFD
   943                                                                  ELCDTEFD
   944 01  DATE-DISK-R.                                                 ELCDTEFD
   945     12  FILLER                      PIC  X(4).                   ELCDTEFD
   946     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   947                                     PIC  X(32).                  ELCDTEFD
   948                                                                  ELCDTEFD
   949 01  DATE-DISK-T.                                                 ELCDTEFD
   950     12  FILLER                      PIC  X(4).                   ELCDTEFD
   951     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   952                                     PIC  X(48).                  ELCDTEFD
   953                                                                  ELCDTEFD
   954 01  DATE-DISK-M.                                                 ELCDTEFD
   955     12  FILLER                      PIC  X(4).                   ELCDTEFD
   956     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   957                                     PIC  X(48).                  ELCDTEFD
   958                                                                  ELCDTEFD
   959 01  DATE-DISK-P.                                                 ELCDTEFD
   960     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   961     12  DD-IDX                      PIC  99.                     ELCDTEFD
   962     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   963     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   964         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   965                                     PIC  X.                      ELCDTEFD
   966         16  FILLER                  PIC  X(46).                  ELCDTEFD
   967     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   968         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   969             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   970             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   971             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   972             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   973         16  FILLER                  PIC  X(16).                  ELCDTEFD
   974                                                                  ELCDTEFD
   975 01  DATE-DISK-E.                                                 ELCDTEFD
   976     12  FILLER                      PIC  X(4).                   ELCDTEFD
   977     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   978                                     PIC  X(4).                   ELCDTEFD
   979                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   980 01  DATE-DISK-C.                                                 ELCDTEFD
   981     12  FILLER                      PIC  X(7).                   ELCDTEFD
   982     12  DD-CARR1-SECPAY-SW          PIC  X.
   983     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   984     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   985     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   986     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   987     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   988     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   989     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   990     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   991     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   992     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   993     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   994     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   995     12  DD-CARR2-SECPAY-SW          PIC  X.
   996     12  FILLER                      PIC  X(7).                   ELCDTEFD
   997                                                                  ELCDTEFD
   998 01  DATE-DISK-OPT.                                               ELCDTEFD
   999     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1000     12  DD-TLR-DATA.                                             ELCDTEFD
  1001         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1002                                     PIC  X(03).                  ELCDTEFD
  1003     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1004         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1005                                     PIC  X(06).                  ELCDTEFD
  1006     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1007         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1008                                     PIC  X(07).                  ELCDTEFD
  1009         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1010     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1011                                     PIC  X(96).                  ELCDTEFD
  1012******************************************************************ELCDTEFD
  1013
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS043P.cbl
  1015 FD  FICH
* 1016                             COPY ELCFCHFD.
  1017******************************************************************04/15/98
  1018*                                                                *ELCFCHFD
  1019*                            ELCFCHFD.                           *   LV003
  1020*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1021*                            VMOD=2.004                          *   CL**3
  1022*                                                                *ELCFCHFD
  1023******************************************************************ELCFCHFD
  1024     BLOCK CONTAINS 0 RECORDS
  1025     RECORDING MODE F.                                            ELCFCHFD
  1026                                                                  ELCFCHFD
  1027 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1028******************************************************************ELCFCHFD
  1029
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS043P.cbl
  1031 WORKING-STORAGE SECTION.
  1032
  1033 77  FILLER  PIC X(32) VALUE '********************************'.
  1034 77  FILLER  PIC X(32) VALUE '     ECS043 WORKING STORAGE     '.
  1035 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1036
  1037 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1038 77  NDX                     PIC S999            COMP.
  1039 77  SA                      PIC S999            COMP.
  1040 77  SB                      PIC S999            COMP.
  1041 77  SC                      PIC S999            COMP.
  1042 77  SE                      PIC S999            COMP.
  1043 77  SF                      PIC S999            COMP.
  1044 77  SG                      PIC S999            COMP.
  1045 77  SH                      PIC S999            COMP.
  1046 77  CL                      PIC S999            COMP.
  1047 77  AL                      PIC S999            COMP.
  1048 77  AN                      PIC S999            COMP.
  1049 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1050 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1051 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1052 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1053 77  X                       PIC X.
  1054 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1055 77  WS-EP-CODE              PIC X.
  1056 77  WS-OB-CODE              PIC X.
  1057 77  SAVE-DA-UP              PIC S9(9)V99.
  1058 77  SAVE-DA-UC              PIC S9(9)V99.
  1059 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1060 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1061 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1062 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1063 77  WS-RETRO-FLAG           PIC X.
  1064
  1065 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1066
  1067 01  WS-ABEND-STORAGE.
  1068     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1069     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1070     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1071     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1072
  1073     12  WS-ABEND-CODE         PIC 9(4).
  1074     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1075         16  W-ABEND-CODE-1    PIC XX.
  1076         16  W-ABEND-CODE-2    PIC XX.
  1077     12  ERACCTT-FILE-STATUS   PIC XX.
  1078     12  ERPLAN-FILE-STATUS    PIC XX.
  1079
  1080 01  WORK-MSG.
  1081     05  FILLER              PIC X    VALUE SPACE.
  1082     05  W-MM                PIC XX.
  1083     05  FILLER              PIC X    VALUE '/'.
  1084     05  W-DD                PIC XX.
  1085     05  FILLER              PIC X    VALUE '/'.
  1086     05  W-CCYY              PIC X(4).
  1087     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
  1088
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS043P.cbl
  1089 01  FORMAT-CONTROL-CARD.
  1090     05  FC-ID               PIC XX.
  1091     05  FC-CLIENT           PIC XXX.
  1092     05  FC-CODE             PIC X.
  1093     05  FC-DATE             PIC 9(8).
  1094     05  FC-DATE-R  REDEFINES  FC-DATE.
  1095         10  FC-CCYY         PIC 9(04).
  1096         10  FC-CCYR REDEFINES FC-CCYY.
  1097             15  FC-CC       PIC 99.
  1098             15  FC-YY       PIC 99.
  1099         10  FC-MM           PIC 99.
  1100         10  FC-DD           PIC 99.
  1101     05  FILLER              PIC X(66).
  1102
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS043P.cbl
  1104 01  SW-REC.
  1105     12  SW-RPT-TYPE-ID      PIC X.
  1106         88  ACCOUNT-RPT        VALUE 'A'.
  1107         88  RETRO-GROUP-RPT    VALUE 'B'.
  1108         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1109     12  SW-CTL.
  1110         16  SW-GA           PIC X(10).
  1111         16  SW-CARR         PIC X.
  1112         16  SW-COMP         PIC XXXXXX.
  1113         16  SW-STATE        PIC XX.
  1114         16  SW-ACCT         PIC X(10).
  1115         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1116     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1117     12  SW-NAME             PIC X(30).
  1118     12  SW-ADDRS            PIC X(20).
  1119     12  SW-CITY             PIC X(20).
  1120     12  SW-ZIP.
  1121         16  SW-ZIP-PRIME.
  1122             20  FILLER      PIC X(01).
  1123                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1124             20  FILLER      PIC X(04).
  1125         16  SW-ZIP-PLUS4    PIC X(04).
  1126     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1127         16  SW-CAN-POST-CODE-1
  1128                             PIC X(03).
  1129         16  SW-CAN-POST-CODE-2
  1130                             PIC X(03).
  1131         16  FILLER          PIC X(03).
  1132     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1133     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1134     12  SW-RET-Y-N          PIC X.
  1135     12  SW-RET-TYP          PIC X.
  1136     12  SW-GA-FLAG          PIC X.
  1137     12  SW-ACCUMS           PIC X(972).
  1138     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1139     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1140     12  SW-PREM-P-E         PIC X.
  1141     12  SW-CLMS-P-I         PIC X.
  1142     12  FILLER              PIC X(12).
  1143
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS043P.cbl
  1145 01  WS-ACCT-CONTROL.
  1146     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1147     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1148
  1149 01  WS-SAVE-CONTROL.
  1150     12  WS-SAVE-CARR        PIC X.
  1151     12  WS-SAVE-COMP        PIC XXXXXX.
  1152     12  WS-SAVE-STATE       PIC XX.
  1153     12  WS-SAVE-ACCT        PIC X(10).
  1154     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1155     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1156
  1157 01  WS-SAVE-CTL.
  1158     12  WS-SAVE-GA          PIC X(10).
  1159     12  WS-SAVE-CAR         PIC X.
  1160     12  WS-SAVE-CMP         PIC XXXXXX.
  1161     12  WS-SAVE-ST          PIC XX.
  1162     12  WS-SAVE-ACC         PIC X(10).
  1163     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1164
  1165 01  WS-PLAN-CONTROL.
  1166     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1167     12  WS-PL-CONTROL-A.
  1168         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1169         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1170         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1171         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1172     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1173     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1174     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1175
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS043P.cbl
  1177 01  MISC.
  1178     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1179     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1180     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1181     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1182     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1183     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1184     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1185     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1186     12  HEAD-SW             PIC X         VALUE SPACE.
  1187     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1188     12  SAVE-GA-FLAG        PIC X.
  1189     12  SAVE-RET-Y-N        PIC X.
  1190     12  SAVE-RET-TYP        PIC X.
  1191     12  SAVE-PREM-P-E       PIC X.
  1192     12  SAVE-CLMS-P-I       PIC X.
  1193     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1194         88  EXCLUDING-BENEFIT  VALUE '*'.
  1195
  1196 01  BEG-DATE                PIC 9(11).
  1197 01  BEG-DATE-R REDEFINES BEG-DATE.
  1198     12 FILLER               PIC 999.
  1199     12  BD-CCYY             PIC 9(04).
  1200     12  BD-CCYR REDEFINES BD-CCYY.
  1201         16  BD-CC           PIC 99.
  1202         16  BD-YR           PIC 99.
  1203     12  BD-MO               PIC 99.
  1204     12  BD-DA               PIC 99.
  1205
  1206 01  RUN-DT                  PIC 9(11).
  1207 01  RUN-DT-R REDEFINES RUN-DT.
  1208     12  FILLER              PIC 999.
  1209     12  RD-CCYY             PIC 9(04).
  1210     12  RD-CCYR REDEFINES RD-CCYY.
  1211         16  RD-CC           PIC 99.
  1212         16  RD-YR           PIC 99.
  1213     12  RD-MO               PIC 99.
  1214     12  RD-DA               PIC 99.
  1215
  1216 01  WORK-DATE           PIC 9(11).
  1217 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1218     12  FILLER          PIC 999.
  1219     12  WK-CCYY         PIC 9(04).
  1220     12  WK-CCYR REDEFINES WK-CCYY.
  1221         16  WK-CC       PIC 99.
  1222         16  WK-YR       PIC 99.
  1223     12  WK-MO           PIC 99.
  1224     12  WK-DA           PIC 99.
  1225
  1226 01  ZONE-GROUP.
  1227     03  ZON                 PIC XXX       VALUE 'ZON'.
  1228     03  Z-G                 PIC XXX.
  1229
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS043P.cbl
  1231*
  1232* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1233*
  1234*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1235*    OCCURRENCE 2 = A&H BEGINNING DATA
  1236*    OCCURRENCE 3 = LIFE CURRENT DATA
  1237*    OCCURRENCE 4 = A&H CURRENT DATA
  1238*
  1239 01  DETAIL-ACCUMULATORS     COMP-3.
  1240     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1241         16  DA-ISP          PIC S9(9)V99.
  1242         16  DA-TAX          PIC S9(9)V99.
  1243         16  DA-CNP          PIC S9(9)V99.
  1244         16  DA-UP           PIC S9(9)V99.
  1245         16  DA-CLM          PIC S9(9)V99.
  1246         16  DA-EXP          PIC S9(9)V99.
  1247         16  DA-CPS          PIC S9(9)V99.
  1248         16  DA-OTC          PIC S9(9)V99.
  1249         16  DA-LRV          PIC S9(9)V99.
  1250         16  DA-CAJ          PIC S9(9)V99.
  1251         16  DA-ISC          PIC S9(9)V99.
  1252         16  DA-CNC          PIC S9(9)V99.
  1253         16  DA-UC           PIC S9(9)V99.
  1254         16  DA-ISC-ADDL     PIC S9(9)V99.
  1255         16  DA-CNC-ADDL     PIC S9(9)V99.
  1256         16  DA-UC-ADDL      PIC S9(9)V99.
  1257         16  DA-GA-ISC       PIC S9(9)V99.
  1258         16  DA-GA-CNC       PIC S9(9)V99.
  1259         16  DA-GA-UC        PIC S9(9)V99.
  1260         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1261
  1262 01  TEMP-GA-ACCUMS.
  1263     12  GA-LEVELS.
  1264         16  GA-LEVELS OCCURS 10 TIMES.
  1265             20  XDA-GA-NO       PIC X(10).
  1266             20  XDA-GA-TYPE     PIC X.
  1267             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1268                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1269                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1270                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1271
  1272 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS043P.cbl
  1274*
  1275* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1276*
  1277*    A SET CONSISTS OF 6 ACCUMULATORS
  1278*
  1279*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1280*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1281*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1282*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1283*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1284*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1285*
  1286*    THERE ARE 6 SETS
  1287*
  1288*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1289*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1290*        SET 3 = LEVEL 3 (STATE TOTALS)
  1291*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1292*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1293*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1294*
  1295 01  PRINT-ACCUMULATORS      COMP-3.
  1296     12  PRINT-ACCUMS    OCCURS 36.
  1297         16  PA-NW           PIC S9(9)V99.
  1298         16  PA-BR           PIC S9(9)V99.
  1299         16  PA-ER           PIC S9(9)V99.
  1300         16  PA-EP           PIC S9(9)V99.
  1301         16  PA-PE           PIC S9(9)V99.
  1302         16  PA-PL           PIC S9(9)V99.
  1303         16  PA-BLR          PIC S9(9)V99.
  1304         16  PA-ELR          PIC S9(9)V99.
  1305         16  PA-TL           PIC S9(9)V99.
  1306         16  PA-RC           PIC S9(9)V99.
  1307         16  PA-OC           PIC S9(9)V99.
  1308         16  PA-TC           PIC S9(9)V99.
  1309         16  PA-CP           PIC S9(9)V99.
  1310         16  PA-EX           PIC S9(9)V99.
  1311         16  PA-TE           PIC S9(9)V99.
  1312         16  PA-BA           PIC S9(9)V99.
  1313         16  PA-NTE          PIC S9(9)V99.
  1314         16  PA-NBA          PIC S9(9)V99.
  1315         16  PA-EC           PIC S9(9)V99.
  1316         16  PA-GARC         PIC S9(9)V99.
  1317         16  PA-GAEC         PIC S9(9)V99.
  1318         16  PA-GACU         PIC S9(9)V99.
  1319         16  PA-CU           PIC S9(9)V99.
  1320         16  PA-GATC         PIC S9(9)V99.
  1321         16  PA-GAGT         PIC S9(9)V99.
  1322         16  PA-GABA         PIC S9(9)V99.
  1323         16  PA-GATE         PIC S9(9)V99.
  1324 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1325     12  PRINT-ACCUMS-R  OCCURS 6.
  1326         16  PRINT-ACCUMS-SL OCCURS 6.
  1327             20  PRINT-ACCUMS-L OCCURS 27.
  1328                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS043P.cbl
  1330
  1331*
  1332* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1333*    TO BE PRINTED ON THE RETRO
  1334*
  1335 01  PERCENT-ACCUMULATORS    COMP-3.
  1336     12  PER-ACCUMS      OCCURS 2.
  1337       14  PER-ACCUMS-X   OCCURS 27.
  1338         16  PT-PRCNT        PIC S9(4)V9(4).
  1339
  1340 01  DESC-TABLE.
  1341     12  FILLER              PIC X(33)   VALUE
  1342             '1. NET WRITTEN PREMIUM      00101'.
  1343     12  FILLER              PIC X(33)   VALUE
  1344             '2. PLUS BEGINNING RESERVE   00202'.
  1345     12  FILLER              PIC X(33)   VALUE
  1346             '3. LESS ENDING RESERVE      00303'.
  1347     12  FILLER              PIC X(33)   VALUE
  1348             '4. EARNED PREMIUM           00404'.
  1349     12  FILLER              PIC X(33)   VALUE
  1350             '5. PERCENT OF EARNED PREMIUM00505'.
  1351     12  FILLER              PIC X(33)   VALUE
  1352             '6. EXPENSES                 -0000'.
  1353     12  FILLER              PIC X(33)   VALUE
  1354             ' A. LOSSES                  00000'.
  1355     12  FILLER              PIC X(33)   VALUE
  1356             '  1. PAID                    0606'.
  1357     12  FILLER              PIC X(33)   VALUE
  1358             '  2. LESS BEG. LOSS RESERVE  0707'.
  1359     12  FILLER              PIC X(33)   VALUE
  1360             '  3. PLUS END. LOSS RESERVE  0808'.
  1361     12  FILLER              PIC X(33)   VALUE
  1362             '  4. TOTAL                   0909'.
  1363     12  FILLER              PIC X(33)   VALUE
  1364             ' B. COMMISSIONS             00000'.
  1365     12  FILLER              PIC X(33)   VALUE
  1366             '  1. RETAINED                2323'.
  1367     12  FILLER              PIC X(33)   VALUE
  1368             '  2. OTHER COMMISSION PAID   1111'.
  1369     12  FILLER              PIC X(33)   VALUE
  1370             '  3. OVERWRITE                 22'.
  1371     12  FILLER              PIC X(33)   VALUE
  1372             '  3. TOTAL                   12  '.
  1373     12  FILLER              PIC X(33)   VALUE
  1374             '  4. TOTAL                     24'.
  1375     12  WS-EX-LINE          PIC X(33)   VALUE
  1376             ' C. OTHER EXPENSE           01414'.
  1377     12  FILLER              PIC X(33)   VALUE
  1378             '7. TOTAL EXPENSE            01727'.
  1379     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1380             '8. BALANCE AT END OF PERIOD 01826'.
  1381     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1382             '   (LINE 5 MINUS LINE 7)     0000'.
  1383     12  FILLER              PIC X(33)   VALUE
  1384             '9. ACCOUNT BALANCES         0  18'.
  1385     12  FILLER              PIC X(33)   VALUE
  1386             '9. EXPERIENCE REFUND PRV PD 013  '.
  1387     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS043P.cbl
  1388             '10. EXPERIENCE REFUND PRV PD0  13'.
  1389     12  FILLER              PIC X(33)   VALUE
  1390             '10. NET BALANCE OR LOSS     -16  '.
  1391     12  FILLER              PIC X(33)   VALUE
  1392             '11. NET BALANCE OR LOSS     -  25'.
  1393     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1394 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1395     12  DT-TB-ENT   OCCURS 27.
  1396         16  DT-ENTRY    PIC X(28).
  1397         16  DT-CTL-CHAR PIC X.
  1398         16  DT-SUBSCR   OCCURS 2.
  1399             20  DT-SS-R.
  1400                 24  DT-SS   PIC 99.
  1401
  1402 01  DESC-TABLE-DESCRIPTIONS.
  1403     12  EXPENSE-LINE        PIC X(33)   VALUE
  1404             ' C. TAXES AND OTHER EXPENSES01414'.
  1405     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1406             '8. BALANCE AT END OF PERIOD 01826'.
  1407     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1408             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS043P.cbl
  1410
  1411 01  HEAD-1.
  1412     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1413     12  FILLER          PIC X(21)   VALUE SPACES.
  1414     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1415     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1416     12  FILLER          PIC X(38)   VALUE SPACES.
  1417     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1418     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1419
  1420 01  HEAD-2.
  1421     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1422     12  FILLER          PIC X(21)   VALUE SPACES.
  1423     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1424     12  FILLER          PIC X(38)   VALUE SPACES.
  1425     12  HD-RD           PIC X(8)    VALUE SPACES.
  1426
  1427 01  HEAD-3.
  1428     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1429     12  FILLER          PIC X       VALUE SPACES.
  1430     12  H3-ZIP.
  1431         16  H3-ZIP-PRIME
  1432                         PIC X(5).
  1433         16  H3-DASH     PIC X.
  1434         16  H3-ZIP-PLUS4
  1435                         PIC X(4).
  1436     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1437         16  H3-CAN-POSTAL-CODE-1
  1438                         PIC X(3).
  1439         16  H3-DASH-CAN PIC X.
  1440         16  H3-CAN-POSTAL-CODE-2
  1441                         PIC X(3).
  1442         16  H3-CAN-FILLER
  1443                         PIC X(3).
  1444     12  FILLER          PIC X(26)   VALUE SPACES.
  1445     12  HD-AD           PIC X(18)   VALUE SPACES.
  1446     12  FILLER          PIC X(44)   VALUE SPACES.
  1447     12  FILLER          PIC X(05)   VALUE
  1448         'PAGE '.
  1449     12  H3-PAGE         PIC ZZZZ9.
  1450
  1451 01  HEAD-4.
  1452     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1453     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1454     12  FILLER          PIC X(5)    VALUE SPACES.
  1455     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1456
  1457 01  HEAD-5.
  1458     12  H5-CARR         PIC X       VALUE SPACES.
  1459     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1460     12  FILLER          PIC X       VALUE SPACES.
  1461     12  H5-ST           PIC XX      VALUE SPACES.
  1462     12  FILLER          PIC X       VALUE SPACES.
  1463     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1464     12  FILLER          PIC X       VALUE SPACES.
  1465     12  H5-FMO          PIC XX      VALUE SPACES.
  1466     12  H5-FS1          PIC X       VALUE '-'.
  1467     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS043P.cbl
  1468     12  H5-FS2          PIC X       VALUE '-'.
  1469     12  H5-FYR          PIC XX      VALUE SPACES.
  1470     12  FILLER          PIC X       VALUE SPACES.
  1471     12  H5-TMO          PIC XX      VALUE SPACES.
  1472     12  H5-TS1          PIC X       VALUE '-'.
  1473     12  H5-TDA          PIC XX      VALUE SPACES.
  1474     12  H5-TS2          PIC X       VALUE '-'.
  1475     12  H5-TYR          PIC XX      VALUE SPACES.
  1476     12  FILLER          PIC X(4)    VALUE SPACES.
  1477     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1478     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1479     12  END-CHARACTER   PIC X       VALUE ' '.
  1480
  1481 01  HEAD-6.
  1482     12  FILLER          PIC X(15)   VALUE '***************'.
  1483     12  H6-YTD-HD.
  1484         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1485         14  H6-MTHS     PIC Z9.
  1486         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1487     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1488         16  H6R-FILLER  PIC X.
  1489         16  H6R-MO      PIC XX.
  1490         16  H6R-DASH1   PIC X.
  1491         16  H6R-DA      PIC XX.
  1492         16  H6R-DASH2   PIC X.
  1493         16  H6R-CCYY    PIC X(4).
  1494         16  H6R-MSG     PIC X(9).
  1495     12  FILLER          PIC X(15)   VALUE '***************'.
  1496     12  FILLER          PIC X(29)   VALUE SPACES.
  1497     12  FILLER          PIC X(16)   VALUE '****************'.
  1498     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1499     12  FILLER          PIC X(16)   VALUE '****************'.
  1500
  1501 01  HEAD-7.
  1502     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1503     12  FILLER          PIC X(1)    VALUE SPACES.
  1504     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1505     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1506     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1507     12  FILLER          PIC X(20)   VALUE '                    '.
  1508     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1509     12  FILLER          PIC X       VALUE SPACES.
  1510     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1511     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1512     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1513
  1514 01  HEAD-8-STATE.
  1515     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1516     12  H8-ST           PIC XX      VALUE SPACES.
  1517     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1518
  1519 01  HEAD-8-COMP.
  1520     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1521     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1522     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1523
  1524 01  HEAD-8-CARR.
  1525     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS043P.cbl
  1526     12  H8-CARR         PIC X       VALUE SPACES.
  1527     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1528
  1529 01  HEAD-8-GROUP.
  1530     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1531     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1532     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1533
  1534 01  HEAD-8-GA.
  1535     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1536     12  H8-GA           PIC X(10)   VALUE SPACES.
  1537     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1538
  1539 01  HEAD-8-FINAL.
  1540     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1541
  1542*01  HEAD-9.
  1543*    12  FILLER          PIC X(127)  VALUE SPACES.
  1544*    12  H9-PAGE         PIC ZZZZ9.
  1545
  1546 01  DETAIL-LINE.
  1547     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1548     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1549     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1550     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1551     12  FILLER          PIC X.
  1552     12  DL-DESC         PIC X(28).
  1553     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1554     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1555     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1556     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1557
* 1558                                    COPY ELCDATE.
  1559******************************************************************06/11/98
  1560*                                                                *ELCDATE
  1561*                                                                *ELCDATE
  1562*                            ELCDATE.                            *   LV023
  1563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1564*                            VMOD=2.003                           ELCDATE
  1565*                                                                *ELCDATE
  1566*                                                                *ELCDATE
  1567*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1568*                 LENGTH = 200                                   *   CL*19
  1569******************************************************************ELCDATE
  1570                                                                  ELCDATE
  1571 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1572     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1573     12  DC-OPTION-CODE                PIC X.                        CL*15
  1574         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1575         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1576         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1577         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1578         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1579         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1580         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1581         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1582         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1583         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1584         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1585         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1586         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1587         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1588         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1589         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1590         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1591         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1592         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1593         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1594         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1595         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1596         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1597         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1598         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1599         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1600         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1601         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1602         88  THREE-CHARACTER-BIN                                  ELCDATE
  1603                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1604         88  GREGORIAN-TO-BIN                                        CL**2
  1605                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1606         88  BIN-TO-GREGORIAN                                        CL**2
  1607                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1608         88  JULIAN-TO-BINARY                                        CL**2
  1609                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1610     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1611         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1612         88  DATE-CONVERSION-ERROR                                ELCDATE
  1613                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1614         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1615         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1616         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1617         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1618         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1619         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1620         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1621         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1622         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1623         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1624     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1625         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1626     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1627         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1628         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1629         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1630     12  FILLER                        PIC X.                        CL*15
  1631     12  DC-CONVERSION-DATES.                                        CL*15
  1632         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1633         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1634         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1635         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1636                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1637             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1638             20  SLASH1-1              PIC X.                        CL*15
  1639             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1640             20  SLASH1-2              PIC X.                        CL*15
  1641             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1642         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1643         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1644                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1645             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1646             20  SLASH2-1              PIC X.                        CL*15
  1647             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1648             20  SLASH2-2              PIC X.                        CL*15
  1649             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1650         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1651         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1652                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1653             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1654             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1655             20  DC-YMD-DAY            PIC 99.                       CL*15
  1656         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1657         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1658                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1659             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1660             20  DC-MDY-DAY            PIC 99.                       CL*15
  1661             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1662         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1663             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1664             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1665             20  FILLER                PIC XX.                       CL*15
  1666             20  DC-ALPHA-CENTURY.                                   CL*15
  1667                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1668             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1669         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1670         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1671         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1672         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1673         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1674                                       PIC 9(05).                    CL*20
  1675         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1676             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1677             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1678         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1679         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1680         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1681     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1682         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1683         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1684             20  FILLER                PIC 9(3).                     CL*15
  1685             20  HOLD-CEN-1-CCYY.                                    CL*15
  1686                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1687                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1688             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1689             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1690         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1691             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1692             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1693             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1694                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1695                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1696             20  FILLER                PIC 9(3).                     CL*15
  1697         16  HOLD-CENTURY-1-X.                                       CL*15
  1698             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1699             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1700                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1701                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1702             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1703             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1704         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1705             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1706             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1707             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1708                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1709                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1710             20  FILLER                PIC XXX.                      CL*23
  1711         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1712         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1713         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1714         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1715             20  DC-JULIAN-1-CCYY.                                   CL*15
  1716                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1717                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1718             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1719         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1720         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1721             20  DC-JULIAN-2-CCYY.                                   CL*15
  1722                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1723                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1724             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1725         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1726             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1727             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1728             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1729             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1730             20  DC-EDITA-CCYY.                                      CL*15
  1731                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1732                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1733         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1734             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1735             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1736             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1737             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1738             20  DC-EDITB-CCYY.                                      CL*15
  1739                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1740                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1741         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1742         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1743                              DC-GREG-DATE-CYMD.                  ELCDATE
  1744             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1745             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1746             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1747             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1748         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1749         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1750                              DC-GREG-DATE-MDCY.                  ELCDATE
  1751             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1752             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1753             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1754             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1755    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1756        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1757    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS043P.cbl
  1758    12  FILLER                         PIC X(28).                    CL*26
  1759
* 1760                                    COPY ELCDTECX.
  1761******************************************************************06/05/98
  1762*                                                                *ELCDTECX
  1763*                            ELCDTECX.                           *   LV005
  1764*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1765*                            VMOD=2.015                          *ELCDTECX
  1766*                                                                *ELCDTECX
  1767*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1768*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1769*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1770*                                                                *ELCDTECX
  1771******************************************************************ELCDTECX
  1772******************************************************************
  1773*                   C H A N G E   L O G
  1774*
  1775* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1776*-----------------------------------------------------------------
  1777*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1778* EFFECTIVE    NUMBER
  1779*-----------------------------------------------------------------
  1780* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1781*                                  BENEFIT CODES FROM 300 TO 900
  1782* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1783* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1784* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1785******************************************************************
  1786 01  DATE-CARD.                                                   ELCDTECX
  1787     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1788     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1789     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1790     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1791     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1792     12  EP-SW                       PIC  X.                      ELCDTECX
  1793         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1794     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1795         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1796     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1797     12  RUN-CENTURY.                                             ELCDTECX
  1798         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1799     12  FILLER                      PIC  X.                         CL**4
  1800     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1801     12  FILLER                      PIC  XXX.                    ELCDTECX
  1802     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1803                                                                  ELCDTECX
  1804 01  FILLER                          PIC  X(7)                       CL**6
  1805                                          VALUE 'OPTIONS'.        ELCDTECX
  1806 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1807     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1808     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1809     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1810         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1811         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1812     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1813     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1814     12  FILLER                      PIC  X.                      ELCDTECX
  1815     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1816     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1817     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1818     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1819     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1820     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1821     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1822     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1823     12  FILLER                      PIC  X.                      ELCDTECX
  1824     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1825     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1826     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1827     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1828     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1829     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1830     12  FILLER                      PIC  X.                      ELCDTECX
  1831     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1832     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1833     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1834     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1835     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1836     12  DTE-R78                     PIC  X.                      ELCDTECX
  1837     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1838     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1839     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1840     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1841     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1842     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1843     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1844                                     PIC  X.                      ELCDTECX
  1845         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1846                                                 ' '.             ELCDTECX
  1847         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1848         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1849     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1850         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1851         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1852     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1853     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1854                                     PIC  9.                         CL**4
  1855     12  DTE-SYSTEM.                                              ELCDTECX
  1856         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1857         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1858         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1859         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1860         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1861         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1862         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1863         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1864         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1865         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1866         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1867         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1868         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1869         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1870         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1871         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1872         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1873         16  DTE-SYS-R               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1874         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1875         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1876         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1877         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1878         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1879         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1880         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1881         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1882     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1883         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1884                                     PIC  X.                      ELCDTECX
  1885     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1886                                                                  ELCDTECX
  1887 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1888     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1889     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1890     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1891*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1892     12  FILLER                      PIC  X.                      ELCDTECX
  1893     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1894     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1895     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1896     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1897     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1898     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1899     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1900                                                                  ELCDTECX
  1901     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1902     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1903     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1904     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1905                                                                  ELCDTECX
  1906     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1907     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1908     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1909     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1910                                                                  ELCDTECX
  1911     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1912     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1913                                                                  ELCDTECX
  1914     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1915     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1916                                                                  ELCDTECX
  1917     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1918                                                                  ELCDTECX
  1919 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1920     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1921     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1922     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1923     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1924     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1925     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1926     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1927                                                                  ELCDTECX
  1928 01  FILLER                          PIC  X(12)                   ELCDTECX
  1929                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1930 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1931     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1932         16  CNT-ID                  PIC  X.                      ELCDTECX
  1933         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1934                                                                  ELCDTECX
  1935 01  FILLER                          PIC  X(11)                   ELCDTECX
  1936                                          VALUE 'STATE NAMES'.    ELCDTECX
  1937 01  STATE-NAMES.                                                 ELCDTECX
  1938     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1939         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1940         16  STATE-PIC1.                                          ELCDTECX
  1941             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1942             20  FILLER              PIC  XXX.                    ELCDTECX
  1943             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1944             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1945             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1946             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1947                                                                  ELCDTECX
  1948 01  FILLER                          PIC  X(13)                   ELCDTECX
  1949                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1950 01  CARRIER-NAMES.                                               ELCDTECX
  1951     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1952         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1953         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1954         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1955         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1956         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1957         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1958*        16  FILLER                  PIC  X.                      ELCDTECX
  1959         16  CARRIER-SEC-PAY         PIC  X.
  1960             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1961                                                                  ELCDTECX
  1962 01  FILLER                          PIC  X(9)                       CL**6
  1963                                          VALUE 'INS TYPES'.      ELCDTECX
  1964 01  CLAS-INS-TYPES.                                              ELCDTECX
  1965*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1966     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1967         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  1968         16  CLAS-I-AB3.                                          ELCDTECX
  1969             20  FILLER              PIC  X.                      ELCDTECX
  1970             20  CLAS-I-AB2.                                      ELCDTECX
  1971                 24  FILLER          PIC  X.                      ELCDTECX
  1972                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1973         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1974             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1975             20  FILLER              PIC  X.                         CL**4
  1976         16  CLAS-I-AB10.                                         ELCDTECX
  1977             20  FILLER              PIC  X(9).                   ELCDTECX
  1978             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1979         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1980         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1981         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1982         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1983             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1984         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1985         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1986         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1987         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1988         16  CLAS-I-REFUND-METHOD    PIC  X.
  1989         16  CLAS-I-MAX-BENEFITS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1990         16  FILLER                  PIC  XXX.
  1991                                                                  ELCDTECX
  1992 01  FILLER                          PIC  X(16)                   ELCDTECX
  1993                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1994 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1995     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1996                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1997         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1998         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1999         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2000         16  CLAS-MORT-DESC.                                      ELCDTECX
  2001             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2002             20  FILLER              PIC  XX.                        CL**5
  2003             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2004             20  FILLER              PIC  X.                         CL**5
  2005             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2006             20  FILLER              PIC  X.                         CL**5
  2007             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2008             20  FILLER              PIC  X.                         CL**5
  2009             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2010             20  FILLER              PIC  X(5).                      CL**6
  2011                                                                  ELCDTECX
  2012 01  FILLER                          PIC  X(15)                   ELCDTECX
  2013                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2014 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2015     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2016         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2017         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2018         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2019         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2020         16  FILLER                  PIC  X(4).                      CL**6
  2021                                                                  ELCDTECX
  2022 01  FILLER                          PIC  X(7)                       CL**6
  2023                                     VALUE 'INDEXES'.             ELCDTECX
  2024 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2025     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2026     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2027     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2028     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2029     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2030     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2031     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2032     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2033     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2034     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2035     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2036     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2037     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2038     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2039     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2040     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2041     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2042                                                                  ELCDTECX
  2043 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2044     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2045     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2046     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2047     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2048     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2049     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2050     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2051     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2052     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2053     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2054     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2055                                                                  ELCDTECX
  2056 01  FILLER                          PIC  X(13)                   ELCDTECX
  2057                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2058 01  CLAS-MISC.                                                   ELCDTECX
  2059     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2060         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2061         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2062         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2063     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2064     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2065     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2066     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2067     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2068     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2069     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2070     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2071     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2072     12  STATE-L                     PIC  XX.                     ELCDTECX
  2073     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2074     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2075     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2076         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2077         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2078     12  DTE-ABEND-WORK.                                          ELCDTECX
  2079         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2080         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2081                                                                  ELCDTECX
  2082 01  FILLER                          PIC  X(12)                   ELCDTECX
  2083                                     VALUE 'WORKING DATE'.        ELCDTECX
  2084 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2085     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2086         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2087         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2088         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2089     12  WS-CURRENT-DATE.                                         ELCDTECX
  2090         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2091         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2092         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2093         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2094         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2095     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2096         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2097         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2098                                                                  ELCDTECX
  2099 01  FILLER                          PIC  X(12)                   ELCDTECX
  2100                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2101 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2102     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2103         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2104         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2105         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2106                                                                  ELCDTECX
  2107 01  FILLER                          PIC  X(10)                   ELCDTECX
  2108                                     VALUE 'STATE TLRS'.          ELCDTECX
  2109 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2110     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2111         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2112         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2113                                                                  ELCDTECX
  2114 01  FILLER                          PIC  X(13)                   ELCDTECX
  2115                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2116 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2117     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2118         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2119                                                                  ELCDTECX
  2120 01  FILLER                          PIC  X(13)                   ELCDTECX
  2121                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2122 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2123     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2124     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2125     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2126                                     PIC  X.                         CL**5
  2127     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2128     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2129     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2130     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2131     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2132     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2133     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2134     12  FILLER                      PIC  X(75).                  ELCDTECX
  2135******************************************************************ELCDTECX
  2136*01  MISC-CARR-PCT-DATA.                                          00001521
  2137*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2138*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2139*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2140*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2141*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2142*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2143******************************************************************ELCDTECX
  2144
* 2145                                    COPY ELCDTEVR.
  2146***************************************************************** 04/15/98
  2147*                                                                *ELCDTEVR
  2148*                                                                *ELCDTEVR
  2149*                            ELCDTEVR.                           *   LV003
  2150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2151*                            VMOD=2.001                          *   CL**2
  2152*                                                                *ELCDTEVR
  2153*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2154*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2155*                                                                *ELCDTEVR
  2156******************************************************************ELCDTEVR
  2157 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2158     05  WS-RUN-DATE.                                             ELCDTEVR
  2159         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2160         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2161         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2162             15  RUN-CC              PIC  99.                     ELCDTEVR
  2163             15  RUN-YR              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2164         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2165         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2166     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2167            WS-RUN-DATE              PIC 9(11).                      CL**2
  2168     05  WS-EP-DT.                                                ELCDTEVR
  2169         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2170         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2171         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2172             15  EP-CC               PIC  99.                     ELCDTEVR
  2173             15  EP-YR               PIC  99.                     ELCDTEVR
  2174         10  EP-MO                   PIC  99.                     ELCDTEVR
  2175         10  EP-DA                   PIC  99.                     ELCDTEVR
  2176     05  WS-EP-DT-N REDEFINES                                        CL**2
  2177            WS-EP-DT                 PIC 9(11).                      CL**2
  2178     05  WS-DTE-CONV-DT.                                             CL**4
  2179         10  FILLER                  PIC  9(03).                     CL**4
  2180         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2181         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2182             15  DTE-CONV-CC         PIC  99.                        CL**4
  2183             15  DTE-CONV-YR         PIC  99.                        CL**4
  2184         10  DTE-CONV-MO             PIC  99.                        CL**4
  2185         10  DTE-CONV-DA             PIC  99.                        CL**4
  2186     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2187            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2188 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2189     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2190         10  FILLER                            PIC 999.           ELCDTEVR
  2191         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2192         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2193             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2194             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2195         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2196         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2197     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2198            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2199     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2200         10  FILLER                            PIC 999.           ELCDTEVR
  2201         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2202         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2203         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2204         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2205     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2206            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2207 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2208     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2209         10  FILLER                            PIC 999.           ELCDTEVR
  2210         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2211         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2212             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2213             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2214         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2215         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2216     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2217            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2218     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2219         10  FILLER                            PIC 999.           ELCDTEVR
  2220         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2221         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2222             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2223             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2224         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2225         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2226     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2227            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2228     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2229         10  FILLER                            PIC 999.           ELCDTEVR
  2230         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2231         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2232             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2233             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2234         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2235         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2236     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2237            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2238 01  WS-RATE-RECORD.                                              ELCDTEVR
  2239         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2240             10  FILLER                        PIC 999.           ELCDTEVR
  2241             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2242             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2243                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2244                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2245             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2246             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2247         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2248                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2249
* 2250                                    COPY ELCACCTV.
  2251******************************************************************04/14/98
  2252*                                                                *ELCACCTV
  2253*                            ELCACCTV                            *   LV002
  2254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2255*                            VMOD=2.001                          *ELCACCTV
  2256*                                                                *ELCACCTV
  2257*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2258*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2259*                                                                *ELCACCTV
  2260*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2261*                                                                *ELCACCTV
  2262******************************************************************ELCACCTV
  2263                                                                  ELCACCTV
  2264 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2265                                                                  ELCACCTV
  2266     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2267         10  FILLER            PIC 999.                           ELCACCTV
  2268         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2269         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2270             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2271             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2272         10  AM-EXP-MO         PIC 99.                               CL**5
  2273         10  AM-EXP-DA         PIC 99.                               CL**5
  2274     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2275            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2276     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2277         10  FILLER                    PIC 999.                   ELCACCTV
  2278         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2279         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2280             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2281             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  2282         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2283         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2284     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2285            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2286     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2287         10  FILLER                    PIC 999.                   ELCACCTV
  2288         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2289         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2290             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2291             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2292         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2293         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2294     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2295            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2296     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2297         10 FILLER                     PIC 999.                   ELCACCTV
  2298         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2299         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2300            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2301            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2302         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2303         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2304     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2305            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2306     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2307         10 FILLER                     PIC 999.                   ELCACCTV
  2308         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2309         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2310            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2311            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2312         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2313         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2314     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2315            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2316     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2317         10  FILLER                    PIC 999.                   ELCACCTV
  2318         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2319         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2320             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2321             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2322         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2323         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2324     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2325            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2326     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2327         10  FILLER                    PIC 999.                   ELCACCTV
  2328         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2329         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2330             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2331             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2332         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2333         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2334     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2335            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2336     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2337         10  FILLER                    PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2338         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2339         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  2340             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2341             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2342         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2343         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2344     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2345            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2346     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2347         10  FILLER                    PIC 999.                   ELCACCTV
  2348         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2349         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2350             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2351             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2352         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2353         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2354     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2355            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2356
* 2357                                    COPY ELCEPCVR.
  2358******************************************************************05/15/98
  2359*                                                                *ELCEPCVR
  2360*                                                                *ELCEPCVR
  2361*                            ELCEPCVR                            *   LV003
  2362*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2363*                            VMOD=2.001                          *ELCEPCVR
  2364*                                                                *ELCEPCVR
  2365*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2366*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2367*                                                                *ELCEPCVR
  2368******************************************************************ELCEPCVR
  2369 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2370     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2371         10  FILLER            PIC 999.                           ELCEPCVR
  2372         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2373         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2374             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2375             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2376         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2377         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2378     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2379            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2380     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2381         10  FILLER            PIC 999.                              CL**5
  2382         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2383         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2384             15  EC-EXP-CC     PIC 99.                               CL**5
  2385             15  EC-EXP-YR     PIC 99.                               CL**5
  2386         10  EC-EXP-MO         PIC 99.                               CL**5
  2387         10  EC-EXP-DA         PIC 99.                               CL**5
  2388     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2389            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2390     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2391         10  FILLER            PIC 999.                           ELCEPCVR
  2392         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2393         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2394             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2395             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2396         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2397         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2398     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2399            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2400     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2401         10  FILLER            PIC 999.                              CL**5
  2402         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2403         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2404             15  EC-EFF-CC     PIC 99.                               CL**5
  2405             15  EC-EFF-YR     PIC 99.                               CL**5
  2406         10  EC-EFF-MO         PIC 99.                               CL**5
  2407         10  EC-EFF-DA         PIC 99.                               CL**5
  2408     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2409            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2410     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2411         10  FILLER            PIC 999.                           ELCEPCVR
  2412         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2413         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2414             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2415             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2416         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2417         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2418     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2419            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2420     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2421         10  FILLER            PIC 999.                           ELCEPCVR
  2422         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2423         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2424             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2425             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2426         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2427         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2428     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2429            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2430     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2431         10  FILLER            PIC 999.                           ELCEPCVR
  2432         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2433         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2434             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2435             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2436         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2437         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2438     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2439            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2440     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2441         10  FILLER            PIC 999.                           ELCEPCVR
  2442         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2443         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2444             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2445             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2446         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2447         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2448     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2449            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2450     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2451         10  FILLER            PIC 999.                           ELCEPCVR
  2452         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2453         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS043P.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2454             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2455             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2456         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2457         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2458     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2459            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2460
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS043P.cbl
  2462 PROCEDURE DIVISION.
  2463 0100-READ-DATE-CARD.
* 2464                             COPY ELCDTERX SUPPRESS.
  2780
  2781     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2782                                   HEAD-7-PLUG-3.
  2783     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2784                                   HEAD-7-PLUG-4.
  2785     MOVE WS-CURRENT-DATE TO HD-RD.
  2786     MOVE ALPH-DATE       TO HD-AD.
  2787     MOVE COMPANY-NAME    TO HD-COMP.
  2788
  2789     MOVE LOW-VALUES      TO END-CHARACTER.
  2790
  2791     MOVE RUN-DATE        TO RUN-DT
  2792                             BEG-DATE.
  2793
  2794     OPEN INPUT CONTROL-CARD.
  2795
  2796     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2797          AT END   MOVE '1' TO FC-CODE
  2798                   GO TO 0130-BUILD-SELECT-DATES.
  2799
  2800 0110-READ-CARD-LOOP.
  2801     IF FC-ID = 'RF'
  2802         IF FC-CLIENT = DTE-CLIENT
  2803             GO TO 0120-FLUSH-REMAINING-CARDS.
  2804
  2805     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2806          AT END   MOVE '1' TO FC-CODE
  2807                   GO TO 0130-BUILD-SELECT-DATES.
  2808
  2809     GO TO 0110-READ-CARD-LOOP.
  2810
  2811 0120-FLUSH-REMAINING-CARDS.
  2812     READ CONTROL-CARD
  2813            AT END GO TO 0130-BUILD-SELECT-DATES.
  2814
  2815     GO TO 0120-FLUSH-REMAINING-CARDS.
  2816
  2817 0130-BUILD-SELECT-DATES.
  2818     IF DTE-PGM-OPT = '5' OR '7'
  2819        MOVE 'RF'       TO FC-ID
  2820        MOVE DTE-CLIENT TO FC-CLIENT
  2821        MOVE '5'        TO FC-CODE
  2822        MOVE RUN-DATE   TO FC-DATE.
  2823
  2824     IF FC-CODE = ' '
  2825       IF FC-DATE NOT NUMERIC  OR
  2826          FC-DATE = ZEROS
  2827          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  2828          GO TO ABEND-PGM.
  2829
  2830     IF FC-CODE = ' '
  2831         MOVE FC-DATE   TO BEG-DATE
  2832         MOVE FC-MM     TO W-MM
  2833         MOVE FC-DD     TO W-DD
  2834         MOVE FC-CCYY   TO W-CCYY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS043P.cbl
  2835         MOVE WORK-MSG  TO H6-YTD-HD
  2836         GO TO 0140-SORT-CONTROL.
  2837
  2838     IF DTE-PGM-OPT = '5'
  2839         MOVE FC-DATE   TO BEG-DATE.
  2840
  2841     IF FC-CODE = ('1' OR '5')
  2842         SUBTRACT 1 FROM BD-CCYY
  2843         IF FC-CODE = '1'
  2844              MOVE 31   TO BD-DA
  2845              MOVE 12   TO BD-MO
  2846              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  2847              GO TO 0140-SORT-CONTROL
  2848         ELSE
  2849              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  2850              MOVE BEG-DATE TO SAVE-BEG-DATE
  2851              GO TO 0140-SORT-CONTROL.
  2852
  2853     IF FC-CODE = '2'
  2854         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  2855         IF RD-MO LESS 3
  2856             MOVE 12    TO BD-MO
  2857             MOVE 31    TO BD-DA
  2858             SUBTRACT 1 FROM BD-CCYY
  2859             GO TO 0140-SORT-CONTROL
  2860         ELSE
  2861             IF RD-MO LESS 6
  2862                 MOVE 03 TO BD-MO
  2863                 MOVE 31 TO BD-DA
  2864                 GO TO 0140-SORT-CONTROL
  2865             ELSE
  2866                 IF BD-MO LESS 9
  2867                     MOVE 06 TO BD-MO
  2868                     MOVE 30 TO BD-DA
  2869                     GO TO 0140-SORT-CONTROL
  2870                 ELSE
  2871                     MOVE 09 TO BD-MO
  2872                     MOVE 30 TO BD-DA
  2873                     GO TO 0140-SORT-CONTROL.
  2874
  2875     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  2876     MOVE '6'                   TO DC-OPTION-CODE.
  2877
  2878     EVALUATE FC-CODE
  2879        WHEN '3'
  2880           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  2881           MOVE  -3 TO DC-ELAPSED-MONTHS
  2882        WHEN '4'
  2883           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  2884           MOVE  -6 TO DC-ELAPSED-MONTHS
  2885        WHEN '6'
  2886           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  2887           MOVE  -1 TO DC-ELAPSED-MONTHS
  2888     END-EVALUATE.
  2889
  2890     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  2891     MOVE '1'                   TO DC-END-OF-MONTH.
  2892     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS043P.cbl
  2893     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  2894
  2895
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS043P.cbl
  2897 0140-SORT-CONTROL.
  2898     SORT SORT-WORK ON
  2899         ASCENDING  SW-RPT-TYPE-ID-OUT
  2900                    SW-CTL-OUT
  2901         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  2902         OUTPUT PROCEDURE
  2903             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  2904
  2905     IF SORT-RETURN NOT = ZERO AND 4
  2906          MOVE SORT-RETURN            TO WS-RETURN-CODE
  2907          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  2908          GO TO ABEND-PGM.
  2909
  2910     GOBACK.
  2911
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS043P.cbl
  2913 0150-BUILD-EXTRACTS SECTION.
  2914
  2915 0160-BEGIN-PROCESSING.
  2916     OPEN INPUT
  2917             ACC-MSTR
  2918             ERPLAN-IN
  2919             EPEC-FILE
  2920         OUTPUT
  2921             PRNTR.
  2922
  2923     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  2924         NEXT SENTENCE
  2925       ELSE
  2926         MOVE '11'                TO W-ABEND-CODE-1
  2927         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  2928         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2929         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  2930         GO TO ABEND-PGM.
  2931
  2932     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  2933         NEXT SENTENCE
  2934       ELSE
  2935         MOVE '12'                TO W-ABEND-CODE-1
  2936         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  2937         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  2938         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  2939         GO TO ABEND-PGM.
  2940
  2941     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  2942                           UNTIL SA GREATER 4.
  2943     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  2944                           UNTIL SB GREATER 36.
  2945     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  2946                           UNTIL CL GREATER 10.
  2947
  2948     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  2949     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  2950
  2951     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  2952
  2953     GO TO 0200-CHECK-ACCT-MSTR.
  2954
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS043P.cbl
  2956 0170-CHECK-CONTROL.
  2957
  2958     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  2959
  2960     IF EXCLUDING-BENEFIT
  2961        GO TO 0190-BYPASS-ACCUM.
  2962
  2963     IF DTE-PGM-OPT = '5'
  2964        AND AM-AN-MO NOT = RUN-MO
  2965        GO TO 0190-BYPASS-ACCUM.
  2966
  2967     IF AM-RET-Y-N = 'L'
  2968         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  2969             GO TO 0190-BYPASS-ACCUM.
  2970
  2971     IF AM-RET-Y-N = 'D'
  2972         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  2973             GO TO 0190-BYPASS-ACCUM.
  2974
  2975     IF EP-RECORD-ID = 'EP'
  2976         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  2977             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  2978             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  2979             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  2980         ELSE
  2981             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  2982             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  2983             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  2984
  2985     IF EP-RECORD-ID = 'EP'
  2986         IF EP-RUN-DTE NOT GREATER BEG-DATE
  2987             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  2988                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  2989                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  2990                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  2991             ELSE
  2992                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  2993                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  2994                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  2995
  2996     IF EP-PURGE = 'P'
  2997         IF EP-RUN-DTE GREATER BEG-DATE
  2998             MOVE 'Q' TO EP-PURGE
  2999             GO TO 0180-TEST-ACCUM
  3000         ELSE
  3001             GO TO 0180-TEST-ACCUM.
  3002
  3003     IF EP-RUN-CCYY = RD-CCYY  AND
  3004        EP-RUN-MO = RD-MO
  3005         MOVE '2' TO EP-PURGE
  3006         GO TO 0180-TEST-ACCUM.
  3007
  3008     IF EP-RUN-CCYY = BD-CCYY  AND
  3009        EP-RUN-MO = BD-MO
  3010         MOVE '1' TO EP-PURGE
  3011         GO TO 0180-TEST-ACCUM.
  3012
  3013     GO TO 0190-BYPASS-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS043P.cbl
  3014
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS043P.cbl
  3016 0180-TEST-ACCUM.
  3017     IF EP-RECORD-ID = 'EP'
  3018         IF EP-PURGE = ('1' OR 'P')
  3019             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3020                 MOVE +1 TO SA
  3021                 MOVE LIFE-RETENT   TO RETENT-FACT
  3022                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3023             ELSE
  3024                 MOVE +2 TO SA
  3025                 MOVE   AH-RETENT   TO RETENT-FACT
  3026                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3027
  3028     IF EP-RECORD-ID = 'EP'
  3029         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3030             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3031                 MOVE +3 TO SA
  3032                 MOVE LIFE-RETENT   TO RETENT-FACT
  3033                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3034             ELSE
  3035                 MOVE +4 TO SA
  3036                 MOVE   AH-RETENT   TO RETENT-FACT
  3037                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3038
  3039     IF EP-RECORD-ID = 'EC'
  3040         IF EP-PURGE = ('1' OR 'P')
  3041             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3042                 MOVE +1 TO SA
  3043                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3044             ELSE
  3045                 MOVE +2 TO SA
  3046                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3047
  3048     IF EP-RECORD-ID = 'EC'
  3049         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3050             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3051                 MOVE +3 TO SA
  3052                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3053             ELSE
  3054                 MOVE +4 TO SA
  3055                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3056
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS043P.cbl
  3058 0190-BYPASS-ACCUM.
  3059     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3060
  3061     IF EP-CONTROL = WS-SAVE-CONTROL
  3062         GO TO 0170-CHECK-CONTROL.
  3063
  3064     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3065
  3066     IF EP-CONTROL = HIGH-VALUES
  3067         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3068
  3069     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3070
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS043P.cbl
  3072 0200-CHECK-ACCT-MSTR.
  3073     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3074         IF AM-GPCD = 98
  3075             PERFORM 0360-BUILD-DUMMY-GA
  3076             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3077             GO TO 0200-CHECK-ACCT-MSTR
  3078         ELSE
  3079             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3080             GO TO 0200-CHECK-ACCT-MSTR.
  3081
  3082 0210-NO-ACCT-MSTR.
  3083     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3084         PERFORM 0270-NO-ACCT-MSG
  3085         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3086         IF EP-CONTROL = HIGH-VALUES
  3087             GO TO 0220-BUILD-EXTRACTS-EXIT
  3088         ELSE
  3089             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3090             GO TO 0200-CHECK-ACCT-MSTR.
  3091
  3092     IF DTE-PGM-OPT = '7'
  3093         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3094
  3095     GO TO 0170-CHECK-CONTROL.
  3096
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS043P.cbl
  3098 0215-COMPUTE-BEG-DATE.
  3099     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3100        (AM-AN-MO LESS 01 OR GREATER 12)
  3101            MOVE SAVE-BEG-DATE TO BEG-DATE
  3102            GO TO 0215-EXIT.
  3103
  3104     MOVE RD-CCYY  TO BD-CCYY.
  3105     MOVE AM-AN-MO TO BD-MO.
  3106
  3107     IF BD-MO NOT LESS RD-MO
  3108         SUBTRACT 1 FROM BD-CCYY.
  3109
  3110     IF BD-MO = 04 OR 06 OR 09 OR 11
  3111         MOVE 30 TO BD-DA
  3112     ELSE
  3113         MOVE 31 TO BD-DA.
  3114
  3115     IF BD-MO = 02
  3116         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3117         MOVE 'H'         TO DC-OPTION-CODE
  3118         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3119         IF ONLY-LEAP-YEAR
  3120             MOVE HOLD-CEN-1-DA TO BD-DA
  3121         ELSE
  3122             MOVE 28            TO BD-DA.
  3123
  3124 0215-EXIT.
  3125     EXIT.
  3126
  3127 0220-BUILD-EXTRACTS-EXIT.
  3128     CLOSE
  3129         ACC-MSTR
  3130         ERPLAN-IN
  3131         EPEC-FILE.
  3132
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS043P.cbl
  3134****************************************************************
  3135*                                                              *
  3136****************************************************************
  3137
  3138 0230-PERFORMED-ROUTINES SECTION.
  3139
  3140 0240-READ-EXTRACT.
  3141     READ EPEC-FILE AT END
  3142          MOVE HIGH-VALUES TO EP-CONTROL
  3143          GO TO 0240-EXIT.
  3144
  3145     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3146         GO TO 0240-READ-EXTRACT.
  3147
  3148     IF EP-REIN = 'R'
  3149         GO TO 0240-READ-EXTRACT.
  3150
  3151     IF EP-RUN-DTE GREATER RUN-DT
  3152         GO TO 0240-READ-EXTRACT.
  3153
* 3154     COPY ELCEPCM1.
  3155******************************************************************05/15/98
  3156*                                                                *ELCEPCM1
  3157*                                                                *ELCEPCM1
  3158*                            ELCEPCM1                            *   LV007
  3159*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3160*                            VMOD=2.001                          *ELCEPCM1
  3161*                                                                *ELCEPCM1
  3162*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3163*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3164*                                                                *ELCEPCM1
  3165******************************************************************ELCEPCM1
  3166                                                                     CL**7
  3167     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3168                                 WS-EC-EXP-DTE-N.                    CL**7
  3169     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3170                                 WS-EC-EFF-DTE-N.                    CL**7
  3171     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3172                                 WS-EC-RUN-DTE-N.                    CL**7
  3173                                                                     CL**7
  3174     IF VALID-EP-ID                                                  CL**7
  3175         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3176         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3177         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3178                                                                     CL**7
  3179
  3180 0240-EXIT.
  3181     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS043P.cbl
  3183
  3184 0250-CHECK-PLAN.
  3185
  3186     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3187
  3188*    IF AM-RET-Y-N = ' '   OR  'N'
  3189*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3190*        GO TO 0250-EXIT.
  3191
  3192
  3193     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3194        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3195        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3196        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3197            GO TO 0250-EXIT.
  3198
  3199     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3200     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3201     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3202     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3203
  3204     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3205
  3206     MOVE +1                  TO NDX.
  3207
  3208 0250-PLAN-LOOP.
  3209
  3210     IF NDX GREATER THAN +20
  3211        MOVE +1                 TO NDX
  3212        GO TO 025A-EDIT-FOR-SPECIAL.
  3213
  3214     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3215        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3216          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3217          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3218          GO TO 0250-READ-PLAN
  3219     ELSE
  3220        ADD +1                TO NDX
  3221        GO TO 0250-PLAN-LOOP.
  3222
  3223 0250-READ-PLAN.
  3224
  3225     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3226         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3227         GO TO 0250-EXIT.
  3228
  3229     READ ERPLAN-IN.
  3230
  3231     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3232         NEXT SENTENCE
  3233     ELSE
  3234        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3235            GO TO 0250-PLAN-NOT-FOUND
  3236        ELSE
  3237            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3238            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3239            DISPLAY '**BAD PLAN FILE READ'
  3240            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS043P.cbl
  3241            GO TO ABEND-PGM.
  3242
  3243     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3244        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3245        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3246        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3247           NEXT SENTENCE
  3248     ELSE
  3249           GO TO 0250-PLAN-NOT-FOUND.
  3250
  3251     IF AM-RET-Y-N = ' '   OR  'N'
  3252         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3253         GO TO 0250-EXIT.
  3254
  3255     IF PL-RETRO-RET EQUAL ZEROS
  3256         GO TO 0250-PLAN-NOT-FOUND.
  3257
  3258     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3259         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3260         GO TO 0250-EXIT
  3261     ELSE
  3262         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3263         GO TO 0250-EXIT.
  3264
  3265 025A-EDIT-FOR-SPECIAL.
  3266
  3267     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3268      AND
  3269        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3270          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3271          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3272          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3273          GO TO 0250-READ-PLAN.
  3274
  3275     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3276      AND
  3277        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3278        AND
  3279          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3280          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3281              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3282          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3283          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3284          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3285          GO TO 0250-READ-PLAN.
  3286
  3287     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3288      AND
  3289        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3290      AND
  3291        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3292         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3293            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3294            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3295            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3296            GO TO 0250-READ-PLAN.
  3297
  3298     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS043P.cbl
  3299      AND
  3300        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3301      AND
  3302        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3303         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3304           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3305             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3306             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3307             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3308             GO TO 0250-READ-PLAN.
  3309
  3310     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3311      AND
  3312        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3313      AND
  3314        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3315         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3316             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3317             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3318             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3319             GO TO 0250-READ-PLAN.
  3320
  3321     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3322      AND
  3323        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3324      AND
  3325        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3326         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3327           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3328             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3329             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3330             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3331             GO TO 0250-READ-PLAN.
  3332
  3333     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3334      AND
  3335        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3336      AND
  3337        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3338         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3339           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3340             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3341             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3342             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3343             GO TO 0250-READ-PLAN.
  3344
  3345     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3346      AND
  3347        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3348             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3349             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3350             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3351             GO TO 0250-READ-PLAN.
  3352
  3353     IF NDX NOT LESS THAN +20
  3354       GO TO 0250-PLAN-NOT-FOUND
  3355     ELSE
  3356       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS043P.cbl
  3357       GO TO 025A-EDIT-FOR-SPECIAL.
  3358
  3359
  3360 0250-PLAN-NOT-FOUND.
  3361     IF AM-RET-Y-N = ' '   OR  'N'
  3362         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3363         GO TO 0250-EXIT
  3364     ELSE
  3365         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3366         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3367         GO TO 0250-EXIT.
  3368
  3369 0250-EXIT.
  3370     EXIT.
  3371
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS043P.cbl
  3373 0260-READ-ACCT.
  3374     READ ACC-MSTR
  3375             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3376                    GO TO 0260-EXIT.
  3377
* 3378     COPY ELCACCTI.
  3379******************************************************************04/14/98
  3380*                                                                *ELCACCTI
  3381*                            ELCACCTI                            *   LV003
  3382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3383*                            VMOD=2.001                          *ELCACCTI
  3384*                                                                *ELCACCTI
  3385*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3386*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3387*                                                                *ELCACCTI
  3388*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3389*                                                                *ELCACCTI
  3390******************************************************************ELCACCTI
  3391     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3392     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3393     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3394     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3395     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3396     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3397     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3398     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3399     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3400
  3401     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3402     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3403
  3404
  3405     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3406         MOVE EXPENSE-LINE TO WS-EX-LINE.
  3407
  3408     IF (AM-ACCOUNT = '0000425300')
  3409        AND (AM-AGT (2) = '0000560000')
  3410        IF AM-EFFECT-DT = 19910315
  3411           IF AM-AGT (3) = SPACES OR ZEROS OR LOW-VALUES
  3412              MOVE '0000423100'  TO AM-AGT (3)
  3413              MOVE 'P'           TO AM-COM-TYP (3)
  3414              MOVE ZEROS         TO AM-L-COM (3)
  3415                                    AM-J-COM (3)
  3416                                    AM-A-COM (3)
  3417              MOVE 'A'           TO AM-RETRO-LV-INDIC (3)
  3418           ELSE
  3419              MOVE '0000423100'  TO AM-AGT (4)
  3420              MOVE 'P'           TO AM-COM-TYP (4)
  3421              MOVE ZEROS         TO AM-L-COM (4)
  3422                                    AM-J-COM (4)
  3423                                    AM-A-COM (4)
  3424              MOVE 'A'           TO AM-RETRO-LV-INDIC (4)
  3425           END-IF
  3426        ELSE
  3427           DISPLAY ' GOT HERE ' AM-EFFECT-DT
  3428*          IF AM-AGT (3) = SPACES OR ZEROS OR LOW-VALUES
  3429              MOVE '0000423200'  TO AM-AGT (3)
  3430              MOVE 'P'           TO AM-COM-TYP (3)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS043P.cbl
  3431              MOVE ZEROS         TO AM-L-COM (3)
  3432                                    AM-J-COM (3)
  3433                                    AM-A-COM (3)
  3434              MOVE 'A'           TO AM-RETRO-LV-INDIC (3)
  3435*          ELSE
  3436*             MOVE '0000423200'  TO AM-AGT (4)
  3437*             MOVE 'P'           TO AM-COM-TYP (4)
  3438*             MOVE ZEROS         TO AM-L-COM (4)
  3439*                                   AM-J-COM (4)
  3440*                                   AM-A-COM (4)
  3441*             MOVE 'A'           TO AM-RETRO-LV-INDIC (4)
  3442*          END-IF
  3443        END-IF
  3444     END-IF
  3445
  3446     IF DTE-PGM-OPT  = '5' AND
  3447        AM-AN-MO NOT = RUN-MO
  3448         MOVE SPACES TO AM-RETRO-POOL
  3449         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3450         MOVE 'N'    TO AM-RET-Y-N.
  3451
  3452     IF DTE-CLIENT = 'GIC'
  3453         MOVE 'P' TO AM-RET-P-E.
  3454     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3455        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3456         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3457
  3458     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3459         MOVE 'E'              TO AM-RET-P-E.
  3460     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3461         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3462     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3463         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
  3464     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3465         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3466     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
  3467         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3468     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
  3469         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3470     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3471         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3472
  3473     IF AM-RETRO-USE-LIFE-METHOD
  3474         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3475
  3476 0260-EXIT.
  3477     EXIT.
  3478
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS043P.cbl
  3480 0270-NO-ACCT-MSG.
  3481     IF LINE-CNT GREATER +55
  3482         MOVE ZERO   TO LINE-CNT
  3483         MOVE '1'    TO X
  3484         MOVE HEAD-1 TO P-DATA
  3485         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3486         MOVE ' '    TO X
  3487         MOVE HEAD-2 TO P-DATA
  3488         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3489         ADD +1               TO PAGE-CNT
  3490         MOVE PAGE-CNT        TO H3-PAGE
  3491         MOVE ' '    TO X
  3492         MOVE HEAD-3 TO P-DATA
  3493         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3494         MOVE ' '    TO X
  3495         MOVE HEAD-4 TO P-DATA
  3496         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3497         MOVE ' '    TO X
  3498         MOVE SPACES TO P-DATA
  3499         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3500
  3501     MOVE WS-SAVE-CARR     TO H5-CARR.
  3502     MOVE WS-SAVE-COMP     TO H5-COMP.
  3503     MOVE WS-SAVE-STATE    TO H5-ST.
  3504     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3505     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3506     MOVE WK-YR            TO H5-TYR.
  3507     MOVE WK-MO            TO H5-TMO.
  3508     MOVE WK-DA            TO H5-TDA.
  3509     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3510     MOVE WK-YR            TO H5-FYR.
  3511     MOVE WK-MO            TO H5-FMO.
  3512     MOVE WK-DA            TO H5-FDA.
  3513     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3514     MOVE ' '              TO X.
  3515     MOVE HEAD-5           TO P-DATA.
  3516     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3517
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS043P.cbl
  3519 0280-CALCULATE-RETRO.
  3520******************************************************************
  3521*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3522
  3523     IF DTE-CLIENT NOT = 'POS'
  3524         GO TO 0290-SKIP-CC.
  3525
  3526     IF AM-CARRIER NOT = '1'
  3527         GO TO 0290-SKIP-CC.
  3528
  3529     IF AM-FLD-5 NOT = 'CC'
  3530         GO TO 0290-SKIP-CC.
  3531
  3532     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3533                     - DA-UP (1))) - DA-CLM (1).
  3534     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3535                     - DA-UP (2))) - DA-CLM (2).
  3536     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3537                     - DA-UP (3))) - DA-CLM (3).
  3538     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3539                     - DA-UP (4))) - DA-CLM (4).
  3540
  3541     IF DA-LRV (1) LESS ZERO
  3542         ADD DA-LRV (1) TO DA-LRV (2)
  3543         MOVE ZEROS TO DA-LRV (1)
  3544         IF DA-LRV (2) LESS ZERO
  3545             MOVE ZEROS TO DA-LRV (2).
  3546
  3547     IF DA-LRV (2) LESS ZERO
  3548         ADD DA-LRV (2) TO DA-LRV (1)
  3549         MOVE ZEROS TO DA-LRV (2)
  3550         IF DA-LRV (1) LESS ZERO
  3551             MOVE ZEROS TO DA-LRV (1).
  3552
  3553     IF DA-LRV (3) LESS ZERO
  3554         ADD DA-LRV (3) TO DA-LRV (4)
  3555         MOVE ZEROS TO DA-LRV (3)
  3556         IF DA-LRV (4) LESS ZERO
  3557             MOVE ZEROS TO DA-LRV (4).
  3558
  3559     IF DA-LRV (4) LESS ZERO
  3560         ADD DA-LRV (4) TO DA-LRV (3)
  3561         MOVE ZEROS TO DA-LRV (4)
  3562         IF DA-LRV (3) LESS ZERO
  3563             MOVE ZEROS TO DA-LRV (3).
  3564
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS043P.cbl
  3566******************************************************************
  3567**       END OF SPECIAL OLI CODING
  3568******************************************************************
  3569
  3570 0290-SKIP-CC.
  3571
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS043P.cbl
  3573 0300-CALC-RETRO-A.
  3574
  3575     MOVE +1 TO SA.
  3576     MOVE +3 TO SB.
  3577     MOVE +1 TO SC.
  3578     MOVE +3 TO SF.
  3579     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3580     MOVE +2 TO SA.
  3581     MOVE +4 TO SB.
  3582     MOVE +2 TO SC.
  3583     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3584     MOVE +3 TO SB.
  3585     MOVE +4 TO SC.
  3586     MOVE +6 TO SF.
  3587     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3588     MOVE +4 TO SB.
  3589     MOVE +5 TO SC.
  3590     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3591     MOVE SPACES       TO SW-REC.
  3592     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3593     MOVE AM-NAME      TO SW-NAME.
  3594     MOVE AM-ADDRS     TO SW-ADDRS.
  3595     MOVE AM-CITY      TO SW-CITY.
  3596     MOVE AM-ZIP       TO SW-ZIP.
  3597     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3598     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3599
  3600     IF PA-EP (4) NOT EQUAL ZEROS
  3601        COMPUTE LIFE-RETENT ROUNDED =
  3602            PA-PE (4) / PA-EP (4)
  3603     ELSE
  3604        MOVE +0.0      TO LIFE-RETENT.
  3605
  3606     IF PA-EP (5) NOT EQUAL ZEROS
  3607        COMPUTE AH-RETENT  ROUNDED =
  3608            PA-PE (5) / PA-EP (5)
  3609     ELSE
  3610        MOVE +0.0      TO AH-RETENT.
  3611
  3612     MOVE LIFE-RETENT  TO SW-LRET.
  3613     MOVE AH-RETENT    TO SW-ARET.
  3614     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3615     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3616     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3617     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3618     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3619     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3620     MOVE AM-CARRIER   TO SW-CARR.
  3621     MOVE AM-GROUPING  TO SW-COMP.
  3622     MOVE AM-STATE     TO SW-STATE.
  3623     MOVE AM-ACCOUNT   TO SW-ACCT.
  3624     MOVE BEG-DATE     TO SW-BEG-DATE.
  3625
  3626 0310-EXIT.
  3627     EXIT.
  3628
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS043P.cbl
  3630 0320-CONT-RETRO-A.
  3631     IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3632         RELEASE SW-REC-OUT FROM SW-REC
  3633         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3634
  3635     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3636         MOVE AM-RETRO-POOL TO SW-GA
  3637         MOVE 'B'           TO SW-RPT-TYPE-ID
  3638         IF DTE-CLIENT NOT = 'VSL'
  3639             RELEASE SW-REC-OUT FROM SW-REC
  3640             ADD +1 TO NO-OF-RECORDS-RELEASED
  3641         ELSE
  3642             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3643                 RELEASE SW-REC-OUT FROM SW-REC
  3644                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3645
  3646     IF DTE-CLIENT = 'TAO'
  3647         MOVE AM-USER-FIELDS TO Z-G
  3648         MOVE ZONE-GROUP     TO SW-GA
  3649         MOVE 'B'            TO SW-RPT-TYPE-ID
  3650         RELEASE SW-REC-OUT FROM SW-REC
  3651         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3652
  3653     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3654                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3655                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3656                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3657
  3658     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3659         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3660
  3661     IF AM-GPCD = 98
  3662         MOVE AM-ACCOUNT  TO SW-GA
  3663         MOVE 'X'         TO SW-GA-FLAG
  3664         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3665         MOVE 'C'         TO SW-RPT-TYPE-ID
  3666         RELEASE SW-REC-OUT FROM SW-REC
  3667         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3668
  3669     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3670                          UNTIL SA GREATER 4.
  3671     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3672                          UNTIL SB GREATER 6.
  3673     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3674                          UNTIL CL GREATER 10.
  3675
  3676 0330-EXIT.
  3677     EXIT.
  3678
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS043P.cbl
  3680 0340-GA-EXT-LOOP.
  3681     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B'
  3682         NEXT SENTENCE
  3683      ELSE
  3684         GO TO 0350-EXIT.
  3685
  3686     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3687     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3688     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3689     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3690     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3691     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3692     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3693     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3694     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3695     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3696     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3697     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3698
  3699     MOVE 3 TO SB.
  3700     PERFORM 0560-ZERO-PA.
  3701     MOVE 6 TO SB.
  3702     PERFORM 0560-ZERO-PA.
  3703     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3704     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3705     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3706     RELEASE SW-REC-OUT FROM SW-REC.
  3707     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3708
  3709 0350-EXIT.
  3710     EXIT.
  3711
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS043P.cbl
  3713 0360-BUILD-DUMMY-GA.
  3714
  3715     MOVE SPACES       TO SW-REC.
  3716     MOVE -9999999     TO SW-RETRO-LIMIT.
  3717     MOVE 'X'          TO SW-GA-FLAG.
  3718     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3719     MOVE AM-NAME      TO SW-NAME.
  3720     MOVE AM-ADDRS     TO SW-ADDRS.
  3721     MOVE AM-CITY      TO SW-CITY.
  3722     MOVE AM-ZIP       TO SW-ZIP.
  3723     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3724     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3725
  3726     IF AM-RET-Y-N = ' '   OR  'N'
  3727         MOVE +1.0 TO SW-LRET SW-ARET
  3728     ELSE
  3729         COMPUTE SW-LRET = 1 - AM-LF-RET
  3730         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3731
  3732     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3733     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3734     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3735     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3736     RELEASE SW-REC-OUT FROM SW-REC.
  3737     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3738
  3739 0370-EXIT.
  3740     EXIT.
  3741
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS043P.cbl
  3743 0380-COMPUTE-YTD.
  3744     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3745                          (DA-ISP (SA) - DA-CNP (SA)).
  3746
  3747     IF AM-RETRO-PREM-P-E = 'E'
  3748         MOVE DA-UP (SA) TO PA-BR (SC)
  3749         MOVE DA-UP (SB) TO PA-ER (SC).
  3750
  3751     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3752
  3753     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3754
  3755     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3756
  3757     IF AM-RETRO-CLMS-P-I = 'I'
  3758         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3759         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3760
  3761     IF DTE-CLIENT = 'ABL'
  3762         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3763         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3764            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3765         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3766
  3767     IF DTE-CLIENT = 'GIC'
  3768         IF SC = +1
  3769             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3770             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3771         ELSE
  3772             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3773             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3774
  3775     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3776         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3777
  3778     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3779         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3780
  3781     IF SC = +1
  3782         COMPUTE WS-MIN-LOSS ROUNDED =
  3783            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3784                                              + PA-BLR (SC)
  3785        ELSE
  3786         COMPUTE WS-MIN-LOSS ROUNDED =
  3787            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3788                                              + PA-BLR (SC).
  3789     IF SC = +1
  3790         IF AM-RET-MIN-LOSS-L = ZERO
  3791            MOVE ZERO TO WS-MIN-LOSS.
  3792
  3793     IF SC = +2
  3794         IF AM-RET-MIN-LOSS-A = ZERO
  3795            MOVE ZERO TO WS-MIN-LOSS.
  3796
  3797     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3798         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3799
  3800     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS043P.cbl
  3801
  3802     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3803                           (DA-ISC (SA) - DA-CNC (SA))) +
  3804                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3805                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3806
  3807     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3808                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3809
  3810     IF AM-RET-P-E = 'P'
  3811         MOVE PA-RC (SC) TO PA-CU (SC)
  3812      ELSE
  3813         MOVE PA-EC (SC) TO PA-CU (SC).
  3814
  3815     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3816     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3817     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3818
  3819     IF DTE-CLIENT = 'FLA'
  3820         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3821      ELSE
  3822         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  3823
  3824     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3825         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3826              IF SC = 1
  3827                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3828*                          (PA-NW (SC) * AM-REI-LF-TAX)
  3829                    (DA-TAX (SB) - DA-TAX (SA))
  3830               ELSE
  3831                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3832*                          (PA-NW (SC) * AM-REI-AH-TAX)
  3833                    (DA-TAX (SB) - DA-TAX (SA))
  3834          ELSE
  3835                 IF SC = 1
  3836                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3837*                             (PA-EP (SC) * AM-REI-LF-TAX)
  3838                       (PA-EP (SC) / PA-NW (SC)) *
  3839                       (DA-TAX (SB) - DA-TAX (SA))
  3840                  ELSE
  3841                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3842*                             (PA-EP (SC) * AM-REI-AH-TAX).
  3843                       (PA-EP (SC) / PA-NW (SC)) *
  3844                       (DA-TAX (SB) - DA-TAX (SA))
  3845
  3846     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3847                          + PA-CP (SC) + PA-EX (SC).
  3848     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3849     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3850     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3851     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  3852                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  3853     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  3854                                        DA-GA-UC (SB).
  3855     PERFORM 0520-ADD-PA-LEVELS.
  3856
  3857 0390-EXIT.
  3858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS043P.cbl
  3859
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS043P.cbl
  3861 0400-COMPUTE-ITD.
  3862     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  3863
  3864     IF AM-RETRO-PREM-P-E = 'E'
  3865         MOVE DA-UP (SB)       TO PA-ER (SC).
  3866
  3867     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  3868
  3869     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  3870
  3871     MOVE DA-CLM (SB)          TO PA-PL (SC).
  3872
  3873     IF AM-RETRO-CLMS-P-I = 'I'
  3874         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  3875
  3876     IF DTE-CLIENT = 'ABL'
  3877         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  3878
  3879     IF DTE-CLIENT = 'GIC'
  3880         IF SC = +4
  3881             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3882         ELSE
  3883             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3884
  3885     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3886         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3887
  3888     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3889         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3890
  3891     IF SC = +4
  3892         COMPUTE WS-MIN-LOSS ROUNDED =
  3893            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3894     ELSE
  3895         COMPUTE WS-MIN-LOSS ROUNDED =
  3896            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  3897
  3898     IF SC = +4
  3899         IF AM-RET-MIN-LOSS-L = ZERO
  3900            MOVE ZERO TO WS-MIN-LOSS.
  3901
  3902     IF SC = +5
  3903         IF AM-RET-MIN-LOSS-A = ZERO
  3904            MOVE ZERO TO WS-MIN-LOSS.
  3905
  3906     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3907         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3908
  3909     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  3910
  3911
  3912     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  3913                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  3914     COMPUTE PA-EC (SC) =
  3915                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  3916
  3917     IF AM-RET-P-E = 'P'
  3918         MOVE PA-RC (SC) TO PA-CU (SC)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS043P.cbl
  3919     ELSE
  3920         MOVE PA-EC (SC) TO PA-CU (SC).
  3921
  3922     MOVE DA-OTC (SB) TO PA-OC (SC).
  3923     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC).
  3924     MOVE DA-CPS (SB) TO PA-CP (SC).
  3925
  3926     IF DTE-CLIENT = 'FLA'
  3927        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3928     ELSE
  3929        MOVE DA-EXP (SB) TO PA-EX (SC)
  3930     END-IF
  3931
  3932*    MOVE 'P' TO AM-RET-ST-TAX-USE
  3933*    MOVE 'P' TO AM-RET-P-E
  3934     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3935        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  3936           IF SC = 4
  3937              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3938*                (PA-NW (SC) * AM-REI-LF-TAX)
  3939                 DA-TAX (SB)
  3940           ELSE
  3941              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3942*                (PA-NW (SC) * AM-REI-AH-TAX)
  3943                 DA-TAX (SB)
  3944           END-IF
  3945        ELSE
  3946           IF SC = 4
  3947              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3948*                (PA-EP (SC) * AM-REI-LF-TAX)
  3949                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  3950           ELSE
  3951              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  3952*                (PA-EP (SC) * AM-REI-AH-TAX).
  3953                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  3954           END-IF
  3955        END-IF
  3956     END-IF
  3957
  3958     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  3959                        + PA-CP (SC) + PA-EX (SC).
  3960     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  3961     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  3962     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  3963     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  3964     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
  3965
  3966     PERFORM 0520-ADD-PA-LEVELS.
  3967
  3968 0410-EXIT.
  3969     EXIT.
  3970
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS043P.cbl
  3972 0420-CALCULATE-GA.
  3973     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  3974
  3975     IF SAVE-RET-TYP = 'E'
  3976         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  3977     ELSE
  3978         MOVE PA-GARC (SC) TO PA-GACU (SC).
  3979
  3980     COMPUTE PA-GATC (SC) = PA-TC (SC) + PA-GACU (SC).
  3981     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  3982     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  3983     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  3984                                      - PA-NBA (SC).
  3985     ADD PA-GACU (SC) TO PA-GACU (SF).
  3986     ADD PA-GATC (SC) TO PA-GATC (SF).
  3987     ADD PA-GATE (SC) TO PA-GATE (SF).
  3988     ADD PA-GABA (SC) TO PA-GABA (SF).
  3989     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  3990
  3991 0430-EXIT.
  3992
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS043P.cbl
  3994 0440-GENERATE-RETRO.
  3995     IF DTE-PGM-OPT = '1'
  3996         AND H1-REPORT-SUF NOT = 'A'
  3997     OR DTE-PGM-OPT = '2'
  3998         AND H1-REPORT-SUF NOT = 'B'
  3999     OR DTE-PGM-OPT = '3'
  4000         AND H1-REPORT-SUF NOT = 'C'
  4001             GO TO 0470-EXIT.
  4002
  4003     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4004        H1-REPORT-SUF NOT = ('A' AND 'B')
  4005          GO TO 0470-EXIT.
  4006
  4007     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  4008                            UNTIL SB GREATER 2
  4009       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 27.
  4010
  4011     MOVE +1 TO SE.
  4012     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4013     MOVE +2 TO SE.
  4014     ADD +3 TO SF.
  4015
  4016     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4017     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  4018
  4019     IF HEAD-SW = '1' OR '2'
  4020         IF SAVE-RET-TYP = 'E'
  4021             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  4022         ELSE
  4023             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  4024     ELSE
  4025         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  4026
  4027     MOVE +1 TO SB.
  4028
  4029 0450-PRINT-LOOP.
  4030     IF DT-SS-R (SB SH) = SPACES
  4031         GO TO 0460-CHECK-NEXT-LINE.
  4032
  4033     IF DT-SS-R (SB SH) = '00'
  4034         MOVE DT-CTL-CHAR (SB) TO X
  4035         MOVE DT-ENTRY (SB)    TO DL-DESC
  4036         MOVE DETAIL-LINE      TO P-DATA
  4037         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4038         GO TO 0460-CHECK-NEXT-LINE.
  4039
  4040     MOVE DT-CTL-CHAR (SB) TO X.
  4041     MOVE DT-SS (SB SH)    TO SA.
  4042
  4043     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4044
  4045 0460-CHECK-NEXT-LINE.
  4046     ADD +1 TO SB.
  4047     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4048         GO TO 0450-PRINT-LOOP.
  4049
  4050     MOVE '-'    TO X.
  4051     MOVE SPACES TO P-DATA.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS043P.cbl
  4052     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4053*    IF (DTE-FMT-OPT  =  2)        AND
  4054*       (BREAK-1-SWITCH NOT = ' ')   AND
  4055*       (H1-REPORT-SUF = 'A')
  4056*       NEXT SENTENCE
  4057*    ELSE
  4058*       ADD 1 TO PAGE-CNT.
  4059*    MOVE PAGE-CNT TO H9-PAGE.
  4060*    MOVE HEAD-9   TO P-DATA.
  4061*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4062
  4063 0470-EXIT.
  4064     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS043P.cbl
  4066
  4067 0480-COMPUTE-PERCENTS.
  4068     IF PA-EP (SF) = ZERO
  4069         GO TO 0490-EXIT.
  4070
  4071     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4072         PA-PE (SF) / PA-EP (SF).
  4073     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4074         PA-TL (SF) / PA-EP (SF).
  4075     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4076         PA-TC (SF) / PA-EP (SF).
  4077
  4078     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4079         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4080             PA-TC (SF) / PA-NW (SF).
  4081
  4082     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4083         PA-CP (SF) / PA-EP (SF).
  4084     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4085         PA-EX (SF) / PA-EP (SF).
  4086     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4087         PA-BA (SF) / PA-EP (SF).
  4088     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4089         PA-NTE (SF) / PA-EP (SF).
  4090     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4091         PA-NBA (SF) / PA-EP (SF).
  4092     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4093         PA-GATC (SF) / PA-EP (SF).
  4094     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4095         PA-GAGT (SF) / PA-EP (SF).
  4096     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4097         PA-GABA (SF) / PA-EP (SF).
  4098     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4099         PA-GATE (SF) / PA-EP (SF).
  4100
  4101     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4102     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4103     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4104     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4105     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4106     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4107     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4108     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4109     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4110     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4111     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4112     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4113
  4114 0490-EXIT.
  4115     EXIT.
  4116
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS043P.cbl
  4118 0500-PRINT-DETAIL.
  4119     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4120     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4121     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4122     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4123     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4124     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4125     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4126     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4127     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4128     MOVE DETAIL-LINE      TO P-DATA.
  4129     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4130     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4131
  4132 0510-EXIT.
  4133     EXIT.
  4134
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS043P.cbl
  4136 0520-ADD-PA-LEVELS.
  4137     ADD PA-NW   (SC) TO PA-NW   (SF).
  4138     ADD PA-BR   (SC) TO PA-BR   (SF).
  4139     ADD PA-ER   (SC) TO PA-ER   (SF).
  4140     ADD PA-EP   (SC) TO PA-EP   (SF).
  4141     ADD PA-PE   (SC) TO PA-PE   (SF).
  4142     ADD PA-PL   (SC) TO PA-PL   (SF).
  4143     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4144     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4145     ADD PA-TL   (SC) TO PA-TL   (SF).
  4146     ADD PA-RC   (SC) TO PA-RC   (SF).
  4147     ADD PA-OC   (SC) TO PA-OC   (SF).
  4148     ADD PA-TC   (SC) TO PA-TC   (SF).
  4149     ADD PA-CP   (SC) TO PA-CP   (SF).
  4150     ADD PA-EX   (SC) TO PA-EX   (SF).
  4151     ADD PA-TE   (SC) TO PA-TE   (SF).
  4152     ADD PA-BA   (SC) TO PA-BA   (SF).
  4153     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4154     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4155     ADD PA-EC   (SC) TO PA-EC   (SF).
  4156     ADD PA-GARC (SC) TO PA-GARC (SF).
  4157     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4158     ADD PA-GACU (SC) TO PA-GACU (SF).
  4159     ADD PA-CU   (SC) TO PA-CU   (SF).
  4160     ADD PA-GATC (SC) TO PA-GATC (SF).
  4161     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4162     ADD PA-GABA (SC) TO PA-GABA (SF).
  4163     ADD PA-GATE (SC) TO PA-GATE (SF).
  4164
  4165 0530-ADD-UP-LEVELS.
  4166     PERFORM 0520-ADD-PA-LEVELS.
  4167     ADD +1 TO SC
  4168               SF.
  4169
  4170 0540-EXIT.
  4171     EXIT.
  4172
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS043P.cbl
  4174 0550-ZERO-DA.
  4175     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4176                DA-TAX (SA)
  4177                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4178                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4179                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4180                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4181                DA-PCT-E-PREM (SA).
  4182
  4183 0560-ZERO-PA.
  4184     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4185                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4186                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4187                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4188                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4189                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4190                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4191                PA-GATE (SB)  PA-CU (SB).
  4192
  4193 0570-ZERO-XDA.
  4194
  4195     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4196                           UNTIL SA GREATER THAN 4.
  4197
  4198 0575-ZERO-XDA.
  4199
  4200     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4201                                     XDA-GA-TYPE (CL).
  4202     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4203                                     XDA-GA-CNC (CL SA)
  4204                                     XDA-GA-UC  (CL SA).
  4205
  4206 0580-ZERO-PCNT.
  4207     MOVE +0 TO PT-PRCNT (SB SC).
  4208
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS043P.cbl
  4210 0590-HEADING-ROUTINE.
  4211     IF DTE-PGM-OPT = '1'
  4212         AND H1-REPORT-SUF NOT = 'A'
  4213     OR DTE-PGM-OPT = '2'
  4214         AND H1-REPORT-SUF NOT = 'B'
  4215     OR DTE-PGM-OPT = '3'
  4216         AND H1-REPORT-SUF NOT = 'C'
  4217             GO TO 0600-EXIT.
  4218
  4219     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4220        H1-REPORT-SUF NOT = ('A' AND 'B')
  4221        GO TO 0600-EXIT.
  4222
  4223     MOVE '1'    TO X.
  4224     MOVE HEAD-1 TO P-DATA.
  4225     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4226     MOVE ' '    TO X.
  4227     MOVE HEAD-2 TO P-DATA.
  4228     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4229     ADD +1               TO PAGE-CNT.
  4230     MOVE PAGE-CNT        TO H3-PAGE.
  4231     MOVE HEAD-3 TO P-DATA.
  4232     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4233
  4234     IF HEAD-SW = '1' OR '2'
  4235         MOVE '0'    TO X
  4236         MOVE HEAD-4 TO P-DATA
  4237         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4238         MOVE ' '    TO X
  4239         MOVE HEAD-5 TO P-DATA
  4240         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4241
  4242     MOVE '0' TO X.
  4243     IF DTE-PGM-OPT = '7'
  4244         IF HEAD-SW NOT = '1' AND '2'
  4245             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4246         ELSE
  4247             MOVE BD-MO     TO H6R-MO
  4248             MOVE BD-DA     TO H6R-DA
  4249             MOVE BD-CCYY   TO H6R-CCYY
  4250             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4251             MOVE ' TO DATE '       TO H6R-MSG
  4252             MOVE ' '       TO H6R-FILLER.
  4253
  4254     MOVE HEAD-6 TO P-DATA.
  4255     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4256     MOVE ' '    TO X.
  4257     MOVE HEAD-7 TO P-DATA.
  4258     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4259     MOVE '0'    TO X.
  4260
  4261 0600-EXIT.
  4262     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS043P.cbl
  4264
  4265 0610-PRT-RTN.
  4266****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4267
  4268     IF (DTE-FMT-OPT  =  2)        AND
  4269        (BREAK-1-SWITCH NOT = ' ')   AND
  4270        (H1-REPORT-SUF = 'A')
  4271             MOVE SPACES TO P-DATA  DETAIL-LINE
  4272             GO TO 0630-EXIT.
  4273
  4274 0620-PRT-REST.
  4275*                            COPY ELCPRT2.
* 4276                             COPY PRTN043.
  4277******************************************************************
  4278*                                                                *
  4279*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4280*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4281*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4282*                                                                *
  4283******************************************************************
  4284*                                                                *
  4285*                            ELCPRTN                             *
  4286*                            VMOD=2.002                          *
  4287*                                                                *
  4288******************************************************************
  4289*                   C H A N G E   L O G
  4290*
  4291* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4292*-----------------------------------------------------------------
  4293*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4294* EFFECTIVE    NUMBER
  4295*-----------------------------------------------------------------
  4296* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4297******************************************************************
  4298
  4299     IF DTE-FICH NOT = SPACE AND
  4300        FICH-OPEN    = SPACE
  4301         MOVE 'X' TO FICH-OPEN
  4302         OPEN OUTPUT FICH.
  4303
  4304     IF DTE-FICH NOT = SPACE
  4305         MOVE X TO P-CTL
  4306         WRITE FICH-REC FROM PRT.
  4307
  4308     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4309         GO TO SKIP-A-REPORT.
  4310
  4311     IF DTE-FICH = SPACE OR '2'
  4312       MOVE X                    TO  P-CTL
  4313       IF P-CTL = ' '
  4314         WRITE PRT AFTER ADVANCING 1 LINE
  4315       ELSE
  4316         IF P-CTL = '0'
  4317           WRITE PRT AFTER ADVANCING 2 LINES
  4318         ELSE
  4319           IF P-CTL = '-'
  4320             WRITE PRT AFTER ADVANCING 3 LINES
  4321           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS043P.cbl (/apps/prod/cid1p/copy/PRTN043)
  4322             WRITE PRT AFTER ADVANCING PAGE.
  4323
  4324******************************************************************
  4325
  4326******************************************************************
  4327 SKIP-A-REPORT.
  4328     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4329
  4330 0630-EXIT.
  4331     EXIT.
  4332
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS043P.cbl
  4334 0640-EP-ADD.
  4335     ADD EP-ISS-PRM TO DA-ISP (SA).
  4336     ADD EP-PRM-TAX TO DA-TAX (SA).
  4337     ADD EP-CNC-PRM TO DA-CNP (SA).
  4338     ADD EP-CLM-AMT TO DA-CLM (SA).
  4339     ADD EP-CLM-DU TO DA-LRV (SA).
  4340
  4341     IF DTE-CLIENT NOT = 'ABL'
  4342         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4343
  4344     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4345     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4346
  4347     IF DTE-CLIENT = 'ABL'
  4348         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4349
  4350*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4351
  4352     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4353     MOVE 0                    TO SAVE-DA-PCT-UP.
  4354
  4355     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4356         COMPUTE SAVE-DA-PCT-UP =
  4357                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4358         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4359                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4360
  4361     IF WS-EP-CODE = 'P'
  4362         COMPUTE SAVE-DA-PCT-UP =
  4363                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4364         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4365                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4366
  4367     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4368         COMPUTE SAVE-DA-PCT-UP =
  4369                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4370         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4371                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4372
  4373     IF WS-EP-CODE = 'M'
  4374         COMPUTE SAVE-DA-PCT-UP =
  4375             ((EP-ISS-PRM - EP-CNC-PRM) -
  4376               ((EP-PRM-PR + EP-PRM-78) * .5))
  4377         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4378             ((EP-ISS-PRM - EP-CNC-PRM) -
  4379               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4380
  4381     IF WS-EP-CODE = '1'
  4382         COMPUTE SAVE-DA-PCT-UP =
  4383             ((EP-ISS-PRM - EP-CNC-PRM) -
  4384              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4385         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4386             ((EP-ISS-PRM - EP-CNC-PRM) -
  4387              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4388
  4389     IF WS-EP-CODE = '2'
  4390         COMPUTE SAVE-DA-PCT-UP =
  4391             ((EP-ISS-PRM - EP-CNC-PRM) -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS043P.cbl
  4392              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4393         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4394             ((EP-ISS-PRM - EP-CNC-PRM) -
  4395              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4396
  4397     IF AM-RETRO-PREM-P-E = 'E'
  4398         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4399             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4400                                                 * RETENT-FACT
  4401     ELSE
  4402         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4403                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4404
  4405     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4406
  4407 0640-EXIT.
  4408     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS043P.cbl
  4410
  4411 0650-EP-EARN-TYPE.
  4412     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4413
  4414 0652-ST-LOOK-UP.
  4415     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4416         NEXT SENTENCE
  4417      ELSE
  4418          ADD +1 TO CLAS-INDEXS
  4419          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4420              GO TO 0652-ST-LOOK-UP
  4421           ELSE
  4422             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4423             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4424             MOVE 0402      TO WS-RETURN-CODE
  4425             GO TO ABEND-PGM.
  4426
  4427     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4428         MOVE CLAS-STARTA TO CLAS-INDEXA
  4429         GO TO 0670-EP-EARN-AH.
  4430
  4431     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4432
  4433 0660-EP-EARN-TYPE-LOOP.
  4434     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4435         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4436         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4437         MOVE 0401            TO WS-RETURN-CODE
  4438         GO TO ABEND-PGM.
  4439
  4440     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4441         ADD +1 TO CLAS-INDEXL
  4442         GO TO 0660-EP-EARN-TYPE-LOOP.
  4443
  4444     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4445
  4446     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4447          MOVE 'P' TO WS-EP-CODE.
  4448
  4449     IF DTE-CLIENT = 'ITG'
  4450          MOVE 'P' TO WS-EP-CODE.
  4451
  4452     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4453       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4454           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4455     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4456       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4457           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4458
  4459     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4460
  4461     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4462       AND (SA = 1 OR 2)
  4463       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4464           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4465
  4466     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4467       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS043P.cbl
  4468       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4469           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4470
  4471     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS043P.cbl
  4473
  4474 0670-EP-EARN-AH.
  4475     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4476         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4477         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4478         MOVE 0402         TO WS-RETURN-CODE
  4479         GO TO ABEND-PGM.
  4480
  4481     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4482         ADD +1 TO CLAS-INDEXA
  4483         GO TO 0670-EP-EARN-AH.
  4484
  4485     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4486
  4487     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4488          MOVE 'P' TO WS-EP-CODE.
  4489
  4490     IF DTE-CLIENT = 'ITG'
  4491          MOVE 'P' TO WS-EP-CODE.
  4492
  4493     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4494       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4495           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4496
  4497     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4498       AND (SA = 1 OR 2)
  4499       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4500           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4501
  4502     IF DTE-CLIENT = 'ITY'
  4503         IF EP-CARRIER = '5' OR '7'
  4504              MOVE '1' TO WS-EP-CODE.
  4505
  4506     IF DTE-CLIENT = 'GIC'
  4507         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4508              MOVE '2' TO WS-EP-CODE.
  4509
  4510     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4511                     'UW1' OR 'DDB' OR 'GSL'
  4512         MOVE 'M'                  TO WS-EP-CODE.
  4513
  4514     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4515
  4516 0680-EXIT.
  4517     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS043P.cbl
  4519
  4520 0690-EC-ADD.
  4521     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4522         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4523
  4524     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS043P.cbl
  4526
  4527 0700-ACCT-EC-ADD.
  4528******************************************************************
  4529*         CL - AGENT LEVEL WITHIN EC RECORD
  4530*         AL - AGENT LEVEL WITHIN GA TABLE
  4531*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4532******************************************************************
  4533
  4534     IF EC-AGT-NO (CL) = ZEROS
  4535         GO TO 0710-EXIT.
  4536
  4537     IF EC-SEQ-NBR GREATER THAN 1
  4538         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4539         SUBTRACT +1 FROM WS-SEQ-NBR
  4540         COMPUTE AL = WS-SEQ-NBR * 5.
  4541
  4542     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4543
  4544     IF WS-RETRO-FLAG = 'N'
  4545        GO TO 0710-EXIT.
  4546
  4547     MOVE +1                     TO  AL.
  4548
  4549 0700-LOOP.
  4550
  4551     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4552         GO TO 0705-ACCUM.
  4553
  4554     IF XDA-GA-NO (AL) = SPACES
  4555         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4556         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4557         GO TO 0705-ACCUM.
  4558
  4559     ADD +1 TO AL.
  4560
  4561     IF AL GREATER THAN EC-REC-MAX
  4562         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4563                                 TO  WS-ABEND-MESSAGE
  4564         GO TO ABEND-PGM.
  4565
  4566     GO TO 0700-LOOP.
  4567
  4568 0705-ACCUM.
  4569
  4570     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4571         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4572         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4573
  4574     IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4575         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4576         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4577       IF AM-RETRO-LV-INDIC (AL) = 'A'
  4578           ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4579           ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4580
  4581*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4582*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
  4583
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS043P.cbl
  4584     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4585        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4586         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4587             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4588              EC-COMM-78 (CL))
  4589        ELSE
  4590         IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4591          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4592             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4593              EC-COMM-78 (CL))
  4594            IF AM-RETRO-LV-INDIC (AL) = 'A'
  4595               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4596                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4597                    EC-COMM-78 (CL)).
  4598
  4599     IF WS-EP-CODE = 'P'
  4600       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4601         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4602             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4603              EC-COMM-PR (CL))
  4604       ELSE
  4605        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4606         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4607             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4608              EC-COMM-PR (CL))
  4609            IF AM-RETRO-LV-INDIC (AL) = 'A'
  4610               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4611                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4612                  EC-COMM-PR (CL)).
  4613
  4614     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4615       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4616         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4617             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4618              EC-COMM-ST (CL))
  4619       ELSE
  4620        IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4621         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4622             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4623              EC-COMM-ST (CL))
  4624            IF AM-RETRO-LV-INDIC (AL) = 'A'
  4625               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4626                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4627                  EC-COMM-ST (CL)).
  4628
  4629     IF WS-EP-CODE = 'M'
  4630         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4631                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4632                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4633                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4634          ELSE
  4635           IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4636                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4637                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4638                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4639               IF AM-RETRO-LV-INDIC (AL) = 'A'
  4640                   COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4641                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS043P.cbl
  4642                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4643
  4644     IF WS-EP-CODE = '1'
  4645         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4646                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4647                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4648                      ((EC-COMM-PR (CL) * +.6667) +
  4649                       (EC-COMM-78 (CL) * +.3333)))
  4650         ELSE
  4651             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4652                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4653                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4654                      ((EC-COMM-PR (CL) * +.6667) +
  4655                       (EC-COMM-78 (CL) * +.3333)))
  4656                 IF AM-RETRO-LV-INDIC (AL) = 'A'
  4657                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4658                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4659                      ((EC-COMM-PR (CL) * +.6667) +
  4660                       (EC-COMM-78 (CL) * +.3333))).
  4661
  4662     IF WS-EP-CODE = '2'
  4663         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4664                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4665                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4666                      ((EC-COMM-PR (CL) * +.80) +
  4667                       (EC-COMM-78 (CL) * +.20)))
  4668         ELSE
  4669             IF EC-AGT-TYPE (CL) = 'O' OR 'P'
  4670                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4671                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4672                      ((EC-COMM-PR (CL) * +.80) +
  4673                       (EC-COMM-78 (CL) * +.20)))
  4674                 IF AM-RETRO-LV-INDIC (AL) = 'A'
  4675                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4676                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4677                      ((EC-COMM-PR (CL) * +.80) +
  4678                       (EC-COMM-78 (CL) * +.20))).
  4679
  4680 0710-EXIT.
  4681     EXIT.
  4682
  4683 0725-CHECK-AM-RETRO.
  4684
  4685     MOVE SPACE                  TO  WS-RETRO-FLAG.
  4686
  4687     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  4688                             UNTIL AN GREATER THAN 10.
  4689 0725-CHECK-LOOP.
  4690
  4691*    IF (EC-ACCOUNT = '0000425300')
  4692*       AND (EC-AGT-NO (CL) = '0000423100')
  4693*       AND (AM-AGT
  4694*       MOVE 'A'                 TO WS-RETRO-FLAG
  4695*       MOVE 'A'                 TO AM-RETRO-LV-INDIC (AN)
  4696*       MOVE +11                 TO AN
  4697*    ELSE
  4698     IF EC-AGT-NO (CL) = AM-AGT (AN)
  4699         MOVE AM-RETRO-LV-INDIC (AN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS043P.cbl
  4700                                 TO  WS-RETRO-FLAG
  4701         MOVE +11                TO  AN.
  4702
  4703 0725-EXIT.
  4704     EXIT.
  4705
  4706 0729-EXIT.
  4707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS043P.cbl
  4709
  4710 0730-RETURN-SORTED-FILE.
  4711
  4712     IF SW-CTL NOT = HIGH-VALUES
  4713         RETURN SORT-WORK  INTO  SW-REC
  4714                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  4715                                               SW-CTL.
  4716 0730-EXIT.
  4717     EXIT.
  4718
  4719 0740-MOVE-SW-REC.
  4720     IF SW-RPT-TYPE-ID = 'C'
  4721         IF DTE-CLIENT = 'LBL'
  4722             MOVE 'E'            TO SW-RET-TYP.
  4723
  4724     MOVE SW-NAME                TO H1-NAME.
  4725     MOVE SW-ADDRS               TO H2-ADDR.
  4726     MOVE SW-CITY                TO H3-ADDR.
  4727
  4728     IF  SW-CANADIAN-POST-CODE
  4729         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  4730         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  4731         MOVE SPACES             TO H3-DASH-CAN
  4732                                    H3-CAN-FILLER
  4733
  4734     ELSE
  4735         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  4736
  4737         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  4738             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  4739
  4740         ELSE
  4741             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  4742             MOVE '-'            TO H3-DASH.
  4743
  4744     MOVE SW-CARR                TO H5-CARR.
  4745     MOVE SW-COMP                TO H5-COMP.
  4746     MOVE SW-STATE               TO H5-ST.
  4747     MOVE SW-ACCT                TO H5-ACCT.
  4748     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  4749     MOVE SW-EFF-DT              TO WORK-DATE.
  4750     MOVE WK-MO                  TO H5-FMO.
  4751     MOVE WK-DA                  TO H5-FDA.
  4752     MOVE WK-YR                  TO H5-FYR.
  4753     MOVE SW-EXP-DT              TO WORK-DATE.
  4754     MOVE WK-MO                  TO H5-TMO.
  4755     MOVE WK-DA                  TO H5-TDA.
  4756     MOVE WK-YR                  TO H5-TYR.
  4757     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
  4758     MOVE SW-CTL                 TO WS-SAVE-CTL.
  4759     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  4760     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  4761     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  4762     MOVE SW-LRET                TO LIFE-RETENT.
  4763     MOVE SW-ARET                TO AH-RETENT.
  4764     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  4765     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  4766     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS043P.cbl
  4767     MOVE SW-BEG-DATE            TO BEG-DATE.
  4768
  4769     IF SW-RPT-TYPE-ID = 'B'
  4770         MOVE 'GROUP'            TO H4-GROUP
  4771         MOVE SW-GA              TO H5-GROUP.
  4772
  4773     MOVE SW-GA                  TO ZONE-GROUP.
  4774
  4775     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  4776         MOVE '  ZONE'           TO H4-GROUP
  4777         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  4778
  4779     IF SW-RPT-TYPE-ID = 'C'
  4780         MOVE ' G.A.'            TO H4-GROUP
  4781         MOVE SW-GA              TO H5-GROUP.
  4782
  4783     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS043P.cbl
  4785 0745-OUTPUT-PROCEDURE SECTION.
  4786     IF NO-OF-RECORDS-RELEASED = +0
  4787        GO TO 1080-E-O-J.
  4788
  4789 0750-PRINT-REPORT SECTION.
  4790     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  4791
  4792     IF SW-RPT-TYPE-ID = 'B'
  4793         GO TO 0900-PRINT-GROUP-TOTALS.
  4794
  4795     IF SW-RPT-TYPE-ID = 'C'
  4796         GO TO 0990-PRINT-GA-TOTALS.
  4797
  4798     MOVE 'A'    TO H1-REPORT-SUF.
  4799     PERFORM 0740-MOVE-SW-REC.
  4800     MOVE SPACES TO H5-MESSAGE.
  4801
  4802*    IF SW-CARR = WS-SAVE-CAR
  4803*        AND SW-COMP = WS-SAVE-CMP
  4804*        AND SW-STATE = WS-SAVE-ST
  4805*        AND SW-ACCT = WS-SAVE-ACC
  4806*            GO TO 0780-BREAK-1
  4807*    ELSE
  4808*        GO TO 0800-BREAK-2.
  4809
  4810 0760-CHECK-BREAK.
  4811     IF SW-CARR NOT = WS-SAVE-CAR
  4812         GO TO 0860-BREAK-5.
  4813     IF SW-COMP NOT = WS-SAVE-CMP
  4814         GO TO 0840-BREAK-4.
  4815     IF SW-STATE NOT = WS-SAVE-ST
  4816         GO TO 0820-BREAK-3.
  4817     IF SW-ACCT NOT = WS-SAVE-ACC
  4818         GO TO 0800-BREAK-2.
  4819
  4820     GO TO 0780-BREAK-1.
  4821
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS043P.cbl
  4823 0770-BREAK-RETURN.
  4824     PERFORM 0740-MOVE-SW-REC.
  4825
  4826     IF SW-CTL = HIGH-VALUES
  4827         PERFORM 0880-BREAK-6
  4828         GO TO 1080-E-O-J
  4829     ELSE
  4830         IF SW-RPT-TYPE-ID = 'B'
  4831             PERFORM 0880-BREAK-6
  4832             GO TO 0900-PRINT-GROUP-TOTALS
  4833         ELSE
  4834             IF SW-RPT-TYPE-ID = 'C'
  4835                 PERFORM 0880-BREAK-6
  4836                 GO TO 0990-PRINT-GA-TOTALS
  4837             ELSE
  4838                 GO TO 0760-CHECK-BREAK.
  4839
  4840 0780-BREAK-1.
  4841     MOVE 'X'            TO BREAK-1-SWITCH.
  4842     MOVE '1'            TO HEAD-SW.
  4843     MOVE 'FROM      TO' TO H4-FT.
  4844     MOVE +1             TO SG.
  4845     MOVE +3             TO SF.
  4846     MOVE +1             TO SH.
  4847
  4848     IF DTE-CLIENT NOT = 'ITG'
  4849         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4850
  4851     MOVE +1 TO SC.
  4852     MOVE +7 TO SF.
  4853     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4854     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4855                          UNTIL SB GREATER 6.
  4856
  4857 0790-BREAD-1-EXIT.
  4858     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS043P.cbl
  4860
  4861 0800-BREAK-2.
  4862     IF BREAK-1-SWITCH NOT = ' '
  4863         PERFORM 0780-BREAK-1
  4864     ELSE
  4865         MOVE +1 TO SC
  4866         MOVE +7 TO SF
  4867         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  4868         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4869                              UNTIL SB GREATER 6.
  4870
  4871     MOVE SPACES TO BREAK-1-SWITCH.
  4872     MOVE '2'    TO HEAD-SW.
  4873
  4874     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  4875                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  4876
  4877     IF FC-CODE = ' '  OR  '5'
  4878         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  4879     IF FC-CODE = '1'
  4880         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  4881     IF FC-CODE = '2'
  4882         IF RD-MO = 01 OR 04 OR 07 OR 10
  4883             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  4884         ELSE
  4885             IF RD-MO = 02 OR 05 OR 08 OR 11
  4886                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  4887             ELSE
  4888                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  4889     IF FC-CODE = '3'
  4890         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  4891     IF FC-CODE = '4'
  4892         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  4893     IF FC-CODE = '6'
  4894         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  4895
  4896     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  4897         MOVE +2   TO SG
  4898         MOVE +9   TO SF
  4899         MOVE +1   TO SH
  4900         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  4901         MOVE +7   TO SC
  4902         MOVE +13  TO SF
  4903         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4904
  4905     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  4906                          UNTIL SB GREATER 12.
  4907
  4908 0810-BREAK-2-EXIT.
  4909     GO TO 0770-BREAK-RETURN.
  4910
  4911 0820-BREAK-3.
  4912     PERFORM 0800-BREAK-2.
  4913     MOVE '3'           TO HEAD-SW.
  4914     MOVE WS-SAVE-ST    TO H8-ST.
  4915     MOVE HEAD-8-STATE  TO H2-ADDR.
  4916     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  4917     MOVE +3            TO SG.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS043P.cbl
  4918     MOVE +15           TO SF.
  4919     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4920     MOVE +13           TO SC.
  4921     MOVE +19           TO SF.
  4922     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4923     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  4924                          UNTIL SB GREATER 18.
  4925
  4926     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  4927     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  4928
  4929 0830-BREAK-3-EXIT.
  4930     GO TO 0770-BREAK-RETURN.
  4931
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS043P.cbl
  4933 0840-BREAK-4.
  4934     PERFORM 0820-BREAK-3.
  4935     MOVE '4'         TO HEAD-SW.
  4936     MOVE WS-SAVE-CMP TO H8-COMP.
  4937     MOVE HEAD-8-COMP TO H2-ADDR.
  4938     MOVE +4          TO SG.
  4939     MOVE +21         TO SF.
  4940     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4941     MOVE +19         TO SC.
  4942     MOVE +25         TO SF.
  4943     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4944     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  4945                          UNTIL SB GREATER 24.
  4946
  4947 0850-BREAK-4-EXIT.
  4948     GO TO 0770-BREAK-RETURN.
  4949
  4950 0860-BREAK-5.
  4951     PERFORM 0840-BREAK-4.
  4952     MOVE '5'         TO HEAD-SW.
  4953     MOVE WS-SAVE-CAR TO H8-CARR.
  4954     MOVE HEAD-8-CARR TO H2-ADDR.
  4955     MOVE +5          TO SG.
  4956     MOVE +27         TO SF.
  4957     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4958     MOVE +25         TO SC.
  4959     MOVE +31         TO SF.
  4960     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  4961     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  4962                          UNTIL SB GREATER 30.
  4963
  4964 0870-BREAK-5-EXIT.
  4965     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS043P.cbl
  4967
  4968 0880-BREAK-6.
  4969     PERFORM 0860-BREAK-5.
  4970     MOVE '6'          TO HEAD-SW.
  4971     MOVE HEAD-8-FINAL TO H2-ADDR.
  4972     MOVE +6           TO SG.
  4973     MOVE +33          TO SF.
  4974     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  4975
  4976 0890-BREAK-6-EXIT.
  4977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS043P.cbl
  4979
  4980 0900-PRINT-GROUP-TOTALS.
  4981     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  4982                          UNTIL SB GREATER 36.
  4983     MOVE 'B' TO H1-REPORT-SUF.
  4984     PERFORM 0740-MOVE-SW-REC.
  4985
  4986 0910-CHECK-GROUP-BREAK.
  4987     IF SW-GA NOT = WS-SAVE-GA
  4988         GO TO 0970-BREAK-GROUP-3.
  4989
  4990     IF SW-CARR  NOT = WS-SAVE-CAR OR
  4991        SW-COMP  NOT = WS-SAVE-CMP OR
  4992        SW-STATE NOT = WS-SAVE-ST  OR
  4993        SW-ACCT  NOT = WS-SAVE-ACC
  4994           GO TO 0950-BREAK-GROUP-2.
  4995
  4996     GO TO 0930-BREAK-GROUP-1.
  4997
  4998 0920-BREAK-GROUP-RETURN.
  4999     PERFORM 0740-MOVE-SW-REC.
  5000
  5001     IF SW-CTL = HIGH-VALUES
  5002         PERFORM 0970-BREAK-GROUP-3
  5003         GO TO 1080-E-O-J
  5004     ELSE
  5005         IF SW-RPT-TYPE-ID = 'C'
  5006             PERFORM 0970-BREAK-GROUP-3
  5007             GO TO 0990-PRINT-GA-TOTALS
  5008         ELSE
  5009             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS043P.cbl
  5011
  5012 0930-BREAK-GROUP-1.
  5013     MOVE +1 TO SC.
  5014     MOVE +7 TO SF.
  5015     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5016     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5017                          UNTIL SB GREATER 6.
  5018
  5019 0940-BREAK-GROUP-1-EXIT.
  5020     GO TO 0920-BREAK-GROUP-RETURN.
  5021
  5022 0950-BREAK-GROUP-2.
  5023     PERFORM 0930-BREAK-GROUP-1.
  5024     MOVE '2'    TO HEAD-SW.
  5025     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5026                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5027     MOVE +2     TO SG.
  5028     MOVE +9     TO SF.
  5029     MOVE +1     TO SH.
  5030     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5031     MOVE +7     TO SC.
  5032     MOVE +13    TO SF.
  5033     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5034     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5035                          UNTIL SB GREATER 12.
  5036
  5037 0960-BREAK-GROUP-2-EXIT.
  5038     GO TO 0920-BREAK-GROUP-RETURN.
  5039
  5040 0970-BREAK-GROUP-3.
  5041     PERFORM 0950-BREAK-GROUP-2.
  5042     MOVE '3'        TO HEAD-SW.
  5043     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5044     MOVE '  GROUP'  TO H-8-G.
  5045
  5046     IF ZON = 'ZON'
  5047         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5048         MOVE '  ZONE' TO H-8-G.
  5049*
  5050*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5051*  SEPARATE PAGE BY ITSELF.
  5052*
  5053     MOVE '1'              TO X.
  5054     MOVE SPACE-LINE       TO P-DATA.
  5055     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5056
  5057     MOVE HEAD-8-GROUP TO H2-ADDR.
  5058     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5059     MOVE +3           TO SG.
  5060     MOVE +15          TO SF.
  5061     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5062*
  5063*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5064*  SEPARATE PAGE BY ITSELF.
  5065*
  5066     MOVE '1'              TO X.
  5067     MOVE SPACE-LINE       TO P-DATA.
  5068     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS043P.cbl
  5069
  5070     MOVE +13          TO SC.
  5071     MOVE +19          TO SF.
  5072     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5073     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5074                          UNTIL SB GREATER 18.
  5075
  5076 0980-BREAK-GROUP-3-EXIT.
  5077     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS043P.cbl
  5079 0990-PRINT-GA-TOTALS.
  5080     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5081                          UNTIL SB GREATER 36.
  5082     MOVE 'C' TO H1-REPORT-SUF.
  5083     PERFORM 0740-MOVE-SW-REC.
  5084
  5085 1000-CHECK-GA-BREAK.
  5086     IF SW-GA NOT = WS-SAVE-GA
  5087         GO TO 1060-BREAK-GA-3.
  5088
  5089     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5090        SW-COMP  NOT = WS-SAVE-CMP  OR
  5091        SW-STATE NOT = WS-SAVE-ST   OR
  5092        SW-ACCT  NOT = WS-SAVE-ACC
  5093           GO TO 1040-BREAK-GA-2.
  5094
  5095     GO TO 1020-BREAK-GA-1.
  5096
  5097 1010-BREAK-GA-RETURN.
  5098     PERFORM 0740-MOVE-SW-REC.
  5099
  5100     IF SW-CTL = HIGH-VALUES
  5101         PERFORM 1060-BREAK-GA-3
  5102         GO TO 1080-E-O-J.
  5103
  5104     GO TO 1000-CHECK-GA-BREAK.
  5105
  5106 1020-BREAK-GA-1.
  5107     MOVE +1 TO SC.
  5108     MOVE +7 TO SF.
  5109     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5110     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5111                          UNTIL SB GREATER 6.
  5112
  5113 1030-BREAK-GA-1-EXIT.
  5114     GO TO 1010-BREAK-GA-RETURN.
  5115
  5116 1040-BREAK-GA-2.
  5117     PERFORM 1020-BREAK-GA-1.
  5118
  5119     IF LIFE-RETENT = ZERO
  5120         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5121
  5122     IF AH-RETENT = ZERO
  5123         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5124
  5125     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5126     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5127
  5128     MOVE '2' TO HEAD-SW.
  5129     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5130                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5131
  5132     MOVE +2 TO SG.
  5133     MOVE +9 TO SF.
  5134     MOVE +1 TO SH.
  5135     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5136
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS043P.cbl
  5137     IF PA-NBA (7) LESS +0
  5138         ADD PA-NBA (7) TO PA-NBA (8)
  5139         MOVE +0 TO PA-NBA (7)
  5140         IF PA-NBA (8) LESS +0
  5141             MOVE +0 TO PA-NBA (8).
  5142
  5143     IF PA-NBA (8) LESS +0
  5144         ADD PA-NBA (8) TO PA-NBA (7)
  5145         MOVE +0 TO PA-NBA (8)
  5146         IF PA-NBA (7) LESS +0
  5147             MOVE +0 TO PA-NBA (7).
  5148
  5149     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5150
  5151     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5152         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5153
  5154     IF PA-NBA (10) LESS +0
  5155         ADD PA-NBA (10) TO PA-NBA (11)
  5156         MOVE +0 TO PA-NBA (10)
  5157         IF PA-NBA (11) LESS +0
  5158             MOVE +0 TO PA-NBA (11).
  5159
  5160     IF PA-NBA (11) LESS +0
  5161         ADD PA-NBA (11) TO PA-NBA (10)
  5162         MOVE +0 TO PA-NBA (11)
  5163         IF PA-NBA (10) LESS +0
  5164             MOVE +0 TO PA-NBA (10).
  5165
  5166     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5167
  5168     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5169         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5170
  5171     MOVE +7  TO SC.
  5172     MOVE +13 TO SF.
  5173     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5174     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5175                          UNTIL SB GREATER 12.
  5176
  5177 1050-BREAK-GA-2-EXIT.
  5178     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS043P.cbl
  5180
  5181 1060-BREAK-GA-3.
  5182     PERFORM 1040-BREAK-GA-2.
  5183     MOVE '3'        TO HEAD-SW.
  5184     MOVE WS-SAVE-GA TO H8-GA.
  5185     MOVE HEAD-8-GA  TO H2-ADDR.
  5186     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5187*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5188
  5189     IF DTE-CLIENT = 'GIC'
  5190         MOVE 'P' TO SAVE-RET-TYP
  5191     ELSE
  5192         MOVE 'E' TO SAVE-RET-TYP.
  5193
  5194     MOVE +3    TO SG.
  5195     MOVE +15   TO SF.
  5196     MOVE +2    TO SH.
  5197     MOVE LIFE-RETENT TO RETENT-FACT.
  5198     MOVE +13   TO SC.
  5199     MOVE +15   TO SF.
  5200     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5201     MOVE AH-RETENT TO RETENT-FACT.
  5202     MOVE +14   TO SC.
  5203     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5204     MOVE LIFE-RETENT TO RETENT-FACT.
  5205     MOVE +16   TO SC.
  5206     MOVE +18   TO SF.
  5207     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5208     MOVE AH-RETENT TO RETENT-FACT.
  5209     MOVE +17 TO SC.
  5210     PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5211
  5212     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5213     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5214
  5215     MOVE +15 TO SF.
  5216
  5217     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5218     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5219                          UNTIL SB GREATER 18.
  5220
  5221 1070-BREAK-GA-3-EXIT.
  5222     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS043P.cbl
  5224 1080-E-O-J.
  5225     CLOSE
  5226         PRNTR.
  5227
  5228 1090-CLOSE-FICH.
* 5229                             COPY ELCPRTC.
  5230******************************************************************04/15/98
  5231*                                                                *ELCPRTC
  5232*                                                                *ELCPRTC
  5233*                            ELCPRTC.                            *   LV003
  5234*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5235*                            VMOD=2.002                          *   CL**2
  5236*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5237*                                                                *ELCPRTC
  5238* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5239******************************************************************ELCPRTC
  5240                                                                  ELCPRTC
  5241      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5242          CLOSE FICH.                                             ELCPRTC
  5243                                                                  ELCPRTC
  5244******************************************************************ELCPRTC
  5245
  5246 1090-CLOSE-EXIT.
  5247     EXIT.
  5248
* 5249 COPY ELCDCS.
  5250****************************************************************  04/15/98
  5251*                                                              *  ELCDCS
  5252*                                                              *  ELCDCS
  5253*                            ELCDCS.                           *     LV003
  5254*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5255*                            VMOD=2.002                        *     CL**3
  5256*                                                              *  ELCDCS
  5257*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5258****************************************************************. ELCDCS
  5259                                                                  ELCDCS
  5260 8510-DATE-CONVERSION.                                            ELCDCS
  5261     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5262                                                                  ELCDCS
  5263 8590-EXIT.                                                       ELCDCS
  5264     EXIT.                                                        ELCDCS
  5265                                                                  ELCDCS
  5266
  5267 ABEND-PGM SECTION.
* 5268                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       65156     Code:       29797
