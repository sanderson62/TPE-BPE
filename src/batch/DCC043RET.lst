* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* DCC043RET.cbl
* Options: int("DCC043RET.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("DCC043RET.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"DCC043RET.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "DCC043RET.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                DCC043RET.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 16:43:46.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9*AUTHOR.     LOGIC, INC.
    10*            DALLAS, TEXAS.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* DCC043RET.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    THIS PROGRAM WILL READ THE EP-EC FILE AND CREATE
    23*            A RETRO EXTRACT FILE.
    24
    25*            AN OPTIONAL CARD INPUT MAY BE USED TO SPECIFY A
    26*        FORMAT OTHER THAN YTD AND ITD.
    27
    28*        FORMAT OF INPUT IS -
    29*         CC 1-2    CARD I.D. 'RF'
    30*            3-5    CLIENT-ID
    31*            6      LEFT SIDE FORMAT  (RIGHT SIDE ALWAYS ITD)
    32
    33*                  BLANK  USE DATE IN CC 7-14 AS BEGINNING DATE
    34*                      1  YTD
    35*                      2  QTD
    36*                      3  LAST 3 MOS.
    37*                      4  LAST 6 MOS.
    38*                      5  LAST 12 MOS.
    39*                      6  LAST MONTH
    40
    41*            7-14   BEGINNING DATE  (CCYYMMDD)
    42
    43******************************************************************
    44*                   C H A N G E   L O G
    45*
    46* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    47*-----------------------------------------------------------------
    48*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    49* EFFECTIVE    NUMBER
    50*-----------------------------------------------------------------
    51* 060402    2002060300014  SMVA  MOVE PAGE # FROM BOTTOM TO TOP
    52* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY - PRTN043
    53* 081208    2008073000002  AJRA  CREATE EXTRACT FILE OF ACCOUNT TOTALS
    54* 090908    2008090300001  AJRA  FIX RETRO CALC FOR COMMISSION
    55*                                FIX DIVIDE BY ZERO
    56* 010809    2008090300001  AJRA  FOR PRIOR YEARS WHERE EXP DT MAY NOT
    57*                                MATCH, COMPARE ACCT AND EPEC BY EFF DT
    58* 020409    2008073000002  AJRA  ADD RETRO PAYMENTS
    59* 051810 CR2010042900001   PEMA  SPEARATE CITY AND STATE
    60* 060314  CR2014050100002  AJRA  ADD DCC CLP AMT TO EXTRACT
    61******************************************************************
    62
    63
    64 ENVIRONMENT DIVISION.
    65 INPUT-OUTPUT SECTION.
    66 FILE-CONTROL.
    67
    68     SELECT  SORT-WORK       ASSIGN TO SYS001-DA-FBA1-S-SORTWK1.
    69     SELECT  PRNTR           ASSIGN TO SYS008-UR-1403-S-SYS008.
    70     SELECT  EPEC-FILE       ASSIGN TO SYS010-UT-2400-S-SYS010.
    71     SELECT  ACC-MSTR        ASSIGN TO ERACCTT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* DCC043RET.cbl
    72                             ACCESS IS SEQUENTIAL
    73                             ORGANIZATION IS INDEXED
    74                             FILE STATUS IS ERACCTT-FILE-STATUS
    75                             RECORD KEY IS AM-CONTROL-PRIMARY.
    76     SELECT  ERPLAN-IN       ASSIGN TO ERPLAN
    77                             ORGANIZATION IS INDEXED
    78                             ACCESS IS DYNAMIC
    79                             FILE STATUS IS ERPLAN-FILE-STATUS
    80                             RECORD KEY IS PL-CONTROL-PRIMARY.
    81     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-FBA1-S-SYS019.
    82     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    83     SELECT  CONTROL-CARD    ASSIGN TO SYS006-UR-2540R-S-SYS006.
    84     SELECT  DATA-OUT        ASSIGN TO SYS022-UT-2400-S-SYS022
    85                             ORGANIZATION IS LINE SEQUENTIAL.
    86
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* DCC043RET.cbl
    88 DATA DIVISION.
    89 FILE SECTION.
    90
    91 SD  SORT-WORK.
    92
    93 01  SW-REC-OUT.
    94     12  SW-RPT-TYPE-ID-OUT  PIC X.
    95     12  SW-CTL-OUT          PIC X(35).
    96*00077      12  FILLER              PIC X(1090).
    97     12  FILLER              PIC X(1521).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* DCC043RET.cbl
    99 FD  CONTROL-CARD
   100     BLOCK CONTAINS 0 RECORDS
   101     RECORDING MODE F.
   102
   103 01  CARD-IN-AREA            PIC X(80).
   104
   105 FD  PRNTR
*  106                             COPY ELCPRTFD.
   107******************************************************************04/15/98
   108*                                                                *ELCPRTFD
   109*                                                                *ELCPRTFD
   110*                            ELCPRTFD.                           *   LV003
   111*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   112*                            VMOD=2.006                          *ELCPRTFD
   113******************************************************************ELCPRTFD
   114     RECORDING MODE F                                             ELCPRTFD
   115     LABEL RECORDS OMITTED                                        ELCPRTFD
   116     BLOCK CONTAINS 0 RECORDS
   117     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   118 01  PRT.                                                         ELCPRTFD
   119     12  P-CTL               PIC  X.                                 CL**2
   120     12  P-DATA              PIC  X(132).                         ELCPRTFD
   121******************************************************************ELCPRTFD
   122
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* DCC043RET.cbl
   124 FD  EPEC-FILE
*  125                             COPY ECSEPCFD.
   126******************************************************************07/10/97
   127*                                                                *ECSEPCFD
   128*                            ECSEPCFD                            *   LV001
   129*                            VMOD=2.002                          *ECSEPCFD
   130*                                                                *ECSEPCFD
   131*  NO  CID  MODS  IN  COPYBOOK  ECSEPCFD                         *ECSEPCFD
   132*                                                                *ECSEPCFD
   133******************************************************************ECSEPCFD
   134     RECORDING MODE F                                             ECSEPCFD
   135     LABEL RECORDS STANDARD                                       ECSEPCFD
   136     BLOCK CONTAINS 0 RECORDS
   137     RECORD CONTAINS 325 CHARACTERS.                              ECSEPCFD
   138******************************************************************ECSEPCFD
*  139                             COPY ECSEPC01.
   140******************************************************************
   141*                                                                *
   142*                            ECSEPC01                            *
   143*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   144*                            VMOD=2.008                          *
   145*                                                                *
   146*   FILE DESCRIPTION =  EARNED PREM / EARNED COMM  (E.P.E.C.)    *
   147*                                                                *
   148*   FILE TYPE = SEQUENTIAL                                       *
   149*   RECORD SIZE = 325  RECFORM = FIXED                           *
   150*                                                                *
   151*   KEY DATA =                                  START=5, LEN=31  *
   152*                                                                *
   153*  NO  CID  MODS  IN  COPYBOOK  ECSEPC01                         *
   154*                                                                *
   155******************************************************************
   156
   157 01  EP-RECORD.
   158     02 EP-FILE.
   159     12  EP-RECORD-ID                      PIC XX.
   160         88  VALID-EP-ID                      VALUE 'EP'.
   161
   162     12  EP-COMPANY-CD                     PIC X.
   163
   164     12  EP-REIN                           PIC X.
   165         88  EP-REIN-EXTRACT                  VALUE 'R'.
   166
   167     12  EP-CONTROL.
   168         16  EP-CNTRL-1.
   169             20  EP-COMPANY.
   170                 24  EP-CARRIER            PIC X.
   171                 24  EP-GROUPING.
   172                     28  EP-GROUP-PREFIX   PIC XXX.
   173                     28  EP-GROUP-PRIME    PIC XXX.
   174             20  EP-STATE                  PIC XX.
   175             20  EP-ACCOUNT.
   176                 24  EP-ACCT-PREFIX        PIC X(4).
   177                 24  EP-ACCT-PRIME         PIC X(6).
   178         16  EP-CNTRL-2.
   179             20  EP-DATES.
   180                 24  EP-EXP-DTE            PIC 9(11)   COMP-3.
   181                 24  EP-EFF-DTE            PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* DCC043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   182
   183     12  EP-REI-CO.
   184         16  EP-REINCO                     PIC XXX.
   185         16  EP-REINCO-SUB                 PIC XXX.
   186
   187     12  EP-RCD-TYPE                       PIC X.
   188         88  EP-BEN-TYPE-LIFE                 VALUE 'L'.
   189         88  EP-BEN-TYPE-AH                   VALUE 'A'.
   190         88  EP-BEN-TYPE-PROPERTY             VALUE 'P'.
   191         88  EP-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   192         88  EP-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   193         88  EP-BEN-TYPE-AD-D                 VALUE 'E'.
   194     12  EP-BEN-CODE                       PIC XX.
   195     12  FILLER                            PIC X.
   196
   197     12  EP-ISS-CNT                        PIC S9(7)      COMP-3.
   198     12  EP-ISS-BEN                        PIC S9(11)V99  COMP-3.
   199     12  EP-ISS-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   200
   201     12  EP-CNC-CNT                        PIC S9(7)      COMP-3.
   202     12  EP-CNC-BEN                        PIC S9(11)V99  COMP-3.
   203     12  EP-CNC-BEN-GROSS                  PIC S9(11)V99  COMP-3.
   204
   205     12  EP-ISS-PRM                        PIC S9(9)V99   COMP-3.
   206     12  EP-ISS-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   207     12  EP-CNC-PRM                        PIC S9(9)V99   COMP-3.
   208     12  EP-CNC-PRM-GROSS                  PIC S9(9)V99   COMP-3.
   209
   210     12  EP-PRM-78                         PIC S9(9)V99   COMP-3.
   211     12  EP-PRM-PR                         PIC S9(9)V99   COMP-3.
   212     12  EP-PRM-ST                         PIC S9(9)V99   COMP-3.
   213
   214     12  EP-CLM-AMT                        PIC S9(9)V99   COMP-3.
   215     12  EP-CLM-CNT                        PIC S9(7)      COMP-3.
   216     12  EP-CLM-CRT                        PIC S9(7)      COMP-3.
   217
   218     12  EP-CLM-DU                         PIC S9(7)V99   COMP-3.
   219     12  EP-CLM-PV                         PIC S9(7)V99   COMP-3.
   220     12  EP-CLM-IBNR                       PIC S9(7)V99   COMP-3.
   221     12  EP-LOSS-RESV                      PIC S9(7)V99   COMP-3.
   222     12  EP-CLAIM-ADJ                      PIC S9(7)V99   COMP-3.
   223
   224     12  EP-RETRO-EXPENSES                 PIC S9(7)V99   COMP-3.
   225     12  EP-RETRO-PAYMENTS                 PIC S9(7)V99   COMP-3.
   226     12  EP-RETRO-OTH-COMM                 PIC S9(7)V99   COMP-3.
   227
   228     12  EP-MORT-RESV                      PIC S9(11)V9(6) COMP-3.
   229     12  EP-IN-FORCE                       PIC S9(11)V99   COMP-3.
   230     12  EP-ADJUST                         PIC S9(7)V99    COMP-3.
   231
   232     12  EP-SPECIFIC-OPT-RSV-FIELDS.
   233         16  EP-LIFE-YEARS                 PIC S9(9)      COMP-3.
   234         16  EP-NEW-DATA-IND               PIC X(01).
   235             88  EP-NEW-DATA                   VALUE 'Y'.
   236         16  EP-CLM-EXP                    PIC S9(9)V99   COMP-3.
   237         16  FILLER                        PIC X(19).
   238
   239     12  EP-PRM-78-ADJ                     PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* DCC043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   240     12  EP-PRM-PR-ADJ                     PIC S9(9)V99   COMP-3.
   241     12  EP-PRM-ST-ADJ                     PIC S9(9)V99   COMP-3.
   242
   243     12  FILLER                            PIC XXX.
   244
   245     12  EP-UNDERWRITING-CODE              PIC X.
   246         88  EP-UNDERWRITTEN-DATA             VALUE 'Y'.
   247
   248     12  EP-PRM-TAX                        PIC S9(7)V99   COMP-3.
   249
   250     12  FILLER                            PIC X(29).
   251*    12  FILLER                            PIC X(34).
   252
   253     12  EP-AVG-AGE                        PIC S9(3)      COMP-3.
   254     12  EP-AVG-ORIG-TERM                  PIC S9(3)      COMP-3.
   255     12  EP-WEIGHTED-AGE                   PIC S9(3)      COMP-3.
   256     12  EP-WEIGHTED-ORIG-TERM             PIC S9(3)      COMP-3.
   257     12  EP-AVG-REM-TERM                   PIC S9(3)      COMP-3.
   258     12  EP-INFORCE-CNT                    PIC S9(9)      COMP-3.
   259
   260     12  EP-HI-COV-DT                      PIC 9(11)      COMP-3.
   261
   262     12  EP-HI-CERT                        PIC 9(11)      COMP-3.
   263     12  EP-LO-CERT                        PIC 9(11)      COMP-3.
   264
   265     12  EP-PURGE                          PIC X.
   266         88  EP-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   267
   268     12  EP-RUN-DTE                        PIC 9(11)      COMP-3.
   269
   270     02 EC-RECORD     REDEFINES     EP-FILE.
   271     12  EC-RECORD-ID                      PIC XX.
   272         88  VALID-EC-ID                      VALUE 'EC'.
   273
   274     12  EC-COMPANY-CD                     PIC X.
   275
   276     12  EC-REIN                           PIC X.
   277         88  EC-REIN-EXTRACT                  VALUE 'R'.
   278
   279     12  EC-CONTROL.
   280         16  EC-CARRIER                    PIC X.
   281         16  EC-GROUPING.
   282             20  EC-GROUP-PREFIX           PIC XXX.
   283             20  EC-GROUP-PRIME            PIC XXX.
   284         16  EC-STATE                      PIC XX.
   285         16  EC-ACCOUNT.
   286             20  EC-ACCT-PREFIX            PIC X(4).
   287             20  EC-ACCT-PRIME             PIC X(6).
   288         16  EC-DATES.
   289             20  EC-EXP-DTE                PIC 9(11)    COMP-3.
   290             20  EC-EFF-DTE                PIC 9(11)    COMP-3.
   291
   292     12  EC-REI-CO.
   293         16  EC-REINCO                     PIC XXX.
   294         16  EC-REINCO-SUB                 PIC XXX.
   295
   296     12  EC-RCD-TYPE                       PIC X.
   297         88  EC-BEN-TYPE-LIFE                 VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* DCC043RET.cbl (/apps/prod/cid1p/copy/ECSEPC01)
   298         88  EC-BEN-TYPE-AH                   VALUE 'A'.
   299         88  EC-BEN-TYPE-PROPERTY             VALUE 'P'.
   300         88  EC-BEN-TYPE-UNEMPLOYMENT         VALUE 'U'.
   301         88  EC-BEN-TYPE-DISMEMBURMENT        VALUE 'D'.
   302     12  EC-BEN-CODE                       PIC XX.
   303     12  EC-SEQ-NBR                        PIC X.
   304         88  EC-COMP-LEVELS-1-5               VALUE '1'.
   305         88  EC-COMP-LEVELS-6-10              VALUE '2'.
   306
   307     12  EC-AGENTS-DATA.
   308         16  EC-AGENTS-LEVEL     OCCURS   5   TIMES.
   309             20  EC-AGT-NO.
   310                 24  EC-AGT-PREFIX         PIC X(4).
   311                 24  EC-AGT-PRIME          PIC X(6).
   312             20  EC-AGT-TYPE               PIC X.
   313             20  EC-ISS-COMM               PIC S9(9)V99   COMP-3.
   314             20  EC-CNC-COMM               PIC S9(9)V99   COMP-3.
   315             20  EC-COMM-78                PIC S9(9)V99   COMP-3.
   316             20  EC-COMM-PR                PIC S9(9)V99   COMP-3.
   317             20  EC-COMM-ST                PIC S9(9)V99   COMP-3.
   318
   319     12  EC-UNDERWRITING-CODE              PIC X.
   320         88  EC-UNDERWRITTEN-DATA             VALUE 'Y'.
   321
   322     12  EC-AGENTS-DATA-II.
   323         16  EC-AGENTS-LEVEL-II  OCCURS   5   TIMES.
   324             20  EC-COMM-78-ADJ            PIC S9(9)V99   COMP-3.
   325             20  EC-COMM-PR-ADJ            PIC S9(9)V99   COMP-3.
   326
   327     12  FILLER                            PIC X(7).
   328
   329     12  EC-PURGE                          PIC X.
   330         88  EC-DATA-FROM-PURGED-CERTS        VALUE 'P'.
   331
   332     12  EC-RUN-DTE                        PIC 9(11)     COMP-3.
   333
   334******************************************************************
   335
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* DCC043RET.cbl
   337 FD  ACC-MSTR.
*  338                             COPY ERCACCT.
   339******************************************************************04/19/98
   340*                                                                *ERCACCT
   341*                                                                *ERCACCT
   342*                            ERCACCT                             *   LV031
   343*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   344*                            VMOD=2.031                          *ERCACCT
   345*                                                                *ERCACCT
   346*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   347*                                                                *ERCACCT
   348*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   349*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   350*                                                                *ERCACCT
   351*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   352*                                                                *ERCACCT
   353*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   354*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   355*                                                                *ERCACCT
   356*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   357*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   358*                                                                *ERCACCT
   359*   LOG = NO                                                     *ERCACCT
   360*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   361*                                                                *ERCACCT
   362*                                                                *ERCACCT
   363******************************************************************ERCACCT
   364*                   C H A N G E   L O G
   365*
   366* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   367*-----------------------------------------------------------------
   368*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   369* EFFECTIVE    NUMBER
   370*-----------------------------------------------------------------
   371* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   372* 092705    2005050300006  PEMA  ADD SPP LEASES
   373* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   374* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   375* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   376* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   377* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   378******************************************************************
   379                                                                  ERCACCT
   380 01  ACCOUNT-MASTER.                                              ERCACCT
   381     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   382         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   383                                                                  ERCACCT
   384     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   385         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   386         16  AM-MSTR-CNTRL.                                       ERCACCT
   387             20  AM-CONTROL-A.                                    ERCACCT
   388                 24  AM-CARRIER            PIC X.                 ERCACCT
   389                 24  AM-GROUPING.                                 ERCACCT
   390                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   391                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   392                 24  AM-STATE              PIC XX.                ERCACCT
   393                 24  AM-ACCOUNT.                                  ERCACCT
   394                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   395                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   396             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   397                                           PIC X(19).             ERCACCT
   398             20  AM-CNTRL-B.                                      ERCACCT
   399                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   400                 24  FILLER                PIC X(4).              ERCACCT
   401             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   402                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   403                                                                  ERCACCT
   404     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   405         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   406         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   407         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   408         16  AM-VG-STATE                   PIC XX.                ERCACCT
   409         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   410         16  AM-VG-DATE.                                          ERCACCT
   411             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   412             20  FILLER                    PIC X(4).              ERCACCT
   413         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   414                                           PIC 9(11)      COMP-3. ERCACCT
   415     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   416         16  FILLER                        PIC X(10).
   417         16  AM-VG-KEY3.
   418             20  AM-VG3-ACCOUNT            PIC X(10).
   419             20  AM-VG3-EXP-DT             PIC XX.
   420         16  FILLER                        PIC X(4).
   421     12  AM-MAINT-INFORMATION.                                    ERCACCT
   422         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   423         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   424         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   425         16  FILLER                        PIC XX.                ERCACCT
   426                                                                  ERCACCT
   427     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   428     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   429                                                                  ERCACCT
   430     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   431         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   432         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   433                                                                  ERCACCT
   434     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   435     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   436                                                                  ERCACCT
   437     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   438     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   439                                                                  ERCACCT
   440     12  AM-NAME                           PIC X(30).             ERCACCT
   441     12  AM-PERSON                         PIC X(30).             ERCACCT
   442     12  AM-ADDRS                          PIC X(30).             ERCACCT
   443     12  AM-CITY.
   444         16  AM-ADDR-CITY                  PIC X(28).
   445         16  AM-ADDR-STATE                 PIC XX.
   446     12  AM-ZIP.                                                  ERCACCT
   447         16  AM-ZIP-PRIME.                                        ERCACCT
   448             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   449                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   450             20  FILLER                    PIC X(4).              ERCACCT
   451         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   452     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   453         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   454         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   455         16  FILLER                        PIC XXX.               ERCACCT
   456     12  AM-TEL-NO.                                               ERCACCT
   457         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   458         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   459         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   460     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   461         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   462         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   463                                                                  ERCACCT
   464     12  AM-COMM-STRUCTURE.                                       ERCACCT
   465         16  AM-DEFN-1.                                           ERCACCT
   466             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   467                 24  AM-AGT.                                      ERCACCT
   468                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   469                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   470                 24  AM-COM-TYP            PIC X.                 ERCACCT
   471                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   472                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   473                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   474                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   475                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   476                 24  AM-GL-CODES           PIC X.                 ERCACCT
   477                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   478                 24  FILLER                PIC X(01).             ERCACCT
   479         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   480             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   481                 24  FILLER                PIC X(11).             ERCACCT
   482                 24  AM-L-COMA             PIC XXX.               ERCACCT
   483                 24  AM-J-COMA             PIC XXX.               ERCACCT
   484                 24  AM-A-COMA             PIC XXX.               ERCACCT
   485                 24  FILLER                PIC X(6).              ERCACCT
   486                                                                  ERCACCT
   487     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   488         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   489                                                                  ERCACCT
   490     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   491                                                                  ERCACCT
   492     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   493         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   494         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   495     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   496         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   497         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   498     12  AM-GPCD                           PIC 99.                ERCACCT
   499     12  AM-IG                             PIC X.                 ERCACCT
   500         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   501         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   502     12  AM-STATUS                         PIC X.                 ERCACCT
   503         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   504         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   505         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   506         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   507         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   508         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   509     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   510     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   511                                                                  ERCACCT
   512     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   513     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   514     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   515     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   516     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   517     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   518     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   519     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   520     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   521                                                                  ERCACCT
   522     12  AM-USER-FIELDS.                                          ERCACCT
   523         16  AM-FLD-1                      PIC XX.                ERCACCT
   524         16  AM-FLD-2                      PIC XX.                ERCACCT
   525         16  AM-FLD-3                      PIC XX.                ERCACCT
   526         16  AM-FLD-4                      PIC XX.                ERCACCT
   527         16  AM-FLD-5                      PIC XX.                ERCACCT
   528                                                                  ERCACCT
   529     12  AM-1ST-PROD-DATE.                                        ERCACCT
   530         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   531         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   532         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   533     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   534     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   535         16  AM-PUR-YR                     PIC XX.                ERCACCT
   536         16  AM-PUR-MO                     PIC XX.                ERCACCT
   537         16  AM-PUR-DA                     PIC XX.                ERCACCT
   538     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   539     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   540     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   541     12  AM-INACTIVE-DATE.                                        ERCACCT
   542         16  AM-INA-MO                     PIC 99.                ERCACCT
   543         16  AM-INA-DA                     PIC 99.                ERCACCT
   544         16  AM-INA-YR                     PIC 99.                ERCACCT
   545     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   546                                                                  ERCACCT
   547     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   548     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   549                                                                  ERCACCT
   550     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   551         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   552         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   553         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   554         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   555                                                                  ERCACCT
   556     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   557         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   558         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   559                                                                  ERCACCT
   560     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   561                                                                  ERCACCT
   562     12  AM-OVER-SHORT.                                           ERCACCT
   563         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   564         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   565                                                                  ERCACCT
   566     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   567     12  AM-DCC-CLP-STATE                  PIC XX.
   568                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   569     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   570     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   571                                                                  ERCACCT
   572     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   573     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   574     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   575     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   576     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   577     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   578     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   579     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   580     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   581     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   582     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   583     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   584     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   585     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   586     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   587     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   588                                                                  ERCACCT
   589     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   590                                                                  ERCACCT
   591     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   592     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   593                                                                  ERCACCT
   594     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   595     12  AM-EARN-METHODS.                                         ERCACCT
   596         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   597             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   598             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   599             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   600             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   601         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   602             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   603             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   604             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   605             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   606         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   607             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   608             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   609             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   610             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   611             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   612             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   613                                                                  ERCACCT
   614     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   615     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   616     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   617                                                                  ERCACCT
   618     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   619     12  AM-RET-P-E                        PIC X.                 ERCACCT
   620     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   621     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   622     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   623     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   624         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   625         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   626     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   627         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   628         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   629         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   630     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   631         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   632         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   633     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   634         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   635         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   636         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   637     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   638     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   639                                                                  ERCACCT
   640     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   641         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   642         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   643         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   644         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   645         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   646                                                                  ERCACCT
   647     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   648                                                                  ERCACCT
   649     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   650                                                                  ERCACCT
   651     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   652         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   653                                                                  ERCACCT
   654     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   655         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   656         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   657                                                                  ERCACCT
   658     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   659         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   660                                                                  ERCACCT
   661     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   662         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   663         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   664                                                                  ERCACCT
   665     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   666                                                                  ERCACCT
   667     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   668     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   669     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   670     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   671     12  AM-DCC-UEF-STATE                  PIC XX.
   672     12  FILLER                            PIC XXX.
   673     12  AM-REPORT-CODE-3                  PIC X(10).
   674*    12  FILLER                            PIC X(22).             ERCACCT
   675                                                                  ERCACCT
   676     12  AM-RESERVE-DATE.                                         ERCACCT
   677         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   678         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   679         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   680                                                                  ERCACCT
   681     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   682     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   683         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   684         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   685         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   686         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   687                                                                  ERCACCT
   688     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   689         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   690         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   691         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   692         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   693                                                                  ERCACCT
   694     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   695         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   696             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   697             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   698             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   699             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   700             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   701             20  FILLER                    PIC XX.                ERCACCT
   702         16  FILLER                        PIC X(80).             ERCACCT
   703                                                                  ERCACCT
   704     12  AM-TRANSFER-DATA.                                        ERCACCT
   705         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   706             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   707             20  AM-TRNFROM-GROUPING.                             ERCACCT
   708                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   709                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   710             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   711             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   712                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   713                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   714             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   715         16  AM-TRANSFERRED-TO.                                   ERCACCT
   716             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   717             20  AM-TRNTO-GROUPING.                               ERCACCT
   718                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   719                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   720             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   721             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   722                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   723                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   724             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   725         16  FILLER                        PIC X(10).             ERCACCT
   726                                                                  ERCACCT
   727     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   728                                                                  ERCACCT
   729     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   730         16  AM-DEFN-1-SAVED.                                     ERCACCT
   731             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   732                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   733                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   734                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   735                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   736                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   737                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   738                 24  FILLER                PIC X.                 ERCACCT
   739                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   740                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   741                 24  FILLER                PIC X.                 ERCACCT
   742         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   743             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   744                 24  FILLER                PIC X(11).             ERCACCT
   745                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   746                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   747                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   748                 24  FILLER                PIC X(6).              ERCACCT
   749                                                                  ERCACCT
   750     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   751         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   752            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   753            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   754            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   755                                                                  ERCACCT
   756     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   757     12  FILLER                            PIC X(120).            ERCACCT
   758                                                                  ERCACCT
   759     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   760         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   761         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   762             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   763             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   764                                                          COMP-3. ERCACCT
   765             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   766                                                          COMP-3. ERCACCT
   767         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   768             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   769             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   770                                                          COMP-3. ERCACCT
   771             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   772                                                          COMP-3. ERCACCT
   773                                                                  ERCACCT
   774     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   775         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   776         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   777         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   778         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   779             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   780                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   781                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   782             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   783                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   784                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   785             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   786                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   787                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   788         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   789             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   790                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   791                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   792                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   793             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   794                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   795                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   796             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   797                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   798                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   799                                                                  ERCACCT
   800     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCACCT)
   801         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   802                                                                  ERCACCT
   803     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   804         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   805         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   806         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   807         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   808         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   809             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   810             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   811             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   812             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   813         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   814             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   815             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   816             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   817         16  FILLER                        PIC X(102).            ERCACCT
   818                                                                  ERCACCT
   819     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   820         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   821             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   822             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   823             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   824             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   825             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   826         16  FILLER                          PIC X(10).           ERCACCT
   827******************************************************************ERCACCT
   828
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* DCC043RET.cbl
   830 FD  ERPLAN-IN.
*  831                             COPY ERCPLAN.
   832******************************************************************04/29/98
   833*                                                                *ERCPLAN
   834*                                                                *ERCPLAN
   835*                            ERCPLAN                             *   LV003
   836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   837*                            VMOD=2.003                          *   CL**2
   838*                                                                *ERCPLAN
   839*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *ERCPLAN
   840*                                                                *ERCPLAN
   841*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *ERCPLAN
   842*   PLAN MASTER                                                  *ERCPLAN
   843*                                                                *ERCPLAN
   844*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *ERCPLAN
   845*                                                                *ERCPLAN
   846*   FILE TYPE = VSAM,KSDS                                        *ERCPLAN
   847*   RECORD SIZE = 420   RECFORM = FIX                            *ERCPLAN
   848*                                                                *ERCPLAN
   849*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *ERCPLAN
   850*       ALTERNATE PATH1 = N/A                                    *ERCPLAN
   851*                                                                *ERCPLAN
   852*   LOG = NO                                                     *ERCPLAN
   853*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCPLAN
   854*                                                                *ERCPLAN
   855*                                                                *ERCPLAN
   856******************************************************************ERCPLAN
   857                                                                  ERCPLAN
   858 01  PLAN-MASTER.                                                 ERCPLAN
   859     12  PL-RECORD-ID                      PIC XX.                ERCPLAN
   860         88  VALID-PL-ID                      VALUE 'PL'.         ERCPLAN
   861                                                                  ERCPLAN
   862     12  PL-CONTROL-PRIMARY.                                      ERCPLAN
   863         16  PL-COMPANY-CD                 PIC X.                 ERCPLAN
   864         16  PL-MSTR-CNTRL.                                       ERCPLAN
   865             20  PL-CONTROL-A.                                    ERCPLAN
   866                 24  PL-CARRIER            PIC X.                 ERCPLAN
   867                 24  PL-GROUPING           PIC X(6).              ERCPLAN
   868                 24  PL-STATE              PIC XX.                ERCPLAN
   869                 24  PL-ACCOUNT            PIC X(10).             ERCPLAN
   870             20  PL-BENEFIT-TYPE           PIC X.                 ERCPLAN
   871             20  PL-BENEFIT-CODE           PIC XX.                ERCPLAN
   872             20  PL-REVISION-NO            PIC X(3).              ERCPLAN
   873                                                                  ERCPLAN
   874     12  PL-CONTROL-BY-VAR-GRP.                                   ERCPLAN
   875         16  PL-COMPANY-CD-A1              PIC X.                 ERCPLAN
   876         16  PL-VG-CARRIER                 PIC X.                 ERCPLAN
   877         16  PL-VG-GROUPING                PIC X(6).              ERCPLAN
   878         16  PL-VG-STATE                   PIC XX.                ERCPLAN
   879         16  PL-VG-ACCOUNT                 PIC X(10).             ERCPLAN
   880         16  PL-BENEFIT-TYPE-A1            PIC X.                 ERCPLAN
   881         16  PL-BENEFIT-CODE-A1            PIC XX.                ERCPLAN
   882         16  PL-REVISION-NO-A1             PIC 999.               ERCPLAN
   883                                                                  ERCPLAN
   884     12  PL-MAINT-INFORMATION.                                    ERCPLAN
   885         16  PL-LAST-MAINT-DT              PIC XX.                ERCPLAN
   886         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCPLAN
   887         16  PL-LAST-MAINT-USER            PIC X(4).              ERCPLAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* DCC043RET.cbl (/apps/prod/cid1p/copy/ERCPLAN)
   888         16  FILLER                        PIC XX.                ERCPLAN
   889                                                                  ERCPLAN
   890     12  PL-LIABILITY-LIMITS.                                     ERCPLAN
   891         16  PL-ATT-AGE                    PIC S99        COMP-3. ERCPLAN
   892         16  PL-L-LIMITS        OCCURS 8 TIMES.                   ERCPLAN
   893             20  PL-LM-AGE                 PIC S99        COMP-3. ERCPLAN
   894             20  PL-LM-DUR                 PIC S999       COMP-3. ERCPLAN
   895             20  PL-LM-MOA                 PIC S9(4)      COMP-3. ERCPLAN
   896             20  PL-LM-AMT                 PIC S9(6)      COMP-3. ERCPLAN
   897                                                                  ERCPLAN
   898     12  FILLER                            PIC X(30).             ERCPLAN
   899                                                                  ERCPLAN
   900     12  PL-GL-ACCOUNT-NOS.                                       ERCPLAN
   901         16  PL-PREMIUM-GL                 PIC X(8).              ERCPLAN
   902         16  PL-COMM-GL                    PIC X(8).              ERCPLAN
   903         16  PL-CLAIM-GL                   PIC X(8).              ERCPLAN
   904     12  FILLER                            PIC X(24).             ERCPLAN
   905     12  PL-TOLERANCES.                                           ERCPLAN
   906         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3. ERCPLAN
   907         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3. ERCPLAN
   908         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3. ERCPLAN
   909         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3. ERCPLAN
   910         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3. ERCPLAN
   911         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3. ERCPLAN
   912     12  PL-OVER-SHORT.                                           ERCPLAN
   913         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3. ERCPLAN
   914         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3. ERCPLAN
   915     12  FILLER                            PIC X(24).             ERCPLAN
   916     12  PLAN-MISC.                                               ERCPLAN
   917         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3. ERCPLAN
   918         16  PL-STATE-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   919         16  PL-IG                         PIC X.                 ERCPLAN
   920         16  PL-RETRO-RET                  PIC S9V9999    COMP-3. ERCPLAN
   921         16  PL-POLICY-FORM                PIC X(12).             ERCPLAN
   922         16  PL-EDIT-FOR-FORM              PIC X(01).             ERCPLAN
   923         16  PL-DEV-CODE                   PIC XXX.               ERCPLAN
   924         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3. ERCPLAN
   925         16  PL-CALC-METHOD                PIC X.                 ERCPLAN
   926         16  PL-BENEFIT-GROUP              PIC X(05).             ERCPLAN
   927         16  PL-SALES-TAX                  PIC S9V9999    COMP-3. ERCPLAN
   928                                                                  ERCPLAN
   929         16  FILLER                        PIC X(99).             ERCPLAN
   930******************************************************************ERCPLAN
   931
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* DCC043RET.cbl
   933 FD  DISK-DATE
*  934                             COPY ELCDTEFD.
   935******************************************************************04/15/98
   936*                                                                *ELCDTEFD
   937*                                                                *ELCDTEFD
   938*                            ELCDTEFD.                           *   LV002
   939*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   940*                            VMOD=2.007                          *   CL**2
   941*                                                                *ELCDTEFD
   942******************************************************************ELCDTEFD
   943     BLOCK CONTAINS 0 RECORDS
   944     RECORDING MODE F.                                            ELCDTEFD
   945                                                                  ELCDTEFD
   946 01  DATE-DISK.                                                   ELCDTEFD
   947     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   948     12  FILLER                      PIC  X(14).                  ELCDTEFD
   949     12  DD-CR1                      PIC  9.                      ELCDTEFD
   950     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   951     12  DD-CR2                      PIC  9.                      ELCDTEFD
   952     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   953     12  FILLER                      PIC  X(20).                  ELCDTEFD
   954                                                                  ELCDTEFD
   955 01  DATE-DISK-R.                                                 ELCDTEFD
   956     12  FILLER                      PIC  X(4).                   ELCDTEFD
   957     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   958                                     PIC  X(32).                  ELCDTEFD
   959                                                                  ELCDTEFD
   960 01  DATE-DISK-T.                                                 ELCDTEFD
   961     12  FILLER                      PIC  X(4).                   ELCDTEFD
   962     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   963                                     PIC  X(48).                  ELCDTEFD
   964                                                                  ELCDTEFD
   965 01  DATE-DISK-M.                                                 ELCDTEFD
   966     12  FILLER                      PIC  X(4).                   ELCDTEFD
   967     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   968                                     PIC  X(48).                  ELCDTEFD
   969                                                                  ELCDTEFD
   970 01  DATE-DISK-P.                                                 ELCDTEFD
   971     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   972     12  DD-IDX                      PIC  99.                     ELCDTEFD
   973     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   974     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   975         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   976                                     PIC  X.                      ELCDTEFD
   977         16  FILLER                  PIC  X(46).                  ELCDTEFD
   978     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   979         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   980             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   981             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   982             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   983             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   984         16  FILLER                  PIC  X(16).                  ELCDTEFD
   985                                                                  ELCDTEFD
   986 01  DATE-DISK-E.                                                 ELCDTEFD
   987     12  FILLER                      PIC  X(4).                   ELCDTEFD
   988     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   989                                     PIC  X(4).                   ELCDTEFD
   990                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   991 01  DATE-DISK-C.                                                 ELCDTEFD
   992     12  FILLER                      PIC  X(7).                   ELCDTEFD
   993     12  DD-CARR1-SECPAY-SW          PIC  X.
   994     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   995     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   996     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   997     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   998     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   999     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1000     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1001     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1002     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1003     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1004     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1005     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1006     12  DD-CARR2-SECPAY-SW          PIC  X.
  1007     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1008                                                                  ELCDTEFD
  1009 01  DATE-DISK-OPT.                                               ELCDTEFD
  1010     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1011     12  DD-TLR-DATA.                                             ELCDTEFD
  1012         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1013                                     PIC  X(03).                  ELCDTEFD
  1014     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1015         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1016                                     PIC  X(06).                  ELCDTEFD
  1017     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1018         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1019                                     PIC  X(07).                  ELCDTEFD
  1020         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1021     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1022                                     PIC  X(96).                  ELCDTEFD
  1023******************************************************************ELCDTEFD
  1024
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* DCC043RET.cbl
  1026 FD  FICH
* 1027                             COPY ELCFCHFD.
  1028******************************************************************04/15/98
  1029*                                                                *ELCFCHFD
  1030*                            ELCFCHFD.                           *   LV003
  1031*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1032*                            VMOD=2.004                          *   CL**3
  1033*                                                                *ELCFCHFD
  1034******************************************************************ELCFCHFD
  1035     BLOCK CONTAINS 0 RECORDS
  1036     RECORDING MODE F.                                            ELCFCHFD
  1037                                                                  ELCFCHFD
  1038 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1039******************************************************************ELCFCHFD
  1040 FD  DATA-OUT
  1041     RECORDING MODE F
  1042     BLOCK CONTAINS 0 RECORDS.
  1043
  1044 01  DATA-OUT-REC               PIC X(1833).
  1045
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* DCC043RET.cbl
  1047 WORKING-STORAGE SECTION.
  1048
  1049 77  FILLER  PIC X(32) VALUE '********************************'.
  1050 77  FILLER  PIC X(32) VALUE '     ECS043 WORKING STORAGE     '.
  1051 77  FILLER  PIC X(32) VALUE '***********VMOD=2.020 **********'.
  1052
  1053 77  NO-OF-RECORDS-RELEASED  PIC S9(9)      COMP-3  VALUE +0.
  1054 77  NDX                     PIC S999            COMP.
  1055 77  SA                      PIC S999            COMP.
  1056 77  SB                      PIC S999            COMP.
  1057 77  SC                      PIC S999            COMP.
  1058 77  SE                      PIC S999            COMP.
  1059 77  SF                      PIC S999            COMP.
  1060 77  SG                      PIC S999            COMP.
  1061 77  SH                      PIC S999            COMP.
  1062 77  CL                      PIC S999            COMP.
  1063 77  AL                      PIC S999            COMP.
  1064 77  AN                      PIC S999            COMP.
  1065 77  WS-SEQ-NBR              PIC S9              COMP   VALUE +0.
  1066 77  PAGE-CNT                PIC S9(5)           COMP-3 VALUE +0.
  1067 77  LINE-CNT                PIC S999            COMP-3 VALUE +99.
  1068 77  PGM-SUB                 PIC S999            COMP-3 VALUE +43.
  1069 77  X                       PIC X.
  1070 77  BREAK-1-SWITCH          PIC X       VALUE SPACES.
  1071 77  WS-EP-CODE              PIC X.
  1072 77  WS-OB-CODE              PIC X.
  1073 77  SAVE-DA-UP              PIC S9(9)V99.
  1074 77  SAVE-DA-UC              PIC S9(9)V99.
  1075 77  SAVE-DA-GA-UC           PIC S9(9)V99.
  1076 77  SAVE-DA-PCT-E-PREM      PIC S9(9)V99.
  1077 77  SAVE-DA-PCT-UP          PIC S9(9)V99.
  1078 77  SAVE-BEG-DATE           PIC 9(11)     VALUE ZERO.
  1079 77  WS-RETRO-FLAG           PIC X.
  1080 77  WS-DO-SUB               PIC S9(3)     COMP-3 VALUE +0.
  1081
  1082 01  SPACE-LINE                PIC X(132)  VALUE SPACES.
  1083
  1084 01  WS-ABEND-STORAGE.
  1085     12  WS-RETURN-CODE        PIC S9(4)   VALUE ZERO COMP.
  1086     12  WS-ABEND-MESSAGE      PIC X(80)   VALUE SPACES.
  1087     12  WS-ABEND-FILE-STATUS  PIC XX      VALUE ZERO.
  1088     12  WS-ZERO               PIC S9      VALUE ZERO COMP-3.
  1089
  1090     12  WS-ABEND-CODE         PIC 9(4).
  1091     12  WORK-ABEND-CODE       REDEFINES     WS-ABEND-CODE.
  1092         16  W-ABEND-CODE-1    PIC XX.
  1093         16  W-ABEND-CODE-2    PIC XX.
  1094     12  ERACCTT-FILE-STATUS   PIC XX.
  1095     12  ERPLAN-FILE-STATUS    PIC XX.
  1096
  1097 01  WORK-MSG.
  1098     05  FILLER              PIC X    VALUE SPACE.
  1099     05  W-MM                PIC XX.
  1100     05  FILLER              PIC X    VALUE '/'.
  1101     05  W-DD                PIC XX.
  1102     05  FILLER              PIC X    VALUE '/'.
  1103     05  W-CCYY              PIC X(4).
  1104     05  FILLER        PIC X(9)  VALUE ' TO DATE '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* DCC043RET.cbl
  1105
  1106 01  FORMAT-CONTROL-CARD.
  1107     05  FC-ID               PIC XX.
  1108     05  FC-CLIENT           PIC XXX.
  1109     05  FC-CODE             PIC X.
  1110     05  FC-DATE             PIC 9(8).
  1111     05  FC-DATE-R  REDEFINES  FC-DATE.
  1112         10  FC-CCYY         PIC 9(04).
  1113         10  FC-CCYR REDEFINES FC-CCYY.
  1114             15  FC-CC       PIC 99.
  1115             15  FC-YY       PIC 99.
  1116         10  FC-MM           PIC 99.
  1117         10  FC-DD           PIC 99.
  1118     05  FILLER              PIC X(66).
  1119
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* DCC043RET.cbl
  1121 01  SW-REC.
  1122     12  SW-RPT-TYPE-ID      PIC X.
  1123         88  ACCOUNT-RPT        VALUE 'A'.
  1124         88  RETRO-GROUP-RPT    VALUE 'B'.
  1125         88  GA-ACCOUNT-RPT     VALUE 'C'.
  1126     12  SW-CTL.
  1127         16  SW-GA           PIC X(10).
  1128         16  SW-CARR         PIC X.
  1129         16  SW-COMP         PIC XXXXXX.
  1130         16  SW-STATE        PIC XX.
  1131         16  SW-ACCT         PIC X(10).
  1132         16  SW-EXP-DT       PIC 9(11)  COMP-3.
  1133     12  SW-EFF-DT           PIC 9(11)  COMP-3.
  1134     12  SW-NAME             PIC X(30).
  1135     12  SW-ADDRS            PIC X(20).
  1136     12  SW-CITY             PIC X(20).
  1137     12  SW-ZIP.
  1138         16  SW-ZIP-PRIME.
  1139             20  FILLER      PIC X(01).
  1140                 88  SW-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1141             20  FILLER      PIC X(04).
  1142         16  SW-ZIP-PLUS4    PIC X(04).
  1143     12  SW-CANADIAN-POSTAL-CODES REDEFINES SW-ZIP.
  1144         16  SW-CAN-POST-CODE-1
  1145                             PIC X(03).
  1146         16  SW-CAN-POST-CODE-2
  1147                             PIC X(03).
  1148         16  FILLER          PIC X(03).
  1149     12  SW-LRET             PIC S9V9(4)     COMP-3.
  1150     12  SW-ARET             PIC S9V9(4)     COMP-3.
  1151     12  SW-RET-Y-N          PIC X.
  1152     12  SW-RET-TYP          PIC X.
  1153     12  SW-GA-FLAG          PIC X.
  1154*00214      12  SW-ACCUMS           PIC X(972).
  1155     12  SW-ACCUMS           PIC X(1404).
  1156     12  SW-BEG-DATE         PIC 9(11)       COMP-3.
  1157     12  SW-RETRO-LIMIT      PIC S9(7)       COMP-3.
  1158     12  SW-PREM-P-E         PIC X.
  1159     12  SW-CLMS-P-I         PIC X.
  1160     12  SW-RETRO-POOL       PIC X(10).
  1161     12  SW-TAX-P-E          PIC X.
  1162
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* DCC043RET.cbl
  1164 01  WS-ACCT-CONTROL.
  1165     12  WS-MSTR-CNTRL       PIC X(25)   VALUE LOW-VALUES.
  1166     12  WS-EFFECT           PIC 9(11)  COMP-3  VALUE ZEROS.
  1167
  1168 01  WS-SAVE-CONTROL.
  1169     12  WS-SAVE-CARR        PIC X.
  1170     12  WS-SAVE-COMP        PIC XXXXXX.
  1171     12  WS-SAVE-STATE       PIC XX.
  1172     12  WS-SAVE-ACCT        PIC X(10).
  1173     12  WS-SAVE-EXP-DATE    PIC 9(11)  COMP-3.
  1174     12  WS-SAVE-EFF-DATE    PIC 9(11)  COMP-3.
  1175
  1176 01  WS-ACCT-CONTROL-EFFDT.
  1177     12  WS-MSTR-CNTRL-EFFDT PIC X(19).
  1178     12  WS-EFFECT-EFFDT     PIC 9(11)  COMP-3  VALUE ZEROS.
  1179 01  WS-SAVE-CONTROL-EFFDT.
  1180     12  WS-SAVE-CNTRL-EFFDT PIC X(19).
  1181     12  WS-SAVE-EFF-DATE-EFFDT PIC 9(11)  COMP-3.
  1182
  1183 01  WS-PREV-RPT-TYPE        PIC X.
  1184 01  WS-SAVE-CTL.
  1185     12  WS-SAVE-GA          PIC X(10).
  1186     12  WS-SAVE-CAR         PIC X.
  1187     12  WS-SAVE-CMP         PIC XXXXXX.
  1188     12  WS-SAVE-ST          PIC XX.
  1189     12  WS-SAVE-ACC         PIC X(10).
  1190     12  WS-SAVE-EXP         PIC 9(11)  COMP-3.
  1191
  1192 01  WS-PLAN-CONTROL.
  1193     12  WS-PL-COMPANY-CD    PIC X          VALUE SPACE.
  1194     12  WS-PL-CONTROL-A.
  1195         16  WS-PL-CARRIER       PIC X      VALUE SPACE.
  1196         16  WS-PL-GROUPING      PIC X(6)   VALUE SPACES.
  1197         16  WS-PL-STATE         PIC XX     VALUE SPACES.
  1198         16  WS-PL-ACCOUNT       PIC X(10)  VALUE SPACES.
  1199     12  WS-PL-BENEFIT-TYPE  PIC X          VALUE SPACE.
  1200     12  WS-PL-BENEFIT-CODE  PIC XX         VALUE SPACE.
  1201     12  WS-PL-REVISION-NO   PIC X(3)       VALUE SPACES.
  1202
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* DCC043RET.cbl
  1204 01  MISC.
  1205     12  RETENT-FACT         PIC S9V9(5)   VALUE +0.
  1206     12  ERP-PERCENT         PIC S9V9(5)   VALUE +0.
  1207     12  EXP-FACTOR          PIC S9V9(5)   VALUE +0.
  1208     12  LIFE-RETENT         PIC S9V9(5)     COMP-3  VALUE +0.
  1209     12  AH-RETENT           PIC S9V9(5)     COMP-3  VALUE +0.
  1210     12  SAVE-RETRO-LIMIT    PIC S9(7)       COMP-3.
  1211     12  ANNUALIZED-PREM     PIC S9(9)V99    COMP-3.
  1212     12  WS-MIN-LOSS         PIC S9(5)V99    COMP-3.
  1213     12  HEAD-SW             PIC X         VALUE SPACE.
  1214     12  NBR-OF-MTHS         PIC 99        VALUE 12.
  1215     12  SAVE-GA-FLAG        PIC X.
  1216     12  SAVE-RET-Y-N        PIC X.
  1217     12  SAVE-RET-TYP        PIC X.
  1218     12  SAVE-PREM-P-E       PIC X.
  1219     12  SAVE-CLMS-P-I       PIC X.
  1220     12  WS-EXCLUSION-SWITCH PIC X             VALUE SPACE.
  1221         88  EXCLUDING-BENEFIT  VALUE '*'.
  1222
  1223 01  BEG-DATE                PIC 9(11).
  1224 01  BEG-DATE-R REDEFINES BEG-DATE.
  1225     12 FILLER               PIC 999.
  1226     12  BD-CCYY             PIC 9(04).
  1227     12  BD-CCYR REDEFINES BD-CCYY.
  1228         16  BD-CC           PIC 99.
  1229         16  BD-YR           PIC 99.
  1230     12  BD-MO               PIC 99.
  1231     12  BD-DA               PIC 99.
  1232
  1233 01  RUN-DT                  PIC 9(11).
  1234 01  RUN-DT-R REDEFINES RUN-DT.
  1235     12  FILLER              PIC 999.
  1236     12  RD-CCYY             PIC 9(04).
  1237     12  RD-CCYR REDEFINES RD-CCYY.
  1238         16  RD-CC           PIC 99.
  1239         16  RD-YR           PIC 99.
  1240     12  RD-MO               PIC 99.
  1241     12  RD-DA               PIC 99.
  1242
  1243 01  WORK-DATE           PIC 9(11).
  1244 01  WORK-DATE-R  REDEFINES  WORK-DATE.
  1245     12  FILLER          PIC 999.
  1246     12  WK-CCYY         PIC 9(04).
  1247     12  WK-CCYR REDEFINES WK-CCYY.
  1248         16  WK-CC       PIC 99.
  1249         16  WK-YR       PIC 99.
  1250     12  WK-MO           PIC 99.
  1251     12  WK-DA           PIC 99.
  1252
  1253 01  ZONE-GROUP.
  1254     03  ZON                 PIC XXX       VALUE 'ZON'.
  1255     03  Z-G                 PIC XXX.
  1256
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* DCC043RET.cbl
  1258*
  1259* THE DETAIL AND AGENTS ACCUMULATORS ARE USED AS FOLLOWS
  1260*
  1261*    OCCURRENCE 1 = LIFE BEGINNING DATA
  1262*    OCCURRENCE 2 = A&H BEGINNING DATA
  1263*    OCCURRENCE 3 = LIFE CURRENT DATA
  1264*    OCCURRENCE 4 = A&H CURRENT DATA
  1265*
  1266 01  DETAIL-ACCUMULATORS     COMP-3.
  1267     12  DETAIL-ACCUMS   OCCURS 4 TIMES.
  1268         16  DA-ISP          PIC S9(9)V99.
  1269         16  DA-TAX          PIC S9(9)V99.
  1270         16  DA-CNP          PIC S9(9)V99.
  1271         16  DA-UP           PIC S9(9)V99.
  1272         16  DA-CLM          PIC S9(9)V99.
  1273         16  DA-EXP          PIC S9(9)V99.
  1274         16  DA-CPS          PIC S9(9)V99.
  1275         16  DA-OTC          PIC S9(9)V99.
  1276         16  DA-LRV          PIC S9(9)V99.
  1277         16  DA-CAJ          PIC S9(9)V99.
  1278         16  DA-ISC          PIC S9(9)V99.
  1279         16  DA-CNC          PIC S9(9)V99.
  1280         16  DA-UC           PIC S9(9)V99.
  1281         16  DA-ISC-ADDL     PIC S9(9)V99.
  1282         16  DA-CNC-ADDL     PIC S9(9)V99.
  1283         16  DA-UC-ADDL      PIC S9(9)V99.
  1284         16  DA-GA-ISC       PIC S9(9)V99.
  1285         16  DA-GA-CNC       PIC S9(9)V99.
  1286         16  DA-GA-UC        PIC S9(9)V99.
  1287         16  DA-PCT-E-PREM   PIC S9(9)V99.
  1288         16  DA-CSO-ADMIN    PIC S9(9)V99.
  1289         16  DA-CCC-ADMIN    PIC S9(9)V99.
  1290         16  DA-CSO-ADM-UC   PIC S9(9)V99.
  1291
  1292 01  TEMP-GA-ACCUMS.
  1293     12  GA-LEVELS.
  1294         16  GA-LEVELS OCCURS 10 TIMES.
  1295             20  XDA-GA-NO       PIC X(10).
  1296             20  XDA-GA-TYPE     PIC X.
  1297             20  ACCUM-LEVELS OCCURS 4 TIMES.
  1298                 24  XDA-GA-ISC      PIC S9(9)V99    COMP-3.
  1299                 24  XDA-GA-CNC      PIC S9(9)V99    COMP-3.
  1300                 24  XDA-GA-UC       PIC S9(9)V99    COMP-3.
  1301
  1302 01  EC-REC-MAX                  PIC S99 COMP-3 VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* DCC043RET.cbl
  1304*
  1305* THE PRINT ACCUMULATORS ARE USED AS FOLLOWS
  1306*
  1307*    A SET CONSISTS OF 6 ACCUMULATORS
  1308*
  1309*        OCCURRENCE 1 = LIFE TOTAL PERIOD
  1310*        OCCURRENCE 2 = A&H TOTAL FOR PERIOD
  1311*        OCCURRENCE 3 = COMBINED TOTAL FOR PERIOD
  1312*        OCCURRENCE 4 = LIFE TOTAL FOR INCEPTION-TO-DATE
  1313*        OCCURRENCE 5 = A&H TOTAL FOR INCEPTION-TO-DATE
  1314*        OCCURRENCE 6 = COMBINED TOTAL FOR INCEPTION-TO-DATE
  1315*
  1316*    THERE ARE 6 SETS
  1317*
  1318*        SET 1 = LEVEL 1 (DATE RANGE TOTALS)
  1319*        SET 2 = LEVEL 2 (ACCOUNT TOTALS)
  1320*        SET 3 = LEVEL 3 (STATE TOTALS)
  1321*        SET 4 = LEVEL 4 (COMPANY TOTALS)
  1322*        SET 5 = LEVEL 5 (CARRIER TOTALS)
  1323*        SET 6 = LEVEL 6 (FINAL TOTALS)
  1324*
  1325 01  PRINT-ACCUMULATORS      COMP-3.
  1326     12  PRINT-ACCUMS    OCCURS 36.
  1327         16  PA-NW           PIC S9(9)V99.
  1328         16  PA-BR           PIC S9(9)V99.
  1329         16  PA-ER           PIC S9(9)V99.
  1330         16  PA-EP           PIC S9(9)V99.
  1331         16  PA-PE           PIC S9(9)V99.
  1332         16  PA-PL           PIC S9(9)V99.
  1333         16  PA-BLR          PIC S9(9)V99.
  1334         16  PA-ELR          PIC S9(9)V99.
  1335         16  PA-TL           PIC S9(9)V99.
  1336         16  PA-RC           PIC S9(9)V99.
  1337         16  PA-OC           PIC S9(9)V99.
  1338         16  PA-TC           PIC S9(9)V99.
  1339         16  PA-CP           PIC S9(9)V99.
  1340         16  PA-EX           PIC S9(9)V99.
  1341         16  PA-TE           PIC S9(9)V99.
  1342         16  PA-BA           PIC S9(9)V99.
  1343         16  PA-NTE          PIC S9(9)V99.
  1344         16  PA-NBA          PIC S9(9)V99.
  1345         16  PA-EC           PIC S9(9)V99.
  1346         16  PA-GARC         PIC S9(9)V99.
  1347         16  PA-GAEC         PIC S9(9)V99.
  1348         16  PA-GACU         PIC S9(9)V99.
  1349         16  PA-CU           PIC S9(9)V99.
  1350         16  PA-GATC         PIC S9(9)V99.
  1351         16  PA-GAGT         PIC S9(9)V99.
  1352         16  PA-GABA         PIC S9(9)V99.
  1353         16  PA-GATE         PIC S9(9)V99.
  1354         16  PA-TAXP         PIC S9(9)V99.
  1355         16  PA-TAXE         PIC S9(9)V99.
  1356         16  PA-ACCT-COMMP   PIC S9(9)V99.
  1357         16  PA-ACCT-COMME   PIC S9(9)V99.
  1358         16  PA-OW-COMMP     PIC S9(9)V99.
  1359         16  PA-OW-COMME     PIC S9(9)V99.
  1360         16  PA-CSO-ADMINP   PIC S9(9)V99.
  1361         16  PA-CSO-ADMINE   PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* DCC043RET.cbl
  1362         16  PA-CCC-ADMINP   PIC S9(9)V99.
  1363         16  PA-CCC-ADMINE   PIC S9(9)V99.
  1364         16  PA-TOT-CLPP     PIC S9(9)V99.
  1365         16  PA-TOT-CLPE     PIC S9(9)V99.
  1366 01  PRINT-ACCUMULATORS-R    REDEFINES PRINT-ACCUMULATORS  COMP-3.
  1367     12  PRINT-ACCUMS-R  OCCURS 6.
  1368         16  PRINT-ACCUMS-SL OCCURS 6.
  1369*00403              20  PRINT-ACCUMS-L OCCURS 27.
  1370             20  PRINT-ACCUMS-L OCCURS 39.
  1371                 24  PA-AMT  PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* DCC043RET.cbl
  1373
  1374*
  1375* THE FOLLOWING ACCUMULATORS ARE FOR THE PERCENTS
  1376*    TO BE PRINTED ON THE RETRO
  1377*
  1378 01  PERCENT-ACCUMULATORS    COMP-3.
  1379     12  PER-ACCUMS      OCCURS 2.
  1380       14  PER-ACCUMS-X   OCCURS 39.
  1381         16  PT-PRCNT        PIC S9(4)V9(4).
  1382
  1383 01  DESC-TABLE.
  1384     12  FILLER              PIC X(33)   VALUE
  1385             '1. NET WRITTEN PREMIUM      00101'.
  1386     12  FILLER              PIC X(33)   VALUE
  1387             '2. PLUS BEGINNING RESERVE   00202'.
  1388     12  FILLER              PIC X(33)   VALUE
  1389             '3. LESS ENDING RESERVE      00303'.
  1390     12  FILLER              PIC X(33)   VALUE
  1391             '4. EARNED PREMIUM           00404'.
  1392     12  FILLER              PIC X(33)   VALUE
  1393             '5. PERCENT OF EARNED PREMIUM00505'.
  1394     12  FILLER              PIC X(33)   VALUE
  1395             '6. EXPENSES                 -0000'.
  1396     12  FILLER              PIC X(33)   VALUE
  1397             ' A. LOSSES                  00000'.
  1398     12  FILLER              PIC X(33)   VALUE
  1399             '  1. PAID                    0606'.
  1400     12  FILLER              PIC X(33)   VALUE
  1401             '  2. LESS BEG. LOSS RESERVE  0707'.
  1402     12  FILLER              PIC X(33)   VALUE
  1403             '  3. PLUS END. LOSS RESERVE  0808'.
  1404     12  FILLER              PIC X(33)   VALUE
  1405             '  4. TOTAL                   0909'.
  1406     12  FILLER              PIC X(33)   VALUE
  1407             ' B. COMMISSIONS             00000'.
  1408     12  FILLER              PIC X(33)   VALUE
  1409             '  1. RETAINED                2323'.
  1410     12  FILLER              PIC X(33)   VALUE
  1411             '  2. OTHER COMMISSION PAID   1111'.
  1412     12  FILLER              PIC X(33)   VALUE
  1413             '  3. OVERWRITE               2222'.
  1414     12  FILLER              PIC X(33)   VALUE
  1415*            '  3. TOTAL                   12  '.
  1416             '  3. TOTAL                       '.
  1417     12  FILLER              PIC X(33)   VALUE
  1418*            '  4. TOTAL                     24'.
  1419             '  4. TOTAL                   2424'.
  1420     12  WS-EX-LINE          PIC X(33)   VALUE
  1421             ' C. OTHER EXPENSE           01414'.
  1422     12  FILLER              PIC X(33)   VALUE
  1423             '7. TOTAL EXPENSE            01727'.
  1424     12  WS-BAL-LINE-1       PIC X(33)   VALUE
  1425             '8. BALANCE AT END OF PERIOD 01826'.
  1426     12  WS-BAL-LINE-2       PIC X(33)   VALUE
  1427             '   (LINE 5 MINUS LINE 7)     0000'.
  1428     12  FILLER              PIC X(33)   VALUE
  1429             '9. ACCOUNT BALANCES         0  18'.
  1430     12  FILLER              PIC X(33)   VALUE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* DCC043RET.cbl
  1431             '9. EXPERIENCE REFUND PRV PD 013  '.
  1432     12  FILLER              PIC X(33)   VALUE
  1433             '10. EXPERIENCE REFUND PRV PD0  13'.
  1434     12  FILLER              PIC X(33)   VALUE
  1435             '10. NET BALANCE OR LOSS     -16  '.
  1436     12  FILLER              PIC X(33)   VALUE
  1437             '11. NET BALANCE OR LOSS     -  25'.
  1438     12  FILLER              PIC X(33)   VALUE
  1439             '11. CSO ADMIN FEE           03434'.
  1440     12  FILLER              PIC X(33)   VALUE
  1441             '12. CCC ADMIN FEE           03636'.
  1442     12  FILLER              PIC X(33)   VALUE
  1443             '12. TOTAL CLP               03838'.
  1444     12  FILLER              PIC X(33)   VALUE HIGH-VALUES.
  1445 01  DESC-TABLE-R    REDEFINES DESC-TABLE.
  1446     12  DT-TB-ENT   OCCURS 30.
  1447         16  DT-ENTRY    PIC X(28).
  1448         16  DT-CTL-CHAR PIC X.
  1449         16  DT-SUBSCR   OCCURS 2.
  1450             20  DT-SS-R.
  1451                 24  DT-SS   PIC 99.
  1452
  1453 01  DESC-TABLE-DESCRIPTIONS.
  1454     12  TAX-EXPENSE-LINE    PIC X(33)   VALUE
  1455             ' C. TAXES AND OTHER EXPENSES01414'.
  1456     12  EXPENSE-LINE        PIC X(33)   VALUE
  1457             ' C. OTHER EXPENSE           01414'.
  1458     12  BALANCE-LINE-1      PIC X(33)   VALUE
  1459             '8. BALANCE AT END OF PERIOD 01826'.
  1460     12  BALANCE-LINE-2      PIC X(33)   VALUE
  1461             '   (LINE 5 MINUS LINE 7)     0000'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* DCC043RET.cbl
  1463
  1464 01  HEAD-1.
  1465     12  H1-NAME         PIC X(30)   VALUE SPACES.
  1466     12  FILLER          PIC X(21)   VALUE SPACES.
  1467     12  FILLER          PIC X(20)   VALUE 'CREDIT INSURANCE EAR'.
  1468     12  FILLER          PIC X(10)   VALUE 'NED REVIEW'.
  1469     12  FILLER          PIC X(38)   VALUE SPACES.
  1470     12  FILLER          PIC X(6)    VALUE 'ECS043'.
  1471     12  H1-REPORT-SUF   PIC X       VALUE SPACES.
  1472
  1473 01  HEAD-2.
  1474     12  H2-ADDR         PIC X(30)   VALUE SPACES.
  1475     12  FILLER          PIC X(21)   VALUE SPACES.
  1476     12  HD-COMP         PIC X(30)   VALUE SPACES.
  1477     12  FILLER          PIC X(38)   VALUE SPACES.
  1478     12  HD-RD           PIC X(8)    VALUE SPACES.
  1479
  1480 01  HEAD-3.
  1481     12  H3-ADDR         PIC X(20)   VALUE SPACES.
  1482     12  FILLER          PIC X       VALUE SPACES.
  1483     12  H3-ZIP.
  1484         16  H3-ZIP-PRIME
  1485                         PIC X(5).
  1486         16  H3-DASH     PIC X.
  1487         16  H3-ZIP-PLUS4
  1488                         PIC X(4).
  1489     12  H3-CANADIAN-POSTAL-CODE REDEFINES H3-ZIP.
  1490         16  H3-CAN-POSTAL-CODE-1
  1491                         PIC X(3).
  1492         16  H3-DASH-CAN PIC X.
  1493         16  H3-CAN-POSTAL-CODE-2
  1494                         PIC X(3).
  1495         16  H3-CAN-FILLER
  1496                         PIC X(3).
  1497     12  FILLER          PIC X(26)   VALUE SPACES.
  1498     12  HD-AD           PIC X(18)   VALUE SPACES.
  1499     12  FILLER          PIC X(44)   VALUE SPACES.
  1500     12  FILLER          PIC X(05)   VALUE
  1501         'PAGE '.
  1502     12  H3-PAGE         PIC ZZZZ9.
  1503
  1504 01  HEAD-4.
  1505     12  FILLER          PIC X(20)   VALUE 'COMP    ST ACCOUNT  '.
  1506     12  H4-FT           PIC X(20)   VALUE '       FROM    TO'.
  1507     12  FILLER          PIC X(5)    VALUE SPACES.
  1508     12  H4-GROUP        PIC X(6)    VALUE SPACES.
  1509
  1510 01  HEAD-5.
  1511     12  H5-CARR         PIC X       VALUE SPACES.
  1512     12  H5-COMP         PIC X(6)    VALUE SPACES.
  1513     12  FILLER          PIC X       VALUE SPACES.
  1514     12  H5-ST           PIC XX      VALUE SPACES.
  1515     12  FILLER          PIC X       VALUE SPACES.
  1516     12  H5-ACCT         PIC X(10)   VALUE SPACES.
  1517     12  FILLER          PIC X       VALUE SPACES.
  1518     12  H5-FMO          PIC XX      VALUE SPACES.
  1519     12  H5-FS1          PIC X       VALUE '-'.
  1520     12  H5-FDA          PIC XX      VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* DCC043RET.cbl
  1521     12  H5-FS2          PIC X       VALUE '-'.
  1522     12  H5-FYR          PIC XX      VALUE SPACES.
  1523     12  FILLER          PIC X       VALUE SPACES.
  1524     12  H5-TMO          PIC XX      VALUE SPACES.
  1525     12  H5-TS1          PIC X       VALUE '-'.
  1526     12  H5-TDA          PIC XX      VALUE SPACES.
  1527     12  H5-TS2          PIC X       VALUE '-'.
  1528     12  H5-TYR          PIC XX      VALUE SPACES.
  1529     12  FILLER          PIC X(4)    VALUE SPACES.
  1530     12  H5-GROUP        PIC X(10)   VALUE SPACES.
  1531     12  H5-MESSAGE      PIC X(40)   VALUE SPACES.
  1532     12  END-CHARACTER   PIC X       VALUE ' '.
  1533
  1534 01  HEAD-6.
  1535     12  FILLER          PIC X(15)   VALUE '***************'.
  1536     12  H6-YTD-HD.
  1537         14  FILLER      PIC X(8)    VALUE '*  LAST '.
  1538         14  H6-MTHS     PIC Z9.
  1539         14  FILLER      PIC X(10)   VALUE ' MONTHS  *'.
  1540     12  H6-YTD-HD-R  REDEFINES H6-YTD-HD.
  1541         16  H6R-FILLER  PIC X.
  1542         16  H6R-MO      PIC XX.
  1543         16  H6R-DASH1   PIC X.
  1544         16  H6R-DA      PIC XX.
  1545         16  H6R-DASH2   PIC X.
  1546         16  H6R-CCYY    PIC X(4).
  1547         16  H6R-MSG     PIC X(9).
  1548     12  FILLER          PIC X(15)   VALUE '***************'.
  1549     12  FILLER          PIC X(29)   VALUE SPACES.
  1550     12  FILLER          PIC X(16)   VALUE '****************'.
  1551     12  FILLER          PIC X(21)  VALUE '  INCEPTION TO DATE  '.
  1552     12  FILLER          PIC X(16)   VALUE '****************'.
  1553
  1554 01  HEAD-7.
  1555     12  HEAD-7-PLUG-1   PIC X(12)   VALUE SPACES.
  1556     12  FILLER          PIC X(1)    VALUE SPACES.
  1557     12  HEAD-7-PLUG-2   PIC X(12)   VALUE SPACES.
  1558     12  FILLER          PIC X(15)   VALUE '         TOTAL '.
  1559     12  FILLER          PIC X(20)   VALUE '   PERCENT          '.
  1560     12  FILLER          PIC X(20)   VALUE '                    '.
  1561     12  HEAD-7-PLUG-3   PIC X(12)   VALUE SPACES.
  1562     12  FILLER          PIC X       VALUE SPACES.
  1563     12  HEAD-7-PLUG-4   PIC X(12)   VALUE SPACES.
  1564     12  FILLER          PIC X(15)   VALUE '           TOTA'.
  1565     12  FILLER          PIC X(12)   VALUE 'L    PERCENT'.
  1566
  1567 01  HEAD-8-STATE.
  1568     12  FILLER          PIC X(8)    VALUE '  STATE '.
  1569     12  H8-ST           PIC XX      VALUE SPACES.
  1570     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1571
  1572 01  HEAD-8-COMP.
  1573     12  FILLER          PIC X(10)   VALUE '  COMPANY '.
  1574     12  H8-COMP         PIC X(6)    VALUE SPACES.
  1575     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1576
  1577 01  HEAD-8-CARR.
  1578     12  FILLER          PIC X(10)   VALUE '  CARRIER '.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* DCC043RET.cbl
  1579     12  H8-CARR         PIC X       VALUE SPACES.
  1580     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1581
  1582 01  HEAD-8-GROUP.
  1583     12  H-8-G           PIC X(8)    VALUE '  GROUP '.
  1584     12  H8-GROUP        PIC X(6)    VALUE SPACES.
  1585     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1586
  1587 01  HEAD-8-GA.
  1588     12  FILLER          PIC X(8)    VALUE '   G.A. '.
  1589     12  H8-GA           PIC X(10)   VALUE SPACES.
  1590     12  FILLER          PIC X(7)    VALUE ' TOTALS'.
  1591
  1592 01  HEAD-8-FINAL.
  1593     12  FILLER          PIC X(20)   VALUE '  FINAL       TOTALS'.
  1594
  1595*01  HEAD-9.
  1596*    12  FILLER          PIC X(127)  VALUE SPACES.
  1597*    12  H9-PAGE         PIC ZZZZ9.
  1598
  1599 01  DETAIL-LINE.
  1600     12  DL-YLF          PIC ZZ,ZZZ,ZZZ.99-.
  1601     12  DL-YAH          PIC ZZ,ZZZ,ZZZ.99-.
  1602     12  DL-YT           PIC ZZ,ZZZ,ZZZ.99-.
  1603     12  DL-YPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1604     12  FILLER          PIC X.
  1605     12  DL-DESC         PIC X(28).
  1606     12  DL-ILF          PIC ZZZ,ZZZ,ZZZ.99-.
  1607     12  DL-IAH          PIC ZZZ,ZZZ,ZZZ.99-.
  1608     12  DL-IT           PIC ZZZ,ZZZ,ZZZ.99-.
  1609     12  DL-IPT          PIC ZZZZ.99-    BLANK WHEN ZERO.
  1610
* 1611                                    COPY ELCDATE.
  1612******************************************************************06/11/98
  1613*                                                                *ELCDATE
  1614*                                                                *ELCDATE
  1615*                            ELCDATE.                            *   LV023
  1616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1617*                            VMOD=2.003                           ELCDATE
  1618*                                                                *ELCDATE
  1619*                                                                *ELCDATE
  1620*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1621*                 LENGTH = 200                                   *   CL*19
  1622******************************************************************ELCDATE
  1623                                                                  ELCDATE
  1624 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1625     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1626     12  DC-OPTION-CODE                PIC X.                        CL*15
  1627         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1628         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1629         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1630         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1631         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1632         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1633         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1634         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1635         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1636         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1637         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1638         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1639         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1640         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1641         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1642         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1643         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1644         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1645         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1646         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1647         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1648         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1649         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1650         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1651         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1652         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1653         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1654         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1655         88  THREE-CHARACTER-BIN                                  ELCDATE
  1656                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1657         88  GREGORIAN-TO-BIN                                        CL**2
  1658                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1659         88  BIN-TO-GREGORIAN                                        CL**2
  1660                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1661         88  JULIAN-TO-BINARY                                        CL**2
  1662                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1663     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1664         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1665         88  DATE-CONVERSION-ERROR                                ELCDATE
  1666                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1667         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1668         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1669         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1670         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1671         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1672         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1673         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1674         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1675         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1676         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1677     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1678         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1679     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1680         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1681         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1682         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1683     12  FILLER                        PIC X.                        CL*15
  1684     12  DC-CONVERSION-DATES.                                        CL*15
  1685         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1686         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1687         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1688         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1689                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1690             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1691             20  SLASH1-1              PIC X.                        CL*15
  1692             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1693             20  SLASH1-2              PIC X.                        CL*15
  1694             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1695         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1696         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1697                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1698             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1699             20  SLASH2-1              PIC X.                        CL*15
  1700             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1701             20  SLASH2-2              PIC X.                        CL*15
  1702             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1703         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1704         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1705                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1706             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1707             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1708             20  DC-YMD-DAY            PIC 99.                       CL*15
  1709         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1710         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1711                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1712             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1713             20  DC-MDY-DAY            PIC 99.                       CL*15
  1714             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1715         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1716             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1717             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1718             20  FILLER                PIC XX.                       CL*15
  1719             20  DC-ALPHA-CENTURY.                                   CL*15
  1720                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1721             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1722         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1723         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1724         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1725         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1726         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1727                                       PIC 9(05).                    CL*20
  1728         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1729             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1730             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1731         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1732         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1733         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1734     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1735         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1736         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1737             20  FILLER                PIC 9(3).                     CL*15
  1738             20  HOLD-CEN-1-CCYY.                                    CL*15
  1739                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1740                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1741             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1742             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1743         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1744             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1745             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1746             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1747                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1748                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1749             20  FILLER                PIC 9(3).                     CL*15
  1750         16  HOLD-CENTURY-1-X.                                       CL*15
  1751             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1752             20  HOLD-CEN-1-X-CCYY.                                  CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1753                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1754                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1755             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1756             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1757         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1758             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1759             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1760             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1761                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1762                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1763             20  FILLER                PIC XXX.                      CL*23
  1764         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1765         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1766         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1767         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1768             20  DC-JULIAN-1-CCYY.                                   CL*15
  1769                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1770                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1771             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1772         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1773         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1774             20  DC-JULIAN-2-CCYY.                                   CL*15
  1775                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1776                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1777             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1778         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1779             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1780             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1781             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1782             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1783             20  DC-EDITA-CCYY.                                      CL*15
  1784                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1785                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1786         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1787             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1788             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1789             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1790             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1791             20  DC-EDITB-CCYY.                                      CL*15
  1792                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1793                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1794         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1795         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1796                              DC-GREG-DATE-CYMD.                  ELCDATE
  1797             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1798             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1799             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1800             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1801         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1802         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1803                              DC-GREG-DATE-MDCY.                  ELCDATE
  1804             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1805             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1806             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1807             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1808    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1809        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1810    12  DC-EL310-DATE                  PIC X(21).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* DCC043RET.cbl
  1811    12  FILLER                         PIC X(28).                    CL*26
  1812
* 1813                                    COPY ELCDTECX.
  1814******************************************************************06/05/98
  1815*                                                                *ELCDTECX
  1816*                            ELCDTECX.                           *   LV005
  1817*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1818*                            VMOD=2.015                          *ELCDTECX
  1819*                                                                *ELCDTECX
  1820*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1821*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1822*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1823*                                                                *ELCDTECX
  1824******************************************************************ELCDTECX
  1825******************************************************************
  1826*                   C H A N G E   L O G
  1827*
  1828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1829*-----------------------------------------------------------------
  1830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1831* EFFECTIVE    NUMBER
  1832*-----------------------------------------------------------------
  1833* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1834*                                  BENEFIT CODES FROM 300 TO 900
  1835* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1836* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1837* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  1838******************************************************************
  1839 01  DATE-CARD.                                                   ELCDTECX
  1840     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1841     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1842     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1843     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1844     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1845     12  EP-SW                       PIC  X.                      ELCDTECX
  1846         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  1847     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1848         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1849     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1850     12  RUN-CENTURY.                                             ELCDTECX
  1851         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1852     12  FILLER                      PIC  X.                         CL**4
  1853     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1854     12  FILLER                      PIC  XXX.                    ELCDTECX
  1855     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1856                                                                  ELCDTECX
  1857 01  FILLER                          PIC  X(7)                       CL**6
  1858                                          VALUE 'OPTIONS'.        ELCDTECX
  1859 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1860     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1861     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1862     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1863         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1864         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1865     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1866     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1867     12  FILLER                      PIC  X.                      ELCDTECX
  1868     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1869     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1870     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1871     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1872     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1873     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1874     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1875     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1876     12  FILLER                      PIC  X.                      ELCDTECX
  1877     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1878     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1879     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1880     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1881     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1882     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1883     12  FILLER                      PIC  X.                      ELCDTECX
  1884     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1885     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1886     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1887     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1888     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1889     12  DTE-R78                     PIC  X.                      ELCDTECX
  1890     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1891     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1892     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1893     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1894     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1895     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1896     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1897                                     PIC  X.                      ELCDTECX
  1898         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1899                                                 ' '.             ELCDTECX
  1900         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1901         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1902     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1903         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1904         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  1905     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1906     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1907                                     PIC  9.                         CL**4
  1908     12  DTE-SYSTEM.                                              ELCDTECX
  1909         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1910         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1911         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1912         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1913         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1914         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1915         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1916         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1917         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1918         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1919         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1920         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1921         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1922         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1923         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1924         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1925         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1926         16  DTE-SYS-R               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1927         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1928         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1929         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1930         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1931         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1932         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1933         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1934         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1935     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1936         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1937                                     PIC  X.                      ELCDTECX
  1938     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1939                                                                  ELCDTECX
  1940 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1941     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1942     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1943     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1944*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1945     12  FILLER                      PIC  X.                      ELCDTECX
  1946     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1947     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1948     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1949     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1950     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1951     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1952     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1953                                                                  ELCDTECX
  1954     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1955     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1956     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1957     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1958                                                                  ELCDTECX
  1959     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1960     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1961     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1962     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  1963                                                                  ELCDTECX
  1964     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1965     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1966                                                                  ELCDTECX
  1967     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1968     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1969                                                                  ELCDTECX
  1970     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1971                                                                  ELCDTECX
  1972 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1973     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1974     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1975     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1976     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1977     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1978     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1979     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1980                                                                  ELCDTECX
  1981 01  FILLER                          PIC  X(12)                   ELCDTECX
  1982                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1983 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1984     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1985         16  CNT-ID                  PIC  X.                      ELCDTECX
  1986         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1987                                                                  ELCDTECX
  1988 01  FILLER                          PIC  X(11)                   ELCDTECX
  1989                                          VALUE 'STATE NAMES'.    ELCDTECX
  1990 01  STATE-NAMES.                                                 ELCDTECX
  1991     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1992         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1993         16  STATE-PIC1.                                          ELCDTECX
  1994             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1995             20  FILLER              PIC  XXX.                    ELCDTECX
  1996             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1997             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1998             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1999             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  2000                                                                  ELCDTECX
  2001 01  FILLER                          PIC  X(13)                   ELCDTECX
  2002                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  2003 01  CARRIER-NAMES.                                               ELCDTECX
  2004     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  2005         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  2006         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  2007         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  2008         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2009         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2010         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  2011*        16  FILLER                  PIC  X.                      ELCDTECX
  2012         16  CARRIER-SEC-PAY         PIC  X.
  2013             88  SEC-PAY-CARRIER          VALUE 'Y'.
  2014                                                                  ELCDTECX
  2015 01  FILLER                          PIC  X(9)                       CL**6
  2016                                          VALUE 'INS TYPES'.      ELCDTECX
  2017 01  CLAS-INS-TYPES.                                              ELCDTECX
  2018*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  2019     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  2020         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  2021         16  CLAS-I-AB3.                                          ELCDTECX
  2022             20  FILLER              PIC  X.                      ELCDTECX
  2023             20  CLAS-I-AB2.                                      ELCDTECX
  2024                 24  FILLER          PIC  X.                      ELCDTECX
  2025                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  2026         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  2027             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  2028             20  FILLER              PIC  X.                         CL**4
  2029         16  CLAS-I-AB10.                                         ELCDTECX
  2030             20  FILLER              PIC  X(9).                   ELCDTECX
  2031             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  2032         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  2033         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  2034         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  2035         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  2036             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  2037         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  2038         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  2039         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  2040         16  CLAS-I-BEN-CATEGORY     PIC  X.
  2041         16  CLAS-I-REFUND-METHOD    PIC  X.
  2042         16  CLAS-I-MAX-BENEFITS     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2043         16  FILLER                  PIC  XXX.
  2044                                                                  ELCDTECX
  2045 01  FILLER                          PIC  X(16)                   ELCDTECX
  2046                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  2047 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  2048     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  2049                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  2050         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  2051         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  2052         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  2053         16  CLAS-MORT-DESC.                                      ELCDTECX
  2054             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  2055             20  FILLER              PIC  XX.                        CL**5
  2056             20  CLAS-YEAR           PIC  X(4).                      CL**6
  2057             20  FILLER              PIC  X.                         CL**5
  2058             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  2059             20  FILLER              PIC  X.                         CL**5
  2060             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  2061             20  FILLER              PIC  X.                         CL**5
  2062             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  2063             20  FILLER              PIC  X(5).                      CL**6
  2064                                                                  ELCDTECX
  2065 01  FILLER                          PIC  X(15)                   ELCDTECX
  2066                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  2067 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  2068     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  2069         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  2070         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  2071         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  2072         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  2073         16  FILLER                  PIC  X(4).                      CL**6
  2074                                                                  ELCDTECX
  2075 01  FILLER                          PIC  X(7)                       CL**6
  2076                                     VALUE 'INDEXES'.             ELCDTECX
  2077 01  CLAS-INDEX-TBL.                                              ELCDTECX
  2078     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  2079     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  2080     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  2081     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  2082     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  2083     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  2084     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  2085     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  2086     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  2087     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  2088     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  2089     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  2090     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  2091     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  2092     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  2093     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  2094     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  2095                                                                  ELCDTECX
  2096 01  CLAS-TYPE-MISC.                                              ELCDTECX
  2097     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  2098     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  2099     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  2100     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2101     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  2102     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  2103     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  2104     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  2105     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  2106     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  2107     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  2108                                                                  ELCDTECX
  2109 01  FILLER                          PIC  X(13)                   ELCDTECX
  2110                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  2111 01  CLAS-MISC.                                                   ELCDTECX
  2112     12  DTE-FICH                    PIC  X.                      ELCDTECX
  2113         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  2114         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  2115         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  2116     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  2117     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  2118     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  2119     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  2120     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  2121     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  2122     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  2123     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  2124     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  2125     12  STATE-L                     PIC  XX.                     ELCDTECX
  2126     12  CLAS-CN                     PIC  99.                     ELCDTECX
  2127     12  CLAS-CO                     PIC  99.                     ELCDTECX
  2128     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  2129         16  DTE-F-1                 PIC  X.                      ELCDTECX
  2130         16  DTE-F-2                 PIC  X.                      ELCDTECX
  2131     12  DTE-ABEND-WORK.                                          ELCDTECX
  2132         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  2133         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  2134                                                                  ELCDTECX
  2135 01  FILLER                          PIC  X(12)                   ELCDTECX
  2136                                     VALUE 'WORKING DATE'.        ELCDTECX
  2137 01  WS-DATE-AND-TIME.                                            ELCDTECX
  2138     12  WS-ACCEPT-DATE.                                          ELCDTECX
  2139         16  WS-AD-YY                PIC  99.                     ELCDTECX
  2140         16  WS-AD-MM                PIC  99.                     ELCDTECX
  2141         16  WS-AD-DD                PIC  99.                     ELCDTECX
  2142     12  WS-CURRENT-DATE.                                         ELCDTECX
  2143         16  WS-CD-MM                PIC  99.                     ELCDTECX
  2144         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2145         16  WS-CD-DD                PIC  99.                     ELCDTECX
  2146         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  2147         16  WS-CD-YY                PIC  99.                     ELCDTECX
  2148     12  WS-TIME-OF-DAY.                                          ELCDTECX
  2149         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  2150         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  2151                                                                  ELCDTECX
  2152 01  FILLER                          PIC  X(12)                   ELCDTECX
  2153                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  2154 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  2155     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  2156         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  2157         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  2158         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2159                                                                  ELCDTECX
  2160 01  FILLER                          PIC  X(10)                   ELCDTECX
  2161                                     VALUE 'STATE TLRS'.          ELCDTECX
  2162 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  2163     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  2164         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  2165         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  2166                                                                  ELCDTECX
  2167 01  FILLER                          PIC  X(13)                   ELCDTECX
  2168                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  2169 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  2170     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  2171         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  2172                                                                  ELCDTECX
  2173 01  FILLER                          PIC  X(13)                   ELCDTECX
  2174                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  2175 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  2176     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  2177     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  2178     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  2179                                     PIC  X.                         CL**5
  2180     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  2181     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  2182     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  2183     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  2184     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  2185     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  2186     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  2187     12  FILLER                      PIC  X(75).                  ELCDTECX
  2188******************************************************************ELCDTECX
  2189*01  MISC-CARR-PCT-DATA.                                          00001521
  2190*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2191*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2192*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2193*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  2194*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  2195*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  2196******************************************************************ELCDTECX
  2197
* 2198                                    COPY ELCDTEVR.
  2199***************************************************************** 04/15/98
  2200*                                                                *ELCDTEVR
  2201*                                                                *ELCDTEVR
  2202*                            ELCDTEVR.                           *   LV003
  2203*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2204*                            VMOD=2.001                          *   CL**2
  2205*                                                                *ELCDTEVR
  2206*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  2207*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  2208*                                                                *ELCDTEVR
  2209******************************************************************ELCDTEVR
  2210 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  2211     05  WS-RUN-DATE.                                             ELCDTEVR
  2212         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2213         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  2214         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  2215             15  RUN-CC              PIC  99.                     ELCDTEVR
  2216             15  RUN-YR              PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2217         10  RUN-MO                  PIC  99.                     ELCDTEVR
  2218         10  RUN-DA                  PIC  99.                     ELCDTEVR
  2219     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  2220            WS-RUN-DATE              PIC 9(11).                      CL**2
  2221     05  WS-EP-DT.                                                ELCDTEVR
  2222         10  FILLER                  PIC  9(03).                  ELCDTEVR
  2223         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  2224         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  2225             15  EP-CC               PIC  99.                     ELCDTEVR
  2226             15  EP-YR               PIC  99.                     ELCDTEVR
  2227         10  EP-MO                   PIC  99.                     ELCDTEVR
  2228         10  EP-DA                   PIC  99.                     ELCDTEVR
  2229     05  WS-EP-DT-N REDEFINES                                        CL**2
  2230            WS-EP-DT                 PIC 9(11).                      CL**2
  2231     05  WS-DTE-CONV-DT.                                             CL**4
  2232         10  FILLER                  PIC  9(03).                     CL**4
  2233         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  2234         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  2235             15  DTE-CONV-CC         PIC  99.                        CL**4
  2236             15  DTE-CONV-YR         PIC  99.                        CL**4
  2237         10  DTE-CONV-MO             PIC  99.                        CL**4
  2238         10  DTE-CONV-DA             PIC  99.                        CL**4
  2239     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  2240            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  2241 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  2242     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  2243         10  FILLER                            PIC 999.           ELCDTEVR
  2244         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  2245         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  2246             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  2247             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  2248         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  2249         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  2250     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  2251            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  2252     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  2253         10  FILLER                            PIC 999.           ELCDTEVR
  2254         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  2255         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  2256         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  2257         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  2258     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  2259            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  2260 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  2261     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  2262         10  FILLER                            PIC 999.           ELCDTEVR
  2263         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  2264         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  2265             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  2266             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  2267         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  2268         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  2269     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  2270            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  2271     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  2272         10  FILLER                            PIC 999.           ELCDTEVR
  2273         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  2274         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  2275             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  2276             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  2277         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  2278         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  2279     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  2280            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  2281     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  2282         10  FILLER                            PIC 999.           ELCDTEVR
  2283         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  2284         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  2285             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  2286             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  2287         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  2288         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  2289     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  2290            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  2291 01  WS-RATE-RECORD.                                              ELCDTEVR
  2292         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  2293             10  FILLER                        PIC 999.           ELCDTEVR
  2294             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  2295             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  2296                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  2297                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  2298             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  2299             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  2300         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  2301                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  2302
* 2303                                    COPY ELCACCTV.
  2304******************************************************************04/14/98
  2305*                                                                *ELCACCTV
  2306*                            ELCACCTV                            *   LV002
  2307*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2308*                            VMOD=2.001                          *ELCACCTV
  2309*                                                                *ELCACCTV
  2310*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCACCTV
  2311*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTV
  2312*                                                                *ELCACCTV
  2313*  NO  CID  MODS  IN  COPYBOOK  ELCACCTV                         *ELCACCTV
  2314*                                                                *ELCACCTV
  2315******************************************************************ELCACCTV
  2316                                                                  ELCACCTV
  2317 01  WS-ACCOUNT-MASTER-DATE.                                      ELCACCTV
  2318                                                                  ELCACCTV
  2319     05  WS-AM-EXPIRE-DT.                                         ELCACCTV
  2320         10  FILLER            PIC 999.                           ELCACCTV
  2321         10  AM-EXP-CCYY       PIC 9(04).                         ELCACCTV
  2322         10  AM-EXP-CCYR  REDEFINES  AM-EXP-CCYY.                 ELCACCTV
  2323             15  AM-EXP-CC     PIC 99.                            ELCACCTV
  2324             15  AM-EXP-YR     PIC 99.                            ELCACCTV
  2325         10  AM-EXP-MO         PIC 99.                               CL**5
  2326         10  AM-EXP-DA         PIC 99.                               CL**5
  2327     05  WS-AM-EXPIRE-DT-N REDEFINES                                 CL**3
  2328            WS-AM-EXPIRE-DT    PIC 9(11).                            CL**4
  2329     05  WS-AM-VG-EXP-DATE.                                       ELCACCTV
  2330         10  FILLER                    PIC 999.                   ELCACCTV
  2331         10  AM-VG-EXP-CCYY            PIC 9(04).                 ELCACCTV
  2332         10  AM-VG-EXP-CCYR  REDEFINES  AM-VG-EXP-CCYY.           ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2333             15  AM-VG-EXP-CC          PIC 99.                    ELCACCTV
  2334             15  AM-VG-EXP-YR          PIC 99.                    ELCACCTV
  2335         10  AM-VG-EXP-MO              PIC 99.                    ELCACCTV
  2336         10  AM-VG-EXP-DA              PIC 99.                    ELCACCTV
  2337     05  WS-AM-VG-EXP-DATE-N REDEFINES                               CL**3
  2338            WS-AM-VG-EXP-DATE          PIC 9(11).                    CL**4
  2339     05  WS-AM-EFFECT-DT.                                         ELCACCTV
  2340         10  FILLER                    PIC 999.                   ELCACCTV
  2341         10  AM-EFF-CCYY               PIC 9(04).                 ELCACCTV
  2342         10  AM-EFF-CCYR  REDEFINES  AM-EFF-CCYY.                 ELCACCTV
  2343             15  AM-EFF-CC             PIC 99.                    ELCACCTV
  2344             15  AM-EFF-YR             PIC 99.                    ELCACCTV
  2345         10  AM-EFF-MO                 PIC 99.                    ELCACCTV
  2346         10  AM-EFF-DA                 PIC 99.                    ELCACCTV
  2347     05  WS-AM-EFFECT-DT-N REDEFINES                                 CL**3
  2348            WS-AM-EFFECT-DT            PIC 9(11).                    CL**4
  2349     05  WS-AM-PREV-EXP-DT.                                       ELCACCTV
  2350         10 FILLER                     PIC 999.                   ELCACCTV
  2351         10 AM-PREV-EXP-DT-CCYY        PIC 9(04).                 ELCACCTV
  2352         10 AM-PREV-EXP-DT-CCYR  REDEFINES  AM-PREV-EXP-DT-CCYY.  ELCACCTV
  2353            15 AM-PREV-EXP-DT-CC       PIC 99.                    ELCACCTV
  2354            15 AM-PREV-EXP-DT-YR       PIC 99.                    ELCACCTV
  2355         10 AM-PREV-EXP-MO             PIC 99.                    ELCACCTV
  2356         10 AM-PREV-EXP-DA             PIC 99.                    ELCACCTV
  2357     05  WS-AM-PREV-EXP-DT-N REDEFINES                               CL**3
  2358            WS-AM-PREV-EXP-DT          PIC 9(11).                    CL**3
  2359     05  WS-AM-PREV-EFF-DT.                                       ELCACCTV
  2360         10 FILLER                     PIC 999.                   ELCACCTV
  2361         10 AM-PREV-EFF-CCYY           PIC 9(04).                 ELCACCTV
  2362         10 AM-PREV-EFF-CCYR  REDEFINES  AM-PREV-EFF-CCYY.        ELCACCTV
  2363            15 AM-PREV-EFF-CC          PIC 99.                    ELCACCTV
  2364            15 AM-PREV-EFF-YR          PIC 99.                    ELCACCTV
  2365         10 AM-PREV-EFF-MO             PIC 99.                    ELCACCTV
  2366         10 AM-PREV-EFF-DA             PIC 99.                    ELCACCTV
  2367     05  WS-AM-PREV-EFF-DT-N REDEFINES                               CL**3
  2368            WS-AM-PREV-EFF-DT          PIC 9(11).                    CL**3
  2369     05  WS-AM-ANNIVERSARY-DATE.                                  ELCACCTV
  2370         10  FILLER                    PIC 999.                   ELCACCTV
  2371         10  AM-AN-CCYY                PIC 9(04).                 ELCACCTV
  2372         10  AM-AN-CCYR  REDEFINES  AM-AN-CCYY.                   ELCACCTV
  2373             15  AM-AN-CC              PIC 99.                    ELCACCTV
  2374             15  AM-AN-YR              PIC 99.                    ELCACCTV
  2375         10  AM-AN-MO                  PIC 99.                    ELCACCTV
  2376         10  AM-AN-DA                  PIC 99.                    ELCACCTV
  2377     05  WS-AM-ANNIVERSARY-DATE-N REDEFINES                          CL**3
  2378            WS-AM-ANNIVERSARY-DATE     PIC 9(11).                    CL**4
  2379     05  WS-AM-HI-CERT-DATE.                                      ELCACCTV
  2380         10  FILLER                    PIC 999.                   ELCACCTV
  2381         10  AM-HI-CCYY                PIC 9(04).                 ELCACCTV
  2382         10  AM-HI-CCYR  REDEFINES  AM-HI-CCYY.                   ELCACCTV
  2383             15  AM-HI-CC              PIC 99.                    ELCACCTV
  2384             15  AM-HI-YR              PIC 99.                    ELCACCTV
  2385         10  AM-HI-MO                  PIC 99.                    ELCACCTV
  2386         10  AM-HI-DA                  PIC 99.                    ELCACCTV
  2387     05  WS-AM-HI-CERT-DATE-N REDEFINES                              CL**3
  2388            WS-AM-HI-CERT-DATE         PIC 9(11).                    CL**3
  2389     05  WS-AM-LO-CERT-DATE.                                      ELCACCTV
  2390         10  FILLER                    PIC 999.                   ELCACCTV
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCACCTV)
  2391         10  AM-LO-CCYY                PIC 9(04).                 ELCACCTV
  2392         10  AM-LO-CCYR  REDEFINES  AM-LO-CCYY.                   ELCACCTV
  2393             15  AM-LO-CC              PIC 99.                    ELCACCTV
  2394             15  AM-LO-YR              PIC 99.                    ELCACCTV
  2395         10  AM-LO-MO                  PIC 99.                    ELCACCTV
  2396         10  AM-LO-DA                  PIC 99.                    ELCACCTV
  2397     05  WS-AM-LO-CERT-DATE-N REDEFINES                              CL**3
  2398            WS-AM-LO-CERT-DATE         PIC 9(11).                    CL**3
  2399     05  WS-AM-ENTRY-DATE.                                        ELCACCTV
  2400         10  FILLER                    PIC 999.                   ELCACCTV
  2401         10  AM-ENT-CCYY               PIC 9(04).                 ELCACCTV
  2402         10  AM-ENT-CCYR  REDEFINES  AM-ENT-CCYY.                 ELCACCTV
  2403             15  AM-ENT-CC             PIC 99.                    ELCACCTV
  2404             15  AM-ENT-YR             PIC 99.                    ELCACCTV
  2405         10  AM-ENT-MO                 PIC 99.                    ELCACCTV
  2406         10  AM-ENT-DA                 PIC 99.                    ELCACCTV
  2407     05  WS-AM-ENTRY-DATE-N REDEFINES                                CL**3
  2408            WS-AM-ENTRY-DATE           PIC 9(11).                    CL**3
  2409
* 2410                                    COPY ELCEPCVR.
  2411******************************************************************05/15/98
  2412*                                                                *ELCEPCVR
  2413*                                                                *ELCEPCVR
  2414*                            ELCEPCVR                            *   LV003
  2415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2416*                            VMOD=2.001                          *ELCEPCVR
  2417*                                                                *ELCEPCVR
  2418*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCEPCVR
  2419*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCVR
  2420*                                                                *ELCEPCVR
  2421******************************************************************ELCEPCVR
  2422 01  WS-EP-RECORD-DATE.                                           ELCEPCVR
  2423     05  WS-EP-EXP-DTE.                                           ELCEPCVR
  2424         10  FILLER            PIC 999.                           ELCEPCVR
  2425         10  EP-EXP-CCYY       PIC 9(04).                         ELCEPCVR
  2426         10  EP-EXP-CCYR  REDEFINES  EP-EXP-CCYY.                 ELCEPCVR
  2427             15  EP-EXP-CC     PIC 99.                            ELCEPCVR
  2428             15  EP-EXP-YR     PIC 99.                            ELCEPCVR
  2429         10  EP-EXP-MO         PIC 99.                            ELCEPCVR
  2430         10  EP-EXP-DA         PIC 99.                            ELCEPCVR
  2431     05  WS-EP-EXP-DTE-N REDEFINES                                   CL**3
  2432            WS-EP-EXP-DTE      PIC 9(11).                            CL**3
  2433     05  WS-EC-EXP-DTE REDEFINES WS-EP-EXP-DTE.                      CL**5
  2434         10  FILLER            PIC 999.                              CL**5
  2435         10  EC-EXP-CCYY       PIC 9(04).                            CL**5
  2436         10  EC-EXP-CCYR  REDEFINES  EC-EXP-CCYY.                    CL**5
  2437             15  EC-EXP-CC     PIC 99.                               CL**5
  2438             15  EC-EXP-YR     PIC 99.                               CL**5
  2439         10  EC-EXP-MO         PIC 99.                               CL**5
  2440         10  EC-EXP-DA         PIC 99.                               CL**5
  2441     05  WS-EC-EXP-DTE-N REDEFINES                                   CL**5
  2442            WS-EC-EXP-DTE      PIC 9(11).                            CL**5
  2443     05  WS-EP-EFF-DTE.                                           ELCEPCVR
  2444         10  FILLER            PIC 999.                           ELCEPCVR
  2445         10  EP-EFF-CCYY       PIC 9(04).                         ELCEPCVR
  2446         10  EP-EFF-CCYR  REDEFINES  EP-EFF-CCYY.                 ELCEPCVR
  2447             15  EP-EFF-CC     PIC 99.                            ELCEPCVR
  2448             15  EP-EFF-YR     PIC 99.                            ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2449         10  EP-EFF-MO         PIC 99.                            ELCEPCVR
  2450         10  EP-EFF-DA         PIC 99.                            ELCEPCVR
  2451     05  WS-EP-EFF-DTE-N REDEFINES                                   CL**3
  2452            WS-EP-EFF-DTE      PIC 9(11).                            CL**3
  2453     05  WS-EC-EFF-DTE REDEFINES WS-EP-EFF-DTE.                      CL**5
  2454         10  FILLER            PIC 999.                              CL**5
  2455         10  EC-EFF-CCYY       PIC 9(04).                            CL**5
  2456         10  EC-EFF-CCYR  REDEFINES  EC-EFF-CCYY.                    CL**5
  2457             15  EC-EFF-CC     PIC 99.                               CL**5
  2458             15  EC-EFF-YR     PIC 99.                               CL**5
  2459         10  EC-EFF-MO         PIC 99.                               CL**5
  2460         10  EC-EFF-DA         PIC 99.                               CL**5
  2461     05  WS-EC-EFF-DTE-N REDEFINES                                   CL**5
  2462            WS-EC-EFF-DTE      PIC 9(11).                            CL**5
  2463     05  WS-EP-HI-COV-DT.                                         ELCEPCVR
  2464         10  FILLER            PIC 999.                           ELCEPCVR
  2465         10  EP-COV-CCYY       PIC 9(04).                         ELCEPCVR
  2466         10  EP-COV-CCYR  REDEFINES  EP-COV-CCYY.                 ELCEPCVR
  2467             15  EP-COV-CC     PIC 99.                            ELCEPCVR
  2468             15  EP-COV-YR     PIC 99.                            ELCEPCVR
  2469         10  EP-COV-MO         PIC 99.                            ELCEPCVR
  2470         10  EP-COV-DA         PIC 99.                            ELCEPCVR
  2471     05  WS-EP-HI-COV-DT-N REDEFINES                                 CL**3
  2472            WS-EP-HI-COV-DT    PIC 9(11).                            CL**3
  2473     05  WS-EP-HI-CERT.                                           ELCEPCVR
  2474         10  FILLER            PIC 999.                           ELCEPCVR
  2475         10  EP-HI-CCYY        PIC 9(04).                         ELCEPCVR
  2476         10  EP-HI-CCYR  REDEFINES  EP-HI-CCYY.                   ELCEPCVR
  2477             15  EP-HI-CC      PIC 99.                            ELCEPCVR
  2478             15  EP-HI-YR      PIC 99.                            ELCEPCVR
  2479         10  EP-HI-MO          PIC 99.                            ELCEPCVR
  2480         10  EP-HI-DA          PIC 99.                            ELCEPCVR
  2481     05  WS-EP-HI-CERT-N REDEFINES                                   CL**3
  2482            WS-EP-HI-CERT      PIC 9(11).                            CL**3
  2483     05  WS-EP-LO-CERT.                                           ELCEPCVR
  2484         10  FILLER            PIC 999.                           ELCEPCVR
  2485         10  EP-LO-CCYY        PIC 9(04).                         ELCEPCVR
  2486         10  EP-LO-CCYR  REDEFINES   EP-LO-CCYY.                  ELCEPCVR
  2487             15  EP-LO-CC      PIC 99.                            ELCEPCVR
  2488             15  EP-LO-YR      PIC 99.                            ELCEPCVR
  2489         10  EP-LO-MO          PIC 99.                            ELCEPCVR
  2490         10  EP-LO-DA          PIC 99.                            ELCEPCVR
  2491     05  WS-EP-LO-CERT-N REDEFINES                                   CL**3
  2492            WS-EP-LO-CERT      PIC 9(11).                            CL**3
  2493     05  WS-EP-RUN-DTE.                                           ELCEPCVR
  2494         10  FILLER            PIC 999.                           ELCEPCVR
  2495         10  EP-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2496         10  EP-RUN-CCYR  REDEFINES  EP-RUN-CCYY.                 ELCEPCVR
  2497             15  EP-RUN-CC     PIC 99.                            ELCEPCVR
  2498             15  EP-RUN-YR     PIC 99.                            ELCEPCVR
  2499         10  EP-RUN-MO         PIC 99.                            ELCEPCVR
  2500         10  EP-RUN-DA         PIC 99.                            ELCEPCVR
  2501     05  WS-EP-RUN-DTE-N REDEFINES                                   CL**3
  2502            WS-EP-RUN-DTE      PIC 9(11).                            CL**3
  2503     05  WS-EC-RUN-DTE REDEFINES WS-EP-RUN-DTE.                      CL**5
  2504         10  FILLER            PIC 999.                           ELCEPCVR
  2505         10  EC-RUN-CCYY       PIC 9(04).                         ELCEPCVR
  2506         10  EC-RUN-CCYR  REDEFINES  EC-RUN-CCYY.                 ELCEPCVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* DCC043RET.cbl (/apps/prod/cid1p/copy/ELCEPCVR)
  2507             15  EC-RUN-CC     PIC 99.                            ELCEPCVR
  2508             15  EC-RUN-YR     PIC 99.                            ELCEPCVR
  2509         10  EC-RUN-MO         PIC 99.                            ELCEPCVR
  2510         10  EC-RUN-DA         PIC 99.                            ELCEPCVR
  2511     05  WS-EC-RUN-DTE-N REDEFINES                                   CL**3
  2512            WS-EC-RUN-DTE      PIC 9(11).                            CL**3
  2513
  2514
  2515 01  DATA-OUT-RECORD.
  2516     05  DO-ME-DATE.
  2517         10  DO-ME-MO         PIC 9(2).
  2518         10  FILLER           PIC X(1)  VALUE '/'.
  2519         10  DO-ME-DD         PIC 9(2).
  2520         10  FILLER           PIC X(1)  VALUE '/'.
  2521         10  DO-ME-YR         PIC 9(4).
  2522     05  DO-CARRIER           PIC X(1).
  2523     05  DO-COMP              PIC X(6).
  2524     05  DO-STATE             PIC X(2).
  2525     05  DO-ACCOUNT-NUM       PIC X(10).
  2526     05  DO-GROUP             PIC X(10).
  2527     05  DO-EXP-DATE.
  2528         10  DO-EXP-MO        PIC 9(2).
  2529         10  FILLER           PIC X(1)  VALUE '/'.
  2530         10  DO-EXP-DD        PIC 9(2).
  2531         10  FILLER           PIC X(1)  VALUE '/'.
  2532         10  DO-EXP-YR        PIC 9(4).
  2533     05  DO-EFF-DATE.
  2534         10  DO-EFF-MO        PIC 9(2).
  2535         10  FILLER           PIC X(1)  VALUE '/'.
  2536         10  DO-EFF-DD        PIC 9(2).
  2537         10  FILLER           PIC X(1)  VALUE '/'.
  2538         10  DO-EFF-YR        PIC 9(4).
  2539     05  DO-ACCOUNT-NAME      PIC X(30).
  2540     05  DO-PERIOD            PIC X(3).
  2541     05  DO-ACCUMULATORS OCCURS 12 TIMES.
  2542         10  DO-DESCR         PIC X(28).
  2543         10  DO-PERLFP        PIC -(11).99.
  2544         10  DO-PERLFE        PIC -(11).99.
  2545         10  DO-ITDLFP        PIC -(11).99.
  2546         10  DO-ITDLFE        PIC -(11).99.
  2547         10  DO-PERAHP        PIC -(11).99.
  2548         10  DO-PERAHE        PIC -(11).99.
  2549         10  DO-ITDAHP        PIC -(11).99.
  2550         10  DO-ITDAHE        PIC -(11).99.
  2551     05  DO-PREM-P-E          PIC X(1).
  2552     05  DO-CLAIM-P-I         PIC X(1).
  2553     05  DO-RETRO-Y-N         PIC X(1).
  2554     05  DO-RETRO-P-E         PIC X(1).
  2555     05  DO-TAX-P-E           PIC X(1).
  2556     05  DO-PER-LF-RETRO-PMT  PIC -(11).99.
  2557     05  DO-ITD-LF-RETRO-PMT  PIC -(11).99.
  2558     05  DO-PER-AH-RETRO-PMT  PIC -(11).99.
  2559     05  DO-ITD-AH-RETRO-PMT  PIC -(11).99.
  2560
  2561 01  DATA-OUT-SELECTIONS.
  2562     05  DO-SUBSCRIPTS.
  2563         10 DO-SUB-1        PIC X(3) VALUE '001'.
  2564         10 DO-SUB-2        PIC X(3) VALUE '002'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* DCC043RET.cbl
  2565         10 DO-SUB-3        PIC X(3) VALUE '003'.
  2566         10 DO-SUB-4        PIC X(3) VALUE '004'.
  2567         10 DO-SUB-5        PIC X(3) VALUE '005'.
  2568         10 DO-SUB-6        PIC X(3) VALUE '000'.
  2569         10 DO-SUB-7        PIC X(3) VALUE '000'.
  2570         10 DO-SUB-8        PIC X(3) VALUE '006'.
  2571         10 DO-SUB-9        PIC X(3) VALUE '007'.
  2572         10 DO-SUB-10       PIC X(3) VALUE '008'.
  2573         10 DO-SUB-11       PIC X(3) VALUE '009'.
  2574         10 DO-SUB-12       PIC X(3) VALUE '000'.
  2575         10 DO-SUB-13       PIC X(3) VALUE '010'.
  2576         10 DO-SUB-14       PIC X(3) VALUE '011'.
  2577         10 DO-SUB-15       PIC X(3) VALUE '000'.
  2578         10 DO-SUB-16       PIC X(3) VALUE '012'.
  2579         10 DO-SUB-17       PIC X(3) VALUE '000'.
  2580         10 DO-SUB-18       PIC X(3) VALUE '013'.
  2581         10 DO-SUB-19       PIC X(3) VALUE '014'.
  2582         10 DO-SUB-20       PIC X(3) VALUE '015'.
  2583         10 DO-SUB-21       PIC X(3) VALUE '000'.
  2584         10 DO-SUB-22       PIC X(3) VALUE '000'.
  2585         10 DO-SUB-23       PIC X(3) VALUE '016'.
  2586         10 DO-SUB-24       PIC X(3) VALUE '000'.
  2587         10 DO-SUB-25       PIC X(3) VALUE '017'.
  2588         10 DO-SUB-26       PIC X(3) VALUE '000'.
  2589         10 DO-SUB-27       PIC X(3) VALUE '000'.
  2590         10 DO-SUB-28       PIC X(3) VALUE '018'.
  2591     05  DO-SELECT-SUBSCRIPT REDEFINES DO-SUBSCRIPTS
  2592             OCCURS 28 TIMES.
  2593         10 DO-OUT-SUBSCRIPT        PIC 9(3).
  2594
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* DCC043RET.cbl
  2596 PROCEDURE DIVISION.
  2597 0100-READ-DATE-CARD.
* 2598                             COPY ELCDTERX SUPPRESS.
  2914
  2915     MOVE LIFE-OVERRIDE-L12     TO HEAD-7-PLUG-1
  2916                                   HEAD-7-PLUG-3.
  2917     MOVE AH-OVERRIDE-L12       TO HEAD-7-PLUG-2
  2918                                   HEAD-7-PLUG-4.
  2919     MOVE WS-CURRENT-DATE TO HD-RD.
  2920     MOVE ALPH-DATE       TO HD-AD.
  2921     MOVE COMPANY-NAME    TO HD-COMP.
  2922
  2923     MOVE LOW-VALUES      TO END-CHARACTER.
  2924
  2925     MOVE RUN-DATE        TO RUN-DT
  2926                             BEG-DATE.
  2927
  2928     OPEN INPUT CONTROL-CARD.
  2929
  2930     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2931          AT END   MOVE '1' TO FC-CODE
  2932                   GO TO 0130-BUILD-SELECT-DATES.
  2933
  2934 0110-READ-CARD-LOOP.
  2935     IF FC-ID = 'RF'
  2936         IF FC-CLIENT = DTE-CLIENT
  2937             GO TO 0120-FLUSH-REMAINING-CARDS.
  2938
  2939     READ CONTROL-CARD INTO FORMAT-CONTROL-CARD
  2940          AT END   MOVE '1' TO FC-CODE
  2941                   GO TO 0130-BUILD-SELECT-DATES.
  2942
  2943     GO TO 0110-READ-CARD-LOOP.
  2944
  2945 0120-FLUSH-REMAINING-CARDS.
  2946     READ CONTROL-CARD
  2947            AT END GO TO 0130-BUILD-SELECT-DATES.
  2948
  2949     GO TO 0120-FLUSH-REMAINING-CARDS.
  2950
  2951 0130-BUILD-SELECT-DATES.
  2952     IF DTE-PGM-OPT = '5' OR '7'
  2953        MOVE 'RF'       TO FC-ID
  2954        MOVE DTE-CLIENT TO FC-CLIENT
  2955        MOVE '5'        TO FC-CODE
  2956        MOVE RUN-DATE   TO FC-DATE.
  2957
  2958     IF FC-CODE = ' '
  2959       IF FC-DATE NOT NUMERIC  OR
  2960          FC-DATE = ZEROS
  2961          MOVE 'INVALID BEGIN DATE  ' TO WS-ABEND-MESSAGE
  2962          GO TO ABEND-PGM.
  2963
  2964     IF FC-CODE = ' '
  2965         MOVE FC-DATE   TO BEG-DATE
  2966         MOVE FC-MM     TO W-MM
  2967         MOVE FC-DD     TO W-DD
  2968         MOVE FC-CCYY   TO W-CCYY
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* DCC043RET.cbl
  2969         MOVE WORK-MSG  TO H6-YTD-HD
  2970         GO TO 0140-SORT-CONTROL.
  2971
  2972     IF DTE-PGM-OPT = '5'
  2973         MOVE FC-DATE   TO BEG-DATE.
  2974
  2975     IF FC-CODE = ('1' OR '5')
  2976         SUBTRACT 1 FROM BD-CCYY
  2977         IF FC-CODE = '1'
  2978              MOVE 31   TO BD-DA
  2979              MOVE 12   TO BD-MO
  2980              MOVE '*   YEAR TO DATE   *' TO H6-YTD-HD
  2981              GO TO 0140-SORT-CONTROL
  2982         ELSE
  2983              MOVE '*  LAST 12 MONTHS  *' TO H6-YTD-HD
  2984              MOVE BEG-DATE TO SAVE-BEG-DATE
  2985              GO TO 0140-SORT-CONTROL.
  2986
  2987     IF FC-CODE = '2'
  2988         MOVE '* QUARTER TO DATE  *' TO H6-YTD-HD
  2989         IF RD-MO LESS 3
  2990             MOVE 12    TO BD-MO
  2991             MOVE 31    TO BD-DA
  2992             SUBTRACT 1 FROM BD-CCYY
  2993             GO TO 0140-SORT-CONTROL
  2994         ELSE
  2995             IF RD-MO LESS 6
  2996                 MOVE 03 TO BD-MO
  2997                 MOVE 31 TO BD-DA
  2998                 GO TO 0140-SORT-CONTROL
  2999             ELSE
  3000                 IF BD-MO LESS 9
  3001                     MOVE 06 TO BD-MO
  3002                     MOVE 30 TO BD-DA
  3003                     GO TO 0140-SORT-CONTROL
  3004                 ELSE
  3005                     MOVE 09 TO BD-MO
  3006                     MOVE 30 TO BD-DA
  3007                     GO TO 0140-SORT-CONTROL.
  3008
  3009     MOVE BIN-RUN-DATE          TO DC-BIN-DATE-1.
  3010     MOVE '6'                   TO DC-OPTION-CODE.
  3011
  3012     EVALUATE FC-CODE
  3013        WHEN '3'
  3014           MOVE '*   LAST 3 MONTHS  *' TO H6-YTD-HD
  3015           MOVE  -3 TO DC-ELAPSED-MONTHS
  3016        WHEN '4'
  3017           MOVE '*   LAST 6 MONTHS  *' TO H6-YTD-HD
  3018           MOVE  -6 TO DC-ELAPSED-MONTHS
  3019        WHEN '6'
  3020           MOVE '*    LAST MONTH    *' TO H6-YTD-HD
  3021           MOVE  -1 TO DC-ELAPSED-MONTHS
  3022     END-EVALUATE.
  3023
  3024     MOVE ZEROS                 TO DC-ELAPSED-DAYS.
  3025     MOVE '1'                   TO DC-END-OF-MONTH.
  3026     PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* DCC043RET.cbl
  3027     MOVE DC-GREG-DATE-CYMD     TO BEG-DATE.
  3028
  3029
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* DCC043RET.cbl
  3031 0140-SORT-CONTROL.
  3032     SORT SORT-WORK ON
  3033         ASCENDING  SW-RPT-TYPE-ID-OUT
  3034                    SW-CTL-OUT
  3035         INPUT PROCEDURE 0150-BUILD-EXTRACTS
  3036         OUTPUT PROCEDURE
  3037             0745-OUTPUT-PROCEDURE THRU 1090-CLOSE-EXIT.
  3038
  3039     IF SORT-RETURN NOT = ZERO AND 4
  3040          MOVE SORT-RETURN            TO WS-RETURN-CODE
  3041          MOVE 'UNSUCCESSFUL SORT RC' TO WS-ABEND-MESSAGE
  3042          GO TO ABEND-PGM.
  3043
  3044     GOBACK.
  3045
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* DCC043RET.cbl
  3047 0150-BUILD-EXTRACTS SECTION.
  3048
  3049 0160-BEGIN-PROCESSING.
  3050     OPEN INPUT
  3051             ACC-MSTR
  3052             ERPLAN-IN
  3053             EPEC-FILE
  3054         OUTPUT
  3055             DATA-OUT
  3056             PRNTR.
  3057
  3058     IF ERACCTT-FILE-STATUS  = '00' OR '97'
  3059         NEXT SENTENCE
  3060       ELSE
  3061         MOVE '11'                TO W-ABEND-CODE-1
  3062         MOVE ERACCTT-FILE-STATUS TO W-ABEND-CODE-2
  3063         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3064         MOVE 'OPEN ERROR - ERACCTT' TO WS-ABEND-MESSAGE
  3065         GO TO ABEND-PGM.
  3066
  3067     IF ERPLAN-FILE-STATUS  = '00' OR '97'
  3068         NEXT SENTENCE
  3069       ELSE
  3070         MOVE '12'                TO W-ABEND-CODE-1
  3071         MOVE ERPLAN-FILE-STATUS  TO W-ABEND-CODE-2
  3072         MOVE WS-ABEND-CODE       TO WS-RETURN-CODE
  3073         MOVE 'OPEN ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3074         GO TO ABEND-PGM.
  3075
  3076     PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT.
  3077
  3078     PERFORM 0550-ZERO-DA  VARYING SA FROM 1 BY 1
  3079                           UNTIL SA GREATER 4.
  3080     PERFORM 0560-ZERO-PA  VARYING SB FROM 1 BY 1
  3081                           UNTIL SB GREATER 36.
  3082     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3083                           UNTIL CL GREATER 10.
  3084
  3085     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3086     PERFORM 0260-READ-ACCT    THRU 0260-EXIT.
  3087
  3088     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3089
  3090     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3091     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3092
  3093     GO TO 0200-CHECK-ACCT-MSTR.
  3094
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* DCC043RET.cbl
  3096 0170-CHECK-CONTROL.
  3097
  3098     PERFORM 0250-CHECK-PLAN  THRU 0250-EXIT.
  3099
  3100     IF EXCLUDING-BENEFIT
  3101        GO TO 0190-BYPASS-ACCUM.
  3102
  3103     IF DTE-PGM-OPT = '5'
  3104        AND AM-AN-MO NOT = RUN-MO
  3105        GO TO 0190-BYPASS-ACCUM.
  3106
  3107     IF AM-RET-Y-N = 'L'
  3108         IF EP-RCD-TYPE NOT = LIFE-OVERRIDE-L1
  3109             GO TO 0190-BYPASS-ACCUM.
  3110
  3111     IF AM-RET-Y-N = 'D'
  3112         IF EP-RCD-TYPE NOT = AH-OVERRIDE-L1
  3113             GO TO 0190-BYPASS-ACCUM.
  3114
  3115     IF EP-RECORD-ID = 'EP'
  3116         IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3117             ADD EP-RETRO-PAYMENTS TO DA-CPS (3)
  3118             ADD EP-RETRO-EXPENSES TO DA-EXP (3)
  3119             ADD EP-RETRO-OTH-COMM TO DA-OTC (3)
  3120         ELSE
  3121             ADD EP-RETRO-PAYMENTS TO DA-CPS (4)
  3122             ADD EP-RETRO-EXPENSES TO DA-EXP (4)
  3123             ADD EP-RETRO-OTH-COMM TO DA-OTC (4).
  3124
  3125     IF EP-RECORD-ID = 'EP'
  3126         IF EP-RUN-DTE NOT GREATER BEG-DATE
  3127             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3128                 ADD EP-RETRO-PAYMENTS TO DA-CPS (1)
  3129                 ADD EP-RETRO-EXPENSES TO DA-EXP (1)
  3130                 ADD EP-RETRO-OTH-COMM TO DA-OTC (1)
  3131             ELSE
  3132                 ADD EP-RETRO-PAYMENTS TO DA-CPS (2)
  3133                 ADD EP-RETRO-EXPENSES TO DA-EXP (2)
  3134                 ADD EP-RETRO-OTH-COMM TO DA-OTC (2).
  3135
  3136     IF EP-PURGE = 'P'
  3137         IF EP-RUN-DTE GREATER BEG-DATE
  3138             MOVE 'Q' TO EP-PURGE
  3139             GO TO 0180-TEST-ACCUM
  3140         ELSE
  3141             GO TO 0180-TEST-ACCUM.
  3142
  3143     IF EP-RUN-CCYY = RD-CCYY  AND
  3144        EP-RUN-MO = RD-MO
  3145         MOVE '2' TO EP-PURGE
  3146         GO TO 0180-TEST-ACCUM.
  3147
  3148     IF EP-RUN-CCYY = BD-CCYY  AND
  3149        EP-RUN-MO = BD-MO
  3150         MOVE '1' TO EP-PURGE
  3151         GO TO 0180-TEST-ACCUM.
  3152
  3153     GO TO 0190-BYPASS-ACCUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* DCC043RET.cbl
  3154
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* DCC043RET.cbl
  3156 0180-TEST-ACCUM.
  3157     IF EP-RECORD-ID = 'EP'
  3158         IF EP-PURGE = ('1' OR 'P')
  3159             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3160                 MOVE +1 TO SA
  3161                 MOVE LIFE-RETENT   TO RETENT-FACT
  3162                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3163             ELSE
  3164                 MOVE +2 TO SA
  3165                 MOVE   AH-RETENT   TO RETENT-FACT
  3166                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3167
  3168     IF EP-RECORD-ID = 'EP'
  3169         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3170             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3171                 MOVE +3 TO SA
  3172                 MOVE LIFE-RETENT   TO RETENT-FACT
  3173                 PERFORM 0640-EP-ADD THRU 0640-EXIT
  3174             ELSE
  3175                 MOVE +4 TO SA
  3176                 MOVE   AH-RETENT   TO RETENT-FACT
  3177                 PERFORM 0640-EP-ADD THRU 0640-EXIT.
  3178
  3179     IF EP-RECORD-ID = 'EC'
  3180         IF EP-PURGE = ('1' OR 'P')
  3181             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3182                 MOVE +1 TO SA
  3183                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3184             ELSE
  3185                 MOVE +2 TO SA
  3186                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3187
  3188     IF EP-RECORD-ID = 'EC'
  3189         IF EP-PURGE = ('2' OR 'P' OR 'Q')
  3190             IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3191                 MOVE +3 TO SA
  3192                 PERFORM 0690-EC-ADD THRU 0729-EXIT
  3193             ELSE
  3194                 MOVE +4 TO SA
  3195                 PERFORM 0690-EC-ADD THRU 0729-EXIT.
  3196
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* DCC043RET.cbl
  3198 0190-BYPASS-ACCUM.
  3199     PERFORM 0240-READ-EXTRACT THRU 0240-EXIT.
  3200
  3201     IF EP-CONTROL = WS-SAVE-CONTROL
  3202         GO TO 0170-CHECK-CONTROL.
  3203
  3204     PERFORM 0280-CALCULATE-RETRO THRU 0330-EXIT.
  3205
  3206     IF EP-CONTROL = HIGH-VALUES
  3207         GO TO 0220-BUILD-EXTRACTS-EXIT.
  3208
  3209     MOVE EP-CONTROL TO WS-SAVE-CONTROL.
  3210
  3211     MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT.
  3212     MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT.
  3213
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* DCC043RET.cbl
  3215 0200-CHECK-ACCT-MSTR.
  3216     IF WS-ACCT-CONTROL LESS WS-SAVE-CONTROL
  3217         IF WS-ACCT-CONTROL-EFFDT = WS-SAVE-CONTROL-EFFDT
  3218             GO TO 0211-CONTINUE
  3219         END-IF
  3220         IF AM-GPCD = 98
  3221             PERFORM 0360-BUILD-DUMMY-GA
  3222             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3223             GO TO 0200-CHECK-ACCT-MSTR
  3224         ELSE
  3225             PERFORM 0260-READ-ACCT THRU 0260-EXIT
  3226             GO TO 0200-CHECK-ACCT-MSTR.
  3227
  3228 0210-NO-ACCT-MSTR.
  3229     IF WS-ACCT-CONTROL GREATER WS-SAVE-CONTROL
  3230         PERFORM 0270-NO-ACCT-MSG
  3231         PERFORM 0240-READ-EXTRACT THRU 0240-EXIT
  3232         IF EP-CONTROL = HIGH-VALUES
  3233             GO TO 0220-BUILD-EXTRACTS-EXIT
  3234         ELSE
  3235             MOVE EP-CONTROL TO WS-SAVE-CONTROL
  3236             MOVE EP-CNTRL-1 TO WS-SAVE-CNTRL-EFFDT
  3237             MOVE EP-EFF-DTE TO WS-SAVE-EFF-DATE-EFFDT
  3238             GO TO 0200-CHECK-ACCT-MSTR.
  3239
  3240 0211-CONTINUE.
  3241     IF DTE-PGM-OPT = '7'
  3242         PERFORM 0215-COMPUTE-BEG-DATE THRU 0215-EXIT.
  3243
  3244     GO TO 0170-CHECK-CONTROL.
  3245
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* DCC043RET.cbl
  3247 0215-COMPUTE-BEG-DATE.
  3248     IF (AM-ANNIVERSARY-DATE NOT NUMERIC) OR
  3249        (AM-AN-MO LESS 01 OR GREATER 12)
  3250            MOVE SAVE-BEG-DATE TO BEG-DATE
  3251            GO TO 0215-EXIT.
  3252
  3253     MOVE RD-CCYY  TO BD-CCYY.
  3254     MOVE AM-AN-MO TO BD-MO.
  3255
  3256     IF BD-MO NOT LESS RD-MO
  3257         SUBTRACT 1 FROM BD-CCYY.
  3258
  3259     IF BD-MO = 04 OR 06 OR 09 OR 11
  3260         MOVE 30 TO BD-DA
  3261     ELSE
  3262         MOVE 31 TO BD-DA.
  3263
  3264     IF BD-MO = 02
  3265         MOVE BD-CCYY     TO HOLD-CEN-1-CCYY
  3266         MOVE 'H'         TO DC-OPTION-CODE
  3267         PERFORM 8510-DATE-CONVERSION THRU 8590-EXIT
  3268         IF ONLY-LEAP-YEAR
  3269             MOVE HOLD-CEN-1-DA TO BD-DA
  3270         ELSE
  3271             MOVE 28            TO BD-DA.
  3272
  3273 0215-EXIT.
  3274     EXIT.
  3275
  3276 0220-BUILD-EXTRACTS-EXIT.
  3277     CLOSE
  3278         ACC-MSTR
  3279         ERPLAN-IN
  3280         EPEC-FILE.
  3281
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* DCC043RET.cbl
  3283****************************************************************
  3284*                                                              *
  3285****************************************************************
  3286
  3287 0230-PERFORMED-ROUTINES SECTION.
  3288
  3289 0240-READ-EXTRACT.
  3290     READ EPEC-FILE AT END
  3291          MOVE HIGH-VALUES TO EP-CONTROL
  3292          GO TO 0240-EXIT.
  3293
  3294     IF EP-RECORD-ID NOT = 'EP' AND 'EC'
  3295         GO TO 0240-READ-EXTRACT.
  3296
  3297     IF EP-REIN = 'R'
  3298         GO TO 0240-READ-EXTRACT.
  3299
  3300     IF EP-RUN-DTE GREATER RUN-DT
  3301         GO TO 0240-READ-EXTRACT.
  3302
* 3303     COPY ELCEPCM1.
  3304******************************************************************05/15/98
  3305*                                                                *ELCEPCM1
  3306*                                                                *ELCEPCM1
  3307*                            ELCEPCM1                            *   LV007
  3308*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  3309*                            VMOD=2.001                          *ELCEPCM1
  3310*                                                                *ELCEPCM1
  3311*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCEPCM1
  3312*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCEPCM1
  3313*                                                                *ELCEPCM1
  3314******************************************************************ELCEPCM1
  3315                                                                     CL**7
  3316     MOVE EP-EXP-DTE         TO  WS-EP-EXP-DTE-N                     CL**7
  3317                                 WS-EC-EXP-DTE-N.                    CL**7
  3318     MOVE EP-EFF-DTE         TO  WS-EP-EFF-DTE-N                     CL**7
  3319                                 WS-EC-EFF-DTE-N.                    CL**7
  3320     MOVE EP-RUN-DTE         TO  WS-EP-RUN-DTE-N                     CL**7
  3321                                 WS-EC-RUN-DTE-N.                    CL**7
  3322                                                                     CL**7
  3323     IF VALID-EP-ID                                                  CL**7
  3324         MOVE EP-HI-COV-DT   TO  WS-EP-HI-COV-DT-N                   CL**7
  3325         MOVE EP-HI-CERT     TO  WS-EP-HI-CERT-N                     CL**7
  3326         MOVE EP-LO-CERT     TO  WS-EP-LO-CERT-N.                    CL**7
  3327                                                                     CL**7
  3328
  3329 0240-EXIT.
  3330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* DCC043RET.cbl
  3332
  3333 0250-CHECK-PLAN.
  3334
  3335     PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  3336
  3337*    IF AM-RET-Y-N = ' '   OR  'N'
  3338*        MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3339*        GO TO 0250-EXIT.
  3340
  3341
  3342     IF EP-COMPANY-CD  EQUAL  WS-PL-COMPANY-CD   AND
  3343        EP-CNTRL-1     EQUAL  WS-PL-CONTROL-A    AND
  3344        EP-RCD-TYPE    EQUAL  WS-PL-BENEFIT-TYPE AND
  3345        EP-BEN-CODE    EQUAL  WS-PL-BENEFIT-CODE
  3346            GO TO 0250-EXIT.
  3347
  3348     MOVE EP-COMPANY-CD       TO WS-PL-COMPANY-CD.
  3349     MOVE EP-CNTRL-1          TO WS-PL-CONTROL-A.
  3350     MOVE EP-RCD-TYPE         TO WS-PL-BENEFIT-TYPE.
  3351     MOVE EP-BEN-CODE         TO WS-PL-BENEFIT-CODE.
  3352
  3353     MOVE SPACE               TO WS-EXCLUSION-SWITCH.
  3354
  3355     MOVE +1                  TO NDX.
  3356
  3357 0250-PLAN-LOOP.
  3358
  3359     IF NDX GREATER THAN +20
  3360        MOVE +1                 TO NDX
  3361        GO TO 025A-EDIT-FOR-SPECIAL.
  3362
  3363     IF AM-BENEFIT-CODE (NDX)  EQUAL EP-BEN-CODE AND
  3364        AM-BENEFIT-TYPE (NDX)  EQUAL EP-RCD-TYPE
  3365          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3366          MOVE WS-PLAN-CONTROL     TO PL-CONTROL-PRIMARY
  3367          GO TO 0250-READ-PLAN
  3368     ELSE
  3369        ADD +1                TO NDX
  3370        GO TO 0250-PLAN-LOOP.
  3371
  3372 0250-READ-PLAN.
  3373
  3374     IF AM-BENEFIT-RETRO-Y-N (NDX) = 'N'
  3375         MOVE '*'              TO WS-EXCLUSION-SWITCH
  3376         GO TO 0250-EXIT.
  3377
  3378     READ ERPLAN-IN.
  3379
  3380     IF ERPLAN-FILE-STATUS  EQUAL '00'
  3381         NEXT SENTENCE
  3382     ELSE
  3383        IF ERPLAN-FILE-STATUS  EQUAL '23'
  3384            GO TO 0250-PLAN-NOT-FOUND
  3385        ELSE
  3386            MOVE ERPLAN-FILE-STATUS  TO WS-ABEND-FILE-STATUS
  3387            MOVE 'READ ERROR - ERPLAN ' TO WS-ABEND-MESSAGE
  3388            DISPLAY '**BAD PLAN FILE READ'
  3389            DISPLAY '**ERPLAN-FILE-STATUS= ' ERPLAN-FILE-STATUS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* DCC043RET.cbl
  3390            GO TO ABEND-PGM.
  3391
  3392     IF EP-COMPANY-CD  EQUAL  PL-COMPANY-CD   AND
  3393        EP-CNTRL-1     EQUAL  PL-CONTROL-A    AND
  3394        EP-RCD-TYPE    EQUAL  PL-BENEFIT-TYPE AND
  3395        AM-BENEFIT-CODE (NDX)  EQUAL  PL-BENEFIT-CODE
  3396           NEXT SENTENCE
  3397     ELSE
  3398           GO TO 0250-PLAN-NOT-FOUND.
  3399
  3400     IF AM-RET-Y-N = ' '   OR  'N'
  3401         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3402         GO TO 0250-EXIT.
  3403
  3404     IF PL-RETRO-RET EQUAL ZEROS
  3405         GO TO 0250-PLAN-NOT-FOUND.
  3406
  3407     IF EP-RCD-TYPE = LIFE-OVERRIDE-L1
  3408         COMPUTE LIFE-RETENT = 1 - PL-RETRO-RET
  3409         GO TO 0250-EXIT
  3410     ELSE
  3411         COMPUTE AH-RETENT   = 1 - PL-RETRO-RET
  3412         GO TO 0250-EXIT.
  3413
  3414 025A-EDIT-FOR-SPECIAL.
  3415
  3416     IF (AM-BENEFIT-CODE (NDX) EQUAL '99')
  3417      AND
  3418        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3419          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3420          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3421          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3422          GO TO 0250-READ-PLAN.
  3423
  3424     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3425      AND
  3426        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3427        AND
  3428          AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE
  3429          IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3430              AND CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R'
  3431          MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3432          MOVE AM-BENEFIT-CODE (NDX)     TO WS-PL-BENEFIT-CODE
  3433          MOVE WS-PLAN-CONTROL           TO PL-CONTROL-PRIMARY
  3434          GO TO 0250-READ-PLAN.
  3435
  3436     IF (AM-BENEFIT-CODE (NDX) EQUAL '91')
  3437      AND
  3438        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3439      AND
  3440        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3441         IF CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I'
  3442            MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3443            MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3444            MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3445            GO TO 0250-READ-PLAN.
  3446
  3447     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* DCC043RET.cbl
  3448      AND
  3449        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3450      AND
  3451        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3452         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3453           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'R')
  3454             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3455             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3456             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3457             GO TO 0250-READ-PLAN.
  3458
  3459     IF (AM-BENEFIT-CODE (NDX) EQUAL '92')
  3460      AND
  3461        (AM-BENEFIT-TYPE (NDX) EQUAL AH-OVERRIDE-L1)
  3462      AND
  3463        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3464         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3465             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3466             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3467             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3468             GO TO 0250-READ-PLAN.
  3469
  3470     IF (AM-BENEFIT-CODE (NDX) EQUAL '93')
  3471      AND
  3472        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3473      AND
  3474        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3475         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'I')
  3476           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3477             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3478             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3479             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3480             GO TO 0250-READ-PLAN.
  3481
  3482     IF (AM-BENEFIT-CODE (NDX) EQUAL '94')
  3483      AND
  3484        (AM-BENEFIT-TYPE (NDX) EQUAL LIFE-OVERRIDE-L1)
  3485      AND
  3486        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3487         IF (CLAS-CO-BEN-I-G-CD (CLAS-INDEXL) EQUAL 'G')
  3488           AND (CLAS-I-RL-AH (CLAS-INDEXL) EQUAL 'P' OR 'L')
  3489             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3490             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3491             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3492             GO TO 0250-READ-PLAN.
  3493
  3494     IF (AM-BENEFIT-CODE (NDX) EQUAL '98')
  3495      AND
  3496        (AM-BENEFIT-TYPE (NDX) EQUAL EP-RCD-TYPE)
  3497             MOVE AM-BENEFIT-REVISION (NDX) TO WS-PL-REVISION-NO
  3498             MOVE AM-BENEFIT-CODE (NDX)   TO WS-PL-BENEFIT-CODE
  3499             MOVE WS-PLAN-CONTROL         TO PL-CONTROL-PRIMARY
  3500             GO TO 0250-READ-PLAN.
  3501
  3502     IF NDX NOT LESS THAN +20
  3503       GO TO 0250-PLAN-NOT-FOUND
  3504     ELSE
  3505       ADD  +1                 TO NDX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* DCC043RET.cbl
  3506       GO TO 025A-EDIT-FOR-SPECIAL.
  3507
  3508
  3509 0250-PLAN-NOT-FOUND.
  3510     IF AM-RET-Y-N = ' '   OR  'N'
  3511         MOVE +1.0 TO LIFE-RETENT AH-RETENT
  3512         GO TO 0250-EXIT
  3513     ELSE
  3514         COMPUTE LIFE-RETENT = 1 - AM-LF-RET
  3515         COMPUTE AH-RETENT   = 1 - AM-AH-RET
  3516         GO TO 0250-EXIT.
  3517
  3518 0250-EXIT.
  3519     EXIT.
  3520
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* DCC043RET.cbl
  3522 0260-READ-ACCT.
  3523     READ ACC-MSTR
  3524             AT END MOVE HIGH-VALUES TO WS-ACCT-CONTROL
  3525                    GO TO 0260-EXIT.
  3526
* 3527     COPY ELCACCTI.
  3528******************************************************************04/14/98
  3529*                                                                *ELCACCTI
  3530*                            ELCACCTI                            *   LV003
  3531*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3532*                            VMOD=2.001                          *ELCACCTI
  3533*                                                                *ELCACCTI
  3534*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCACCTI
  3535*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCACCTI
  3536*                                                                *ELCACCTI
  3537*  NO  CID  MODS  IN  COPYBOOK  ELCACCTI                         *ELCACCTI
  3538*                                                                *ELCACCTI
  3539******************************************************************ELCACCTI
  3540     MOVE AM-EXPIRE-DT           TO  WS-AM-EXPIRE-DT-N.              CL**2
  3541     MOVE AM-VG-EXP-DATE         TO  WS-AM-VG-EXP-DATE-N.            CL**2
  3542     MOVE AM-EFFECT-DT           TO  WS-AM-EFFECT-DT-N.              CL**2
  3543     MOVE AM-PREV-EXP-DT         TO  WS-AM-PREV-EXP-DT-N.            CL**2
  3544     MOVE AM-PREV-EFF-DT         TO  WS-AM-PREV-EFF-DT-N             CL**2
  3545     MOVE AM-ANNIVERSARY-DATE    TO  WS-AM-ANNIVERSARY-DATE-N.       CL**2
  3546     MOVE AM-HI-CERT-DATE        TO  WS-AM-HI-CERT-DATE-N.           CL**2
  3547     MOVE AM-LO-CERT-DATE        TO  WS-AM-LO-CERT-DATE-N.           CL**2
  3548     MOVE AM-ENTRY-DATE          TO  WS-AM-ENTRY-DATE-N.             CL**2
  3549
  3550     MOVE AM-MSTR-CNTRL TO WS-MSTR-CNTRL.
  3551     MOVE AM-EFFECT-DT  TO WS-EFFECT.
  3552
  3553     MOVE AM-CNTRL-1    TO WS-MSTR-CNTRL-EFFDT.
  3554     MOVE AM-EFFECT-DT  TO WS-EFFECT-EFFDT.
  3555
  3556     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  3557        MOVE TAX-EXPENSE-LINE TO WS-EX-LINE
  3558     ELSE
  3559        MOVE EXPENSE-LINE TO WS-EX-LINE
  3560     END-IF.
  3561
  3562     IF DTE-PGM-OPT  = '5' AND
  3563        AM-AN-MO NOT = RUN-MO
  3564         MOVE SPACES TO AM-RETRO-POOL
  3565         MOVE +0.0   TO AM-LF-RET AM-AH-RET
  3566         MOVE 'N'    TO AM-RET-Y-N.
  3567
  3568     IF DTE-CLIENT = 'GIC'
  3569         MOVE 'P' TO AM-RET-P-E.
  3570     IF AM-RETRO-QUALIFY-LIMIT NOT NUMERIC  OR
  3571        AM-RETRO-QUALIFY-LIMIT = ZEROS
  3572         MOVE -9999999         TO AM-RETRO-QUALIFY-LIMIT.
  3573
  3574     IF AM-RET-P-E NOT = 'P'  AND  'E'
  3575         MOVE 'E'              TO AM-RET-P-E.
  3576     IF AM-RETRO-PREM-P-E NOT = 'P'  AND  'E'
  3577         MOVE AM-RET-P-E       TO AM-RETRO-PREM-P-E.
  3578     IF AM-RETRO-CLMS-P-I NOT = 'P'  AND  'I'
  3579         MOVE 'I'              TO AM-RETRO-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* DCC043RET.cbl
  3580     IF AM-RETRO-RET-METHOD-LF NOT = 'P'  AND  'S'
  3581         MOVE 'P'              TO AM-RETRO-RET-METHOD-LF.
  3582     IF AM-RETRO-RET-BASIS-LF NOT = 'P'  AND  'E'
  3583         MOVE 'P'              TO AM-RETRO-RET-BASIS-LF.
  3584     IF AM-RETRO-RET-METHOD-AH NOT = 'P'  AND  'S'  AND  'L'
  3585         MOVE 'P'              TO AM-RETRO-RET-METHOD-AH.
  3586     IF AM-RETRO-RET-BASIS-AH NOT = 'P'  AND  'E'
  3587         MOVE 'P'              TO AM-RETRO-RET-BASIS-AH.
  3588
  3589     IF AM-RETRO-USE-LIFE-METHOD
  3590         MOVE AM-RETRO-RET-BRACKET-LF TO AM-RETRO-RET-BRACKET-AH.
  3591
  3592 0260-EXIT.
  3593     EXIT.
  3594
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* DCC043RET.cbl
  3596 0270-NO-ACCT-MSG.
  3597     IF LINE-CNT GREATER +55
  3598         MOVE ZERO   TO LINE-CNT
  3599         MOVE '1'    TO X
  3600         MOVE HEAD-1 TO P-DATA
  3601         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3602         MOVE ' '    TO X
  3603         MOVE HEAD-2 TO P-DATA
  3604         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3605         ADD +1               TO PAGE-CNT
  3606         MOVE PAGE-CNT        TO H3-PAGE
  3607         MOVE ' '    TO X
  3608         MOVE HEAD-3 TO P-DATA
  3609         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3610         MOVE ' '    TO X
  3611         MOVE HEAD-4 TO P-DATA
  3612         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  3613         MOVE ' '    TO X
  3614         MOVE SPACES TO P-DATA
  3615         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3616
  3617     MOVE WS-SAVE-CARR     TO H5-CARR.
  3618     MOVE WS-SAVE-COMP     TO H5-COMP.
  3619     MOVE WS-SAVE-STATE    TO H5-ST.
  3620     MOVE WS-SAVE-ACCT     TO H5-ACCT.
  3621     MOVE WS-SAVE-EXP-DATE TO WORK-DATE.
  3622     MOVE WK-YR            TO H5-TYR.
  3623     MOVE WK-MO            TO H5-TMO.
  3624     MOVE WK-DA            TO H5-TDA.
  3625     MOVE WS-SAVE-EFF-DATE TO WORK-DATE.
  3626     MOVE WK-YR            TO H5-FYR.
  3627     MOVE WK-MO            TO H5-FMO.
  3628     MOVE WK-DA            TO H5-FDA.
  3629     MOVE ' NO MATCHING ACCOUNT MASTER' TO H5-MESSAGE.
  3630     MOVE ' '              TO X.
  3631     MOVE HEAD-5           TO P-DATA.
  3632     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  3633
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* DCC043RET.cbl
  3635 0280-CALCULATE-RETRO.
  3636******************************************************************
  3637*              SPECIAL LOSS-RESERVE CALCULATION FOR OLI
  3638
  3639     IF DTE-CLIENT NOT = 'POS'
  3640         GO TO 0290-SKIP-CC.
  3641
  3642     IF AM-CARRIER NOT = '1'
  3643         GO TO 0290-SKIP-CC.
  3644
  3645     IF AM-FLD-5 NOT = 'CC'
  3646         GO TO 0290-SKIP-CC.
  3647
  3648     COMPUTE DA-LRV (1) = (+.40 * ((DA-ISP (1) - DA-CNP (1))
  3649                     - DA-UP (1))) - DA-CLM (1).
  3650     COMPUTE DA-LRV (2) = (+.40 * ((DA-ISP (2) - DA-CNP (2))
  3651                     - DA-UP (2))) - DA-CLM (2).
  3652     COMPUTE DA-LRV (3) = (+.40 * ((DA-ISP (3) - DA-CNP (3))
  3653                     - DA-UP (3))) - DA-CLM (3).
  3654     COMPUTE DA-LRV (4) = (+.40 * ((DA-ISP (4) - DA-CNP (4))
  3655                     - DA-UP (4))) - DA-CLM (4).
  3656
  3657     IF DA-LRV (1) LESS ZERO
  3658         ADD DA-LRV (1) TO DA-LRV (2)
  3659         MOVE ZEROS TO DA-LRV (1)
  3660         IF DA-LRV (2) LESS ZERO
  3661             MOVE ZEROS TO DA-LRV (2).
  3662
  3663     IF DA-LRV (2) LESS ZERO
  3664         ADD DA-LRV (2) TO DA-LRV (1)
  3665         MOVE ZEROS TO DA-LRV (2)
  3666         IF DA-LRV (1) LESS ZERO
  3667             MOVE ZEROS TO DA-LRV (1).
  3668
  3669     IF DA-LRV (3) LESS ZERO
  3670         ADD DA-LRV (3) TO DA-LRV (4)
  3671         MOVE ZEROS TO DA-LRV (3)
  3672         IF DA-LRV (4) LESS ZERO
  3673             MOVE ZEROS TO DA-LRV (4).
  3674
  3675     IF DA-LRV (4) LESS ZERO
  3676         ADD DA-LRV (4) TO DA-LRV (3)
  3677         MOVE ZEROS TO DA-LRV (4)
  3678         IF DA-LRV (3) LESS ZERO
  3679             MOVE ZEROS TO DA-LRV (3).
  3680
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* DCC043RET.cbl
  3682******************************************************************
  3683**       END OF SPECIAL OLI CODING
  3684******************************************************************
  3685
  3686 0290-SKIP-CC.
  3687
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* DCC043RET.cbl
  3689 0300-CALC-RETRO-A.
  3690
  3691     MOVE +1 TO SA.
  3692     MOVE +3 TO SB.
  3693     MOVE +1 TO SC.
  3694     MOVE +3 TO SF.
  3695     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3696     MOVE +2 TO SA.
  3697     MOVE +4 TO SB.
  3698     MOVE +2 TO SC.
  3699     PERFORM 0380-COMPUTE-YTD THRU 0390-EXIT.
  3700     MOVE +3 TO SB.
  3701     MOVE +4 TO SC.
  3702     MOVE +6 TO SF.
  3703     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3704     MOVE +4 TO SB.
  3705     MOVE +5 TO SC.
  3706     PERFORM 0400-COMPUTE-ITD THRU 0410-EXIT.
  3707     MOVE SPACES       TO SW-REC.
  3708     MOVE 'A'          TO SW-RPT-TYPE-ID.
  3709     MOVE AM-NAME      TO SW-NAME.
  3710     MOVE AM-ADDRS     TO SW-ADDRS.
  3711     MOVE SPACES       TO SW-CITY.
  3712     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3713        DELIMITED BY '  ' INTO SW-CITY
  3714     END-STRING
  3715     MOVE AM-ZIP       TO SW-ZIP.
  3716     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3717     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3718
  3719     IF PA-EP (4) NOT EQUAL ZEROS
  3720        COMPUTE LIFE-RETENT ROUNDED =
  3721            PA-PE (4) / PA-EP (4)
  3722     ELSE
  3723        MOVE +0.0      TO LIFE-RETENT.
  3724
  3725     IF PA-EP (5) NOT EQUAL ZEROS
  3726        COMPUTE AH-RETENT  ROUNDED =
  3727            PA-PE (5) / PA-EP (5)
  3728     ELSE
  3729        MOVE +0.0      TO AH-RETENT.
  3730
  3731     MOVE LIFE-RETENT  TO SW-LRET.
  3732     MOVE AH-RETENT    TO SW-ARET.
  3733     MOVE AM-RET-Y-N   TO SW-RET-Y-N.
  3734     MOVE AM-RET-P-E   TO SW-RET-TYP.
  3735     MOVE AM-RET-ST-TAX-USE TO SW-TAX-P-E.
  3736     MOVE AM-RETRO-PREM-P-E TO SW-PREM-P-E.
  3737     MOVE AM-RETRO-CLMS-P-I TO SW-CLMS-P-I.
  3738     MOVE AM-RETRO-QUALIFY-LIMIT   TO SW-RETRO-LIMIT.
  3739     MOVE PRINT-ACCUMS-R (1) TO SW-ACCUMS.
  3740     MOVE AM-CARRIER   TO SW-CARR.
  3741     MOVE AM-GROUPING  TO SW-COMP.
  3742     MOVE AM-STATE     TO SW-STATE.
  3743     MOVE AM-ACCOUNT   TO SW-ACCT.
  3744     MOVE BEG-DATE     TO SW-BEG-DATE.
  3745
  3746 0310-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* DCC043RET.cbl
  3747     EXIT.
  3748
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* DCC043RET.cbl
  3750 0320-CONT-RETRO-A.
  3751*01408      IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3752         IF AM-RETRO-POOL EQUAL LOW-VALUES
  3753             MOVE SPACES TO SW-RETRO-POOL SW-GA
  3754         ELSE
  3755             MOVE AM-RETRO-POOL TO SW-RETRO-POOL  SW-GA
  3756         END-IF
  3757         RELEASE SW-REC-OUT FROM SW-REC
  3758         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3759
  3760     IF AM-RETRO-POOL NOT = SPACES AND NOT = ZEROS
  3761         MOVE AM-RETRO-POOL TO SW-GA
  3762         MOVE 'B'           TO SW-RPT-TYPE-ID
  3763         IF DTE-CLIENT NOT = 'VSL'
  3764             RELEASE SW-REC-OUT FROM SW-REC
  3765             ADD +1 TO NO-OF-RECORDS-RELEASED
  3766         ELSE
  3767             IF AM-RET-Y-N = 'Y' OR 'I' OR 'G' OR 'L' OR 'D'
  3768                 RELEASE SW-REC-OUT FROM SW-REC
  3769                 ADD +1 TO NO-OF-RECORDS-RELEASED.
  3770
  3771     IF DTE-CLIENT = 'TAO'
  3772         MOVE AM-USER-FIELDS TO Z-G
  3773         MOVE ZONE-GROUP     TO SW-GA
  3774         MOVE 'B'            TO SW-RPT-TYPE-ID
  3775         RELEASE SW-REC-OUT FROM SW-REC
  3776         ADD +1             TO NO-OF-RECORDS-RELEASED.
  3777
  3778     MOVE ZEROS TO DA-ISC-ADDL (1) DA-CNC-ADDL (1) DA-UC-ADDL (1)
  3779                   DA-ISC-ADDL (2) DA-CNC-ADDL (2) DA-UC-ADDL (2)
  3780                   DA-ISC-ADDL (3) DA-CNC-ADDL (3) DA-UC-ADDL (3)
  3781                   DA-ISC-ADDL (4) DA-CNC-ADDL (4) DA-UC-ADDL (4).
  3782     MOVE ZEROS TO
  3783              DA-CSO-ADMIN (1) DA-CCC-ADMIN (1) DA-CSO-ADM-UC (1)
  3784              DA-CSO-ADMIN (2) DA-CCC-ADMIN (2) DA-CSO-ADM-UC (2)
  3785              DA-CSO-ADMIN (3) DA-CCC-ADMIN (3) DA-CSO-ADM-UC (3)
  3786              DA-CSO-ADMIN (4) DA-CCC-ADMIN (4) DA-CSO-ADM-UC (4).
  3787
  3788     PERFORM 0340-GA-EXT-LOOP THRU 0350-EXIT
  3789         VARYING CL FROM 1 BY 1 UNTIL CL GREATER EC-REC-MAX.
  3790
  3791     IF AM-GPCD = 98
  3792         MOVE AM-ACCOUNT  TO SW-GA
  3793         MOVE 'X'         TO SW-GA-FLAG
  3794         MOVE HIGH-VALUES TO SW-CARR SW-COMP SW-STATE
  3795         MOVE 'C'         TO SW-RPT-TYPE-ID
  3796         RELEASE SW-REC-OUT FROM SW-REC
  3797         ADD +1 TO NO-OF-RECORDS-RELEASED.
  3798
  3799     PERFORM 0550-ZERO-DA VARYING SA FROM 1 BY 1
  3800                          UNTIL SA GREATER 4.
  3801     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  3802                          UNTIL SB GREATER 6.
  3803     PERFORM 0570-ZERO-XDA VARYING CL FROM 1 BY 1
  3804                          UNTIL CL GREATER 10.
  3805
  3806 0330-EXIT.
  3807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* DCC043RET.cbl
  3808
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* DCC043RET.cbl
  3810 0340-GA-EXT-LOOP.
  3811     IF XDA-GA-TYPE (CL) = 'O' OR 'P' OR 'G' OR 'B'
  3812         NEXT SENTENCE
  3813      ELSE
  3814         GO TO 0350-EXIT.
  3815
  3816     MOVE XDA-GA-ISC (CL, 1) TO DA-GA-ISC (1).
  3817     MOVE XDA-GA-ISC (CL, 2) TO DA-GA-ISC (2).
  3818     MOVE XDA-GA-ISC (CL, 3) TO DA-GA-ISC (3).
  3819     MOVE XDA-GA-ISC (CL, 4) TO DA-GA-ISC (4).
  3820     MOVE XDA-GA-CNC (CL, 1) TO DA-GA-CNC (1).
  3821     MOVE XDA-GA-CNC (CL, 2) TO DA-GA-CNC (2).
  3822     MOVE XDA-GA-CNC (CL, 3) TO DA-GA-CNC (3).
  3823     MOVE XDA-GA-CNC (CL, 4) TO DA-GA-CNC (4).
  3824     MOVE XDA-GA-UC  (CL, 1) TO DA-GA-UC  (1).
  3825     MOVE XDA-GA-UC  (CL, 2) TO DA-GA-UC  (2).
  3826     MOVE XDA-GA-UC  (CL, 3) TO DA-GA-UC  (3).
  3827     MOVE XDA-GA-UC  (CL, 4) TO DA-GA-UC  (4).
  3828
  3829     MOVE 3 TO SB.
  3830     PERFORM 0560-ZERO-PA.
  3831     MOVE 6 TO SB.
  3832     PERFORM 0560-ZERO-PA.
  3833     PERFORM 0300-CALC-RETRO-A THRU 0310-EXIT.
  3834     MOVE XDA-GA-NO (CL)         TO SW-GA.
  3835     MOVE 'C'                    TO SW-RPT-TYPE-ID.
  3836     RELEASE SW-REC-OUT FROM SW-REC.
  3837     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3838
  3839 0350-EXIT.
  3840     EXIT.
  3841
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* DCC043RET.cbl
  3843 0360-BUILD-DUMMY-GA.
  3844
  3845     MOVE SPACES       TO SW-REC.
  3846     MOVE -9999999     TO SW-RETRO-LIMIT.
  3847     MOVE 'X'          TO SW-GA-FLAG.
  3848     MOVE 'C'          TO SW-RPT-TYPE-ID.
  3849     MOVE AM-NAME      TO SW-NAME.
  3850     MOVE AM-ADDRS     TO SW-ADDRS.
  3851     MOVE SPACES       TO SW-CITY.
  3852     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  3853        DELIMITED BY '  ' INTO SW-CITY
  3854     END-STRING
  3855     MOVE AM-ZIP       TO SW-ZIP.
  3856     MOVE AM-EXPIRE-DT TO SW-EXP-DT.
  3857     MOVE AM-EFFECT-DT TO SW-EFF-DT.
  3858
  3859     IF AM-RET-Y-N = ' '   OR  'N'
  3860         MOVE +1.0 TO SW-LRET SW-ARET
  3861     ELSE
  3862         COMPUTE SW-LRET = 1 - AM-LF-RET
  3863         COMPUTE SW-ARET = 1 - AM-AH-RET.
  3864
  3865     MOVE AM-RET-P-E         TO SW-RET-TYP.
  3866     MOVE PRINT-ACCUMS-R (6) TO SW-ACCUMS.
  3867     MOVE HIGH-VALUES        TO SW-CARR SW-COMP SW-STATE.
  3868     MOVE AM-ACCOUNT         TO SW-ACCT SW-GA.
  3869     RELEASE SW-REC-OUT FROM SW-REC.
  3870     ADD +1 TO NO-OF-RECORDS-RELEASED.
  3871
  3872 0370-EXIT.
  3873     EXIT.
  3874
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* DCC043RET.cbl
  3876 0380-COMPUTE-YTD.
  3877     COMPUTE PA-NW (SC) = (DA-ISP (SB) - DA-CNP (SB)) -
  3878                          (DA-ISP (SA) - DA-CNP (SA)).
  3879
  3880*01524      IF AM-RETRO-PREM-P-E = 'E'
  3881         MOVE DA-UP (SA) TO PA-BR (SC)
  3882         MOVE DA-UP (SB) TO PA-ER (SC).
  3883
  3884     COMPUTE PA-EP (SC) = PA-NW (SC) + PA-BR (SC) - PA-ER (SC).
  3885
  3886     COMPUTE PA-PE (SC) = DA-PCT-E-PREM (SB) - DA-PCT-E-PREM (SA).
  3887
  3888     COMPUTE PA-PL (SC) = DA-CLM (SB) - DA-CLM (SA).
  3889
  3890     IF AM-RETRO-CLMS-P-I = 'I'
  3891         MOVE DA-LRV (SA) TO PA-BLR (SC)
  3892         MOVE DA-LRV (SB) TO PA-ELR (SC).
  3893
  3894     IF DTE-CLIENT = 'ABL'
  3895         COMPUTE PA-BLR (SC) =   DA-LRV (SA) +
  3896         ((((DA-ISP (SB) - DA-ISP (SA)) -
  3897            (DA-CNP (SB) - DA-CNP (SA))) - DA-UP (SA)) * .25)
  3898         COMPUTE PA-ELR (SC) =   DA-LRV (SB) + (PA-EP (SC) * .25).
  3899
  3900     IF DTE-CLIENT = 'GIC'
  3901         IF SC = +1
  3902             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .00
  3903             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  3904         ELSE
  3905             COMPUTE PA-BLR (SC) =  PA-BR (SC) * .12
  3906             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  3907
  3908     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  3909         MOVE +0 TO AM-RET-MIN-LOSS-L.
  3910
  3911     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  3912         MOVE +0 TO AM-RET-MIN-LOSS-A.
  3913
  3914     IF SC = +1
  3915         COMPUTE WS-MIN-LOSS ROUNDED =
  3916            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  3917                                              + PA-BLR (SC)
  3918        ELSE
  3919         COMPUTE WS-MIN-LOSS ROUNDED =
  3920            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC)
  3921                                              + PA-BLR (SC).
  3922     IF SC = +1
  3923         IF AM-RET-MIN-LOSS-L = ZERO
  3924            MOVE ZERO TO WS-MIN-LOSS.
  3925
  3926     IF SC = +2
  3927         IF AM-RET-MIN-LOSS-A = ZERO
  3928            MOVE ZERO TO WS-MIN-LOSS.
  3929
  3930     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  3931         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  3932
  3933     COMPUTE PA-TL (SC) = PA-PL (SC) - PA-BLR (SC) + PA-ELR (SC).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* DCC043RET.cbl
  3934
  3935     COMPUTE PA-RC (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3936                           (DA-ISC (SA) - DA-CNC (SA))) +
  3937                          ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3938                           (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3939
  3940     COMPUTE PA-EC (SC) = PA-RC (SC) + (DA-UC (SA) - DA-UC (SB))
  3941                         + (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3942
  3943     COMPUTE PA-ACCT-COMMP (SC) = ((DA-ISC (SB) - DA-CNC (SB)) -
  3944                                  (DA-ISC (SA) - DA-CNC (SA))).
  3945     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) +
  3946                                  (DA-UC (SA) - DA-UC (SB)).
  3947     COMPUTE PA-OW-COMMP (SC) =
  3948                         ((DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) -
  3949                          (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA))).
  3950     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) +
  3951                            (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)).
  3952     COMPUTE PA-CSO-ADMINP (SC) =
  3953             DA-CSO-ADMIN (SB) - DA-CSO-ADMIN (SA)
  3954     COMPUTE PA-CSO-ADMINE (SC) = PA-CSO-ADMINP (SC) +
  3955             (DA-CSO-ADM-UC (SA) - DA-CSO-ADM-UC (SB)).
  3956     COMPUTE PA-CCC-ADMINP (SC) =
  3957             (PA-NW (SC) - PA-PE (SC)) -
  3958             (DA-CSO-ADMIN (SB) - DA-CSO-ADMIN (SC))
  3959     COMPUTE PA-CCC-ADMINE (SC) = PA-CCC-ADMINP (SC) +
  3960             (DA-CSO-ADM-UC (SA) - DA-CSO-ADM-UC (SB)).
  3961     COMPUTE PA-TOT-CLPP (SC) = PA-NW (SC) -
  3962             (((DA-ISC (SB) - DA-CNC (SB)) +
  3963             (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) +
  3964              DA-CSO-ADMIN (SB))
  3965                  -
  3966             ((DA-ISC (SA) - DA-CNC (SA)) +
  3967             (DA-ISC-ADDL (SA) - DA-CNC-ADDL (SA)) +
  3968              DA-CSO-ADMIN (SA)))
  3969     COMPUTE PA-TOT-CLPE (SC) = PA-TOT-CLPP (SC) +
  3970             (DA-UC (SA) - DA-UC (SB)) +
  3971             (DA-UC-ADDL (SA) - DA-UC-ADDL (SB)) +
  3972             (DA-CSO-ADM-UC (SA) - DA-CSO-ADM-UC (SB))
  3973
  3974     IF AM-RET-P-E = 'P'
  3975*         MOVE PA-RC (SC) TO PA-CU (SC)
  3976         MOVE PA-ACCT-COMMP (SC) TO PA-CU (SC)
  3977      ELSE
  3978*         MOVE PA-EC (SC) TO PA-CU (SC).
  3979         MOVE PA-ACCT-COMME (SC) TO PA-CU (SC)
  3980     END-IF.
  3981     COMPUTE PA-GACU (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB))
  3982        - (DA-GA-ISC (SA) - DA-GA-CNC (SA))
  3983     COMPUTE PA-GATC (SC) = PA-CU (SC) + PA-GACU (SC).
  3984
  3985     COMPUTE PA-OC (SC) = DA-OTC (SB) - DA-OTC (SA).
  3986     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC) + PA-GACU (SC)
  3987     COMPUTE PA-CP (SC) = DA-CPS (SB) - DA-CPS (SA).
  3988     COMPUTE PA-TAXP (SC) = DA-TAX (SB) - DA-TAX (SA).
  3989     IF PA-NW (SC) <> 0
  3990         COMPUTE PA-TAXE (SC) = (PA-EP (SC) / PA-NW (SC)) *
  3991                                (DA-TAX (SB) - DA-TAX (SA))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* DCC043RET.cbl
  3992     ELSE
  3993         COMPUTE PA-TAXE (SC) = DA-TAX (SB) - DA-TAX (SA)
  3994     END-IF.
  3995
  3996     IF DTE-CLIENT = 'FLA'
  3997         COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  3998      ELSE
  3999         COMPUTE PA-EX (SC) = DA-EXP (SB) - DA-EXP (SA).
  4000
  4001     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4002         IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4003              IF SC = 1
  4004                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4005*                          (PA-NW (SC) * AM-REI-LF-TAX)
  4006                    (DA-TAX (SB) - DA-TAX (SA))
  4007               ELSE
  4008                 COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4009*                          (PA-NW (SC) * AM-REI-AH-TAX)
  4010                    (DA-TAX (SB) - DA-TAX (SA))
  4011          ELSE
  4012              IF PA-NW(SC) <> 0
  4013                 IF SC = 1
  4014                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4015*                             (PA-EP (SC) * AM-REI-LF-TAX)
  4016                       (PA-EP (SC) / PA-NW (SC)) *
  4017                       (DA-TAX (SB) - DA-TAX (SA))
  4018                  ELSE
  4019                    COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4020*                             (PA-EP (SC) * AM-REI-AH-TAX).
  4021                       (PA-EP (SC) / PA-NW (SC)) *
  4022                       (DA-TAX (SB) - DA-TAX (SA)).
  4023
  4024     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4025                          + PA-CP (SC) + PA-EX (SC).
  4026     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  4027     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4028     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4029     COMPUTE PA-GARC (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB)) -
  4030                   (DA-GA-ISC (SA) - DA-GA-CNC (SA)).
  4031     COMPUTE PA-GAEC (SC) = PA-GARC (SC) + DA-GA-UC (SA) -
  4032                                        DA-GA-UC (SB).
  4033     PERFORM 0520-ADD-PA-LEVELS.
  4034
  4035 0390-EXIT.
  4036     EXIT.
  4037
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* DCC043RET.cbl
  4039 0400-COMPUTE-ITD.
  4040     COMPUTE PA-NW (SC) = DA-ISP (SB) - DA-CNP (SB).
  4041
  4042*01635      IF AM-RETRO-PREM-P-E = 'E'
  4043         MOVE DA-UP (SB)       TO PA-ER (SC).
  4044
  4045     COMPUTE PA-EP (SC) = PA-NW (SC) - PA-ER (SC).
  4046
  4047     MOVE DA-PCT-E-PREM (SB)   TO PA-PE (SC).
  4048
  4049     MOVE DA-CLM (SB)          TO PA-PL (SC).
  4050
  4051     IF AM-RETRO-CLMS-P-I = 'I'
  4052         MOVE DA-LRV (SB)      TO PA-ELR (SC).
  4053
  4054     IF DTE-CLIENT = 'ABL'
  4055         COMPUTE PA-ELR (SC) = DA-LRV (SB) + (PA-EP (SC) * .25).
  4056
  4057     IF DTE-CLIENT = 'GIC'
  4058         IF SC = +4
  4059             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .00
  4060         ELSE
  4061             COMPUTE PA-ELR (SC) =  PA-ER (SC) * .12.
  4062
  4063     IF AM-RET-MIN-LOSS-L NOT NUMERIC
  4064         MOVE +0 TO AM-RET-MIN-LOSS-L.
  4065
  4066     IF AM-RET-MIN-LOSS-A NOT NUMERIC
  4067         MOVE +0 TO AM-RET-MIN-LOSS-A.
  4068
  4069     IF SC = +4
  4070         COMPUTE WS-MIN-LOSS ROUNDED =
  4071            (PA-EP (SC) * AM-RET-MIN-LOSS-L) - PA-PL (SC)
  4072     ELSE
  4073         COMPUTE WS-MIN-LOSS ROUNDED =
  4074            (PA-EP (SC) * AM-RET-MIN-LOSS-A) - PA-PL (SC).
  4075
  4076     IF SC = +4
  4077         IF AM-RET-MIN-LOSS-L = ZERO
  4078            MOVE ZERO TO WS-MIN-LOSS.
  4079
  4080     IF SC = +5
  4081         IF AM-RET-MIN-LOSS-A = ZERO
  4082            MOVE ZERO TO WS-MIN-LOSS.
  4083
  4084     IF WS-MIN-LOSS GREATER PA-ELR (SC)
  4085         MOVE WS-MIN-LOSS TO PA-ELR (SC).
  4086
  4087     COMPUTE PA-TL (SC) = PA-PL (SC) + PA-ELR (SC).
  4088
  4089
  4090     COMPUTE PA-RC (SC) = (DA-ISC (SB) - DA-CNC (SB)) +
  4091                          (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)).
  4092     COMPUTE PA-EC (SC) =
  4093                  PA-RC (SC) - DA-UC (SB) - DA-UC-ADDL (SB).
  4094
  4095     COMPUTE PA-ACCT-COMMP (SC) = DA-ISC (SB) - DA-CNC (SB).
  4096     COMPUTE PA-ACCT-COMME (SC) = PA-ACCT-COMMP (SC) - DA-UC (SB).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* DCC043RET.cbl
  4097     COMPUTE PA-OW-COMMP (SC) = DA-ISC-ADDL (SB) -
  4098                                DA-CNC-ADDL (SB).
  4099     COMPUTE PA-OW-COMME (SC) = PA-OW-COMMP (SC) -
  4100                                DA-UC-ADDL (SB).
  4101     COMPUTE PA-CSO-ADMINP (SC) = DA-CSO-ADMIN (SB).
  4102     COMPUTE PA-CSO-ADMINE (SC) = PA-CSO-ADMINP (SC) -
  4103                                   DA-CSO-ADM-UC (SB).
  4104     COMPUTE PA-CCC-ADMINP (SC) = (PA-NW (SC) - PA-PE (SC)) -
  4105                                DA-CSO-ADMIN (SB).
  4106     COMPUTE PA-CCC-ADMINE (SC) = PA-CCC-ADMINP (SC) -
  4107                                DA-CSO-ADM-UC (SB).
  4108     COMPUTE PA-TOT-CLPP (SC) = PA-NW (SC) -
  4109             ((DA-ISC (SB) - DA-CNC (SB)) +
  4110             (DA-ISC-ADDL (SB) - DA-CNC-ADDL (SB)) +
  4111              DA-CSO-ADMIN (SB))
  4112     COMPUTE PA-TOT-CLPE (SC) = PA-TOT-CLPP (SC) +
  4113             DA-UC (SB) + DA-UC-ADDL (SB) +
  4114             DA-CSO-ADM-UC (SB)
  4115
  4116     IF AM-RET-P-E = 'P'
  4117*         MOVE PA-RC (SC) TO PA-CU (SC)
  4118         MOVE PA-ACCT-COMMP (SC) TO PA-CU (SC)
  4119     ELSE
  4120*         MOVE PA-EC (SC) TO PA-CU (SC).
  4121         MOVE PA-ACCT-COMME (SC) TO PA-CU (SC)
  4122     END-IF.
  4123     COMPUTE PA-GACU (SC) = (DA-GA-ISC (SB) - DA-GA-CNC (SB))
  4124     COMPUTE PA-GATC (SC) = PA-CU (SC) + PA-GACU (SC).
  4125
  4126     MOVE DA-OTC (SB) TO PA-OC (SC).
  4127     COMPUTE PA-TC (SC) = PA-CU (SC) + PA-OC (SC) + PA-GACU (SC).
  4128     MOVE DA-CPS (SB) TO PA-CP (SC).
  4129     MOVE DA-TAX (SB) TO PA-TAXP (SC).
  4130     IF PA-NW (SC) <> 0
  4131         COMPUTE PA-TAXE (SC) = ((PA-EP (SC) / PA-NW (SC))
  4132                                * DA-TAX (SB))
  4133     ELSE
  4134         MOVE DA-TAX (SB) TO PA-TAXE (SC)
  4135     END-IF.
  4136
  4137     IF DTE-CLIENT = 'FLA'
  4138        COMPUTE PA-EX (SC) = PA-NW (SC) * .11
  4139     ELSE
  4140        MOVE DA-EXP (SB) TO PA-EX (SC)
  4141     END-IF
  4142
  4143*    MOVE 'P' TO AM-RET-ST-TAX-USE
  4144*    MOVE 'P' TO AM-RET-P-E
  4145     IF AM-RET-ST-TAX-USE = 'Y' OR 'P' OR 'E'
  4146        IF (AM-RET-P-E = 'P') OR (AM-RET-ST-TAX-USE = 'P')
  4147           IF SC = 4
  4148              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4149*                (PA-NW (SC) * AM-REI-LF-TAX)
  4150                 DA-TAX (SB)
  4151           ELSE
  4152              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4153*                (PA-NW (SC) * AM-REI-AH-TAX)
  4154                 DA-TAX (SB)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* DCC043RET.cbl
  4155           END-IF
  4156        ELSE
  4157          IF PA-NW (SC) <> 0
  4158           IF SC = 4
  4159              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4160*                (PA-EP (SC) * AM-REI-LF-TAX)
  4161                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4162           ELSE
  4163              COMPUTE PA-EX (SC) =  PA-EX (SC) +
  4164*                (PA-EP (SC) * AM-REI-AH-TAX).
  4165                 ((PA-EP (SC) / PA-NW (SC)) * DA-TAX (SB))
  4166           END-IF
  4167          END-IF
  4168        END-IF
  4169     END-IF
  4170
  4171     COMPUTE PA-TE (SC) = PA-TL (SC) + PA-TC (SC)
  4172                        + PA-CP (SC) + PA-EX (SC).
  4173     COMPUTE PA-BA (SC) = PA-PE (SC) - PA-TE (SC).
  4174     COMPUTE PA-NTE (SC) = PA-TL (SC) + PA-TC (SC) + PA-EX (SC).
  4175     COMPUTE PA-NBA (SC) = PA-PE (SC) - PA-NTE (SC).
  4176     COMPUTE PA-GARC (SC) = DA-GA-ISC (SB) - DA-GA-CNC (SB).
  4177     COMPUTE PA-GAEC (SC) = PA-GARC (SC) - DA-GA-UC (SB).
  4178
  4179     PERFORM 0520-ADD-PA-LEVELS.
  4180
  4181 0410-EXIT.
  4182     EXIT.
  4183
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* DCC043RET.cbl
  4185 0420-CALCULATE-GA.
  4186     COMPUTE PA-PE (SC) ROUNDED = PA-EP (SC) * RETENT-FACT.
  4187
  4188     IF SAVE-RET-TYP = 'E'
  4189         MOVE PA-GAEC (SC) TO PA-GACU (SC)
  4190     ELSE
  4191         MOVE PA-GARC (SC) TO PA-GACU (SC).
  4192
  4193     COMPUTE PA-GATC (SC) = PA-TC (SC) + PA-GACU (SC).
  4194     COMPUTE PA-GATE (SC) = PA-NTE (SC) + PA-GACU (SC).
  4195     COMPUTE PA-GABA (SC) = PA-PE (SC) - PA-GATE (SC).
  4196     COMPUTE PA-GAGT (SC) = PA-GABA (SC) - PA-CP (SC)
  4197                                      - PA-NBA (SC).
  4198     ADD PA-GACU (SC) TO PA-GACU (SF).
  4199     ADD PA-GATC (SC) TO PA-GATC (SF).
  4200     ADD PA-GATE (SC) TO PA-GATE (SF).
  4201     ADD PA-GABA (SC) TO PA-GABA (SF).
  4202     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4203
  4204 0430-EXIT.
  4205
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* DCC043RET.cbl
  4207 0440-GENERATE-RETRO.
  4208     IF DTE-PGM-OPT = '1'
  4209         AND H1-REPORT-SUF NOT = 'A'
  4210     OR DTE-PGM-OPT = '2'
  4211         AND H1-REPORT-SUF NOT = 'B'
  4212     OR DTE-PGM-OPT = '3'
  4213         AND H1-REPORT-SUF NOT = 'C'
  4214             GO TO 0470-EXIT.
  4215
  4216     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4217        H1-REPORT-SUF NOT = ('A' AND 'B')
  4218          GO TO 0470-EXIT.
  4219
  4220     PERFORM 0580-ZERO-PCNT VARYING SB FROM 1 BY 1
  4221                            UNTIL SB GREATER 2
  4222       AFTER SC FROM 1 BY 1 UNTIL SC GREATER 39.
  4223
  4224     MOVE +1 TO SE.
  4225     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4226     MOVE +2 TO SE.
  4227     ADD +3 TO SF.
  4228
  4229     PERFORM 0480-COMPUTE-PERCENTS THRU 0490-EXIT.
  4230
  4231     IF SG = 1
  4232         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  4233     END-IF.
  4234
  4235     PERFORM 0590-HEADING-ROUTINE  THRU 0600-EXIT.
  4236
  4237     IF SH = +1
  4238        MOVE '13. TOTAL CLP    ' TO DT-ENTRY (29)
  4239     ELSE
  4240        MOVE '14. TOTAL CLP    ' TO DT-ENTRY (29)
  4241     END-IF
  4242
  4243     IF HEAD-SW = '1' OR '2'
  4244         IF SAVE-RET-TYP = 'E'
  4245             MOVE '  1. EARNED '         TO DT-ENTRY (13)
  4246         ELSE
  4247             MOVE '  1. RETAINED '       TO DT-ENTRY (13)
  4248     ELSE
  4249         MOVE '  1. ACCOUNT COMMISSION ' TO DT-ENTRY (13).
  4250
  4251     MOVE +1 TO SB.
  4252
  4253 0450-PRINT-LOOP.
  4254     IF DT-SS-R (SB SH) = SPACES
  4255         GO TO 0460-CHECK-NEXT-LINE.
  4256
  4257     IF DT-SS-R (SB SH) = '00'
  4258         MOVE DT-CTL-CHAR (SB) TO X
  4259         MOVE DT-ENTRY (SB)    TO DL-DESC
  4260         MOVE DETAIL-LINE      TO P-DATA
  4261         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4262         GO TO 0460-CHECK-NEXT-LINE.
  4263
  4264     MOVE DT-CTL-CHAR (SB) TO X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* DCC043RET.cbl
  4265     MOVE DT-SS (SB SH)    TO SA.
  4266
  4267     PERFORM 0500-PRINT-DETAIL THRU 0510-EXIT.
  4268
  4269 0460-CHECK-NEXT-LINE.
  4270     ADD +1 TO SB.
  4271     IF DT-CTL-CHAR (SB) NOT = HIGH-VALUES
  4272         GO TO 0450-PRINT-LOOP.
  4273
  4274     MOVE '-'    TO X.
  4275     MOVE SPACES TO P-DATA.
  4276     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4277*    IF (DTE-FMT-OPT  =  2)        AND
  4278*       (BREAK-1-SWITCH NOT = ' ')   AND
  4279*       (H1-REPORT-SUF = 'A')
  4280*       NEXT SENTENCE
  4281*    ELSE
  4282*       ADD 1 TO PAGE-CNT.
  4283*    MOVE PAGE-CNT TO H9-PAGE.
  4284*    MOVE HEAD-9   TO P-DATA.
  4285*    PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4286
  4287 0470-EXIT.
  4288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* DCC043RET.cbl
  4290
  4291 0480-COMPUTE-PERCENTS.
  4292     IF PA-EP (SF) = ZERO
  4293         GO TO 0490-EXIT.
  4294
  4295     COMPUTE PT-PRCNT (SE 5) ROUNDED =
  4296         PA-PE (SF) / PA-EP (SF).
  4297     COMPUTE PT-PRCNT (SE 9) ROUNDED =
  4298         PA-TL (SF) / PA-EP (SF).
  4299     COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4300         PA-TC (SF) / PA-EP (SF).
  4301
  4302     IF DTE-CLIENT = 'TAO'  AND  PA-NW (SF) NOT = ZERO
  4303         COMPUTE PT-PRCNT (SE 12) ROUNDED =
  4304             PA-TC (SF) / PA-NW (SF).
  4305
  4306     COMPUTE PT-PRCNT (SE 13) ROUNDED =
  4307         PA-CP (SF) / PA-EP (SF).
  4308     COMPUTE PT-PRCNT (SE 14) ROUNDED =
  4309         PA-EX (SF) / PA-EP (SF).
  4310     COMPUTE PT-PRCNT (SE 16) ROUNDED =
  4311         PA-BA (SF) / PA-EP (SF).
  4312     COMPUTE PT-PRCNT (SE 17) ROUNDED =
  4313         PA-NTE (SF) / PA-EP (SF).
  4314     COMPUTE PT-PRCNT (SE 18) ROUNDED =
  4315         PA-NBA (SF) / PA-EP (SF).
  4316     COMPUTE PT-PRCNT (SE 24) ROUNDED =
  4317         PA-GATC (SF) / PA-EP (SF).
  4318     COMPUTE PT-PRCNT (SE 25) ROUNDED =
  4319         PA-GAGT (SF) / PA-EP (SF).
  4320     COMPUTE PT-PRCNT (SE 26) ROUNDED =
  4321         PA-GABA (SF) / PA-EP (SF).
  4322     COMPUTE PT-PRCNT (SE 27) ROUNDED =
  4323         PA-GATE (SF) / PA-EP (SF).
  4324     COMPUTE PT-PRCNT (SE 34) ROUNDED =
  4325         PA-CSO-ADMINP (SF) / PA-EP (SF).
  4326     COMPUTE PT-PRCNT (SE 36) ROUNDED =
  4327         PA-CCC-ADMINP (SF) / PA-EP (SF).
  4328     COMPUTE PT-PRCNT (SE 38) ROUNDED =
  4329         PA-TOT-CLPP (SF) / PA-EP (SF).
  4330
  4331     COMPUTE PT-PRCNT (SE 5)  =  PT-PRCNT (SE 5)  * +100.
  4332     COMPUTE PT-PRCNT (SE 9)  =  PT-PRCNT (SE 9)  * +100.
  4333     COMPUTE PT-PRCNT (SE 12) =  PT-PRCNT (SE 12) * +100.
  4334     COMPUTE PT-PRCNT (SE 13) =  PT-PRCNT (SE 13) * +100.
  4335     COMPUTE PT-PRCNT (SE 14) =  PT-PRCNT (SE 14) * +100.
  4336     COMPUTE PT-PRCNT (SE 16) =  PT-PRCNT (SE 16) * +100.
  4337     COMPUTE PT-PRCNT (SE 17) =  PT-PRCNT (SE 17) * +100.
  4338     COMPUTE PT-PRCNT (SE 18) =  PT-PRCNT (SE 18) * +100.
  4339     COMPUTE PT-PRCNT (SE 24) =  PT-PRCNT (SE 24) * +100.
  4340     COMPUTE PT-PRCNT (SE 25) =  PT-PRCNT (SE 25) * +100.
  4341     COMPUTE PT-PRCNT (SE 26) =  PT-PRCNT (SE 26) * +100.
  4342     COMPUTE PT-PRCNT (SE 27) =  PT-PRCNT (SE 27) * +100.
  4343     COMPUTE PT-PRCNT (SE 34) =  PT-PRCNT (SE 34) * +100.
  4344     COMPUTE PT-PRCNT (SE 36) =  PT-PRCNT (SE 36) * +100.
  4345     COMPUTE PT-PRCNT (SE 38) =  PT-PRCNT (SE 38) * +100.
  4346
  4347 0490-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* DCC043RET.cbl
  4348     EXIT.
  4349
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* DCC043RET.cbl
  4351 0500-PRINT-DETAIL.
  4352     MOVE PA-AMT (SG 1 SA) TO DL-YLF.
  4353     MOVE PA-AMT (SG 2 SA) TO DL-YAH.
  4354     MOVE PA-AMT (SG 3 SA) TO DL-YT.
  4355     MOVE PT-PRCNT (1 SA)  TO DL-YPT.
  4356     MOVE DT-ENTRY (SB)    TO DL-DESC.
  4357     MOVE PA-AMT (SG 4 SA) TO DL-ILF.
  4358     MOVE PA-AMT (SG 5 SA) TO DL-IAH.
  4359     MOVE PA-AMT (SG 6 SA) TO DL-IT.
  4360     MOVE PT-PRCNT (2 SA)  TO DL-IPT.
  4361     MOVE DETAIL-LINE      TO P-DATA.
  4362     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4363     MOVE SPACES           TO DETAIL-LINE  P-DATA.
  4364
  4365*     IF SG = 2
  4366*         IF DO-OUT-SUBSCRIPT (SB) > 0
  4367*            MOVE DO-OUT-SUBSCRIPT (SB) TO WS-DO-SUB
  4368*            MOVE DT-ENTRY (SB)     TO DO-DESCR (WS-DO-SUB)
  4369*            MOVE PA-AMT (SG 1 SA)  TO DO-PERLF (WS-DO-SUB)
  4370*            MOVE PA-AMT (SG 4 SA)  TO DO-ITDLF (WS-DO-SUB)
  4371*            MOVE PA-AMT (SG 2 SA)  TO DO-PERAH (WS-DO-SUB)
  4372*            MOVE PA-AMT (SG 5 SA)  TO DO-ITDAH (WS-DO-SUB)
  4373*         END-IF
  4374*     END-IF.
  4375
  4376 0510-EXIT.
  4377     EXIT.
  4378
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* DCC043RET.cbl
  4380 0520-ADD-PA-LEVELS.
  4381     ADD PA-NW   (SC) TO PA-NW   (SF).
  4382     ADD PA-BR   (SC) TO PA-BR   (SF).
  4383     ADD PA-ER   (SC) TO PA-ER   (SF).
  4384     ADD PA-EP   (SC) TO PA-EP   (SF).
  4385     ADD PA-PE   (SC) TO PA-PE   (SF).
  4386     ADD PA-PL   (SC) TO PA-PL   (SF).
  4387     ADD PA-BLR  (SC) TO PA-BLR  (SF).
  4388     ADD PA-ELR  (SC) TO PA-ELR  (SF).
  4389     ADD PA-TL   (SC) TO PA-TL   (SF).
  4390     ADD PA-RC   (SC) TO PA-RC   (SF).
  4391     ADD PA-OC   (SC) TO PA-OC   (SF).
  4392     ADD PA-TC   (SC) TO PA-TC   (SF).
  4393     ADD PA-CP   (SC) TO PA-CP   (SF).
  4394     ADD PA-EX   (SC) TO PA-EX   (SF).
  4395     ADD PA-TE   (SC) TO PA-TE   (SF).
  4396     ADD PA-BA   (SC) TO PA-BA   (SF).
  4397     ADD PA-NTE  (SC) TO PA-NTE  (SF).
  4398     ADD PA-NBA  (SC) TO PA-NBA  (SF).
  4399     ADD PA-EC   (SC) TO PA-EC   (SF).
  4400     ADD PA-GARC (SC) TO PA-GARC (SF).
  4401     ADD PA-GAEC (SC) TO PA-GAEC (SF).
  4402     ADD PA-GACU (SC) TO PA-GACU (SF).
  4403     ADD PA-CU   (SC) TO PA-CU   (SF).
  4404     ADD PA-GATC (SC) TO PA-GATC (SF).
  4405     ADD PA-GAGT (SC) TO PA-GAGT (SF).
  4406     ADD PA-GABA (SC) TO PA-GABA (SF).
  4407     ADD PA-GATE (SC) TO PA-GATE (SF).
  4408     ADD PA-TAXP (SC) TO PA-TAXP (SF).
  4409     ADD PA-TAXE (SC) TO PA-TAXE (SF).
  4410     ADD PA-ACCT-COMMP (SC) TO PA-ACCT-COMMP (SF).
  4411     ADD PA-ACCT-COMME (SC) TO PA-ACCT-COMME (SF).
  4412     ADD PA-OW-COMMP (SC) TO PA-OW-COMMP (SF).
  4413     ADD PA-OW-COMME (SC) TO PA-OW-COMME (SF).
  4414     ADD PA-CSO-ADMINP (SC) TO PA-CSO-ADMINP (SF).
  4415     ADD PA-CSO-ADMINE (SC) TO PA-CSO-ADMINE (SF).
  4416     ADD PA-CCC-ADMINP (SC) TO PA-CCC-ADMINP (SF).
  4417     ADD PA-CCC-ADMINE (SC) TO PA-CCC-ADMINE (SF).
  4418     ADD PA-TOT-CLPP (SC) TO PA-TOT-CLPP (SF).
  4419     ADD PA-TOT-CLPE (SC) TO PA-TOT-CLPE (SF).
  4420
  4421 0530-ADD-UP-LEVELS.
  4422     PERFORM 0520-ADD-PA-LEVELS.
  4423     ADD +1 TO SC
  4424               SF.
  4425
  4426 0540-EXIT.
  4427     EXIT.
  4428
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* DCC043RET.cbl
  4430 0550-ZERO-DA.
  4431     MOVE +0 TO DA-ISP (SA)  DA-CNP (SA)  DA-UP (SA)   DA-UC (SA)
  4432                DA-TAX (SA)
  4433                DA-CLM (SA)  DA-EXP (SA)  DA-CPS (SA)  DA-OTC (SA)
  4434                DA-LRV (SA)  DA-CAJ (SA)  DA-ISC (SA)  DA-CNC (SA)
  4435                DA-ISC-ADDL (SA) DA-CNC-ADDL (SA) DA-UC-ADDL (SA)
  4436                DA-GA-ISC (SA)   DA-GA-CNC (SA)   DA-GA-UC (SA)
  4437                DA-PCT-E-PREM (SA).
  4438     MOVE +0 TO DA-CSO-ADMIN (SA) DA-CCC-ADMIN (SA)
  4439                DA-CSO-ADM-UC (SA).
  4440
  4441 0560-ZERO-PA.
  4442     MOVE +0 TO PA-NW (SB)  PA-BR (SB) PA-ER (SB)  PA-EP (SB)
  4443                PA-PE (SB)  PA-PL (SB) PA-BLR (SB) PA-ELR (SB)
  4444                PA-TL (SB)  PA-RC (SB) PA-OC (SB)  PA-TC (SB)
  4445                PA-CP (SB)  PA-EX (SB) PA-TE (SB)  PA-BA (SB)
  4446                PA-NTE (SB) PA-NBA (SB)   PA-EC (SB)
  4447                PA-GARC (SB)  PA-GAEC (SB)  PA-GACU (SB)
  4448                PA-GATC (SB)  PA-GAGT (SB)  PA-GABA (SB)
  4449                PA-GATE (SB)  PA-CU (SB).
  4450     MOVE +0 TO PA-TAXP (SB)  PA-TAXE (SB).
  4451     MOVE +0 TO PA-ACCT-COMMP (SB)  PA-ACCT-COMME (SB)
  4452                PA-OW-COMMP (SB)  PA-OW-COMME (SB)
  4453                PA-CSO-ADMINP (SB) PA-CSO-ADMINE (SB)
  4454                PA-CCC-ADMINP (SB) PA-CCC-ADMINE (SB)
  4455                PA-TOT-CLPP (SB)  PA-TOT-CLPE (SB).
  4456
  4457 0570-ZERO-XDA.
  4458
  4459     PERFORM 0575-ZERO-XDA VARYING SA FROM 1 BY 1
  4460                           UNTIL SA GREATER THAN 4.
  4461
  4462 0575-ZERO-XDA.
  4463
  4464     MOVE SPACES                 TO  XDA-GA-NO (CL)
  4465                                     XDA-GA-TYPE (CL).
  4466     MOVE ZEROS                  TO  XDA-GA-ISC (CL SA)
  4467                                     XDA-GA-CNC (CL SA)
  4468                                     XDA-GA-UC  (CL SA).
  4469
  4470 0580-ZERO-PCNT.
  4471     MOVE +0 TO PT-PRCNT (SB SC).
  4472
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* DCC043RET.cbl
  4474 0590-HEADING-ROUTINE.
  4475     IF DTE-PGM-OPT = '1'
  4476         AND H1-REPORT-SUF NOT = 'A'
  4477     OR DTE-PGM-OPT = '2'
  4478         AND H1-REPORT-SUF NOT = 'B'
  4479     OR DTE-PGM-OPT = '3'
  4480         AND H1-REPORT-SUF NOT = 'C'
  4481             GO TO 0600-EXIT.
  4482
  4483     IF DTE-PGM-OPT = ('5' OR '6' OR '7') AND
  4484        H1-REPORT-SUF NOT = ('A' AND 'B')
  4485        GO TO 0600-EXIT.
  4486
  4487     MOVE '1'    TO X.
  4488     MOVE HEAD-1 TO P-DATA.
  4489     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4490     MOVE ' '    TO X.
  4491     MOVE HEAD-2 TO P-DATA.
  4492     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4493     ADD +1               TO PAGE-CNT.
  4494     MOVE PAGE-CNT        TO H3-PAGE.
  4495     MOVE HEAD-3 TO P-DATA.
  4496     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4497
  4498     IF HEAD-SW = '1' OR '2'
  4499         MOVE '0'    TO X
  4500         MOVE HEAD-4 TO P-DATA
  4501         PERFORM 0610-PRT-RTN THRU 0630-EXIT
  4502         MOVE ' '    TO X
  4503         MOVE HEAD-5 TO P-DATA
  4504         PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4505
  4506     MOVE '0' TO X.
  4507     IF DTE-PGM-OPT = '7'
  4508         IF HEAD-SW NOT = '1' AND '2'
  4509             MOVE '* CONTRACT TO DATE *' TO H6-YTD-HD
  4510         ELSE
  4511             MOVE BD-MO     TO H6R-MO
  4512             MOVE BD-DA     TO H6R-DA
  4513             MOVE BD-CCYY   TO H6R-CCYY
  4514             MOVE '-'       TO H6R-DASH1 H6R-DASH2
  4515             MOVE ' TO DATE '       TO H6R-MSG
  4516             MOVE ' '       TO H6R-FILLER.
  4517
  4518     MOVE HEAD-6 TO P-DATA.
  4519     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4520     MOVE ' '    TO X.
  4521     MOVE HEAD-7 TO P-DATA.
  4522     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  4523     MOVE '0'    TO X.
  4524
  4525 0600-EXIT.
  4526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* DCC043RET.cbl
  4528
  4529 0610-PRT-RTN.
  4530****  THE FOLLOWING CLIENT CODING SUPPRESSES DATE BREAKS ON '43A'.
  4531
  4532     IF (DTE-FMT-OPT  =  2)        AND
  4533        (BREAK-1-SWITCH NOT = ' ')   AND
  4534        (H1-REPORT-SUF = 'A')
  4535             MOVE SPACES TO P-DATA  DETAIL-LINE
  4536             GO TO 0630-EXIT.
  4537
  4538 0620-PRT-REST.
  4539*                            COPY ELCPRT2.
* 4540                             COPY PRTN043.
  4541******************************************************************
  4542*                                                                *
  4543*  THIS IS A CSO VERSION OF COPYBOOK ELCPRTN TO ALLOW INDIVIDUAL *
  4544*  CHANGES FOR DELETING PAPER PRINT OF ECS043A.     (CSOMOD #759)*
  4545*  ALL REPORTS WILL STILL GO TO FICH.                            *
  4546*                                                                *
  4547******************************************************************
  4548*                                                                *
  4549*                            ELCPRTN                             *
  4550*                            VMOD=2.002                          *
  4551*                                                                *
  4552******************************************************************
  4553*                   C H A N G E   L O G
  4554*
  4555* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4556*-----------------------------------------------------------------
  4557*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4558* EFFECTIVE    NUMBER
  4559*-----------------------------------------------------------------
  4560* 061302    2002061200004  SMVA  REMOVE ECS043B HARDCOPY
  4561******************************************************************
  4562
  4563     IF DTE-FICH NOT = SPACE AND
  4564        FICH-OPEN    = SPACE
  4565         MOVE 'X' TO FICH-OPEN
  4566         OPEN OUTPUT FICH.
  4567
  4568     IF DTE-FICH NOT = SPACE
  4569         MOVE X TO P-CTL
  4570         WRITE FICH-REC FROM PRT.
  4571
  4572     IF H1-REPORT-SUF = 'A' OR 'B' OR 'C'
  4573         GO TO SKIP-A-REPORT.
  4574
  4575     IF DTE-FICH = SPACE OR '2'
  4576       MOVE X                    TO  P-CTL
  4577       IF P-CTL = ' '
  4578         WRITE PRT AFTER ADVANCING 1 LINE
  4579       ELSE
  4580         IF P-CTL = '0'
  4581           WRITE PRT AFTER ADVANCING 2 LINES
  4582         ELSE
  4583           IF P-CTL = '-'
  4584             WRITE PRT AFTER ADVANCING 3 LINES
  4585           ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* DCC043RET.cbl (/apps/prod/cid1p/copy/PRTN043)
  4586             WRITE PRT AFTER ADVANCING PAGE.
  4587
  4588******************************************************************
  4589
  4590******************************************************************
  4591 SKIP-A-REPORT.
  4592     MOVE SPACES TO P-DATA  DETAIL-LINE.
  4593
  4594 0630-EXIT.
  4595     EXIT.
  4596
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* DCC043RET.cbl
  4598 0640-EP-ADD.
  4599     ADD EP-ISS-PRM TO DA-ISP (SA).
  4600     IF EP-PRM-TAX NUMERIC
  4601        ADD EP-PRM-TAX TO DA-TAX (SA).
  4602     ADD EP-CNC-PRM TO DA-CNP (SA).
  4603     ADD EP-CLM-AMT TO DA-CLM (SA).
  4604     ADD EP-CLM-DU TO DA-LRV (SA).
  4605
  4606     IF DTE-CLIENT NOT = 'ABL'
  4607         ADD EP-CLM-IBNR TO DA-LRV (SA).
  4608
  4609     ADD EP-LOSS-RESV TO DA-LRV (SA).
  4610     ADD EP-CLAIM-ADJ TO DA-CAJ (SA).
  4611
  4612     IF DTE-CLIENT = 'ABL'
  4613         ADD EP-CLAIM-ADJ TO DA-CLM (SA).
  4614
  4615*    PERFORM 0650-EP-EARN-TYPE THRU 0680-EXIT.
  4616
  4617     MOVE DA-UP (SA) TO SAVE-DA-UP.
  4618     MOVE 0                    TO SAVE-DA-PCT-UP.
  4619
  4620     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4621         COMPUTE SAVE-DA-PCT-UP =
  4622                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78)
  4623         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4624                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-78).
  4625
  4626     IF WS-EP-CODE = 'P'
  4627         COMPUTE SAVE-DA-PCT-UP =
  4628                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR)
  4629         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4630                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-PR).
  4631
  4632     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4633         COMPUTE SAVE-DA-PCT-UP =
  4634                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST)
  4635         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4636                       ((EP-ISS-PRM - EP-CNC-PRM) - EP-PRM-ST).
  4637
  4638     IF WS-EP-CODE = 'M'
  4639         COMPUTE SAVE-DA-PCT-UP =
  4640             ((EP-ISS-PRM - EP-CNC-PRM) -
  4641               ((EP-PRM-PR + EP-PRM-78) * .5))
  4642         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4643             ((EP-ISS-PRM - EP-CNC-PRM) -
  4644               ((EP-PRM-PR + EP-PRM-78) * .5)).
  4645
  4646     IF WS-EP-CODE = '1'
  4647         COMPUTE SAVE-DA-PCT-UP =
  4648             ((EP-ISS-PRM - EP-CNC-PRM) -
  4649              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333)))
  4650         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4651             ((EP-ISS-PRM - EP-CNC-PRM) -
  4652              ((EP-PRM-PR * +.6667) + (EP-PRM-78 * +.3333))).
  4653
  4654     IF WS-EP-CODE = '2'
  4655         COMPUTE SAVE-DA-PCT-UP =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* DCC043RET.cbl
  4656             ((EP-ISS-PRM - EP-CNC-PRM) -
  4657              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20)))
  4658         COMPUTE DA-UP (SA) = DA-UP (SA) +
  4659             ((EP-ISS-PRM - EP-CNC-PRM) -
  4660              ((EP-PRM-PR * +.80) + (EP-PRM-78 * +.20))).
  4661
  4662     IF AM-RETRO-PREM-P-E = 'E'
  4663         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4664             (EP-ISS-PRM - EP-CNC-PRM - SAVE-DA-PCT-UP)
  4665                                                 * RETENT-FACT
  4666     ELSE
  4667         COMPUTE SAVE-DA-PCT-E-PREM  ROUNDED  =
  4668                       (EP-ISS-PRM - EP-CNC-PRM) * RETENT-FACT.
  4669
  4670     ADD SAVE-DA-PCT-E-PREM      TO DA-PCT-E-PREM (SA).
  4671
  4672 0640-EXIT.
  4673     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* DCC043RET.cbl
  4675
  4676 0650-EP-EARN-TYPE.
  4677     MOVE CLAS-STARTS TO CLAS-INDEXS.
  4678
  4679 0652-ST-LOOK-UP.
  4680     IF AM-STATE = STATE-SUB (CLAS-INDEXS)
  4681         NEXT SENTENCE
  4682      ELSE
  4683          ADD +1 TO CLAS-INDEXS
  4684          IF CLAS-INDEXS NOT GREATER CLAS-MAXS
  4685              GO TO 0652-ST-LOOK-UP
  4686           ELSE
  4687             DISPLAY ' INVALID STATE CODE -' AM-STATE
  4688             MOVE    ' INVALID STATE CODE -' TO WS-ABEND-MESSAGE
  4689             MOVE 0402      TO WS-RETURN-CODE
  4690             GO TO ABEND-PGM.
  4691
  4692     IF EP-RCD-TYPE = AH-OVERRIDE-L1
  4693         MOVE CLAS-STARTA TO CLAS-INDEXA
  4694         GO TO 0670-EP-EARN-AH.
  4695
  4696     MOVE CLAS-STARTL TO CLAS-INDEXL.
  4697
  4698 0660-EP-EARN-TYPE-LOOP.
  4699     IF (CLAS-INDEXL GREATER CLAS-MAXL) OR (CLAS-INDEXL = ZERO)
  4700         DISPLAY ' INVALID LIFE BENEFIT TYPE -' EP-BEN-CODE
  4701         MOVE ' INVALID LIFE BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4702         MOVE 0401            TO WS-RETURN-CODE
  4703         GO TO ABEND-PGM.
  4704
  4705     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXL)
  4706         ADD +1 TO CLAS-INDEXL
  4707         GO TO 0660-EP-EARN-TYPE-LOOP.
  4708
  4709     MOVE CLAS-I-EP (CLAS-INDEXL) TO WS-EP-CODE.
  4710
  4711     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4712          MOVE 'P' TO WS-EP-CODE.
  4713
  4714     IF DTE-CLIENT = 'ITG'
  4715          MOVE 'P' TO WS-EP-CODE.
  4716
  4717     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4718       AND (AM-RET-EARN-R NOT = SPACE AND ZERO)
  4719           MOVE AM-RET-EARN-R TO WS-EP-CODE.
  4720     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4721       AND (AM-RET-EARN-L NOT = SPACE AND ZERO)
  4722           MOVE AM-RET-EARN-L TO WS-EP-CODE.
  4723
  4724     MOVE CLAS-I-BAL (CLAS-INDEXL) TO WS-OB-CODE.
  4725
  4726     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  4727       AND (SA = 1 OR 2)
  4728       AND (AM-RET-BEG-EARN-R NOT = SPACE AND ZERO)
  4729           MOVE AM-RET-BEG-EARN-R TO WS-EP-CODE.
  4730
  4731     IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')
  4732       AND (SA = 1 OR 2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* DCC043RET.cbl
  4733       AND (AM-RET-BEG-EARN-L NOT = SPACE AND ZERO)
  4734           MOVE AM-RET-BEG-EARN-L TO WS-EP-CODE.
  4735
  4736     GO TO 0680-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* DCC043RET.cbl
  4738
  4739 0670-EP-EARN-AH.
  4740     IF (CLAS-INDEXA GREATER CLAS-MAXA) OR (CLAS-INDEXA = ZERO)
  4741         DISPLAY ' INVALID A&H BENEFIT TYPE -' EP-BEN-CODE
  4742         MOVE    ' INVALID A&H BENEFIT TYPE -' TO WS-ABEND-MESSAGE
  4743         MOVE 0402         TO WS-RETURN-CODE
  4744         GO TO ABEND-PGM.
  4745
  4746     IF EP-BEN-CODE NOT = CLAS-I-BEN (CLAS-INDEXA)
  4747         ADD +1 TO CLAS-INDEXA
  4748         GO TO 0670-EP-EARN-AH.
  4749
  4750     MOVE CLAS-I-EP (CLAS-INDEXA) TO WS-EP-CODE.
  4751
  4752     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  4753          MOVE 'P' TO WS-EP-CODE.
  4754
  4755     IF DTE-CLIENT = 'ITG'
  4756          MOVE 'P' TO WS-EP-CODE.
  4757
  4758     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4759       AND (AM-RET-EARN-A NOT = SPACE AND ZERO)
  4760           MOVE AM-RET-EARN-A TO WS-EP-CODE.
  4761
  4762     IF CLAS-I-RL-AH (CLAS-INDEXA) = 'A'
  4763       AND (SA = 1 OR 2)
  4764       AND (AM-RET-BEG-EARN-A NOT = SPACE AND ZERO)
  4765           MOVE AM-RET-BEG-EARN-A TO WS-EP-CODE.
  4766
  4767     IF DTE-CLIENT = 'ITY'
  4768         IF EP-CARRIER = '5' OR '7'
  4769              MOVE '1' TO WS-EP-CODE.
  4770
  4771     IF DTE-CLIENT = 'GIC'
  4772         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4773              MOVE '2' TO WS-EP-CODE.
  4774
  4775     IF DTE-CLIENT = 'AN1' OR 'TFS' OR 'NIS' OR
  4776                     'UW1' OR 'DDB' OR 'GSL'
  4777         MOVE 'M'                  TO WS-EP-CODE.
  4778
  4779     MOVE CLAS-I-BAL (CLAS-INDEXA) TO WS-OB-CODE.
  4780
  4781 0680-EXIT.
  4782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* DCC043RET.cbl
  4784
  4785 0690-EC-ADD.
  4786     PERFORM 0700-ACCT-EC-ADD  THRU 0710-EXIT
  4787         VARYING CL FROM 1 BY 1 UNTIL CL GREATER THAN +5.
  4788
  4789     GO TO 0729-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* DCC043RET.cbl
  4791
  4792 0700-ACCT-EC-ADD.
  4793******************************************************************
  4794*         CL - AGENT LEVEL WITHIN EC RECORD
  4795*         AL - AGENT LEVEL WITHIN GA TABLE
  4796*         SA - BEGINNING / CURRENT   LIFE/AH INDICATOR
  4797******************************************************************
  4798
  4799     IF EC-AGT-NO (CL) = ZEROS
  4800         GO TO 0710-EXIT.
  4801
  4802     IF EC-SEQ-NBR GREATER THAN 1
  4803         MOVE EC-SEQ-NBR         TO  WS-SEQ-NBR
  4804         SUBTRACT +1 FROM WS-SEQ-NBR
  4805         COMPUTE AL = WS-SEQ-NBR * 5.
  4806
  4807     PERFORM 0725-CHECK-AM-RETRO  THRU  0725-EXIT.
  4808
  4809     IF WS-RETRO-FLAG = 'N'
  4810        GO TO 0710-EXIT.
  4811
  4812     MOVE +1                     TO  AL.
  4813
  4814 0700-LOOP.
  4815
  4816     IF EC-AGT-NO (CL) = XDA-GA-NO (AL)
  4817         GO TO 0705-ACCUM.
  4818
  4819     IF XDA-GA-NO (AL) = SPACES
  4820         MOVE EC-AGT-NO (CL)     TO  XDA-GA-NO (AL)
  4821         MOVE EC-AGT-TYPE (CL)   TO  XDA-GA-TYPE (AL)
  4822         GO TO 0705-ACCUM.
  4823
  4824     ADD +1 TO AL.
  4825
  4826     IF AL GREATER THAN EC-REC-MAX
  4827         MOVE 'NO OF EC RECORDS EXCEED TABLE LIMIT'
  4828                                 TO  WS-ABEND-MESSAGE
  4829         GO TO ABEND-PGM.
  4830
  4831     GO TO 0700-LOOP.
  4832
  4833 0705-ACCUM.
  4834
  4835     IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4836         ADD EC-ISS-COMM (CL) TO DA-ISC (SA)
  4837         ADD EC-CNC-COMM (CL) TO DA-CNC (SA).
  4838
  4839     IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4840         ADD EC-ISS-COMM (CL) TO XDA-GA-ISC (AL SA)
  4841         ADD EC-CNC-COMM (CL) TO XDA-GA-CNC (AL SA)
  4842*02281        IF AM-RETRO-LV-INDIC (AL) = 'A'
  4843       IF WS-RETRO-FLAG = 'A'
  4844         IF EC-AGT-TYPE (CL) = 'S'
  4845            COMPUTE DA-CSO-ADMIN (SA) = DA-CSO-ADMIN (SA) +
  4846               (EC-ISS-COMM (CL) - EC-CNC-COMM (CL))
  4847         ELSE
  4848           ADD EC-ISS-COMM (CL) TO DA-GA-ISC (SA)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* DCC043RET.cbl
  4849           ADD EC-CNC-COMM (CL) TO DA-GA-CNC (SA)
  4850           ADD EC-ISS-COMM (CL) TO DA-ISC-ADDL (SA)
  4851           ADD EC-CNC-COMM (CL) TO DA-CNC-ADDL (SA).
  4852
  4853*    MOVE DA-UC (SA) TO SAVE-DA-UC.
  4854*    MOVE XDA-GA-UC (SA AL) TO SAVE-DA-GA-UC.
  4855
  4856     IF WS-EP-CODE = 'R' OR 'N' OR 'U' OR 'A' OR 'T'
  4857        IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4858         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4859             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4860              EC-COMM-78 (CL))
  4861        ELSE
  4862         IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4863          COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4864             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4865              EC-COMM-78 (CL))
  4866*02298             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4867            IF WS-RETRO-FLAG = 'A'
  4868               IF EC-AGT-TYPE (CL) = 'S'
  4869                  COMPUTE DA-CSO-ADM-UC (SA) =
  4870                          DA-CSO-ADM-UC (SA) +
  4871                     ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4872                        EC-COMM-78 (CL))
  4873               ELSE
  4874               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4875                  ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4876                    EC-COMM-78 (CL)).
  4877
  4878     IF WS-EP-CODE = 'P'
  4879       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4880         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4881             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4882              EC-COMM-PR (CL))
  4883       ELSE
  4884        IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4885         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4886             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4887              EC-COMM-PR (CL))
  4888*02313             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4889            IF WS-RETRO-FLAG = 'A'
  4890               IF EC-AGT-TYPE (CL) = 'S'
  4891                  COMPUTE DA-CSO-ADM-UC (SA) =
  4892                          DA-CSO-ADM-UC (SA) +
  4893                     ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4894                        EC-COMM-PR (CL))
  4895               ELSE
  4896               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4897                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4898                  EC-COMM-PR (CL)).
  4899
  4900     IF (WS-EP-CODE = 'B' OR 'K' OR 'L')
  4901       IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4902         COMPUTE DA-UC (SA) = DA-UC (SA) +
  4903             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4904              EC-COMM-ST (CL))
  4905       ELSE
  4906        IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* DCC043RET.cbl
  4907         COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4908             ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4909              EC-COMM-ST (CL))
  4910*02328             IF AM-RETRO-LV-INDIC (AL) = 'A'
  4911            IF WS-RETRO-FLAG = 'A'
  4912               IF EC-AGT-TYPE (CL) = 'S'
  4913                  COMPUTE DA-CSO-ADM-UC (SA) =
  4914                          DA-CSO-ADM-UC (SA) +
  4915                     ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4916                        EC-COMM-ST (CL))
  4917               ELSE
  4918               COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4919                ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4920                  EC-COMM-ST (CL)).
  4921
  4922     IF WS-EP-CODE = 'M'
  4923         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4924                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4925                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4926                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4927          ELSE
  4928           IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4929                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4930                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4931                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4932*02343                IF AM-RETRO-LV-INDIC (AL) = 'A'
  4933               IF WS-RETRO-FLAG = 'A'
  4934                IF EC-AGT-TYPE (CL) = 'S'
  4935                  COMPUTE DA-CSO-ADM-UC (SA) =
  4936                          DA-CSO-ADM-UC (SA) +
  4937                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4938                     ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5))
  4939                ELSE
  4940                   COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4941                    ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4942                      ((EC-COMM-PR (CL) + EC-COMM-78 (CL)) * .5)).
  4943
  4944     IF WS-EP-CODE = '1'
  4945         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4946                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4947                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4948                      ((EC-COMM-PR (CL) * +.6667) +
  4949                       (EC-COMM-78 (CL) * +.3333)))
  4950         ELSE
  4951             IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4952                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4953                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4954                      ((EC-COMM-PR (CL) * +.6667) +
  4955                       (EC-COMM-78 (CL) * +.3333)))
  4956*02360                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4957                 IF WS-RETRO-FLAG = 'A'
  4958                  IF EC-AGT-TYPE (CL) = 'S'
  4959                    COMPUTE DA-CSO-ADM-UC (SA) =
  4960                          DA-CSO-ADM-UC (SA) +
  4961                     ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4962                     ((EC-COMM-PR (CL) * +.6667) +
  4963                       (EC-COMM-78 (CL) * +.3333)))
  4964                    ELSE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* DCC043RET.cbl
  4965                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4966                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4967                      ((EC-COMM-PR (CL) * +.6667) +
  4968                       (EC-COMM-78 (CL) * +.3333))).
  4969
  4970     IF WS-EP-CODE = '2'
  4971         IF EC-AGT-TYPE (CL) = 'C' OR 'D'
  4972                 COMPUTE DA-UC (SA) = DA-UC (SA) +
  4973                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4974                      ((EC-COMM-PR (CL) * +.80) +
  4975                       (EC-COMM-78 (CL) * +.20)))
  4976         ELSE
  4977             IF EC-AGT-TYPE (CL) = 'O' OR 'P' OR 'S'
  4978                 COMPUTE XDA-GA-UC (AL SA) = XDA-GA-UC (AL SA) +
  4979                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4980                      ((EC-COMM-PR (CL) * +.80) +
  4981                       (EC-COMM-78 (CL) * +.20)))
  4982*02378                  IF AM-RETRO-LV-INDIC (AL) = 'A'
  4983                 IF WS-RETRO-FLAG = 'A'
  4984                  IF EC-AGT-TYPE (CL) = 'S'
  4985                    COMPUTE DA-CSO-ADM-UC (SA) =
  4986                          DA-CSO-ADM-UC (SA) +
  4987                     ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4988                     ((EC-COMM-PR (CL) * +.80) +
  4989                       (EC-COMM-78 (CL) * +.20)))
  4990                    ELSE
  4991                     COMPUTE DA-UC-ADDL (SA) = DA-UC-ADDL (SA) +
  4992                      ((EC-ISS-COMM (CL) - EC-CNC-COMM (CL)) -
  4993                      ((EC-COMM-PR (CL) * +.80) +
  4994                       (EC-COMM-78 (CL) * +.20))).
  4995
  4996 0710-EXIT.
  4997     EXIT.
  4998
  4999 0725-CHECK-AM-RETRO.
  5000
  5001     MOVE SPACE                  TO  WS-RETRO-FLAG.
  5002
  5003     PERFORM 0725-CHECK-LOOP VARYING AN FROM 1 BY 1
  5004                             UNTIL AN GREATER THAN 10.
  5005 0725-CHECK-LOOP.
  5006
  5007     IF EC-AGT-NO (CL) = AM-AGT (AN)
  5008         MOVE AM-RETRO-LV-INDIC (AN)
  5009                                 TO  WS-RETRO-FLAG
  5010         MOVE +11                TO  AN.
  5011
  5012 0725-EXIT.
  5013     EXIT.
  5014
  5015 0729-EXIT.
  5016     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* DCC043RET.cbl
  5018
  5019 0730-RETURN-SORTED-FILE.
  5020
  5021     IF SW-CTL NOT = HIGH-VALUES
  5022         RETURN SORT-WORK  INTO  SW-REC
  5023                    AT END MOVE HIGH-VALUES TO SW-RPT-TYPE-ID
  5024                                               SW-CTL.
  5025 0730-EXIT.
  5026     EXIT.
  5027
  5028 0740-MOVE-SW-REC.
  5029     IF SW-RPT-TYPE-ID = 'C'
  5030         IF DTE-CLIENT = 'LBL'
  5031             MOVE 'E'            TO SW-RET-TYP.
  5032
  5033     MOVE SW-NAME                TO H1-NAME.
  5034     MOVE SW-ADDRS               TO H2-ADDR.
  5035     MOVE SW-CITY                TO H3-ADDR.
  5036
  5037     IF  SW-CANADIAN-POST-CODE
  5038         MOVE SW-CAN-POST-CODE-1 TO H3-CAN-POSTAL-CODE-1
  5039         MOVE SW-CAN-POST-CODE-2 TO H3-CAN-POSTAL-CODE-2
  5040         MOVE SPACES             TO H3-DASH-CAN
  5041                                    H3-CAN-FILLER
  5042
  5043     ELSE
  5044         MOVE SW-ZIP-PRIME       TO H3-ZIP-PRIME
  5045
  5046         IF  SW-ZIP-PLUS4 = SPACES OR ZEROS
  5047             MOVE SPACES         TO H3-ZIP-PLUS4 H3-DASH
  5048
  5049         ELSE
  5050             MOVE SW-ZIP-PLUS4   TO H3-ZIP-PLUS4
  5051             MOVE '-'            TO H3-DASH.
  5052
  5053     MOVE SW-CARR                TO H5-CARR.
  5054     MOVE SW-COMP                TO H5-COMP.
  5055     MOVE SW-STATE               TO H5-ST.
  5056     MOVE SW-ACCT                TO H5-ACCT.
  5057     MOVE '-'                    TO H5-FS1 H5-FS2 H5-TS1 H5-TS2.
  5058     MOVE SW-EFF-DT              TO WORK-DATE.
  5059     MOVE WK-MO                  TO H5-FMO.
  5060     MOVE WK-DA                  TO H5-FDA.
  5061     MOVE WK-YR                  TO H5-FYR.
  5062     MOVE SW-EXP-DT              TO WORK-DATE.
  5063     MOVE WK-MO                  TO H5-TMO.
  5064     MOVE WK-DA                  TO H5-TDA.
  5065     MOVE WK-YR                  TO H5-TYR.
  5066     MOVE SW-ACCUMS              TO PRINT-ACCUMS-R (1).
  5067     MOVE SW-CTL                 TO WS-SAVE-CTL.
  5068     MOVE SW-GA-FLAG             TO SAVE-GA-FLAG.
  5069     MOVE SW-RET-Y-N             TO SAVE-RET-Y-N.
  5070     MOVE SW-RET-TYP             TO SAVE-RET-TYP.
  5071     MOVE SW-LRET                TO LIFE-RETENT.
  5072     MOVE SW-ARET                TO AH-RETENT.
  5073     MOVE SW-RETRO-LIMIT         TO SAVE-RETRO-LIMIT.
  5074     MOVE SW-PREM-P-E            TO SAVE-PREM-P-E.
  5075     MOVE SW-CLMS-P-I            TO SAVE-CLMS-P-I.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* DCC043RET.cbl
  5076     MOVE SW-BEG-DATE            TO BEG-DATE.
  5077
  5078*****rpt type a = rpt 43a,  b = rpt 43b
  5079     IF SW-RPT-TYPE-ID = 'A' AND
  5080       (FC-CODE = '1' OR '5' OR '6')
  5081         MOVE RD-MO    TO DO-ME-MO
  5082         MOVE RD-DA    TO DO-ME-DD
  5083         MOVE RD-CCYY  TO DO-ME-YR
  5084         MOVE SW-CARR  TO DO-CARRIER
  5085         MOVE SW-COMP  TO DO-COMP
  5086         MOVE SW-STATE TO DO-STATE
  5087         MOVE SW-ACCT  TO DO-ACCOUNT-NUM
  5088         MOVE SW-EXP-DT TO WORK-DATE
  5089         MOVE WK-CCYY  TO DO-EXP-YR
  5090         MOVE WK-MO    TO DO-EXP-MO
  5091         MOVE WK-DA    TO DO-EXP-DD
  5092         IF DO-EXP-MO = 99
  5093             MOVE 12   TO DO-EXP-MO
  5094             MOVE 31   TO DO-EXP-DD
  5095         END-IF
  5096         MOVE SW-EFF-DT TO WORK-DATE
  5097         MOVE WK-CCYY  TO DO-EFF-YR
  5098         MOVE WK-MO    TO DO-EFF-MO
  5099         MOVE WK-DA    TO DO-EFF-DD
  5100         IF SW-RETRO-POOL < SPACES
  5101             MOVE SPACES TO DO-GROUP
  5102         ELSE
  5103             MOVE SW-RETRO-POOL TO DO-GROUP
  5104         END-IF
  5105         MOVE SW-NAME  TO DO-ACCOUNT-NAME
  5106         MOVE SW-PREM-P-E TO DO-PREM-P-E
  5107         MOVE SW-CLMS-P-I TO DO-CLAIM-P-I
  5108         IF SW-RET-Y-N EQUAL LOW-VALUES
  5109            MOVE SPACES TO DO-RETRO-Y-N
  5110         ELSE
  5111            MOVE SW-RET-Y-N  TO DO-RETRO-Y-N
  5112         END-IF
  5113         MOVE SW-RET-TYP  TO DO-RETRO-P-E
  5114         MOVE SW-TAX-P-E  TO DO-TAX-P-E
  5115*         MOVE SW-LRET     TO DO-LIFE-RETENT
  5116*         MOVE SW-ARET     TO DO-AH-RETENT
  5117         IF FC-CODE = '1'
  5118             MOVE 'YTD'   TO DO-PERIOD
  5119         ELSE
  5120             IF FC-CODE = '5'
  5121                 MOVE 'L12'   TO DO-PERIOD
  5122             ELSE
  5123                 MOVE 'CUR'   TO DO-PERIOD
  5124             END-IF
  5125         END-IF
  5126      END-IF.
  5127
  5128     IF SW-RPT-TYPE-ID = 'A' OR 'B'
  5129         MOVE 'GROUP'            TO H4-GROUP
  5130         MOVE SW-GA              TO H5-GROUP.
  5131
  5132     MOVE SW-GA                  TO ZONE-GROUP.
  5133
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* DCC043RET.cbl
  5134     IF SW-RPT-TYPE-ID = 'B' AND ZON = 'ZON'
  5135         MOVE '  ZONE'           TO H4-GROUP
  5136         INSPECT H5-GROUP CONVERTING 'ZON' TO '   '.
  5137
  5138     IF SW-RPT-TYPE-ID = 'C'
  5139         MOVE ' G.A.'            TO H4-GROUP
  5140         MOVE SW-GA              TO H5-GROUP.
  5141
  5142     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* DCC043RET.cbl
  5144 0745-OUTPUT-PROCEDURE SECTION.
  5145     IF NO-OF-RECORDS-RELEASED = +0
  5146        GO TO 1080-E-O-J.
  5147
  5148 0746-MOVE-OUT-DATA SECTION.
  5149     MOVE 'PREMIUM' TO DO-DESCR(1).
  5150     MOVE PA-AMT (1 1 1) TO DO-PERLFP (1).
  5151     MOVE PA-AMT (1 1 4) TO DO-PERLFE (1).
  5152     MOVE PA-AMT (1 4 1) TO DO-ITDLFP (1).
  5153     MOVE PA-AMT (1 4 4) TO DO-ITDLFE (1).
  5154     MOVE PA-AMT (1 2 1) TO DO-PERAHP (1).
  5155     MOVE PA-AMT (1 2 4) TO DO-PERAHE (1).
  5156     MOVE PA-AMT (1 5 1) TO DO-ITDAHP (1).
  5157     MOVE PA-AMT (1 5 4) TO DO-ITDAHE (1).
  5158     MOVE 'BEG PREM RESERVE' TO DO-DESCR (2).
  5159     MOVE +0             TO DO-PERLFP (2).
  5160     MOVE PA-AMT (1 1 2) TO DO-PERLFE (2).
  5161     MOVE +0             TO DO-ITDLFP (2).
  5162     MOVE PA-AMT (1 4 2) TO DO-ITDLFE (2).
  5163     MOVE +0             TO DO-PERAHP (2).
  5164     MOVE PA-AMT (1 2 2) TO DO-PERAHE (2).
  5165     MOVE +0             TO DO-ITDAHP (2).
  5166     MOVE PA-AMT (1 5 2) TO DO-ITDAHE (2).
  5167     MOVE 'END PREM RESERVE' TO DO-DESCR (3).
  5168     MOVE +0             TO DO-PERLFP (3).
  5169     MOVE PA-AMT (1 1 3) TO DO-PERLFE (3).
  5170     MOVE +0             TO DO-ITDLFP (3).
  5171     MOVE PA-AMT (1 4 3) TO DO-ITDLFE (3).
  5172     MOVE +0             TO DO-PERAHP (3).
  5173     MOVE PA-AMT (1 2 3) TO DO-PERAHE (3).
  5174     MOVE +0             TO DO-ITDAHP (3).
  5175     MOVE PA-AMT (1 5 3) TO DO-ITDAHE (3).
  5176     MOVE 'ACCOUNT COMMISSION' TO DO-DESCR (4).
  5177     MOVE PA-AMT (1 1 30) TO DO-PERLFP (4).
  5178     MOVE PA-AMT (1 1 31) TO DO-PERLFE (4).
  5179     MOVE PA-AMT (1 4 30) TO DO-ITDLFP (4).
  5180     MOVE PA-AMT (1 4 31) TO DO-ITDLFE (4).
  5181     MOVE PA-AMT (1 2 30) TO DO-PERAHP (4).
  5182     MOVE PA-AMT (1 2 31) TO DO-PERAHE (4).
  5183     MOVE PA-AMT (1 5 30) TO DO-ITDAHP (4).
  5184     MOVE PA-AMT (1 5 31) TO DO-ITDAHE (4).
  5185     MOVE 'OW COMMISSION' TO DO-DESCR (5).
  5186     MOVE PA-AMT (1 1 32) TO DO-PERLFP (5).
  5187     MOVE PA-AMT (1 1 33) TO DO-PERLFE (5).
  5188     MOVE PA-AMT (1 4 32) TO DO-ITDLFP (5).
  5189     MOVE PA-AMT (1 4 33) TO DO-ITDLFE (5).
  5190     MOVE PA-AMT (1 2 32) TO DO-PERAHP (5).
  5191     MOVE PA-AMT (1 2 33) TO DO-PERAHE (5).
  5192     MOVE PA-AMT (1 5 32) TO DO-ITDAHP (5).
  5193     MOVE PA-AMT (1 5 33) TO DO-ITDAHE (5).
  5194     MOVE 'CLAIMS' TO DO-DESCR (6).
  5195     MOVE PA-AMT (1 1 6) TO DO-PERLFP (6).
  5196     MOVE PA-AMT (1 1 9) TO DO-PERLFE (6).
  5197     MOVE PA-AMT (1 4 6) TO DO-ITDLFP (6).
  5198     MOVE PA-AMT (1 4 9) TO DO-ITDLFE (6).
  5199     MOVE PA-AMT (1 2 6) TO DO-PERAHP (6).
  5200     MOVE PA-AMT (1 2 9) TO DO-PERAHE (6).
  5201     MOVE PA-AMT (1 5 6) TO DO-ITDAHP (6).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* DCC043RET.cbl
  5202     MOVE PA-AMT (1 5 9) TO DO-ITDAHE (6).
  5203     MOVE 'BEG CLAIM RESERVE' TO DO-DESCR (7).
  5204     MOVE +0             TO DO-PERLFP (7).
  5205     MOVE PA-AMT (1 1 7) TO DO-PERLFE (7).
  5206     MOVE +0             TO DO-ITDLFP (7).
  5207     MOVE PA-AMT (1 4 7) TO DO-ITDLFE (7).
  5208     MOVE +0             TO DO-PERAHP (7).
  5209     MOVE PA-AMT (1 2 7) TO DO-PERAHE (7).
  5210     MOVE +0             TO DO-ITDAHP (7).
  5211     MOVE PA-AMT (1 5 7) TO DO-ITDAHE (7).
  5212     MOVE 'END CLAIM RESERVE' TO DO-DESCR (8).
  5213     MOVE +0             TO DO-PERLFP (8).
  5214     MOVE PA-AMT (1 1 8) TO DO-PERLFE (8).
  5215     MOVE +0             TO DO-ITDLFP (8).
  5216     MOVE PA-AMT (1 4 8) TO DO-ITDLFE (8).
  5217     MOVE +0             TO DO-PERAHP (8).
  5218     MOVE PA-AMT (1 2 8) TO DO-PERAHE (8).
  5219     MOVE +0             TO DO-ITDAHP (8).
  5220     MOVE PA-AMT (1 5 8) TO DO-ITDAHE (8).
  5221     MOVE 'TAXES'        TO DO-DESCR (9).
  5222     MOVE PA-AMT (1 1 28) TO DO-PERLFP (9).
  5223     MOVE PA-AMT (1 1 29) TO DO-PERLFE (9).
  5224     MOVE PA-AMT (1 4 28) TO DO-ITDLFP (9).
  5225     MOVE PA-AMT (1 4 29) TO DO-ITDLFE (9).
  5226     MOVE PA-AMT (1 2 28) TO DO-PERAHP (9).
  5227     MOVE PA-AMT (1 2 29) TO DO-PERAHE (9).
  5228     MOVE PA-AMT (1 5 28) TO DO-ITDAHP (9).
  5229     MOVE PA-AMT (1 5 29) TO DO-ITDAHE (9).
  5230     MOVE 'CSO ADMIN'     TO DO-DESCR  (10).
  5231     MOVE PA-AMT (1 1 34) TO DO-PERLFP (10).
  5232     MOVE PA-AMT (1 1 35) TO DO-PERLFE (10).
  5233     MOVE PA-AMT (1 4 34) TO DO-ITDLFP (10).
  5234     MOVE PA-AMT (1 4 35) TO DO-ITDLFE (10).
  5235     MOVE PA-AMT (1 2 34) TO DO-PERAHP (10).
  5236     MOVE PA-AMT (1 2 35) TO DO-PERAHE (10).
  5237     MOVE PA-AMT (1 5 34) TO DO-ITDAHP (10).
  5238     MOVE PA-AMT (1 5 35) TO DO-ITDAHE (10).
  5239     MOVE 'CCC ADMIN'     TO DO-DESCR  (11).
  5240     MOVE PA-AMT (1 1 36) TO DO-PERLFP (11).
  5241     MOVE PA-AMT (1 1 37) TO DO-PERLFE (11).
  5242     MOVE PA-AMT (1 4 36) TO DO-ITDLFP (11).
  5243     MOVE PA-AMT (1 4 37) TO DO-ITDLFE (11).
  5244     MOVE PA-AMT (1 2 36) TO DO-PERAHP (11).
  5245     MOVE PA-AMT (1 2 37) TO DO-PERAHE (11).
  5246     MOVE PA-AMT (1 5 36) TO DO-ITDAHP (11).
  5247     MOVE PA-AMT (1 5 37) TO DO-ITDAHE (11).
  5248     MOVE 'CLP'           TO DO-DESCR  (12).
  5249     MOVE PA-AMT (1 1 38) TO DO-PERLFP (12).
  5250     MOVE PA-AMT (1 1 39) TO DO-PERLFE (12).
  5251     MOVE PA-AMT (1 4 38) TO DO-ITDLFP (12).
  5252     MOVE PA-AMT (1 4 39) TO DO-ITDLFE (12).
  5253     MOVE PA-AMT (1 2 38) TO DO-PERAHP (12).
  5254     MOVE PA-AMT (1 2 39) TO DO-PERAHE (12).
  5255     MOVE PA-AMT (1 5 38) TO DO-ITDAHP (12).
  5256     MOVE PA-AMT (1 5 39) TO DO-ITDAHE (12).
  5257     MOVE PA-AMT (1 1 13) TO DO-PER-LF-RETRO-PMT.
  5258     MOVE PA-AMT (1 4 13) TO DO-ITD-LF-RETRO-PMT.
  5259     MOVE PA-AMT (1 2 13) TO DO-PER-AH-RETRO-PMT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* DCC043RET.cbl
  5260     MOVE PA-AMT (1 5 13) TO DO-ITD-AH-RETRO-PMT.
  5261
  5262 0747-EXIT.
  5263     EXIT.
  5264
  5265 0750-PRINT-REPORT SECTION.
  5266     PERFORM 0730-RETURN-SORTED-FILE THRU 0730-EXIT.
  5267
  5268     MOVE SW-RPT-TYPE-ID         TO WS-PREV-RPT-TYPE
  5269
  5270     IF SW-RPT-TYPE-ID = 'B'
  5271         GO TO 0900-PRINT-GROUP-TOTALS.
  5272
  5273     IF SW-RPT-TYPE-ID = 'C'
  5274         GO TO 0990-PRINT-GA-TOTALS.
  5275
  5276     MOVE 'A'    TO H1-REPORT-SUF.
  5277     PERFORM 0740-MOVE-SW-REC.
  5278     MOVE SPACES TO H5-MESSAGE.
  5279
  5280*    IF SW-CARR = WS-SAVE-CAR
  5281*        AND SW-COMP = WS-SAVE-CMP
  5282*        AND SW-STATE = WS-SAVE-ST
  5283*        AND SW-ACCT = WS-SAVE-ACC
  5284*            GO TO 0780-BREAK-1
  5285*    ELSE
  5286*        GO TO 0800-BREAK-2.
  5287
  5288 0760-CHECK-BREAK.
  5289
  5290     IF SW-RPT-TYPE-ID NOT = WS-PREV-RPT-TYPE
  5291        MOVE 'X' TO BREAK-1-SWITCH
  5292        MOVE SW-RPT-TYPE-ID TO WS-PREV-RPT-TYPE
  5293        GO TO 0770-FOR-ONE-A-RECORD
  5294     END-IF
  5295
  5296     IF SW-CARR NOT = WS-SAVE-CAR
  5297         GO TO 0860-BREAK-5.
  5298     IF SW-COMP NOT = WS-SAVE-CMP
  5299         GO TO 0840-BREAK-4.
  5300     IF SW-STATE NOT = WS-SAVE-ST
  5301         GO TO 0820-BREAK-3.
  5302     IF SW-ACCT NOT = WS-SAVE-ACC
  5303         GO TO 0800-BREAK-2.
  5304
  5305     GO TO 0780-BREAK-1.
  5306
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* DCC043RET.cbl
  5308 0770-BREAK-RETURN.
  5309     PERFORM 0740-MOVE-SW-REC.
  5310
  5311 0770-FOR-ONE-A-RECORD.
  5312
  5313     IF SW-CTL = HIGH-VALUES
  5314         PERFORM 0880-BREAK-6
  5315         GO TO 1080-E-O-J
  5316     ELSE
  5317         IF SW-RPT-TYPE-ID = 'B'
  5318             PERFORM 0880-BREAK-6
  5319             GO TO 0900-PRINT-GROUP-TOTALS
  5320         ELSE
  5321             IF SW-RPT-TYPE-ID = 'C'
  5322                 PERFORM 0880-BREAK-6
  5323                 GO TO 0990-PRINT-GA-TOTALS
  5324             ELSE
  5325                 GO TO 0760-CHECK-BREAK.
  5326
  5327 0780-BREAK-1.
  5328     MOVE 'X'            TO BREAK-1-SWITCH.
  5329     MOVE '1'            TO HEAD-SW.
  5330     MOVE 'FROM      TO' TO H4-FT.
  5331     MOVE +1             TO SG.
  5332     MOVE +3             TO SF.
  5333     MOVE +1             TO SH.
  5334
  5335     IF DTE-CLIENT NOT = 'ITG'
  5336         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5337
  5338     IF (FC-CODE = '1' OR '5' OR '6')
  5339         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5340         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5341     END-IF.
  5342
  5343     MOVE +1 TO SC.
  5344     MOVE +7 TO SF.
  5345     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5346     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5347                          UNTIL SB GREATER 6.
  5348
  5349 0790-BREAD-1-EXIT.
  5350     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* DCC043RET.cbl
  5352
  5353 0800-BREAK-2.
  5354     IF BREAK-1-SWITCH NOT = ' '
  5355         PERFORM 0780-BREAK-1
  5356     ELSE
  5357         PERFORM 0746-MOVE-OUT-DATA THRU 0747-EXIT
  5358         IF (FC-CODE = '1' OR '5' OR '6')
  5359             WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5360             PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5361         END-IF
  5362         MOVE +1 TO SC
  5363         MOVE +7 TO SF
  5364         PERFORM 0530-ADD-UP-LEVELS 6 TIMES
  5365         PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5366                              UNTIL SB GREATER 6.
  5367
  5368     MOVE SPACES TO BREAK-1-SWITCH.
  5369     MOVE '2'    TO HEAD-SW.
  5370
  5371     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5372                    H5-TMO  H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5373
  5374     IF FC-CODE = ' '  OR  '5'
  5375         MOVE PA-NW (9)             TO ANNUALIZED-PREM.
  5376     IF FC-CODE = '1'
  5377         COMPUTE ANNUALIZED-PREM = (PA-NW (9) / RD-MO) * 12.
  5378     IF FC-CODE = '2'
  5379         IF RD-MO = 01 OR 04 OR 07 OR 10
  5380             COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12
  5381         ELSE
  5382             IF RD-MO = 02 OR 05 OR 08 OR 11
  5383                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 6
  5384             ELSE
  5385                 COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5386     IF FC-CODE = '3'
  5387         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 4.
  5388     IF FC-CODE = '4'
  5389         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 2.
  5390     IF FC-CODE = '6'
  5391         COMPUTE ANNUALIZED-PREM =  PA-NW (9) * 12.
  5392
  5393     IF ANNUALIZED-PREM GREATER THAN SAVE-RETRO-LIMIT
  5394         MOVE +2   TO SG
  5395         MOVE +9   TO SF
  5396         MOVE +1   TO SH
  5397         PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT
  5398         MOVE +7   TO SC
  5399         MOVE +13  TO SF
  5400         PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5401
  5402     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5403                          UNTIL SB GREATER 12.
  5404
  5405 0810-BREAK-2-EXIT.
  5406     GO TO 0770-BREAK-RETURN.
  5407
  5408 0820-BREAK-3.
  5409     PERFORM 0800-BREAK-2.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* DCC043RET.cbl
  5410     MOVE '3'           TO HEAD-SW.
  5411     MOVE WS-SAVE-ST    TO H8-ST.
  5412     MOVE HEAD-8-STATE  TO H2-ADDR.
  5413     MOVE SPACES        TO H1-NAME  H3-ADDR  H3-ZIP.
  5414     MOVE +3            TO SG.
  5415     MOVE +15           TO SF.
  5416     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5417     MOVE +13           TO SC.
  5418     MOVE +19           TO SF.
  5419     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5420     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5421                          UNTIL SB GREATER 18.
  5422
  5423     MOVE BALANCE-LINE-1 TO WS-BAL-LINE-1.
  5424     MOVE BALANCE-LINE-2 TO WS-BAL-LINE-2.
  5425
  5426 0830-BREAK-3-EXIT.
  5427     GO TO 0770-BREAK-RETURN.
  5428
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* DCC043RET.cbl
  5430 0840-BREAK-4.
  5431     PERFORM 0820-BREAK-3.
  5432     MOVE '4'         TO HEAD-SW.
  5433     MOVE WS-SAVE-CMP TO H8-COMP.
  5434     MOVE HEAD-8-COMP TO H2-ADDR.
  5435     MOVE +4          TO SG.
  5436     MOVE +21         TO SF.
  5437     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5438     MOVE +19         TO SC.
  5439     MOVE +25         TO SF.
  5440     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5441     PERFORM 0560-ZERO-PA VARYING SB FROM 19 BY 1
  5442                          UNTIL SB GREATER 24.
  5443
  5444 0850-BREAK-4-EXIT.
  5445     GO TO 0770-BREAK-RETURN.
  5446
  5447 0860-BREAK-5.
  5448     PERFORM 0840-BREAK-4.
  5449     MOVE '5'         TO HEAD-SW.
  5450     MOVE WS-SAVE-CAR TO H8-CARR.
  5451     MOVE HEAD-8-CARR TO H2-ADDR.
  5452     MOVE +5          TO SG.
  5453     MOVE +27         TO SF.
  5454     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5455     MOVE +25         TO SC.
  5456     MOVE +31         TO SF.
  5457     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5458     PERFORM 0560-ZERO-PA VARYING SB FROM 25 BY 1
  5459                          UNTIL SB GREATER 30.
  5460
  5461 0870-BREAK-5-EXIT.
  5462     GO TO 0770-BREAK-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* DCC043RET.cbl
  5464
  5465 0880-BREAK-6.
  5466     PERFORM 0860-BREAK-5.
  5467     MOVE '6'          TO HEAD-SW.
  5468     MOVE HEAD-8-FINAL TO H2-ADDR.
  5469     MOVE +6           TO SG.
  5470     MOVE +33          TO SF.
  5471     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5472
  5473 0890-BREAK-6-EXIT.
  5474     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* DCC043RET.cbl
  5476
  5477 0900-PRINT-GROUP-TOTALS.
  5478     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5479                          UNTIL SB GREATER 36.
  5480     MOVE 'B' TO H1-REPORT-SUF.
  5481     PERFORM 0740-MOVE-SW-REC.
  5482
  5483     IF SW-RPT-TYPE-ID NOT = WS-PREV-RPT-TYPE
  5484        MOVE SW-RPT-TYPE-ID TO WS-PREV-RPT-TYPE
  5485        GO TO 0920-FOR-ONE-B-RECORD
  5486     END-IF.
  5487
  5488
  5489 0910-CHECK-GROUP-BREAK.
  5490     IF SW-GA NOT = WS-SAVE-GA
  5491         GO TO 0970-BREAK-GROUP-3.
  5492
  5493     IF SW-CARR  NOT = WS-SAVE-CAR OR
  5494        SW-COMP  NOT = WS-SAVE-CMP OR
  5495        SW-STATE NOT = WS-SAVE-ST  OR
  5496        SW-ACCT  NOT = WS-SAVE-ACC
  5497           GO TO 0950-BREAK-GROUP-2.
  5498
  5499     GO TO 0930-BREAK-GROUP-1.
  5500
  5501 0920-BREAK-GROUP-RETURN.
  5502     PERFORM 0740-MOVE-SW-REC.
  5503
  5504 0920-FOR-ONE-B-RECORD.
  5505
  5506     IF SW-CTL = HIGH-VALUES
  5507         PERFORM 0970-BREAK-GROUP-3
  5508         GO TO 1080-E-O-J
  5509     ELSE
  5510         IF SW-RPT-TYPE-ID = 'C'
  5511             PERFORM 0970-BREAK-GROUP-3
  5512             GO TO 0990-PRINT-GA-TOTALS
  5513         ELSE
  5514             GO TO 0910-CHECK-GROUP-BREAK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* DCC043RET.cbl
  5516
  5517 0930-BREAK-GROUP-1.
  5518     MOVE +1 TO SC.
  5519     MOVE +7 TO SF.
  5520     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5521     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5522                          UNTIL SB GREATER 6.
  5523
  5524 0940-BREAK-GROUP-1-EXIT.
  5525     GO TO 0920-BREAK-GROUP-RETURN.
  5526
  5527 0950-BREAK-GROUP-2.
  5528     PERFORM 0930-BREAK-GROUP-1.
  5529     MOVE '2'    TO HEAD-SW.
  5530     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5531                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5532     MOVE +2     TO SG.
  5533     MOVE +9     TO SF.
  5534     MOVE +1     TO SH.
  5535     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5536*
  5537***rpt-type a = rpt 43a, b = rpt 43b
  5538*     IF SW-RPT-TYPE-ID = 'A' AND
  5539*       (FC-CODE = '1' OR '5' OR '6')
  5540*         WRITE DATA-OUT-REC FROM DATA-OUT-RECORD
  5541*         PERFORM 3300-INIT-DATA-OUT THRU 3399-EXIT
  5542*     END-IF.
  5543*
  5544     MOVE +7     TO SC.
  5545     MOVE +13    TO SF.
  5546     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5547     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5548                          UNTIL SB GREATER 12.
  5549
  5550 0960-BREAK-GROUP-2-EXIT.
  5551     GO TO 0920-BREAK-GROUP-RETURN.
  5552
  5553 0970-BREAK-GROUP-3.
  5554     PERFORM 0950-BREAK-GROUP-2.
  5555     MOVE '3'        TO HEAD-SW.
  5556     MOVE WS-SAVE-GA TO H8-GROUP  ZONE-GROUP.
  5557     MOVE '  GROUP'  TO H-8-G.
  5558
  5559     IF ZON = 'ZON'
  5560         INSPECT H8-GROUP CONVERTING 'ZON' TO '   '
  5561         MOVE '  ZONE' TO H-8-G.
  5562*
  5563*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5564*  SEPARATE PAGE BY ITSELF.
  5565*
  5566     MOVE '1'              TO X.
  5567     MOVE SPACE-LINE       TO P-DATA.
  5568     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5569
  5570     MOVE HEAD-8-GROUP TO H2-ADDR.
  5571     MOVE SPACES       TO H1-NAME  H3-ADDR  H3-ZIP.
  5572     MOVE +3           TO SG.
  5573     MOVE +15          TO SF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* DCC043RET.cbl
  5574     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5575*
  5576*  SKIP 1 ADDITIONAL PAGE TO PRINT GROUP TOTALS ON A
  5577*  SEPARATE PAGE BY ITSELF.
  5578*
  5579     MOVE '1'              TO X.
  5580     MOVE SPACE-LINE       TO P-DATA.
  5581     PERFORM 0610-PRT-RTN THRU 0630-EXIT.
  5582
  5583     MOVE +13          TO SC.
  5584     MOVE +19          TO SF.
  5585     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5586     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5587                          UNTIL SB GREATER 18.
  5588
  5589 0980-BREAK-GROUP-3-EXIT.
  5590     GO TO 0920-BREAK-GROUP-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* DCC043RET.cbl
  5592 0990-PRINT-GA-TOTALS.
  5593     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5594                          UNTIL SB GREATER 36.
  5595     MOVE 'C' TO H1-REPORT-SUF.
  5596     PERFORM 0740-MOVE-SW-REC.
  5597
  5598 1000-CHECK-GA-BREAK.
  5599     IF SW-GA NOT = WS-SAVE-GA
  5600         GO TO 1060-BREAK-GA-3.
  5601
  5602     IF SW-CARR  NOT = WS-SAVE-CAR  OR
  5603        SW-COMP  NOT = WS-SAVE-CMP  OR
  5604        SW-STATE NOT = WS-SAVE-ST   OR
  5605        SW-ACCT  NOT = WS-SAVE-ACC
  5606           GO TO 1040-BREAK-GA-2.
  5607
  5608     GO TO 1020-BREAK-GA-1.
  5609
  5610 1010-BREAK-GA-RETURN.
  5611     PERFORM 0740-MOVE-SW-REC.
  5612
  5613     IF SW-CTL = HIGH-VALUES
  5614         PERFORM 1060-BREAK-GA-3
  5615         GO TO 1080-E-O-J.
  5616
  5617     GO TO 1000-CHECK-GA-BREAK.
  5618
  5619 1020-BREAK-GA-1.
  5620     MOVE +1 TO SC.
  5621     MOVE +7 TO SF.
  5622     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5623     PERFORM 0560-ZERO-PA VARYING SB FROM 1 BY 1
  5624                          UNTIL SB GREATER 6.
  5625
  5626 1030-BREAK-GA-1-EXIT.
  5627     GO TO 1010-BREAK-GA-RETURN.
  5628
  5629 1040-BREAK-GA-2.
  5630     PERFORM 1020-BREAK-GA-1.
  5631
  5632     IF LIFE-RETENT = ZERO
  5633         MOVE ZEROS TO PA-NBA (7) PA-NBA (10).
  5634
  5635     IF AH-RETENT = ZERO
  5636         MOVE ZEROS TO PA-NBA (8) PA-NBA (11).
  5637
  5638     ADD PA-NBA (7) PA-NBA (8) GIVING PA-NBA (9).
  5639     ADD PA-NBA (10) PA-NBA (11) GIVING PA-NBA (12).
  5640
  5641     MOVE '2' TO HEAD-SW.
  5642     MOVE SPACES TO H4-FT  H5-FMO  H5-FS1  H5-FDA  H5-FS2  H5-FYR
  5643                    H5-TMO H5-TS1  H5-TDA  H5-TS2  H5-TYR.
  5644
  5645     MOVE +2 TO SG.
  5646     MOVE +9 TO SF.
  5647     MOVE +1 TO SH.
  5648     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5649
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* DCC043RET.cbl
  5650     IF PA-NBA (7) LESS +0
  5651         ADD PA-NBA (7) TO PA-NBA (8)
  5652         MOVE +0 TO PA-NBA (7)
  5653         IF PA-NBA (8) LESS +0
  5654             MOVE +0 TO PA-NBA (8).
  5655
  5656     IF PA-NBA (8) LESS +0
  5657         ADD PA-NBA (8) TO PA-NBA (7)
  5658         MOVE +0 TO PA-NBA (8)
  5659         IF PA-NBA (7) LESS +0
  5660             MOVE +0 TO PA-NBA (7).
  5661
  5662     COMPUTE PA-NBA (9) = PA-NBA (7) + PA-NBA (8).
  5663
  5664     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5665         MOVE ZEROS  TO  PA-NBA (7)  PA-NBA (8)  PA-NBA (9).
  5666
  5667     IF PA-NBA (10) LESS +0
  5668         ADD PA-NBA (10) TO PA-NBA (11)
  5669         MOVE +0 TO PA-NBA (10)
  5670         IF PA-NBA (11) LESS +0
  5671             MOVE +0 TO PA-NBA (11).
  5672
  5673     IF PA-NBA (11) LESS +0
  5674         ADD PA-NBA (11) TO PA-NBA (10)
  5675         MOVE +0 TO PA-NBA (11)
  5676         IF PA-NBA (10) LESS +0
  5677             MOVE +0 TO PA-NBA (10).
  5678
  5679     COMPUTE PA-NBA (12) = PA-NBA (10) + PA-NBA (11).
  5680
  5681     IF SAVE-RET-Y-N = SPACE  OR  'N'
  5682         MOVE ZEROS  TO  PA-NBA (10)  PA-NBA (11)  PA-NBA (12).
  5683
  5684     MOVE +7  TO SC.
  5685     MOVE +13 TO SF.
  5686     PERFORM 0530-ADD-UP-LEVELS 6 TIMES.
  5687     PERFORM 0560-ZERO-PA VARYING SB FROM 7 BY 1
  5688                          UNTIL SB GREATER 12.
  5689
  5690 1050-BREAK-GA-2-EXIT.
  5691     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* DCC043RET.cbl
  5693
  5694 1060-BREAK-GA-3.
  5695     PERFORM 1040-BREAK-GA-2.
  5696     MOVE '3'        TO HEAD-SW.
  5697     MOVE WS-SAVE-GA TO H8-GA.
  5698     MOVE HEAD-8-GA  TO H2-ADDR.
  5699     MOVE SPACES     TO H1-NAME  H3-ADDR  H3-ZIP.
  5700*    MOVE +1.0       TO LIFE-RETENT AH-RETENT.
  5701
  5702     IF DTE-CLIENT = 'GIC'
  5703         MOVE 'P' TO SAVE-RET-TYP
  5704     ELSE
  5705         MOVE 'E' TO SAVE-RET-TYP.
  5706
  5707     MOVE +3    TO SG.
  5708     MOVE +15   TO SF.
  5709     MOVE +2    TO SH.
  5710     MOVE LIFE-RETENT TO RETENT-FACT.
  5711     MOVE +13   TO SC.
  5712     MOVE +15   TO SF.
  5713*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5714     MOVE AH-RETENT TO RETENT-FACT.
  5715     MOVE +14   TO SC.
  5716*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5717     MOVE LIFE-RETENT TO RETENT-FACT.
  5718     MOVE +16   TO SC.
  5719     MOVE +18   TO SF.
  5720*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5721     MOVE AH-RETENT TO RETENT-FACT.
  5722     MOVE +17 TO SC.
  5723*    PERFORM 0420-CALCULATE-GA THRU 0430-EXIT.
  5724
  5725     ADD PA-PE (13) PA-PE (14) GIVING PA-PE (15).
  5726     ADD PA-PE (16) PA-PE (17) GIVING PA-PE (18).
  5727
  5728     MOVE +15 TO SF.
  5729
  5730     PERFORM 0440-GENERATE-RETRO THRU 0470-EXIT.
  5731     PERFORM 0560-ZERO-PA VARYING SB FROM 13 BY 1
  5732                          UNTIL SB GREATER 18.
  5733
  5734 1070-BREAK-GA-3-EXIT.
  5735     GO TO 1010-BREAK-GA-RETURN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* DCC043RET.cbl
  5737 1080-E-O-J.
  5738     CLOSE
  5739         PRNTR.
  5740     CLOSE DATA-OUT.
  5741
  5742 1090-CLOSE-FICH.
* 5743                             COPY ELCPRTC.
  5744******************************************************************04/15/98
  5745*                                                                *ELCPRTC
  5746*                                                                *ELCPRTC
  5747*                            ELCPRTC.                            *   LV003
  5748*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  5749*                            VMOD=2.002                          *   CL**2
  5750*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  5751*                                                                *ELCPRTC
  5752* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  5753******************************************************************ELCPRTC
  5754                                                                  ELCPRTC
  5755      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  5756          CLOSE FICH.                                             ELCPRTC
  5757                                                                  ELCPRTC
  5758******************************************************************ELCPRTC
  5759
  5760 1090-CLOSE-EXIT.
  5761     EXIT.
  5762
  5763 3300-INIT-DATA-OUT.
  5764     MOVE SPACES TO DO-CARRIER
  5765                    DO-COMP
  5766                    DO-STATE
  5767                    DO-ACCOUNT-NUM
  5768                    DO-GROUP
  5769                    DO-ACCOUNT-NAME
  5770                    DO-PERIOD
  5771                    DO-PREM-P-E
  5772                    DO-CLAIM-P-I
  5773                    DO-RETRO-Y-N
  5774                    DO-RETRO-P-E
  5775                    DO-TAX-P-E.
  5776
  5777*     MOVE ZEROS  TO DO-RET-PCT
  5778*                    DO-ITD-RET-PCT
  5779*                    DO-LIFE-RETENT
  5780*                    DO-AH-RETENT.
  5781
  5782     PERFORM VARYING WS-DO-SUB FROM 1 BY 1 UNTIL
  5783                     WS-DO-SUB > 10
  5784          MOVE SPACES TO DO-DESCR (WS-DO-SUB)
  5785          MOVE ZEROS  TO DO-PERLFP (WS-DO-SUB)
  5786                         DO-ITDLFP (WS-DO-SUB)
  5787                         DO-PERAHP (WS-DO-SUB)
  5788                         DO-ITDAHP (WS-DO-SUB)
  5789                         DO-PERLFE (WS-DO-SUB)
  5790                         DO-ITDLFE (WS-DO-SUB)
  5791                         DO-PERAHE (WS-DO-SUB)
  5792                         DO-ITDAHE (WS-DO-SUB)
  5793     END-PERFORM.
  5794
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* DCC043RET.cbl
  5795     MOVE +0     TO WS-DO-SUB.
  5796
  5797 3399-EXIT.
  5798     EXIT.
  5799
* 5800 COPY ELCDCS.
  5801****************************************************************  04/15/98
  5802*                                                              *  ELCDCS
  5803*                                                              *  ELCDCS
  5804*                            ELCDCS.                           *     LV003
  5805*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  5806*                            VMOD=2.002                        *     CL**3
  5807*                                                              *  ELCDCS
  5808*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  5809****************************************************************. ELCDCS
  5810                                                                  ELCDCS
  5811 8510-DATE-CONVERSION.                                            ELCDCS
  5812     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  5813                                                                  ELCDCS
  5814 8590-EXIT.                                                       ELCDCS
  5815     EXIT.                                                        ELCDCS
  5816                                                                  ELCDCS
  5817
  5818 ABEND-PGM SECTION.
* 5819                             COPY ELCABEND SUPPRESS.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       73188     Code:       36944
