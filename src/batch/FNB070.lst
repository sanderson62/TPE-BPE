* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNB070.cbl
* Options: int("FNB070.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB070.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB070.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB070.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNB070.
     3 DATE-WRITTEN.  MAY, 2000.
     4
     5******************************************************************
     6*
     7*       CREATE FIRST NATIONAL BANK FILE OF ISSUED CHECKS
     8*        THIS FILE IS TRANSFERRED TO FNB BY OPERATIONS
     9******************************************************************
    10*                   C H A N G E   L O G
    11*
    12* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNB070.cbl
    14*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    15* EFFECTIVE    NUMBER
    16*-----------------------------------------------------------------
    17* 070902    2002031800003  SMVA  MOVE FROM MAINFRAME TO LAN
    18* 092302                   SMVA  CHANGE COMPARISON VALUE FOR CHECK
    19*                        AMOUNT FROM ZERO TO 0.00 W/LEADING SPACES
    20* 100702    2002100700003  SMVA  ADD VOIDS TO PROCESS FOR BANK
    21******************************************************************
    22
    23 ENVIRONMENT DIVISION.
    24 INPUT-OUTPUT SECTION.
    25 FILE-CONTROL.
    26
    27*    SELECT MICR-DRAFT-FILE
    28     SELECT MICR-TRNSFR-FILE
    29         ASSIGN TO TRNSFR
    30         ORGANIZATION IS LINE SEQUENTIAL
    31         FILE STATUS IS MICR-STATUS.
    32
    33     SELECT FNB-ISSUE-FILE
    34         ASSIGN TO SYS011
    35         ORGANIZATION IS LINE SEQUENTIAL
    36         FILE STATUS IS SYS011-STATUS.
    37
    38
    39 DATA DIVISION.
    40 FILE SECTION.
    41
    42 FD  FNB-ISSUE-FILE
    43     LABEL RECORDS ARE STANDARD
    44     RECORDING MODE IS F
    45     RECORD CONTAINS 54 CHARACTERS
    46     BLOCK CONTAINS 0 RECORDS.
    47 01  FNB-ISSUE-RECORD   PIC X(54).
    48
    49*FD  MICR-DRAFT-FILE
    50 FD  MICR-TRNSFR-FILE
    51     RECORD IS VARYING FROM 430 TO 1858 CHARACTERS.
    52*    RECORD IS VARYING FROM 650 TO 3000 CHARACTERS.
    53*01  MICR-DRAFT-RECORD.
    54 01  MICR-TRNSFR-RECORD.
*   55     COPY FNMICR.
    56       10 FNMICR-FORM               PIC X(04).
    57       10 FNMICR-DRAFT-ORDER        PIC 9(05).
    58       10 FNMICR-DRAFT-NO           PIC 9(10).
    59       10 FNMICR-AMOUNT-PAID        PIC ZZZ,ZZZ,ZZ9.99.
    60       10 FNMICR-CHECK-DATE         PIC X(10).
    61       10 FNMICR-PAYEE-NAME         PIC X(50).
    62       10 FNMICR-PAYEE-ADDRESS1     PIC X(50).
    63       10 FNMICR-PAYEE-ADDRESS2     PIC X(50).
    64       10 FNMICR-PAYEE-ADDRESS3     PIC X(50).
    65       10 FNMICR-PAYEE-ADDRESS4     PIC X(50).
    66       10 FILLER                    PIC X(04).
    67       10 FNMICR-VENDOR-NO          PIC X(10).
    68       10 FNMICR-VOID-SW            PIC X(01).
    69       10 FNMICR-NO-OF-INVOICES     PIC 9(03).
    70       10 FNMICR-INVOICE-DATA       OCCURS 15 TIMES.
    71          15  FNMICR-INV-DATE       PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNB070.cbl (/apps/prod/cid1p/copy/FNMICR)
    72          15  FNMICR-INV-NO         PIC X(16).
    73          15  FNMICR-INV-TYPE       PIC X(02).
    74          15  FNMICR-INV-AMT        PIC ZZZ,ZZZ,ZZZ.99.
    75          15  FNMICR-INV-MSG        PIC X(60).
    76*01  FILLER.
    77*    05  MICR-KEY         PIC X(0019).
    78*    05  FILLER           PIC X(2981).
    79
    80
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNB070.cbl
    81/
    82 WORKING-STORAGE SECTION.
    83
    84 01  FILLER.
    85     05  MICR-STATUS         PIC XX     VALUE '00'.
    86         88  EOF                        VALUE '10'.
    87     05  SYS011-STATUS       PIC XX     VALUE '00'.
    88     05  TOT-COUNT           PIC S9(7)  COMP-3 VALUE +0.
    89*    05  ED-CNT              PIC ZZ,ZZZ,ZZZ,ZZ9.
    90*    05  ED-AMT              PIC ZZZ,ZZZ,ZZZ.99.
    91     05  WS-DATE.
    92         10  WS-MO           PIC XX.
    93         10  FILLER          PIC X.
    94         10  WS-DAY          PIC XX.
    95         10  FILLER          PIC X.
    96         10  WS-YEAR         PIC XXXX.
    97     05  WS-CHECK-DATE.
    98         10  WS-CHECK-YEAR   PIC XXXX.
    99         10  WS-CHECK-MO     PIC XX.
   100         10  WS-CHECK-DAY    PIC XX.
   101
   102 01  FNB-WORK-RECORD.
   103     05  FNB-VOID-IND    PIC X         VALUE '0'.
   104     05  FNB-ACCOUNT     PIC X(10)     VALUE '0013238089'.
   105     05  FNB-CHECK-NO    PIC 9(10)     VALUE ZERO.
   106     05  FNB-ISSUE-DATE  PIC 9(8)      VALUE ZERO.
   107     05  FNB-CHECK-AMT   PIC 9(8)V99   VALUE ZERO.
   108     05  FILLER          PIC X(15)     VALUE ZERO.
   109
   110 01  FNB-TOTAL-RECORD.
   111     05  FNB-TOTAL-IND   PIC X         VALUE 'T'.
   112     05  FNB-TOTAL-AMT   PIC 9(10)V99  VALUE ZERO.
   113     05  FILLER          PIC X(41)     VALUE ZERO.
   114
   115
   116
   117*
   118 PROCEDURE DIVISION.
   119*
   120     PERFORM 0000-INIT THRU 0000-EXIT
   121
   122     PERFORM 1000-PROCESS-FILE THRU 1000-EXIT
   123       UNTIL EOF
   124
   125     PERFORM 9000-END THRU 9000-EXIT
   126
   127     GOBACK.
   128
   129 0000-INIT.
   130*
   131*    OPEN INPUT MICR-DRAFT-FILE
   132     OPEN INPUT MICR-TRNSFR-FILE
   133     IF MICR-STATUS = '00' OR '97'
   134        CONTINUE
   135     ELSE
   136*       DISPLAY 'OPEN ERROR ' MICR-STATUS ' ON MICRDRFT'
   137        DISPLAY 'OPEN ERROR ' MICR-STATUS ' ON TRNSFR'
   138     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* FNB070.cbl
   139
   140     OPEN OUTPUT FNB-ISSUE-FILE
   141     IF SYS011-STATUS NOT = '00'
   142        DISPLAY 'OPEN ERROR ' SYS011-STATUS ' ON SYS011'
   143     END-IF
   144
   145     .
   146 0000-EXIT.
   147     EXIT.
   148
   149 1000-PROCESS-FILE.
   150*
   151*    READ MICR-DRAFT-FILE
   152     READ MICR-TRNSFR-FILE
   153       AT END GO TO 1000-EXIT
   154     END-READ
   155
   156     IF FNMICR-FORM NOT = '0031'
   157        GO TO 1000-EXIT
   158     END-IF
   159
   160     IF FNMICR-AMOUNT-PAID = '          0.00'
   161        GO TO 1000-EXIT
   162     END-IF
   163
   164     MOVE '0'                TO FNB-VOID-IND
   165     MOVE FNMICR-DRAFT-NO    TO FNB-CHECK-NO
   166     MOVE FNMICR-CHECK-DATE  TO WS-DATE
   167     MOVE WS-YEAR            TO WS-CHECK-YEAR
   168     MOVE WS-MO              TO WS-CHECK-MO
   169     MOVE WS-DAY             TO WS-CHECK-DAY
   170     MOVE WS-CHECK-DATE      TO FNB-ISSUE-DATE
   171     MOVE FNMICR-AMOUNT-PAID TO FNB-CHECK-AMT
   172     IF FNMICR-VOID-SW = 'V'
   173         MOVE FNMICR-VOID-SW TO FNB-VOID-IND
   174     ELSE
   175         ADD +1 TO TOT-COUNT
   176         ADD FNB-CHECK-AMT TO FNB-TOTAL-AMT
   177     END-IF
   178
   179     MOVE FNMICR-DRAFT-NO    TO FNB-CHECK-NO
   180     MOVE FNMICR-CHECK-DATE  TO WS-DATE
   181     WRITE FNB-ISSUE-RECORD  FROM FNB-WORK-RECORD
   182
   183     .
   184 1000-EXIT.
   185     EXIT.
   186
   187 9000-END.
   188*
   189     WRITE FNB-ISSUE-RECORD FROM FNB-TOTAL-RECORD
   190*    CLOSE MICR-DRAFT-FILE
   191     CLOSE MICR-TRNSFR-FILE
   192     CLOSE FNB-ISSUE-FILE
   193     .
   194 9000-EXIT.
   195     EXIT.
   196
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* FNB070.cbl
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3452     Code:         705
