* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIDBALCPY.cbl
* Options: int("CIDBALCPY.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIDBALCPY.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIDBALCPY.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CIDBALCPY.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    cidlgcpy.
     3 AUTHOR.        Pablo.
     4 ENVIRONMENT DIVISION.
     5 INPUT-OUTPUT SECTION.
     6 FILE-CONTROL.
     7*
     8     SELECT CID-FILE-IN
     9         ASSIGN TO SYS010
    10         FILE STATUS IS SYS010-STATUS
    11         organization is line sequential.
    12
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIDBALCPY.cbl
    14     SELECT CID-FILE-OUT
    15         ASSIGN TO SYS011.
    16
    17
    18 DATA DIVISION.
    19 FILE SECTION.
    20
    21 FD  CID-FILE-IN
    22     LABEL RECORDS ARE STANDARD
    23     RECORDING MODE IS F
    24     BLOCK CONTAINS 0 RECORDS.
    25 01  CID-RECORD-IN               PIC X(172).
    26
    27 FD  CID-FILE-OUT
    28     LABEL RECORDS ARE STANDARD
    29     RECORDING MODE IS F
    30     BLOCK CONTAINS 0 RECORDS.
    31 01  CID-RECORD-OUT              PIC X(174).
    32
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIDBALCPY.cbl
    34
    35 WORKING-STORAGE SECTION.
    36
    37 01  FILLER                  BINARY.
    38     05  SUB                 PIC S9(4)    VALUE +0.
    39
    40 01  BALLARD-REC.
    41     05  FILLER                      PIC X(131).
    42     05  BAL-EFFDT                   PIC X(8).
    43     05  FILLER                      PIC X(33).
    44
    45 01  BALLARD-REC-OUT.
    46     05  FILLER                      PIC X(131).
    47     05  BAL-EFFDTO                  PIC X(10).
    48     05  FILLER                      PIC X(33).
    49
    50 01  FILLER.
    51     05  sub1                pic s9(3) comp-3 value +0.
    52     05  cid-in-cnt          pic 9(5) value zeros.
    53     05  cid-out-cnt         pic 9(5) value zeros.
    54     05  S0C7                PIC X        VALUE ' '.
    55     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
    56     05  SYS010-STATUS       PIC XX       VALUE '00'.
    57         88  EOF                          VALUE '10'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIDBALCPY.cbl
    59*
    60 PROCEDURE DIVISION.
    61*
    62     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT
    63
    64     PERFORM 1000-PROCESS THRU 1000-EXIT UNTIL EOF
    65     display ' records in   ' cid-in-cnt
    66     display ' records out  ' cid-out-cnt
    67     CLOSE CID-FILE-IN   CID-FILE-OUT
    68     GOBACK
    69
    70
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIDBALCPY.cbl
    72     .
    73 1000-PROCESS.
    74*
    75     READ CID-FILE-IN
    76      INTO BALLARD-REC
    77        AT END GO TO 1000-EXIT.
    78     add 1 to cid-in-cnt
    79     MOVE BALLARD-REC (1:137) TO BALLARD-REC-OUT (1:137)
    80     MOVE '19'                TO BAL-EFFDTO (7:2)
    81     MOVE BAL-EFFDT (7:2)     TO BAL-EFFDTO (9:2)
    82     IF BAL-EFFDT (7:2) < '30'
    83        MOVE '20'          TO BAL-EFFDTO (7:2)
    84     END-IF
    85     MOVE BALLARD-REC (140:33) TO BALLARD-REC-OUT (142:33)
    86
    87     WRITE CID-RECORD-OUT FROM BALLARD-REC-OUT
    88     add 1 to cid-out-cnt
    89     .
    90 1000-EXIT.
    91     EXIT.
    92
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIDBALCPY.cbl
    94*
    95*
    96 0000-HOUSEKEEPING.
    97*
    98
    99     OPEN INPUT CID-FILE-IN
   100     IF SYS010-STATUS NOT = '00'
   101        DISPLAY 'OPEN ERROR ' SYS010-STATUS ' ON SYS010'
   102        ADD +1 TO FORCE-DUMP.
   103
   104
   105     OPEN OUTPUT CID-FILE-OUT
   106     .
   107 0000-EXIT.
   108     EXIT.
   109
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2116     Code:         631
