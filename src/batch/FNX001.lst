* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* FNX001.cbl
* Options: int("FNX001.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNX001.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNX001.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNX001.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    FNX001.
     3
     4*REMARKS.
     5******************************************************************
     6*                                                                *
     7*  DESCRIPTION:  CONVERT ONE INPUT FIELD CONTAINING CITY, STATE  *
     8*                AND/OR ZIP INTO 3 OUTPUT FIELDS.                *
     9*                                                                *
    10*  INPUT:  A 50-CHARACTER FIELD WITH CITY, STATE, ZIP.           *
    11*                                                                *
    12*  OUTPUT: A 30-CHARACTER FIELD FOR CITY NAME.                   *
    13*          A 2-CHARACTER  FIELD FOR STATE NAME.                  *
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* FNX001.cbl
    14*          A 9-CHARACTER  FIELD FOR ZIP CODE.                    *
    15*                                                                *
    16******************************************************************
    17
    18 ENVIRONMENT DIVISION.
    19
    20 DATA DIVISION.
    21
    22 WORKING-STORAGE SECTION.
    23
    24 01  WS-CITY-ST-ZIP     PIC X(51).
    25 01  FILLER REDEFINES WS-CITY-ST-ZIP.
    26     05  WS-CS OCCURS 51 TIMES INDEXED BY CI PIC X.
    27
    28 01  WS-STATE           PIC X(2).
    29 01  FILLER REDEFINES WS-STATE.
    30     05  WS-ST OCCURS 2  TIMES INDEXED BY SI PIC X.
    31
    32 01  WS-ZIP             PIC X(9).
    33 01  FILLER REDEFINES WS-ZIP.
    34     05  WS-ZP OCCURS 9  TIMES INDEXED BY ZI PIC X.
    35
    36
    37
    38 LINKAGE SECTION.
    39
    40 01  FNX001-PARMS.
    41     05  PARM-CITY-ST-ZIP  PIC X(50).
    42     05  PARM-CITY         PIC X(30).
    43     05  PARM-STATE        PIC X(02).
    44     05  PARM-ZIP          PIC X(09).
    45
    46
    47
    48*
    49 PROCEDURE DIVISION USING FNX001-PARMS.
    50*
    51     MOVE SPACES  TO  PARM-CITY.
    52     MOVE SPACES  TO  PARM-STATE, WS-STATE.
    53     MOVE SPACES  TO  PARM-ZIP,   WS-ZIP.
    54     MOVE PARM-CITY-ST-ZIP TO WS-CITY-ST-ZIP.
    55     SET ZI, SI TO +1.
    56
    57     PERFORM 1000-MOVE-ZIP   THRU 1000-EXIT
    58         VARYING CI FROM +50 BY -1
    59           UNTIL CI = +0
    60              OR ZI = +0.
    61
    62     PERFORM 2000-MOVE-STATE THRU 2000-EXIT
    63         VARYING CI FROM +50 BY -1
    64           UNTIL CI = +0
    65              OR SI = +0.
    66
    67     MOVE WS-CITY-ST-ZIP TO PARM-CITY.
    68     MOVE WS-STATE       TO PARM-STATE.
    69     MOVE WS-ZIP         TO PARM-ZIP.
    70     GOBACK.
    71
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* FNX001.cbl
    72
    73*
    74 1000-MOVE-ZIP.
    75*
    76*  THIS ROUTINE FINDS A SPACE FOLLOWED BY 9 DIGITS
    77*    OR A SPACE FOLLOWED BY 5 DIGITS.
    78*
    79     IF WS-CS (CI) = ' '
    80         GO TO 1000-EXIT.
    81
    82     IF (WS-CS (CI - 0) IS NUMERIC) AND
    83        (WS-CS (CI - 1) IS NUMERIC) AND
    84        (WS-CS (CI - 2) IS NUMERIC) AND
    85        (WS-CS (CI - 3) IS NUMERIC) AND
    86        (WS-CS (CI - 4) IS NUMERIC) AND
    87        (WS-CS (CI - 5) IS NUMERIC) AND
    88        (WS-CS (CI - 6) IS NUMERIC) AND
    89        (WS-CS (CI - 7) IS NUMERIC) AND
    90        (WS-CS (CI - 8) IS NUMERIC) AND
    91        (WS-CS (CI - 9)  = ' ')
    92            SET ZI TO +9
    93            PERFORM 1100-MOVE UNTIL ZI = +0
    94            GO TO 1000-EXIT.
    95
    96     IF (WS-CS (CI - 0) IS NUMERIC) AND
    97        (WS-CS (CI - 1) IS NUMERIC) AND
    98        (WS-CS (CI - 2) IS NUMERIC) AND
    99        (WS-CS (CI - 3) IS NUMERIC) AND
   100        (WS-CS (CI - 4) IS NUMERIC) AND
   101        (WS-CS (CI - 5)  = ' ')
   102            SET ZI TO +5
   103            PERFORM 1100-MOVE UNTIL ZI = +0.
   104
   105 1000-EXIT.
   106     EXIT.
   107
   108
   109*
   110 1100-MOVE.
   111*
   112     MOVE WS-CS (CI) TO WS-ZP (ZI).
   113     MOVE ' '        TO WS-CS (CI).
   114     SET CI DOWN BY +1.
   115     SET ZI DOWN BY +1.
   116
   117 1100-EXIT.
   118     EXIT.
   119
   120
   121*
   122 2000-MOVE-STATE.
   123*
   124*  THIS ROUTINE FINDS A SPACE OR A COMMA FOLLOWED BY
   125*    TWO ALPHABETIC CHARACTERS.
   126*
   127     IF WS-CS (CI) = ' '
   128         GO TO 2000-EXIT.
   129
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* FNX001.cbl
   130     IF (WS-CS (CI - 0) IS ALPHABETIC) AND
   131        (WS-CS (CI - 0) NOT = ' ')     AND
   132        (WS-CS (CI - 1) IS ALPHABETIC) AND
   133        (WS-CS (CI - 1) NOT = ' ')     AND
   134        (WS-CS (CI - 2) = ' ' OR ',')
   135            SET SI TO +2
   136            MOVE WS-CS (CI - 0) TO WS-ST (SI)
   137            MOVE ' '            TO WS-CS (CI - 0)
   138            SET SI DOWN BY +1
   139            MOVE WS-CS (CI - 1) TO WS-ST (SI)
   140            MOVE ' '            TO WS-CS (CI - 1)
   141            SET SI DOWN BY +1
   142            MOVE ' '            TO WS-CS (CI - 2).
   143
   144     IF WS-CS (CI - 3) = ','
   145         MOVE ' ' TO WS-CS (CI - 3)
   146     ELSE
   147     IF WS-CS (CI - 4) = ','
   148         MOVE ' ' TO WS-CS (CI - 4).
   149
   150 2000-EXIT.
   151     EXIT.
   152
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:         660     Code:         914
