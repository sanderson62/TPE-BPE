* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS026P.cbl
* Options: int("ECS026P.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS026P.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS026P.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS026P.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                ECS026.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 05/13/94 09:27:38.
     7*             PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                           VMOD=2.021.
     9
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS026P.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24
    25
    26******************************************************************
    27*        THIS PROGRAM GENERATES THE EXPERIENCE ANALYSIS          *
    28*        REPORT.                                                 *
    29******************************************************************
    30******************************************************************
    31*                   C H A N G E   L O G
    32*
    33* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    34*-----------------------------------------------------------------
    35*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    36* EFFECTIVE    NUMBER
    37*-----------------------------------------------------------------
    38* 080702                   PEMA  ADD CERT COUNT FOR LIFE AND COMBI1102****
    39
    40 ENVIRONMENT DIVISION.
    41 INPUT-OUTPUT SECTION.
    42 FILE-CONTROL.
    43
    44     SELECT  SORT-WORK       ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    45     SELECT  SORT-WORK-2     ASSIGN TO SYS001-UT-2314-S-SORTWK1.
    46     SELECT  PRINTER         ASSIGN TO SYS008-UR-1403-S-SYS008.
    47
    48     SELECT  ACCT-IN         ASSIGN TO SYS021-FBA1-ERACCTT
    49                             ORGANIZATION    INDEXED
    50                             ACCESS          SEQUENTIAL
    51                             RECORD KEY      AM-CONTROL-PRIMARY
    52                             FILE STATUS     ERACCT-FILE-STATUS.
    53
    54     SELECT  ERRTBL-IN       ASSIGN TO SYS021-FBA1-ERRTBLT
    55                             ORGANIZATION    INDEXED
    56                             ACCESS          DYNAMIC
    57                             RECORD KEY      RE-CONTROL-PRIMARY
    58                             FILE STATUS     ERRTBL-FILE-STATUS.
    59
    60     SELECT  CERT-IN         ASSIGN TO SYS011-UT-2400-S-SYS011.
    61     SELECT  DISK-DATE       ASSIGN TO SYS019-UT-2314-S-SYS019.
    62     SELECT  FICH            ASSIGN TO SYS020-UT-2400-S-SYS020.
    63     SELECT  REIN-WORK       ASSIGN TO SYS030-UT-FBA1-S-SYS030.
    64     SELECT  TEMP-WORK       ASSIGN TO SYS031-UT-FBA1-S-SYS031.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS026P.cbl
    66 DATA DIVISION.
    67 FILE SECTION.
    68
    69 SD  SORT-WORK.
    70
    71 01  SORT-REC.
    72     12  SR-CONTROL          PIC X(20).
    73     12  FILLER              PIC X(1121).
    74
    75 01  SORT-REC-B.
    76     12  FILLER              PIC X(20).
    77     12  SR-CONTROL-B        PIC X(10).
    78     12  FILLER              PIC X(1111).
    79
    80 01  SORT-REC-C.
    81     12  FILLER              PIC X.
    82     12  SR-CONTROL-C1       PIC X(7).
    83     12  FILLER              PIC X(22).
    84     12  SR-CONTROL-C2       PIC X(10).
    85     12  FILLER              PIC X(1101).
    86
    87 SD  SORT-WORK-2.
    88
    89 01  SORT-REC-2.
    90     12  SR2-CONTROL         PIC X(4).
    91     12  FILLER              PIC X(120).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS026P.cbl
    93 FD  PRINTER
*   94                             COPY ELCPRTFD.
    95******************************************************************04/15/98
    96*                                                                *ELCPRTFD
    97*                                                                *ELCPRTFD
    98*                            ELCPRTFD.                           *   LV003
    99*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   100*                            VMOD=2.006                          *ELCPRTFD
   101******************************************************************ELCPRTFD
   102     RECORDING MODE F                                             ELCPRTFD
   103     LABEL RECORDS OMITTED                                        ELCPRTFD
   104     BLOCK CONTAINS 0 RECORDS
   105     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   106 01  PRT.                                                         ELCPRTFD
   107     12  P-CTL               PIC  X.                                 CL**2
   108     12  P-DATA              PIC  X(132).                         ELCPRTFD
   109******************************************************************ELCPRTFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS026P.cbl
   111 FD  ACCT-IN.
*  112                             COPY ERCACCT.
   113******************************************************************04/19/98
   114*                                                                *ERCACCT
   115*                                                                *ERCACCT
   116*                            ERCACCT                             *   LV031
   117*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*31
   118*                            VMOD=2.031                          *ERCACCT
   119*                                                                *ERCACCT
   120*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *ERCACCT
   121*                                                                *ERCACCT
   122*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *ERCACCT
   123*   VSAM ACCOUNT MASTER FILES.                                   *ERCACCT
   124*                                                                *ERCACCT
   125*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *ERCACCT
   126*                                                                *ERCACCT
   127*   FILE TYPE = VSAM,KSDS                                        *ERCACCT
   128*   RECORD SIZE = 2000  RECFORM = FIX                            *ERCACCT
   129*                                                                *ERCACCT
   130*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *ERCACCT
   131*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *ERCACCT
   132*                                                                *ERCACCT
   133*   LOG = NO                                                     *ERCACCT
   134*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCACCT
   135*                                                                *ERCACCT
   136*                                                                *ERCACCT
   137******************************************************************ERCACCT
   138*                   C H A N G E   L O G
   139*
   140* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   141*-----------------------------------------------------------------
   142*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   143* EFFECTIVE    NUMBER
   144*-----------------------------------------------------------------
   145* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   146* 092705    2005050300006  PEMA  ADD SPP LEASES
   147* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   148* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   149* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   150* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   151* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   152******************************************************************
   153                                                                  ERCACCT
   154 01  ACCOUNT-MASTER.                                              ERCACCT
   155     12  AM-RECORD-ID                      PIC XX.                ERCACCT
   156         88  VALID-AM-ID                      VALUE 'AM'.         ERCACCT
   157                                                                  ERCACCT
   158     12  AM-CONTROL-PRIMARY.                                      ERCACCT
   159         16  AM-COMPANY-CD                 PIC X.                 ERCACCT
   160         16  AM-MSTR-CNTRL.                                       ERCACCT
   161             20  AM-CONTROL-A.                                    ERCACCT
   162                 24  AM-CARRIER            PIC X.                 ERCACCT
   163                 24  AM-GROUPING.                                 ERCACCT
   164                     28 AM-GROUPING-PREFIX PIC XXX.               ERCACCT
   165                     28 AM-GROUPING-PRIME  PIC XXX.               ERCACCT
   166                 24  AM-STATE              PIC XX.                ERCACCT
   167                 24  AM-ACCOUNT.                                  ERCACCT
   168                     28  AM-ACCOUNT-PREFIX PIC X(4).              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   169                     28  AM-ACCOUNT-PRIME  PIC X(6).              ERCACCT
   170             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A            ERCACCT
   171                                           PIC X(19).             ERCACCT
   172             20  AM-CNTRL-B.                                      ERCACCT
   173                 24  AM-EXPIRATION-DT      PIC XX.                ERCACCT
   174                 24  FILLER                PIC X(4).              ERCACCT
   175             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.                 ERCACCT
   176                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.     ERCACCT
   177                                                                  ERCACCT
   178     12  AM-CONTROL-BY-VAR-GRP.                                   ERCACCT
   179         16  AM-COMPANY-CD-A1              PIC X.                 ERCACCT
   180         16  AM-VG-CARRIER                 PIC X.                 ERCACCT
   181         16  AM-VG-GROUPING                PIC X(6).              ERCACCT
   182         16  AM-VG-STATE                   PIC XX.                ERCACCT
   183         16  AM-VG-ACCOUNT                 PIC X(10).             ERCACCT
   184         16  AM-VG-DATE.                                          ERCACCT
   185             20  AM-VG-EXPIRATION-DT       PIC XX.                ERCACCT
   186             20  FILLER                    PIC X(4).              ERCACCT
   187         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE                  ERCACCT
   188                                           PIC 9(11)      COMP-3. ERCACCT
   189     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   190         16  FILLER                        PIC X(10).
   191         16  AM-VG-KEY3.
   192             20  AM-VG3-ACCOUNT            PIC X(10).
   193             20  AM-VG3-EXP-DT             PIC XX.
   194         16  FILLER                        PIC X(4).
   195     12  AM-MAINT-INFORMATION.                                    ERCACCT
   196         16  AM-LAST-MAINT-DT              PIC XX.                ERCACCT
   197         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCACCT
   198         16  AM-LAST-MAINT-USER            PIC X(4).              ERCACCT
   199         16  FILLER                        PIC XX.                ERCACCT
   200                                                                  ERCACCT
   201     12  AM-EFFECTIVE-DT                   PIC XX.                ERCACCT
   202     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3. ERCACCT
   203                                                                  ERCACCT
   204     12  AM-PREV-DATES  COMP-3.                                   ERCACCT
   205         16  AM-PREV-EXP-DT                PIC 9(11).             ERCACCT
   206         16  AM-PREV-EFF-DT                PIC 9(11).             ERCACCT
   207                                                                  ERCACCT
   208     12  AM-REPORT-CODE-1                  PIC X(10).             ERCACCT
   209     12  AM-REPORT-CODE-2                  PIC X(10).             ERCACCT
   210                                                                  ERCACCT
   211     12  AM-CITY-CODE                      PIC X(4).              ERCACCT
   212     12  AM-COUNTY-PARISH                  PIC X(6).              ERCACCT
   213                                                                  ERCACCT
   214     12  AM-NAME                           PIC X(30).             ERCACCT
   215     12  AM-PERSON                         PIC X(30).             ERCACCT
   216     12  AM-ADDRS                          PIC X(30).             ERCACCT
   217     12  AM-CITY.
   218         16  AM-ADDR-CITY                  PIC X(28).
   219         16  AM-ADDR-STATE                 PIC XX.
   220     12  AM-ZIP.                                                  ERCACCT
   221         16  AM-ZIP-PRIME.                                        ERCACCT
   222             20  AM-ZIP-PRI-1ST            PIC X.                 ERCACCT
   223                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'. ERCACCT
   224             20  FILLER                    PIC X(4).              ERCACCT
   225         16  AM-ZIP-PLUS4                  PIC X(4).              ERCACCT
   226     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.              ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   227         16  AM-CAN-POSTAL-1               PIC XXX.               ERCACCT
   228         16  AM-CAN-POSTAL-2               PIC XXX.               ERCACCT
   229         16  FILLER                        PIC XXX.               ERCACCT
   230     12  AM-TEL-NO.                                               ERCACCT
   231         16  AM-AREA-CODE                  PIC 999.               ERCACCT
   232         16  AM-TEL-PRE                    PIC 999.               ERCACCT
   233         16  AM-TEL-NBR                    PIC 9(4).              ERCACCT
   234     12  AM-TEL-LOC                        PIC X.                 ERCACCT
   235         88  AM-TEL-AT-HOME                   VALUE 'H'.          ERCACCT
   236         88  AM-TEL-AT-BUSINESS               VALUE 'B'.          ERCACCT
   237                                                                  ERCACCT
   238     12  AM-COMM-STRUCTURE.                                       ERCACCT
   239         16  AM-DEFN-1.                                           ERCACCT
   240             20  AM-AGT-COMMS       OCCURS 10 TIMES.              ERCACCT
   241                 24  AM-AGT.                                      ERCACCT
   242                     28  AM-AGT-PREFIX     PIC X(4).              ERCACCT
   243                     28  AM-AGT-PRIME      PIC X(6).              ERCACCT
   244                 24  AM-COM-TYP            PIC X.                 ERCACCT
   245                 24  AM-L-COM              PIC SV9(5)     COMP-3. ERCACCT
   246                 24  AM-J-COM              PIC SV9(5)     COMP-3. ERCACCT
   247                 24  AM-A-COM              PIC SV9(5)     COMP-3. ERCACCT
   248                 24  AM-RECALC-LV-INDIC    PIC X.                 ERCACCT
   249                 24  AM-RETRO-LV-INDIC     PIC X.                 ERCACCT
   250                 24  AM-GL-CODES           PIC X.                 ERCACCT
   251                 24  AM-COMM-CHARGEBACK    PIC 9(02).             ERCACCT
   252                 24  FILLER                PIC X(01).             ERCACCT
   253         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.                   ERCACCT
   254             20  AM-COM-TBLS        OCCURS 10 TIMES.              ERCACCT
   255                 24  FILLER                PIC X(11).             ERCACCT
   256                 24  AM-L-COMA             PIC XXX.               ERCACCT
   257                 24  AM-J-COMA             PIC XXX.               ERCACCT
   258                 24  AM-A-COMA             PIC XXX.               ERCACCT
   259                 24  FILLER                PIC X(6).              ERCACCT
   260                                                                  ERCACCT
   261     12  AM-COMM-CHANGE-STATUS             PIC X.                 ERCACCT
   262         88  AM-COMMISSIONS-CHANGED           VALUE '*'.          ERCACCT
   263                                                                  ERCACCT
   264     12  AM-CSR-CODE                       PIC X(4).              ERCACCT
   265                                                                  ERCACCT
   266     12  AM-BILLING-STATUS                 PIC X.                 ERCACCT
   267         88  AM-ACCOUNT-BILLED                VALUE 'B'.          ERCACCT
   268         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.          ERCACCT
   269     12  AM-AUTO-REFUND-SW                 PIC X.                 ERCACCT
   270         88  AUTO-REFUNDS-USED                VALUE 'Y'.          ERCACCT
   271         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.      ERCACCT
   272     12  AM-GPCD                           PIC 99.                ERCACCT
   273     12  AM-IG                             PIC X.                 ERCACCT
   274         88  AM-HAS-INDIVIDUAL                VALUE '1'.          ERCACCT
   275         88  AM-HAS-GROUP                     VALUE '2'.          ERCACCT
   276     12  AM-STATUS                         PIC X.                 ERCACCT
   277         88  AM-ACCOUNT-ACTIVE                VALUE '0'.          ERCACCT
   278         88  AM-ACCOUNT-INACTIVE              VALUE '1'.          ERCACCT
   279         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.          ERCACCT
   280         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
   281         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   282         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   283     12  AM-REMIT-TO                       PIC 99.                ERCACCT
   284     12  AM-ID-NO                          PIC X(11).             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   285                                                                  ERCACCT
   286     12  AM-CAL-TABLE                      PIC XX.                ERCACCT
   287     12  AM-LF-DEVIATION                   PIC XXX.               ERCACCT
   288     12  AM-AH-DEVIATION                   PIC XXX.               ERCACCT
   289     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   290     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3. ERCACCT
   291     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   292     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3. ERCACCT
   293     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   294     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3. ERCACCT
   295                                                                  ERCACCT
   296     12  AM-USER-FIELDS.                                          ERCACCT
   297         16  AM-FLD-1                      PIC XX.                ERCACCT
   298         16  AM-FLD-2                      PIC XX.                ERCACCT
   299         16  AM-FLD-3                      PIC XX.                ERCACCT
   300         16  AM-FLD-4                      PIC XX.                ERCACCT
   301         16  AM-FLD-5                      PIC XX.                ERCACCT
   302                                                                  ERCACCT
   303     12  AM-1ST-PROD-DATE.                                        ERCACCT
   304         16  AM-1ST-PROD-YR                PIC XX.                ERCACCT
   305         16  AM-1ST-PROD-MO                PIC XX.                ERCACCT
   306         16  AM-1ST-PROD-DA                PIC XX.                ERCACCT
   307     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.     ERCACCT
   308     12  AM-CERTS-PURGED-DATE.                                    ERCACCT
   309         16  AM-PUR-YR                     PIC XX.                ERCACCT
   310         16  AM-PUR-MO                     PIC XX.                ERCACCT
   311         16  AM-PUR-DA                     PIC XX.                ERCACCT
   312     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   313     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.     ERCACCT
   314     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.     ERCACCT
   315     12  AM-INACTIVE-DATE.                                        ERCACCT
   316         16  AM-INA-MO                     PIC 99.                ERCACCT
   317         16  AM-INA-DA                     PIC 99.                ERCACCT
   318         16  AM-INA-YR                     PIC 99.                ERCACCT
   319     12  AM-AR-HI-CERT-DATE                PIC XX.                ERCACCT
   320                                                                  ERCACCT
   321     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   322     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3. ERCACCT
   323                                                                  ERCACCT
   324     12  AM-OB-PAYMENT-MODE                PIC X.                 ERCACCT
   325         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.      ERCACCT
   326         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.          ERCACCT
   327         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.          ERCACCT
   328         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.          ERCACCT
   329                                                                  ERCACCT
   330     12  AM-AH-ONLY-INDICATOR              PIC X.                 ERCACCT
   331         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.      ERCACCT
   332         88  AM-NO-AH-ONLY                    VALUE 'N'.          ERCACCT
   333                                                                  ERCACCT
   334     12  AM-EDIT-LOAN-OFC                  PIC X(01).             ERCACCT
   335                                                                  ERCACCT
   336     12  AM-OVER-SHORT.                                           ERCACCT
   337         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3. ERCACCT
   338         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3. ERCACCT
   339                                                                  ERCACCT
   340     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   341     12  AM-DCC-CLP-STATE                  PIC XX.
   342                                                                  ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   343     12  AM-RECALC-COMM                    PIC X.                 ERCACCT
   344     12  AM-RECALC-REIN                    PIC X.                 ERCACCT
   345                                                                  ERCACCT
   346     12  AM-REI-TABLE                      PIC XXX.               ERCACCT
   347     12  AM-REI-ET-LF                      PIC X.                 ERCACCT
   348     12  AM-REI-ET-AH                      PIC X.                 ERCACCT
   349     12  AM-REI-PE-LF                      PIC X.                 ERCACCT
   350     12  AM-REI-PE-AH                      PIC X.                 ERCACCT
   351     12  AM-REI-PRT-ST                     PIC X.                 ERCACCT
   352     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3. ERCACCT
   353     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3. ERCACCT
   354     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3. ERCACCT
   355     12  AM-REI-GROUP-A                    PIC X(6).              ERCACCT
   356     12  AM-REI-MORT                       PIC X(4).              ERCACCT
   357     12  AM-REI-PRT-OW                     PIC X.                 ERCACCT
   358     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3. ERCACCT
   359     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3. ERCACCT
   360     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3. ERCACCT
   361     12  AM-REI-GROUP-B                    PIC X(6).              ERCACCT
   362                                                                  ERCACCT
   363     12  AM-TRUST-TYPE                     PIC X(2).              ERCACCT
   364                                                                  ERCACCT
   365     12  AM-EMPLOYER-STMT-USED             PIC X.                 ERCACCT
   366     12  AM-GROUPED-CHECKS-Y-N             PIC X.                 ERCACCT
   367                                                                  ERCACCT
   368     12  AM-STD-AH-TYPE                    PIC XX.                ERCACCT
   369     12  AM-EARN-METHODS.                                         ERCACCT
   370         16  AM-EARN-METHOD-R              PIC X.                 ERCACCT
   371             88 AM-REF-RL-R78                 VALUE 'R'.          ERCACCT
   372             88 AM-REF-RL-PR                  VALUE 'P'.          ERCACCT
   373             88 AM-REF-RL-MEAN                VALUE 'M'.          ERCACCT
   374             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.          ERCACCT
   375         16  AM-EARN-METHOD-L              PIC X.                 ERCACCT
   376             88 AM-REF-LL-R78                 VALUE 'R'.          ERCACCT
   377             88 AM-REF-LL-PR                  VALUE 'P'.          ERCACCT
   378             88 AM-REF-LL-MEAN                VALUE 'M'.          ERCACCT
   379             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.          ERCACCT
   380         16  AM-EARN-METHOD-A              PIC X.                 ERCACCT
   381             88 AM-REF-AH-R78                 VALUE 'R'.          ERCACCT
   382             88 AM-REF-AH-PR                  VALUE 'P'.          ERCACCT
   383             88 AM-REF-AH-MEAN                VALUE 'M'.          ERCACCT
   384             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.          ERCACCT
   385             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.          ERCACCT
   386             88 AM-REF-AH-NET                 VALUE 'N'.          ERCACCT
   387                                                                  ERCACCT
   388     12  AM-TOL-PREM                       PIC S999V99    COMP-3. ERCACCT
   389     12  AM-TOL-REF                        PIC S999V99    COMP-3. ERCACCT
   390     12  AM-TOL-CLM                        PIC S999V99    COMP-3. ERCACCT
   391                                                                  ERCACCT
   392     12  AM-RET-Y-N                        PIC X.                 ERCACCT
   393     12  AM-RET-P-E                        PIC X.                 ERCACCT
   394     12  AM-LF-RET                         PIC S9V9999    COMP-3. ERCACCT
   395     12  AM-AH-RET                         PIC S9V9999    COMP-3. ERCACCT
   396     12  AM-RET-GRP                        PIC X(6).              ERCACCT
   397     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.                    ERCACCT
   398         16  AM-POOL-PRIME                 PIC XXX.               ERCACCT
   399         16  AM-POOL-SUB                   PIC XXX.               ERCACCT
   400     12  AM-RETRO-EARNINGS.                                       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   401         16  AM-RET-EARN-R                 PIC X.                 ERCACCT
   402         16  AM-RET-EARN-L                 PIC X.                 ERCACCT
   403         16  AM-RET-EARN-A                 PIC X.                 ERCACCT
   404     12  AM-RET-ST-TAX-USE                 PIC X.                 ERCACCT
   405         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.  ERCACCT
   406         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.      ERCACCT
   407     12  AM-RETRO-BEG-EARNINGS.                                   ERCACCT
   408         16  AM-RET-BEG-EARN-R             PIC X.                 ERCACCT
   409         16  AM-RET-BEG-EARN-L             PIC X.                 ERCACCT
   410         16  AM-RET-BEG-EARN-A             PIC X.                 ERCACCT
   411     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3. ERCACCT
   412     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3. ERCACCT
   413                                                                  ERCACCT
   414     12  AM-USER-SELECT-OPTIONS.                                  ERCACCT
   415         16  AM-USER-SELECT-1              PIC X(10).             ERCACCT
   416         16  AM-USER-SELECT-2              PIC X(10).             ERCACCT
   417         16  AM-USER-SELECT-3              PIC X(10).             ERCACCT
   418         16  AM-USER-SELECT-4              PIC X(10).             ERCACCT
   419         16  AM-USER-SELECT-5              PIC X(10).             ERCACCT
   420                                                                  ERCACCT
   421     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   422                                                                  ERCACCT
   423     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3. ERCACCT
   424                                                                  ERCACCT
   425     12  AM-RPT045A-SWITCH                 PIC X.                 ERCACCT
   426         88  RPT045A-OFF                   VALUE 'N'.             ERCACCT
   427                                                                  ERCACCT
   428     12  AM-INSURANCE-LIMITS.                                     ERCACCT
   429         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3. ERCACCT
   430         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3. ERCACCT
   431                                                                  ERCACCT
   432     12  AM-PROFILE-CHANGE-SWITCH          PIC X.                 ERCACCT
   433         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.          ERCACCT
   434                                                                  ERCACCT
   435     12  AM-DISMBR-COVERAGE-SW             PIC X.                 ERCACCT
   436         88  AM-DISMBR-COVERAGE               VALUE 'Y'.          ERCACCT
   437         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.          ERCACCT
   438                                                                  ERCACCT
   439     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3. ERCACCT
   440                                                                  ERCACCT
   441     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3. ERCACCT
   442     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   443     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   444     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   445     12  AM-DCC-UEF-STATE                  PIC XX.
   446     12  FILLER                            PIC XXX.
   447     12  AM-REPORT-CODE-3                  PIC X(10).
   448*    12  FILLER                            PIC X(22).             ERCACCT
   449                                                                  ERCACCT
   450     12  AM-RESERVE-DATE.                                         ERCACCT
   451         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.    ERCACCT
   452         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.    ERCACCT
   453         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.    ERCACCT
   454                                                                  ERCACCT
   455     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.                ERCACCT
   456     12  AM-NOTIFICATION-TYPES.                                   ERCACCT
   457         16  AM-NOTIF-OF-LETTERS           PIC X.                 ERCACCT
   458         16  AM-NOTIF-OF-PAYMENTS          PIC X.                 ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   459         16  AM-NOTIF-OF-REPORTS           PIC X.                 ERCACCT
   460         16  AM-NOTIF-OF-STATUS            PIC X.                 ERCACCT
   461                                                                  ERCACCT
   462     12  AM-BENEFIT-TABLE-USAGE            PIC X.                 ERCACCT
   463         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.          ERCACCT
   464         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.          ERCACCT
   465         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.          ERCACCT
   466         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.     ERCACCT
   467                                                                  ERCACCT
   468     12  AM-BENEFIT-CONTROLS.                                     ERCACCT
   469         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.            ERCACCT
   470             20  AM-BENEFIT-CODE           PIC XX.                ERCACCT
   471             20  AM-BENEFIT-TYPE           PIC X.                 ERCACCT
   472             20  AM-BENEFIT-REVISION       PIC XXX.               ERCACCT
   473             20  AM-BENEFIT-REM-TERM       PIC X.                 ERCACCT
   474             20  AM-BENEFIT-RETRO-Y-N      PIC X.                 ERCACCT
   475             20  FILLER                    PIC XX.                ERCACCT
   476         16  FILLER                        PIC X(80).             ERCACCT
   477                                                                  ERCACCT
   478     12  AM-TRANSFER-DATA.                                        ERCACCT
   479         16  AM-TRANSFERRED-FROM.                                 ERCACCT
   480             20  AM-TRNFROM-CARRIER        PIC X.                 ERCACCT
   481             20  AM-TRNFROM-GROUPING.                             ERCACCT
   482                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.               ERCACCT
   483                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.               ERCACCT
   484             20  AM-TRNFROM-STATE          PIC XX.                ERCACCT
   485             20  AM-TRNFROM-ACCOUNT.                              ERCACCT
   486                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).             ERCACCT
   487                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).              ERCACCT
   488             20  AM-TRNFROM-DTE            PIC XX.                ERCACCT
   489         16  AM-TRANSFERRED-TO.                                   ERCACCT
   490             20  AM-TRNTO-CARRIER          PIC X.                 ERCACCT
   491             20  AM-TRNTO-GROUPING.                               ERCACCT
   492                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.               ERCACCT
   493                 24  AM-TRNTO-GRP-PRIME    PIC XXX.               ERCACCT
   494             20  AM-TRNTO-STATE            PIC XX.                ERCACCT
   495             20  AM-TRNTO-ACCOUNT.                                ERCACCT
   496                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).              ERCACCT
   497                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).              ERCACCT
   498             20  AM-TRNTO-DTE              PIC XX.                ERCACCT
   499         16  FILLER                        PIC X(10).             ERCACCT
   500                                                                  ERCACCT
   501     12  AM-SAVED-REMIT-TO                 PIC 99.                ERCACCT
   502                                                                  ERCACCT
   503     12  AM-COMM-STRUCTURE-SAVED.                                 ERCACCT
   504         16  AM-DEFN-1-SAVED.                                     ERCACCT
   505             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.           ERCACCT
   506                 24  AM-AGT-SV             PIC X(10).             ERCACCT
   507                 24  AM-COM-TYP-SV         PIC X.                 ERCACCT
   508                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   509                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   510                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3. ERCACCT
   511                 24  AM-RECALC-LV-INDIC-SV PIC X.                 ERCACCT
   512                 24  FILLER                PIC X.                 ERCACCT
   513                 24  AM-GL-CODES-SV        PIC X.                 ERCACCT
   514                 24  AM-COM-CHARGEBACK-SV  PIC 99.                ERCACCT
   515                 24  FILLER                PIC X.                 ERCACCT
   516         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.       ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   517             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.            ERCACCT
   518                 24  FILLER                PIC X(11).             ERCACCT
   519                 24  AM-L-COMA-SV          PIC XXX.               ERCACCT
   520                 24  AM-J-COMA-SV          PIC XXX.               ERCACCT
   521                 24  AM-A-COMA-SV          PIC XXX.               ERCACCT
   522                 24  FILLER                PIC X(6).              ERCACCT
   523                                                                  ERCACCT
   524     12  AM-FLC-NET-PREMIUM-ALLOWANCE.                            ERCACCT
   525         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.                 ERCACCT
   526            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3. ERCACCT
   527            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3. ERCACCT
   528            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3. ERCACCT
   529                                                                  ERCACCT
   530     12  AM-ORIG-DEALER-NO                 PIC X(10).             ERCACCT
   531     12  FILLER                            PIC X(120).            ERCACCT
   532                                                                  ERCACCT
   533     12  AM-ACCOUNT-EXECUTIVE-DATA.                               ERCACCT
   534         16  AM-CONTROL-NAME               PIC X(30).             ERCACCT
   535         16  AM-EXECUTIVE-ONE.                                    ERCACCT
   536             20  AM-EXEC1-NAME             PIC X(15).             ERCACCT
   537             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   538                                                          COMP-3. ERCACCT
   539             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   540                                                          COMP-3. ERCACCT
   541         16  AM-EXECUTIVE-TWO.                                    ERCACCT
   542             20  AM-EXEC2-NAME             PIC X(15).             ERCACCT
   543             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)       ERCACCT
   544                                                          COMP-3. ERCACCT
   545             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)       ERCACCT
   546                                                          COMP-3. ERCACCT
   547                                                                  ERCACCT
   548     12  AM-RETRO-ADDITIONAL-DATA.                                ERCACCT
   549         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3. ERCACCT
   550         16  AM-RETRO-PREM-P-E             PIC X.                 ERCACCT
   551         16  AM-RETRO-CLMS-P-I             PIC X.                 ERCACCT
   552         16  AM-RETRO-RET-BRACKET-LF.                             ERCACCT
   553             20  AM-RETRO-RET-METHOD-LF    PIC X.                 ERCACCT
   554                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.      ERCACCT
   555                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.          ERCACCT
   556             20  AM-RETRO-RET-BASIS-LF     PIC X.                 ERCACCT
   557                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.      ERCACCT
   558                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.          ERCACCT
   559             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.           ERCACCT
   560                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3. ERCACCT
   561                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3. ERCACCT
   562         16  AM-RETRO-RET-BRACKET-AH.                             ERCACCT
   563             20  AM-RETRO-RET-METHOD-AH    PIC X.                 ERCACCT
   564                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.      ERCACCT
   565                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.          ERCACCT
   566                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.          ERCACCT
   567             20  AM-RETRO-RET-BASIS-AH     PIC X.                 ERCACCT
   568                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.      ERCACCT
   569                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.          ERCACCT
   570             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.           ERCACCT
   571                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3. ERCACCT
   572                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3. ERCACCT
   573                                                                  ERCACCT
   574     12  AM-COMMENTS.                                             ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCACCT)
   575         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.ERCACCT
   576                                                                  ERCACCT
   577     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.         ERCACCT
   578         16  AM-FLI-RETRO-SHARE-CODE       PIC X.                 ERCACCT
   579         16  AM-FLI-BILLING-CODE           PIC X.                 ERCACCT
   580         16  AM-FLI-ALT-STATE-CODE         PIC XX.                ERCACCT
   581         16  AM-FLI-UNITED-IDENT           PIC X.                 ERCACCT
   582         16  AM-FLI-INTEREST-LOST-DATA.                           ERCACCT
   583             20  AM-FLI-BANK-NO            PIC X(5).              ERCACCT
   584             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3. ERCACCT
   585             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3. ERCACCT
   586             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3. ERCACCT
   587         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.            ERCACCT
   588             20  AM-FLI-AGT                PIC X(9).              ERCACCT
   589             20  AM-FLI-AGT-COMM-ACC       PIC X.                 ERCACCT
   590             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3. ERCACCT
   591         16  FILLER                        PIC X(102).            ERCACCT
   592                                                                  ERCACCT
   593     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.         ERCACCT
   594         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.          ERCACCT
   595             20  AM-BENEFIT-DMD-CODE         PIC XX.              ERCACCT
   596             20  AM-BENEFIT-DMD-TYPE         PIC X.               ERCACCT
   597             20  AM-BENEFIT-DMD-REVISION     PIC XXX.             ERCACCT
   598             20  AM-BENEFIT-DMD-REM-TERM     PIC X.               ERCACCT
   599             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.               ERCACCT
   600         16  FILLER                          PIC X(10).           ERCACCT
   601******************************************************************ERCACCT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS026P.cbl
   603 FD  ERRTBL-in.
*  604                             COPY ERCREIN.
   605******************************************************************07/27/93
   606*                                                                *ERCREIN
   607*                            ERCREIN                             *   LV009
   608*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   609*                            VMOD=2.010                          *   CL**9
   610*                                                                *ERCREIN
   611*   ONLINE CREDIT SYSTEM                                         *ERCREIN
   612*                                                                *ERCREIN
   613*   FILE DESCRIPTION = REINSURANCE MASTER FILE                   *ERCREIN
   614*                                                                *ERCREIN
   615*   FILE TYPE = VSAM,KSDS                                        *ERCREIN
   616*   RECORD SIZE = 4000  RECFORM = FIXED                          *ERCREIN
   617*                                                                *ERCREIN
   618*   BASE CLUSTER NAME = ERREIN                   RKP=2,LEN=8     *ERCREIN
   619*       ALTERNATE PATH = NONE                                    *ERCREIN
   620*                                                                *ERCREIN
   621*   LOG = NO                                                     *ERCREIN
   622*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *ERCREIN
   623*                                                                *ERCREIN
   624******************************************************************ERCREIN
   625*                   C H A N G E   L O G
   626*
   627* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   628*-----------------------------------------------------------------
   629*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   630* EFFECTIVE    NUMBER
   631*-----------------------------------------------------------------
   632* 103101    2001100100006  SMVA  ADD STATE EXHIBIT REPORT OPTION F
   633* 032707    2007032100006  PEMA  ADD EXCISE TAX CAPABILITY
   634******************************************************************
   635 01  REINSURANCE-RECORD.                                          ERCREIN
   636     12  RE-RECORD-ID                      PIC XX.                ERCREIN
   637         88  VALID-RE-ID                      VALUE 'RE'.         ERCREIN
   638                                                                  ERCREIN
   639     12  RE-CONTROL-PRIMARY.                                      ERCREIN
   640         16  RE-COMPANY-CD                 PIC X.                 ERCREIN
   641         16  RE-KEY.                                              ERCREIN
   642             20  RE-CODE                   PIC X.                 ERCREIN
   643                 88  RE-TABLE-RECORD          VALUE 'A'.          ERCREIN
   644                 88  RE-COMPANY-RECORD        VALUE 'B'.          ERCREIN
   645             20  RE-TABLE                  PIC XXX.               ERCREIN
   646             20  FILLER                    PIC XXX.               ERCREIN
   647         16  RE-COMPANY-KEY REDEFINES RE-KEY.                     ERCREIN
   648             20  FILLER                    PIC X.                 ERCREIN
   649             20  RE-COMPANY.                                      ERCREIN
   650                 24  RE-COMP-PRIME         PIC XXX.               ERCREIN
   651                 24  RE-COMP-SUB           PIC XXX.               ERCREIN
   652                                                                  ERCREIN
   653     12  RE-MAINT-INFORMATION.                                    ERCREIN
   654         16  RE-LAST-MAINT-DT              PIC XX.                ERCREIN
   655         16  RE-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3. ERCREIN
   656         16  RE-LAST-MAINT-USER            PIC X(4).              ERCREIN
   657         16  FILLER                        PIC X(10).             ERCREIN
   658                                                                  ERCREIN
   659     12  RE-TABLE-DATA.                                           ERCREIN
   660         16  RE-100-COMP                   PIC 99.                ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   661                                                                  ERCREIN
   662         16  RE-COMP-INFO    OCCURS 30 TIMES.                     ERCREIN
   663             20  RE-REI-COMP-NO.                                  ERCREIN
   664                 24  RE-REI-COMP           PIC XXX.               ERCREIN
   665                 24  RE-REI-COMP-SUB       PIC XXX.               ERCREIN
   666             20  RE-LF-QC                  PIC X.                 ERCREIN
   667             20  RE-AH-QC                  PIC X.                 ERCREIN
   668             20  RE-LO-DATE                PIC 9(11)     COMP-3.  ERCREIN
   669             20  RE-HI-DATE                PIC 9(11)     COMP-3.  ERCREIN
   670             20  RE-LFAGE-LO               PIC 99.                ERCREIN
   671             20  RE-LFAGE-HI               PIC 99.                ERCREIN
   672             20  RE-AHAGE-LO               PIC 99.                ERCREIN
   673             20  RE-AHAGE-HI               PIC 99.                ERCREIN
   674             20  RE-LFTRM-LO               PIC S999       COMP-3. ERCREIN
   675             20  RE-LFTRM-HI               PIC S999       COMP-3. ERCREIN
   676             20  RE-AHTRM-LO               PIC S999       COMP-3. ERCREIN
   677             20  RE-AHTRM-HI               PIC S999       COMP-3. ERCREIN
   678             20  RE-LF-PCT                 PIC S9V9999    COMP-3. ERCREIN
   679             20  RE-AH-PCT                 PIC S9V9999    COMP-3. ERCREIN
   680             20  RE-LF-LIM-LO              PIC S9(9)V99   COMP-3. ERCREIN
   681             20  RE-LF-LIM-HI              PIC S9(9)V99   COMP-3. ERCREIN
   682             20  RE-LF-LO                  PIC S9(9)V99   COMP-3. ERCREIN
   683             20  RE-LF-HI                  PIC S9(9)V99   COMP-3. ERCREIN
   684             20  RE-AHBEN-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   685             20  RE-AHBEN-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   686             20  RE-AHBEN-LO               PIC S9(7)V99   COMP-3. ERCREIN
   687             20  RE-AHBEN-HI               PIC S9(7)V99   COMP-3. ERCREIN
   688             20  RE-AHMOA-LIM-LO           PIC S9(7)V99   COMP-3. ERCREIN
   689             20  RE-AHMOA-LIM-HI           PIC S9(7)V99   COMP-3. ERCREIN
   690             20  RE-AHMOA-LO               PIC S9(7)V99   COMP-3. ERCREIN
   691             20  RE-AHMOA-HI               PIC S9(7)V99   COMP-3. ERCREIN
   692             20  RE-LF-BEN-CODE            PIC X.                 ERCREIN
   693             20  RE-AH-BEN-CODE            PIC X.                 ERCREIN
   694             20  RE-INTERACTIVE            PIC X.                 ERCREIN
   695             20  RE-REMAINING              PIC X.                 ERCREIN
   696             20  RE-LF-RUNOFF-SW           PIC X.                      000
   697             20  RE-AH-RUNOFF-SW           PIC X.                      000
   698             20  FILLER                    PIC X(19).                  000
   699                                                                  ERCREIN
   700         16  RE-COMP-INFO-END              PIC X(6).              ERCREIN
   701         16  RE-NSP-ST-CD-LF               PIC XX.                ERCREIN
   702         16  RE-NSP-ST-CD-AH               PIC XX.                ERCREIN
   703         16  RE-TABLE-CARRIER-SECURITY     PIC X.                 ERCREIN
   704             88  NO-TABLE-CARRIER-SECURITY    VALUE SPACE.        ERCREIN
   705                                                                  ERCREIN
   706         16  FILLER                        PIC X(27).             ERCREIN
   707                                                                  ERCREIN
   708     12  RE-COMPANY-DATA   REDEFINES   RE-TABLE-DATA.             ERCREIN
   709         16  RE-NAME                       PIC X(30).             ERCREIN
   710         16  RE-LF-PE                      PIC X.                 ERCREIN
   711         16  RE-AH-PE                      PIC X.                 ERCREIN
   712         16  RE-LF-FEE                     PIC S9V9999    COMP-3. ERCREIN
   713         16  RE-AH-FEE                     PIC S9V9999    COMP-3. ERCREIN
   714         16  RE-AH-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   715         16  RE-AH-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   716         16  RE-PRT-ST                     PIC X.                 ERCREIN
   717         16  RE-PRT-OW                     PIC X.                 ERCREIN
   718         16  RE-MORT-CODE                  PIC X(4).              ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   719         16  RE-CLAIM-CODE                 PIC X.                 ERCREIN
   720         16  RE-ZERO-LF-FEE                PIC X.                 ERCREIN
   721         16  RE-ZERO-AH-FEE                PIC X.                 ERCREIN
   722         16  RE-CEDE-NAME                  PIC X(30).             ERCREIN
   723         16  RE-LF-COMM                    PIC X.                 ERCREIN
   724         16  RE-AH-COMM                    PIC X.                 ERCREIN
   725         16  RE-LF-TAX                     PIC X.                 ERCREIN
   726         16  RE-AH-TAX                     PIC X.                 ERCREIN
   727         16  RE-CLM-INCURRED-LIM           PIC 9(11)  COMP-3.     ERCREIN
   728         16  RE-LF-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   729         16  RE-AH-IBNR-PCT                PIC SV999      COMP-3. ERCREIN
   730                                                                  ERCREIN
   731         16  RE-COMP-CARRIER-SECURITY      PIC X.                 ERCREIN
   732             88  NO-COMP-CARRIER-SECURITY     VALUE SPACE.        ERCREIN
   733                                                                  ERCREIN
   734         16  RE-LF-CEDING-FEE-BRACKETS.                           ERCREIN
   735             20  RE-LF-FEE-METHOD          PIC X.                 ERCREIN
   736                 88  RE-LF-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   737                 88  RE-LF-FEE-METHOD-1          VALUE '1'.       ERCREIN
   738                 88  RE-LF-FEE-METHOD-2          VALUE '2'.       ERCREIN
   739                 88  RE-LF-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   740             20  RE-LF-FEE-BASIS           PIC X.                 ERCREIN
   741                 88  RE-LF-GROSS-CEDED             VALUE '1'.     ERCREIN
   742                 88  RE-LF-NET-CEDED               VALUE '2'.     ERCREIN
   743                 88  RE-LF-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   744                 88  RE-LF-NET-WRITTEN             VALUE '4'.     ERCREIN
   745                 88  RE-LF-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   746                 88  RE-LF-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   747                 88  RE-LF-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   748                 88  RE-LF-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   749             20  FILLER                    PIC XXX.               ERCREIN
   750             20  RE-LF-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   751                 24  RE-LF-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   752                 24  RE-LF-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   753                                                                  ERCREIN
   754         16  RE-AH-CEDING-FEE-BRACKETS.                           ERCREIN
   755             20  RE-AH-FEE-METHOD          PIC X.                 ERCREIN
   756                 88  RE-AH-FEE-BRACKETED         VALUE '1' '2'.   ERCREIN
   757                 88  RE-AH-FEE-METHOD-1          VALUE '1'.       ERCREIN
   758                 88  RE-AH-FEE-METHOD-2          VALUE '2'.       ERCREIN
   759                 88  RE-AH-FEE-PERCENT           VALUE ' ' 'P'.   ERCREIN
   760             20  RE-AH-FEE-BASIS           PIC X.                 ERCREIN
   761                 88  RE-AH-GROSS-CEDED             VALUE '1'.     ERCREIN
   762                 88  RE-AH-NET-CEDED               VALUE '2'.     ERCREIN
   763                 88  RE-AH-GROSS-WRITTEN           VALUE '3'.     ERCREIN
   764                 88  RE-AH-NET-WRITTEN             VALUE '4'.     ERCREIN
   765                 88  RE-AH-COMBINE-GROSS-CEDED     VALUE '5'.     ERCREIN
   766                 88  RE-AH-COMBINE-NET-CEDED       VALUE '6'.     ERCREIN
   767                 88  RE-AH-COMBINE-GROSS-WRITTEN   VALUE '7'.     ERCREIN
   768                 88  RE-AH-COMBINE-NET-WRITTEN     VALUE '8'.     ERCREIN
   769             20  FILLER                    PIC XXX.               ERCREIN
   770             20  RE-AH-FEE-RANGES  OCCURS 6 TIMES.                ERCREIN
   771                 24  RE-AH-FEE-RANGE-PCT   PIC S9V9999    COMP-3. ERCREIN
   772                 24  RE-AH-FEE-THRU-AMT    PIC S9(7)V99   COMP-3. ERCREIN
   773                                                                  ERCREIN
   774         16  RE-EARNING-START-DT           PIC 9(11)  COMP-3.     ERCREIN
   775                                                                  ERCREIN
   776         16  RE-OLD-CEDING-STMT            PIC X.                    CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS026P.cbl (/apps/prod/cid1p/copy/ERCREIN)
   777                                                                  ERCREIN
   778         16  RE-LF-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   779         16  RE-AH-CLM-PCT                 PIC S9V9999    COMP-3. ERCREIN
   780         16  RE-LF-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   781         16  RE-AH-CLM-MAX                 PIC S9(7)V99   COMP-3. ERCREIN
   782         16  RE-LF-PR-PCT                  PIC S9V9999    COMP-3. ERCREIN
   783         16  RE-LF-78-PCT                  PIC S9V9999    COMP-3. ERCREIN
   784         16  RE-REINS-GROUPING-CODE        PIC X(6).              ERCREIN
   785         16  RE-MORT-SW                    PIC X.                 ERCREIN
   786         16  RE-CEDING-TYPE-FLAG           PIC X.                    CL**2
   787             88  RE-NO-CESSION-TYPE                VALUE ' '.        CL**2
   788             88  RE-CEDED                          VALUE 'C'.        CL**2
   789             88  RE-ASSUMED                        VALUE 'A'.        CL**2
   790             88  RE-PHANTOM                        VALUE 'P'.        CL**2
   791                                                                  ERCREIN
   792         16  RE-CEDING-STMT-OPT-A          PIC X.                    CL**3
   793             88  REPORT-A-WANTED    VALUE ' ' 'Y'.                   CL**3
   794         16  RE-CEDING-STMT-OPT-B          PIC X.                    CL**3
   795             88  REPORT-B-WANTED    VALUE ' ' 'Y'.                   CL**3
   796         16  RE-CEDING-STMT-OPT-C          PIC X.                    CL**3
   797             88  REPORT-C-WANTED    VALUE ' ' 'Y'.                   CL**3
   798         16  RE-CEDING-STMT-OPT-D          PIC X.                    CL**3
   799             88  REPORT-D-WANTED    VALUE ' ' 'Y'.                   CL**3
   800         16  RE-CEDING-STMT-OPT-E          PIC X.                    CL**3
   801             88  REPORT-E-WANTED    VALUE ' ' 'Y'.                   CL**3
   802                                                                     CL**3
   803         16  RE-PRT-CRSV                   PIC X.                    CL**5
   804                                                                     CL**5
   805         16  RE-GL-CENTER                  PIC X(4).                 CL**6
   806                                                                     CL**8
   807         16  RE-CUSTODIAL-BAL              PIC S9(7)V99   COMP-3.    CL**8
   808                                                                     CL**8
   809         16  RE-EARNING-STOP-DT            PIC 9(11)  COMP-3.        CL**9
   810                                                                     CL**9
   811         16  RE-EARN-STOP-CODE             PIC X.                    CL**9
   812             88  STOP-LIFE-EARNING  VALUE 'L' 'B'.                   CL**9
   813             88  STOP-AH-EARNING    VALUE 'A' 'B'.                   CL**9
   814
   815         16  RE-STATE-EXHIBIT-OPT-F        PIC X.
   816             88  RPTF-ECS152-WANTED VALUE ' ' 'Y'.
   817                                                                     CL**9
   818         16  RE-EXCISE-TAX                 PIC S9V9999 COMP-3.
   819         16  FILLER                        PIC X(2281).              CL**9
   820                                                                  ERCREIN
   821         16  RE-DESC OCCURS 18 TIMES       PIC X(79).             ERCREIN
   822                                                                  ERCREIN
   823******************************************************************ERCREIN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS026P.cbl
   825 FD  CERT-IN
   826     RECORDING MODE F.
*  827                             COPY ECSCRT01.
   828******************************************************************
   829*                                                                *
   830*                            ECSCRT01                            *
   831*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   832*                            VMOD=2.016                          *
   833*                                                                *
   834*   FILE DESCRIPTION = CERTIFICATE RECORD    (OFF-LINE)          *
   835*                                                                *
   836*   FILE TYPE = SEQUENTIAL
   837*   RECORD SIZE = 1056 RECFORM = FIXED                           *
   838*                                                                *
   839*   KEY DATA =                         START=4, LEN=36           *
   840*                                                                *
   841*  NO  CID  MODS  IN  COPYBOOK  ECSCRT01                         *
   842*                                                                *
   843******************************************************************
   844******************************************************************
   845*                   C H A N G E   L O G
   846*
   847* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   848*-----------------------------------------------------------------
   849*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   850* EFFECTIVE    NUMBER
   851*-----------------------------------------------------------------
   852* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   853* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
   854* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   855* 020305    2005020000000  PEMA  ADD CLP STATE TO CERT RECORD
   856* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   857* 042408    2007110500003  PEMA  ADD REFUND INTEREST PROCESSING
   858* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   859* 032612  CR2011110200001  PEMA  AHL CHANGES
   860* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
   861* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   862******************************************************************
   863
   864 01  CERTIFICATE-RECORD.
   865     12  CR-RECORD-ID                      PIC XX.
   866         88  VALID-CR-ID                      VALUE 'CR'.
   867
   868     12  CR-COMPANY-CD                     PIC X.
   869
   870     12  CR-FULL-CONTROL.
   871         16  CR-CONTROL-1.
   872             20  CR-ACCT-CONTROL.
   873                 24  CR-CARRIER            PIC X.
   874                 24  CR-GROUPING.
   875                     28  CR-GROUP-PREFIX   PIC XXX.
   876                     28  CR-GROUP-PRIME    PIC XXX.
   877                 24  CR-STATE              PIC XX.
   878                 24  CR-ACCOUNT.
   879                     28  CR-ACCT-PREFIX    PIC X(4).
   880                     28  CR-ACCT-PRIME     PIC X(6).
   881             20  CR-DT                     PIC 9(11)  COMP-3.
   882         16  CR-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   883             20  CR-CERT.
   884                 24  CR-CERT-PREFIX        PIC X(3).
   885                 24  CR-CERT-PRIME         PIC X(7).
   886             20  CR-CERT-SFX               PIC X.
   887
   888     12  CR-INSUREDS-PROFILE.
   889         16  CR-NAME.
   890             20  CR-LNAME                  PIC X(15).
   891             20  CR-FNAME.
   892                 24  CR-1ST-INITIAL        PIC X.
   893                 24  FILLER                PIC X(9).
   894             20  CR-INIT                   PIC X.
   895         16  CR-AGE                        PIC 99.
   896         16  CR-SEX                        PIC X.
   897             88  CR-SEX-MALE                  VALUE 'M'.
   898             88  CR-SEX-FEMALE                VALUE 'F'.
   899         16  CR-SOC-SEC                    PIC X(11).
   900         16  CR-JOINT-NAME.
   901             20  CR-JT-LNAME               PIC X(15).
   902             20  CR-JT-FNAME.
   903                 24  CR-JT-1ST-INIT        PIC X.
   904                 24  FILLER                PIC X(9).
   905             20  CR-JT-INIT                PIC X.
   906         16  CR-JOINT-AGE                  PIC 99.
   907
   908         16  cr-ahl-ah-claim-no            pic x(9).
   909         16  cr-ahl-ah-cert-seq            pic x(3).
   910         16  cr-hst-proc-lf                pic x.
   911         16  f                             pic x(7).
   912
   913     12  CR-LF-COVERAGE-DATA.
   914         16  CR-LFTYP                      PIC XX.
   915         16  CR-LF-TERM                    PIC S999       COMP-3.
   916         16  CR-LF-CRIT-PERIOD             PIC S999       COMP-3.
   917         16  CR-LF-TERM-IN-DAYS            PIC S9(5)      COMP-3.
   918         16  CR-LF-DEV-CODE                PIC XXX.
   919         16  CR-LF-DEV-PCT                 PIC S9V9(6)    COMP-3.
   920
   921         16  CR-LFAMT                      PIC S9(9)V99   COMP-3.
   922         16  CR-LFPRM                      PIC S9(7)V99   COMP-3.
   923         16  CR-LFPRM-CALC                 PIC S9(7)V99   COMP-3.
   924         16  CR-LFPRM-RATE                 PIC S99V9(5)   COMP-3.
   925
   926         16  CR-LFAMT-ALT                  PIC S9(9)V99   COMP-3.
   927         16  CR-LFPRM-ALT                  PIC S9(7)V99   COMP-3.
   928         16  CR-LFPRM-CALC-ALT             PIC S9(7)V99   COMP-3.
   929         16  CR-LFPRM-RATE-ALT             PIC S99V9(5)   COMP-3.
   930
   931         16  CR-LFRFND                     PIC S9(7)V99   COMP-3.
   932         16  CR-LFRFND-CALC                PIC S9(7)V99   COMP-3.
   933
   934         16  CR-LF-NSP-PRM                 PIC S9(7)V99   COMP-3.
   935         16  CR-LF-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   936
   937         16  CR-LF-REFUND-TYPE             PIC X.
   938         16  CR-LF-POLICY-FEE              PIC S9(3)V99   COMP-3.
   939
   940         16  CR-LF-COMM-CHARGEBACK         PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   941             88  CR-NO-LF-CHARGEBACK          VALUE 'N'.
   942
   943         16  CR-LF-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   944
   945         16  CR-LF-EXPIRE-DATE             PIC 9(11)      COMP-3.
   946         16  CR-LF-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   947         16  CR-LF-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   948
   949         16  cr-ahl-lf-claim-no            pic x(9).
   950         16  cr-ahl-lf-cert-seq            pic x(3).
   951         16  FILLER                        PIC XX.
   952
   953     12  CR-AH-COVERAGE-DATA.
   954         16  CR-AHTYP                      PIC XX.
   955         16  CR-AH-TERM                    PIC S999       COMP-3.
   956         16  CR-AH-CRIT-PERIOD             PIC S999       COMP-3.
   957         16  CR-AH-DEV-CODE                PIC XXX.
   958         16  CR-AH-DEV-PCT                 PIC S9V9(6)    COMP-3.
   959
   960         16  CR-AHAMT                      PIC S9(7)V99   COMP-3.
   961         16  CR-AHPRM                      PIC S9(7)V99   COMP-3.
   962         16  CR-AHPRM-CALC                 PIC S9(7)V99   COMP-3.
   963         16  CR-AHPRM-RATE                 PIC S99V9(5)   COMP-3.
   964
   965         16  CR-AHRFND                     PIC S9(7)V99   COMP-3.
   966         16  CR-AHRFND-CALC                PIC S9(7)V99   COMP-3.
   967
   968         16  CR-AH-NSP-PRM                 PIC S9(7)V99   COMP-3.
   969         16  CR-AH-NSP-PRM-RATE            PIC S99V9(5)   COMP-3.
   970
   971         16  CR-AH-REFUND-TYPE             PIC X.
   972         16  CR-AH-POLICY-FEE              PIC S9(3)V99   COMP-3.
   973
   974         16  CR-AH-COMM-CHARGEBACK         PIC X.
   975             88  CR-NO-AH-CHARGEBACK          VALUE 'N'.
   976
   977         16  CR-AH-REI-RISK-PRM            PIC S9(7)V99   COMP-3.
   978
   979         16  CR-AH-EXPIRE-DATE             PIC 9(11)      COMP-3.
   980         16  CR-AH-ISS-PREM-TAX            PIC S9V9(4)    COMP-3.
   981         16  CR-AH-CNC-PREM-TAX            PIC S9V9(4)    COMP-3.
   982
   983         16  FILLER                        PIC XX.
   984*        16  FILLER                        PIC X(8).
   985
   986     12  CR-LOAN-DATA.
   987         16  CR-LIVES                      PIC S9(7)      COMP-3.
   988         16  CR-DDF-IU-RATE-UP REDEFINES CR-LIVES
   989                                           PIC S9(5)V99   COMP-3.
   990         16  CR-BILLED                     PIC S9(7)      COMP-3.
   991         16  CR-APR                        PIC S999V9(4)  COMP-3.
   992         16  CR-PMT-FREQ                   PIC 99.
   993         16  CR-LOAN-TERM                  PIC S999       COMP-3.
   994         16  CR-RATING-CLASS               PIC XX.
   995         16  CR-POLICY-FORM-NO             PIC X(12).
   996         16  CR-GRPTYP                     PIC XX.
   997         16  CR-IND-GRP                    PIC X.
   998             88  CR-INDIVIDUAL                VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
   999             88  CR-GROUP                     VALUE '2'.
  1000         16  CR-SKIP                       PIC 99.
  1001             88  NO-MONTHS-SKIPPED            VALUE 00.
  1002             88  SKIP-JULY                    VALUE 01.
  1003             88  SKIP-AUGUST                  VALUE 02.
  1004             88  SKIP-SEPTEMBER               VALUE 03.
  1005             88  SKIP-JULY-AUG                VALUE 04.
  1006             88  SKIP-AUG-SEPT                VALUE 05.
  1007             88  SKIP-JULY-AUG-SEPT           VALUE 06.
  1008             88  SKIP-JUNE-JULY-AUG           VALUE 07.
  1009             88  SKIP-JUNE                    VALUE 08.
  1010             88  SKIP-JUNE-JULY               VALUE 09.
  1011             88  SKIP-AUG-SEPT-OCT            VALUE 10.
  1012             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 11.
  1013         16  CR-RESIDENT-STATE             PIC XX.
  1014         16  CR-RATE-CODE.
  1015             20  CR-LF-CLASS-CD            PIC XX.
  1016             20  CR-AH-CLASS-CD            PIC XX.
  1017         16  CR-MORT.
  1018             20  CR-TAB                    PIC X.
  1019             20  CR-INT                    PIC 99.
  1020             20  CR-GRP                    PIC X.
  1021         16  CR-MEMBER-NO                  PIC X(12).
  1022         16  CR-OLD-LOF                    PIC XXX.
  1023*        16  CR-LOAN-OFFICER               PIC XXX.
  1024         16  CR-REIN-TABLE                 PIC XXX.
  1025         16  CR-REIN-SPEC                  PIC X.
  1026         16  CR-LOAN-1ST-PMT-DT.
  1027             20  CR-1ST-PMT-YR             PIC 99.
  1028             20  CR-1ST-PMT-MO             PIC 99.
  1029             20  CR-1ST-PMT-DA             PIC 99.
  1030         16  CR-SUM-CAN-CNT-ITD            PIC S999       COMP-3.
  1031         16  CR-SUM-CAN-CNT-YTD            PIC S999       COMP-3.
  1032         16  CR-PMT-EXTENSION-DAYS         PIC S999       COMP-3.
  1033         16  CR-LAST-ADD-ON-DT             PIC XX.
  1034
  1035         16  CR-UNDERWRITING-CODE          PIC X.
  1036             88  CR-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1037
  1038         16  CR-STATE-TAX                  PIC S9(7)V99   COMP-3.
  1039         16  CR-MUNI-TAX                   PIC S9(7)V99   COMP-3.
  1040         16  CR-CANCEL-STATE-TAX           PIC S9(7)V99   COMP-3.
  1041         16  CR-CANCEL-MUNI-TAX            PIC S9(7)V99   COMP-3.
  1042
  1043     12  CR-STATUS-INFORMATION.
  1044         16  CR-ENTRY-STATUS               PIC X.
  1045             88  CR-NORMAL-ENTRY              VALUE '1'.
  1046             88  CR-POLICY-IS-RESTORE         VALUE '3'.
  1047             88  CR-CONVERSION-ENTRY          VALUE '4'.
  1048             88  CR-POLICY-IS-REISSUE         VALUE '5'.
  1049             88  CR-POLICY-IS-CASH            VALUE 'C'.
  1050             88  CR-POLICY-IS-MONTHLY         VALUE 'M'.
  1051             88  CR-POLICY-IS-REIN-ONLY       VALUE '9'.
  1052             88  CR-POLICY-IS-DECLINED        VALUE 'D'.
  1053             88  CR-POLICY-IS-VOID            VALUE 'V'.
  1054             88  CR-POLICY-IS-PREM-ONLY       VALUE 'P'.
  1055             88  CR-POLICY-IS-ACTIVE          VALUE '1' '3' '4'
  1056                                                'C' '5' '9' 'P'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1057         16  CR-ENTRY-DATE                 PIC 9(11)  COMP-3.
  1058
  1059         16  CR-LF-STATUS-AT-CANCEL        PIC X.
  1060         16  CR-LF-CANC-DT                 PIC 9(11)  COMP-3.
  1061         16  CR-LF-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  1062
  1063         16  CR-LF-STATUS-AT-DEATH         PIC X.
  1064         16  CR-LF-CLAIM-EXIT-DATE         PIC 9(11)  COMP-3.
  1065
  1066         16  CR-LF-CURRENT-STATUS          PIC X.
  1067             88  CR-LF-NORMAL-ENTRY           VALUE '1'.
  1068             88  CR-LF-POLICY-PENDING         VALUE '2'.
  1069             88  CR-LF-POLICY-IS-RESTORE      VALUE '3'.
  1070             88  CR-LF-CONVERSION-ENTRY       VALUE '4'.
  1071             88  CR-LF-POLICY-IS-REISSUE      VALUE '5'.
  1072             88  CR-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1073             88  CR-LF-LUMP-SUM-DISAB         VALUE '6'.
  1074             88  CR-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1075             88  CR-LF-CANCEL-APPLIED         VALUE '8'.
  1076             88  CR-LF-IS-REIN-ONLY           VALUE '9'.
  1077             88  CR-LF-IS-DECLINED            VALUE 'D'.
  1078             88  CR-LF-IS-VOID                VALUE 'V'.
  1079             88  CR-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1080                                                    '4' '5' '9'.
  1081
  1082         16  CR-AH-STATUS-AT-CANCEL        PIC X.
  1083
  1084         16  CR-AH-CANC-DT                 PIC 9(11)  COMP-3.
  1085         16  CR-AH-CANCEL-EXIT-DATE        PIC 9(11)  COMP-3.
  1086
  1087         16  CR-AH-STATUS-AT-SETTLEMENT    PIC X.
  1088         16  CR-AH-SETTLEMENT-EXIT-DATE    PIC 9(11)  COMP-3.
  1089
  1090         16  CR-AH-CURRENT-STATUS          PIC X.
  1091             88  CR-AH-NORMAL-ENTRY           VALUE '1'.
  1092             88  CR-AH-POLICY-PENDING         VALUE '2'.
  1093             88  CR-AH-POLICY-IS-RESTORE      VALUE '3'.
  1094             88  CR-AH-CONVERSION-ENTRY       VALUE '4'.
  1095             88  CR-AH-POLICY-IS-REISSUE      VALUE '5'.
  1096             88  CR-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1097             88  CR-AH-LUMP-SUM-DISAB         VALUE '6'.
  1098             88  CR-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1099             88  CR-AH-CANCEL-APPLIED         VALUE '8'.
  1100             88  CR-AH-IS-REIN-ONLY           VALUE '9'.
  1101             88  CR-AH-IS-DECLINED            VALUE 'D'.
  1102             88  CR-AH-IS-VOID                VALUE 'V'.
  1103             88  CR-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1104                                                    '4' '5' '9'.
  1105         16  CR-LOAN-OFFICER               PIC X(5).
  1106         16  CR-CANCEL-REASON              PIC X.
  1107         16  cr-xycor-lf-cov-code          pic x(4).
  1108         16  cr-xycor-ah-cov-code          pic x(4).
  1109         16  cr-temp-epiq                  pic x(4).
  1110         16  FILLER                        PIC XX.
  1111
  1112     12  CR-DEATH-CLAIM-DATA.
  1113         16  CR-NUM-DTH-CLM                PIC S999       COMP-3.
  1114
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1115         16  CR-DTH-DT                     PIC 9(11)      COMP-3.
  1116         16  CR-DTH-RPT-DT.
  1117             20  CR-DTH-RPT-YR             PIC 99.
  1118             20  CR-DTH-RPT-MO             PIC 99.
  1119             20  CR-DTH-RPT-DA             PIC 99.
  1120         16  CR-DTH-PAY-DT                 PIC 9(11)      COMP-3.
  1121
  1122         16  CR-DTHAMT                     PIC S9(9)V99   COMP-3.
  1123         16  CR-DTHAMT-YTD                 PIC S9(9)V99   COMP-3.
  1124         16  CR-DTHAMT-LAST                PIC S9(9)V99   COMP-3.
  1125         16  CR-DTHEXP                     PIC S9(7)V99   COMP-3.
  1126         16  CR-DTHEXP-YTD                 PIC S9(7)V99   COMP-3.
  1127
  1128         16  CR-DTH-AGE                    PIC 99.
  1129         16  CR-DTH-PAY-CD                 PIC X.
  1130         16  CR-DEATH-CAUSE                PIC X(6).
  1131
  1132         16  FILLER                        PIC X(16).
  1133
  1134     12  CR-DISAB-CLAIM-DATA.
  1135         16  CR-NUM-DIS-CLM                PIC S999       COMP-3.
  1136
  1137         16  CR-DIS-DT                     PIC 9(11)      COMP-3.
  1138         16  CR-DIS-RPT-DT.
  1139             20  CR-DIS-RPT-YR             PIC 99.
  1140             20  CR-DIS-RPT-MO             PIC 99.
  1141             20  CR-DIS-RPT-DA             PIC 99.
  1142         16  CR-DIS-PAY-DT                 PIC 9(11)      COMP-3.
  1143         16  CR-DIS-PTO-DT                 PIC 9(11)      COMP-3.
  1144
  1145         16  CR-DISAMT                     PIC S9(9)V99   COMP-3.
  1146         16  CR-DISAMT-YTD                 PIC S9(9)V99   COMP-3.
  1147         16  CR-DISAMT-LAST                PIC S9(9)V99   COMP-3.
  1148         16  CR-DISEXP                     PIC S9(7)V99   COMP-3.
  1149         16  CR-DISEXP-YTD                 PIC S9(7)V99   COMP-3.
  1150
  1151         16  CR-DAYS-DISAB                 PIC 999        COMP-3.
  1152         16  CR-DIS-PAY-CD                 PIC X.
  1153         16  FILLER                        PIC XX.
  1154
  1155         16  CR-DISAB-INCURRED-DETAIL.
  1156             20  CR-DISAB-DETAIL-DATA  OCCURS 5 TIMES.
  1157**ELCCRTVR MUST BE CHANGED IF THE "OCCURS" IS CHANGED.
  1158                 24  CR-DIS-INCUR-DT       PIC 9(11)     COMP-3.
  1159                 24  CR-INCUR-DISAMT       PIC S9(9)V99  COMP-3.
  1160                 24  CR-INCUR-DISEXP       PIC S9(9)V99  COMP-3.
  1161
  1162         16  CR-DISAB-CAUSE                PIC X(6).
  1163         16  FILLER                        PIC X(14).
  1164
  1165     12  CR-REMIT-TO                       PIC 99.
  1166
  1167     12  CR-COMPENSATION-LEVELS.
  1168         16  CR-AGT-LEVELS      OCCURS 10 TIMES.
  1169             20  CR-COM-AGT.
  1170                 24  CR-COM-AGT-PREFIX     PIC X(4).
  1171                 24  CR-COM-AGT-PRIME      PIC X(6).
  1172             20  CR-AGT-TYPE               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSCRT01)
  1173             20  CR-LCOM-L                 PIC SV9(5)     COMP-3.
  1174             20  CR-LCOM-AH                PIC SV9(5)     COMP-3.
  1175
  1176     12  CR-BANK-NOCHRGB-MONTHS            PIC 99.
  1177     12  CR-MOB-NET-TOT-FEES               PIC S9(7)V99   COMP-3.
  1178     12  CR-ADDL-CLP                       PIC S9(5)V99   COMP-3.
  1179     12  CR-CLP-STATE                      PIC XX.
  1180     12  CR-POST-CARD-IND                  PIC X.
  1181     12  CR-LF-CLP                         PIC S9(5)V99   COMP-3.
  1182     12  CR-AH-CLP                         PIC S9(5)V99   COMP-3.
  1183     12  CR-DCC-PRODUCT-CODE               PIC XXX.
  1184     12  CR-LF-RFND-CLP                    PIC S9(5)V99   COMP-3.
  1185     12  CR-AH-RFND-CLP                    PIC S9(5)V99   COMP-3.
  1186     12  FILLER                            PIC X(07).
  1187
  1188     12  CR-CSR-CODE                       PIC XXX.
  1189
  1190     12  CR-CLAIM-DEDUCT-WITHHELD          PIC S9(5)V99   COMP-3.
  1191     12  CR-CANCEL-DEDUCT-WITHHELD         PIC S9(5)V99   COMP-3.
  1192
  1193     12  CR-MICROFILM-NUMBERS.
  1194*        16  CR-ISS-MICROFILM-NO           PIC S9(9)      COMP-3.
  1195         16  FILLER                        PIC X(5).
  1196     12  CR-NH-INT-ON-REF                  PIC S9(7)V99   COMP-3.
  1197
  1198     12  CR-USER-CODE                      PIC X.
  1199     12  CR-USER-FUTURE                    PIC X(9).
  1200
  1201     12  CR-BENEFICIARY.
  1202         16  CR-BANK-NO                    PIC X(10).
  1203         16  FILLER                        PIC X(15).
  1204
  1205     12  CR-ENTRY-BATCH                    PIC X(6).
  1206     12  CR-LF-EXIT-BATCH                  PIC X(6).
  1207     12  CR-AH-EXIT-BATCH                  PIC X(6).
  1208
  1209     12  CR-NOTE-SW                        PIC X.
  1210
  1211     12  CR-ORIGIN-INDICATOR               PIC X.
  1212         88  CR-ENTERED-MANUALLY              VALUE '1'.
  1213         88  CR-CREATED-FROM-TAPE-LOAD        VALUE '2'.
  1214
  1215     12  CR-LF-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  1216     12  CR-AH-CNC-ENT-DT                  PIC 9(11)  COMP-3.
  1217     12  FILLER                            PIC X(33).
  1218
  1219******************************************************************
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS026P.cbl
  1221 FD  REIN-WORK
  1222     RECORDING MODE F
  1223     BLOCK CONTAINS 0 RECORDS.
  1224
  1225 01  REIN-WORK-REC           PIC X(124).
  1226
  1227 FD  TEMP-WORK
  1228     RECORDING MODE F
  1229     BLOCK CONTAINS 0 RECORDS.
  1230
  1231 01  TEMP-WORK-REC           PIC X(1141).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS026P.cbl
  1233 FD  DISK-DATE
* 1234                             COPY ELCDTEFD.
  1235******************************************************************04/15/98
  1236*                                                                *ELCDTEFD
  1237*                                                                *ELCDTEFD
  1238*                            ELCDTEFD.                           *   LV002
  1239*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1240*                            VMOD=2.007                          *   CL**2
  1241*                                                                *ELCDTEFD
  1242******************************************************************ELCDTEFD
  1243     BLOCK CONTAINS 0 RECORDS
  1244     RECORDING MODE F.                                            ELCDTEFD
  1245                                                                  ELCDTEFD
  1246 01  DATE-DISK.                                                   ELCDTEFD
  1247     12  DD-ID                       PIC  X(4).                   ELCDTEFD
  1248     12  FILLER                      PIC  X(14).                  ELCDTEFD
  1249     12  DD-CR1                      PIC  9.                      ELCDTEFD
  1250     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
  1251     12  DD-CR2                      PIC  9.                      ELCDTEFD
  1252     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
  1253     12  FILLER                      PIC  X(20).                  ELCDTEFD
  1254                                                                  ELCDTEFD
  1255 01  DATE-DISK-R.                                                 ELCDTEFD
  1256     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1257     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
  1258                                     PIC  X(32).                  ELCDTEFD
  1259                                                                  ELCDTEFD
  1260 01  DATE-DISK-T.                                                 ELCDTEFD
  1261     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1262     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
  1263                                     PIC  X(48).                  ELCDTEFD
  1264                                                                  ELCDTEFD
  1265 01  DATE-DISK-M.                                                 ELCDTEFD
  1266     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1267     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
  1268                                     PIC  X(48).                  ELCDTEFD
  1269                                                                  ELCDTEFD
  1270 01  DATE-DISK-P.                                                 ELCDTEFD
  1271     12  DD-IDA                      PIC  XX.                     ELCDTEFD
  1272     12  DD-IDX                      PIC  99.                     ELCDTEFD
  1273     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
  1274     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1275         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
  1276                                     PIC  X.                      ELCDTEFD
  1277         16  FILLER                  PIC  X(46).                  ELCDTEFD
  1278     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
  1279         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
  1280             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
  1281             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
  1282             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
  1283             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
  1284         16  FILLER                  PIC  X(16).                  ELCDTEFD
  1285                                                                  ELCDTEFD
  1286 01  DATE-DISK-E.                                                 ELCDTEFD
  1287     12  FILLER                      PIC  X(4).                   ELCDTEFD
  1288     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
  1289                                     PIC  X(4).                   ELCDTEFD
  1290                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
  1291 01  DATE-DISK-C.                                                 ELCDTEFD
  1292     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1293     12  DD-CARR1-SECPAY-SW          PIC  X.
  1294     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1295     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1296     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1297     12  DD-CARR1                    PIC  X.                      ELCDTEFD
  1298     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
  1299     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
  1300     12  DD-CARR2                    PIC  X.                      ELCDTEFD
  1301     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
  1302     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
  1303     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1304     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1305     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
  1306     12  DD-CARR2-SECPAY-SW          PIC  X.
  1307     12  FILLER                      PIC  X(7).                   ELCDTEFD
  1308                                                                  ELCDTEFD
  1309 01  DATE-DISK-OPT.                                               ELCDTEFD
  1310     12  FILLER                      PIC  X(04).                  ELCDTEFD
  1311     12  DD-TLR-DATA.                                             ELCDTEFD
  1312         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
  1313                                     PIC  X(03).                  ELCDTEFD
  1314     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
  1315         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
  1316                                     PIC  X(06).                  ELCDTEFD
  1317     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
  1318         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
  1319                                     PIC  X(07).                  ELCDTEFD
  1320         16  FILLER                  PIC  X(05).                  ELCDTEFD
  1321     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
  1322                                     PIC  X(96).                  ELCDTEFD
  1323******************************************************************ELCDTEFD
  1324
  1325 FD  FICH
* 1326                             COPY ELCFCHFD.
  1327******************************************************************04/15/98
  1328*                                                                *ELCFCHFD
  1329*                            ELCFCHFD.                           *   LV003
  1330*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1331*                            VMOD=2.004                          *   CL**3
  1332*                                                                *ELCFCHFD
  1333******************************************************************ELCFCHFD
  1334     BLOCK CONTAINS 0 RECORDS
  1335     RECORDING MODE F.                                            ELCFCHFD
  1336                                                                  ELCFCHFD
  1337 01  FICH-REC                            PIC   X(133).            ELCFCHFD
  1338******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS026P.cbl
  1340 WORKING-STORAGE SECTION.
  1341 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
  1342 77  FILLER  PIC X(32) VALUE '********************************'.
  1343 77  FILLER  PIC X(32) VALUE '     ECS026 WORKING STORAGE     '.
  1344 77  FILLER  PIC X(32) VALUE '******** VMOD=2.021 ************'.
  1345
  1346 77  PGM-SUB                 PIC S9(4)  COMP     VALUE +026.
  1347 77  A-SUB1                  PIC S9(4)  COMP     VALUE +0.
  1348 77  A-SUB2                  PIC S9(4)  COMP     VALUE +0.
  1349 77  P-SUB1                  PIC S9(4)  COMP     VALUE +0.
  1350 77  P-SUB2                  PIC S9(4)  COMP     VALUE +0.
  1351 77  SUB5                    PIC S9(4)  COMP     VALUE +0.
  1352 77  S1                      PIC S9(4)  COMP     VALUE +0.
  1353 77  CERT-END-SW             PIC X               VALUE 'N'.
  1354     88  END-OF-CERT                             VALUE 'Y'.
  1355 77  ACCT-END-SW             PIC X               VALUE 'N'.
  1356     88  END-OF-ACCT                             VALUE 'Y'.
  1357 77  EXTR-END-SW             PIC X               VALUE 'N'.
  1358     88  END-OF-EXTR                             VALUE 'Y'.
  1359 77  CERT-NEEDED-SW          PIC X               VALUE 'Y'.
  1360     88  CERT-NEEDED                             VALUE 'Y'.
  1361 77  ACCOUNT-NEEDED-SW       PIC X               VALUE 'Y'.
  1362     88  ACCOUNT-NEEDED                          VALUE 'Y'.
  1363 77  EXTR-NEEDED-SW          PIC X               VALUE 'Y'.
  1364     88  EXTR-NEEDED                             VALUE 'Y'.
  1365 77  CERT-ACCT-MATCH-SW      PIC X               VALUE 'N'.
  1366     88  NO-MATCH                                VALUE 'N'.
  1367 77  ACCOUNT-BREAK-SW        PIC X               VALUE 'N'.
  1368     88  ACCT-BREAK                              VALUE 'Y'.
  1369 77  ACCT-HAS-BIZ-SW         PIC X               VALUE 'N'.
  1370     88  NO-BIZ                                  VALUE 'N'.
  1371 77  FIRST-TIME-SW           PIC X               VALUE 'Y'.
  1372     88  FIRST-TIME                              VALUE 'Y'.
  1373 77  FIRST-READ-SW           PIC X               VALUE 'Y'.
  1374     88  FIRST-READ                              VALUE 'Y'.
  1375 77  WS-ERRTBL-OPEN-SW       PIC X               VALUE 'N'.
  1376     88  WS-ERRTBL-OPEN                          VALUE 'Y'.
  1377 77  X                       PIC X               VALUE SPACE.
  1378 77  ABEND-OPTION            PIC X               VALUE 'Y'.
  1379 77  CARRIER-L               PIC X.
  1380 77  ABEND-CODE              PIC X(4)            VALUE SPACES.
  1381 77  ERACCT-FILE-STATUS      PIC XX              VALUE ZERO.
  1382 77  ERRTBL-FILE-STATUS      PIC XX              VALUE ZERO.
  1383 77  REIN-RT-SW              PIC X               VALUE 'X'.
  1384
  1385 01  WS.
  1386     12  WS-LIFE-SW              PIC X           VALUE SPACES.
  1387     12  WS-RETURN-CODE          PIC S9(4)       VALUE ZERO.
  1388     12  WS-ZERO                 PIC S9          VALUE ZERO.
  1389     12  WS-ABEND-MESSAGE        PIC X(80)       VALUE SPACES.
  1390     12  WS-ABEND-FILE-STATUS    PIC XX          VALUE ZERO.
  1391
  1392 01  WORK-ABEND-CODE.
  1393     12  WAC-1               PIC X.
  1394     12  WAC-2               PIC X.
  1395     12  WAC-3-4.
  1396         16  WAC-3           PIC X.
  1397         16  WAC-4           PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS026P.cbl
* 1399                             COPY ELCDATE.
  1400******************************************************************06/11/98
  1401*                                                                *ELCDATE
  1402*                                                                *ELCDATE
  1403*                            ELCDATE.                            *   LV023
  1404*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1405*                            VMOD=2.003                           ELCDATE
  1406*                                                                *ELCDATE
  1407*                                                                *ELCDATE
  1408*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1409*                 LENGTH = 200                                   *   CL*19
  1410******************************************************************ELCDATE
  1411                                                                  ELCDATE
  1412 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1413     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1414     12  DC-OPTION-CODE                PIC X.                        CL*15
  1415         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1416         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1417         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1418         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1419         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1420         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1421         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1422         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1423         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1424         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1425         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1426         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1427         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1428         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1429         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1430         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1431         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1432         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1433         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1434         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1435         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1436         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1437         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1438         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1439         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1440         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1441         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1442         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1443         88  THREE-CHARACTER-BIN                                  ELCDATE
  1444                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1445         88  GREGORIAN-TO-BIN                                        CL**2
  1446                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1447         88  BIN-TO-GREGORIAN                                        CL**2
  1448                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1449         88  JULIAN-TO-BINARY                                        CL**2
  1450                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1451     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1452         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1453         88  DATE-CONVERSION-ERROR                                ELCDATE
  1454                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1455         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1456         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1457         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1458         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
  1459         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1460         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1461         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1462         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1463         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1464         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1465     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1466         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1467     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1468         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1469         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1470         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1471     12  FILLER                        PIC X.                        CL*15
  1472     12  DC-CONVERSION-DATES.                                        CL*15
  1473         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1474         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1475         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1476         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1477                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1478             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1479             20  SLASH1-1              PIC X.                        CL*15
  1480             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1481             20  SLASH1-2              PIC X.                        CL*15
  1482             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1483         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1484         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1485                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1486             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1487             20  SLASH2-1              PIC X.                        CL*15
  1488             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1489             20  SLASH2-2              PIC X.                        CL*15
  1490             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1491         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1492         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1493                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1494             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1495             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1496             20  DC-YMD-DAY            PIC 99.                       CL*15
  1497         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1498         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1499                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1500             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1501             20  DC-MDY-DAY            PIC 99.                       CL*15
  1502             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1503         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1504             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1505             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1506             20  FILLER                PIC XX.                       CL*15
  1507             20  DC-ALPHA-CENTURY.                                   CL*15
  1508                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1509             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1510         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1511         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1512         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1513         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1514         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1515                                       PIC 9(05).                    CL*20
  1516         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
  1517             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1518             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1519         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1520         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1521         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1522     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1523         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1524         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1525             20  FILLER                PIC 9(3).                     CL*15
  1526             20  HOLD-CEN-1-CCYY.                                    CL*15
  1527                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1528                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1529             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1530             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1531         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1532             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1533             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1534             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1535                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1536                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1537             20  FILLER                PIC 9(3).                     CL*15
  1538         16  HOLD-CENTURY-1-X.                                       CL*15
  1539             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1540             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1541                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1542                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1543             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1544             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1545         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1546             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1547             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1548             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1549                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1550                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1551             20  FILLER                PIC XXX.                      CL*23
  1552         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1553         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1554         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1555         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1556             20  DC-JULIAN-1-CCYY.                                   CL*15
  1557                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1558                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1559             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1560         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1561         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1562             20  DC-JULIAN-2-CCYY.                                   CL*15
  1563                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1564                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1565             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1566         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1567             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1568             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1569             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1570             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1571             20  DC-EDITA-CCYY.                                      CL*15
  1572                 24  DC-EDITA-CENT     PIC 99.                       CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1573                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1574         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1575             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1576             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1577             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1578             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1579             20  DC-EDITB-CCYY.                                      CL*15
  1580                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1581                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1582         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1583         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1584                              DC-GREG-DATE-CYMD.                  ELCDATE
  1585             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1586             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1587             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1588             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1589         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1590         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1591                              DC-GREG-DATE-MDCY.                  ELCDATE
  1592             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1593             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1594             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1595             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1596    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1597        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1598    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1599    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS026P.cbl
* 1601                             COPY ELCCALC.
  1602******************************************************************04/15/98
  1603*                                                                *ELCCALC
  1604*                           ELCCALC.                            *    LV003
  1605*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1606*                            VMOD=2.025                          *   CL**3
  1607*                                                                *   CL**2
  1608*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
  1609*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
  1610*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
  1611*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
  1612*                                                                *   CL**2
  1613*  PASSED TO ELRTRM                                              *   CL**2
  1614*  -----------------                                             *   CL**2
  1615*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
  1616*  ORIGINAL TERM                                                 *   CL**2
  1617*  BEGINNING DATE                                                *   CL**2
  1618*  ENDING DATE                                                   *   CL**2
  1619*  COMPANY I.D.                                                  *   CL**2
  1620*  ACCOUNT MASTER USER FIELD                                     *   CL**2
  1621*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
  1622*  FREE LOOK DAYS                                                *   CL**2
  1623*                                                                *   CL**2
  1624*  RETURNED FROM ELRTRM                                          *   CL**2
  1625*  ---------------------                                         *   CL**2
  1626*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
  1627*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
  1628*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
  1629*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
  1630*----------------------------------------------------------------*   CL**2
  1631*  PASSED TO ELRAMT                                              *   CL**2
  1632*  ----------------                                              *   CL**2
  1633*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
  1634*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1635*  ORIGINAL AMOUNT                                               *   CL**2
  1636*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
  1637*  A.P.R. - NET PAY ONLY                                         *   CL**2
  1638*  METHOD                                                            CL**2
  1639*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
  1640*  COMPANY I.D.                                                  *   CL**2
  1641*  BENEFIT TYPE                                                  *   CL**2
  1642*                                                                *   CL**2
  1643*  RETURNED FROM ELRAMT                                          *   CL**2
  1644*  --------------------                                          *   CL**2
  1645*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
  1646*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
  1647*  REMAINING AMOUNT FACTOR                                           CL**2
  1648*----------------------------------------------------------------*   CL**2
  1649*  PASSED TO ELRESV                                              *   CL**2
  1650*  -----------------                                             *   CL**2
  1651*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
  1652*  VALUATION DATE                                                *   CL**2
  1653*  PAID THRU DATE                                                *   CL**2
  1654*  BENEFIT                                                       *   CL**2
  1655*  INCURRED DATE                                                 *   CL**2
  1656*  REPORTED DATE                                                 *   CL**2
  1657*  ISSUE AGE                                                     *   CL**2
  1658*  TERM                                                          *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1659*  CDT PERCENT                                                   *   CL**2
  1660*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
  1661* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
  1662* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
  1663* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
  1664*                                                                *   CL**2
  1665*  RETURNED FROM ELRESV                                          *   CL**2
  1666*  --------------------                                          *   CL**2
  1667*  CDT TABLE USED                                                *   CL**2
  1668*  CDT FACTOR USED                                               *   CL**2
  1669*  PAY TO CURRENT RESERVE                                        *   CL**2
  1670*  I.B.N.R. - A/H ONLY                                           *   CL**2
  1671*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
  1672*----------------------------------------------------------------*   CL**2
  1673*  PASSED TO ELRATE                                              *   CL**2
  1674*  ----------------                                              *   CL**2
  1675*  CERT ISSUE DATE                                               *   CL**2
  1676*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1677*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1678*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
  1679*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1680*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1681*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1682*  DEVIATION CODE                                                *   CL**2
  1683*  ISSUE AGE                                                     *   CL**2
  1684*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1685*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1686*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
  1687*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1688*  A.P.R.                                                        *   CL**2
  1689*  METHOD                                                            CL**2
  1690*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1691*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1692*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1693*  BENEFIT CODE                                                  *   CL**2
  1694*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1695*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
  1696*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
  1697*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
  1698*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
  1699*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
  1700*                                                                *   CL**2
  1701*  RETURNED FROM ELRATE                                          *   CL**2
  1702*  --------------------                                          *   CL**2
  1703*  CALCULATED PREMIUM                                            *   CL**2
  1704*  PREMIUM RATE                                                  *   CL**2
  1705*  MORTALITY CODE                                                *   CL**2
  1706*  MAX ATTAINED AGE                                              *   CL**2
  1707*  MAX AGE                                                       *   CL**2
  1708*  MAX TERM                                                      *   CL**2
  1709*  MAX MONTHLY BENEFIT                                           *   CL**2
  1710*  MAX TOTAL BENIFIT                                             *   CL**2
  1711*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
  1712*----------------------------------------------------------------*   CL**2
  1713*  PASSED TO ELRFND                                              *   CL**2
  1714*  ----------------                                              *   CL**2
  1715*  CERT ISSUE DATE                                               *   CL**2
  1716*  REFUND DATE                                                   *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1717*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1718*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1719*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
  1720*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1721*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1722*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1723*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1724*  DEVIATION CODE                                                *   CL**2
  1725*  ISSUE AGE                                                     *   CL**2
  1726*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1727*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
  1728*  PROCESS TYPE (CANCEL)                                         *   CL**2
  1729*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1730*  A.P.R.                                                        *   CL**2
  1731*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
  1732*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
  1733*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1734*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1735*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1736*  BENEFIT CODE                                                  *   CL**2
  1737*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1738*                                                                *   CL**2
  1739*  RETURNED FROM ELRFND                                          *   CL**2
  1740*  --------------------                                          *   CL**2
  1741*  CALCULATED REFUND                                             *   CL**2
  1742*----------------------------------------------------------------*   CL**2
  1743*  PASSED TO ELEARN                                              *   CL**2
  1744*  ----------------                                              *   CL**2
  1745*  CERT ISSUE DATE                                               *   CL**2
  1746*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
  1747*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
  1748*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
  1749*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
  1750*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
  1751*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
  1752*  DEVIATION CODE                                                *   CL**2
  1753*  ISSUE AGE                                                     *   CL**2
  1754*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
  1755*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
  1756*  A.P.R.                                                        *   CL**2
  1757*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
  1758*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
  1759*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
  1760*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
  1761*  BENEFIT CODE                                                  *   CL**2
  1762*  BENEFIT OVERRIDE CODE                                         *   CL**2
  1763*                                                                *   CL**2
  1764*  RETURNED FROM ELEARN                                          *   CL**2
  1765*  --------------------                                          *   CL**2
  1766*  INDICATED  EARNINGS                                           *   CL**2
  1767*----------------------------------------------------------------*   CL**2
  1768*                 LENGTH = 450                                   *   CL**2
  1769*                                                                *   CL**2
  1770******************************************************************   CL**2
  1771******************************************************************
  1772*                   C H A N G E   L O G
  1773*
  1774* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1775*-----------------------------------------------------------------
  1776*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1777* EFFECTIVE    NUMBER
  1778*-----------------------------------------------------------------
  1779* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
  1780* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1781* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
  1782* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
  1783* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
  1784* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  1785* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
  1786* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
  1787* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1788* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
  1789******************************************************************
  1790                                                                     CL**2
  1791 01  CALCULATION-PASS-AREA.                                          CL**2
  1792     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
  1793                                     COMP.                           CL**2
  1794                                                                     CL**2
  1795     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
  1796       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
  1797       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
  1798                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
  1799       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
  1800       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
  1801       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
  1802       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
  1803       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
  1804       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
  1805       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
  1806       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
  1807       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
  1808       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
  1809       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
  1810       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
  1811       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
  1812       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
  1813       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
  1814       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
  1815       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
  1816                                                                     CL**2
  1817     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
  1818       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
  1819***********************  INPUT AREAS ****************************    CL**2
  1820                                                                     CL**2
  1821     12  CP-CALCULATION-AREA.                                        CL**2
  1822         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
  1823         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
  1824         16  CP-VALUATION-DT       PIC XX.                           CL**2
  1825         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
  1826         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
  1827           88  CP-AH                               VALUE 'A' 'D'     CL**2
  1828                                                   'I' 'U'.          CL**2
  1829           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
  1830           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
  1831         16  CP-INCURRED-DT        PIC XX.                           CL**2
  1832         16  CP-REPORTED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1833         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
  1834         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
  1835         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
  1836                                     COMP-3.                         CL**2
  1837         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
  1838                                     COMP-3.                         CL**2
  1839         16  CP-CDT-METHOD         PIC X.                            CL**2
  1840           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
  1841           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
  1842           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
  1843         16  CP-CLAIM-TYPE         PIC X.                            CL**2
  1844           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
  1845           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
  1846         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
  1847                                     COMP-3.                         CL**2
  1848         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
  1849                                     COMP-3.                         CL**2
  1850         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
  1851                                     COMP-3.                         CL**2
  1852         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
  1853                                     COMP-3.                         CL**2
  1854         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1855                                     COMP-3.                         CL**2
  1856         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
  1857                                     COMP-3.                         CL**2
  1858         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
  1859                                     COMP-3.                         CL**2
  1860         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
  1861           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
  1862           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
  1863           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
  1864           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
  1865           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
  1866           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
  1867           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
  1868         16  CP-EARNING-METHOD     PIC X.                            CL**2
  1869           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
  1870           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
  1871           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1872           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1873           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1874           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1875           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
  1876           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1877           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
  1878           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1879           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
  1880           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
  1881           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
  1882           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
  1883         16  CP-PROCESS-TYPE       PIC X.                            CL**2
  1884           88  CP-CLAIM                            VALUE '1'.        CL**2
  1885           88  CP-CANCEL                           VALUE '2'.        CL**2
  1886           88  CP-ISSUE                            VALUE '3'.        CL**2
  1887         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
  1888           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
  1889           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
  1890           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1891           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
  1892           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
  1893           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
  1894           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
  1895           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
  1896           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
  1897           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
  1898           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
  1899           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
  1900           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
  1901           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
  1902           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
  1903           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
  1904           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
  1905           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
  1906                                                     'W' 'X'.        CL**2
  1907           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
  1908           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
  1909           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
  1910           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
  1911           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
  1912           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
  1913           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
  1914           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
  1915           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
  1916           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
  1917           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
  1918           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
  1919           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
  1920                                                                     CL**2
  1921         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
  1922                                     COMP-3.                         CL**2
  1923         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
  1924         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
  1925         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
  1926         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
  1927         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
  1928           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
  1929               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
  1930         16  CP-R78-OPTION         PIC X.                            CL**2
  1931           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
  1932           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
  1933                                                                     CL**2
  1934         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
  1935         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
  1936         16  CP-CLAIM-STATUS       PIC X.                            CL**2
  1937         16  CP-RATE-FILE          PIC X.                            CL**2
  1938         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
  1939                                     COMP-3.                         CL**2
  1940                                                                     CL**2
  1941         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
  1942         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
  1943                                                                     CL**2
  1944         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
  1945                                     COMP-3.
  1946         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
  1947                                   PIC S9(5)V99 COMP-3.
  1948         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1949                                     COMP-3.                         CL**2
  1950         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
  1951                                     COMP-3.                         CL**2
  1952         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
  1953                                     COMP-3.
  1954         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
  1955                                  PIC S9(7)V99 COMP-3.
  1956                                                                     CL**2
  1957         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
  1958         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
  1959         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
  1960           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
  1961           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
  1962           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
  1963           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
  1964         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
  1965         16  CP-CARRIER            PIC X.                            CL**2
  1966         16  CP-REIN-FLAG          PIC X.                            CL**2
  1967         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
  1968           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
  1969                      '2' '3' '4' '5'.                               CL**2
  1970           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
  1971           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
  1972           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
  1973           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
  1974           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
  1975           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
  1976           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
  1977           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
  1978         16  CP-SIG-SWITCH         PIC X.                            CL**2
  1979         16  CP-RATING-METHOD      PIC X.                            CL**2
  1980           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
  1981           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
  1982           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
  1983           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
  1984           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
  1985           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
  1986           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
  1987           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
  1988           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
  1989         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
  1990                                     COMP-3.                         CL**2
  1991         16  CP-BEN-CATEGORY       PIC X.
  1992         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1993         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
  1994                                   PIC S99V9(5) COMP-3.
  1995         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
  1996         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
  1997                                   PIC S99V9(5) COMP-3.
  1998         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
  1999         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
  2000         16  CP-EXPIRE-DT          PIC XX.
  2001         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
  2002         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
  2003         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
  2004         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
  2005         16  CP-DDF-SPEC-CALC      PIC X.
  2006             88  CP-CALC-GROSS-FEE        VALUE 'G'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2007             88  CP-CALC-CLP              VALUE 'C'.
  2008         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
  2009         16  CP-CANCEL-REASON      PIC X.
  2010         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
  2011         16  CP-PMT-MODE           PIC X.
  2012         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
  2013         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
  2014         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
  2015         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
  2016         16  FILLER                PIC X.
  2017                                                                     CL**2
  2018***************    OUTPUT FROM ELRESV   ************************     CL**2
  2019                                                                     CL**2
  2020         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
  2021                                                                     CL**2
  2022         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
  2023                                     COMP-3.                         CL**2
  2024         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
  2025                                     COMP-3.                         CL**2
  2026         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
  2027                                     COMP-3.                         CL**2
  2028         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
  2029                                     COMP-3.                         CL**2
  2030         16  FILLER                PIC X(09).                        CL**2
  2031***************    OUTPUT FROM ELRTRM   *************************    CL**2
  2032                                                                     CL**2
  2033         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
  2034                                     COMP-3.                         CL**2
  2035         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
  2036                                     COMP-3.                         CL**2
  2037         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
  2038                                     COMP-3.                         CL**2
  2039         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
  2040                                     COMP-3.                         CL**2
  2041         16  FILLER                PIC X(12).                        CL**2
  2042                                                                     CL**2
  2043***************    OUTPUT FROM ELRAMT   *************************    CL**2
  2044                                                                     CL**2
  2045         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
  2046                                     COMP-3.                         CL**2
  2047         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
  2048                                     COMP-3.                         CL**2
  2049         16  FILLER                PIC X(12).                        CL**2
  2050                                                                     CL**2
  2051***************    OUTPUT FROM ELRATE   *************************    CL**2
  2052                                                                     CL**2
  2053         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
  2054                                     COMP-3.                         CL**2
  2055         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
  2056                                     COMP-3.                         CL**2
  2057         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
  2058         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
  2059             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
  2060         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
  2061                                     COMP-3.                         CL**2
  2062         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
  2063         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
  2064         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2065                                   PIC S9(7)V99 COMP-3.
  2066         16  FILLER                PIC X(07).                        CL**2
  2067                                                                     CL**2
  2068***************    OUTPUT FROM ELRFND   *************************    CL**2
  2069                                                                     CL**2
  2070         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
  2071                                     COMP-3.                         CL**2
  2072         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
  2073           88  CP-R-AS-R78                         VALUE '1'.        CL**2
  2074           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
  2075           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
  2076           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
  2077           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2078           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
  2079           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
  2080           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
  2081           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2082           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
  2083           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
  2084           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
  2085           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
  2086           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
  2087         16  FILLER                PIC X(12).                        CL**2
  2088                                                                     CL**2
  2089***************    OUTPUT FROM ELEARN   *************************    CL**2
  2090                                                                     CL**2
  2091         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
  2092                                     COMP-3.                         CL**2
  2093         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
  2094                                     COMP-3.                         CL**2
  2095         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
  2096                                     COMP-3.                         CL**2
  2097         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
  2098                                     COMP-3.                         CL**2
  2099         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  2100                                     COMP-3.                         CL**2
  2101         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  2102                                     COMP-3.                         CL**2
  2103         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  2104           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  2105           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  2106           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  2107           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  2108           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  2109           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  2110           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  2111           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  2112           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  2113         16  FILLER                PIC X(12).                        CL**2
  2114                                                                     CL**2
  2115***************    OUTPUT FROM ELPMNT   *************************    CL**2
  2116                                                                     CL**2
  2117         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  2118                                     COMP-3.                         CL**2
  2119         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  2120                                     COMP-3.                         CL**2
  2121         16  FILLER                PIC X(12).                        CL**2
  2122                                                                     CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2123***************   MISC WORK AREAS    *****************************   CL**2
  2124         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  2125                                     COMP-3.                         CL**2
  2126         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  2127                                     COMP-3.                         CL**2
  2128         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  2129                                     COMP-3.                         CL**2
  2130         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  2131                                     COMP-3.                         CL**2
  2132         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2133                                     COMP-3.                         CL**2
  2134         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  2135                                     COMP-3.                         CL**2
  2136         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  2137             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  2138             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  2139             88  IO-ERROR                         VALUE 'E'.         CL**2
  2140                                                                     CL**2
  2141         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  2142                                                                     CL**2
  2143         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  2144                                                                     CL**2
  2145         16  CP-RESERVE-REMAINING-TERM                               CL**2
  2146                                   PIC S9(4)V9    VALUE ZERO         CL**2
  2147                                     COMP-3.                         CL**2
  2148                                                                     CL**2
  2149         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  2150                                                                     CL**2
  2151         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  2152                                     COMP-3.                         CL**2
  2153                                                                     CL**2
  2154         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  2155                                     COMP-3.                         CL**2
  2156                                                                     CL**2
  2157         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  2158                                     COMP-3.                         CL**2
  2159                                                                     CL**2
  2160         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  2161                                     COMP-3.                         CL**2
  2162                                                                     CL**2
  2163         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  2164                                     COMP-3.                         CL**2
  2165                                                                     CL**2
  2166         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  2167                                     COMP-3.                         CL**2
  2168                                                                     CL**2
  2169         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  2170                                     COMP-3.                         CL**2
  2171                                                                     CL**2
  2172         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  2173             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  2174                                                                     CL**2
  2175         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  2176                                     COMP-3.                         CL**2
  2177         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  2178                                     COMP-3.
  2179         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
  2180         16  cp-extra-periods      pic 9 value zeros.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCALC)
  2181         16  cp-net-only-state     pic x value spaces.
  2182         16  FILLER                PIC X(13).                        CL**2
  2183******************************************************************   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS026P.cbl
* 2185                             COPY ECSRITAB.
  2186******************************************************************04/29/98
  2187*                                                                *ECSRITAB
  2188*                            ECSRITAB                            *   LV015
  2189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
  2190*                            VMOD=2.015                          *ECSRITAB
  2191*                                                                *ECSRITAB
  2192*  NO  CID  MODS  IN  COPYBOOK  ECSRITAB                         *ECSRITAB
  2193*                                                                *ECSRITAB
  2194******************************************************************ECSRITAB
  2195 01  REIN-WORK-AREAS.                                             ECSRITAB
  2196     12  RW-LFAMT                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2197     12  RW-AHWRK                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2198     12  RW-LFPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2199     12  RW-LFPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2200     12  RW-LFRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2201     12  RW-AHPRM                PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2202     12  RW-AHPRMC               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2203     12  RW-AHRFND               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2204     12  RW-LFCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2205     12  RW-AHCLMWK              PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2206     12  RW-AH-INCURRED-DETAIL.                                   ECSRITAB
  2207         16  RW-AH-INCURRED-DATA OCCURS 5 TIMES.                  ECSRITAB
  2208             20  RW-AH-INCUR-DT  PIC 9(11) COMP-3.                   CL**2
  2209             20  RW-AH-CLM-AMT   PIC S9(9)V99             COMP-3. ECSRITAB
  2210             20  RW-AH-CLM-EXP   PIC S9(9)V99             COMP-3. ECSRITAB
  2211     12  RW-LFCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2212     12  RW-AHCLM                PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2213     12  RW-AH-LIMIT             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2214     12  RW-LFIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2215     12  RW-LFPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2216     12  RW-LFFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2217     12  RW-AHIBNR               PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2218     12  RW-AHPAYCUR             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2219     12  RW-AHFUTRSV             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2220     12  RW-LFIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2221     12  RW-LFPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2222     12  RW-LFFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2223     12  RW-AHIBNRWK             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2224     12  RW-AHPAYCURWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2225     12  RW-AHFUTRSVWK           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2226     12  RW-AHLIM-LO             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2227     12  RW-AHLIM-HI             PIC S9(9)V99  VALUE +0   COMP-3. ECSRITAB
  2228     12  RW-ACCUM-LF             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2229     12  RW-ACCUM-AH             PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2230     12  RW-ACCUM-CLM            PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2231     12  RW-ACCUM-IBNR           PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2232     12  RW-ACCUM-PAYCUR         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2233     12  RW-ACCUM-FUTRSV         PIC S9(7)V99  VALUE +0   COMP-3. ECSRITAB
  2234                                                                  ECSRITAB
  2235 01  REIN-HOLD-AREAS.                                             ECSRITAB
  2236     12  REIN-LEVELS       OCCURS 30 TIMES.                       ECSRITAB
  2237         16  REIN-COMP               PIC X(6).                    ECSRITAB
  2238         16  REIN-LF-AH-FLGS.                                     ECSRITAB
  2239             20  REIN-LF-FLG         PIC X.                       ECSRITAB
  2240             20  REIN-AH-FLG         PIC X.                       ECSRITAB
  2241         16  REIN-WORK-FLDS.                                      ECSRITAB
  2242             20  REIN-LFAMT          PIC S9(9)V99   COMP-3.       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2243             20  REIN-LFPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2244             20  REIN-AHAMT          PIC S9(7)V99   COMP-3.       ECSRITAB
  2245             20  REIN-AHPRM          PIC S9(7)V99   COMP-3.       ECSRITAB
  2246             20  REIN-LFRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2247             20  REIN-AHRFND         PIC S9(7)V99   COMP-3.       ECSRITAB
  2248             20  REIN-LFCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2249             20  REIN-AHCLM          PIC S9(9)V99   COMP-3.       ECSRITAB
  2250             20  REIN-LFCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2251             20  REIN-AHCLML         PIC S9(9)V99   COMP-3.       ECSRITAB
  2252             20  REIN-DIS-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2253             20  REIN-DIS-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2254             20  REIN-DIS-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2255             20  REIN-DIS-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2256             20  REIN-DIS-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2257             20  REIN-DIS-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2258             20  REIN-DTH-IBNR       PIC S9(7)V99   COMP-3.       ECSRITAB
  2259             20  REIN-DTH-PAYCUR     PIC S9(7)V99   COMP-3.       ECSRITAB
  2260             20  REIN-DTH-FUTRSV     PIC S9(7)V99   COMP-3.       ECSRITAB
  2261             20  REIN-DTH-IBNRL      PIC S9(7)V99   COMP-3.       ECSRITAB
  2262             20  REIN-DTH-PAYCURL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2263             20  REIN-DTH-FUTRSVL    PIC S9(7)V99   COMP-3.       ECSRITAB
  2264             20  REIN-AH-LIMIT       PIC S9(7)V99   COMP-3.       ECSRITAB
  2265             20  REIN-REM-SW         PIC X.                       ECSRITAB
  2266             20  REIN-REM-AH-100     PIC X.                       ECSRITAB
  2267             20  REIN-EP-STOP-DATE   PIC 9(11)      COMP-3.          CL**4
  2268             20  REIN-LF-RUNOFF-SW   PIC X.                       ECSRITAB
  2269             20  REIN-AH-RUNOFF-SW   PIC X.                       ECSRITAB
  2270     12  REIN-LEVELS-END             PIC X(6).                    ECSRITAB
  2271                                                                  ECSRITAB
  2272     12  RWF-FIELDS.                                              ECSRITAB
  2273         16  RWF-LFAMT               PIC S9(9)V99   COMP-3.       ECSRITAB
  2274         16  RWF-LFPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2275         16  RWF-AHAMT               PIC S9(7)V99   COMP-3.       ECSRITAB
  2276         16  RWF-AHPRM               PIC S9(7)V99   COMP-3.       ECSRITAB
  2277         16  RWF-LFRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2278         16  RWF-AHRFND              PIC S9(7)V99   COMP-3.       ECSRITAB
  2279         16  RWF-LFCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2280         16  RWF-AHCLM               PIC S9(9)V99   COMP-3.       ECSRITAB
  2281         16  RWF-LFCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2282         16  RWF-AHCLML              PIC S9(9)V99   COMP-3.       ECSRITAB
  2283         16  RWF-DIS-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2284         16  RWF-DIS-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2285         16  RWF-DIS-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2286         16  RWF-DIS-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2287         16  RWF-DIS-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2288         16  RWF-DIS-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2289         16  RWF-DTH-IBNR            PIC S9(7)V99   COMP-3.       ECSRITAB
  2290         16  RWF-DTH-PAYCUR          PIC S9(7)V99   COMP-3.       ECSRITAB
  2291         16  RWF-DTH-FUTRSV          PIC S9(7)V99   COMP-3.       ECSRITAB
  2292         16  RWF-DTH-IBNRL           PIC S9(7)V99   COMP-3.       ECSRITAB
  2293         16  RWF-DTH-PAYCURL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2294         16  RWF-DTH-FUTRSVL         PIC S9(7)V99   COMP-3.       ECSRITAB
  2295         16  RWF-AH-LIMIT            PIC S9(7)V99   COMP-3.       ECSRITAB
  2296         16  RWF-REM-SW              PIC X.                       ECSRITAB
  2297         16  RWF-REM-AH-100          PIC X.                       ECSRITAB
  2298         16  RWF-EP-STOP-DATE        PIC 9(11)      COMP-3.          CL**3
  2299         16  RWF-LF-RUNOFF-SW        PIC X.                       ECSRITAB
  2300         16  RWF-AH-RUNOFF-SW        PIC X.                       ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2301                                                                  ECSRITAB
  2302     12  WT-COMP-INFO.                                            ECSRITAB
  2303         16  WT-REI-COMP             PIC X(6).                    ECSRITAB
  2304         16  WT-LF-QC                PIC X.                       ECSRITAB
  2305         16  WT-AH-QC                PIC X.                       ECSRITAB
  2306         16  WT-LO-DATE              PIC 9(11)     COMP-3.           CL**2
  2307         16  WT-HI-DATE              PIC 9(11)     COMP-3.           CL**2
  2308         16  WT-LFAGE-LO             PIC 99.                      ECSRITAB
  2309         16  WT-LFAGE-HI             PIC 99.                      ECSRITAB
  2310         16  WT-AHAGE-LO             PIC 99.                      ECSRITAB
  2311         16  WT-AHAGE-HI             PIC 99.                      ECSRITAB
  2312         16  WT-LFTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2313         16  WT-LFTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2314         16  WT-AHTRM-LO             PIC S999       COMP-3.       ECSRITAB
  2315         16  WT-AHTRM-HI             PIC S999       COMP-3.       ECSRITAB
  2316         16  WT-LF-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2317         16  WT-AH-PCT               PIC S9V9999    COMP-3.       ECSRITAB
  2318         16  WT-LF-LIM-LO            PIC S9(9)V99   COMP-3.       ECSRITAB
  2319         16  WT-LF-LIM-HI            PIC S9(9)V99   COMP-3.       ECSRITAB
  2320         16  WT-LF-LO                PIC S9(9)V99   COMP-3.       ECSRITAB
  2321         16  WT-LF-HI                PIC S9(9)V99   COMP-3.       ECSRITAB
  2322         16  WT-AHBEN-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2323         16  WT-AHBEN-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2324         16  WT-AHBEN-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2325         16  WT-AHBEN-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2326         16  WT-AHMOA-LIM-LO         PIC S9(7)V99   COMP-3.       ECSRITAB
  2327         16  WT-AHMOA-LIM-HI         PIC S9(7)V99   COMP-3.       ECSRITAB
  2328         16  WT-AHMOA-LO             PIC S9(7)V99   COMP-3.       ECSRITAB
  2329         16  WT-AHMOA-HI             PIC S9(7)V99   COMP-3.       ECSRITAB
  2330         16  WT-LF-BEN-CODE          PIC X.                       ECSRITAB
  2331         16  WT-AH-BEN-CODE          PIC X.                       ECSRITAB
  2332         16  WT-INTERACTIVE          PIC X.                       ECSRITAB
  2333         16  WT-REMAINING            PIC X.                       ECSRITAB
  2334         16  FILLER                  PIC X(21).                   ECSRITAB
  2335                                                                  ECSRITAB
  2336 01  REIN-MISC-WORK-FIELDS.                                       ECSRITAB
  2337     12  SUB1                    PIC S9(4)       COMP.            ECSRITAB
  2338     12  SUB2                    PIC S9(4)       COMP.            ECSRITAB
  2339     12  CO-SUB                  PIC S9(4)       COMP.            ECSRITAB
  2340     12  INC-SUB                 PIC S999        COMP.            ECSRITAB
  2341     12  MORTALITY-SUB           PIC S999        COMP.            ECSRITAB
  2342     12  REIN-FACTOR             PIC S99V9(7)  COMP-3   VALUE +0. ECSRITAB
  2343     12  REIN-CALCED-LIFE        PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2344     12  REIN-CALCED-AH          PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2345     12  REIN-RISK-AMOUNT        PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2346     12  REIN-MONTH-REDUCE       PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2347     12  REIN-CEDE-TERM          PIC S999V99   COMP-3   VALUE +0. ECSRITAB
  2348     12  REIN-WORKA              PIC S999      COMP-3   VALUE +0. ECSRITAB
  2349     12  REIN-EARN-LF-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2350     12  REIN-EARN-AH-TERM       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2351     12  REIN-LCNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2352     12  REIN-ACNC-EARN-TERM     PIC S999      COMP-3   VALUE +0. ECSRITAB
  2353     12  REIN-LF-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2354     12  REIN-AH-CLM-MONTHS      PIC S999      COMP-3   VALUE +0. ECSRITAB
  2355     12  REIN-AH-CLM-MTH-1       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2356     12  REIN-AH-CLM-MTH-2       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2357     12  REIN-AH-CLM-MTH-3       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2358     12  REIN-AH-CLM-MTH-4       PIC S999      COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2359     12  REIN-AH-CLM-MTH-5       PIC S999      COMP-3   VALUE +0. ECSRITAB
  2360     12  REIN-AH-PRIOR-CLMS-PAID PIC S9(11)V99 COMP-3   VALUE +0. ECSRITAB
  2361                                                                  ECSRITAB
  2362     12  REIN-VOID-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2363         88  VOIDING-LF-CANCEL            VALUE '*'.              ECSRITAB
  2364     12  REIN-VOID-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2365         88  VOIDING-AH-CANCEL            VALUE '*'.              ECSRITAB
  2366     12  REIN-ADDL-LF-SW         PIC X    VALUE ' '.              ECSRITAB
  2367         88  ADDITIONAL-LF-CANCEL         VALUE '*'.              ECSRITAB
  2368     12  REIN-ADDL-AH-SW         PIC X    VALUE ' '.              ECSRITAB
  2369         88  ADDITIONAL-AH-CANCEL         VALUE '*'.              ECSRITAB
  2370     12  REIN-CANCEL-LF-SW       PIC X    VALUE ' '.              ECSRITAB
  2371         88  FLAT-CANCEL-LF               VALUE '*'.              ECSRITAB
  2372     12  REIN-CANCEL-AH-SW       PIC X    VALUE ' '.              ECSRITAB
  2373         88  FLAT-CANCEL-AH               VALUE '*'.              ECSRITAB
  2374                                                                  ECSRITAB
  2375     12  REIN-BEN-CODE           PIC X.                           ECSRITAB
  2376         88  CEDING-SINGLE-PREM-ONLY      VALUE 'A'.              ECSRITAB
  2377         88  CEDING-OUT-BALANCE-ONLY      VALUE 'B'.              ECSRITAB
  2378         88  CEDING-REDUCING-ONLY         VALUE 'C'  'F'.         ECSRITAB
  2379         88  CEDING-LEVEL-ONLY            VALUE 'D'  'E'.         ECSRITAB
  2380         88  CEDING-GROUP-ONLY            VALUE 'G'.              ECSRITAB
  2381         88  CEDING-GROUP-RED-LIFE-ONLY   VALUE 'H'.              ECSRITAB
  2382         88  CEDING-INDIVIDUAL-ONLY       VALUE 'I'.              ECSRITAB
  2383         88  CEDING-JOINT-ONLY            VALUE 'J'.              ECSRITAB
  2384         88  CEDING-SGL-PREM-REDUCING     VALUE 'K'.              ECSRITAB
  2385         88  CEDING-SGL-PREM-GROUP        VALUE 'L'.              ECSRITAB
  2386         88  CEDING-GROUP-LEVEL-ONLY      VALUE 'M'.              ECSRITAB
  2387         88  CEDING-SGL-PREM-GRP-REDUCING VALUE 'N'.              ECSRITAB
  2388         88  CEDING-SGL-PREM-GROUP-LEVEL  VALUE 'P'.              ECSRITAB
  2389         88  CEDING-GROUP-REDUCING-ONLY   VALUE 'R'.              ECSRITAB
  2390         88  CEDING-SINGLE-POLICIES-ONLY  VALUE 'S'.              ECSRITAB
  2391         88  CEDING-AH-ONLY               VALUE '1'.              ECSRITAB
  2392         88  CEDING-PROPERTY-ONLY         VALUE '2'.              ECSRITAB
  2393         88  CEDING-UNEMPLOYMENT-ONLY     VALUE '3'.              ECSRITAB
  2394         88  CEDING-AD-D-ONLY             VALUE '4'.              ECSRITAB
  2395         88  CEDING-LIFE-ONLY             VALUE '5'.              ECSRITAB
  2396         88  CEDING-DISMEMBERMENT-ONLY    VALUE '6'.              ECSRITAB
  2397         88  CEDING-7-DAY-RETRO           VALUE '7'.              ECSRITAB
  2398         88  CEDING-14-DAY-RETRO          VALUE '8'.              ECSRITAB
  2399     12  REIN-OPEN-SW            PIC X           VALUE SPACE.     ECSRITAB
  2400     12  REIN-SEARCH.                                             ECSRITAB
  2401         16  REIN-SRCH-COMP-CD   PIC X           VALUE SPACE.     ECSRITAB
  2402         16  REIN-SRCH-CODE      PIC X           VALUE SPACE.     ECSRITAB
  2403         16  REIN-SRCH           PIC XXX         VALUE SPACE.     ECSRITAB
  2404         16  FILLER              PIC XXX         VALUE LOW-VALUE. ECSRITAB
  2405     12  SAVE-REIN-SRCH          PIC XXX         VALUE SPACE.     ECSRITAB
  2406     12  REIN-BUS-FLAG           PIC X           VALUE SPACE.     ECSRITAB
  2407     12  RATE-WORK               PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2408     12  RATE-WORK-L             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2409     12  RATE-WORK-A             PIC S9(8)V9(5)  COMP-3.          ECSRITAB
  2410     12  RS-LIFE-BEN             PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2411     12  RS-LIFE-PREM            PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2412     12  RS-AH-BEN               PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2413     12  RS-AH-PREM              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2414     12  RS-LP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2415     12  RS-AP-CALC              PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2416     12  RS-R-LB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRITAB)
  2417     12  RS-R-LP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2418     12  RS-R-AB                 PIC S9(9)V99  COMP-3   VALUE +0. ECSRITAB
  2419     12  RS-R-AP                 PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2420     12  RS-R-LPC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2421     12  RS-R-APC                PIC S9(7)V99  COMP-3   VALUE +0. ECSRITAB
  2422     12  BIN-RWF-EP-STOP-DT      PIC XX        VALUE SPACES.      ECSRITAB
  2423     12  BIN-CNT                 PIC 9(3)      VALUE ZEROES.      ECSRITAB
  2424     12  BIN-CR-DIS-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2425     12  BIN-WT-HIGH-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2426     12  BIN-WT-LO-DT            PIC XX        VALUE SPACES.      ECSRITAB
  2427     12  BIN-LF-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2428     12  BIN-AH-CANC-DT          PIC XX        VALUE SPACES.      ECSRITAB
  2429     12  BIN-CR-DTH-DT           PIC XX        VALUE SPACES.      ECSRITAB
  2430                                                                  ECSRITAB
  2431 01  REIN-CO-HOLD-TABLE.                                          ECSRITAB
  2432* ELCPSEVR MUST BE MODIFIED IF THE "OCCURS" IS CHANGED.           ECSRITAB
  2433     12  REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2434         16  RCT-REIN-CO         PIC X(6).                        ECSRITAB
  2435         16  RCT-CLM-CUTOFF-DT   PIC 9(11)  COMP-3.               ECSRITAB
  2436         16  RCT-EARNING-START-DT PIC 9(11)  COMP-3.              ECSRITAB
  2437         16  RCT-EARNING-STOP-DT PIC 9(11)  COMP-3.               ECSRITAB
  2438         16  RCT-EARN-STOP-CODE  PIC X.                           ECSRITAB
  2439         16  RCT-LF-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2440         16  RCT-LF-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2441         16  RCT-AH-CLM-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2442         16  RCT-AH-CLM-MAX      PIC S9(9)V99   COMP-3.           ECSRITAB
  2443                                                                  ECSRITAB
  2444 01  REIN-CO-HOLD-TABLE-2.                                        ECSRITAB
  2445     12  RC2-CO-HOLD-ENTRIES  OCCURS 1500 TIMES.                  ECSRITAB
  2446         16  RC2-REIN-CO.                                         ECSRITAB
  2447             20  RC2-CO-PRIME    PIC XXX.                         ECSRITAB
  2448             20  RC2-CO-SUB      PIC XXX.                         ECSRITAB
  2449         16  RC2-LF-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2450         16  RC2-LF-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2451         16  RC2-AH-R78-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2452         16  RC2-AH-PRO-PCT      PIC S9V9(4)    COMP-3.           ECSRITAB
  2453         16  RC2-CO-NAME         PIC X(30).                       ECSRITAB
  2454         16  RC2-ECS152-RPT      PIC X.                           ECSRITAB
  2455                                                                  ECSRITAB
  2456 01  REIN-MORT-CD-HOLD-TABLE.                                     ECSRITAB
  2457     12  REIN-MORT-CD-ENTRIES  OCCURS 1500 TIMES.                 ECSRITAB
  2458         16  RCT-MORT-CO         PIC X(6).                        ECSRITAB
  2459         16  RCT-MORT-CODE       PIC X(4).                        ECSRITAB
  2460     12  REIN-INDEX              PIC S9(4)    COMP    VALUE +0.   ECSRITAB
  2461                                                                  ECSRITAB
  2462 01  BIN-RCT-ITEMS-TABLE.                                         ECSRITAB
  2463     12  BIN-RCT-ITEMS OCCURS 1500 TIMES.                         ECSRITAB
  2464         16  BIN-RCT-CLM-CUTOFF-DT    PIC XX.                     ECSRITAB
  2465         16  BIN-RCT-EARNING-START-DT PIC XX.                     ECSRITAB
  2466         16  BIN-RCT-EARNING-STOP-DT  PIC XX.                     ECSRITAB
  2467 01  BIN-RW-ITEMS-TABLE.                                          ECSRITAB
  2468     12  BIN-RW-ITEMS OCCURS 5 TIMES.                             ECSRITAB
  2469         16  BIN-RW-AH-INCUR-DT       PIC XX.                     ECSRITAB
  2470                                                                  ECSRITAB
  2471 01  REIN-CO-TABLE-ENT-CNT       PIC S9(4)    COMP-3  VALUE +1500.ECSRITAB
  2472******************************************************************ECSRITAB
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS026P.cbl
  2474 01  MISC-WORK-AREAS.
  2475     12  WORK-ACC-NO         PIC X(10).
  2476     12  LAST-SWR-CONTROL    PIC X(20)          VALUE LOW-VALUES.
  2477     12  LAST-SWR-CONTROL-R REDEFINES LAST-SWR-CONTROL.
  2478         16  LSC-REC-TYPE    PIC X.
  2479         16  LSC-CARR        PIC X.
  2480         16  LSC-GROUP       PIC X(6).
  2481         16  LSC-STATE       PIC XX.
  2482         16  LSC-ACCOUNT     PIC X(10).
  2483*            66  LSC-RPT-CODE  RENAMES  LSC-ACCOUNT.
  2484     12  SAVE-ACCT-NAME      PIC X(30).
  2485     12  SAVE-REIN-NAME      PIC X(30).
  2486     12  LAST-SWR2-CONTROL   PIC X(4)           VALUE LOW-VALUES.
  2487     12  LAST-SWR2-CONTROL-R  REDEFINES LAST-SWR2-CONTROL.
  2488         16  LSC2-REIN-COMP  PIC XXX.
  2489         16  LSC2-CARR       PIC X.
  2490     12  CLM-INCUR-REIN-DATE PIC 9(06)           VALUE ZEROS.
  2491     12  CLM-INCUR-REIN-DATE-R  REDEFINES CLM-INCUR-REIN-DATE.
  2492         16  CIRD-CCYY       PIC 9(04).
  2493         16  CIRD-CCYR  REDEFINES CIRD-CCYY.
  2494             20  CIRD-CC     PIC 99.
  2495             20  CIRD-YR     PIC 99.
  2496         16  CIRD-MO         PIC 99.
  2497     12  INCURRED-DATE.
  2498         16  DTO-CC          PIC 99             VALUE ZEROS.
  2499         16  DTO-YR          PIC 99             VALUE ZEROS.
  2500         16  DTO-MO          PIC 99             VALUE ZEROS.
  2501     12  PROCESS-OPT-FROM-DT PIC 9(06)          VALUE ZEROS.
  2502     12  PROCESS-OPT-FROM-DT-R REDEFINES  PROCESS-OPT-FROM-DT.
  2503         16  POF-CCYY        PIC 9(04).
  2504         16  POF-CCYR REDEFINES POF-CCYY.
  2505             20  POF-CC      PIC 99.
  2506             20  POF-YR      PIC 99.
  2507         16  POF-MO          PIC 99.
  2508     12  PROCESS-OPT-THRU-DT PIC 9(06)          VALUE ZEROS.
  2509     12  PROCESS-OPT-THRU-DT-R REDEFINES  PROCESS-OPT-THRU-DT.
  2510         16  POT-CCYY        PIC 9(04).
  2511         16  POT-CCYR  REDEFINES POT-CCYY.
  2512             20  POT-CC      PIC 99.
  2513             20  POT-YR      PIC 99.
  2514         16  POT-MO          PIC 99.
  2515     12  CERT-ISSUE-DATE     PIC 9(06)          VALUE ZEROS.
  2516     12  CERT-ISSUE-DATE-R REDEFINES CERT-ISSUE-DATE.
  2517         16  CID-CCYY        PIC 9(04).
  2518         16  CID-CCYR  REDEFINES CID-CCYY.
  2519             20  CID-CC      PIC 99.
  2520             20  CID-YR      PIC 99.
  2521         16  CID-MO          PIC 99.
  2522     12  EOM-RUN-DATE        PIC 9(11)          VALUE ZEROS.
  2523     12  EOM-RUN-DATE-R REDEFINES EOM-RUN-DATE.
  2524         16  FILLER          PIC 999.
  2525         16  EOM-CC          PIC 99.
  2526         16  EOM-YR          PIC 99.
  2527         16  EOM-MO          PIC 99.
  2528         16  EOM-DA          PIC 99.
  2529     12  BIN-EOM-DT          PIC XX             VALUE SPACE.
  2530     12  VALUATION-DT        PIC 9(11)          VALUE ZEROS.
  2531     12  VALUATION-DT-R REDEFINES VALUATION-DT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS026P.cbl
  2532         16  FILLER          PIC 999.
  2533         16  VAL-CC          PIC 99.
  2534         16  VAL-YR          PIC 99.
  2535         16  VAL-MO          PIC 99.
  2536         16  VAL-DA          PIC 99.
  2537     12  BIN-VALUATION-DT    PIC XX.
  2538     12  WK-BREAK-TYPE       PIC X.
  2539         88  ACCOUNT-BREAK                      VALUE '1'.
  2540         88  STATE-BREAK                        VALUE '2'.
  2541         88  GROUP-BREAK                        VALUE '3'.
  2542         88  CARRIER-BREAK                      VALUE '4'.
  2543     12  WS-CR-BIN-DATE      PIC XX             VALUE SPACES.
  2544     12  CURR-CARR           PIC X              VALUE SPACES.
  2545     12  CURR-ACCT           PIC X(10)          VALUE SPACES.
  2546     12  CURR-STATE          PIC XX             VALUE SPACES.
  2547     12  CURR-GRP            PIC X(6)           VALUE SPACES.
  2548     12  CURR-REPORT-CODE-1  PIC X(10)          VALUE SPACES.
  2549     12  CURR-REPORT-CODE-2  PIC X(10)          VALUE SPACES.
  2550     12  CURR-REIN-COMP      PIC XXX            VALUE SPACES.
  2551     12  WS-PRINT-RPT-B      PIC X              VALUE 'N'.
  2552     12  WS-PRINT-RPT-C      PIC X              VALUE 'N'.
  2553     12  PREV-CARR           PIC X              VALUE SPACES.
  2554     12  PREV-ACCT           PIC X(10)          VALUE SPACES.
  2555     12  PREV-STATE          PIC XX             VALUE SPACES.
  2556     12  PREV-GRP            PIC X(6)           VALUE SPACES.
  2557     12  PREV-REPORT-CODE-1  PIC X(10)          VALUE SPACES.
  2558     12  PREV-REPORT-CODE-2  PIC X(10)          VALUE SPACES.
  2559     12  PREV-REIN-COMP      PIC XXX            VALUE SPACES.
  2560     12  PREV-REINS-TABLE    PIC XXX            VALUE SPACES.
  2561     12  WK-RPT-CODE         PIC X              VALUE SPACES.
  2562     12  WK-DTE-OPT          PIC X              VALUE SPACES.
  2563     12  TEMP-1              PIC S9(5)V99 COMP-3 VALUE +0.
  2564     12  TEMP-2              PIC S9(5)V99 COMP-3 VALUE +0.
  2565     12  TEMP-3              PIC S9(5)V99 COMP-3 VALUE +0.
  2566     12  TEMP-4              PIC S9V9(6)  COMP-3 VALUE +0.
  2567     12  TEMP-5              PIC S9V9(6)  COMP-3 VALUE +0.
  2568     12  TEMP-6              PIC S99V9(6) COMP-3 VALUE +0.
  2569     12  TEMP-7              PIC S9(9)V99 COMP-3 VALUE +0.
  2570     12  TEMP-8              PIC S9(9)V99 COMP-3 VALUE +0.
  2571     12  REM-TRM1            PIC S999V99  COMP-3.
  2572     12  REM-TRM2            PIC S999V99  COMP-3.
  2573     12  REM-TRM3            PIC S999V99  COMP-3.
  2574     12  TEM-TRM1            PIC S999V99  COMP-3.
  2575     12  ORIG-TERM           PIC S999V99  COMP-3.
  2576     12  WS-RE-CNT           PIC S9999    COMP-3 VALUE +0.
  2577     12  STATUTORY-SWITCH    PIC X               VALUE SPACE.
  2578         88 STATUTORY-REQUIREMENT                VALUE '*'.
  2579
  2580 01  MISC-COMP-3-AREAS   COMP-3.
  2581     12  FLA-CLM-REIN-BASE   PIC S9(9)V99         VALUE +0.
  2582     12  ADJ-FLA-REIN-BASE   PIC S9(9)V9(4)       VALUE +0.
  2583     12  ROUND-UP-DOLLARS    PIC S9(9)            VALUE +0.
  2584     12  NET-PREMIUM         PIC S9(9)V99         VALUE +0.
  2585     12  UNEARNED-PREMIUM    PIC S9(5)V99         VALUE +0.
  2586     12  EARNED-PREMIUM      PIC S9(5)V99         VALUE +0.
  2587     12  PER-DAY-BENEFIT     PIC S9(5)V9(5)       VALUE +0.
  2588     12  AH-TOTAL-AMT        PIC S9(7)V99         VALUE +0.
  2589     12  LF-EPR-R78          PIC S9(7)V99         VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS026P.cbl
  2590     12  LF-EPR-PRO          PIC S9(7)V99         VALUE +0.
  2591     12  LF-EPR-ST           PIC S9(7)V99         VALUE +0.
  2592     12  AH-EPR-R78          PIC S9(7)V99         VALUE +0.
  2593     12  AH-EPR-PRO          PIC S9(7)V99         VALUE +0.
  2594     12  AH-EPR-ST           PIC S9(7)V99         VALUE +0.
  2595     12  SAVE-LF-EPR-R78     PIC S9(7)V99         VALUE +0.
  2596     12  SAVE-LF-EPR-PRO     PIC S9(7)V99         VALUE +0.
  2597     12  SAVE-AH-EPR-R78     PIC S9(7)V99         VALUE +0.
  2598     12  SAVE-AH-EPR-PRO     PIC S9(7)V99         VALUE +0.
  2599     12  WS-FAC              PIC S9V9999          VALUE +0.
  2600     12  WS-PRO              PIC S9V9999          VALUE +0.
  2601     12  WS-R78              PIC S9V9999          VALUE +0.
  2602     12  LF-R78              PIC S9V9999          VALUE +0.
  2603     12  AH-R78              PIC S9V9999          VALUE +0.
  2604     12  LF-PRO              PIC S9V9999          VALUE +0.
  2605     12  AH-PRO              PIC S9V9999          VALUE +0.
  2606     12  NO-DAYS-THIS-CERT   PIC S9(9)            VALUE +0.
  2607     12  WORK-AREA-FOR-ACCUMULATOR.
  2608         16  WA-FACE-BEN     PIC S9(13)V99        VALUE +0.
  2609         16  WA-ISS-PRM      PIC S9(9)V99         VALUE +0.
  2610         16  WA-CNC-PRM      PIC S9(9)V99         VALUE +0.
  2611         16  WA-EARNED-PRM   PIC S9(9)V99         VALUE +0.
  2612         16  WA-CLAIM-AMT    PIC S9(9)V99         VALUE +0.
  2613         16  WA-CERT-COUNT   PIC S9(7)            VALUE +0.
  2614         16  WA-CLAIM-COUNT  PIC S9(9)            VALUE +0.
  2615         16  WA-NUMBER-DAYS  PIC S9(9)            VALUE +0.
  2616         16  WA-CRT-W-CLM    PIC S9(9)            VALUE +0.
  2617     12  REMAINING-TERM-WORK-AREAS.
  2618         16  LF-REM-TRM      PIC S999V99          VALUE +0.
  2619         16  AH-REM-TRM      PIC S999V99          VALUE +0.
  2620 01  EARNED-PREM-AREAS.
  2621     12  WE-REIN-CO          PIC X(6).
  2622     12  WE-LF-AH            PIC X.
  2623     12  WE-BEN-TYPE         PIC XX.
  2624     12  WE-LFAMT            PIC S9(9)V99    COMP-3.
  2625     12  WE-LFPRM            PIC S9(7)V99    COMP-3.
  2626     12  WE-LFAMT-ALT        PIC S9(9)V99    COMP-3.
  2627     12  WE-LFPRM-ALT        PIC S9(7)V99    COMP-3.
  2628     12  WE-LFRFND           PIC S9(7)V99    COMP-3.
  2629     12  WE-AHAMT            PIC S9(9)V99    COMP-3.
  2630     12  WE-AHPRM            PIC S9(7)V99    COMP-3.
  2631     12  WE-AHRFND           PIC S9(7)V99    COMP-3.
  2632 01  TEXAS-REG-WORK-AREAS   SYNC.
  2633     12  TEX-FACT-1          PIC S9(9)V99    COMP-3.
  2634     12  TEX-FACT-2          PIC S999        COMP-3.
  2635     12  TEX-FACT-3          PIC S999        COMP-3.
  2636     12  TEX-FACT-4          PIC S9(7)       COMP-3.
  2637     12  TEX-FACT-5          PIC S999        COMP-3.
  2638     12  TEX-FACT-6          PIC S999        COMP-3.
  2639     12  TEX-FACT-7          PIC S9(7)       COMP-3.
  2640     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
  2641     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
  2642
  2643 01  NET-PAY-INTERFACE.
  2644     12  NP-APR              PIC S999V9(4)   COMP-3.
  2645     12  NP-ORIG             PIC S999        COMP-3.
  2646     12  NP-REM              PIC S999        COMP-3.
  2647     12  NP-OPT              PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS026P.cbl
  2648     12  NP-CAP              PIC S999        COMP-3.
  2649     12  NP-FACTOR           PIC S9(4)V9(9)  COMP-3.
  2650     12  NP-WORK1            PIC S9(9)V9(9)  COMP-3.
  2651     12  NP-WORK2            PIC S9(9)V9(9)  COMP-3.
  2652     12  NP-BENEFIT          PIC S9(9)V99    COMP-3.
  2653     12  NP-REMAINING        PIC S9(9)V99    COMP-3.
  2654     12  NP-AHPRM            PIC S9(7)V99    COMP-3.
  2655     12  NP-ACCOUNT          PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS026P.cbl
  2657 01  ACCUMULATOR-TABLE   COMP-3.
  2658     12  AT-AMOUNTS-L-D    OCCURS 3 TIMES.
  2659         16  AT-AMOUNTS    OCCURS 7 TIMES.
  2660             20  AT-FACE-BEN     PIC S9(13)V99.
  2661             20  AT-ISS-PRM      PIC S9(9)V99.
  2662             20  AT-CNC-PRM      PIC S9(9)V99.
  2663             20  AT-EARNED-PRM   PIC S9(9)V99.
  2664             20  AT-CLAIM-AMT    PIC S9(9)V99.
  2665             20  AT-CERT-COUNT   PIC S9(7).
  2666             20  AT-CLAIM-COUNT  PIC S9(9).
  2667             20  AT-NUMBER-DAYS  PIC S9(9).
  2668             20  AT-CRT-W-CLM    PIC S9(9).
  2669
  2670 01  ACCUMULATOR-TABLE-2 COMP-3.
  2671     12  AT2-AMOUNTS-L-D   OCCURS 3 TIMES.
  2672         16  AT2-AMOUNTS   OCCURS 7 TIMES.
  2673             20  AT2-FACE-BEN    PIC S9(13)V99.
  2674             20  AT2-ISS-PRM     PIC S9(9)V99.
  2675             20  AT2-CNC-PRM     PIC S9(9)V99.
  2676             20  AT2-EARNED-PRM  PIC S9(9)V99.
  2677             20  AT2-CLAIM-AMT   PIC S9(9)V99.
  2678             20  AT2-CERT-COUNT  PIC S9(7).
  2679             20  AT2-CLAIM-COUNT PIC S9(9).
  2680             20  AT2-NUMBER-DAYS PIC S9(9).
  2681             20  AT2-CRT-W-CLM   PIC S9(9).
  2682
  2683 01  ACCUMULATOR-TABLE-3 COMP-3.
  2684     12  AT3-AMOUNTS-L-D   OCCURS 3 TIMES.
  2685         16  AT3-AMOUNTS   OCCURS 7 TIMES.
  2686             20  AT3-FACE-BEN    PIC S9(13)V99.
  2687             20  AT3-ISS-PRM     PIC S9(9)V99.
  2688             20  AT3-CNC-PRM     PIC S9(9)V99.
  2689             20  AT3-EARNED-PRM  PIC S9(9)V99.
  2690             20  AT3-CLAIM-AMT   PIC S9(9)V99.
  2691             20  AT3-CERT-COUNT  PIC S9(7).
  2692             20  AT3-CLAIM-COUNT PIC S9(9).
  2693             20  AT3-NUMBER-DAYS PIC S9(9).
  2694             20  AT3-CRT-W-CLM   PIC S9(9).
  2695
  2696 01  ACCUMULATOR-TABLE-4 COMP-3.
  2697     12  AT4-AMOUNTS-L-D   OCCURS 3 TIMES.
  2698         16  AT4-AMOUNTS   OCCURS 7 TIMES.
  2699             20  AT4-FACE-BEN    PIC S9(13)V99.
  2700             20  AT4-ISS-PRM     PIC S9(9)V99.
  2701             20  AT4-CNC-PRM     PIC S9(9)V99.
  2702             20  AT4-EARNED-PRM  PIC S9(9)V99.
  2703             20  AT4-CLAIM-AMT   PIC S9(9)V99.
  2704             20  AT4-CERT-COUNT  PIC S9(7).
  2705             20  AT4-CLAIM-COUNT PIC S9(9).
  2706             20  AT4-NUMBER-DAYS PIC S9(9).
  2707             20  AT4-CRT-W-CLM   PIC S9(9).
  2708
  2709 01  ACCUMULATOR-TABLE-5 COMP-3.
  2710     12  AT5-AMOUNTS-L-D   OCCURS 3 TIMES.
  2711         16  AT5-AMOUNTS   OCCURS 7 TIMES.
  2712             20  AT5-FACE-BEN    PIC S9(13)V99.
  2713             20  AT5-ISS-PRM     PIC S9(9)V99.
  2714             20  AT5-CNC-PRM     PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS026P.cbl
  2715             20  AT5-EARNED-PRM  PIC S9(9)V99.
  2716             20  AT5-CLAIM-AMT   PIC S9(9)V99.
  2717             20  AT5-CERT-COUNT  PIC S9(7).
  2718             20  AT5-CLAIM-COUNT PIC S9(9).
  2719             20  AT5-NUMBER-DAYS PIC S9(9).
  2720             20  AT5-CRT-W-CLM   PIC S9(9).
  2721
  2722 01  PRINT-TABLE         COMP-3.
  2723     12  PT-AMOUNTS-L-D    OCCURS 4 TIMES.
  2724         16  PT-AMOUNTS    OCCURS 8 TIMES.
  2725             20  PT-FACE-BEN     PIC S9(13)V99.
  2726             20  PT-CERT-COUNT   PIC S9(9).
  2727             20  PT-CLAIM-COUNT  PIC S9(9).
  2728             20  PT-NUMBER-DAYS  PIC S9(9).
  2729             20  PT-GROSS-PRM    PIC S9(9)V99.
  2730             20  PT-CNC-PRM      PIC S9(9)V99.
  2731             20  PT-NET-PRM      PIC S9(9)V99.
  2732             20  PT-EARNED-PRM   PIC S9(9)V99.
  2733             20  PT-CLAIMS       PIC S9(9)V99.
  2734             20  PT-EL-RATIO     PIC S9(5)V9(4).
  2735             20  PT-PRCNT-PRM    PIC S9(5)V9(4).
  2736             20  PT-PRCNT-CLAIM  PIC S9(5)V9(4).
  2737             20  PT-PRCNT-CNC-G  PIC S9(5)V9(4).
  2738             20  PT-AVG-LOAN     PIC S9(9)V99.
  2739             20  PT-AVG-CLAIM    PIC S9(9)V99.
  2740             20  PT-AVG-DAYS     PIC S9(9).
  2741             20  PT-CRT-W-CLM    PIC S9(9).
  2742
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS026P.cbl
  2744 01  HEADING-1.
  2745     12  FILLER              PIC X(49)           VALUE SPACES.
  2746     12  FILLER              PIC X(26)           VALUE
  2747             'EXPERIENCE ANALYSIS REPORT'.
  2748     12  FILLER              PIC X(44)           VALUE SPACES.
  2749     12  FILLER              PIC X(6)            VALUE 'ECS026'.
  2750     12  H1-RPT-CODE         PIC X               VALUE SPACES.
  2751
  2752 01  HEADING-2.
  2753     12  FILLER              PIC X(47)           VALUE SPACES.
  2754     12  H2-COMPANY          PIC X(30).
  2755     12  FILLER              PIC X(42)           VALUE SPACES.
  2756     12  H2-CURRENT-DATE     PIC X(8).
  2757
  2758 01  HEADING-3.
  2759     12  FILLER              PIC X(53)           VALUE SPACES.
  2760     12  H3-RUN-DATE         PIC X(18).
  2761
  2762 01  ACCOUNT-HEADING.
  2763     12  FILLER              PIC X(9)            VALUE 'ACCOUNT'.
  2764     12  AH-ACCT-NO          PIC X(10).
  2765     12  FILLER              PIC XX              VALUE SPACES.
  2766     12  AH-ACCT-NAME        PIC X(30).
  2767
  2768 01  FINAL-HEADING.
  2769     12  FILLER              PIC X(12)    VALUE 'FINAL TOTALS'.
  2770
  2771 01  CARRIER-HEADING.
  2772     12  FILLER              PIC X(9)            VALUE 'CARRIER'.
  2773     12  CH-CARR-NO          PIC X.
  2774     12  FILLER              PIC XX              VALUE SPACES.
  2775     12  CH-CARR-NA          PIC X(40).
  2776
  2777 01  STATE-HEADING.
  2778     12  FILLER              PIC X(7)            VALUE 'STATE'.
  2779     12  SH-STATE-NO         PIC XX.
  2780     12  FILLER              PIC XX              VALUE SPACES.
  2781     12  SH-STATE-NAME       PIC X(20).
  2782
  2783 01  GROUP-HEADING.
  2784     12  FILLER              PIC X(7)            VALUE 'GROUP'.
  2785     12  GH-GROUP-NO         PIC X(6).
  2786
  2787 01  REPORT-CODE-1-HEADING.
  2788     12  RC1H-CAPTION        PIC X(12).
  2789     12  RC1H-CODE           PIC X(10).
  2790
  2791 01  REPORT-CODE-2-HEADING.
  2792     12  RC2H-CAPTION        PIC X(12).
  2793     12  RC2H-CODE           PIC X(10).
  2794
  2795 01  REINSURANCE-HEADING.
  2796     12  FILLER              PIC X(12)           VALUE
  2797             'REINS COMP'.
  2798     12  RH-COMP-NO          PIC X(6).
  2799     12  FILLER              PIC XX              VALUE SPACES.
  2800     12  RH-COMP-NAME        PIC X(30).
  2801
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS026P.cbl
  2803 01  HEADING-7.
  2804     12  H7-DESC.
  2805         16 H7-DESC1-7       PIC X(7).
  2806         16 H7-DESC8-20      PIC X(13).
  2807     12  FILLER              PIC X(4)            VALUE SPACES.
  2808     12  FILLER              PIC X(8)            VALUE
  2809             '30-UNDER'.
  2810     12  FILLER              PIC X(8)            VALUE SPACES.
  2811     12  FILLER              PIC X(5)            VALUE '31-40'.
  2812     12  FILLER              PIC X(9)            VALUE SPACES.
  2813     12  FILLER              PIC X(5)            VALUE '41-45'.
  2814     12  FILLER              PIC X(9)            VALUE SPACES.
  2815     12  FILLER              PIC X(5)            VALUE '46-50'.
  2816     12  FILLER              PIC X(9)            VALUE SPACES.
  2817     12  FILLER              PIC X(5)            VALUE '51-55'.
  2818     12  FILLER              PIC X(9)            VALUE SPACES.
  2819     12  FILLER              PIC X(5)            VALUE '56-60'.
  2820     12  FILLER              PIC X(9)            VALUE SPACES.
  2821     12  FILLER              PIC X(5)            VALUE '61-UP'.
  2822     12  FILLER              PIC X(9)            VALUE SPACES.
  2823     12  FILLER              PIC X(5)            VALUE 'TOTAL'.
  2824
  2825 01  DETAIL-LINE.
  2826     12  DL-DESC             PIC X(20).
  2827     12  FILLER              PIC X(112).
  2828
  2829 01  DETAIL-LINE-R REDEFINES DETAIL-LINE.
  2830     12  FILLER              PIC X(20).
  2831     12  DL-AMT              PIC ZZ,ZZZ,ZZZ.99-  OCCURS 8 TIMES.
  2832
  2833 01  DETAIL-LINE-RR REDEFINES DETAIL-LINE.
  2834     12  FILLER              PIC X(20).
  2835     12  DL-AMT1             PIC ZZZZZZZZZZZZ9-  OCCURS 8 TIMES.
  2836
  2837 01  DETAIL-LINE-RR REDEFINES DETAIL-LINE.
  2838     12  FILLER              PIC X(20).
  2839     12  DL-AMT2             PIC Z,ZZZ,ZZZ,ZZ9-  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS026P.cbl
  2841 01  SORT-WORK-REC.
  2842     12  SWR-CONTROL.
  2843         16  SWR-REC-TYPE            PIC X.
  2844         16  SWR-CARR                PIC X.
  2845         16  SWR-GROUP               PIC X(6).
  2846         16  SWR-STATE               PIC XX.
  2847         16  SWR-ACCOUNT             PIC X(10).
  2848*            66  SWR-RPT-CODE RENAMES SWR-ACCOUNT.
  2849     12  SWR-REPORT-CODE-1           PIC X(10).
  2850     12  SWR-REPORT-CODE-2           PIC X(10).
  2851     12  SWR-ACCT-NAME               PIC X(30).
  2852     12  SWR-TABLE       COMP-3.
  2853         16  SWR-AMOUNTS-L-D   OCCURS 3 TIMES.
  2854             20  SWR-AMOUNTS   OCCURS 7 TIMES.
  2855                 24  SWR-FACE-BEN    PIC S9(13)V99.
  2856                 24  SWR-ISS-PRM     PIC S9(9)V99.
  2857                 24  SWR-CNC-PRM     PIC S9(9)V99.
  2858                 24  SWR-EARNED-PRM  PIC S9(9)V99.
  2859                 24  SWR-CLAIM-AMT   PIC S9(9)V99.
  2860                 24  SWR-CERT-COUNT  PIC S9(7).
  2861                 24  SWR-CLAIM-COUNT PIC S9(9).
  2862                 24  SWR-NUMBER-DAYS PIC S9(9).
  2863                 24  SWR-CRT-W-CLM   PIC S9(9).
  2864
  2865 01  SORT-WORK-REC-2.
  2866     12  SWR2-CONTROL.
  2867         16  SWR2-REIN-COMP          PIC XXX.
  2868         16  SWR2-CARR               PIC X.
  2869     12  SWR2-DT                     PIC 9(11)      COMP-3.
  2870     12  SWR2-AGE                    PIC 99.
  2871     12  SWR2-ENTRY-STATUS           PIC X.
  2872     12  SWR2-LF-CURRENT-STATUS      PIC X.
  2873     12  SWR2-AH-CURRENT-STATUS      PIC X.
  2874     12  SWR2-LFTYP                  PIC XX.
  2875     12  SWR2-LF-TERM                PIC S999       COMP-3.
  2876     12  SWR2-LF-REM-TRM             PIC S999       COMP-3.
  2877     12  SWR2-LFAMT                  PIC S9(9)V99   COMP-3.
  2878     12  SWR2-LFPRM                  PIC S9(7)V99   COMP-3.
  2879     12  SWR2-LFRFND                 PIC S9(7)V99   COMP-3.
  2880     12  SWR2-AHTYP                  PIC XX.
  2881     12  SWR2-AH-TERM                PIC S999       COMP-3.
  2882     12  SWR2-AH-REM-TRM             PIC S999       COMP-3.
  2883     12  SWR2-AHAMT                  PIC S9(9)V99   COMP-3.
  2884     12  SWR2-AHPRM                  PIC S9(7)V99   COMP-3.
  2885     12  SWR2-AHRFND                 PIC S9(7)V99   COMP-3.
  2886     12  SWR2-NUM-DTH-CLM            PIC S999       COMP-3.
  2887     12  SWR2-DTHAMT                 PIC S9(9)V99   COMP-3.
  2888     12  SWR2-NUM-DIS-CLM            PIC S999       COMP-3.
  2889     12  SWR2-DISAMT                 PIC S9(9)V99   COMP-3.
  2890     12  SWR2-NAME                   PIC X(30).
  2891     12  SWR2-REINS-TABLE            PIC XXX.
  2892     12  SWR2-LF-EPR-PR              PIC S9(5)V99   COMP-3.
  2893     12  SWR2-LF-EPR-78              PIC S9(5)V99   COMP-3.
  2894     12  SWR2-AH-EPR-PR              PIC S9(5)V99   COMP-3.
  2895     12  SWR2-AH-EPR-78              PIC S9(5)V99   COMP-3.
  2896
* 2897                             COPY ELCDTECX.
  2898******************************************************************06/05/98
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2899*                                                                *ELCDTECX
  2900*                            ELCDTECX.                           *   LV005
  2901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  2902*                            VMOD=2.015                          *ELCDTECX
  2903*                                                                *ELCDTECX
  2904*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  2905*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  2906*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  2907*                                                                *ELCDTECX
  2908******************************************************************ELCDTECX
  2909******************************************************************
  2910*                   C H A N G E   L O G
  2911*
  2912* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2913*-----------------------------------------------------------------
  2914*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2915* EFFECTIVE    NUMBER
  2916*-----------------------------------------------------------------
  2917* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  2918*                                  BENEFIT CODES FROM 300 TO 900
  2919* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  2920* 051304    2003080800002  SMVA  ADD REFUND METHOD
  2921* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
  2922******************************************************************
  2923 01  DATE-CARD.                                                   ELCDTECX
  2924     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  2925     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  2926     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  2927     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  2928     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  2929     12  EP-SW                       PIC  X.                      ELCDTECX
  2930         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
  2931     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  2932         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  2933     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  2934     12  RUN-CENTURY.                                             ELCDTECX
  2935         16 RUN-CENTURY-N            PIC  99.                        CL**4
  2936     12  FILLER                      PIC  X.                         CL**4
  2937     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  2938     12  FILLER                      PIC  XXX.                    ELCDTECX
  2939     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  2940                                                                  ELCDTECX
  2941 01  FILLER                          PIC  X(7)                       CL**6
  2942                                          VALUE 'OPTIONS'.        ELCDTECX
  2943 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  2944     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  2945     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  2946     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  2947         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  2948         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  2949     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  2950     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  2951     12  FILLER                      PIC  X.                      ELCDTECX
  2952     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  2953     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  2954     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  2955     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  2956     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  2957     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  2958     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  2959     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  2960     12  FILLER                      PIC  X.                      ELCDTECX
  2961     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  2962     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  2963     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  2964     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  2965     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  2966     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  2967     12  FILLER                      PIC  X.                      ELCDTECX
  2968     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  2969     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  2970     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  2971     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  2972     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  2973     12  DTE-R78                     PIC  X.                      ELCDTECX
  2974     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  2975     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  2976     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  2977     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  2978     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  2979     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  2980     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  2981                                     PIC  X.                      ELCDTECX
  2982         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  2983                                                 ' '.             ELCDTECX
  2984         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  2985         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  2986     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  2987         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  2988         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
  2989     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  2990     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  2991                                     PIC  9.                         CL**4
  2992     12  DTE-SYSTEM.                                              ELCDTECX
  2993         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  2994         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  2995         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  2996         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  2997         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  2998         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  2999         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  3000         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  3001         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  3002         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  3003         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  3004         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  3005         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  3006         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  3007         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  3008         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  3009         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  3010         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  3011         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  3012         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  3013         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  3014         16  DTE-SYS-V               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3015         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  3016         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  3017         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  3018         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  3019     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  3020         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  3021                                     PIC  X.                      ELCDTECX
  3022     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  3023                                                                  ELCDTECX
  3024 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  3025     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  3026     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  3027     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  3028*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  3029     12  FILLER                      PIC  X.                      ELCDTECX
  3030     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  3031     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  3032     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  3033     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  3034     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  3035     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  3036     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  3037                                                                  ELCDTECX
  3038     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  3039     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  3040     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  3041     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  3042                                                                  ELCDTECX
  3043     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  3044     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  3045     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  3046     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
  3047                                                                  ELCDTECX
  3048     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  3049     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  3050                                                                  ELCDTECX
  3051     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  3052     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  3053                                                                  ELCDTECX
  3054     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  3055                                                                  ELCDTECX
  3056 01  DATE-CARD-FACTORS.                                           ELCDTECX
  3057     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  3058     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  3059     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  3060     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  3061     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  3062     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  3063     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  3064                                                                  ELCDTECX
  3065 01  FILLER                          PIC  X(12)                   ELCDTECX
  3066                                          VALUE 'COMPANY NAME'.   ELCDTECX
  3067 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  3068     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  3069         16  CNT-ID                  PIC  X.                      ELCDTECX
  3070         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  3071                                                                  ELCDTECX
  3072 01  FILLER                          PIC  X(11)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  61
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3073                                          VALUE 'STATE NAMES'.    ELCDTECX
  3074 01  STATE-NAMES.                                                 ELCDTECX
  3075     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  3076         16  STATE-SUB               PIC  XX.                     ELCDTECX
  3077         16  STATE-PIC1.                                          ELCDTECX
  3078             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  3079             20  FILLER              PIC  XXX.                    ELCDTECX
  3080             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  3081             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  3082             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  3083             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  3084                                                                  ELCDTECX
  3085 01  FILLER                          PIC  X(13)                   ELCDTECX
  3086                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  3087 01  CARRIER-NAMES.                                               ELCDTECX
  3088     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  3089         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  3090         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  3091         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  3092         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3093         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3094         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  3095*        16  FILLER                  PIC  X.                      ELCDTECX
  3096         16  CARRIER-SEC-PAY         PIC  X.
  3097             88  SEC-PAY-CARRIER          VALUE 'Y'.
  3098                                                                  ELCDTECX
  3099 01  FILLER                          PIC  X(9)                       CL**6
  3100                                          VALUE 'INS TYPES'.      ELCDTECX
  3101 01  CLAS-INS-TYPES.                                              ELCDTECX
  3102*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  3103     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  3104         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
  3105         16  CLAS-I-AB3.                                          ELCDTECX
  3106             20  FILLER              PIC  X.                      ELCDTECX
  3107             20  CLAS-I-AB2.                                      ELCDTECX
  3108                 24  FILLER          PIC  X.                      ELCDTECX
  3109                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  3110         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  3111             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  3112             20  FILLER              PIC  X.                         CL**4
  3113         16  CLAS-I-AB10.                                         ELCDTECX
  3114             20  FILLER              PIC  X(9).                   ELCDTECX
  3115             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  3116         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  3117         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  3118         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  3119         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  3120             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  3121         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  3122         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  3123         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  3124         16  CLAS-I-BEN-CATEGORY     PIC  X.
  3125         16  CLAS-I-REFUND-METHOD    PIC  X.
  3126         16  CLAS-I-MAX-BENEFITS     PIC 99.
  3127         16  FILLER                  PIC  XXX.
  3128                                                                  ELCDTECX
  3129 01  FILLER                          PIC  X(16)                   ELCDTECX
  3130                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  62
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3131 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  3132     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  3133                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  3134         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  3135         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  3136         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  3137         16  CLAS-MORT-DESC.                                      ELCDTECX
  3138             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  3139             20  FILLER              PIC  XX.                        CL**5
  3140             20  CLAS-YEAR           PIC  X(4).                      CL**6
  3141             20  FILLER              PIC  X.                         CL**5
  3142             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  3143             20  FILLER              PIC  X.                         CL**5
  3144             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  3145             20  FILLER              PIC  X.                         CL**5
  3146             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  3147             20  FILLER              PIC  X(5).                      CL**6
  3148                                                                  ELCDTECX
  3149 01  FILLER                          PIC  X(15)                   ELCDTECX
  3150                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  3151 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  3152     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  3153         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  3154         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  3155         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  3156         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  3157         16  FILLER                  PIC  X(4).                      CL**6
  3158                                                                  ELCDTECX
  3159 01  FILLER                          PIC  X(7)                       CL**6
  3160                                     VALUE 'INDEXES'.             ELCDTECX
  3161 01  CLAS-INDEX-TBL.                                              ELCDTECX
  3162     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  3163     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
  3164     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  3165     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  3166     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  3167     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  3168     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  3169     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  3170     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  3171     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  3172     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  3173     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  3174     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  3175     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  3176     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  3177     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  3178     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  3179                                                                  ELCDTECX
  3180 01  CLAS-TYPE-MISC.                                              ELCDTECX
  3181     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  3182     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  3183     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  3184     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  3185     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  3186     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  3187     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  3188     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  63
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3189     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  3190     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  3191     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  3192                                                                  ELCDTECX
  3193 01  FILLER                          PIC  X(13)                   ELCDTECX
  3194                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  3195 01  CLAS-MISC.                                                   ELCDTECX
  3196     12  DTE-FICH                    PIC  X.                      ELCDTECX
  3197         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  3198         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  3199         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  3200     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  3201     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  3202     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  3203     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  3204     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  3205     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  3206     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  3207     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  3208     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  3209     12  STATE-L                     PIC  XX.                     ELCDTECX
  3210     12  CLAS-CN                     PIC  99.                     ELCDTECX
  3211     12  CLAS-CO                     PIC  99.                     ELCDTECX
  3212     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  3213         16  DTE-F-1                 PIC  X.                      ELCDTECX
  3214         16  DTE-F-2                 PIC  X.                      ELCDTECX
  3215     12  DTE-ABEND-WORK.                                          ELCDTECX
  3216         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  3217         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  3218                                                                  ELCDTECX
  3219 01  FILLER                          PIC  X(12)                   ELCDTECX
  3220                                     VALUE 'WORKING DATE'.        ELCDTECX
  3221 01  WS-DATE-AND-TIME.                                            ELCDTECX
  3222     12  WS-ACCEPT-DATE.                                          ELCDTECX
  3223         16  WS-AD-YY                PIC  99.                     ELCDTECX
  3224         16  WS-AD-MM                PIC  99.                     ELCDTECX
  3225         16  WS-AD-DD                PIC  99.                     ELCDTECX
  3226     12  WS-CURRENT-DATE.                                         ELCDTECX
  3227         16  WS-CD-MM                PIC  99.                     ELCDTECX
  3228         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3229         16  WS-CD-DD                PIC  99.                     ELCDTECX
  3230         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  3231         16  WS-CD-YY                PIC  99.                     ELCDTECX
  3232     12  WS-TIME-OF-DAY.                                          ELCDTECX
  3233         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  3234         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  3235                                                                  ELCDTECX
  3236 01  FILLER                          PIC  X(12)                   ELCDTECX
  3237                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  3238 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  3239     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  3240         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  3241         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  3242         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  3243                                                                  ELCDTECX
  3244 01  FILLER                          PIC  X(10)                   ELCDTECX
  3245                                     VALUE 'STATE TLRS'.          ELCDTECX
  3246 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  64
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  3247     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  3248         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  3249         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  3250                                                                  ELCDTECX
  3251 01  FILLER                          PIC  X(13)                   ELCDTECX
  3252                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  3253 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  3254     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  3255         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  3256                                                                  ELCDTECX
  3257 01  FILLER                          PIC  X(13)                   ELCDTECX
  3258                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  3259 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  3260     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  3261     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  3262     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  3263                                     PIC  X.                         CL**5
  3264     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  3265     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  3266     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  3267     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  3268     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  3269     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  3270     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  3271     12  FILLER                      PIC  X(75).                  ELCDTECX
  3272******************************************************************ELCDTECX
  3273*01  MISC-CARR-PCT-DATA.                                          00001521
  3274*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3275*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3276*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3277*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  3278*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  3279*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  3280******************************************************************ELCDTECX
  3281
* 3282                             COPY ELCDTEVR.
  3283***************************************************************** 04/15/98
  3284*                                                                *ELCDTEVR
  3285*                                                                *ELCDTEVR
  3286*                            ELCDTEVR.                           *   LV003
  3287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3288*                            VMOD=2.001                          *   CL**2
  3289*                                                                *ELCDTEVR
  3290*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  3291*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  3292*                                                                *ELCDTEVR
  3293******************************************************************ELCDTEVR
  3294 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  3295     05  WS-RUN-DATE.                                             ELCDTEVR
  3296         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3297         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  3298         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  3299             15  RUN-CC              PIC  99.                     ELCDTEVR
  3300             15  RUN-YR              PIC  99.                     ELCDTEVR
  3301         10  RUN-MO                  PIC  99.                     ELCDTEVR
  3302         10  RUN-DA                  PIC  99.                     ELCDTEVR
  3303     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  3304            WS-RUN-DATE              PIC 9(11).                      CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  65
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3305     05  WS-EP-DT.                                                ELCDTEVR
  3306         10  FILLER                  PIC  9(03).                  ELCDTEVR
  3307         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  3308         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  3309             15  EP-CC               PIC  99.                     ELCDTEVR
  3310             15  EP-YR               PIC  99.                     ELCDTEVR
  3311         10  EP-MO                   PIC  99.                     ELCDTEVR
  3312         10  EP-DA                   PIC  99.                     ELCDTEVR
  3313     05  WS-EP-DT-N REDEFINES                                        CL**2
  3314            WS-EP-DT                 PIC 9(11).                      CL**2
  3315     05  WS-DTE-CONV-DT.                                             CL**4
  3316         10  FILLER                  PIC  9(03).                     CL**4
  3317         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  3318         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  3319             15  DTE-CONV-CC         PIC  99.                        CL**4
  3320             15  DTE-CONV-YR         PIC  99.                        CL**4
  3321         10  DTE-CONV-MO             PIC  99.                        CL**4
  3322         10  DTE-CONV-DA             PIC  99.                        CL**4
  3323     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  3324            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  3325 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  3326     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  3327         10  FILLER                            PIC 999.           ELCDTEVR
  3328         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  3329         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  3330             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  3331             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  3332         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  3333         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  3334     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  3335            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  3336     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  3337         10  FILLER                            PIC 999.           ELCDTEVR
  3338         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  3339         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  3340         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  3341         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  3342     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  3343            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  3344 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  3345     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  3346         10  FILLER                            PIC 999.           ELCDTEVR
  3347         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  3348         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  3349             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  3350             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  3351         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  3352         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  3353     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  3354            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  3355     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  3356         10  FILLER                            PIC 999.           ELCDTEVR
  3357         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  3358         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  3359             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  3360             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  3361         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  3362         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  66
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  3363     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  3364            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  3365     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  3366         10  FILLER                            PIC 999.           ELCDTEVR
  3367         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  3368         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  3369             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  3370             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  3371         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  3372         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  3373     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  3374            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  3375 01  WS-RATE-RECORD.                                              ELCDTEVR
  3376         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  3377             10  FILLER                        PIC 999.           ELCDTEVR
  3378             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  3379             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  3380                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  3381                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  3382             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  3383             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  3384         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  3385                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  3386
* 3387                             COPY ELCCRTVR.
  3388***************************************************************** 04/24/98
  3389*                                                                *ELCCRTVR
  3390*                                                                *ELCCRTVR
  3391*                            ELCCRTVR                            *   LV003
  3392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3393*                            VMOD=2.001                          *ELCCRTVR
  3394*                                                                *ELCCRTVR
  3395*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCCRTVR
  3396*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTVR
  3397*                                                                *ELCCRTVR
  3398******************************************************************ELCCRTVR
  3399                                                                  ELCCRTVR
  3400 01  WS-CERTIFICATE-RECORD-DATE.                                  ELCCRTVR
  3401     05  WS-CR-DT.                                                ELCCRTVR
  3402         10  FILLER                PIC 999.                       ELCCRTVR
  3403         10  CR-CCYY               PIC 9(04).                     ELCCRTVR
  3404         10  CR-CCYR  REDEFINES  CR-CCYY.                         ELCCRTVR
  3405             15  CR-CC             PIC 99.                        ELCCRTVR
  3406             15  CR-YR             PIC 99.                        ELCCRTVR
  3407         10  CR-MO                 PIC 99.                        ELCCRTVR
  3408         10  CR-DA                 PIC 99.                        ELCCRTVR
  3409     05  WS-CR-DT-N REDEFINES                                        CL**2
  3410            WS-CR-DT               PIC 9(11).                        CL**2
  3411     05  WS-CR-LF-EXPIRE-DATE.                                    ELCCRTVR
  3412         10  FILLER                    PIC 999.                   ELCCRTVR
  3413         10  CR-LF-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3414         10  CR-LF-EXPIRE-CCYR  REDEFINES  CR-LF-EXPIRE-CCYY.     ELCCRTVR
  3415             15  CR-LF-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3416             15  CR-LF-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3417         10  CR-LF-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3418         10  CR-LF-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3419     05  WS-CR-LF-EXPIRE-DATE-N REDEFINES                            CL**2
  3420            WS-CR-LF-EXPIRE-DATE       PIC 9(11).                    CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  67
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3421     05  WS-CR-AH-EXPIRE-DATE.                                    ELCCRTVR
  3422         10  FILLER                    PIC 999.                   ELCCRTVR
  3423         10  CR-AH-EXPIRE-CCYY         PIC 9(04).                 ELCCRTVR
  3424         10  CR-AH-EXPIRE-CCYR   REDEFINES CR-AH-EXPIRE-CCYY.     ELCCRTVR
  3425             15  CR-AH-EXPIRE-CC       PIC 99.                    ELCCRTVR
  3426             15  CR-AH-EXPIRE-YR       PIC 99.                    ELCCRTVR
  3427         10  CR-AH-EXPIRE-MO           PIC 99.                    ELCCRTVR
  3428         10  CR-AH-EXPIRE-DA           PIC 99.                    ELCCRTVR
  3429     05  WS-CR-AH-EXPIRE-DATE-N REDEFINES                            CL**2
  3430            WS-CR-AH-EXPIRE-DATE       PIC 9(11).                    CL**2
  3431     05  WS-CR-ENTRY-DATE.                                        ELCCRTVR
  3432         10  FILLER                    PIC 999.                   ELCCRTVR
  3433         10  CR-ENTRY-CCYY             PIC 9(04).                 ELCCRTVR
  3434         10  CR-ENTRY-CCYR  REDEFINES  CR-ENTRY-CCYY.             ELCCRTVR
  3435             15 CR-ENTRY-CC            PIC 99.                    ELCCRTVR
  3436             15 CR-ENTRY-YR            PIC 99.                    ELCCRTVR
  3437         10  CR-ENTRY-MO               PIC 99.                    ELCCRTVR
  3438         10  CR-ENTRY-DA               PIC 99.                    ELCCRTVR
  3439     05  WS-CR-ENTRY-DATE-N REDEFINES                                CL**2
  3440            WS-CR-ENTRY-DATE           PIC 9(11).                    CL**2
  3441     05  WS-CR-LF-CANC-DT.                                        ELCCRTVR
  3442         10  FILLER                    PIC 999.                   ELCCRTVR
  3443         10  CR-LF-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3444         10  CR-LF-CNC-CCYR   REDEFINES CR-LF-CNC-CCYY.           ELCCRTVR
  3445             15  CR-LF-CNC-CC          PIC 99.                    ELCCRTVR
  3446             15  CR-LF-CNC-YR          PIC 99.                    ELCCRTVR
  3447         10  CR-LF-CNC-MO              PIC 99.                    ELCCRTVR
  3448         10  CR-LF-CNC-DA              PIC 99.                    ELCCRTVR
  3449     05  WS-CR-LF-CANC-DT-N REDEFINES                                CL**2
  3450            WS-CR-LF-CANC-DT           PIC 9(11).                    CL**2
  3451     05  WS-CR-LF-CANCEL-EXIT-DATE.                               ELCCRTVR
  3452         10  FILLER                    PIC 999.                   ELCCRTVR
  3453         10  CR-LF-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3454         10  CR-LF-CEX-CCYR  REDEFINES  CR-LF-CEX-CCYY.              CL**3
  3455             15  CR-LF-CEX-CC          PIC 99.                    ELCCRTVR
  3456             15  CR-LF-CEX-YR          PIC 99.                    ELCCRTVR
  3457         10  CR-LF-CEX-MO              PIC 99.                    ELCCRTVR
  3458         10  CR-LF-CEX-DA              PIC 99.                    ELCCRTVR
  3459     05  WS-CR-LF-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3460            WS-CR-LF-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3461     05  WS-CR-LF-CLAIM-EXIT-DATE.                                ELCCRTVR
  3462         10  FILLER                    PIC 999.                   ELCCRTVR
  3463         10  CR-LF-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3464         10  CR-LF-DEX-CCYR  REDEFINES  CR-LF-DEX-CCYY.           ELCCRTVR
  3465             15  CR-LF-DEX-CC          PIC 99.                    ELCCRTVR
  3466             15  CR-LF-DEX-YR          PIC 99.                    ELCCRTVR
  3467         10  CR-LF-DEX-MO              PIC 99.                    ELCCRTVR
  3468         10  CR-LF-DEX-DA              PIC 99.                    ELCCRTVR
  3469     05  WS-CR-LF-CLAIM-EXIT-DATE-N REDEFINES                        CL**2
  3470            WS-CR-LF-CLAIM-EXIT-DATE   PIC 9(11).                    CL**2
  3471     05  WS-CR-AH-CANC-DT.                                        ELCCRTVR
  3472         10  FILLER                    PIC 999.                   ELCCRTVR
  3473         10  CR-AH-CNC-CCYY            PIC 9(04).                 ELCCRTVR
  3474         10  CR-AH-CNC-CCYR  REDEFINES  CR-AH-CNC-CCYY.           ELCCRTVR
  3475             15  CR-AH-CNC-CC          PIC 99.                    ELCCRTVR
  3476             15  CR-AH-CNC-YR          PIC 99.                    ELCCRTVR
  3477         10  CR-AH-CNC-MO              PIC 99.                    ELCCRTVR
  3478         10  CR-AH-CNC-DA              PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  68
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3479     05  WS-CR-AH-CANC-DT-N  REDEFINES                               CL**2
  3480            WS-CR-AH-CANC-DT           PIC 9(11).                    CL**2
  3481     05  WS-CR-AH-CANCEL-EXIT-DATE.                               ELCCRTVR
  3482         10  FILLER                    PIC 999.                   ELCCRTVR
  3483         10  CR-AH-CEX-CCYY            PIC 9(04).                 ELCCRTVR
  3484         10  CR-AH-CEX-CCYR  REDEFINES  CR-AH-CEX-CCYY.           ELCCRTVR
  3485             15  CR-AH-CEX-CC          PIC 99.                    ELCCRTVR
  3486             15  CR-AH-CEX-YR          PIC 99.                    ELCCRTVR
  3487         10  CR-AH-CEX-MO              PIC 99.                    ELCCRTVR
  3488         10  CR-AH-CEX-DA              PIC 99.                    ELCCRTVR
  3489     05  WS-CR-AH-CANCEL-EXIT-DATE-N REDEFINES                       CL**2
  3490            WS-CR-AH-CANCEL-EXIT-DATE  PIC 9(11).                    CL**2
  3491     05  WS-CR-AH-SETTLEMENT-EXIT-DATE.                           ELCCRTVR
  3492         10  FILLER                    PIC 999.                   ELCCRTVR
  3493         10  CR-AH-DEX-CCYY            PIC 9(04).                 ELCCRTVR
  3494         10  CR-AH-DEX-CCYR  REDEFINES  CR-AH-DEX-CCYY.           ELCCRTVR
  3495             15  CR-AH-DEX-CC          PIC 99.                    ELCCRTVR
  3496             15  CR-AH-DEX-YR          PIC 99.                    ELCCRTVR
  3497         10  CR-AH-DEX-MO              PIC 99.                    ELCCRTVR
  3498         10  CR-AH-DEX-DA              PIC 99.                    ELCCRTVR
  3499     05  WS-CR-AH-SETTLEMENT-EXIT-DATEN REDEFINES                    CL**5
  3500          WS-CR-AH-SETTLEMENT-EXIT-DATE   PIC 9(11).                 CL**5
  3501     05  WS-CR-DTH-DT.                                            ELCCRTVR
  3502         10  FILLER                    PIC 999.                   ELCCRTVR
  3503         10  CR-DTH-CCYY               PIC 9(04).                 ELCCRTVR
  3504         10  CR-DTH-CCYR  REDEFINES  CR-DTH-CCYY.                 ELCCRTVR
  3505             15  CR-DTH-CC             PIC 99.                    ELCCRTVR
  3506             15  CR-DTH-YR             PIC 99.                    ELCCRTVR
  3507         10  CR-DTH-MO                 PIC 99.                    ELCCRTVR
  3508         10  CR-DTH-DA                 PIC 99.                    ELCCRTVR
  3509     05  WS-CR-DTH-DT-N REDEFINES                                    CL**2
  3510            WS-CR-DTH-DT               PIC 9(11).                    CL**2
  3511     05  WS-CR-DTH-PAY-DT.                                        ELCCRTVR
  3512         10  FILLER                    PIC 999.                   ELCCRTVR
  3513         10  CR-DTH-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3514         10  CR-DTH-PAY-CCYR  REDEFINES CR-DTH-PAY-CCYY.          ELCCRTVR
  3515             15  CR-DTH-PAY-CC         PIC 99.                    ELCCRTVR
  3516             15  CR-DTH-PAY-YR         PIC 99.                    ELCCRTVR
  3517         10  CR-DTH-PAY-MO             PIC 99.                    ELCCRTVR
  3518         10  CR-DTH-PAY-DA             PIC 99.                    ELCCRTVR
  3519     05  WS-CR-DTH-PAY-DT-N REDEFINES                                CL**2
  3520            WS-CR-DTH-PAY-DT           PIC 9(11).                    CL**2
  3521     05  WS-CR-DIS-DT.                                            ELCCRTVR
  3522         10  FILLER                    PIC 999.                   ELCCRTVR
  3523         10  CR-DIS-CCYY               PIC 9(04).                 ELCCRTVR
  3524         10  CR-DIS-CCYR  REDEFINES  CR-DIS-CCYY.                 ELCCRTVR
  3525             15  CR-DIS-CC             PIC 99.                    ELCCRTVR
  3526             15  CR-DIS-YR             PIC 99.                    ELCCRTVR
  3527         10  CR-DIS-MO                 PIC 99.                    ELCCRTVR
  3528         10  CR-DIS-DA                 PIC 99.                    ELCCRTVR
  3529     05  WS-CR-DIS-DT-N REDEFINES                                    CL**2
  3530            WS-CR-DIS-DT               PIC 9(11).                    CL**2
  3531     05  WS-CR-DIS-PAY-DT.                                        ELCCRTVR
  3532         10  FILLER                    PIC 999.                   ELCCRTVR
  3533         10  CR-DIS-PAY-CCYY           PIC 9(04).                 ELCCRTVR
  3534         10  CR-DIS-PAY-CCYR  REDEFINES  CR-DIS-PAY-CCYY.         ELCCRTVR
  3535             15  CR-DIS-PAY-CC         PIC 99.                    ELCCRTVR
  3536             15  CR-DIS-PAY-YR         PIC 99.                    ELCCRTVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  69
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCCRTVR)
  3537         10  CR-DIS-PAY-MO             PIC 99.                    ELCCRTVR
  3538         10  CR-DIS-PAY-DA             PIC 99.                    ELCCRTVR
  3539     05  WS-CR-DIS-PAY-DT-N REDEFINES                                CL**2
  3540            WS-CR-DIS-PAY-DT           PIC 9(11).                    CL**2
  3541     05  WS-CR-DIS-PTO-DT.                                        ELCCRTVR
  3542         10  FILLER                    PIC 999.                   ELCCRTVR
  3543         10  CR-DIS-PTO-CCYY           PIC 9(04).                 ELCCRTVR
  3544         10  CR-DIS-PTO-CCYR  REDEFINES  CR-DIS-PTO-CCYY.         ELCCRTVR
  3545             15  CR-DIS-PTO-CC         PIC 99.                    ELCCRTVR
  3546             15  CR-DIS-PTO-YR         PIC 99.                    ELCCRTVR
  3547         10  CR-DIS-PTO-MO             PIC 99.                    ELCCRTVR
  3548         10  CR-DIS-PTO-DA             PIC 99.                    ELCCRTVR
  3549     05  WS-CR-DIS-PTO-DT-N REDEFINES                                CL**2
  3550            WS-CR-DIS-PTO-DT           PIC 9(11).                    CL**2
  3551     05  COPY-NDX                      PIC 9.                        CL**6
  3552     05  WS-DIS-INCUR-DT OCCURS 5 TIMES.                             CL**6
  3553         10  WS-CR-DIS-INCUR-DT.                                  ELCCRTVR
  3554             15  FILLER                PIC 999.                   ELCCRTVR
  3555             15  CR-DIS-INC-CCYY       PIC 9(04).                 ELCCRTVR
  3556             15  CR-DIS-INC-CCYR  REDEFINES  CR-DIS-INC-CCYY.     ELCCRTVR
  3557                 20  CR-DIS-INC-CC     PIC 99.                    ELCCRTVR
  3558                 20  CR-DIS-INC-YR     PIC 99.                    ELCCRTVR
  3559             15  CR-DIS-INC-MO         PIC 99.                    ELCCRTVR
  3560             15  CR-DIS-INC-DA         PIC 99.                    ELCCRTVR
  3561         10  WS-CR-DIS-INCUR-DT-N REDEFINES                          CL**2
  3562                WS-CR-DIS-INCUR-DT     PIC 9(11).                    CL**2
  3563
* 3564                             COPY ELCPSEVR.
  3565******************************************************************04/16/98
  3566*                                                                *ELCPSEVR
  3567*                                                                *ELCPSEVR
  3568*                            ELCPSEVR                            *   LV003
  3569*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3570*                            VMOD=2.001                          *ELCPSEVR
  3571*                                                                *ELCPSEVR
  3572*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCPSEVR
  3573*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCPSEVR
  3574*                                                                *ELCPSEVR
  3575******************************************************************ELCPSEVR
  3576                                                                  ELCPSEVR
  3577 01  WS-PD-SUMMARY-DETAIL-EXTR-DT.                                ELCPSEVR
  3578     05  WS-PSC-CID-LOW.                                          ELCPSEVR
  3579         10  FILLER               PIC 999.                        ELCPSEVR
  3580         10  PSC-CID-LOW-CCYY     PIC 9(04).                      ELCPSEVR
  3581         10  PSC-CID-LOW-CCYR  REDEFINES  PSC-CID-LOW-CCYY.       ELCPSEVR
  3582             15  PSC-CID-LOW-CC   PIC 99.                            CL**3
  3583             15  PSC-CID-LOW-YY   PIC 99.                            CL**3
  3584         10  PSC-CID-LOW-MM       PIC 99.                            CL**3
  3585         10  PSC-CID-LOW-DD       PIC 99.                            CL**3
  3586     05  WS-PSC-CID-LOW-N REDEFINES                                  CL**2
  3587            WS-PSC-CID-LOW        PIC 9(11).                         CL**2
  3588     05  WS-PSC-CID-HIGH.                                         ELCPSEVR
  3589         10  FILLER              PIC 999.                         ELCPSEVR
  3590         10  PSC-CID-HIGH-CCYY   PIC 9(04).                       ELCPSEVR
  3591         10  PSC-CID-HIGH-CCYR  REDEFINES  PSC-CID-HIGH-CCYY.     ELCPSEVR
  3592             15  PSC-CID-HIGH-CC PIC 99.                             CL**3
  3593             15  PSC-CID-HIGH-YY PIC 99.                             CL**3
  3594         10  PSC-CID-HIGH-MM     PIC 99.                             CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  70
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCPSEVR)
  3595         10  PSC-CID-HIGH-DD     PIC 99.                             CL**3
  3596     05  WS-PSC-CID-HIGH-N REDEFINES                                 CL**2
  3597            WS-PSC-CID-HIGH          PIC 9(11).                      CL**2
  3598 01  WS-REIN-WORK-AREAS.                                          ELCPSEVR
  3599     05  WS-REIN-CO-HOLD-ENTRIES  OCCURS 1500 TIMES               ELCPSEVR
  3600                 INDEXED BY CPSE-NDX.                             ELCPSEVR
  3601         10  WS-RCT-CLM-CUTOFF-DT.                                ELCPSEVR
  3602             15  FILLER              PIC 999.                     ELCPSEVR
  3603             15  RCT-CUTOFF-CCYY     PIC 9(04).                   ELCPSEVR
  3604             15  RCT-CUTOFF-CCYR  REDEFINES  RCT-CUTOFF-CCYY.     ELCPSEVR
  3605                 20  RCT-CUTOFF-CC   PIC 99.                      ELCPSEVR
  3606                 20  RCT-CUTOFF-YR   PIC 99.                      ELCPSEVR
  3607             15  RCT-CUTOFF-MO       PIC 99.                      ELCPSEVR
  3608             15  RCT-CUTOFF-DA       PIC 99.                      ELCPSEVR
  3609         10  WS-RCT-CLM-CUTOFF-DT-N REDEFINES                        CL**2
  3610                WS-RCT-CLM-CUTOFF-DT PIC 9(11).                      CL**2
  3611         10  WS-RCT-EARNING-START-DT.                             ELCPSEVR
  3612             15  FILLER              PIC 999.                     ELCPSEVR
  3613             15  RCT-START-CCYY      PIC 9(04).                   ELCPSEVR
  3614             15  RCT-START-CCYR  REDEFINES  RCT-START-CCYY.       ELCPSEVR
  3615                 20  RCT-START-CC    PIC 99.                      ELCPSEVR
  3616                 20  RCT-START-YR    PIC 99.                      ELCPSEVR
  3617             15  RCT-START-MO        PIC 99.                      ELCPSEVR
  3618             15  RCT-START-DA        PIC 99.                      ELCPSEVR
  3619         10  WS-RCT-EARNING-START-DT-N REDEFINES                     CL**2
  3620                WS-RCT-EARNING-START-DT  PIC 9(11).                  CL**2
  3621         10  WS-RCT-EARNING-STOP-DT.                              ELCPSEVR
  3622             15  FILLER              PIC 999.                     ELCPSEVR
  3623             15  RCT-STOP-CCYY       PIC 9(04).                   ELCPSEVR
  3624             15  RCT-STOP-CCYR  REDEFINES  RCT-STOP-CCYY.         ELCPSEVR
  3625                 20  RCT-STOP-CC     PIC 99.                      ELCPSEVR
  3626                 20  RCT-STOP-YR     PIC 99.                      ELCPSEVR
  3627             15  RCT-STOP-MO         PIC 99.                      ELCPSEVR
  3628             15  RCT-STOP-DA         PIC 99.                      ELCPSEVR
  3629         10  WS-RCT-EARNING-STOP-DT-N REDEFINES                      CL**2
  3630                WS-RCT-EARNING-STOP-DT   PIC 9(11).                  CL**2
  3631     05  WS-RWF-EP-STOP-DATE.                                     ELCPSEVR
  3632         10  FILLER              PIC 999.                         ELCPSEVR
  3633         10  RWF-EP-STOP-CCYY    PIC 9(04).                       ELCPSEVR
  3634         10  RWF-EP-STOP-CCYR REDEFINES  RWF-EP-STOP-CCYY.        ELCPSEVR
  3635             15  RWF-EP-STOP-CC  PIC 99.                          ELCPSEVR
  3636             15  RWF-EP-STOP-YR  PIC 99.                          ELCPSEVR
  3637         10  RWF-EP-STOP-MO      PIC 99.                          ELCPSEVR
  3638         10  RWF-EP-STOP-DA      PIC 99.                          ELCPSEVR
  3639     05  WS-RWF-EP-STOP-DATE-N REDEFINES                             CL**2
  3640            WS-RWF-EP-STOP-DATE  PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  71
* ECS026P.cbl
  3642 PROCEDURE DIVISION.
  3643
  3644 0000-READ-DATE-CARD.
* 3645                             COPY ELCDTERX.
  3646******************************************************************04/15/98
  3647*                                                                *ELCDTERX
  3648*                                                                *ELCDTERX
  3649*                            ELCDTERX.                           *   LV002
  3650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  3651*                            VMOD=2.007                          *ELCDTERX
  3652*                                                                *ELCDTERX
  3653*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  3654*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  3655*      = ELCDTEFD)                                               *ELCDTERX
  3656*                                                                *ELCDTERX
  3657******************************************************************ELCDTERX
  3658                                                                  ELCDTERX
  3659     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  3660                                                                  ELCDTERX
  3661     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  3662     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  3663     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  3664                                                                  ELCDTERX
  3665     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  3666                                                                  ELCDTERX
  3667******************************************************************ELCDTERX
  3668*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  3669*          WARNING MESSAGES.                                      ELCDTERX
  3670******************************************************************ELCDTERX
  3671     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  3672         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  3673                                                                  ELCDTERX
  3674     OPEN INPUT DISK-DATE.                                        ELCDTERX
  3675                                                                  ELCDTERX
  3676     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  3677                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  3678                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  3679                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  3680                   CLAX-ID           CLAS-MISC                    ELCDTERX
  3681                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  3682                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  3683                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  3684                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  3685                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  3686                                                                  ELCDTERX
  3687     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  3688                                                                  ELCDTERX
  3689     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  3690                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  3691                                                                  ELCDTERX
  3692     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  3693     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  3694     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  3695     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  3696                                                                  ELCDTERX
  3697     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  3698         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  3699     ELSE                                                         ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  72
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3700         ADD +1                 TO CLAS-CN.                       ELCDTERX
  3701                                                                  ELCDTERX
  3702     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  3703         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  3704     ELSE                                                         ELCDTERX
  3705         ADD +1                 TO CLAS-CO.                       ELCDTERX
  3706                                                                  ELCDTERX
  3707 0005-READ--CARD.                                                 ELCDTERX
  3708     READ DISK-DATE                                               ELCDTERX
  3709         AT END CLOSE DISK-DATE                                   ELCDTERX
  3710             GO TO 0060-READ--TEST.                               ELCDTERX
  3711                                                                  ELCDTERX
  3712     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  3713                                                                  ELCDTERX
  3714     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  3715         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  3716         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  3717         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  3718         GO TO 0005-READ--CARD.                                   ELCDTERX
  3719                                                                  ELCDTERX
  3720     IF DD-ID = 'CLAD'                                            ELCDTERX
  3721         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  3722         GO TO 0005-READ--CARD.                                   ELCDTERX
  3723                                                                  ELCDTERX
  3724     IF DD-ID = 'CLAX'                                            ELCDTERX
  3725         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  3726         GO TO 0005-READ--CARD.                                   ELCDTERX
  3727                                                                  ELCDTERX
  3728     IF DD-ID = 'CLAF'                                            ELCDTERX
  3729         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  3730         GO TO 0005-READ--CARD.                                   ELCDTERX
  3731                                                                  ELCDTERX
  3732     IF DD-ID = 'CLAC'                                            ELCDTERX
  3733         GO TO 0010-READ--CLAC.                                   ELCDTERX
  3734                                                                  ELCDTERX
  3735     IF DD-ID = 'CARR'                                            ELCDTERX
  3736         GO TO 0015-READ--CARR.                                   ELCDTERX
  3737                                                                  ELCDTERX
  3738     IF DD-ID = 'STAT'                                            ELCDTERX
  3739         GO TO 0020-READ--STAT.                                   ELCDTERX
  3740                                                                  ELCDTERX
  3741     IF DD-ID = 'BUSC'                                            ELCDTERX
  3742         GO TO 0025-READ--BUSC.                                   ELCDTERX
  3743                                                                  ELCDTERX
  3744     IF DD-ID = 'MORT'                                            ELCDTERX
  3745         GO TO 0030-READ--MORT.                                   ELCDTERX
  3746                                                                  ELCDTERX
  3747     IF DD-ID = 'CLAI'                                            ELCDTERX
  3748         GO TO 0040-READ--CLAI.                                   ELCDTERX
  3749                                                                  ELCDTERX
  3750     IF DD-ID = 'COLC'                                            ELCDTERX
  3751         GO TO 0065-READ--COLC.                                   ELCDTERX
  3752                                                                  ELCDTERX
  3753     IF DD-IDX NUMERIC AND                                        ELCDTERX
  3754        DD-IDA = 'CL'                                             ELCDTERX
  3755         GO TO 0035-READ--CLXX.                                   ELCDTERX
  3756                                                                  ELCDTERX
  3757     IF DD-IDX NUMERIC AND                                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  73
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3758        DD-IDA = 'PO'                                             ELCDTERX
  3759         GO TO 0050-READ--POXX.                                   ELCDTERX
  3760                                                                  ELCDTERX
  3761     IF DD-ID = 'OPCA'                                            ELCDTERX
  3762         GO TO 0070-READ--OPCA.                                   ELCDTERX
  3763                                                                  ELCDTERX
  3764     IF DD-ID = 'OPST'                                            ELCDTERX
  3765         GO TO 0072-READ--OPST.                                   ELCDTERX
  3766                                                                  ELCDTERX
  3767     IF DD-ID = 'OPBS'                                            ELCDTERX
  3768         GO TO 0074-READ--OPBS.                                   ELCDTERX
  3769                                                                  ELCDTERX
  3770     IF DD-ID = 'OPMS'                                            ELCDTERX
  3771         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  3772                                                                  ELCDTERX
  3773     GO TO 0005-READ--CARD.                                       ELCDTERX
  3774                                                                  ELCDTERX
  3775 0010-READ--CLAC.                                                 ELCDTERX
  3776     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  3777     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  3778     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  3779     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  3780     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  3781     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  3782     GO TO 0005-READ--CARD.                                       ELCDTERX
  3783                                                                  ELCDTERX
  3784 0015-READ--CARR.                                                 ELCDTERX
  3785     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  3786     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  3787        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  3788        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  3789        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  3790        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  3791        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  3792        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  3793        MOVE DD-CARR1-SECPAY-SW
  3794                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  3795     END-IF
  3796                                                                  ELCDTERX
  3797     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  3798     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  3799        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  3800        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  3801        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  3802        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  3803        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  3804        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  3805        MOVE DD-CARR2-SECPAY-SW
  3806                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  3807     END-IF
  3808                                                                  ELCDTERX
  3809                                                                  ELCDTERX
  3810     GO TO 0005-READ--CARD.                                       ELCDTERX
  3811                                                                  ELCDTERX
  3812 0020-READ--STAT.                                                 ELCDTERX
  3813     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3814     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  3815        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  74
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3816         GO TO 0005-READ--CARD.                                   ELCDTERX
  3817                                                                  ELCDTERX
  3818     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  3819     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  3820     GO TO 0020-READ--STAT.                                       ELCDTERX
  3821                                                                  ELCDTERX
  3822 0025-READ--BUSC.                                                 ELCDTERX
  3823     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3824     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  3825        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  3826         GO TO 0005-READ--CARD.                                   ELCDTERX
  3827                                                                  ELCDTERX
  3828     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  3829     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  3830     GO TO 0025-READ--BUSC.                                       ELCDTERX
  3831                                                                  ELCDTERX
  3832 0030-READ--MORT.                                                 ELCDTERX
  3833     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3834     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  3835        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  3836         GO TO 0005-READ--CARD.                                   ELCDTERX
  3837                                                                  ELCDTERX
  3838     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  3839     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  3840     GO TO 0030-READ--MORT.                                       ELCDTERX
  3841                                                                  ELCDTERX
  3842 0035-READ--CLXX.                                                 ELCDTERX
  3843     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  3844          GO TO 0005-READ--CARD.                                  ELCDTERX
  3845                                                                  ELCDTERX
  3846     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  3847         DISPLAY '***********************************************'ELCDTERX
  3848         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  3849         DISPLAY '***********************************************'ELCDTERX
  3850         GO TO 0055-READ--STOP.                                   ELCDTERX
  3851                                                                  ELCDTERX
  3852     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  3853        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  3854         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  3855                                                                  ELCDTERX
  3856     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  3857        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  3858         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  3859                                                                  ELCDTERX
  3860*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  3861     GO TO 0005-READ--CARD.                                       ELCDTERX
  3862                                                                  ELCDTERX
  3863 0040-READ--CLAI.                                                 ELCDTERX
  3864     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3865     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  3866        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  3867         GO TO 0005-READ--CARD.                                   ELCDTERX
  3868                                                                  ELCDTERX
  3869     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  3870     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  3871     GO TO 0040-READ--CLAI.                                       ELCDTERX
  3872                                                                  ELCDTERX
  3873 0045-READ--DUMP.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  75
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3874     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  3875     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  3876                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  3877     PERFORM ABEND-PGM.                                           ELCDTERX
  3878                                                                  ELCDTERX
  3879 0050-READ--POXX.                                                 ELCDTERX
  3880     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  3881         GO TO 0005-READ--CARD.                                   ELCDTERX
  3882                                                                  ELCDTERX
  3883     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  3884         DISPLAY '***********************************************'ELCDTERX
  3885         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  3886         DISPLAY '***********************************************'ELCDTERX
  3887         GO TO 0055-READ--STOP.                                   ELCDTERX
  3888                                                                  ELCDTERX
  3889     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  3890     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  3891     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  3892     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  3893                                                                  ELCDTERX
  3894     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  3895         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  3896     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  3897         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  3898                                                                  ELCDTERX
  3899     GO TO 0005-READ--CARD.                                       ELCDTERX
  3900                                                                  ELCDTERX
  3901 0055-READ--STOP.                                                 ELCDTERX
  3902     GOBACK.                                                      ELCDTERX
  3903                                                                  ELCDTERX
  3904 0060-READ--TEST.                                                 ELCDTERX
  3905     IF DATX-COD        = SPACE  OR                               ELCDTERX
  3906        CLAX-ID         = SPACE  OR                               ELCDTERX
  3907        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  3908         GO TO 0045-READ--DUMP.                                   ELCDTERX
  3909                                                                  ELCDTERX
  3910     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  3911     GO TO 0079-READ--EXIT.                                       ELCDTERX
  3912                                                                  ELCDTERX
  3913 0065-READ--COLC.                                                 ELCDTERX
  3914     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  3915     GO TO 0005-READ--CARD.                                       ELCDTERX
  3916                                                                  ELCDTERX
  3917 0070-READ--OPCA.                                                 ELCDTERX
  3918                                                                  ELCDTERX
  3919     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3920                                                                  ELCDTERX
  3921     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  3922             OR                                                   ELCDTERX
  3923         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  3924         GO TO 0005-READ--CARD.                                   ELCDTERX
  3925                                                                  ELCDTERX
  3926     ADD 1                       TO INDEXCA.                      ELCDTERX
  3927     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  3928                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  3929     GO TO 0070-READ--OPCA.                                       ELCDTERX
  3930                                                                  ELCDTERX
  3931 0072-READ--OPST.                                                 ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  76
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  3932                                                                  ELCDTERX
  3933     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3934                                                                  ELCDTERX
  3935     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  3936             OR                                                   ELCDTERX
  3937         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3938         GO TO 0005-READ--CARD.                                   ELCDTERX
  3939                                                                  ELCDTERX
  3940     ADD 1                       TO INDEXST.                      ELCDTERX
  3941     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  3942                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  3943     GO TO 0072-READ--OPST.                                       ELCDTERX
  3944                                                                  ELCDTERX
  3945 0074-READ--OPBS.                                                 ELCDTERX
  3946                                                                  ELCDTERX
  3947     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  3948                                                                  ELCDTERX
  3949     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  3950             OR                                                   ELCDTERX
  3951         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  3952         GO TO 0005-READ--CARD.                                   ELCDTERX
  3953                                                                  ELCDTERX
  3954     ADD 1                       TO INDEXBS.                      ELCDTERX
  3955     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  3956     GO TO 0074-READ--OPBS.                                       ELCDTERX
  3957                                                                  ELCDTERX
  3958 0079-READ--EXIT.                                                 ELCDTERX
  3959*    EXIT.                                                        ELCDTERX
  3960******************************************************************ELCDTERX
  3961
  3962 0100-MAIN-LINE.
  3963     OPEN OUTPUT PRINTER.
  3964
  3965     PERFORM 0120-INITIALIZATION  THRU 0199-EXIT.
  3966
  3967     PERFORM 0200-MAIN-PROCESSING THRU 0299-EXIT.
  3968
  3969     CLOSE PRINTER.
  3970
  3971 0110-CLOSE-FICH.
* 3972                             COPY ELCPRTC.
  3973******************************************************************04/15/98
  3974*                                                                *ELCPRTC
  3975*                                                                *ELCPRTC
  3976*                            ELCPRTC.                            *   LV003
  3977*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  3978*                            VMOD=2.002                          *   CL**2
  3979*       CLOSE FICH FILE IF OPEN                                  *ELCPRTC
  3980*                                                                *ELCPRTC
  3981* NOTE- USE ELCPRTCX IF USING ELCPRT2X (ONLINE REPORT SAVE)      *   CL**2
  3982******************************************************************ELCPRTC
  3983                                                                  ELCPRTC
  3984      IF FICH-OPEN NOT = SPACE                                    ELCPRTC
  3985          CLOSE FICH.                                             ELCPRTC
  3986                                                                  ELCPRTC
  3987******************************************************************ELCPRTC
  3988
  3989     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  77
* ECS026P.cbl
  3990
  3991 0120-INITIALIZATION.
  3992     MOVE WS-CURRENT-DATE        TO H2-CURRENT-DATE.
  3993
  3994     MOVE COMPANY-NAME           TO H2-COMPANY.
  3995     MOVE ALPH-DATE              TO H3-RUN-DATE.
  3996
  3997     MOVE SPACES TO REIN-LEVELS-END.
  3998     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  3999
  4000     MOVE '1'                    TO WK-BREAK-TYPE.
  4001     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4002
  4003     MOVE '2'                    TO WK-BREAK-TYPE.
  4004     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4005
  4006     MOVE '3'                    TO WK-BREAK-TYPE.
  4007     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4008
  4009     MOVE '4'                    TO WK-BREAK-TYPE.
  4010     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4011
  4012     MOVE '5'                    TO WK-BREAK-TYPE.
  4013     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  4014
  4015     PERFORM 6700-CLEAR-PRINT-TABLE THRU 6799-EXIT.
  4016
  4017     MOVE  '1'                   TO WK-BREAK-TYPE.
  4018
  4019     IF DTE-PRC-OPT NOT NUMERIC
  4020         MOVE 1 TO DTE-PRC-OPT.
  4021
  4022     IF DTE-TOT-OPT NOT NUMERIC
  4023         MOVE 1 TO DTE-TOT-OPT.
  4024
  4025     MOVE RUN-DATE              TO EOM-RUN-DATE.
  4026     MOVE BIN-RUN-DATE          TO BIN-EOM-DT.
  4027
  4028     MOVE RUN-CCYY              TO POT-CCYY.
  4029     MOVE RUN-MO                TO POT-MO.
  4030
  4031     IF DTE-PRC-OPT = 1 OR 2 OR 3 OR 4
  4032         COMPUTE POF-CCYY = RUN-CCYY - DTE-PRC-OPT
  4033         COMPUTE POF-MO   = RUN-MO + 1
  4034         IF POF-MO GREATER 12
  4035             MOVE 01 TO POF-MO
  4036             ADD 1 TO POF-CCYY.
  4037
  4038 0199-EXIT.
  4039     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  78
* ECS026P.cbl
  4041 0200-MAIN-PROCESSING.
  4042     PERFORM  0300-CREATE-EXTRACTS  THRU  0399-EXIT.
  4043
  4044     CLOSE TEMP-WORK.
  4045     SORT SORT-WORK ON ASCENDING SR-CONTROL
  4046                                 USING  TEMP-WORK
  4047                                 GIVING TEMP-WORK.
  4048
  4049     IF SORT-RETURN NOT = ZEROS
  4050         MOVE  '0101'            TO  WS-RETURN-CODE
  4051         MOVE  'SORT ERROR'      TO  WS-ABEND-MESSAGE
  4052         GO TO ABEND-PGM.
  4053
  4054     OPEN INPUT TEMP-WORK.
  4055
  4056     MOVE 'A' TO WK-RPT-CODE.
  4057     PERFORM  3000-PRODUCE-REPORTS  THRU  3099-EXIT.
  4058
  4059     CLOSE TEMP-WORK.
  4060
  4061     IF WS-PRINT-RPT-B = 'Y'
  4062         SORT SORT-WORK ON ASCENDING SR-CONTROL-B
  4063                                     USING  TEMP-WORK
  4064                                     GIVING TEMP-WORK
  4065         IF SORT-RETURN NOT = ZEROS
  4066             MOVE '0101'         TO  WS-RETURN-CODE
  4067             MOVE 'SORT ERROR'   TO  WS-ABEND-MESSAGE
  4068             GO TO ABEND-PGM
  4069          ELSE
  4070             OPEN INPUT TEMP-WORK
  4071             MOVE 'B'            TO WK-RPT-CODE
  4072             MOVE 'Y'            TO FIRST-TIME-SW
  4073             MOVE 'N'            TO EXTR-END-SW
  4074             PERFORM 3000-PRODUCE-REPORTS THRU 3099-EXIT
  4075             CLOSE TEMP-WORK.
  4076
  4077     IF WS-PRINT-RPT-C = 'Y'
  4078         SORT SORT-WORK ON ASCENDING SR-CONTROL-C1
  4079                                     SR-CONTROL-C2
  4080                                     USING  TEMP-WORK
  4081                                     GIVING TEMP-WORK
  4082         IF SORT-RETURN NOT = ZEROS
  4083             MOVE '0101'         TO  WS-RETURN-CODE
  4084             MOVE 'SORT ERROR'   TO  WS-ABEND-MESSAGE
  4085             GO TO ABEND-PGM
  4086           ELSE
  4087             OPEN INPUT TEMP-WORK
  4088             MOVE 'C'            TO WK-RPT-CODE
  4089             MOVE 'Y'            TO FIRST-TIME-SW
  4090             MOVE 'N'            TO EXTR-END-SW
  4091             PERFORM 3000-PRODUCE-REPORTS THRU 3099-EXIT
  4092             CLOSE TEMP-WORK.
  4093
  4094     MOVE 'D'                 TO WK-RPT-CODE.
  4095     MOVE 'Y'                 TO FIRST-TIME-SW.
  4096     MOVE 'N'                 TO EXTR-END-SW.
  4097
  4098     IF DTE-TOT-OPT = 1 OR 4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  79
* ECS026P.cbl
  4099         SORT SORT-WORK-2 ON ASCENDING SR2-CONTROL
  4100                                       USING  REIN-WORK
  4101                                       GIVING REIN-WORK
  4102         IF SORT-RETURN NOT = ZEROS
  4103             MOVE  '0102'            TO  WS-RETURN-CODE
  4104             MOVE  'SORT ERROR'      TO  WS-ABEND-MESSAGE
  4105             GO TO ABEND-PGM
  4106          ELSE
  4107             OPEN INPUT REIN-WORK
  4108             PERFORM 5000-PRODUCE-D-REPORT THRU 5099-EXIT
  4109                                        UNTIL END-OF-EXTR
  4110             CLOSE REIN-WORK
  4111             IF WS-ERRTBL-OPEN
  4112                 CLOSE ERRTBL-in
  4113                 IF ERRTBL-FILE-STATUS  = '00'
  4114                     NEXT SENTENCE
  4115                 ELSE
  4116                     MOVE 'ERROR OCCURED CLOSE - ERRTBL'
  4117                                      TO  WS-ABEND-MESSAGE
  4118                     MOVE ERRTBL-FILE-STATUS
  4119                                      TO  WS-ABEND-FILE-STATUS
  4120                     GO TO ABEND-PGM.
  4121
  4122 0299-EXIT.
  4123     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  80
* ECS026P.cbl
  4125 0300-CREATE-EXTRACTS.
  4126     OPEN INPUT ACCT-IN  CERT-IN
  4127         OUTPUT TEMP-WORK.
  4128
  4129     IF ERACCT-FILE-STATUS  = '00' OR '97'
  4130         NEXT SENTENCE
  4131      ELSE
  4132         MOVE 'ERROR OCCURED OPEN - ERACCTT' TO WS-ABEND-MESSAGE
  4133         MOVE ERACCT-FILE-STATUS         TO WS-ABEND-FILE-STATUS
  4134         GO TO ABEND-PGM.
  4135
  4136     IF DTE-TOT-OPT = 1 OR 4
  4137         OPEN INPUT ERRTBL-in
  4138              OUTPUT REIN-WORK
  4139         IF ERRTBL-FILE-STATUS  = '35'
  4140             NEXT SENTENCE
  4141         ELSE
  4142             IF ERRTBL-FILE-STATUS  = '00' OR '97'
  4143                 PERFORM REIN-CO-TABLE-BUILD THRU REIN-BUILD-EXIT
  4144                 MOVE 'Y'             TO  WS-ERRTBL-OPEN-SW
  4145             ELSE
  4146                 MOVE 'ERROR OCCURED OPEN - ERRTBL'
  4147                                      TO  WS-ABEND-MESSAGE
  4148                 MOVE ERRTBL-FILE-STATUS
  4149                                      TO  WS-ABEND-FILE-STATUS
  4150                 GO TO ABEND-PGM.
  4151
  4152     PERFORM 0400-PROCESS-CERTS THRU 0499-EXIT
  4153                                UNTIL END-OF-CERT.
  4154
  4155     CLOSE ACCT-IN  CERT-IN.
  4156
  4157     IF ERACCT-FILE-STATUS  = '00'
  4158         NEXT SENTENCE
  4159      ELSE
  4160         MOVE 'ERROR OCCURED CLOSE - ERACCTT'
  4161                                 TO WS-ABEND-MESSAGE
  4162         MOVE ERACCT-FILE-STATUS
  4163                                 TO  WS-ABEND-FILE-STATUS
  4164         GO TO ABEND-PGM.
  4165
  4166     IF DTE-TOT-OPT = 1 OR 4
  4167         CLOSE          REIN-WORK.
  4168
  4169 0399-EXIT.
  4170     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  81
* ECS026P.cbl
  4172 0400-PROCESS-CERTS.
  4173     IF CERT-NEEDED
  4174         PERFORM 9000-READ-CERT-IN  THRU  9099-EXIT.
  4175
  4176     IF ACCOUNT-NEEDED
  4177         PERFORM 9200-READ-ACCT-IN  THRU  9299-EXIT.
  4178
  4179     PERFORM  0500-MATCH-CERT-ACCT  THRU  0599-EXIT.
  4180
  4181     IF NO-MATCH
  4182         MOVE  '0302'            TO  WS-RETURN-CODE
  4183         MOVE  'NO ACCOUNT MATCH' TO  WS-ABEND-MESSAGE
  4184         GO TO ABEND-PGM.
  4185
  4186     IF ACCT-BREAK
  4187         PERFORM 1000-CREATE-EXTRACTS         THRU 1099-EXIT
  4188         PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT
  4189         MOVE  'N'               TO  ACCT-HAS-BIZ-SW
  4190                                     CERT-NEEDED-SW
  4191         MOVE  'Y'               TO  ACCOUNT-NEEDED-SW
  4192         GO TO 0499-EXIT.
  4193
  4194     PERFORM  0700-ACCUMULATE-FROM-CERT  THRU  0799-EXIT.
  4195
  4196     IF (DTE-TOT-OPT = 1 OR 4) AND
  4197        (CR-REIN-TABLE NOT = SPACES AND ZEROS AND LOW-VALUES)
  4198           PERFORM 2000-REINSURE-ROUTINE THRU 2099-EXIT.
  4199
  4200     MOVE  'Y'                   TO  ACCT-HAS-BIZ-SW
  4201                                     CERT-NEEDED-SW.
  4202     MOVE  'N'                   TO  ACCOUNT-NEEDED-SW.
  4203
  4204 0499-EXIT.
  4205     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  82
* ECS026P.cbl
  4207 0500-MATCH-CERT-ACCT.
  4208     IF AM-CONTROL-A LESS CR-ACCT-CONTROL
  4209         MOVE  'Y'               TO  ACCOUNT-BREAK-SW
  4210                                     CERT-ACCT-MATCH-SW
  4211         GO TO 0599-EXIT.
  4212
  4213     IF AM-CONTROL-A GREATER CR-ACCT-CONTROL
  4214         MOVE  'N'               TO  CERT-ACCT-MATCH-SW
  4215         GO TO 0599-EXIT.
  4216
  4217     IF CR-DT LESS AM-EFFECT-DT
  4218         MOVE  'N'               TO  CERT-ACCT-MATCH-SW
  4219         GO TO 0599-EXIT.
  4220
  4221     IF CR-DT NOT LESS AM-EXPIRE-DT
  4222         MOVE  'Y'               TO  ACCOUNT-BREAK-SW
  4223                                     CERT-ACCT-MATCH-SW
  4224         GO TO 0599-EXIT.
  4225
  4226     MOVE  'N'                   TO  ACCOUNT-BREAK-SW.
  4227     MOVE  'Y'                   TO  CERT-ACCT-MATCH-SW.
  4228
  4229 0599-EXIT.
  4230     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  83
* ECS026P.cbl
  4232 0700-ACCUMULATE-FROM-CERT.
  4233     IF CR-AGE  GREATER  +60
  4234         MOVE  +7                TO  A-SUB2.
  4235
  4236     IF CR-AGE  LESS  +61
  4237         MOVE  +6                TO  A-SUB2.
  4238
  4239     IF CR-AGE  LESS  +56
  4240         MOVE  +5                TO  A-SUB2.
  4241
  4242     IF CR-AGE  LESS  +51
  4243         MOVE  +4                TO  A-SUB2.
  4244
  4245     IF CR-AGE  LESS  +46
  4246         MOVE  +3                TO  A-SUB2.
  4247
  4248     IF CR-AGE  LESS  +41
  4249         MOVE  +2                TO  A-SUB2.
  4250
  4251     IF CR-AGE  LESS  +31
  4252         MOVE  +1                TO  A-SUB2.
  4253
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  84
* ECS026P.cbl
  4255 0710-ACCUMULATE-LIFE.
  4256
  4257     MOVE SPACES                 TO WS-LIFE-SW
  4258     IF CR-LFTYP = ZERO
  4259         GO TO 0750-ACCUMULATE-AH.
  4260
  4261     IF DTE-PRC-OPT = 5
  4262         IF CR-LF-POLICY-IS-ACTIVE
  4263              NEXT SENTENCE
  4264            ELSE
  4265              GO TO 0750-ACCUMULATE-AH.
  4266
  4267     MOVE CR-LFTYP               TO CLAS-LOOK.
  4268     PERFORM  0900-FIND-LIFE-TYPE  THRU  0950-EXIT.
  4269
  4270     MOVE CR-LF-TERM             TO ORIG-TERM.
  4271     MOVE RUN-DATE               TO VALUATION-DT.
  4272     PERFORM 8800-REMAINING-TERM-ROUTINE THRU 8899-EXIT.
  4273     MOVE REM-TRM1               TO LF-REM-TRM.
  4274
  4275     IF DTE-PRC-OPT = 5
  4276       IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  4277         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
  4278             IF REM-TRM1 NOT GREATER +0
  4279                 MOVE 'E'           TO CR-LF-CURRENT-STATUS
  4280                 GO TO 0750-ACCUMULATE-AH
  4281             ELSE
  4282                 NEXT SENTENCE
  4283         ELSE
  4284             IF (REM-TRM1 + 1) NOT GREATER +0
  4285                 MOVE 'E'           TO CR-LF-CURRENT-STATUS
  4286                 GO TO 0750-ACCUMULATE-AH
  4287             ELSE
  4288                 NEXT SENTENCE
  4289     ELSE
  4290         IF REM-TRM1 NOT GREATER +0  OR
  4291            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  4292             MOVE 'E'               TO CR-LF-CURRENT-STATUS
  4293             GO TO 0750-ACCUMULATE-AH.
  4294
  4295     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  4296         MOVE  +2                TO  A-SUB1
  4297     ELSE
  4298         MOVE  +1                TO  A-SUB1.
  4299
  4300     MOVE 'Y'                    TO WS-LIFE-SW
  4301     MOVE AT-AMOUNTS (A-SUB1  A-SUB2)
  4302                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  4303
  4304     IF CR-ENTRY-STATUS = '9'
  4305         GO TO 0715-ADD-LIFE-EARN.
  4306
  4307     IF CR-ENTRY-STATUS NOT = '5'
  4308         ADD CR-LFAMT            TO  WA-FACE-BEN
  4309         ADD CR-LFAMT-ALT        TO  WA-FACE-BEN
  4310         ADD CR-LFPRM            TO  WA-ISS-PRM
  4311         ADD CR-LFPRM-ALT        TO  WA-ISS-PRM.
  4312
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  85
* ECS026P.cbl
  4313     ADD CR-LFRFND               TO  WA-CNC-PRM.
  4314     ADD CR-DTHAMT               TO  WA-CLAIM-AMT.
  4315     ADD CR-DTHEXP               TO  WA-CLAIM-AMT.
  4316     ADD +1                      TO  WA-CERT-COUNT.
  4317     ADD CR-NUM-DTH-CLM          TO  WA-CLAIM-COUNT.
  4318
  4319     MOVE  ZERO                  TO  WA-NUMBER-DAYS.
  4320
  4321     IF CR-DTHAMT NOT = ZERO
  4322         ADD  +1                 TO  WA-CRT-W-CLM.
  4323
  4324 0715-ADD-LIFE-EARN.
  4325
  4326     MOVE ZEROS TO EARNED-PREMIUM LF-EPR-R78
  4327                                  LF-EPR-PRO
  4328                                  LF-EPR-ST
  4329                             SAVE-LF-EPR-R78
  4330                             SAVE-LF-EPR-PRO.
  4331
  4332     PERFORM 8200-EP-BUMP-RTN  THRU  8299-EXIT.
  4333     PERFORM 8400-EP-DO-LF     THRU  8499-EXIT.
  4334
  4335     MOVE LF-EPR-R78      TO SAVE-LF-EPR-R78.
  4336     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  4337         MOVE LF-EPR-ST   TO SAVE-LF-EPR-R78.
  4338
  4339     MOVE LF-EPR-PRO      TO SAVE-LF-EPR-PRO.
  4340
  4341     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  4342         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  4343
  4344     IF DTE-CLIENT = 'FIA'
  4345       IF CR-CARRIER = 'A' OR 'B'
  4346         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  4347         GO TO 0715-CONT.
  4348
  4349     IF CLAS-I-EP (CLAS-INDEXL) = '1'
  4350         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO * +.6667)
  4351                                + (LF-EPR-R78 * +.3333)
  4352         GO TO 0715-CONT.
  4353
  4354     IF CLAS-I-EP (CLAS-INDEXL) = 'M'
  4355         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  4356         GO TO 0715-CONT.
  4357
  4358     IF CLAS-I-EP (CLAS-INDEXL) = 'P' OR
  4359        AM-STATE   = 'WY'             OR
  4360        DTE-CLIENT = 'SLC'
  4361          MOVE LF-EPR-PRO TO EARNED-PREMIUM
  4362          GO TO 0715-CONT.
  4363
  4364     IF CLAS-I-EP (CLAS-INDEXL) = 'B'
  4365          MOVE LF-EPR-ST  TO EARNED-PREMIUM
  4366          GO TO 0715-CONT.
  4367
  4368     IF CLAS-I-EP (CLAS-INDEXL) = 'R' OR 'T' OR 'N' OR 'A'
  4369         MOVE LF-EPR-R78 TO EARNED-PREMIUM.
  4370
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  86
* ECS026P.cbl
  4371 0715-CONT.
  4372
  4373     IF CR-ENTRY-STATUS NOT = '9'
  4374         ADD EARNED-PREMIUM     TO  WA-EARNED-PRM.
  4375
  4376     MOVE WORK-AREA-FOR-ACCUMULATOR
  4377                                TO AT-AMOUNTS (A-SUB1  A-SUB2).
  4378
  4379     MOVE ZEROS TO EARNED-PREMIUM.
  4380
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  87
* ECS026P.cbl
  4382 0750-ACCUMULATE-AH.
  4383
  4384     IF CR-AHTYP = ZERO
  4385         GO TO 0799-EXIT.
  4386
  4387     IF DTE-PRC-OPT = 5
  4388         IF CR-AH-POLICY-IS-ACTIVE
  4389              NEXT SENTENCE
  4390            ELSE
  4391              GO TO 0799-EXIT.
  4392
  4393     MOVE CR-AHTYP             TO CLAS-LOOK.
  4394     PERFORM  0960-FIND-AH-TYPE  THRU  0990-EXIT.
  4395
  4396     MOVE CR-AH-TERM           TO ORIG-TERM.
  4397     MOVE RUN-DATE             TO VALUATION-DT.
  4398     PERFORM 8800-REMAINING-TERM-ROUTINE THRU 8899-EXIT.
  4399     MOVE REM-TRM1             TO AH-REM-TRM.
  4400
  4401     IF DTE-PRC-OPT = 5
  4402       IF REM-TRM1 NOT GREATER +0
  4403           MOVE 'E'              TO CR-AH-CURRENT-STATUS
  4404           GO TO 0799-EXIT.
  4405
  4406     MOVE +3                     TO  A-SUB1.
  4407     MOVE AT-AMOUNTS (A-SUB1  A-SUB2)
  4408                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  4409
  4410     IF CR-ENTRY-STATUS = '9'
  4411         GO TO 0755-ADD-AH-EARN.
  4412
  4413     IF CR-ENTRY-STATUS NOT = '5'
  4414         COMPUTE AH-TOTAL-AMT = CR-AHAMT * CR-AH-TERM
  4415         ADD AH-TOTAL-AMT        TO  WA-FACE-BEN
  4416         ADD CR-AHPRM            TO  WA-ISS-PRM.
  4417
  4418     ADD CR-AHRFND               TO  WA-CNC-PRM.
  4419     ADD CR-DISAMT               TO  WA-CLAIM-AMT.
  4420     ADD CR-DISEXP               TO  WA-CLAIM-AMT.
  4421*    if WS-LIFE-SW = SPACES
  4422     add +1                      to wa-cert-count
  4423*    end-if
  4424*    ADD +1                      TO  WA-CERT-COUNT.
  4425     ADD CR-NUM-DIS-CLM          TO  WA-CLAIM-COUNT.
  4426
  4427     IF CR-DISAMT NOT  = ZEROS AND
  4428        CR-AHAMT  NOT  = ZEROS
  4429         COMPUTE PER-DAY-BENEFIT ROUNDED = CR-AHAMT / 30
  4430         COMPUTE NO-DAYS-THIS-CERT ROUNDED = CR-DISAMT
  4431                                             /  PER-DAY-BENEFIT
  4432         ADD +1                 TO  WA-CRT-W-CLM
  4433         ADD NO-DAYS-THIS-CERT  TO  WA-NUMBER-DAYS.
  4434
  4435 0755-ADD-AH-EARN.
  4436
  4437     MOVE ZEROS TO EARNED-PREMIUM AH-EPR-R78
  4438                                  AH-EPR-PRO
  4439                                  AH-EPR-ST
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  88
* ECS026P.cbl
  4440                             SAVE-AH-EPR-R78
  4441                             SAVE-AH-EPR-PRO.
  4442
  4443     PERFORM 8200-EP-BUMP-RTN THRU 8299-EXIT.
  4444     PERFORM 8600-EP-DO-AH    THRU 8699-EXIT.
  4445
  4446     MOVE AH-EPR-R78  TO SAVE-AH-EPR-R78.
  4447     MOVE AH-EPR-PRO  TO SAVE-AH-EPR-PRO.
  4448
  4449     IF (DTE-CLIENT = 'FIA' AND CR-CARRIER = 'A' OR 'B')  OR
  4450        (DTE-CLIENT = 'MLI')
  4451             COMPUTE EARNED-PREMIUM =
  4452                 (AH-EPR-PRO + AH-EPR-R78) / +2
  4453             GO TO 0755-CONT.
  4454
  4455     IF DTE-CLIENT = 'GIC'
  4456         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  4457             COMPUTE EARNED-PREMIUM =
  4458                  (AH-EPR-PRO * +.80) + (AH-EPR-R78 * +.20)
  4459             GO TO 0755-CONT.
  4460
  4461     IF CLAS-I-EP (CLAS-INDEXA) = '1' OR
  4462       (DTE-CLIENT = 'ITY' AND CR-CARRIER = '5' OR '7')
  4463          COMPUTE EARNED-PREMIUM =
  4464               (AH-EPR-PRO * +.6667) + (AH-EPR-R78 * +.3333)
  4465          GO TO 0755-CONT.
  4466
  4467     IF CLAS-I-EP (CLAS-INDEXA) = 'M'
  4468         COMPUTE EARNED-PREMIUM =
  4469             (AH-EPR-PRO + AH-EPR-R78) / +2
  4470         GO TO 0755-CONT.
  4471
  4472     IF CLAS-I-EP (CLAS-INDEXA) = 'P'  OR
  4473        AM-STATE   = 'WY'     OR
  4474        DTE-CLIENT = 'SLC'    OR
  4475       (DTE-CLIENT = 'ITY' AND CR-CARRIER = '2')
  4476          MOVE AH-EPR-PRO TO EARNED-PREMIUM
  4477          GO TO 0755-CONT.
  4478
  4479     IF CLAS-I-EP (CLAS-INDEXA) = 'R'  OR  'A'
  4480          IF (DTE-CLIENT = 'POS' AND CR-CARRIER = '2')  OR
  4481             (DTE-CLIENT = 'FIM')
  4482              COMPUTE EARNED-PREMIUM =
  4483                  (AH-EPR-PRO + AH-EPR-R78) / +2
  4484            ELSE
  4485              MOVE AH-EPR-R78 TO EARNED-PREMIUM.
  4486
  4487 0755-CONT.
  4488
  4489     IF CR-ENTRY-STATUS NOT = '9'
  4490         ADD EARNED-PREMIUM     TO  WA-EARNED-PRM.
  4491
  4492     MOVE WORK-AREA-FOR-ACCUMULATOR
  4493                          TO AT-AMOUNTS (A-SUB1  A-SUB2).
  4494
  4495     MOVE ZEROS TO EARNED-PREMIUM.
  4496
  4497 0799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  89
* ECS026P.cbl
  4498     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  90
* ECS026P.cbl
  4500 0800-DATE-CONVERT-ROUTINE.
  4501     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  4502
  4503 0899-EXIT.
  4504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  91
* ECS026P.cbl
  4506 0900-FIND-LIFE-TYPE.
  4507     IF CLAS-I-BEN (CLAS-INDEXL)  = CLAS-LOOK
  4508         GO TO 0950-EXIT.
  4509
  4510     MOVE  CLAS-STARTL           TO  CLAS-INDEXL.
  4511
  4512 0910-FIND-LIFE-LOOP.
  4513     IF CLAS-INDEXL  GREATER CLAS-MAXL
  4514         GO TO 0940-FIND-LIFE-ABEND.
  4515
  4516     IF CLAS-I-BEN (CLAS-INDEXL) = CLAS-LOOK
  4517         GO TO 0950-EXIT.
  4518
  4519     ADD +1                     TO  CLAS-INDEXL.
  4520
  4521     GO TO 0910-FIND-LIFE-LOOP.
  4522
  4523 0940-FIND-LIFE-ABEND.
  4524     MOVE '0401'                 TO  WS-RETURN-CODE.
  4525     MOVE 'INVALID BENEFIT TYPE' TO  WS-ABEND-MESSAGE.
  4526
  4527     GO TO ABEND-PGM.
  4528
  4529 0950-EXIT.
  4530     EXIT.
  4531
  4532 0960-FIND-AH-TYPE.
  4533     IF CLAS-I-BEN (CLAS-INDEXA)  = CLAS-LOOK
  4534         GO TO 0990-EXIT.
  4535
  4536     MOVE  CLAS-STARTA           TO  CLAS-INDEXA.
  4537
  4538 0970-FIND-AH-LOOP.
  4539     IF CLAS-INDEXA  GREATER CLAS-MAXA
  4540         GO TO 0980-FIND-AH-ABEND.
  4541
  4542     IF CLAS-I-BEN (CLAS-INDEXA) = CLAS-LOOK
  4543         GO TO 0990-EXIT.
  4544
  4545     ADD +1                     TO  CLAS-INDEXA.
  4546
  4547     GO TO 0970-FIND-AH-LOOP.
  4548
  4549 0980-FIND-AH-ABEND.
  4550     MOVE '0401'                 TO  WS-RETURN-CODE.
  4551     MOVE 'INVALID BENEFIT TYPE' TO  WS-ABEND-MESSAGE.
  4552
  4553     GO TO ABEND-PGM.
  4554
  4555 0990-EXIT.
  4556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  92
* ECS026P.cbl
  4558 1000-CREATE-EXTRACTS.
  4559     IF NO-BIZ
  4560         GO TO 1099-EXIT.
  4561
  4562     MOVE SPACES                 TO  SORT-WORK-REC.
  4563     MOVE 'A'                    TO  SWR-REC-TYPE.
  4564     MOVE AM-CARRIER             TO  SWR-CARR.
  4565     MOVE AM-GROUPING            TO  SWR-GROUP.
  4566     MOVE AM-STATE               TO  SWR-STATE.
  4567     MOVE AM-ACCOUNT             TO  SWR-ACCOUNT.
  4568     MOVE AM-NAME                TO  SWR-ACCT-NAME.
  4569     MOVE AM-REPORT-CODE-1       TO  SWR-REPORT-CODE-1.
  4570     MOVE AM-REPORT-CODE-2       TO  SWR-REPORT-CODE-2.
  4571     MOVE ACCUMULATOR-TABLE      TO  SWR-TABLE.
  4572
  4573     IF DTE-TOT-OPT = 3 OR 4
  4574         MOVE SPACES TO SWR-ACCOUNT  SWR-ACCT-NAME.
  4575
  4576     IF AM-REPORT-CODE-1 NOT = SPACES
  4577         MOVE 'Y' TO WS-PRINT-RPT-B.
  4578
  4579     IF AM-REPORT-CODE-2 NOT = SPACES
  4580         MOVE 'Y' TO WS-PRINT-RPT-C.
  4581
  4582     WRITE TEMP-WORK-REC FROM SORT-WORK-REC.
  4583
  4584 1099-EXIT.
  4585     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  93
* ECS026P.cbl
  4587 2000-REINSURE-ROUTINE.
  4588
  4589     IF DTE-PRC-OPT = 5
  4590         IF NOT CR-LF-POLICY-IS-ACTIVE
  4591             MOVE ZEROS          TO CR-LFTYP.
  4592     IF DTE-PRC-OPT = 5
  4593         IF NOT CR-AH-POLICY-IS-ACTIVE
  4594             MOVE ZEROS          TO CR-AHTYP.
  4595
  4596     IF CR-LFTYP = ZEROS  AND
  4597        CR-AHTYP = ZEROS
  4598         GO TO 2099-EXIT.
  4599
  4600     MOVE SPACES                 TO  REIN-LEVELS-END.
  4601
  4602     PERFORM CLEAR-REIN-HOLD THRU CLEAR-REIN-HOLD-X.
  4603
  4604     MOVE DTE-CLASIC-COMPANY-CD  TO  REIN-SRCH-COMP-CD.
  4605     MOVE 'A'                    TO  REIN-SRCH-CODE.
  4606     MOVE CR-REIN-TABLE          TO  REIN-SRCH SWR2-REINS-TABLE.
  4607
  4608     IF REIN-SRCH NOT = SAVE-REIN-SRCH
  4609         MOVE REIN-SRCH          TO  SAVE-REIN-SRCH
  4610         MOVE REIN-SEARCH        TO  RE-CONTROL-PRIMARY
  4611         READ ERRTBL-in
  4612             IF ERRTBL-FILE-STATUS = '23'
  4613                 DISPLAY 'INVALID REINSURANCE TABLE CODE - '
  4614                           REIN-SRCH ' ' CR-FULL-CONTROL
  4615                 MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS
  4616                 GO TO ABEND-PGM
  4617             ELSE
  4618                 IF ERRTBL-FILE-STATUS NOT = '00'
  4619                     MOVE 'ERROR OCCURED READ - ERRTBL'
  4620                                         TO WS-ABEND-MESSAGE
  4621                     MOVE ERRTBL-FILE-STATUS
  4622                                         TO WS-ABEND-FILE-STATUS
  4623                     GO TO ABEND-PGM.
  4624
  4625
  4626     IF RE-REMAINING (1) NOT = 'I'
  4627         GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4628
  4629     MOVE SPACE                        TO REIN-CANCEL-LF-SW
  4630                                          REIN-CANCEL-AH-SW.
  4631     MOVE ZEROS                        TO REIN-EARN-LF-TERM
  4632                                          REIN-LCNC-EARN-TERM
  4633                                          REIN-LF-CLM-MONTHS
  4634                                          REIN-EARN-AH-TERM
  4635                                          REIN-ACNC-EARN-TERM
  4636                                          REIN-AH-PRIOR-CLMS-PAID
  4637                                          REIN-AH-CLM-MONTHS
  4638                                          REIN-AH-CLM-MTH-1
  4639                                          REIN-AH-CLM-MTH-2
  4640                                          REIN-AH-CLM-MTH-3
  4641                                          REIN-AH-CLM-MTH-4
  4642                                          REIN-AH-CLM-MTH-5.
  4643
  4644     MOVE CR-DT                        TO DC-GREG-DATE-CYMD.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  94
* ECS026P.cbl
  4645     MOVE 'L'                          TO DC-OPTION-CODE.
  4646     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4647     MOVE DC-BIN-DATE-1                TO WS-CR-BIN-DATE.
  4648
  4649     IF CR-LFTYP = ZEROS  OR  SPACES
  4650         GO TO 2003-CONTINUE.
  4651
  4652     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
  4653     MOVE BIN-EOM-DT                   TO BIN-VALUATION-DT.
  4654
  4655     IF CR-LF-CANCEL-EXIT-DATE NOT = ZEROS
  4656       IF CR-LF-CANCEL-EXIT-DATE  LESS THAN VALUATION-DT
  4657           MOVE CR-LF-CANCEL-EXIT-DATE TO VALUATION-DT.
  4658
  4659     IF CR-LF-CLAIM-EXIT-DATE NOT = ZEROS
  4660       IF CR-LF-CLAIM-EXIT-DATE  LESS THAN VALUATION-DT
  4661           MOVE CR-LF-CLAIM-EXIT-DATE  TO VALUATION-DT.
  4662
  4663     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
  4664     PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT.
  4665     IF DC-ELAPSED-MONTHS GREATER THAN CR-LF-TERM
  4666         MOVE CR-LF-TERM               TO REIN-EARN-LF-TERM
  4667     ELSE
  4668         MOVE DC-ELAPSED-MONTHS        TO REIN-EARN-LF-TERM.
  4669
  4670     IF CR-LF-CANC-DT NOT = ZEROS
  4671         MOVE CR-LF-CANC-DT            TO DC-GREG-DATE-CYMD
  4672         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4673         MOVE DC-ELAPSED-MONTHS        TO REIN-LCNC-EARN-TERM
  4674         IF CR-DT = CR-LF-CANC-DT
  4675             MOVE '*'                  TO REIN-CANCEL-LF-SW.
  4676
  4677     IF CR-DTH-DT NOT = ZEROS
  4678         MOVE CR-DTH-DT                TO DC-GREG-DATE-CYMD
  4679         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4680         MOVE DC-ELAPSED-MONTHS        TO REIN-LF-CLM-MONTHS.
  4681
  4682
  4683 2003-CONTINUE.
  4684
  4685     IF CR-AHTYP = ZEROS  OR  SPACES
  4686        GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4687
  4688     MOVE EOM-RUN-DATE                 TO VALUATION-DT.
  4689     MOVE BIN-EOM-DT                   TO BIN-VALUATION-DT.
  4690
  4691     IF CR-AH-CANCEL-EXIT-DATE NOT = ZEROS
  4692       IF CR-AH-CANCEL-EXIT-DATE  LESS THAN VALUATION-DT
  4693           MOVE CR-AH-CANCEL-EXIT-DATE TO VALUATION-DT.
  4694
  4695     IF CR-AH-SETTLEMENT-EXIT-DATE NOT = ZEROS
  4696       IF CR-AH-SETTLEMENT-EXIT-DATE  LESS THAN VALUATION-DT
  4697           MOVE CR-AH-SETTLEMENT-EXIT-DATE TO VALUATION-DT.
  4698
  4699     MOVE VALUATION-DT                 TO DC-GREG-DATE-CYMD.
  4700     PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT.
  4701     IF DC-ELAPSED-MONTHS GREATER THAN CR-AH-TERM
  4702         MOVE CR-AH-TERM               TO REIN-EARN-AH-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  95
* ECS026P.cbl
  4703     ELSE
  4704         MOVE DC-ELAPSED-MONTHS        TO REIN-EARN-AH-TERM.
  4705
  4706     IF CR-AH-CANC-DT NOT = ZEROS
  4707         MOVE CR-AH-CANC-DT            TO DC-GREG-DATE-CYMD
  4708         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4709         MOVE DC-ELAPSED-MONTHS        TO REIN-ACNC-EARN-TERM
  4710         IF CR-DT = CR-AH-CANC-DT
  4711             MOVE '*'                  TO REIN-CANCEL-AH-SW.
  4712
  4713     IF CR-DIS-INCUR-DT (1) NOT = ZEROS
  4714         MOVE CR-DIS-INCUR-DT(1)       TO DC-GREG-DATE-CYMD
  4715         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4716         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-1.
  4717
  4718     IF CR-DIS-INCUR-DT (2) NOT = ZEROS
  4719         MOVE CR-DIS-INCUR-DT (2)      TO DC-GREG-DATE-CYMD
  4720         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4721         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-2.
  4722
  4723     IF CR-DIS-INCUR-DT (3) NOT = ZEROS
  4724         MOVE CR-DIS-INCUR-DT (3)      TO DC-GREG-DATE-CYMD
  4725         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4726         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-3.
  4727
  4728     IF CR-DIS-INCUR-DT (4) NOT = ZEROS
  4729         MOVE CR-DIS-INCUR-DT (4)      TO DC-GREG-DATE-CYMD
  4730         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4731         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-4.
  4732
  4733     IF CR-DIS-INCUR-DT (5) NOT = ZEROS
  4734         MOVE CR-DIS-INCUR-DT (5)      TO DC-GREG-DATE-CYMD
  4735         PERFORM 2009-CALC-ELAPSED-MONTHS THRU 2009-CALC-EXIT
  4736         MOVE DC-ELAPSED-MONTHS        TO REIN-AH-CLM-MTH-5.
  4737
  4738
  4739     GO TO 2010-REINSURE-ROUTINE-GET-CALC.
  4740
  4741
  4742 2009-CALC-ELAPSED-MONTHS.
  4743
  4744     MOVE 'L'                          TO DC-OPTION-CODE.
  4745     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4746     MOVE DC-BIN-DATE-1                TO DC-BIN-DATE-2.
  4747     MOVE WS-CR-BIN-DATE               TO DC-BIN-DATE-1.
  4748     MOVE '1'                          TO DC-OPTION-CODE.
  4749     MOVE ' '                          TO DC-CENTURY-ADJUSTMENT.
  4750     MOVE ZEROS                        TO DC-ELAPSED-MONTHS
  4751                                          DC-ODD-DAYS-OVER
  4752                                          DC-ELAPSED-DAYS.
  4753     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  4754
  4755 2009-CALC-EXIT.
  4756     EXIT.
  4757
  4758
  4759 2010-REINSURE-ROUTINE-GET-CALC.
* 4760                             COPY ECSRTPFM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  96
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  4761******************************************************************07/10/97
  4762*                                                                *ECSRTPFM
  4763*                            ECSRTPFM                            *   LV001
  4764*                            VMOD=2.002                          *ECSRTPFM
  4765*                                                                *ECSRTPFM
  4766******************************************************************ECSRTPFM
  4767                                                                  ECSRTPFM
  4768     IF    CR-LFAMT  NUMERIC                                      00000072
  4769           NEXT SENTENCE                                          00000073
  4770        ELSE                                                      00000074
  4771           MOVE ZEROS TO CR-LFAMT.                                00000075
  4772                                                                  00000076
  4773     IF    CR-LFAMT-ALT  NUMERIC                                  00000077
  4774           NEXT SENTENCE                                          00000078
  4775        ELSE                                                      00000079
  4776           MOVE ZEROS TO CR-LFAMT-ALT.                            00000080
  4777                                                                  00000081
  4778                                                                  00000082
  4779     IF    CR-LFPRM  NUMERIC                                      00000083
  4780           NEXT SENTENCE                                          00000084
  4781        ELSE                                                      00000085
  4782           MOVE ZEROS TO CR-LFPRM.                                00000086
  4783                                                                  00000087
  4784     IF    CR-LFPRM-ALT  NUMERIC                                  00000088
  4785           NEXT SENTENCE                                          00000089
  4786        ELSE                                                      00000090
  4787           MOVE ZEROS TO CR-LFPRM-ALT.                            00000091
  4788                                                                  00000092
  4789                                                                  00000093
  4790     IF    CR-LFPRM-CALC  NUMERIC                                 00000094
  4791           NEXT SENTENCE                                          00000095
  4792        ELSE                                                      00000096
  4793           MOVE ZEROS TO CR-LFPRM-CALC.                           00000097
  4794                                                                  00000098
  4795     IF    CR-LFPRM-CALC-ALT  NUMERIC                             00000099
  4796           NEXT SENTENCE                                          00000100
  4797        ELSE                                                      00000101
  4798           MOVE ZEROS TO CR-LFPRM-CALC-ALT.                       00000102
  4799                                                                  00000103
  4800     IF    CR-LF-NSP-PRM  NUMERIC                                 00000104
  4801           NEXT SENTENCE                                          00000105
  4802        ELSE                                                      00000106
  4803           MOVE ZEROS TO CR-LF-NSP-PRM.                           00000107
  4804                                                                  00000108
  4805     COMPUTE RS-R-LB = CR-LFAMT + CR-LFAMT-ALT.                   ECSRTPFM
  4806     COMPUTE RS-R-LP = CR-LFPRM + CR-LFPRM-ALT.                   ECSRTPFM
  4807     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRTPFM
  4808         COMPUTE RS-R-LPC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT     ECSRTPFM
  4809     ELSE                                                         ECSRTPFM
  4810         MOVE CR-LF-NSP-PRM         TO RS-R-LPC.                  ECSRTPFM
  4811     MOVE RS-R-LPC                  TO REIN-CALCED-LIFE.          ECSRTPFM
  4812                                                                  ECSRTPFM
  4813     MOVE CR-AHAMT                  TO RS-R-AB.                   ECSRTPFM
  4814     MOVE CR-AHPRM                  TO RS-R-AP.                   ECSRTPFM
  4815     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRTPFM
  4816         MOVE CR-AHPRM-CALC         TO RS-R-APC                   ECSRTPFM
  4817     ELSE                                                         ECSRTPFM
  4818         MOVE CR-AH-NSP-PRM         TO RS-R-APC.                  ECSRTPFM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  97
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRTPFM)
  4819     MOVE RS-R-APC                  TO REIN-CALCED-AH.            ECSRTPFM
  4820                                                                  ECSRTPFM
  4821     PERFORM REINSURE-CALC THRU REINSURE-CALC-X                   ECSRTPFM
  4822         VARYING SUB1 FROM +1 BY +1                               ECSRTPFM
  4823             UNTIL RE-REI-COMP-NO (SUB1) = SPACES.                ECSRTPFM
  4824                                                                  ECSRTPFM
  4825
  4826 2020-REINSURE-ROUTINE-SKIP-1.
  4827     MOVE +1 TO SUB1.
  4828
  4829 2030-REINSURE-ROUTINE-BLD-WORK.
  4830     IF REIN-COMP (SUB1) = SPACES
  4831         GO TO 2099-EXIT.
  4832
  4833     IF REIN-REM-SW (SUB1) = 'Z'
  4834         ADD +1 TO SUB1
  4835         GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4836
  4837     IF REIN-LF-AH-FLGS (SUB1) = SPACES
  4838         ADD +1 TO SUB1
  4839         GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4840
  4841     IF CR-LFRFND = ZEROS  AND
  4842        CR-AHRFND = ZEROS
  4843         NEXT SENTENCE
  4844     ELSE
  4845         PERFORM REINSURE-CALC-CANCEL THRU REINSURE-CALC-CANCEL-X.
  4846
  4847     MOVE CR-DTHAMT TO RW-LFCLMWK.
  4848     ADD  CR-DTHEXP TO RW-LFCLMWK.
  4849     MOVE CR-DISAMT TO RW-AHCLMWK.
  4850     ADD  CR-DISEXP TO RW-AHCLMWK.
  4851
  4852     IF RW-LFCLMWK = ZEROS  AND
  4853        RW-AHCLMWK = ZEROS
  4854         NEXT SENTENCE
  4855     ELSE
  4856         PERFORM REINSURE-CALC-CLAIM  THRU REINSURE-CALC-CLAIM-X.
  4857
  4858     MOVE REIN-COMP (SUB1)       TO  SWR2-REIN-COMP.
  4859     MOVE REIN-WORK-FLDS (SUB1)  TO  RWF-FIELDS.
  4860     MOVE CR-CARRIER             TO  SWR2-CARR.
  4861     MOVE CR-DT                  TO  SWR2-DT.
  4862     MOVE CR-AGE                 TO  SWR2-AGE.
  4863     MOVE CR-ENTRY-STATUS        TO  SWR2-ENTRY-STATUS.
  4864     MOVE CR-LF-CURRENT-STATUS   TO  SWR2-LF-CURRENT-STATUS.
  4865     MOVE CR-AH-CURRENT-STATUS   TO  SWR2-AH-CURRENT-STATUS.
  4866
  4867     IF CR-ENTRY-STATUS = '5'
  4868         MOVE ZEROS              TO RWF-LFAMT    RWF-AHAMT
  4869                                    RWF-LFPRM    RWF-AHPRM.
  4870
  4871     MOVE ZEROS    TO SWR2-LFTYP SWR2-LF-TERM SWR2-LF-REM-TRM
  4872                      SWR2-LFAMT SWR2-LFPRM   SWR2-LFRFND
  4873                      SWR2-NUM-DTH-CLM        SWR2-DTHAMT
  4874                      SWR2-LF-EPR-78          SWR2-LF-EPR-PR
  4875                      SWR2-AHTYP SWR2-AH-TERM SWR2-AH-REM-TRM
  4876                      SWR2-AHAMT SWR2-AHPRM   SWR2-AHRFND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  98
* ECS026P.cbl
  4877                      SWR2-NUM-DIS-CLM        SWR2-DISAMT
  4878                      SWR2-AH-EPR-78          SWR2-AH-EPR-PR.
  4879
  4880     IF REIN-LF-FLG (SUB1) = 'X'  AND
  4881        CR-LFTYP NOT = ZERO
  4882         MOVE CR-LFTYP           TO  SWR2-LFTYP
  4883         MOVE CR-LF-TERM         TO  SWR2-LF-TERM
  4884         MOVE LF-REM-TRM         TO  SWR2-LF-REM-TRM
  4885         MOVE RWF-LFAMT          TO  SWR2-LFAMT
  4886         MOVE RWF-LFPRM          TO  SWR2-LFPRM
  4887         MOVE RWF-LFRFND         TO  SWR2-LFRFND
  4888         MOVE CR-NUM-DTH-CLM     TO  SWR2-NUM-DTH-CLM
  4889         MOVE RWF-LFCLM          TO  SWR2-DTHAMT
  4890         IF REIN-REM-SW (SUB1) = 'I'
  4891             COMPUTE SWR2-LF-EPR-78 = RWF-LFPRM - RWF-LFRFND
  4892             MOVE SWR2-LF-EPR-78 TO  SWR2-LF-EPR-PR
  4893         ELSE
  4894             IF CR-LFPRM NOT = ZEROS
  4895                 COMPUTE SWR2-LF-EPR-78 =
  4896                        (RWF-LFPRM * SAVE-LF-EPR-R78) / CR-LFPRM
  4897                 COMPUTE SWR2-LF-EPR-PR =
  4898                        (RWF-LFPRM * SAVE-LF-EPR-PRO) / CR-LFPRM.
  4899
  4900     IF REIN-AH-FLG (SUB1) = 'X'  AND
  4901        CR-AHTYP NOT = ZERO
  4902         MOVE CR-AHTYP           TO  SWR2-AHTYP
  4903         MOVE CR-AH-TERM         TO  SWR2-AH-TERM
  4904         MOVE AH-REM-TRM         TO  SWR2-AH-REM-TRM
  4905         MOVE RWF-AHAMT          TO  SWR2-AHAMT
  4906         MOVE RWF-AHPRM          TO  SWR2-AHPRM
  4907         MOVE RWF-AHRFND         TO  SWR2-AHRFND
  4908         MOVE CR-NUM-DIS-CLM     TO  SWR2-NUM-DIS-CLM
  4909         MOVE RWF-AHCLM          TO  SWR2-DISAMT
  4910         IF REIN-REM-SW (SUB1) = 'I'
  4911             COMPUTE SWR2-AH-EPR-78 = RWF-AHPRM - RWF-AHRFND
  4912             MOVE SWR2-AH-EPR-78 TO  SWR2-AH-EPR-PR
  4913         ELSE
  4914             IF CR-AHPRM NOT = ZEROS
  4915                 COMPUTE SWR2-AH-EPR-78 =
  4916                        (RWF-AHPRM * SAVE-AH-EPR-R78) / CR-AHPRM
  4917                 COMPUTE SWR2-AH-EPR-PR =
  4918                        (RWF-AHPRM * SAVE-AH-EPR-PRO) / CR-AHPRM.
  4919
  4920
  4921     WRITE REIN-WORK-REC  FROM  SORT-WORK-REC-2.
  4922
  4923     ADD +1 TO SUB1.
  4924
  4925     GO TO 2030-REINSURE-ROUTINE-BLD-WORK.
  4926
  4927 2099-EXIT.
  4928     EXIT.
  4929
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  99
* ECS026P.cbl
  4931 2900-REINSURANCE-ROUTINES.
* 4932                             COPY ECSRIRTN.
  4933******************************************************************04/30/98
  4934*                                                                *ECSRIRTN
  4935*                            ECSRIRTN                            *   LV012
  4936*                            VMOD=2.025.                         *ECSRIRTN
  4937*                                                                *ECSRIRTN
  4938******************************************************************ECSRIRTN
  4939******************************************************************
  4940*                   C H A N G E   L O G
  4941*
  4942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4943*-----------------------------------------------------------------
  4944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4945* EFFECTIVE    NUMBER
  4946*-----------------------------------------------------------------
  4947* 062703                   PEMA  ADD DCC CLIENT ID TO
  4948*                                SPECIAL CEDED CLAIM CALC
  4949* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4950* 052114  CR2014051900001  PEMA  ADD ROUNDING TO PREM TAX CALC
  4951                                                                  ECSRIRTN
  4952 REINSURE-CALC.                                                   ECSRIRTN
  4953                                                                  ECSRIRTN
  4954     MOVE RE-REI-COMP-NO (SUB1) TO REIN-COMP (SUB1).              ECSRIRTN
  4955     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  4956     MOVE RE-COMP-INFO (SUB1)   TO WT-COMP-INFO.                  ECSRIRTN
  4957     MOVE WT-REMAINING          TO RWF-REM-SW                     ECSRIRTN
  4958                                   REIN-REM-SW (SUB1).            ECSRIRTN
  4959                                                                  ECSRIRTN
  4960     MOVE ZEROS                 TO RWF-EP-STOP-DATE               ECSRIRTN
  4961                                   WS-RWF-EP-STOP-DATE-N             CL*12
  4962                                   REIN-EP-STOP-DATE (SUB1).      ECSRIRTN
  4963                                                                  ECSRIRTN
  4964     MOVE 'Y'                   TO RWF-LF-RUNOFF-SW               ECSRIRTN
  4965                                   REIN-LF-RUNOFF-SW (SUB1)       ECSRIRTN
  4966                                   RWF-AH-RUNOFF-SW               ECSRIRTN
  4967                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  4968                                                                  ECSRIRTN
  4969     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  4970        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  4971          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  4972          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  4973          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  4974                                                                  ECSRIRTN
  4975     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  4976        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  4977         GO TO CALC-CONTINUED.                                    ECSRIRTN
  4978                                                                  ECSRIRTN
  4979     MOVE RCT-EARNING-STOP-DT (CO-SUB) TO RWF-EP-STOP-DATE        ECSRIRTN
  4980                                          WS-RWF-EP-STOP-DATE-N      CL*12
  4981                                          REIN-EP-STOP-DATE (SUB1)ECSRIRTN
  4982                                                                  ECSRIRTN
  4983     IF RWF-EP-STOP-DATE = ZEROS                                  ECSRIRTN
  4984         GO TO CALC-CONTINUED.                                    ECSRIRTN
  4985                                                                  ECSRIRTN
  4986     IF RCT-EARN-STOP-CODE (CO-SUB) = 'L'  OR  'B'                ECSRIRTN
  4987         MOVE 'N'               TO RWF-LF-RUNOFF-SW               ECSRIRTN
  4988                                   REIN-LF-RUNOFF-SW (SUB1).      ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 100
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  4989                                                                  ECSRIRTN
  4990     IF RCT-EARN-STOP-CODE (CO-SUB) = 'A'  OR  'B'                ECSRIRTN
  4991         MOVE 'N'               TO RWF-AH-RUNOFF-SW               ECSRIRTN
  4992                                   REIN-AH-RUNOFF-SW (SUB1).      ECSRIRTN
  4993                                                                  ECSRIRTN
  4994 CALC-CONTINUED.                                                  ECSRIRTN
  4995                                                                  ECSRIRTN
  4996     COMPUTE RS-LIFE-BEN  = CR-LFAMT + CR-LFAMT-ALT.              ECSRIRTN
  4997     COMPUTE RS-LIFE-PREM = CR-LFPRM + CR-LFPRM-ALT.              ECSRIRTN
  4998                                                                  ECSRIRTN
  4999     IF RE-NSP-ST-CD-LF = ZEROS  OR  SPACES                       ECSRIRTN
  5000         COMPUTE RS-LP-CALC = CR-LFPRM-CALC + CR-LFPRM-CALC-ALT   ECSRIRTN
  5001     ELSE                                                         ECSRIRTN
  5002         MOVE CR-LF-NSP-PRM         TO RS-LP-CALC.                ECSRIRTN
  5003     MOVE RS-LP-CALC                TO REIN-CALCED-LIFE.          ECSRIRTN
  5004                                                                  ECSRIRTN
  5005     MOVE CR-AHAMT                  TO RS-AH-BEN.                 ECSRIRTN
  5006     MOVE CR-AHPRM                  TO RS-AH-PREM.                ECSRIRTN
  5007     IF RE-NSP-ST-CD-AH = ZEROS  OR  SPACES                       ECSRIRTN
  5008         MOVE CR-AHPRM-CALC         TO RS-AP-CALC                 ECSRIRTN
  5009     ELSE                                                         ECSRIRTN
  5010         MOVE CR-AH-NSP-PRM         TO RS-AP-CALC.                ECSRIRTN
  5011     MOVE RS-AP-CALC                TO REIN-CALCED-AH.            ECSRIRTN
  5012                                                                  ECSRIRTN
  5013     IF WT-REMAINING = 'Y' OR 'Z' OR 'L' OR 'R'                   ECSRIRTN
  5014         MOVE RS-R-LB               TO RS-LIFE-BEN                ECSRIRTN
  5015         MOVE RS-R-LP               TO RS-LIFE-PREM               ECSRIRTN
  5016         MOVE RS-R-LPC              TO RS-LP-CALC                 ECSRIRTN
  5017         MOVE RS-R-AB               TO RS-AH-BEN                  ECSRIRTN
  5018         MOVE RS-R-AP               TO RS-AH-PREM                 ECSRIRTN
  5019         MOVE RS-R-APC              TO RS-AP-CALC.                ECSRIRTN
  5020                                                                  ECSRIRTN
  5021     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5022         GO TO REINSURE-CALC-REMAINDER.                           ECSRIRTN
  5023                                                                  ECSRIRTN
  5024     IF CR-DT LESS WT-LO-DATE                                        CL**2
  5025         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  5026                                                                  ECSRIRTN
  5027     IF CR-DT NOT LESS WT-HI-DATE                                    CL**2
  5028         GO TO REINSURE-CALC-X.                                   ECSRIRTN
  5029                                                                  ECSRIRTN
  5030     PERFORM REINSURE-CK-LIFE      THRU REINSURE-CK-LIFE-X.       ECSRIRTN
  5031     PERFORM REINSURE-CK-AH        THRU REINSURE-CK-AH-X.         ECSRIRTN
  5032                                                                  ECSRIRTN
  5033     IF WT-INTERACTIVE = 'E'                                      ECSRIRTN
  5034         PERFORM REIN-CHECK-INTERACT-E THRU REIN-INTERACT-CHECK-X.ECSRIRTN
  5035                                                                  ECSRIRTN
  5036     IF WT-INTERACTIVE = 'X'                                      ECSRIRTN
  5037       IF  (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  5038        OR (REIN-LF-FLG (SUB1) = 'X' AND REIN-AH-FLG (SUB1) = ' ')ECSRIRTN
  5039        OR (REIN-LF-FLG (SUB1) = ' ' AND REIN-AH-FLG (SUB1) = 'X')ECSRIRTN
  5040           NEXT SENTENCE                                          ECSRIRTN
  5041       ELSE                                                       ECSRIRTN
  5042           MOVE 'Y' TO REIN-LF-FLG (SUB1)                         ECSRIRTN
  5043                       REIN-AH-FLG (SUB1).                        ECSRIRTN
  5044                                                                  ECSRIRTN
  5045     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  5046         IF REIN-LF-FLG (SUB1) = 'X' AND                          ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 101
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5047            REIN-AH-FLG (SUB1) = 'Y'                              ECSRIRTN
  5048             MOVE 'X' TO REIN-AH-FLG (SUB1).                      ECSRIRTN
  5049                                                                  ECSRIRTN
  5050     IF WT-INTERACTIVE = 'Y'                                      ECSRIRTN
  5051         IF REIN-AH-FLG (SUB1) = 'X' AND                          ECSRIRTN
  5052            REIN-LF-FLG (SUB1) = 'Y'                              ECSRIRTN
  5053             MOVE 'X' TO REIN-LF-FLG (SUB1).                      ECSRIRTN
  5054                                                                  ECSRIRTN
  5055     IF WT-INTERACTIVE = 'Z'                                      ECSRIRTN
  5056         IF REIN-LF-FLG (SUB1) = 'X'                              ECSRIRTN
  5057             IF REIN-AH-FLG (SUB1) = 'Y'                          ECSRIRTN
  5058                 MOVE 'X' TO REIN-AH-FLG (SUB1)                   ECSRIRTN
  5059             ELSE                                                 ECSRIRTN
  5060                 NEXT SENTENCE                                    ECSRIRTN
  5061         ELSE                                                     ECSRIRTN
  5062             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  5063                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  5064                                                                  ECSRIRTN
  5065     IF WT-INTERACTIVE = 'W'                                      ECSRIRTN
  5066         IF REIN-AH-FLG (SUB1) = 'X'                              ECSRIRTN
  5067             IF REIN-LF-FLG (SUB1) = 'Y'                          ECSRIRTN
  5068                 MOVE 'X' TO REIN-LF-FLG (SUB1)                   ECSRIRTN
  5069             ELSE                                                 ECSRIRTN
  5070                 NEXT SENTENCE                                    ECSRIRTN
  5071         ELSE                                                     ECSRIRTN
  5072             MOVE 'Y' TO REIN-LF-FLG (SUB1)                       ECSRIRTN
  5073                         REIN-AH-FLG (SUB1).                      ECSRIRTN
  5074                                                                  ECSRIRTN
  5075     IF REIN-LF-FLG (SUB1) = 'X'                                  ECSRIRTN
  5076         PERFORM REIN-CALC-LIFE THRU REIN-CALC-LIFE-X.            ECSRIRTN
  5077                                                                  ECSRIRTN
  5078     IF REIN-LF-FLG (SUB1) = 'E'                                  ECSRIRTN
  5079         PERFORM REIN-LF-SKIP-LIMIT THRU REIN-CALC-LIFE-X         ECSRIRTN
  5080         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5081                                                                  ECSRIRTN
  5082     IF REIN-AH-FLG (SUB1) = 'X'                                  ECSRIRTN
  5083         PERFORM REIN-CALC-AH THRU REIN-CALC-AH-X.                ECSRIRTN
  5084                                                                  ECSRIRTN
  5085     IF REIN-AH-FLG (SUB1) = 'E'                                  ECSRIRTN
  5086         PERFORM REIN-AH-SKIP-LIMIT THRU REIN-CALC-AH-X           ECSRIRTN
  5087         MOVE 'X'                TO  REIN-AH-FLG (SUB1).          ECSRIRTN
  5088                                                                  ECSRIRTN
  5089     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5090         MOVE SPACE TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  5091                                                                  ECSRIRTN
  5092     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5093         MOVE SPACE TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  5094                                                                  ECSRIRTN
  5095     GO TO REINSURE-CALC-X.                                       ECSRIRTN
  5096                                                                  ECSRIRTN
  5097 REINSURE-CK-LIFE.                                                ECSRIRTN
  5098                                                                  ECSRIRTN
  5099     IF CR-LFTYP = ZERO                                           ECSRIRTN
  5100         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5101                                                                  ECSRIRTN
  5102     IF WT-LF-PCT = ZERO                                          ECSRIRTN
  5103         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5104                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 102
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5105     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  5106         IF CLAS-I-REIN-YN (CLAS-INDEXL) = 'N'                    ECSRIRTN
  5107             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5108                                                                  ECSRIRTN
  5109     MOVE WT-LF-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  5110                                                                  ECSRIRTN
  5111     IF CEDING-PROPERTY-ONLY                                      ECSRIRTN
  5112         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '2'              ECSRIRTN
  5113             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  5114         ELSE                                                     ECSRIRTN
  5115             NEXT SENTENCE                                        ECSRIRTN
  5116     ELSE                                                         ECSRIRTN
  5117         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '2'                  ECSRIRTN
  5118             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5119                                                                  ECSRIRTN
  5120     IF CEDING-AD-D-ONLY                                          ECSRIRTN
  5121         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = '4'              ECSRIRTN
  5122             GO TO REINSURE-CK-LIFE-X                             ECSRIRTN
  5123         ELSE                                                     ECSRIRTN
  5124             NEXT SENTENCE                                        ECSRIRTN
  5125     ELSE                                                         ECSRIRTN
  5126         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = '4'                  ECSRIRTN
  5127             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5128                                                                  ECSRIRTN
  5129     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  5130         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                  ECSRIRTN
  5131             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5132                                                                  ECSRIRTN
  5133     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  5134         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'B'              ECSRIRTN
  5135            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5136                                                                  ECSRIRTN
  5137     IF CEDING-REDUCING-ONLY                                      ECSRIRTN
  5138         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P'               ECSRIRTN
  5139             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5140                                                                  ECSRIRTN
  5141     IF CEDING-LEVEL-ONLY                                         ECSRIRTN
  5142         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'                      ECSRIRTN
  5143            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5144                                                                  ECSRIRTN
  5145     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  5146         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  5147             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5148                                                                  ECSRIRTN
  5149     IF CEDING-GROUP-RED-LIFE-ONLY                                ECSRIRTN
  5150         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  5151            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P') OR          ECSRIRTN
  5152            (CR-AHTYP NOT = ZERO)                                 ECSRIRTN
  5153             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5154                                                                  ECSRIRTN
  5155     IF CEDING-GROUP-REDUCING-ONLY                                ECSRIRTN
  5156         IF (CR-IND-GRP = '1')  OR                                ECSRIRTN
  5157            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')             ECSRIRTN
  5158             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5159                                                                  ECSRIRTN
  5160     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  5161         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
  5162             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 103
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5163                                                                  ECSRIRTN
  5164     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  5165         IF CLAS-I-JOINT (CLAS-INDEXL) NOT = 'J'                  ECSRIRTN
  5166             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5167                                                                  ECSRIRTN
  5168     IF CEDING-SGL-PREM-REDUCING                                  ECSRIRTN
  5169        IF (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR          ECSRIRTN
  5170           CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'                   ECSRIRTN
  5171            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5172                                                                  ECSRIRTN
  5173     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  5174         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5175            CR-IND-GRP = '1'                                      ECSRIRTN
  5176             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5177                                                                  ECSRIRTN
  5178     IF CEDING-GROUP-LEVEL-ONLY                                   ECSRIRTN
  5179         IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  5180            CR-IND-GRP = '1'                                      ECSRIRTN
  5181             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5182                                                                  ECSRIRTN
  5183     IF CEDING-SGL-PREM-GRP-REDUCING                              ECSRIRTN
  5184         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5185            (CLAS-I-RL-AH (CLAS-INDEXL) = 'L' OR 'P')  OR         ECSRIRTN
  5186            CR-IND-GRP = '1'                                      ECSRIRTN
  5187             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5188                                                                  ECSRIRTN
  5189     IF CEDING-SGL-PREM-GROUP-LEVEL                               ECSRIRTN
  5190         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'  OR              ECSRIRTN
  5191            CLAS-I-RL-AH (CLAS-INDEXL) = 'R'  OR                  ECSRIRTN
  5192            CR-IND-GRP = '1'                                      ECSRIRTN
  5193             GO TO REINSURE-CK-LIFE-X.                            ECSRIRTN
  5194                                                                  ECSRIRTN
  5195     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  5196         IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'                      ECSRIRTN
  5197            GO TO REINSURE-CK-LIFE-X.                             ECSRIRTN
  5198                                                                  ECSRIRTN
  5199     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  5200        MOVE 'Y'                 TO REIN-LF-FLG (SUB1).           ECSRIRTN
  5201                                                                  ECSRIRTN
  5202     IF CR-AGE LESS WT-LFAGE-LO                                   ECSRIRTN
  5203         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5204                                                                  ECSRIRTN
  5205     IF CR-AGE GREATER WT-LFAGE-HI                                ECSRIRTN
  5206         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5207                                                                  ECSRIRTN
  5208     IF CR-LF-TERM  NUMERIC                                       00002331
  5209        NEXT SENTENCE                                             00002332
  5210     ELSE                                                         00002333
  5211        MOVE ZEROS               TO CR-LF-TERM                    00002334
  5212     END-IF
  5213                                                                  00002335
  5214     IF CR-LF-TERM LESS WT-LFTRM-LO                               ECSRIRTN
  5215         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5216                                                                  ECSRIRTN
  5217     IF CR-LF-TERM GREATER WT-LFTRM-HI                            ECSRIRTN
  5218         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5219                                                                  ECSRIRTN
  5220     MOVE 'Y' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 104
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5221                                                                  ECSRIRTN
  5222     IF RS-LIFE-BEN NOT GREATER WT-LF-LIM-LO                      ECSRIRTN
  5223         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5224                                                                  ECSRIRTN
  5225     IF RS-LIFE-BEN GREATER WT-LF-LIM-HI                          ECSRIRTN
  5226         GO TO REINSURE-CK-LIFE-X.                                ECSRIRTN
  5227                                                                  ECSRIRTN
  5228     MOVE 'X' TO REIN-LF-FLG (SUB1).                              ECSRIRTN
  5229                                                                  ECSRIRTN
  5230 REINSURE-CK-LIFE-X.                                              ECSRIRTN
  5231     EXIT.                                                        ECSRIRTN
  5232                                                                  ECSRIRTN
  5233 REINSURE-CK-AH.                                                  ECSRIRTN
  5234                                                                  ECSRIRTN
  5235     IF CR-AHTYP = ZERO                                           ECSRIRTN
  5236         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5237                                                                  ECSRIRTN
  5238     IF WT-AH-PCT = ZERO                                          ECSRIRTN
  5239         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5240                                                                  ECSRIRTN
  5241     IF DTE-CLIENT = 'CSO' OR 'CSI'                               ECSRIRTN
  5242         IF CLAS-I-REIN-YN (CLAS-INDEXA) = 'N'                    ECSRIRTN
  5243             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5244                                                                  ECSRIRTN
  5245     MOVE WT-AH-BEN-CODE                TO REIN-BEN-CODE.         ECSRIRTN
  5246                                                                  ECSRIRTN
  5247     IF CEDING-UNEMPLOYMENT-ONLY                                  ECSRIRTN
  5248         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = '3'              ECSRIRTN
  5249             GO TO REINSURE-CK-AH-X                               ECSRIRTN
  5250         ELSE                                                     ECSRIRTN
  5251             NEXT SENTENCE                                        ECSRIRTN
  5252     ELSE                                                         ECSRIRTN
  5253         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = '3'                  ECSRIRTN
  5254             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5255                                                                  ECSRIRTN
  5256     IF CEDING-SINGLE-PREM-ONLY                                   ECSRIRTN
  5257         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'                  ECSRIRTN
  5258             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5259                                                                  ECSRIRTN
  5260     IF CEDING-JOINT-ONLY                                         ECSRIRTN
  5261         IF CLAS-I-JOINT (CLAS-INDEXA) NOT = 'J'                  ECSRIRTN
  5262             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5263                                                                  ECSRIRTN
  5264     IF CEDING-OUT-BALANCE-ONLY                                   ECSRIRTN
  5265         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'B'              ECSRIRTN
  5266             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5267                                                                  ECSRIRTN
  5268     IF CEDING-GROUP-ONLY                                         ECSRIRTN
  5269         IF CR-IND-GRP NOT = '2'                                  ECSRIRTN
  5270             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5271                                                                  ECSRIRTN
  5272     IF CEDING-SGL-PREM-GROUP                                     ECSRIRTN
  5273         IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'  OR              ECSRIRTN
  5274            CR-IND-GRP = '1'                                      ECSRIRTN
  5275             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5276                                                                  ECSRIRTN
  5277     IF CEDING-INDIVIDUAL-ONLY                                    ECSRIRTN
  5278         IF CR-IND-GRP NOT = '1'                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 105
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5279             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5280                                                                  ECSRIRTN
  5281     IF CEDING-SINGLE-POLICIES-ONLY                               ECSRIRTN
  5282         IF CLAS-I-JOINT (CLAS-INDEXA) = 'J'                      ECSRIRTN
  5283            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  5284                                                                  ECSRIRTN
  5285     IF CEDING-7-DAY-RETRO                                        ECSRIRTN
  5286         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = (' 7R'  AND  '07R')    ECSRIRTN
  5287            GO TO REINSURE-CK-AH-X.                               ECSRIRTN
  5288                                                                  ECSRIRTN
  5289     IF CEDING-14-DAY-RETRO                                       ECSRIRTN
  5290         IF CLAS-I-AB3 (CLAS-INDEXA) NOT = '14R'                  ECSRIRTN
  5291             GO TO REINSURE-CK-AH-X.                              ECSRIRTN
  5292                                                                  ECSRIRTN
  5293     IF DTE-CLIENT EQUAL 'NCL'                                    ECSRIRTN
  5294        MOVE 'Y'                 TO REIN-AH-FLG (SUB1).           ECSRIRTN
  5295                                                                  ECSRIRTN
  5296     IF CR-AGE LESS WT-AHAGE-LO                                   ECSRIRTN
  5297         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5298                                                                  ECSRIRTN
  5299     IF CR-AGE GREATER WT-AHAGE-HI                                ECSRIRTN
  5300         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5301                                                                  ECSRIRTN
  5302     IF CR-AH-TERM  NUMERIC                                       00002331
  5303        NEXT SENTENCE                                             00002332
  5304     ELSE                                                         00002333
  5305        MOVE ZEROS               TO CR-AH-TERM                    00002334
  5306     END-IF
  5307                                                                  00002335
  5308     IF CR-AH-TERM LESS WT-AHTRM-LO                               ECSRIRTN
  5309         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5310                                                                  ECSRIRTN
  5311     IF CR-AH-TERM GREATER WT-AHTRM-HI                            ECSRIRTN
  5312         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5313                                                                  ECSRIRTN
  5314     MOVE 'Y' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  5315                                                                  ECSRIRTN
  5316     IF WT-AHBEN-LIM-LO = ZERO                                    ECSRIRTN
  5317         AND WT-AHBEN-LIM-HI = ZERO                               ECSRIRTN
  5318             MOVE +9999999.99 TO WT-AHBEN-LIM-LO                  ECSRIRTN
  5319                                 WT-AHBEN-LIM-HI.                 ECSRIRTN
  5320                                                                  ECSRIRTN
  5321     IF WT-AHMOA-LIM-LO = ZERO                                    ECSRIRTN
  5322         AND WT-AHMOA-LIM-HI = ZERO                               ECSRIRTN
  5323             MOVE +9999999.99 TO WT-AHMOA-LIM-LO                  ECSRIRTN
  5324                                 WT-AHMOA-LIM-HI.                 ECSRIRTN
  5325                                                                  ECSRIRTN
  5326     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LIM-LO.          ECSRIRTN
  5327     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-LIM-HI.          ECSRIRTN
  5328                                                                  ECSRIRTN
  5329     IF RW-AHLIM-LO GREATER WT-AHBEN-LIM-LO                       ECSRIRTN
  5330         MOVE WT-AHBEN-LIM-LO TO RW-AHLIM-LO.                     ECSRIRTN
  5331                                                                  ECSRIRTN
  5332     IF RW-AHLIM-HI GREATER WT-AHBEN-LIM-HI                       ECSRIRTN
  5333         MOVE WT-AHBEN-LIM-HI TO RW-AHLIM-HI.                     ECSRIRTN
  5334                                                                  ECSRIRTN
  5335     MOVE RW-AHLIM-LO TO RWF-AH-LIMIT.                            ECSRIRTN
  5336                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 106
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5337     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  5338                                                                  ECSRIRTN
  5339     IF RW-AHWRK NOT GREATER RW-AHLIM-LO                          ECSRIRTN
  5340         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5341                                                                  ECSRIRTN
  5342     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5343         GO TO REINSURE-CK-AH-X.                                  ECSRIRTN
  5344                                                                  ECSRIRTN
  5345     MOVE 'X' TO REIN-AH-FLG (SUB1).                              ECSRIRTN
  5346                                                                  ECSRIRTN
  5347 REINSURE-CK-AH-X.                                                ECSRIRTN
  5348     EXIT.                                                        ECSRIRTN
  5349                                                                  ECSRIRTN
  5350 REIN-CHECK-INTERACT-E.                                           ECSRIRTN
  5351                                                                  ECSRIRTN
  5352     IF RS-LIFE-BEN = ZERO  OR                                    ECSRIRTN
  5353        RS-AH-BEN = ZERO                                          ECSRIRTN
  5354         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  5355                                                                  ECSRIRTN
  5356     IF REIN-LF-FLG (SUB1) NOT = 'X'  AND                         ECSRIRTN
  5357        REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5358         GO TO REIN-INTERACT-CHECK-X.                             ECSRIRTN
  5359                                                                  ECSRIRTN
  5360     MOVE 'X'                    TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5361                                    REIN-AH-FLG (SUB1).           ECSRIRTN
  5362                                                                  ECSRIRTN
  5363     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  5364         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  5365             MOVE +9999999.99    TO  WT-AHBEN-LO                  ECSRIRTN
  5366                                     WT-AHBEN-HI.                 ECSRIRTN
  5367     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  5368         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  5369             MOVE +9999999.99    TO  WT-AHMOA-LO                  ECSRIRTN
  5370                                     WT-AHMOA-HI.                 ECSRIRTN
  5371                                                                  ECSRIRTN
  5372     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  5373     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  5374                                                                  ECSRIRTN
  5375     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  5376         MOVE WT-AHBEN-LO        TO  RW-AHLIM-LO.                 ECSRIRTN
  5377                                                                  ECSRIRTN
  5378     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  5379         MOVE WT-AHBEN-HI        TO  RW-AHLIM-HI.                 ECSRIRTN
  5380                                                                  ECSRIRTN
  5381     COMPUTE RW-AHWRK = RS-AH-BEN * CR-AH-TERM.                   ECSRIRTN
  5382                                                                  ECSRIRTN
  5383     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5384         MOVE RW-AHLIM-HI        TO  RW-AHWRK.                    ECSRIRTN
  5385                                                                  ECSRIRTN
  5386     IF RW-AHWRK GREATER RW-AHLIM-LO                              ECSRIRTN
  5387         COMPUTE RATE-WORK-A ROUNDED = (RW-AHWRK - RW-AHLIM-LO)   ECSRIRTN
  5388                                       / RW-AHWRK                 ECSRIRTN
  5389       ELSE                                                       ECSRIRTN
  5390         MOVE ZERO               TO RATE-WORK-A.                  ECSRIRTN
  5391                                                                  ECSRIRTN
  5392     IF RS-LIFE-BEN GREATER WT-LF-LO                              ECSRIRTN
  5393         COMPUTE RATE-WORK-L ROUNDED = (RS-LIFE-BEN - WT-LF-LO)   ECSRIRTN
  5394                                       / RS-LIFE-BEN              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 107
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5395       ELSE                                                       ECSRIRTN
  5396         MOVE ZERO               TO RATE-WORK-L.                  ECSRIRTN
  5397                                                                  ECSRIRTN
  5398     IF (RS-LIFE-BEN GREATER WT-LF-LO) AND                        ECSRIRTN
  5399        (RW-AHWRK NOT GREATER RW-AHLIM-LO)                        ECSRIRTN
  5400          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  5401          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  5402                                      / CR-AH-TERM.               ECSRIRTN
  5403                                                                  ECSRIRTN
  5404     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  5405        (RS-LIFE-BEN NOT GREATER WT-LF-LO)                        ECSRIRTN
  5406          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5407          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  5408               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  5409            ELSE                                                  ECSRIRTN
  5410                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  5411                                                                  ECSRIRTN
  5412     IF (RW-AHWRK GREATER RW-AHLIM-LO) AND                        ECSRIRTN
  5413        (RS-LIFE-BEN GREATER WT-LF-LO)                            ECSRIRTN
  5414        IF RATE-WORK-L GREATER RATE-WORK-A                        ECSRIRTN
  5415          MOVE 'E'               TO REIN-AH-FLG (SUB1)            ECSRIRTN
  5416          COMPUTE RWF-AHAMT ROUNDED = (RW-AHWRK * RATE-WORK-L)    ECSRIRTN
  5417                                      / CR-AH-TERM                ECSRIRTN
  5418         ELSE                                                     ECSRIRTN
  5419          MOVE 'E'               TO REIN-LF-FLG (SUB1)            ECSRIRTN
  5420          IF (RW-AHWRK - RW-AHLIM-LO) NOT GREATER RS-LIFE-BEN     ECSRIRTN
  5421               COMPUTE RWF-LFAMT = RW-AHWRK - RW-AHLIM-LO         ECSRIRTN
  5422            ELSE                                                  ECSRIRTN
  5423                MOVE RS-LIFE-BEN TO RWF-LFAMT.                    ECSRIRTN
  5424                                                                  ECSRIRTN
  5425 REIN-INTERACT-CHECK-X.                                           ECSRIRTN
  5426     EXIT.                                                        ECSRIRTN
  5427                                                                  ECSRIRTN
  5428                                                                  ECSRIRTN
  5429 REIN-CALC-LIFE.                                                  ECSRIRTN
  5430                                                                  ECSRIRTN
  5431     IF RS-LIFE-BEN NOT GREATER WT-LF-HI                          ECSRIRTN
  5432         MOVE RS-LIFE-BEN TO RWF-LFAMT                            ECSRIRTN
  5433     ELSE                                                         ECSRIRTN
  5434         MOVE WT-LF-HI TO RWF-LFAMT.                              ECSRIRTN
  5435                                                                  ECSRIRTN
  5436     IF RS-LIFE-BEN LESS WT-LF-LO                                 ECSRIRTN
  5437         MOVE +0 TO RWF-LFAMT                                     ECSRIRTN
  5438     ELSE                                                         ECSRIRTN
  5439         IF WT-REMAINING NOT = 'L'                                ECSRIRTN
  5440           IF RS-LIFE-BEN LESS THAN ZERO                          ECSRIRTN
  5441               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT * RS-LIFE-BENECSRIRTN
  5442           ELSE                                                   ECSRIRTN
  5443               COMPUTE RWF-LFAMT ROUNDED = WT-LF-PCT *            ECSRIRTN
  5444                                          (RWF-LFAMT - WT-LF-LO). ECSRIRTN
  5445                                                                  ECSRIRTN
  5446 REIN-LF-SKIP-LIMIT.                                              ECSRIRTN
  5447                                                                  ECSRIRTN
  5448     MOVE +0 TO RW-LFPRM  RW-LFPRMC.                              ECSRIRTN
  5449                                                                  ECSRIRTN
  5450     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5451         GO TO REIN-CALC-LF-RISK-PREM.                            ECSRIRTN
  5452                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 108
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5453     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5454         COMPUTE RWF-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT     ECSRIRTN
  5455         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  5456                                                                  ECSRIRTN
  5457     IF RS-LIFE-BEN NOT = ZERO                                    ECSRIRTN
  5458         COMPUTE RW-LFPRM ROUNDED = (RS-LIFE-PREM *               ECSRIRTN
  5459                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  5460         COMPUTE RW-LFPRMC ROUNDED = (RS-LP-CALC *                ECSRIRTN
  5461                   RWF-LFAMT) / RS-LIFE-BEN                       ECSRIRTN
  5462     ELSE                                                         ECSRIRTN
  5463         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  5464             COMPUTE RW-LFPRM ROUNDED = RS-LIFE-PREM * WT-LF-PCT  ECSRIRTN
  5465             COMPUTE RW-LFPRMC ROUNDED = RS-LP-CALC * WT-LF-PCT.  ECSRIRTN
  5466                                                                  ECSRIRTN
  5467     IF ((WT-LF-QC = '1' OR '3') OR                                  CL**8
  5468         (WT-LF-QC = '2' AND                                         CL**8
  5469          PGM-SUB = +50  AND                                         CL**8
  5470          DTE-CLIENT = 'LAP'))                                       CL**8
  5471          MOVE RW-LFPRM TO RWF-LFPRM                                 CL**8
  5472     ELSE                                                         ECSRIRTN
  5473         MOVE RW-LFPRMC TO RWF-LFPRM.                             ECSRIRTN
  5474                                                                  ECSRIRTN
  5475     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  5476         COMPUTE RS-R-LB = RS-R-LB - RWF-LFAMT                    ECSRIRTN
  5477         COMPUTE RS-R-LP = RS-R-LP - RW-LFPRM                     ECSRIRTN
  5478         COMPUTE RS-R-LPC = RS-R-LPC - RW-LFPRMC.                 ECSRIRTN
  5479                                                                  ECSRIRTN
  5480     GO TO REIN-CALC-LIFE-X.                                      ECSRIRTN
  5481                                                                  ECSRIRTN
  5482 REIN-CALC-LF-RISK-PREM.                                          ECSRIRTN
  5483                                                                  ECSRIRTN
  5484     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
  5485         MOVE ZEROS                 TO RWF-LFPRM                  ECSRIRTN
  5486         GO TO REIN-CALC-LIFE-X.                                  ECSRIRTN
  5487                                                                  ECSRIRTN
  5488     MOVE RWF-LFAMT                 TO REIN-RISK-AMOUNT.          ECSRIRTN
  5489     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  5490     MOVE +0                        TO REIN-WORKA                 ECSRIRTN
  5491                                       RW-LFPRM.                  ECSRIRTN
  5492                                                                  ECSRIRTN
  5493 REIN-LF-RISK-PREM-LOOP.                                          ECSRIRTN
  5494                                                                  ECSRIRTN
  5495     COMPUTE RW-LFPRM = RW-LFPRM +                                ECSRIRTN
  5496                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  5497                                                                  ECSRIRTN
  5498     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  5499        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  5500                                                                  ECSRIRTN
  5501     IF REIN-WORKA = REIN-EARN-LF-TERM  OR                        ECSRIRTN
  5502        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5503         MOVE RW-LFPRM              TO RWF-LFPRM                  ECSRIRTN
  5504     ELSE                                                         ECSRIRTN
  5505         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5506         GO TO REIN-LF-RISK-PREM-LOOP.                            ECSRIRTN
  5507                                                                  ECSRIRTN
  5508                                                                  ECSRIRTN
  5509 REIN-CALC-LIFE-X.                                                ECSRIRTN
  5510     EXIT.                                                        ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 109
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5511                                                                  ECSRIRTN
  5512 REIN-CALC-AH.                                                    ECSRIRTN
  5513                                                                  ECSRIRTN
  5514     IF WT-AHBEN-LO = ZERO                                        ECSRIRTN
  5515         AND WT-AHBEN-HI = ZERO                                   ECSRIRTN
  5516             MOVE +9999999.99 TO WT-AHBEN-LO                      ECSRIRTN
  5517                                 WT-AHBEN-HI.                     ECSRIRTN
  5518                                                                  ECSRIRTN
  5519     IF WT-AHMOA-LO = ZERO                                        ECSRIRTN
  5520         AND WT-AHMOA-HI = ZERO                                   ECSRIRTN
  5521             MOVE +9999999.99 TO WT-AHMOA-LO                      ECSRIRTN
  5522                                 WT-AHMOA-HI.                     ECSRIRTN
  5523                                                                  ECSRIRTN
  5524     COMPUTE RW-AHLIM-LO = CR-AH-TERM * WT-AHMOA-LO.              ECSRIRTN
  5525     COMPUTE RW-AHLIM-HI = CR-AH-TERM * WT-AHMOA-HI.              ECSRIRTN
  5526                                                                  ECSRIRTN
  5527     IF RW-AHLIM-LO GREATER WT-AHBEN-LO                           ECSRIRTN
  5528         MOVE WT-AHBEN-LO TO RW-AHLIM-LO.                         ECSRIRTN
  5529                                                                  ECSRIRTN
  5530     IF RW-AHLIM-HI GREATER WT-AHBEN-HI                           ECSRIRTN
  5531         MOVE WT-AHBEN-HI TO RW-AHLIM-HI.                         ECSRIRTN
  5532                                                                  ECSRIRTN
  5533     IF RW-AHWRK GREATER RW-AHLIM-HI                              ECSRIRTN
  5534         MOVE RW-AHLIM-HI TO RW-AHWRK.                            ECSRIRTN
  5535                                                                  ECSRIRTN
  5536     IF RW-AHWRK LESS RW-AHLIM-LO                                 ECSRIRTN
  5537         MOVE +0 TO RWF-AHAMT                                     ECSRIRTN
  5538     ELSE                                                         ECSRIRTN
  5539         IF WT-REMAINING = 'L'                                    ECSRIRTN
  5540             COMPUTE RWF-AHAMT ROUNDED = RW-AHWRK / CR-AH-TERM    ECSRIRTN
  5541         ELSE                                                     ECSRIRTN
  5542             COMPUTE RWF-AHAMT ROUNDED =                          ECSRIRTN
  5543             ((RW-AHWRK - RW-AHLIM-LO) / CR-AH-TERM) * WT-AH-PCT. ECSRIRTN
  5544                                                                  ECSRIRTN
  5545 REIN-AH-SKIP-LIMIT.                                              ECSRIRTN
  5546                                                                  ECSRIRTN
  5547     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5548         GO TO REIN-CALC-AH-RISK-PREM.                            ECSRIRTN
  5549                                                                  ECSRIRTN
  5550     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5551         COMPUTE RWF-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT       ECSRIRTN
  5552         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  5553                                                                  ECSRIRTN
  5554     IF RS-AH-BEN NOT = ZERO                                      ECSRIRTN
  5555         COMPUTE RW-AHPRM ROUNDED = (RS-AH-PREM *                 ECSRIRTN
  5556                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  5557         COMPUTE RW-AHPRMC ROUNDED = (RS-AP-CALC *                ECSRIRTN
  5558                   RWF-AHAMT) / RS-AH-BEN                         ECSRIRTN
  5559     ELSE                                                         ECSRIRTN
  5560         IF RW-AHLIM-LO = ZERO                                    ECSRIRTN
  5561             COMPUTE RW-AHPRM ROUNDED = RS-AH-PREM * WT-AH-PCT    ECSRIRTN
  5562             COMPUTE RW-AHPRMC ROUNDED = RS-AP-CALC * WT-AH-PCT.  ECSRIRTN
  5563                                                                  ECSRIRTN
  5564     IF ((WT-AH-QC = '1' OR '3') OR                                  CL**8
  5565         (WT-AH-QC = '2' AND                                         CL**8
  5566          PGM-SUB = +50  AND                                         CL**8
  5567          DTE-CLIENT = 'LAP'))                                       CL**8
  5568         MOVE RW-AHPRM TO RWF-AHPRM                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 110
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5569     ELSE                                                         ECSRIRTN
  5570         MOVE RW-AHPRMC TO RWF-AHPRM.                             ECSRIRTN
  5571                                                                  ECSRIRTN
  5572     IF RE-NSP-ST-CD-AH = SPACES OR ZERO                          ECSRIRTN
  5573         IF (WT-REMAINING = 'Y' OR 'Z') AND (WT-AH-QC = '1')      ECSRIRTN
  5574            AND (RWF-AHAMT = RS-R-AB) AND (RWF-AHAMT NOT = +0)    ECSRIRTN
  5575                MOVE 'Y' TO RWF-REM-AH-100.                       ECSRIRTN
  5576                                                                  ECSRIRTN
  5577     IF WT-REMAINING = 'Y' OR 'Z' OR 'X' OR 'N'                   ECSRIRTN
  5578         COMPUTE RS-R-AB = RS-R-AB - RWF-AHAMT                    ECSRIRTN
  5579         COMPUTE RS-R-AP = RS-R-AP - RW-AHPRM                     ECSRIRTN
  5580         COMPUTE RS-R-APC = RS-R-APC - RW-AHPRMC.                 ECSRIRTN
  5581                                                                  ECSRIRTN
  5582     GO TO REIN-CALC-AH-X.                                        ECSRIRTN
  5583                                                                  ECSRIRTN
  5584 REIN-CALC-AH-RISK-PREM.                                          ECSRIRTN
  5585                                                                  ECSRIRTN
  5586     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  5587         MOVE ZEROS                 TO RWF-AHPRM                  ECSRIRTN
  5588         GO TO REIN-CALC-AH-X.                                    ECSRIRTN
  5589                                                                  ECSRIRTN
  5590     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  5591     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  5592     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  5593                                    RW-AHPRM.                     ECSRIRTN
  5594                                                                  ECSRIRTN
  5595 REIN-AH-RISK-PREM-LOOP.                                          ECSRIRTN
  5596                                                                  ECSRIRTN
  5597     COMPUTE RW-AHPRM = RW-AHPRM +                                ECSRIRTN
  5598                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  5599                                                                  ECSRIRTN
  5600     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  5601                                                                  ECSRIRTN
  5602     IF REIN-WORKA = REIN-EARN-AH-TERM  OR                        ECSRIRTN
  5603        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5604         MOVE RW-AHPRM          TO RWF-AHPRM                      ECSRIRTN
  5605     ELSE                                                         ECSRIRTN
  5606         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5607         GO TO REIN-AH-RISK-PREM-LOOP.                            ECSRIRTN
  5608                                                                  ECSRIRTN
  5609                                                                  ECSRIRTN
  5610 REIN-CALC-AH-X.                                                  ECSRIRTN
  5611     EXIT.                                                        ECSRIRTN
  5612                                                                  ECSRIRTN
  5613 REINSURE-CALC-REMAINDER.                                         ECSRIRTN
  5614                                                                  ECSRIRTN
  5615     COMPUTE RWF-LFAMT = CR-LFAMT + CR-LFAMT-ALT.                 ECSRIRTN
  5616     COMPUTE RWF-LFPRM = CR-LFPRM + CR-LFPRM-ALT.                 ECSRIRTN
  5617     MOVE CR-AHAMT TO RWF-AHAMT.                                  ECSRIRTN
  5618     MOVE CR-AHPRM TO RWF-AHPRM.                                  ECSRIRTN
  5619                                                                  ECSRIRTN
  5620     PERFORM REINSURE-SUBTRACT THRU REINSURE-SUBTRACT-X           ECSRIRTN
  5621         VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.            ECSRIRTN
  5622                                                                  ECSRIRTN
  5623     IF RWF-LFAMT NOT = ZEROS OR                                  ECSRIRTN
  5624        RWF-LFPRM NOT = ZEROS                                     ECSRIRTN
  5625           MOVE 'X' TO REIN-LF-FLG (SUB1).                        ECSRIRTN
  5626                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 111
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5627     IF RWF-AHAMT NOT = ZEROS OR                                  ECSRIRTN
  5628        RWF-AHPRM NOT = ZEROS                                     ECSRIRTN
  5629           MOVE 'X' TO REIN-AH-FLG (SUB1).                        ECSRIRTN
  5630                                                                  ECSRIRTN
  5631 REINSURE-CALC-X.                                                 ECSRIRTN
  5632                                                                  ECSRIRTN
  5633     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  5634         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  5635                                                                  ECSRIRTN
  5636     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  5637                                                                  ECSRIRTN
  5638 REINSURE-SUBTRACT.                                               ECSRIRTN
  5639                                                                  ECSRIRTN
  5640     SUBTRACT REIN-LFAMT (SUB2) FROM RWF-LFAMT.                   ECSRIRTN
  5641     SUBTRACT REIN-LFPRM (SUB2) FROM RWF-LFPRM.                   ECSRIRTN
  5642     SUBTRACT REIN-AHAMT (SUB2) FROM RWF-AHAMT.                   ECSRIRTN
  5643     SUBTRACT REIN-AHPRM (SUB2) FROM RWF-AHPRM.                   ECSRIRTN
  5644                                                                  ECSRIRTN
  5645 REINSURE-SUBTRACT-X.                                             ECSRIRTN
  5646     EXIT.                                                        ECSRIRTN
  5647                                                                  ECSRIRTN
  5648 REINSURE-CALC-CANCEL.                                            ECSRIRTN
  5649                                                                  ECSRIRTN
  5650     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  5651     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  5652                                                                  ECSRIRTN
  5653     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5654         GO TO REINSURE-REMAINDER-CANCEL.                         ECSRIRTN
  5655                                                                  ECSRIRTN
  5656     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5657         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5658                                                                  ECSRIRTN
  5659     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  5660         IF CR-LF-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**3
  5661             GO TO REINSURE-CALC-CANCEL-AH.                       ECSRIRTN
  5662                                                                  ECSRIRTN
  5663     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5664         GO TO REINSURE-CALC-LF-RISK-CANCEL.                      ECSRIRTN
  5665                                                                  ECSRIRTN
  5666     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5667         COMPUTE RWF-LFRFND ROUNDED = CR-LFRFND * WT-LF-PCT       ECSRIRTN
  5668         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5669                                                                  ECSRIRTN
  5670     IF CR-LFPRM = ZERO                                           ECSRIRTN
  5671        MOVE ZERO                TO REIN-FACTOR
  5672     ELSE                                                         ECSRIRTN
  5673        IF DTE-CLIENT = 'GIC'  AND
  5674           CLAS-I-BAL (CLAS-INDEXL) = 'B'
  5675           MOVE +1.0             TO REIN-FACTOR
  5676        ELSE
  5677           IF DTE-CLIENT = 'DCC'
  5678              COMPUTE REIN-FACTOR = CR-LFRFND /
  5679                 (CR-LFPRM + CR-LFPRM-ALT)
  5680           ELSE
  5681              COMPUTE REIN-FACTOR ROUNDED =  CR-LFRFND-CALC /
  5682                 (CR-LFPRM + CR-LFPRM-ALT)
  5683            END-IF
  5684         END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 112
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5685     END-IF
  5686                                                                  ECSRIRTN
  5687     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  5688         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  5689             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5690                 COMPUTE RWF-LFRFND ROUNDED =  ((CR-LFRFND *      ECSRIRTN
  5691                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  5692             ELSE                                                 ECSRIRTN
  5693                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5694                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5695                 COMPUTE RWF-LFRFND ROUNDED =  ((RWF-LFRFND *     ECSRIRTN
  5696                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  5697         ELSE                                                     ECSRIRTN
  5698             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5699                 compute rein-factor rounded =
  5700                    RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)
  5701                 COMPUTE RWF-LFRFND ROUNDED =  CR-LFRFND *
  5702                    rein-factor
  5703             ELSE                                                 ECSRIRTN
  5704*                COMPUTE RWF-LFRFND = REIN-FACTOR
  5705*                   * REIN-CALCED-LIFE *
  5706*                   (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).
  5707                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5708                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5709                 COMPUTE RWF-LFRFND ROUNDED =  (RWF-LFRFND *
  5710                        RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT).
  5711                                                                  ECSRIRTN
  5712     IF CR-LFAMT = ZERO                                           ECSRIRTN
  5713         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  5714             IF WT-LF-QC = ('1' OR '4')                           ECSRIRTN
  5715                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  5716                       CR-LFRFND * WT-LF-PCT                      ECSRIRTN
  5717             ELSE                                                 ECSRIRTN
  5718                 COMPUTE RWF-LFRFND =                             ECSRIRTN
  5719                            REIN-FACTOR * REIN-CALCED-LIFE        ECSRIRTN
  5720                 COMPUTE RWF-LFRFND ROUNDED =                     ECSRIRTN
  5721                       RWF-LFRFND * WT-LF-PCT.                    ECSRIRTN
  5722                                                                  ECSRIRTN
  5723     GO TO REINSURE-CALC-CANCEL-AH.                               ECSRIRTN
  5724                                                                  ECSRIRTN
  5725                                                                  ECSRIRTN
  5726 REINSURE-CALC-LF-RISK-CANCEL.                                    ECSRIRTN
  5727                                                                  ECSRIRTN
  5728     IF RWF-LFAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  5729       (CR-LF-CANC-DT = ZEROS)                                       CL*10
  5730         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  5731         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5732                                                                  ECSRIRTN
  5733     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  5734       IF VOIDING-LF-CANCEL                                       ECSRIRTN
  5735           COMPUTE RWF-LFRFND = RWF-LFRFND * (-1)                 ECSRIRTN
  5736           GO TO REINSURE-CALC-CANCEL-AH                          ECSRIRTN
  5737       ELSE                                                       ECSRIRTN
  5738           IF ADDITIONAL-LF-CANCEL                                ECSRIRTN
  5739               GO TO REINSURE-CALC-CANCEL-AH.                     ECSRIRTN
  5740                                                                  ECSRIRTN
  5741     IF FLAT-CANCEL-LF                                            ECSRIRTN
  5742         MOVE RWF-LFPRM               TO RWF-LFRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 113
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5743         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5744                                                                  ECSRIRTN
  5745     IF REIN-EARN-LF-TERM = REIN-LCNC-EARN-TERM                   ECSRIRTN
  5746         MOVE ZERO                    TO RWF-LFRFND               ECSRIRTN
  5747         GO TO REINSURE-CALC-CANCEL-AH.                           ECSRIRTN
  5748                                                                  ECSRIRTN
  5749     MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT.        ECSRIRTN
  5750     COMPUTE REIN-MONTH-REDUCE = RS-LIFE-BEN / CR-LF-TERM.        ECSRIRTN
  5751     MOVE +0                          TO REIN-WORKA               ECSRIRTN
  5752                                         RW-LFRFND.               ECSRIRTN
  5753                                                                  ECSRIRTN
  5754 REINSURE-LF-RISK-CANCEL-LOOP.                                    ECSRIRTN
  5755                                                                  ECSRIRTN
  5756     COMPUTE RW-LFRFND = RW-LFRFND +                              ECSRIRTN
  5757                ((REIN-RISK-AMOUNT / +1000) * CR-LF-NSP-PRM-RATE).ECSRIRTN
  5758                                                                  ECSRIRTN
  5759     IF CLAS-I-RL-AH (CLAS-INDEXL) NOT = 'L'                      ECSRIRTN
  5760        SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.         ECSRIRTN
  5761                                                                  ECSRIRTN
  5762     IF REIN-WORKA = REIN-LCNC-EARN-TERM  OR                      ECSRIRTN
  5763        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5764         COMPUTE RWF-LFRFND = RWF-LFPRM - RW-LFRFND               ECSRIRTN
  5765     ELSE                                                         ECSRIRTN
  5766         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5767         GO TO REINSURE-LF-RISK-CANCEL-LOOP.                      ECSRIRTN
  5768                                                                  ECSRIRTN
  5769                                                                  ECSRIRTN
  5770 REINSURE-CALC-CANCEL-AH.                                         ECSRIRTN
  5771                                                                  ECSRIRTN
  5772     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5773         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5774                                                                  ECSRIRTN
  5775     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  5776         IF CR-AH-CANC-DT NOT LESS THAN RWF-EP-STOP-DATE             CL**4
  5777             GO TO REINSURE-CALC-CANCEL-SKIP.                     ECSRIRTN
  5778                                                                  ECSRIRTN
  5779     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  5780         MOVE CR-AHRFND TO RWF-AHRFND                             ECSRIRTN
  5781         PERFORM REINSURE-SUB-REM-CANCEL THRU                     ECSRIRTN
  5782             REINSURE-SUB-REM-CANCEL-X                            ECSRIRTN
  5783                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  5784         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5785                                                                  ECSRIRTN
  5786     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5787         GO TO REINSURE-CALC-AH-RISK-CANCEL.                      ECSRIRTN
  5788                                                                  ECSRIRTN
  5789     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5790         COMPUTE RWF-AHRFND ROUNDED = CR-AHRFND * WT-AH-PCT       ECSRIRTN
  5791         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5792                                                                  ECSRIRTN
  5793     IF CR-AHPRM = ZERO                                           ECSRIRTN
  5794        MOVE ZERO                TO REIN-FACTOR
  5795     ELSE
  5796        IF DTE-CLIENT = 'GIC'  AND
  5797           CLAS-I-BAL (CLAS-INDEXA) = 'B'
  5798            MOVE +1.0            TO REIN-FACTOR
  5799        ELSE
  5800           IF DTE-CLIENT = 'DCC'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 114
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5801              COMPUTE REIN-FACTOR =
  5802                 CR-AHRFND / CR-AHPRM
  5803           ELSE
  5804              COMPUTE REIN-FACTOR ROUNDED =
  5805                                CR-AHRFND-CALC / CR-AHPRM
  5806           END-IF
  5807        END-IF
  5808     END-IF
  5809
  5810     IF CR-AHAMT NOT = ZERO
  5811        IF (DTE-CLIENT = 'DCC')
  5812           AND (CLAS-I-REFUND-METHOD (CLAS-INDEXA) = 'D')
  5813           MOVE CR-AH-RFND-CLP   TO RWF-AHRFND
  5814        ELSE
  5815           IF WT-AH-QC = ('1' OR '4')
  5816              compute rein-factor rounded = rwf-ahamt / cr-ahamt
  5817              compute rwf-ahrfnd rounded =
  5818                 cr-ahrfnd * rein-factor
  5819           ELSE
  5820              COMPUTE RWF-AHRFND = REIN-FACTOR * REIN-CALCED-AH
  5821              COMPUTE RWF-AHRFND ROUNDED = (RWF-AHRFND *
  5822                       RWF-AHAMT) / CR-AHAMT
  5823           END-IF
  5824        END-IF
  5825     ELSE
  5826        IF RWF-AH-LIMIT = ZERO
  5827           IF WT-AH-QC = ('1' OR '4')
  5828              COMPUTE RWF-AHRFND ROUNDED =
  5829                       CR-AHRFND * WT-AH-PCT
  5830           ELSE
  5831              COMPUTE RWF-AHRFND =
  5832                            REIN-FACTOR * REIN-CALCED-AH
  5833              COMPUTE RWF-AHRFND ROUNDED =
  5834                       RWF-AHRFND * WT-AH-PCT
  5835           END-IF
  5836        END-IF
  5837     END-IF
  5838
  5839     GO TO REINSURE-CALC-CANCEL-SKIP.                             ECSRIRTN
  5840                                                                  ECSRIRTN
  5841                                                                  ECSRIRTN
  5842 REINSURE-CALC-AH-RISK-CANCEL.                                    ECSRIRTN
  5843                                                                  ECSRIRTN
  5844     IF RWF-AHAMT NOT GREATER THAN +0  OR                         ECSRIRTN
  5845       (CR-AH-CANC-DT = ZEROS)                                       CL*10
  5846         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  5847         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5848                                                                  ECSRIRTN
  5849     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  5850       IF VOIDING-AH-CANCEL                                       ECSRIRTN
  5851           COMPUTE RWF-AHRFND = RWF-AHRFND * (-1)                 ECSRIRTN
  5852           GO TO REINSURE-CALC-CANCEL-SKIP                        ECSRIRTN
  5853       ELSE                                                       ECSRIRTN
  5854           IF ADDITIONAL-AH-CANCEL                                ECSRIRTN
  5855               GO TO REINSURE-CALC-CANCEL-SKIP.                   ECSRIRTN
  5856                                                                  ECSRIRTN
  5857     IF FLAT-CANCEL-AH                                            ECSRIRTN
  5858         MOVE RWF-AHPRM               TO RWF-AHRFND               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 115
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5859         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5860                                                                  ECSRIRTN
  5861     IF REIN-EARN-AH-TERM = REIN-ACNC-EARN-TERM                   ECSRIRTN
  5862         MOVE ZERO                    TO RWF-AHRFND               ECSRIRTN
  5863         GO TO REINSURE-CALC-CANCEL-SKIP.                         ECSRIRTN
  5864                                                                  ECSRIRTN
  5865     MOVE RS-AH-BEN              TO REIN-MONTH-REDUCE.            ECSRIRTN
  5866     COMPUTE REIN-RISK-AMOUNT = RWF-AHAMT * CR-AH-TERM.           ECSRIRTN
  5867     MOVE +0                     TO REIN-WORKA                    ECSRIRTN
  5868                                    RW-AHRFND.                    ECSRIRTN
  5869                                                                  ECSRIRTN
  5870 REINSURE-AH-RISK-CANCEL-LOOP.                                    ECSRIRTN
  5871                                                                  ECSRIRTN
  5872     COMPUTE RW-AHRFND = RW-AHRFND +                              ECSRIRTN
  5873                ((REIN-RISK-AMOUNT / +1000) * CR-AH-NSP-PRM-RATE).ECSRIRTN
  5874                                                                  ECSRIRTN
  5875     SUBTRACT REIN-MONTH-REDUCE FROM REIN-RISK-AMOUNT.            ECSRIRTN
  5876                                                                  ECSRIRTN
  5877     IF REIN-WORKA = REIN-ACNC-EARN-TERM  OR                      ECSRIRTN
  5878        REIN-RISK-AMOUNT LESS THAN +0                             ECSRIRTN
  5879         COMPUTE RWF-AHRFND = RWF-AHPRM - RW-AHRFND               ECSRIRTN
  5880     ELSE                                                         ECSRIRTN
  5881         ADD +1 TO REIN-WORKA                                     ECSRIRTN
  5882         GO TO REINSURE-AH-RISK-CANCEL-LOOP.                      ECSRIRTN
  5883                                                                  ECSRIRTN
  5884                                                                  ECSRIRTN
  5885 REINSURE-CALC-CANCEL-SKIP.                                       ECSRIRTN
  5886                                                                  ECSRIRTN
  5887     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  5888         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5889                                                                  ECSRIRTN
  5890     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  5891         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  5892                                                                  ECSRIRTN
  5893     GO TO REINSURE-CALC-CANCEL-X.                                ECSRIRTN
  5894                                                                  ECSRIRTN
  5895 REINSURE-REMAINDER-CANCEL.                                       ECSRIRTN
  5896                                                                  ECSRIRTN
  5897     MOVE CR-LFRFND TO RWF-LFRFND.                                ECSRIRTN
  5898     MOVE CR-AHRFND TO RWF-AHRFND.                                ECSRIRTN
  5899                                                                  ECSRIRTN
  5900     PERFORM REINSURE-SUBTRACT-CANCEL THRU                        ECSRIRTN
  5901         REINSURE-SUBTRACT-CANCEL-X                               ECSRIRTN
  5902             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  5903                                                                  ECSRIRTN
  5904     IF RWF-LFRFND NOT = ZEROS                                    ECSRIRTN
  5905         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  5906                                                                  ECSRIRTN
  5907     IF RWF-AHRFND NOT = ZEROS                                    ECSRIRTN
  5908         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  5909                                                                  ECSRIRTN
  5910 REINSURE-CALC-CANCEL-X.                                          ECSRIRTN
  5911                                                                  ECSRIRTN
  5912     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  5913         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  5914                                                                  ECSRIRTN
  5915     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  5916                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 116
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5917 REINSURE-SUBTRACT-CANCEL.                                        ECSRIRTN
  5918                                                                  ECSRIRTN
  5919     SUBTRACT REIN-LFRFND (SUB2) FROM RWF-LFRFND.                 ECSRIRTN
  5920     SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.                 ECSRIRTN
  5921                                                                  ECSRIRTN
  5922 REINSURE-SUBTRACT-CANCEL-X.                                      ECSRIRTN
  5923     EXIT.                                                        ECSRIRTN
  5924                                                                  ECSRIRTN
  5925 REINSURE-SUB-REM-CANCEL.                                         ECSRIRTN
  5926                                                                  ECSRIRTN
  5927     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  5928         SUBTRACT REIN-AHRFND (SUB2) FROM RWF-AHRFND.             ECSRIRTN
  5929                                                                  ECSRIRTN
  5930 REINSURE-SUB-REM-CANCEL-X.                                       ECSRIRTN
  5931     EXIT.                                                        ECSRIRTN
  5932                                                                  ECSRIRTN
  5933 REINSURE-CALC-CLAIM.                                             ECSRIRTN
  5934                                                                  ECSRIRTN
  5935     MOVE REIN-WORK-FLDS (SUB1) TO RWF-FIELDS.                    ECSRIRTN
  5936     MOVE RE-COMP-INFO (SUB1) TO WT-COMP-INFO.                    ECSRIRTN
  5937                                                                  ECSRIRTN
  5938     IF SUB1 = RE-100-COMP                                        ECSRIRTN
  5939         GO TO REINSURE-REMAINDER-CLAIM.                          ECSRIRTN
  5940                                                                  ECSRIRTN
  5941     PERFORM REIN-FIND-CO-LOOP THRU FIND-REI-CO-EXIT              ECSRIRTN
  5942        VARYING CO-SUB FROM 1 BY 1 UNTIL                          ECSRIRTN
  5943          (RCT-REIN-CO (CO-SUB) = REIN-COMP (SUB1))  OR           ECSRIRTN
  5944          (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)     OR           ECSRIRTN
  5945          (RCT-REIN-CO (CO-SUB) = SPACES).                        ECSRIRTN
  5946                                                                  ECSRIRTN
  5947     IF (CO-SUB GREATER REIN-CO-TABLE-ENT-CNT)  OR                ECSRIRTN
  5948        (RCT-REIN-CO (CO-SUB) = SPACES)                           ECSRIRTN
  5949          MOVE ZERO TO CO-SUB.                                    ECSRIRTN
  5950                                                                  ECSRIRTN
  5951     MOVE ZEROS                TO RWF-LFCLML                      ECSRIRTN
  5952                                  RWF-AHCLML.                     ECSRIRTN
  5953                                                                  ECSRIRTN
  5954     IF REIN-LF-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  5955         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  5956                                                                  ECSRIRTN
  5957     IF RW-LFCLMWK = ZEROS                                        ECSRIRTN
  5958         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  5959                                                                  ECSRIRTN
  5960     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  5961         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  5962             IF CR-DTH-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)         ECSRIRTN
  5963                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  5964                                                                  ECSRIRTN
  5965     IF RWF-LF-RUNOFF-SW = 'N'                                    ECSRIRTN
  5966         IF CR-DTH-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  5967                 GO TO REINSURE-CALC-CLAIM-AH.                    ECSRIRTN
  5968                                                                  ECSRIRTN
  5969     IF WT-REMAINING = 'I'                                        ECSRIRTN
  5970         GO TO REINSURE-CALC-LF-RISK-CLAIM.                       ECSRIRTN
  5971                                                                  ECSRIRTN
  5972     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5973         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  5974             IF RW-LFCLMWK GREATER WT-LF-HI                       ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 117
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  5975                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  5976             ELSE                                                 ECSRIRTN
  5977                 MOVE RW-LFCLMWK TO RWF-LFCLM                     ECSRIRTN
  5978         ELSE                                                     ECSRIRTN
  5979             IF (RW-LFCLMWK + RWF-LFCLM) GREATER WT-LF-HI         ECSRIRTN
  5980                 COMPUTE RWF-LFCLML = WT-LF-HI - RWF-LFCLM        ECSRIRTN
  5981                 MOVE WT-LF-HI TO RWF-LFCLM                       ECSRIRTN
  5982             ELSE                                                 ECSRIRTN
  5983                 MOVE RW-LFCLMWK TO RWF-LFCLML                    ECSRIRTN
  5984                 ADD RWF-LFCLML TO RWF-LFCLM.                     ECSRIRTN
  5985                                                                  ECSRIRTN
  5986     IF WT-REMAINING = 'L'                                        ECSRIRTN
  5987         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  5988                                                                  ECSRIRTN
  5989     IF CR-LFAMT NOT = ZERO                                       ECSRIRTN
  5990         IF DTE-CLIENT = 'GTL'  OR  'UAL'  OR  'NCL'  OR  'CVL'   ECSRIRTN
  5991            OR 'DCC'
  5992             COMPUTE RWF-LFCLML ROUNDED =  ((RW-LFCLMWK *         ECSRIRTN
  5993                         RWF-LFAMT) / (CR-LFAMT + CR-LFAMT-ALT))  ECSRIRTN
  5994         ELSE                                                     ECSRIRTN
  5995             COMPUTE RWF-LFCLML ROUNDED =  RW-LFCLMWK *           ECSRIRTN
  5996                        (RWF-LFAMT / (CR-LFAMT + CR-LFAMT-ALT)).  ECSRIRTN
  5997                                                                  ECSRIRTN
  5998     IF CR-LFAMT = ZERO                                           ECSRIRTN
  5999         IF WT-LF-LIM-LO = ZERO                                   ECSRIRTN
  6000             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  6001                       RW-LFCLMWK * WT-LF-PCT.                    ECSRIRTN
  6002                                                                  ECSRIRTN
  6003     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6004         IF RCT-LF-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  6005             COMPUTE RWF-LFCLML ROUNDED =                         ECSRIRTN
  6006                          RW-LFCLMWK * RCT-LF-CLM-PCT (CO-SUB).   ECSRIRTN
  6007                                                                  ECSRIRTN
  6008     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6009         IF RCT-LF-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  6010             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  6011               IF RWF-LFCLML GREATER RCT-LF-CLM-MAX (CO-SUB)      ECSRIRTN
  6012                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  6013                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  6014                  ELSE                                            ECSRIRTN
  6015                     MOVE RWF-LFCLML TO RWF-LFCLM                 ECSRIRTN
  6016                      GO TO REINSURE-CALC-CLAIM-AH                ECSRIRTN
  6017              ELSE                                                ECSRIRTN
  6018                 IF (RWF-LFCLML + RWF-LFCLM) GREATER              ECSRIRTN
  6019                                           RCT-LF-CLM-MAX (CO-SUB)ECSRIRTN
  6020                     COMPUTE RWF-LFCLML =                         ECSRIRTN
  6021                               RCT-LF-CLM-MAX (CO-SUB) - RWF-LFCLMECSRIRTN
  6022                     MOVE RCT-LF-CLM-MAX (CO-SUB) TO RWF-LFCLM    ECSRIRTN
  6023                      GO TO REINSURE-CALC-CLAIM-AH.               ECSRIRTN
  6024                                                                  ECSRIRTN
  6025     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  6026                                                                  ECSRIRTN
  6027     GO TO REINSURE-CALC-CLAIM-AH.                                ECSRIRTN
  6028                                                                  ECSRIRTN
  6029                                                                  ECSRIRTN
  6030 REINSURE-CALC-LF-RISK-CLAIM.                                     ECSRIRTN
  6031                                                                  ECSRIRTN
  6032     IF RWF-LFAMT NOT GREATER THAN +0                             ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 118
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6033         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  6034                                                                  ECSRIRTN
  6035     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'L'                          ECSRIRTN
  6036         MOVE RWF-LFAMT                   TO REIN-RISK-AMOUNT     ECSRIRTN
  6037     ELSE                                                         ECSRIRTN
  6038         COMPUTE REIN-RISK-AMOUNT = RWF-LFAMT -                   ECSRIRTN
  6039                ((RS-LIFE-BEN / CR-LF-TERM) * REIN-LF-CLM-MONTHS).ECSRIRTN
  6040                                                                  ECSRIRTN
  6041     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6042         GO TO REINSURE-CALC-CLAIM-AH.                            ECSRIRTN
  6043                                                                  ECSRIRTN
  6044     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6045         IF RW-LFCLMWK GREATER THAN REIN-RISK-AMOUNT              ECSRIRTN
  6046             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  6047         ELSE                                                     ECSRIRTN
  6048             MOVE RW-LFCLMWK              TO RWF-LFCLM            ECSRIRTN
  6049     ELSE                                                         ECSRIRTN
  6050         IF (RW-LFCLMWK + RWF-LFCLM) GREATER THAN REIN-RISK-AMOUNTECSRIRTN
  6051             COMPUTE RWF-LFCLML = REIN-RISK-AMOUNT - RWF-LFCLM    ECSRIRTN
  6052             MOVE REIN-RISK-AMOUNT        TO RWF-LFCLM            ECSRIRTN
  6053         ELSE                                                     ECSRIRTN
  6054             MOVE RW-LFCLMWK              TO RWF-LFCLML           ECSRIRTN
  6055             ADD RW-LFCLMWK TO RWF-LFCLM.                         ECSRIRTN
  6056                                                                  ECSRIRTN
  6057                                                                  ECSRIRTN
  6058 REINSURE-CALC-CLAIM-AH.                                          ECSRIRTN
  6059                                                                  ECSRIRTN
  6060     IF REIN-AH-FLG (SUB1) NOT = 'X'                              ECSRIRTN
  6061         GO TO REINSURE-CALC-CLAIM-X.                             ECSRIRTN
  6062                                                                  ECSRIRTN
  6063     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6064         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6065                                                                  ECSRIRTN
  6066     IF REIN-RT-SW NOT = 'X'                                      ECSRIRTN
  6067         GO TO REINSURE-CALC-AH-DETAIL.                           ECSRIRTN
  6068                                                                  ECSRIRTN
  6069     MOVE CR-DISAB-INCURRED-DETAIL    TO RW-AH-INCURRED-DETAIL.   ECSRIRTN
  6070     MOVE ZEROS                       TO RW-AHCLMWK.              ECSRIRTN
  6071                                                                  ECSRIRTN
  6072     PERFORM CHECK-MULTIPLE-DISABILITIES THRU CHECK-DISABS-EXIT   ECSRIRTN
  6073             VARYING                                              ECSRIRTN
  6074         INC-SUB FROM +1 BY +1                                    ECSRIRTN
  6075             UNTIL                                                ECSRIRTN
  6076         INC-SUB GREATER THAN +5.                                 ECSRIRTN
  6077                                                                  ECSRIRTN
  6078     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6079         GO TO REINSURE-CALC-CLAIM-SKIP                           ECSRIRTN
  6080     ELSE                                                         ECSRIRTN
  6081         GO TO REINSURE-CALC-AH-CONTINUED.                        ECSRIRTN
  6082                                                                  ECSRIRTN
  6083 CHECK-MULTIPLE-DISABILITIES.                                     ECSRIRTN
  6084                                                                  ECSRIRTN
  6085     IF RW-AH-INCUR-DT (INC-SUB) = ZEROS                          ECSRIRTN
  6086         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6087                                                                  ECSRIRTN
  6088     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6089       IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                   ECSRIRTN
  6090           IF RW-AH-INCUR-DT (INC-SUB) LESS THAN                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 119
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6091                       RCT-CLM-CUTOFF-DT (CO-SUB)                    CL**5
  6092               MOVE ZEROS             TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  6093                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  6094               GO TO CHECK-DISABS-EXIT.                           ECSRIRTN
  6095                                                                  ECSRIRTN
  6096     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  6097       IF RW-AH-INCUR-DT (INC-SUB) NOT LESS THAN RWF-EP-STOP-DATE ECSRIRTN
  6098           MOVE ZEROS                 TO RW-AH-CLM-AMT (INC-SUB)  ECSRIRTN
  6099                                         RW-AH-CLM-EXP (INC-SUB)  ECSRIRTN
  6100           GO TO CHECK-DISABS-EXIT.                               ECSRIRTN
  6101                                                                  ECSRIRTN
  6102     IF WT-REMAINING NOT = 'I'                                    ECSRIRTN
  6103         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  6104                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  6105                             + RW-AH-CLM-EXP (INC-SUB)            ECSRIRTN
  6106         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6107                                                                  ECSRIRTN
  6108     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  6109         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6110                                                                  ECSRIRTN
  6111     IF INC-SUB = +1                                              ECSRIRTN
  6112         MOVE REIN-AH-CLM-MTH-1       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6113     IF INC-SUB = +2                                              ECSRIRTN
  6114         MOVE REIN-AH-CLM-MTH-2       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6115     IF INC-SUB = +3                                              ECSRIRTN
  6116         MOVE REIN-AH-CLM-MTH-3       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6117     IF INC-SUB = +4                                              ECSRIRTN
  6118         MOVE REIN-AH-CLM-MTH-4       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6119     IF INC-SUB = +5                                              ECSRIRTN
  6120         MOVE REIN-AH-CLM-MTH-5       TO REIN-AH-CLM-MONTHS.      ECSRIRTN
  6121                                                                  ECSRIRTN
  6122     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  6123                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  6124                                                                  ECSRIRTN
  6125     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6126         GO TO CHECK-DISABS-EXIT.                                 ECSRIRTN
  6127                                                                  ECSRIRTN
  6128     IF (RW-AH-CLM-AMT (INC-SUB) + RW-AH-CLM-EXP (INC-SUB))       ECSRIRTN
  6129              GREATER THAN REIN-RISK-AMOUNT                       ECSRIRTN
  6130         COMPUTE RW-AHCLMWK = RW-AHCLMWK + REIN-RISK-AMOUNT       ECSRIRTN
  6131     ELSE                                                         ECSRIRTN
  6132         COMPUTE RW-AHCLMWK = RW-AHCLMWK                          ECSRIRTN
  6133                             + RW-AH-CLM-AMT (INC-SUB)            ECSRIRTN
  6134                             + RW-AH-CLM-EXP (INC-SUB).           ECSRIRTN
  6135                                                                  ECSRIRTN
  6136 CHECK-DISABS-EXIT.                                               ECSRIRTN
  6137      EXIT.                                                       ECSRIRTN
  6138                                                                  ECSRIRTN
  6139 REINSURE-CALC-AH-DETAIL.                                         ECSRIRTN
  6140                                                                  ECSRIRTN
  6141     IF RW-AHCLMWK = ZEROS                                        ECSRIRTN
  6142         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6143                                                                  ECSRIRTN
  6144     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6145         IF RCT-CLM-CUTOFF-DT (CO-SUB) NOT = ZERO                 ECSRIRTN
  6146             IF CR-DIS-DT LESS RCT-CLM-CUTOFF-DT (CO-SUB)            CL*11
  6147                 GO TO REINSURE-CALC-CLAIM-SKIP.                  ECSRIRTN
  6148                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 120
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6149     IF RWF-AH-RUNOFF-SW = 'N'                                    ECSRIRTN
  6150         IF CR-DIS-DT NOT LESS THAN RWF-EP-STOP-DATE                 CL**6
  6151             GO TO REINSURE-CALC-CLAIM-SKIP.                      ECSRIRTN
  6152                                                                  ECSRIRTN
  6153 REINSURE-CALC-AH-CONTINUED.                                      ECSRIRTN
  6154                                                                  ECSRIRTN
  6155     IF RWF-REM-AH-100 = 'Y'                                      ECSRIRTN
  6156         MOVE RW-AHCLMWK TO RWF-AHCLML                            ECSRIRTN
  6157         PERFORM REINSURE-SUB-REM-CLAIM THRU                      ECSRIRTN
  6158             REINSURE-SUB-REM-CLAIM-X                             ECSRIRTN
  6159                 VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1     ECSRIRTN
  6160         ADD RWF-AHCLML TO RWF-AHCLM                              ECSRIRTN
  6161         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6162                                                                  ECSRIRTN
  6163     IF WT-REMAINING = 'I'                                        ECSRIRTN
  6164         GO TO REINSURE-CALC-AH-RISK-CLAIM.                       ECSRIRTN
  6165                                                                  ECSRIRTN
  6166     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6167         IF REIN-RT-SW = 'X'                                      ECSRIRTN
  6168             IF RW-AHCLMWK GREATER WT-AHBEN-HI                    ECSRIRTN
  6169                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  6170             ELSE                                                 ECSRIRTN
  6171                 MOVE RW-AHCLMWK TO RWF-AHCLM                     ECSRIRTN
  6172         ELSE                                                     ECSRIRTN
  6173             IF (RW-AHCLMWK + RWF-AHCLM) GREATER WT-AHBEN-HI      ECSRIRTN
  6174                 COMPUTE RWF-AHCLML = WT-AHBEN-HI - RWF-AHCLM     ECSRIRTN
  6175                 MOVE WT-AHBEN-HI TO RWF-AHCLM                    ECSRIRTN
  6176             ELSE                                                 ECSRIRTN
  6177                 MOVE RW-AHCLMWK TO RWF-AHCLML                    ECSRIRTN
  6178                 ADD RWF-AHCLML TO RWF-AHCLM.                     ECSRIRTN
  6179                                                                  ECSRIRTN
  6180     IF WT-REMAINING = 'L'                                        ECSRIRTN
  6181         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6182                                                                  ECSRIRTN
  6183     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  6184         COMPUTE RWF-AHCLML ROUNDED = (RW-AHCLMWK *               ECSRIRTN
  6185                            RWF-AHAMT) / CR-AHAMT                 ECSRIRTN
  6186     ELSE                                                         ECSRIRTN
  6187         IF RWF-AH-LIMIT = ZERO                                   ECSRIRTN
  6188             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  6189                       RW-AHCLMWK * WT-AH-PCT.                    ECSRIRTN
  6190                                                                  ECSRIRTN
  6191     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6192         IF RCT-AH-CLM-PCT (CO-SUB) NOT = ZERO                    ECSRIRTN
  6193             COMPUTE RWF-AHCLML ROUNDED =                         ECSRIRTN
  6194                           RW-AHCLMWK * RCT-AH-CLM-PCT (CO-SUB).  ECSRIRTN
  6195                                                                  ECSRIRTN
  6196     IF CO-SUB NOT = ZERO                                         ECSRIRTN
  6197         IF RCT-AH-CLM-MAX (CO-SUB) NOT = ZERO                    ECSRIRTN
  6198             IF REIN-RT-SW = 'X'                                  ECSRIRTN
  6199               IF RWF-AHCLML GREATER RCT-AH-CLM-MAX (CO-SUB)      ECSRIRTN
  6200                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  6201                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  6202                  ELSE                                            ECSRIRTN
  6203                     MOVE RWF-AHCLML TO RWF-AHCLM                 ECSRIRTN
  6204                      GO TO REINSURE-CALC-CLAIM-SKIP              ECSRIRTN
  6205              ELSE                                                ECSRIRTN
  6206                 IF (RWF-AHCLML + RWF-AHCLM) GREATER              ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 121
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6207                                           RCT-AH-CLM-MAX (CO-SUB)ECSRIRTN
  6208                     COMPUTE RWF-AHCLML =                         ECSRIRTN
  6209                               RCT-AH-CLM-MAX (CO-SUB) - RWF-AHCLMECSRIRTN
  6210                     MOVE RCT-AH-CLM-MAX (CO-SUB) TO RWF-AHCLM    ECSRIRTN
  6211                      GO TO REINSURE-CALC-CLAIM-SKIP.             ECSRIRTN
  6212                                                                  ECSRIRTN
  6213                                                                  ECSRIRTN
  6214     IF DTE-CLIENT = 'FLA'                                        ECSRIRTN
  6215        IF REIN-COMP (SUB1) = ('200000' OR '210000' OR            ECSRIRTN
  6216                               '220000' OR '230000')              ECSRIRTN
  6217           PERFORM FLA-SPEC-REIN-CLMS THRU                        ECSRIRTN
  6218               E-FLA-SPEC-REIN-CLMS.                              ECSRIRTN
  6219                                                                  ECSRIRTN
  6220     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  6221                                                                  ECSRIRTN
  6222     GO TO REINSURE-CALC-CLAIM-SKIP.                              ECSRIRTN
  6223                                                                  ECSRIRTN
  6224                                                                  ECSRIRTN
  6225 REINSURE-CALC-AH-RISK-CLAIM.                                     ECSRIRTN
  6226                                                                  ECSRIRTN
  6227     IF RWF-AHAMT NOT GREATER THAN +0                             ECSRIRTN
  6228         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6229                                                                  ECSRIRTN
  6230     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6231         MOVE RW-AHCLMWK              TO RWF-AHCLM                ECSRIRTN
  6232         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6233                                                                  ECSRIRTN
  6234     COMPUTE REIN-RISK-AMOUNT = (RWF-AHAMT * CR-AH-TERM) -        ECSRIRTN
  6235                                (RS-AH-BEN * REIN-AH-CLM-MONTHS). ECSRIRTN
  6236                                                                  ECSRIRTN
  6237     IF REIN-RISK-AMOUNT NOT GREATER THAN +0                      ECSRIRTN
  6238         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6239                                                                  ECSRIRTN
  6240     IF REIN-AH-PRIOR-CLMS-PAID GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  6241         GO TO REINSURE-CALC-CLAIM-SKIP.                          ECSRIRTN
  6242                                                                  ECSRIRTN
  6243     IF (RW-AHCLMWK + REIN-AH-PRIOR-CLMS-PAID)                    ECSRIRTN
  6244                                GREATER THAN REIN-RISK-AMOUNT     ECSRIRTN
  6245         COMPUTE RWF-AHCLML = REIN-RISK-AMOUNT                    ECSRIRTN
  6246                             - REIN-AH-PRIOR-CLMS-PAID            ECSRIRTN
  6247         MOVE REIN-RISK-AMOUNT        TO RWF-AHCLM                ECSRIRTN
  6248     ELSE                                                         ECSRIRTN
  6249         MOVE RW-AHCLMWK              TO RWF-AHCLML               ECSRIRTN
  6250         ADD RW-AHCLMWK TO RWF-AHCLM.                             ECSRIRTN
  6251                                                                  ECSRIRTN
  6252                                                                  ECSRIRTN
  6253 REINSURE-CALC-CLAIM-SKIP.                                        ECSRIRTN
  6254                                                                  ECSRIRTN
  6255     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  6256         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  6257                                                                  ECSRIRTN
  6258     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  6259         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  6260                                                                  ECSRIRTN
  6261     GO TO REINSURE-CALC-CLAIM-X.                                 ECSRIRTN
  6262                                                                  ECSRIRTN
  6263 REINSURE-REMAINDER-CLAIM.                                        ECSRIRTN
  6264                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 122
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6265     MOVE RW-LFCLMWK TO RWF-LFCLML.                               ECSRIRTN
  6266     MOVE RW-AHCLMWK TO RWF-AHCLML.                               ECSRIRTN
  6267                                                                  ECSRIRTN
  6268     PERFORM REINSURE-SUBTRACT-CLAIM THRU                         ECSRIRTN
  6269         REINSURE-SUBTRACT-CLAIM-X                                ECSRIRTN
  6270             VARYING SUB2 FROM +1 BY +1 UNTIL SUB2 = SUB1.        ECSRIRTN
  6271                                                                  ECSRIRTN
  6272     ADD RWF-LFCLML TO RWF-LFCLM.                                 ECSRIRTN
  6273     ADD RWF-AHCLML TO RWF-AHCLM.                                 ECSRIRTN
  6274                                                                  ECSRIRTN
  6275     IF RWF-LFCLM NOT = ZEROS                                     ECSRIRTN
  6276         MOVE 'X' TO REIN-LF-FLG (SUB1).                          ECSRIRTN
  6277                                                                  ECSRIRTN
  6278     IF RWF-AHCLM NOT = ZEROS                                     ECSRIRTN
  6279         MOVE 'X' TO REIN-AH-FLG (SUB1).                          ECSRIRTN
  6280                                                                  ECSRIRTN
  6281 REINSURE-CALC-CLAIM-X.                                           ECSRIRTN
  6282                                                                  ECSRIRTN
  6283     IF REIN-LF-AH-FLGS (SUB1) NOT = SPACES                       ECSRIRTN
  6284         MOVE 'X' TO REIN-BUS-FLAG.                               ECSRIRTN
  6285                                                                  ECSRIRTN
  6286     MOVE RWF-FIELDS TO REIN-WORK-FLDS (SUB1).                    ECSRIRTN
  6287                                                                  ECSRIRTN
  6288 REINSURE-SUBTRACT-CLAIM.                                         ECSRIRTN
  6289                                                                  ECSRIRTN
  6290     SUBTRACT REIN-LFCLML (SUB2) FROM RWF-LFCLML.                 ECSRIRTN
  6291     SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.                 ECSRIRTN
  6292                                                                  ECSRIRTN
  6293 REINSURE-SUBTRACT-CLAIM-X.                                       ECSRIRTN
  6294     EXIT.                                                        ECSRIRTN
  6295                                                                  ECSRIRTN
  6296 REINSURE-SUB-REM-CLAIM.                                          ECSRIRTN
  6297                                                                  ECSRIRTN
  6298     IF REIN-REM-SW (SUB2) = 'Y' OR 'Z' OR 'X' OR 'N'             ECSRIRTN
  6299         SUBTRACT REIN-AHCLML (SUB2) FROM RWF-AHCLML.             ECSRIRTN
  6300                                                                  ECSRIRTN
  6301 REINSURE-SUB-REM-CLAIM-X.                                        ECSRIRTN
  6302     EXIT.                                                        ECSRIRTN
  6303                                                                  ECSRIRTN
  6304                                                                  ECSRIRTN
  6305 CLEAR-REIN-HOLD.                                                 ECSRIRTN
  6306                                                                  ECSRIRTN
  6307     MOVE SPACES TO REIN-COMP (1).                                ECSRIRTN
  6308     MOVE SPACES TO REIN-LF-AH-FLGS (1).                          ECSRIRTN
  6309     MOVE SPACES TO REIN-REM-SW (1).                              ECSRIRTN
  6310     MOVE SPACES TO REIN-REM-AH-100 (1).                          ECSRIRTN
  6311                                                                  ECSRIRTN
  6312     MOVE +0 TO REIN-LFAMT (1)  REIN-LFPRM (1)  REIN-AHAMT (1)    ECSRIRTN
  6313         REIN-AHPRM (1)  REIN-LFRFND (1)  REIN-AHRFND (1)         ECSRIRTN
  6314         REIN-LFCLM (1)  REIN-AHCLM (1)  REIN-LFCLML (1)          ECSRIRTN
  6315         REIN-AHCLML (1)  REIN-DIS-IBNR (1)  REIN-DIS-PAYCUR (1)  ECSRIRTN
  6316         REIN-DIS-FUTRSV (1)  REIN-DTH-IBNR (1)                   ECSRIRTN
  6317         REIN-DTH-PAYCUR (1)  REIN-DTH-FUTRSV (1)                 ECSRIRTN
  6318         REIN-DIS-IBNRL (1)  REIN-DIS-PAYCURL (1)                 ECSRIRTN
  6319         REIN-DIS-FUTRSVL (1)  REIN-DTH-IBNRL (1)                 ECSRIRTN
  6320         REIN-DTH-PAYCURL (1)  REIN-DTH-FUTRSVL (1)               ECSRIRTN
  6321         REIN-AH-LIMIT (1).                                       ECSRIRTN
  6322                                                                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 123
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6323     PERFORM CLEAR-REIN-HOLD-ALL VARYING SUB1 FROM 2 BY 1         ECSRIRTN
  6324         UNTIL REIN-COMP (SUB1) = SPACES.                         ECSRIRTN
  6325                                                                  ECSRIRTN
  6326     GO TO CLEAR-REIN-HOLD-X.                                     ECSRIRTN
  6327                                                                  ECSRIRTN
  6328 CLEAR-REIN-HOLD-ALL.                                             ECSRIRTN
  6329                                                                  ECSRIRTN
  6330     MOVE REIN-LEVELS (1) TO REIN-LEVELS (SUB1).                  ECSRIRTN
  6331                                                                  ECSRIRTN
  6332 CLEAR-REIN-HOLD-X.                                               ECSRIRTN
  6333     EXIT.                                                        ECSRIRTN
  6334                                                                  ECSRIRTN
  6335 FLA-SPEC-REIN-CLMS.                                              ECSRIRTN
  6336                                                                  ECSRIRTN
  6337     MOVE +250.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.        ECSRIRTN
  6338                                                                  ECSRIRTN
  6339     IF REIN-COMP (SUB1) = '230000'                               ECSRIRTN
  6340         MOVE +100.00 TO FLA-CLM-REIN-BASE  ADJ-FLA-REIN-BASE.    ECSRIRTN
  6341                                                                  ECSRIRTN
  6342     IF CR-AHAMT NOT = ZERO                                       ECSRIRTN
  6343         COMPUTE ADJ-FLA-REIN-BASE ROUNDED =                      ECSRIRTN
  6344             (RW-AHCLMWK / CR-AHAMT) * FLA-CLM-REIN-BASE.         ECSRIRTN
  6345                                                                  ECSRIRTN
  6346     IF REIN-RT-SW = 'X'                                          ECSRIRTN
  6347         MOVE CR-DIS-CC TO CIRD-CC                                ECSRIRTN
  6348         MOVE CR-DIS-YR TO CIRD-YR                                ECSRIRTN
  6349         MOVE CR-DIS-MO TO CIRD-MO                                ECSRIRTN
  6350     ELSE                                                         ECSRIRTN
  6351         MOVE DTO-CC    TO CIRD-CC                                ECSRIRTN
  6352         MOVE DTO-YR    TO CIRD-YR                                ECSRIRTN
  6353         MOVE DTO-MO    TO CIRD-MO.                               ECSRIRTN
  6354                                                                  ECSRIRTN
  6355     MOVE ZEROS TO RWF-AHCLML.                                    ECSRIRTN
  6356                                                                  ECSRIRTN
  6357     IF CLM-INCUR-REIN-DATE LESS '197809'  AND                    ECSRIRTN
  6358        CR-AHAMT GREATER FLA-CLM-REIN-BASE                        ECSRIRTN
  6359         COMPUTE RWF-AHCLML = RW-AHCLMWK - ADJ-FLA-REIN-BASE.     ECSRIRTN
  6360                                                                  ECSRIRTN
  6361     IF CLM-INCUR-REIN-DATE GREATER '197806'                      ECSRIRTN
  6362         COMPUTE RWF-AHCLML = RWF-AHCLML + (RW-AHCLMWK * +.9).    ECSRIRTN
  6363                                                                  ECSRIRTN
  6364 E-FLA-SPEC-REIN-CLMS.                                            ECSRIRTN
  6365     EXIT.                                                        ECSRIRTN
  6366                                                                  ECSRIRTN
  6367 REIN-FIND-CO-LOOP.                                               ECSRIRTN
  6368                                                                  ECSRIRTN
  6369     CONTINUE.                                                    ECSRIRTN
  6370*  DUMMY PARAGRAPH - NO CODE NEEDED.                              ECSRIRTN
  6371 FIND-REI-CO-EXIT.                                                ECSRIRTN
  6372     EXIT.                                                        ECSRIRTN
  6373                                                                  ECSRIRTN
  6374 REIN-CO-TABLE-BUILD.                                             ECSRIRTN
  6375                                                                  ECSRIRTN
  6376     PERFORM ZERO-RCT-ENTRIES THRU ZERO-RCT-EXIT                  ECSRIRTN
  6377         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  6378                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  6379                                                                  ECSRIRTN
  6380     PERFORM ZERO-RC2-ENTRIES THRU ZERO-RC2-EXIT                  ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 124
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6381         VARYING CO-SUB FROM 1 BY 1                               ECSRIRTN
  6382                   UNTIL CO-SUB GREATER REIN-CO-TABLE-ENT-CNT.    ECSRIRTN
  6383                                                                  ECSRIRTN
  6384     MOVE LOW-VALUES          TO RE-CONTROL-PRIMARY.              ECSRIRTN
  6385                                                                  ECSRIRTN
  6386     START ERRTBL-IN                                              ECSRIRTN
  6387           KEY IS GREATER THAN RE-CONTROL-PRIMARY                 ECSRIRTN
  6388             INVALID KEY                                          ECSRIRTN
  6389               GO TO REIN-BUILD-EXIT.                             ECSRIRTN
  6390                                                                  ECSRIRTN
  6391     MOVE 0 TO CO-SUB.                                            ECSRIRTN
  6392     MOVE 0 TO SUB1.                                              ECSRIRTN
  6393 REIN-CO-BUILD-LOOP.                                              ECSRIRTN
  6394                                                                  ECSRIRTN
  6395     READ ERRTBL-IN  NEXT RECORD.                                 ECSRIRTN
  6396                                                                  ECSRIRTN
  6397     IF ERRTBL-FILE-STATUS = '10'                                 ECSRIRTN
  6398        GO TO REIN-BUILD-EXIT.                                    ECSRIRTN
  6399                                                                  ECSRIRTN
  6400     IF ERRTBL-FILE-STATUS NOT = ZERO                             ECSRIRTN
  6401        MOVE ERRTBL-FILE-STATUS TO WS-ABEND-FILE-STATUS           ECSRIRTN
  6402        MOVE 'READ ERROR ON FILE - ERRTBL'                        ECSRIRTN
  6403                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6404        GO TO ABEND-PGM.                                          ECSRIRTN
  6405                                                                  ECSRIRTN
  6406     IF RE-CODE NOT = 'B'                                         ECSRIRTN
  6407        GO TO REIN-CO-BUILD-LOOP.                                 ECSRIRTN
  6408                                                                  ECSRIRTN
  6409     IF RE-CLM-INCURRED-LIM NOT NUMERIC                           ECSRIRTN
  6410        MOVE ZERO TO RE-CLM-INCURRED-LIM.                         ECSRIRTN
  6411                                                                  ECSRIRTN
  6412     IF RE-EARNING-START-DT NOT NUMERIC                           ECSRIRTN
  6413        MOVE ZERO TO RE-EARNING-START-DT.                         ECSRIRTN
  6414                                                                  ECSRIRTN
  6415     IF RE-EARNING-STOP-DT NOT NUMERIC                            ECSRIRTN
  6416        MOVE ZERO TO RE-EARNING-STOP-DT.                          ECSRIRTN
  6417                                                                  ECSRIRTN
  6418     PERFORM VARYING CPSE-NDX FROM 1 BY 1 UNTIL CPSE-NDX > 1500   ECSRIRTN
  6419        MOVE RCT-CLM-CUTOFF-DT (CPSE-NDX)                         ECSRIRTN
*1118-E***************************************                         (   0)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6420                        TO  WS-RCT-CLM-CUTOFF-DT-N (CPSE-NDX)        CL*12
  6421        MOVE RCT-EARNING-START-DT (CPSE-NDX)                      ECSRIRTN
*1118-E******************************************                      ( 124)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6422                        TO  WS-RCT-EARNING-START-DT-N (CPSE-NDX)     CL*12
  6423        MOVE RCT-EARNING-STOP-DT (CPSE-NDX)                       ECSRIRTN
*1118-E*****************************************                       ( 124)**
**    Index-name belongs to different table - unexpected behaviour may occur
  6424                        TO  WS-RCT-EARNING-STOP-DT-N (CPSE-NDX)      CL*12
  6425     END-PERFORM.                                                 ECSRIRTN
  6426     MOVE RWF-EP-STOP-DATE       TO  WS-RWF-EP-STOP-DATE-N.          CL*12
  6427                                                                  ECSRIRTN
  6428     IF RE-LF-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  6429        MOVE ZERO TO RE-LF-CLM-PCT.                               ECSRIRTN
  6430                                                                  ECSRIRTN
  6431     IF RE-AH-CLM-PCT NOT NUMERIC                                 ECSRIRTN
  6432        MOVE ZERO TO RE-AH-CLM-PCT.                               ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 125
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6433                                                                  ECSRIRTN
  6434     IF RE-LF-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  6435        MOVE ZERO TO RE-LF-CLM-MAX.                               ECSRIRTN
  6436                                                                  ECSRIRTN
  6437     IF RE-AH-CLM-MAX NOT NUMERIC                                 ECSRIRTN
  6438        MOVE ZERO TO RE-AH-CLM-MAX.                               ECSRIRTN
  6439                                                                  ECSRIRTN
  6440     IF (RE-AH-CLM-MAX = ZERO) AND                                ECSRIRTN
  6441        (RE-LF-CLM-MAX = ZERO) AND                                ECSRIRTN
  6442        (RE-AH-CLM-PCT = ZERO) AND                                ECSRIRTN
  6443        (RE-LF-CLM-PCT = ZERO) AND                                ECSRIRTN
  6444        (RE-CLM-INCURRED-LIM = ZERO) AND                          ECSRIRTN
  6445        (RE-EARNING-START-DT = ZERO) AND                          ECSRIRTN
  6446        (RE-EARNING-STOP-DT = ZERO)                               ECSRIRTN
  6447          GO TO REIN-CO-BUILD-EPR.                                ECSRIRTN
  6448                                                                  ECSRIRTN
  6449     ADD +1 TO CO-SUB.                                            ECSRIRTN
  6450                                                                  ECSRIRTN
  6451     IF CO-SUB GREATER REIN-CO-TABLE-ENT-CNT                      ECSRIRTN
  6452        MOVE 0202 TO WS-RETURN-CODE                               ECSRIRTN
  6453        DISPLAY 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'         ECSRIRTN
  6454        DISPLAY 'ERROR DETECTED IN ECSRIRTN, SEE ECSRITAB'        ECSRIRTN
  6455        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  6456                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6457        GO TO ABEND-PGM.                                          ECSRIRTN
  6458                                                                  ECSRIRTN
  6459     MOVE RE-COMPANY           TO RCT-REIN-CO (CO-SUB).              CL**7
  6460                                                                  ECSRIRTN
  6461     MOVE RE-CLM-INCURRED-LIM  TO RCT-CLM-CUTOFF-DT (CO-SUB)      ECSRIRTN
  6462                               WS-RCT-CLM-CUTOFF-DT-N (CO-SUB).      CL*12
  6463     MOVE RE-EARNING-START-DT  TO RCT-EARNING-START-DT (CO-SUB)   ECSRIRTN
  6464                               WS-RCT-EARNING-START-DT-N (CO-SUB).   CL*12
  6465     MOVE RE-EARNING-STOP-DT   TO RCT-EARNING-STOP-DT (CO-SUB)    ECSRIRTN
  6466                               WS-RCT-EARNING-STOP-DT-N (CO-SUB).    CL*12
  6467                                                                  ECSRIRTN
  6468     IF RE-EARN-STOP-CODE = 'A'  OR  'L'                          ECSRIRTN
  6469         MOVE RE-EARN-STOP-CODE  TO RCT-EARN-STOP-CODE (CO-SUB)   ECSRIRTN
  6470     ELSE                                                         ECSRIRTN
  6471         MOVE 'B'                TO RCT-EARN-STOP-CODE (CO-SUB).  ECSRIRTN
  6472                                                                  ECSRIRTN
  6473     MOVE RE-LF-CLM-PCT  TO RCT-LF-CLM-PCT (CO-SUB).              ECSRIRTN
  6474     MOVE RE-AH-CLM-PCT  TO RCT-AH-CLM-PCT (CO-SUB).              ECSRIRTN
  6475     MOVE RE-LF-CLM-MAX  TO RCT-LF-CLM-MAX (CO-SUB).              ECSRIRTN
  6476     MOVE RE-AH-CLM-MAX  TO RCT-AH-CLM-MAX (CO-SUB).              ECSRIRTN
  6477                                                                  ECSRIRTN
  6478 REIN-CO-BUILD-EPR.                                               ECSRIRTN
  6479                                                                  ECSRIRTN
  6480     IF RE-AH-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  6481        MOVE ZERO TO RE-AH-PR-PCT.                                ECSRIRTN
  6482                                                                  ECSRIRTN
  6483     IF RE-AH-78-PCT  NOT NUMERIC                                 ECSRIRTN
  6484        MOVE ZERO TO RE-AH-78-PCT.                                ECSRIRTN
  6485                                                                  ECSRIRTN
  6486     IF RE-LF-PR-PCT  NOT NUMERIC                                 ECSRIRTN
  6487        MOVE ZERO TO RE-LF-PR-PCT.                                ECSRIRTN
  6488                                                                  ECSRIRTN
  6489     IF RE-LF-78-PCT  NOT NUMERIC                                 ECSRIRTN
  6490        MOVE ZERO TO RE-LF-78-PCT.                                ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 126
* ECS026P.cbl (/apps/prod/cid1p/copy/ECSRIRTN)
  6491                                                                  ECSRIRTN
  6492     ADD +1 TO SUB1.                                              ECSRIRTN
  6493                                                                  ECSRIRTN
  6494     IF SUB1 GREATER REIN-CO-TABLE-ENT-CNT                        ECSRIRTN
  6495        MOVE 0201 TO WS-RETURN-CODE                               ECSRIRTN
  6496        MOVE 'REINSURANCE COMPANY SAVE TABLE EXCEEDED'            ECSRIRTN
  6497                                  TO WS-ABEND-MESSAGE             ECSRIRTN
  6498        GO TO ABEND-PGM.                                          ECSRIRTN
  6499                                                                  ECSRIRTN
  6500     MOVE RE-COMPANY     TO RC2-REIN-CO    (SUB1).                ECSRIRTN
  6501     MOVE RE-AH-PR-PCT   TO RC2-AH-PRO-PCT (SUB1).                ECSRIRTN
  6502     MOVE RE-AH-78-PCT   TO RC2-AH-R78-PCT (SUB1).                ECSRIRTN
  6503     MOVE RE-LF-PR-PCT   TO RC2-LF-PRO-PCT (SUB1).                ECSRIRTN
  6504     MOVE RE-LF-78-PCT   TO RC2-LF-R78-PCT (SUB1).                ECSRIRTN
  6505     MOVE RE-NAME        TO RC2-CO-NAME    (SUB1).                ECSRIRTN
  6506     if re-state-exhibit-opt-f = 'Y'
  6507        move 'Y'         to rc2-ecs152-rpt (sub1)
  6508     else
  6509        move 'N'         to rc2-ecs152-rpt (sub1)
  6510     end-if
  6511                                                                  ECSRIRTN
  6512     GO TO REIN-CO-BUILD-LOOP.                                    ECSRIRTN
  6513                                                                  ECSRIRTN
  6514 REIN-BUILD-EXIT.                                                 ECSRIRTN
  6515     EXIT.                                                        ECSRIRTN
  6516                                                                  ECSRIRTN
  6517 ZERO-RCT-ENTRIES.                                                ECSRIRTN
  6518                                                                  ECSRIRTN
  6519     MOVE SPACES TO REIN-CO-HOLD-ENTRIES (CO-SUB).                ECSRIRTN
  6520                                                                  ECSRIRTN
  6521     MOVE ZERO   TO RCT-CLM-CUTOFF-DT (CO-SUB)                    ECSRIRTN
  6522                    WS-RCT-CLM-CUTOFF-DT-N (CO-SUB)                  CL*12
  6523                    RCT-EARNING-START-DT (CO-SUB)                 ECSRIRTN
  6524                    WS-RCT-EARNING-START-DT-N (CO-SUB)               CL*12
  6525                    RCT-EARNING-STOP-DT (CO-SUB)                  ECSRIRTN
  6526                    WS-RCT-EARNING-STOP-DT-N (CO-SUB)                CL*12
  6527                    RCT-LF-CLM-PCT    (CO-SUB)                    ECSRIRTN
  6528                    RCT-AH-CLM-PCT    (CO-SUB)                    ECSRIRTN
  6529                    RCT-LF-CLM-MAX    (CO-SUB)                    ECSRIRTN
  6530                    RCT-AH-CLM-MAX    (CO-SUB).                   ECSRIRTN
  6531                                                                  ECSRIRTN
  6532 ZERO-RCT-EXIT.                                                   ECSRIRTN
  6533     EXIT.                                                        ECSRIRTN
  6534                                                                  ECSRIRTN
  6535 ZERO-RC2-ENTRIES.                                                ECSRIRTN
  6536                                                                  ECSRIRTN
  6537     MOVE SPACES TO RC2-CO-NAME (CO-SUB)                          ECSRIRTN
  6538                    RC2-REIN-CO (CO-SUB).                         ECSRIRTN
  6539     move spaces      to rc2-ecs152-rpt (co-sub)
  6540                                                                  ECSRIRTN
  6541     MOVE ZERO   TO RC2-LF-R78-PCT    (CO-SUB)                    ECSRIRTN
  6542                    RC2-LF-PRO-PCT    (CO-SUB)                    ECSRIRTN
  6543                    RC2-AH-R78-PCT    (CO-SUB)                    ECSRIRTN
  6544                    RC2-AH-PRO-PCT    (CO-SUB).                   ECSRIRTN
  6545                                                                  ECSRIRTN
  6546 ZERO-RC2-EXIT.                                                   ECSRIRTN
  6547     EXIT.                                                        ECSRIRTN
  6548******************************************************************ECSRIRTN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 127
* ECS026P.cbl
  6549
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 128
* ECS026P.cbl
  6551 3000-PRODUCE-REPORTS.
  6552     PERFORM 3200-PROCESS-EXTRACTS THRU 3299-EXIT
  6553                                   UNTIL END-OF-EXTR.
  6554
  6555 3099-EXIT.
  6556     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 129
* ECS026P.cbl
  6558 3200-PROCESS-EXTRACTS.
  6559     IF EXTR-NEEDED
  6560         PERFORM 9300-READ-SORTED-FILE THRU 9399-EXIT.
  6561
  6562     IF WK-RPT-CODE = 'B' AND SWR-REPORT-CODE-1 = SPACES
  6563         GO TO 3299-EXIT.
  6564
  6565     IF WK-RPT-CODE = 'C' AND SWR-REPORT-CODE-2 = SPACES
  6566         GO TO 3299-EXIT.
  6567
  6568     IF WK-RPT-CODE = 'A'
  6569         MOVE  SWR-CARR          TO  CURR-CARR
  6570         MOVE  SWR-GROUP         TO  CURR-GRP
  6571         MOVE  SWR-STATE         TO  CURR-STATE
  6572         MOVE  SWR-ACCOUNT       TO  CURR-ACCT
  6573     ELSE
  6574     IF WK-RPT-CODE = 'B'
  6575         MOVE  SWR-REPORT-CODE-1 TO CURR-REPORT-CODE-1
  6576     ELSE
  6577     IF WK-RPT-CODE = 'C'
  6578         MOVE  SWR-CARR          TO  CURR-CARR
  6579         MOVE  SWR-GROUP         TO  CURR-GRP
  6580         MOVE  SWR-REPORT-CODE-2 TO  CURR-REPORT-CODE-2.
  6581
  6582     IF FIRST-TIME
  6583         MOVE  'N'               TO  FIRST-TIME-SW
  6584         MOVE  SWR-ACCT-NAME     TO  SAVE-ACCT-NAME
  6585         MOVE  SWR-CARR          TO  PREV-CARR CURR-CARR
  6586         MOVE  SWR-GROUP         TO  PREV-GRP CURR-GRP
  6587         MOVE  SWR-STATE         TO  PREV-STATE CURR-STATE
  6588         MOVE  SWR-ACCOUNT       TO  PREV-ACCT CURR-ACCT
  6589         MOVE  SWR-REPORT-CODE-1 TO  PREV-REPORT-CODE-1
  6590                                     CURR-REPORT-CODE-1
  6591         MOVE  SWR-REPORT-CODE-2 TO  PREV-REPORT-CODE-2
  6592                                     CURR-REPORT-CODE-2.
  6593
  6594     IF WK-RPT-CODE NOT = 'A'
  6595         GO TO 3220-CHECK-REPORT-B.
  6596
  6597     IF SWR-CONTROL = HIGH-VALUES
  6598         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6599         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6600         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
  6601         PERFORM 3700-CARR-BREAK  THRU  3749-EXIT
  6602         PERFORM 3750-FINAL-BREAK THRU  3799-EXIT
  6603         GO TO 3250-BUILD-CONTROL.
  6604
  6605     IF PREV-CARR NOT = CURR-CARR
  6606         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6607         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6608         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
  6609         PERFORM 3700-CARR-BREAK  THRU  3749-EXIT
  6610         GO TO 3250-BUILD-CONTROL.
  6611
  6612     IF PREV-GRP NOT = CURR-GRP
  6613         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6614         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6615         PERFORM 3600-GROUP-BREAK THRU  3699-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 130
* ECS026P.cbl
  6616         GO TO 3250-BUILD-CONTROL.
  6617
  6618     IF PREV-STATE NOT = CURR-STATE
  6619         PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT
  6620         PERFORM 3500-ST-BREAK    THRU  3599-EXIT
  6621         GO TO 3250-BUILD-CONTROL.
  6622
  6623     IF DTE-TOT-OPT = 1 OR 2
  6624       IF PREV-ACCT NOT = CURR-ACCT
  6625           PERFORM 3400-ACCT-BREAK  THRU  3499-EXIT.
  6626
  6627 3220-CHECK-REPORT-B.
  6628     IF WK-RPT-CODE = 'B'
  6629         IF PREV-REPORT-CODE-1 NOT = CURR-REPORT-CODE-1
  6630             PERFORM 3300-REPORT-BREAK THRU 3399-EXIT.
  6631
  6632     IF WK-RPT-CODE = 'C'
  6633         IF PREV-REPORT-CODE-2 NOT = CURR-REPORT-CODE-2 OR
  6634            PREV-CARR          NOT = CURR-CARR          OR
  6635            PREV-GRP           NOT = CURR-GRP
  6636             PERFORM 3300-REPORT-BREAK THRU 3399-EXIT.
  6637
  6638 3250-BUILD-CONTROL.
  6639     IF SWR-CONTROL = HIGH-VALUES
  6640         GO TO 3299-EXIT.
  6641
  6642     PERFORM  3800-ACCUMULATE-FOR-CONTROL  THRU  3899-EXIT.
  6643
  6644     MOVE  'Y'                   TO EXTR-NEEDED-SW.
  6645     MOVE CURR-CARR              TO PREV-CARR.
  6646     MOVE CURR-STATE             TO PREV-STATE.
  6647     MOVE CURR-GRP               TO PREV-GRP.
  6648     MOVE CURR-ACCT              TO PREV-ACCT.
  6649     MOVE SWR-ACCT-NAME          TO SAVE-ACCT-NAME.
  6650     MOVE CURR-REPORT-CODE-1     TO PREV-REPORT-CODE-1.
  6651     MOVE CURR-REPORT-CODE-2     TO PREV-REPORT-CODE-2.
  6652
  6653 3299-EXIT.
  6654     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 131
* ECS026P.cbl
  6656 3300-REPORT-BREAK.
  6657     MOVE '1' TO WK-BREAK-TYPE.
  6658
  6659     IF WK-RPT-CODE = 'D'
  6660         PERFORM 3900-ACCUMULATE-FOR-BREAK THRU 3999-EXIT.
  6661
  6662     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6663     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6664     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6665     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6666
  6667 3399-EXIT.
  6668      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 132
* ECS026P.cbl
  6670 3400-ACCT-BREAK.
  6671     MOVE '1' TO WK-BREAK-TYPE.
  6672     PERFORM 3900-ACCUMULATE-FOR-BREAK THRU 3999-EXIT.
  6673
  6674     IF DTE-TOT-OPT = 1 OR 2
  6675         PERFORM 4000-CREATE-PRINT-TABLE THRU 4099-EXIT
  6676         PERFORM 4500-PRINT-A-PAGE       THRU 4599-EXIT.
  6677
  6678     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6679     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6680
  6681 3499-EXIT.
  6682      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 133
* ECS026P.cbl
  6684 3500-ST-BREAK.
  6685     MOVE '2' TO WK-BREAK-TYPE.
  6686     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6687     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6688     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6689     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6690     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6691
  6692 3599-EXIT.
  6693      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 134
* ECS026P.cbl
  6695 3600-GROUP-BREAK.
  6696     MOVE '3' TO WK-BREAK-TYPE.
  6697     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6698     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6699     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6700     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6701     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6702
  6703 3699-EXIT.
  6704      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 135
* ECS026P.cbl
  6706 3700-CARR-BREAK.
  6707     MOVE '4' TO WK-BREAK-TYPE.
  6708     PERFORM 3900-ACCUMULATE-FOR-BREAK    THRU 3999-EXIT.
  6709     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6710     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6711     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6712     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6713
  6714 3749-EXIT.
  6715      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 136
* ECS026P.cbl
  6717 3750-FINAL-BREAK.
  6718     MOVE '5' TO WK-BREAK-TYPE.
  6719     PERFORM 4000-CREATE-PRINT-TABLE      THRU 4099-EXIT.
  6720     PERFORM 4500-PRINT-A-PAGE            THRU 4599-EXIT.
  6721     PERFORM 6500-CLEAR-ACCUMULATOR-TABLE THRU 6599-EXIT.
  6722     PERFORM 6700-CLEAR-PRINT-TABLE       THRU 6799-EXIT.
  6723
  6724 3799-EXIT.
  6725      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 137
* ECS026P.cbl
  6727 3800-ACCUMULATE-FOR-CONTROL.
  6728     PERFORM  3830-ACCUM-LOOP  THRU  3839-EXIT
  6729         VARYING  A-SUB1  FROM  1  BY  1
  6730           UNTIL  A-SUB1  GREATER  3
  6731         AFTER  A-SUB2  FROM  1  BY  1
  6732         UNTIL  A-SUB2  GREATER  7.
  6733
  6734     GO TO 3899-EXIT.
  6735
  6736 3830-ACCUM-LOOP.
  6737     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  6738                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  6739
  6740     ADD SWR-FACE-BEN    (A-SUB1  A-SUB2)  TO WA-FACE-BEN.
  6741     ADD SWR-ISS-PRM     (A-SUB1  A-SUB2)  TO WA-ISS-PRM.
  6742     ADD SWR-CNC-PRM     (A-SUB1  A-SUB2)  TO WA-CNC-PRM.
  6743     ADD SWR-EARNED-PRM  (A-SUB1  A-SUB2)  TO WA-EARNED-PRM.
  6744     ADD SWR-CLAIM-AMT   (A-SUB1  A-SUB2)  TO WA-CLAIM-AMT.
  6745     ADD SWR-CERT-COUNT  (A-SUB1  A-SUB2)  TO WA-CERT-COUNT.
  6746     ADD SWR-CLAIM-COUNT (A-SUB1  A-SUB2)  TO WA-CLAIM-COUNT.
  6747     ADD SWR-NUMBER-DAYS (A-SUB1  A-SUB2)  TO WA-NUMBER-DAYS.
  6748     ADD SWR-CRT-W-CLM   (A-SUB1  A-SUB2)  TO WA-CRT-W-CLM.
  6749
  6750     MOVE  WORK-AREA-FOR-ACCUMULATOR
  6751                                 TO  AT-AMOUNTS (A-SUB1  A-SUB2).
  6752
  6753 3839-EXIT.
  6754     EXIT.
  6755
  6756 3899-EXIT.
  6757     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 138
* ECS026P.cbl
  6759 3900-ACCUMULATE-FOR-BREAK.
  6760     PERFORM  3930-ACCUM-LOOP  THRU  3939-EXIT
  6761         VARYING  A-SUB1  FROM  1  BY  1
  6762           UNTIL  A-SUB1  GREATER  3
  6763         AFTER  A-SUB2  FROM  1  BY  1
  6764          UNTIL A-SUB2  GREATER  7.
  6765
  6766     GO TO 3999-EXIT.
  6767
  6768 3930-ACCUM-LOOP.
  6769     IF ACCOUNT-BREAK
  6770         ADD AT-FACE-BEN (A-SUB1 A-SUB2)
  6771                               TO  AT2-FACE-BEN (A-SUB1 A-SUB2)
  6772         ADD AT-ISS-PRM (A-SUB1 A-SUB2)
  6773                               TO  AT2-ISS-PRM (A-SUB1 A-SUB2)
  6774         ADD AT-CNC-PRM (A-SUB1 A-SUB2)
  6775                               TO  AT2-CNC-PRM (A-SUB1 A-SUB2)
  6776         ADD AT-EARNED-PRM (A-SUB1 A-SUB2)
  6777                               TO  AT2-EARNED-PRM (A-SUB1 A-SUB2)
  6778         ADD AT-CLAIM-AMT (A-SUB1 A-SUB2)
  6779                               TO  AT2-CLAIM-AMT (A-SUB1 A-SUB2)
  6780         ADD AT-CERT-COUNT (A-SUB1 A-SUB2)
  6781                               TO  AT2-CERT-COUNT (A-SUB1 A-SUB2)
  6782         ADD AT-CLAIM-COUNT (A-SUB1 A-SUB2)
  6783                               TO  AT2-CLAIM-COUNT (A-SUB1 A-SUB2)
  6784         ADD AT-NUMBER-DAYS (A-SUB1 A-SUB2)
  6785                               TO  AT2-NUMBER-DAYS (A-SUB1 A-SUB2)
  6786         ADD AT-CRT-W-CLM (A-SUB1 A-SUB2)
  6787                               TO  AT2-CRT-W-CLM (A-SUB1 A-SUB2)
  6788     ELSE
  6789     IF STATE-BREAK
  6790         ADD AT2-FACE-BEN (A-SUB1 A-SUB2)
  6791                               TO  AT3-FACE-BEN (A-SUB1 A-SUB2)
  6792         ADD AT2-ISS-PRM (A-SUB1 A-SUB2)
  6793                               TO  AT3-ISS-PRM (A-SUB1 A-SUB2)
  6794         ADD AT2-CNC-PRM (A-SUB1 A-SUB2)
  6795                               TO  AT3-CNC-PRM (A-SUB1 A-SUB2)
  6796         ADD AT2-EARNED-PRM (A-SUB1 A-SUB2)
  6797                               TO  AT3-EARNED-PRM (A-SUB1 A-SUB2)
  6798         ADD AT2-CLAIM-AMT (A-SUB1 A-SUB2)
  6799                               TO  AT3-CLAIM-AMT (A-SUB1 A-SUB2)
  6800         ADD AT2-CERT-COUNT (A-SUB1 A-SUB2)
  6801                               TO  AT3-CERT-COUNT (A-SUB1 A-SUB2)
  6802         ADD AT2-CLAIM-COUNT (A-SUB1 A-SUB2)
  6803                               TO  AT3-CLAIM-COUNT (A-SUB1 A-SUB2)
  6804         ADD AT2-NUMBER-DAYS (A-SUB1 A-SUB2)
  6805                               TO  AT3-NUMBER-DAYS (A-SUB1 A-SUB2)
  6806         ADD AT2-CRT-W-CLM (A-SUB1 A-SUB2)
  6807                               TO  AT3-CRT-W-CLM (A-SUB1 A-SUB2)
  6808     ELSE
  6809     IF GROUP-BREAK
  6810         ADD AT3-FACE-BEN (A-SUB1 A-SUB2)
  6811                               TO  AT4-FACE-BEN (A-SUB1 A-SUB2)
  6812         ADD AT3-ISS-PRM (A-SUB1 A-SUB2)
  6813                               TO  AT4-ISS-PRM (A-SUB1 A-SUB2)
  6814         ADD AT3-CNC-PRM (A-SUB1 A-SUB2)
  6815                               TO  AT4-CNC-PRM (A-SUB1 A-SUB2)
  6816         ADD AT3-EARNED-PRM (A-SUB1 A-SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 139
* ECS026P.cbl
  6817                               TO  AT4-EARNED-PRM (A-SUB1 A-SUB2)
  6818         ADD AT3-CLAIM-AMT (A-SUB1 A-SUB2)
  6819                               TO  AT4-CLAIM-AMT (A-SUB1 A-SUB2)
  6820         ADD AT3-CERT-COUNT (A-SUB1 A-SUB2)
  6821                               TO  AT4-CERT-COUNT (A-SUB1 A-SUB2)
  6822         ADD AT3-CLAIM-COUNT (A-SUB1 A-SUB2)
  6823                               TO  AT4-CLAIM-COUNT (A-SUB1 A-SUB2)
  6824         ADD AT3-NUMBER-DAYS (A-SUB1 A-SUB2)
  6825                               TO  AT4-NUMBER-DAYS (A-SUB1 A-SUB2)
  6826         ADD AT3-CRT-W-CLM (A-SUB1 A-SUB2)
  6827                               TO  AT4-CRT-W-CLM (A-SUB1 A-SUB2)
  6828     ELSE
  6829     IF CARRIER-BREAK
  6830         ADD AT4-FACE-BEN (A-SUB1 A-SUB2)
  6831                               TO  AT5-FACE-BEN (A-SUB1 A-SUB2)
  6832         ADD AT4-ISS-PRM (A-SUB1 A-SUB2)
  6833                               TO  AT5-ISS-PRM (A-SUB1 A-SUB2)
  6834         ADD AT4-CNC-PRM (A-SUB1 A-SUB2)
  6835                               TO  AT5-CNC-PRM (A-SUB1 A-SUB2)
  6836         ADD AT4-EARNED-PRM (A-SUB1 A-SUB2)
  6837                               TO  AT5-EARNED-PRM (A-SUB1 A-SUB2)
  6838         ADD AT4-CLAIM-AMT (A-SUB1 A-SUB2)
  6839                               TO  AT5-CLAIM-AMT (A-SUB1 A-SUB2)
  6840         ADD AT4-CERT-COUNT (A-SUB1 A-SUB2)
  6841                               TO  AT5-CERT-COUNT (A-SUB1 A-SUB2)
  6842         ADD AT4-CLAIM-COUNT (A-SUB1 A-SUB2)
  6843                               TO  AT5-CLAIM-COUNT (A-SUB1 A-SUB2)
  6844         ADD AT4-NUMBER-DAYS (A-SUB1 A-SUB2)
  6845                               TO  AT5-NUMBER-DAYS (A-SUB1 A-SUB2)
  6846         ADD AT4-CRT-W-CLM (A-SUB1 A-SUB2)
  6847                               TO  AT5-CRT-W-CLM (A-SUB1 A-SUB2).
  6848
  6849 3939-EXIT.
  6850     EXIT.
  6851
  6852 3999-EXIT.
  6853     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 140
* ECS026P.cbl
  6855 4000-CREATE-PRINT-TABLE.
  6856     PERFORM  4020-CALC-PRINT-TOTALS  THRU  4029-EXIT
  6857         VARYING  A-SUB1  FROM  1  BY  1
  6858           UNTIL  A-SUB1  GREATER  3
  6859         AFTER  A-SUB2  FROM  1  BY  1
  6860          UNTIL A-SUB2  GREATER  7.
  6861
  6862     PERFORM  4050-CALC-PRINT-PRCNTS  THRU  4059-EXIT
  6863         VARYING  P-SUB1  FROM  1  BY  1
  6864           UNTIL  P-SUB1  GREATER  4
  6865         AFTER  P-SUB2  FROM  1  BY  1
  6866          UNTIL P-SUB2  GREATER  8.
  6867
  6868     PERFORM  4080-CALC-PRINT-AVERAGES  THRU  4089-EXIT
  6869         VARYING  P-SUB1  FROM  1  BY  1
  6870           UNTIL  P-SUB1  GREATER  3
  6871         AFTER  P-SUB2  FROM  1  BY  1
  6872          UNTIL P-SUB2  GREATER  8.
  6873
  6874     GO TO 4099-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 141
* ECS026P.cbl
  6876 4020-CALC-PRINT-TOTALS.
  6877     MOVE  A-SUB1                TO  P-SUB1.
  6878     MOVE  A-SUB2                TO  P-SUB2.
  6879
  6880     IF ACCOUNT-BREAK
  6881         MOVE AT-AMOUNTS (A-SUB1 A-SUB2)
  6882                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6883     ELSE
  6884     IF STATE-BREAK
  6885         MOVE AT2-AMOUNTS (A-SUB1 A-SUB2)
  6886                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6887     ELSE
  6888     IF GROUP-BREAK
  6889         MOVE AT3-AMOUNTS (A-SUB1 A-SUB2)
  6890                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6891     ELSE
  6892     IF CARRIER-BREAK
  6893         MOVE AT4-AMOUNTS (A-SUB1 A-SUB2)
  6894                                 TO  WORK-AREA-FOR-ACCUMULATOR
  6895     ELSE
  6896         MOVE AT5-AMOUNTS (A-SUB1 A-SUB2)
  6897                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  6898
  6899     ADD  WA-ISS-PRM         TO  PT-GROSS-PRM (P-SUB1  P-SUB2)
  6900                                 PT-GROSS-PRM (P-SUB1  8)
  6901                                 PT-GROSS-PRM (4  P-SUB2)
  6902                                 PT-GROSS-PRM (4  8).
  6903
  6904     ADD  WA-CNC-PRM         TO  PT-CNC-PRM (P-SUB1  P-SUB2)
  6905                                 PT-CNC-PRM (P-SUB1  8)
  6906                                 PT-CNC-PRM (4  P-SUB2)
  6907                                 PT-CNC-PRM (4  8).
  6908
  6909     ADD  WA-EARNED-PRM      TO  PT-EARNED-PRM (P-SUB1  P-SUB2)
  6910                                 PT-EARNED-PRM (P-SUB1  8)
  6911                                 PT-EARNED-PRM (4  P-SUB2)
  6912                                 PT-EARNED-PRM (4  8).
  6913
  6914     ADD  WA-CLAIM-AMT       TO  PT-CLAIMS (P-SUB1  P-SUB2)
  6915                                 PT-CLAIMS (P-SUB1  8)
  6916                                 PT-CLAIMS (4  P-SUB2)
  6917                                 PT-CLAIMS (4  8).
  6918
  6919     COMPUTE  NET-PREMIUM  = WA-ISS-PRM - WA-CNC-PRM.
  6920
  6921     ADD  NET-PREMIUM        TO  PT-NET-PRM (P-SUB1  P-SUB2)
  6922                                 PT-NET-PRM (P-SUB1  8)
  6923                                 PT-NET-PRM (4  P-SUB2)
  6924                                 PT-NET-PRM (4  8).
  6925
  6926     ADD  WA-FACE-BEN        TO  PT-FACE-BEN (P-SUB1  P-SUB2)
  6927                                 PT-FACE-BEN (P-SUB1  8).
  6928
  6929     ADD  WA-CERT-COUNT      TO  PT-CERT-COUNT (P-SUB1  P-SUB2)
  6930                                 PT-CERT-COUNT (P-SUB1  8).
  6931
  6932     ADD  WA-CLAIM-COUNT     TO  PT-CLAIM-COUNT (P-SUB1  P-SUB2)
  6933                                 PT-CLAIM-COUNT (P-SUB1  8).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 142
* ECS026P.cbl
  6934
  6935     ADD  WA-NUMBER-DAYS     TO  PT-NUMBER-DAYS (P-SUB1  P-SUB2)
  6936                                 PT-NUMBER-DAYS (P-SUB1  8).
  6937
  6938     ADD  WA-CRT-W-CLM       TO  PT-CRT-W-CLM (P-SUB1  P-SUB2)
  6939                                 PT-CRT-W-CLM (P-SUB1  8).
  6940
  6941 4029-EXIT.
  6942     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 143
* ECS026P.cbl
  6944 4050-CALC-PRINT-PRCNTS.
  6945     IF  PT-EARNED-PRM (P-SUB1  P-SUB2)  = +0
  6946         MOVE  +0.0          TO  PT-EL-RATIO (P-SUB1  P-SUB2)
  6947     ELSE
  6948         COMPUTE  PT-EL-RATIO (P-SUB1  P-SUB2)  ROUNDED  =
  6949                                PT-CLAIMS (P-SUB1  P-SUB2)  /
  6950                                PT-EARNED-PRM (P-SUB1  P-SUB2).
  6951
  6952     IF  PT-GROSS-PRM (P-SUB1  8)  = +0
  6953         MOVE  +0            TO  PT-PRCNT-PRM (P-SUB1  P-SUB2)
  6954     ELSE
  6955         COMPUTE  PT-PRCNT-PRM (P-SUB1  P-SUB2)  ROUNDED  =
  6956                               PT-GROSS-PRM (P-SUB1  P-SUB2)  /
  6957                               PT-GROSS-PRM (P-SUB1  8).
  6958
  6959     IF  PT-CLAIMS (P-SUB1  8)  = +0
  6960         MOVE  +0            TO  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)
  6961     ELSE
  6962         COMPUTE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  ROUNDED  =
  6963                               PT-CLAIMS (P-SUB1  P-SUB2)  /
  6964                               PT-CLAIMS (P-SUB1  8).
  6965
  6966     IF  PT-GROSS-PRM (P-SUB1  P-SUB2)  = +0
  6967         MOVE  +0            TO  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)
  6968     ELSE
  6969         COMPUTE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  ROUNDED  =
  6970                               PT-CNC-PRM   (P-SUB1  P-SUB2)  /
  6971                               PT-GROSS-PRM (P-SUB1  P-SUB2).
  6972
  6973 4059-EXIT.
  6974     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 144
* ECS026P.cbl
  6976 4080-CALC-PRINT-AVERAGES.
  6977     IF  PT-CERT-COUNT (P-SUB1  P-SUB2)  = +0
  6978         MOVE  +0            TO  PT-AVG-LOAN (P-SUB1  P-SUB2)
  6979     ELSE
  6980         COMPUTE  PT-AVG-LOAN (P-SUB1  P-SUB2)  ROUNDED  =
  6981                              PT-FACE-BEN (P-SUB1  P-SUB2)  /
  6982                              PT-CERT-COUNT (P-SUB1  P-SUB2).
  6983
  6984     IF  PT-CLAIM-COUNT (P-SUB1  P-SUB2)  = +0
  6985         MOVE  +0            TO  PT-AVG-CLAIM (P-SUB1  P-SUB2)
  6986     ELSE
  6987         COMPUTE  PT-AVG-CLAIM (P-SUB1  P-SUB2)  ROUNDED  =
  6988                              PT-CLAIMS (P-SUB1  P-SUB2)  /
  6989                              PT-CLAIM-COUNT (P-SUB1  P-SUB2).
  6990
  6991     IF  PT-CRT-W-CLM (P-SUB1  P-SUB2)  = +0
  6992         MOVE  +0            TO  PT-AVG-DAYS (P-SUB1  P-SUB2)
  6993     ELSE
  6994         COMPUTE  PT-AVG-DAYS (P-SUB1  P-SUB2)  ROUNDED  =
  6995                              PT-NUMBER-DAYS (P-SUB1  P-SUB2)  /
  6996                              PT-CRT-W-CLM (P-SUB1  P-SUB2).
  6997
  6998 4089-EXIT.
  6999     EXIT.
  7000
  7001 4099-EXIT.
  7002     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 145
* ECS026P.cbl
  7004 4500-PRINT-A-PAGE.
  7005     PERFORM  7000-HEADING-ROUTINE  THRU  7099-EXIT.
  7006
  7007     PERFORM  4510-PRINT-REPORT-SECTIONS  THRU  4514-EXIT
  7008         VARYING  P-SUB1  FROM  1  BY  1
  7009           UNTIL  P-SUB1  GREATER  4.
  7010
  7011     GO TO 4599-EXIT.
  7012
  7013 4510-PRINT-REPORT-SECTIONS.
  7014     IF P-SUB1 = 1
  7015         MOVE  'SINGLE'          TO  H7-DESC1-7
  7016         MOVE LIFE-OVERRIDE-L12  TO  H7-DESC8-20.
  7017
  7018     IF P-SUB1 = 2
  7019         MOVE  'JOINT'           TO  H7-DESC1-7
  7020         MOVE LIFE-OVERRIDE-L12  TO  H7-DESC8-20.
  7021
  7022     IF P-SUB1 = 3
  7023         MOVE  AH-OVERRIDE-L12   TO  H7-DESC.
  7024
  7025     IF P-SUB1 = 4
  7026         MOVE  'COMBINED TOTALS'  TO  H7-DESC.
  7027
  7028     MOVE  '0'                   TO  X.
  7029     MOVE  HEADING-7             TO  P-DATA.
  7030     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7031
  7032     MOVE  'GROSS PREMIUM'       TO  DL-DESC.
  7033
  7034     PERFORM  4515-LOAD-GROSS-PRM  THRU  4519-EXIT
  7035         VARYING  P-SUB2  FROM  1  BY  1
  7036           UNTIL  P-SUB2  GREATER 8.
  7037
  7038     MOVE  DETAIL-LINE           TO  P-DATA.
  7039     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7040
  7041     MOVE  ' '                   TO  X.
  7042     MOVE  'REFUNDS'             TO  DL-DESC.
  7043
  7044     PERFORM  4520-LOAD-CNC-PRM  THRU  4524-EXIT
  7045         VARYING  P-SUB2  FROM  1  BY  1
  7046           UNTIL  P-SUB2  GREATER  8.
  7047
  7048     MOVE  DETAIL-LINE           TO  P-DATA.
  7049     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7050
  7051     MOVE  'NET PREMIUM'         TO  DL-DESC.
  7052
  7053     PERFORM  4525-LOAD-NET-PRM  THRU  4529-EXIT
  7054         VARYING  P-SUB2  FROM  1  BY  1
  7055           UNTIL  P-SUB2  GREATER 8.
  7056
  7057     MOVE  DETAIL-LINE           TO  P-DATA.
  7058     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7059
  7060     MOVE  'EARNED PREMIUM'      TO  DL-DESC.
  7061
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 146
* ECS026P.cbl
  7062     PERFORM  4530-LOAD-EARNED-PRM  THRU  4534-EXIT
  7063         VARYING  P-SUB2  FROM  1  BY  1
  7064           UNTIL  P-SUB2  GREATER 8.
  7065
  7066     MOVE  DETAIL-LINE           TO  P-DATA.
  7067     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7068
  7069     MOVE  'CLAIMS PAID'         TO  DL-DESC.
  7070
  7071     PERFORM  4535-LOAD-CLAIMS  THRU  4539-EXIT
  7072         VARYING  P-SUB2  FROM  1  BY  1
  7073           UNTIL  P-SUB2  GREATER 8.
  7074
  7075     MOVE  DETAIL-LINE           TO  P-DATA.
  7076     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7077
  7078     MOVE  'EARN/LOSS RATIO'     TO  DL-DESC.
  7079
  7080     PERFORM  4540-LOAD-EL-RATIO  THRU  4544-EXIT
  7081         VARYING  P-SUB2  FROM  1  BY  1
  7082           UNTIL  P-SUB2  GREATER 8.
  7083
  7084     MOVE  DETAIL-LINE           TO  P-DATA.
  7085     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7086
  7087     MOVE  '% PREMIUM BY AGE'    TO  DL-DESC.
  7088
  7089     PERFORM  4545-LOAD-PRCNT-PRM  THRU  4549-EXIT
  7090         VARYING  P-SUB2  FROM  1  BY  1
  7091           UNTIL  P-SUB2  GREATER 8.
  7092
  7093     MOVE  DETAIL-LINE           TO  P-DATA.
  7094     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7095
  7096     MOVE  '% CLAIMS BY AGE'     TO  DL-DESC.
  7097
  7098     PERFORM  4550-LOAD-PRCNT-CLAIM  THRU  4554-EXIT
  7099         VARYING  P-SUB2  FROM  1  BY  1
  7100           UNTIL  P-SUB2  GREATER 8.
  7101
  7102     MOVE  DETAIL-LINE           TO  P-DATA.
  7103     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7104
  7105     MOVE  '% REFUNDS TO GROSS'  TO  DL-DESC.
  7106
  7107     PERFORM  4555-LOAD-PRCNT-CNC-G  THRU  4559-EXIT
  7108         VARYING  P-SUB2  FROM  1  BY  1
  7109           UNTIL  P-SUB2  GREATER 8.
  7110
  7111     MOVE  DETAIL-LINE           TO  P-DATA.
  7112     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7113
  7114     if p-sub1 = 1 OR 2
  7115        move ' CERTIFICATE COUNT '
  7116                                 TO DL-DESC
  7117        perform varying p-sub2 from 1 by 1 until
  7118          (p-sub2 > 8)
  7119          compute round-up-dollars roundED =
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 147
* ECS026P.cbl
  7120            PT-CERT-COUNT (P-SUB1 P-SUB2) * 1
  7121          move round-up-dollars  to dl-amt1 (p-sub2)
  7122        end-perform
  7123        MOVE  DETAIL-LINE        TO  P-DATA
  7124        PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7125     end-if
  7126
  7127*    if p-sub1 = 4
  7128*       move ' CERTIFICATE COUNT '
  7129*                                TO DL-DESC
  7130*       perform varying p-sub2 from 1 by 1 until
  7131*         (p-sub2 > 8)
  7132*         compute round-up-dollars roundED =
  7133*           (pt-cert-count (1 p-sub2)
  7134*           + PT-CERT-COUNT (2 P-SUB2)) * 1
  7135*         move round-up-dollars  to dl-amt1 (p-sub2)
  7136*       end-perform
  7137*       MOVE  DETAIL-LINE        TO  P-DATA
  7138*       PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7139*    end-if
  7140
  7141     IF P-SUB1 = 4
  7142         GO TO 4514-EXIT.
  7143
  7144     IF P-SUB1 = 1
  7145         MOVE  'AVG INITIAL EXPOSURE'  TO  DL-DESC
  7146         PERFORM  4560-LOAD-AVG-LOAN  THRU  4564-EXIT
  7147             VARYING  P-SUB2  FROM  1  BY  1
  7148               UNTIL  P-SUB2  GREATER 8
  7149         MOVE  DETAIL-LINE             TO  P-DATA
  7150         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7151
  7152     IF P-SUB1 = 1 OR 2
  7153         MOVE  'AVG. CLAIM PAID'  TO  DL-DESC
  7154         PERFORM  4565-LOAD-AVG-CLAIM  THRU  4569-EXIT
  7155             VARYING  P-SUB2  FROM  1  BY  1
  7156               UNTIL  P-SUB2  GREATER 8
  7157         MOVE  DETAIL-LINE        TO  P-DATA
  7158         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7159
  7160     IF P-SUB1 = 3
  7161         MOVE  'AVG. DAYS INDEMNITY'  TO  DL-DESC
  7162         PERFORM  4570-LOAD-AVG-DAYS  THRU  4574-EXIT
  7163             VARYING  P-SUB2  FROM  1  BY  1
  7164               UNTIL  P-SUB2  GREATER 8
  7165         MOVE  DETAIL-LINE            TO  P-DATA
  7166         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7167
  7168 4514-EXIT.
  7169     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 148
* ECS026P.cbl
  7171 4515-LOAD-GROSS-PRM.
  7172     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7173              PT-GROSS-PRM (P-SUB1  P-SUB2)  *  1.
  7174
  7175     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7176
  7177 4519-EXIT.
  7178     EXIT.
  7179
  7180 4520-LOAD-CNC-PRM.
  7181     COMPUTE  PT-CNC-PRM (P-SUB1 P-SUB2)  =
  7182              PT-CNC-PRM (P-SUB1 P-SUB2)  *  -1.
  7183
  7184     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7185              PT-CNC-PRM (P-SUB1  P-SUB2)  *  1.
  7186
  7187     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7188
  7189 4524-EXIT.
  7190     EXIT.
  7191
  7192 4525-LOAD-NET-PRM.
  7193     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7194              PT-NET-PRM (P-SUB1  P-SUB2)  *  1.
  7195
  7196     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7197
  7198 4529-EXIT.
  7199     EXIT.
  7200
  7201 4530-LOAD-EARNED-PRM.
  7202     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7203              PT-EARNED-PRM (P-SUB1  P-SUB2)  *  1.
  7204
  7205     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7206
  7207 4534-EXIT.
  7208     EXIT.
  7209
  7210 4535-LOAD-CLAIMS.
  7211     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7212              PT-CLAIMS (P-SUB1  P-SUB2)  *  1.
  7213
  7214     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7215
  7216 4539-EXIT.
  7217     EXIT.
  7218
  7219 4540-LOAD-EL-RATIO.
  7220     COMPUTE  PT-EL-RATIO (P-SUB1  P-SUB2)  =
  7221              PT-EL-RATIO (P-SUB1  P-SUB2)  *  100.
  7222
  7223     MOVE  PT-EL-RATIO (P-SUB1  P-SUB2)
  7224                                 TO  DL-AMT (P-SUB2).
  7225
  7226 4544-EXIT.
  7227     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 149
* ECS026P.cbl
  7229 4545-LOAD-PRCNT-PRM.
  7230     COMPUTE  PT-PRCNT-PRM (P-SUB1  P-SUB2)  =
  7231              PT-PRCNT-PRM (P-SUB1  P-SUB2)  *  100.
  7232
  7233     MOVE  PT-PRCNT-PRM (P-SUB1  P-SUB2)
  7234                                 TO  DL-AMT (P-SUB2).
  7235
  7236 4549-EXIT.
  7237     EXIT.
  7238
  7239 4550-LOAD-PRCNT-CLAIM.
  7240     COMPUTE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  =
  7241              PT-PRCNT-CLAIM (P-SUB1  P-SUB2)  *  100.
  7242
  7243     MOVE  PT-PRCNT-CLAIM (P-SUB1  P-SUB2)
  7244                                 TO  DL-AMT (P-SUB2).
  7245
  7246 4554-EXIT.
  7247     EXIT.
  7248
  7249 4555-LOAD-PRCNT-CNC-G.
  7250     COMPUTE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  =
  7251              PT-PRCNT-CNC-G (P-SUB1  P-SUB2)  *  100.
  7252
  7253     MOVE  PT-PRCNT-CNC-G (P-SUB1  P-SUB2)
  7254                                 TO  DL-AMT (P-SUB2).
  7255
  7256 4559-EXIT.
  7257     EXIT.
  7258
  7259 4560-LOAD-AVG-LOAN.
  7260     COMPUTE  ROUND-UP-DOLLARS ROUNDED  =
  7261              PT-AVG-LOAN (P-SUB1  P-SUB2)  *  1.
  7262
  7263     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7264
  7265 4564-EXIT.
  7266     EXIT.
  7267
  7268 4565-LOAD-AVG-CLAIM.
  7269     COMPUTE  ROUND-UP-DOLLARS  ROUNDED  =
  7270              PT-AVG-CLAIM (P-SUB1  P-SUB2)  *  1.
  7271
  7272     MOVE  ROUND-UP-DOLLARS      TO  DL-AMT2 (P-SUB2).
  7273
  7274 4569-EXIT.
  7275     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 150
* ECS026P.cbl
  7277 4570-LOAD-AVG-DAYS.
  7278     MOVE  PT-AVG-DAYS (P-SUB1  P-SUB2)
  7279                                 TO  DL-AMT1 (P-SUB2).
  7280
  7281 4574-EXIT.
  7282     EXIT.
  7283
  7284 4599-EXIT.
  7285     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 151
* ECS026P.cbl
  7287 5000-PRODUCE-D-REPORT.
  7288     PERFORM 9400-READ-REIN-FILE THRU 9499-EXIT.
  7289
  7290     MOVE SWR2-REIN-COMP  TO CURR-REIN-COMP.
  7291     MOVE SWR2-CARR       TO CURR-CARR.
  7292
  7293     IF FIRST-TIME
  7294         MOVE CURR-REIN-COMP   TO PREV-REIN-COMP
  7295         MOVE CURR-CARR        TO PREV-CARR
  7296         MOVE SWR2-REINS-TABLE TO PREV-REINS-TABLE
  7297         MOVE 'N'              TO FIRST-TIME-SW.
  7298
  7299     IF PREV-REIN-COMP NOT = CURR-REIN-COMP
  7300         PERFORM 5300-GET-REINS-NAME THRU 5399-EXIT
  7301         PERFORM 3300-REPORT-BREAK   THRU 3399-EXIT
  7302         PERFORM 3500-ST-BREAK       THRU 3599-EXIT
  7303     ELSE
  7304     IF PREV-CARR NOT = CURR-CARR
  7305         PERFORM 5300-GET-REINS-NAME THRU 5399-EXIT
  7306         PERFORM 3300-REPORT-BREAK   THRU 3399-EXIT.
  7307
  7308     IF END-OF-EXTR
  7309         GO TO 5099-EXIT.
  7310
  7311     PERFORM 5100-ACCUMULATE-FROM-REIN THRU 5199-EXIT.
  7312
  7313     MOVE CURR-REIN-COMP   TO PREV-REIN-COMP.
  7314     MOVE CURR-CARR        TO PREV-CARR.
  7315     MOVE SWR2-REINS-TABLE TO PREV-REINS-TABLE.
  7316
  7317 5099-EXIT.
  7318      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 152
* ECS026P.cbl
  7320
  7321 5100-ACCUMULATE-FROM-REIN.
  7322     IF SWR2-AGE GREATER +60
  7323         MOVE  +7                TO  A-SUB2.
  7324
  7325     IF SWR2-AGE LESS +61
  7326         MOVE  +6                TO  A-SUB2.
  7327
  7328     IF SWR2-AGE LESS +56
  7329         MOVE  +5                TO  A-SUB2.
  7330
  7331     IF SWR2-AGE LESS +51
  7332         MOVE  +4                TO  A-SUB2.
  7333
  7334     IF SWR2-AGE LESS +46
  7335         MOVE  +3                TO  A-SUB2.
  7336
  7337     IF SWR2-AGE LESS +41
  7338         MOVE  +2                TO  A-SUB2.
  7339
  7340     IF SWR2-AGE LESS +31
  7341         MOVE  +1                TO  A-SUB2.
  7342
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 153
* ECS026P.cbl
  7344 5110-ACCUMULATE-LIFE.
  7345     IF SWR2-LFTYP = ZERO
  7346         GO TO 5150-ACCUMULATE-AH.
  7347
  7348     IF DTE-PRC-OPT = 5
  7349         IF SWR2-LF-CURRENT-STATUS = '1' OR '2' OR '3' OR
  7350                                     '4' OR '5' OR '9'
  7351         NEXT SENTENCE
  7352        ELSE
  7353         GO TO 5150-ACCUMULATE-AH.
  7354
  7355     MOVE  SWR2-LFTYP            TO  CLAS-LOOK.
  7356
  7357     PERFORM  0900-FIND-LIFE-TYPE  THRU  0950-EXIT.
  7358
  7359     IF CLAS-I-JOINT (CLAS-INDEXL) = 'J'
  7360         MOVE  +2                TO  A-SUB1
  7361     ELSE
  7362         MOVE  +1                TO  A-SUB1.
  7363
  7364     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  7365                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  7366
  7367     IF SWR2-ENTRY-STATUS = '5'
  7368         MOVE  +0                TO  SWR2-LFAMT
  7369                                     SWR2-LFPRM.
  7370
  7371     ADD  SWR2-LFAMT             TO  WA-FACE-BEN.
  7372     ADD  SWR2-LFPRM             TO  WA-ISS-PRM.
  7373     ADD  SWR2-LFRFND            TO  WA-CNC-PRM.
  7374     ADD  SWR2-DTHAMT            TO  WA-CLAIM-AMT.
  7375     ADD  +1                     TO  WA-CERT-COUNT.
  7376     ADD  SWR2-NUM-DTH-CLM       TO  WA-CLAIM-COUNT.
  7377
  7378     MOVE  ZERO                  TO  WA-NUMBER-DAYS.
  7379
  7380     IF SWR2-DTHAMT NOT = ZERO
  7381         ADD  +1                 TO  WA-CRT-W-CLM.
  7382
  7383 5115-ADD-LIFE-EARN.
  7384     MOVE ZEROS           TO  EARNED-PREMIUM.
  7385     MOVE SWR2-LF-EPR-78  TO  LF-EPR-R78.
  7386     MOVE SWR2-LF-EPR-PR  TO  LF-EPR-PRO.
  7387
  7388     IF DTE-CLIENT = 'FIM'
  7389         PERFORM 5500-CHECK-PCT  THRU  5599-EXIT.
  7390
  7391     IF DTE-CLIENT = 'FFL'
  7392         MOVE +.005 TO FAC-1.
  7393
  7394     IF DTE-CLIENT = 'FIM'
  7395         MOVE +.015 TO FAC-1.
  7396
  7397     MOVE FAC-1 TO WS-FAC.
  7398
  7399     IF DTE-CLIENT = 'FIM'
  7400         MOVE FAC-3          TO WS-FAC
  7401         MOVE LF-PRO         TO WS-PRO
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 154
* ECS026P.cbl
  7402         MOVE LF-R78         TO WS-R78.
  7403
  7404     IF DTE-CLIENT = 'FIM'
  7405         IF WS-PRO = ZERO  AND  WS-R78 = ZERO
  7406             IF CLAS-I-EP  (CLAS-INDEXL) = 'P'  OR
  7407                STATE-ABBR (CLAS-INDEXS) = 'WY'
  7408                 MOVE +1.00      TO WS-PRO
  7409             ELSE
  7410                 MOVE +1.00      TO WS-R78.
  7411
  7412     IF CLAS-I-EP (CLAS-INDEXL) = 'U'
  7413         MOVE 'R' TO CLAS-I-EP (CLAS-INDEXL).
  7414
  7415     IF DTE-CLIENT = 'FIA'  AND
  7416        SWR2-CARR = 'A' OR 'B'
  7417         COMPUTE EARNED-PREMIUM = (LF-EPR-PRO + LF-EPR-R78) / +2
  7418         GO TO 5115-CONT.
  7419
  7420     IF DTE-CLIENT = 'FIM'
  7421         COMPUTE EARNED-PREMIUM =
  7422              (LF-EPR-PRO * WS-PRO) + (LF-EPR-R78 * WS-R78)
  7423         GO TO 5115-CONT.
  7424
  7425     IF DTE-CLIENT = 'GIC'
  7426         COMPUTE EARNED-PREMIUM =
  7427                  (LF-EPR-PRO * +.80) + (LF-EPR-R78 * +.20)
  7428         GO TO 5115-CONT.
  7429
  7430     IF CLAS-I-EP (CLAS-INDEXL) = '1'
  7431         COMPUTE EARNED-PREMIUM =
  7432                 (LF-EPR-PRO * +.6667) + (LF-EPR-R78 * +.3333)
  7433         GO TO 5115-CONT.
  7434
  7435     IF CLAS-I-EP (CLAS-INDEXL) = 'M'
  7436         COMPUTE EARNED-PREMIUM =
  7437                 (LF-EPR-PRO + LF-EPR-R78) / +2
  7438         GO TO 5115-CONT.
  7439
  7440     IF CLAS-I-EP  (CLAS-INDEXL) = 'P'   OR
  7441        STATE-ABBR (CLAS-INDEXS) = 'WY'  OR
  7442        DTE-CLIENT = 'SLC'
  7443          MOVE LF-EPR-PRO TO EARNED-PREMIUM
  7444          GO TO 5115-CONT.
  7445
  7446     IF CLAS-I-EP (CLAS-INDEXL) = 'R' OR 'T' OR 'N' OR 'A' OR 'B'
  7447         MOVE LF-EPR-R78 TO EARNED-PREMIUM.
  7448
  7449 5115-CONT.
  7450     ADD EARNED-PREMIUM          TO WA-EARNED-PRM.
  7451
  7452     MOVE WORK-AREA-FOR-ACCUMULATOR
  7453                                 TO AT-AMOUNTS (A-SUB1  A-SUB2).
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 155
* ECS026P.cbl
  7455 5150-ACCUMULATE-AH.
  7456     IF SWR2-AHTYP = ZERO
  7457         GO TO 5199-EXIT.
  7458
  7459     IF DTE-PRC-OPT = 5
  7460         IF SWR2-AH-CURRENT-STATUS = '1' OR '2' OR '3' OR
  7461                                     '4' OR '5' OR '9'
  7462           NEXT SENTENCE
  7463         ELSE
  7464           GO TO 5199-EXIT.
  7465
  7466     MOVE  +3                    TO  A-SUB1.
  7467     MOVE  AT-AMOUNTS (A-SUB1  A-SUB2)
  7468                                 TO  WORK-AREA-FOR-ACCUMULATOR.
  7469
  7470     IF SWR2-ENTRY-STATUS = '5'
  7471         MOVE +0                 TO  SWR2-AHAMT
  7472                                     SWR2-AHPRM.
  7473
  7474     COMPUTE AH-TOTAL-AMT = SWR2-AHAMT * SWR2-AH-TERM.
  7475
  7476     ADD  AH-TOTAL-AMT           TO  WA-FACE-BEN.
  7477     ADD  SWR2-AHPRM             TO  WA-ISS-PRM.
  7478     ADD  SWR2-AHRFND            TO  WA-CNC-PRM.
  7479     ADD  SWR2-DISAMT            TO  WA-CLAIM-AMT.
  7480     ADD  +1                     TO  WA-CERT-COUNT.
  7481     ADD  SWR2-NUM-DIS-CLM       TO  WA-CLAIM-COUNT.
  7482
  7483     IF SWR2-DISAMT NOT = ZEROS AND
  7484        SWR2-AHAMT  NOT = ZEROS
  7485         COMPUTE PER-DAY-BENEFIT   ROUNDED = SWR2-AHAMT / 30
  7486         COMPUTE NO-DAYS-THIS-CERT ROUNDED = SWR2-DISAMT
  7487                                             / PER-DAY-BENEFIT
  7488         ADD  +1                 TO  WA-CRT-W-CLM
  7489         ADD  NO-DAYS-THIS-CERT  TO  WA-NUMBER-DAYS.
  7490
  7491 5155-ADD-AH-EARN.
  7492     MOVE ZEROS           TO  EARNED-PREMIUM.
  7493     MOVE SWR2-AH-EPR-78  TO  AH-EPR-R78.
  7494     MOVE SWR2-AH-EPR-PR  TO  AH-EPR-PRO.
  7495
  7496     IF DTE-CLIENT = 'FIM'
  7497         PERFORM 5500-CHECK-PCT  THRU  5599-EXIT.
  7498
  7499     IF DTE-CLIENT = 'FFL'
  7500         MOVE ZEROS TO FAC-2.
  7501
  7502     IF DTE-CLIENT = 'FIM'
  7503         MOVE +.025 TO FAC-2.
  7504
  7505     MOVE FAC-2 TO WS-FAC.
  7506
  7507     IF DTE-CLIENT = 'FIM'
  7508         MOVE FAC-4          TO WS-FAC
  7509         MOVE AH-PRO         TO WS-PRO
  7510         MOVE AH-R78         TO WS-R78.
  7511
  7512     IF DTE-CLIENT = 'FIM'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 156
* ECS026P.cbl
  7513         IF WS-PRO = ZERO  AND  WS-R78 = ZERO
  7514            IF CLAS-I-EP  (CLAS-INDEXA) = 'P'  OR
  7515               STATE-ABBR (CLAS-INDEXS) = 'WY'
  7516                 MOVE +1.00      TO WS-PRO
  7517             ELSE
  7518                 MOVE +1.00      TO WS-R78.
  7519
  7520     IF DTE-CLIENT = 'FIA'  AND
  7521        SWR2-CARR = 'A' OR 'B'
  7522          COMPUTE EARNED-PREMIUM = (AH-EPR-PRO + AH-EPR-R78) / +2
  7523          GO TO 5155-CONT.
  7524
  7525     IF DTE-CLIENT = 'FIM'
  7526         COMPUTE EARNED-PREMIUM =
  7527              (AH-EPR-PRO * WS-PRO) + (AH-EPR-R78 * WS-R78)
  7528         GO TO 5155-CONT.
  7529
  7530     IF DTE-CLIENT = 'GIC'
  7531         IF CLAS-I-BAL (CLAS-INDEXA) NOT = 'B'
  7532             COMPUTE EARNED-PREMIUM =
  7533                  (AH-EPR-PRO * +.80) + (AH-EPR-R78 * +.20)
  7534             GO TO 5155-CONT.
  7535
  7536     IF CLAS-I-EP (CLAS-INDEXA) = '1'  OR
  7537        (DTE-CLIENT = 'ITY' AND (SWR2-CARR = '5' OR '7'))
  7538             COMPUTE EARNED-PREMIUM =
  7539            (AH-EPR-PRO * +.6667) + (AH-EPR-R78 * +.3333)
  7540             GO TO 5155-CONT.
  7541
  7542     IF CLAS-I-EP  (CLAS-INDEXA) = 'M'
  7543          COMPUTE EARNED-PREMIUM =
  7544                  (AH-EPR-PRO + AH-EPR-R78) / +2
  7545          GO TO 5155-CONT.
  7546
  7547     IF CLAS-I-EP  (CLAS-INDEXA) = 'P'   OR
  7548        STATE-ABBR (CLAS-INDEXS) = 'WY'  OR
  7549        DTE-CLIENT = 'SLC'               OR
  7550       (DTE-CLIENT = 'ITY' AND SWR2-CARR = '2')
  7551          MOVE AH-EPR-PRO TO EARNED-PREMIUM
  7552          GO TO 5155-CONT.
  7553
  7554     IF CLAS-I-EP (CLAS-INDEXA) = 'R'  OR  'A'
  7555        IF (DTE-CLIENT = 'POS' AND SWR2-CARR = '2')   OR
  7556           (DTE-CLIENT = 'FIM')
  7557              COMPUTE EARNED-PREMIUM =
  7558                  ((AH-EPR-PRO + AH-EPR-R78) / +2)
  7559          ELSE
  7560             MOVE AH-EPR-R78 TO EARNED-PREMIUM.
  7561
  7562 5155-CONT.
  7563     ADD  EARNED-PREMIUM         TO  WA-EARNED-PRM.
  7564
  7565     MOVE  WORK-AREA-FOR-ACCUMULATOR
  7566                             TO  AT-AMOUNTS (A-SUB1  A-SUB2).
  7567
  7568 5199-EXIT.
  7569     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 157
* ECS026P.cbl
  7571
  7572 5300-GET-REINS-NAME.
  7573      MOVE 0 TO CO-SUB.
  7574
  7575 5300-GET-NAME-LOOP.
  7576      ADD +1 TO CO-SUB.
  7577      IF PREV-REIN-COMP = RC2-CO-PRIME (CO-SUB)
  7578          MOVE RC2-CO-NAME (CO-SUB) TO SAVE-REIN-NAME
  7579          GO TO 5399-EXIT
  7580      ELSE
  7581      IF RC2-CO-PRIME (CO-SUB) = SPACES
  7582          MOVE SPACES TO SAVE-REIN-NAME
  7583          GO TO 5399-EXIT
  7584      ELSE
  7585          GO TO 5300-GET-NAME-LOOP.
  7586
  7587 5399-EXIT.
  7588     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 158
* ECS026P.cbl
  7590 5500-CHECK-PCT.
  7591     IF FIRST-READ
  7592         MOVE ZEROS            TO CO-SUB
  7593                                  LF-PRO LF-R78 AH-PRO AH-R78
  7594         MOVE 'N'              TO FIRST-READ-SW
  7595         GO TO 5500-LOOP.
  7596
  7597     IF SWR2-REIN-COMP = PREV-REIN-COMP
  7598         GO TO 5599-EXIT.
  7599
  7600 5500-LOOP.
  7601      ADD +1 TO CO-SUB.
  7602      IF SWR2-REIN-COMP = RC2-CO-PRIME (CO-SUB)
  7603          MOVE RC2-LF-R78-PCT (CO-SUB) TO LF-R78
  7604          MOVE RC2-LF-PRO-PCT (CO-SUB) TO LF-PRO
  7605          MOVE RC2-AH-R78-PCT (CO-SUB) TO AH-R78
  7606          MOVE RC2-AH-PRO-PCT (CO-SUB) TO AH-PRO
  7607          GO TO 5599-EXIT
  7608      ELSE
  7609      IF RC2-CO-PRIME (CO-SUB) = SPACES
  7610          GO TO 5599-EXIT
  7611      ELSE
  7612          GO TO 5500-LOOP.
  7613
  7614 5599-EXIT.
  7615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 159
* ECS026P.cbl
  7617 6500-CLEAR-ACCUMULATOR-TABLE.
  7618     PERFORM  6530-CLEAR-LOOP  THRU  6539-EXIT
  7619         VARYING  A-SUB2  FROM  1  BY  1
  7620           UNTIL  A-SUB2  GREATER  7.
  7621
  7622     IF ACCOUNT-BREAK
  7623         MOVE AT-AMOUNTS-L-D (1) TO  AT-AMOUNTS-L-D (2)
  7624                                     AT-AMOUNTS-L-D (3)
  7625     ELSE
  7626     IF STATE-BREAK
  7627         MOVE AT2-AMOUNTS-L-D (1) TO  AT2-AMOUNTS-L-D (2)
  7628                                      AT2-AMOUNTS-L-D (3)
  7629     ELSE
  7630     IF GROUP-BREAK
  7631         MOVE AT3-AMOUNTS-L-D (1) TO  AT3-AMOUNTS-L-D (2)
  7632                                      AT3-AMOUNTS-L-D (3)
  7633     ELSE
  7634     IF CARRIER-BREAK
  7635         MOVE AT4-AMOUNTS-L-D (1) TO  AT4-AMOUNTS-L-D (2)
  7636                                      AT4-AMOUNTS-L-D (3)
  7637     ELSE
  7638         MOVE AT5-AMOUNTS-L-D (1) TO  AT5-AMOUNTS-L-D (2)
  7639                                      AT5-AMOUNTS-L-D (3).
  7640
  7641     GO TO 6599-EXIT.
  7642
  7643 6530-CLEAR-LOOP.
  7644     IF ACCOUNT-BREAK
  7645         MOVE +0                 TO  AT-FACE-BEN    (1 A-SUB2)
  7646                                     AT-ISS-PRM     (1 A-SUB2)
  7647                                     AT-CNC-PRM     (1 A-SUB2)
  7648                                     AT-EARNED-PRM  (1 A-SUB2)
  7649                                     AT-CLAIM-AMT   (1 A-SUB2)
  7650                                     AT-CERT-COUNT  (1 A-SUB2)
  7651                                     AT-CLAIM-COUNT (1 A-SUB2)
  7652                                     AT-NUMBER-DAYS (1 A-SUB2)
  7653                                     AT-CRT-W-CLM   (1 A-SUB2)
  7654     ELSE
  7655     IF STATE-BREAK
  7656         MOVE +0                 TO  AT2-FACE-BEN    (1 A-SUB2)
  7657                                     AT2-ISS-PRM     (1 A-SUB2)
  7658                                     AT2-CNC-PRM     (1 A-SUB2)
  7659                                     AT2-EARNED-PRM  (1 A-SUB2)
  7660                                     AT2-CLAIM-AMT   (1 A-SUB2)
  7661                                     AT2-CERT-COUNT  (1 A-SUB2)
  7662                                     AT2-CLAIM-COUNT (1 A-SUB2)
  7663                                     AT2-NUMBER-DAYS (1 A-SUB2)
  7664                                     AT2-CRT-W-CLM   (1 A-SUB2)
  7665     ELSE
  7666     IF GROUP-BREAK
  7667         MOVE +0                 TO  AT3-FACE-BEN    (1 A-SUB2)
  7668                                     AT3-ISS-PRM     (1 A-SUB2)
  7669                                     AT3-CNC-PRM     (1 A-SUB2)
  7670                                     AT3-EARNED-PRM  (1 A-SUB2)
  7671                                     AT3-CLAIM-AMT   (1 A-SUB2)
  7672                                     AT3-CERT-COUNT  (1 A-SUB2)
  7673                                     AT3-CLAIM-COUNT (1 A-SUB2)
  7674                                     AT3-NUMBER-DAYS (1 A-SUB2)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 160
* ECS026P.cbl
  7675                                     AT3-CRT-W-CLM   (1 A-SUB2)
  7676     ELSE
  7677     IF CARRIER-BREAK
  7678         MOVE +0                 TO  AT4-FACE-BEN    (1 A-SUB2)
  7679                                     AT4-ISS-PRM     (1 A-SUB2)
  7680                                     AT4-CNC-PRM     (1 A-SUB2)
  7681                                     AT4-EARNED-PRM  (1 A-SUB2)
  7682                                     AT4-CLAIM-AMT   (1 A-SUB2)
  7683                                     AT4-CERT-COUNT  (1 A-SUB2)
  7684                                     AT4-CLAIM-COUNT (1 A-SUB2)
  7685                                     AT4-NUMBER-DAYS (1 A-SUB2)
  7686                                     AT4-CRT-W-CLM   (1 A-SUB2)
  7687     ELSE
  7688         MOVE +0                 TO  AT5-FACE-BEN    (1 A-SUB2)
  7689                                     AT5-ISS-PRM     (1 A-SUB2)
  7690                                     AT5-CNC-PRM     (1 A-SUB2)
  7691                                     AT5-EARNED-PRM  (1 A-SUB2)
  7692                                     AT5-CLAIM-AMT   (1 A-SUB2)
  7693                                     AT5-CERT-COUNT  (1 A-SUB2)
  7694                                     AT5-CLAIM-COUNT (1 A-SUB2)
  7695                                     AT5-NUMBER-DAYS (1 A-SUB2)
  7696                                     AT5-CRT-W-CLM   (1 A-SUB2).
  7697
  7698 6539-EXIT.
  7699     EXIT.
  7700
  7701 6599-EXIT.
  7702     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 161
* ECS026P.cbl
  7704 6700-CLEAR-PRINT-TABLE.
  7705     PERFORM  6730-CLEAR-LOOP  THRU  6739-EXIT
  7706         VARYING  P-SUB2  FROM  1  BY  1
  7707           UNTIL  P-SUB2  GREATER  8.
  7708
  7709     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (2).
  7710     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (3).
  7711     MOVE  PT-AMOUNTS-L-D (1)    TO  PT-AMOUNTS-L-D (4).
  7712
  7713     GO TO 6799-EXIT.
  7714
  7715 6730-CLEAR-LOOP.
  7716     MOVE  +0                    TO  PT-FACE-BEN    (1 P-SUB2)
  7717                                     PT-CERT-COUNT  (1 P-SUB2)
  7718                                     PT-CLAIM-COUNT (1 P-SUB2)
  7719                                     PT-NUMBER-DAYS (1 P-SUB2)
  7720                                     PT-GROSS-PRM   (1 P-SUB2)
  7721                                     PT-CNC-PRM     (1 P-SUB2)
  7722                                     PT-NET-PRM     (1 P-SUB2)
  7723                                     PT-EARNED-PRM  (1 P-SUB2)
  7724                                     PT-CLAIMS      (1 P-SUB2)
  7725                                     PT-EL-RATIO    (1 P-SUB2)
  7726                                     PT-PRCNT-PRM   (1 P-SUB2)
  7727                                     PT-PRCNT-CLAIM (1 P-SUB2)
  7728                                     PT-PRCNT-CNC-G (1 P-SUB2)
  7729                                     PT-AVG-LOAN    (1 P-SUB2)
  7730                                     PT-AVG-CLAIM   (1 P-SUB2)
  7731                                     PT-AVG-DAYS    (1 P-SUB2)
  7732                                     PT-CRT-W-CLM   (1 P-SUB2).
  7733
  7734 6739-EXIT.
  7735     EXIT.
  7736
  7737 6799-EXIT.
  7738     EXIT.
  7739
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 162
* ECS026P.cbl
  7741 7000-HEADING-ROUTINE.
  7742     MOVE  WK-RPT-CODE           TO  H1-RPT-CODE.
  7743     MOVE  '1'                   TO  X.
  7744     MOVE  HEADING-1             TO  P-DATA.
  7745     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7746
  7747     MOVE  ' '                   TO  X.
  7748     MOVE  HEADING-2             TO  P-DATA.
  7749     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7750
  7751     MOVE  HEADING-3             TO  P-DATA.
  7752     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7753
  7754     MOVE  SPACES                TO  P-DATA.
  7755     PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
  7756
  7757     IF WK-RPT-CODE NOT = 'A'
  7758         GO TO 7020-CHECK-REPORT-B.
  7759
  7760     IF WK-BREAK-TYPE = '5'
  7761         MOVE FINAL-HEADING  TO P-DATA
  7762         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7763         MOVE SPACES       TO P-DATA
  7764         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 3 TIMES
  7765         GO TO 7099-EXIT.
  7766
  7767     MOVE PREV-CARR        TO CH-CARR-NO
  7768                              CARRIER-L.
  7769     PERFORM 7800-LOAD-CARRIER-NAME THRU 7899-EXIT.
  7770
  7771     MOVE CARRIER-HEADING  TO P-DATA.
  7772     PERFORM 7700-PRINT-RTN THRU 7799-EXIT.
  7773
  7774     IF WK-BREAK-TYPE = '4'
  7775         MOVE SPACES TO P-DATA
  7776         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 3 TIMES
  7777     ELSE
  7778     IF WK-BREAK-TYPE = '3'
  7779         MOVE PREV-GRP      TO GH-GROUP-NO
  7780         MOVE GROUP-HEADING TO P-DATA
  7781         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7782         MOVE SPACES        TO P-DATA
  7783         PERFORM 7700-PRINT-RTN THRU 7799-EXIT 2 TIMES
  7784     ELSE
  7785     IF WK-BREAK-TYPE = '2'
  7786         MOVE PREV-GRP      TO GH-GROUP-NO
  7787         MOVE GROUP-HEADING TO P-DATA
  7788         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7789         MOVE PREV-STATE    TO SH-STATE-NO  STATE-L
  7790         PERFORM 7900-LOAD-STATE-NAME THRU 7999-EXIT
  7791         MOVE STATE-HEADING TO P-DATA
  7792         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7793         MOVE SPACES        TO P-DATA
  7794         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7795     ELSE
  7796         MOVE PREV-GRP        TO GH-GROUP-NO
  7797         MOVE GROUP-HEADING   TO P-DATA
  7798         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 163
* ECS026P.cbl
  7799         MOVE PREV-STATE      TO SH-STATE-NO  STATE-L
  7800         PERFORM 7900-LOAD-STATE-NAME THRU 7999-EXIT
  7801         MOVE STATE-HEADING   TO P-DATA
  7802         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7803         MOVE PREV-ACCT       TO AH-ACCT-NO
  7804         MOVE SAVE-ACCT-NAME  TO AH-ACCT-NAME
  7805         MOVE ACCOUNT-HEADING TO P-DATA
  7806         PERFORM 7700-PRINT-RTN THRU 7799-EXIT.
  7807
  7808 7020-CHECK-REPORT-B.
  7809     IF WK-RPT-CODE  = 'B'
  7810         MOVE  CLAS-REPORT-CD1-CAPTION TO RC1H-CAPTION
  7811         MOVE  PREV-REPORT-CODE-1      TO RC1H-CODE
  7812         MOVE  REPORT-CODE-1-HEADING   TO  P-DATA
  7813         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7814         MOVE  SPACES                  TO  P-DATA
  7815         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 3 TIMES.
  7816
  7817     IF WK-RPT-CODE   = 'C'
  7818         MOVE  PREV-CARR         TO  CH-CARR-NO  CARRIER-L
  7819         PERFORM  7800-LOAD-CARRIER-NAME  THRU  7899-EXIT
  7820         MOVE  CARRIER-HEADING   TO  P-DATA
  7821         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7822         MOVE PREV-GRP           TO GH-GROUP-NO
  7823         MOVE GROUP-HEADING      TO P-DATA
  7824         PERFORM 7700-PRINT-RTN THRU 7799-EXIT
  7825         MOVE  CLAS-REPORT-CD2-CAPTION TO RC2H-CAPTION
  7826         MOVE  PREV-REPORT-CODE-2      TO RC2H-CODE
  7827         MOVE  REPORT-CODE-2-HEADING   TO  P-DATA
  7828         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7829         MOVE  SPACES            TO  P-DATA
  7830         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 164
* ECS026P.cbl
  7832     IF WK-RPT-CODE   = 'D'
  7833         MOVE PREV-REIN-COMP      TO RH-COMP-NO
  7834         MOVE SAVE-REIN-NAME      TO RH-COMP-NAME
  7835         MOVE REINSURANCE-HEADING TO P-DATA
  7836         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7837       IF WK-BREAK-TYPE = '1'
  7838         MOVE  PREV-CARR         TO  CH-CARR-NO  CARRIER-L
  7839         PERFORM  7800-LOAD-CARRIER-NAME  THRU  7899-EXIT
  7840         MOVE  CARRIER-HEADING   TO  P-DATA
  7841         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT
  7842         MOVE SPACES             TO P-DATA
  7843         PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 2 TIMES
  7844         IF WK-BREAK-TYPE = '2'
  7845           MOVE SPACES             TO P-DATA
  7846           PERFORM  7700-PRINT-RTN  THRU  7799-EXIT 3 TIMES.
  7847
  7848 7099-EXIT.
  7849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 165
* ECS026P.cbl
  7851 7700-PRINT-RTN.
* 7852                             COPY ELCPRT2.
  7853******************************************************************04/15/98
  7854*                                                                *ELCPRT2
  7855*                                                                *ELCPRT2
  7856*                            ELCPRT2                             *   LV005
  7857*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**5
  7858*                            VMOD=2.002                          *   CL**5
  7859*                                                                *   CL**4
  7860******************************************************************   CL**4
  7861                                                                     CL**4
  7862     IF DTE-FICH NOT = SPACE AND                                     CL**4
  7863        FICH-OPEN    = SPACE                                         CL**4
  7864         MOVE 'X'                TO  FICH-OPEN                       CL**4
  7865         OPEN OUTPUT FICH.                                           CL**4
  7866                                                                     CL**4
  7867     IF DTE-FICH NOT = SPACE                                         CL**4
  7868         MOVE X                  TO  P-CTL                           CL**4
  7869         WRITE FICH-REC FROM PRT.                                    CL**4
  7870                                                                     CL**4
  7871     IF DTE-FICH = SPACE OR '2'                                      CL**4
  7872       MOVE X                    TO  P-CTL                           CL**4
  7873       IF P-CTL = ' '                                                CL**4
  7874         WRITE PRT AFTER ADVANCING 1 LINE                            CL**4
  7875       ELSE                                                          CL**4
  7876         IF P-CTL = '0'                                              CL**4
  7877           WRITE PRT AFTER ADVANCING 2 LINES                         CL**4
  7878         ELSE                                                        CL**4
  7879           IF P-CTL = '-'                                            CL**4
  7880             WRITE PRT AFTER ADVANCING 3 LINES                       CL**4
  7881           ELSE                                                      CL**4
  7882             WRITE PRT AFTER ADVANCING PAGE.                         CL**4
  7883                                                                     CL**4
  7884******************************************************************   CL**4
  7885
  7886 7799-EXIT.
  7887     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 166
* ECS026P.cbl
  7889 7800-LOAD-CARRIER-NAME.
  7890     MOVE  ALL  '$'              TO  CH-CARR-NA.
  7891
  7892     IF CARRIER-SUB (1)  = SPACE
  7893         GO TO 7899-EXIT.
  7894
  7895     MOVE  +0                    TO  S1.
  7896
  7897 7810-LOAD-CARRIER-LOOP.
  7898     ADD  +1                     TO  S1.
  7899
  7900     IF S1 GREATER  CLAS-MAXCN
  7901         GO TO 7899-EXIT.
  7902
  7903     IF CARRIER-L  = CARRIER-SUB (S1)
  7904         MOVE  CARRIER-PIC (S1)  TO  CH-CARR-NA
  7905         GO TO 7899-EXIT.
  7906
  7907     GO TO 7810-LOAD-CARRIER-LOOP.
  7908
  7909 7899-EXIT.
  7910     EXIT.
  7911
  7912 7900-LOAD-STATE-NAME.
  7913     MOVE  ALL  '$'              TO  SH-STATE-NAME.
  7914     MOVE  ZERO                  TO  CLAS-INDEXS.
  7915
  7916 7920-LOAD-STATE-LOOP.
  7917     ADD  1                      TO  CLAS-INDEXS.
  7918
  7919     IF CLAS-INDEXS  GREATER  CLAS-MAXS
  7920         GO TO 7999-EXIT.
  7921
  7922     IF STATE-L  NOT = STATE-SUB (CLAS-INDEXS)
  7923         GO TO 7920-LOAD-STATE-LOOP.
  7924
  7925     MOVE  STATE-PIC (CLAS-INDEXS)  TO  SH-STATE-NAME.
  7926
  7927 7999-EXIT.
  7928     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 167
* ECS026P.cbl
  7930 8000-RELEASE-SORT-WORK.
  7931     MOVE  SORT-WORK-REC         TO  SORT-REC.
  7932
  7933     RELEASE  SORT-REC.
  7934
  7935 8099-EXIT.
  7936     EXIT.
  7937
  7938******************************************************************
  7939***    E A R N E D   P R E M I U M   C A L C U L A T I O N S   ***
  7940******************************************************************
  7941
  7942 8200-EP-BUMP-RTN.
  7943     MOVE CR-LFAMT       TO WE-LFAMT.
  7944     MOVE CR-LFPRM       TO WE-LFPRM.
  7945
  7946     IF CR-LFTYP NOT = ZEROS
  7947         IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  7948             MOVE CR-LFAMT-ALT        TO WE-LFAMT-ALT
  7949             MOVE CR-LFPRM-ALT        TO WE-LFPRM-ALT
  7950         ELSE
  7951             MOVE ZEROS               TO WE-LFAMT-ALT
  7952                                         WE-LFPRM-ALT.
  7953
  7954     MOVE CR-LFRFND      TO WE-LFRFND.
  7955
  7956     MOVE CR-AHPRM       TO WE-AHPRM.
  7957     MOVE CR-AHAMT       TO WE-AHAMT.
  7958     MOVE CR-AHRFND      TO WE-AHRFND.
  7959
  7960     IF CR-POLICY-IS-RESTORE  OR
  7961        CR-POLICY-IS-REISSUE
  7962         MOVE ZEROS      TO WE-LFAMT  WE-LFAMT-ALT
  7963                            WE-LFPRM  WE-LFPRM-ALT
  7964                            WE-AHAMT  WE-AHPRM.
  7965
  7966 8299-EXIT.
  7967     EXIT.
  7968
  7969 8350-EP-LF-REINSURE.
  7970     MOVE SWR2-LFPRM     TO WE-LFPRM.
  7971     MOVE SWR2-LFAMT     TO WE-LFAMT.
  7972     MOVE +0             TO WE-LFAMT-ALT
  7973                            WE-LFPRM-ALT.
  7974     MOVE SWR2-LFRFND    TO WE-LFRFND.
  7975
  7976     IF SWR2-LF-CURRENT-STATUS = '3' OR '5'
  7977         MOVE ZEROS      TO WE-LFPRM
  7978                            WE-AHPRM.
  7979
  7980 8359-EXIT.
  7981     EXIT.
  7982
  7983 8360-EP-AH-REINSURE.
  7984     MOVE SWR2-AHPRM     TO WE-AHPRM.
  7985     MOVE SWR2-AHAMT     TO WE-AHAMT
  7986     MOVE SWR2-AHRFND    TO WE-AHRFND.
  7987
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 168
* ECS026P.cbl
  7988     IF SWR2-AH-CURRENT-STATUS = '3' OR '5'
  7989         MOVE ZEROS      TO WE-LFPRM
  7990                            WE-AHPRM.
  7991
  7992 8369-EXIT.
  7993     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 169
* ECS026P.cbl
  7995******************************************************************
  7996***  C A L C U L A T E   L I F E   E A R N E D   P R E M I U M ***
  7997******************************************************************
  7998
  7999 8400-EP-DO-LF.
  8000     MOVE +0                         TO   LF-EPR-R78
  8001                                          LF-EPR-PRO
  8002                                          LF-EPR-ST.
  8003
  8004     MOVE LIFE-OVERRIDE-L1       TO WE-LF-AH.
  8005
  8006     IF CR-LF-STATUS-AT-DEATH NOT = ' '
  8007         COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8008         MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST.
  8009
  8010     IF CR-LF-STATUS-AT-CANCEL = ' ' AND
  8011         CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  8012             GO TO 8430-EP-DO-LF-EP.
  8013
  8014     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  8015         GO TO 8430-EP-DO-LF-EP.
  8016
  8017     COMPUTE LF-EPR-R78 = (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND.
  8018     MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST.
  8019
  8020     GO TO 8499-EXIT.
  8021
  8022 8430-EP-DO-LF-EP.
  8023     MOVE SPACE                  TO STATUTORY-SWITCH.
  8024
  8025     IF CR-LF-STATUS-AT-DEATH NOT = ' '  AND
  8026        CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'Z'
  8027         GO TO 8499-EXIT.
  8028
  8029     IF REM-TRM1 GREATER CR-LF-TERM
  8030         MOVE +0 TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8031         GO TO 8499-EXIT.
  8032
  8033     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'Z'
  8034         GO TO 8480-EP-DO-LF-EP-SUM.
  8035
  8036     IF (CLAS-I-EP (CLAS-INDEXL) = 'B' OR 'K' OR 'L')
  8037         IF CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'L'
  8038             IF REM-TRM1 NOT GREATER +0
  8039                 COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8040                 MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8041                 GO TO 8499-EXIT
  8042             ELSE
  8043                 NEXT SENTENCE
  8044         ELSE
  8045             IF (REM-TRM1 + 1) NOT GREATER +0
  8046                 COMPUTE LF-EPR-R78 = WE-LFPRM + WE-LFPRM-ALT
  8047                 MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8048                 GO TO 8499-EXIT
  8049             ELSE
  8050                 NEXT SENTENCE
  8051     ELSE
  8052         IF REM-TRM1 NOT GREATER +0  OR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 170
* ECS026P.cbl
  8053            CLAS-I-CALC-TYPE (CLAS-INDEXL) = 'B'
  8054             MOVE WE-LFPRM TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8055             GO TO 8499-EXIT.
  8056
  8057     IF CLAS-I-EP (CLAS-INDEXL) = 'T'
  8058         GO TO 8440-EP-DO-LF-EP-TEX.
  8059
  8060     IF CLAS-I-EP (CLAS-INDEXL) = 'N'
  8061         GO TO 8450-EP-DO-LF-EP-NP.
  8062
  8063*    IF STATE-ABBR (CLAS-INDEXS) = 'OH'
  8064     IF (STATE-ABBR (CLAS-INDEXS) = 'OH') AND
  8065        (CR-RATING-CLASS NOT = 'L ')
  8066         IF CR-APR     GREATER ZERO   AND
  8067            CR-LF-TERM GREATER 060    AND
  8068            CR-DT      GREATER 19831031
  8069             MOVE '*'             TO STATUTORY-SWITCH
  8070             GO TO 8450-EP-DO-LF-EP-NP.
  8071
  8072     IF STATE-ABBR (CLAS-INDEXS) = 'MT'
  8073         IF CR-APR     GREATER ZERO  AND
  8074            CR-LF-TERM GREATER 061   AND
  8075            CR-DT      GREATER 19830318
  8076             MOVE '*'             TO STATUTORY-SWITCH
  8077             GO TO 8450-EP-DO-LF-EP-NP.
  8078
  8079     IF STATE-ABBR (CLAS-INDEXS) = 'UT'
  8080         IF CR-APR     GREATER ZERO     AND
  8081            CR-LF-TERM GREATER 062      AND
  8082            CR-DT      GREATER 19810831 AND
  8083            CR-DT      LESS    19830901
  8084             MOVE '*'             TO STATUTORY-SWITCH
  8085             GO TO 8450-EP-DO-LF-EP-NP.
  8086
  8087     IF STATE-ABBR (CLAS-INDEXS) = 'RI'
  8088         IF CR-APR     GREATER ZERO  AND
  8089            CR-LF-TERM GREATER 060   AND
  8090            CR-DT      GREATER 19831231
  8091             MOVE '*'             TO STATUTORY-SWITCH
  8092             GO TO 8450-EP-DO-LF-EP-NP.
  8093
  8094     GO TO 8460-EP-DO-LF-EP-R78.
  8095
  8096 8440-EP-DO-LF-EP-TEX.
  8097     COMPUTE TEX-FACT-4 = (CR-LF-TERM  * CR-LF-TERM)
  8098                        + (CR-PMT-FREQ * CR-LF-TERM).
  8099
  8100     DIVIDE REM-TRM1 BY CR-PMT-FREQ
  8101         GIVING TEX-FACT-5   REMAINDER TEX-FACT-6.
  8102
  8103     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CR-PMT-FREQ.
  8104
  8105     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  8106                          (TEX-FACT-5 * CR-PMT-FREQ) +
  8107                          (2 * (TEX-FACT-6 *
  8108                          (TEX-FACT-5 + CR-PMT-FREQ))).
  8109
  8110     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 171
* ECS026P.cbl
  8111
  8112     COMPUTE LF-EPR-R78 ROUNDED =
  8113                    WE-LFPRM - (WE-LFPRM * TEX-FACT-8).
  8114
  8115     GO TO 8460-EP-DO-LF-EP-R78.
  8116
  8117 8450-EP-DO-LF-EP-NP.
  8118     IF WE-LFPRM = ZERO
  8119         GO TO 8460-EP-DO-LF-EP-R78.
  8120
  8121     MOVE CR-APR                 TO NP-APR.
  8122     MOVE CR-LF-TERM             TO NP-ORIG  NP-CAP.
  8123     MOVE REM-TRM1               TO NP-REM.
  8124
  8125     MOVE CLAS-I-CALC-TYPE (CLAS-INDEXL) TO NP-OPT.
  8126
  8127     IF NP-OPT = 'T' OR 'U' OR 'V'
  8128         MOVE CR-LOAN-TERM       TO NP-ORIG.
  8129
  8130     MOVE 'R'                    TO NP-OPT.
  8131
  8132     CALL 'ECSNETRM'
  8133         USING NP-APR NP-ORIG NP-REM NP-OPT NP-CAP NP-FACTOR.
  8134
  8135     COMPUTE LF-EPR-R78 ROUNDED =
  8136                     WE-LFPRM - (NP-FACTOR * WE-LFPRM).
  8137
  8138     IF STATUTORY-REQUIREMENT
  8139         MOVE LF-EPR-R78             TO LF-EPR-ST.
  8140
  8141 8460-EP-DO-LF-EP-R78.
  8142     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
  8143     COMPUTE TEMP-2 = REM-TRM1   * (REM-TRM1 + 1).
  8144
  8145     IF DTE-R78 = '1'
  8146         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8147
  8148     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8149
  8150     IF REM-TRM1 GREATER +0
  8151         COMPUTE TEMP-7 ROUNDED =
  8152             WE-LFPRM - (WE-LFPRM * TEMP-4)
  8153     ELSE
  8154         MOVE WE-LFPRM                TO TEMP-7.
  8155
  8156     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8157         MOVE ZEROS                  TO TEMP-8
  8158         GO TO 8465-END-LF-EP-R78.
  8159
  8160     MOVE TEMP-7                     TO LF-EPR-ST.
  8161
  8162     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  8163         COMPUTE TEMP-1 = (CR-LF-TERM + 1) * (CR-LF-TERM + 2)
  8164         COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 2)
  8165         IF DTE-R78 = '1'
  8166             COMPUTE TEMP-2 = (REM-TRM1 + 1) * (REM-TRM1 + 1).
  8167
  8168     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 172
* ECS026P.cbl
  8169
  8170     COMPUTE TEMP-8 ROUNDED =
  8171               WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-4).
  8172
  8173 8465-END-LF-EP-R78.
  8174     IF LF-EPR-R78 = ZEROS
  8175         COMPUTE LF-EPR-R78 = TEMP-7 + TEMP-8.
  8176
  8177 8470-EP-DO-LF-EP-PRO.
  8178     IF DTE-CLIENT = 'MIC' OR 'MCC'
  8179         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-LF-TERM
  8180     ELSE
  8181         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
  8182
  8183     IF REM-TRM1 GREATER +0
  8184         COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFPRM * TEMP-5)
  8185     ELSE
  8186         MOVE WE-LFPRM                  TO TEMP-7.
  8187
  8188     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8189         MOVE ZEROS                     TO TEMP-8
  8190         GO TO 8475-END-LF-EP-PRO.
  8191
  8192     IF CLAS-I-CALC-TYPE (CLAS-INDEXL) NOT = 'L'
  8193         IF DTE-CLIENT = 'MIC' OR 'MCC'
  8194             COMPUTE TEMP-5 ROUNDED =
  8195                           (REM-TRM1 + .5) / (CR-LF-TERM + 1)
  8196         ELSE
  8197             COMPUTE TEMP-5 ROUNDED =
  8198                           (REM-TRM1 + 1) / (CR-LF-TERM + 1).
  8199
  8200     COMPUTE TEMP-8 ROUNDED =
  8201                   WE-LFPRM-ALT - (WE-LFPRM-ALT * TEMP-5).
  8202
  8203     COMPUTE LF-EPR-ST = LF-EPR-ST + TEMP-8.
  8204
  8205 8475-END-LF-EP-PRO.
  8206     COMPUTE LF-EPR-PRO = TEMP-7 + TEMP-8.
  8207
  8208     GO TO 8485-EP-DO-LF-STATUTORY.
  8209
  8210 8480-EP-DO-LF-EP-SUM.
  8211     IF REM-TRM1 NOT GREATER +0
  8212         COMPUTE LF-EPR-R78 =
  8213                         (WE-LFPRM + WE-LFPRM-ALT) - WE-LFRFND
  8214         MOVE LF-EPR-R78 TO LF-EPR-PRO LF-EPR-ST
  8215         GO TO 8499-EXIT.
  8216
  8217     IF WE-LFPRM + WE-LFPRM-ALT EQUAL ZEROS
  8218        MOVE +.01 TO WE-LFPRM.
  8219
  8220     COMPUTE TEMP-7 ROUNDED = WE-LFPRM - (WE-LFRFND *
  8221                   (WE-LFPRM / (WE-LFPRM + WE-LFPRM-ALT))).
  8222
  8223     IF TEMP-7 NOT GREATER ZERO
  8224         IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8225             MOVE ZEROS   TO LF-EPR-R78 LF-EPR-PRO LF-EPR-ST
  8226             GO TO 8499-EXIT
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 173
* ECS026P.cbl
  8227         ELSE
  8228             MOVE ZEROS             TO TEMP-7.
  8229
  8230     COMPUTE TEMP-1 = CR-LF-TERM * (CR-LF-TERM + 1).
  8231     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
  8232     IF DTE-R78 = '1'
  8233         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8234
  8235     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8236     COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-LF-TERM.
  8237
  8238     COMPUTE LF-EPR-R78 ROUNDED = TEMP-7 - (TEMP-7 * TEMP-4).
  8239
  8240     COMPUTE LF-EPR-PRO ROUNDED = TEMP-7 - (TEMP-7 * TEMP-5).
  8241
  8242     IF (CLAS-I-EP (CLAS-INDEXL) NOT = 'B' AND 'K' AND 'L')
  8243         GO TO 8485-EP-DO-LF-STATUTORY.
  8244
  8245     MOVE LF-EPR-R78               TO LF-EPR-ST.
  8246
  8247     COMPUTE TEMP-8 ROUNDED = WE-LFPRM-ALT - (WE-LFRFND *
  8248                   (WE-LFPRM-ALT / (WE-LFPRM + WE-LFPRM-ALT))).
  8249
  8250     IF TEMP-8 NOT GREATER ZERO
  8251         GO TO 8485-EP-DO-LF-STATUTORY.
  8252
  8253     COMPUTE LF-EPR-R78 ROUNDED = LF-EPR-R78 +
  8254                              (TEMP-8 - (TEMP-8 * TEMP-4)).
  8255
  8256     COMPUTE LF-EPR-PRO ROUNDED = LF-EPR-PRO +
  8257                              (TEMP-8 - (TEMP-8 * TEMP-5)).
  8258
  8259     COMPUTE LF-EPR-ST ROUNDED = LF-EPR-ST +
  8260                              (TEMP-8 - (TEMP-8 * TEMP-5)).
  8261
  8262 8485-EP-DO-LF-STATUTORY.
  8263     IF LF-EPR-ST NOT = ZEROS
  8264         GO TO 8499-EXIT.
  8265
  8266     IF CLAS-I-RL-AH (CLAS-INDEXL) = 'R'
  8267         MOVE LF-EPR-R78             TO LF-EPR-ST
  8268     ELSE
  8269         MOVE LF-EPR-PRO             TO LF-EPR-ST.
  8270
  8271     IF STATE-ABBR (CLAS-INDEXS) = 'AL'
  8272         MOVE LF-EPR-R78             TO LF-EPR-ST.
  8273
  8274     IF STATE-ABBR (CLAS-INDEXS) = 'WY'
  8275         MOVE LF-EPR-PRO             TO LF-EPR-ST.
  8276
  8277 8499-EXIT.
  8278     EXIT.
  8279
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 174
* ECS026P.cbl
  8281******************************************************************
  8282***   C A L C U L A T E   A & H   E A R N E D   P R E M I U M  ***
  8283******************************************************************
  8284
  8285 8600-EP-DO-AH.
  8286     MOVE +0                         TO   AH-EPR-R78
  8287                                          AH-EPR-PRO
  8288                                          AH-EPR-ST.
  8289
  8290     MOVE AH-OVERRIDE-L1       TO WE-LF-AH.
  8291     MOVE CR-AHTYP             TO WE-BEN-TYPE.
  8292
  8293     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' '
  8294         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST.
  8295
  8296     IF CR-AH-STATUS-AT-CANCEL = ' '
  8297         GO TO 8630-EP-DO-AH-EP.
  8298
  8299     COMPUTE AH-EPR-R78 = WE-AHPRM - WE-AHRFND.
  8300     MOVE AH-EPR-R78 TO AH-EPR-PRO AH-EPR-ST.
  8301
  8302     GO TO 8699-EXIT.
  8303
  8304 8630-EP-DO-AH-EP.
  8305     IF CR-AH-STATUS-AT-SETTLEMENT NOT = ' ' AND
  8306        CLAS-I-CALC-TYPE (CLAS-INDEXA) NOT = 'Z'
  8307         GO TO 8699-EXIT.
  8308
  8309     IF REM-TRM1 GREATER CR-AH-TERM
  8310         MOVE +0 TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8311         GO TO 8699-EXIT.
  8312
  8313     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'Z'
  8314         COMPUTE WE-AHPRM = WE-AHPRM - WE-AHRFND.
  8315
  8316     IF REM-TRM1 NOT GREATER +0
  8317         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8318         GO TO 8699-EXIT.
  8319
  8320     IF CLAS-I-CALC-TYPE (CLAS-INDEXA) = 'B'
  8321         MOVE WE-AHPRM TO AH-EPR-R78 AH-EPR-PRO AH-EPR-ST
  8322         GO TO 8699-EXIT.
  8323
  8324     COMPUTE TEMP-1 = CR-AH-TERM * (CR-AH-TERM + 1).
  8325     COMPUTE TEMP-2 = REM-TRM1 * (REM-TRM1 + 1).
  8326     IF DTE-R78 = '1'
  8327         COMPUTE TEMP-2 = REM-TRM1 * REM-TRM1.
  8328     COMPUTE TEMP-4 ROUNDED = TEMP-2 / TEMP-1.
  8329
  8330     IF DTE-CLIENT = 'MIC' OR 'MCC'
  8331         COMPUTE TEMP-5 ROUNDED = (REM-TRM1 - .5) / CR-AH-TERM
  8332     ELSE
  8333         COMPUTE TEMP-5 ROUNDED = REM-TRM1 / CR-AH-TERM.
  8334
  8335     COMPUTE AH-EPR-R78 ROUNDED = WE-AHPRM * TEMP-4.
  8336     COMPUTE AH-EPR-R78 = WE-AHPRM - AH-EPR-R78.
  8337
  8338     COMPUTE AH-EPR-PRO ROUNDED = WE-AHPRM * TEMP-5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 175
* ECS026P.cbl
  8339     COMPUTE AH-EPR-PRO = WE-AHPRM - AH-EPR-PRO.
  8340
  8341 8640-EP-DO-AH-STATUTORY.
  8342     MOVE AH-EPR-R78                 TO AH-EPR-ST.
  8343
  8344 8645-EP-AH-STAT-LOOP.
  8345     IF (STATE-ABBR (CLAS-INDEXS) = 'OH'  AND
  8346         CR-DT GREATER 19831031)  OR
  8347        (STATE-ABBR (CLAS-INDEXS) = 'OK'  AND
  8348         CR-DT GREATER 19820629)  OR
  8349        (STATE-ABBR (CLAS-INDEXS) = 'TX'  AND
  8350         CR-DT GREATER 19830831)
  8351           COMPUTE AH-EPR-ST = (AH-EPR-R78 + AH-EPR-PRO) / 2.
  8352
  8353     IF DTE-CLIENT = 'CSO'  OR  'CID'
  8354        IF STATE-ABBR (CLAS-INDEXS) = 'CO'
  8355          IF CR-DT LESS THAN 19970101
  8356              MOVE AH-EPR-R78        TO AH-EPR-ST
  8357          ELSE
  8358              COMPUTE AH-EPR-ST = (AH-EPR-R78 + AH-EPR-PRO) / 2.
  8359
  8360 8699-EXIT.
  8361     EXIT.
  8362
  8363 8800-REMAINING-TERM-ROUTINE.
  8364     MOVE CR-DT                      TO DC-GREG-DATE-CYMD.
  8365     MOVE 'L'                        TO DC-OPTION-CODE.
  8366     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  8367     MOVE DC-BIN-DATE-1              TO CP-CERT-EFF-DT.
  8368
  8369     IF CR-LOAN-1ST-PMT-DT NOT NUMERIC
  8370         MOVE ZEROS                  TO CR-LOAN-1ST-PMT-DT.
  8371
  8372     IF CR-LOAN-1ST-PMT-DT NOT = ZEROS
  8373         MOVE CR-LOAN-1ST-PMT-DT     TO DC-GREG-DATE-1-YMD
  8374         MOVE ZEROS                  TO DC-ELAPSED-MONTHS
  8375                                        DC-ELAPSED-DAYS
  8376         MOVE '3'                    TO DC-OPTION-CODE
  8377         PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT
  8378         IF NO-CONVERSION-ERROR
  8379             MOVE DC-BIN-DATE-1      TO CP-FIRST-PAY-DATE
  8380         ELSE
  8381             MOVE ZEROS              TO CR-LOAN-1ST-PMT-DT.
  8382
  8383     IF CR-LOAN-1ST-PMT-DT = ZEROS
  8384         MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  8385         MOVE +1                     TO DC-ELAPSED-MONTHS
  8386         MOVE ZEROS                  TO DC-ELAPSED-DAYS
  8387         MOVE '6'                    TO DC-OPTION-CODE
  8388         PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT
  8389         MOVE DC-BIN-DATE-1          TO CP-FIRST-PAY-DATE
  8390         MOVE DC-GREG-DATE-1-YMD     TO CR-LOAN-1ST-PMT-DT.
  8391
  8392     MOVE VALUATION-DT               TO DC-GREG-DATE-CYMD.
  8393     MOVE 'L'                        TO DC-OPTION-CODE.
  8394     PERFORM 0800-DATE-CONVERT-ROUTINE THRU 0899-EXIT.
  8395     MOVE DC-BIN-DATE-1              TO CP-VALUATION-DT.
  8396
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 176
* ECS026P.cbl
  8397     MOVE SPACES                     TO CP-ACCT-FLD-5.
  8398     MOVE DTE-CLIENT                 TO CP-COMPANY-ID.
  8399     MOVE ORIG-TERM                  TO CP-ORIGINAL-TERM.
  8400     MOVE DTE-REM-TRM                TO CP-REM-TERM-METHOD.
  8401     MOVE DTE-REM-TRM-CALC-OPTION    TO CP-REM-TRM-CALC-OPTION.
  8402     MOVE '3'                        TO CP-PROCESS-TYPE.
  8403     MOVE DTE-CLASIC-COMPANY-CD      TO CP-COMPANY-CD.
  8404
  8405     IF DTE-CLIENT = 'FIM'
  8406         MOVE '5'                    TO CP-REM-TERM-METHOD.
  8407
  8408     IF DTE-CLIENT NOT = 'FLI' AND 'FLU'
  8409         GO TO 8850-GET-REMAINING-TERM.
  8410
  8411     IF WE-LF-AH = AH-OVERRIDE-L1
  8412         MOVE '2'                    TO CP-REM-TERM-METHOD
  8413         GO TO 8850-GET-REMAINING-TERM.
  8414
  8415     IF CR-LFTYP = '01' OR '03'
  8416         MOVE '4'                    TO CP-REM-TERM-METHOD.
  8417
  8418     IF CR-LFTYP = '02' OR '04'
  8419         MOVE '2'                    TO CP-REM-TERM-METHOD.
  8420
  8421 8850-GET-REMAINING-TERM.
  8422     CALL 'ELRTRMX' USING CALCULATION-PASS-AREA.
  8423
  8424     MOVE CP-REMAINING-TERM-1        TO REM-TRM1.
  8425     MOVE CP-REMAINING-TERM-2        TO REM-TRM2.
  8426     MOVE CP-REMAINING-TERM-3        TO REM-TRM3.
  8427     MOVE CP-ODD-DAYS                TO TEM-TRM1.
  8428
  8429 8899-EXIT.
  8430     EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 177
* ECS026P.cbl
  8432 9000-READ-CERT-IN.
  8433
  8434     READ CERT-IN  AT END
  8435         MOVE  'Y'               TO  CERT-END-SW
  8436         MOVE  HIGH-VALUES       TO  CERTIFICATE-RECORD
  8437         GO TO 9099-EXIT.
  8438
  8439     IF CR-POLICY-IS-DECLINED OR
  8440        CR-POLICY-IS-VOID
  8441             GO TO 9000-READ-CERT-IN.
  8442
* 8443     COPY ELCCRTM1.
  8444******************************************************************04/15/98
  8445*                                                                *ELCCRTM1
  8446*                                                                *ELCCRTM1
  8447*                            ELCCRTM1                            *   LV003
  8448*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8449*                            VMOD=2.001                          *ELCCRTM1
  8450*                                                                *ELCCRTM1
  8451*   COPY FILE VARIABLES TO WORKING STORAGE                       *ELCCRTM1
  8452*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCCRTM1
  8453*                                                                *ELCCRTM1
  8454******************************************************************ELCCRTM1
  8455     MOVE CR-DT                   TO  WS-CR-DT-N.                    CL**2
  8456     MOVE CR-LF-EXPIRE-DATE       TO  WS-CR-LF-EXPIRE-DATE-N.        CL**2
  8457     MOVE CR-AH-EXPIRE-DATE       TO  WS-CR-AH-EXPIRE-DATE-N.        CL**2
  8458     MOVE CR-ENTRY-DATE           TO  WS-CR-ENTRY-DATE-N.            CL**2
  8459     MOVE CR-LF-CANC-DT           TO  WS-CR-LF-CANC-DT-N.            CL**2
  8460     MOVE CR-LF-CANCEL-EXIT-DATE  TO  WS-CR-LF-CANCEL-EXIT-DATE-N.   CL**2
  8461     MOVE CR-LF-CLAIM-EXIT-DATE   TO  WS-CR-LF-CLAIM-EXIT-DATE-N.    CL**2
  8462     MOVE CR-AH-CANC-DT           TO  WS-CR-AH-CANC-DT-N.            CL**2
  8463     MOVE CR-AH-CANCEL-EXIT-DATE  TO                                 CL**2
  8464                                  WS-CR-AH-CANCEL-EXIT-DATE-N.       CL**2
  8465     MOVE CR-AH-SETTLEMENT-EXIT-DATE TO                           ELCCRTM1
  8466                                 WS-CR-AH-SETTLEMENT-EXIT-DATEN.     CL**2
  8467     MOVE CR-DTH-DT               TO  WS-CR-DTH-DT-N.                CL**2
  8468     MOVE CR-DTH-PAY-DT           TO  WS-CR-DTH-PAY-DT-N.            CL**2
  8469     MOVE CR-DIS-DT               TO  WS-CR-DIS-DT-N.                CL**2
  8470     MOVE CR-DIS-PAY-DT           TO  WS-CR-DIS-PAY-DT-N.            CL**2
  8471     MOVE CR-DIS-PTO-DT           TO  WS-CR-DIS-PTO-DT-N.            CL**2
  8472     PERFORM  VARYING COPY-NDX FROM 1 BY 1 UNTIL COPY-NDX > 5     ELCCRTM1
  8473           MOVE CR-DIS-INCUR-DT (COPY-NDX)   TO                   ELCCRTM1
  8474                                WS-CR-DIS-INCUR-DT-N (COPY-NDX)      CL**2
  8475     END-PERFORM.                                                 ELCCRTM1
  8476                                                                  ELCCRTM1
  8477
  8478     MOVE CR-CCYY TO CID-CCYY.
  8479     MOVE CR-MO   TO CID-MO.
  8480
  8481     IF DTE-PRC-OPT = 1 OR 2 OR 3 OR 4
  8482         IF CERT-ISSUE-DATE LESS PROCESS-OPT-FROM-DT OR
  8483                         GREATER PROCESS-OPT-THRU-DT
  8484             GO TO 9000-READ-CERT-IN.
  8485
  8486 9099-EXIT.
  8487     EXIT.
  8488
  8489 9200-READ-ACCT-IN.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 178
* ECS026P.cbl
  8490     READ ACCT-IN.
  8491
  8492     IF ERACCT-FILE-STATUS = '10'
  8493         MOVE  'Y'               TO  ACCT-END-SW
  8494         MOVE  HIGH-VALUES       TO  ACCOUNT-MASTER
  8495         GO TO 9299-EXIT.
  8496
  8497     IF ERACCT-FILE-STATUS NOT = ZERO
  8498         MOVE 'ERROR OCCURED READ - ERACCTT'  TO  WS-ABEND-MESSAGE
  8499         MOVE ERACCT-FILE-STATUS  TO  WS-ABEND-FILE-STATUS
  8500         GO TO ABEND-PGM.
  8501
  8502 9299-EXIT.
  8503     EXIT.
  8504
  8505 9300-READ-SORTED-FILE.
  8506     READ TEMP-WORK INTO SORT-WORK-REC   AT END
  8507         MOVE  'Y'               TO  EXTR-END-SW
  8508         MOVE  HIGH-VALUES       TO  SORT-WORK-REC.
  8509
  8510 9399-EXIT.
  8511     EXIT.
  8512
  8513 9400-READ-REIN-FILE.
  8514     READ REIN-WORK INTO SORT-WORK-REC-2  AT END
  8515         MOVE  'Y'               TO  EXTR-END-SW
  8516         MOVE  HIGH-VALUES       TO  SORT-WORK-REC-2.
  8517
  8518 9499-EXIT.
  8519     EXIT.
  8520
  8521 ABEND-PGM SECTION.
* 8522                                 COPY ELCABEND.
  8523***************************************************************** 04/14/98
  8524*                                                               * ELCABEND
  8525*                            ELCABEND.                          *    LV003
  8526*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  8527*                            VMOD 2.002                              CL**2
  8528*                                                               * ELCABEND
  8529*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  8530*            AND THEN ABENDS.                                   * ELCABEND
  8531*                                                               * ELCABEND
  8532*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  8533*                                                               * ELCABEND
  8534***************************************************************** ELCABEND
  8535*APS-010.                                                         ELCABEND
  8536     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  8537     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  8538                                                                  ELCABEND
  8539     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  8540         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  8541         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  8542                                 UPON CONSOLE.                    ELCABEND
  8543                                                                  ELCABEND
  8544     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  8545         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  8546         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  8547                                 UPON CONSOLE.                    ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page 179
* ECS026P.cbl (/apps/prod/cid1p/copy/ELCABEND)
  8548                                                                  ELCABEND
  8549     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  8550     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  8551                                 UPON CONSOLE.                    ELCABEND
  8552                                                                  ELCABEND
  8553     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  8554     CALL 'ABORTME'.
  8555                                                                  ELCABEND
  8556 APS-EXIT.                                                        ELCABEND
  8557     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:  124
* Total Messages:     3
* Unrecoverable :     0                    Severe  :     0
* Errors        :     3                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:      288716     Code:       43773
