* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   1
* ELRFNDXP.cbl
* Options: int("ELRFNDXP.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ELRFNDXP.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELRFNDXP.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "ELRFNDXP.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 ELRFNDX.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/20/95 13:26:06.
     7*                            VMOD=2.011
     8*
     9*AUTHOR.       LOGIC, INC.
    10*              DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   2
* ELRFNDXP.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    *****************************************************
    25*            *                                                   *
    26*            *    THIS 'SUBROUTINE' WILL, DEPENDING UPON THE     *
    27*            *    OPTION SPECIFIED, COMPUTE PREMIUM REFUNDS      *
    28*            *****************************************************
    29
    30
    31******************************************************************
    32*                                                                *
    33*              INPUT FIELDS USED                                 *
    34*                                                                *
    35******************************************************************
    36*  CERT ISSUE DATE  - CP-CERT-EFF-DT                             *
    37*  REFUND DATE      - CP-VALUATION-DT                            *
    38*  ORIGINAL TERM    - CP-ORIGINAL-TERM                           *
    39*  CAPPED TERM      - CP-LOAN-TERM                               *
    40*  REMAINING TERM   - CP-REMAINING-TERM                          *
    41*  STATE CODE       - CP-STATE                                   *
    42*  STATE CODE       - CP-STATE-STD-ABBV                          *
    43*  CLASS CODE       - CP-CLASS-CODE                              *
    44*  DEVIATION CODE   - CP-DEVIATION-CODE                          *
    45*  ORIGINAL BENEFIT - CP-ORIGINAL-BENEFIT                        *
    46*  PROCESS TYPE     - CP-PROCESS-TYPE                            *
    47*  BENEFIT KIND     - CP-BENEFIT-TYPE                            *
    48*  A.P.R.           - CP-LOAN-APR                                *
    49*  METHOD           - CP-EARNING-METHOD                          *
    50*  SPECIAL METHOD   - CP-SPECIAL-CALC-CODE                       *
    51*  PAYMENT FREQUENCY- CP-PAY-FREQUENCY                           *
    52*  COMPANY I.D.     - CP-COMPANY-ID                              *
    53*  BENEFIT CODE     - CP-BENEFIT-CD                              *
    54*  INSURED AGE      - CP-ISSUE-AGE                               *
    55******************************************************************
    56 ENVIRONMENT DIVISION.
    57
    58 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   3
* ELRFNDXP.cbl
    60 WORKING-STORAGE SECTION.
    61 01  LCP-ABND-CODE                 PIC S999 COMP VALUE +519.
    62 77  FILLER   PIC X(32) VALUE '********************************'.
    63 77  FILLER   PIC X(32) VALUE '**  ELRFNDX WORKING STORAGE   **'.
    64 77  FILLER   PIC X(32) VALUE '*** VMOD=2.011 *****************'.
    65
    66 01  WS-WORK-MISC.
    67     12  WS-REMAINING-TERM   PIC S9(4)V9      COMP-3.
    68     12  WS-TEMP-RESULT      PIC S9(7)V9(6)   COMP-3.
    69     12  WS-REMAINING-AMT    PIC S9(7)V9(6)   COMP-3.
    70     12  WS-ORIG-PREM        PIC S9(7)V9(6)   COMP-3.
    71     12  WS-REMAIN-PREM      PIC S9(7)V9(6)   COMP-3.
    72     12  WS-NP-REF-FACTOR    PIC S9(4)V9(11)  COMP-3.
    73     12  WS-SAVE-TERM        PIC S9(3)        COMP-3.
    74     12  WS-SAVE-LOAN-TERM   PIC S9(3)        COMP-3.
    75     12  WS-SAVE-BENEFIT     PIC S9(9)V99     COMP-3.
    76     12  WS-SAVE-EARN-METHOD PIC X.
    77     12  CAL-RFND            PIC S9(5)V99     COMP-3.
    78     12  FACTOR-1            PIC S9(4)V9(11)  COMP-3.
    79     12  FACTOR-2            PIC S9(4)V9(11)  COMP-3.
    80     12  FACTOR-3            PIC S9(4)V9(11)  COMP-3.
    81     12  FACTOR-4            PIC S9(4)V9(11)  COMP-3.
    82     12  FACTOR-5            PIC S9(7)        COMP-3.
    83     12  FACTOR-6            PIC S9(7)        COMP-3.
    84     12  RATE-FACTOR-1       PIC S9V99        COMP-3.
    85     12  RATE-FACTOR-2       PIC S999         COMP-3.
    86     12  R78-FACTOR          PIC S9(4)V9(11)  COMP-3.
    87     12  PR-FACTOR           PIC S9(4)V9(11)  COMP-3.
    88     12  RSUM-FACTOR         PIC S9(4)V9(11)  COMP-3.
    89     12  RSUM-REMAINING-TERM PIC S9(3)V99     COMP-3.
    90
    91 01  TEXAS-REG-WORK-AREAS.
    92     12  TEX-FACT-1          PIC S9(7)V9(2)  COMP-3.
    93     12  TEX-FACT-2          PIC S9(3)       COMP-3.
    94     12  TEX-FACT-3          PIC S9(3)       COMP-3.
    95     12  TEX-FACT-4          PIC S9(7)       COMP-3.
    96     12  TEX-FACT-5          PIC S9(3)       COMP-3.
    97     12  TEX-FACT-6          PIC S9(3)       COMP-3.
    98     12  TEX-FACT-7          PIC S9(7)       COMP-3.
    99     12  TEX-FACT-8          PIC S9V9(6)     COMP-3.
   100     12  TEX-FACT-9          PIC S9(4)V9(11) COMP-3.
   101
   102 01  NET-PAY-INTERFACE.
   103     12  N-P-APR             PIC S9(3)V9(4)  COMP-3.
   104     12  N-P-ORIG            PIC S9(3)       COMP-3.
   105     12  N-P-REM             PIC S9(3)       COMP-3.
   106     12  N-P-OPT             PIC X.
   107     12  N-P-LOAN            PIC S9(3)       COMP-3.
   108     12  N-P-FACTOR          PIC S9(4)V9(9)  COMP-3.
   109
*  110                         COPY ERCNETWS.
   111***************************************************************** 04/29/98
   112*                                                               * ERCNETWS
   113*                                                               * ERCNETWS
   114*                            ERCNETWS                           *    LV004
   115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**4
   116*                            VMOD=2.014                         *    CL**3
   117*                                                               * ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   4
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   118*    WORKING STORAGE TO USE WITH ERCNETP - NET PAY CALCULATIONS * ERCNETWS
   119*                                                               * ERCNETWS
   120*****************************************************************.ERCNETWS
   121*                   C H A N G E   L O G
   122*
   123* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   124*-----------------------------------------------------------------
   125*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   126* EFFECTIVE    NUMBER
   127*-----------------------------------------------------------------
   128* 060909  CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
   129* 101509  IR2009100700002  PEMA  INCREASE DECIMAL POSITIONS
   130* 071910  IR2010062900001  PEMA  ADD MN NET BALLOON REFUND CALC
   131* 071511  CR2011021500001  PEMA  ADD CODE FOR DCC 10C
   132* 050713  CR2008052200001  PEMA  ADD CODE FOR 0 PCT APR
   133******************************************************************
   134                                                                  ERCNETWS
   135 01  NET-PAY-WORK-AREA.                                           ERCNETWS
   136     12  OPTION-SW               PIC X   VALUE 'X'.               ERCNETWS
   137        88  NPO-STD         VALUE SPACE.                          ERCNETWS
   138        88  NPO-ALT         VALUE 'A'.                            ERCNETWS
   139        88  NPO-SIMPLE      VALUE 'S'.                            ERCNETWS
   140        88  NPO-2MO         VALUE 'I'.                            ERCNETWS
   141        88  NPO-3MO         VALUE 'J'.                            ERCNETWS
   142        88  NPO-4MO         VALUE 'K'.                            ERCNETWS
   143        88  NPO-TRUNC       VALUE 'T' 'U' 'V' 'W' 'X'.            ERCNETWS
   144        88  NPO-TRUNC-0     VALUE 'T'.                            ERCNETWS
   145        88  NPO-TRUNC-1     VALUE 'U'.                            ERCNETWS
   146        88  NPO-TRUNC-2     VALUE 'V'.                            ERCNETWS
   147        88  NPO-TRUNC-3     VALUE 'W'.                            ERCNETWS
   148        88  NPO-TRUNC-4     VALUE 'X'.                            ERCNETWS
   149        88  NPO-REFUND      VALUE 'R'.                            ERCNETWS
   150        88  NPO-PRUDENTIAL  VALUE 'P'.                            ERCNETWS
   151                                                                  ERCNETWS
   152     12  TYPE-SW             PIC X   VALUE 'N'.                   ERCNETWS
   153        88  NET-STD             VALUE 'N'.                        ERCNETWS
   154        88  NET-SMP             VALUE 'S'.                        ERCNETWS
   155                                                                  ERCNETWS
   156     12  NP-PROCESS-SW       PIC X   VALUE '1'.                   ERCNETWS
   157        88  NP-RATING           VALUE '1'.                        ERCNETWS
   158        88  NP-REFUND           VALUE '2'.                        ERCNETWS
   159        88  NP-REMAIN-AMT       VALUE '3'.                        ERCNETWS
   160                                                                  ERCNETWS
   161     12  COMP-3-WORK-AREA         COMP-3.                         ERCNETWS
   162         16  WS-WORK-DIS-RATE PIC S99V9(06)    VALUE +0.          ERCNETWS
   163         16  V               PIC SV9(13)       VALUE +.0.         ERCNETWS
   164         16  J               PIC SV9(9)        VALUE +0.
   165         16  K               PIC SV9(9)        VALUE +0.
   166         16  I               PIC SV9(10)       VALUE +.0.         ERCNETWS
   167         16  D               PIC S9(5)         VALUE +.0.
   168         16  APR100          PIC SV9(9)        VALUE +.0.         ERCNETWS
   169         16  RA              PIC S9(6)V9(9)    VALUE +.0.         ERCNETWS
   170         16  WK1             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   171         16  WK2             PIC S9(4)V9(13)   VALUE +.0.         ERCNETWS
   172         16  pema            pic s9(2)v9(15)   value +0.
   173         16  WK3             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   174         16  WK4             PIC S9(7)V9(8)    VALUE +.0.         ERCNETWS
   175         16  WK5             PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   5
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   176         16  WK5-CSL         PIC S9(9)V9(6)    VALUE +.0.         ERCNETWS
   177         16  WK6             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   178         16  WK7             PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   179         16  WK8             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   180         16  WK9             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   181         16  GR              PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   182         16  ONE-PLUS-I      PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   183         16  ODF             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   184         16  OD              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   185         16  FM              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   186         16  FN              PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   187         16  FNM             PIC S9(3)V9(10)   VALUE +.0.         ERCNETWS
   188         16  ANGLEM          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   189         16  ANGLEMY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   190         16  ANGLEMP1        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   191         16  ANGLEN          PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   192         16  ANGLENY         PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   193         16  ANGLEN-M        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   194         16  ANGLEN-MP1      PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   195         16  ANGLEN-MP1Y     PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   196         16  ANGLEN-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   197         16  ANGLEM-1        PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   198         16  ANGLEM-1Y       PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   199         16  ANGLEM-T        PIC S9(5)V9(13)   VALUE +.0.         ERCNETWS
   200         16  PVBALLOON       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   201         16  TRUNC-PMT       PIC S9(7)V99      VALUE +.0.         ERCNETWS
   202         16  K1              PIC S999          VALUE +1.          ERCNETWS
   203         16  K12             PIC S999          VALUE +12.         ERCNETWS
   204         16  K100            PIC S999          VALUE +100.        ERCNETWS
   205         16  K1000           PIC S9(7)         VALUE +1000.       ERCNETWS
   206         16  NC-LR           PIC S9(2)V9(5)    VALUE +.0.         ERCNETWS
   207         16  Y REDEFINES NC-LR
   208                             PIC S99V9(5).
   209         16  TI              PIC S999V9(5)     VALUE +0.
   210         16  NC-R            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   211         16  NC-OB           PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   212         16  NC-P            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   213         16  NC-D            PIC S9(7)V9(10)   VALUE +.0.         ERCNETWS
   214         16  NC-BIG-D        PIC S9(3)         VALUE +030.        ERCNETWS
   215         16  NC-LITTLE-D     PIC S9(2)V9(7)    VALUE +.0.         ERCNETWS
   216         16  NC-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   217         16  NC-LP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   218                                                                  ERCNETWS
   219         16  CA-MP           PIC S9(5)V9(2)    VALUE +.0.         ERCNETWS
   220         16  CA-API          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   221         16  CA-APJ          PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   222         16  CA-VI           PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   223         16  CA-J            PIC S9(2)V9(8)    VALUE +.0.         ERCNETWS
   224         16  CA-DISCOUNT     PIC S9(2)V9(8)    VALUE +.042000.    ERCNETWS
   225         16  GTL-IA-DIVIDEND PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   226         16  GTL-IA-DIVISOR  PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   227         16  GTL-IA-FACTOR   PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   228         16  GTL-IA-ODF      PIC S9(5)V9(8)    VALUE +.0.         ERCNETWS
   229         16  GTL-IA-ODD-DAYS PIC S999          VALUE +.0.         ERCNETWS
   230         16  GTL-IA-SGN      PIC S9            VALUE +.0.         ERCNETWS
   231         16  GTL-IA-ABS      PIC 999           VALUE ZEROS.       ERCNETWS
   232                                                                  ERCNETWS
   233         16  ANNUAL-INT-RATE PIC S9(3)V9(4)    VALUE +.0.         ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   6
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   234                                                                  ERCNETWS
   235         16  ORIGINAL-TERM   PIC S999.                            ERCNETWS
   236         16  M              REDEFINES ORIGINAL-TERM               ERCNETWS
   237                             PIC S999.                            ERCNETWS
   238                                                                  ERCNETWS
   239         16  REMAINING-TERM  PIC S999.                            ERCNETWS
   240         16  R              REDEFINES REMAINING-TERM              ERCNETWS
   241                             PIC S999.                            ERCNETWS
   242                                                                  ERCNETWS
   243         16  LOAN-TERM       PIC S999.                            ERCNETWS
   244         16  N              REDEFINES LOAN-TERM                   ERCNETWS
   245                             PIC S999.                            ERCNETWS
   246                                                                  ERCNETWS
   247         16  EXPIRED-TERM    PIC S999.                            ERCNETWS
   248         16  E              REDEFINES EXPIRED-TERM                ERCNETWS
   249                             PIC S999.                            ERCNETWS
   250                                                                  ERCNETWS
   251         16  PRUDENTIAL-WORK-AMT                                  ERCNETWS
   252                             PIC S9(7)V9(8).                      ERCNETWS
   253         16  PWK            REDEFINES PRUDENTIAL-WORK-AMT         ERCNETWS
   254                             PIC S9(7)V9(8).                      ERCNETWS
   255                                                                  ERCNETWS
   256         16  FACTOR          PIC S9(4)V9(9)    VALUE +0.0.        ERCNETWS
   257         16  VX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   258         16  SV              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   259         16  SV-MINUS-ONE    PIC S999V9(09)    VALUE +0.0.        ERCNETWS
   260         16  SX              PIC S9V9(13)      VALUE +0.0.        ERCNETWS
   261         16  SE              PIC S9V9(10)      VALUE +0.0.        ERCNETWS
   262         16  N2              PIC S9(7)         VALUE +0.          ERCNETWS
   263         16  N3              PIC S9(7)         VALUE +0.          ERCNETWS
   264         16  K-I             PIC S9V9(8)       VALUE +0.0.        ERCNETWS
   265                                                                  ERCNETWS
   266     12  BINARY-WORK-AREA        COMP.                            ERCNETWS
   267         16  X1              PIC S999        VALUE +0.            ERCNETWS
   268         16  X2              PIC S999        VALUE +0.            ERCNETWS
   269         16  MAX-X           PIC S9(5)       VALUE +0.            ERCNETWS
   270         16  B1              PIC S9(5)       VALUE +1.            ERCNETWS
   271         16  LINDX           PIC S999        VALUE ZEROS.         ERCNETWS
   272         16  AHNDX           PIC S999        VALUE ZEROS.         ERCNETWS
   273                                                                  ERCNETWS
   274     12  CSO-RATE-WORK-AREAS.
   275         16  C-PMTS-PER-YEAR     PIC S999V99 COMP-3 VALUE ZEROS.
   276         16  C-DAYS-IN-PMT-PER   PIC S999 COMP-3 VALUE ZEROS.
   277         16  C-TOT-PMTS          PIC S999 COMP-3 VALUE ZEROS.
   278
   279     12  WS-WORK-MISC.                                            ERCNETWS
   280         16  ws-extra-pmts       pic s999         comp-3.
   281         16  NET-BEN             PIC S9(9)V9999   COMP-3.         ERCNETWS
   282         16  WS-RATE-TERM        PIC S9(3)        COMP-3.         ERCNETWS
   283*        16  WS-AGE              PIC 99           VALUE ZEROS.    ERCNETWS
   284         16  WS-AGE              PIC S9(3)V99 COMP-3 VALUE +0.
   285         16  WS-AH-FACE-BENEFIT  PIC S9(7)        COMP-3.         ERCNETWS
   286         16  WS-COUNTER          PIC S9(3)    COMP-3  VALUE +0.   ERCNETWS
   287         16  WS-WORK-RATE        PIC S9(2)V9(8) COMP-3 VALUE +0.  ERCNETWS
   288         16  WS-DISCOUNT-OPTION  PIC X VALUE SPACES.              ERCNETWS
   289         16  WS-DUE-DATE         PIC S9(7) COMP-3 VALUE +0.          CL**2
   290         16  WS-INT-BEGIN-DATE   PIC S9(7) COMP-3 VALUE +0.          CL**2
   291         16  WS-X-Y-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   7
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETWS)
   292         16  WS-Y-X-FACTOR       PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   293         16  WS-ODD-DAY-UNITS    PIC S9(3)V9(15) COMP-3 VALUE +0. ERCNETWS
   294         16  WS-CALC-FREQ-RATE   PIC S9(2)V9(15) COMP-3 VALUE +0. ERCNETWS
   295         16  WS-NP-FACTOR        PIC S9(5)V9(10) COMP-3 VALUE +0. ERCNETWS
   296******************************************************************ERCNETWS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   8
* ELRFNDXP.cbl
   298
*  299                         COPY ELCDATE.
   300******************************************************************06/11/98
   301*                                                                *ELCDATE
   302*                                                                *ELCDATE
   303*                            ELCDATE.                            *   LV023
   304*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   305*                            VMOD=2.003                           ELCDATE
   306*                                                                *ELCDATE
   307*                                                                *ELCDATE
   308*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   309*                 LENGTH = 200                                   *   CL*19
   310******************************************************************ELCDATE
   311                                                                  ELCDATE
   312 01  DATE-CONVERSION-DATA.                                        ELCDATE
   313     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   314     12  DC-OPTION-CODE                PIC X.                        CL*15
   315         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   316         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   317         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   318         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   319         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   320         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   321         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   322         88  FIND-CENTURY               VALUE '7'.                   CL*22
   323         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   324         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   325         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   326         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   327         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   328         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   329         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   330         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   331         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   332         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   333         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   334         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   335         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   336         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   337         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   338         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   339         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
   340         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   341         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   342         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   343         88  THREE-CHARACTER-BIN                                  ELCDATE
   344                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   345         88  GREGORIAN-TO-BIN                                        CL**2
   346                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   347         88  BIN-TO-GREGORIAN                                        CL**2
   348                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   349         88  JULIAN-TO-BINARY                                        CL**2
   350                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   351     12  DC-ERROR-CODE                 PIC X.                        CL*15
   352         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   353         88  DATE-CONVERSION-ERROR                                ELCDATE
   354                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   355         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page   9
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   356         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   357         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   358         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   359         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   360         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   361         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   362         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   363         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   364         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   365     12  DC-END-OF-MONTH               PIC X.                        CL*15
   366         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   367     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   368         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   369         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   370         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   371     12  FILLER                        PIC X.                        CL*15
   372     12  DC-CONVERSION-DATES.                                        CL*15
   373         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   374         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   375         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   376         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   377                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   378             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   379             20  SLASH1-1              PIC X.                        CL*15
   380             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   381             20  SLASH1-2              PIC X.                        CL*15
   382             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   383         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   384         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   385                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   386             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   387             20  SLASH2-1              PIC X.                        CL*15
   388             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   389             20  SLASH2-2              PIC X.                        CL*15
   390             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   391         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   392         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   393                     DC-GREG-DATE-1-YMD.                          ELCDATE
   394             20  DC-YMD-YEAR           PIC 99.                       CL*15
   395             20  DC-YMD-MONTH          PIC 99.                       CL*15
   396             20  DC-YMD-DAY            PIC 99.                       CL*15
   397         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
   398         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   399                      DC-GREG-DATE-1-MDY.                         ELCDATE
   400             20  DC-MDY-MONTH          PIC 99.                       CL*15
   401             20  DC-MDY-DAY            PIC 99.                       CL*15
   402             20  DC-MDY-YEAR           PIC 99.                       CL*15
   403         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   404             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   405             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   406             20  FILLER                PIC XX.                       CL*15
   407             20  DC-ALPHA-CENTURY.                                   CL*15
   408                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   409             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   410         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   411         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   412         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   413         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  10
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   414         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   415                                       PIC 9(05).                    CL*20
   416         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   417             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   418             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   419         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   420         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   421         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   422     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   423         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   424         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   425             20  FILLER                PIC 9(3).                     CL*15
   426             20  HOLD-CEN-1-CCYY.                                    CL*15
   427                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   428                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   429             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   430             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   431         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   432             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   433             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   434             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   435                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   436                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   437             20  FILLER                PIC 9(3).                     CL*15
   438         16  HOLD-CENTURY-1-X.                                       CL*15
   439             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   440             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   441                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   442                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   443             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   444             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   445         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   446             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   447             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   448             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   449                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   450                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   451             20  FILLER                PIC XXX.                      CL*23
   452         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   453         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   454         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   455         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
   456             20  DC-JULIAN-1-CCYY.                                   CL*15
   457                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
   458                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
   459             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
   460         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
   461         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
   462             20  DC-JULIAN-2-CCYY.                                   CL*15
   463                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
   464                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
   465             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
   466         16  DC-GREG-DATE-A-EDIT.                                    CL*15
   467             20  DC-EDITA-MONTH        PIC 99.                       CL*15
   468             20  SLASHA-1              PIC X VALUE '/'.              CL*15
   469             20  DC-EDITA-DAY          PIC 99.                       CL*15
   470             20  SLASHA-2              PIC X VALUE '/'.              CL*15
   471             20  DC-EDITA-CCYY.                                      CL*15
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  11
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   472                 24  DC-EDITA-CENT     PIC 99.                       CL*15
   473                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
   474         16  DC-GREG-DATE-B-EDIT.                                    CL*15
   475             20  DC-EDITB-MONTH        PIC 99.                       CL*15
   476             20  SLASHB-1              PIC X VALUE '/'.              CL*15
   477             20  DC-EDITB-DAY          PIC 99.                       CL*15
   478             20  SLASHB-2              PIC X VALUE '/'.              CL*15
   479             20  DC-EDITB-CCYY.                                      CL*15
   480                 24  DC-EDITB-CENT     PIC 99.                       CL*15
   481                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
   482         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
   483         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
   484                              DC-GREG-DATE-CYMD.                  ELCDATE
   485             20  DC-CYMD-CEN           PIC 99.                       CL*15
   486             20  DC-CYMD-YEAR          PIC 99.                       CL*15
   487             20  DC-CYMD-MONTH         PIC 99.                       CL*15
   488             20  DC-CYMD-DAY           PIC 99.                       CL*15
   489         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
   490         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
   491                              DC-GREG-DATE-MDCY.                  ELCDATE
   492             20  DC-MDCY-MONTH         PIC 99.                       CL*15
   493             20  DC-MDCY-DAY           PIC 99.                       CL*15
   494             20  DC-MDCY-CEN           PIC 99.                       CL*15
   495             20  DC-MDCY-YEAR          PIC 99.                       CL*15
   496    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
   497        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
   498    12  DC-EL310-DATE                  PIC X(21).                    CL*26
   499    12  FILLER                         PIC X(28).                    CL*26
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  12
* ELRFNDXP.cbl
   501 LINKAGE SECTION.
*  502                         COPY ELCCALC.
   503******************************************************************04/15/98
   504*                                                                *ELCCALC
   505*                           ELCCALC.                            *    LV003
   506*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   507*                            VMOD=2.025                          *   CL**3
   508*                                                                *   CL**2
   509*   DESCRIPTION:  DATA TO BE PASSED TO REMAINING TERM ROUTINE    *   CL**2
   510*                 REMAINING AMOUNT ROUTINE, LOSS RESERVE ROUTINE *   CL**2
   511*                 REFUND CALCULATIONS ROUTINE, EARNINGS CALCU -  *   CL**2
   512*                 LATIONS ROUTINE, AND THE RATING ROUTINE.       *   CL**2
   513*                                                                *   CL**2
   514*  PASSED TO ELRTRM                                              *   CL**2
   515*  -----------------                                             *   CL**2
   516*  METHOD CODE (I.E. FULL MONTH, HALF ADJ, ETC)                  *   CL**2
   517*  ORIGINAL TERM                                                 *   CL**2
   518*  BEGINNING DATE                                                *   CL**2
   519*  ENDING DATE                                                   *   CL**2
   520*  COMPANY I.D.                                                  *   CL**2
   521*  ACCOUNT MASTER USER FIELD                                     *   CL**2
   522*  PROCESS SWITCH (CANCEL, CLAIM)                                *   CL**2
   523*  FREE LOOK DAYS                                                *   CL**2
   524*                                                                *   CL**2
   525*  RETURNED FROM ELRTRM                                          *   CL**2
   526*  ---------------------                                         *   CL**2
   527*  REMAINING TERM 1 - USED FOR EARNINGS                          *   CL**2
   528*  REMAINING TERM 2 - USED FOR BENEFIT CALCULATIONS              *   CL**2
   529*  REMAINING TERM 3 - USED FOR CLAIM BENEFITS                    *   CL**2
   530*  ODD DAYS - REMAINING DAYS PAST FULL MONTHS                    *   CL**2
   531*----------------------------------------------------------------*   CL**2
   532*  PASSED TO ELRAMT                                              *   CL**2
   533*  ----------------                                              *   CL**2
   534*  REMAINING TERM 1 OR 2 OR 3 (FROM ELRTRM)                      *   CL**2
   535*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   536*  ORIGINAL AMOUNT                                               *   CL**2
   537*  ALTERNATE BENEFIT (BALLON)                                    *   CL**2
   538*  A.P.R. - NET PAY ONLY                                         *   CL**2
   539*  METHOD                                                            CL**2
   540*  PAYMENT FREQUENCY - FOR FARM PLAN                             *   CL**2
   541*  COMPANY I.D.                                                  *   CL**2
   542*  BENEFIT TYPE                                                  *   CL**2
   543*                                                                *   CL**2
   544*  RETURNED FROM ELRAMT                                          *   CL**2
   545*  --------------------                                          *   CL**2
   546*  REMAINING AMOUNT 1 - CURRENT                                  *   CL**2
   547*  REMAINING AMOUNT 2 - PREVIOUS MONTH                           *   CL**2
   548*  REMAINING AMOUNT FACTOR                                           CL**2
   549*----------------------------------------------------------------*   CL**2
   550*  PASSED TO ELRESV                                              *   CL**2
   551*  -----------------                                             *   CL**2
   552*  CERTIFICATE EFFECTIVE DATE                                    *   CL**2
   553*  VALUATION DATE                                                *   CL**2
   554*  PAID THRU DATE                                                *   CL**2
   555*  BENEFIT                                                       *   CL**2
   556*  INCURRED DATE                                                 *   CL**2
   557*  REPORTED DATE                                                 *   CL**2
   558*  ISSUE AGE                                                     *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  13
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   559*  TERM                                                          *   CL**2
   560*  CDT PERCENT                                                   *   CL**2
   561*  CDT METHOD (I.E. INTERPOLATED, AVERAGE, ETC)                  *   CL**2
   562* *CLAIM TYPE (LIFE, A/H)                                        *   CL**2
   563* *REMAINING BENEFIT (FROM ELRAMT)                               *   CL**2
   564* *ONLY FIELDS REQUIRED FOR LIFE CLAIMS                          *   CL**2
   565*                                                                *   CL**2
   566*  RETURNED FROM ELRESV                                          *   CL**2
   567*  --------------------                                          *   CL**2
   568*  CDT TABLE USED                                                *   CL**2
   569*  CDT FACTOR USED                                               *   CL**2
   570*  PAY TO CURRENT RESERVE                                        *   CL**2
   571*  I.B.N.R. - A/H ONLY                                           *   CL**2
   572*  FUTURE (ACCRUED) AH ONLY                                      *   CL**2
   573*----------------------------------------------------------------*   CL**2
   574*  PASSED TO ELRATE                                              *   CL**2
   575*  ----------------                                              *   CL**2
   576*  CERT ISSUE DATE                                               *   CL**2
   577*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   578*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   579*  CAPPED TERM   (ONLY FOR TRUNCATED LIFE)                       *   CL**2
   580*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   581*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   582*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   583*  DEVIATION CODE                                                *   CL**2
   584*  ISSUE AGE                                                     *   CL**2
   585*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   586*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   587*  PROCESS TYPE (ISSUE OR CANCEL)                                *   CL**2
   588*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   589*  A.P.R.                                                        *   CL**2
   590*  METHOD                                                            CL**2
   591*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   592*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   593*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   594*  BENEFIT CODE                                                  *   CL**2
   595*  BENEFIT OVERRIDE CODE                                         *   CL**2
   596*  MAXIMUM MONTHLY BENEFIT (FROM ACCT MASTER - CSL ONLY)         *   CL**2
   597*  MAXIMUM TOTAL BENEFIT (FROM ACCT MASTER - CSL ONLY)           *   CL**2
   598*  JOINT INDICATOR (CSL ONLY)                                    *   CL**2
   599*  FIRST PAYMENT DATE (CSL ONLY)                                 *   CL**2
   600*  PERIODIC PAYMENT AMOUNT (IN CP-REMAINING-TERM - CSL ONLY)     *   CL**2
   601*                                                                *   CL**2
   602*  RETURNED FROM ELRATE                                          *   CL**2
   603*  --------------------                                          *   CL**2
   604*  CALCULATED PREMIUM                                            *   CL**2
   605*  PREMIUM RATE                                                  *   CL**2
   606*  MORTALITY CODE                                                *   CL**2
   607*  MAX ATTAINED AGE                                              *   CL**2
   608*  MAX AGE                                                       *   CL**2
   609*  MAX TERM                                                      *   CL**2
   610*  MAX MONTHLY BENEFIT                                           *   CL**2
   611*  MAX TOTAL BENIFIT                                             *   CL**2
   612*  COMPOSITE RATE (OPEN-END ONLY)                                *   CL**2
   613*----------------------------------------------------------------*   CL**2
   614*  PASSED TO ELRFND                                              *   CL**2
   615*  ----------------                                              *   CL**2
   616*  CERT ISSUE DATE                                               *   CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  14
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   617*  REFUND DATE                                                   *   CL**2
   618*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   619*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   620*  TERM OR EXT DAYS  (DAY TERM FOR SP CALC = 'D', ELSE EXT DAYS) *   CL**2
   621*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   622*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   623*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   624*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   625*  DEVIATION CODE                                                *   CL**2
   626*  ISSUE AGE                                                     *   CL**2
   627*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   628*  RATING BENEFIT AMT (TOTAL BENEFIT AMT FOR BALLOONS)           *   CL**2
   629*  PROCESS TYPE (CANCEL)                                         *   CL**2
   630*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   631*  A.P.R.                                                        *   CL**2
   632*  EARNING METHOD - (CODE FROM BENEFIT, STATE OR ACCOUNT RECORD) *   CL**2
   633*  RATING METHOD -  (CODE FROM BENEFIT)                          *   CL**2
   634*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   635*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   636*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   637*  BENEFIT CODE                                                  *   CL**2
   638*  BENEFIT OVERRIDE CODE                                         *   CL**2
   639*                                                                *   CL**2
   640*  RETURNED FROM ELRFND                                          *   CL**2
   641*  --------------------                                          *   CL**2
   642*  CALCULATED REFUND                                             *   CL**2
   643*----------------------------------------------------------------*   CL**2
   644*  PASSED TO ELEARN                                              *   CL**2
   645*  ----------------                                              *   CL**2
   646*  CERT ISSUE DATE                                               *   CL**2
   647*  ORIGINAL TERM (ADJUSTED IF SKIP MONTHS ARE USED)              *   CL**2
   648*  REMAINING TERM (REMAINING TERM 1 FROM ELTERM)                 *   CL**2
   649*  RULE OF 78 OPTION (FROM CONTROL RECORD)                       *   CL**2
   650*  STATE CODE (CLIENT DEFINED)                                   *   CL**2
   651*  STATE CODE (STANDARD P.O. ABBRV)                              *   CL**2
   652*  CLASS CODE (FROM CERT OR ACCOUNT IF CERT ZERO OR SPACES)      *   CL**2
   653*  DEVIATION CODE                                                *   CL**2
   654*  ISSUE AGE                                                     *   CL**2
   655*  ORIGINAL BENEFIT AMOUNT                                       *   CL**2
   656*  BENEFIT KIND (LIFE OR A/H)                                    *   CL**2
   657*  A.P.R.                                                        *   CL**2
   658*  METHOD - (EARNING CODE FROM BENEFIT RECORD)                   *   CL**2
   659*  SPECIAL METHOD - (SPECIAL CODE FROM BENEFIT RECORD)           *   CL**2
   660*  PAYMENT FREQUENCY  (FOR TEXAS IRREGULAR)                      *   CL**2
   661*  COMPANY I.D. (3 CHARACTER)                                    *   CL**2
   662*  BENEFIT CODE                                                  *   CL**2
   663*  BENEFIT OVERRIDE CODE                                         *   CL**2
   664*                                                                *   CL**2
   665*  RETURNED FROM ELEARN                                          *   CL**2
   666*  --------------------                                          *   CL**2
   667*  INDICATED  EARNINGS                                           *   CL**2
   668*----------------------------------------------------------------*   CL**2
   669*                 LENGTH = 450                                   *   CL**2
   670*                                                                *   CL**2
   671******************************************************************   CL**2
   672******************************************************************
   673*                   C H A N G E   L O G
   674*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  15
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   675* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   676*-----------------------------------------------------------------
   677*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   678* EFFECTIVE    NUMBER
   679*-----------------------------------------------------------------
   680* 010303    2001061800003  PEMA  ADD DCC/MONTHLY PROCESSING
   681* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
   682* 101807    2007100100007  PEMA  EXPAND CLM RESERVE FIELDS
   683* 010410    2008021200005  PEMA  ADD FIELDS FOR MN NET PAY BALLOON
   684* 010410    2009050700003  PEMA  ADD FIELDS FOR SPP-DD
   685* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
   686* 041710    2007111300001  AJRA  ADD CLAIM CALC SW FOR SC NP+6
   687* 101110  CR2010012700001  PEMA ADD DDF REFUND/UEP PROCESSING
   688* 071211  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   689* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS
   690******************************************************************
   691                                                                     CL**2
   692 01  CALCULATION-PASS-AREA.                                          CL**2
   693     12  CP-COMM-LENGTH            PIC S9(4)         VALUE +450      CL**2
   694                                     COMP.                           CL**2
   695                                                                     CL**2
   696     12  CP-RETURN-CODE            PIC X             VALUE ZERO.     CL**2
   697       88  NO-CP-ERROR                             VALUE ZERO.       CL**2
   698       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'    CL**2
   699                                  '9' 'A' 'B' 'C' 'D' 'E' 'H'.       CL**2
   700       88  CP-ERROR-IN-AMOUNTS                     VALUE '1'.        CL**2
   701       88  CP-ERROR-IN-DATES                       VALUE '2'.        CL**2
   702       88  CP-ERROR-IN-OPTIONS                     VALUE '3'.        CL**2
   703       88  CP-ERROR-IN-TERMS                       VALUE '4'.        CL**2
   704       88  CP-ERROR-IN-FREQUENCY                   VALUE '5'.        CL**2
   705       88  CP-ERROR-RATE-NOT-FOUND                 VALUE '6'.        CL**2
   706       88  CP-ERROR-RATE-IS-ZERO                   VALUE '7'.        CL**2
   707       88  CP-ERROR-AMT-OUTSIDE-LIMIT              VALUE '8'.        CL**2
   708       88  CP-ERROR-TERM-OUTSIDE-LIMIT             VALUE '9'.        CL**2
   709       88  CP-ERROR-AGE-OUTSIDE-LIMIT              VALUE 'A'.        CL**2
   710       88  CP-ERROR-ATT-OUTSIDE-LIMIT              VALUE 'B'.        CL**2
   711       88  CP-ERROR-TOT-OUTSIDE-LIMIT              VALUE 'C'.        CL**2
   712       88  CP-ERROR-RATE-FILE-NOTOPEN              VALUE 'D'.        CL**2
   713       88  CP-ERROR-ISSUE-AGE-ZERO                 VALUE 'E'.        CL**2
   714       88  CP-ERROR-NO-LIMITS-CRI                  VALUE 'F'.        CL**2
   715       88  CP-ERROR-DIV-BY-ZERO                    VALUE 'G'.        CL**2
   716       88  CP-ERROR-LOAN-TERM                      VALUE 'H'.        CL**2
   717                                                                     CL**2
   718     12  CP-RETURN-CODE-2          PIC X             VALUE ZERO.     CL**2
   719       88  NO-CP-ERROR-2                           VALUE ZERO.       CL**2
   720***********************  INPUT AREAS ****************************    CL**2
   721                                                                     CL**2
   722     12  CP-CALCULATION-AREA.                                        CL**2
   723         16  CP-ACCOUNT-NUMBER     PIC X(10)       VALUE SPACES.     CL**2
   724         16  CP-CERT-EFF-DT        PIC XX.                           CL**2
   725         16  CP-VALUATION-DT       PIC XX.                           CL**2
   726         16  CP-PAID-THRU-DT       PIC XX.                           CL**2
   727         16  CP-BENEFIT-TYPE       PIC X.                            CL**2
   728           88  CP-AH                               VALUE 'A' 'D'     CL**2
   729                                                   'I' 'U'.          CL**2
   730           88  CP-REDUCING-LIFE                    VALUE 'R'.        CL**2
   731           88  CP-LEVEL-LIFE                       VALUE 'L' 'P'.    CL**2
   732         16  CP-INCURRED-DT        PIC XX.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  16
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   733         16  CP-REPORTED-DT        PIC XX.                           CL**2
   734         16  CP-ACCT-FLD-5         PIC XX            VALUE SPACE.    CL**2
   735         16  CP-COMPANY-ID         PIC XXX           VALUE SPACE.    CL**2
   736         16  CP-ISSUE-AGE          PIC S9(3)         VALUE ZERO      CL**2
   737                                     COMP-3.                         CL**2
   738         16  CP-CDT-PERCENT        PIC S9(3)V99      VALUE ZERO      CL**2
   739                                     COMP-3.                         CL**2
   740         16  CP-CDT-METHOD         PIC X.                            CL**2
   741           88  CP-CDT-ROUND-NEAR                   VALUE '1'.        CL**2
   742           88  CP-CDT-ROUND-HIGH                   VALUE '2'.        CL**2
   743           88  CP-CDT-INTERPOLATED                 VALUE '3'.        CL**2
   744         16  CP-CLAIM-TYPE         PIC X.                            CL**2
   745           88  CP-AH-CLAIM                         VALUE 'A'.        CL**2
   746           88  CP-LIFE-CLAIM                       VALUE 'L'.        CL**2
   747         16  CP-ORIGINAL-TERM      PIC S9(3)         VALUE ZERO      CL**2
   748                                     COMP-3.                         CL**2
   749         16  CP-ORIGINAL-BENEFIT   PIC S9(9)V99      VALUE ZERO      CL**2
   750                                     COMP-3.                         CL**2
   751         16  CP-ORIGINAL-PREMIUM   PIC S9(7)V99      VALUE ZERO      CL**2
   752                                     COMP-3.                         CL**2
   753         16  CP-REMAINING-TERM     PIC S9(3)V99      VALUE ZERO      CL**2
   754                                     COMP-3.                         CL**2
   755         16  CP-REMAINING-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   756                                     COMP-3.                         CL**2
   757         16  CP-LOAN-APR           PIC S9(3)V9(4)    VALUE ZERO      CL**2
   758                                     COMP-3.                         CL**2
   759         16  CP-PAY-FREQUENCY      PIC S9(3)         VALUE ZERO      CL**2
   760                                     COMP-3.                         CL**2
   761         16  CP-REM-TERM-METHOD    PIC X.                            CL**2
   762           88  CP-EARN-AFTER-15TH                  VALUE '1'.        CL**2
   763           88  CP-EARN-ON-HALF-MONTH               VALUE '2'.        CL**2
   764           88  CP-EARN-ON-1ST-DAY                  VALUE '3'.        CL**2
   765           88  CP-EARN-ON-FULL-MONTH               VALUE '4'.        CL**2
   766           88  CP-EARN-WITH-NO-DAYS                VALUE '5'.        CL**2
   767           88  CP-EARN-AFTER-14TH                  VALUE '6'.        CL**2
   768           88  CP-EARN-AFTER-16TH                  VALUE '7'.        CL**2
   769         16  CP-EARNING-METHOD     PIC X.                            CL**2
   770           88  CP-EARN-BY-R78                      VALUE '1' 'R'.    CL**2
   771           88  CP-EARN-BY-PRORATA                  VALUE '2' 'P'.    CL**2
   772           88  CP-EARN-AS-CALIF                    VALUE '3' 'C'.    CL**2
   773           88  CP-EARN-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   774           88  CP-EARN-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   775           88  CP-EARN-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   776           88  CP-EARN-ANTICIPATION                VALUE '6' 'A'.    CL**2
   777           88  CP-EARN-AS-MEAN                     VALUE '8' 'M'.    CL**2
   778           88  CP-EARN-AS-SUM-OF-DIGITS            VALUE '9'.        CL**2
   779           88  CP-EARN-AS-REG-BALLOON              VALUE 'B'.        CL**2
   780           88  CP-GAP-NON-REFUNDABLE               VALUE 'G'.
   781           88  CP-GAP-ACTUARIAL                    VALUE 'S'.
   782           88  CP-DCC-SPP-DDF                      VALUE 'D' 'I'.
   783           88  CP-DCC-SPP-DDF-IU                   VALUE 'I'.
   784         16  CP-PROCESS-TYPE       PIC X.                            CL**2
   785           88  CP-CLAIM                            VALUE '1'.        CL**2
   786           88  CP-CANCEL                           VALUE '2'.        CL**2
   787           88  CP-ISSUE                            VALUE '3'.        CL**2
   788         16  CP-SPECIAL-CALC-CD    PIC X.                            CL**2
   789           88  CP-OUTSTANDING-BAL              VALUE 'O'.            CL**2
   790           88  CP-1-MTH-INTEREST               VALUE ' '.            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  17
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   791           88  CP-0-MTH-INTEREST               VALUE 'A'.            CL**2
   792           88  CP-OB-OFFLINE-RESERVED          VALUE 'B'.            CL**2
   793           88  CP-CRITICAL-PERIOD              VALUE 'C'.            CL**2
   794           88  CP-TERM-IS-DAYS                 VALUE 'D'.            CL**2
   795           88  CP-USE-PREM-AS-ENTERED          VALUE 'E'.            CL**2
   796           88  CP-FARM-PLAN                    VALUE 'F'.            CL**2
   797           88  CP-RATE-AS-STANDARD             VALUE 'G'.            CL**2
   798           88  CP-2-MTH-INTEREST               VALUE 'I'.            CL**2
   799           88  CP-3-MTH-INTEREST               VALUE 'J'.            CL**2
   800           88  CP-4-MTH-INTEREST               VALUE 'K'.            CL**2
   801           88  CP-BALLOON-LAST-PMT             VALUE 'L'.            CL**2
   802           88  CP-MORTGAGE-REC                 VALUE 'M'.            CL**2
   803           88  CP-OUTSTANDING-BALANCE          VALUE 'O'.            CL**2
   804           88  CP-NET-PAY-PRUDENTIAL           VALUE 'P'.            CL**2
   805           88  CP-NET-PAY-SIMPLE               VALUE 'S'.            CL**2
   806           88  CP-TRUNCATED-LIFE               VALUE 'T' 'U' 'V'     CL**2
   807                                                     'W' 'X'.        CL**2
   808           88  CP-TRUNCATE-0-MTH               VALUE 'T'.            CL**2
   809           88  CP-TRUNCATE-1-MTH               VALUE 'U'.            CL**2
   810           88  CP-TRUNCATE-2-MTH               VALUE 'V'.            CL**2
   811           88  CP-TRUNCATE-3-MTH               VALUE 'W'.            CL**2
   812           88  CP-TRUNCATE-4-MTH               VALUE 'X'.            CL**2
   813           88  CP-SUMMARY-REC                  VALUE 'Z'.            CL**2
   814           88  CP-PROPERTY-BENEFIT             VALUE '2'.            CL**2
   815           88  CP-UNEMPLOYMENT-BENEFIT         VALUE '3'.            CL**2
   816           88  CP-AD-D-BENEFIT                 VALUE '4'.            CL**2
   817           88  CP-CSL-METH-1                   VALUE '5'.            CL**2
   818           88  CP-CSL-METH-2                   VALUE '6'.            CL**2
   819           88  CP-CSL-METH-3                   VALUE '7'.            CL**2
   820           88  CP-CSL-METH-4                   VALUE '8'.            CL**2
   821                                                                     CL**2
   822         16  CP-LOAN-TERM          PIC S9(3)       VALUE ZERO        CL**2
   823                                     COMP-3.                         CL**2
   824         16  CP-CLASS-CODE         PIC XX          VALUE ZERO.       CL**2
   825         16  CP-DEVIATION-CODE     PIC XXX         VALUE ZERO.       CL**2
   826         16  CP-STATE              PIC XX          VALUE SPACE.      CL**2
   827         16  CP-STATE-STD-ABBRV    PIC XX          VALUE SPACE.      CL**2
   828         16  CP-BENEFIT-CD         PIC XX          VALUE ZERO.       CL**2
   829           88  CP-CSL-VALID-NP-BENEFIT-CD VALUES '12' '13'           CL**2
   830               '34' '35' '36' '37' '44' '45' '46' '47' '72' '73'.    CL**2
   831         16  CP-R78-OPTION         PIC X.                            CL**2
   832           88  CP-TERM-TIMES-TERM-PLUS-1           VALUE ' '.        CL**2
   833           88  CP-TERM-TIMES-TERM                  VALUE '1'.        CL**2
   834                                                                     CL**2
   835         16  CP-COMPANY-CD         PIC X             VALUE SPACE.    CL**2
   836         16  CP-IBNR-RESERVE-SW    PIC X.                            CL**2
   837         16  CP-CLAIM-STATUS       PIC X.                            CL**2
   838         16  CP-RATE-FILE          PIC X.                            CL**2
   839         16  CP-TERM-OR-EXT-DAYS   PIC S9(05)        VALUE ZERO      CL**2
   840                                     COMP-3.                         CL**2
   841                                                                     CL**2
   842         16  CP-LIFE-OVERRIDE-CODE PIC X.                            CL**2
   843         16  CP-AH-OVERRIDE-CODE   PIC X.                            CL**2
   844                                                                     CL**2
   845         16  CP-RATE-DEV-PCT       PIC S9V9(6)       VALUE ZERO      CL**2
   846                                     COMP-3.
   847         16  CP-CLP-RATE-UP        REDEFINES CP-RATE-DEV-PCT
   848                                   PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  18
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   849         16  CP-CRITICAL-MONTHS    PIC S9(3)         VALUE ZERO      CL**2
   850                                     COMP-3.                         CL**2
   851         16  CP-ALTERNATE-BENEFIT  PIC S9(9)V99      VALUE ZERO      CL**2
   852                                     COMP-3.                         CL**2
   853         16  CP-ALTERNATE-PREMIUM  PIC S9(7)V99      VALUE ZERO      CL**2
   854                                     COMP-3.
   855         16  CP-DDF-CSO-ADMIN-FEE REDEFINES CP-ALTERNATE-PREMIUM
   856                                  PIC S9(7)V99 COMP-3.
   857                                                                     CL**2
   858         16  CP-PAID-FROM-DATE     PIC X(02).                        CL**2
   859         16  CP-CLAIM-CALC-METHOD  PIC X(01).                        CL**2
   860         16  CP-EXT-DAYS-CALC      PIC X.                            CL**2
   861           88  CP-EXT-NO-CHG                   VALUE ' '.            CL**2
   862           88  CP-EXT-CHG-LF                   VALUE '1'.            CL**2
   863           88  CP-EXT-CHG-AH                   VALUE '2'.            CL**2
   864           88  CP-EXT-CHG-LF-AH                VALUE '3'.            CL**2
   865         16  CP-DOMICILE-STATE     PIC XX.                           CL**2
   866         16  CP-CARRIER            PIC X.                            CL**2
   867         16  CP-REIN-FLAG          PIC X.                            CL**2
   868         16  CP-REM-TRM-CALC-OPTION PIC X.                           CL**2
   869           88  VALID-REM-TRM-CALC-OPTION    VALUE '1'                CL**2
   870                      '2' '3' '4' '5'.                               CL**2
   871           88  CP-CALC-OPTION-DEFAULT       VALUE '4'.               CL**2
   872           88  CP-CONSIDER-EXTENSION        VALUE '3' '4' '5'.       CL**2
   873           88  CP-30-DAY-MONTH              VALUE '1' '3' '5'.       CL**2
   874           88  CP-NO-EXT-30-DAY-MONTH       VALUE '1'.               CL**2
   875           88  CP-NO-EXT-ACTUAL-DAYS        VALUE '2'.               CL**2
   876           88  CP-EXT-30-DAY-MONTH          VALUE '3'.               CL**2
   877           88  CP-EXT-ACTUAL-DAYS           VALUE '4'.               CL**2
   878           88  CP-USE-EXP-AND-1ST-PMT       VALUE '5'.
   879         16  CP-SIG-SWITCH         PIC X.                            CL**2
   880         16  CP-RATING-METHOD      PIC X.                            CL**2
   881           88  CP-RATE-AS-R78                      VALUE '1' 'R'.    CL**2
   882           88  CP-RATE-AS-PRORATA                  VALUE '2' 'P'.    CL**2
   883           88  CP-RATE-AS-CALIF                    VALUE '3' 'C'.    CL**2
   884           88  CP-RATE-AS-TEXAS                    VALUE '4' 'T'.    CL**2
   885           88  CP-RATE-AS-FARM-PLAN                VALUE '4' 'T'.    CL**2
   886           88  CP-RATE-AS-NET-PAY                  VALUE '5' 'N'.    CL**2
   887           88  CP-RATE-AS-ANTICIPATION             VALUE '6' 'A'.    CL**2
   888           88  CP-RATE-AS-MEAN                     VALUE '8' 'M'.    CL**2
   889           88  CP-RATE-AS-REG-BALLOON              VALUE 'B'.        CL**2
   890         16  CP-SALES-TAX          PIC S9V9999     VALUE  ZEROS      CL**2
   891                                     COMP-3.                         CL**2
   892         16  CP-BEN-CATEGORY       PIC X.
   893         16  CP-DCC-LF-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   894         16  CP-DCC-ACT-COMM REDEFINES CP-DCC-LF-RATE
   895                                   PIC S99V9(5) COMP-3.
   896         16  CP-DCC-AH-RATE        PIC S99V9(5) COMP-3 VALUE +0.
   897         16  CP-DCC-PMF-COMM REDEFINES CP-DCC-AH-RATE
   898                                   PIC S99V9(5) COMP-3.
   899         16  CP-DAYS-TO-1ST-PMT    PIC S999     COMP-3 VALUE +0.
   900         16  CP-AH-BALLOON-SW      PIC X  VALUE ' '.
   901         16  CP-EXPIRE-DT          PIC XX.
   902         16  CP-LF-CLAIM-CALC-SW   PIC X  VALUE ' '.
   903         16  CP-DDF-HI-FACT        PIC S9V999   COMP-3 VALUE +0.
   904         16  CP-DDF-LO-FACT        PIC S9V999   COMP-3 VALUE +0.
   905         16  CP-DDF-CLP            PIC S9(5)V99 COMP-3 VALUE +0.
   906         16  CP-DDF-SPEC-CALC      PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  19
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   907             88  CP-CALC-GROSS-FEE        VALUE 'G'.
   908             88  CP-CALC-CLP              VALUE 'C'.
   909         16  CP-IU-RATE-UP         PIC S9(5)V99   COMP-3 VALUE +0.
   910         16  CP-CANCEL-REASON      PIC X.
   911         16  CP-DDF-ADMIN-FEES     PIC S9(5)V99 COMP-3 VALUE +0.
   912         16  CP-PMT-MODE           PIC X.
   913         16  CP-NO-OF-PMTS         PIC S999 COMP-3 VALUE +0.
   914         16  CP-1ST-YR-ALLOW       PIC S999V99 COMP-3 VALUE +0.
   915         16  CP-DDF-COMM-AND-MFEE  PIC S9(5)V99 COMP-3 VALUE +0.
   916         16  CP-DDF-YR1AF          PIC S9(5)V99 COMP-3 VALUE +0.
   917         16  FILLER                PIC X.
   918                                                                     CL**2
   919***************    OUTPUT FROM ELRESV   ************************     CL**2
   920                                                                     CL**2
   921         16  CP-CDT-TABLE          PIC 9             VALUE ZERO.     CL**2
   922                                                                     CL**2
   923         16  CP-CDT-FACTOR         PIC S9(5)V9(6)    VALUE ZERO      CL**2
   924                                     COMP-3.                         CL**2
   925         16  CP-PTC-RESERVE        PIC S9(7)V99   VALUE ZERO         CL**2
   926                                     COMP-3.                         CL**2
   927         16  CP-IBNR-RESERVE       PIC S9(7)V99   VALUE ZERO         CL**2
   928                                     COMP-3.                         CL**2
   929         16  CP-FUTURE-RESERVE     PIC S9(7)V99   VALUE ZERO         CL**2
   930                                     COMP-3.                         CL**2
   931         16  FILLER                PIC X(09).                        CL**2
   932***************    OUTPUT FROM ELRTRM   *************************    CL**2
   933                                                                     CL**2
   934         16  CP-REMAINING-TERM-1   PIC S9(4)V9    VALUE ZERO         CL**2
   935                                     COMP-3.                         CL**2
   936         16  CP-REMAINING-TERM-2   PIC S9(4)V9    VALUE ZERO         CL**2
   937                                     COMP-3.                         CL**2
   938         16  CP-REMAINING-TERM-3   PIC S9(4)V9    VALUE ZERO         CL**2
   939                                     COMP-3.                         CL**2
   940         16  CP-ODD-DAYS           PIC S9(3)      VALUE ZERO         CL**2
   941                                     COMP-3.                         CL**2
   942         16  FILLER                PIC X(12).                        CL**2
   943                                                                     CL**2
   944***************    OUTPUT FROM ELRAMT   *************************    CL**2
   945                                                                     CL**2
   946         16  CP-REMAINING-AMT      PIC S9(9)V99   VALUE ZERO         CL**2
   947                                     COMP-3.                         CL**2
   948         16  CP-REMAINING-AMT-PRV  PIC S9(9)V99   VALUE ZERO         CL**2
   949                                     COMP-3.                         CL**2
   950         16  FILLER                PIC X(12).                        CL**2
   951                                                                     CL**2
   952***************    OUTPUT FROM ELRATE   *************************    CL**2
   953                                                                     CL**2
   954         16  CP-CALC-PREMIUM       PIC S9(7)V99   VALUE ZERO         CL**2
   955                                     COMP-3.                         CL**2
   956         16  CP-PREMIUM-RATE       PIC S9(2)V9(5) VALUE ZERO         CL**2
   957                                     COMP-3.                         CL**2
   958         16  CP-MORTALITY-CODE     PIC X(4).                         CL**2
   959         16  CP-RATE-EDIT-FLAG     PIC X.                            CL**2
   960             88  CP-RATES-NEED-APR                  VALUE '1'.       CL**2
   961         16  CP-COMPOSITE-RATE     PIC S99V999    VALUE ZERO         CL**2
   962                                     COMP-3.                         CL**2
   963         16  CP-POLICY-FEE         PIC S9(3)V99 VALUE +0 COMP-3.     CL**2
   964         16  CP-LF-PREM            PIC S9(7)V99 VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  20
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
   965         16  CP-LF-BALLOON-PREM REDEFINES CP-LF-PREM
   966                                   PIC S9(7)V99 COMP-3.
   967         16  FILLER                PIC X(07).                        CL**2
   968                                                                     CL**2
   969***************    OUTPUT FROM ELRFND   *************************    CL**2
   970                                                                     CL**2
   971         16  CP-CALC-REFUND        PIC S9(7)V99   VALUE ZERO         CL**2
   972                                     COMP-3.                         CL**2
   973         16  CP-REFUND-TYPE-USED   PIC X.                            CL**2
   974           88  CP-R-AS-R78                         VALUE '1'.        CL**2
   975           88  CP-R-AS-PRORATA                     VALUE '2'.        CL**2
   976           88  CP-R-AS-CALIF                       VALUE '3'.        CL**2
   977           88  CP-R-AS-TEXAS                       VALUE '4'.        CL**2
   978           88  CP-R-AS-FARM-PLAN                   VALUE '4'.        CL**2
   979           88  CP-R-AS-NET-PAY                     VALUE '5'.        CL**2
   980           88  CP-R-AS-ANTICIPATION                VALUE '6'.        CL**2
   981           88  CP-R-AS-MEAN                        VALUE '8'.        CL**2
   982           88  CP-R-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
   983           88  CP-R-AS-GAP-NON-REFUND              VALUE 'G'.
   984           88  CP-R-AS-GAP-ACTUARIAL               VALUE 'S'.
   985           88  CP-R-AS-SPP-DDF                     VALUE 'D'.
   986           88  CP-R-AS-SPP-DDF-IU                  VALUE 'I'.
   987           88  CP-R-AS-REPOSSESSION                VALUE 'R'.
   988         16  FILLER                PIC X(12).                        CL**2
   989                                                                     CL**2
   990***************    OUTPUT FROM ELEARN   *************************    CL**2
   991                                                                     CL**2
   992         16  CP-R78-U-PRM          PIC S9(7)V99   VALUE ZERO         CL**2
   993                                     COMP-3.                         CL**2
   994         16  CP-R78-U-PRM-ALT      PIC S9(7)V99   VALUE ZERO         CL**2
   995                                     COMP-3.                         CL**2
   996         16  CP-PRORATA-U-PRM      PIC S9(7)V99   VALUE ZERO         CL**2
   997                                     COMP-3.                         CL**2
   998         16  CP-PRORATA-U-PRM-ALT  PIC S9(7)V99   VALUE ZERO         CL**2
   999                                     COMP-3.                         CL**2
  1000         16  CP-STATE-U-PRM        PIC S9(7)V99   VALUE ZERO         CL**2
  1001                                     COMP-3.                         CL**2
  1002         16  CP-DOMICILE-U-PRM     PIC S9(7)V99   VALUE ZERO         CL**2
  1003                                     COMP-3.                         CL**2
  1004         16  CP-EARNING-TYPE-USED  PIC X.                            CL**2
  1005           88  CP-E-AS-SPECIAL                     VALUE 'S'.        CL**2
  1006           88  CP-E-AS-R78                         VALUE '1'.        CL**2
  1007           88  CP-E-AS-PRORATA                     VALUE '2'.        CL**2
  1008           88  CP-E-AS-TEXAS                       VALUE '4'.        CL**2
  1009           88  CP-E-AS-FARM-PLAN                   VALUE '4'.        CL**2
  1010           88  CP-E-AS-NET-PAY                     VALUE '5'.        CL**2
  1011           88  CP-E-AS-ANTICIPATION                VALUE '6'.        CL**2
  1012           88  CP-E-AS-MEAN                        VALUE '8'.        CL**2
  1013           88  CP-E-AS-SUM-OF-DIGITS               VALUE '9'.        CL**2
  1014         16  FILLER                PIC X(12).                        CL**2
  1015                                                                     CL**2
  1016***************    OUTPUT FROM ELPMNT   *************************    CL**2
  1017                                                                     CL**2
  1018         16  CP-ACTUAL-DAYS        PIC S9(05)     VALUE ZERO         CL**2
  1019                                     COMP-3.                         CL**2
  1020         16  CP-CLAIM-PAYMENT      PIC S9(7)V99   VALUE ZERO         CL**2
  1021                                     COMP-3.                         CL**2
  1022         16  FILLER                PIC X(12).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  21
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1023                                                                     CL**2
  1024***************   MISC WORK AREAS    *****************************   CL**2
  1025         16  CP-TOTAL-PAID         PIC S9(7)V99   VALUE ZERO         CL**2
  1026                                     COMP-3.                         CL**2
  1027         16  CP-R-MAX-ATT-AGE      PIC S9(3)      VALUE ZERO         CL**2
  1028                                     COMP-3.                         CL**2
  1029         16  CP-R-MAX-AGE          PIC S9(3)      VALUE ZERO         CL**2
  1030                                     COMP-3.                         CL**2
  1031         16  CP-R-MAX-TERM         PIC S9(5)      VALUE ZERO         CL**2
  1032                                     COMP-3.                         CL**2
  1033         16  CP-R-MAX-TOT-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1034                                     COMP-3.                         CL**2
  1035         16  CP-R-MAX-MON-BEN      PIC S9(7)V99   VALUE ZERO         CL**2
  1036                                     COMP-3.                         CL**2
  1037         16  CP-IO-FUNCTION        PIC X          VALUE SPACE.       CL**2
  1038             88  OPEN-RATE-FILE                   VALUE 'O'.         CL**2
  1039             88  CLOSE-RATE-FILE                  VALUE 'C'.         CL**2
  1040             88  IO-ERROR                         VALUE 'E'.         CL**2
  1041                                                                     CL**2
  1042         16  CP-FIRST-PAY-DATE     PIC XX.                           CL**2
  1043                                                                     CL**2
  1044         16  CP-JOINT-INDICATOR    PIC X.                            CL**2
  1045                                                                     CL**2
  1046         16  CP-RESERVE-REMAINING-TERM                               CL**2
  1047                                   PIC S9(4)V9    VALUE ZERO         CL**2
  1048                                     COMP-3.                         CL**2
  1049                                                                     CL**2
  1050         16  CP-INSURED-BIRTH-DT   PIC XX.                           CL**2
  1051                                                                     CL**2
  1052         16  CP-INCURRED-AGE       PIC S9(3)      VALUE ZERO         CL**2
  1053                                     COMP-3.                         CL**2
  1054                                                                     CL**2
  1055         16  CP-MONTHLY-PAYMENT    PIC S9(5)V99   VALUE ZERO         CL**2
  1056                                     COMP-3.                         CL**2
  1057                                                                     CL**2
  1058         16  CP-RATING-BENEFIT-AMT PIC S9(9)V99   VALUE ZERO         CL**2
  1059                                     COMP-3.                         CL**2
  1060                                                                     CL**2
  1061         16  CP-ODD-DAYS-TO-PMT    PIC S9(3)      VALUE ZERO         CL**2
  1062                                     COMP-3.                         CL**2
  1063                                                                     CL**2
  1064         16  CP-MNTHS-TO-FIRST-PMT PIC S9(3)      VALUE ZERO         CL**2
  1065                                     COMP-3.                         CL**2
  1066                                                                     CL**2
  1067         16  CP-REMAMT-FACTOR      PIC S9(4)V9(9) VALUE ZEROS        CL**2
  1068                                     COMP-3.                         CL**2
  1069                                                                     CL**2
  1070         16  CP-FREE-LOOK          PIC S9(3)      VALUE ZERO         CL**2
  1071                                     COMP-3.                         CL**2
  1072                                                                     CL**2
  1073         16  CP-ROA-REFUND         PIC X          VALUE 'N'.         CL**2
  1074             88  CP-ROA-PREM-AT-REFUND            VALUE 'Y'.         CL**2
  1075                                                                     CL**2
  1076         16  CP-NET-BENEFIT-AMT    PIC S9(9)V99   VALUE ZERO         CL**2
  1077                                     COMP-3.                         CL**2
  1078         16  CP-SCNP-6MO-AMT       PIC S9(9)V99   VALUE ZERO
  1079                                     COMP-3.
  1080         16  CP-MONTH              PIC S999     COMP-3 VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  22
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCCALC)
  1081         16  cp-extra-periods      pic 9 value zeros.
  1082         16  cp-net-only-state     pic x value spaces.
  1083         16  FILLER                PIC X(13).                        CL**2
  1084******************************************************************   CL**2
  1085
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  23
* ELRFNDXP.cbl
  1087 PROCEDURE DIVISION  USING CALCULATION-PASS-AREA.
  1088
  1089 000-START-REFUND-CALC.
* 1090                       COPY ELCRFNDPP.
  1091****************************************************************
  1092*                                                              *
  1093*                            ELCRFNDP.                         *
  1094*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1095*                            VMOD=2.028                        *
  1096*                                                              *
  1097****************************************************************.
  1098*                   C H A N G E   L O G
  1099*
  1100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1101*-----------------------------------------------------------------
  1102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1103* EFFECTIVE    NUMBER
  1104*-----------------------------------------------------------------
  1105* 042203                   PEMA ADD SPECIAL IN CALC FOR CID
  1106* 033104    2003080800002  PEMA ADD GAP NON REFUNDABLE OPTION
  1107* 042904    2003080800002  PEMA ADD ACTUARIAL EARNING METHOD
  1108******************************************************************
  1109
  1110     MOVE ZERO                   TO  CP-RETURN-CODE
  1111                                     CP-CALC-REFUND.
  1112     MOVE SPACE                  TO  CP-REFUND-TYPE-USED.
  1113
  1114 0001-GET-CANCEL-TYPE.
  1115     IF CP-CERT-EFF-DT = CP-VALUATION-DT
  1116        MOVE CP-ORIGINAL-PREMIUM TO CP-CALC-REFUND
  1117        GO TO 1999-CALC-REF-AMT-X.
  1118
  1119     IF CP-REMAINING-TERM = ZERO   OR
  1120        CP-REMAINING-TERM NEGATIVE
  1121          MOVE ZERO TO CP-CALC-REFUND
  1122          GO TO 1999-CALC-REF-AMT-X.
  1123
  1124     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1125     MOVE SPACE              TO DC-OPTION-CODE.
  1126     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1127
  1128     IF DATE-CONVERSION-ERROR
  1129         MOVE '2' TO CP-RETURN-CODE
  1130         GO TO 1999-CALC-REF-AMT-X.
  1131
  1132     IF CP-AH
  1133        GO TO 1030-GET-AH-REFUND.
  1134
  1135********************    LIFE REFUNDS    **************************
  1136
  1137     IF CP-TERM-OR-EXT-DAYS NOT NUMERIC
  1138         MOVE +0                TO CP-TERM-OR-EXT-DAYS.
  1139
  1140     IF CP-LOAN-TERM NOT NUMERIC
  1141         MOVE +0                TO CP-LOAN-TERM.
  1142
  1143     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1144
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  24
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1145     COMPUTE R78-FACTOR =
  1146            (CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1147              (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1148************************************************************
  1149***       ADDED IF CONDITION FOR TESTING PURPOSES.       ***
  1150***---------------------------------------------------------
  1151     IF CP-TRUNCATED-LIFE
  1152        MOVE  CP-LOAN-TERM         TO  WS-RATE-TERM
  1153     ELSE
  1154        MOVE  CP-ORIGINAL-TERM     TO  WS-RATE-TERM.
  1155***
  1156************************************************************
  1157**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1158**** FOLLOWING.
  1159****       FOR NC. LIFE..
  1160****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1161****  TRUNCATED NET COVERAGE --- TERM > 60 USE RULE OF ANTIC.
  1162****                             TERM <= 60 USE SUM OF DIGITS.
  1163****  DECREASING COVERAGE    --- EFF DATE > 093081 AND
  1164****                             TERM > 60 USE RULE OF ANTIC
  1165****                             OTHERWISE USE RULE OF 78.
  1166****
  1167****
  1168
  1169     IF (CP-COMPANY-ID = 'NCL') AND
  1170        (CP-STATE-STD-ABBRV = 'NC')
  1171        IF CP-LEVEL-LIFE
  1172           GO TO 1023-REF-PR
  1173        ELSE
  1174        IF CP-EARN-AS-NET-PAY AND
  1175           CP-TRUNCATED-LIFE
  1176           IF CP-ORIGINAL-TERM GREATER THAN 60
  1177              GO TO 1021-ANTICIPATION-REF
  1178           ELSE
  1179              GO TO 1026-REF-R78
  1180        ELSE
  1181        IF CP-REDUCING-LIFE
  1182           IF (DC-GREG-DATE-CYMD  GREATER 19810930 AND
  1183              CP-ORIGINAL-TERM GREATER THAN 60)
  1184              GO TO 1021-ANTICIPATION-REF
  1185           ELSE
  1186              GO TO 1075-SUM-OF-DIGITS.
  1187
  1188****
  1189**** THE FOLLOWING IF STATEMENT FOR CID ONLY SHOULD DO THE
  1190**** FOLLOWING.
  1191****       FOR OH. LIFE..
  1192****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1193****  NET/NET TRUNCATED      --- TERM > 60 USE RULE OF ANTIC.
  1194****  GROSS DECREASING       --- RULE OF 78
  1195****
  1196****
  1197
  1198     IF (CP-COMPANY-ID = 'CID') AND
  1199        (CP-STATE-STD-ABBRV = 'OH') AND
  1200        (CP-CLASS-CODE NOT = 'L ')
  1201        IF CP-LEVEL-LIFE
  1202           GO TO 1023-REF-PR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  25
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1203        ELSE
  1204           IF (CP-ORIGINAL-TERM > 60) OR
  1205              (CP-EARN-AS-NET-PAY)
  1206              GO TO 1028-NET-PAY-REFUND
  1207           ELSE
  1208              GO TO 1026-REF-R78
  1209           END-IF
  1210        END-IF
  1211     END-IF
  1212
  1213**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1214**** FOLLOWING.
  1215****       FOR VA. LIFE..
  1216****  LEVEL LIFE COVERAGES   --- REFUND AS PRO RATA.
  1217****           NET COVERAGES --- USE RULE OF ANTIC.
  1218****  DECREASING COVERAGE    --- EFF DATE < 010193 USE R78.
  1219****                         --- EFF DATE > 123194 USE ANTIC.
  1220****                         --- EFF DATE BETWEEN 010193 AND 12319
  1221****                             WITH TERM > 61 USE RULE OF ANTIC
  1222****                             OTHERWISE USE RULE OF 78.
  1223****
  1224****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1225****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1226****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1227****            WILL FOLLOW.
  1228****
  1229****
  1230****
  1231
  1232     IF (CP-COMPANY-ID = 'NCL') AND
  1233        (CP-STATE-STD-ABBRV = 'VA')
  1234        IF CP-LEVEL-LIFE
  1235           GO TO 1023-REF-PR
  1236        ELSE
  1237        IF CP-EARN-AS-NET-PAY
  1238           GO TO 1021-ANTICIPATION-REF
  1239        ELSE
  1240        IF CP-REDUCING-LIFE
  1241           IF DC-GREG-DATE-CYMD LESS THAN 19930101
  1242              GO TO 1026-REF-R78
  1243           ELSE
  1244           IF DC-GREG-DATE-CYMD GREATER THAN 19941231
  1245              GO TO 1021-ANTICIPATION-REF
  1246           ELSE
  1247           IF CP-ORIGINAL-TERM GREATER THAN 61
  1248              GO TO 1021-ANTICIPATION-REF
  1249           ELSE
  1250              GO TO 1026-REF-R78.
  1251
  1252     IF (CP-COMPANY-ID = 'CID')
  1253        AND (CP-STATE-STD-ABBRV = 'IN')
  1254        AND (DC-GREG-DATE-CYMD < 20030401)
  1255        IF CP-REDUCING-LIFE
  1256           GO TO 1026-REF-R78
  1257        ELSE
  1258           IF CP-LEVEL-LIFE
  1259              GO TO 1023-REF-PR
  1260           END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  26
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1261        END-IF
  1262     END-IF
  1263
  1264     IF (CP-COMPANY-ID = 'CID')
  1265        AND (CP-STATE-STD-ABBRV = 'FL')
  1266        AND (DC-GREG-DATE-CYMD > 20030630)
  1267        IF CP-RATE-AS-NET-PAY
  1268           GO TO 1028-NET-PAY-REFUND
  1269        END-IF
  1270     END-IF
  1271
  1272     IF (CP-COMPANY-ID = 'CID')
  1273        AND (CP-STATE-STD-ABBRV = 'MO')
  1274        AND (DC-GREG-DATE-CYMD > 20030630)
  1275        AND (CP-LOAN-TERM < +121)
  1276        IF CP-RATE-AS-NET-PAY
  1277           GO TO 1028-NET-PAY-REFUND
  1278        END-IF
  1279     END-IF
  1280
  1281     IF (CP-COMPANY-ID = 'CID')
  1282        AND (CP-STATE-STD-ABBRV = 'ND')
  1283        AND (DC-GREG-DATE-CYMD > 20011231)
  1284        AND (CP-REDUCING-LIFE)
  1285        GO TO 1021-ANTICIPATION-REF
  1286     END-IF
  1287
  1288     IF CP-CRITICAL-PERIOD
  1289        IF CP-COMPANY-ID = 'NCL'
  1290           NEXT SENTENCE
  1291        ELSE
  1292           GO TO 1022-REF-CRITICAL-PERIOD-LF.
  1293
  1294     IF CP-TERM-IS-DAYS  AND
  1295        CP-TERM-OR-EXT-DAYS GREATER ZERO
  1296         GO TO 1024-REF-PR-DAYS.
  1297
  1298     IF CP-STATE-STD-ABBRV = 'NM'
  1299       IF CP-REDUCING-LIFE
  1300*        IF DC-GREG-DATE-1-YMD LESS THAN '980901'
  1301         IF DC-GREG-DATE-CYMD LESS THAN 19980901
  1302             GO TO 1026-REF-R78.
  1303
  1304     IF CP-EARN-ANTICIPATION
  1305         GO TO 1021-ANTICIPATION-REF.
  1306
  1307     IF CP-STATE-STD-ABBRV = 'ME'
  1308         IF CP-COMPANY-ID = 'NCL' OR 'CVL'
  1309            NEXT SENTENCE
  1310         ELSE
  1311            IF CP-REDUCING-LIFE
  1312               GO TO 1021-ANTICIPATION-REF.
  1313
  1314     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1315        IF CP-STATE-STD-ABBRV = 'TX'
  1316            GO TO SKIP-CSO-TEXAS-LIFE-PROCESSING
  1317        END-IF
  1318     END-IF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  27
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1319
  1320     IF CP-STATE-STD-ABBRV = 'TX'
  1321       IF CP-COMPANY-ID EQUAL 'HER' OR 'NCL'
  1322          NEXT SENTENCE
  1323       END-IF
  1324        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1325           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1326           GO TO 1021-ANTICIPATION-REF.
  1327
  1328 SKIP-CSO-TEXAS-LIFE-PROCESSING.
  1329
  1330     IF CP-EARN-BY-PRORATA
  1331         GO TO 1023-REF-PR.
  1332
  1333     IF CP-EARN-AS-MEAN
  1334         GO TO 1025-REF-MEAN.
  1335
  1336     IF CP-EARN-AS-TEXAS
  1337         GO TO 1027-TEXAS-REFUND.
  1338
  1339     IF CP-EARN-AS-NET-PAY
  1340         GO TO 1028-NET-PAY-REFUND.
  1341
  1342     IF CP-LIFE-OVERRIDE-CODE NOT = 'L'
  1343         GO TO 1000-NO-NET-PAY.
  1344
  1345     IF  CP-COMPANY-ID IS EQUAL TO 'CID' OR 'CSO'
  1346       IF CP-STATE-STD-ABBRV = 'NC'
  1347         IF CP-REDUCING-LIFE
  1348           IF CP-ORIGINAL-TERM GREATER 60  AND
  1349              DC-GREG-DATE-CYMD GREATER 19810930
  1350                GO TO 1028-NET-PAY-REFUND
  1351           ELSE
  1352              GO TO 1026-REF-R78.
  1353
  1354
  1355     IF CP-STATE-STD-ABBRV = 'NC'
  1356       IF CP-COMPANY-ID EQUAL 'NCL'
  1357          NEXT SENTENCE
  1358       END-IF
  1359       IF CP-REDUCING-LIFE
  1360         IF CP-ORIGINAL-TERM GREATER 60  AND
  1361            DC-GREG-DATE-CYMD GREATER 19810930
  1362             GO TO 1021-ANTICIPATION-REF
  1363         ELSE
  1364             GO TO 1026-REF-R78.
  1365
  1366     IF CP-STATE-STD-ABBRV = 'UT'
  1367       IF CP-COMPANY-ID EQUAL 'NCL'
  1368          NEXT SENTENCE
  1369       END-IF
  1370         IF CP-ORIGINAL-TERM GREATER 62         AND
  1371            CP-LOAN-APR GREATER ZERO            AND
  1372            DC-GREG-DATE-CYMD GREATER 19810831 AND
  1373            DC-GREG-DATE-CYMD LESS    19830901
  1374             GO TO 1028-NET-PAY-REFUND
  1375         ELSE
  1376             GO TO 1026-REF-R78.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  28
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1377
  1378     IF CP-STATE-STD-ABBRV = 'OH'
  1379       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1380          NEXT SENTENCE
  1381       END-IF
  1382           IF CP-ORIGINAL-TERM GREATER 60         AND
  1383              CP-CLASS-CODE NOT = 'L '            AND
  1384              CP-LOAN-APR GREATER ZERO            AND
  1385              DC-GREG-DATE-CYMD GREATER 19831031
  1386              GO TO 1028-NET-PAY-REFUND
  1387           ELSE
  1388              GO TO 1026-REF-R78.
  1389
  1390     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1391       IF CP-STATE-STD-ABBRV = 'MT'
  1392         GO TO SKIP-CSO-MT-LF-PROCESSING.
  1393
  1394
  1395     IF CP-STATE-STD-ABBRV = 'MT'
  1396       IF CP-COMPANY-ID EQUAL 'NCL'
  1397          NEXT SENTENCE
  1398       END-IF
  1399         IF CP-ORIGINAL-TERM GREATER 61         AND
  1400            CP-LOAN-APR GREATER ZERO            AND
  1401            DC-GREG-DATE-CYMD GREATER 19830318
  1402             GO TO 1028-NET-PAY-REFUND
  1403         ELSE
  1404             GO TO 1026-REF-R78.
  1405
  1406 SKIP-CSO-MT-LF-PROCESSING.
  1407
  1408     IF CP-STATE-STD-ABBRV = 'RI'
  1409       IF CP-COMPANY-ID EQUAL 'NCL'
  1410          NEXT SENTENCE
  1411       END-IF
  1412         IF CP-ORIGINAL-TERM GREATER 60         AND
  1413            CP-LOAN-APR GREATER ZERO            AND
  1414            DC-GREG-DATE-CYMD GREATER 19831231
  1415             GO TO 1028-NET-PAY-REFUND
  1416         ELSE
  1417             GO TO 1026-REF-R78.
  1418
  1419
  1420 1000-NO-NET-PAY.
  1421
  1422     IF CP-STATE-STD-ABBRV = 'WY'
  1423       IF CP-COMPANY-ID EQUAL 'NCL'
  1424          NEXT SENTENCE
  1425       END-IF
  1426        IF CP-COMPANY-ID = 'TMS'
  1427           GO TO 1026-REF-R78
  1428        ELSE
  1429           GO TO 1023-REF-PR.
  1430
  1431     IF CP-EARN-BY-R78
  1432         GO TO 1026-REF-R78.
  1433
  1434     IF CP-EARN-AS-SUM-OF-DIGITS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  29
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1435         GO TO 1075-SUM-OF-DIGITS.
  1436
  1437     IF CP-LEVEL-LIFE
  1438         GO TO 1023-REF-PR
  1439     ELSE
  1440         GO TO 1026-REF-R78.
  1441
  1442*-----------------------------------------------------------------
  1443 1021-ANTICIPATION-REF.
  1444
  1445     DISPLAY ' MADE IT TO 1021 YEA '
  1446     MOVE '6'                  TO CP-REFUND-TYPE-USED.
  1447
  1448     MOVE CP-LOAN-TERM         TO WS-SAVE-LOAN-TERM.
  1449     COMPUTE CP-LOAN-TERM = CP-LOAN-TERM - CP-ORIGINAL-TERM +
  1450                            CP-REMAINING-TERM.
  1451
  1452     MOVE CP-ORIGINAL-BENEFIT  TO WS-SAVE-BENEFIT.
  1453     MOVE CP-ORIGINAL-TERM     TO WS-SAVE-TERM.
  1454     MOVE CP-EARNING-METHOD    TO WS-SAVE-EARN-METHOD.
  1455
  1456     MOVE CP-REMAINING-BENEFIT TO CP-ORIGINAL-BENEFIT.
  1457     MOVE CP-REMAINING-TERM    TO CP-ORIGINAL-TERM.
  1458     MOVE CP-RATING-METHOD     TO CP-EARNING-METHOD.
  1459
  1460     IF CP-REMAINING-TERM = WS-SAVE-TERM
  1461         MOVE 'N'              TO CP-ROA-REFUND
  1462     ELSE
  1463         MOVE 'Y'              TO CP-ROA-REFUND.
  1464
  1465******    TO COMPUTE PREMIUM AT REFUND DATE
  1466     PERFORM 2500-GET-RATE.
  1467
  1468     DISPLAY ' FIRST PREM ' CP-CALC-PREMIUM
  1469     MOVE 'N'                  TO CP-ROA-REFUND.
  1470     MOVE WS-SAVE-BENEFIT      TO CP-ORIGINAL-BENEFIT.
  1471     MOVE WS-SAVE-TERM         TO CP-ORIGINAL-TERM.
  1472     MOVE WS-SAVE-LOAN-TERM    TO CP-LOAN-TERM.
  1473
  1474     IF CP-PREMIUM-RATE = ZEROS
  1475        MOVE '7'                 TO CP-RETURN-CODE
  1476        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1477        GO TO 1999-CALC-REF-AMT-X.
  1478
  1479     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1480
  1481******    TO COMPUTE PREMIUM AT ORIGINAL ISSUE DATE
  1482     PERFORM 2500-GET-RATE.
  1483
  1484     DISPLAY ' SECOND PREM ' CP-CALC-PREMIUM
  1485
  1486     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1487
  1488     IF CP-PREMIUM-RATE = ZEROS
  1489        MOVE '7'            TO CP-RETURN-CODE
  1490        GO TO 1999-CALC-REF-AMT-X.
  1491
  1492     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  30
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1493
  1494     IF  WS-ORIG-PREM = ZEROS
  1495         MOVE ZEROS TO WS-NP-REF-FACTOR
  1496        ELSE
  1497         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1498                                            WS-ORIG-PREM.
  1499
  1500     DISPLAY ' WS REM PREM  ' WS-REMAIN-PREM
  1501     DISPLAY ' WS ORIG PREM ' WS-ORIG-PREM
  1502     DISPLAY ' WS NP FACT   ' WS-NP-REF-FACTOR
  1503
  1504     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1505                                        CP-ORIGINAL-PREMIUM.
  1506
  1507     GO TO 1999-CALC-REF-AMT-X.
  1508
  1509*---------------------------------------------------------------
  1510 1022-REF-CRITICAL-PERIOD-LF.
  1511     GO TO 1023-REF-PR.
  1512
  1513*---------------------------------------------------------------
  1514 1023-REF-PR.
  1515     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1516     COMPUTE CP-CALC-REFUND ROUNDED =
  1517            CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1518
  1519     GO TO 1999-CALC-REF-AMT-X.
  1520
  1521*---------------------------------------------------------------
  1522 1024-REF-PR-DAYS.
  1523     MOVE CP-CERT-EFF-DT     TO DC-BIN-DATE-1.
  1524     MOVE CP-VALUATION-DT    TO DC-BIN-DATE-2.
  1525     MOVE '1'                TO DC-OPTION-CODE.
  1526     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.
  1527
  1528     IF DATE-CONVERSION-ERROR
  1529         MOVE '2' TO CP-RETURN-CODE
  1530         GO TO 1999-CALC-REF-AMT-X.
  1531
  1532     COMPUTE CP-CALC-REFUND ROUNDED =
  1533         (CP-ORIGINAL-PREMIUM / CP-TERM-OR-EXT-DAYS) *
  1534                 (CP-TERM-OR-EXT-DAYS - DC-ELAPSED-DAYS).
  1535
  1536     GO TO 1999-CALC-REF-AMT-X.
  1537
  1538*---------------------------------------------------------------
  1539 1025-REF-MEAN.
  1540     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1541     COMPUTE CP-CALC-REFUND ROUNDED =
  1542          ((CP-ORIGINAL-PREMIUM * PR-FACTOR) +
  1543           (CP-ORIGINAL-PREMIUM * R78-FACTOR)) * +.5.
  1544
  1545     GO TO 1999-CALC-REF-AMT-X.
  1546
  1547*---------------------------------------------------------------
  1548 1026-REF-R78.
  1549     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1550*    IF CP-TERM-TIMES-TERM
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  31
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1551*        COMPUTE R78-FACTOR =
  1552*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1553*               (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1554*
  1555     COMPUTE CP-CALC-REFUND ROUNDED =
  1556        CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1557
  1558     GO TO 1999-CALC-REF-AMT-X.
  1559
  1560*---------------------------------------------------------------
  1561 1027-TEXAS-REFUND.
  1562     MOVE '4'               TO CP-REFUND-TYPE-USED.
  1563     IF CP-PAY-FREQUENCY = ZERO
  1564        MOVE ZERO TO CP-CALC-REFUND
  1565        MOVE '5'  TO CP-RETURN-CODE
  1566        GO TO 1999-CALC-REF-AMT-X.
  1567
  1568     COMPUTE TEX-FACT-4 = (CP-ORIGINAL-TERM * CP-ORIGINAL-TERM) +
  1569         (CP-PAY-FREQUENCY * CP-ORIGINAL-TERM).
  1570
  1571     DIVIDE CP-REMAINING-TERM BY CP-PAY-FREQUENCY
  1572         GIVING TEX-FACT-5
  1573             REMAINDER TEX-FACT-6.
  1574
  1575     COMPUTE TEX-FACT-5 = TEX-FACT-5 * CP-PAY-FREQUENCY.
  1576
  1577     COMPUTE TEX-FACT-7 = (TEX-FACT-5 * TEX-FACT-5) +
  1578         (TEX-FACT-5 * CP-PAY-FREQUENCY) +
  1579         (2 * (TEX-FACT-6 * (TEX-FACT-5 + CP-PAY-FREQUENCY))).
  1580
  1581     COMPUTE TEX-FACT-8 ROUNDED = TEX-FACT-7 / TEX-FACT-4.
  1582
  1583     COMPUTE CP-CALC-REFUND ROUNDED = CP-ORIGINAL-PREMIUM
  1584                                        * TEX-FACT-8.
  1585
  1586     GO TO 1999-CALC-REF-AMT-X.
  1587
  1588*---------------------------------------------------------------
  1589 1028-NET-PAY-REFUND.
  1590     MOVE '5'               TO CP-REFUND-TYPE-USED.
  1591     IF CP-LOAN-APR = ZERO
  1592        MOVE ZERO TO CP-CALC-REFUND
  1593        MOVE '1'  TO CP-RETURN-CODE
  1594        GO TO 1999-CALC-REF-AMT-X.
  1595
  1596     MOVE CP-LOAN-APR           TO N-P-APR.
  1597     MOVE CP-ORIGINAL-TERM      TO N-P-ORIG  N-P-LOAN.
  1598     MOVE CP-REMAINING-TERM     TO N-P-REM.
  1599
  1600     IF CP-TRUNCATED-LIFE
  1601        MOVE CP-LOAN-TERM     TO N-P-LOAN.
  1602
  1603     MOVE 'R'                   TO N-P-OPT.
  1604
  1605     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1606
  1607     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1608                                        CP-ORIGINAL-PREMIUM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  32
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1609
  1610 1029-UTAH-REFUND.
  1611*
  1612*---------------------------------------------------------------
  1613* FOLLOWING IS FOR TRISH - 10/26/98  (FOR UTAH ONLY).
  1614*---------------------------------------------------------------
  1615*
  1616     GO TO 1999-CALC-REF-AMT-X.
  1617*
  1618*---------------------------------------------------------------
  1619     IF (CP-STATE-STD-ABBRV NOT = 'UT')
  1620                      OR
  1621        (CP-COMPANY-ID EQUAL 'NCL')
  1622         GO TO 1999-CALC-REF-AMT-X.
  1623     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1624
  1625     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1626        GREATER ZERO AND LESS 13
  1627         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1628                 (CP-CALC-REFUND * .05).
  1629
  1630     IF (CP-ORIGINAL-TERM - CP-REMAINING-TERM)
  1631        GREATER 12 AND LESS 25
  1632         COMPUTE CP-CALC-REFUND = CP-CALC-REFUND -
  1633                 (CP-CALC-REFUND * .025).
  1634
  1635     GO TO 1999-CALC-REF-AMT-X.
  1636*---------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  33
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1638*---------------------------------------------------------------
  1639 1030-GET-AH-REFUND.
  1640     COMPUTE PR-FACTOR = CP-REMAINING-TERM / CP-ORIGINAL-TERM.
  1641
  1642     COMPUTE R78-FACTOR =
  1643            ((CP-REMAINING-TERM * (CP-REMAINING-TERM + 1)) /
  1644                (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1))).
  1645
  1646*    IF CP-TERM-TIMES-TERM
  1647*        COMPUTE R78-FACTOR =
  1648*            (CP-REMAINING-TERM * CP-REMAINING-TERM) /
  1649*            (CP-ORIGINAL-TERM * (CP-ORIGINAL-TERM + 1)).
  1650*
  1651
  1652**** THE FOLLOWING IF STATEMENT FOR NCL ONLY SHOULD DO THE
  1653**** FOLLOWING.
  1654****       FOR VA. DISABILITY
  1655****                         --- EFF DATE > 123192 AND
  1656****                             TERM > 61 USE RULE OF ANTIC
  1657****                             OTHERWISE USE RULE OF 78.
  1658****
  1659****    NOTE... PER NCL WE SHOULD NOT INCLUDE THEM IN ANY
  1660****            OF THE SYSTEM DEFAULT STATUTORY REFUND RULES.
  1661****            NCL WILL SUPPLY US WITH THE STATUTORY RULES THEY
  1662****            WILL FOLLOW.
  1663****
  1664****
  1665****
  1666     IF CP-COMPANY-ID EQUAL 'NCL'
  1667        IF CP-STATE-STD-ABBRV = 'VA'
  1668           IF (DC-GREG-DATE-CYMD GREATER 19921231) AND
  1669              (CP-ORIGINAL-TERM GREATER THAN 61)
  1670               MOVE '6'        TO CP-EARNING-METHOD
  1671               GO TO 1060-ANTICIPATION-REF
  1672            ELSE
  1673               MOVE '1'        TO CP-EARNING-METHOD
  1674               GO TO 1050-R78-REF.
  1675
  1676     IF CP-STATE-STD-ABBRV = 'WY'
  1677        IF CP-COMPANY-ID = 'TMS'
  1678           GO TO 1050-R78-REF.
  1679
  1680     IF CP-COMPANY-ID = 'NCL' OR 'WDS' OR 'CID' OR 'DCC'
  1681         NEXT SENTENCE
  1682     ELSE
  1683         IF CP-CRITICAL-PERIOD
  1684             GO TO 1035-REF-AH-CRITICAL-PERIOD.
  1685
  1686
  1687*      THE FOLLOWING HAPPENS WHEN THE REFUND METHOD FOR THE
  1688*    BENEFIT CODE IS A NON REFUNDABLE METHOD
  1689*    I AM CHECKING THE TERM AND REM TERM BECAUSE OF THE 30
  1690*    DAY FREE LOOK PERIOD
  1691
  1692     IF CP-GAP-NON-REFUNDABLE
  1693        IF CP-ORIGINAL-TERM NOT = CP-REMAINING-TERM
  1694           MOVE ZEROS            TO CP-CALC-REFUND
  1695           MOVE 'G'              TO CP-REFUND-TYPE-USED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  34
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1696           GO TO 1999-CALC-REF-AMT-X
  1697        END-IF
  1698     END-IF
  1699
  1700     IF CP-GAP-ACTUARIAL
  1701         GO TO 1070-NET-PAY-REFUND
  1702     END-IF
  1703
  1704     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1705        IF CP-STATE-STD-ABBRV = 'NC'
  1706           GO TO SKIP-CSO-NC-AH-PROCESSING.
  1707
  1708     IF (CP-COMPANY-ID = 'CID')
  1709        AND (CP-STATE-STD-ABBRV = 'IN')
  1710        AND (DC-GREG-DATE-CYMD < 20030401)
  1711        GO TO 1026-REF-R78
  1712     END-IF
  1713
  1714     IF (CP-COMPANY-ID = 'CID')
  1715        AND (CP-STATE-STD-ABBRV = 'FL')
  1716        AND (DC-GREG-DATE-CYMD > 20030630)
  1717        AND (CP-CRITICAL-PERIOD)
  1718        GO TO 1040-PR-REF
  1719     END-IF
  1720
  1721     IF (CP-COMPANY-ID = 'CID')
  1722        AND (CP-STATE-STD-ABBRV = 'MO')
  1723        AND (DC-GREG-DATE-CYMD > 20030630)
  1724        AND (CP-CRITICAL-PERIOD)
  1725        GO TO 1040-PR-REF
  1726     END-IF
  1727
  1728     IF (CP-COMPANY-ID = 'CID')
  1729        AND (CP-STATE-STD-ABBRV = 'ND')
  1730        AND (CP-CRITICAL-PERIOD)
  1731        AND (DC-GREG-DATE-CYMD > 20011231)
  1732        GO TO 1040-PR-REF
  1733     END-IF
  1734
  1735     IF (CP-COMPANY-ID = 'CID')
  1736        AND (CP-STATE-STD-ABBRV = 'ND')
  1737        AND (DC-GREG-DATE-CYMD > 20011231)
  1738        GO TO 1060-ANTICIPATION-REF
  1739     END-IF
  1740
  1741     IF CP-STATE-STD-ABBRV = 'NC'
  1742       IF CP-COMPANY-ID EQUAL 'NCL' OR 'NCB'
  1743          NEXT SENTENCE
  1744       END-IF
  1745         IF DC-GREG-DATE-CYMD GREATER 19810930
  1746            IF CP-EARN-ANTICIPATION
  1747                GO TO 1060-ANTICIPATION-REF
  1748            ELSE
  1749                GO TO 1055-MEAN-REF.
  1750
  1751 SKIP-CSO-NC-AH-PROCESSING.
  1752
  1753     IF CP-STATE-STD-ABBRV = 'NM'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  35
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1754       IF CP-COMPANY-ID EQUAL 'NCL'
  1755          NEXT SENTENCE
  1756       END-IF
  1757         IF DC-GREG-DATE-CYMD GREATER THAN 19871231
  1758            IF CP-COMPANY-ID = 'MON'
  1759              MOVE '6'             TO CP-EARNING-METHOD
  1760              GO TO 1060-ANTICIPATION-REF
  1761             ELSE
  1762              GO TO 1055-MEAN-REF.
  1763
  1764     IF CP-STATE-STD-ABBRV = 'CT'
  1765       IF CP-COMPANY-ID EQUAL 'NCL'
  1766          NEXT SENTENCE
  1767       END-IF
  1768          MOVE '6'              TO CP-EARNING-METHOD
  1769          GO TO 1060-ANTICIPATION-REF.
  1770
  1771     IF CP-STATE-STD-ABBRV = 'ME'
  1772       IF CP-COMPANY-ID EQUAL 'NCL' OR 'CVL'
  1773          NEXT SENTENCE
  1774       END-IF
  1775           IF CP-EARN-BY-PRORATA
  1776              GO TO 1040-PR-REF
  1777           ELSE
  1778              MOVE '6'           TO CP-EARNING-METHOD
  1779              GO TO 1060-ANTICIPATION-REF.
  1780
  1781
  1782     IF CP-COMPANY-ID EQUAL 'CID' OR 'CSO'
  1783        IF CP-STATE-STD-ABBRV = 'TX' OR 'VA'
  1784            GO TO SKIP-CSO-TX-VA-AH-PROCESSING.
  1785
  1786     IF CP-STATE-STD-ABBRV = 'TX'
  1787       IF CP-COMPANY-ID EQUAL 'NCL' OR 'HER'
  1788          NEXT SENTENCE
  1789       END-IF
  1790        IF DC-GREG-DATE-CYMD GREATER 19920629  AND
  1791           CP-ORIGINAL-TERM NOT GREATER THAN 120
  1792           MOVE '6'              TO CP-EARNING-METHOD
  1793           GO TO 1060-ANTICIPATION-REF.
  1794
  1795     IF CP-STATE-STD-ABBRV = 'VA'
  1796       IF CP-COMPANY-ID EQUAL 'NCL'
  1797          NEXT SENTENCE
  1798       END-IF
  1799       IF CP-COMPANY-ID = 'NCB'
  1800           MOVE '6'                TO CP-EARNING-METHOD
  1801           GO TO 1060-ANTICIPATION-REF
  1802       ELSE
  1803           IF DC-GREG-DATE-CYMD GREATER 19921231
  1804               IF CP-ORIGINAL-TERM GREATER THAN 61
  1805                   MOVE '6'        TO CP-EARNING-METHOD
  1806                   GO TO 1060-ANTICIPATION-REF
  1807               ELSE
  1808                   MOVE '1'        TO CP-EARNING-METHOD
  1809                   GO TO 1050-R78-REF.
  1810
  1811 SKIP-CSO-TX-VA-AH-PROCESSING.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  36
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1812
  1813     IF CP-EARN-BY-PRORATA
  1814         GO TO 1040-PR-REF.
  1815
  1816     IF CP-EARN-BY-R78
  1817         GO TO 1050-R78-REF.
  1818
  1819     IF CP-EARN-AS-MEAN
  1820        GO TO 1055-MEAN-REF.
  1821
  1822     IF CP-EARN-AS-SUM-OF-DIGITS
  1823         GO TO 1075-SUM-OF-DIGITS.
  1824
  1825     IF CP-EARN-AS-CALIF
  1826         GO TO 1060-ANTICIPATION-REF.
  1827
  1828     IF CP-EARN-ANTICIPATION
  1829         GO TO 1060-ANTICIPATION-REF.
  1830
  1831     IF CP-EARN-AS-NET-PAY
  1832         GO TO 1070-NET-PAY-REFUND.
  1833
  1834     GO TO 1050-R78-REF.
  1835
  1836*---------------------------------------------------------------
  1837 1035-REF-AH-CRITICAL-PERIOD.
  1838     IF CP-REMAINING-TERM GREATER +6
  1839        COMPUTE CP-CALC-REFUND ROUNDED =
  1840          CP-ORIGINAL-PREMIUM * (((CP-REMAINING-TERM * +2) - +5) /
  1841                       ((CP-ORIGINAL-TERM * +2) - + 5))
  1842      ELSE
  1843        COMPUTE CP-CALC-REFUND ROUNDED =
  1844          CP-ORIGINAL-PREMIUM * ((CP-REMAINING-TERM *
  1845                                           CP-REMAINING-TERM + 1)
  1846                              /  (+12 * CP-ORIGINAL-TERM) - +30).
  1847
  1848     IF CP-CALC-REFUND LESS ZERO
  1849         MOVE ZERO TO CP-CALC-REFUND.
  1850
  1851     GO TO 1999-CALC-REF-AMT-X.
  1852
  1853*---------------------------------------------------------------
  1854 1040-PR-REF.
  1855     MOVE '2'               TO CP-REFUND-TYPE-USED.
  1856     COMPUTE CP-CALC-REFUND = CP-ORIGINAL-PREMIUM * PR-FACTOR.
  1857
  1858     GO TO 1999-CALC-REF-AMT-X.
  1859
  1860*---------------------------------------------------------------
  1861 1050-R78-REF.
  1862     MOVE '1'               TO CP-REFUND-TYPE-USED.
  1863     COMPUTE CP-CALC-REFUND ROUNDED =
  1864           CP-ORIGINAL-PREMIUM * R78-FACTOR.
  1865
  1866     GO TO 1999-CALC-REF-AMT-X.
  1867
  1868*---------------------------------------------------------------
  1869 1055-MEAN-REF.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  37
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1870     MOVE '8'               TO CP-REFUND-TYPE-USED.
  1871     COMPUTE CP-CALC-REFUND ROUNDED =
  1872         ((CP-ORIGINAL-PREMIUM * R78-FACTOR) +
  1873          (CP-ORIGINAL-PREMIUM * PR-FACTOR)) * .5.
  1874
  1875     GO TO 1999-CALC-REF-AMT-X.
  1876
  1877*---------------------------------------------------------------
  1878 1060-ANTICIPATION-REF.
  1879     MOVE '6'               TO CP-REFUND-TYPE-USED.
  1880
  1881     MOVE CP-ORIGINAL-TERM  TO WS-SAVE-TERM.
  1882     MOVE CP-LOAN-TERM      TO WS-SAVE-LOAN-TERM.
  1883     MOVE CP-EARNING-METHOD TO WS-SAVE-EARN-METHOD.
  1884
  1885     MOVE CP-REMAINING-TERM TO CP-ORIGINAL-TERM
  1886                               CP-LOAN-TERM.
  1887     MOVE CP-RATING-METHOD  TO CP-EARNING-METHOD.
  1888
  1889     PERFORM 2500-GET-RATE.
  1890
  1891     MOVE WS-SAVE-TERM      TO CP-ORIGINAL-TERM.
  1892     MOVE WS-SAVE-LOAN-TERM TO CP-LOAN-TERM.
  1893
  1894     IF CP-PREMIUM-RATE = ZEROS
  1895        MOVE '7'                 TO CP-RETURN-CODE
  1896        MOVE WS-SAVE-EARN-METHOD TO CP-EARNING-METHOD
  1897        GO TO 1999-CALC-REF-AMT-X.
  1898
  1899     MOVE CP-CALC-PREMIUM         TO WS-REMAIN-PREM.
  1900
  1901     PERFORM 2500-GET-RATE.
  1902
  1903     MOVE WS-SAVE-EARN-METHOD     TO CP-EARNING-METHOD.
  1904
  1905     IF CP-PREMIUM-RATE = ZEROS
  1906        MOVE '7'            TO CP-RETURN-CODE
  1907        GO TO 1999-CALC-REF-AMT-X.
  1908
  1909     MOVE CP-CALC-PREMIUM         TO WS-ORIG-PREM.
  1910
  1911     IF  WS-ORIG-PREM = ZERO
  1912         MOVE ZERO                TO WS-NP-REF-FACTOR
  1913        ELSE
  1914         COMPUTE WS-NP-REF-FACTOR ROUNDED = WS-REMAIN-PREM /
  1915                                            WS-ORIG-PREM.
  1916
  1917     COMPUTE CP-CALC-REFUND ROUNDED = WS-NP-REF-FACTOR *
  1918                                        CP-ORIGINAL-PREMIUM.
  1919
  1920     IF NOT CP-EARN-AS-CALIF
  1921         GO TO 1999-CALC-REF-AMT-X.
  1922
  1923*---------------------------------------------------------------
  1924 1065-CALIF-REGS.
  1925     MOVE '3'               TO CP-REFUND-TYPE-USED.
  1926     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1927         GIVING FACTOR-5.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  38
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1928
  1929     IF FACTOR-5 NOT GREATER +6  AND
  1930        CP-CLASS-CODE = 'A '
  1931         GO TO 1050-R78-REF.
  1932
  1933     IF FACTOR-5 = ZERO
  1934         MOVE CP-ORIGINAL-PREMIUM   TO CP-CALC-REFUND
  1935         GO TO 1999-CALC-REF-AMT-X.
  1936
  1937     IF CP-ORIGINAL-TERM LESS +014
  1938         GO TO 1999-CALC-REF-AMT-X.
  1939
  1940     MULTIPLY CP-ORIGINAL-TERM BY CP-ORIGINAL-TERM
  1941                                   GIVING FACTOR-5 ROUNDED.
  1942
  1943     MULTIPLY FACTOR-5 BY +0.0000045573 GIVING FACTOR-1 ROUNDED.
  1944
  1945     MULTIPLY +0.001125 BY CP-ORIGINAL-TERM
  1946                                   GIVING FACTOR-2 ROUNDED.
  1947
  1948     SUBTRACT FACTOR-2 FROM FACTOR-1.
  1949     ADD +0.099375 TO FACTOR-1.
  1950
  1951     SUBTRACT CP-REMAINING-TERM FROM CP-ORIGINAL-TERM
  1952                                   GIVING FACTOR-5 ROUNDED.
  1953
  1954     SUBTRACT +1.00 FROM FACTOR-5.
  1955
  1956     IF CP-ORIGINAL-TERM LESS +049
  1957         SUBTRACT +013 FROM CP-ORIGINAL-TERM
  1958                                   GIVING FACTOR-6 ROUNDED
  1959     ELSE
  1960         MOVE +035 TO FACTOR-6.
  1961
  1962     MOVE +001 TO FACTOR-2.
  1963
  1964     DIVIDE FACTOR-5 BY FACTOR-6 GIVING FACTOR-4 ROUNDED.
  1965     SUBTRACT FACTOR-4 FROM FACTOR-2.
  1966     MULTIPLY FACTOR-1 BY FACTOR-2 GIVING FACTOR-3 ROUNDED.
  1967     MOVE +001 TO FACTOR-2.
  1968     SUBTRACT FACTOR-3 FROM FACTOR-2 GIVING FACTOR-1 ROUNDED.
  1969
  1970     MULTIPLY FACTOR-1 BY CP-CALC-REFUND
  1971         GIVING CAL-RFND ROUNDED.
  1972
  1973     IF CAL-RFND LESS +0.01
  1974         MOVE ZEROS TO CAL-RFND.
  1975
  1976     IF CAL-RFND LESS CP-CALC-REFUND
  1977         MOVE CAL-RFND TO CP-CALC-REFUND.
  1978
  1979     GO TO 1999-CALC-REF-AMT-X.
  1980
  1981*-----------------------------------------------------------------
  1982 1070-NET-PAY-REFUND.
  1983     MOVE '5'                    TO  CP-REFUND-TYPE-USED.
  1984     IF CP-LOAN-APR = ZERO
  1985         MOVE ZEROS              TO  CP-CALC-REFUND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  39
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ELCRFNDPP)
  1986         MOVE '1'                TO  CP-RETURN-CODE
  1987         GO TO 1999-CALC-REF-AMT-X.
  1988
  1989     MOVE CP-LOAN-APR            TO  N-P-APR.
  1990     MOVE CP-ORIGINAL-TERM       TO  N-P-ORIG  N-P-LOAN.
  1991     MOVE CP-REMAINING-TERM      TO  N-P-REM.
  1992
  1993     MOVE 'R'                    TO  N-P-OPT.
  1994
  1995     PERFORM 10000-NET-TERM THRU 99999-EXIT.
  1996
  1997     COMPUTE CP-CALC-REFUND ROUNDED = N-P-FACTOR *
  1998                                        CP-ORIGINAL-PREMIUM.
  1999
  2000     GO TO 1999-CALC-REF-AMT-X.
  2001*---------------------------------------------------------------
  2002
  2003 1075-SUM-OF-DIGITS.
  2004
  2005     MOVE '9'               TO CP-REFUND-TYPE-USED.
  2006
  2007     COMPUTE RSUM-REMAINING-TERM =
  2008             CP-LOAN-TERM -
  2009                  (CP-ORIGINAL-TERM - (CP-REMAINING-TERM + 1))
  2010
  2011     COMPUTE RSUM-FACTOR =
  2012        ((RSUM-REMAINING-TERM * (RSUM-REMAINING-TERM + 1)) -
  2013               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2014                 (CP-LOAN-TERM - CP-ORIGINAL-TERM + 1)))   /
  2015            ((CP-LOAN-TERM * (CP-LOAN-TERM + 1))           -
  2016               ((CP-LOAN-TERM - CP-ORIGINAL-TERM)          *
  2017                 (CP-LOAN-TERM - CP-ORIGINAL-TERM  + 1))).
  2018
  2019     COMPUTE CP-CALC-REFUND ROUNDED =
  2020           CP-ORIGINAL-PREMIUM * RSUM-FACTOR.
  2021
  2022     GO TO 1999-CALC-REF-AMT-X.
  2023
  2024*-----------------------------------------------------------------
  2025
  2026 1999-CALC-REF-AMT-X.
  2027     GOBACK.
  2028
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  40
* ELRFNDXP.cbl
  2030 2500-GET-RATE.
  2031     CALL 'ELRATEX' USING CALCULATION-PASS-AREA.
  2032
  2033 2500-EXIT.
  2034      EXIT.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  41
* ELRFNDXP.cbl
  2036
  2037 9100-CONVERT-DATE.
  2038     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.
  2039
  2040 9100-EXIT.
  2041      EXIT.
  2042
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  42
* ELRFNDXP.cbl
  2044 10000-NET-TERM SECTION.
* 2045                             COPY ERCNETP.
  2046***************************************************************** 04/29/98
  2047*                                                               * ERCNETP
  2048*                            ERCNETP                            *    LV006
  2049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**6
  2050*                            VMOD=2.029                         *    CL**3
  2051*                                                               * ERCNETP
  2052*****************************************************************.ERCNETP
  2053*                                                                 ERCNETP
  2054*    FIVE PARAMETERS ARE PASSED TO THIS MODULE AND A FACTOR IS    ERCNETP
  2055*    RETURNED. PARAMETERS PASSED  - A.P.R. (S999V9999)            ERCNETP
  2056*                                   ORIGINAL TERM (S999)          ERCNETP
  2057*                                   REMAINING TERM (S999)         ERCNETP
  2058*                                   NET PAY OPTION (X)            ERCNETP
  2059*                                   LOAN TERM (S999)              ERCNETP
  2060*              FACTOR RETURNED IS - FACTOR (S9(4)V9(9))           ERCNETP
  2061*                                                                 ERCNETP
  2062*    FACTOR RETURNED IS MULTIPLIED BY ORIG. FACE TO GET REMAINING ERCNETP
  2063*    FACE. IF ORIGNAL TERM = REMAINING TERM, FACTOR WOULD BE 1,   ERCNETP
  2064*    THEREFORE MODULE ASSUMES RATING IS DESIRED AND FACTOR THAT   ERCNETP
  2065*    IS RETURNED MAY BE MULTIPLIED BY THOUSANDS OF ORIGINAL FACE  ERCNETP
  2066*    AND REGULAR PREMIUM PER $100 PER MONTH TO GET PREMIUM TO BE  ERCNETP
  2067*    CHARGED.                                                     ERCNETP
  2068*                                                                 ERCNETP
  2069*    OPTIONS - S = NET SIMPLE                                     ERCNETP
  2070*          SPACE = NET PAY  (1 MO. INTEREST)                      ERCNETP
  2071*              A = NET PAY  (0 MO. INTEREST)                      ERCNETP
  2072*              I = NET PAY  (2 MO. INTEREST)                      ERCNETP
  2073*              J = NET PAY  (3 MO. INTEREST)                      ERCNETP
  2074*              K = NET PAY  (4 MO. INTEREST)                      ERCNETP
  2075*              T = TRUNCATED  (0 MO. INTEREST)                    ERCNETP
  2076*              U = TRUNCATED  (1 MO. INTEREST)                    ERCNETP
  2077*              V = TRUNCATED  (2 MO. INTEREST)                    ERCNETP
  2078*              W = TRUNCATED  (3 MO. INTEREST)                    ERCNETP
  2079*              X = TRUNCATED  (4 MO. INTEREST)                    ERCNETP
  2080*              R = REFUNDS (REGULAR OR TRUNCATED)                 ERCNETP
  2081******************************************************************
  2082*                   C H A N G E   L O G
  2083*
  2084* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2085*-----------------------------------------------------------------
  2086*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2087* EFFECTIVE    NUMBER
  2088*-----------------------------------------------------------------
  2089* 120202    2001061800003  PEMA  ADD DCC PROCESSING
  2090* 120502                   PEMA  ADD SPECIAL IN CALC FOR CID
  2091* 120403                   PEMA  ADD SPECIAL TX CALC
  2092* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2093* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2094* 081205                   PEMA  ADD DAYS TO 1ST PMT ON 'S'
  2095* 083105                   PEMA  ADD DAYS TO 1ST PMT ON 'N'
  2096* 011707                   PEMA  ADD SC NP PLUS 6 PMTS
  2097* 021207                   PEMA  ADD PA NP
  2098* 022107                   PEMA  ADD NH NP AND NP TRUNC
  2099* 032807                   PEMA  ADD VT NP PLUS 2
  2100* 091307  IR2007090600001  PEMA  REMOVE LOW APR CHECK
  2101* 110207    2007010300001  PEMA  FIX PROBLEM WHERE DIFF OF LOAN
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  43
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2102* 110207      LOAN TERM AND INS TERM IS 1. ALSO ADD TRUNC
  2103* 110207      TO 'AL' NET PAY CALC
  2104* 052808    2008032000002  PEMA  ADD CODE FOR AK NET PAY
  2105* 052808    2008050800003  PEMA  ADD CODE FOR NV NET +2
  2106* 060308  IR2008052800002  PEMA  ADD TNP FOR ME
  2107* 060308  CR2008032700002  PEMA  ADD EXT DAYS FOR ME
  2108* 0600909 CR2008042300002  PEMA  ADD NEW FARM PLAN CALC
  2109* 010410  CR2009092300002  PEMA  ADD MN NET CALC
  2110* 010410  CR2008021200005  PEMA  ADD MN NET BALLOON
  2111* 041310  CR2008021200005  PEMA  ADD CODE FOR MN LEVEL
  2112* 071910  IR2010062900001  PEMA ADD MN NET BALLOON REFUND CALC
  2113* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  2114* 092311  IR2011092100001  PEMA  ID 10C MONTHLY
  2115* 032612  CR2011110200001  PEMA  AHL CHANGES
  2116* 111212  CR2012013100001  PEMA  CHANGES FOR MN AND WA
  2117* 022613  CR2011021500001  PEMA  ADD CODE 4 TRUNC BALLOON DCC 10C
  2118* 050713  CR2008042200001  PEMA  ADD CODE FOR ZERO APR
  2119* 030515  IR2015022300001  PEMA  ADD MN AND WA FARMPLAN CODING
  2120* 040615  CR2013072200002  PEMA  ADD EXTRA PERIODS FOR NET BALLOONS
  2121******************************************************************
  2122                                                                  ERCNETP
  2123     MOVE N-P-APR     TO ANNUAL-INT-RATE.                         ERCNETP
  2124     MOVE N-P-ORIG    TO ORIGINAL-TERM.                           ERCNETP
  2125     MOVE N-P-LOAN    TO LOAN-TERM.                               ERCNETP
  2126     MOVE N-P-REM     TO REMAINING-TERM.                          ERCNETP
  2127     MOVE N-P-OPT     TO OPTION-SW.                               ERCNETP
  2128                                                                  ERCNETP
  2129     MOVE +0 TO FACTOR.                                           ERCNETP
  2130
  2131     if cp-company-id = 'CID'
  2132        if annual-int-rate = +99.9999
  2133           go to 99000-error
  2134        end-if
  2135     else
  2136        if annual-int-rate = zero
  2137           go to 99000-error
  2138        end-if
  2139     end-if
  2140
  2141     IF ORIGINAL-TERM = ZERO                                      ERCNETP
  2142         GO TO 99999-RETURN.                                      ERCNETP
  2143     IF REMAINING-TERM = ZERO                                     ERCNETP
  2144         GO TO 99999-RETURN.                                      ERCNETP
  2145     IF REMAINING-TERM GREATER ORIGINAL-TERM                      ERCNETP
  2146         GO TO 99000-ERROR.                                       ERCNETP
  2147     IF LOAN-TERM = ZERO                                          ERCNETP
  2148         GO TO 99999-RETURN.                                      ERCNETP
  2149     IF LOAN-TERM LESS ORIGINAL-TERM                              ERCNETP
  2150         GO TO 99000-ERROR.                                       ERCNETP
  2151                                                                  ERCNETP
  2152*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2153*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2154*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2155*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2156*    IF ANNUAL-INT-RATE LESS +2                                   ERCNETP
  2157*        COMPUTE ANNUAL-INT-RATE = ANNUAL-INT-RATE * +10.         ERCNETP
  2158                                                                  ERCNETP
  2159     IF NPO-REFUND                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  44
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2160         MOVE '2' TO NP-PROCESS-SW                                ERCNETP
  2161       ELSE                                                       ERCNETP
  2162         IF ORIGINAL-TERM = REMAINING-TERM                        ERCNETP
  2163            MOVE '1'   TO NP-PROCESS-SW                           ERCNETP
  2164           ELSE                                                   ERCNETP
  2165            MOVE '3'   TO NP-PROCESS-SW.                          ERCNETP
  2166                                                                  ERCNETP
  2167     IF NPO-SIMPLE                                                ERCNETP
  2168         MOVE 'S' TO TYPE-SW                                      ERCNETP
  2169     ELSE                                                         ERCNETP
  2170         MOVE 'N' TO TYPE-SW.                                     ERCNETP
  2171                                                                  ERCNETP
  2172     COMPUTE I ROUNDED = (ANNUAL-INT-RATE / K100) / K12.          ERCNETP
  2173     if i = zeros
  2174        move .0000000001         to i
  2175     end-if
  2176                                                                  ERCNETP
  2177     COMPUTE V ROUNDED = K1 / (K1 + I).                           ERCNETP
  2178                                                                  ERCNETP
  2179     MOVE V     TO VX                                             ERCNETP
  2180                   SV.                                            ERCNETP
  2181                                                                  ERCNETP
  2182     MOVE +1    TO X1                                             ERCNETP
  2183                   SX.                                            ERCNETP
  2184                                                                  ERCNETP
  2185     MOVE LOAN-TERM TO MAX-X.                                     ERCNETP
  2186                                                                  ERCNETP
  2187     COMPUTE X2 = MAX-X - ORIGINAL-TERM.                          ERCNETP
  2188                                                                  ERCNETP
  2189     IF MAX-X = +1                                                ERCNETP
  2190        GO TO 10700-COMPUTE-REMAINING-FACTOR.                     ERCNETP
  2191                                                                  ERCNETP
  2192     COMPUTE EXPIRED-TERM = ORIGINAL-TERM - REMAINING-TERM.       ERCNETP
  2193                                                                  ERCNETP
  2194     IF (CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'     ERCNETP
  2195         OR 'DCC'        OR 'NCL') AND                            ERCNETP
  2196        (NOT NP-REFUND)                                           ERCNETP
  2197        NEXT SENTENCE                                             ERCNETP
  2198     ELSE                                                         ERCNETP
  2199     IF LOAN-TERM NOT = ORIGINAL-TERM                             ERCNETP
  2200        COMPUTE REMAINING-TERM = LOAN-TERM - EXPIRED-TERM.        ERCNETP
  2201                                                                  ERCNETP
  2202     COMPUTE SV-MINUS-ONE EQUAL ORIGINAL-TERM - +1.               ERCNETP
  2203                                                                  ERCNETP
  2204 10500-VX-LOOP.                                                   ERCNETP
  2205                                                                  ERCNETP
  2206***  VX = AMORT. LOAN TERM.                                       ERCNETP
  2207***  SV = AMORT. INSURANCE TERM.                                  ERCNETP
  2208***  SV = AMORT. REMAINING TERM FOR REFUND CALCS.                 ERCNETP
  2209***  SX = AMORT. LOAN TERM - INSURANCE TERM. (USED FOR TRUNCATED. ERCNETP
  2210***  SV-MINUS-ONE = INSURANCE TERM - +1... (TMS ONLY)             ERCNETP
  2211                                                                  ERCNETP
  2212     IF X2 = 1
  2213        MOVE V         TO SX
  2214     END-IF
  2215     COMPUTE VX ROUNDED = VX * V.                                 ERCNETP
  2216                                                                  ERCNETP
  2217     ADD B1 TO X1.                                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  45
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2218                                                                  ERCNETP
  2219     IF X1 = REMAINING-TERM                                       ERCNETP
  2220          MOVE VX    TO SV.                                       ERCNETP
  2221                                                                  ERCNETP
  2222     IF X1 EQUAL SV-MINUS-ONE                                     ERCNETP
  2223        MOVE VX      TO SV-MINUS-ONE.                             ERCNETP
  2224                                                                  ERCNETP
  2225     IF X1 = X2                                                   ERCNETP
  2226          MOVE VX    TO SX.                                       ERCNETP
  2227                                                                  ERCNETP
  2228     IF X1 NOT = MAX-X                                            ERCNETP
  2229          GO TO 10500-VX-LOOP.                                    ERCNETP
  2230                                                                  ERCNETP
  2231 10700-COMPUTE-REMAINING-FACTOR.                                  ERCNETP
  2232*****  WK1 = LOAN TERM AMORT
  2233     COMPUTE WK1 = K1 - VX.                                       ERCNETP
  2234*****  WK2 = INS TERM AMORT
  2235     COMPUTE WK2 = K1 - SV.                                       ERCNETP
  2236*****  WK5 = LOAN TERM - INS TERM AMORT (TRUNCATED)
  2237     COMPUTE WK5 = K1 - SX.                                       ERCNETP
  2238*****  WK6 = INS TERM - 1
  2239     COMPUTE WK6 = K1 - SV-MINUS-ONE.                             ERCNETP
  2240                                                                  ERCNETP
  2241     IF NP-RATING                                                 ERCNETP
  2242         GO TO 12000-PREMIUM-RATE.                                ERCNETP
  2243                                                                  ERCNETP
  2244     IF NP-REFUND                                                 ERCNETP
  2245         GO TO 11000-REFUND-CALC.                                 ERCNETP
  2246                                                                  ERCNETP
  2247     IF NET-STD                                                   ERCNETP
  2248         COMPUTE WK3 ROUNDED = (WK2 * K1000) / WK1.               ERCNETP
  2249                                                                  ERCNETP
  2250     IF NET-SMP                                                   ERCNETP
  2251         COMPUTE WK3 ROUNDED = ((R + 1) / (N + 1)) * (R / N)      ERCNETP
  2252         COMPUTE WK3 ROUNDED = (1 - WK3) * ((I * N / WK1) - 1)    ERCNETP
  2253         COMPUTE WK3 ROUNDED = WK3 + 1 - ((N - R) * I / WK1)      ERCNETP
  2254         COMPUTE WK3 ROUNDED = WK3 * 1000.                        ERCNETP
  2255                                                                  ERCNETP
  2256     IF REMAINING-TERM LESS THAN X2                               ERCNETP
  2257         MOVE +0 TO WK3.                                          ERCNETP
  2258                                                                  ERCNETP
  2259     MOVE WK3 TO FACTOR.                                          ERCNETP
  2260                                                                  ERCNETP
  2261     GO TO 99999-RETURN.                                          ERCNETP
  2262                                                                  ERCNETP
  2263 11000-REFUND-CALC.                                               ERCNETP
  2264     IF REMAINING-TERM NOT LESS MAX-X                             ERCNETP
  2265        MOVE +1 TO FACTOR                                         ERCNETP
  2266        GO TO 99999-RETURN.                                       ERCNETP
  2267                                                                  ERCNETP
  2268     IF REMAINING-TERM LESS +1                                    ERCNETP
  2269        MOVE 0 TO FACTOR                                          ERCNETP
  2270        GO TO 99999-RETURN.                                       ERCNETP
  2271                                                                  ERCNETP
  2272     COMPUTE WK2 ROUNDED = WK2 / I.                               ERCNETP
  2273     COMPUTE WK5 ROUNDED = WK5 / I.                               ERCNETP
  2274     COMPUTE WK1 ROUNDED = WK1 / I.                               ERCNETP
  2275                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  46
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2276     IF (CP-COMPANY-ID EQUAL 'CID')
  2277        AND (CP-STATE-STD-ABBRV = 'MN')
  2278        AND (CP-CERT-EFF-DT > X'A4FF')
  2279        AND (CP-RATE-AS-REG-BALLOON)
  2280        AND (CP-EARN-AS-NET-PAY)
  2281        AND (CP-DEVIATION-CODE NOT = 'LEV')
  2282        CONTINUE
  2283     ELSE
  2284        GO TO 11000-CHECK-MN-LEV-BALLOON
  2285     END-IF
  2286
  2287     COMPUTE R = M - E
  2288     COMPUTE FACTOR = (R - WK2 + WK5) /
  2289        (M - WK1 + WK5)
  2290
  2291     GO TO 99999-RETURN
  2292
  2293      .
  2294 11000-CHECK-MN-LEV-BALLOON.
  2295
  2296     IF (CP-COMPANY-ID EQUAL 'CID')
  2297        AND (CP-STATE-STD-ABBRV = 'MN')
  2298        AND (CP-CERT-EFF-DT > X'A4FF')
  2299        AND (CP-RATE-AS-REG-BALLOON)
  2300        AND (CP-EARN-AS-NET-PAY)
  2301        AND (CP-DEVIATION-CODE = 'LEV')
  2302        CONTINUE
  2303     ELSE
  2304        GO TO 11000-CONTINUE-REFUND
  2305     END-IF
  2306
  2307     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2308     COMPUTE ANGLEM-T = (1 - (1 / (1 + I))
  2309        ** (M - E)) / I
  2310
  2311     COMPUTE FACTOR = ANGLEM-T / ANGLEM
  2312
  2313     GO TO 99999-RETURN
  2314
  2315     .
  2316 11000-CONTINUE-REFUND.
  2317
  2318*    IF CP-GAP-ACTUARIAL
  2319*       COMPUTE ANGLEN = WK1 / ((1 + I) **
  2320*          (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2321*       COMPUTE WK3 = WK2 / ANGLEN
  2322*       MOVE 'S'                 TO CP-REFUND-TYPE-USED
  2323
  2324     IF CP-GAP-ACTUARIAL
  2325        COMPUTE ANGLEN = WK1 / ((1 + I) **
  2326           (CP-TERM-OR-EXT-DAYS * 12 / 365))
  2327        COMPUTE WK3 = (R - WK2) / (M - ANGLEN)
  2328     ELSE
  2329        COMPUTE WK3 ROUNDED =
  2330          (N-P-REM - WK2 + WK5) / (ORIGINAL-TERM - WK1 + WK5)
  2331     END-IF
  2332                                                                  ERCNETP
  2333     MOVE WK3  TO FACTOR.                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  47
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2334                                                                  ERCNETP
  2335     GO TO 99999-RETURN.                                          ERCNETP
  2336                                                                  ERCNETP
  2337 12000-PREMIUM-RATE.                                              ERCNETP
  2338*    K-I IS ADJUSTMENT FACTOR FOR NO. MONTHS ADD'L. INTEREST      ERCNETP
  2339*      OPTION - N OR U OR SPACE  = 1 MO,  SO K-I = 1 + I          ERCNETP
  2340*      OPTION - A OR T           = 0 MO,  SO K-I = 1              ERCNETP
  2341*      OPTION - I OR V           = 2 MO,  SO K-I = 1 + 2I         ERCNETP
  2342*      OPTION - J OR W           = 3 MO,  SO K-I = 1 + 3I         ERCNETP
  2343*      OPTION - K OR X           = 4 MO,  SO K-I = 1 + 4I         ERCNETP
  2344                                                                  ERCNETP
  2345     COMPUTE K-I = K1 + I.                                        ERCNETP
  2346     MOVE K-I TO ONE-PLUS-I.                                      ERCNETP
  2347                                                                  ERCNETP
  2348     IF NPO-ALT OR NPO-TRUNC-0                                    ERCNETP
  2349         MOVE K1 TO K-I.                                          ERCNETP
  2350                                                                  ERCNETP
  2351     IF NPO-2MO OR NPO-TRUNC-2                                    ERCNETP
  2352         COMPUTE K-I = K1 + (2 * I).                              ERCNETP
  2353                                                                  ERCNETP
  2354     IF NPO-3MO OR NPO-TRUNC-3                                    ERCNETP
  2355         COMPUTE K-I = K1 + (3 * I).                              ERCNETP
  2356                                                                  ERCNETP
  2357     IF NPO-4MO OR NPO-TRUNC-4                                    ERCNETP
  2358         COMPUTE K-I = K1 + (4 * I).                              ERCNETP
  2359                                                                  ERCNETP
  2360     COMPUTE RA ROUNDED = 1 -                                     ERCNETP
  2361             ((X2 * (X2 + 1)) /                                   ERCNETP
  2362              (N *  (N  + 1))).                                   ERCNETP
  2363                                                                  ERCNETP
  2364     IF (CP-COMPANY-ID EQUAL 'CSL') AND                           ERCNETP
  2365        (CP-CSL-VALID-NP-BENEFIT-CD)                              ERCNETP
  2366        NEXT SENTENCE                                             ERCNETP
  2367     ELSE                                                         ERCNETP
  2368        GO TO XXXX-CHECK-DISCOUNT-5.                              ERCNETP
  2369                                                                  ERCNETP
  2370     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  2371     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  2372     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2373                                                                  ERCNETP
  2374     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2375        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2376        MOVE ZEROS               TO FACTOR                        ERCNETP
  2377                                    CP-CALC-PREMIUM               ERCNETP
  2378         GO TO 99999-RETURN.                                      ERCNETP
  2379                                                                  ERCNETP
  2380     MOVE DC-JULIAN-DATE-1 TO WS-INT-BEGIN-DATE                      CL**2
  2381     MOVE CP-FIRST-PAY-DATE TO DC-BIN-DATE-1                      ERCNETP
  2382     MOVE ' ' TO DC-OPTION-CODE                                   ERCNETP
  2383     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  2384                                                                  ERCNETP
  2385     IF DATE-CONVERSION-ERROR                                     ERCNETP
  2386        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  2387        MOVE ZEROS               TO FACTOR                        ERCNETP
  2388                                    CP-CALC-PREMIUM               ERCNETP
  2389         GO TO 99999-RETURN.                                      ERCNETP
  2390                                                                  ERCNETP
  2391     MOVE DC-JULIAN-DATE-1 TO WS-DUE-DATE.                           CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  48
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2392                                                                  ERCNETP
  2393     COMPUTE ANGLEN-1 EQUAL 1 + (WK6 / I).                        ERCNETP
  2394                                                                  ERCNETP
  2395     IF (WS-DUE-DATE - WS-INT-BEGIN-DATE) GREATER THAN 30         ERCNETP
  2396        COMPUTE WK3 EQUAL 1 + ((30 + CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2397        CP-PAY-FREQUENCY / 365) * I                               ERCNETP
  2398     ELSE                                                         ERCNETP
  2399        COMPUTE WK3 EQUAL 1 + ((30 - CP-TERM-OR-EXT-DAYS) *       ERCNETP
  2400        CP-PAY-FREQUENCY / 365) * I.                              ERCNETP
  2401                                                                  ERCNETP
  2402     COMPUTE WS-WORK-RATE EQUAL ((2 * CP-PREMIUM-RATE) /          ERCNETP
  2403     13).                                                         ERCNETP
  2404                                                                  ERCNETP
  2405     COMPUTE WK5-CSL EQUAL WS-WORK-RATE * ((1 + I) / I) *         ERCNETP
  2406     (N - ( ANGLEN-1 / WK3)).                                     ERCNETP
  2407                                                                  ERCNETP
  2408     MOVE ZEROS TO WS-Y-X-FACTOR WS-X-Y-FACTOR.                   ERCNETP
  2409                                                                  ERCNETP
  2410     COMPUTE WS-CALC-FREQ-RATE EQUAL                              ERCNETP
  2411       (CP-LOAN-APR * .01) / CP-PAY-FREQUENCY.                    ERCNETP
  2412                                                                  ERCNETP
  2413     COMPUTE WS-Y-X-FACTOR EQUAL                                  ERCNETP
  2414       1 + ((1 - (1 + WS-CALC-FREQ-RATE) ** -(N - 1)) /           ERCNETP
  2415       WS-CALC-FREQ-RATE).                                        ERCNETP
  2416                                                                  ERCNETP
  2417     COMPUTE WS-ODD-DAY-UNITS EQUAL                               ERCNETP
  2418       (WS-DUE-DATE - WS-INT-BEGIN-DATE) * CP-PAY-FREQUENCY / 365.ERCNETP
  2419                                                                  ERCNETP
  2420     COMPUTE WS-X-Y-FACTOR EQUAL                                  ERCNETP
  2421       1 + (WS-ODD-DAY-UNITS * WS-CALC-FREQ-RATE).                ERCNETP
  2422                                                                  ERCNETP
  2423     COMPUTE WS-NP-FACTOR EQUAL WS-WORK-RATE *                    ERCNETP
  2424       ((1 + WS-CALC-FREQ-RATE) / WS-CALC-FREQ-RATE) *            ERCNETP
  2425       (N - (WS-Y-X-FACTOR / WS-X-Y-FACTOR)).                     ERCNETP
  2426                                                                  ERCNETP
  2427     COMPUTE CP-CALC-PREMIUM EQUAL CP-MONTHLY-PAYMENT * WK5-CSL.  ERCNETP
  2428                                                                  ERCNETP
  2429     GO TO 99999-RETURN.                                          ERCNETP
  2430                                                                  ERCNETP
  2431 XXXX-CHECK-DISCOUNT-5.                                           ERCNETP
  2432                                                                  ERCNETP
  2433     IF WS-DISCOUNT-OPTION EQUAL '5'                              ERCNETP
  2434        NEXT SENTENCE                                             ERCNETP
  2435     ELSE                                                         ERCNETP
  2436        GO TO 12000-CHECK-CLIENT.                                 ERCNETP
  2437                                                                  ERCNETP
  2438      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2439                                                                  ERCNETP
  2440      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2441                                                                  ERCNETP
  2442      COMPUTE WK3 EQUAL                                           ERCNETP
  2443        (12 *                                                     ERCNETP
  2444        (((CP-ORIGINAL-BENEFIT / ANGLEN) * N) -                   ERCNETP
  2445        CP-ORIGINAL-BENEFIT)) /                                   ERCNETP
  2446        APR100.                                                   ERCNETP
  2447                                                                  ERCNETP
  2448     COMPUTE WK3 EQUAL                                            ERCNETP
  2449        (WK3 * CP-PREMIUM-RATE) / +1000.                          ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  49
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2450                                                                  ERCNETP
  2451     COMPUTE WK3 EQUAL                                            ERCNETP
  2452        (24 * WK3) / (24 + (WS-WORK-DIS-RATE * N)).               ERCNETP
  2453                                                                  ERCNETP
  2454      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2455                                                                  ERCNETP
  2456     GO TO 99999-RETURN.                                          ERCNETP
  2457                                                                  ERCNETP
  2458 12000-CHECK-CLIENT.                                              ERCNETP
  2459                                                                  ERCNETP
  2460     IF (CP-COMPANY-ID EQUAL 'MON') AND                           ERCNETP
  2461        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2462        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2463        NEXT SENTENCE                                             ERCNETP
  2464     ELSE                                                         ERCNETP
  2465        GO TO 12000-CHECK-NEXT.                                   ERCNETP
  2466                                                                  ERCNETP
  2467     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2468                                                                  ERCNETP
  2469     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2470     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2471                                                                  ERCNETP
  2472     COMPUTE FM EQUAL                                             ERCNETP
  2473                    (((ONE-PLUS-I ** M) * I * M) /                ERCNETP
  2474                    ((ONE-PLUS-I ** M) - 1))                      ERCNETP
  2475                    - 1.                                          ERCNETP
  2476                                                                  ERCNETP
  2477     COMPUTE FN EQUAL                                             ERCNETP
  2478                    (((ONE-PLUS-I ** N) * I * N) /                ERCNETP
  2479                    ((ONE-PLUS-I ** N) - 1))                      ERCNETP
  2480                    - 1.                                          ERCNETP
  2481                                                                  ERCNETP
  2482     COMPUTE FNM EQUAL                                            ERCNETP
  2483                    (((ONE-PLUS-I ** (N - M)) * I * (N - M)) /    ERCNETP
  2484                    ((ONE-PLUS-I ** (N - M)) - 1))                ERCNETP
  2485                    - 1.                                          ERCNETP
  2486                                                                  ERCNETP
  2487     COMPUTE GR EQUAL                                             ERCNETP
  2488                    (WS-WORK-RATE * ANGLEM * I) /                 ERCNETP
  2489                    (M - ANGLEM).                                 ERCNETP
  2490                                                                  ERCNETP
  2491     COMPUTE ODF EQUAL                                            ERCNETP
  2492                     (1 +                                         ERCNETP
  2493                     ((12 * I * (CP-TERM-OR-EXT-DAYS + 30)) /     ERCNETP
  2494                     360)) /                                      ERCNETP
  2495                     ONE-PLUS-I.                                  ERCNETP
  2496                                                                  ERCNETP
  2497     COMPUTE OD EQUAL                                             ERCNETP
  2498                    (1 + (ODF * (FN / I - 1))) +                  ERCNETP
  2499                    ((12 * CP-TERM-OR-EXT-DAYS) / +360).          ERCNETP
  2500                                                                  ERCNETP
  2501     COMPUTE WK3 EQUAL                                            ERCNETP
  2502*                   ((1 + FN) * ODF * CP-ORIGINAL-BENEFIT) /      ERCNETP
  2503                    ((1 + FN) * ODF *                             ERCNETP
  2504                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM)) /ERCNETP
  2505                    (1 - (GR * (OD - ((ONE-PLUS-I ** M) / I) *    ERCNETP
  2506                    FNM * ODF * (1 - ANGLEM / ANGLEN)))).         ERCNETP
  2507                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  50
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2508     COMPUTE TRUNC-PMT EQUAL WK3 / N.                             ERCNETP
  2509     COMPUTE WK3 EQUAL TRUNC-PMT * N.                             ERCNETP
  2510                                                                  ERCNETP
  2511     COMPUTE WK3 EQUAL                                            ERCNETP
  2512                    (WK3 / (ODF * (1 + FN))) -                    ERCNETP
  2513*                   CP-ORIGINAL-BENEFIT.                          ERCNETP
  2514                    (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM).  ERCNETP
  2515                                                                  ERCNETP
  2516      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2517                                                                  ERCNETP
  2518     GO TO 99999-RETURN.                                          ERCNETP
  2519                                                                  ERCNETP
  2520 12000-CHECK-NEXT.                                                ERCNETP
  2521                                                                  ERCNETP
  2522     IF WS-DISCOUNT-OPTION EQUAL '3' OR '4'                       ERCNETP
  2523        NEXT SENTENCE                                             ERCNETP
  2524     ELSE                                                         ERCNETP
  2525        GO TO 12000-CHECK-PA-TRUNC.                               ERCNETP
  2526                                                                  ERCNETP
  2527      IF WS-WORK-DIS-RATE EQUAL +0                                ERCNETP
  2528         MOVE '7'                TO CP-RETURN-CODE                ERCNETP
  2529         MOVE ZEROS              TO FACTOR                        ERCNETP
  2530                                    CP-CALC-PREMIUM               ERCNETP
  2531         GO TO 99999-RETURN.                                      ERCNETP
  2532                                                                  ERCNETP
  2533      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2534                                                                  ERCNETP
  2535      COMPUTE APR100 EQUAL ANNUAL-INT-RATE / +100.                ERCNETP
  2536                                                                  ERCNETP
  2537      IF WS-WORK-DIS-RATE EQUAL APR100                            ERCNETP
  2538         ADD .00001 TO APR100.                                    ERCNETP
  2539                                                                  ERCNETP
  2540      COMPUTE WK8 EQUAL 12 / (12 + WS-WORK-DIS-RATE).             ERCNETP
  2541      COMPUTE WK9 EQUAL 12 / (12 + APR100).                       ERCNETP
  2542                                                                  ERCNETP
  2543
  2544
  2545     COMPUTE Y = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  2546        / (1 + I)
  2547     COMPUTE ANGLEN-1 = ANGLEN / Y
  2548
  2549      IF CP-COMPANY-ID EQUAL 'CDL'                                ERCNETP
  2550         COMPUTE WK3 EQUAL                                        ERCNETP
  2551                                                                  ERCNETP
  2552          (144 * CP-ORIGINAL-BENEFIT / ANGLEN) *                  ERCNETP
  2553          ((1 + WS-WORK-DIS-RATE / 12) ** .5) *                   ERCNETP
  2554                                                                  ERCNETP
  2555          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2556                                                                  ERCNETP
  2557          ((WK8 ** N) /                                           ERCNETP
  2558          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2559                                                                  ERCNETP
  2560          ((WK9 ** N) /                                           ERCNETP
  2561          (APR100 * (APR100 - WS-WORK-DIS-RATE))))                ERCNETP
  2562                                                                  ERCNETP
  2563      ELSE                                                        ERCNETP
  2564         COMPUTE WK3 EQUAL                                        ERCNETP
  2565                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  51
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2566          ((CP-ORIGINAL-BENEFIT / ANGLEN-1) *
  2567          (12 + WS-WORK-DIS-RATE) * 12) *                         ERCNETP
  2568                                                                  ERCNETP
  2569          ((1 / (WS-WORK-DIS-RATE * APR100)) -                    ERCNETP
  2570                                                                  ERCNETP
  2571          ((WK8 ** N) /                                           ERCNETP
  2572          (WS-WORK-DIS-RATE * (APR100 - WS-WORK-DIS-RATE))) +     ERCNETP
  2573                                                                  ERCNETP
  2574          ((WK9 ** N) /                                           ERCNETP
  2575          (APR100 * (APR100 - WS-WORK-DIS-RATE)))).               ERCNETP
  2576                                                                  ERCNETP
  2577      COMPUTE WK3 EQUAL                                           ERCNETP
  2578          (WK3 * CP-PREMIUM-RATE) / +1000.                        ERCNETP
  2579                                                                  ERCNETP
  2580      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2581                                                                  ERCNETP
  2582     GO TO 99999-RETURN.                                          ERCNETP
  2583                                                                  ERCNETP
  2584 12000-CHECK-PA-TRUNC.                                            ERCNETP
  2585                                                                  ERCNETP
  2586     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2587        (CP-STATE-STD-ABBRV EQUAL 'PA') AND                          CL**3
  2588        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2589        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2590        NEXT SENTENCE                                             ERCNETP
  2591     ELSE                                                         ERCNETP
  2592        GO TO 12000-CHECK-MD-TRUNC.                               ERCNETP
  2593                                                                  ERCNETP
  2594     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2595                                                                  ERCNETP
  2596     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2597     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  2598                                                                  ERCNETP
  2599     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2600                                                                  ERCNETP
  2601     COMPUTE WK3 EQUAL                                            ERCNETP
  2602        (CP-ORIGINAL-BENEFIT * 2 * (M - (ANGLEN-M - ANGLEN)) *    ERCNETP
  2603        WS-WORK-RATE) / (ANGLEN-1 * (N + 1) * I).                 ERCNETP
  2604                                                                  ERCNETP
  2605     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2606                                                                  ERCNETP
  2607     GO TO 99999-RETURN.                                          ERCNETP
  2608                                                                  ERCNETP
  2609 12000-CHECK-MD-TRUNC.                                            ERCNETP
  2610                                                                  ERCNETP
  2611     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2612        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2613        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2614        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2615        NEXT SENTENCE                                             ERCNETP
  2616     ELSE                                                         ERCNETP
  2617        GO TO 12000-CHECK-MD.                                     ERCNETP
  2618                                                                  ERCNETP
  2619     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2620                                                                  ERCNETP
  2621     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  2622     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  2623     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  52
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2624                                                                  ERCNETP
  2625     COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                         ERCNETP
  2626                                                                  ERCNETP
  2627     COMPUTE WK3 EQUAL                                            ERCNETP
  2628        CP-ORIGINAL-BENEFIT * WS-WORK-RATE *                      ERCNETP
  2629        ((ANGLEM * (M - (ANGLEN - ANGLEN-M))) /                   ERCNETP
  2630        (ANGLEN-1 * (M - ANGLEM))).                               ERCNETP
  2631                                                                  ERCNETP
  2632     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2633                                                                  ERCNETP
  2634     GO TO 99999-RETURN.                                          ERCNETP
  2635                                                                  ERCNETP
  2636 12000-CHECK-MD.                                                  ERCNETP
  2637                                                                  ERCNETP
  2638     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2639        (CP-STATE-STD-ABBRV EQUAL 'MD') AND                       ERCNETP
  2640        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  2641        NEXT SENTENCE                                             ERCNETP
  2642     ELSE                                                         ERCNETP
  2643        GO TO 12000-CHECK-ME-TRUNC.                               ERCNETP
  2644                                                                  ERCNETP
  2645     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100.           ERCNETP
  2646                                                                  ERCNETP
  2647     COMPUTE WK3 EQUAL                                            ERCNETP
  2648        CP-ORIGINAL-BENEFIT * WS-WORK-RATE.                       ERCNETP
  2649                                                                  ERCNETP
  2650     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2651                                                                  ERCNETP
  2652     GO TO 99999-RETURN.                                          ERCNETP
  2653                                                                  ERCNETP
  2654 12000-CHECK-ME-TRUNC.                                            ERCNETP
  2655                                                                  ERCNETP
  2656     IF (CP-COMPANY-ID EQUAL 'NCL' OR 'CID')
  2657        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2658        AND (CP-EARN-AS-NET-PAY)
  2659        AND (CP-TRUNCATED-LIFE)
  2660        CONTINUE
  2661     ELSE
  2662        GO TO 12000-CHECK-CID-WA-FARMPLAN
  2663     END-IF
  2664                                                                  ERCNETP
  2665     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  2666
  2667     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2668
  2669     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2670
  2671     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2672
  2673     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2674     COMPUTE ANGLEN-1 = ANGLEN / Y
  2675
  2676     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2677
  2678     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  2679
  2680     COMPUTE WK9 = 1 / (1 + (WS-WORK-DIS-RATE * (N - M) / 24))
  2681
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  53
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2682     COMPUTE WK3
  2683        = (WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE * WK5)
  2684        - (WK4 * (((N - M) - ANGLEN-M) / I) * WS-WORK-RATE * WK9
  2685            * (1 / (1.0635 ** (M / 12))))
  2686
  2687*    COMPUTE WK8 EQUAL 1 / (1 + (.045 * N / 24)).                 ERCNETP
  2688*    COMPUTE WK9 EQUAL                                            ERCNETP
  2689*       1 / (1 + (.045 * (N - M) / 24))                           ERCNETP
  2690*    COMPUTE WK7 EQUAL                                            ERCNETP
  2691*       WS-WORK-RATE * 20 / (M + 1).                              ERCNETP
  2692*    COMPUTE WK3 EQUAL                                            ERCNETP
  2693*       ((( N - ANGLEN) * WK7 * WK8) /                            ERCNETP
  2694*       (10 * ANGLEN-1 * I)) -                                    ERCNETP
  2695*       (((N - M - ANGLEN-M) * WK7 * WK9 * 1) /                   ERCNETP
  2696*       (10 * ANGLEN-1 * I * (1.0635 ** (M / 12)))).              ERCNETP
  2697*    COMPUTE WK3 EQUAL WK3 * CP-ORIGINAL-BENEFIT.                 ERCNETP
  2698*                                                                 ERCNETP
  2699     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  2700                                                                  ERCNETP
  2701     GO TO 99999-RETURN
  2702
  2703      .
  2704 12000-CHECK-CID-WA-FARMPLAN.
  2705
  2706     IF (CP-COMPANY-ID EQUAL 'CID')
  2707        AND (CP-STATE-STD-ABBRV = 'WA')
  2708        AND (CP-FARM-PLAN)
  2709        CONTINUE
  2710     ELSE
  2711        GO TO 12000-CHECK-CID-FARMPLAN
  2712     END-IF
  2713
  2714**  This was removed due to IR 2015022300001
  2715    GO TO 12000-CHECK-CID-FARMPLAN
  2716
  2717     move cp-original-term       to n
  2718     move cp-no-of-pmts          TO C-TOT-PMTS
  2719     compute c-pmts-per-year = 12 / cp-pay-frequency
  2720     move cp-pay-frequency       to m
  2721     compute c-days-in-pmt-per = 365 / c-pmts-per-year
  2722     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  2723     if i = zeros
  2724        move .0000000001         to i
  2725     end-if
  2726     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** c-tot-pmts) / I
  2727
  2728     COMPUTE Y = (1 + ((CP-DAYS-TO-1ST-PMT * I) /
  2729        (m * 30))) / (1 + I)
  2730     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  2731        ** CP-PAY-FREQUENCY) - 1
  2732     COMPUTE TI = (cp-days-to-1st-pmt - (M * 30)) / 30
  2733     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2734        ** TI) / WS-WORK-DIS-RATE
  2735     COMPUTE WK2 = (1 - (1 / (1 + J)) ** c-tot-pmts) / J
  2736     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (c-tot-pmts - 1)) / J
  2737     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2738        ** m) / WS-WORK-DIS-RATE
  2739     COMPUTE WK2 = WK2 * (1 + J)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  54
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2740     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  2741     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  2742     COMPUTE WK3 = WK3 * (1 + J)
  2743     COMPUTE WK5 = (WK3 - (c-tot-pmts - 1) * (1 / (1 + J)
  2744        ** (c-tot-pmts - 1))) / J
  2745     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  2746        ((c-tot-pmts * WK2) - WK5)) + (c-tot-pmts * WK1)) *
  2747        (CP-PREMIUM-RATE / 1000)
  2748     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / (anglen / y)
  2749     COMPUTE WK6 = (WK7 * GR)
  2750
  2751     MOVE WK6 TO CP-CALC-PREMIUM
  2752
  2753     GO TO 99999-RETURN
  2754
  2755     .
  2756 12000-CHECK-CID-FARMPLAN.
  2757
  2758     IF (CP-COMPANY-ID EQUAL 'CID')
  2759        AND (CP-STATE-STD-ABBRV EQUAL 'ND' OR 'MT' OR 'NJ'
  2760           OR 'IN' OR 'AZ')
  2761        AND (CP-FARM-PLAN)
  2762        CONTINUE
  2763     ELSE
  2764        GO TO 12000-CHECK-SC-CID
  2765     END-IF
  2766
  2767     COMPUTE N = M / CP-PAY-FREQUENCY
  2768     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2769     COMPUTE J = ((1 + WS-WORK-DIS-RATE)
  2770        ** CP-PAY-FREQUENCY) - 1
  2771     COMPUTE TI = (D - (CP-PAY-FREQUENCY * 30)) / 30
  2772     COMPUTE WK1 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2773        ** TI) / WS-WORK-DIS-RATE
  2774     COMPUTE WK2 = (1 - (1 / (1 + J)) ** N) / J
  2775     COMPUTE WK3 = (1 - (1 / (1 + J)) ** (N - 1)) / J
  2776     COMPUTE WK4 = (1 - (1 / (1 + WS-WORK-DIS-RATE))
  2777        ** CP-PAY-FREQUENCY) / WS-WORK-DIS-RATE
  2778     COMPUTE WK2 = WK2 * (1 + J)
  2779     COMPUTE WK4 = WK4 * (1 + WS-WORK-DIS-RATE)
  2780     COMPUTE WK1 = WK1 * (1 + WS-WORK-DIS-RATE)
  2781     COMPUTE WK3 = WK3 * (1 + J)
  2782     COMPUTE WK5 = (WK3 - (N - 1) * (1 / (1 + J)
  2783        ** (N - 1))) / J
  2784     COMPUTE GR = (((1 / (1 + WS-WORK-DIS-RATE) ** TI) * WK4 *
  2785        ((N * WK2) - WK5)) + (N * WK1)) *
  2786        (CP-PREMIUM-RATE / 1000)
  2787     COMPUTE WK7 = CP-ORIGINAL-BENEFIT / N
  2788     COMPUTE WK6 = (WK7 * GR)
  2789
  2790     MOVE WK6 TO CP-CALC-PREMIUM
  2791
  2792     GO TO 99999-RETURN
  2793
  2794     .
  2795 12000-CHECK-SC-CID.
  2796
  2797     IF (CP-COMPANY-ID = 'CID')
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  55
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2798        AND (CP-STATE-STD-ABBRV = 'SC')
  2799        AND (CP-EARN-AS-NET-PAY)
  2800        AND (CP-BENEFIT-CD = '2I' OR '2J' OR '2K' OR '2L')
  2801        move 6                   to ws-extra-pmts
  2802     ELSE
  2803        GO TO 12000-CHECK-AL-CID
  2804     END-IF
  2805
  2806     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2807     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2808     COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  2809        / 12)) / ((M + 1) / 2)
  2810
  2811     if i = .0000000001
  2812        compute wk4 = cp-original-benefit / n
  2813        compute wk3 = wk4 * (((n * (n + 1)) / 2 - ((n - m) *
  2814            (n - m + 1)) / 2 + ws-extra-pmts * m) * wk2 / 100)
  2815        display ' hit sc wo apr - wk2 ' wk2
  2816     else
  2817        COMPUTE ANGLEN rounded = (1 - (1 / (1 + I)) ** N) / I
  2818        COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2819        COMPUTE ANGLEN-1 = ANGLEN / Y
  2820        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2821        COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  2822           + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  2823     end-if
  2824
  2825*    COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2826*    COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2827*    COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2828*    COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2829*    COMPUTE ANGLEN-1 = ANGLEN / Y
  2830*    COMPUTE WK2 = (CP-PREMIUM-RATE * ((M + ((D - 30) / 30))
  2831*       / 12)) / ((M + 1) / 2)
  2832*    COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2833*    COMPUTE WK3 = WK4 * (((M - (ANGLEN - ANGLEN-M)) / I)
  2834*       + WS-EXTRA-PMTS * M) * (WK2 / 100) * (1 + I)
  2835
  2836     MOVE WK3 TO CP-CALC-PREMIUM
  2837
  2838     GO TO 99999-RETURN
  2839
  2840     .
  2841 12000-CHECK-AL-CID.
  2842
  2843     IF (CP-COMPANY-ID EQUAL 'CID')
  2844        AND (CP-BENEFIT-CD = '49' OR '50' OR '53' OR '54')
  2845        AND (CP-EARN-AS-NET-PAY)
  2846        CONTINUE
  2847     ELSE
  2848        GO TO 12000-CHECK-NH-CID
  2849     END-IF
  2850
  2851     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2852     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  2853     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2854
  2855     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  56
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2856                   / (1 + I)
  2857
  2858     COMPUTE ANGLEN-1 = ANGLEN / WK8
  2859
  2860     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2861
  2862     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M) + I * M) / I) *
  2863        (CP-PREMIUM-RATE / 1000)
  2864
  2865     MOVE WK3 TO CP-CALC-PREMIUM
  2866
  2867     GO TO 99999-RETURN
  2868
  2869     .
  2870 12000-CHECK-NH-CID.
  2871
  2872     IF (CP-COMPANY-ID EQUAL 'CID')
  2873        AND (CP-STATE-STD-ABBRV = 'NH' OR 'AK')
  2874        AND (CP-EARN-AS-NET-PAY)
  2875        CONTINUE
  2876     ELSE
  2877        GO TO 12000-CHECK-PA-CID
  2878     END-IF
  2879
  2880     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2881     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  2882
  2883     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30)* I) / +30)
  2884                   / (1 + I)
  2885
  2886     COMPUTE ANGLEN-1 = ANGLEN / WK8
  2887
  2888     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2889
  2890     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  2891        (1 + (2 * I)) * (CP-PREMIUM-RATE / 1000)
  2892
  2893     MOVE WK3 TO CP-CALC-PREMIUM
  2894
  2895     GO TO 99999-RETURN
  2896
  2897     .
  2898 12000-CHECK-PA-CID.
  2899
  2900     IF (CP-COMPANY-ID EQUAL 'CID')
  2901        AND (CP-STATE-STD-ABBRV EQUAL 'PA')
  2902        AND (CP-EARN-AS-NET-PAY)
  2903        CONTINUE
  2904     ELSE
  2905        GO TO 12000-CHECK-ME-CID
  2906     END-IF
  2907
  2908
  2909     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2910     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2911     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2912     COMPUTE ANGLEN-1 = ANGLEN / Y
  2913     COMPUTE WK5 = 1 / (10 * (1 + (WS-WORK-DIS-RATE / 24) * N))
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  57
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2914     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2915     COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +100
  2916     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  2917        * WK5
  2918
  2919     MOVE WK3 TO CP-CALC-PREMIUM
  2920
  2921     GO TO 99999-RETURN
  2922
  2923     .
  2924 12000-CHECK-ME-CID.
  2925
  2926     IF (CP-COMPANY-ID EQUAL 'CID')
  2927        AND (CP-STATE-STD-ABBRV EQUAL 'ME')
  2928        AND (CP-EARN-AS-NET-PAY)
  2929        CONTINUE
  2930     ELSE
  2931        GO TO 12000-CHECK-VT-TRUNC
  2932     END-IF
  2933
  2934     COMPUTE WS-WORK-RATE = CP-PREMIUM-RATE / +1000
  2935
  2936     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  2937
  2938     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  2939     COMPUTE Y = (1 + (D * I) / 30) / (1 + I)
  2940     COMPUTE ANGLEN-1 = ANGLEN / Y
  2941
  2942     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  2943
  2944     COMPUTE WK5 = 1 / (1 + (WS-WORK-DIS-RATE * N / 24))
  2945
  2946     COMPUTE WK3 = WK4 * ((N - ANGLEN) / I) * WS-WORK-RATE
  2947        * WK5
  2948
  2949     MOVE WK3 TO CP-CALC-PREMIUM
  2950
  2951     GO TO 99999-RETURN
  2952
  2953     .
  2954 12000-CHECK-VT-TRUNC.                                            ERCNETP
  2955                                                                  ERCNETP
  2956     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2957        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  2958        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  2959        (CP-TRUNCATED-LIFE)                                       ERCNETP
  2960        NEXT SENTENCE                                             ERCNETP
  2961     ELSE                                                         ERCNETP
  2962        GO TO 12000-CHECK-VT.                                     ERCNETP
  2963                                                                  ERCNETP
  2964      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  2965                                                                  ERCNETP
  2966      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2967                                                                  ERCNETP
  2968      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  2969                                                                  ERCNETP
  2970      COMPUTE WK8 EQUAL (1 / (1 + I)) ** N.                       ERCNETP
  2971      COMPUTE WK9 EQUAL                                           ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  58
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  2972        (1 - ((1 / (1 + ((.0054 - I) / (1 + I)))) ** (M - 1))) /  ERCNETP
  2973        ((.0054 - I) / (1 + I)).                                  ERCNETP
  2974      COMPUTE WK7 EQUAL                                           ERCNETP
  2975        (1 - (1 / 1.0054) ** (M - 1)) / .0054.                    ERCNETP
  2976      COMPUTE WK3 EQUAL  CP-ORIGINAL-BENEFIT * WS-WORK-RATE *     ERCNETP
  2977        ((WK7 + 1) - (WK8 * (WK9 + 1))) / (ANGLEN-1 * I).         ERCNETP
  2978                                                                  ERCNETP
  2979      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  2980                                                                  ERCNETP
  2981     GO TO 99999-RETURN.                                          ERCNETP
  2982                                                                  ERCNETP
  2983 12000-CHECK-VT.                                                  ERCNETP
  2984                                                                  ERCNETP
  2985     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  2986        (CP-STATE-STD-ABBRV EQUAL 'VT') AND                       ERCNETP
  2987        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  2988        NEXT SENTENCE                                             ERCNETP
  2989     ELSE                                                         ERCNETP
  2990        GO TO 12000-CHECK-MINN-WDS.                               ERCNETP
  2991                                                                  ERCNETP
  2992      COMPUTE WS-WORK-RATE EQUAL CP-PREMIUM-RATE / +1000.         ERCNETP
  2993                                                                  ERCNETP
  2994      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  2995                                                                  ERCNETP
  2996      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  2997                                                                  ERCNETP
  2998      COMPUTE WK3 EQUAL ((CP-ORIGINAL-BENEFIT * WS-WORK-RATE) /   ERCNETP
  2999                        (ANGLEN-1 * I)) *                         ERCNETP
  3000                                                                  ERCNETP
  3001                        (((1.0054 ** N - 1) /                     ERCNETP
  3002                        (1.0054 ** (N - 1) * .0054)) -            ERCNETP
  3003                                                                  ERCNETP
  3004                        ((V * (1 - 1.0054 ** N * VX)) /           ERCNETP
  3005                        (1.0054 ** (N - 1) * (1 - 1.0054 * V)))). ERCNETP
  3006                                                                  ERCNETP
  3007      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3008                                                                  ERCNETP
  3009     GO TO 99999-RETURN.                                          ERCNETP
  3010                                                                  ERCNETP
  3011 12000-CHECK-MINN-WDS.                                            ERCNETP
  3012                                                                  ERCNETP
  3013     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3014        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3015        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3016        NEXT SENTENCE                                             ERCNETP
  3017     ELSE                                                         ERCNETP
  3018        GO TO 12000-CHECK-MINN-BALL-LEV.                          ERCNETP
  3019                                                                  ERCNETP
  3020     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3021     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +100) *                 ERCNETP
  3022              (N / +12) * (2 / (N + 1)).                          ERCNETP
  3023     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN) *           ERCNETP
  3024         WK3 * ((N - ANGLEN) / I).                                ERCNETP
  3025                                                                  ERCNETP
  3026      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3027                                                                  ERCNETP
  3028     GO TO 99999-RETURN.                                          ERCNETP
  3029                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  59
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3030 12000-CHECK-MINN-BALL-LEV.                                       ERCNETP
  3031                                                                  ERCNETP
  3032     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3033        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3034        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3035        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3036        NEXT SENTENCE                                             ERCNETP
  3037     ELSE                                                         ERCNETP
  3038        GO TO 12000-CHECK-MINN-BALL.                              ERCNETP
  3039                                                                  ERCNETP
  3040     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3041                                                                  ERCNETP
  3042     COMPUTE WK3 EQUAL 1 / (1 + I) ** N.                          ERCNETP
  3043                                                                  ERCNETP
  3044     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3045        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / WK3).             ERCNETP
  3046                                                                  ERCNETP
  3047     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3048                                                                  ERCNETP
  3049     GO TO 99999-RETURN.                                          ERCNETP
  3050                                                                  ERCNETP
  3051 12000-CHECK-MINN-BALL.                                           ERCNETP
  3052                                                                  ERCNETP
  3053     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3054        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3055        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3056        NEXT SENTENCE                                             ERCNETP
  3057     ELSE                                                         ERCNETP
  3058        GO TO 12000-CHECK-CID-MN-BALL.                            ERCNETP
  3059                                                                  ERCNETP
  3060     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3061     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3062                                                                  ERCNETP
  3063     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3064     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3065     (((N - 1) - ANGLEN-1) / (I * ANGLEN-1)).                     ERCNETP
  3066                                                                  ERCNETP
  3067      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3068                                                                  ERCNETP
  3069     GO TO 99999-RETURN.                                          ERCNETP
  3070                                                                  ERCNETP
  3071 12000-CHECK-CID-MN-BALL.                                         ERCNETP
  3072                                                                  ERCNETP
  3073     IF (CP-COMPANY-ID EQUAL 'CID')
  3074        AND (CP-STATE-STD-ABBRV = 'MN')
  3075        AND (CP-CERT-EFF-DT > X'A4FF')
  3076        AND (CP-EARN-AS-REG-BALLOON)
  3077        CONTINUE
  3078     ELSE
  3079        GO TO 12000-CHECK-CID-MN-FARM
  3080     END-IF
  3081                                                                  ERCNETP
  3082     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3083     COMPUTE ANGLEM = (1 - (1 / (1 + I)) ** M) / I
  3084     COMPUTE ANGLEMP1 = (1 - (1 / (1 + I)) ** (M + 1)) / I
  3085     COMPUTE ANGLEM-1 = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3086     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3087     COMPUTE V = 1 / (1 + I)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  60
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3088     COMPUTE D = CP-TERM-OR-EXT-DAYS + +30
  3089     COMPUTE Y = (1 + (D * I) / +30)
  3090        / (1 + I)
  3091
  3092
  3093     COMPUTE CP-LF-BALLOON-PREM = CP-ALTERNATE-BENEFIT * (M + 1)
  3094        * CP-PREMIUM-RATE / 1000
  3095
  3096*    IF CP-MONTHLY-PAYMENT NOT = ZEROS
  3097*       MOVE CP-MONTHLY-PAYMENT  TO GR
  3098*    ELSE
  3099*       COMPUTE WK6 = CP-ORIGINAL-BENEFIT + CP-ALTERNATE-BENEFIT
  3100*          * (ANGLEM / Y) * (CP-PREMIUM-RATE / 1000) -
  3101*          CP-ALTERNATE-BENEFIT * V ** (M + ((D - 30) / 30))
  3102*       DISPLAY ' BALLOON TOP ' WK6
  3103*       COMPUTE WK7 = (ANGLEM-1 / Y) - ((M - 1) - ANGLEM-1) / I
  3104*          * (CP-PREMIUM-RATE / 1000) * (1 + I) - ((M - 1) * 6.65)
  3105*          / 100
  3106*       DISPLAY ' BALLOON BOTTOM ' WK7
  3107*       COMPUTE GR = WK6 / WK7
  3108*       DISPLAY ' BALLOON PAYMENT ' GR
  3109*    END-IF
  3110
  3111     COMPUTE WK8 = (1 + I) ** ((M + 1) * -1)
  3112     COMPUTE CP-ORIGINAL-BENEFIT ROUNDED = (CP-ORIGINAL-BENEFIT
  3113        + CP-ALTERNATE-BENEFIT) - (CP-ALTERNATE-BENEFIT * WK8)
  3114     COMPUTE GR = CP-ORIGINAL-BENEFIT / ANGLEM
  3115
  3116     COMPUTE WK3 = (GR * ((M - ANGLEM) / I) * (1 + I)
  3117        + (CP-ALTERNATE-BENEFIT * ANGLEMP1) -
  3118           (CP-ALTERNATE-BENEFIT * (M + 1)))
  3119           * CP-PREMIUM-RATE / 1000
  3120
  3121     MOVE WK3                    TO CP-CALC-PREMIUM
  3122                                                                  ERCNETP
  3123     GO TO 99999-RETURN.                                          ERCNETP
  3124
  3125     .
  3126 12000-CHECK-CID-MN-FARM.
  3127
  3128     IF (CP-COMPANY-ID EQUAL 'CID')
  3129        AND (CP-STATE-STD-ABBRV = 'MN' or 'WA')
  3130        AND (CP-CERT-EFF-DT > X'A4FF')
  3131        AND (CP-EARN-AS-FARM-PLAN)
  3132        CONTINUE
  3133     ELSE
  3134        GO TO 12000-CHECK-CID-NET-BALLoons
  3135     END-IF
  3136
  3137     EVALUATE CP-PMT-MODE
  3138        WHEN 'B'
  3139           MOVE +14              TO C-DAYS-IN-PMT-PER
  3140           MOVE +26              TO C-PMTS-PER-YEAR
  3141           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3142        WHEN 'S'
  3143           MOVE +15              TO C-DAYS-IN-PMT-PER
  3144           MOVE +24              TO C-PMTS-PER-YEAR
  3145           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  61
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3146        WHEN 'T'
  3147           MOVE +360             TO C-DAYS-IN-PMT-PER
  3148           MOVE +1               TO C-PMTS-PER-YEAR
  3149           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3150        WHEN 'W'
  3151           MOVE +7               TO C-DAYS-IN-PMT-PER
  3152           MOVE +52              TO C-PMTS-PER-YEAR
  3153           MOVE CP-NO-OF-PMTS    TO C-TOT-PMTS
  3154        WHEN OTHER
  3155           move cp-no-of-pmts    to c-tot-pmts
  3156           if cp-pay-frequency > zeros
  3157              compute c-pmts-per-year =
  3158                 12 / cp-pay-frequency
  3159              compute c-days-in-pmt-per = 360 / c-pmts-per-year
  3160           else
  3161              MOVE +30           TO C-DAYS-IN-PMT-PER
  3162              MOVE +12           TO C-PMTS-PER-YEAR
  3163              MOVE CP-LOAN-TERM  TO C-TOT-PMTS
  3164           end-if
  3165     END-EVALUATE
  3166
  3167     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  3168     if i = zeros
  3169        move .0000000001         to i
  3170     end-if
  3171
  3172     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  3173        C-DAYS-IN-PMT-PER)) / (1 + I)
  3174
  3175     compute cp-premium-rate =
  3176        cp-premium-rate * 12 / c-pmts-per-year / 10
  3177     move c-tot-pmts to n m
  3178     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3179     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3180     COMPUTE ANGLEN-1 = ANGLEN / Y
  3181     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3182
  3183     compute wk3 = wk3 * ((m - (anglen - anglen-m)) / i) *
  3184        (cp-premium-rate / 100)
  3185
  3186
  3187     MOVE WK3                    TO CP-CALC-PREMIUM
  3188
  3189     GO TO 99999-RETURN.
  3190
  3191     .
  3192 12000-check-cid-net-balloons.
  3193
  3194     IF (CP-COMPANY-ID EQUAL 'CID')
  3195        AND (CP-EARN-AS-REG-BALLOON)
  3196        and (CP-NET-ONLY-STATE not = 'Y')
  3197        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3198        CONTINUE
  3199     ELSE
  3200        GO TO 12000-check-cid-net-only-balls
  3201     END-IF
  3202
  3203     display ' *** NOT NET ONLY STATE BALLOONS *** '
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  62
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3204     COMPUTE Y =
  3205        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3206
  3207     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3208     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3209     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3210     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3211     COMPUTE ANGLEMY = ANGLEM / Y
  3212     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3213     COMPUTE ANGLENY = ANGLEN / Y
  3214     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3215
  3216     compute cp-original-benefit =
  3217        cp-original-benefit + cp-alternate-benefit
  3218     COMPUTE PVBALLOON rounded =
  3219        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3220     compute wk4 rounded =
  3221        cp-original-benefit - pvballoon
  3222     compute wk6 rounded =
  3223        (cp-original-benefit - cp-alternate-benefit)
  3224
  3225***  compute ra = wk4 / anglem-1y
  3226     compute ra = wk4 / anglemy
  3227     compute wk6 rounded = wk6 / anglemy
  3228     display ' rate before ' cp-premium-rate
  3229
  3230
  3231     compute cp-premium-rate =
  3232        (cp-premium-rate * ((m + (cp-days-to-1st-pmt - 30)
  3233            / 30) / 12))     /
  3234           ((m + 1) / 2)
  3235
  3236     display '************************************'
  3237     display ' orign ben    ' cp-original-benefit
  3238     display ' balloon      ' cp-alternate-benefit
  3239     display ' ra           ' ra
  3240     display ' wk6          ' wk6
  3241     display ' m            ' m
  3242     display ' anglemy      ' anglemy
  3243     display ' anglem-1     ' anglem-1y
  3244     display ' i            ' i
  3245     display ' extra per    ' cp-extra-periods
  3246     display ' prem rate    ' cp-premium-rate
  3247
  3248
  3249***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3250***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3251
  3252     compute wk3 = wk6 * (m - anglem) / i * (1 +
  3253        (cp-extra-periods * i)) * cp-premium-rate / 100
  3254
  3255     move wk3                    to cp-calc-premium
  3256     display ' wk3          ' wk3
  3257     display '************************************'
  3258*    compute wk3 rounded =
  3259*       cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3260*    move wk3                    to cp-lf-balloon-prem
  3261
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  63
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3262     GO TO 99999-RETURN.
  3263
  3264     .
  3265 12000-check-cid-net-only-balls.
  3266
  3267     IF (CP-COMPANY-ID EQUAL 'CID')
  3268        AND (CP-EARN-AS-REG-BALLOON)
  3269        AND (CP-BEN-CATEGORY = 'P' OR 'I')
  3270        CONTINUE
  3271     ELSE
  3272        GO TO 12000-CHECK-NC-WDS
  3273     END-IF
  3274
  3275     display ' *** NET ONLY STATE BALLOONS *** '
  3276
  3277     COMPUTE Y =
  3278        (1 + (CP-DAYS-TO-1ST-PMT * I / 30)) / (1 + I)
  3279
  3280     COMPUTE ANGLEN   = (1 - (1 / (1 + I)) ** N) / I
  3281     COMPUTE ANGLEM   = (1 - (1 / (1 + I)) ** M) / I
  3282     COMPUTE ANGLEM-1   = (1 - (1 / (1 + I)) ** (M - 1)) / I
  3283     COMPUTE ANGLEN-MP1 = (1 - (1 / (1 + I)) ** (N - M + 1)) / I
  3284     COMPUTE ANGLEMY = ANGLEM / Y
  3285     COMPUTE ANGLEM-1Y = ANGLEM-1 / Y
  3286     COMPUTE ANGLENY = ANGLEN / Y
  3287     COMPUTE ANGLEN-MP1Y = ANGLEN-MP1 / Y
  3288
  3289
  3290     COMPUTE PVBALLOON rounded =
  3291        CP-ALTERNATE-BENEFIT / ((1 + I) ** (N + 1))
  3292     compute wk4 rounded =
  3293        cp-original-benefit - pvballoon
  3294
  3295
  3296*    compute cp-premium-rate =
  3297*       (cp-premium-rate * (m + 1) / 12)  /
  3298*          ((m + 2) / 2)
  3299
  3300
  3301***  compute ra = wk4 / anglem-1y
  3302     compute ra = (cp-original-benefit + cp-alternate-benefit -
  3303        pvballoon) / anglemy
  3304
  3305     display '************************************'
  3306     display ' ra           ' ra
  3307     display ' m            ' m
  3308     display ' anglemy      ' anglemy
  3309     display ' anglem-1     ' anglem-1y
  3310     display ' i            ' i
  3311     display ' extra per    ' cp-extra-periods
  3312     display ' prem rate    ' cp-premium-rate
  3313     display '************************************'
  3314
  3315***  compute wk3 = ra * ((m - 1) - anglem-1y) / i * (1 +
  3316***     (cp-extra-periods * i)) * cp-premium-rate / 100
  3317
  3318     compute wk3 = ra * (m - anglemy) / i * (1 +
  3319        (cp-extra-periods * i)) * cp-premium-rate / 100
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  64
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3320
  3321     move wk3                    to cp-calc-premium
  3322     compute wk3 rounded =
  3323        cp-alternate-benefit * (m + 1) * cp-premium-rate / 100
  3324     move wk3                    to cp-lf-balloon-prem
  3325
  3326     GO TO 99999-RETURN.
  3327
  3328     .
  3329 12000-CHECK-NC-WDS.                                              ERCNETP
  3330                                                                  ERCNETP
  3331     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3332        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3333        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3334        NEXT SENTENCE                                             ERCNETP
  3335     ELSE                                                         ERCNETP
  3336        GO TO 12000-CHECK-NC-BALL-LEV.                            ERCNETP
  3337                                                                  ERCNETP
  3338     COMPUTE WK4 EQUAL N * (1 + I * 2).                           ERCNETP
  3339     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3340     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                      ERCNETP
  3341              CP-PREMIUM-RATE / +100 *                            ERCNETP
  3342              N / +12 * 2 / (N + 1) *                             ERCNETP
  3343              (WK4 - ANGLEN) / (I * ANGLEN).                      ERCNETP
  3344                                                                  ERCNETP
  3345      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3346                                                                  ERCNETP
  3347     GO TO 99999-RETURN.                                          ERCNETP
  3348                                                                  ERCNETP
  3349 12000-CHECK-NC-BALL-LEV.                                         ERCNETP
  3350                                                                  ERCNETP
  3351     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3352        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3353        (CP-DEVIATION-CODE EQUAL 'LEV') AND                       ERCNETP
  3354        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3355        NEXT SENTENCE                                             ERCNETP
  3356     ELSE                                                         ERCNETP
  3357        GO TO 12000-CHECK-NC-BALL.                                ERCNETP
  3358                                                                  ERCNETP
  3359     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3360                                                                  ERCNETP
  3361**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3362                                                                  ERCNETP
  3363     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE /    ERCNETP
  3364        +100 * N / 12 * 2 / (N + 1) * (ANGLEN / VX).              ERCNETP
  3365                                                                  ERCNETP
  3366     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3367                                                                  ERCNETP
  3368     GO TO 99999-RETURN.                                          ERCNETP
  3369                                                                  ERCNETP
  3370 12000-CHECK-NC-BALL.                                             ERCNETP
  3371                                                                  ERCNETP
  3372     IF (CP-COMPANY-ID EQUAL 'WDS') AND                           ERCNETP
  3373        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3374        (CP-EARN-AS-REG-BALLOON)                                  ERCNETP
  3375        NEXT SENTENCE                                             ERCNETP
  3376     ELSE                                                         ERCNETP
  3377        GO TO 12000-CHECK-MINN-TRUNC.                             ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  65
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3378                                                                  ERCNETP
  3379     COMPUTE WK4 EQUAL (N - 1) * (1 + I * 2).                     ERCNETP
  3380     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3381     COMPUTE ANGLEN-1 EQUAL WK6 / I.                              ERCNETP
  3382**** VX = 1 / (1 + I)**N.                                         ERCNETP
  3383                                                                  ERCNETP
  3384     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE      ERCNETP
  3385     / +100 * (N - 1) / 12 * 2 / N *                              ERCNETP
  3386     (WK4 - ANGLEN-1) / (I * ANGLEN-1).                           ERCNETP
  3387                                                                  ERCNETP
  3388      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3389                                                                  ERCNETP
  3390     GO TO 99999-RETURN.                                          ERCNETP
  3391                                                                  ERCNETP
  3392 12000-CHECK-MINN-TRUNC.                                          ERCNETP
  3393                                                                  ERCNETP
  3394     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3395        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3396        (M GREATER THAN +63) AND                                  ERCNETP
  3397        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3398        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3399        NEXT SENTENCE                                             ERCNETP
  3400     ELSE                                                         ERCNETP
  3401        GO TO 12000-CHECK-MINN.                                   ERCNETP
  3402                                                                  ERCNETP
  3403      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3404      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3405                                                                  ERCNETP
  3406      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3407                                                                  ERCNETP
  3408      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3409       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3410       (((M - ANGLEN + ANGLEN-M) / I) + (2 * M)).                 ERCNETP
  3411                                                                  ERCNETP
  3412      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3413                                                                  ERCNETP
  3414     GO TO 99999-RETURN.                                          ERCNETP
  3415                                                                  ERCNETP
  3416 12000-CHECK-MINN.                                                ERCNETP
  3417                                                                  ERCNETP
  3418     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3419        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  3420        (M GREATER THAN +63) AND                                  ERCNETP
  3421        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3422        NEXT SENTENCE                                             ERCNETP
  3423     ELSE                                                         ERCNETP
  3424        GO TO 12000-CHECK-MONTANA-TRUNC.                          ERCNETP
  3425                                                                  ERCNETP
  3426      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3427                                                                  ERCNETP
  3428      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3429                                                                  ERCNETP
  3430      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3431       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3432       (((N - ANGLEN) / I) + (2 * N)).                            ERCNETP
  3433                                                                  ERCNETP
  3434      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3435                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  66
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3436     GO TO 99999-RETURN.                                          ERCNETP
  3437                                                                  ERCNETP
  3438 12000-CHECK-MONTANA-TRUNC.                                       ERCNETP
  3439                                                                  ERCNETP
  3440     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3441        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3442        (M GREATER THAN +63) AND                                  ERCNETP
  3443        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3444        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3445        NEXT SENTENCE                                             ERCNETP
  3446     ELSE                                                         ERCNETP
  3447        GO TO 12000-CHECK-MONTANA.                                ERCNETP
  3448                                                                  ERCNETP
  3449      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3450      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3451                                                                  ERCNETP
  3452      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3453                                                                  ERCNETP
  3454      COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT *                     ERCNETP
  3455      ((CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3456       (((M - ANGLEN + ANGLEN-M) / I) + (4 * M)).                 ERCNETP
  3457                                                                  ERCNETP
  3458      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3459                                                                  ERCNETP
  3460     GO TO 99999-RETURN.                                          ERCNETP
  3461                                                                  ERCNETP
  3462 12000-CHECK-MONTANA.                                             ERCNETP
  3463                                                                  ERCNETP
  3464     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3465        (CP-STATE-STD-ABBRV EQUAL 'MT') AND                       ERCNETP
  3466        (M GREATER THAN +63) AND                                  ERCNETP
  3467        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3468        NEXT SENTENCE                                             ERCNETP
  3469     ELSE                                                         ERCNETP
  3470        GO TO 12001-CONTINUE-NCL-TRUNC.                           ERCNETP
  3471                                                                  ERCNETP
  3472      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3473                                                                  ERCNETP
  3474      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3475                                                                  ERCNETP
  3476      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3477       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3478       (((N - ANGLEN) / I) + (4 * N)).                            ERCNETP
  3479                                                                  ERCNETP
  3480      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3481                                                                  ERCNETP
  3482     GO TO 99999-RETURN.                                          ERCNETP
  3483                                                                  ERCNETP
  3484 12001-CONTINUE-NCL-TRUNC.                                        ERCNETP
  3485                                                                  ERCNETP
  3486     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3487        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3488        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3489        NEXT SENTENCE                                             ERCNETP
  3490     ELSE                                                         ERCNETP
  3491        GO TO 12001-CONTINUE-NCL.                                 ERCNETP
  3492                                                                  ERCNETP
  3493      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  67
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3494      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3495                                                                  ERCNETP
  3496      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3497                                                                  ERCNETP
  3498      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT * 2 *                ERCNETP
  3499      (M - (ANGLEN - ANGLEN-M)) * (CP-PREMIUM-RATE / +100)) /     ERCNETP
  3500      (ANGLEN-1 * (N + 1) * I).                                   ERCNETP
  3501                                                                  ERCNETP
  3502      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3503                                                                  ERCNETP
  3504     GO TO 99999-RETURN.                                          ERCNETP
  3505                                                                  ERCNETP
  3506 12001-CONTINUE-NCL.                                              ERCNETP
  3507                                                                  ERCNETP
  3508     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3509        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3510        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3511        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3512                                                                  ERCNETP
  3513     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3514        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3515        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3516        GO TO 12001-CHECK-CA.                                     ERCNETP
  3517                                                                  ERCNETP
  3518     IF (CP-COMPANY-ID EQUAL 'NCL') AND                           ERCNETP
  3519        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3520        NEXT SENTENCE                                             ERCNETP
  3521     ELSE                                                         ERCNETP
  3522        GO TO 12000-CONTINUE-NET.                                 ERCNETP
  3523                                                                  ERCNETP
  3524      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3525      MOVE ANGLEN                TO ANGLEN-1.                     ERCNETP
  3526                                                                  ERCNETP
  3527      COMPUTE ANGLEN-1 EQUAL ANGLEN * ODF.                        ERCNETP
  3528                                                                  ERCNETP
  3529      COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT *                    ERCNETP
  3530       (CP-PREMIUM-RATE / +100) * 2) / (ANGLEN-1 * (N + 1)) *     ERCNETP
  3531       ((N - ANGLEN) / I).                                        ERCNETP
  3532                                                                  ERCNETP
  3533      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3534                                                                  ERCNETP
  3535     GO TO 99999-RETURN.                                          ERCNETP
  3536                                                                  ERCNETP
  3537 12000-CONTINUE-NET.                                              ERCNETP
  3538                                                                  ERCNETP
  3539     IF (CP-COMPANY-ID EQUAL 'TMS') AND                           ERCNETP
  3540        (CP-STATE-STD-ABBRV EQUAL 'MN' OR 'CA' OR 'WA') AND       ERCNETP
  3541        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3542        NEXT SENTENCE                                             ERCNETP
  3543     ELSE                                                         ERCNETP
  3544        GO TO 12001-CONTINUE-MINN.                                ERCNETP
  3545                                                                  ERCNETP
  3546      COMPUTE ANGLEN EQUAL WK6 / I.                               ERCNETP
  3547      COMPUTE ODF EQUAL 1 + (12 * CP-TERM-OR-EXT-DAYS / +365).    ERCNETP
  3548                                                                  ERCNETP
  3549      COMPUTE WK7 EQUAL (1 + ODF * I) / (1 + ANGLEN).             ERCNETP
  3550      COMPUTE WK3 EQUAL (M  * WK7) - 1.                           ERCNETP
  3551      COMPUTE WK3 EQUAL (WK3 / I) *                               ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  68
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3552       ((M * (CP-PREMIUM-RATE / +100)) / (+6 * (M + 1))).         ERCNETP
  3553                                                                  ERCNETP
  3554      IF CP-R-MAX-TOT-BEN NOT NUMERIC                             ERCNETP
  3555         MOVE +0 TO CP-R-MAX-TOT-BEN.                             ERCNETP
  3556                                                                  ERCNETP
  3557      COMPUTE WK3 EQUAL (WK3 * CP-ORIGINAL-BENEFIT)               ERCNETP
  3558                                                                  ERCNETP
  3559      IF (CP-ORIGINAL-BENEFIT GREATER THAN CP-R-MAX-TOT-BEN) AND  ERCNETP
  3560         (CP-R-MAX-TOT-BEN NOT EQUAL +0)                          ERCNETP
  3561         COMPUTE WK3 EQUAL (WK3 * CP-R-MAX-TOT-BEN).              ERCNETP
  3562                                                                  ERCNETP
  3563      MOVE WK3 TO CP-CALC-PREMIUM.                                ERCNETP
  3564                                                                  ERCNETP
  3565     GO TO 99999-RETURN.                                          ERCNETP
  3566                                                                  ERCNETP
  3567 12001-CONTINUE-MINN.                                             ERCNETP
  3568                                                                  ERCNETP
  3569     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3570        (CP-STATE-STD-ABBRV EQUAL 'NJ') AND                       ERCNETP
  3571        (CP-TRUNCATED-LIFE)                                       ERCNETP
  3572        NEXT SENTENCE                                             ERCNETP
  3573     ELSE                                                         ERCNETP
  3574        GO TO 12001-CHECK-RI-GTL.                                 ERCNETP
  3575                                                                  ERCNETP
  3576      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3577      COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3578                                                                  ERCNETP
  3579      COMPUTE WK3 EQUAL ((M - ANGLEM * SX) /                      ERCNETP
  3580       (I * ANGLEN) * CP-PREMIUM-RATE / (1 + WS-WORK-DIS-RATE     ERCNETP
  3581       * M / 2400) * 1000 + .5) / 1000000.                        ERCNETP
  3582                                                                  ERCNETP
  3583      COMPUTE CP-CALC-PREMIUM EQUAL WK3 * (CP-ORIGINAL-BENEFIT    ERCNETP
  3584       - CP-ORIGINAL-PREMIUM) / (1 - WK3).                        ERCNETP
  3585                                                                  ERCNETP
  3586     GO TO 99999-RETURN.                                          ERCNETP
  3587                                                                  ERCNETP
  3588 12001-CHECK-RI-GTL.                                              ERCNETP
  3589                                                                  ERCNETP
  3590     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3591        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3592        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3593        NEXT SENTENCE                                             ERCNETP
  3594     ELSE                                                         ERCNETP
  3595        GO TO 12001-CHECK-RI-LEASE-GTL.                           ERCNETP
  3596                                                                  ERCNETP
  3597      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3598*     COMPUTE ANGLEM EQUAL WK2 / I.                               ERCNETP
  3599                                                                  ERCNETP
  3600      COMPUTE WK3 EQUAL (1000 * I * ANGLEN) *                     ERCNETP
  3601               (1 + WS-WORK-DIS-RATE * N).                        ERCNETP
  3602      COMPUTE CP-CALC-PREMIUM EQUAL CP-ORIGINAL-BENEFIT *         ERCNETP
  3603         ((N - ANGLEN) * (1 + 2 * I) * CP-PREMIUM-RATE) / WK3.    ERCNETP
  3604                                                                  ERCNETP
  3605                                                                  ERCNETP
  3606     GO TO 99999-RETURN.                                          ERCNETP
  3607                                                                  ERCNETP
  3608 12001-CHECK-RI-LEASE-GTL.                                        ERCNETP
  3609                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  69
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3610     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3611        (CP-STATE-STD-ABBRV EQUAL 'RI') AND                       ERCNETP
  3612        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3613        NEXT SENTENCE                                             ERCNETP
  3614     ELSE                                                         ERCNETP
  3615        GO TO 12001-CHECK-OR-GTL.                                 ERCNETP
  3616                                                                  ERCNETP
  3617     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3618                                                                  ERCNETP
  3619     COMPUTE WK3 EQUAL (CP-ORIGINAL-BENEFIT / ANGLEN *            ERCNETP
  3620        (N - ANGLEN) * CP-PREMIUM-RATE * (1 + 2 * I))             ERCNETP
  3621                        /                                         ERCNETP
  3622        (1000 * I * (1 + .0021 * N)).                             ERCNETP
  3623     COMPUTE CP-CALC-PREMIUM EQUAL WK3 +                          ERCNETP
  3624       (CP-ALTERNATE-BENEFIT * CP-PREMIUM-RATE * (N + 1))         ERCNETP
  3625                            /                                     ERCNETP
  3626       (1000 * (1 + .0027 * (N + 1))).                            ERCNETP
  3627                                                                  ERCNETP
  3628     GO TO 99999-RETURN.                                          ERCNETP
  3629                                                                  ERCNETP
  3630 12001-CHECK-OR-GTL.                                              ERCNETP
  3631                                                                  ERCNETP
  3632     IF (CP-COMPANY-ID EQUAL 'GTL' ) AND                          ERCNETP
  3633        (CP-STATE-STD-ABBRV EQUAL 'OR') AND                       ERCNETP
  3634        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3635        NEXT SENTENCE                                             ERCNETP
  3636     ELSE                                                         ERCNETP
  3637        GO TO 12001-CHECK-GA-GTL.                                 ERCNETP
  3638                                                                  ERCNETP
  3639     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3640     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3641                                                                  ERCNETP
  3642     IF M LESS THAN +64                                           ERCNETP
  3643        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3644         (1 + I) * CP-PREMIUM-RATE * (N - (N - M)))               ERCNETP
  3645                   /                                              ERCNETP
  3646         (I * ANGLEN * (N - (N - M) + 1) * 600)                   ERCNETP
  3647        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT   ERCNETP
  3648     ELSE                                                         ERCNETP
  3649        COMPUTE WK3 EQUAL (((N - (N - M)) - (ANGLEN - ANGLEN-M)) *ERCNETP
  3650        CP-PREMIUM-RATE * (1 + I))                                ERCNETP
  3651                  /                                               ERCNETP
  3652        (+1000 * I * ANGLEN)                                      ERCNETP
  3653        COMPUTE CP-CALC-PREMIUM EQUAL WK3 * CP-ORIGINAL-BENEFIT.  ERCNETP
  3654*    MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3655     GO TO 99999-RETURN.                                          ERCNETP
  3656                                                                  ERCNETP
  3657 12001-CHECK-GA-GTL.                                              ERCNETP
  3658                                                                  ERCNETP
  3659     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3660        (CP-STATE-STD-ABBRV EQUAL 'GA') AND                       ERCNETP
  3661        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3662*       (CP-TRUNCATED-LIFE)                                       ERCNETP
  3663        NEXT SENTENCE                                             ERCNETP
  3664     ELSE                                                         ERCNETP
  3665        GO TO 12001-CHECK-MA-GTL.                                 ERCNETP
  3666                                                                  ERCNETP
  3667     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  70
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3668     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3669                                                                  ERCNETP
  3670     COMPUTE WK3 EQUAL CP-ORIGINAL-BENEFIT / ANGLEN.              ERCNETP
  3671     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) * WK3 *          ERCNETP
  3672      ((N - (ANGLEN - ANGLEN-M)) / I) * (1 + 2 * I).              ERCNETP
  3673     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3674                                                                  ERCNETP
  3675     GO TO 99999-RETURN.                                          ERCNETP
  3676                                                                  ERCNETP
  3677 12001-CHECK-MA-GTL.                                              ERCNETP
  3678                                                                  ERCNETP
  3679     IF (CP-COMPANY-ID EQUAL 'GTL') AND                           ERCNETP
  3680        (CP-STATE-STD-ABBRV EQUAL 'MA') AND                       ERCNETP
  3681        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3682        (CP-SPECIAL-CALC-CD EQUAL 'H')                            ERCNETP
  3683        NEXT SENTENCE                                             ERCNETP
  3684     ELSE                                                         ERCNETP
  3685        GO TO 12001-CHECK-NV-NET.                                 ERCNETP
  3686                                                                  ERCNETP
  3687     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3688                                                                  ERCNETP
  3689     COMPUTE WK3 EQUAL (CP-PREMIUM-RATE / +1000) *                ERCNETP
  3690      CP-ALTERNATE-BENEFIT * N.                                   ERCNETP
  3691                                                                  ERCNETP
  3692     COMPUTE WK7 EQUAL (CP-ORIGINAL-BENEFIT + WK3) /              ERCNETP
  3693     (ANGLEN - (CP-PREMIUM-RATE / +1000) * (N - ANGLEN) / I).     ERCNETP
  3694                                                                  ERCNETP
  3695     COMPUTE WK3 EQUAL WK3 + (CP-PREMIUM-RATE / +1000) *          ERCNETP
  3696     WK7 * (N - ANGLEN) / I.                                      ERCNETP
  3697     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3698                                                                  ERCNETP
  3699     GO TO 99999-RETURN.                                          ERCNETP
  3700                                                                  ERCNETP
  3701 12001-CHECK-NV-NET.                                              ERCNETP
  3702
  3703     IF (CP-COMPANY-ID EQUAL 'CID')
  3704        AND (CP-STATE-STD-ABBRV = 'NV' OR 'WA')
  3705        AND (CP-EARN-AS-NET-PAY)
  3706        CONTINUE
  3707     ELSE
  3708        GO TO 12001-CHECK-MN-NET
  3709     END-IF
  3710
  3711     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3712     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3713
  3714     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3715                   / (1 + I)
  3716
  3717     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3718
  3719     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3720
  3721     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3722        (CP-PREMIUM-RATE * K-I / 1000)
  3723
  3724     MOVE WK3                    TO CP-CALC-PREMIUM
  3725
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  71
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3726     GO TO 99999-RETURN
  3727
  3728      .
  3729 12001-CHECK-MN-NET.
  3730
  3731     IF (CP-COMPANY-ID EQUAL 'CID')
  3732        AND (CP-STATE-STD-ABBRV = 'MN')
  3733        AND (CP-EARN-AS-NET-PAY)
  3734        AND (NOT CP-LEVEL-LIFE)
  3735        AND (WS-DISCOUNT-OPTION = '1')
  3736        CONTINUE
  3737     ELSE
  3738        GO TO 12001-CHECK-NC-NET
  3739     END-IF
  3740
  3741     if i = .0000000001
  3742        compute wk4 = cp-original-benefit / n
  3743        compute wk3 = wk4 * ((n * (n + 1) / 2) - ((n - m) *
  3744           (n - m + 1) / 2))*(cp-premium-rate / 1000)
  3745        move wk3 to cp-calc-premium
  3746        go to 99999-return
  3747     end-if
  3748
  3749     COMPUTE ANGLEN = (1 - (1 / (1 + I)) ** N) / I
  3750     COMPUTE ANGLEN-M = (1 - (1 / (1 + I)) ** (N - M)) / I
  3751
  3752     COMPUTE WK8 = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I) / +30)
  3753                   / (1 + I)
  3754
  3755     COMPUTE ANGLEN-1 = ANGLEN / WK8
  3756
  3757     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  3758
  3759     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  3760        (CP-PREMIUM-RATE / 1000) * (1 + I)
  3761
  3762     MOVE WK3                    TO CP-CALC-PREMIUM
  3763
  3764     GO TO 99999-RETURN
  3765
  3766      .
  3767 12001-CHECK-NC-NET.                                              ERCNETP
  3768                                                                  ERCNETP
  3769     IF (CP-COMPANY-ID EQUAL 'NCB' ) AND                          ERCNETP
  3770        (CP-STATE-STD-ABBRV EQUAL 'NC') AND                       ERCNETP
  3771        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3772        NEXT SENTENCE                                             ERCNETP
  3773     ELSE                                                         ERCNETP
  3774        GO TO 12001-CHECK-NC-NET-PLUS3.                           ERCNETP
  3775                                                                  ERCNETP
  3776      COMPUTE ANGLEN EQUAL WK1 / I.                               ERCNETP
  3777      COMPUTE ANGLEN-M EQUAL WK5 / I.                             ERCNETP
  3778                                                                  ERCNETP
  3779      COMPUTE WK6 ROUNDED = CP-ORIGINAL-BENEFIT /                 ERCNETP
  3780          (ANGLEN - (CP-PREMIUM-RATE / 1000) *                    ERCNETP
  3781          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N) -               ERCNETP
  3782          N * (CP-PREMIUM-RATE / 1000)).                          ERCNETP
  3783                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  72
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3784      COMPUTE WK3 ROUNDED = (CP-PREMIUM-RATE / 1000) * WK6 *      ERCNETP
  3785          ((N - (ANGLEN - ANGLEN-M)) / I + 3 * N).                ERCNETP
  3786                                                                  ERCNETP
  3787      COMPUTE WK7 ROUNDED = (1 - (CP-PREMIUM-RATE / 1000) *       ERCNETP
  3788          ((N - ANGLEN) / I + 3) / ANGLEN) /                      ERCNETP
  3789          (1 - (CP-PREMIUM-RATE / 1000) * N * (N + 1) /           ERCNETP
  3790          (ANGLEN * 2))                                           ERCNETP
  3791                                                                  ERCNETP
  3792      COMPUTE WK7 ROUNDED = WK7 * N - 3.                          ERCNETP
  3793                                                                  ERCNETP
  3794      IF ANGLEN IS NOT LESS THAN WK7                              ERCNETP
  3795          COMPUTE CP-PREMIUM-RATE ROUNDED =                       ERCNETP
  3796              (CP-PREMIUM-RATE / 1000) * +6.5 * (N / 12)          ERCNETP
  3797          COMPUTE WK3 ROUNDED =                                   ERCNETP
  3798              (CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE).            ERCNETP
  3799                                                                  ERCNETP
  3800     MOVE WK3 TO CP-CALC-PREMIUM.                                 ERCNETP
  3801                                                                  ERCNETP
  3802     GO TO 99999-RETURN.                                          ERCNETP
  3803                                                                  ERCNETP
  3804 12001-CHECK-NC-NET-PLUS3.                                        ERCNETP
  3805                                                                  ERCNETP
  3806     IF (CP-STATE-STD-ABBRV EQUAL 'NC') AND                          ERCNE
  3807        (CP-EARN-AS-NET-PAY) AND                                     ERCNE
  3808        (CP-COMPANY-ID NOT = 'CID' AND 'DCC' AND 'AHL')
  3809        NEXT SENTENCE                                                ERCNE
  3810     ELSE                                                            ERCNE
  3811        GO TO 12001-CHECK-CA.                                        ERCNE
  3812                                                                  ERCNETP
  3813     MOVE CP-CERT-EFF-DT TO DC-BIN-DATE-1.                        ERCNETP
  3814     MOVE ' ' TO DC-OPTION-CODE.                                  ERCNETP
  3815     PERFORM 9100-CONVERT-DATE THRU 9100-EXIT.                    ERCNETP
  3816                                                                  ERCNETP
  3817     IF DATE-CONVERSION-ERROR                                     ERCNETP
  3818        MOVE '2'                 TO CP-RETURN-CODE                ERCNETP
  3819        MOVE ZEROS               TO FACTOR                        ERCNETP
  3820                                    CP-CALC-PREMIUM               ERCNETP
  3821         GO TO 99999-RETURN.                                      ERCNETP
  3822                                                                  ERCNETP
  3823     IF DC-GREG-DATE-CYMD GREATER THAN 19931231                      CL**4
  3824        NEXT SENTENCE                                             ERCNETP
  3825     ELSE                                                         ERCNETP
  3826        GO TO 12001-CONTINUE-NET.                                 ERCNETP
  3827                                                                  ERCNETP
  3828     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3829     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  3830                                                                  ERCNETP
  3831     COMPUTE NC-LR = CP-PREMIUM-RATE / ( ORIGINAL-TERM / 12).     ERCNETP
  3832                                                                  ERCNETP
  3833     COMPUTE NC-R = 20 *                                          ERCNETP
  3834                    ((NC-LR * ORIGINAL-TERM) / 12)                ERCNETP
  3835                          / (ORIGINAL-TERM + 1).                  ERCNETP
  3836                                                                  ERCNETP
  3837     COMPUTE NC-OB = NC-R / 1000.                                 ERCNETP
  3838                                                                  ERCNETP
  3839     COMPUTE NC-P = (((ORIGINAL-TERM - ANGLEN) / I) * NC-OB) +    ERCNETP
  3840                    (NC-OB * ORIGINAL-TERM * 3).                  ERCNETP
  3841                                                                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  73
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3842     IF CP-EXT-CHG-LF                                             ERCNETP
  3843         COMPUTE NC-BIG-D = CP-TERM-OR-EXT-DAYS + 30              ERCNETP
  3844     ELSE                                                         ERCNETP
  3845         MOVE 30                 TO  NC-BIG-D.                    ERCNETP
  3846                                                                  ERCNETP
  3847     COMPUTE NC-LITTLE-D = (1 + I) /                              ERCNETP
  3848             ((( 1 + ((NC-BIG-D / 30.4166666)) * I))).            ERCNETP
  3849                                                                  ERCNETP
  3850     COMPUTE NC-MP ROUNDED = CP-ORIGINAL-BENEFIT  /               ERCNETP
  3851             (ANGLEN * NC-LITTLE-D ).                             ERCNETP
  3852                                                                  ERCNETP
  3853     COMPUTE CP-CALC-PREMIUM ROUNDED = NC-MP * NC-P.              ERCNETP
  3854                                                                  ERCNETP
  3855     GO TO 99999-RETURN.                                          ERCNETP
  3856                                                                  ERCNETP
  3857 12001-CHECK-CA.                                                  ERCNETP
  3858                                                                  ERCNETP
  3859     IF (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  3860        (WS-DISCOUNT-OPTION = '6')                                ERCNETP
  3861        NEXT SENTENCE                                             ERCNETP
  3862     ELSE                                                         ERCNETP
  3863        GO TO 12001-CHECK-GTL-IA.                                 ERCNETP
  3864                                                                  ERCNETP
  3865     COMPUTE CA-J = CA-DISCOUNT / 12.                             ERCNETP
  3866     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3867     COMPUTE CA-MP = CP-ORIGINAL-BENEFIT  / ANGLEN.               ERCNETP
  3868     COMPUTE CA-API = (1 - (1 + I)** - ORIGINAL-TERM) / I.        ERCNETP
  3869     COMPUTE CA-APJ = (1 - (1 + CA-J)** - ORIGINAL-TERM) / CA-J.  ERCNETP
  3870     COMPUTE CA-VI = (1 + I)** -1.                                ERCNETP
  3871     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  3872         ((CP-PREMIUM-RATE * 2) / (100 * (ORIGINAL-TERM + 1)) *   ERCNETP
  3873         ((1 + CA-J) / I) *                                       ERCNETP
  3874         (CA-APJ + (CA-J * CA-APJ - I * CA-API) *                 ERCNETP
  3875         ((CA-VI ** (LOAN-TERM - ORIGINAL-TERM)) /                ERCNETP
  3876         (I - CA-J))) * (1 + CP-ODD-DAYS-TO-PMT * I) * CA-MP).    ERCNETP
  3877                                                                  ERCNETP
  3878     GO TO 99999-RETURN.                                          ERCNETP
  3879                                                                  ERCNETP
  3880 12001-CHECK-GTL-IA.                                              ERCNETP
  3881                                                                  ERCNETP
  3882     IF (CP-COMPANY-ID EQUAL 'GTL')     AND                       ERCNETP
  3883        (CP-STATE-STD-ABBRV EQUAL 'IA') AND                       ERCNETP
  3884        (CP-EARN-AS-NET-PAY)                                      ERCNETP
  3885        NEXT SENTENCE                                             ERCNETP
  3886     ELSE                                                         ERCNETP
  3887        GO TO 12001-CHECK-CID-TRN-VA.                             ERCNETP
  3888                                                                  ERCNETP
  3889***************************************************************   ERCNETP
  3890                                                                  ERCNETP
  3891     COMPUTE GTL-IA-ODD-DAYS = CP-ODD-DAYS-TO-PMT - 30.           ERCNETP
  3892                                                                  ERCNETP
  3893     IF GTL-IA-ODD-DAYS = ZEROS                                   ERCNETP
  3894         MOVE ZERO               TO  GTL-IA-SGN                   ERCNETP
  3895     ELSE                                                         ERCNETP
  3896         IF GTL-IA-ODD-DAYS GREATER THAN ZERO                     ERCNETP
  3897             MOVE +1             TO  GTL-IA-SGN                   ERCNETP
  3898         ELSE                                                     ERCNETP
  3899             MOVE -1             TO  GTL-IA-SGN.                  ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  74
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3900                                                                  ERCNETP
  3901     MOVE GTL-IA-ODD-DAYS        TO  GTL-IA-ABS.                  ERCNETP
  3902     COMPUTE GTL-IA-ABS = GTL-IA-ABS - 30.                        ERCNETP
  3903                                                                  ERCNETP
  3904     COMPUTE GTL-IA-ODF = (1 + I * GTL-IA-ABS / 30) **            ERCNETP
  3905                          GTL-IA-SGN.                             ERCNETP
  3906                                                                  ERCNETP
  3907     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  3908     COMPUTE ANGLEN-M EQUAL WK5 / I.                                 CL**3
  3909                                                                  ERCNETP
  3910     IF GTL-IA-ODF NOT = ZERO                                     ERCNETP
  3911         COMPUTE ANGLEN EQUAL ANGLEN / GTL-IA-ODF                    CL**3
  3912         COMPUTE ANGLEN-M EQUAL ANGLEN-M / GTL-IA-ODF.               CL**3
  3913                                                                  ERCNETP
  3914     COMPUTE GTL-IA-DIVIDEND =                                       CL**3
  3915           (((N-P-LOAN - (N-P-LOAN - N-P-ORIG)) -                    CL**3
  3916                             (ANGLEN - ANGLEN-M))) *                 CL**3
  3917           ((K1 + I) * CP-PREMIUM-RATE *                             CL**3
  3918                     (N-P-LOAN - (N-P-LOAN - N-P-ORIG))).            CL**3
  3919                                                                     CL**3
  3920     COMPUTE GTL-IA-DIVISOR =                                     ERCNETP
  3921      I * ANGLEN * (N-P-LOAN - (N-P-LOAN - N-P-ORIG) + 1) * +600.    CL**3
  3922                                                                     CL**3
  3923     COMPUTE GTL-IA-FACTOR = GTL-IA-DIVIDEND / GTL-IA-DIVISOR.    ERCNETP
  3924                                                                     CL**3
  3925     COMPUTE CP-CALC-PREMIUM =                                    ERCNETP
  3926                           GTL-IA-FACTOR * CP-ORIGINAL-BENEFIT.   ERCNETP
  3927     GO TO 99999-RETURN.                                          ERCNETP
  3928                                                                  ERCNETP
  3929                                                                  ERCNETP
  3930 12001-CHECK-CID-TRN-VA.                                          ERCNETP
  3931                                                                  ERCNETP
  3932     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  3933        (CP-STATE-STD-ABBRV EQUAL 'VA') AND                       ERCNETP
  3934        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  3935        (CP-TRUNCATED-LIFE) AND
  3936        (CP-STATE-STD-ABBRV = CP-STATE)
  3937        CONTINUE                                                  ERCNETP
  3938     ELSE                                                         ERCNETP
  3939        GO TO 12001-CHECK-CID-TX
  3940     END-IF
  3941
  3942     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  3943     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3944     IF WS-WORK-DIS-RATE = ZEROS
  3945        CONTINUE
  3946     ELSE
  3947        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3948        COMPUTE WK7 = (1 / I) *
  3949              (((WK4 ** M - 1) / (WK4 - 1)) -
  3950              ((WK4 ** M * SX - VX) /
  3951              (WK4 * (1 + I) - 1))) *
  3952              (CP-PREMIUM-RATE / 1000)
  3953        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3954        COMPUTE WK8 = WK7 * 100 / ANGLEN
  3955        COMPUTE CP-CALC-PREMIUM =
  3956           WK8 *  ((WK4 * ANGLEN) / 100)
  3957     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  75
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  3958
  3959     GO TO 99999-RETURN                                           ERCNETP
  3960
  3961     .                                                            ERCNETP
  3962                                                                  ERCNETP
  3963 12001-CHECK-CID-TX.
  3964
  3965     IF (CP-COMPANY-ID EQUAL 'CID')     AND
  3966        (CP-STATE-STD-ABBRV EQUAL 'TX') AND
  3967        (CP-EARN-AS-NET-PAY) AND
  3968        (WS-WORK-DIS-RATE > ZEROS) AND
  3969        (CP-STATE-STD-ABBRV = CP-STATE)
  3970        CONTINUE
  3971     ELSE
  3972        GO TO 12001-CHECK-CID-LEV-MN-NEW
  3973     END-IF
  3974* THE FOLLOWING STMT FORCES ONE MONTH EXTRA INT PERIOD
  3975     COMPUTE K-I = 1 + (1 * I)
  3976     COMPUTE ANGLEN EQUAL WK1 / I
  3977     COMPUTE ANGLEM EQUAL WK2 / I
  3978     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  3979     IF WS-WORK-DIS-RATE = ZEROS
  3980        CONTINUE
  3981     ELSE
  3982        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  3983        COMPUTE WK7 = (K-I / I) *
  3984              (((WK4 ** M - 1) / (WK4 - 1)) -
  3985*             ((WK4 ** M * SX - VX) /
  3986              ((WK4 ** M * SX) - VX) /
  3987*             (WK4 * (1 + I) - 1))) *
  3988              (WK4 * (1 + I) - 1)) *
  3989              (CP-PREMIUM-RATE / 1000)
  3990        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  3991        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * K-I)
  3992        COMPUTE CP-CALC-PREMIUM =
  3993           WK8 *  ((WK4 * ANGLEN * K-I) / 100)
  3994     END-IF
  3995
  3996     GO TO 99999-RETURN
  3997
  3998     .
  3999 12001-CHECK-CID-LEV-MN-NEW.
  4000
  4001*    IF (CP-COMPANY-ID EQUAL 'CID')
  4002*       AND (CP-STATE-STD-ABBRV = 'MN')
  4003*       AND (CP-EARN-AS-NET-PAY)
  4004*       AND (CP-LEVEL-LIFE)
  4005*       AND (CP-CERT-EFF-DT > X'A4FF')
  4006*       CONTINUE
  4007*    ELSE
  4008*       GO TO 12001-CHECK-CID-LEV-MN
  4009*    END-IF
  4010*
  4011*    MOVE CP-CERT-EFF-DT         TO DC-BIN-DATE-1
  4012*    MOVE CP-EXPIRE-DT           TO DC-BIN-DATE-2
  4013*    MOVE '1'                    TO DC-OPTION-CODE
  4014*    PERFORM 9100-CONVERT-DATE THRU 9100-EXIT
  4015*
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  76
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4016*    IF DATE-CONVERSION-ERROR
  4017*       MOVE '2'                 TO CP-RETURN-CODE
  4018*       MOVE ZEROS               TO FACTOR
  4019*                                   CP-CALC-PREMIUM
  4020*       GO TO 99999-RETURN
  4021*    END-IF
  4022*
  4023*    COMPUTE I = CP-LOAN-APR / 100
  4024*    COMPUTE D = DC-ELAPSED-DAYS + CP-TERM-OR-EXT-DAYS
  4025*
  4026*    COMPUTE WK3 = (CP-ORIGINAL-BENEFIT - CP-ORIGINAL-PREMIUM) /
  4027*      (1 / (1 + (I * D / 360)) - CP-PREMIUM-RATE / 1000
  4028*      * 12 / 360 * D)
  4029*
  4030*    COMPUTE CP-CALC-PREMIUM = WK3 * CP-PREMIUM-RATE / 1000
  4031*       * 12 / 360 * D
  4032*
  4033*    GO TO 99999-RETURN
  4034
  4035      .
  4036 12001-CHECK-CID-LEV-MN.                                          ERCNETP
  4037                                                                  ERCNETP
  4038     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4039        (CP-STATE-STD-ABBRV EQUAL 'MN') AND                       ERCNETP
  4040        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4041        (CP-LEVEL-LIFE) AND
  4042        (CP-STATE-STD-ABBRV = CP-STATE)
  4043        CONTINUE                                                  ERCNETP
  4044     ELSE                                                         ERCNETP
  4045        GO TO 12001-CHECK-CID-LEV-CA                              ERCNETP
  4046     END-IF
  4047
  4048     COMPUTE CP-CALC-PREMIUM = (CP-ORIGINAL-BENEFIT *
  4049         (N / +12) * (CP-PREMIUM-RATE / +100)) /
  4050         (1 - (N / +12) * (CP-PREMIUM-RATE / 100))
  4051
  4052     GO TO 99999-RETURN                                           ERCNETP
  4053
  4054      .
  4055 12001-CHECK-CID-LEV-CA.                                          ERCNETP
  4056                                                                  ERCNETP
  4057     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4058        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4059        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4060        (CP-LEVEL-LIFE) AND
  4061        (CP-STATE-STD-ABBRV = CP-STATE)
  4062        CONTINUE                                                  ERCNETP
  4063     ELSE                                                         ERCNETP
  4064        GO TO 12001-CHECK-CID-TRN-CA                              ERCNETP
  4065     END-IF
  4066
  4067     COMPUTE WK4 = WS-WORK-DIS-RATE / 12
  4068     COMPUTE WK7 = (1 / (1 + WK4)) ** N
  4069     COMPUTE WK8 = (1 / (1 + WK4)) ** (N - 1)
  4070     COMPUTE ANGLEN-1 = (1 - WK8) / WK4
  4071     COMPUTE CP-CALC-PREMIUM =
  4072          (CP-ORIGINAL-BENEFIT * (1 + ANGLEN-1) *
  4073          (CP-PREMIUM-RATE / 1000)) /
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  77
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4074          (1 - ((1 + ANGLEN-1) * (CP-PREMIUM-RATE / 1000)))
  4075
  4076     GO TO 99999-RETURN                                           ERCNETP
  4077
  4078      .
  4079 12001-CHECK-CID-TRN-CA.                                          ERCNETP
  4080                                                                  ERCNETP
  4081     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4082        (CP-STATE-STD-ABBRV EQUAL 'CA') AND                       ERCNETP
  4083        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4084        (CP-TRUNCATED-LIFE) AND
  4085        (CP-STATE-STD-ABBRV = CP-STATE) AND
  4086        (WS-DISCOUNT-OPTION NOT = ' ')
  4087        CONTINUE                                                  ERCNETP
  4088     ELSE                                                         ERCNETP
  4089        GO TO 12001-CHECK-CID-TRN-MT                              ERCNETP
  4090     END-IF
  4091
  4092     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4093     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4094     IF WS-WORK-DIS-RATE = ZEROS
  4095        CONTINUE
  4096     ELSE
  4097        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4098        COMPUTE WK7 = (1 / I) *
  4099              (((WK4 ** M - 1) / (WK4 - 1)) -
  4100              ((WK4 ** M * SX - VX) /
  4101              (WK4 * (1 + I) - 1))) *
  4102              (CP-PREMIUM-RATE / 1000)
  4103        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN
  4104        COMPUTE CP-CALC-PREMIUM =
  4105           WK4 *  WK7
  4106     END-IF
  4107
  4108     GO TO 99999-RETURN                                           ERCNETP
  4109
  4110      .
  4111 12001-CHECK-CID-TRN-MT.                                          ERCNETP
  4112                                                                  ERCNETP
  4113     IF (CP-COMPANY-ID EQUAL 'CID') AND
  4114        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'VT')
  4115                   OR
  4116        ((CP-STATE-STD-ABBRV = 'IN') AND
  4117        (CP-CERT-EFF-DT > X'9A7F'))
  4118                   OR
  4119        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4120        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4121        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4122        (CP-TRUNCATED-LIFE) AND
  4123        (CP-STATE-STD-ABBRV = CP-STATE)
  4124        CONTINUE                                                  ERCNETP
  4125     ELSE                                                         ERCNETP
  4126        GO TO 12001-CHECK-CID-MT                                  ERCNETP
  4127     END-IF
  4128
  4129* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4130     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4131        MOVE 0                   TO K-I
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  78
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4132     ELSE
  4133        MOVE 2                   TO K-I
  4134     END-IF
  4135     COMPUTE CP-TERM-OR-EXT-DAYS =
  4136           CP-TERM-OR-EXT-DAYS + 30
  4137
  4138     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4139     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4140     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4141                   / (1 + I)
  4142     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4143     IF WS-WORK-DIS-RATE = ZEROS
  4144        CONTINUE
  4145     ELSE
  4146        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4147*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4148        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4149              (((WK4 ** M - 1) / (WK4 - 1)) -
  4150              ((WK4 ** M * SX - VX) /
  4151              (WK4 * (1 + I) - 1))) *
  4152              (CP-PREMIUM-RATE / 1000)
  4153        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4154*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4155        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4156        COMPUTE CP-CALC-PREMIUM =
  4157           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4158*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4159     END-IF
  4160
  4161     GO TO 99999-RETURN                                           ERCNETP
  4162
  4163     .                                                            ERCNETP
  4164 12001-CHECK-CID-MT.                                              ERCNETP
  4165                                                                  ERCNETP
  4166     IF (CP-COMPANY-ID EQUAL 'CID')     AND                       ERCNETP
  4167        ((CP-STATE-STD-ABBRV EQUAL 'MT' OR 'NJ'
  4168                                OR 'VT')
  4169                   OR
  4170        ((CP-STATE-STD-ABBRV = 'IN') AND
  4171        (CP-CERT-EFF-DT > X'9A7F'))
  4172                   OR
  4173        ((CP-STATE-STD-ABBRV = 'AZ' OR 'ND') AND
  4174        (CP-CERT-EFF-DT > X'9ADF'))) AND
  4175        (CP-EARN-AS-NET-PAY) AND                                  ERCNETP
  4176        (CP-STATE-STD-ABBRV = CP-STATE)
  4177        CONTINUE                                                  ERCNETP
  4178     ELSE                                                         ERCNETP
  4179        GO TO 12001-CHECK-DCC-DD
  4180     END-IF
  4181
  4182     COMPUTE CP-TERM-OR-EXT-DAYS =
  4183           CP-TERM-OR-EXT-DAYS + 30
  4184
  4185* K-I WILL BE USED FOR EXTRA INT. PERIODS
  4186     IF CP-STATE-STD-ABBRV = 'IN' OR 'ND'
  4187        MOVE 0                   TO K-I
  4188     ELSE
  4189        IF CP-STATE-STD-ABBRV = 'NJ'
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  79
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4190           MOVE 1                TO K-I
  4191        ELSE
  4192           MOVE 2                TO K-I
  4193        END-IF
  4194     END-IF
  4195     COMPUTE ANGLEN EQUAL WK1 / I                                 ERCNETP
  4196     COMPUTE WS-WORK-DIS-RATE = WS-WORK-DIS-RATE / +12
  4197     COMPUTE WK8 = (1 + (CP-TERM-OR-EXT-DAYS * I) / +30)
  4198                   / (1 + I)
  4199     COMPUTE ANGLEN-1 = ANGLEN / WK8
  4200     IF WS-WORK-DIS-RATE = ZEROS
  4201        CONTINUE
  4202     ELSE
  4203        COMPUTE WK4 = 1 / (1 + WS-WORK-DIS-RATE)
  4204*       COMPUTE WK7 = ((1 + (2 * I)) / I) *
  4205        COMPUTE WK7 = ((1 + (K-I * I)) / I) *
  4206              (((WK4 ** N - 1) / (WK4 - 1)) -
  4207              ((WK4 ** N - SV) /
  4208              (WK4 * (1 + I) - 1))) *
  4209              (CP-PREMIUM-RATE / 1000)
  4210        COMPUTE WK4 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4211*       COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + 2 * I))
  4212        COMPUTE WK8 = (WK7 * 100) / (ANGLEN * (1 + K-I * I))
  4213        COMPUTE CP-CALC-PREMIUM =
  4214           WK8 *  ((WK4 * ANGLEN * (1 + K-I * I)) / 100)
  4215*          WK8 *  ((WK4 * ANGLEN * (1 + 2 * I)) / 100)
  4216     END-IF
  4217
  4218     GO TO 99999-RETURN                                           ERCNETP
  4219
  4220     .                                                            ERCNETP
  4221
  4222 12001-CHECK-DCC-DD.
  4223
  4224     IF (CP-COMPANY-ID EQUAL 'DCC')
  4225        AND (CP-EARN-AS-NET-PAY)
  4226        AND (CP-BEN-CATEGORY = 'D')
  4227        CONTINUE
  4228     ELSE
  4229        GO TO 12001-CHECK-DCC-NET
  4230     END-IF
  4231
  4232     COMPUTE CP-TERM-OR-EXT-DAYS =
  4233           CP-TERM-OR-EXT-DAYS + 30
  4234
  4235     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4236     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4237     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4238                                                                  ERCNETP
  4239     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4240           / (1 + I)
  4241
  4242     COMPUTE GR     = ANGLEN / ODF
  4243*    COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE *
  4244*      CP-RATE-DEV-PCT
  4245
  4246     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4247
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  80
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4248     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4249       (CP-PREMIUM-RATE / 100) * (1 + (0 * (N-P-APR / 12)))
  4250     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4251     MOVE WK3                    TO CP-CALC-PREMIUM
  4252
  4253     GO TO 99999-RETURN                                           ERCNETP
  4254
  4255     .                                                            ERCNETP
  4256
  4257 12001-CHECK-DCC-NET.                                             ERCNETP
  4258                                                                  ERCNETP
  4259     IF (CP-COMPANY-ID EQUAL 'DCC')
  4260        AND (CP-EARN-AS-NET-PAY)
  4261        AND (CP-BENEFIT-CD (1:1) NOT = 'M' AND 'N'
  4262             AND 'H' AND 'S' AND 'P')
  4263        CONTINUE                                                  ERCNETP
  4264     ELSE                                                         ERCNETP
  4265        GO TO 12001-CHECK-DCC-PNET                                ERCNETP
  4266     END-IF
  4267
  4268     COMPUTE CP-TERM-OR-EXT-DAYS =
  4269           CP-TERM-OR-EXT-DAYS + 30
  4270
  4271     COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4272     COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4273     COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4274                                                                  ERCNETP
  4275     COMPUTE ODF = (1+ (CP-TERM-OR-EXT-DAYS * I / 30))
  4276           / (1 + I)
  4277
  4278     COMPUTE GR     = ANGLEN / ODF
  4279     COMPUTE CP-PREMIUM-RATE = CP-PREMIUM-RATE / M * 12
  4280     COMPUTE CP-CALC-PREMIUM ROUNDED = CP-PREMIUM-RATE *
  4281       CP-RATE-DEV-PCT
  4282     MOVE CP-CALC-PREMIUM        TO CP-PREMIUM-RATE
  4283*    COMPUTE WK8 = CP-PREMIUM-RATE * M / 12
  4284
  4285     COMPUTE WK8 = CP-PREMIUM-RATE *
  4286        ((M + ((CP-TERM-OR-EXT-DAYS - 30) / 30)) / 12)
  4287     COMPUTE WK8 = WK8 / ((M + (12 / 12)) / 2)
  4288     COMPUTE WK4 = CP-ORIGINAL-BENEFIT / GR
  4289     COMPUTE WK3 = WK4 * ((M - (ANGLEN - ANGLEN-M)) / I) *
  4290       (WK8 / 100) * (1 + (0 * (N-P-APR / 12)))
  4291     MOVE ZEROS                  TO CP-RATE-DEV-PCT
  4292     MOVE WK3                    TO CP-CALC-PREMIUM
  4293
  4294     GO TO 99999-RETURN                                           ERCNETP
  4295
  4296     .                                                            ERCNETP
  4297 12001-CHECK-DCC-PNET.                                            ERCNETP
  4298
  4299     IF (CP-COMPANY-ID EQUAL 'DCC')
  4300        AND (CP-EARN-AS-NET-PAY)
  4301        AND (CP-BENEFIT-CD (1:1) = 'P')
  4302        CONTINUE                                                  ERCNETP
  4303     ELSE                                                         ERCNETP
  4304        GO TO 12001-CHECK-DCC-MNET                                ERCNETP
  4305     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  81
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4306
  4307     IF CP-NO-OF-PMTS NOT NUMERIC
  4308        MOVE +0                  TO CP-NO-OF-PMTS
  4309     END-IF
  4310     IF CP-PMT-MODE NOT = 'W' AND 'S' AND 'B' AND 'T'
  4311        AND ' ' AND 'M'
  4312        MOVE ' '                 TO CP-PMT-MODE
  4313     END-IF
  4314
  4315******************************************************************
  4316***   Default is monthly, use loan term for rate and amort     ***
  4317******************************************************************
  4318     move cp-loan-term         to c-tot-pmts
  4319     MOVE +30                  TO C-DAYS-IN-PMT-PER
  4320     MOVE +12                  TO C-PMTS-PER-YEAR
  4321******************************************************************
  4322
  4323     evaluate true
  4324        when cp-pmt-mode = 'W'
  4325           MOVE +52              TO C-PMTS-PER-YEAR
  4326           compute c-tot-pmts = cp-loan-term /
  4327              12 * c-pmts-per-year
  4328           MOVE +7               TO C-DAYS-IN-PMT-PER
  4329        when cp-pmt-mode = 'B'
  4330           MOVE +26              TO C-PMTS-PER-YEAR
  4331           compute c-tot-pmts = cp-loan-term /
  4332              12 * c-pmts-per-year
  4333           MOVE +14              TO C-DAYS-IN-PMT-PER
  4334     end-evaluate
  4335
  4336     COMPUTE I = CP-LOAN-APR / C-PMTS-PER-YEAR / 100
  4337
  4338     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * I /
  4339        C-DAYS-IN-PMT-PER)) / (1 + I)
  4340
  4341     compute anglen = (1 - (1 / (1 + i)) ** c-tot-pmts) / i
  4342*    COMPUTE ANGLEN = (1 - ((1 + I) ** (C-TOT-PMTS * -1))) / I
  4343     COMPUTE ANGLEN-1 = ANGLEN / Y
  4344
  4345     COMPUTE WK3 = CP-ORIGINAL-BENEFIT / ANGLEN-1
  4346
  4347     IF CP-RATE-DEV-PCT NOT = ZEROS
  4348        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4349           CP-PREMIUM-RATE
  4350     END-IF
  4351
  4352     COMPUTE CP-CALC-PREMIUM = (WK3 / 100) * CP-PREMIUM-RATE
  4353
  4354     GO TO 99999-RETURN
  4355
  4356     .                                                            ERCNETP
  4357 12001-CHECK-DCC-MNET.                                            ERCNETP
  4358                                                                  ERCNETP
  4359     IF (CP-COMPANY-ID EQUAL 'DCC')
  4360        AND (CP-EARN-AS-NET-PAY)
  4361        AND (CP-BENEFIT-CD (1:1) = 'M' OR 'H')
  4362        CONTINUE                                                  ERCNETP
  4363     ELSE                                                         ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  82
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4364        GO TO 12001-CHECK-DCC-MNET-LF-BAL
  4365     END-IF
  4366
  4367*    COMPUTE ANGLEN EQUAL WK1 / I.                                ERCNETP
  4368*    COMPUTE ANGLEM EQUAL WK2 / I.                                ERCNETP
  4369*    COMPUTE ANGLEN-M EQUAL WK5 / I.                              ERCNETP
  4370                                                                  ERCNETP
  4371     COMPUTE WK3 = CP-ORIGINAL-BENEFIT * CP-PREMIUM-RATE / 1000
  4372     MOVE WK3                    TO CP-CALC-PREMIUM
  4373
  4374     GO TO 99999-RETURN                                           ERCNETP
  4375
  4376     .                                                            ERCNETP
  4377 12001-CHECK-DCC-MNET-LF-BAL.
  4378                                                                  ERCNETP
  4379     IF (CP-COMPANY-ID EQUAL 'DCC')
  4380        AND (CP-EARN-AS-NET-PAY)
  4381        AND (CP-BENEFIT-CD (1:1) = 'N')
  4382        AND (CP-BEN-CATEGORY NOT = 'N')
  4383        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4384        CONTINUE                                                  ERCNETP
  4385     ELSE                                                         ERCNETP
  4386        GO TO 12001-CHECK-DCC-MNET-LFSUM-BAL
  4387     END-IF
  4388
  4389     IF CP-RATE-DEV-PCT NOT = ZEROS
  4390        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4391           CP-PREMIUM-RATE
  4392     END-IF
  4393
  4394*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4395     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4396        / (1 + I)
  4397     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4398     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4399     COMPUTE WK2 = (1 + J) ** (M * -1)
  4400     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4401
  4402     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4403          ** ((M - 1) * -1))) / J)
  4404
  4405     COMPUTE ANGLEM = ((1 - ((1 + J)
  4406          ** (M * -1))) / J) / OD
  4407
  4408     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4409        (CP-ALTERNATE-BENEFIT * (1 + J) ** (M * -1)))
  4410        / ANGLEM-1
  4411
  4412     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4413          ** ((N - M) * -1))) / I)
  4414
  4415     MOVE +0                     TO WK3
  4416     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4417        (WS-COUNTER > M)
  4418        COMPUTE ANGLEM = (1 - ((1 + J)
  4419          ** ((M - WS-COUNTER) * -1))) / J
  4420        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4421        COMPUTE WK5-CSL = (RA * ANGLEM)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  83
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4422        + (CP-ALTERNATE-BENEFIT * WK2)
  4423        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4424     END-PERFORM
  4425
  4426     MOVE WK3                    TO CP-CALC-PREMIUM
  4427
  4428     GO TO 99999-RETURN                                           ERCNETP
  4429
  4430     .                                                            ERCNETP
  4431 12001-CHECK-DCC-MNET-LFSUM-BAL.
  4432                                                                  ERCNETP
  4433     IF (CP-COMPANY-ID EQUAL 'DCC')
  4434        AND (CP-EARN-AS-NET-PAY)
  4435        AND (CP-BENEFIT-CD (1:1) = 'S')
  4436        AND (CP-BEN-CATEGORY NOT = 'N')
  4437        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4438        CONTINUE                                                  ERCNETP
  4439     ELSE                                                         ERCNETP
  4440        GO TO 12001-CHECK-DCC-MNET-LF
  4441     END-IF
  4442
  4443     IF CP-RATE-DEV-PCT NOT = ZEROS
  4444        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4445           CP-PREMIUM-RATE
  4446     END-IF
  4447
  4448     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4449
  4450     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4451          ** ((M - 1) * -1))) / K)
  4452
  4453     COMPUTE ANGLEM = ((1 - ((1 + K)
  4454          ** (M * -1))) / K)
  4455
  4456     MOVE CP-MONTHLY-PAYMENT     TO RA
  4457
  4458     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4459        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K) * 0 / 1000))
  4460        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4461        CP-PREMIUM-RATE / 1000
  4462
  4463     MOVE WK3                    TO CP-CALC-PREMIUM
  4464
  4465
  4466     GO TO 99999-RETURN                                           ERCNETP
  4467
  4468     .                                                            ERCNETP
  4469 12001-CHECK-DCC-MNET-LF.
  4470                                                                  ERCNETP
  4471     IF (CP-COMPANY-ID EQUAL 'DCC')
  4472        AND (CP-EARN-AS-NET-PAY)
  4473        AND (CP-BENEFIT-CD (1:1) = 'N')
  4474        AND (CP-BEN-CATEGORY NOT = 'N')
  4475        CONTINUE                                                  ERCNETP
  4476     ELSE                                                         ERCNETP
  4477        GO TO 12001-CHECK-DCC-MNET-SUMLF
  4478     END-IF
  4479
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  84
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4480     IF CP-RATE-DEV-PCT NOT = ZEROS
  4481        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4482           CP-PREMIUM-RATE
  4483     END-IF
  4484
  4485*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4486     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4487        / (1 + I)
  4488     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4489     COMPUTE J = I + (CP-PREMIUM-RATE / +1000)
  4490     COMPUTE WK2 = (1 + J) ** (M * -1)
  4491     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4492
  4493
  4494     COMPUTE ANGLEM = ((1 - ((1 + J)
  4495          ** (M * -1))) / J) / OD
  4496     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4497
  4498     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4499          ** ((N - M) * -1))) / I)
  4500
  4501     MOVE +0                     TO WK3
  4502     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4503        (WS-COUNTER > M)
  4504        COMPUTE ANGLEM = (1 - ((1 + J)
  4505          ** ((M - WS-COUNTER + 1) * -1))) / J
  4506        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4507        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4508        COMPUTE WK3 = WK3 + (WK5-CSL * CP-PREMIUM-RATE / +1000)
  4509     END-PERFORM
  4510
  4511     MOVE WK3                    TO CP-CALC-PREMIUM
  4512
  4513     GO TO 99999-RETURN                                           ERCNETP
  4514
  4515     .                                                            ERCNETP
  4516 12001-CHECK-DCC-MNET-SUMLF.
  4517                                                                  ERCNETP
  4518     IF (CP-COMPANY-ID EQUAL 'DCC')
  4519        AND (CP-EARN-AS-NET-PAY)
  4520        AND (CP-BENEFIT-CD (1:1) = 'S')
  4521        AND (CP-BEN-CATEGORY NOT = 'N')
  4522        CONTINUE                                                  ERCNETP
  4523     ELSE                                                         ERCNETP
  4524        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-N
  4525     END-IF
  4526
  4527     IF CP-RATE-DEV-PCT NOT = ZEROS
  4528        COMPUTE CP-PREMIUM-RATE = CP-RATE-DEV-PCT *
  4529           CP-PREMIUM-RATE
  4530     END-IF
  4531
  4532     COMPUTE K = I + (CP-PREMIUM-RATE / +1000)
  4533     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4534        / (1 + K)
  4535
  4536     COMPUTE ANGLEN-M = (WK5 / I)
  4537     COMPUTE WK2 = (1 + K) ** (M * -1)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  85
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4538     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4539     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4540
  4541
  4542     COMPUTE ANGLEM = ((1 - ((1 + K)
  4543          ** (M * -1))) / K) / Y
  4544     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4545
  4546     COMPUTE WK5-CSL = (((M - ANGLEM) / K) + (ANGLEN-M *
  4547        ((1 + K) ** (M + 1 / Y * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4548        - 1)) / K) * RA
  4549     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4550        + (CP-DAYS-TO-1ST-PMT - +30)
  4551        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4552        +0 / 1000 * 12 / 12)
  4553     COMPUTE WK3 = (WK5-CSL - WK7) * (CP-PREMIUM-RATE / 1000)
  4554        * (12 / 12)
  4555
  4556
  4557     MOVE WK3                    TO CP-CALC-PREMIUM
  4558
  4559     GO TO 99999-RETURN                                           ERCNETP
  4560
  4561     .                                                            ERCNETP
  4562 12001-CHECK-DCC-MNET-TOT-BAL-N.
  4563                                                                  ERCNETP
  4564     IF (CP-COMPANY-ID EQUAL 'DCC')
  4565        AND (CP-EARN-AS-NET-PAY)
  4566        AND (CP-BENEFIT-CD (1:1) = 'N')
  4567        AND (CP-BEN-CATEGORY = 'N')
  4568        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4569        CONTINUE                                                  ERCNETP
  4570     ELSE                                                         ERCNETP
  4571        GO TO 12001-CHECK-DCC-MNET-TOT-BAL-S
  4572     END-IF
  4573
  4574*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4575     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4576        / (1 + I)
  4577     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4578     COMPUTE J = I + ((CP-DCC-LF-RATE + CP-DCC-AH-RATE) / +1000)
  4579     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4580     COMPUTE WK2 = (1 + J) ** (M * -1)
  4581     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4582
  4583     COMPUTE ANGLEM-1 = ((1 - ((1 + J)
  4584          ** ((M - 1) * -1))) / J)
  4585
  4586     COMPUTE ANGLEM = ((1 - ((1 + J)
  4587          ** (M * -1))) / J) / OD
  4588
  4589     COMPUTE RA = (CP-ORIGINAL-BENEFIT * OD -
  4590        (CP-ALTERNATE-BENEFIT * (1 + K) ** (M * -1)))
  4591        / ANGLEM-1
  4592
  4593     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4594          ** ((N - M) * -1))) / I)
  4595
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  86
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4596     MOVE +0                     TO WK3
  4597     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4598        (WS-COUNTER > M)
  4599        COMPUTE ANGLEM = (1 - ((1 + J)
  4600          ** ((M - WS-COUNTER) * -1))) / J
  4601        COMPUTE WK2 = (1 / (1 + K)) ** (M - WS-COUNTER + 1)
  4602        COMPUTE WK5-CSL = (RA * ANGLEM)
  4603        + (CP-ALTERNATE-BENEFIT * WK2)
  4604        COMPUTE WK3 = WK3 +
  4605         (WK5-CSL * (CP-DCC-LF-RATE / +1000))
  4606        COMPUTE WK3 = WK3 + (WK5-CSL - (CP-ALTERNATE-BENEFIT *
  4607          (1 / (1 + K) ** (M - WS-COUNTER + 1)))) *
  4608          (CP-DCC-AH-RATE / 1000)
  4609     END-PERFORM
  4610
  4611     MOVE WK3                    TO CP-CALC-PREMIUM
  4612
  4613     GO TO 99999-RETURN                                           ERCNETP
  4614
  4615     .                                                            ERCNETP
  4616 12001-CHECK-DCC-MNET-TOT-BAL-S.
  4617                                                                  ERCNETP
  4618     IF (CP-COMPANY-ID EQUAL 'DCC')
  4619        AND (CP-EARN-AS-NET-PAY)
  4620        AND (CP-BENEFIT-CD (1:1) = 'S')
  4621        AND (CP-BEN-CATEGORY = 'N')
  4622        AND (CP-ALTERNATE-BENEFIT NOT = ZEROS)
  4623        CONTINUE                                                  ERCNETP
  4624     ELSE                                                         ERCNETP
  4625        GO TO 12001-CHECK-DCC-MNET-TOT-N
  4626     END-IF
  4627
  4628
  4629     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4630
  4631     COMPUTE ANGLEM-1 = ((1 - ((1 + K)
  4632          ** ((M - 1) * -1))) / K)
  4633
  4634     COMPUTE ANGLEM = ((1 - ((1 + K)
  4635          ** (M * -1))) / K)
  4636
  4637     MOVE CP-MONTHLY-PAYMENT     TO RA
  4638
  4639     COMPUTE WK3 = (((((M - 1) - ANGLEM-1) / K) - ((((M - 1)
  4640        * M / 2 - (((M - 1) - ANGLEM-1) / K)) / K)
  4641        * CP-DCC-AH-RATE / 1000))
  4642        * RA + (CP-ALTERNATE-BENEFIT * ANGLEM)) *
  4643        CP-DCC-LF-RATE / 1000
  4644
  4645     MOVE WK3                    TO CP-LF-PREM
  4646
  4647     COMPUTE WK5-CSL = RA * ((M - 1) * M / 2
  4648        + (M - 1) * (CP-DAYS-TO-1ST-PMT - 30) / 30)
  4649        * CP-DCC-AH-RATE / 1000
  4650
  4651     COMPUTE WK3 = WK3 + WK5-CSL
  4652
  4653
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  87
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4654     MOVE WK3                    TO CP-CALC-PREMIUM
  4655
  4656     GO TO 99999-RETURN                                           ERCNETP
  4657
  4658      .
  4659 12001-CHECK-DCC-MNET-TOT-N.
  4660                                                                  ERCNETP
  4661     IF (CP-COMPANY-ID EQUAL 'DCC')
  4662        AND (CP-EARN-AS-NET-PAY)
  4663        AND (CP-BENEFIT-CD (1:1) = 'N')
  4664        AND (CP-BEN-CATEGORY = 'N')
  4665        CONTINUE                                                  ERCNETP
  4666     ELSE                                                         ERCNETP
  4667        GO TO 12001-CHECK-DCC-MNET-TOT-S
  4668     END-IF
  4669
  4670*    I = APR/1200
  4671*    J = APR/1200 THEN ADJUSTED FOR THE LIFE AND DIS RATE
  4672*    RA = PAYMENT AMOUNT
  4673*    WK5-CSL = THE BALANCE (PAY OFF )
  4674*    WK3 = THE ACCUMULATED PREMIUM
  4675*    WK2 = (1 + I) ^ (m * -1)
  4676*    OD  = GAMMA
  4677*
  4678*    COMPUTE OD = (1 + ((CP-TERM-OR-EXT-DAYS + +30) * I / 30))
  4679     COMPUTE OD = (1 + (CP-DAYS-TO-1ST-PMT * I / 30))
  4680        / (1 + I)
  4681     COMPUTE ANGLEN-M = (WK5 / I) / OD
  4682     COMPUTE J = I + (CP-DCC-LF-RATE / +1000) +
  4683        (CP-DCC-AH-RATE / +1000)
  4684     COMPUTE WK2 = (1 + J) ** (M * -1)
  4685     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4686
  4687
  4688     COMPUTE ANGLEM = ((1 - ((1 + J)
  4689          ** (M * -1))) / J) / OD
  4690     COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4691
  4692     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4693          ** ((N - M) * -1))) / I)
  4694
  4695     MOVE +0                     TO WK3
  4696     PERFORM VARYING WS-COUNTER FROM +1 BY +1 UNTIL
  4697        (WS-COUNTER > M)
  4698        COMPUTE ANGLEM = (1 - ((1 + J)
  4699          ** ((M - WS-COUNTER + 1) * -1))) / J
  4700        COMPUTE WK2 = (1 / (1 + j)) ** (M - WS-COUNTER + 1)
  4701        COMPUTE WK5-CSL = RA * (ANGLEM + (ANGLEN-M * WK2))
  4702        COMPUTE WK3 = WK3 + (WK5-CSL * CP-DCC-LF-RATE / +1000)
  4703           + (WK5-CSL * CP-DCC-AH-RATE / +1000)
  4704     END-PERFORM
  4705
  4706     MOVE WK3                    TO CP-CALC-PREMIUM
  4707
  4708     GO TO 99999-RETURN                                           ERCNETP
  4709
  4710     .                                                            ERCNETP
  4711 12001-CHECK-DCC-MNET-TOT-S.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  88
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4712                                                                  ERCNETP
  4713     IF (CP-COMPANY-ID EQUAL 'DCC')
  4714        AND (CP-EARN-AS-NET-PAY)
  4715        AND (CP-BENEFIT-CD (1:1) = 'S')
  4716        AND (CP-BEN-CATEGORY = 'N')
  4717        CONTINUE                                                  ERCNETP
  4718     ELSE                                                         ERCNETP
  4719        GO TO 12001-CONTINUE-NET
  4720     END-IF
  4721
  4722*    I = APR/1200
  4723*    J = APR/1200 THEN ADJUSTED FOR THE LIFE RATE (K)
  4724*    RA = PAYMENT AMOUNT
  4725*    WK5-CSL = THE BALANCE (PAY OFF )
  4726*    WK3 = THE ACCUMULATED PREMIUM
  4727*    WK2 = (1 + I) ^ (m * -1)
  4728*    OD  = GAMMA
  4729*
  4730     COMPUTE J = I + (CP-DCC-LF-RATE / +1000)
  4731
  4732     COMPUTE OD = ((1 + (CP-DAYS-TO-1ST-PMT * J / 30)))
  4733        / (1 + J)
  4734
  4735     COMPUTE ANGLEM = ((1 - ((1 + J)
  4736          ** (M * -1))) / J) / OD
  4737
  4738     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4739          ** ((N - M) * -1))) / I)
  4740          * (1 + J) ** (-1 * M)
  4741
  4742     COMPUTE ANGLEN-M = ANGLEN-M / OD
  4743
  4744     MOVE CP-MONTHLY-PAYMENT     TO RA
  4745
  4746     COMPUTE WK1 = (M + 1 / OD * (CP-DAYS-TO-1ST-PMT - +30)
  4747        / +30)
  4748     COMPUTE WK4 = (((M - ANGLEM) / J) + (ANGLEN-M * ((1 + J)
  4749        ** (WK1) - 1)) / J) * RA
  4750
  4751     COMPUTE WK5 = (((((M * (M + 1) / 2)
  4752        + (CP-DAYS-TO-1ST-PMT - +30)
  4753        / +30 * M - (M - ANGLEM) / J) / J)) * RA *
  4754        CP-DCC-AH-RATE / +1000 * 12 / 12)
  4755
  4756     COMPUTE WK3 = (WK4 - WK5) * (CP-DCC-LF-RATE / +1000) *
  4757        (12 / 12)
  4758
  4759     COMPUTE WK5-CSL = RA * (M * (M + 1) / 2 + M *
  4760        (CP-DAYS-TO-1ST-PMT - +30) / +30) *
  4761        (CP-DCC-AH-RATE / +1000) * 12 / 12
  4762
  4763     COMPUTE WK3 = WK3 + WK5-CSL
  4764     MOVE WK3                    TO CP-CALC-PREMIUM
  4765
  4766     COMPUTE K = I + (CP-DCC-LF-RATE / +1000)
  4767     COMPUTE Y = (1 + (CP-DAYS-TO-1ST-PMT * K / 30))
  4768        / (1 + K)
  4769
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  89
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4770     COMPUTE ANGLEN-M = ((1 - ((1 + I)
  4771          ** ((N - M) * -1))) / I)
  4772     COMPUTE WK2 = (1 + K) ** (M * -1)
  4773     COMPUTE ANGLEN-M = ANGLEN-M * WK2
  4774     COMPUTE ANGLEN-M = ANGLEN-M / Y
  4775
  4776
  4777     COMPUTE ANGLEM = ((1 - ((1 + K)
  4778          ** (M * -1))) / K) / Y
  4779
  4780*    COMPUTE RA = CP-ORIGINAL-BENEFIT / (ANGLEM + ANGLEN-M)
  4781
  4782     COMPUTE WK6 = (((M - ANGLEM) / K) + (ANGLEN-M *
  4783        ((1 + K) ** (M + 1 / Y
  4784        * (CP-DAYS-TO-1ST-PMT - +30) / 30)
  4785        - 1)) / K) * RA
  4786     COMPUTE WK7 = (((((M * (M + 1) / 2)
  4787        + (CP-DAYS-TO-1ST-PMT - +30)
  4788        / 30 * M - (M - ANGLEM) / K) / K)) * RA *
  4789        CP-DCC-AH-RATE / 1000 * 12 / 12)
  4790     COMPUTE WK3 = (WK6 - WK7) * (CP-DCC-LF-RATE / 1000)
  4791        * (12 / 12)
  4792
  4793
  4794     MOVE WK3                    TO CP-LF-PREM
  4795
  4796
  4797
  4798     GO TO 99999-RETURN                                           ERCNETP
  4799
  4800     .                                                            ERCNETP
  4801 12001-CONTINUE-NET.                                              ERCNETP
  4802                                                                  ERCNETP
  4803     IF NET-STD                                                   ERCNETP
  4804        IF CP-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'CID' OR 'MON'   ERCNETP
  4805*          OR 'DCC'
  4806         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N
  4807         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)
  4808         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)
  4809         COMPUTE WK3 ROUNDED = (WK3 * RA * K-I)
  4810                               * ((1 + N) / (1 + M))
  4811         if (i = .0000000001)
  4812            and (wk3 = zeros)
  4813            move 1               to wk3
  4814         end-if
  4815        ELSE                                                      ERCNETP
  4816         COMPUTE WK3 ROUNDED = ((I * M) + VX - SX) * 2 * N        ERCNETP
  4817         COMPUTE WK3 ROUNDED = WK3 / ((1 - VX) * M * I)           ERCNETP
  4818         COMPUTE WK3 ROUNDED = WK3 / ((2 * N) - M + 1)            ERCNETP
  4819         COMPUTE WK3 ROUNDED = WK3 * RA * K-I.                    ERCNETP
  4820                                                                  ERCNETP
  4821     IF NET-SMP                                                   ERCNETP
  4822         COMPUTE N2 = N * N                                       ERCNETP
  4823         COMPUTE N3 = N2 * N                                      ERCNETP
  4824         COMPUTE WK3 ROUNDED = 2 * N2 * WK1                       ERCNETP
  4825         COMPUTE WK3 ROUNDED = WK3 + (N3 * I) - (N2 * I)          ERCNETP
  4826         COMPUTE WK3 ROUNDED = WK3 + (4 * N * WK1)                ERCNETP
  4827         COMPUTE WK3 ROUNDED = WK3 * (1 + I) * 10                 ERCNETP
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:19 Page  90
* ELRFNDXP.cbl (/apps/prod/cid1p/copy/ERCNETP)
  4828         COMPUTE WK3 ROUNDED = WK3 / (36 * (N + 1) * WK1).        ERCNETP
  4829                                                                  ERCNETP
  4830     IF NPO-PRUDENTIAL                                            ERCNETP
  4831       PERFORM 12100-PRU-CALC THRU 12199-EXIT                     ERCNETP
  4832           VARYING WS-COUNTER FROM 1 BY 1                         ERCNETP
  4833               UNTIL WS-COUNTER = N                               ERCNETP
  4834       COMPUTE WK3 ROUNDED = (N * (I * PWK / (PWK - 1))) - 1      ERCNETP
  4835       COMPUTE WK3 ROUNDED = WK3 / (I * 12).                      ERCNETP
  4836                                                                  ERCNETP
  4837     MOVE WK3 TO FACTOR.                                          ERCNETP
  4838
  4839                                                                  ERCNETP
  4840     GO TO 99999-RETURN.                                          ERCNETP
  4841                                                                  ERCNETP
  4842 12100-PRU-CALC.                                                  ERCNETP
  4843     IF WS-COUNTER = 1                                            ERCNETP
  4844         COMPUTE PWK = (I + 1)                                    ERCNETP
  4845     ELSE                                                         ERCNETP
  4846         COMPUTE PWK = PWK * (I + 1).                             ERCNETP
  4847                                                                  ERCNETP
  4848 12199-EXIT.                                                      ERCNETP
  4849      EXIT.                                                       ERCNETP
  4850                                                                  ERCNETP
  4851 99000-ERROR.                                                     ERCNETP
  4852     MOVE +9999.999999999 TO N-P-FACTOR.                          ERCNETP
  4853     MOVE '4'             TO CP-RETURN-CODE.                      ERCNETP
  4854                                                                  ERCNETP
  4855     GO TO 99999-EXIT.                                            ERCNETP
  4856                                                                  ERCNETP
  4857 99999-RETURN.                                                    ERCNETP
  4858     MOVE FACTOR          TO N-P-FACTOR.                          ERCNETP
  4859                                                                  ERCNETP
  4860 99999-EXIT.                                                      ERCNETP
  4861      EXIT.                                                       ERCNETP
  4862
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1700     Code:       41275
