* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS151.cbl
* Options: int("ECS151.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS151.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS151.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS151.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.                                         09/28/98
     2                                                                  ECS151
     3 PROGRAM-ID.                 ECS151.                                 LV009
     4*              PROGRAM CONVERTED BY                                  CL**1
     5*              COBOL CONVERSION AID PO 5785-ABJ                      CL**1
     6*              CONVERSION DATE 10/17/97 08:53:48.                    CL**1
     7*                            VMOD=2.007                              CL**1
     8*                                                                    CL**1
     9*AUTHOR.     LOGIC, INC.                                             CL**1
    10*            DALLAS, TEXAS                                           CL**1
    11                                                                     CL**1
    12*DATE-COMPILED.                                                      CL**1
    13*SECURITY.   *****************************************************   CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS151.cbl
    14*            *                                                   *   CL**1
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *   CL**1
    16*            *                                                   *   CL**1
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *   CL**1
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *   CL**1
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *   CL**1
    20*            *                                                   *   CL**1
    21*            *****************************************************   CL**1
    22                                                                     CL**1
    23*REMARKS.  PRINT POLICY EXHIBIT.                                     CL**1
    24*          OPTION '1' WILL PRINT ALL TOTALS.                         CL**1
    25*          OPTION '2' WILL PRINT ALL TOTALS EXCEPT ACCOUNT.          CL**1
    26*          OPTION '3' WILL PRINT ALL STATE TOTALS ONLY.              CL**1
    27*          OPTION '4' WILL PRINT ALL TOTALS - GROSS ONLY.            CL**1
    28*          OPTION '5' WILL SKIP ACCNT TOTS - PRINT GROSS ONLY.       CL**1
    29*          OPTION '6' WILL PRINT STATE TOTS -  GROSS ONLY.           CL**1
    30*          OPTION '7' WILL PRINT ALL TOTALS - REINS ONLY.            CL**1
    31*          OPTION '8' WILL SKIP ACCNT TOTS - PRINT REINS ONLY.       CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS151.cbl
    33 ENVIRONMENT DIVISION.                                               CL**1
    34 CONFIGURATION SECTION.                                              CL**1
    35 SPECIAL-NAMES.                                                      CL**1
    36     C02 IS LCP-CH2                                                  CL**1
    37     C03 IS LCP-CH3                                                  CL**1
    38     C04 IS LCP-CH4                                                  CL**1
    39     C05 IS LCP-CH5                                                  CL**1
    40     C06 IS LCP-CH6                                                  CL**1
    41     C07 IS LCP-CH7                                                  CL**1
    42     C08 IS LCP-CH8                                                  CL**1
    43     C09 IS LCP-CH9                                                  CL**1
    44     C10 IS LCP-CH10                                                 CL**1
    45     C11 IS LCP-CH11                                                 CL**1
    46     C12 IS LCP-CH12                                                 CL**1
    47     S01 IS LCP-P01                                                  CL**1
    48     S02 IS LCP-P02.                                                 CL**1
    49 INPUT-OUTPUT SECTION.                                               CL**1
    50 FILE-CONTROL.                                                       CL**1
    51     SELECT EXTR-IN      ASSIGN TO SYS010-UT-2400-S-SYS010.          CL**1
    52     SELECT DISK-DATE    ASSIGN TO SYS019-UT-FBA1-S-SYS019.          CL**1
    53     SELECT PRT-FILE     ASSIGN TO SYS008-UR-1403-S-SYS008.          CL**1
    54     SELECT FICH         ASSIGN TO SYS020-UT-2400-S-SYS020.          CL**1
    55     SELECT SORT-FILE    ASSIGN TO SYS001-UT-FBA1-S-SORTWK1.         CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS151.cbl
    57 DATA DIVISION.                                                      CL**1
    58 FILE SECTION.                                                       CL**1
    59 FD  EXTR-IN                                                         CL**1
    60     BLOCK CONTAINS 0 RECORDS
    61     RECORDING MODE F.                                               CL**1
    62                                                                     CL**1
    63 01  EXTR-RECORD.                                                    CL**1
    64     03  EXTR-KEY.                                                   CL**1
    65         05  EX-REINS-CO         PIC X(06).                          CL**1
    66         05  EX-CARRIER          PIC X(01).                          CL**1
    67         05  EX-COMPANY          PIC X(06).                          CL**1
    68         05  EX-STATE            PIC X(02).                          CL**1
    69         05  EX-ACCOUNT          PIC X(10).                          CL**1
    70         05  EX-ST-SEQ           PIC X(02).                          CL**1
    71         05  EX-REC-TYPE         PIC 99.                             CL**1
    72         05  EX-PERIOD-START     PIC 9(11)   COMP-3.                 CL**2
    73         05  EX-PERIOD-END       PIC 9(11)   COMP-3.                 CL**2
    74     03  EXTR-RECORD-BODY        PIC X(2660).                        CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS151.cbl
    76 FD  DISK-DATE                                                       CL**1
*   77                             COPY ELCDTEFD.                          CL**1
    78******************************************************************04/15/98
    79*                                                                *ELCDTEFD
    80*                                                                *ELCDTEFD
    81*                            ELCDTEFD.                           *   LV002
    82*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    83*                            VMOD=2.007                          *   CL**2
    84*                                                                *ELCDTEFD
    85******************************************************************ELCDTEFD
    86     BLOCK CONTAINS 0 RECORDS
    87     RECORDING MODE F.                                            ELCDTEFD
    88                                                                  ELCDTEFD
    89 01  DATE-DISK.                                                   ELCDTEFD
    90     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    91     12  FILLER                      PIC  X(14).                  ELCDTEFD
    92     12  DD-CR1                      PIC  9.                      ELCDTEFD
    93     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    94     12  DD-CR2                      PIC  9.                      ELCDTEFD
    95     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    96     12  FILLER                      PIC  X(20).                  ELCDTEFD
    97                                                                  ELCDTEFD
    98 01  DATE-DISK-R.                                                 ELCDTEFD
    99     12  FILLER                      PIC  X(4).                   ELCDTEFD
   100     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   101                                     PIC  X(32).                  ELCDTEFD
   102                                                                  ELCDTEFD
   103 01  DATE-DISK-T.                                                 ELCDTEFD
   104     12  FILLER                      PIC  X(4).                   ELCDTEFD
   105     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   106                                     PIC  X(48).                  ELCDTEFD
   107                                                                  ELCDTEFD
   108 01  DATE-DISK-M.                                                 ELCDTEFD
   109     12  FILLER                      PIC  X(4).                   ELCDTEFD
   110     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   111                                     PIC  X(48).                  ELCDTEFD
   112                                                                  ELCDTEFD
   113 01  DATE-DISK-P.                                                 ELCDTEFD
   114     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   115     12  DD-IDX                      PIC  99.                     ELCDTEFD
   116     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   117     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   118         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   119                                     PIC  X.                      ELCDTEFD
   120         16  FILLER                  PIC  X(46).                  ELCDTEFD
   121     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   122         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   123             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   124             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   125             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   126             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   127         16  FILLER                  PIC  X(16).                  ELCDTEFD
   128                                                                  ELCDTEFD
   129 01  DATE-DISK-E.                                                 ELCDTEFD
   130     12  FILLER                      PIC  X(4).                   ELCDTEFD
   131     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   132                                     PIC  X(4).                   ELCDTEFD
   133                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   134 01  DATE-DISK-C.                                                 ELCDTEFD
   135     12  FILLER                      PIC  X(7).                   ELCDTEFD
   136     12  DD-CARR1-SECPAY-SW          PIC  X.
   137     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   138     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   139     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   140     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   141     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   142     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   143     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   144     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   145     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   146     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   147     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   148     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   149     12  DD-CARR2-SECPAY-SW          PIC  X.
   150     12  FILLER                      PIC  X(7).                   ELCDTEFD
   151                                                                  ELCDTEFD
   152 01  DATE-DISK-OPT.                                               ELCDTEFD
   153     12  FILLER                      PIC  X(04).                  ELCDTEFD
   154     12  DD-TLR-DATA.                                             ELCDTEFD
   155         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   156                                     PIC  X(03).                  ELCDTEFD
   157     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   158         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   159                                     PIC  X(06).                  ELCDTEFD
   160     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   161         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   162                                     PIC  X(07).                  ELCDTEFD
   163         16  FILLER                  PIC  X(05).                  ELCDTEFD
   164     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   165                                     PIC  X(96).                  ELCDTEFD
   166******************************************************************ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS151.cbl
   168 FD  PRT-FILE                                                        CL**1
*  169                             COPY ELCPRTFD.                          CL**1
   170******************************************************************04/15/98
   171*                                                                *ELCPRTFD
   172*                                                                *ELCPRTFD
   173*                            ELCPRTFD.                           *   LV003
   174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   175*                            VMOD=2.006                          *ELCPRTFD
   176******************************************************************ELCPRTFD
   177     RECORDING MODE F                                             ELCPRTFD
   178     LABEL RECORDS OMITTED                                        ELCPRTFD
   179     BLOCK CONTAINS 0 RECORDS
   180     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
   181 01  PRT.                                                         ELCPRTFD
   182     12  P-CTL               PIC  X.                                 CL**2
   183     12  P-DATA              PIC  X(132).                         ELCPRTFD
   184******************************************************************ELCPRTFD
   185                                                                     CL**1
   186 FD  FICH                                                            CL**1
*  187                             COPY ELCFCHFD.                          CL**1
   188******************************************************************04/15/98
   189*                                                                *ELCFCHFD
   190*                            ELCFCHFD.                           *   LV003
   191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   192*                            VMOD=2.004                          *   CL**3
   193*                                                                *ELCFCHFD
   194******************************************************************ELCFCHFD
   195     BLOCK CONTAINS 0 RECORDS
   196     RECORDING MODE F.                                            ELCFCHFD
   197                                                                  ELCFCHFD
   198 01  FICH-REC                            PIC   X(133).            ELCFCHFD
   199******************************************************************ELCFCHFD
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS151.cbl
   201 SD  SORT-FILE.                                                      CL**1
   202                                                                     CL**1
   203 01  SORT-REC.                                                       CL**1
   204     03  SORT-KEY.                                                   CL**1
   205         05  SR-REINS-CO         PIC X(06).                          CL**1
   206         05  SR-STATE-SEQ        PIC X(02).                          CL**1
   207         05  SR-CARRIER          PIC X(01).                          CL**1
   208         05  SR-COMPANY          PIC X(06).                          CL**1
   209         05  SR-STATE            PIC X(02).                          CL**1
   210         05  SR-ACCOUNT          PIC X(10).                          CL**1
   211         05  SR-ST-SEQ           PIC X(02).                          CL**1
   212         05  SR-REC-TYPE         PIC 99.                             CL**1
   213         05  SR-PERIOD-START     PIC 9(11)   COMP-3.                 CL**2
   214         05  SR-PERIOD-END       PIC 9(11)   COMP-3.                 CL**2
   215     03  SORT-RECORD-BODY        PIC X(2660).                        CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS151.cbl
   217 WORKING-STORAGE SECTION.                                            CL**1
   218 77  FILLER  PIC X(32) VALUE '********************************'.     CL**1
   219 77  FILLER  PIC X(32) VALUE '     ECS151 WORKING STORAGE     '.     CL**1
   220 77  FILLER  PIC X(32) VALUE '**** VMOD=2.007 ****************'.     CL**1
   221                                                                     CL**1
   222 77  LCP-ASA                     PIC X.                              CL**1
   223 77  EOJ-SW                      PIC X VALUE 'N'.                    CL**1
   224 77  PAGE-CNT                    PIC 9(5) VALUE ZERO.                CL**1
   225 77  FIRST-READ                  PIC X VALUE 'Y'.                    CL**1
   226 77  STATE-INDEX                 PIC XX VALUE SPACES.                CL**1
   227 77  DO-PRINT                    PIC X VALUE SPACE.                  CL**1
   228 77  PRINT-SW                    PIC X VALUE SPACE.                  CL**1
   229                                                                     CL**1
   230 01  WS-ABEND-AREAS.                                                 CL**1
   231     05  WS-ZERO                 PIC S9     VALUE +0 COMP-3.         CL**1
   232     05  WS-RETURN-CODE          PIC S9(4)  VALUE +0 COMP-3.         CL**1
   233     05  WS-ABEND-MESSAGE        PIC X(8)   VALUE SPACES.            CL**1
   234     05  WS-ABEND-FILE-STATUS    PIC XX     VALUE ZERO.              CL**1
   235                                                                     CL**1
   236 01  WS-REPORT-TITLE             PIC X(10)  VALUE SPACES.
   237 01  WS.                                                             CL**1
   238     03  ABEND-CODE              PIC X(4)    VALUE ZERO.             CL**1
   239     03  ABEND-OPTION            PIC X       VALUE 'Y'.              CL**1
   240     03  PGM-SUB                 PIC S9(3)   VALUE +151 COMP.        CL**1
   241                                                                     CL**1
   242 01  WS-WORK-DATE                PIC 9(11).                          CL**2
   243 01  WS-WORK-DATE-R  REDEFINES  WS-WORK-DATE.                        CL**2
   244     03  FILLER                  PIC 999.                            CL**2
   245     03  WS-CCYY                 PIC 9(4).                           CL**2
   246     03  WS-CCYR  REDEFINES  WS-CCYY.                                CL**2
   247         05  WS-CENT             PIC 99.                             CL**2
   248         05  WS-YEAR             PIC 99.                             CL**2
   249     03  WS-MONTH                PIC 99.                             CL**2
   250     03  WS-DAY                  PIC X9.                             CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS151.cbl
   252 01  HD-1.                                                           CL**1
   253     03  FILLER                  PIC X(12) VALUE '1TOTALS FOR '.     CL**1
   254     03  HD-1-MSG                PIC X(21) VALUE SPACES.             CL**1
   255     03  HD-1-MSGA               PIC X(17) VALUE SPACES.
   256*    03  FILLER                  PIC X(17) VALUE SPACES.             CL**1
   257     03  HD-1-COMP               PIC X(30) VALUE SPACES.             CL**1
   258     03  FILLER                  PIC X(45) VALUE SPACES.             CL**1
   259     03  FILLER                  PIC X(8)  VALUE 'ECS-151'.          CL**1
   260                                                                     CL**1
   261 01  HD-2.                                                           CL**1
   262     03  FILLER                  PIC X(12) VALUE '   CARRIER  '.     CL**1
   263     03  HD-2-CARRIER            PIC X     VALUE SPACE.              CL**1
   264     03  FILLER                  PIC X(38) VALUE SPACES.             CL**1
   265     03  HD-2-REIN.                                                  CL**1
   266         05  HD-2-REIN-MSG       PIC X(26) VALUE SPACES.             CL**1
   267         05  HD-2-REIN-COMP      PIC X(4)  VALUE SPACES.             CL**1
   268     03  HD-2-AREA.                                                  CL**1
   269         05  FILLER              PIC X(44).                          CL**1
   270         05  HD-2-IPL            PIC X(8).                           CL**1
   271     03  HD-2-AREA-RDF REDEFINES HD-2-AREA.                          CL**1
   272         05  FILLER              PIC X(37).                          CL**1
   273         05  HD-2-PAGE-LIT       PIC X(5).                           CL**1
   274         05  HD-2-PAGE           PIC ZZ,ZZZ.                         CL**1
   275         05  FILLER              PIC X(4).                           CL**1
   276                                                                     CL**1
   277 01  HD-3.                                                           CL**1
   278     03  FILLER                  PIC X(12) VALUE '  GROUPING  '.     CL**1
   279     03  HD-3-COMPANY            PIC X(6)  VALUE SPACES.             CL**1
   280     03  FILLER                  PIC X(25) VALUE SPACES.             CL**1
   281     03  HD-3-TITLE              PIC X(26) VALUE SPACES.             CL**1
   282     03  HD-3-MSG                PIC X(20) VALUE SPACES.             CL**1
   283     03  FILLER                  PIC X(44) VALUE SPACES.             CL**1
   284                                                                     CL**1
   285 01  HD-4.                                                           CL**1
   286     03  FILLER                  PIC X(12) VALUE '   STATE    '.     CL**1
   287     03  HD-4-STATE              PIC X(20) VALUE SPACES.             CL**1
   288     03  FILLER                  PIC X(49) VALUE SPACES.             CL**1
   289     03  HD-4-AREA.                                                  CL**1
   290         05  FILLER                  PIC X(37).                      CL**1
   291         05  HD-4-PAGE-LIT           PIC X(5).                       CL**1
   292         05  HD-4-PAGE               PIC ZZ,ZZZ.                     CL**1
   293         05  FILLER                  PIC X(4).                       CL**1
   294     03  HD-4-AREA-RDF REDEFINES HD-4-AREA.                          CL**1
   295         05  FILLER                  PIC X(44).                      CL**1
   296         05  HD-4-IPL                PIC X(8).                       CL**1
   297                                                                     CL**1
   298 01  HD-5.                                                           CL**1
   299     03  FILLER                  PIC X(12) VALUE '   ACCOUNT  '.     CL**1
   300     03  HD-5-ACCOUNT            PIC X(10) VALUE SPACES.             CL**1
   301     03  FILLER                  PIC X(26) VALUE SPACES.             CL**1
   302     03  FILLER                  PIC X(22)                           CL**1
   303         VALUE 'FOR PERIOD STARTING - '.                             CL**1
   304     03  HD-5-MONTH              PIC X(10).                          CL**1
   305     03  HD-5-DAY                PIC X(2).                           CL**1
   306     03  FILLER                  PIC X(2) VALUE ', '.                CL**9
   307     03  HD-5-CENT               PIC X(2).                           CL**9
   308     03  HD-5-YEAR               PIC X(2).                           CL**1
   309     03  FILLER                  PIC X(45) VALUE SPACES.             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS151.cbl
   310                                                                     CL**1
   311 01  HD-6.                                                           CL**1
   312     03  FILLER                  PIC X(3)  VALUE SPACES.             CL**1
   313     03  HD-6-MSG                PIC X(53) VALUE SPACES.             CL**1
   314     03  FILLER                  PIC X(10)                           CL**1
   315         VALUE 'ENDING  - '.                                         CL**1
   316     03  HD-6-MONTH              PIC X(10).                          CL**1
   317     03  HD-6-DAY                PIC X(2).                           CL**1
   318     03  FILLER                  PIC X(2) VALUE ', '.                CL**9
   319     03  HD-6-CENT               PIC X(2).                           CL**9
   320     03  HD-6-YEAR               PIC X(2).                           CL**1
   321     03  FILLER                  PIC X(49) VALUE SPACES.             CL**1
   322                                                                     CL**1
   323 01  HD-7.                                                           CL**1
   324     03  FILLER                  PIC X(41) VALUE '0'.                CL**1
   325     03  FILLER                  PIC X(43)                           CL**1
   326         VALUE '*****  G R O U P   C E R T I F I C A T E S '.        CL**1
   327     03  FILLER                  PIC X(6)                            CL**1
   328         VALUE ' *****'.                                             CL**1
   329     03  FILLER                  PIC X(43) VALUE SPACES.             CL**1
   330                                                                     CL**1
   331 01  HD-8.                                                           CL**1
   332     03  FILLER                  PIC X(41) VALUE '0'.                CL**1
   333     03  FILLER                  PIC X(44)                           CL**1
   334         VALUE '*****  I N D I V I D U A L   P O L I C I E S'.       CL**1
   335     03  FILLER                  PIC X(7) VALUE '  *****'.           CL**1
   336     03  FILLER                  PIC X(41) VALUE SPACES.             CL**1
   337                                                                     CL**1
   338 01  HD-9.                                                           CL**1
   339     03  FILLER                  PIC X(50) VALUE SPACES.             CL**1
   340     03  HD-9-MSG                PIC X(32) VALUE SPACES.             CL**1
   341     03  FILLER                  PIC X(51) VALUE SPACES.             CL**1
   342                                                                     CL**1
   343 01  HD-MESSAGES.                                                    CL**1
   344     03  HD-MSG1                 PIC X(20)                           CL**1
   345         VALUE 'COMPLETE BUSINESS - '.                               CL**1
   346     03  HD-MSG2                 PIC X(20)                           CL**1
   347         VALUE 'REINSURED BUSINESS -'.                               CL**1
   348     03  HD-MSG3                 PIC X(26)                           CL**1
   349         VALUE 'FOR REINSURANCE COMPANY - '.                         CL**1
   350     03  HD-MSG4                 PIC X(26)                           CL**1
   351         VALUE '- CERTIFICATE ACTIVITY ON '.                         CL**1
   352     03  HD-MSG5                 PIC X(26)                           CL**1
   353         VALUE ' - CERTIFICATE EXHIBIT ON '.                         CL**1
   354     03  HD-MSG6.                                                    CL**1
   355         05  FILLER              PIC X(21)                           CL**1
   356             VALUE 'REINSURANCE COMPANY  '.                          CL**1
   357         05  HD-MSG6-REIN        PIC X(4).                           CL**1
   358     03  HD-MSG7                 PIC X(34)                           CL**1
   359         VALUE '**********************************'.                 CL**1
   360                                                                     CL**1
   361 01  HD-10.                                                          CL**1
   362     03  FILLER                  PIC X(26)                           CL**1
   363         VALUE '0 BENEFIT TYPE'.                                     CL**1
   364     03  FILLER                  PIC X(37)                           CL**1
   365         VALUE 'I S S U E D'.                                        CL**1
   366     03  FILLER                  PIC X(36)                           CL**1
   367         VALUE 'C A N C E L L E D'.                                  CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS151.cbl
   368     03  FILLER                  PIC X(23)                           CL**1
   369         VALUE 'C L A I M S'.                                        CL**1
   370     03  FILLER                  PIC X(11)                           CL**1
   371         VALUE 'E A R N E D'.                                        CL**1
   372                                                                     CL**1
   373 01  HD-11.                                                          CL**1
   374     03  FILLER                  PIC X(17)                           CL**1
   375         VALUE ' **************'.                                    CL**1
   376     03  FILLER                  PIC X(40)                           CL**1
   377         VALUE '************************************'.               CL**1
   378     03  FILLER                  PIC X(39)                           CL**1
   379         VALUE '************************************'.               CL**1
   380     03  FILLER                  PIC X(24)                           CL**1
   381         VALUE '*********************'.                              CL**1
   382     03  FILLER                  PIC X(13)                           CL**1
   383         VALUE '*************'.                                      CL**1
   384                                                                     CL**1
   385 01  HD-12.                                                          CL**1
   386     03  FILLER                  PIC X(17) VALUE SPACES.             CL**1
   387     03  FILLER                  PIC X(8) VALUE '-COUNT-'.           CL**1
   388     03  FILLER                  PIC X(16)                           CL**1
   389         VALUE '----AMOUNT----'.                                     CL**1
   390     03  FILLER                  PIC X(12)                           CL**1
   391         VALUE '--PREMIUM---'.                                       CL**1
   392     03  FILLER                  PIC X(4) VALUE SPACES.              CL**1
   393     03  FILLER                  PIC X(8) VALUE '-COUNT-'.           CL**1
   394     03  FILLER                  PIC X(16)                           CL**1
   395         VALUE '----AMOUNT----'.                                     CL**1
   396     03  FILLER                  PIC X(12)                           CL**1
   397         VALUE '--PREMIUM---'.                                       CL**1
   398     03  FILLER                  PIC X(3) VALUE SPACES.              CL**1
   399     03  FILLER                  PIC X(8) VALUE '-COUNT-'.           CL**1
   400     03  FILLER                  PIC X(16)                           CL**1
   401         VALUE '---AMOUNT----'.                                      CL**1
   402     03  FILLER                  PIC X(13)                           CL**1
   403         VALUE '----AMOUNT---'.                                      CL**1
   404                                                                     CL**1
   405 01  HD-13.                                                          CL**1
   406     03  FILLER                  PIC X(7) VALUE '-'.                 CL**1
   407     03  FILLER                  PIC X(33)                           CL**1
   408         VALUE '**** E X H I B I T   I T E M ****'.                  CL**1
   409     03  FILLER                  PIC X(10) VALUE SPACES.             CL**1
   410     03  FILLER                  PIC X(30)                           CL**1
   411         VALUE '***** GROUP CERTIFICATES *****'.                     CL**1
   412     03  FILLER                  PIC X(10) VALUE SPACES.             CL**1
   413     03  FILLER                  PIC X(31)                           CL**1
   414         VALUE '***** INDIVIDUAL POLICIES *****'.                    CL**1
   415     03  FILLER                  PIC X(12) VALUE SPACES.             CL**1
   416                                                                     CL**1
   417 01  HD-14.                                                          CL**1
   418     03  FILLER                  PIC X(50) VALUE SPACES.             CL**1
   419     03  FILLER                  PIC X(16) VALUE '-COUNT-'.          CL**1
   420     03  FILLER                  PIC X(24) VALUE '----AMOUNT----'.   CL**1
   421     03  FILLER                  PIC X(17) VALUE '-COUNT-'.          CL**1
   422     03  FILLER                  PIC X(26) VALUE '----AMOUNT----'.   CL**1
   423                                                                     CL**1
   424 01  HD-15.                                                          CL**1
   425     03  FILLER                  PIC X(41) VALUE '-'.                CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS151.cbl
   426     03  FILLER                  PIC X(46)                           CL**1
   427         VALUE '****  A AND H CLAIMS PAID IN THIS PERIOD  ****'.     CL**1
   428     03  FILLER                  PIC X(46) VALUE SPACES.             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS151.cbl
   430 01  DETAIL-1.                                                       CL**1
   431     03  FILLER                  PIC X VALUE SPACE.                  CL**1
   432     03  D1-MSG                  PIC X(15) VALUE SPACES.             CL**1
   433     03  D1-ISS-CNT              PIC ZZZ,ZZZ-.                       CL**1
   434     03  D1-ISS-AMT              PIC ZZZZ,ZZZ,ZZZ.ZZ-.               CL**1
   435     03  D1-ISS-PRM              PIC ZZ,ZZZ,ZZZ.ZZ-.                 CL**1
   436     03  FILLER                  PIC XX VALUE SPACES.                CL**1
   437     03  D1-CAN-CNT              PIC ZZZ,ZZZ-.                       CL**1
   438     03  D1-CAN-AMT              PIC ZZZZ,ZZZ,ZZZ.ZZ-.               CL**1
   439     03  D1-CAN-PRM              PIC ZZ,ZZZ,ZZZ.ZZ-.                 CL**1
   440     03  FILLER                  PIC X VALUE SPACES.                 CL**1
   441     03  D1-CLM-CNT              PIC ZZZ,ZZZ-.                       CL**1
   442     03  D1-CLM-AMT              PIC ZZ,ZZZ,ZZZ.ZZ-.                 CL**1
   443     03  FILLER                  PIC X VALUE SPACE.                  CL**1
   444     03  D1-ERN-AMT              PIC ZZZ,ZZZ,ZZZ.ZZ-.                CL**1
   445                                                                     CL**1
   446 01  DETAIL-2.                                                       CL**1
   447     03  FILLER                  PIC X(7) VALUE SPACES.              CL**1
   448     03  D2-MSG                  PIC X(34) VALUE SPACES.             CL**1
   449     03  FILLER                  PIC X(6) VALUE SPACES.              CL**1
   450     03  D2-GRP-CNT              PIC ZZ,ZZZ,ZZZ-.                    CL**1
   451     03  FILLER                  PIC X(6) VALUE SPACES.              CL**1
   452     03  D2-GRP-AMT              PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.             CL**1
   453     03  FILLER                  PIC X(5) VALUE SPACES.              CL**1
   454     03  D2-IND-CNT              PIC ZZ,ZZZ,ZZZ-.                    CL**1
   455     03  FILLER                  PIC X(7) VALUE SPACES.              CL**1
   456     03  D2-IND-AMT              PIC ZZ,ZZZ,ZZZ,ZZZ.ZZ-.             CL**1
   457     03  FILLER                  PIC X(10) VALUE SPACES.             CL**1
   458                                                                     CL**1
   459 01  WORK-INDEX.                                                     CL**1
   460     03 Y                        PIC S9(2) COMP.                     CL**1
   461     03 Z                        PIC S9(2) COMP.                     CL**1
   462                                                                     CL**1
   463 01  DETAIL-3.                                                       CL**1
   464     03  FILLER                  PIC X(41) VALUE SPACES.             CL**1
   465     03  D3-MSG                  PIC X(27) VALUE SPACES.             CL**1
   466     03  D3-AH-AMT               PIC ZZ,ZZZ,ZZZ,ZZZ.99-.             CL**1
   467     03  FILLER                  PIC X(47) VALUE SPACES.             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS151.cbl
   469 01  MONTH-TABLE.                                                    CL**1
   470     03  FILLER                  PIC X(10) VALUE 'JANUARY   '.       CL**1
   471     03  FILLER                  PIC X(10) VALUE 'FEBRUARY  '.       CL**1
   472     03  FILLER                  PIC X(10) VALUE 'MARCH     '.       CL**1
   473     03  FILLER                  PIC X(10) VALUE 'APRIL     '.       CL**1
   474     03  FILLER                  PIC X(10) VALUE 'MAY       '.       CL**1
   475     03  FILLER                  PIC X(10) VALUE 'JUNE      '.       CL**1
   476     03  FILLER                  PIC X(10) VALUE 'JULY      '.       CL**1
   477     03  FILLER                  PIC X(10) VALUE 'AUGUST    '.       CL**1
   478     03  FILLER                  PIC X(10) VALUE 'SEPTEMBER '.       CL**1
   479     03  FILLER                  PIC X(10) VALUE 'OCTOBER   '.       CL**1
   480     03  FILLER                  PIC X(10) VALUE 'NOVEMBER  '.       CL**1
   481     03  FILLER                  PIC X(10) VALUE 'DECEMBER  '.       CL**1
   482                                                                     CL**1
   483 01  MONTH-TABLE-A     REDEFINES MONTH-TABLE.                        CL**1
   484     03  MONTH-SUB               OCCURS 12 TIMES.                    CL**1
   485         05  MONTH-ALPHA         PIC X(10).                          CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS151.cbl
   487 01  TABLE-1.                                                        CL**1
   488     03  TABLE-1-GRP     OCCURS 3 TIMES.                             CL**1
   489         05  TABLE-1-DTL OCCURS 10 TIMES.                            CL**1
   490             07  TBL-ISSUE-CNT   PIC S9(13)          COMP-3.         CL**1
   491             07  TBL-ISSUE-AMT   PIC S9(11)V99       COMP-3.         CL**1
   492             07  TBL-ISSUE-PREM  PIC S9(11)V99       COMP-3.         CL**1
   493             07  TBL-CANCEL-CNT  PIC S9(13)          COMP-3.         CL**1
   494             07  TBL-CANCEL-AMT  PIC S9(11)V99       COMP-3.         CL**1
   495             07  TBL-CANCEL-PREM PIC S9(11)V99       COMP-3.         CL**1
   496             07  TBL-CLAIM-CNT   PIC S9(13)          COMP-3.         CL**1
   497             07  TBL-CLAIM-AMT   PIC S9(11)V99       COMP-3.         CL**1
   498             07  TBL-EARN-PREM   PIC S9(11)V99       COMP-3.         CL**1
   499                                                                     CL**1
   500 01  TABLE-2.                                                        CL**1
   501     03  TABLE-2-GRP     OCCURS 3 TIMES.                             CL**1
   502         05  TBL-2-DTL   OCCURS 9 TIMES.                             CL**1
   503             07  TBL-GRP-CNT     PIC S9(13)          COMP-3.         CL**1
   504             07  TBL-GRP-AMT     PIC S9(11)V99       COMP-3.         CL**1
   505             07  TBL-IND-CNT     PIC S9(13)          COMP-3.         CL**1
   506             07  TBL-IND-AMT     PIC S9(11)V99       COMP-3.         CL**1
   507                                                                     CL**1
   508 01  TABLE-3.                                                        CL**1
   509     03  TABLE-3-GRP     OCCURS 9 TIMES.                             CL**1
   510         05  T3-GRP-CNT          PIC S9(13)          COMP-3.         CL**1
   511         05  T3-GRP-AMT          PIC S9(11)V99       COMP-3.         CL**1
   512         05  T3-IND-CNT          PIC S9(13)          COMP-3.         CL**1
   513         05  T3-IND-AMT          PIC S9(11)V99       COMP-3.         CL**1
   514                                                                     CL**1
   515 01  P1-MESS-R.                                                      CL**1
   516     03  FILLER                  PIC X(32)                           CL**1
   517         VALUE 'TERMS OF 1 MONTH THRU 120 MONTHS'.                   CL**1
   518     03  FILLER                  PIC X(32)                           CL**1
   519         VALUE 'TERMS 61 MONTHS THRU 120 MONTHS '.                   CL**1
   520     03  FILLER                  PIC X(32)                           CL**1
   521         VALUE 'TERMS GREATER THAN 120 MONTHS   '.                   CL**1
   522                                                                     CL**1
   523 01  PAGE-1-MESSAGE REDEFINES P1-MESS-R.                             CL**1
   524     03  P1-MESS         OCCURS 3 TIMES.                             CL**1
   525         05  P1-MSG-1            PIC X(32).                          CL**1
   526                                                                     CL**1
   527 01  TABLE-FOR-PRINT-G.                                              CL**1
   528     03  REPORT-G-SWITCHES  OCCURS 3 TIMES.                          CL**1
   529         05  R-SW-G              PIC X.                              CL**1
   530                                                                     CL**1
   531 01  TABLE-FOR-PRINT-I.                                              CL**1
   532     03  REPORT-I-SWITCHES  OCCURS 3 TIMES.                          CL**1
   533         05  R-SW-I              PIC X.                              CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS151.cbl
   535 01  TOTAL-PRINT-AMOUNTS         COMP-3.                             CL**1
   536     03  G1-ISS-CNT              PIC S9(13).                         CL**1
   537     03  G1-ISS-AMT              PIC S9(11)V99.                      CL**1
   538     03  G1-ISS-PRM              PIC S9(11)V99.                      CL**1
   539     03  G1-CAN-CNT              PIC S9(13).                         CL**1
   540     03  G1-CAN-AMT              PIC S9(11)V99.                      CL**1
   541     03  G1-CAN-PRM              PIC S9(11)V99.                      CL**1
   542     03  G1-CLM-CNT              PIC S9(13).                         CL**1
   543     03  G1-CLM-AMT              PIC S9(11)V99.                      CL**1
   544     03  G1-ERN-PRM              PIC S9(11)V99.                      CL**1
   545                                                                     CL**1
   546 01  TOTAL-AMOUNTS               COMP-3.                             CL**1
   547     03  T1-ISS-CNT              PIC S9(13).                         CL**1
   548     03  T1-ISS-AMT              PIC S9(11)V99.                      CL**1
   549     03  T1-ISS-PRM              PIC S9(11)V99.                      CL**1
   550     03  T1-CAN-CNT              PIC S9(13).                         CL**1
   551     03  T1-CAN-AMT              PIC S9(11)V99.                      CL**1
   552     03  T1-CAN-PRM              PIC S9(11)V99.                      CL**1
   553     03  T1-CLM-CNT              PIC S9(13).                         CL**1
   554     03  T1-CLM-AMT              PIC S9(11)V99.                      CL**1
   555     03  T1-ERN-PRM              PIC S9(11)V99.                      CL**1
   556                                                                     CL**1
   557 01  TOT-AH-ACCUM.                                                   CL**1
   558     03  TOT-AH-PD-THIS          PIC S9(11)V99 COMP-3.               CL**1
   559     03  TOT-AH-PD-LAST          PIC S9(11)V99 COMP-3.               CL**1
   560                                                                     CL**1
   561 01  ZERO-FIELDS-1               COMP-3.                             CL**1
   562     03  FILLER                  PIC S9(13)      VALUE +0.           CL**1
   563     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   564     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   565     03  FILLER                  PIC S9(13)      VALUE +0.           CL**1
   566     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   567     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   568     03  FILLER                  PIC S9(13)      VALUE +0.           CL**1
   569     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   570     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   571                                                                     CL**1
   572 01  ZERO-FIELDS-2               COMP-3.                             CL**1
   573     03  FILLER                  PIC S9(13)      VALUE +0.           CL**1
   574     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
   575     03  FILLER                  PIC S9(13)      VALUE +0.           CL**1
   576     03  FILLER                  PIC S9(11)V99   VALUE +0.           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS151.cbl
   578 01  CONTROL-AREA.                                                   CL**1
   579     03  CONTROL-A.                                                  CL**1
   580         05  CNTRL-REIN-CO       PIC X(6)  VALUE LOW-VALUES.         CL**1
   581         05  CNTRL-STATE-SEQ     PIC X(2)  VALUE LOW-VALUES.         CL**1
   582         05  CNTRL-CARRIER       PIC X     VALUE LOW-VALUES.         CL**1
   583         05  CNTRL-COMPANY       PIC X(6)  VALUE LOW-VALUES.         CL**1
   584         05  CNTRL-STATE         PIC X(2)  VALUE LOW-VALUES.         CL**1
   585         05  CNTRL-ACCOUNT       PIC X(10) VALUE LOW-VALUES.         CL**1
   586     03  CNTRL-ST-SEQ            PIC X(2)  VALUE LOW-VALUES.         CL**1
   587     03  CNTRL-REC-TYPE          PIC 99    VALUE ZERO.               CL**1
   588                                                                     CL**1
   589 01  RANGE-DATES.                                                    CL**1
   590     03  CNTRL-START             PIC 9(11).                          CL**2
   591     03  CNTRL-END               PIC 9(11).                          CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS151.cbl
   593 01  THE-RECORD.                                                     CL**1
   594     03  ER-SORT-KEY.                                                CL**1
   595         05  ER-CONTROL.                                             CL**1
   596             07  ER-REINS-CO     PIC X(06).                          CL**1
   597             07  ER-STATE-SEQ    PIC X(02).                          CL**1
   598             07  ER-CARRIER      PIC X(01).                          CL**1
   599             07  ER-COMPANY      PIC X(06).                          CL**1
   600             07  ER-STATE        PIC X(02).                          CL**1
   601             07  ER-ACCOUNT      PIC X(10).                          CL**1
   602         05  ER-ST-SEQ           PIC X(02).                          CL**1
   603         05  ER-REC-TYPE         PIC 99.                             CL**1
   604     03  ER-PERIOD-START         PIC 9(11)   COMP-3.                 CL**2
   605     03  ER-PERIOD-END           PIC 9(11)   COMP-3.                 CL**2
   606     03  ER-ACTIVITY-TOTALS.                                         CL**1
   607         05  ER-TERM-GROUP       OCCURS 3 TIMES.                     CL**1
   608*                1 = 0-60 MONTHS                                     CL**1
   609*                2 = 61-120 MONTHS                                   CL**1
   610*                3 = 121 AND OVER.                                   CL**1
   611             07  ER-TYPE-GROUPS  OCCURS 10 TIMES.                    CL**1
   612*                    1 = LIFE(R-GP)      6 = LIFE(R-IND)             CL**1
   613*                    2 = LIFE(L-GP)      7 = LIFE(L-IND)             CL**1
   614*                    3 = LIFE(OB-GP)     8 = LIFE(OB-IND)            CL**1
   615*                    4 = AH(GP)          9 = AH(IND)                 CL**1
   616*                    5 = AH(OB-GP)      10 = AH(OB-IND)              CL**1
   617                 09  ER-ISSUE-CNT    PIC S9(13)      COMP-3.         CL**1
   618                 09  ER-ISSUE-AMT    PIC S9(11)V99   COMP-3.         CL**1
   619                 09  ER-ISSUE-PREM   PIC S9(11)V99   COMP-3.         CL**1
   620                 09  ER-CANCEL-CNT   PIC S9(13)      COMP-3.         CL**1
   621                 09  ER-CANCEL-AMT   PIC S9(11)V99   COMP-3.         CL**1
   622                 09  ER-CANCEL-PREM  PIC S9(11)V99   COMP-3.         CL**1
   623                 09  ER-CLAIM-CNT    PIC S9(13)      COMP-3.         CL**1
   624                 09  ER-CLAIM-AMT    PIC S9(11)V99   COMP-3.         CL**1
   625                 09  ER-EARN-PREM    PIC S9(11)V99   COMP-3.         CL**1
   626     03  ER-EXHIBIT-TOTALS.                                          CL**1
   627         05  ER-TERM-GROUP-E     OCCURS 3 TIMES.                     CL**1
   628*                1 = 0-60 MONTHS                                     CL**1
   629*                2 = 61-120 MONTHS                                   CL**1
   630*                3 = 121 AND OVER                                    CL**1
   631             07  ER-LINE-DETAIL  OCCURS 9 TIMES.                     CL**1
   632*                1 = INFORCE PREVIOUS PER  6 = CANCEL IN PERIOD      CL**1
   633*                2 = ISSUED IN PERIOD      7 = DECREASES IN PERIOD   CL**1
   634*                3 = TOTAL INFORCE-START   8 = TOTAL DEC IN PERIOD   CL**1
   635*                4 = DEATHS IN PERIOD      9 = TOTAL INFORCE (END)   CL**1
   636*                5 = EXPIRED IN PERIOD                               CL**1
   637                                                                     CL**1
   638                 09  ER-GROUP-CNT    PIC S9(13)      COMP-3.         CL**1
   639                 09  ER-GROUP-AMT    PIC S9(11)V99   COMP-3.         CL**1
   640                 09  ER-IND-CNT      PIC S9(13)      COMP-3.         CL**1
   641                 09  ER-IND-AMT      PIC S9(11)V99   COMP-3.         CL**1
   642                                                                     CL**1
   643     03  ER-AH-PD-THIS               PIC S9(11)V99   COMP-3.         CL**1
   644     03  ER-AH-PD-LAST               PIC S9(11)V99   COMP-3.         CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS151.cbl
*  646                             COPY ELCDTECX.                          CL**1
   647******************************************************************06/05/98
   648*                                                                *ELCDTECX
   649*                            ELCDTECX.                           *   LV005
   650*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   651*                            VMOD=2.015                          *ELCDTECX
   652*                                                                *ELCDTECX
   653*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   654*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   655*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   656*                                                                *ELCDTECX
   657******************************************************************ELCDTECX
   658******************************************************************
   659*                   C H A N G E   L O G
   660*
   661* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   662*-----------------------------------------------------------------
   663*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   664* EFFECTIVE    NUMBER
   665*-----------------------------------------------------------------
   666* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   667*                                  BENEFIT CODES FROM 300 TO 900
   668* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   669* 051304    2003080800002  SMVA  ADD REFUND METHOD
   670* 071714    2013100100002  PEMA  FIX CRIT PERIOD EDITS
   671******************************************************************
   672 01  DATE-CARD.                                                   ELCDTECX
   673     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   674     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   675     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   676     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   677     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   678     12  EP-SW                       PIC  X.                      ELCDTECX
   679         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   680     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   681         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   682     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   683     12  RUN-CENTURY.                                             ELCDTECX
   684         16 RUN-CENTURY-N            PIC  99.                        CL**4
   685     12  FILLER                      PIC  X.                         CL**4
   686     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   687     12  FILLER                      PIC  XXX.                    ELCDTECX
   688     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   689                                                                  ELCDTECX
   690 01  FILLER                          PIC  X(7)                       CL**6
   691                                          VALUE 'OPTIONS'.        ELCDTECX
   692 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   693     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   694     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   695     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   696         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   697         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   698     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   699     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   700     12  FILLER                      PIC  X.                      ELCDTECX
   701     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   702     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   703     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   704     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   705     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   706     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   707     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   708     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   709     12  FILLER                      PIC  X.                      ELCDTECX
   710     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   711     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   712     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   713     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   714     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   715     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   716     12  FILLER                      PIC  X.                      ELCDTECX
   717     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   718     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   719     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   720     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   721     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   722     12  DTE-R78                     PIC  X.                      ELCDTECX
   723     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   724     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   725     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   726     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   727     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   728     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   729     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   730                                     PIC  X.                      ELCDTECX
   731         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   732                                                 ' '.             ELCDTECX
   733         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   734         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   735     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   736         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   737         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   738     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   739     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   740                                     PIC  9.                         CL**4
   741     12  DTE-SYSTEM.                                              ELCDTECX
   742         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   743         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   744         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   745         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   746         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   747         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   748         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   749         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   750         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   751         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   752         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   753         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   754         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   755         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   756         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   757         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   758         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   759         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   760         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   761         16  DTE-SYS-T               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   762         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   763         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   764         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   765         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   766         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   767         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   768     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   769         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   770                                     PIC  X.                      ELCDTECX
   771     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   772                                                                  ELCDTECX
   773 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   774     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   775     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   776     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   777*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   778     12  FILLER                      PIC  X.                      ELCDTECX
   779     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   780     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   781     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   782     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   783     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   784     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   785     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   786                                                                  ELCDTECX
   787     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   788     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   789     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   790     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   791                                                                  ELCDTECX
   792     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   793     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   794     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   795     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   796                                                                  ELCDTECX
   797     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   798     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   799                                                                  ELCDTECX
   800     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   801     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   802                                                                  ELCDTECX
   803     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   804                                                                  ELCDTECX
   805 01  DATE-CARD-FACTORS.                                           ELCDTECX
   806     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   807     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   808     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   809     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   810     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   811     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   812     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   813                                                                  ELCDTECX
   814 01  FILLER                          PIC  X(12)                   ELCDTECX
   815                                          VALUE 'COMPANY NAME'.   ELCDTECX
   816 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   817     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   818         16  CNT-ID                  PIC  X.                      ELCDTECX
   819         16  CNT-NAME                PIC  X(30).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   820                                                                  ELCDTECX
   821 01  FILLER                          PIC  X(11)                   ELCDTECX
   822                                          VALUE 'STATE NAMES'.    ELCDTECX
   823 01  STATE-NAMES.                                                 ELCDTECX
   824     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   825         16  STATE-SUB               PIC  XX.                     ELCDTECX
   826         16  STATE-PIC1.                                          ELCDTECX
   827             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   828             20  FILLER              PIC  XXX.                    ELCDTECX
   829             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   830             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   831             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   832             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   833                                                                  ELCDTECX
   834 01  FILLER                          PIC  X(13)                   ELCDTECX
   835                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   836 01  CARRIER-NAMES.                                               ELCDTECX
   837     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   838         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   839         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   840         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   841         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   842         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   843         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   844*        16  FILLER                  PIC  X.                      ELCDTECX
   845         16  CARRIER-SEC-PAY         PIC  X.
   846             88  SEC-PAY-CARRIER          VALUE 'Y'.
   847                                                                  ELCDTECX
   848 01  FILLER                          PIC  X(9)                       CL**6
   849                                          VALUE 'INS TYPES'.      ELCDTECX
   850 01  CLAS-INS-TYPES.                                              ELCDTECX
   851*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   852     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   853         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   854         16  CLAS-I-AB3.                                          ELCDTECX
   855             20  FILLER              PIC  X.                      ELCDTECX
   856             20  CLAS-I-AB2.                                      ELCDTECX
   857                 24  FILLER          PIC  X.                      ELCDTECX
   858                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   859         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   860             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   861             20  FILLER              PIC  X.                         CL**4
   862         16  CLAS-I-AB10.                                         ELCDTECX
   863             20  FILLER              PIC  X(9).                   ELCDTECX
   864             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   865         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   866         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   867         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   868         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   869             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   870         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   871         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   872         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   873         16  CLAS-I-BEN-CATEGORY     PIC  X.
   874         16  CLAS-I-REFUND-METHOD    PIC  X.
   875         16  CLAS-I-MAX-BENEFITS     PIC 99.
   876         16  FILLER                  PIC  XXX.
   877                                                                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   878 01  FILLER                          PIC  X(16)                   ELCDTECX
   879                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   880 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   881     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   882                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   883         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   884         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   885         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   886         16  CLAS-MORT-DESC.                                      ELCDTECX
   887             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   888             20  FILLER              PIC  XX.                        CL**5
   889             20  CLAS-YEAR           PIC  X(4).                      CL**6
   890             20  FILLER              PIC  X.                         CL**5
   891             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   892             20  FILLER              PIC  X.                         CL**5
   893             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   894             20  FILLER              PIC  X.                         CL**5
   895             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   896             20  FILLER              PIC  X(5).                      CL**6
   897                                                                  ELCDTECX
   898 01  FILLER                          PIC  X(15)                   ELCDTECX
   899                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   900 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   901     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   902         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   903         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   904         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   905         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   906         16  FILLER                  PIC  X(4).                      CL**6
   907                                                                  ELCDTECX
   908 01  FILLER                          PIC  X(7)                       CL**6
   909                                     VALUE 'INDEXES'.             ELCDTECX
   910 01  CLAS-INDEX-TBL.                                              ELCDTECX
   911     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   912     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   913     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   914     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   915     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   916     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   917     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   918     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   919     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   920     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   921     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   922     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   923     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   924     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   925     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   926     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   927     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   928                                                                  ELCDTECX
   929 01  CLAS-TYPE-MISC.                                              ELCDTECX
   930     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   931     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   932     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   933     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   934     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   935     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   936     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   937     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   938     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   939     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   940     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   941                                                                  ELCDTECX
   942 01  FILLER                          PIC  X(13)                   ELCDTECX
   943                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   944 01  CLAS-MISC.                                                   ELCDTECX
   945     12  DTE-FICH                    PIC  X.                      ELCDTECX
   946         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   947         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   948         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   949     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   950     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   951     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   952     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   953     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   954     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   955     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   956     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   957     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   958     12  STATE-L                     PIC  XX.                     ELCDTECX
   959     12  CLAS-CN                     PIC  99.                     ELCDTECX
   960     12  CLAS-CO                     PIC  99.                     ELCDTECX
   961     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   962         16  DTE-F-1                 PIC  X.                      ELCDTECX
   963         16  DTE-F-2                 PIC  X.                      ELCDTECX
   964     12  DTE-ABEND-WORK.                                          ELCDTECX
   965         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   966         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   967                                                                  ELCDTECX
   968 01  FILLER                          PIC  X(12)                   ELCDTECX
   969                                     VALUE 'WORKING DATE'.        ELCDTECX
   970 01  WS-DATE-AND-TIME.                                            ELCDTECX
   971     12  WS-ACCEPT-DATE.                                          ELCDTECX
   972         16  WS-AD-YY                PIC  99.                     ELCDTECX
   973         16  WS-AD-MM                PIC  99.                     ELCDTECX
   974         16  WS-AD-DD                PIC  99.                     ELCDTECX
   975     12  WS-CURRENT-DATE.                                         ELCDTECX
   976         16  WS-CD-MM                PIC  99.                     ELCDTECX
   977         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   978         16  WS-CD-DD                PIC  99.                     ELCDTECX
   979         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   980         16  WS-CD-YY                PIC  99.                     ELCDTECX
   981     12  WS-TIME-OF-DAY.                                          ELCDTECX
   982         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   983         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   984                                                                  ELCDTECX
   985 01  FILLER                          PIC  X(12)                   ELCDTECX
   986                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   987 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   988     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   989         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   990         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   991         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   992                                                                  ELCDTECX
   993 01  FILLER                          PIC  X(10)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  26
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   994                                     VALUE 'STATE TLRS'.          ELCDTECX
   995 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   996     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   997         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   998         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   999                                                                  ELCDTECX
  1000 01  FILLER                          PIC  X(13)                   ELCDTECX
  1001                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1002 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1003     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1004         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1005                                                                  ELCDTECX
  1006 01  FILLER                          PIC  X(13)                   ELCDTECX
  1007                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1008 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1009     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1010     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1011     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1012                                     PIC  X.                         CL**5
  1013     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1014     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1015     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1016     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1017     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1018     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1019     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1020     12  FILLER                      PIC  X(75).                  ELCDTECX
  1021******************************************************************ELCDTECX
  1022*01  MISC-CARR-PCT-DATA.                                          00001521
  1023*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1024*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1025*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1026*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1027*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1028*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1029******************************************************************ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  27
* ECS151.cbl
* 1031                             COPY ELCDTEVR.                          CL**2
  1032***************************************************************** 04/15/98
  1033*                                                                *ELCDTEVR
  1034*                                                                *ELCDTEVR
  1035*                            ELCDTEVR.                           *   LV003
  1036*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1037*                            VMOD=2.001                          *   CL**2
  1038*                                                                *ELCDTEVR
  1039*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1040*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1041*                                                                *ELCDTEVR
  1042******************************************************************ELCDTEVR
  1043 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1044     05  WS-RUN-DATE.                                             ELCDTEVR
  1045         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1046         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1047         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1048             15  RUN-CC              PIC  99.                     ELCDTEVR
  1049             15  RUN-YR              PIC  99.                     ELCDTEVR
  1050         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1051         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1052     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1053            WS-RUN-DATE              PIC 9(11).                      CL**2
  1054     05  WS-EP-DT.                                                ELCDTEVR
  1055         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1056         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1057         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1058             15  EP-CC               PIC  99.                     ELCDTEVR
  1059             15  EP-YR               PIC  99.                     ELCDTEVR
  1060         10  EP-MO                   PIC  99.                     ELCDTEVR
  1061         10  EP-DA                   PIC  99.                     ELCDTEVR
  1062     05  WS-EP-DT-N REDEFINES                                        CL**2
  1063            WS-EP-DT                 PIC 9(11).                      CL**2
  1064     05  WS-DTE-CONV-DT.                                             CL**4
  1065         10  FILLER                  PIC  9(03).                     CL**4
  1066         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1067         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1068             15  DTE-CONV-CC         PIC  99.                        CL**4
  1069             15  DTE-CONV-YR         PIC  99.                        CL**4
  1070         10  DTE-CONV-MO             PIC  99.                        CL**4
  1071         10  DTE-CONV-DA             PIC  99.                        CL**4
  1072     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1073            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1074 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1075     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1076         10  FILLER                            PIC 999.           ELCDTEVR
  1077         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1078         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1079             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1080             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1081         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1082         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1083     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1084            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1085     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1086         10  FILLER                            PIC 999.           ELCDTEVR
  1087         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
  1088         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  28
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1089         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1090         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1091     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1092            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1093 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1094     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1095         10  FILLER                            PIC 999.           ELCDTEVR
  1096         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1097         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1098             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1099             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1100         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1101         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1102     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1103            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1104     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1105         10  FILLER                            PIC 999.           ELCDTEVR
  1106         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1107         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1108             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1109             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1110         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1111         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1112     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1113            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1114     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1115         10  FILLER                            PIC 999.           ELCDTEVR
  1116         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1117         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1118             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1119             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1120         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1121         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1122     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1123            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1124 01  WS-RATE-RECORD.                                              ELCDTEVR
  1125         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1126             10  FILLER                        PIC 999.           ELCDTEVR
  1127             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1128             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1129                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1130                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1131             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1132             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1133         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1134                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  29
* ECS151.cbl
  1136 PROCEDURE DIVISION.                                                 CL**1
  1137 0100-READ-DATE.                                                     CL**1
  1138
  1139     ACCEPT      WS-REPORT-TITLE.
  1140
  1141     IF WS-REPORT-TITLE = 'NON CREDIT'
  1142        MOVE ' NON CREDIT '      TO HD-1-MSGA
  1143     ELSE
  1144        IF WS-REPORT-TITLE = 'CREDIT'
  1145           MOVE ' ONLY CREDIT '  TO HD-1-MSGA
  1146        ELSE
  1147           MOVE SPACES           TO HD-1-MSGA
  1148        END-IF
  1149     END-IF
  1150
* 1151                             COPY ELCDTERX.                          CL**1
  1152******************************************************************04/15/98
  1153*                                                                *ELCDTERX
  1154*                                                                *ELCDTERX
  1155*                            ELCDTERX.                           *   LV002
  1156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1157*                            VMOD=2.007                          *ELCDTERX
  1158*                                                                *ELCDTERX
  1159*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1160*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1161*      = ELCDTEFD)                                               *ELCDTERX
  1162*                                                                *ELCDTERX
  1163******************************************************************ELCDTERX
  1164                                                                  ELCDTERX
  1165     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1166                                                                  ELCDTERX
  1167     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1168     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1169     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1170                                                                  ELCDTERX
  1171     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1172                                                                  ELCDTERX
  1173******************************************************************ELCDTERX
  1174*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1175*          WARNING MESSAGES.                                      ELCDTERX
  1176******************************************************************ELCDTERX
  1177     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1178         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1179                                                                  ELCDTERX
  1180     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1181                                                                  ELCDTERX
  1182     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1183                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1184                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1185                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1186                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1187                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1188                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1189                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1190                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1191                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1192                                                                  ELCDTERX
  1193     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  30
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1194                                                                  ELCDTERX
  1195     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1196                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1197                                                                  ELCDTERX
  1198     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1199     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1200     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1201     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1202                                                                  ELCDTERX
  1203     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1204         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1205     ELSE                                                         ELCDTERX
  1206         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1207                                                                  ELCDTERX
  1208     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1209         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1210     ELSE                                                         ELCDTERX
  1211         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1212                                                                  ELCDTERX
  1213 0005-READ--CARD.                                                 ELCDTERX
  1214     READ DISK-DATE                                               ELCDTERX
  1215         AT END CLOSE DISK-DATE                                   ELCDTERX
  1216             GO TO 0060-READ--TEST.                               ELCDTERX
  1217                                                                  ELCDTERX
  1218     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1219                                                                  ELCDTERX
  1220     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1221         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1222         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1223         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1224         GO TO 0005-READ--CARD.                                   ELCDTERX
  1225                                                                  ELCDTERX
  1226     IF DD-ID = 'CLAD'                                            ELCDTERX
  1227         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1228         GO TO 0005-READ--CARD.                                   ELCDTERX
  1229                                                                  ELCDTERX
  1230     IF DD-ID = 'CLAX'                                            ELCDTERX
  1231         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1232         GO TO 0005-READ--CARD.                                   ELCDTERX
  1233                                                                  ELCDTERX
  1234     IF DD-ID = 'CLAF'                                            ELCDTERX
  1235         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1236         GO TO 0005-READ--CARD.                                   ELCDTERX
  1237                                                                  ELCDTERX
  1238     IF DD-ID = 'CLAC'                                            ELCDTERX
  1239         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1240                                                                  ELCDTERX
  1241     IF DD-ID = 'CARR'                                            ELCDTERX
  1242         GO TO 0015-READ--CARR.                                   ELCDTERX
  1243                                                                  ELCDTERX
  1244     IF DD-ID = 'STAT'                                            ELCDTERX
  1245         GO TO 0020-READ--STAT.                                   ELCDTERX
  1246                                                                  ELCDTERX
  1247     IF DD-ID = 'BUSC'                                            ELCDTERX
  1248         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1249                                                                  ELCDTERX
  1250     IF DD-ID = 'MORT'                                            ELCDTERX
  1251         GO TO 0030-READ--MORT.                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  31
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1252                                                                  ELCDTERX
  1253     IF DD-ID = 'CLAI'                                            ELCDTERX
  1254         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1255                                                                  ELCDTERX
  1256     IF DD-ID = 'COLC'                                            ELCDTERX
  1257         GO TO 0065-READ--COLC.                                   ELCDTERX
  1258                                                                  ELCDTERX
  1259     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1260        DD-IDA = 'CL'                                             ELCDTERX
  1261         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1262                                                                  ELCDTERX
  1263     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1264        DD-IDA = 'PO'                                             ELCDTERX
  1265         GO TO 0050-READ--POXX.                                   ELCDTERX
  1266                                                                  ELCDTERX
  1267     IF DD-ID = 'OPCA'                                            ELCDTERX
  1268         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1269                                                                  ELCDTERX
  1270     IF DD-ID = 'OPST'                                            ELCDTERX
  1271         GO TO 0072-READ--OPST.                                   ELCDTERX
  1272                                                                  ELCDTERX
  1273     IF DD-ID = 'OPBS'                                            ELCDTERX
  1274         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1275                                                                  ELCDTERX
  1276     IF DD-ID = 'OPMS'                                            ELCDTERX
  1277         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1278                                                                  ELCDTERX
  1279     GO TO 0005-READ--CARD.                                       ELCDTERX
  1280                                                                  ELCDTERX
  1281 0010-READ--CLAC.                                                 ELCDTERX
  1282     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1283     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1284     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1285     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1286     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1287     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1288     GO TO 0005-READ--CARD.                                       ELCDTERX
  1289                                                                  ELCDTERX
  1290 0015-READ--CARR.                                                 ELCDTERX
  1291     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1292     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1293        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1294        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1295        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1296        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1297        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1298        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1299        MOVE DD-CARR1-SECPAY-SW
  1300                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1301     END-IF
  1302                                                                  ELCDTERX
  1303     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1304     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1305        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1306        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1307        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1308        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1309        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  32
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1310        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1311        MOVE DD-CARR2-SECPAY-SW
  1312                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1313     END-IF
  1314                                                                  ELCDTERX
  1315                                                                  ELCDTERX
  1316     GO TO 0005-READ--CARD.                                       ELCDTERX
  1317                                                                  ELCDTERX
  1318 0020-READ--STAT.                                                 ELCDTERX
  1319     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1320     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1321        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1322         GO TO 0005-READ--CARD.                                   ELCDTERX
  1323                                                                  ELCDTERX
  1324     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1325     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1326     GO TO 0020-READ--STAT.                                       ELCDTERX
  1327                                                                  ELCDTERX
  1328 0025-READ--BUSC.                                                 ELCDTERX
  1329     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1330     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1331        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1332         GO TO 0005-READ--CARD.                                   ELCDTERX
  1333                                                                  ELCDTERX
  1334     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1335     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1336     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1337                                                                  ELCDTERX
  1338 0030-READ--MORT.                                                 ELCDTERX
  1339     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1340     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1341        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1342         GO TO 0005-READ--CARD.                                   ELCDTERX
  1343                                                                  ELCDTERX
  1344     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1345     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1346     GO TO 0030-READ--MORT.                                       ELCDTERX
  1347                                                                  ELCDTERX
  1348 0035-READ--CLXX.                                                 ELCDTERX
  1349     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1350          GO TO 0005-READ--CARD.                                  ELCDTERX
  1351                                                                  ELCDTERX
  1352     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1353         DISPLAY '***********************************************'ELCDTERX
  1354         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1355         DISPLAY '***********************************************'ELCDTERX
  1356         GO TO 0055-READ--STOP.                                   ELCDTERX
  1357                                                                  ELCDTERX
  1358     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1359        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1360         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1361                                                                  ELCDTERX
  1362     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1363        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1364         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1365                                                                  ELCDTERX
  1366*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1367     GO TO 0005-READ--CARD.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  33
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1368                                                                  ELCDTERX
  1369 0040-READ--CLAI.                                                 ELCDTERX
  1370     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1371     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1372        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1373         GO TO 0005-READ--CARD.                                   ELCDTERX
  1374                                                                  ELCDTERX
  1375     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1376     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1377     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1378                                                                  ELCDTERX
  1379 0045-READ--DUMP.                                                 ELCDTERX
  1380     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1381     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1382                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1383     PERFORM ABEND-PGM.                                           ELCDTERX
  1384                                                                  ELCDTERX
  1385 0050-READ--POXX.                                                 ELCDTERX
  1386     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1387         GO TO 0005-READ--CARD.                                   ELCDTERX
  1388                                                                  ELCDTERX
  1389     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1390         DISPLAY '***********************************************'ELCDTERX
  1391         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1392         DISPLAY '***********************************************'ELCDTERX
  1393         GO TO 0055-READ--STOP.                                   ELCDTERX
  1394                                                                  ELCDTERX
  1395     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1396     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1397     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1398     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1399                                                                  ELCDTERX
  1400     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1401         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1402     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1403         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1404                                                                  ELCDTERX
  1405     GO TO 0005-READ--CARD.                                       ELCDTERX
  1406                                                                  ELCDTERX
  1407 0055-READ--STOP.                                                 ELCDTERX
  1408     GOBACK.                                                      ELCDTERX
  1409                                                                  ELCDTERX
  1410 0060-READ--TEST.                                                 ELCDTERX
  1411     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1412        CLAX-ID         = SPACE  OR                               ELCDTERX
  1413        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1414         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1415                                                                  ELCDTERX
  1416     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1417     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1418                                                                  ELCDTERX
  1419 0065-READ--COLC.                                                 ELCDTERX
  1420     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1421     GO TO 0005-READ--CARD.                                       ELCDTERX
  1422                                                                  ELCDTERX
  1423 0070-READ--OPCA.                                                 ELCDTERX
  1424                                                                  ELCDTERX
  1425     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  34
* ECS151.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1426                                                                  ELCDTERX
  1427     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1428             OR                                                   ELCDTERX
  1429         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1430         GO TO 0005-READ--CARD.                                   ELCDTERX
  1431                                                                  ELCDTERX
  1432     ADD 1                       TO INDEXCA.                      ELCDTERX
  1433     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1434                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1435     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1436                                                                  ELCDTERX
  1437 0072-READ--OPST.                                                 ELCDTERX
  1438                                                                  ELCDTERX
  1439     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1440                                                                  ELCDTERX
  1441     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1442             OR                                                   ELCDTERX
  1443         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1444         GO TO 0005-READ--CARD.                                   ELCDTERX
  1445                                                                  ELCDTERX
  1446     ADD 1                       TO INDEXST.                      ELCDTERX
  1447     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1448                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1449     GO TO 0072-READ--OPST.                                       ELCDTERX
  1450                                                                  ELCDTERX
  1451 0074-READ--OPBS.                                                 ELCDTERX
  1452                                                                  ELCDTERX
  1453     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1454                                                                  ELCDTERX
  1455     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1456             OR                                                   ELCDTERX
  1457         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1458         GO TO 0005-READ--CARD.                                   ELCDTERX
  1459                                                                  ELCDTERX
  1460     ADD 1                       TO INDEXBS.                      ELCDTERX
  1461     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1462     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1463                                                                  ELCDTERX
  1464 0079-READ--EXIT.                                                 ELCDTERX
  1465*    EXIT.                                                        ELCDTERX
  1466******************************************************************ELCDTERX
  1467                                                                     CL**1
  1468     IF DTE-CLIENT = 'UAL'                                           CL**1
  1469         MOVE 9 TO DTE-PGM-OPT.                                      CL**1
  1470                                                                     CL**1
  1471     MOVE COMPANY-NAME           TO HD-1-COMP.                       CL**1
  1472     MOVE SPACES                 TO HD-2-AREA.                       CL**3
  1473     MOVE SPACES                 TO HD-4-AREA.                       CL**3
  1474                                                                     CL**3
  1475     IF DTE-PGM-OPT = 9                                              CL**1
  1476         MOVE  WS-CURRENT-DATE   TO HD-4-IPL                         CL**3
  1477     ELSE                                                            CL**1
  1478         MOVE WS-CURRENT-DATE    TO HD-2-IPL.                        CL**3
  1479                                                                     CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  35
* ECS151.cbl
  1481 0120-OPEN-FILES.                                                    CL**1
  1482     OPEN INPUT EXTR-IN  OUTPUT PRT-FILE.                            CL**1
  1483     PERFORM 0510-CLEAR-WORK-TABLES THRU 0520-C-W-EXIT.              CL**1
  1484                                                                     CL**1
  1485 0130-SORT-PROCEDURE.                                                CL**1
  1486     SORT SORT-FILE ASCENDING SORT-KEY                               CL**1
  1487         INPUT PROCEDURE 0150-GET-EXTRACT THRU 0160-GET-EXIT         CL**1
  1488         OUTPUT PROCEDURE 0180-READ-EXTRACT THRU 0910-EOJ-EXIT.      CL**1
  1489                                                                     CL**1
  1490     IF SORT-RETURN NOT = ZEROS                                      CL**3
  1491         MOVE '0101'             TO ABEND-CODE                       CL**1
  1492         GO TO ABEND-PGM.                                            CL**1
  1493                                                                     CL**1
  1494     MOVE ZEROS  TO RETURN-CODE.
  1495     GOBACK.                                                         CL**1
  1496                                                                     CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  36
* ECS151.cbl
  1498 0150-GET-EXTRACT  SECTION.                                          CL**1
  1499     READ EXTR-IN AT END                                             CL**1
  1500         CLOSE EXTR-IN                                               CL**1
  1501         GO TO 0160-GET-EXIT.                                        CL**1
  1502                                                                     CL**1
  1503     MOVE EXTR-RECORD-BODY TO SORT-RECORD-BODY.                      CL**1
  1504     MOVE EX-REINS-CO      TO SR-REINS-CO.                           CL**1
  1505     MOVE EX-CARRIER       TO SR-CARRIER.                            CL**1
  1506     MOVE EX-COMPANY       TO SR-COMPANY.                            CL**1
  1507     MOVE EX-STATE         TO SR-STATE.                              CL**1
  1508     MOVE EX-ACCOUNT       TO SR-ACCOUNT.                            CL**1
  1509     MOVE EX-ST-SEQ        TO SR-ST-SEQ.                             CL**1
  1510     MOVE EX-REC-TYPE      TO SR-REC-TYPE.                           CL**1
  1511     MOVE EX-PERIOD-START  TO SR-PERIOD-START.                       CL**1
  1512     MOVE EX-PERIOD-END    TO SR-PERIOD-END.                         CL**1
  1513                                                                     CL**1
  1514     IF DTE-PGM-OPT = 9                                              CL**1
  1515         MOVE EX-STATE  TO SR-STATE-SEQ                              CL**1
  1516     ELSE                                                            CL**1
  1517         MOVE SPACES    TO SR-STATE-SEQ.                             CL**1
  1518                                                                     CL**1
  1519     RELEASE SORT-REC.                                               CL**1
  1520     GO TO 0150-GET-EXTRACT.                                         CL**1
  1521                                                                     CL**1
  1522 0160-GET-EXIT.                                                      CL**3
  1523     EXIT.                                                           CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  37
* ECS151.cbl
  1525 0180-READ-EXTRACT  SECTION.                                         CL**1
  1526     RETURN SORT-FILE INTO THE-RECORD AT END                         CL**1
  1527         MOVE 'Y'                TO EOJ-SW                           CL**1
  1528         GO TO 0230-CONTROL-BREAK.                                   CL**1
  1529                                                                     CL**1
  1530     IF DTE-PGM-OPT = 1                                              CL**3
  1531         GO TO 0190-SET-CONTROL.                                     CL**3
  1532                                                                     CL**3
  1533     IF DTE-PGM-OPT = 2                                              CL**1
  1534         IF ER-REC-TYPE = 01 OR 02                                   CL**1
  1535             GO TO 0180-READ-EXTRACT                                 CL**1
  1536         ELSE                                                        CL**3
  1537             GO TO 0190-SET-CONTROL.                                 CL**1
  1538                                                                     CL**1
  1539     IF DTE-PGM-OPT = 3                                              CL**1
  1540         IF DTE-CLIENT = 'CVL'                                       CL**1
  1541             IF ER-REC-TYPE LESS THAN 07                             CL**1
  1542                 GO TO 0180-READ-EXTRACT                             CL**1
  1543             ELSE                                                    CL**1
  1544                 GO TO 0190-SET-CONTROL                              CL**1
  1545         ELSE                                                        CL**1
  1546             IF ER-REC-TYPE LESS THAN 11                             CL**1
  1547                 GO TO 0180-READ-EXTRACT                             CL**1
  1548             ELSE                                                    CL**1
  1549                 GO TO 0190-SET-CONTROL.                             CL**1
  1550                                                                     CL**1
  1551     IF DTE-PGM-OPT = 4                                              CL**1
  1552         IF ER-REC-TYPE = 02 OR 04 OR 06 OR 08 OR                    CL**1
  1553             10 OR 12 OR 14                                          CL**1
  1554             GO TO 0180-READ-EXTRACT                                 CL**3
  1555         ELSE                                                        CL**3
  1556             GO TO 0190-SET-CONTROL.                                 CL**3
  1557                                                                     CL**3
  1558     IF DTE-PGM-OPT = 5                                              CL**1
  1559         IF ER-REC-TYPE = 01 OR 02 OR 04 OR 06 OR                    CL**1
  1560             08 OR 10 OR 12 OR 14                                    CL**1
  1561             GO TO 0180-READ-EXTRACT                                 CL**3
  1562         ELSE                                                        CL**3
  1563             GO TO 0190-SET-CONTROL.                                 CL**3
  1564                                                                     CL**3
  1565     IF DTE-PGM-OPT = 6                                              CL**1
  1566         IF ER-REC-TYPE = 11 OR 13                                   CL**1
  1567             GO TO 0190-SET-CONTROL                                  CL**1
  1568         ELSE                                                        CL**3
  1569             GO TO 0180-READ-EXTRACT.                                CL**1
  1570                                                                     CL**3
  1571     IF DTE-PGM-OPT = 7                                              CL**1
  1572         IF ER-REC-TYPE = 01 OR 03 OR 05 OR                          CL**1
  1573             07 OR 09 OR 11 OR 13                                    CL**1
  1574             GO TO 0180-READ-EXTRACT                                 CL**3
  1575         ELSE                                                        CL**3
  1576             GO TO 0190-SET-CONTROL.                                 CL**3
  1577                                                                     CL**3
  1578     IF DTE-PGM-OPT = 8                                              CL**1
  1579         IF ER-REC-TYPE = 01 OR 02 OR 03 OR 05 OR                    CL**1
  1580             07 OR 09 OR 11 OR 13                                    CL**1
  1581             GO TO 0180-READ-EXTRACT                                 CL**3
  1582         ELSE                                                        CL**3
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  38
* ECS151.cbl
  1583             GO TO 0190-SET-CONTROL.                                 CL**3
  1584                                                                     CL**3
  1585     IF DTE-PGM-OPT = 9                                              CL**1
  1586         IF ER-REC-TYPE = 07 OR 08 OR 11 OR 12 OR 13 OR 14           CL**1
  1587             GO TO 0190-SET-CONTROL                                  CL**1
  1588         ELSE                                                        CL**5
  1589             GO TO 0180-READ-EXTRACT.                                CL**1
  1590                                                                     CL**3
  1591     DISPLAY 'PROGRAM OPTION SWITCH = ' DTE-PGM-OPT.                 CL**1
  1592     MOVE '0301'                 TO ABEND-CODE.                      CL**1
  1593     GO TO ABEND-PGM.                                                CL**1
  1594                                                                     CL**1
  1595 0190-SET-CONTROL.                                                   CL**1
  1596                                                                     CL**1
  1597     IF FIRST-READ = 'Y'                                             CL**1
  1598         MOVE ER-SORT-KEY        TO CONTROL-AREA                     CL**1
  1599         MOVE ER-PERIOD-START    TO CNTRL-START                      CL**1
  1600         MOVE ER-PERIOD-END      TO CNTRL-END                        CL**1
  1601         MOVE 'N'                TO FIRST-READ.                      CL**1
  1602                                                                     CL**1
  1603 0200-CHECK-SEQUENCE.                                                CL**1
  1604     IF ER-SORT-KEY LESS CONTROL-AREA                                CL**1
  1605         DISPLAY 'ECS151 - SEQUENCE ERROR PROGRAM TERMINATED'        CL**1
  1606         MOVE '0610'             TO ABEND-CODE                       CL**1
  1607         GO TO ABEND-PGM.                                            CL**1
  1608                                                                     CL**1
  1609     IF ER-SORT-KEY NOT EQUAL CONTROL-AREA                           CL**1
  1610         GO TO 0230-CONTROL-BREAK.                                   CL**1
  1611                                                                     CL**1
  1612 0210-ACCUM-AMOUNTS.                                                 CL**1
  1613     PERFORM 0320-ADD-UP-DETAIL THRU 0330-ADD-DETAIL-EXIT            CL**1
  1614         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER               CL**1
  1615             Z FROM 1 BY 1 UNTIL Z GREATER 10.                       CL**1
  1616                                                                     CL**1
  1617     PERFORM 0340-ADD-UP-A-H THRU 0350-ADD-AH-EXIT                   CL**1
  1618         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER               CL**1
  1619             Z FROM 1 BY 1 UNTIL Z GREATER 9.                        CL**1
  1620                                                                     CL**1
  1621     ADD ER-AH-PD-THIS TO TOT-AH-PD-THIS.                            CL**1
  1622     ADD ER-AH-PD-LAST TO TOT-AH-PD-LAST.                            CL**1
  1623                                                                     CL**1
  1624     GO TO 0180-READ-EXTRACT.                                        CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  39
* ECS151.cbl
  1626 0230-CONTROL-BREAK.                                                 CL**1
  1627     MOVE '*                   ' TO  HD-2-CARRIER                    CL**3
  1628                                     HD-3-COMPANY                    CL**3
  1629                                     HD-4-STATE                      CL**3
  1630                                     HD-5-ACCOUNT.                   CL**3
  1631                                                                     CL**1
  1632     IF EOJ-SW = 'Y' AND PRINT-SW = SPACE                            CL**3
  1633         GO TO 0890-NO-PRINT.                                        CL**3
  1634                                                                     CL**1
  1635     MOVE CNTRL-STATE            TO STATE-INDEX.                     CL**1
  1636                                                                     CL**1
  1637     IF CNTRL-REC-TYPE LESS 03                                       CL**1
  1638         MOVE 'ACCOUNT              ' TO HD-1-MSG                    CL**1
  1639         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                     CL**1
  1640         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                     CL**1
  1641         PERFORM 0600-FIND-STATE THRU 0620-FIND-S-EXIT               CL**1
  1642         MOVE CNTRL-ACCOUNT      TO HD-5-ACCOUNT                     CL**1
  1643         GO TO 0250-END-BREAK.                                       CL**1
  1644                                                                     CL**1
  1645     IF CNTRL-REC-TYPE LESS 05                                       CL**1
  1646         MOVE 'STATE                ' TO HD-1-MSG                    CL**1
  1647         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                     CL**1
  1648         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                     CL**1
  1649         PERFORM 0600-FIND-STATE THRU 0620-FIND-S-EXIT               CL**1
  1650         GO TO 0250-END-BREAK.                                       CL**1
  1651                                                                     CL**1
  1652     IF CNTRL-REC-TYPE LESS 07                                       CL**1
  1653         MOVE 'COMPANY              ' TO HD-1-MSG                    CL**1
  1654         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                     CL**1
  1655         MOVE CNTRL-COMPANY      TO HD-3-COMPANY                     CL**1
  1656         GO TO 0250-END-BREAK.                                       CL**1
  1657                                                                     CL**1
  1658     IF CNTRL-REC-TYPE LESS 09                                       CL**1
  1659         IF DTE-PGM-OPT = 9                                          CL**1
  1660             MOVE 'STATE / CARRIER      ' TO HD-1-MSG                CL**1
  1661             MOVE CNTRL-CARRIER      TO HD-2-CARRIER                 CL**1
  1662             PERFORM 0600-FIND-STATE THRU 0620-FIND-S-EXIT           CL**1
  1663             GO TO 0250-END-BREAK                                    CL**1
  1664         ELSE                                                        CL**1
  1665             MOVE 'CARRIER / STATE      ' TO HD-1-MSG                CL**1
  1666             MOVE CNTRL-CARRIER      TO HD-2-CARRIER                 CL**1
  1667             PERFORM 0600-FIND-STATE THRU 0620-FIND-S-EXIT           CL**1
  1668             GO TO 0250-END-BREAK.                                   CL**1
  1669                                                                     CL**1
  1670     IF CNTRL-REC-TYPE LESS 11                                       CL**1
  1671         MOVE 'CARRIER              ' TO HD-1-MSG                    CL**1
  1672         MOVE CNTRL-CARRIER      TO HD-2-CARRIER                     CL**1
  1673         GO TO 0250-END-BREAK.                                       CL**1
  1674                                                                     CL**1
  1675     IF CNTRL-REC-TYPE LESS 13                                       CL**1
  1676         MOVE 'GRAND TOTAL          ' TO HD-1-MSG                    CL**1
  1677         GO TO 0250-END-BREAK.                                       CL**1
  1678                                                                     CL**1
  1679     MOVE 'STATE OVERALL        ' TO HD-1-MSG.                       CL**1
  1680     MOVE CNTRL-ST-SEQ           TO STATE-INDEX.                     CL**1
  1681     PERFORM 0600-FIND-STATE THRU 0620-FIND-S-EXIT.                  CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  40
* ECS151.cbl
  1683 0250-END-BREAK.                                                     CL**1
  1684     MOVE CNTRL-START            TO WS-WORK-DATE.                    CL**1
  1685     MOVE WS-DAY                 TO HD-5-DAY.                        CL**1
  1686     MOVE WS-YEAR                TO HD-5-YEAR.                       CL**1
  1687     MOVE WS-CENT                TO HD-5-CENT.                       CL**9
  1688     MOVE MONTH-ALPHA (WS-MONTH) TO HD-5-MONTH.                      CL**1
  1689                                                                     CL**1
  1690     MOVE CNTRL-END              TO WS-WORK-DATE.                    CL**1
  1691     MOVE WS-DAY                 TO HD-6-DAY.                        CL**1
  1692     MOVE WS-CENT                TO HD-6-CENT.                       CL**9
  1693     MOVE WS-YEAR                TO HD-6-YEAR.                       CL**9
  1694     MOVE MONTH-ALPHA (WS-MONTH) TO HD-6-MONTH.                      CL**1
  1695                                                                     CL**1
  1696     IF CNTRL-REC-TYPE = 01 OR 03 OR 05 OR 07 OR 09 OR 11 OR 13      CL**1
  1697         MOVE HD-MSG1            TO HD-3-MSG                         CL**1
  1698     ELSE                                                            CL**1
  1699         MOVE HD-MSG2            TO HD-3-MSG.                        CL**1
  1700                                                                     CL**1
  1701     PERFORM 0370-ACCUMULATE-1-120 THRU 0380-A-1-120-EXIT            CL**1
  1702         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 10.                   CL**1
  1703                                                                     CL**1
  1704     PERFORM 0390-ADD-3-AH-LEVELS THRU 0400-ADD-3-EXIT               CL**1
  1705         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 9 AFTER               CL**1
  1706             Y FROM 1 BY 1 UNTIL Y GREATER 3.                        CL**1
  1707                                                                     CL**1
  1708     MOVE +1                      TO Y.                              CL**1
  1709     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1710         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                    CL**1
  1711     MOVE DO-PRINT                TO R-SW-G (Y).                     CL**1
  1712                                                                     CL**1
  1713     MOVE +2                     TO Y.                               CL**1
  1714     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1715         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                    CL**1
  1716     MOVE DO-PRINT               TO R-SW-G (Y).                      CL**1
  1717                                                                     CL**1
  1718     MOVE +3                     TO Y.                               CL**1
  1719     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1720         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 5.                    CL**1
  1721     MOVE DO-PRINT               TO R-SW-G (Y).                      CL**1
  1722                                                                     CL**1
  1723     MOVE +1                     TO Y.                               CL**1
  1724     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1725         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                   CL**1
  1726     MOVE DO-PRINT               TO R-SW-I (Y).                      CL**1
  1727                                                                     CL**1
  1728     MOVE +2                     TO Y.                               CL**1
  1729     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1730         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                   CL**1
  1731     MOVE DO-PRINT               TO R-SW-I (Y).                      CL**1
  1732                                                                     CL**1
  1733     MOVE +3                     TO Y.                               CL**1
  1734     PERFORM 0740-CHECK-FOR-PRINT THRU 0750-CHECK-PRINT-EXIT         CL**1
  1735         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 10.                   CL**1
  1736     MOVE DO-PRINT               TO R-SW-I (Y).                      CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  41
* ECS151.cbl
  1738                                                                     CL**1
  1739 0270-CONTROL-BREAK-PRINT.                                           CL**1
  1740     MOVE HD-MSG4                TO HD-3-TITLE.                      CL**1
  1741     IF R-SW-G (1) = SPACE AND R-SW-G (2) = SPACE AND                CL**1
  1742        R-SW-G (3) = SPACE AND R-SW-I (1) = SPACE AND                CL**3
  1743        R-SW-I (2) = SPACE AND R-SW-I (3) = SPACE                    CL**3
  1744         GO TO 0300-CONTROL-4.                                       CL**3
  1745                                                                     CL**1
  1746     IF PRINT-SW = SPACE                                             CL**3
  1747         MOVE 'Y'                TO PRINT-SW.                        CL**3
  1748                                                                     CL**1
  1749     PERFORM 0640-PRINT-HEADINGS THRU 0650-P-H-X.                    CL**1
  1750                                                                     CL**1
  1751     IF R-SW-G (1) = SPACE AND R-SW-G (2) = SPACE AND                CL**1
  1752        R-SW-G (3) = SPACE                                           CL**3
  1753         GO TO 0280-CONTROL-2.                                       CL**3
  1754                                                                     CL**1
  1755     PERFORM 0770-DUMP-PAGE-1 THRU 0790-DUMP-1-EXIT                  CL**1
  1756         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3.                    CL**1
  1757                                                                     CL**1
  1758     IF R-SW-I (1) = SPACE AND R-SW-I (2) = SPACE AND                CL**1
  1759         R-SW-I (3) = SPACE                                          CL**1
  1760             MOVE +3             TO Y                                CL**1
  1761             PERFORM 0830-DUMP-2-FINAL THRU 0840-DUMP-2-EXIT         CL**1
  1762             GO TO 0290-CONTROL-3.                                   CL**1
  1763                                                                     CL**1
  1764     PERFORM 0640-PRINT-HEADINGS THRU 0650-P-H-X.                    CL**1
  1765                                                                     CL**1
  1766 0280-CONTROL-2.                                                     CL**1
  1767     PERFORM 0810-DUMP-PAGE-2 THRU 0840-DUMP-2-EXIT                  CL**1
  1768         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3.                    CL**1
  1769                                                                     CL**1
  1770 0290-CONTROL-3.                                                     CL**1
  1771     MOVE HD-MSG5                TO HD-3-TITLE.                      CL**1
  1772     PERFORM 0640-PRINT-HEADINGS THRU 0650-P-H-X.                    CL**1
  1773     PERFORM 0860-DUMP-PAGE-3 THRU 0870-DUMP-3-EXIT.                 CL**1
  1774                                                                     CL**1
  1775 0300-CONTROL-4.                                                     CL**1
  1776     MOVE 'Y'                    TO FIRST-READ.                      CL**1
  1777                                                                     CL**1
  1778     IF EOJ-SW = 'Y'                                                 CL**1
  1779         GO TO 0900-END-JOB.                                         CL**1
  1780                                                                     CL**1
  1781     PERFORM 0510-CLEAR-WORK-TABLES THRU 0520-C-W-EXIT.              CL**1
  1782     GO TO 0190-SET-CONTROL.                                         CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  42
* ECS151.cbl
  1784*                                                                    CL**1
  1785*        PERFORMED PROCEDURES NEXT                                   CL**1
  1786*                                                                    CL**1
  1787 0320-ADD-UP-DETAIL.                                                 CL**1
  1788     ADD ER-ISSUE-CNT   (Y, Z) TO TBL-ISSUE-CNT   (Y, Z).            CL**3
  1789     ADD ER-ISSUE-AMT   (Y, Z) TO TBL-ISSUE-AMT   (Y, Z).            CL**3
  1790     ADD ER-ISSUE-PREM  (Y, Z) TO TBL-ISSUE-PREM  (Y, Z).            CL**3
  1791     ADD ER-CANCEL-CNT  (Y, Z) TO TBL-CANCEL-CNT  (Y, Z).            CL**3
  1792     ADD ER-CANCEL-AMT  (Y, Z) TO TBL-CANCEL-AMT  (Y, Z).            CL**3
  1793     ADD ER-CANCEL-PREM (Y, Z) TO TBL-CANCEL-PREM (Y, Z).            CL**1
  1794     ADD ER-CLAIM-CNT   (Y, Z) TO TBL-CLAIM-CNT   (Y, Z).            CL**3
  1795     ADD ER-CLAIM-AMT   (Y, Z) TO TBL-CLAIM-AMT   (Y, Z).            CL**3
  1796     ADD ER-EARN-PREM   (Y, Z) TO TBL-EARN-PREM   (Y, Z).            CL**3
  1797 0330-ADD-DETAIL-EXIT.                                               CL**1
  1798     EXIT.                                                           CL**1
  1799                                                                     CL**1
  1800 0340-ADD-UP-A-H.                                                    CL**1
  1801     ADD ER-GROUP-CNT (Y, Z) TO TBL-GRP-CNT (Y, Z).                  CL**1
  1802     ADD ER-GROUP-AMT (Y, Z) TO TBL-GRP-AMT (Y, Z).                  CL**1
  1803     ADD ER-IND-CNT   (Y, Z) TO TBL-IND-CNT (Y, Z).                  CL**1
  1804     ADD ER-IND-AMT   (Y, Z) TO TBL-IND-AMT (Y, Z).                  CL**1
  1805 0350-ADD-AH-EXIT.                                                   CL**1
  1806     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  43
* ECS151.cbl
  1808                                                                     CL**3
  1809 0370-ACCUMULATE-1-120.                                              CL**1
  1810     ADD TBL-ISSUE-CNT   (2, Z)   TO TBL-ISSUE-CNT   (1, Z).         CL**1
  1811     ADD TBL-ISSUE-AMT   (2, Z)   TO TBL-ISSUE-AMT   (1, Z).         CL**1
  1812     ADD TBL-ISSUE-PREM  (2, Z)   TO TBL-ISSUE-PREM  (1, Z).         CL**1
  1813     ADD TBL-CANCEL-CNT  (2, Z)   TO TBL-CANCEL-CNT  (1, Z).         CL**1
  1814     ADD TBL-CANCEL-AMT  (2, Z)   TO TBL-CANCEL-AMT  (1, Z).         CL**1
  1815     ADD TBL-CANCEL-PREM (2, Z)   TO TBL-CANCEL-PREM (1, Z).         CL**1
  1816     ADD TBL-CLAIM-CNT   (2, Z)   TO TBL-CLAIM-CNT   (1, Z).         CL**1
  1817     ADD TBL-CLAIM-AMT   (2, Z)   TO TBL-CLAIM-AMT   (1, Z).         CL**1
  1818     ADD TBL-EARN-PREM   (2, Z)   TO TBL-EARN-PREM   (1, Z).         CL**1
  1819 0380-A-1-120-EXIT.                                                  CL**1
  1820     EXIT.                                                           CL**1
  1821                                                                     CL**1
  1822 0390-ADD-3-AH-LEVELS.                                               CL**1
  1823     ADD TBL-GRP-CNT (Y, Z) TO T3-GRP-CNT (Z).                       CL**1
  1824     ADD TBL-GRP-AMT (Y, Z) TO T3-GRP-AMT (Z).                       CL**1
  1825     ADD TBL-IND-CNT (Y, Z) TO T3-IND-CNT (Z).                       CL**1
  1826     ADD TBL-IND-AMT (Y, Z) TO T3-IND-AMT (Z).                       CL**1
  1827 0400-ADD-3-EXIT.                                                    CL**1
  1828     EXIT.                                                           CL**1
  1829                                                                     CL**1
  1830 0410-ADD-SUB-TOTALS.                                                CL**1
  1831     ADD TBL-ISSUE-CNT   (Y, Z) TO G1-ISS-CNT   T1-ISS-CNT.          CL**1
  1832     ADD TBL-ISSUE-AMT   (Y, Z) TO G1-ISS-AMT   T1-ISS-AMT.          CL**1
  1833     ADD TBL-ISSUE-PREM  (Y, Z) TO G1-ISS-PRM   T1-ISS-PRM.          CL**1
  1834     ADD TBL-CANCEL-CNT  (Y, Z) TO G1-CAN-CNT   T1-CAN-CNT.          CL**1
  1835     ADD TBL-CANCEL-AMT  (Y, Z) TO G1-CAN-AMT   T1-CAN-AMT.          CL**1
  1836     ADD TBL-CANCEL-PREM (Y, Z) TO G1-CAN-PRM   T1-CAN-PRM.          CL**1
  1837     ADD TBL-CLAIM-CNT   (Y, Z) TO G1-CLM-CNT   T1-CLM-CNT.          CL**1
  1838     ADD TBL-CLAIM-AMT   (Y, Z) TO G1-CLM-AMT   T1-CLM-AMT.          CL**1
  1839     ADD TBL-EARN-PREM   (Y, Z) TO G1-ERN-PRM   T1-ERN-PRM.          CL**1
  1840 0420-ADD-SUB-EXIT.                                                  CL**1
  1841     EXIT.                                                           CL**1
  1842                                                                     CL**4
  1843 0440-BUILD-DETAIL-1.                                                CL**1
  1844     MOVE TBL-ISSUE-CNT   (Y, Z) TO D1-ISS-CNT.                      CL**1
  1845     MOVE TBL-ISSUE-AMT   (Y, Z) TO D1-ISS-AMT.                      CL**1
  1846     MOVE TBL-ISSUE-PREM  (Y, Z) TO D1-ISS-PRM.                      CL**1
  1847     MOVE TBL-CANCEL-CNT  (Y, Z) TO D1-CAN-CNT.                      CL**1
  1848     MOVE TBL-CANCEL-AMT  (Y, Z) TO D1-CAN-AMT.                      CL**1
  1849     MOVE TBL-CANCEL-PREM (Y, Z) TO D1-CAN-PRM.                      CL**1
  1850     MOVE TBL-CLAIM-CNT   (Y, Z) TO D1-CLM-CNT.                      CL**1
  1851     MOVE TBL-CLAIM-AMT   (Y, Z) TO D1-CLM-AMT.                      CL**1
  1852     MOVE TBL-EARN-PREM   (Y, Z) TO D1-ERN-AMT.                      CL**1
  1853 0450-BUILD-D-EXIT.                                                  CL**1
  1854     EXIT.                                                           CL**1
  1855                                                                     CL**1
  1856 0460-BUILD-DETAIL-2.                                                CL**1
  1857     MOVE T3-GRP-CNT (Z)         TO D2-GRP-CNT.                      CL**1
  1858     MOVE T3-GRP-AMT (Z)         TO D2-GRP-AMT.                      CL**1
  1859     MOVE T3-IND-CNT (Z)         TO D2-IND-CNT.                      CL**1
  1860     MOVE T3-IND-AMT (Z)         TO D2-IND-AMT.                      CL**1
  1861 0470-BUILD-2-EXIT.                                                  CL**1
  1862     EXIT.                                                           CL**1
  1863                                                                     CL**1
  1864 0480-BUILD-DETAIL-2A.                                               CL**1
  1865     MOVE TBL-GRP-CNT (Y, Z)     TO D2-GRP-CNT.                      CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  44
* ECS151.cbl
  1866     MOVE TBL-GRP-AMT (Y, Z)     TO D2-GRP-AMT.                      CL**1
  1867     MOVE TBL-IND-CNT (Y, Z)     TO D2-IND-CNT.                      CL**1
  1868     MOVE TBL-IND-AMT (Y, Z)     TO D2-IND-AMT.                      CL**1
  1869 0490-BUILD-2A-EXIT.                                                 CL**1
  1870     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  45
* ECS151.cbl
  1872 0510-CLEAR-WORK-TABLES.                                             CL**1
  1873     PERFORM 0530-ZERO-TABLE-1 THRU 0540-Z-T1-EXIT                   CL**1
  1874         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER               CL**1
  1875             Z FROM 1 BY 1 UNTIL Z GREATER 10.                       CL**1
  1876                                                                     CL**1
  1877     PERFORM 0550-ZERO-TABLE-2 THRU 0560-Z-T2-EXIT                   CL**1
  1878         VARYING Y FROM 1 BY 1 UNTIL Y GREATER 3 AFTER               CL**1
  1879             Z FROM 1 BY 1 UNTIL Z GREATER 9.                        CL**1
  1880                                                                     CL**1
  1881     PERFORM 0570-ZERO-TABLE-3 THRU 0580-Z-T3-EXIT                   CL**1
  1882         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 9.                    CL**1
  1883                                                                     CL**1
  1884     MOVE +0                     TO TOT-AH-PD-THIS                   CL**4
  1885                                    TOT-AH-PD-LAST.                  CL**4
  1886 0520-C-W-EXIT.                                                      CL**1
  1887     EXIT.                                                           CL**1
  1888                                                                     CL**1
  1889 0530-ZERO-TABLE-1.                                                  CL**1
  1890     MOVE ZERO-FIELDS-1          TO TABLE-1-DTL (Y, Z).              CL**1
  1891 0540-Z-T1-EXIT.                                                     CL**1
  1892     EXIT.                                                           CL**1
  1893                                                                     CL**1
  1894 0550-ZERO-TABLE-2.                                                  CL**1
  1895     MOVE ZERO-FIELDS-2          TO TBL-2-DTL (Y, Z).                CL**1
  1896 0560-Z-T2-EXIT.                                                     CL**1
  1897     EXIT.                                                           CL**1
  1898                                                                     CL**1
  1899 0570-ZERO-TABLE-3.                                                  CL**1
  1900     MOVE ZERO-FIELDS-2          TO TABLE-3-GRP (Z).                 CL**1
  1901 0580-Z-T3-EXIT.                                                     CL**1
  1902     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  46
* ECS151.cbl
  1904                                                                     CL**4
  1905 0600-FIND-STATE.                                                    CL**1
  1906     MOVE +1                     TO Y.                               CL**1
  1907 0610-FIND-STATE-NOW.                                                CL**1
  1908     IF Y GREATER +75                                                CL**1
  1909         MOVE 'UNKNOWN             ' TO HD-4-STATE                   CL**1
  1910         GO TO 0620-FIND-S-EXIT.                                     CL**1
  1911                                                                     CL**1
  1912     IF STATE-INDEX = STATE-SUB (Y) OR STATE-ABBR (Y)                CL**1
  1913         MOVE STATE-PIC (Y)      TO HD-4-STATE                       CL**1
  1914         GO TO 0620-FIND-S-EXIT.                                     CL**1
  1915                                                                     CL**1
  1916     ADD +1 TO Y.                                                    CL**1
  1917     GO TO 0610-FIND-STATE-NOW.                                      CL**1
  1918 0620-FIND-S-EXIT.                                                   CL**1
  1919     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  47
* ECS151.cbl
  1921                                                                     CL**4
  1922 0640-PRINT-HEADINGS.                                                CL**1
  1923     ADD 1 TO PAGE-CNT.                                              CL**1
  1924                                                                     CL**1
  1925     IF DTE-PGM-OPT = 9                                              CL**1
  1926         MOVE PAGE-CNT           TO HD-2-PAGE                        CL**1
  1927         MOVE 'PAGE '            TO HD-2-PAGE-LIT                    CL**1
  1928     ELSE                                                            CL**1
  1929         MOVE PAGE-CNT           TO HD-4-PAGE                        CL**1
  1930         MOVE 'PAGE '            TO HD-4-PAGE-LIT.                   CL**1
  1931                                                                     CL**4
  1932     MOVE HD-1                   TO PRT.                             CL**1
  1933     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  1934                                                                     CL**4
  1935     IF DTE-PGM-OPT = 9                                              CL**1
  1936         MOVE HD-4                   TO PRT                          CL**1
  1937         PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X                    CL**1
  1938         MOVE HD-3                   TO PRT                          CL**1
  1939         PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X                    CL**1
  1940         MOVE HD-2                   TO PRT                          CL**1
  1941     ELSE                                                            CL**1
  1942         MOVE HD-2                   TO PRT                          CL**1
  1943         PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X                    CL**1
  1944         MOVE HD-3                   TO PRT                          CL**1
  1945         PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X                    CL**1
  1946         MOVE HD-4                   TO PRT.                         CL**1
  1947                                                                     CL**4
  1948     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  1949     MOVE HD-5                   TO PRT.                             CL**1
  1950     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  1951     MOVE HD-6                   TO PRT.                             CL**1
  1952     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  1953 0650-P-H-X.                                                         CL**1
  1954     EXIT.                                                           CL**1
  1955                                                                     CL**1
  1956                                                                     CL**1
  1957 0660-PRT-RTN.                                                       CL**1
  1958     IF DTE-FICH IS NOT EQUAL TO SPACE AND                           CL**1
  1959         FICH-OPEN IS EQUAL TO SPACE                                 CL**1
  1960         OPEN OUTPUT FICH                                            CL**1
  1961         MOVE 'X'                TO FICH-OPEN.                       CL**1
  1962                                                                     CL**1
  1963     IF DTE-FICH IS NOT EQUAL TO SPACE                               CL**1
  1964         WRITE FICH-REC FROM PRT.                                    CL**1
  1965                                                                     CL**1
  1966     IF DTE-FICH IS EQUAL TO SPACE OR '2'                            CL**1
  1967         MOVE P-CTL TO LCP-ASA                                       CL**1
  1968         PERFORM LCP-WRITE-POS-PRT                                   CL**1
  1969             THRU LCP-WRITE-END-PRT.                                 CL**1
  1970                                                                     CL**1
  1971 0670-PRT-RTN-X.                                                     CL**1
  1972     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  48
* ECS151.cbl
  1974 0690-MOVE-G1-TO-PRINT.                                              CL**1
  1975     MOVE G1-ISS-CNT             TO D1-ISS-CNT.                      CL**1
  1976     MOVE G1-ISS-AMT             TO D1-ISS-AMT.                      CL**1
  1977     MOVE G1-ISS-PRM             TO D1-ISS-PRM.                      CL**1
  1978     MOVE G1-CAN-CNT             TO D1-CAN-CNT.                      CL**1
  1979     MOVE G1-CAN-AMT             TO D1-CAN-AMT.                      CL**1
  1980     MOVE G1-CAN-PRM             TO D1-CAN-PRM.                      CL**1
  1981     MOVE G1-CLM-CNT             TO D1-CLM-CNT.                      CL**1
  1982     MOVE G1-CLM-AMT             TO D1-CLM-AMT.                      CL**1
  1983     MOVE G1-ERN-PRM             TO D1-ERN-AMT.                      CL**1
  1984 0700-MOVE-G1-EXIT.                                                  CL**1
  1985     EXIT.                                                           CL**1
  1986                                                                     CL**1
  1987 0710-MOVE-T1-TO-PRINT.                                              CL**1
  1988     MOVE T1-ISS-CNT             TO D1-ISS-CNT.                      CL**1
  1989     MOVE T1-ISS-AMT             TO D1-ISS-AMT.                      CL**1
  1990     MOVE T1-ISS-PRM             TO D1-ISS-PRM.                      CL**1
  1991     MOVE T1-CAN-CNT             TO D1-CAN-CNT.                      CL**1
  1992     MOVE T1-CAN-AMT             TO D1-CAN-AMT.                      CL**1
  1993     MOVE T1-CAN-PRM             TO D1-CAN-PRM.                      CL**1
  1994     MOVE T1-CLM-CNT             TO D1-CLM-CNT.                      CL**1
  1995     MOVE T1-CLM-AMT             TO D1-CLM-AMT.                      CL**1
  1996     MOVE T1-ERN-PRM             TO D1-ERN-AMT.                      CL**1
  1997 0720-MOVE-T1-EXIT.                                                  CL**1
  1998     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  49
* ECS151.cbl
  2000                                                                     CL**4
  2001 0740-CHECK-FOR-PRINT.                                               CL**1
  2002     MOVE SPACE TO DO-PRINT.                                         CL**1
  2003                                                                     CL**4
  2004     IF TBL-ISSUE-CNT (Y, Z) NOT = +0                                CL**1
  2005         MOVE 'Y'                TO DO-PRINT                         CL**1
  2006         MOVE +11                TO Z                                CL**1
  2007         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2008                                                                     CL**1
  2009     IF TBL-ISSUE-AMT (Y, Z) NOT = +0                                CL**1
  2010         MOVE 'Y'                TO DO-PRINT                         CL**1
  2011         MOVE +11                TO Z                                CL**1
  2012         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2013                                                                     CL**1
  2014     IF TBL-ISSUE-PREM (Y, Z) NOT = +0                               CL**1
  2015         MOVE 'Y'                TO DO-PRINT                         CL**1
  2016         MOVE +11                TO Z                                CL**1
  2017         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2018                                                                     CL**1
  2019     IF TBL-CANCEL-CNT (Y, Z) NOT = +0                               CL**1
  2020         MOVE 'Y'                TO DO-PRINT                         CL**1
  2021         MOVE +11                TO Z                                CL**1
  2022         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2023                                                                     CL**1
  2024     IF TBL-CANCEL-AMT (Y, Z) NOT = +0                               CL**1
  2025         MOVE 'Y'                TO DO-PRINT                         CL**1
  2026         MOVE +11                TO Z                                CL**1
  2027         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2028                                                                     CL**1
  2029     IF TBL-CANCEL-PREM (Y, Z) NOT = +0                              CL**1
  2030         MOVE 'Y'                TO DO-PRINT                         CL**1
  2031         MOVE +11                TO Z                                CL**1
  2032         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2033                                                                     CL**1
  2034     IF TBL-CLAIM-CNT (Y, Z) NOT = +0                                CL**1
  2035         MOVE 'Y'                TO DO-PRINT                         CL**1
  2036         MOVE +11                TO Z                                CL**1
  2037         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2038                                                                     CL**1
  2039     IF TBL-CLAIM-AMT (Y, Z) NOT = +0                                CL**1
  2040         MOVE 'Y'                TO DO-PRINT                         CL**1
  2041         MOVE +11                TO Z                                CL**1
  2042         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2043                                                                     CL**1
  2044     IF TBL-EARN-PREM (Y, Z) NOT = +0                                CL**1
  2045         MOVE 'Y'                TO DO-PRINT                         CL**1
  2046         MOVE +11                TO Z                                CL**1
  2047         GO TO 0750-CHECK-PRINT-EXIT.                                CL**1
  2048                                                                     CL**1
  2049 0750-CHECK-PRINT-EXIT.                                              CL**1
  2050     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  50
* ECS151.cbl
  2052                                                                     CL**4
  2053 0770-DUMP-PAGE-1.                                                   CL**1
  2054*                                                                    CL**1
  2055*    THIS PRINT STARTS WITH LINE 8 THRU END OF PAGE 1.               CL**1
  2056*                                                                    CL**1
  2057     IF R-SW-G (Y) = SPACE                                           CL**1
  2058         GO TO 0790-DUMP-1-EXIT.                                     CL**1
  2059                                                                     CL**1
  2060     MOVE HD-7                   TO PRT.                             CL**1
  2061     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2062                                                                     CL**4
  2063     MOVE P1-MESS (Y)            TO HD-9-MSG.                        CL**1
  2064     MOVE HD-9                   TO PRT.                             CL**1
  2065     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2066                                                                     CL**4
  2067     IF Y GREATER +1                                                 CL**4
  2068         GO TO 0780-CONT-DUMP-1.                                     CL**4
  2069                                                                     CL**4
  2070     MOVE HD-10                  TO PRT.                             CL**1
  2071     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2072                                                                     CL**4
  2073     MOVE HD-11                  TO PRT.                             CL**1
  2074     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2075                                                                     CL**4
  2076     MOVE HD-12                  TO PRT.                             CL**1
  2077     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2078                                                                     CL**1
  2079 0780-CONT-DUMP-1.                                                   CL**1
  2080     MOVE 'LIFE REDUCING  '      TO D1-MSG.                          CL**1
  2081     MOVE +1                     TO Z.                               CL**1
  2082     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2083                                                                     CL**4
  2084     MOVE DETAIL-1               TO PRT.                             CL**1
  2085     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2086                                                                     CL**4
  2087     MOVE 'LIFE LEVEL     '      TO D1-MSG.                          CL**1
  2088     MOVE +2                     TO Z.                               CL**1
  2089     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2090     MOVE DETAIL-1               TO PRT.                             CL**1
  2091     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2092                                                                     CL**4
  2093     MOVE 'LIFE OUT BAL   '      TO D1-MSG.                          CL**1
  2094     MOVE +3                     TO Z.                               CL**1
  2095     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2096     MOVE DETAIL-1               TO PRT.                             CL**1
  2097     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2098                                                                     CL**4
  2099     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS              CL**4
  2100                                    TOTAL-AMOUNTS.                   CL**4
  2101     PERFORM 0410-ADD-SUB-TOTALS THRU 0420-ADD-SUB-EXIT              CL**1
  2102         VARYING Z FROM 1 BY 1 UNTIL Z GREATER 3.                    CL**1
  2103     PERFORM 0690-MOVE-G1-TO-PRINT THRU 0700-MOVE-G1-EXIT.           CL**1
  2104     MOVE '  TOTAL LIFE   '      TO D1-MSG.                          CL**1
  2105     MOVE DETAIL-1               TO PRT.                             CL**1
  2106     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2107                                                                     CL**4
  2108     MOVE 'A-H RETRO/ELIM '      TO D1-MSG.                          CL**1
  2109     MOVE +4                     TO Z.                               CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  51
* ECS151.cbl
  2110     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2111     MOVE DETAIL-1               TO PRT.                             CL**1
  2112     MOVE '0'                    TO P-CTL.                           CL**1
  2113     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2114                                                                     CL**4
  2115     MOVE 'A-H OUT BAL    '      TO D1-MSG.                          CL**1
  2116     MOVE +5                     TO Z.                               CL**1
  2117     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2118     MOVE DETAIL-1               TO PRT.                             CL**1
  2119     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2120                                                                     CL**4
  2121     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.             CL**1
  2122     PERFORM 0410-ADD-SUB-TOTALS THRU 0420-ADD-SUB-EXIT              CL**1
  2123             VARYING Z FROM 4 BY 1 UNTIL Z GREATER 5.                CL**1
  2124     PERFORM 0690-MOVE-G1-TO-PRINT THRU 0700-MOVE-G1-EXIT.           CL**1
  2125     MOVE '  TOTAL A-H    '      TO D1-MSG.                          CL**1
  2126     MOVE DETAIL-1               TO PRT.                             CL**1
  2127     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2128                                                                     CL**4
  2129     PERFORM 0710-MOVE-T1-TO-PRINT THRU 0720-MOVE-T1-EXIT.           CL**1
  2130     MOVE '  TOTAL INS    '      TO D1-MSG.                          CL**1
  2131     MOVE DETAIL-1               TO PRT.                             CL**1
  2132     MOVE '0'                    TO P-CTL.                           CL**1
  2133     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2134                                                                     CL**4
  2135 0790-DUMP-1-EXIT.                                                   CL**1
  2136     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  52
* ECS151.cbl
  2138 0810-DUMP-PAGE-2.                                                   CL**1
  2139*                                                                    CL**1
  2140*    THIS PRINT STARTS WITH LINE 8 OF PAGE 2 THRU END OF PAGE 2.     CL**1
  2141*                                                                    CL**1
  2142     IF R-SW-I (Y) = SPACE                                           CL**1
  2143         GO TO 0830-DUMP-2-FINAL.                                    CL**1
  2144                                                                     CL**1
  2145     MOVE HD-8                   TO PRT.                             CL**1
  2146     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2147                                                                     CL**4
  2148     MOVE P1-MESS (Y)            TO HD-9-MSG.                        CL**1
  2149     MOVE HD-9                   TO PRT.                             CL**1
  2150     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2151                                                                     CL**4
  2152     IF Y GREATER +1                                                 CL**4
  2153         GO TO 0820-CONT-DUMP-2.                                     CL**4
  2154                                                                     CL**4
  2155     MOVE HD-10                  TO PRT.                             CL**1
  2156     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2157                                                                     CL**4
  2158     MOVE HD-11                  TO PRT.                             CL**1
  2159     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2160                                                                     CL**4
  2161     MOVE HD-12                  TO PRT.                             CL**1
  2162     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2163                                                                     CL**1
  2164 0820-CONT-DUMP-2.                                                   CL**1
  2165                                                                     CL**4
  2166     MOVE 'LIFE REDUCING  '      TO D1-MSG.                          CL**1
  2167     MOVE +6                     TO Z.                               CL**1
  2168     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2169     MOVE DETAIL-1               TO PRT.                             CL**1
  2170     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2171                                                                     CL**4
  2172     MOVE 'LIFE LEVEL     '      TO D1-MSG.                          CL**1
  2173     MOVE +7                     TO Z.                               CL**1
  2174     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2175     MOVE DETAIL-1               TO PRT.                             CL**1
  2176     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2177                                                                     CL**4
  2178     MOVE 'LIFE OUT BAL   '      TO D1-MSG.                          CL**1
  2179     MOVE +8                     TO Z.                               CL**1
  2180     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2181     MOVE DETAIL-1               TO PRT.                             CL**1
  2182     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2183                                                                     CL**4
  2184     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS              CL**4
  2185                                    TOTAL-AMOUNTS.                   CL**4
  2186     PERFORM 0410-ADD-SUB-TOTALS THRU 0420-ADD-SUB-EXIT              CL**1
  2187         VARYING Z FROM 6 BY 1 UNTIL Z GREATER 8.                    CL**1
  2188     PERFORM 0690-MOVE-G1-TO-PRINT THRU 0700-MOVE-G1-EXIT.           CL**1
  2189     MOVE '  TOTAL LIFE   '      TO D1-MSG.                          CL**1
  2190     MOVE DETAIL-1               TO PRT.                             CL**1
  2191     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2192                                                                     CL**4
  2193     MOVE 'A-H RETRO/ELIM '      TO D1-MSG.                          CL**1
  2194     MOVE +9                     TO Z.                               CL**1
  2195     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  53
* ECS151.cbl
  2196     MOVE DETAIL-1               TO PRT.                             CL**1
  2197     MOVE '0'                    TO P-CTL.                           CL**1
  2198     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2199                                                                     CL**4
  2200     MOVE 'A-H OUT BAL    '      TO D1-MSG.                          CL**1
  2201     MOVE +10                    TO Z.                               CL**1
  2202     PERFORM 0440-BUILD-DETAIL-1 THRU 0450-BUILD-D-EXIT.             CL**1
  2203     MOVE DETAIL-1               TO PRT.                             CL**1
  2204     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2205                                                                     CL**4
  2206     MOVE ZERO-FIELDS-1          TO TOTAL-PRINT-AMOUNTS.             CL**1
  2207     PERFORM 0410-ADD-SUB-TOTALS THRU 0420-ADD-SUB-EXIT              CL**1
  2208         VARYING Z FROM 9 BY 1 UNTIL Z GREATER 10.                   CL**1
  2209     PERFORM 0690-MOVE-G1-TO-PRINT THRU 0700-MOVE-G1-EXIT.           CL**1
  2210     MOVE '  TOTAL A-H    '      TO D1-MSG.                          CL**1
  2211     MOVE DETAIL-1               TO PRT.                             CL**1
  2212     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2213                                                                     CL**4
  2214     PERFORM 0710-MOVE-T1-TO-PRINT THRU 0720-MOVE-T1-EXIT.           CL**1
  2215     MOVE '  TOTAL INS    '      TO D1-MSG.                          CL**1
  2216     MOVE DETAIL-1               TO PRT.                             CL**1
  2217     MOVE '0'                    TO P-CTL.                           CL**1
  2218     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2219                                                                     CL**1
  2220 0830-DUMP-2-FINAL.                                                  CL**1
  2221                                                                     CL**4
  2222     IF Y LESS +3                                                    CL**4
  2223         GO TO 0840-DUMP-2-EXIT.                                     CL**4
  2224                                                                     CL**4
  2225     MOVE HD-15                  TO PRT.                             CL**1
  2226     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2227                                                                     CL**4
  2228     MOVE 'INCURRED IN THIS PERIOD -  ' TO D3-MSG.                   CL**1
  2229     MOVE TOT-AH-PD-THIS         TO D3-AH-AMT.                       CL**1
  2230     MOVE DETAIL-3               TO PRT.                             CL**1
  2231     MOVE '0'                    TO P-CTL.                           CL**1
  2232     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2233                                                                     CL**4
  2234     MOVE 'INCURRED IN PRIOR PERIOD - ' TO D3-MSG.                   CL**1
  2235     MOVE TOT-AH-PD-LAST         TO D3-AH-AMT.                       CL**1
  2236     MOVE DETAIL-3               TO PRT.                             CL**1
  2237     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2238                                                                     CL**4
  2239 0840-DUMP-2-EXIT.                                                   CL**1
  2240     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  54
* ECS151.cbl
  2242 0860-DUMP-PAGE-3.                                                   CL**1
  2243*                                                                    CL**1
  2244*    THIS PRINT,  LIKE THE OTHERS,  STARTS WITH LINE 8.              CL**1
  2245*                                                                    CL**1
  2246     MOVE HD-13                  TO PRT.                             CL**1
  2247     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2248                                                                     CL**4
  2249     MOVE HD-14                  TO PRT.                             CL**1
  2250     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2251                                                                     CL**4
  2252     MOVE 'IN FORCE AT END OF PREVIOUS PERIOD' TO D2-MSG.            CL**1
  2253     MOVE +1                     TO Z.                               CL**1
  2254     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2255     MOVE DETAIL-2               TO PRT.                             CL**1
  2256     MOVE '0'                    TO P-CTL.                           CL**1
  2257     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2258                                                                     CL**4
  2259     MOVE 'ISSUED DURING THIS PERIOD         ' TO D2-MSG.            CL**1
  2260     MOVE +2                     TO Z.                               CL**1
  2261     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2262     MOVE DETAIL-2               TO PRT.                             CL**1
  2263     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2264                                                                     CL**4
  2265     MOVE '         SUB-TOTAL IN FORCE       ' TO D2-MSG.            CL**1
  2266     MOVE +3                     TO Z.                               CL**1
  2267     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2268     MOVE DETAIL-2               TO PRT.                             CL**1
  2269     MOVE '0'                    TO P-CTL.                           CL**1
  2270     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2271                                                                     CL**4
  2272     MOVE 'DEATH CLAIMS PAID THIS PERIOD     ' TO D2-MSG.            CL**1
  2273     MOVE +4                     TO Z.                               CL**1
  2274     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2275     MOVE DETAIL-2               TO PRT.                             CL**1
  2276     MOVE '0'                    TO P-CTL.                           CL**1
  2277     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2278                                                                     CL**4
  2279     MOVE 'EXPIRATIONS IN THIS PERIOD        ' TO D2-MSG.            CL**1
  2280     MOVE +5                     TO Z.                               CL**1
  2281     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2282     MOVE DETAIL-2               TO PRT.                             CL**1
  2283     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2284                                                                     CL**4
  2285     MOVE 'CANCELLATIONS IN THIS PERIOD      ' TO D2-MSG.            CL**1
  2286     MOVE +6                     TO Z.                               CL**1
  2287     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2288     MOVE DETAIL-2               TO PRT.                             CL**1
  2289     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2290                                                                     CL**4
  2291     MOVE 'OTHER DECREASES                   ' TO D2-MSG.            CL**1
  2292     MOVE +7                     TO Z.                               CL**1
  2293     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2294     MOVE DETAIL-2               TO PRT.                             CL**1
  2295     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2296                                                                     CL**4
  2297     MOVE '         SUB-TOTAL OF DEDUCTIONS  ' TO D2-MSG.            CL**1
  2298     MOVE +8                     TO Z.                               CL**1
  2299     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  55
* ECS151.cbl
  2300     MOVE DETAIL-2               TO PRT.                             CL**1
  2301     MOVE '0'                    TO P-CTL.                           CL**1
  2302     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2303                                                                     CL**4
  2304     MOVE 'IN FORCE AT END OF CURRENT PERIOD ' TO D2-MSG.            CL**1
  2305     MOVE +9                     TO Z.                               CL**1
  2306     PERFORM 0460-BUILD-DETAIL-2 THRU 0470-BUILD-2-EXIT.             CL**1
  2307     MOVE DETAIL-2               TO PRT.                             CL**1
  2308     MOVE '0'                    TO P-CTL.                           CL**1
  2309     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2310                                                                     CL**4
  2311     MOVE ZERO TO D2-GRP-CNT  D2-GRP-AMT  D2-IND-CNT  D2-IND-AMT.    CL**1
  2312     MOVE ALL '*'                TO D2-MSG.                          CL**1
  2313     MOVE DETAIL-2               TO PRT.                             CL**1
  2314     MOVE '0'                    TO P-CTL.                           CL**1
  2315     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2316                                                                     CL**4
  2317     MOVE 'IN FORCE AT END OF PREVIOUS PERIOD' TO D2-MSG.            CL**1
  2318     MOVE DETAIL-2               TO PRT.                             CL**1
  2319     MOVE '0'                    TO P-CTL.                           CL**1
  2320     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2321                                                                     CL**4
  2322     MOVE '    TERMS OF 1 THRU 60 MONTHS     ' TO D2-MSG.            CL**1
  2323     MOVE +1                     TO Y.                               CL**1
  2324     MOVE +1                     TO Z.                               CL**1
  2325     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2326     MOVE DETAIL-2               TO PRT.                             CL**1
  2327     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2328                                                                     CL**4
  2329     MOVE '    TERMS OF 61 THRU 120 MONTHS   ' TO D2-MSG.            CL**1
  2330     MOVE +2                     TO Y.                               CL**1
  2331     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2332     MOVE DETAIL-2               TO PRT.                             CL**1
  2333     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2334                                                                     CL**4
  2335     MOVE '    TERMS GREATER THAN 120 MONTHS ' TO D2-MSG.            CL**1
  2336     MOVE +3                     TO Y.                               CL**1
  2337     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2338     MOVE DETAIL-2               TO PRT.                             CL**1
  2339     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2340                                                                     CL**4
  2341     MOVE ZERO TO D2-GRP-CNT  D2-GRP-AMT  D2-IND-CNT  D2-IND-AMT.    CL**1
  2342     MOVE 'IN FORCE AT END OF CURRENT PERIOD ' TO D2-MSG.            CL**1
  2343     MOVE DETAIL-2               TO PRT.                             CL**1
  2344     MOVE '0'                    TO P-CTL.                           CL**1
  2345     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2346                                                                     CL**4
  2347     MOVE '    TERMS OF 1 THRU 60 MONTHS     ' TO D2-MSG.            CL**1
  2348     MOVE +1                     TO Y.                               CL**1
  2349     MOVE +9                     TO Z.                               CL**1
  2350     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2351     MOVE DETAIL-2               TO PRT.                             CL**1
  2352     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2353                                                                     CL**4
  2354     MOVE '    TERMS OF 61 THRU 120 MONTHS   ' TO D2-MSG.            CL**1
  2355     MOVE +2                     TO Y.                               CL**1
  2356     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2357     MOVE DETAIL-2               TO PRT.                             CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  56
* ECS151.cbl
  2358     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2359                                                                     CL**4
  2360     MOVE '    TERMS GREATER THAN 120 MONTHS ' TO D2-MSG.            CL**1
  2361     MOVE +3                     TO Y.                               CL**1
  2362     PERFORM 0480-BUILD-DETAIL-2A THRU 0490-BUILD-2A-EXIT.           CL**1
  2363     MOVE DETAIL-2               TO PRT.                             CL**1
  2364     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2365                                                                     CL**4
  2366 0870-DUMP-3-EXIT.                                                   CL**1
  2367     EXIT.                                                           CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  57
* ECS151.cbl
  2369                                                                     CL**4
  2370 0890-NO-PRINT.                                                      CL**1
  2371     MOVE RUN-DATE               TO WS-WORK-DATE.                    CL**1
  2372     MOVE WS-DAY                 TO HD-5-DAY.                        CL**1
  2373     MOVE WS-YEAR                TO HD-5-YEAR.                       CL**1
  2374     MOVE MONTH-ALPHA (WS-MONTH) TO HD-5-MONTH.                      CL**1
  2375                                                                     CL**1
  2376     MOVE EP-DT                  TO WS-WORK-DATE.                    CL**1
  2377     MOVE WS-DAY                 TO HD-6-DAY.                        CL**1
  2378     MOVE WS-YEAR                TO HD-6-YEAR.                       CL**1
  2379     MOVE MONTH-ALPHA (WS-MONTH) TO HD-6-MONTH.                      CL**1
  2380                                                                     CL**1
  2381     PERFORM 0640-PRINT-HEADINGS THRU 0650-P-H-X.                    CL**1
  2382     MOVE 'PROGRAM COMPLETED - NO PRINT DATA' TO P-DATA.             CL**1
  2383     PERFORM 0660-PRT-RTN THRU 0670-PRT-RTN-X.                       CL**1
  2384                                                                     CL**1
  2385 0900-END-JOB.                                                       CL**1
  2386     CLOSE  PRT-FILE.                                                CL**1
  2387     IF FICH-OPEN = 'X'                                              CL**1
  2388         CLOSE FICH.                                                 CL**1
  2389 0910-EOJ-EXIT.                                                      CL**4
  2390      EXIT.                                                          CL**4
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  58
* ECS151.cbl
  2392                                                                     CL**1
  2393 ABEND-PGM.
*                                      COPY ELCABEND.                      CL**1
  2394***************************************************************** 04/14/98
  2395*                                                               * ELCABEND
  2396*                            ELCABEND.                          *    LV003
  2397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2398*                            VMOD 2.002                              CL**2
  2399*                                                               * ELCABEND
  2400*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2401*            AND THEN ABENDS.                                   * ELCABEND
  2402*                                                               * ELCABEND
  2403*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2404*                                                               * ELCABEND
  2405***************************************************************** ELCABEND
  2406*APS-010.                                                         ELCABEND
  2407     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2408     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2409                                                                  ELCABEND
  2410     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2411         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2412         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2413                                 UPON CONSOLE.                    ELCABEND
  2414                                                                  ELCABEND
  2415     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2416         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2417         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2418                                 UPON CONSOLE.                    ELCABEND
  2419                                                                  ELCABEND
  2420     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2421     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2422                                 UPON CONSOLE.                    ELCABEND
  2423                                                                  ELCABEND
  2424     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2425     CALL 'ABORTME'.
  2426                                                                  ELCABEND
  2427 APS-EXIT.                                                        ELCABEND
  2428     EXIT.                                                        ELCABEND
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  59
* ECS151.cbl
  2429/                                                                    CL**1
  2430 LCP-WRITE-POS-PRT SECTION.                                          CL**1
  2431     IF LCP-ASA = '+'                                                CL**1
  2432         WRITE PRT AFTER 0 LINE                                      CL**1
  2433     ELSE                                                            CL**1
  2434     IF LCP-ASA = ' '                                                CL**1
  2435         WRITE PRT AFTER ADVANCING 1 LINE                            CL**1
  2436     ELSE                                                            CL**1
  2437     IF LCP-ASA = '0'                                                CL**1
  2438         WRITE PRT AFTER ADVANCING 2 LINE                            CL**1
  2439     ELSE                                                            CL**1
  2440     IF LCP-ASA = '-'                                                CL**1
  2441         WRITE PRT AFTER ADVANCING 3 LINE                            CL**1
  2442     ELSE                                                            CL**1
  2443     IF LCP-ASA = '1'                                                CL**1
  2444         WRITE PRT AFTER ADVANCING PAGE                              CL**1
  2445     ELSE                                                            CL**1
  2446     IF LCP-ASA = '2'                                                CL**1
  2447         WRITE PRT AFTER ADVANCING LCP-CH2                           CL**1
  2448     ELSE                                                            CL**1
  2449     IF LCP-ASA = '3'                                                CL**1
  2450         WRITE PRT AFTER ADVANCING LCP-CH3                           CL**1
  2451     ELSE                                                            CL**1
  2452     IF LCP-ASA = '4'                                                CL**1
  2453         WRITE PRT AFTER ADVANCING LCP-CH4                           CL**1
  2454     ELSE                                                            CL**1
  2455     IF LCP-ASA = '5'                                                CL**1
  2456         WRITE PRT AFTER ADVANCING LCP-CH5                           CL**1
  2457     ELSE                                                            CL**1
  2458     IF LCP-ASA = '6'                                                CL**1
  2459         WRITE PRT AFTER ADVANCING LCP-CH6                           CL**1
  2460     ELSE                                                            CL**1
  2461     IF LCP-ASA = '7'                                                CL**1
  2462         WRITE PRT AFTER ADVANCING LCP-CH7                           CL**1
  2463     ELSE                                                            CL**1
  2464     IF LCP-ASA = '8'                                                CL**1
  2465         WRITE PRT AFTER ADVANCING LCP-CH8                           CL**1
  2466     ELSE                                                            CL**1
  2467     IF LCP-ASA = '9'                                                CL**1
  2468         WRITE PRT AFTER ADVANCING LCP-CH9                           CL**1
  2469     ELSE                                                            CL**1
  2470     IF LCP-ASA = 'A'                                                CL**1
  2471         WRITE PRT AFTER ADVANCING LCP-CH10                          CL**1
  2472     ELSE                                                            CL**1
  2473     IF LCP-ASA = 'B'                                                CL**1
  2474         WRITE PRT AFTER ADVANCING LCP-CH11                          CL**1
  2475     ELSE                                                            CL**1
  2476     IF LCP-ASA = 'C'                                                CL**1
  2477         WRITE PRT AFTER ADVANCING LCP-CH12                          CL**1
  2478     ELSE                                                            CL**1
  2479     IF LCP-ASA = 'V'                                                CL**1
  2480         WRITE PRT AFTER ADVANCING LCP-P01                           CL**1
  2481     ELSE                                                            CL**1
  2482     IF LCP-ASA = 'W'                                                CL**1
  2483         WRITE PRT AFTER ADVANCING LCP-P02                           CL**1
  2484     ELSE                                                            CL**1
  2485     DISPLAY 'ASA CODE ERROR'.                                       CL**1
  2486 LCP-WRITE-END-PRT.                                                  CL**1
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  60
* ECS151.cbl
  2487     EXIT.                                                           CL**1
  2488                                                                     CL**1
  2489                                                                     CL**1
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       62244     Code:       13536
