* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIUPDNOTE.cbl
* Options: int("CIUPDNOTE.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIUPDNOTE.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIUPDNOTE.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CIUPDNOTE.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                CIUPDNOTE.
     3*AUTHOR.     AJRA.
     4*REMARKS.
     5* THIS PROGRAM REMOVES THE BILLING NOTE LINE NUMBERS FROM ERNOTE
     6* FOR CERTS WITH NO PENDING TRANSACTIONS.
     7 ENVIRONMENT DIVISION.
     8 INPUT-OUTPUT SECTION.
     9 FILE-CONTROL.
    10
    11
    12     SELECT ERNOTE           ASSIGN TO ERNOTE
    13                             ORGANIZATION IS INDEXED
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIUPDNOTE.cbl
    14                             ACCESS IS DYNAMIC
    15                             RECORD KEY IS CN-CONTROL-PRIMARY
    16                             FILE STATUS IS ERNOTE-FILE-STATUS.
    17
    18     SELECT ERPNDB           ASSIGN TO ERPNDB2
    19                             ORGANIZATION IS INDEXED
    20                             ACCESS IS DYNAMIC
    21                             RECORD KEY IS PB-CONTROL-BY-ACCOUNT
    22                             FILE STATUS IS ERPNDB-FILE-STATUS.
    23
    24     SELECT  EXT-OUT         ASSIGN TO SYS011
    25                             ORGANIZATION IS LINE SEQUENTIAL.
    26
    27 DATA DIVISION.
    28
    29 FILE SECTION.
    30
    31 FD  ERNOTE.
*   32                                 COPY ERCNOTE.
    33******************************************************************04/29/98
    34*                                                                *ERCNOTE
    35*                                                                *ERCNOTE
    36*                            ERCNOTE                             *   LV002
    37*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    38*                            VMOD=2.003                          *   CL**2
    39*                                                                *ERCNOTE
    40*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *ERCNOTE
    41*                                                                *ERCNOTE
    42*        FILE TYPE= VSAM,KSDS                                    *ERCNOTE
    43*        RECORD SIZE = 825    RECFORM = FIXED                    *ERCNOTE
    44*                                                                *ERCNOTE
    45*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *ERCNOTE
    46*                                                                *ERCNOTE
    47*        LOG = YES                                               *ERCNOTE
    48*        SERVREQ = DELETE,UPDATE,NEWREC                          *ERCNOTE
    49*                                                                *ERCNOTE
    50******************************************************************
    51*                   C H A N G E   L O G
    52*
    53* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    54*-----------------------------------------------------------------
    55*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    56* EFFECTIVE    NUMBER
    57*-----------------------------------------------------------------
    58* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THIS
    59*                                FILE WILL CONTAIN BILLING NOTES ONLY.
    60******************************************************************ERCNOTE
    61                                                                  ERCNOTE
    62 01  CERTIFICATE-NOTE.                                            ERCNOTE
    63     12  CN-RECORD-ID                PIC  XX.                     ERCNOTE
    64         88  VALID-CN-ID                  VALUE 'CN'.             ERCNOTE
    65                                                                  ERCNOTE
    66     12  CN-CONTROL-PRIMARY.                                      ERCNOTE
    67         16  CN-COMPANY-CD           PIC X.                       ERCNOTE
    68         16  CN-CARRIER              PIC X.                       ERCNOTE
    69         16  CN-GROUPING.                                         ERCNOTE
    70             20 CN-GROUPING-PREFIX   PIC XXX.                     ERCNOTE
    71             20 CN-GROUPING-PRIME    PIC XXX.                     ERCNOTE
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCNOTE)
    72         16  CN-STATE                PIC XX.                      ERCNOTE
    73         16  CN-ACCOUNT.                                          ERCNOTE
    74             20 CN-ACCOUNT-PREFIX    PIC X(4).                    ERCNOTE
    75             20 CN-ACCOUNT-PRIME     PIC X(6).                    ERCNOTE
    76         16  CN-CERT-EFF-DT          PIC XX.                      ERCNOTE
    77         16  CN-CERT-NO.                                          ERCNOTE
    78             20  CN-CERT-PRIME       PIC X(10).                   ERCNOTE
    79             20  CN-CERT-SFX         PIC X.                       ERCNOTE
    80                                                                  ERCNOTE
    81     12  CN-BILLING-START-LINE-NO    PIC 99.                      ERCNOTE
    82     12  CN-BILLING-END-LINE-NO      PIC 99.                      ERCNOTE
    83                                                                  ERCNOTE
    84     12  CN-LINES.                                                ERCNOTE
    85         16  CN-LINE OCCURS 10       PIC X(77).                   ERCNOTE
    86                                                                  ERCNOTE
    87     12  CN-LAST-MAINT-DT            PIC XX.                      ERCNOTE
    88     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.          ERCNOTE
    89     12  CN-LAST-MAINT-USER          PIC X(4).                    ERCNOTE
    90     12  FILLER                      PIC X(6).                    ERCNOTE
    91******************************************************************ERCNOTE
    92
    93 FD  ERPNDB.
    94
*   95                                 COPY ERCPNDB.
    96******************************************************************
    97*                                                                *
    98*                                                                *
    99*                            ERCPNDB.                            *
   100*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   101*                            VMOD=2.025                          *
   102*                                                                *
   103*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   104*                                                                *
   105******************************************************************
   106*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
   107*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*   FILE TYPE = VSAM,KSDS                                        *
   112*   RECORD SIZE = 585  RECFORM = FIXED                           *
   113*                                                                *
   114*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   115*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   116*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   117*                                                 RKP=13,LEN=36  *
   118*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   119*                                      AND CHG-SEQ.)             *
   120*                                                RKP=49,LEN=11   *
   121*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   122*                                      AND CHG-SEQ.)             *
   123*                                                RKP=60,LEN=15   *
   124*                                                                *
   125*   LOG = NO                                                     *
   126*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   127******************************************************************
   128******************************************************************
   129*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   130*
   131* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   132*-----------------------------------------------------------------
   133*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   134* EFFECTIVE    NUMBER
   135*-----------------------------------------------------------------
   136* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   137* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   138* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   139* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   140* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   141* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   142* 032306                   PEMA  ADD BOW LOAN NUMBER
   143* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   144* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   145* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   146* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   147* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   148* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORSEMENT
   149* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   150* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
   151* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
   152******************************************************************
   153
   154 01  PENDING-BUSINESS.
   155     12  PB-RECORD-ID                     PIC XX.
   156         88  VALID-PB-ID                        VALUE 'PB'.
   157
   158     12  PB-CONTROL-PRIMARY.
   159         16  PB-COMPANY-CD                PIC X.
   160         16  PB-ENTRY-BATCH               PIC X(6).
   161         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   162         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   163
   164     12  PB-CONTROL-BY-ACCOUNT.
   165         16  PB-COMPANY-CD-A1             PIC X.
   166         16  PB-CARRIER                   PIC X.
   167         16  PB-GROUPING.
   168             20  PB-GROUPING-PREFIX       PIC XXX.
   169             20  PB-GROUPING-PRIME        PIC XXX.
   170         16  PB-STATE                     PIC XX.
   171         16  PB-ACCOUNT.
   172             20  PB-ACCOUNT-PREFIX        PIC X(4).
   173             20  PB-ACCOUNT-PRIME         PIC X(6).
   174         16  PB-CERT-EFF-DT               PIC XX.
   175         16  PB-CERT-NO.
   176             20  PB-CERT-PRIME            PIC X(10).
   177             20  PB-CERT-SFX              PIC X.
   178         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   179
   180         16  PB-RECORD-TYPE               PIC X.
   181             88  PB-MAILING-DATA                VALUE '0'.
   182             88  PB-ISSUE                       VALUE '1'.
   183             88  PB-CANCELLATION                VALUE '2'.
   184             88  PB-BATCH-TRAILER               VALUE '9'.
   185
   186     12  PB-CONTROL-BY-ORIG-BATCH.
   187         16  PB-ORIGINAL-COMPANY-CD       PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   188         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   189         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   190         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   191
   192     12  PB-CONTROL-BY-CSR.
   193         16  PB-CSR-COMPANY-CD            PIC X.
   194         16  PB-CSR-ID                    PIC X(4).
   195         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   196         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   197         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   198******************************************************************
   199*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   200******************************************************************
   201
   202     12  PB-LAST-MAINT-DT                 PIC XX.
   203     12  PB-LAST-MAINT-BY                 PIC X(4).
   204     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   205
   206     12  PB-RECORD-BODY                   PIC X(375).
   207
   208     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   209         16  PB-CERT-ORIGIN               PIC X.
   210             88  CLASIC-CREATED-CERT         VALUE '1'.
   211         16  PB-I-NAME.
   212             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   213             20  PB-I-INSURED-FIRST-NAME.
   214                 24  PB-I-INSURED-1ST-INIT PIC X.
   215                 24  FILLER                PIC X(9).
   216             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   217         16  PB-I-AGE                     PIC S99   COMP-3.
   218         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   219         16  PB-I-BIRTHDAY                PIC XX.
   220         16  PB-I-INSURED-SEX             PIC X.
   221             88  PB-SEX-MALE     VALUE 'M'.
   222             88  PB-SEX-FEMALE   VALUE 'F'.
   223
   224         16  PB-I-LF-TERM                 PIC S999   COMP-3.
   225         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   226         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   227         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   228         16  PB-I-SKIP-CODE               PIC X.
   229             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   230             88  PB-SKIP-JULY              VALUE '1'.
   231             88  PB-SKIP-AUGUST            VALUE '2'.
   232             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   233             88  PB-SKIP-JULY-AUG          VALUE '4'.
   234             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   235             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   236             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   237             88  PB-SKIP-JUNE              VALUE '8'.
   238             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   239             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   240             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   241         16  PB-I-TERM-TYPE               PIC X.
   242             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   243             88  PB-PAID-WEEKLY            VALUE 'W'.
   244             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   245             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   246             88  PB-PAID-13-YEARLY         VALUE 'T'.
   247         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   248         16  PB-I-POLICY-FORM-NO          PIC X(12).
   249         16  PB-I-DATA-ENTRY-SW           PIC X.
   250             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   251             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   252             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   253             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   254         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   255         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   256*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   257         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   258         16  FILLER                       PIC X.
   259
   260         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   261             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   262             88  PB-INVALID-LIFE             VALUE '  ' '00'
   263                                                   '90' THRU '99'.
   264         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   265                                          PIC XX.
   266         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   267         16  PB-I-AMOUNT-FINANCED REDEFINES
   268                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   269         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   270         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   271                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   272         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   273         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   274         16  PB-I-CLP-AMOUNT REDEFINES
   275                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   276         16  PB-I-LF-CALC-FLAG            PIC X.
   277             88 PB-COMP-LF-PREM               VALUE '?'.
   278         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   279         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   280         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   281         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   282         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
   283         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   284         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   285         16  PB-I-LF-ABBR                 PIC XXX.
   286         16  PB-I-LF-INPUT-CD             PIC XX.
   287
   288         16  PB-I-AH-BENEFIT-CD           PIC XX.
   289             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   290             88  PB-INVALID-AH               VALUE '  ' '00'
   291                                                   '90' THRU '99'.
   292         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   293         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   294         16  PB-I-AH-CALC-FLAG            PIC X.
   295             88 PB-COMP-AH-PREM                  VALUE '?'.
   296         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   297         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   298         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   299         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   300         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   301         16  PB-I-AH-ABBR                 PIC XXX.
   302         16  PB-I-AH-INPUT-CD             PIC XXX.
   303
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   304         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   305         16  PB-I-REIN-TABLE              PIC XXX.
   306         16  PB-I-BUSINESS-TYPE           PIC 99.
   307         16  PB-I-INDV-GRP-CD             PIC X.
   308         16  PB-I-MORT-CODE.
   309             20  PB-I-TABLE               PIC X.
   310             20  PB-I-INTEREST            PIC XX.
   311             20  PB-I-MORT-TYP            PIC X.
   312         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   313         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   314         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   315         16  PB-I-INDV-GRP-OVRD           PIC X.
   316         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   317         16  PB-I-SIG-SW                  PIC X.
   318             88  PB-POLICY-SIGNED             VALUE 'Y'.
   319         16  PB-I-RATE-CLASS              PIC XX.
   320         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   321         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   322         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   323         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   324         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   325         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   326         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   327         16  PB-I-BENEFIT-TYPE            PIC XXX.
   328         16  PB-I-OB-FLAG                 PIC X.
   329             88  PB-I-OB                      VALUE 'B'.
   330             88  PB-I-SUMMARY                 VALUE 'Z'.
   331         16  PB-I-ENTRY-STATUS            PIC X.
   332             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   333                                              'M' '5' '9' '2'.
   334             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   335             88  PB-I-POLICY-PENDING          VALUE '2'.
   336             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   337             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   338             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
   339             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   340             88  PB-I-REIN-ONLY               VALUE '9'.
   341             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
   342             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   343             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   344             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   345         16  PB-I-INT-CODE                PIC X.
   346             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   347             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   348         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   349         16  PB-I-SOC-SEC-NO              PIC X(11).
   350         16  PB-I-MEMBER-NO               PIC X(12).
   351         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   352*        16  PB-I-LOAN-OFFICER            PIC XXX.
   353         16  PB-I-OLD-LOF                 PIC XXX.
   354         16  PB-I-LF-EXPIRE-DT            PIC XX.
   355         16  PB-I-AH-EXPIRE-DT            PIC XX.
   356         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   357         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   358         16  PB-I-LIFE-INDICATOR          PIC X.
   359             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   360         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   361         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   362                                          PIC S9(5)V99    COMP-3.
   363         16  PB-I-MAIL-ADDRS-SW           PIC X.
   364             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   365             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   366         16  PB-I-1ST-PMT-DT              PIC XX.
   367         16  PB-I-JOINT-INSURED.
   368             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   369             20 PB-I-JOINT-FIRST-NAME.
   370                24  PB-I-JOINT-FIRST-INIT PIC X.
   371                24  FILLER                PIC X(9).
   372             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   373*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   374         16  PB-I-BENEFICIARY-NAME.
   375             20  PB-I-BANK-NUMBER         PIC X(10).
   376             20  FILLER                   PIC X(15).
   377         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   378         16  PB-I-REFERENCE               PIC X(12).
   379         16  FILLER REDEFINES PB-I-REFERENCE.
   380             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   381             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   382             20  PB-I-CLP-STATE           PIC XX.
   383         16  PB-I-UNDERWRITING-STATUS     PIC X.
   384             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   385             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   386             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   387         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   388         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   389         16  PB-I-RESIDENT-STATE          PIC XX.
   390         16  PB-I-RATE-CODE               PIC X(4).
   391         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   392         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   393         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   394         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   395         16  PB-I-BANK-NOCHRGB            PIC 99.
   396         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   397         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   398
   399     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   400         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   401             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
   402         16  PB-C-CANCEL-ORIGIN           PIC X.
   403             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   404         16  PB-C-LF-CANCEL-DT            PIC XX.
   405         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   406         16  PB-C-LF-CALC-REQ             PIC X.
   407             88 PB-COMP-LF-CANCEL            VALUE '?'.
   408         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   409         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   410         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   411             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   412         16  PB-C-AH-CANCEL-DT            PIC XX.
   413         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   414         16  PB-C-AH-CALC-REQ             PIC X.
   415             88 PB-COMP-AH-CANCEL            VALUE '?'.
   416         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   417         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   418         16  PB-C-LAST-NAME               PIC X(15).
   419         16  PB-C-REFUND-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   420             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   421             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   422         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   423         16  PB-C-PAYEE-CODE              PIC X(6).
   424         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   425         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   426         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   427         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   428         16  PB-C-REFERENCE               PIC X(12).
   429         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   430         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   431         16  PB-C-POST-CARD-IND           PIC X.
   432         16  PB-C-CANCEL-REASON           PIC X.
   433         16  PB-C-REF-INTERFACE-SW        PIC X.
   434         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
   435         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
   436         16  FILLER                       PIC X(01).
   437*        16  FILLER                       PIC X(18).
   438         16  PB-C-POLICY-FORM-NO          PIC X(12).
   439*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   440         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   441         16  PB-CANCELED-CERT-DATA.
   442             20  PB-CI-INSURED-NAME.
   443                 24  PB-CI-LAST-NAME      PIC X(15).
   444                 24  PB-CI-INITIALS       PIC XX.
   445             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   446             20  PB-CI-INSURED-SEX        PIC X.
   447             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   448             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   449             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   450             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   451             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   452             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   453             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   454             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   455             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   456             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   457             20  PB-CI-RATE-CLASS         PIC XX.
   458             20  PB-CI-RATE-DEV-LF        PIC XXX.
   459             20  PB-CI-RATE-DEV-AH        PIC XXX.
   460             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   461             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
   462             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   463             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   464             20  PB-CI-LF-ABBR            PIC X(3).
   465             20  PB-CI-AH-ABBR            PIC X(3).
   466             20  PB-CI-OB-FLAG            PIC X.
   467                 88  PB-CI-OB                VALUE 'B'.
   468             20  PB-CI-LF-POLICY-STATUS   PIC X.
   469                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   470                                           'M' '4' '5' '9' '2'.
   471                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   472                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   473                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   474                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   475                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   476                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
   477                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   478                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   479                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   480                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   481                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   482                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   483                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   484             20  PB-CI-AH-POLICY-STATUS   PIC X.
   485                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   486                                           'M' '4' '5' '9' '2'.
   487                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   488                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   489                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   490                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   491                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   492                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
   493                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   494                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   495                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   496                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   497                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   498                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   499                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   500             20  PB-CI-PAY-FREQUENCY      PIC 99.
   501             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   502             20  PB-CI-SOC-SEC-NO         PIC X(11).
   503             20  PB-CI-MEMBER-NO          PIC X(12).
   504             20  PB-CI-INT-CODE           PIC X.
   505                 88  PB-CI-ADD-ON                  VALUE 'A'.
   506                 88  PB-CI-SIMPLE                  VALUE 'S'.
   507             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   508             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   509             20  PB-CI-COMP-EXCP-SW       PIC X.
   510                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   511                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   512             20  PB-CI-ENTRY-STATUS       PIC X.
   513             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   514             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   515             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   516             20  PB-CI-DEATH-DT           PIC XX.
   517             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   518             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   519             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   520             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   521             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
   522             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   523             20  PB-CI-ENTRY-DT              PIC XX.
   524             20  PB-CI-ENTRY-BATCH           PIC X(6).
   525             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   526             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   527             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   528             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   529             20  PB-CI-OLD-LOF               PIC XXX.
   530*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   531             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   532             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   533             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   534             20  PB-CI-INDV-GRP-CD           PIC X.
   535             20  PB-CI-BENEFICIARY-NAME.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   536                 24  PB-CI-BANK-NUMBER       PIC X(10).
   537                 24  FILLER                  PIC X(15).
   538             20  PB-CI-NOTE-SW               PIC X.
   539             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   540             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   541             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   542             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   543             20  PB-CI-LOAN-OFFICER          PIC X(5).
   544             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   545             20  PB-CI-FIRST-NAME            PIC X(10).
   546             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
   547
   548         16  FILLER                       PIC X(13).
   549*032306  16  FILLER                       PIC X(27).
   550*        16  FILLER                       PIC X(46).
   551
   552     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   553         16  FILLER                       PIC X(10).
   554         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   555         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   556         16  PB-M-INSURED-MID-INIT        PIC X.
   557         16  PB-M-INSURED-AGE             PIC 99.
   558         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   559         16  PB-M-INSURED-SEX             PIC X.
   560         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   561         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   562         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   563         16  PB-M-INSURED-CITY-STATE.
   564             20  PB-M-INSURED-CITY        PIC X(28).
   565             20  PB-M-INSURED-STATE       PIC XX.
   566         16  PB-M-INSURED-ZIP-CODE.
   567             20  PB-M-INSURED-ZIP-PRIME.
   568                 24  PB-M-INSURED-ZIP-1   PIC X.
   569                     88  PB-M-CANADIAN-POST-CODE
   570                                             VALUE 'A' THRU 'Z'.
   571                 24  FILLER               PIC X(4).
   572             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   573         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   574                                        PB-M-INSURED-ZIP-CODE.
   575             20  PM-M-INS-CAN-POST1       PIC XXX.
   576             20  PM-M-INS-CAN-POST2       PIC XXX.
   577             20  FILLER                   PIC XXX.
   578         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   579         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   580         16  PB-M-CRED-BENE-NAME          PIC X(30).
   581         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   582         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   583         16  PB-M-CRED-BENE-CITYST.
   584             20  PB-M-CRED-BENE-CITY      PIC X(28).
   585             20  PB-M-CRED-BENE-STATE     PIC XX.
   586
   587         16  FILLER                       PIC X(92).
   588
   589     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   590         16  FILLER                       PIC X(10).
   591         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   592         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   593         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   594         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   595         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   596         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   597         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   598         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   599         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   600         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   601         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   602         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   603         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   604         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   605         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   606         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   607         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   608         16  PB-ACCOUNT-NAME              PIC X(30).
   609         16  PB-PREM-REF-RPT-FLAG         PIC X.
   610         16  PB-REFERENCE                 PIC X(12).
   611         16  PB-B-RECEIVED-DT             PIC XX.
   612         16  FILLER                       PIC X(234).
   613
   614     12  PB-RECORD-STATUS.
   615         16  PB-CREDIT-SELECT-DT          PIC XX.
   616         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   617         16  PB-BILLED-DT                 PIC XX.
   618         16  PB-BILLING-STATUS            PIC X.
   619             88  PB-ENTRY-REVERSED            VALUE 'R'.
   620             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   621             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   622         16  PB-RECORD-BILL               PIC X.
   623             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   624             88  PB-RECORD-RETURNED           VALUE 'R'.
   625             88  PB-RECORD-ENDORSED           VALUE 'E'.
   626             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   627             88  PB-OVERRIDE-AH               VALUE 'A'.
   628             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   629         16  PB-BATCH-ENTRY               PIC X.
   630             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   631             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   632             88  PB-REISSUED-CERT             VALUE 'E'.
   633             88  PB-CASH-CERT                 VALUE 'C'.
   634             88  PB-MONTHLY-CERT              VALUE 'M'.
   635             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   636             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   637             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   638         16  PB-FORCE-CODE                PIC X.
   639             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   640             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
   641             88  PB-CANCEL-FORCE              VALUE '8'.
   642             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   643             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   644             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   645             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   646             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   647             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   648             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   649         16  PB-FATAL-FLAG                PIC X.
   650             88  PB-FATAL-ERRORS              VALUE 'X'.
   651         16  PB-FORCE-ER-CD               PIC X.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* CIUPDNOTE.cbl (/apps/prod/cid1p/copy/ERCPNDB)
   652             88  PB-FORCE-ERRORS              VALUE 'F'.
   653             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   654         16  PB-WARN-ER-CD                PIC X.
   655             88  PB-WARNING-ERRORS            VALUE 'W'.
   656         16  FILLER                       PIC X.
   657         16  PB-OUT-BAL-CD                PIC X.
   658             88  PB-OUT-OF-BAL                VALUE 'O'.
   659         16  PB-LIFE-OVERRIDE-L1          PIC X.
   660         16  PB-AH-OVERRIDE-L1            PIC X.
   661         16  PB-INPUT-DT                  PIC XX.
   662         16  PB-INPUT-BY                  PIC X(4).
   663         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   664         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   665         16  PB-TOLERANCE-REJECT-SW       PIC X.
   666         16  PB-LF-EARNING-METHOD         PIC X.
   667         16  PB-AH-EARNING-METHOD         PIC X.
   668         16  PB-LF-TERM-CALC-METHOD       PIC X.
   669         16  PB-AH-TERM-CALC-METHOD       PIC X.
   670         16  PB-REIN-CD                   PIC XXX.
   671         16  PB-LF-REFUND-TYPE            PIC X.
   672         16  PB-AH-REFUND-TYPE            PIC X.
   673         16  PB-ACCT-EFF-DT               PIC XX.
   674         16  PB-ACCT-EXP-DT               PIC XX.
   675         16  PB-COMPANY-ID                PIC X(3).
   676         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   677         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   678         16  PB-SV-CARRIER                PIC X.
   679         16  PB-SV-GROUPING               PIC X(6).
   680         16  PB-SV-STATE                  PIC XX.
   681         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   682         16  PB-GA-BILLING-INFO.
   683             20  PB-GA-BILL-DT OCCURS 5 TIMES
   684                                          PIC XX.
   685         16  PB-SV-REMIT-TO  REDEFINES
   686             PB-GA-BILLING-INFO           PIC X(10).
   687         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   688         16  PB-I-LOAN-OFFICER            PIC X(5).
   689         16  PB-I-VIN                     PIC X(17).
   690
   691         16  FILLER                       PIC X(04).
   692         16  IMNET-BYPASS-SW              PIC X.
   693
   694******************************************************************
   695*                COMMON EDIT ERRORS                              *
   696******************************************************************
   697
   698     12  PB-COMMON-ERRORS.
   699         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   700                                           PIC S9(4)     COMP.
   701
   702******************************************************************
   703
   704 FD  EXT-OUT
   705     RECORDING MODE F
   706     LABEL RECORDS STANDARD
   707     BLOCK CONTAINS 0 RECORDS.
   708 01  EXT-RECORD                 PIC X(826).
   709
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* CIUPDNOTE.cbl
   710   WORKING-STORAGE SECTION.
   711 77  FILLER  PIC X(32) VALUE '********************************'.
   712 77  FILLER  PIC X(32) VALUE '   PEMEPC2  WORKING-STORAGE     '.
   713 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.001. ********'.
   714
   715 77  WS-ABEND-FILE-STATUS        PIC XX            VALUE ZERO.
   716 77  WS-ABEND-MESSAGE            PIC X(80)         VALUE SPACES.
   717 77  WS-ABEND-PROGRAM            PIC X(8)          VALUE SPACES.
   718 77  WS-RETURN-CODE              PIC S9(4)         VALUE +0.
   719 77  WS-ZERO                     PIC S9     COMP-3 VALUE +0.
   720 77  WS-EOF-SW                   PIC X VALUE SPACES.
   721     88  END-OF-NOTE               VALUE 'Y'.
   722 77  WS-DROP-SW                  PIC X VALUE SPACES.
   723     88  DROP-NOTE                 VALUE 'Y'.
   724 77  NOTE-RECS-IN                PIC 9(9) VALUE ZEROS.
   725 77  NOTE-RECS-OUT               PIC 9(9) VALUE ZEROS.
   726 77  NOTE-RECS-FIX               PIC 9(9) VALUE ZEROS.
   727 77  ERNOTE-FILE-STATUS          PIC XX  VALUE LOW-VALUES.
   728 77  ERPNDB-FILE-STATUS          PIC XX  VALUE ZEROS.
   729
   730 01  misc.
   731     05  wrk-run-dte             pic 9(11) comp-3.
   732
   733 01  EXT-REC.
   734     12  EX-CARRIER            PIC X.
   735     12  FILLER                PIC X    VALUE '|'.
   736     12  EX-GROUPING           PIC X(6).
   737     12  FILLER                PIC X    VALUE '|'.
   738     12  EX-STATE              PIC XX.
   739     12  FILLER                PIC X    VALUE '|'.
   740     12  EX-ACCOUNT            PIC X(10).
   741     12  FILLER                PIC X    VALUE '|'.
   742     12  EX-CERT               PIC X(10).
   743     12  FILLER                PIC X    VALUE '|'.
   744     12  EX-CERT-SFX           PIC X.
   745     12  FILLER                PIC X    VALUE '|'.
   746     12  EX-BILL-START         PIC Z9.
   747     12  FILLER                PIC X    VALUE '|'.
   748     12  EX-BILL-END           PIC Z9.
   749     12  FILLER                PIC X    VALUE '|'.
   750     12  EX-NOTE-1             PIC X(77).
   751     12  FILLER                PIC X    VALUE '|'.
   752     12  EX-NOTE-2             PIC X(77).
   753     12  FILLER                PIC X    VALUE '|'.
   754     12  EX-NOTE-3             PIC X(77).
   755     12  FILLER                PIC X    VALUE '|'.
   756     12  EX-NOTE-4             PIC X(77).
   757     12  FILLER                PIC X    VALUE '|'.
   758     12  EX-NOTE-5             PIC X(77).
   759     12  FILLER                PIC X    VALUE '|'.
   760     12  EX-NOTE-6             PIC X(77).
   761     12  FILLER                PIC X    VALUE '|'.
   762     12  EX-NOTE-7             PIC X(77).
   763     12  FILLER                PIC X    VALUE '|'.
   764     12  EX-NOTE-8             PIC X(77).
   765     12  FILLER                PIC X    VALUE '|'.
   766     12  EX-NOTE-9             PIC X(77).
   767     12  FILLER                PIC X    VALUE '|'.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* CIUPDNOTE.cbl
   768     12  EX-NOTE-10            PIC X(77).
   769     12  FILLER                PIC X    VALUE '|'.
   770     12  EX-MAINT-BY           PIC X(4).
   771
   772
   773 PROCEDURE DIVISION.
   774
   775     PERFORM 0040-OPEN-FILES     THRU 0040-EXIT
   776     PERFORM 0050-INIT           THRU 0050-EXIT
   777
   778     PERFORM 0020-PROCESS        THRU 0020-EXIT UNTIL
   779        (END-OF-NOTE)
   780     PERFORM 0060-CLOSE-FILES    THRU 0060-EXIT
   781
   782     DISPLAY ' NOTE RECS READ  ' NOTE-RECS-IN
   783     DISPLAY ' NOTE RECS WRITE ' NOTE-RECS-OUT
   784
   785     GOBACK
   786     .
   787
   788 0010-START-ERNOTE.
   789
   790     MOVE LOW-VALUES             TO CN-CONTROL-PRIMARY
   791     MOVE ZERO                   TO CN-CARRIER
   792     MOVE X'04'                  TO CN-COMPANY-CD
   793
   794     START ERNOTE KEY IS NOT < CN-CONTROL-PRIMARY
   795
   796     IF ERNOTE-FILE-STATUS = '10' OR '23'
   797        SET END-OF-NOTE        TO TRUE
   798     ELSE
   799        IF ERNOTE-FILE-STATUS NOT = '00'
   800           DISPLAY 'ERNOTE START     ' ERNOTE-FILE-STATUS
   801           SET END-OF-NOTE     TO TRUE
   802        END-IF
   803     END-IF
   804
   805     .
   806
   807 0010-EXIT.
   808     EXIT.
   809
   810 0015-READ-ERNOTE.
   811
   812     READ ERNOTE NEXT RECORD
   813
   814     IF ERNOTE-FILE-STATUS = '00'
   815        ADD 1                    TO NOTE-RECS-IN
   816     ELSE
   817        IF (ERNOTE-FILE-STATUS = '23' OR '10')
   818           SET END-OF-NOTE     TO TRUE
   819           GO TO 0015-EXIT
   820        ELSE
   821           DISPLAY ' BAD READ ERNOTE ' CN-CONTROL-PRIMARY '  '
   822              ERNOTE-FILE-STATUS
   823           PERFORM ABEND-PGM
   824        END-IF
   825     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* CIUPDNOTE.cbl
   826
   827     IF CN-BILLING-START-LINE-NO NOT NUMERIC
   828         MOVE ZERO TO CN-BILLING-START-LINE-NO
   829     END-IF
   830     IF CN-BILLING-END-LINE-NO NOT NUMERIC
   831         MOVE ZERO TO CN-BILLING-END-LINE-NO
   832     END-IF
   833
   834     IF CN-BILLING-START-LINE-NO = ZERO AND
   835        CN-BILLING-END-LINE-NO = ZERO
   836            GO TO 0015-READ-ERNOTE
   837    END-IF.
   838
   839     .
   840 0015-EXIT.
   841     EXIT.
   842
   843 0020-PROCESS.
   844
   845     PERFORM 0025-READ-PENDING THRU 0025-EXIT
   846
   847     IF CN-CONTROL-PRIMARY = PB-CONTROL-BY-ACCOUNT (1:33)
   848          PERFORM 0015-READ-ERNOTE THRU 0015-EXIT
   849          GO TO 0020-EXIT
   850     END-IF
   851
   852
   853
   854     MOVE  CN-CARRIER            TO  EX-CARRIER
   855     MOVE  CN-GROUPING           TO  EX-GROUPING
   856     MOVE  CN-STATE              TO  EX-STATE
   857     MOVE  CN-ACCOUNT            TO  EX-ACCOUNT
   858     MOVE  CN-CERT-PRIME         TO  EX-CERT
   859     MOVE  CN-CERT-SFX           TO  EX-CERT-SFX
   860     MOVE  CN-BILLING-START-LINE-NO TO EX-BILL-START
   861     MOVE  CN-BILLING-END-LINE-NO TO EX-BILL-END
   862     MOVE  CN-LINE (1)           TO  EX-NOTE-1
   863     MOVE  CN-LINE (2)           TO  EX-NOTE-2
   864     MOVE  CN-LINE (3)           TO  EX-NOTE-3
   865     MOVE  CN-LINE (4)           TO  EX-NOTE-4
   866     MOVE  CN-LINE (5)           TO  EX-NOTE-5
   867     MOVE  CN-LINE (6)           TO  EX-NOTE-6
   868     MOVE  CN-LINE (7)           TO  EX-NOTE-7
   869     MOVE  CN-LINE (8)           TO  EX-NOTE-8
   870     MOVE  CN-LINE (9)           TO  EX-NOTE-9
   871     MOVE  CN-LINE (10)          TO  EX-NOTE-10
   872     MOVE  CN-LAST-MAINT-USER    TO  EX-MAINT-BY
   873     PERFORM 0030-WRITE-EXT  THRU 0030-EXIT
   874
   875     MOVE ZERO TO CN-BILLING-START-LINE-NO
   876                  CN-BILLING-END-LINE-NO
   877
   878     PERFORM 0035-REWRITE-ERNOTE THRU 0035-EXIT
   879
   880     PERFORM 0015-READ-ERNOTE    THRU 0015-EXIT
   881
   882
   883     .
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* CIUPDNOTE.cbl
   884 0020-EXIT.
   885      EXIT.
   886
   887 0025-READ-PENDING.
   888
   889     MOVE LOW-VALUES             TO PB-CONTROL-BY-ACCOUNT
   890     MOVE CN-COMPANY-CD          TO PB-COMPANY-CD-A1
   891     MOVE CN-CARRIER             TO PB-CARRIER
   892     MOVE CN-GROUPING            TO PB-GROUPING
   893     MOVE CN-STATE               TO PB-STATE
   894     MOVE CN-ACCOUNT             TO PB-ACCOUNT
   895     MOVE CN-CERT-EFF-DT         TO PB-CERT-EFF-DT
   896     MOVE CN-CERT-NO             TO PB-CERT-NO
   897     MOVE ZERO                   TO PB-ALT-CHG-SEQ-NO
   898     MOVE SPACES                 TO PB-RECORD-TYPE
   899
   900     START ERPNDB KEY >= PB-CONTROL-BY-ACCOUNT
   901     IF ERPNDB-FILE-STATUS NOT = '00'
   902         DISPLAY ' ERROR ON ERPNDB - START '
   903            ERPNDB-FILE-STATUS
   904            '   CERT NO = ' CN-CERT-NO
   905         GO TO 0025-EXIT
   906     END-IF
   907
   908     READ ERPNDB NEXT RECORD
   909     IF ERPNDB-FILE-STATUS NOT = '00'
   910         DISPLAY ' ERROR ON ERPNDB - READNEXT '
   911            ERPNDB-FILE-STATUS
   912            '   CERT NO = ' CN-CERT-NO
   913     END-IF
   914
   915     .
   916 0025-EXIT.
   917      EXIT.
   918
   919
   920 0030-WRITE-EXT.
   921
   922
   923     WRITE EXT-RECORD         FROM EXT-REC
   924     ADD 1                    TO NOTE-RECS-OUT
   925
   926     .
   927 0030-EXIT.
   928      EXIT.
   929
   930
   931 0035-REWRITE-ERNOTE.
   932
   933     REWRITE CERTIFICATE-NOTE
   934*     GO TO 0035-EXIT
   935
   936     IF ERNOTE-FILE-STATUS NOT = '00'
   937        DISPLAY ' ERROR - ERNOTE - REWRITE  ' ERNOTE-FILE-STATUS
   938        SET END-OF-NOTE          TO TRUE
   939     ELSE
   940        ADD 1                    TO NOTE-RECS-FIX
   941     END-IF
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* CIUPDNOTE.cbl
   942
   943     .
   944 0035-EXIT.
   945     EXIT.
   946
   947
   948
   949 0040-OPEN-FILES.
   950
   951     OPEN I-O ERNOTE
   952     OPEN INPUT ERPNDB
   953
   954     IF ERNOTE-FILE-STATUS NOT = '00'
   955        DISPLAY ' ERNOTE OPEN ' ERNOTE-FILE-STATUS
   956        PERFORM ABEND-PGM
   957     END-IF
   958
   959     IF ERPNDB-FILE-STATUS NOT = '00'
   960        DISPLAY ' ERPNDB OPEN ' ERPNDB-FILE-STATUS
   961        PERFORM ABEND-PGM
   962     END-IF
   963
   964     OPEN output ext-out.
   965
   966     .
   967 0040-EXIT.
   968     EXIT.
   969
   970 0050-INIT.
   971
   972     PERFORM 0010-START-ERNOTE   THRU 0010-EXIT
   973     PERFORM 0015-READ-ERNOTE    THRU 0015-EXIT
   974     .
   975 0050-EXIT.
   976     EXIT.
   977
   978 0060-CLOSE-FILES.
   979
   980     CLOSE ERNOTE ERPNDB
   981
   982     IF ERNOTE-FILE-STATUS NOT = '00'
   983        DISPLAY ' ERNOTE CLOSE ' ERNOTE-FILE-STATUS
   984        PERFORM ABEND-PGM
   985     END-IF
   986
   987     IF ERPNDB-FILE-STATUS NOT = '00'
   988        DISPLAY ' ERPNDB CLOSE ' ERPNDB-FILE-STATUS
   989        PERFORM ABEND-PGM
   990     END-IF
   991
   992     CLOSE EXT-OUT.
   993
   994     .
   995 0060-EXIT.
   996     EXIT.
   997
   998
   999
  1000 ABEND-PGM.
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* CIUPDNOTE.cbl
*                   COPY ELCABEND.
  1001***************************************************************** 04/14/98
  1002*                                                               * ELCABEND
  1003*                            ELCABEND.                          *    LV003
  1004*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1005*                            VMOD 2.002                              CL**2
  1006*                                                               * ELCABEND
  1007*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  1008*            AND THEN ABENDS.                                   * ELCABEND
  1009*                                                               * ELCABEND
  1010*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  1011*                                                               * ELCABEND
  1012***************************************************************** ELCABEND
  1013*APS-010.                                                         ELCABEND
  1014     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  1015     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  1016                                                                  ELCABEND
  1017     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  1018         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1019         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  1020                                 UPON CONSOLE.                    ELCABEND
  1021                                                                  ELCABEND
  1022     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  1023         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1024         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  1025                                 UPON CONSOLE.                    ELCABEND
  1026                                                                  ELCABEND
  1027     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1028     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  1029                                 UPON CONSOLE.                    ELCABEND
  1030                                                                  ELCABEND
  1031     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  1032     CALL 'ABORTME'.
  1033                                                                  ELCABEND
  1034 APS-EXIT.                                                        ELCABEND
  1035     EXIT.                                                        ELCABEND
  1036
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5248     Code:        1942
