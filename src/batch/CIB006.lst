* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* CIB006.cbl
* Options: int("CIB006.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIB006.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIB006.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"CIB006.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.    CIB006.
     3 DATE-WRITTEN.  JULY, 2000.
     4
     5*****************************************************************
     6*                                                               *
     7*  THIS PROGRAM SEARCHES FOR THE PARAMETER IN THE FIRST 7 LINES *
     8*  OF A REPORT.  IF THE PARMATER IS FOUND, THE ENTIRE PAGE IS   *
     9*  IS PRINTED, INCLUDING PRINTER CARRIAGE CONTROLS.             *
    10*                                                               *
    11*****************************************************************
    12
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* CIB006.cbl
    13/
    14 ENVIRONMENT DIVISION.
    15
    16 INPUT-OUTPUT SECTION.
    17
    18 FILE-CONTROL.
    19
    20     SELECT PRINT-LINES-IN
    21         ASSIGN TO SYS010
    22         FILE STATUS IS SYS010-STATUS.
    23
    24     SELECT PRINT-LINES-OUT
    25         ASSIGN TO SYS011.
    26
    27
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* CIB006.cbl
    28/
    29 DATA DIVISION.
    30
    31 FILE SECTION.
    32
    33 FD  PRINT-LINES-IN
    34     LABEL RECORDS ARE STANDARD
    35     RECORDING MODE IS F
    36     BLOCK CONTAINS 0 RECORDS.
    37 01  INPUT-RECORD.
    38     05  CC            PIC X.
    39     05  FILLER        PIC X(132).
    40
    41 FD  PRINT-LINES-OUT
    42     LABEL RECORDS ARE STANDARD
    43     RECORDING MODE IS F
    44     BLOCK CONTAINS 0 RECORDS.
    45 01  OUTPUT-RECORD     PIC X(133).
    46
    47
    48
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* CIB006.cbl
    50
    51 WORKING-STORAGE SECTION.
    52
    53 01  FILLER.
    54     05  S0C7             PIC X      VALUE SPACE.
    55     05  FORCE-DUMP REDEFINES S0C7 PIC S9 COMP-3.
    56     05  SYS010-STATUS    PIC X(2)   VALUE SPACE.
    57         88  EOF                     VALUE '10'.
    58     05  SUB              PIC S9(4)  BINARY SYNC VALUE +0.
    59     05  STRT             PIC S9(4)  BINARY SYNC VALUE +0.
    60     05  END-LINE         PIC S9(4)  BINARY SYNC VALUE +0.
    61     05  PRINT-SW         PIC X(3)   VALUE SPACE.
    62     05  WORK-AREA.
    63         10  SAVE-REC OCCURS 7 TIMES PIC X(133).
    64
    65
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* CIB006.cbl
    67
    68 LINKAGE SECTION.
    69
    70 01  PARM.
    71     05  PARM-LENGTH BINARY  PICTURE IS S9(4).
    72     05  PARM-VALUE  DISPLAY PICTURE IS X(20).
    73
    74
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* CIB006.cbl
    75/
    76 PROCEDURE DIVISION USING PARM.
    77
    78     PERFORM 0000-INIT-ROUTINE
    79        THRU 0000-EXIT
    80
    81     PERFORM 1000-PROCESS-FILE
    82        THRU 1000-EXIT UNTIL EOF
    83
    84     STOP RUN.
    85
    86
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* CIB006.cbl
    87/
    88 0000-INIT-ROUTINE.
    89*
    90     IF PARM-LENGTH > +50
    91        DISPLAY 'PARAMETER CANNOT BE LONGER THAN 50 CHARACTERS'
    92        ADD +1 TO FORCE-DUMP.
    93
    94*    931 = 133 * 7
    95     COMPUTE END-LINE = 931 - PARM-LENGTH
    96
    97     if parm-length > +0
    98        inspect parm-value replacing
    99           all '-' by ' '
   100     end-if
   101
   102     OPEN INPUT PRINT-LINES-IN
   103     IF SYS010-STATUS NOT = '00'
   104        DISPLAY 'OPEN ERROR ' SYS010-STATUS ' ON SYS010'
   105        ADD +1 TO FORCE-DUMP.
   106
   107     OPEN OUTPUT PRINT-LINES-OUT.
   108
   109 0000-EXIT.
   110     EXIT.
   111
   112
   113
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* CIB006.cbl
   114/
   115 1000-PROCESS-FILE.
   116*
   117     READ PRINT-LINES-IN
   118          AT END GO TO 1000-EXIT.
   119
   120     IF CC = '1'
   121        PERFORM 2000-NEW-PAGE THRU 2000-EXIT.
   122
   123     IF PRINT-SW = 'YES'
   124        WRITE OUTPUT-RECORD FROM INPUT-RECORD.
   125
   126 1000-EXIT.
   127     EXIT.
   128
   129
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* CIB006.cbl
   130/
   131 2000-NEW-PAGE.
   132*
   133     IF PARM-LENGTH = +0
   134        MOVE 'YES' TO PRINT-SW
   135        GO TO 2000-EXIT.
   136
   137     MOVE SPACES TO WORK-AREA
   138     MOVE INPUT-RECORD TO SAVE-REC(1)
   139     PERFORM VARYING SUB FROM 2 BY 1
   140               UNTIL SUB > 7  OR  EOF
   141        READ PRINT-LINES-IN
   142             NOT AT END MOVE INPUT-RECORD TO SAVE-REC(SUB)
   143        END-READ
   144     END-PERFORM
   145
   146     MOVE 'NO' TO PRINT-SW
   147
   148     PERFORM VARYING STRT FROM 1 BY 1
   149               UNTIL PRINT-SW = 'YES'
   150                  OR STRT > END-LINE
   151         IF WORK-AREA(STRT:PARM-LENGTH) =
   152            PARM-VALUE(1:PARM-LENGTH)
   153              MOVE 'YES' TO PRINT-SW
   154         END-IF
   155     END-PERFORM
   156
   157     IF PRINT-SW = 'YES'
   158        PERFORM VARYING SUB FROM 1 BY 1 UNTIL SUB > 6
   159          WRITE OUTPUT-RECORD FROM SAVE-REC(SUB)
   160        END-PERFORM
   161     END-IF
   162     .
   163 2000-EXIT.
   164     EXIT.
   165
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2620     Code:         912
