* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   1
* ECS201.cbl
* Options: int("ECS201.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("ECS201.lst")
     1$SET ALTER
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" ALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ECS201.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ECS201.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 ID DIVISION.                                                     00000010
     3                                                                  00000020
     4 PROGRAM-ID.                     ECS201.                          00000030
     5*                            VMOD=2.001.                          00000040
     6                                                                  00000050
     7                                                                  00000060
     8 AUTHOR.     LOGIC, INC.                                          00000070
     9             DALLAS, TEXAS.                                       00000080
    10                                                                  00000090
    11 DATE-COMPILED. 06-Oct-15 17:18.
    13 SECURITY.   *****************************************************00000120
    14             *                                                   *00000130
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   2
* ECS201.cbl
    15             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *00000140
    16             *                                                   *00000150
    17             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *00000160
    18             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *00000170
    19             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *00000180
    20             *                                                   *00000190
    21             *****************************************************00000200
    22                                                                  00000210
    23 REMARKS.                                                         00000220
    24                                                                  00000230
    25     PRINT DOCUMENTATION MANUAL FROM CARD INPUT AND TAPE          00000240
    26             MANUAL SELECTION IS VIA A FINDER CARD                00000250
    27                 (MANUAL NAME IN COL 1-8 OF FINDER).              00000260
    28     PRINT DOCUMENTATION MANUAL FROM ICCF CARD IMAGES.            00000270
    29                                                                  00000280
    30     INPUT CARD FORMAT - COL. 1-2 = TT                            00000290
    31                         COL. 3-72 = DATA                         00000300
    32                         COL. 73-80 = UNUSED                      00000310
    33                                                                  00000320
    34     CONTROL FIELD - ** = MANUAL TITLE                            00000330
    35                     *C = CHAPTER TITLE                           00000340
    36                     *S = SECTION TITLE                           00000350
    37                     *P = PARAGRAPH TITLE                         00000360
    38                     *T = INSERT TABLE OF CONTENTS                00000370
    39                     NN = SKIP LINES AFTER PRINT                  00000380
    40                           IF NN = 01 SPACE 1 LINE AFTER          00000390
    41                           IF NN = 02 SPACE 2 LINES AFTER         00000400
    42                           IF NN = 99 SPACE 99 LINES AFTER        00000410
    43                           IF NN NOT NUMERIC, IGNORED.            00000420
    44                                                                  00000430
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   3
* ECS201.cbl
    46 ENVIRONMENT DIVISION.                                            00000450
    47 INPUT-OUTPUT SECTION.                                            00000460
    48 FILE-CONTROL.                                                    00000470
    49                                                                  00000480
    50     SELECT SORT-FILE     ASSIGN TO 2 SYS001-UT-FBA1-S-SORTWK1.   00000490
    51                                                                  00000500
    52     SELECT DOCU-CARD     ASSIGN TO SYS006-UR-2540R-S-SYS006.     00000510
    53                                                                  00000520
    54     SELECT PRNT-FILE     ASSIGN TO SYS008-UR-1403-S-SYS008.      00000530
    55                                                                  00000540
    56     SELECT INDX-FILE     ASSIGN TO SYS016-UT-FBA1-S-SYS016.      00000550
    57                                                                  00000560
    58     SELECT CNTR-FILE     ASSIGN TO SYS017-UT-FBA1-S-SYS017.      00000570
    59                                                                  00000580
    60     SELECT CNTR-FILE-R   ASSIGN TO SYS014-UT-FBA1-S-SYS014.      00000590
    61                                                                  00000600
    62     SELECT WORK-FILE     ASSIGN TO SYS018-UT-FBA1-S-SYS018.      00000610
    63                                                                  00000620
    64     SELECT FICH          ASSIGN TO SYS020-UT-2400-S-SYS020.      00000630
    65                                                                  00000640
    66     SELECT DOCU-TAPE     ASSIGN TO SYS010-UT-2400-S-SYS010.      00000650
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   4
* ECS201.cbl
    68 DATA DIVISION.                                                   00000670
    69 FILE SECTION.                                                    00000680
    70 FD  PRNT-FILE
*                            COPY ELCPRTFD.                             00000690
    71******************************************************************04/15/98
    72*                                                                *ELCPRTFD
    73*                                                                *ELCPRTFD
    74*                            ELCPRTFD.                           *   LV003
    75*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
    76*                            VMOD=2.006                          *ELCPRTFD
    77******************************************************************ELCPRTFD
    78     RECORDING MODE F                                             ELCPRTFD
    79     LABEL RECORDS OMITTED                                        ELCPRTFD
    80     BLOCK CONTAINS 0 RECORDS
    81     RECORD CONTAINS 133 CHARACTERS.                              ELCPRTFD
    82 01  PRT.                                                         ELCPRTFD
    83     12  P-CTL               PIC  X.                                 CL**2
    84     12  P-DATA              PIC  X(132).                         ELCPRTFD
    85******************************************************************ELCPRTFD
    86                                                                  00000700
    87 01  PRT-1.                                                       00000710
    88     12  FILLER                  PIC XXXX.                        00000720
    89     12  P-DESC                  PIC X(73).                       00000730
    90     12  FILLER                  PIC X(56).                       00000740
    91                                                                  00000750
    92 01  PRT-2.                                                       00000760
    93     12  FILLER                  PIC XXXX.                        00000770
    94     12  PRT-2-DTL.                                               00000780
    95         16  PRT-2-TD            PIC X       OCCURS 70 TIMES.     00000790
    96     12  PRT-2-PGNO              PIC ZZZZZ.                       00000800
    97     12  FILLER                  PIC X(54).                       00000810
    98                                                                  00000820
    99 01  PRT-2A.                                                      00000830
   100     12  FILLER                  PIC XXXX.                        00000840
   101     12  FILLER                  PIC X(46).                       00000850
   102     12  PRT-2E-PGNO             PIC ZZZZZ.                       00000860
   103     12  PRT-2D-PGNO             PIC ZZZZZ.                       00000870
   104     12  PRT-2C-PGNO             PIC ZZZZZ.                       00000880
   105     12  PRT-2B-PGNO             PIC ZZZZZ.                       00000890
   106     12  PRT-2A-PGNO             PIC ZZZZZ.                       00000900
   107     12  FILLER                  PIC X(58).                       00000910
   108                                                                  00000920
   109 01  PRT-3.                                                       00000930
   110     12  FILLER                  PIC X(8).                        00000940
   111     12  PRT-3-DTL               PIC X(66).                       00000950
   112     12  FILLER                  PIC X(59).                       00000960
   113                                                                  00000970
   114 FD  DOCU-CARD                                                    00000980
   115     RECORDING MODE F                                             00000990
   116     LABEL RECORDS OMITTED.                                       00001000
   117 01  DOCU-CARD-REC               PIC X(80).                       00001010
   118                                                                  00001020
   119 01  D-FINDER.                                                    00001030
   120     12  D-MANUAL                PIC X(8).                        00001040
   121     12  FILLER                  PIC X(72).                       00001050
   122                                                                  00001060
   123 FD  INDX-FILE                                                    00001070
   124     RECORDING MODE F                                             00001080
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   5
* ECS201.cbl
   125     LABEL RECORDS STANDARD                                       00001090
   126*    BLOCK CONTAINS 0 RECORDS                                     00001100
   127     BLOCK CONTAINS 0 RECORDS.                                    00001100
   128 01  INDX-REC.                                                    00001110
   129     12  INDX-IND.                                                00001120
   130         16  INDX-CTL            PIC XX.                          00001130
   131         16  INDX-DATA           PIC X(70).                       00001140
   132     12  INDX-PG                 PIC S9(5)   COMP-3.              00001150
   133                                                                  00001160
   134 FD  CNTR-FILE                                                    00001170
   135     RECORDING MODE F                                             00001180
   136     LABEL RECORDS STANDARD                                       00001190
   137     BLOCK CONTAINS 0 RECORDS                                     00001200
   138     RECORD CONTAINS 83 CHARACTERS.                               00001210
   139 01  CNTR-REC.                                                    00001220
   140     12  CNTR-NAME               PIC X(80).                       00001230
   141     12  CNTR-PG                 PIC S9(5)   COMP-3.              00001240
   142                                                                  00001250
   143 FD  CNTR-FILE-R                                                  00001260
   144     RECORDING MODE F                                             00001270
   145     LABEL RECORDS STANDARD                                       00001280
   146     BLOCK CONTAINS 0 RECORDS                                     00001290
   147     RECORD CONTAINS 83 CHARACTERS.                               00001300
   148 01  CNTR-REC-R.                                                  00001310
   149     12  CNTR-NAME-R             PIC X(80).                       00001320
   150     12  CNTR-PG-R               PIC S9(5)   COMP-3.              00001330
   151                                                                  00001340
   152 SD  SORT-FILE                                                    00001350
   153     RECORDING MODE F                                             00001360
   154     LABEL RECORDS STANDARD.                                      00001370
   155 01  SORT-REC.                                                    00001380
   156     12  SORT-CTL                PIC X(80).                       00001390
   157     12  SORT-PG                 PIC S9(5)   COMP-3.              00001400
   158                                                                  00001410
   159 FD  WORK-FILE                                                    00001420
   160     RECORDING MODE F                                             00001430
   161     LABEL RECORDS STANDARD                                       00001440
   162     BLOCK CONTAINS 0 RECORDS                                     00001450
   163     RECORD CONTAINS 133 CHARACTERS.                              00001460
   164 01  WORK-FILE-REC.                                               00001470
   165     12  WF-CTL                  PIC X.                           00001480
   166     12  WF-DATA.                                                 00001490
   167         16  WFX-CTL             PIC XX.                          00001500
   168         16  WF-DESC             PIC X(78).                       00001510
   169         16  FILLER              PIC X(52).                       00001520
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   6
* ECS201.cbl
   171 FD  FICH                                                         00001540
*  172                             COPY ECSFICH.                        00001550
   173******************************************************************10/06/86
   174*                                                                *ECSFICH
   175*                            ECSFICH                             *   LV001
   176*                            VMOD=2.001                          *ECSFICH
   177*                                                                *ECSFICH
   178*  NO  CSO  MODS  IN  COPYBOOK  ECSFICH                          *ECSFICH
   179*                                                                *ECSFICH
   180******************************************************************ECSFICH
   181     RECORDING MODE F                                             ECSFICH
   182     LABEL RECORDS STANDARD                                       ECSFICH
   183     BLOCK CONTAINS 0 RECORDS
   184     RECORD CONTAINS 133 CHARACTERS.                              ECSFICH
   185 01  FICH-REC                PIC  X(133).                         ECSFICH
   186******************************************************************ECSFICH
   187 FD  DOCU-TAPE                                                    00001560
   188     RECORDING MODE F                                             00001570
   189     LABEL RECORDS STANDARD                                       00001580
   190*    BLOCK CONTAINS 0 RECORDS                                     00001590
   191     BLOCK CONTAINS 0 RECORDS.                                    00001590
   192 01  DOCU-TAPE-REC               PIC X(80).                       00001600
   193                                                                  00001610
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   7
* ECS201.cbl
   195 WORKING-STORAGE SECTION.                                         00001630
   196 77  FILLER  PIC X(32) VALUE '********************************'.  00001640
   197 77  FILLER  PIC X(32) VALUE '     ECS201 WORKING STARAGE     '.  00001650
   198 77  FILLER  PIC X(32) VALUE '*****V/M=2.001******************'.  00001660
   199                                                                  00001670
   200 77  FOUND-SW                    PIC X      VALUE SPACE.          00001680
   201     88  FOUND                              VALUE '1'.            00001690
   202 77  FINDER-SW                   PIC X      VALUE SPACE.          00001700
   203     88  FINDER                             VALUE '1'.            00001710
   204                                                                  00001720
   205 77  NO-COLONS                   PIC S9999  COMP.                 00001730
   206                                                                  00001740
   207 01  WS-ACCEPT-DATE.                                              00001750
   208     12  WS-AD-YY                    PIC 99.                      00001760
   209     12  WS-AD-MM                    PIC 99.                      00001770
   210     12  WS-AD-DD                    PIC 99.                      00001780
   211                                                                  00001790
   212 01  WS-CURRENT-DATE.                                             00001800
   213     12  WS-CD-MM                    PIC 99.                      00001810
   214     12  FILLER                      PIC X      VALUE '/'.        00001820
   215     12  WS-CD-DD                    PIC 99.                      00001830
   216     12  FILLER                      PIC X      VALUE '/'.        00001840
   217     12  WS-CD-YY                    PIC 99.                      00001850
   218                                                                  00001860
   219 01  HD1.                                                         00001870
   220     12  HD-MAJ                  PIC X(66)   VALUE SPACES.        00001880
   221     12  FILLER                  PIC X(6)    VALUE ' PAGE '.      00001890
   222     12  HD-PG                   PIC ZZ,ZZZ.                      00001900
   223                                                                  00001910
   224 01  HD2.                                                         00001920
   225     12  HD-SS                   PIC X(70)   VALUE SPACES.        00001930
   226     12  HD-DT                   PIC X(8)    VALUE SPACES.        00001940
   227                                                                  00001950
   228 01  HD3.                                                         00001960
   229     12  HD-HD                   PIC X(76)   VALUE SPACES.        00001970
   230                                                                  00001980
   231 01  HD4.                                                         00001990
   232     12  HD-MAJ2                 PIC X(73).                       00002000
   233                                                                  00002010
   234 01  HD5.                                                         00002020
   235     12  HD-TOC                  PIC X(18)   VALUE                00002030
   236        'TABLE OF CONTENTS'.                                      00002040
   237     12  HD-CNT                  PIC X(11)   VALUE                00002050
   238        '(CONTINUED)'.                                            00002060
   239                                                                  00002070
   240 01  WS-DOCU-REC.                                                 00002080
   241     12  WSD-ID.                                                  00002090
   242         16  WSD-ID-R            PIC 99.                          00002100
   243     12  WSD-DESC.                                                00002110
   244         16  WSD-SS              PIC X(57).                       00002120
   245         16  FILLER              PIC X(21).                       00002130
   246                                                                  00002140
   247 01  WS-DOCU-REC-R REDEFINES WS-DOCU-REC.                         00002150
   248     12  XSD-ID                  PIC XXX.                         00002160
   249     12  XSD-SEQ                 PIC XXXX.                        00002170
   250     12  XSD-DESC.                                                00002180
   251         16  XSD-SS              PIC X(57).                       00002190
   252         16  FILLER              PIC X(16).                       00002200
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   8
* ECS201.cbl
   253                                                                  00002210
   254 01  WS-DOCU-REC-F REDEFINES WS-DOCU-REC.                         00002220
   255     12  F-FINDER                PIC X(8).                        00002230
   256     12  FILLER                  PIC X(72).                       00002240
   257                                                                  00002250
   258 01  TAPE-REC-1    REDEFINES WS-DOCU-REC.                         00002260
   259     12  DOC-ID.                                                  00002270
   260         16  DOC-TAPE            PIC XX.                          00002280
   261         16  DOC-NAME            PIC X(8).                        00002290
   262     12  DOC-MANUAL              PIC X(8).                        00002300
   263     12  FILLER                  PIC X(62).                       00002310
   264                                                                  00002320
   265                                                                  00002330
   266 01  TEST-PRT.                                                    00002340
   267     12  FILLER                  PIC X(24)   VALUE                00002350
   268        'LINEUP RIGHT PERFORATION'.                               00002360
   269     12  FILLER                  PIC X(26)   VALUE                00002370
   270        ' BETWEEN PERIODS #########'.                             00002380
   271     12  FILLER                  PIC X(33)   VALUE                00002390
   272        '############################. .'.                        00002400
   273                                                                  00002410
   274 01  INDEX-WORK-AREA.                                             00002420
   275     12  WS-INDX.                                                 00002430
   276         16  WS-INDX-O           PIC X       OCCURS 80 TIMES.     00002440
   277                                                                  00002450
   278 01  INPUT-INDEX-AREA.                                            00002460
   279     12  I-I-A.                                                   00002470
   280         16  I-A                 PIC X       OCCURS 73 TIMES.     00002480
   281                                                                  00002490
   282 01  BINARY-WORK-AREA    COMP.                                    00002500
   283     12  X1                      PIC S999    VALUE +0.            00002510
   284     12  X2                      PIC S999    VALUE +0.            00002520
   285     12  X3                      PIC S999    VALUE +0.            00002530
   286     12  X4                      PIC S999    VALUE +0.            00002540
   287     12  B1                      PIC S999    VALUE +1.            00002550
   288     12  B2                      PIC S999    VALUE +2.            00002560
   289     12  B69                     PIC S999    VALUE +69.           00002570
   290     12  B70                     PIC S999    VALUE +70.           00002580
   291     12  B80                     PIC S999    VALUE +80.           00002590
   292     12  B12                     PIC S999    VALUE +12.           00002600
   293                                                                  00002610
   294 01  MISC-COMP-3-AREA    COMP-3.                                  00002620
   295     12  LN-CT                   PIC S999    VALUE +99.           00002630
   296     12  PG-NO                   PIC S9(5)   VALUE +0.            00002640
   297     12  K1                      PIC S999    VALUE +1.            00002650
   298     12  K99                     PIC S999    VALUE +99.           00002660
   299     12  LN-MX                   PIC S999    VALUE +53.           00002670
   300     12  K0                      PIC S999    VALUE +0.            00002680
   301     12  SAVE-PAGE               PIC S9(5)   VALUE +0.            00002690
   302     12  NEW-PAGE-SW             PIC S9      VALUE +0.            00002700
   303                                                                  00002710
   304 01  MISC-WORK-AREA.                                              00002720
   305     12  SV-CTL                  PIC XX.                          00002730
   306     12  K-CNTD                  PIC X(11)   VALUE '(CONTINUED)'. 00002740
   307     12  K-CNTD-R REDEFINES K-CNTD.                               00002750
   308         16  K-C                 PIC X       OCCURS 11 TIMES.     00002760
   309     12  KEY-WORD-SWITCH         PIC X       VALUE ' '.           00002770
   310     12  K-COLON                 PIC X       VALUE ':'.           00002780
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page   9
* ECS201.cbl
   311     12  PG-ONE                  PIC X       VALUE ' '.           00002790
   312                                                                  00002800
   313     12  FICH-SW                 PIC X       VALUE SPACE.         00002810
   314                                                                  00002820
   315         88  FICHE     VALUE 'X'.                                 00002830
   316                                                                  00002840
   317     12  SAVE-TOC.                                                00002850
   318                                                                  00002860
   319         16  SV-TOC      PIC X     OCCURS 80.                     00002870
   320                                                                  00002880
   321     12  TAPE-INPUT      PIC X(3)       VALUE 'NO '.              00002890
   322     12  ABEND-CODE      PIC X(4)       VALUE SPACE.              00002900
   323     12  ABEND-OPTION    PIC X          VALUE 'Y'.                00002910
   324     12  PGM-SUB         PIC S999    COMP  VALUE +201.            00002920
   325     12  MANUAL-NAME     PIC X(8)       VALUE SPACES.             00002930
   326                                                                  00002940
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  10
* ECS201.cbl
   328 PROCEDURE DIVISION.                                              00002960
   329 HSKPG.                                                           00002970
   330     OPEN INPUT DOCU-CARD                                         00002980
   331          OUTPUT INDX-FILE                                        00002990
   332                 CNTR-FILE                                        00003000
   333                 WORK-FILE                                        00003010
   334                 PRNT-FILE.                                       00003020
   335                                                                  00003030
   336     MOVE '1' TO P-CTL.                                           00003040
   337     MOVE +0 TO LN-CT.                                            00003050
   338                                                                  00003060
   339     ACCEPT WS-ACCEPT-DATE FROM DATE.                             00003070
   340     MOVE WS-AD-YY               TO WS-CD-YY.                     00003080
   341     MOVE WS-AD-MM               TO WS-CD-MM.                     00003090
   342     MOVE WS-AD-DD               TO WS-CD-DD.                     00003100
   343                                                                  00003110
   344     MOVE WS-CURRENT-DATE TO HD-DT.                               00003120
   345                                                                  00003130
   346 HSKPG-READ.                                                      00003140
   347     READ DOCU-CARD INTO WS-DOCU-REC                              00003150
   348             AT END GO TO BOJ-ABORT.                              00003160
   349                                                                  00003170
   350     IF DOC-TAPE = 'TT'                                           00003180
   351         MOVE DOC-NAME TO MANUAL-NAME                             00003190
   352         ALTER MAIN-READ TO PROCEED TO READ-TAPE                  00003200
   353         MOVE 'YES' TO TAPE-INPUT                                 00003210
   354         OPEN INPUT DOCU-TAPE                                     00003220
   355         GO TO SCAN-FOR-MANUAL.                                   00003230
   356                                                                  00003240
   357 HSK-2.                                                           00003250
   358     IF WSD-ID NOT = '**'                                         00003260
   359        IF XSD-ID NOT = '*K*' AND '*M*'                           00003270
   360           GO TO BOJ-ABORT.                                       00003280
   361                                                                  00003290
   362     DISPLAY WSD-DESC UPON CONSOLE.                               00003300
   363                                                                  00003310
   364     IF WSD-ID = '**'                                             00003320
   365         ALTER MAIN-LOOP TO PROCEED TO CHECK-NEW-CTL.             00003330
   366                                                                  00003340
   367 AGAIN-TST.                                                       00003350
   368     MOVE TEST-PRT TO P-DATA.                                     00003360
   369                                                                  00003370
   370     PERFORM PRINT-RTN-2.                                         00003380
   371                                                                  00003390
   372     IF LN-CT LESS LN-MX                                          00003400
   373         GO TO AGAIN-TST.                                         00003410
   374                                                                  00003420
   375     MOVE +99 TO LN-CT.                                           00003430
   376                                                                  00003440
   377     IF XSD-ID = '*M*' OR '*K*'                                   00003450
   378          MOVE XSD-DESC TO WSD-DESC                               00003460
   379          MOVE '**'     TO WSD-ID.                                00003470
   380                                                                  00003480
   381     MOVE WSD-DESC TO HD-MAJ                                      00003490
   382                      HD-MAJ2.                                    00003500
   383                                                                  00003510
   384 MAIN-LOOP.                                                       00003520
   385     GO TO CHECK-OLD-CTL.                                         00003530
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  11
* ECS201.cbl
   386                                                                  00003540
   387 CHECK-OLD-CTL.                                                   00003550
   388     IF WSD-ID = '**'                                             00003560
   389         GO TO CHECK-NEW-CTL.                                     00003570
   390                                                                  00003580
   391     IF XSD-ID = '*H*'                                            00003590
   392         MOVE '*C' TO WSD-ID                                      00003600
   393         GO TO SHIFT-OLD.                                         00003610
   394                                                                  00003620
   395     IF XSD-ID = '*HH'                                            00003630
   396         MOVE '*S' TO WSD-ID                                      00003640
   397         GO TO SHIFT-OLD.                                         00003650
   398                                                                  00003660
   399     IF XSD-ID = '*T*'                                            00003670
   400         MOVE '*T' TO WSD-ID                                      00003680
   401         GO TO SHIFT-OLD.                                         00003690
   402                                                                  00003700
   403     IF XSD-ID = '*S1'                                            00003710
   404         MOVE '01' TO WSD-ID                                      00003720
   405         GO TO SHIFT-OLD.                                         00003730
   406                                                                  00003740
   407     IF XSD-ID = '*S2'                                            00003750
   408         MOVE '02' TO WSD-ID                                      00003760
   409         GO TO SHIFT-OLD.                                         00003770
   410                                                                  00003780
   411     IF XSD-ID = '*S3'                                            00003790
   412         MOVE '03' TO WSD-ID                                      00003800
   413         GO TO SHIFT-OLD.                                         00003810
   414                                                                  00003820
   415     IF XSD-ID = '*S4'                                            00003830
   416         MOVE '04' TO WSD-ID                                      00003840
   417         GO TO SHIFT-OLD.                                         00003850
   418                                                                  00003860
   419     IF XSD-ID = '*S5'                                            00003870
   420         MOVE '05' TO WSD-ID                                      00003880
   421         GO TO SHIFT-OLD.                                         00003890
   422                                                                  00003900
   423     IF XSD-ID = '*S6'                                            00003910
   424         MOVE '06' TO WSD-ID                                      00003920
   425         GO TO SHIFT-OLD.                                         00003930
   426                                                                  00003940
   427     IF XSD-ID = '*S7'                                            00003950
   428         MOVE '07' TO WSD-ID                                      00003960
   429         GO TO SHIFT-OLD.                                         00003970
   430                                                                  00003980
   431     IF XSD-ID = '*S8'                                            00003990
   432         MOVE '08' TO WSD-ID                                      00004000
   433         GO TO SHIFT-OLD.                                         00004010
   434                                                                  00004020
   435     IF XSD-ID = '*S9'                                            00004030
   436         MOVE '09' TO WSD-ID                                      00004040
   437         GO TO SHIFT-OLD.                                         00004050
   438                                                                  00004060
   439     IF XSD-ID = '*S0'                                            00004070
   440         MOVE '10' TO WSD-ID                                      00004080
   441         GO TO SHIFT-OLD.                                         00004090
   442                                                                  00004100
   443     IF XSD-ID = '*SA'                                            00004110
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  12
* ECS201.cbl
   444         MOVE '11' TO WSD-ID                                      00004120
   445         GO TO SHIFT-OLD.                                         00004130
   446                                                                  00004140
   447     IF XSD-ID = '*SB'                                            00004150
   448         MOVE '12' TO WSD-ID                                      00004160
   449         GO TO SHIFT-OLD.                                         00004170
   450                                                                  00004180
   451     IF XSD-ID = '*SC'                                            00004190
   452         MOVE '13' TO WSD-ID                                      00004200
   453         GO TO SHIFT-OLD.                                         00004210
   454                                                                  00004220
   455     IF XSD-ID = '*SD'                                            00004230
   456         MOVE '14' TO WSD-ID                                      00004240
   457         GO TO SHIFT-OLD.                                         00004250
   458                                                                  00004260
   459     IF XSD-ID = '*SE'                                            00004270
   460         MOVE '15' TO WSD-ID                                      00004280
   461         GO TO SHIFT-OLD.                                         00004290
   462                                                                  00004300
   463     IF XSD-ID = '*SF'                                            00004310
   464         MOVE '16' TO WSD-ID                                      00004320
   465         GO TO SHIFT-OLD.                                         00004330
   466                                                                  00004340
   467     IF XSD-ID = '*SG'                                            00004350
   468         MOVE '17' TO WSD-ID                                      00004360
   469         GO TO SHIFT-OLD.                                         00004370
   470                                                                  00004380
   471     IF XSD-ID = '*SH'                                            00004390
   472         MOVE '18' TO WSD-ID                                      00004400
   473         GO TO SHIFT-OLD.                                         00004410
   474                                                                  00004420
   475     IF XSD-ID = '*SI'                                            00004430
   476         MOVE '19' TO WSD-ID                                      00004440
   477         GO TO SHIFT-OLD.                                         00004450
   478                                                                  00004460
   479     MOVE SPACES TO WSD-ID.                                       00004470
   480                                                                  00004480
   481 SHIFT-OLD.                                                       00004490
   482     MOVE XSD-DESC TO WSD-DESC.                                   00004500
   483                                                                  00004510
   484 CHECK-NEW-CTL.                                                   00004520
   485     IF WSD-ID = '**'                                             00004530
   486         GO TO SET-MANUAL-TITLE.                                  00004540
   487                                                                  00004550
   488     IF WSD-ID = '*C'                                             00004560
   489         GO TO SET-CHAPTER.                                       00004570
   490                                                                  00004580
   491     IF WSD-ID = '*S'                                             00004590
   492         GO TO SET-SECTION.                                       00004600
   493                                                                  00004610
   494     IF WSD-ID = '*P'                                             00004620
   495         GO TO SET-PARA.                                          00004630
   496                                                                  00004640
   497     IF WSD-ID = '*T'                                             00004650
   498         GO TO SET-TOX.                                           00004660
   499                                                                  00004670
   500     IF LN-CT GREATER LN-MX                                       00004680
   501         PERFORM PT-HEAD.                                         00004690
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  13
* ECS201.cbl
   502                                                                  00004700
   503     IF WSD-ID = '*/'                                             00004710
   504         MOVE SPACES             TO  WSD-ID                       00004720
   505         MOVE +1                 TO  NEW-PAGE-SW.                 00004730
   506                                                                  00004740
   507     MOVE SPACES   TO WORK-FILE-REC.                              00004750
   508     MOVE WSD-DESC TO WF-DESC.                                    00004760
   509                                                                  00004770
   510 PRINT-RTN-1.                                                     00004780
   511     IF LN-CT GREATER LN-MX                                       00004790
   512         PERFORM PT-HEAD.                                         00004800
   513                                                                  00004810
   514     MOVE ZEROS TO NO-COLONS.                                     00004820
   515                                                                  00004830
   516     INSPECT WORK-FILE-REC                                        00004840
   517             TALLYING NO-COLONS FOR ALL ':'.                      00004850
   518                                                                  00004860
   519     IF NO-COLONS GREATER ZERO                                    00004870
   520         PERFORM KEY-WORD-XTRCT  THRU K-W-X.                      00004880
   521                                                                  00004890
   522     TRANSFORM WORK-FILE-REC CHARACTERS FROM ':' TO ' '.          00004900
   523                                                                  00004910
   524     WRITE WORK-FILE-REC                                          00004920
   525           INVALID KEY GO TO SPOOL-FULL.                          00004930
   526                                                                  00004940
   527     MOVE SPACES TO WORK-FILE-REC.                                00004950
   528                                                                  00004960
   529     ADD K1 TO LN-CT.                                             00004970
   530                                                                  00004980
   531     IF NEW-PAGE-SW = +1                                          00004990
   532         MOVE ZERO               TO  NEW-PAGE-SW                  00005000
   533         PERFORM PT-HEAD.                                         00005010
   534                                                                  00005020
   535 CHECK-KEYWORD.                                                   00005030
   536     IF WSD-ID-R NUMERIC                                          00005040
   537         PERFORM PRINT-RTN-1 WSD-ID-R TIMES.                      00005050
   538                                                                  00005060
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  14
* ECS201.cbl
   540 MAIN-READ.                                                       00005080
   541     GO TO READ-CARDS.                                            00005090
   542                                                                  00005100
   543 READ-CARDS.                                                      00005110
   544     READ DOCU-CARD INTO WS-DOCU-REC                              00005120
   545             AT END GO TO END-SPOOL.                              00005130
   546                                                                  00005140
   547     GO TO M-R-X.                                                 00005150
   548                                                                  00005160
   549 READ-TAPE.                                                       00005170
   550     READ DOCU-TAPE INTO WS-DOCU-REC AT END                       00005180
   551             GO TO END-SPOOL.                                     00005190
   552 RT-CHECK.                                                        00005200
   553     IF XSD-ID = '$$$'                                            00005210
   554        GO TO READ-TAPE.                                          00005220
   555                                                                  00005230
   556     IF DOC-ID = ' *MANUAL* '                                     00005240
   557*       IF MANUAL-NAME = 'ALL'                                    00005250
   558*          GO TO READ-TAPE                                        00005260
   559*     ELSE                                                        00005270
   560          GO TO END-SPOOL.                                        00005280
   561                                                                  00005290
   562     GO TO M-R-X.                                                 00005300
   563                                                                  00005310
   564 M-R-X.                                                           00005320
   565     GO TO MAIN-LOOP.                                             00005330
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  15
* ECS201.cbl
   567 SET-TOX.                                                         00005350
   568     MOVE SPACES TO WORK-FILE-REC.                                00005360
   569     MOVE '*T' TO WFX-CTL.                                        00005370
   570                                                                  00005380
   571     GO TO PRINT-RTN-1.                                           00005390
   572                                                                  00005400
   573 SET-MANUAL-TITLE.                                                00005410
   574     MOVE K99 TO LN-CT.                                           00005420
   575     MOVE K1 TO PG-NO.                                            00005430
   576     MOVE WSD-DESC TO HD-MAJ HD-MAJ2.                             00005440
   577     GO TO MAIN-READ.                                             00005450
   578                                                                  00005460
   579 SET-CHAPTER.                                                     00005470
   580     MOVE K99 TO LN-CT.                                           00005480
   581     MOVE WSD-SS TO HD-SS.                                        00005490
   582     MOVE  PG-NO TO INDX-PG.                                      00005500
   583                                                                  00005510
   584     IF WSD-SS = SPACES GO TO MAIN-READ.                          00005520
   585                                                                  00005530
   586 BUILD-TOC.                                                       00005540
   587     MOVE WS-DOCU-REC TO INDX-IND.                                00005550
   588                                                                  00005560
   589     PERFORM BUILD-INDEX THRU B-I-X.                              00005570
   590                                                                  00005580
   591     WRITE INDX-REC INVALID KEY GO TO TOC-FULL.                   00005590
   592                                                                  00005600
   593 B-T-X.                                                           00005610
   594     EXIT.                                                        00005620
   595                                                                  00005630
   596 S-S-X.                                                           00005640
   597     GO TO MAIN-READ.                                             00005650
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  16
* ECS201.cbl
   599 SET-SECTION.                                                     00005670
   600     MOVE WSD-DESC TO HD-HD.                                      00005680
   601                                                                  00005690
   602     IF WSD-DESC = SPACES                                         00005700
   603         GO TO MAIN-READ.                                         00005710
   604                                                                  00005720
   605     MOVE 'X' TO PG-ONE.                                          00005730
   606                                                                  00005740
   607 PT-HEAD.                                                         00005750
   608     MOVE K0 TO LN-CT.                                            00005760
   609                                                                  00005770
   610     PERFORM PT-HDNG.                                             00005780
   611                                                                  00005790
   612     MOVE HD3 TO WF-DATA.                                         00005800
   613     MOVE '-' TO WF-CTL.                                          00005810
   614                                                                  00005820
   615     IF PG-ONE = ' '   MOVE SPACES TO WF-DATA                     00005830
   616                       MOVE 'X' TO PG-ONE.                        00005840
   617                                                                  00005850
   618     PERFORM PRINT-RTN-1.                                         00005860
   619                                                                  00005870
   620     MOVE '0' TO WF-CTL.                                          00005880
   621                                                                  00005890
   622     PERFORM PRINT-RTN-1.                                         00005900
   623                                                                  00005910
   624 INSERT-CONTD.                                                    00005920
   625     MOVE HD3 TO WS-INDX.                                         00005930
   626     MOVE B80 TO X1.                                              00005940
   627                                                                  00005950
   628 I-C-LP.                                                          00005960
   629     IF WS-INDX-O (X1) NOT = ' '                                  00005970
   630         GO TO INS-CT.                                            00005980
   631                                                                  00005990
   632     SUBTRACT B1 FROM X1.                                         00006000
   633                                                                  00006010
   634     IF X1 NOT = B2                                               00006020
   635         GO TO I-C-LP.                                            00006030
   636                                                                  00006040
   637 INS-CT.                                                          00006050
   638     ADD B2 TO X1.                                                00006060
   639     MOVE B1 TO X2.                                               00006070
   640                                                                  00006080
   641 I-C-MV.                                                          00006090
   642     MOVE K-C (X2) TO WS-INDX-O (X1).                             00006100
   643                                                                  00006110
   644     ADD B1 TO X2.                                                00006120
   645     ADD B1 TO X1.                                                00006130
   646                                                                  00006140
   647     IF X2 = B12 OR                                               00006150
   648        X1 GREATER B80                                            00006160
   649             GO TO I-C-X.                                         00006170
   650                                                                  00006180
   651     GO TO I-C-MV.                                                00006190
   652                                                                  00006200
   653 I-C-X.                                                           00006210
   654     EXIT.                                                        00006220
   655                                                                  00006230
   656 I-C-XX.                                                          00006240
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  17
* ECS201.cbl
   657     MOVE WS-INDX TO HD3.                                         00006250
   658                                                                  00006260
   659 S-P-2.                                                           00006270
   660     COMPUTE INDX-PG = PG-NO - K1.                                00006280
   661                                                                  00006290
   662     PERFORM BUILD-TOC THRU B-T-X.                                00006300
   663                                                                  00006310
   664     GO TO MAIN-READ.                                             00006320
   665                                                                  00006330
   666 SET-PARA.                                                        00006340
   667     MOVE WSD-DESC TO HD-HD.                                      00006350
   668                                                                  00006360
   669     IF WSD-DESC = SPACES                                         00006370
   670         GO TO MAIN-READ.                                         00006380
   671                                                                  00006390
   672     MOVE HD3 TO WF-DATA.                                         00006400
   673     MOVE ' ' TO WF-CTL.                                          00006410
   674                                                                  00006420
   675     PERFORM PRINT-RTN-1.                                         00006430
   676                                                                  00006440
   677     MOVE SPACES TO WF-DATA.                                      00006450
   678                                                                  00006460
   679     PERFORM PRINT-RTN-1.                                         00006470
   680                                                                  00006480
   681     GO TO INSERT-CONTD.                                          00006490
   682                                                                  00006500
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  18
* ECS201.cbl
   684 PT-HDNG.                                                         00006520
   685     MOVE PG-NO TO HD-PG.                                         00006530
   686     MOVE HD1 TO WF-DATA.                                         00006540
   687     MOVE '1' TO WF-CTL.                                          00006550
   688                                                                  00006560
   689     IF PG-ONE = ' '                                              00006570
   690         MOVE SPACES TO WF-DATA.                                  00006580
   691                                                                  00006590
   692     PERFORM PRINT-RTN-1.                                         00006600
   693                                                                  00006610
   694     MOVE HD2 TO WF-DATA.                                         00006620
   695                                                                  00006630
   696     IF PG-ONE = ' '                                              00006640
   697         MOVE SPACES TO WF-DATA.                                  00006650
   698                                                                  00006660
   699     PERFORM PRINT-RTN-1.                                         00006670
   700                                                                  00006680
   701     ADD K1 TO PG-NO.                                             00006690
   702                                                                  00006700
   703 SET-TOC.                                                         00006710
   704     PERFORM BUILD-TOC THRU B-T-X.                                00006720
   705                                                                  00006730
   706     GO TO MAIN-READ.                                             00006740
   707                                                                  00006750
   708 BOJ-ABORT.                                                       00006760
   709                                                                  00006770
   710     IF WSD-ID = 'FI'                                             00006780
   711         MOVE 'X' TO FICH-SW                                      00006790
   712         GO TO HSKPG-READ.                                        00006800
   713                                                                  00006810
   714     DISPLAY 'ECS201 - MISSING ** RECORD' UPON CONSOLE.           00006820
   715     DISPLAY 'ECS201 - MISSING ** RECORD'.                        00006830
   716                                                                  00006840
   717     GOBACK.                                                      00006850
   718                                                                  00006860
   719 SPOOL-FULL.                                                      00006870
   720     DISPLAY 'ECS201-EXTENTS FOR SYS018 EXCEEDED' UPON CONSOLE.   00006880
   721     DISPLAY 'ECS201-EXTENTS FOR SYS018 EXCEEDED'.                00006890
   722                                                                  00006900
   723     GOBACK.                                                      00006910
   724                                                                  00006920
   725 TOC-FULL.                                                        00006930
   726     DISPLAY 'ECS201-EXTENTS FOR SYS016 EXCEEDED' UPON CONSOLE.   00006940
   727     DISPLAY 'ECS201-EXTENTS FOR SYS016 EXCEEDED'.                00006950
   728                                                                  00006960
   729     GOBACK.                                                      00006970
   730                                                                  00006980
   731 BUILD-INDEX.                                                     00006990
   732     MOVE INDX-CTL TO SV-CTL.                                     00007000
   733     MOVE SPACES   TO INDX-CTL.                                   00007010
   734     MOVE INDX-PG  TO CNTR-PG.                                    00007020
   735     MOVE INDX-IND TO WS-INDX.                                    00007030
   736     MOVE B1       TO X1.                                         00007040
   737     MOVE B2       TO X2.                                         00007050
   738                                                                  00007060
   739 B-I-LOOP.                                                        00007070
   740     IF WS-INDX-O (X1) NOT = ' '                                  00007080
   741         GO TO B-I-END.                                           00007090
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  19
* ECS201.cbl
   742                                                                  00007100
   743 B-I-MOVE.                                                        00007110
   744     MOVE WS-INDX-O (X2) TO WS-INDX-O (X1).                       00007120
   745                                                                  00007130
   746     ADD B1 TO X1.                                                00007140
   747     ADD B1 TO X2.                                                00007150
   748                                                                  00007160
   749     IF X1 NOT = B80                                              00007170
   750         GO TO B-I-MOVE.                                          00007180
   751                                                                  00007190
   752     MOVE ' ' TO WS-INDX-O (80).                                  00007200
   753     MOVE B1 TO X1.                                               00007210
   754     MOVE B2 TO X2.                                               00007220
   755                                                                  00007230
   756     GO TO B-I-LOOP.                                              00007240
   757                                                                  00007250
   758 B-I-END.                                                         00007260
   759     MOVE WS-INDX TO CNTR-NAME.                                   00007270
   760     MOVE SV-CTL TO INDX-CTL.                                     00007280
   761                                                                  00007290
   762     IF WS-INDX = SPACES                                          00007300
   763         GO TO B-I-X.                                             00007310
   764                                                                  00007320
   765     WRITE CNTR-REC                                               00007330
   766         INVALID KEY GO TO INDEX-FULL.                            00007340
   767                                                                  00007350
   768 B-I-X.                                                           00007360
   769     EXIT.                                                        00007370
   770                                                                  00007380
   771 INDEX-FULL.                                                      00007390
   772     DISPLAY 'ECS201-EXTENTS FOR SYS017 EXCEEDED' UPON CONSOLE.   00007400
   773     DISPLAY 'ECS201-EXTENTS FOR SYS017 EXCEEDED'.                00007410
   774                                                                  00007420
   775     GOBACK.                                                      00007430
   776                                                                  00007440
   777 END-SPOOL.                                                       00007450
   778     CLOSE DOCU-CARD                                              00007460
   779           INDX-FILE                                              00007470
   780           WORK-FILE                                              00007480
   781           CNTR-FILE.                                             00007490
   782                                                                  00007500
   783 SORT-INDEX SECTION.                                              00007510
   784     MOVE +5000 TO SORT-FILE-SIZE.                                00007520
   785                                                                  00007530
   786     SORT SORT-FILE ON ASCENDING KEY SORT-CTL                     00007540
   787                                     SORT-PG                      00007550
   788         USING CNTR-FILE                                          00007560
   789         GIVING CNTR-FILE-R.                                      00007570
   790                                                                  00007580
   791 PRINT-MANUAL SECTION.                                            00007590
   792     OPEN INPUT INDX-FILE                                         00007600
   793                CNTR-FILE-R                                       00007610
   794                WORK-FILE.                                        00007620
   795                                                                  00007630
   796     IF FICHE                                                     00007640
   797          OPEN OUTPUT FICH.                                       00007650
   798                                                                  00007660
   799     MOVE SPACES TO SAVE-TOC.                                     00007670
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  20
* ECS201.cbl
   800                                                                  00007680
   801 PRINT-READ.                                                      00007690
   802     READ WORK-FILE AT END                                        00007700
   803         GO TO PRINT-INDEX.                                       00007710
   804                                                                  00007720
   805     MOVE WORK-FILE-REC TO PRT.                                   00007730
   806                                                                  00007740
   807     IF WFX-CTL = '*T'                                            00007750
   808         GO TO INSERT-TOC.                                        00007760
   809                                                                  00007770
   810     PERFORM PRINT-RTN-2.                                         00007780
   811                                                                  00007790
   812     GO TO PRINT-READ.                                            00007800
   813                                                                  00007810
   814 INSERT-TOC.                                                      00007820
   815     MOVE SPACES TO HD-CNT.                                       00007830
   816                                                                  00007840
   817     PERFORM REAL-PRT-HDNG THRU R-P-H-X.                          00007850
   818                                                                  00007860
   819     MOVE '(CONTINUED)' TO HD-CNT.                                00007870
   820                                                                  00007880
   821 TOC-LOOP.                                                        00007890
   822     READ INDX-FILE AT END                                        00007900
   823         GO TO END-TOC.                                           00007910
   824                                                                  00007920
   825     IF INDX-CTL = '*C'                                           00007930
   826         MOVE INDX-DATA TO PRT-2-DTL.                             00007940
   827                                                                  00007950
   828     IF INDX-CTL = '*S'                                           00007960
   829         MOVE INDX-DATA TO PRT-2-DTL                              00007970
   830         GO TO INSERT-AST.                                        00007980
   831                                                                  00007990
   832     IF INDX-CTL = '*P'                                           00008000
   833         MOVE INDX-DATA TO PRT-3-DTL                              00008010
   834         GO TO INSERT-AST.                                        00008020
   835                                                                  00008030
   836     MOVE INDX-DATA TO P-DATA.                                    00008040
   837                                                                  00008050
   838     ADD K1 TO LN-CT.                                             00008060
   839                                                                  00008070
   840     MOVE '0' TO P-CTL.                                           00008080
   841     MOVE INDX-DATA TO WS-INDX.                                   00008090
   842     MOVE B80 TO X1.                                              00008100
   843                                                                  00008110
   844     PERFORM I-C-LP THRU I-C-X.                                   00008120
   845                                                                  00008130
   846 TOC-PRNT.                                                        00008140
   847     PERFORM PRINT-RTN-2.                                         00008150
   848                                                                  00008160
   849     IF LN-CT LESS LN-MX                                          00008170
   850         GO TO TOC-LOOP.                                          00008180
   851                                                                  00008190
   852     PERFORM REAL-PRT-HDNG THRU R-P-H-X.                          00008200
   853                                                                  00008210
   854     MOVE WS-INDX TO P-DATA.                                      00008220
   855                                                                  00008230
   856     GO TO TOC-PRNT.                                              00008240
   857                                                                  00008250
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  21
* ECS201.cbl
   858     IF LN-CT GREATER LN-MX                                       00008260
   859         PERFORM REAL-PRT-HDNG THRU R-P-H-X.                      00008270
   860                                                                  00008280
   861     GO TO TOC-LOOP.                                              00008290
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  22
* ECS201.cbl
   863 REAL-PRT-HDNG.                                                   00008310
   864     MOVE HD4 TO P-DATA.                                          00008320
   865     MOVE '1' TO P-CTL.                                           00008330
   866                                                                  00008340
   867 PRINT-RTN-2.                                                     00008350
   868     IF FICHE                                                     00008360
   869         WRITE FICH-REC FROM PRT                                  00008370
   870         ELSE                                                     00008380
   871         WRITE PRT AFTER POSITIONING P-CTL.                       00008390
   872                                                                  00008400
   873     MOVE SPACES TO PRT.                                          00008410
   874                                                                  00008420
   875     ADD K1 TO LN-CT.                                             00008430
   876                                                                  00008440
   877 R-P-H-2.                                                         00008450
   878     MOVE HD5 TO P-DATA.                                          00008460
   879                                                                  00008470
   880     PERFORM PRINT-RTN-2.                                         00008480
   881                                                                  00008490
   882     MOVE '-' TO P-CTL.                                           00008500
   883                                                                  00008510
   884     PERFORM PRINT-RTN-2.                                         00008520
   885                                                                  00008530
   886     MOVE K0 TO LN-CT.                                            00008540
   887                                                                  00008550
   888 R-P-H-X.                                                         00008560
   889     EXIT.                                                        00008570
   890                                                                  00008580
   891 END-TOC.                                                         00008590
   892     GO TO PRINT-READ.                                            00008600
   893                                                                  00008610
   894 INSERT-AST.                                                      00008620
   895     MOVE INDX-PG TO PRT-2-PGNO.                                  00008630
   896     MOVE B70 TO X2.                                              00008640
   897     MOVE B69 TO X1.                                              00008650
   898                                                                  00008660
   899 AST-LOOP.                                                        00008670
   900     IF PRT-2-TD (X1) NOT = ' '                                   00008680
   901         MOVE ' ' TO PRT-2-TD (X2),                               00008690
   902             GO TO A-LP-X.                                        00008700
   903                                                                  00008710
   904     MOVE '.' TO PRT-2-TD (X1).                                   00008720
   905                                                                  00008730
   906     SUBTRACT B1 FROM X1.                                         00008740
   907     SUBTRACT B1 FROM X2.                                         00008750
   908                                                                  00008760
   909     IF X1 NOT = B1                                               00008770
   910         GO TO AST-LOOP.                                          00008780
   911                                                                  00008790
   912 A-LP-X.                                                          00008800
   913     EXIT.                                                        00008810
   914                                                                  00008820
   915 A-LP-XX.                                                         00008830
   916     GO TO TOC-PRNT.                                              00008840
   917                                                                  00008850
   918 PRINT-INDEX.                                                     00008860
   919     MOVE SPACES TO HD-CNT.                                       00008870
   920     MOVE 'INDEX' TO HD-TOC.                                      00008880
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  23
* ECS201.cbl
   921                                                                  00008890
   922     PERFORM REAL-PRT-HDNG THRU R-P-H-X.                          00008900
   923                                                                  00008910
   924     MOVE 'INDEX (CONTINUED)' TO HD-TOC.                          00008920
   925                                                                  00008930
   926 INDEX-LOOP.                                                      00008940
   927     READ CNTR-FILE-R AT END GO TO END-JOB.                       00008950
   928                                                                  00008960
   929     IF LN-CT GREATER LN-MX                                       00008970
   930         PERFORM REAL-PRT-HDNG THRU R-P-H-X.                      00008980
   931                                                                  00008990
   932     IF CNTR-NAME-R = SAVE-TOC                                    00009000
   933             GO TO ADDL-PAGES.                                    00009010
   934                                                                  00009020
   935 INDEX-PRINT.                                                     00009030
   936     PERFORM PRINT-RTN-2.                                         00009040
   937                                                                  00009050
   938     IF LN-CT GREATER LN-MX                                       00009060
   939         PERFORM REAL-PRT-HDNG THRU R-P-H-X.                      00009070
   940                                                                  00009080
   941     MOVE CNTR-NAME-R TO PRT-2-DTL, SAVE-TOC.                     00009090
   942     MOVE CNTR-PG-R TO PRT-2-PGNO, SAVE-PAGE.                     00009100
   943     MOVE B70 TO X2.                                              00009110
   944     MOVE B69 TO X1.                                              00009120
   945                                                                  00009130
   946     PERFORM AST-LOOP THRU A-LP-X.                                00009140
   947                                                                  00009150
   948     GO TO INDEX-LOOP.                                            00009160
   949                                                                  00009170
   950 ADDL-PAGES.                                                      00009180
   951     IF SAVE-PAGE = CNTR-PG-R                                     00009190
   952              GO TO INDEX-LOOP.                                   00009200
   953                                                                  00009210
   954     IF PRT-2A-PGNO = '.....'                                     00009220
   955          MOVE CNTR-PG-R TO PRT-2A-PGNO, SAVE-PAGE                00009230
   956          GO TO INDEX-LOOP.                                       00009240
   957                                                                  00009250
   958     IF PRT-2B-PGNO = '.....'                                     00009260
   959          MOVE CNTR-PG-R TO PRT-2B-PGNO, SAVE-PAGE                00009270
   960          GO TO INDEX-LOOP.                                       00009280
   961                                                                  00009290
   962     IF PRT-2C-PGNO = '.....'                                     00009300
   963          MOVE CNTR-PG-R TO PRT-2C-PGNO, SAVE-PAGE                00009310
   964          GO TO INDEX-LOOP.                                       00009320
   965                                                                  00009330
   966     IF PRT-2D-PGNO = '.....'                                     00009340
   967          MOVE CNTR-PG-R TO PRT-2D-PGNO, SAVE-PAGE                00009350
   968          GO TO INDEX-LOOP.                                       00009360
   969                                                                  00009370
   970     MOVE CNTR-PG-R TO PRT-2E-PGNO.                               00009380
   971     MOVE SPACES TO SAVE-TOC.                                     00009390
   972     MOVE +0 TO SAVE-PAGE.                                        00009400
   973                                                                  00009410
   974     GO TO INDEX-LOOP.                                            00009420
   975                                                                  00009430
   976 KEY-WORD-XTRCT.                                                  00009440
   977     MOVE B1 TO X1.                                               00009450
   978                                                                  00009460
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  24
* ECS201.cbl
   979 K-W-SEARCH-AGAIN.                                                00009470
   980     MOVE SPACES TO CNTR-REC                                      00009480
   981                    WS-INDX.                                      00009490
   982                                                                  00009500
   983     COMPUTE CNTR-PG = PG-NO - K1.                                00009510
   984                                                                  00009520
   985     MOVE WSD-DESC TO I-I-A.                                      00009530
   986     MOVE B1 TO X3.                                               00009540
   987                                                                  00009550
   988 K-W-LOOP.                                                        00009560
   989     IF I-A (X1) = ':'                                            00009570
   990         GO TO K-W-FOUND.                                         00009580
   991                                                                  00009590
   992     ADD B1 TO X1.                                                00009600
   993                                                                  00009610
   994     IF X1 LESS THAN B70                                          00009620
   995         GO TO K-W-LOOP.                                          00009630
   996                                                                  00009640
   997     GO TO K-W-X.                                                 00009650
   998                                                                  00009660
   999 K-W-FOUND.                                                       00009670
  1000     ADD B1 TO X1.                                                00009680
  1001                                                                  00009690
  1002 K-W-MVE.                                                         00009700
  1003     MOVE I-A (X1) TO WS-INDX-O (X3).                             00009710
  1004                                                                  00009720
  1005     ADD B1 TO X1.                                                00009730
  1006     ADD B1 TO X3.                                                00009740
  1007                                                                  00009750
  1008     IF X3 = +74                                                  00009760
  1009         GO TO K-W-X.                                             00009770
  1010                                                                  00009780
  1011     IF I-A (X1) NOT = ':'                                        00009790
  1012         GO TO K-W-MVE.                                           00009800
  1013                                                                  00009810
  1014     GO TO K-W-END.                                               00009820
  1015                                                                  00009830
  1016 K-W-END.                                                         00009840
  1017     PERFORM B-I-END THRU B-I-X.                                  00009850
  1018                                                                  00009860
  1019     ADD B1 TO X1.                                                00009870
  1020                                                                  00009880
  1021     IF X1 LESS B70                                               00009890
  1022         GO TO K-W-SEARCH-AGAIN.                                  00009900
  1023                                                                  00009910
  1024 K-W-X.                                                           00009920
  1025     EXIT.                                                        00009930
* Micro Focus Server Express         V5.1 revision 000 06-Oct-15 17:18 Page  25
* ECS201.cbl
  1027 END-JOB.                                                         00009950
  1028     PERFORM PRINT-RTN-2.                                         00009960
  1029                                                                  00009970
  1030     CLOSE INDX-FILE                                              00009980
  1031           CNTR-FILE-R                                            00009990
  1032           WORK-FILE                                              00010000
  1033           PRNT-FILE.                                             00010010
  1034                                                                  00010020
  1035     IF MANUAL-NAME NOT = SPACES                                  00010030
  1036        CLOSE DOCU-TAPE.                                          00010040
  1037                                                                  00010050
  1038     IF FICHE                                                     00010060
  1039        CLOSE FICH.                                               00010070
  1040                                                                  00010080
  1041     GOBACK.                                                      00010090
  1042                                                                  00010100
  1043 SCAN-FOR-MANUAL.                                                 00010110
  1044     PERFORM READ-TAPE.                                           00010120
  1045     IF DOC-ID NOT = ' *MANUAL* ' GO TO SCAN-FOR-MANUAL.          00010130
  1046*    IF MANUAL-NAME = 'ALL'                                       00010140
  1047*       PERFORM READ-TAPE                                         00010150
  1048*          GO TO HSK-2.                                           00010160
  1049                                                                  00010170
  1050     IF DOC-MANUAL NOT = MANUAL-NAME                              00010180
  1051        GO TO SCAN-FOR-MANUAL.                                    00010190
  1052     PERFORM READ-TAPE.                                           00010200
  1053     GO TO HSK-2.                                                 00010210
  1054*                                                                 00010220
  1055*   END OF PGM ECS201                                             00010230
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6284     Code:        5735
