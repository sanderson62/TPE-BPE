* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   1
* FNB164.cbl
* Options: int("FNB164.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("FNB164.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"FNB164.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"FNB164.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*TITLE 'CID CLAIM INTERFACE'
     2
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID.    FNB164.
     5*AUTHOR.        DAN DRYDEN.
     6*DATE-WRITTEN.  MAY, 1998.
     7
     8*****************************************************************
     9*                      H I S T O R Y                            *
    10*****************************************************************
    11* NAME    DATE    DESCRIPTION                                   *
    12* ---- ---------- --------------------------------------------- *
    13* DANA 01/01/1999 CR#1998011500013 FREEDOM SYSTEM INSTALL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   2
* FNB164.cbl
    14* DJNA 04/01/2000 CR#2000030100009 DRAFT NUMBER EXPANSION
    15* DANA 08/29/2000 CR#2000082900005 DRAFT RECORD LENGTH CHANGE
    16* DANA 02/16/2001 MEMO FROM TPT -  CHECK DR-NOTE-CODE FOR 01
    17* SMVA 03/07/2002 2001112600001    REMOVE PLAN CODE TABLE
    18*                                DEPENDENCIES
    19* PEMA 10/30/2002                  ADD PROCESSING FOR DCC
    20* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    21* 112906  CR2006111300003  PEMA  ADD PROCESSING FOR KY
    22* 091808    2008022800002  AJRA  ADD PAYEE STATE TO OUTPUT FOR
    23*                                ALASKA CHECK PROCESSING.
    24* 101708    2008050500001  AJRA  ADD PROCESSING FOR CCC
    25* 022812    2011110200001  AJRA  ADD PROCESSING FOR AHL
    26*****************************************************************
    27
    28 ENVIRONMENT DIVISION.
    29 INPUT-OUTPUT SECTION.
    30 FILE-CONTROL.
    31
    32     SELECT DAILY-DRAFTS
    33         ASSIGN TO SYS010
    34         FILE STATUS IS SYS010-STATUS.
    35
    36     SELECT WORK-FILE
    37         ASSIGN TO SYS011
    38         organization is line sequential.
    39
    40     SELECT CSI-WORK-FILE
    41         ASSIGN TO SYS012
    42         organization is line sequential.
    43
    44     SELECT CCC-WORK-FILE
    45         ASSIGN TO SYS013
    46         organization is line sequential.
    47
    48     SELECT DISK-DATE        ASSIGN TO SYS019.
    49
    50 DATA DIVISION.
    51 FILE SECTION.
    52
    53 FD  DAILY-DRAFTS
    54     LABEL RECORDS ARE STANDARD
    55     RECORDING MODE IS F
    56**** RECORD CONTAINS 1194 CHARACTERS
    57     BLOCK CONTAINS 0 RECORDS.
*   58     COPY CLO420.
    59*----------------------------------------------------------------*00000001
    60* DJNA 12/13/1997 Y2K PHASE II                                   *00000002
    61* DJNA 04/01/2000 DRAFT NUMBER EXPANSION                         *00000002
    62* DJNA 08/26/2000 DATA EXPANSION                                 *00000002
    63* 122205    2005033100001  PEMA  ADD PROCESSING FOR CSI
    64*----------------------------------------------------------------*00000003
    65 01  DCP-RECORD.                                                  00000001
    66     03  DRAFT-RECORD.                                            00000002
    67         05  DR-RECORD-KEY.                                       00000003
    68             07  DR-DRAFT-ACCOUNT      PIC XX.                    00000004
    69             07  DR-DRAFT-NUMBER       PIC 9(8).                  00000005
    70             07  DR-DRAFT-STATUS       PIC X.                     00000006
    71         05  DR-POLICY-NUMBER          PIC X(10).                 00000007
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   3
* FNB164.cbl (/apps/prod/cid1p/copy/CLO420)
    72         05  DR-CLAIM-NUMBER           PIC X(10).                 00000008
    73         05  DR-AMOUNT-PAID            PIC 9(7)V99.               00000009
    74         05  DR-AUDITOR                PIC XXX.                   00000010
    75         05  DR-PART-FINAL             PIC X.                     00000011
    76         05  DR-FROM-DATE              PIC X(8).                  00000012
    77         05  DR-TO-DATE                PIC X(8).                  00000013
    78         05  DR-NO-OF-DAYS             PIC 9(3).                  00000014
    79         05  DR-HOSP-ROOM-AMT          PIC 9(7)V99.               00000015
    80         05  DR-HOSP-MISC-AMT          PIC 9(7)V99.               00000016
    81         05  DR-SURGERY-AMT            PIC 9(7)V99.               00000017
    82         05  DR-PHYSICIAN-AMT          PIC 9(7)V99.               00000018
    83         05  DR-MATERNITY-AMT          PIC 9(7)V99.               00000019
    84         05  DR-NOTE-CODE              PIC 99.                    00000020
    85         05  DR-NOTE-AREA         OCCURS 8        TIMES           00000021
    86                                  INDEXED BY  DR-NOTE-NDX.        00000022
    87             07  DR-NOTE               PIC X(32).                 00000023
    88         05  DR-PAYEE                  PIC X(30).                 00000024
    89         05  DR-PAYEE-ADDR1            PIC X(30).                 00000025
    90         05  DR-PAYEE-ADDR2            PIC X(30).                 00000026
    91         05  DR-PAYEE-CITY             PIC X(20).                 00000027
    92         05  DR-PAYEE-STATE            PIC XX.                    00000028
    93         05  DR-PAYEE-ZIP              PIC 9(9).                  00000029
    94         05  DR-ENTERED-DATE           PIC X(8).                  00000030
    95         05  DR-PRINT-FLAG             PIC X.                     00000031
    96         05  DR-PROOF                  PIC X(8).                  00000032
    97         05  DR-SSN-TIN.                                          00000033
    98             07  DR-TAX-NO             PIC X(09).                 00000034
    99             07  DR-TAX-TYPE           PIC X(01).                 00000035
   100         05  DR-EOB-AUDITOR            PIC X(4).                  00000036
   101         05  DR-RETURN-DFT             PIC X(1).                  00000037
   102                                                                  00000038
   103     03  CLAIM-RECORD.                                            00000039
   104         05  CR-RECORD-KEY.                                       00000040
   105             07  CR-CLAIM-NUMBER       PIC X(10).                 00000041
   106         05  CR-CLAIMANT               PIC X(20).                 00000042
   107         05  CR-CLAIMANT-DOB           PIC X(8).                  00000043
   108         05  CR-CLAIM-STATUS           PIC X.                     00000044
   109         05  CR-ENTRY-DATE             PIC X(8).                  00000045
   110         05  CR-REVISION-DATE          PIC X(8).                  00000046
   111         05  CR-CLAIMANT-STATE-OF-RES  PIC XX.                    00000047
   112         05  CR-DATE-INCURRED          PIC X(6).                  00000048
   113         05  CR-FIRST-NOTICE           PIC X(8).                  00000049
   114         05  CR-DIAGNOSIS              PIC X(50).                 00000050
   115         05  CR-AMOUNT-PAID            PIC 9(7)V99.               00000051
   116         05  CR-LAST-PAID              PIC X(8).                  00000052
   117         05  CR-REMARKS                PIC X(50).                 00000053
   118         05  CR-PRINT-FORM             PIC X.                     00000054
   119         05  CR-HISTORY-FLAG           PIC X.                     00000055
   120         05  CR-CLAIM-TYPE             PIC X.
   121         05  CR-CARRIER REDEFINES CR-CLAIM-TYPE
   122                                       PIC X.
   123         05  CR-CLAIM-ACTION           PIC X.                     00000057
   124         05  CR-ACTION-TIME            PIC X(6).                  00000058
   125         05  CR-CLAIMANT-DOD           PIC X(8).                  00000059
   126                                                                  00000066
   127     03  POLICY-RECORD.                                           00000067
   128         05  PR-RECORD-KEY.                                       00000068
   129             07  PR-CLAIM-NUMBER       PIC X(10).                 00000069
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   4
* FNB164.cbl (/apps/prod/cid1p/copy/CLO420)
   130             07  PR-POLICY-NUMBER      PIC X(10).                 00000070
   131         05  PR-CLAIMANT               PIC X(20).                 00000071
   132         05  PR-CLAIMANT-DOB           PIC X(8).                  00000072
   133         05  PR-POLICY-STATUS          PIC X.                     00000073
   134         05  PR-POLICY-OWNER           PIC X(30).                 00000074
   135         05  PR-PO-ADDR1               PIC X(30).                 00000075
   136         05  PR-PO-ADDR2               PIC X(30).                 00000076
   137         05  PR-PO-CITY                PIC X(20).                 00000077
   138         05  PR-PO-STATE               PIC XX.                    00000078
   139         05  PR-PO-ZIP                 PIC 9(9).                  00000079
   140         05  PR-PLAN-NUMBER            PIC X(6).                  00000080
   141         05  PR-POLICY-TYPE            PIC XX.                    00000081
   142         05  PR-ISSUE-DATE             PIC X(8).                  00000082
   143         05  PR-INDEMNITY              PIC 9(7)V99.               00000083
   144         05  PR-SELL-AGT-NO            PIC 9(7).                  00000084
   145         05  PR-SELL-AGT-NAME          PIC X(20).                 00000085
   146         05  PR-PAID-TO                PIC X(8).                  00000086
   147         05  PR-BILLING-FORM           PIC X.                     00000087
   148         05  PR-COLL-AGT-NO            PIC 9(7).                  00000088
   149         05  PR-COLL-AGT-STATE         PIC XX.                    00000089
   150         05  PR-COLL-AGT-REGION        PIC 99.                    00000090
   151         05  PR-PAYEE                  PIC X(30).                 00000091
   152         05  PR-PAYEE-ADDR1            PIC X(30).                 00000092
   153         05  PR-PAYEE-ADDR2            PIC X(30).                 00000093
   154         05  PR-PAYEE-CITY             PIC X(20).                 00000094
   155         05  PR-PAYEE-STATE            PIC XX.                    00000095
   156         05  PR-PAYEE-ZIP              PIC 9(9).                  00000096
   157         05  PR-REMARKS                PIC X(50).                 00000097
   158         05  PR-AMOUNT-PAID            PIC 9(7)V99.               00000098
   159         05  PR-LAST-PAID              PIC X(8).                  00000099
   160         05  PR-REINSURANCE            PIC X.                     00000100
   161         05  PR-PROOF-DATE             PIC X(8).                  00000101
   162         05  PR-AUDITOR                PIC XXX.                   00000102
   163         05  PR-POLICY-ACTION          PIC X.                     00000103
   164         05  PR-ACTION-TIME            PIC X(6).                  00000104
   165         05  PR-REVISION-DATE          PIC X(8).                  00000105
   166         05  PR-HOME-OFFICE-CATEGORY   PIC XXX.                   00000106
   167         05  PR-ANNUAL-STATE-CATEGORY  PIC XXX.                   00000107
   168         05  PR-CLAIM-TYPE             PIC X.                     00000108
   169         05  PR-OPER-COMPANY           PIC XX.                    00000109
   170         05  PR-BENEFIT-DURATION       PIC 999.                   00000110
   171
   172 FD  WORK-FILE
   173     LABEL RECORDS ARE STANDARD
   174     RECORDING MODE IS F
   175     BLOCK CONTAINS 0 RECORDS.
   176 01  WORK-RECORD.
*  177     COPY FNC022.
   178     05  FX-COMMON-SECTION.                                       00010001
   179         10  FX-SYSTEM             PIC X(10).                     00020001
   180         10  FX-SOURCE-CODE        PIC X(6).                      00030001
   181         10  FX-DIVISION           PIC X(2).                      00040001
   182         10  FX-TRAN-TYPE          PIC X(2).                      00050001
   183         10  FX-SUB-TYPE           PIC X(2).                      00060001
   184         10  FX-CLM-RES            PIC X(2).                      00070001
   185         10  FX-ANN-STMT           PIC X(3).                      00080001
   186         10  FX-PLAN-CODE          PIC X(6).                      00090001
   187         10  FX-FORM               PIC X(3).                      00091001
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   5
* FNB164.cbl (/apps/prod/cid1p/copy/FNC022)
   188         10  FX-JOURNAL-DATE       PIC X(8).                      00092001
   189         10  FX-POSTING-DATE       PIC X(8).                      00093001
   190         10  FX-POLICY-NO          PIC X(10).                     00094001
   191         10  FX-CITY               PIC X(30).                     00095002
   192         10  FX-STATE              PIC X(2).                      00095102
   193         10  FX-ZIP-CODE           PIC X(9).                      00096001
   194         10  FX-LOC-CODE           PIC X.                         00096102
   195         10  FX-FY-REN             PIC X.                         00097001
   196         10  FX-AGENT-01           PIC X(9).                      00098001
   197         10  FX-AGENT-50           PIC X(9).                      00099001
   198         10  FX-COST-CENTER        PIC X(4).                      00100001
   199         10  FX-TAXABLE            PIC X.                         00110004
   200         10  FX-DISTR              PIC X(2).                      00120001
   201         10  FX-SOURCE-ACCT        PIC X(10).                     00130001
   202         10  FX-DESCRIPTION        PIC X(30).                     00140001
   203         10  FX-REFERENCE          PIC X(10).                     00150001
   204         10  FX-SUSPENSE           PIC X(15).                     00151002
   205         10  FX-AMOUNT             PIC S9(10)V99                  00160001
   206                                   SIGN IS TRAILING SEPARATE.     00170001
   207                                                                  00180001
   208     05  FX-CLAIM-SECTION.                                        00190001
   209         10  FX-CLAIM-NO           PIC X(10).                     00200001
   210         10  FX-CLAIM-TYPE         PIC X.                         00210001
   211         10  FX-DRAFT-NO           PIC X(10).                     00220001
   212         10  FX-DRAFT-STATUS       PIC X.                         00230001
   213         10  FX-TAX-ID             PIC X(10).                     00240001
   214         10  FILLER                PIC X(10).                     00250003
   215                                                                  00290001
   216
   217
   218 FD  CSI-WORK-FILE
   219     LABEL RECORDS ARE STANDARD
   220     RECORDING MODE IS F
   221     BLOCK CONTAINS 0 RECORDS.
   222 01  CSI-WORK-RECORD             PIC X(250).
   223
   224 FD  CCC-WORK-FILE
   225     LABEL RECORDS ARE STANDARD
   226     RECORDING MODE IS F
   227     BLOCK CONTAINS 0 RECORDS.
   228 01  CCC-WORK-RECORD             PIC X(250).
   229
   230 FD  DISK-DATE
*  231     COPY ELCDTEFD.
   232******************************************************************04/15/98
   233*                                                                *ELCDTEFD
   234*                                                                *ELCDTEFD
   235*                            ELCDTEFD.                           *   LV002
   236*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   237*                            VMOD=2.007                          *   CL**2
   238*                                                                *ELCDTEFD
   239******************************************************************ELCDTEFD
   240     BLOCK CONTAINS 0 RECORDS
   241     RECORDING MODE F.                                            ELCDTEFD
   242                                                                  ELCDTEFD
   243 01  DATE-DISK.                                                   ELCDTEFD
   244     12  DD-ID                       PIC  X(4).                   ELCDTEFD
   245     12  FILLER                      PIC  X(14).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   6
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   246     12  DD-CR1                      PIC  9.                      ELCDTEFD
   247     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
   248     12  DD-CR2                      PIC  9.                      ELCDTEFD
   249     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
   250     12  FILLER                      PIC  X(20).                  ELCDTEFD
   251                                                                  ELCDTEFD
   252 01  DATE-DISK-R.                                                 ELCDTEFD
   253     12  FILLER                      PIC  X(4).                   ELCDTEFD
   254     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
   255                                     PIC  X(32).                  ELCDTEFD
   256                                                                  ELCDTEFD
   257 01  DATE-DISK-T.                                                 ELCDTEFD
   258     12  FILLER                      PIC  X(4).                   ELCDTEFD
   259     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
   260                                     PIC  X(48).                  ELCDTEFD
   261                                                                  ELCDTEFD
   262 01  DATE-DISK-M.                                                 ELCDTEFD
   263     12  FILLER                      PIC  X(4).                   ELCDTEFD
   264     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
   265                                     PIC  X(48).                  ELCDTEFD
   266                                                                  ELCDTEFD
   267 01  DATE-DISK-P.                                                 ELCDTEFD
   268     12  DD-IDA                      PIC  XX.                     ELCDTEFD
   269     12  DD-IDX                      PIC  99.                     ELCDTEFD
   270     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
   271     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   272         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
   273                                     PIC  X.                      ELCDTEFD
   274         16  FILLER                  PIC  X(46).                  ELCDTEFD
   275     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
   276         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
   277             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
   278             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
   279             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   280             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   281         16  FILLER                  PIC  X(16).                  ELCDTEFD
   282                                                                  ELCDTEFD
   283 01  DATE-DISK-E.                                                 ELCDTEFD
   284     12  FILLER                      PIC  X(4).                   ELCDTEFD
   285     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   286                                     PIC  X(4).                   ELCDTEFD
   287                                                                  ELCDTEFD
   288 01  DATE-DISK-C.                                                 ELCDTEFD
   289     12  FILLER                      PIC  X(7).                   ELCDTEFD
   290     12  DD-CARR1-SECPAY-SW          PIC  X.
   291     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   292     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   293     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   294     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   295     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   296     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   297     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   298     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   299     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   300     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   301     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   302     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   303     12  DD-CARR2-SECPAY-SW          PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   7
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   304     12  FILLER                      PIC  X(7).                   ELCDTEFD
   305                                                                  ELCDTEFD
   306 01  DATE-DISK-OPT.                                               ELCDTEFD
   307     12  FILLER                      PIC  X(04).                  ELCDTEFD
   308     12  DD-TLR-DATA.                                             ELCDTEFD
   309         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   310                                     PIC  X(03).                  ELCDTEFD
   311     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   312         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   313                                     PIC  X(06).                  ELCDTEFD
   314     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   315         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   316                                     PIC  X(07).                  ELCDTEFD
   317         16  FILLER                  PIC  X(05).                  ELCDTEFD
   318     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   319                                     PIC  X(96).                  ELCDTEFD
   320******************************************************************ELCDTEFD
   321
   322
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   8
* FNB164.cbl
   324
   325 WORKING-STORAGE SECTION.
   326
   327 01  FILLER.
   328     05  WS-ZERO                 PIC S9(3)  COMP-3  VALUE +0.
   329     05  WS-ABEND-MESSAGE        PIC X(80)  VALUE SPACES.
   330     05  PGM-SUB                 PIC S9(4) COMP VALUE +310.
   331     05  WS-RETURN-CODE          PIC S999  COMP-3 VALUE +0.
   332     05  DUMP                PIC X         VALUE ' '.
   333     05  FORCE-DUMP REDEFINES DUMP PIC S9 COMP-3.
   334     05  SYS010-STATUS       PIC XX        VALUE '00'.
   335         88  EOF                           VALUE '10'.
   336     05  DATE-SW             PIC X         VALUE ' '.
   337         88  VALID-DATE                    VALUE 'V'.
   338     05  WS-ZIP              PIC ZZZZ99999.
   339     05  WS-DESCRIPTION.
   340         10  WS-DESC-TYPE      PIC XX.
   341         10  FILLER            PIC X.
   342         10  WS-DESC-KON       PIC X(5).
   343         10  WS-DESC-DATE      PIC X(4).
   344         10  WS-DESC-DR-STATUS PIC X.
   345         10  WS-DESC-HORC      PIC X(3).
   346         10  WS-DESC-ASRC      PIC X(3).
   347         10  WS-DESC-PLAN      PIC X(6).
   348*               10  FILLER            PIC X(5).
   349         10  FILLER            PIC X(3).
   350         10  WS-DESC-PAYEE-ST  PIC X(2).
   351
   352
   353 01  SYSTEM-DATE.
   354     05  SYS-MO         PIC 9(2).
   355     05  SYS-DA         PIC 9(2).
   356     05  SYS-CCYY       PIC 9(4).
   357
   358* FUNCTION-DATE COPYBOOK
*  359                                      COPY ELCFUNDT.
   360***************************************************************** 12/03/98
   361*                                                               * ELCFUNDT
   362*                            ELCFUNDT.                          *    LV004
   363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *             CL**4
   364*                            VMOD=2.001                         * ELCFUNDT
   365*                                                               * ELCFUNDT
   366*           COPYBOOK FOR THE FUNCTION DATE FORMAT               * ELCFUNDT
   367*                                                               * ELCFUNDT
   368***************************************************************** ELCFUNDT
   369                                                                  ELCFUNDT
   370                                                                  ELCFUNDT
   371 01  FUNCTION-DATE.                                                  CL**2
   372     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.          CL**3
   373     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.                          CL**3
   374         10  WS-FN-CCYR            PIC 9(4).                         CL**3
   375         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.                      CL**3
   376             15  WS-FN-CC          PIC 99.                           CL**3
   377             15  WS-FN-YR          PIC 99.                           CL**3
   378         10  WS-FN-MO              PIC 99.                           CL**3
   379         10  WS-FN-DA              PIC 99.                           CL**3
   380     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.          CL**3
   381     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.          CL**3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page   9
* FNB164.cbl (/apps/prod/cid1p/copy/ELCFUNDT)
   382     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.          CL**3
   383     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.          CL**3
   384     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.         CL**2
   385         88  WS-BEHIND-GMT                     VALUE '-'.            CL**2
   386         88  WS-AFTER-GMT                      VALUE '+'.            CL**2
   387         88  WS-NO-GMT                         VALUE ZERO.           CL**2
   388     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.          CL**2
   389     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.          CL**2
   390
   391
   392* STATE EDIT TABLE
*  393 COPY FNC018.
   394***************************************************************** 00020002
   395*                                                               * 00030002
   396*                     STATE CODE TABLE                          * 00040002
   397*                                                               * 00050002
   398*  CAUTION:  THIS TABLE MUST BE IN SEQUENCE BY STATE OR THE     * 00060002
   399*            SEARCH VERB WILL NOT WORK PROPERLY !               * 00070002
   400*                                                               * 00080002
   401***************************************************************** 00090002
   402*                                                                 00100002
   403 01  STATE-VALUES.                                                00110002
   404     05  PIC X(24)  VALUE 'AKAKALASKA              '.             00120002
   405     05  PIC X(24)  VALUE 'ALALALABAMA             '.             00130002
   406     05  PIC X(24)  VALUE 'ARARARKANSAS            '.             00140002
   407     05  PIC X(24)  VALUE 'ASASAMERICAN SAMOA      '.             00150002
   408     05  PIC X(24)  VALUE 'AZAZARIZONA             '.             00160002
   409     05  PIC X(24)  VALUE 'CACACALIFORNIA          '.             00170002
   410     05  PIC X(24)  VALUE 'CDCNCANADA              '.             00180002
   411     05  PIC X(24)  VALUE 'CNCNCANADA              '.             00190002
   412     05  PIC X(24)  VALUE 'COCOCOLORADO            '.             00200002
   413     05  PIC X(24)  VALUE 'CTCTCONNECTICUT         '.             00210002
   414     05  PIC X(24)  VALUE 'DCDCDISTRICT OF COLUMBIA'.             00220002
   415     05  PIC X(24)  VALUE 'DEDEDELAWARE            '.             00230002
   416     05  PIC X(24)  VALUE 'FCOTOTHER ALIEN         '.             00240002
   417     05  PIC X(24)  VALUE 'FLFLFLORIDA             '.             00250002
   418     05  PIC X(24)  VALUE 'GAGAGEORGIA             '.             00260002
   419     05  PIC X(24)  VALUE 'GUGUGUAM                '.             00270002
   420     05  PIC X(24)  VALUE 'HIHIHAWAII              '.             00280002
   421     05  PIC X(24)  VALUE 'IAIAIOWA                '.             00290002
   422     05  PIC X(24)  VALUE 'IDIDIDAHO               '.             00300002
   423     05  PIC X(24)  VALUE 'ILILILLINOIS            '.             00310002
   424     05  PIC X(24)  VALUE 'INININDIANA             '.             00320002
   425     05  PIC X(24)  VALUE 'KSKSKANSAS              '.             00330002
   426     05  PIC X(24)  VALUE 'KYKYKENTUCKY            '.             00340002
   427     05  PIC X(24)  VALUE 'LALALOUISIANA           '.             00350002
   428     05  PIC X(24)  VALUE 'MAMAMASSACHUSETTS       '.             00360002
   429     05  PIC X(24)  VALUE 'MDMDMARYLAND            '.             00370002
   430     05  PIC X(24)  VALUE 'MEMEMAINE               '.             00380002
   431     05  PIC X(24)  VALUE 'MIMIMICHIGAN            '.             00390002
   432     05  PIC X(24)  VALUE 'MNMNMINNESOTA           '.             00400002
   433     05  PIC X(24)  VALUE 'MOMOMISSOURI            '.             00410002
   434     05  PIC X(24)  VALUE 'MSMSMISSISSIPPI         '.             00420002
   435     05  PIC X(24)  VALUE 'MTMTMONTANA             '.             00430002
   436     05  PIC X(24)  VALUE 'NCNCNORTH CAROLINA      '.             00440002
   437     05  PIC X(24)  VALUE 'NDNDNORTH DAKOTA        '.             00450002
   438     05  PIC X(24)  VALUE 'NENENEBRASKA            '.             00460002
   439     05  PIC X(24)  VALUE 'NHNHNEW HAMPSHIRE       '.             00470002
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  10
* FNB164.cbl (/apps/prod/cid1p/copy/FNC018)
   440     05  PIC X(24)  VALUE 'NJNJNEW JERSEY          '.             00480002
   441     05  PIC X(24)  VALUE 'NMNMNEW MEXICO          '.             00490002
   442     05  PIC X(24)  VALUE 'NVNVNEVADA              '.             00500002
   443     05  PIC X(24)  VALUE 'NYNYNEW YORK            '.             00510002
   444     05  PIC X(24)  VALUE 'OFOTOTHER ALIEN         '.             00520002
   445     05  PIC X(24)  VALUE 'OHOHOHIO                '.             00530002
   446     05  PIC X(24)  VALUE 'OKOKOKLAHOMA            '.             00540002
   447     05  PIC X(24)  VALUE 'OROROREGON              '.             00550002
   448     05  PIC X(24)  VALUE 'OTOTOTHER ALIEN         '.             00560002
   449     05  PIC X(24)  VALUE 'PAPAPENNSYLVANIA        '.             00570002
   450     05  PIC X(24)  VALUE 'PRPRPUERTO RICO         '.             00580002
   451     05  PIC X(24)  VALUE 'RIRIRHODE ISLAND        '.             00590002
   452     05  PIC X(24)  VALUE 'SCSCSOUTH CAROLINA      '.             00600002
   453     05  PIC X(24)  VALUE 'SDSDSOUTH DAKOTA        '.             00610002
   454     05  PIC X(24)  VALUE 'TNTNTENNESSEE           '.             00620002
   455     05  PIC X(24)  VALUE 'TXTXTEXAS               '.             00630002
   456     05  PIC X(24)  VALUE 'UTUTUTAH                '.             00640002
   457     05  PIC X(24)  VALUE 'VAVAVIRGINIA            '.             00650002
   458     05  PIC X(24)  VALUE 'VIVIUS VIRGIN ISLANDS   '.             00660002
   459     05  PIC X(24)  VALUE 'VTVTVERMONT             '.             00670002
   460     05  PIC X(24)  VALUE 'WAWAWASHINGTON          '.             00680002
   461     05  PIC X(24)  VALUE 'WIWIWISCONSIN           '.             00690002
   462     05  PIC X(24)  VALUE 'WVWVWEST VIRGINIA       '.             00700002
   463     05  PIC X(24)  VALUE 'WYWYWYOMING             '.             00710002
   464                                                                  00720002
   465 01  FILLER REDEFINES STATE-VALUES.                               00730002
   466     05  STATE-TABLE                                              00740002
   467             OCCURS 60 TIMES                                      00750002
   468             ASCENDING KEY IS ST-STATE                            00760002
   469             INDEXED BY ST-INDEX.                                 00770002
   470         10  ST-STATE          PIC XX.                            00780002
   471         10  ST-ALT-STATE      PIC XX.                            00790002
   472         10  ST-NAME           PIC X(20).                         00800002
   473                                                                  00810002
   475
*  476     COPY ELCDTECX.
   477******************************************************************06/05/98
   478*                                                                *ELCDTECX
   479*                            ELCDTECX.                           *   LV005
   480*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   481*                            VMOD=2.015                          *ELCDTECX
   482*                                                                *ELCDTECX
   483*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   484*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   485*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   486*                                                                *ELCDTECX
   487******************************************************************ELCDTECX
   488******************************************************************
   489*                   C H A N G E   L O G
   490*
   491* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   492*-----------------------------------------------------------------
   493*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   494* EFFECTIVE    NUMBER
   495*-----------------------------------------------------------------
   496* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   497*                                  BENEFIT CODES FROM 300 TO 900
   498* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  11
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   499* 051304    2003080800002  SMVA  ADD REFUND METHOD
   500******************************************************************
   501 01  DATE-CARD.                                                   ELCDTECX
   502     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   503     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   504     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   505     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   506     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   507     12  EP-SW                       PIC  X.                      ELCDTECX
   508         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   509     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   510         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   511     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   512     12  RUN-CENTURY.                                             ELCDTECX
   513         16 RUN-CENTURY-N            PIC  99.                        CL**4
   514     12  FILLER                      PIC  X.                         CL**4
   515     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   516     12  FILLER                      PIC  XXX.                    ELCDTECX
   517     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   518                                                                  ELCDTECX
   519 01  FILLER                          PIC  X(7)                       CL**6
   520                                          VALUE 'OPTIONS'.        ELCDTECX
   521 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   522     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   523     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   524     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   525         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   526         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   527     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   528     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   529     12  FILLER                      PIC  X.                      ELCDTECX
   530     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   531     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   532     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   533     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   534     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   535     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   536     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   537     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   538     12  FILLER                      PIC  X.                      ELCDTECX
   539     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   540     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   541     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   542     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   543     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   544     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   545     12  FILLER                      PIC  X.                      ELCDTECX
   546     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   547     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   548     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   549     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   550     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   551     12  DTE-R78                     PIC  X.                      ELCDTECX
   552     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   553     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   554     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   555     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   556     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  12
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   557     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   558     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   559                                     PIC  X.                      ELCDTECX
   560         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   561                                                 ' '.             ELCDTECX
   562         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   563         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   564     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   565         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   566         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   567     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   568     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   569                                     PIC  9.                         CL**4
   570     12  DTE-SYSTEM.                                              ELCDTECX
   571         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   572         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   573         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   574         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   575         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   576         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   577         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   578         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   579         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   580         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   581         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   582         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   583         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   584         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   585         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   586         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   587         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   588         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   589         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   590         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   591         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   592         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   593         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   594         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   595         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   596         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
   597     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   598         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   599                                     PIC  X.                      ELCDTECX
   600     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   601                                                                  ELCDTECX
   602 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   603     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   604     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   605     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   606*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   607     12  FILLER                      PIC  X.                      ELCDTECX
   608     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   609     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   610     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   611     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   612     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   613     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   614     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  13
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   615                                                                  ELCDTECX
   616     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   617     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   618     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   619     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   620                                                                  ELCDTECX
   621     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   622     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   623     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   624     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   625                                                                  ELCDTECX
   626     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   627     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   628                                                                  ELCDTECX
   629     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   630     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   631                                                                  ELCDTECX
   632     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   633                                                                  ELCDTECX
   634 01  DATE-CARD-FACTORS.                                           ELCDTECX
   635     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   636     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   637     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   638     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   639     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   640     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   641     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   642                                                                  ELCDTECX
   643 01  FILLER                          PIC  X(12)                   ELCDTECX
   644                                          VALUE 'COMPANY NAME'.   ELCDTECX
   645 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   646     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   647         16  CNT-ID                  PIC  X.                      ELCDTECX
   648         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   649                                                                  ELCDTECX
   650 01  FILLER                          PIC  X(11)                   ELCDTECX
   651                                          VALUE 'STATE NAMES'.    ELCDTECX
   652 01  STATE-NAMES.                                                 ELCDTECX
   653     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   654         16  STATE-SUB               PIC  XX.                     ELCDTECX
   655         16  STATE-PIC1.                                          ELCDTECX
   656             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   657             20  FILLER              PIC  XXX.                    ELCDTECX
   658             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   659             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   660             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   661             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   662                                                                  ELCDTECX
   663 01  FILLER                          PIC  X(13)                   ELCDTECX
   664                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   665 01  CARRIER-NAMES.                                               ELCDTECX
   666     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   667         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   668         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   669         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   670         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   671         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   672         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  14
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   673*        16  FILLER                  PIC  X.                      ELCDTECX
   674         16  CARRIER-SEC-PAY         PIC  X.
   675             88  SEC-PAY-CARRIER          VALUE 'Y'.
   676                                                                  ELCDTECX
   677 01  FILLER                          PIC  X(9)                       CL**6
   678                                          VALUE 'INS TYPES'.      ELCDTECX
   679 01  CLAS-INS-TYPES.                                              ELCDTECX
   680*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   681     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   682         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   683         16  CLAS-I-AB3.                                          ELCDTECX
   684             20  FILLER              PIC  X.                      ELCDTECX
   685             20  CLAS-I-AB2.                                      ELCDTECX
   686                 24  FILLER          PIC  X.                      ELCDTECX
   687                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   688         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   689             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   690             20  FILLER              PIC  X.                         CL**4
   691         16  CLAS-I-AB10.                                         ELCDTECX
   692             20  FILLER              PIC  X(9).                   ELCDTECX
   693             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   694         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   695         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   696         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   697         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   698             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   699         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   700         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   701         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   702         16  CLAS-I-BEN-CATEGORY     PIC  X.
   703         16  CLAS-I-REFUND-METHOD    PIC  X(01).
   704         16  FILLER                  PIC  X(05).
   705                                                                  ELCDTECX
   706 01  FILLER                          PIC  X(16)                   ELCDTECX
   707                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   708 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   709     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   710                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   711         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   712         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
   713         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   714         16  CLAS-MORT-DESC.                                      ELCDTECX
   715             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   716             20  FILLER              PIC  XX.                        CL**5
   717             20  CLAS-YEAR           PIC  X(4).                      CL**6
   718             20  FILLER              PIC  X.                         CL**5
   719             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   720             20  FILLER              PIC  X.                         CL**5
   721             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   722             20  FILLER              PIC  X.                         CL**5
   723             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   724             20  FILLER              PIC  X(5).                      CL**6
   725                                                                  ELCDTECX
   726 01  FILLER                          PIC  X(15)                   ELCDTECX
   727                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   728 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   729     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   730         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  15
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   731         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   732         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   733         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   734         16  FILLER                  PIC  X(4).                      CL**6
   735                                                                  ELCDTECX
   736 01  FILLER                          PIC  X(7)                       CL**6
   737                                     VALUE 'INDEXES'.             ELCDTECX
   738 01  CLAS-INDEX-TBL.                                              ELCDTECX
   739     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   740     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   741     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   742     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   743     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   744     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   745     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   746     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   747     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   748     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   749     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   750     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   751     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   752     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   753     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   754     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   755     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   756                                                                  ELCDTECX
   757 01  CLAS-TYPE-MISC.                                              ELCDTECX
   758     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   759     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   760     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   761     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   762     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   763     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   764     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   765     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   766     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   767     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   768     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   769                                                                  ELCDTECX
   770 01  FILLER                          PIC  X(13)                   ELCDTECX
   771                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   772 01  CLAS-MISC.                                                   ELCDTECX
   773     12  DTE-FICH                    PIC  X.                      ELCDTECX
   774         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   775         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   776         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   777     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   778     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   779     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   780     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   781     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   782     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   783     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   784     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   785     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   786     12  STATE-L                     PIC  XX.                     ELCDTECX
   787     12  CLAS-CN                     PIC  99.                     ELCDTECX
   788     12  CLAS-CO                     PIC  99.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  16
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   789     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   790         16  DTE-F-1                 PIC  X.                      ELCDTECX
   791         16  DTE-F-2                 PIC  X.                      ELCDTECX
   792     12  DTE-ABEND-WORK.                                          ELCDTECX
   793         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   794         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   795                                                                  ELCDTECX
   796 01  FILLER                          PIC  X(12)                   ELCDTECX
   797                                     VALUE 'WORKING DATE'.        ELCDTECX
   798 01  WS-DATE-AND-TIME.                                            ELCDTECX
   799     12  WS-ACCEPT-DATE.                                          ELCDTECX
   800         16  WS-AD-YY                PIC  99.                     ELCDTECX
   801         16  WS-AD-MM                PIC  99.                     ELCDTECX
   802         16  WS-AD-DD                PIC  99.                     ELCDTECX
   803     12  WS-CURRENT-DATE.                                         ELCDTECX
   804         16  WS-CD-MM                PIC  99.                     ELCDTECX
   805         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   806         16  WS-CD-DD                PIC  99.                     ELCDTECX
   807         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   808         16  WS-CD-YY                PIC  99.                     ELCDTECX
   809     12  WS-TIME-OF-DAY.                                          ELCDTECX
   810         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   811         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   812                                                                  ELCDTECX
   813 01  FILLER                          PIC  X(12)                   ELCDTECX
   814                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   815 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   816     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   817         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   818         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   819         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   820                                                                  ELCDTECX
   821 01  FILLER                          PIC  X(10)                   ELCDTECX
   822                                     VALUE 'STATE TLRS'.          ELCDTECX
   823 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   824     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   825         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   826         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   827                                                                  ELCDTECX
   828 01  FILLER                          PIC  X(13)                   ELCDTECX
   829                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   830 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   831     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   832         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   833                                                                  ELCDTECX
   834 01  FILLER                          PIC  X(13)                   ELCDTECX
   835                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   836 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   837     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   838     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   839     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   840                                     PIC  X.                         CL**5
   841     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   842     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   843     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   844     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   845     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   846     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  17
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   847     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   848     12  FILLER                      PIC  X(75).                  ELCDTECX
   849******************************************************************ELCDTECX
   850*01  MISC-CARR-PCT-DATA.                                          00001521
   851*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   852*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   853*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   854*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   855*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   856*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   857******************************************************************ELCDTECX
*  858     COPY ELCDTEVR.
   859***************************************************************** 04/15/98
   860*                                                                *ELCDTEVR
   861*                                                                *ELCDTEVR
   862*                            ELCDTEVR.                           *   LV003
   863*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   864*                            VMOD=2.001                          *   CL**2
   865*                                                                *ELCDTEVR
   866*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   867*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   868*                                                                *ELCDTEVR
   869******************************************************************ELCDTEVR
   870 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   871     05  WS-RUN-DATE.                                             ELCDTEVR
   872         10  FILLER                  PIC  9(03).                  ELCDTEVR
   873         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   874         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   875             15  RUN-CC              PIC  99.                     ELCDTEVR
   876             15  RUN-YR              PIC  99.                     ELCDTEVR
   877         10  RUN-MO                  PIC  99.                     ELCDTEVR
   878         10  RUN-DA                  PIC  99.                     ELCDTEVR
   879     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   880            WS-RUN-DATE              PIC 9(11).                      CL**2
   881     05  WS-EP-DT.                                                ELCDTEVR
   882         10  FILLER                  PIC  9(03).                  ELCDTEVR
   883         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   884         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   885             15  EP-CC               PIC  99.                     ELCDTEVR
   886             15  EP-YR               PIC  99.                     ELCDTEVR
   887         10  EP-MO                   PIC  99.                     ELCDTEVR
   888         10  EP-DA                   PIC  99.                     ELCDTEVR
   889     05  WS-EP-DT-N REDEFINES                                        CL**2
   890            WS-EP-DT                 PIC 9(11).                      CL**2
   891     05  WS-DTE-CONV-DT.                                             CL**4
   892         10  FILLER                  PIC  9(03).                     CL**4
   893         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   894         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   895             15  DTE-CONV-CC         PIC  99.                        CL**4
   896             15  DTE-CONV-YR         PIC  99.                        CL**4
   897         10  DTE-CONV-MO             PIC  99.                        CL**4
   898         10  DTE-CONV-DA             PIC  99.                        CL**4
   899     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   900            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   901 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   902     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   903         10  FILLER                            PIC 999.           ELCDTEVR
   904         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  18
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   905         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   906             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   907             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   908         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   909         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   910     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   911            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   912     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   913         10  FILLER                            PIC 999.           ELCDTEVR
   914         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   915         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   916         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   917         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   918     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   919            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   920 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   921     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   922         10  FILLER                            PIC 999.           ELCDTEVR
   923         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   924         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   925             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   926             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   927         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   928         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   929     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   930            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   931     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   932         10  FILLER                            PIC 999.           ELCDTEVR
   933         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   934         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   935             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   936             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   937         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   938         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   939     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   940            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   941     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   942         10  FILLER                            PIC 999.           ELCDTEVR
   943         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   944         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
   945             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   946             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   947         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   948         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   949     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   950            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   951 01  WS-RATE-RECORD.                                              ELCDTEVR
   952         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   953             10  FILLER                        PIC 999.           ELCDTEVR
   954             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   955             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   956                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   957                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   958             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   959             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   960         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   961                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
   962
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  19
* FNB164.cbl
   963 LINKAGE SECTION.
   964
   965 01  PARM.
   966     05  PARM-LENGTH      PIC S9(4)   COMP.
   967     05  CYCLE-DATE       PIC X(8).
   968
   969
   970
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  20
* FNB164.cbl
   972*
   973 PROCEDURE DIVISION USING PARM.
   974*
   975*************************************************************
*  976                                 COPY ELCDTERX.
   977******************************************************************04/15/98
   978*                                                                *ELCDTERX
   979*                                                                *ELCDTERX
   980*                            ELCDTERX.                           *   LV002
   981*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
   982*                            VMOD=2.007                          *ELCDTERX
   983*                                                                *ELCDTERX
   984*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
   985*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
   986*      = ELCDTEFD)                                               *ELCDTERX
   987*                                                                *ELCDTERX
   988******************************************************************ELCDTERX
   989                                                                  ELCDTERX
   990     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
   991                                                                  ELCDTERX
   992     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
   993     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
   994     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
   995                                                                  ELCDTERX
   996     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
   997                                                                  ELCDTERX
   998******************************************************************ELCDTERX
   999*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1000*          WARNING MESSAGES.                                      ELCDTERX
  1001******************************************************************ELCDTERX
  1002     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1003         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1004                                                                  ELCDTERX
  1005     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1006                                                                  ELCDTERX
  1007     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1008                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1009                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1010                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1011                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1012                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1013                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1014                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1015                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1016                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1017                                                                  ELCDTERX
  1018     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1019                                                                  ELCDTERX
  1020     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1021                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1022                                                                  ELCDTERX
  1023     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1024     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1025     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1026     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1027                                                                  ELCDTERX
  1028     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1029         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  21
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1030     ELSE                                                         ELCDTERX
  1031         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1032                                                                  ELCDTERX
  1033     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1034         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1035     ELSE                                                         ELCDTERX
  1036         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1037                                                                  ELCDTERX
  1038 0005-READ--CARD.                                                 ELCDTERX
  1039     READ DISK-DATE                                               ELCDTERX
  1040         AT END CLOSE DISK-DATE                                   ELCDTERX
  1041             GO TO 0060-READ--TEST.                               ELCDTERX
  1042                                                                  ELCDTERX
  1043     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1044                                                                  ELCDTERX
  1045     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1046         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1047         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1048         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1049         GO TO 0005-READ--CARD.                                   ELCDTERX
  1050                                                                  ELCDTERX
  1051     IF DD-ID = 'CLAD'                                            ELCDTERX
  1052         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1053         GO TO 0005-READ--CARD.                                   ELCDTERX
  1054                                                                  ELCDTERX
  1055     IF DD-ID = 'CLAX'                                            ELCDTERX
  1056         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1057         GO TO 0005-READ--CARD.                                   ELCDTERX
  1058                                                                  ELCDTERX
  1059     IF DD-ID = 'CLAF'                                            ELCDTERX
  1060         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1061         GO TO 0005-READ--CARD.                                   ELCDTERX
  1062                                                                  ELCDTERX
  1063     IF DD-ID = 'CLAC'                                            ELCDTERX
  1064         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1065                                                                  ELCDTERX
  1066     IF DD-ID = 'CARR'                                            ELCDTERX
  1067         GO TO 0015-READ--CARR.                                   ELCDTERX
  1068                                                                  ELCDTERX
  1069     IF DD-ID = 'STAT'                                            ELCDTERX
  1070         GO TO 0020-READ--STAT.                                   ELCDTERX
  1071                                                                  ELCDTERX
  1072     IF DD-ID = 'BUSC'                                            ELCDTERX
  1073         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1074                                                                  ELCDTERX
  1075     IF DD-ID = 'MORT'                                            ELCDTERX
  1076         GO TO 0030-READ--MORT.                                   ELCDTERX
  1077                                                                  ELCDTERX
  1078     IF DD-ID = 'CLAI'                                            ELCDTERX
  1079         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1080                                                                  ELCDTERX
  1081     IF DD-ID = 'COLC'                                            ELCDTERX
  1082         GO TO 0065-READ--COLC.                                   ELCDTERX
  1083                                                                  ELCDTERX
  1084     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1085        DD-IDA = 'CL'                                             ELCDTERX
  1086         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1087                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  22
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1088     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1089        DD-IDA = 'PO'                                             ELCDTERX
  1090         GO TO 0050-READ--POXX.                                   ELCDTERX
  1091                                                                  ELCDTERX
  1092     IF DD-ID = 'OPCA'                                            ELCDTERX
  1093         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1094                                                                  ELCDTERX
  1095     IF DD-ID = 'OPST'                                            ELCDTERX
  1096         GO TO 0072-READ--OPST.                                   ELCDTERX
  1097                                                                  ELCDTERX
  1098     IF DD-ID = 'OPBS'                                            ELCDTERX
  1099         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1100                                                                  ELCDTERX
  1101     IF DD-ID = 'OPMS'                                            ELCDTERX
  1102         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1103                                                                  ELCDTERX
  1104     GO TO 0005-READ--CARD.                                       ELCDTERX
  1105                                                                  ELCDTERX
  1106 0010-READ--CLAC.                                                 ELCDTERX
  1107     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1108     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1109     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1110     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1111     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1112     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1113     GO TO 0005-READ--CARD.                                       ELCDTERX
  1114                                                                  ELCDTERX
  1115 0015-READ--CARR.                                                 ELCDTERX
  1116     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1117     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1118        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1119        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1120        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1121        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1122        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1123        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1124        MOVE DD-CARR1-SECPAY-SW
  1125                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1126     END-IF
  1127                                                                  ELCDTERX
  1128     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1129     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1130        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1131        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1132        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1133        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1134        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1135        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1136        MOVE DD-CARR2-SECPAY-SW
  1137                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1138     END-IF
  1139                                                                  ELCDTERX
  1140                                                                  ELCDTERX
  1141     GO TO 0005-READ--CARD.                                       ELCDTERX
  1142                                                                  ELCDTERX
  1143 0020-READ--STAT.                                                 ELCDTERX
  1144     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1145     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  23
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1146        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1147         GO TO 0005-READ--CARD.                                   ELCDTERX
  1148                                                                  ELCDTERX
  1149     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1150     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1151     GO TO 0020-READ--STAT.                                       ELCDTERX
  1152                                                                  ELCDTERX
  1153 0025-READ--BUSC.                                                 ELCDTERX
  1154     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1155     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1156        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1157         GO TO 0005-READ--CARD.                                   ELCDTERX
  1158                                                                  ELCDTERX
  1159     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1160     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1161     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1162                                                                  ELCDTERX
  1163 0030-READ--MORT.                                                 ELCDTERX
  1164     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1165     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1166        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1167         GO TO 0005-READ--CARD.                                   ELCDTERX
  1168                                                                  ELCDTERX
  1169     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1170     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1171     GO TO 0030-READ--MORT.                                       ELCDTERX
  1172                                                                  ELCDTERX
  1173 0035-READ--CLXX.                                                 ELCDTERX
  1174     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1175          GO TO 0005-READ--CARD.                                  ELCDTERX
  1176                                                                  ELCDTERX
  1177     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1178         DISPLAY '***********************************************'ELCDTERX
  1179         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1180         DISPLAY '***********************************************'ELCDTERX
  1181         GO TO 0055-READ--STOP.                                   ELCDTERX
  1182                                                                  ELCDTERX
  1183     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1184        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1185         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1186                                                                  ELCDTERX
  1187     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1188        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1189         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1190                                                                  ELCDTERX
  1191*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1192     GO TO 0005-READ--CARD.                                       ELCDTERX
  1193                                                                  ELCDTERX
  1194 0040-READ--CLAI.                                                 ELCDTERX
  1195     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1196     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1197        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1198         GO TO 0005-READ--CARD.                                   ELCDTERX
  1199                                                                  ELCDTERX
  1200     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1201     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1202     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1203                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  24
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1204 0045-READ--DUMP.                                                 ELCDTERX
  1205     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1206     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1207                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1208     PERFORM ABEND-PGM.                                           ELCDTERX
  1209                                                                  ELCDTERX
  1210 0050-READ--POXX.                                                 ELCDTERX
  1211     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1212         GO TO 0005-READ--CARD.                                   ELCDTERX
  1213                                                                  ELCDTERX
  1214     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1215         DISPLAY '***********************************************'ELCDTERX
  1216         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1217         DISPLAY '***********************************************'ELCDTERX
  1218         GO TO 0055-READ--STOP.                                   ELCDTERX
  1219                                                                  ELCDTERX
  1220     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1221     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1222     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1223     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1224                                                                  ELCDTERX
  1225     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1226         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1227     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1228         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1229                                                                  ELCDTERX
  1230     GO TO 0005-READ--CARD.                                       ELCDTERX
  1231                                                                  ELCDTERX
  1232 0055-READ--STOP.                                                 ELCDTERX
  1233     GOBACK.                                                      ELCDTERX
  1234                                                                  ELCDTERX
  1235 0060-READ--TEST.                                                 ELCDTERX
  1236     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1237        CLAX-ID         = SPACE  OR                               ELCDTERX
  1238        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1239         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1240                                                                  ELCDTERX
  1241     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1242     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1243                                                                  ELCDTERX
  1244 0065-READ--COLC.                                                 ELCDTERX
  1245     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1246     GO TO 0005-READ--CARD.                                       ELCDTERX
  1247                                                                  ELCDTERX
  1248 0070-READ--OPCA.                                                 ELCDTERX
  1249                                                                  ELCDTERX
  1250     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1251                                                                  ELCDTERX
  1252     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1253             OR                                                   ELCDTERX
  1254         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1255         GO TO 0005-READ--CARD.                                   ELCDTERX
  1256                                                                  ELCDTERX
  1257     ADD 1                       TO INDEXCA.                      ELCDTERX
  1258     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1259                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1260     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1261                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  25
* FNB164.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1262 0072-READ--OPST.                                                 ELCDTERX
  1263                                                                  ELCDTERX
  1264     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1265                                                                  ELCDTERX
  1266     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1267             OR                                                   ELCDTERX
  1268         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1269         GO TO 0005-READ--CARD.                                   ELCDTERX
  1270                                                                  ELCDTERX
  1271     ADD 1                       TO INDEXST.                      ELCDTERX
  1272     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1273                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1274     GO TO 0072-READ--OPST.                                       ELCDTERX
  1275                                                                  ELCDTERX
  1276 0074-READ--OPBS.                                                 ELCDTERX
  1277                                                                  ELCDTERX
  1278     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1279                                                                  ELCDTERX
  1280     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1281             OR                                                   ELCDTERX
  1282         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1283         GO TO 0005-READ--CARD.                                   ELCDTERX
  1284                                                                  ELCDTERX
  1285     ADD 1                       TO INDEXBS.                      ELCDTERX
  1286     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1287     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1288                                                                  ELCDTERX
  1289 0079-READ--EXIT.                                                 ELCDTERX
  1290*    EXIT.                                                        ELCDTERX
  1291******************************************************************ELCDTERX
  1292*************************************************************
  1293     PERFORM 0000-HOUSEKEEPING THRU 0000-EXIT
  1294
  1295     PERFORM 1000-PROCESS      THRU 1000-EXIT
  1296         UNTIL EOF
  1297
  1298     CLOSE DAILY-DRAFTS
  1299           WORK-FILE
  1300
  1301     IF DTE-CLIENT = 'DCC'
  1302        CLOSE CSI-WORK-FILE
  1303              CCC-WORK-FILE
  1304     END-IF
  1305
  1306     GOBACK.
  1307
  1308*
  1309 1000-PROCESS.
  1310*
  1311     READ DAILY-DRAFTS
  1312         AT END GO TO 1000-EXIT
  1313     END-READ
  1314
  1315     IF PR-POLICY-TYPE NOT = 'CR'
  1316         GO TO 1000-EXIT
  1317     END-IF
  1318
  1319     MOVE SPACES                 TO WORK-RECORD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  26
* FNB164.cbl
  1320
  1321     MOVE 'CLAIMS'               TO FX-SOURCE-CODE
  1322     MOVE '60'                   TO FX-TRAN-TYPE
  1323
  1324     EVALUATE TRUE
  1325        WHEN DTE-CLIENT = 'AHL'
  1326           MOVE 'AHL CLAIMS'     TO FX-SYSTEM
  1327           MOVE '02'             TO FX-DIVISION
  1328        WHEN DTE-CLIENT = 'CID'
  1329           MOVE 'CID CLAIMS'     TO FX-SYSTEM
  1330           MOVE '02'             TO FX-DIVISION
  1331        WHEN (DTE-CLIENT = 'DCC')
  1332             AND (DR-RECORD-KEY (4:1) = '3' OR '4')
  1333           MOVE 'CSIDCCCLMS'     TO FX-SYSTEM
  1334           MOVE '11'             TO FX-DIVISION
  1335        WHEN (DTE-CLIENT = 'DCC') AND
  1336             (DR-RECORD-KEY (4:1) = '5' OR '6')
  1337           MOVE 'CCCDCCCLMS'     TO FX-SYSTEM
  1338           MOVE '50'             TO FX-DIVISION
  1339        WHEN DTE-CLIENT = 'DCC'
  1340           MOVE 'LPACCLAIMS'     TO FX-SYSTEM
  1341           MOVE '11'             TO FX-DIVISION
  1342     END-EVALUATE
  1343
  1344
  1345***** SUB-TYPE 2 = REFUND AND SUB-TYPE 1 = PAYMENT
  1346***** DR-NOTE-CODE '01' IS A NEGATIVE AMOUNT PAID AND A PAYMENT
  1347***** ORIGIN OF '3', EVALUATED IN PGM LGCIFCE
  1348     IF (DR-DRAFT-STATUS = 'S')  OR  (DR-NOTE-CODE = 01)
  1349        MOVE '02' TO FX-SUB-TYPE
  1350        MULTIPLY DR-AMOUNT-PAID BY -1 GIVING FX-AMOUNT
  1351     ELSE
  1352        MOVE '01' TO FX-SUB-TYPE
  1353        MOVE DR-AMOUNT-PAID TO FX-AMOUNT
  1354     END-IF
  1355
  1356     IF (DTE-CLIENT = 'CID' OR 'AHL')
  1357        AND (DR-RECORD-KEY (2:1) = '8')
  1358        MOVE '04'                TO FX-SUB-TYPE
  1359     END-IF
  1360
  1361     MOVE PR-PLAN-NUMBER      TO FX-PLAN-CODE
  1362     MOVE CYCLE-DATE          TO FX-POSTING-DATE
  1363     MOVE PR-POLICY-NUMBER    TO FX-POLICY-NO
  1364     MOVE PR-PO-CITY          TO FX-CITY
  1365     MOVE 'Y'                 TO FX-LOC-CODE
  1366     MOVE PR-COLL-AGT-STATE   TO FX-STATE
  1367
  1368     MOVE PR-PO-ZIP TO WS-ZIP
  1369     IF WS-ZIP(1:4) = '0000'
  1370        MOVE WS-ZIP(5:5)      TO FX-ZIP-CODE
  1371     ELSE
  1372        MOVE WS-ZIP           TO FX-ZIP-CODE
  1373     END-IF
  1374
  1375     IF DTE-CLIENT = 'CID' OR 'AHL'
  1376        MOVE 'S'                 TO FX-FY-REN
  1377     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  27
* FNB164.cbl
  1378        IF DTE-CLIENT = 'DCC'
  1379           MOVE ' '              TO FX-FY-REN
  1380        END-IF
  1381     END-IF
  1382
  1383     MOVE PR-SELL-AGT-NO      TO FX-AGENT-01
  1384     MOVE ' '                 TO FX-DISTR
  1385     MOVE ' '                 TO FX-SOURCE-ACCT
  1386     MOVE ' '                 TO FX-REFERENCE
  1387     MOVE DR-CLAIM-NUMBER     TO FX-CLAIM-NO
  1388     IF DTE-CLIENT = 'DCC'
  1389        MOVE DR-RECORD-KEY (3:2) TO FX-DRAFT-NO (1:2)
  1390        MOVE '00'                TO FX-DRAFT-NO (3:2)
  1391        MOVE DR-RECORD-KEY (5:6) TO FX-DRAFT-NO (5:6)
  1392     ELSE
  1393        MOVE DR-RECORD-KEY(1:10) TO FX-DRAFT-NO
  1394     END-IF
  1395     MOVE DR-DRAFT-STATUS     TO FX-DRAFT-STATUS
  1396
  1397     IF DR-TAX-TYPE = 'E' OR 'S'
  1398        MOVE DR-TAX-TYPE      TO FX-TAX-ID(1:1)
  1399        MOVE DR-TAX-NO        TO FX-TAX-ID(2:9)
  1400     ELSE
  1401        MOVE SPACES           TO FX-TAX-ID
  1402     END-IF
  1403
  1404     MOVE SPACES                   TO WS-DESCRIPTION
  1405     MOVE PR-POLICY-TYPE           TO WS-DESC-TYPE
  1406     MOVE 'CLAIM'                  TO WS-DESC-KON
  1407     MOVE CR-DATE-INCURRED(5:2)    TO WS-DESC-DATE(1:2)
  1408     MOVE CR-DATE-INCURRED(3:2)    TO WS-DESC-DATE(3:2)
  1409     MOVE DR-DRAFT-STATUS          TO WS-DESC-DR-STATUS
  1410     MOVE PR-PLAN-NUMBER           TO WS-DESC-PLAN
  1411**** PUT PAYEE STATE IN LAST 2 POSITIONS OF DESC
  1412     MOVE DR-PAYEE-STATE           TO WS-DESC-PAYEE-ST
  1413     MOVE WS-DESCRIPTION           TO FX-DESCRIPTION
  1414
  1415**** NO LONGER READING PLAN CODE TABLE WITHIN CID LOGIC SYSTEM
  1416**** THE FOLLOWING CALL USED TO BRING BACK PLAN CODE TABLE DATA
  1417*    CALL 'FNB160' USING WORK-RECORD
  1418
  1419**** SEARCH PULLED FROM FNB160
  1420     IF FX-STATE NOT= SPACES
  1421         SEARCH ALL STATE-TABLE
  1422             AT END DISPLAY 'INVALID STATE CODE: ' FX-STATE
  1423             WHEN ST-STATE (ST-INDEX) = FX-STATE
  1424             MOVE ST-ALT-STATE (ST-INDEX) TO FX-STATE
  1425         END-SEARCH
  1426     END-IF
  1427
  1428     MOVE SYSTEM-DATE              TO FX-JOURNAL-DATE
  1429
  1430**** THE '*' IN POSITION 250 ENSURES A 250 BYTE RECORD IS PASSED
  1431**** TO FREEDOM - PREVENTS TRUNCATION OF BLANK FIELDS
  1432     MOVE '*'                      TO WORK-RECORD(250:1)
  1433
  1434*    DISPLAY ' FX-DRAFT-NO = ' FX-DRAFT-NO (2:1)
  1435*    DISPLAY ' DR-RECORD-KEY 4 1 = ' DR-RECORD-KEY (4:1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  28
* FNB164.cbl
  1436*    DISPLAY ' CR-CARRIER = ' CR-CARRIER
  1437*    MOVE '3'                TO CR-CARRIER
  1438     IF (DTE-CLIENT = 'DCC')
  1439*       AND (CR-CARRIER = '3' OR '4')
  1440        AND (DR-RECORD-KEY (4:1) = '3' OR '4')
  1441        WRITE CSI-WORK-RECORD    FROM WORK-RECORD
  1442     ELSE
  1443       IF (DTE-CLIENT = 'DCC') AND
  1444          (DR-RECORD-KEY (4:1) = '5' OR '6')
  1445             WRITE CCC-WORK-RECORD FROM WORK-RECORD
  1446       ELSE
  1447        WRITE WORK-RECORD
  1448       END-IF
  1449     END-IF
  1450
  1451     .
  1452 1000-EXIT.
  1453     EXIT.
  1454
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:16 Page  29
* FNB164.cbl
  1456*
  1457 0000-HOUSEKEEPING.
  1458*
  1459     IF PARM-LENGTH = +0
  1460         DISPLAY 'PARAMETER DATE IS MISSING'
  1461         ADD +1 TO FORCE-DUMP
  1462     ELSE
  1463         CALL 'DATEEDIT' USING CYCLE-DATE,  DATE-SW
  1464         IF NOT VALID-DATE
  1465             DISPLAY 'INVALID PARAMETER DATE: ' CYCLE-DATE
  1466             ADD +1 TO FORCE-DUMP
  1467         END-IF
  1468     END-IF
  1469
  1470     MOVE FUNCTION CURRENT-DATE
  1471                                 TO FUNCTION-DATE
  1472     MOVE WS-FN-MO               TO SYS-MO
  1473     MOVE WS-FN-DA               TO SYS-DA
  1474     MOVE WS-FN-CCYR             TO SYS-CCYY
  1475
  1476
  1477     OPEN  INPUT DAILY-DRAFTS
  1478          OUTPUT WORK-FILE
  1479
  1480     IF DTE-CLIENT = 'DCC'
  1481        OPEN OUTPUT CSI-WORK-FILE
  1482                    CCC-WORK-FILE
  1483     END-IF
  1484
  1485     .
  1486 0000-EXIT.
  1487      EXIT.
  1488 ABEND-PGM SECTION.                                               00026280
  1489     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    00026290
  1490 ABEND-EXIT.                                                      00026300
  1491
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51044     Code:        4573
