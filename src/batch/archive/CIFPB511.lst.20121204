* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   1
* CIFPB511.cbl
* Options: int("CIFPB511.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("CIFPB511.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"CIFPB511.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "CIFPB511.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID. CIFPB511.
     3 AUTHOR.     PABLO.
     4 DATE-COMPILED. 14-Nov-12 16:14.
     5******************************************************************
     6*                   C H A N G E   L O G
     7*
     8* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
     9*-----------------------------------------------------------------
    10*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    11* EFFECTIVE    NUMBER
    12*-----------------------------------------------------------------
    13* 051606   CR2006050500001 PEMA  NEW PROGRAM
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   2
* CIFPB511.cbl
    14* 021109   CR2009010500002 PEMA  REMOVE LOAN TERM MOVE STMT
    15* 032109     2009021700002 PEMA  ADD CRED BENE TO PNDB REC
    16* 030612   IR2012030600001 PEMA  ADD A&H ONLY BENEFIT CODES
    17* 110712   CR2011071400001 PEMA  A&H ONLY IN ACCT 0001107201
    18******************************************************************
    19 ENVIRONMENT DIVISION.
    20 INPUT-OUTPUT SECTION.
    21 FILE-CONTROL.
    22     SELECT  FPB-IN              ASSIGN TO SYS010.
    23*       ORGANIZATION IS LINE SEQUENTIAL.
    24     SELECT  DISK-DATE           ASSIGN TO SYS019.
    25     SELECT  FPB-OUT             ASSIGN TO SYS012.
    26     SELECT SORT-FILE        ASSIGN TO SYS001-UT-3380-S-SORTWK1.
    27
    28 DATA DIVISION.
    29 FILE SECTION.
    30
    31 FD  FPB-IN
    32     RECORDING MODE F
    33     LABEL RECORDS STANDARD
    34     BLOCK CONTAINS 0 RECORDS.
    35
    36 01  FPB-IN-RECORD.
    37     05  FPB-RECORD-TYPE         PIC X.
    38         88  FPB-VALID-REC-1        VALUE '1'.
    39         88  FPB-VALID-REC-2        VALUE '2'.
    40         88  FPB-VALID-REC-3        VALUE '3'.
    41         88  FPB-VALID-REC-4        VALUE '4'.
    42         88  FPB-VALID-REC-5        VALUE '5'.
    43         88  FPB-VALID-REC-7        VALUE '7'.
    44         88  FPB-VALID-REC-9        VALUE '9'.
    45     05  FILLER                  PIC XXX.
    46     05  FPB-INST-NO             PIC 99.
    47     05  FPB-ACCT-NO             PIC X(10).
    48     05  FILLER                  PIC X(920).
    49
    50 FD  DISK-DATE
*   51                                 COPY ELCDTEFD.
    52******************************************************************04/15/98
    53*                                                                *ELCDTEFD
    54*                                                                *ELCDTEFD
    55*                            ELCDTEFD.                           *   LV002
    56*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    57*                            VMOD=2.007                          *   CL**2
    58*                                                                *ELCDTEFD
    59******************************************************************ELCDTEFD
    60     BLOCK CONTAINS 0 RECORDS
    61     RECORDING MODE F.                                            ELCDTEFD
    62                                                                  ELCDTEFD
    63 01  DATE-DISK.                                                   ELCDTEFD
    64     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    65     12  FILLER                      PIC  X(14).                  ELCDTEFD
    66     12  DD-CR1                      PIC  9.                      ELCDTEFD
    67     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    68     12  DD-CR2                      PIC  9.                      ELCDTEFD
    69     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    70     12  FILLER                      PIC  X(20).                  ELCDTEFD
    71                                                                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   3
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72 01  DATE-DISK-R.                                                 ELCDTEFD
    73     12  FILLER                      PIC  X(4).                   ELCDTEFD
    74     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    75                                     PIC  X(32).                  ELCDTEFD
    76                                                                  ELCDTEFD
    77 01  DATE-DISK-T.                                                 ELCDTEFD
    78     12  FILLER                      PIC  X(4).                   ELCDTEFD
    79     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    80                                     PIC  X(48).                  ELCDTEFD
    81                                                                  ELCDTEFD
    82 01  DATE-DISK-M.                                                 ELCDTEFD
    83     12  FILLER                      PIC  X(4).                   ELCDTEFD
    84     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    85                                     PIC  X(48).                  ELCDTEFD
    86                                                                  ELCDTEFD
    87 01  DATE-DISK-P.                                                 ELCDTEFD
    88     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    89     12  DD-IDX                      PIC  99.                     ELCDTEFD
    90     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    91     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    92         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    93                                     PIC  X.                      ELCDTEFD
    94         16  FILLER                  PIC  X(46).                  ELCDTEFD
    95     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    96         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    97             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    98             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    99             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
   100             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
   101         16  FILLER                  PIC  X(16).                  ELCDTEFD
   102                                                                  ELCDTEFD
   103 01  DATE-DISK-E.                                                 ELCDTEFD
   104     12  FILLER                      PIC  X(4).                   ELCDTEFD
   105     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
   106                                     PIC  X(4).                   ELCDTEFD
   107                                                                  ELCDTEFD
   108 01  DATE-DISK-C.                                                 ELCDTEFD
   109     12  FILLER                      PIC  X(7).                   ELCDTEFD
   110     12  DD-CARR1-SECPAY-SW          PIC  X.
   111     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   112     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   113     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   114     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   115     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   116     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   117     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   118     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   119     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   120     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   121     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   122     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   123     12  DD-CARR2-SECPAY-SW          PIC  X.
   124     12  FILLER                      PIC  X(7).                   ELCDTEFD
   125                                                                  ELCDTEFD
   126 01  DATE-DISK-OPT.                                               ELCDTEFD
   127     12  FILLER                      PIC  X(04).                  ELCDTEFD
   128     12  DD-TLR-DATA.                                             ELCDTEFD
   129         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   4
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
   130                                     PIC  X(03).                  ELCDTEFD
   131     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   132         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   133                                     PIC  X(06).                  ELCDTEFD
   134     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   135         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   136                                     PIC  X(07).                  ELCDTEFD
   137         16  FILLER                  PIC  X(05).                  ELCDTEFD
   138     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   139                                     PIC  X(96).                  ELCDTEFD
   140******************************************************************ELCDTEFD
   141 FD  FPB-OUT
   142     RECORDING MODE F
   143     LABEL RECORDS STANDARD
   144     BLOCK CONTAINS 0 RECORDS.
   145
   146 01  CARD-RECORD                 PIC X(91).
   147
   148 SD  SORT-FILE.
   149
   150 01  SORT-RECORD.
   151     12  SR-PENDING-RECORD.
   152         16  SR-CERT-NO              PIC X(11).
   153         16  F                       PIC X(67).
   154         16  SR-REC-TYPE             PIC XX.
   155     12  SR-CONTROL                  PIC X(10).
   156     12  SR-BATCH-HDR-IND            PIC X.
   157
   158 WORKING-STORAGE SECTION.
   159 77  FILLER  PIC X(32) VALUE '********************************'.  00133388
   160 77  FILLER  PIC X(32) VALUE '         WORKING-STORAGE        '.  00133389
   161 77  FILLER  PIC X(32) VALUE '********************************'.  00133390
   162 77  W-DISPLAY-DATE        PIC 9(9) VALUE ZEROS.
   163 77  WS-SAVE-ACCT-NO             PIC X(10) VALUE LOW-VALUES.
   164 77  V-AH-BEN-AMT-WORK      PIC S9(7)V99  VALUE ZEROS.            00134107
   165 77  LAST-REC-SW            PIC X         VALUE 'N'.              00133393
   166 77  LETTER-SW              PIC X         VALUE 'N'.              00133393
   167 77  SAVE-SUB               PIC 99        VALUE ZERO.             00133393
   168 77  SAVE-1                 PIC X         VALUE SPACE.            00133393
   169 77  CANCL-SW               PIC X         VALUE 'N'.              00133394
   170 77  SW-20                  PIC X         VALUE ' '.              00133395
   171 77  ERROR-CODE             PIC X(25)     VALUE SPACES.           00133396
   172 77  SAVE-SEQ               PIC X(30)     VALUE SPACES.           00133397
   173 77  SAVE-CERT              PIC X(10)     VALUE SPACES.           00133398
   174 77  SAVE-STATE             PIC X(02)     VALUE SPACES.           00133399
   175 77  HDR-CNT                PIC 9(07)     VALUE ZEROS.            00133400
   176 77  NAME-LINE-CNT          PIC 99        VALUE ZEROS.            00133403
   177 77  RPT-CNT                PIC 9999999   VALUE ZEROS.            00133404
   178 77  SPACE-CNT              PIC 9         VALUE ZEROS.            00133404
   179 77  DETAIL-CNT             PIC 9999      VALUE ZEROS.            00133405
   180 77  NINES-IN               PIC 9(12)     VALUE 999999999999.     00133406
   181 77  DETAIL-CNT-TOT         PIC 9999999   VALUE ZEROS.            00133407
   182 77  PPA-CNT                PIC 9999999   VALUE ZEROS.            00133407
   183 77  LOGIC-CNT              PIC 9999999   VALUE ZEROS.            00133407
   184 77  LOGIC-CANC-CNT         PIC 9999999   VALUE ZEROS.            00133407
   185 77  IN-CNT                 PIC 9999999   VALUE ZEROS.            00133408
   186 77  TOT-LIFE-WRITTEN       PIC S9(8)V99  VALUE ZEROS.            00133409
   187 77  TOT-LIFE-CANC          PIC S9(8)V99  VALUE ZEROS.            00133410
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   5
* CIFPB511.cbl
   188 77  TOT-AH-WRITTEN         PIC S9(8)V99  VALUE ZEROS.            00133411
   189 77  TOT-AH-CANC            PIC S9(8)V99  VALUE ZEROS.            00133412
   190 77  TOT-CERT-ISS           PIC S9(4)     VALUE ZEROS.            00133413
   191 77  TOT-CERT-CANC          PIC S9(4)     VALUE ZEROS.            00133414
   192 77  CANC-CNT               PIC 9999      VALUE ZEROS.            00133415
   193 77  CERT-CNT               PIC 9999      VALUE ZEROS.            00133416
   194 77  FIRST-SW               PIC X         VALUE 'Y'.              00133418
   195 77  WRITTEN-PREM-SW        PIC X         VALUE 'N'.              00133419
   196 77  JR-SUB                 PIC 99        VALUE ZEROS.            00133421
   197 77  SP-SUB                 PIC 99        VALUE ZEROS.            00133421
   198 77  JR-SW                  PIC X         VALUE 'N'.              00133422
   199 77  SAVE-JNT-FIRST-INIT    PIC X(01)     VALUE SPACES.           00133423
   200 77  SAVE-SUB-LT-SUB1       PIC 9999999   VALUE ZEROS.            00133424
   201 77  SUB1                   PIC 99        VALUE ZEROS.            00133425
   202 77  SUB2                   PIC 99        VALUE ZEROS.            00133426
   203 77  CODE-SUB               PIC 99        VALUE ZEROS.            00133427
   204 77  G-SUB                  PIC 99        VALUE ZEROS.            00133428
   205 77  SAVE-G-SUB             PIC 99        VALUE ZEROS.            00133429
   206 77  PGM-SUB                PIC S9(4) COMP  VALUE +511.
   207 77  WS-EOF-SW              PIC X         VALUE ' '.
   208     88  END-OF-FPB                       VALUE 'Y'.
   209 77  WS-RETURN-CODE         PIC S9(3)     VALUE ZERO.
   210 77  WS-ABEND-MESSAGE       PIC X(80)     VALUE SPACES.
   211 77  SAVE-EFF-DATE          PIC X(6)      VALUE SPACES.
   212 77  WS-BIN-1ST-PAY-DT      PIC XX        VALUE LOW-VALUES.
   213 77  WS-BIN-EFF-DT          PIC XX        VALUE LOW-VALUES.
   214 77  WS-BIN-BIRTH-DT        PIC XX        VALUE LOW-VALUES.
   215 77  WS-INSURED-AGE         PIC 999       VALUE ZEROS.
   216 77  RECS-IN                PIC 9(7)      VALUE ZEROS.
   217 77  RECS-RET               PIC 9(7)      VALUE ZEROS.
   218 77  RECS-REL               PIC 9(7)      VALUE ZEROS.
   219 77  WS-ABEND-FILE-STATUS   PIC XX        VALUE ZERO.
   220 77  WS-ZERO                PIC S9        VALUE ZERO.
   221 77  WS-ISS-SW              PIC X         VALUE ' '.
   222     88  ISSUED-CERT                      VALUE 'Y'.
   223 77  WS-CAN-SW              PIC X         VALUE ' '.
   224     88  CANCELLED-CERT                   VALUE 'Y'.
   225
   226 77  S1                          PIC S999 COMP-3 VALUE +0.
   227 77  S2                          PIC S999 COMP-3 VALUE +0.
   228 77  WS-LF-BENEFIT-CD            PIC XX        VALUE '  '.
   229 77  WS-AH-BENEFIT-CD            PIC XX        VALUE '  '.
   230 77  WS-LF-PREM                  PIC 9(9)V99   VALUE ZEROS.
   231 77  WS-AH-PREM                  PIC 9(9)V99   VALUE ZEROS.
   232 77  WS-LF-PREM-ALT              PIC 9(9)V99   VALUE ZEROS.
   233 77  WS-LF-BALLOON               PIC 9(11)V99  VALUE ZEROS.
   234 77  WS-LF-REF                   PIC 9(9)V99   VALUE ZEROS.
   235 77  WS-AH-REF                   PIC 9(9)V99   VALUE ZEROS.
   236 77  WS-LF-REF-DATE              PIC X(6)      VALUE ZEROS.
   237 77  WS-AH-REF-DATE              PIC X(6)      VALUE ZEROS.
   238 77  WS-PREV-SR-ACCOUNT          PIC X(10)     VALUE LOW-VALUES.
   239 77  WS-AH-ONLY-SW               PIC X         VALUE ' '.
   240     88  FOUND-AH-ONLY                   VALUE 'Y'.
   241
   242 01  BRANCH-RESP-TABLE.
   243     05  LOAN-OFFICERS.
   244         10  FILLER              PIC X(5)  VALUE '11001'.
   245         10  FILLER              PIC X(5)  VALUE '13445'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   6
* CIFPB511.cbl
   246         10  FILLER              PIC X(5)  VALUE '13645'.
   247         10  FILLER              PIC X(5)  VALUE '13745'.
   248         10  FILLER              PIC X(5)  VALUE '13917'.
   249         10  FILLER              PIC X(5)  VALUE '14312'.
   250         10  FILLER              PIC X(5)  VALUE '14413'.
   251         10  FILLER              PIC X(5)  VALUE '14518'.
   252         10  FILLER              PIC X(5)  VALUE '14821'.
   253         10  FILLER              PIC X(5)  VALUE '15117'.
   254         10  FILLER              PIC X(5)  VALUE '15319'.
   255         10  FILLER              PIC X(5)  VALUE '20117'.
   256         10  FILLER              PIC X(5)  VALUE '21118'.
   257         10  FILLER              PIC X(5)  VALUE '22417'.
   258         10  FILLER              PIC X(5)  VALUE '22617'.
   259         10  FILLER              PIC X(5)  VALUE '22714'.
   260         10  FILLER              PIC X(5)  VALUE '23217'.
   261         10  FILLER              PIC X(5)  VALUE '23616'.
   262         10  FILLER              PIC X(5)  VALUE '23720'.
   263         10  FILLER              PIC X(5)  VALUE '24207'.
   264         10  FILLER              PIC X(5)  VALUE '24605'.
   265         10  FILLER              PIC X(5)  VALUE '25217'.
   266         10  FILLER              PIC X(5)  VALUE '26818'.
   267         10  FILLER              PIC X(5)  VALUE '26918'.
   268         10  FILLER              PIC X(5)  VALUE '27014'.
   269         10  FILLER              PIC X(5)  VALUE '27117'.
   270         10  FILLER              PIC X(5)  VALUE '27501'.
   271         10  FILLER              PIC X(5)  VALUE '27620'.
   272         10  FILLER              PIC X(5)  VALUE '27712'.
   273         10  FILLER              PIC X(5)  VALUE '30513'.
   274         10  FILLER              PIC X(5)  VALUE '31017'.
   275         10  FILLER              PIC X(5)  VALUE '31521'.
   276         10  FILLER              PIC X(5)  VALUE '32013'.
   277         10  FILLER              PIC X(5)  VALUE '36001'.
   278         10  FILLER              PIC X(5)  VALUE '42516'.
   279         10  FILLER              PIC X(5)  VALUE '43016'.
   280         10  FILLER              PIC X(5)  VALUE '48116'.
   281         10  FILLER              PIC X(5)  VALUE '48512'.
   282         10  FILLER              PIC X(5)  VALUE '50019'.
   283         10  FILLER              PIC X(5)  VALUE '50503'.
   284         10  FILLER              PIC X(5)  VALUE '50710'.
   285         10  FILLER              PIC X(5)  VALUE '51521'.
   286         10  FILLER              PIC X(5)  VALUE '53806'.
   287         10  FILLER              PIC X(5)  VALUE '54206'.
   288         10  FILLER              PIC X(5)  VALUE '54805'.
   289         10  FILLER              PIC X(5)  VALUE '60718'.
   290         10  FILLER              PIC X(5)  VALUE '60821'.
   291         10  FILLER              PIC X(5)  VALUE '60901'.
   292         10  FILLER              PIC X(5)  VALUE '63407'.
   293         10  FILLER              PIC X(5)  VALUE '63801'.
   294         10  FILLER              PIC X(5)  VALUE '64101'.
   295         10  FILLER              PIC X(5)  VALUE '64614'.
   296         10  FILLER              PIC X(5)  VALUE '70105'.
   297         10  FILLER              PIC X(5)  VALUE '73505'.
   298         10  FILLER              PIC X(5)  VALUE '74105'.
   299         10  FILLER              PIC X(5)  VALUE '74405'.
   300         10  FILLER              PIC X(5)  VALUE '81005'.
   301         10  FILLER              PIC X(5)  VALUE '90501'.
   302     05  LOAN-OFFS REDEFINES LOAN-OFFICERS OCCURS 58
   303                   ASCENDING KEY RESP-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   7
* CIFPB511.cbl
   304                   INDEXED BY S3.
   305         10  RESP-CODE           PIC XXX.
   306         10  BRANCH-CODE         PIC XX.
   307
   308
   309 01  WS-WORK-APR.
   310     05  WS-WORK-APR-DOLLARS       PIC 9(6).
   311     05  WS-WORK-APR-CENTS         PIC 9(6).
   312 01  WS-WORK-APR-N REDEFINES WS-WORK-APR
   313                                   PIC 9(6)V9(6).
   314
   315 01  WS-WORK-PREM-1.
   316     05  WS-WORK-PREM-DOLLARS-1    PIC 9(9).
   317     05  WS-WORK-PREM-CENTS-1      PIC 99.
   318 01  WS-WORK-PREM-N-1 REDEFINES WS-WORK-PREM-1
   319                                   PIC 9(9)V99.
   320
   321 01  WS-WORK-PREM-2.
   322     05  WS-WORK-PREM-DOLLARS-2    PIC 9(9).
   323     05  WS-WORK-PREM-CENTS-2      PIC 99.
   324 01  WS-WORK-PREM-N-2 REDEFINES WS-WORK-PREM-2
   325                                   PIC 9(9)V99.
   326
   327 01  WS-WORK-AMT.
   328     05  WS-WORK-AMT-DOLLARS       PIC 9(9).
   329     05  WS-WORK-AMT-CENTS         PIC 99.
   330 01  WS-WORK-AMT-N   REDEFINES WS-WORK-AMT
   331                                   PIC 9(9)V99.
   332
   333 01  WS-WORK-AMT-2.
   334     05  WS-WORK-AMT-DOLLARS-2     PIC 9(9).
   335     05  WS-WORK-AMT-CENTS-2       PIC 99.
   336 01  WS-WORK-AMT-N-2 REDEFINES WS-WORK-AMT-2
   337                                   PIC 9(9)V99.
   338
   339 01  WS-WORK-REFUND-1.
   340     05  WS-WORK-REF-DOLLARS-1   PIC 9(9).
   341     05  WS-WORK-REF-CENTS-1     PIC 99.
   342 01  WS-WORK-REFUND-N-1 REDEFINES WS-WORK-REFUND-1
   343                                   PIC 9(9)V99.
   344
   345 01  WS-WORK-REFUND-2.
   346     05  WS-WORK-REF-DOLLARS-2   PIC 9(9).
   347     05  WS-WORK-REF-CENTS-2     PIC 99.
   348 01  WS-WORK-REFUND-N-2 REDEFINES WS-WORK-REFUND-2
   349                                   PIC 9(9)V99.
   350
   351 01  WS-CERT-WORK1.                                               00133352
   352     05  WS-CERT-WK1-NUM-6         PIC X(06).                     00133352
   353     05  WS-CERT-WK1-ZEROS-4       PIC X(04).                     00133352
   354 01  WS-CERT-WORK1-R  REDEFINES                                   00133352
   355     WS-CERT-WORK1.                                               00133352
   356     05  WS-CERT-WK1-NUM-7         PIC X(07).                     00133352
   357     05  WS-CERT-WK1-ZEROS-3       PIC X(03).                     00133352
   358                                                                  00133352
   359 01  WS-CERT-WORK2.                                               00133352
   360     05  WS-CERT-WK2-ZEROS-4       PIC X(04).                     00133352
   361     05  WS-CERT-WK2-NUM-6         PIC X(06).                     00133352
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   8
* CIFPB511.cbl
   362 01  WS-CERT-WORK2-R  REDEFINES                                   00133352
   363     WS-CERT-WORK2.                                               00133352
   364     05  WS-CERT-WK2-ZEROS-3       PIC X(03).                     00133352
   365     05  WS-CERT-WK2-NUM-7         PIC X(07).                     00133352
   366
   367 01  SPACE-CK.                                                    00133447
   368     05  SP-CK               PIC X    OCCURS 26 TIMES.            00133448
   369
   370 01  CANC-NAME.                                                   00133461
   371     05   A-NAME             PIC X(11) VALUE SPACE.               00133462
   372     05   A-INIT             PIC X     VALUE SPACE.               00133463
   373
   374 01  W-PROC-YR-CEN.                                               00133497
   375     05  W-PROC-MO          PIC 99        VALUE ZEROS.            00133417
   376     05  W-PROC-SLASH       PIC X         VALUE '/'.              00133417
   377     05  W-PROC-CEN         PIC X(02)     VALUE SPACES.           00133498
   378     05  W-PROC-YR          PIC 9(02)     VALUE ZEROS.            00133499
   379                                                                  00133500
   380 01  OUT-RECORD.                                                  00133501
   381     05  OUT-CERT-NO        PIC X(10)     VALUE SPACES.           00133502
   382     05  OUT-CERT-SFX       PIC X(01)     VALUE SPACES.           00133503
   383     05  OUT-EFF-DATE       PIC X(06)     VALUE SPACES.           00133504
   384     05  OUT-INFO           PIC X(61)     VALUE SPACES.           00133505
   385     05  OUT-TRAN-TYPE      PIC X         VALUE SPACES.           00133506
   386     05  OUT-SEQUENCE       PIC X         VALUE SPACES.           00133507
   387     05  OUT-ACCOUNT-NO     PIC X(10)     VALUE SPACES.
   388     05  OUT-BATCH-HDR-IND  PIC X         VALUE SPACES.
   389
   390 01  FPB-BATCH-NO.
   391     05  SR-BATCH-NUMB.                                           00133508
   392         10  SR-BATCH-ID    PIC XX        VALUE ZEROS.            00133508
   393         10  SR-BATCH-DA    PIC XX        VALUE ZEROS.            00133508
   394         10  SR-BATCH-NO    PIC 99        VALUE ZEROS.            00133508
   395     05  SR-REC-CNT         PIC 9(4)      VALUE ZEROS.            00133509
   396                                                                  00133510
   397 01  SAVE-FULL-ACCT.                                              00133511
   398     05 SAVE-ACCT-7         PIC X(07)     VALUE SPACES.           00133512
   399     05 SAVE-ACCT           PIC XXX       VALUE SPACES.           00133513
   400                                                                  00133514
   401 01  FPB-BATCH-HDR.
   402     05 FP-CARR-CO.                                               00133516
   403         10 FP-CARR          PIC X         VALUE '9'.             00133517
   404         10 FP-COMP          PIC X(6)      VALUE '000000'.        00133518
   405     05 FP-STATE             PIC XX        VALUE 'SD'.            00133519
   406     05 FP-ACCT-NO           PIC X(10)     VALUE SPACES.
   407     05 FP-BATCH-NUMB.                                            00133521
   408         10 FP-BATCH-ID      PIC XX        VALUE ZEROS.           00133521
   409         10 FP-BATCH-DA      PIC XX        VALUE ZEROS.           00133521
   410         10 FP-BATCH-NO      PIC 99        VALUE ZEROS.           00133521
   411     05 FP-HD-EFF-DT.                                             00133522
   412         10 FP-HD-EFF-MO     PIC XX        VALUE SPACES.          00133523
   413         10 FP-HD-EFF-DA     PIC XX        VALUE SPACES.          00133524
   414         10 FP-HD-EFF-YR     PIC XX        VALUE SPACES.          00133525
   415     05 FP-CERT-ISS          PIC S9(4)     VALUE ZEROS.           00133526
   416     05 FP-LF-WRITTEN        PIC S9(7)V99  VALUE ZEROS.           00133527
   417     05 FP-AH-WRITTEN        PIC S9(7)V99  VALUE ZEROS.           00133528
   418     05 FP-CERT-CANC         PIC S9(4)     VALUE ZEROS.           00133529
   419     05 FP-LF-CANC           PIC S9(7)V99  VALUE ZEROS.           00133530
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page   9
* CIFPB511.cbl
   420     05 FP-AH-CANC           PIC S9(7)V99  VALUE ZEROS.           00133531
   421     05 FP-CLIENT-ID         PIC X(3)      VALUE 'CID'.           00133532
   422     05 FP-TRANS-TYPE        PIC X         VALUE '1'.             00133533
   423     05 FP-SEQUENCE-NO       PIC X         VALUE '0'.             00133534
   424     05 FP-ACCOUNT-NO        PIC X(10)  VALUE SPACES.
   425     05 FP-BATCH-HDR-IND     PIC X      VALUE ' '.
   426                                                                  00133535
   427                                                                  00133621
   428 01  WS-BIRTH-DT                 PIC 9(6).
   429 01  WS-1ST-PMT-DT               PIC 9(6).
   430
   431 01  WS-WORK-DATE            PIC X(8).
   432 01  WS-WORK-DATE-N REDEFINES WS-WORK-DATE
   433                             PIC 9(8).
   434 01  WK-DATE-N.                                                   00133622
   435     05  WK-MO-X             PIC XX     VALUE SPACES.             00133623
   436     05  WK-MO-N REDEFINES WK-MO-X PIC 99.                        00133624
   437                                                                  00133625
   438 01  WK-DATE.                                                     00133626
   439     05  WK-MO               PIC XX     VALUE SPACES.             00133627
   440     05  FILLER              PIC X      VALUE SPACES.             00133628
   441     05  WK-DA               PIC XX     VALUE SPACES.             00133629
   442     05  FILLER              PIC X      VALUE SPACES.             00133630
   443     05  WK-YR               PIC XX     VALUE SPACES.             00133631
   444                                                                  00133632
   445 01  WORK-DATE.                                                   00133633
   446     12  WORK-BIRTH-DATE.
   447         15  WB-CC               PIC XX.
   448         15  WB-YY               PIC XX.
   449         15  WB-MM               PIC XX.
   450         15  WB-DD               PIC XX.
   451     12  WORK-BIRTH-DATE-N REDEFINES WORK-BIRTH-DATE
   452                                 PIC 9(8).
   453     12  WORK-DATE-X.                                             00133634
   454         15  WORK-MO-X       PIC XX.                              00133635
   455         15  WORK-DA-X       PIC XX.                              00133636
   456         15  WORK-YR-X       PIC XX.                              00133637
   457     12  WORK-DATE-N    REDEFINES   WORK-DATE-X.                  00133638
   458         15  WORK-MO-N       PIC 99.                              00133639
   459         15  WORK-DA-N       PIC 99.                              00133640
   460         15  WORK-YR-N       PIC 99.                              00133641
   461                                                                  00133642
   462     12  WORK-DATE-IN.                                            00133638
   463         15  WORK-YR-IN      PIC 99.                              00133641
   464         15  WORK-MO-IN      PIC 99.                              00133639
   465         15  WORK-DA-IN      PIC 99.                              00133640
   466                                                                  00133642
   467 01  WORK-ISS-DATE.                                               00133642
   468     05  WRK-ISS-YR          PIC XX.                              00133642
   469     05  WRK-ISS-MO          PIC XX.                              00133642
   470     05  WRK-ISS-DA          PIC XX.                              00133642
   471                                                                  00133642
   472 01  WORK-ISS-DTE-R          REDEFINES                            00133638
   473     WORK-ISS-DATE           PIC 9(06).                           00133638
   474                                                                  00133642
   475 01  WORK-ISS-DTE-N          REDEFINES                            00133638
   476     WORK-ISS-DATE.                                               00133638
   477     05  WRK-ISS-YR-N        PIC 99.                              00133642
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  10
* CIFPB511.cbl
   478     05  WRK-ISS-MO-N        PIC 99.                              00133642
   479     05  WRK-ISS-DA-N        PIC 99.                              00133642
   480                                                                  00133642
   481                                                                  00133383
   482******************************************************************00133384
   483                                                                  00133379
   484                                                                  00133662
*  485                                 COPY ERCPNDBI.
   486******************************************************************04/29/98
   487*                                                                *ERCPNDBI
   488*                                                                *ERCPNDBI
   489*                            ERCPNDBI                            *   LV015
   490*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*15
   491*                            VMOD=2.014                          *   CL*14
   492*                                                                *ERCPNDBI
   493*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *ERCPNDBI
   494*                      BATCH INPUT FILE                          *ERCPNDBI
   495*                                                                *ERCPNDBI
   496*   FILE TYPE = SEQUENTIAL                                       *ERCPNDBI
   497*   RECORD SIZE = 80  RECFORM = FIXED                            *ERCPNDBI
   498*                                                                *ERCPNDBI
   499******************************************************************ERCPNDBI
   500*                   C H A N G E   L O G
   501*
   502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   503*-----------------------------------------------------------------
   504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   505* EFFECTIVE    NUMBER
   506*-----------------------------------------------------------------
   507* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   508* 032306                   PEMA  ADD BOW LOAN NUMBER
   509* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDBI REC
   510* 032409    2009031600001  AJRA  ADD VIN NUMBER
   511******************************************************************
   512                                                                  ERCPNDBI
   513 01  PENDING-BUSINESS-IN.                                         ERCPNDBI
   514     12  PBI-RECORD-BODY                       PIC X(80).         ERCPNDBI
   515                                                                  ERCPNDBI
   516     12  PBI-ISSUE-CANCEL-COMMON               REDEFINES          ERCPNDBI
   517         PBI-RECORD-BODY.                                         ERCPNDBI
   518         16  PBI-CERT-NO.                                         ERCPNDBI
   519             20  PBI-CERT-PRIME                PIC X(10).         ERCPNDBI
   520             20  PBI-CERT-SFX                  PIC X.             ERCPNDBI
   521         16  PBI-CERT-EFF-DT.                                     ERCPNDBI
   522             20  PBI-CERT-EFF-MO               PIC S99.           ERCPNDBI
   523             20  PBI-CERT-EFF-DA               PIC S99.           ERCPNDBI
   524             20  PBI-CERT-EFF-YR               PIC S99.           ERCPNDBI
   525         16  PBI-CERT-EFF-DT-X                 REDEFINES          ERCPNDBI
   526             PBI-CERT-EFF-DT                   PIC X(6).          ERCPNDBI
   527                                                                  ERCPNDBI
   528         16  FILLER                            PIC X(61).         ERCPNDBI
   529                                                                  ERCPNDBI
   530         16  PBI-TRANS-TYPE                    PIC X.             ERCPNDBI
   531             88  PBI-REMITTANCE                VALUE '1'.         ERCPNDBI
   532             88  PBI-ISSUE                     VALUE '2'.         ERCPNDBI
   533             88  PBI-CANCEL                    VALUE '3'.         ERCPNDBI
   534         16  PBI-SEQUENCE                      PIC X.             ERCPNDBI
   535             88  PBI-PROFILE                   VALUE '1'.         ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  11
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   536             88  PBI-JOINT                     VALUE '2'.         ERCPNDBI
   537             88  PBI-LIFE                      VALUE '3'.         ERCPNDBI
   538             88  PBI-AH                        VALUE '4'.         ERCPNDBI
   539             88  PBI-LOAN-INFO                 VALUE '5'.         ERCPNDBI
   540             88  PBI-ADDR-1                    VALUE '6'.         ERCPNDBI
   541             88  PBI-ADDR-2                    VALUE '7'.         ERCPNDBI
   542             88  PBI-CRED-BENE1                VALUE '8'.         ERCPNDBI
   543                                                                  ERCPNDBI
   544******************************************************************ERCPNDBI
   545                                                                  ERCPNDBI
   546     12  PBI-ISSUE-RECORD                      REDEFINES          ERCPNDBI
   547         PBI-RECORD-BODY.                                         ERCPNDBI
   548         16  FILLER                            PIC X(17).         ERCPNDBI
   549                                                                  ERCPNDBI
   550         16  PBI-I-CERT-FORM                   PIC X(61).         ERCPNDBI
   551                                                                  ERCPNDBI
   552         16  PBI-I-ISSUE-REC-SEQ-1             REDEFINES          ERCPNDBI
   553             PBI-I-CERT-FORM.                                     ERCPNDBI
   554             20  PBI-I-INSURED-NAME.                              ERCPNDBI
   555                 24  PBI-I-INS-1ST-NAME.                          ERCPNDBI
   556                     28  PBI-I-INS-1ST-INIT    PIC X.             ERCPNDBI
   557                     28  FILLER                PIC X(9).          ERCPNDBI
   558                 24  PBI-I-INS-MIDDLE-INIT     PIC X.             ERCPNDBI
   559                 24  PBI-I-INS-LAST-NAME       PIC X(15).         ERCPNDBI
   560             20  PBI-I-INSURED-AGE             PIC S99.           ERCPNDBI
   561             20  PBI-I-INSURED-AGE-X           REDEFINES          ERCPNDBI
   562                 PBI-I-INSURED-AGE             PIC XX.            ERCPNDBI
   563             20  PBI-I-INSURED-SEX             PIC X.             ERCPNDBI
   564             20  PBI-I-SOC-SEC-NO              PIC X(11).         ERCPNDBI
   565             20  PBI-I-MEMBER-NO               PIC X(12).         ERCPNDBI
   566             20  PBI-I-BIRTHDAY.                                  ERCPNDBI
   567                 24  PBI-I-BIRTH-MO            PIC S99.           ERCPNDBI
   568                 24  PBI-I-BIRTH-DA            PIC S99.           ERCPNDBI
   569                 24  PBI-I-BIRTH-YR            PIC S99.           ERCPNDBI
   570             20  PBI-I-BIRTHDAY-X              REDEFINES          ERCPNDBI
   571                 PBI-I-BIRTHDAY                PIC X(6).          ERCPNDBI
   572             20  FILLER                        PIC X.             ERCPNDBI
   573             20  PBI-I-ENTRY-CD                PIC X.             ERCPNDBI
   574                 88  REIN-ONLY-CERT            VALUE 'R'.         ERCPNDBI
   575                 88  REISSUED-CERT             VALUE 'E'.         ERCPNDBI
   576                 88  PREM-ACCTNG-ONLY          VALUE 'P'.            CL**3
   577                 88  DECLINED-CERT             VALUE 'D'.            CL**9
   578                 88  CERT-NEEDS-UNDERWRITING   VALUE 'U'.            CL**9
   579                 88  VOIDED-CERT               VALUE 'V'.            CL**9
   580             20  PBI-I-FORCE-CD                PIC X.             ERCPNDBI
   581                 88  FORCE-ALL-ISSUE-ERRORS    VALUE 'A'.         ERCPNDBI
   582                 88  FORCE-DATE-ERRORS-ONLY    VALUE 'D'.         ERCPNDBI
   583                 88  PLACE-REC-ON-HOLD         VALUE 'H'.         ERCPNDBI
   584                                                                  ERCPNDBI
   585         16  PBI-I-ISSUE-REC-SEQ-2             REDEFINES          ERCPNDBI
   586             PBI-I-CERT-FORM.                                     ERCPNDBI
   587             20  PBI-I-JOINT-NAME.                                ERCPNDBI
   588                 24  PBI-I-JNT-1ST-NAME.                          ERCPNDBI
   589                     28  PBI-I-JNT-1ST-INIT    PIC X.             ERCPNDBI
   590                     28  FILLER                PIC X(9).          ERCPNDBI
   591                 24  PBI-I-JNT-MIDDLE-INIT     PIC X.             ERCPNDBI
   592                 24  PBI-I-JNT-LAST-NAME       PIC X(15).         ERCPNDBI
   593             20  PBI-I-JOINT-AGE               PIC S99.           ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  12
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   594             20  PBI-I-JOINT-AGE-X             REDEFINES          ERCPNDBI
   595                 PBI-I-JOINT-AGE               PIC XX.            ERCPNDBI
   596             20  PBI-I-POLICY-FORM-NO          PIC X(12).            CL**4
   597             20  FILLER                        PIC X(21).            CL**4
   598                                                                  ERCPNDBI
   599         16  PBI-I-ISSUE-REC-SEQ-3             REDEFINES          ERCPNDBI
   600             PBI-I-CERT-FORM.                                     ERCPNDBI
   601             20  FILLER                        PIC X.             ERCPNDBI
   602             20  PBI-I-LF-BENEFIT-TYPE         PIC XX.            ERCPNDBI
   603             20  PBI-I-LF-TERM                 PIC S9(03).        ERCPNDBI
   604             20  PBI-I-LF-TERM-X               REDEFINES          ERCPNDBI
   605                 PBI-I-LF-TERM                 PIC X(3).          ERCPNDBI
   606             20  PBI-I-LF-BENEFIT-AMT          PIC S9(09)V99.     ERCPNDBI
   607             20  PBI-I-LF-BENEFIT-AMT-X        REDEFINES          ERCPNDBI
   608                 PBI-I-LF-BENEFIT-AMT          PIC X(11).         ERCPNDBI
   609             20  PBI-I-LF-PREM-AMT             PIC S9(7)V99.      ERCPNDBI
   610             20  PBI-I-LF-PREM-AMT-X           REDEFINES          ERCPNDBI
   611                 PBI-I-LF-PREM-AMT             PIC X(9).          ERCPNDBI
   612             20  PBI-I-LF-CRIT-PERIOD          PIC 999.           ERCPNDBI
   613             20  PBI-I-LF-CRIT-PERIOD-X        REDEFINES          ERCPNDBI
   614                 PBI-I-LF-CRIT-PERIOD          PIC XXX.           ERCPNDBI
   615             20  PBI-I-LF-EXPIRE-DT.                              ERCPNDBI
   616                 24  PBI-I-LF-EXPIRE-MO        PIC S99.           ERCPNDBI
   617                 24  PBI-I-LF-EXPIRE-DA        PIC S99.           ERCPNDBI
   618                 24  PBI-I-LF-EXPIRE-YR        PIC S99.           ERCPNDBI
   619             20  PBI-I-LF-EXPIRE-DT-X          REDEFINES          ERCPNDBI
   620                 PBI-I-LF-EXPIRE-DT            PIC X(6).          ERCPNDBI
   621             20  PBI-I-LF-ALT-BENEFIT-AMT      PIC S9(07)V99.     ERCPNDBI
   622             20  PBI-I-LF-ALT-BENEFIT-AMT-X    REDEFINES          ERCPNDBI
   623                 PBI-I-LF-ALT-BENEFIT-AMT      PIC X(9).          ERCPNDBI
   624             20  PBI-I-LF-ALT-PREM-AMT         PIC S9(5)V99.      ERCPNDBI
   625             20  PBI-I-LF-ALT-PREM-AMT-X       REDEFINES          ERCPNDBI
   626                 PBI-I-LF-ALT-PREM-AMT         PIC X(7).          ERCPNDBI
   627             20  PBI-I-TERM-AS-DAYS            PIC 9(5).          ERCPNDBI
   628             20  PBI-I-TERM-AS-DAYS-X          REDEFINES          ERCPNDBI
   629                 PBI-I-TERM-AS-DAYS            PIC X(5).          ERCPNDBI
   630             20  FILLER                        PIC X(5).          ERCPNDBI
   631                                                                  ERCPNDBI
   632         16  PBI-I-ISSUE-REC-SEQ-4             REDEFINES          ERCPNDBI
   633             PBI-I-CERT-FORM.                                     ERCPNDBI
   634             20  PBI-I-AH-BENEFIT-TYPE.                           ERCPNDBI
   635                 24  PBI-I-AH-BENEFIT-POS1     PIC X.                CL**4
   636                 24  PBI-I-AH-BENEFIT-NO       PIC XX.            ERCPNDBI
   637             20  PBI-I-AH-TERM                 PIC S9(3).         ERCPNDBI
   638             20  PBI-I-AH-TERM-X               REDEFINES          ERCPNDBI
   639                 PBI-I-AH-TERM                 PIC X(3).          ERCPNDBI
   640             20  FILLER                        PIC XX.            ERCPNDBI
   641             20  PBI-I-AH-BENEFIT-AMT          PIC S9(7)V99.      ERCPNDBI
   642             20  PBI-I-AH-BENEFIT-AMT-X        REDEFINES          ERCPNDBI
   643                 PBI-I-AH-BENEFIT-AMT          PIC X(9).          ERCPNDBI
   644             20  PBI-I-AH-PREM-AMT             PIC S9(7)V99.      ERCPNDBI
   645             20  PBI-I-AH-PREM-AMT-X           REDEFINES          ERCPNDBI
   646                 PBI-I-AH-PREM-AMT             PIC X(9).          ERCPNDBI
   647             20  PBI-I-AH-CRIT-PERIOD          PIC 999.           ERCPNDBI
   648             20  PBI-I-AH-CRIT-PERIOD-X        REDEFINES          ERCPNDBI
   649                 PBI-I-AH-CRIT-PERIOD          PIC XXX.           ERCPNDBI
   650             20  PBI-I-AH-EXPIRE-DT.                              ERCPNDBI
   651                 24  PBI-I-AH-EXPIRE-MO        PIC S99.           ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  13
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   652                 24  PBI-I-AH-EXPIRE-DA        PIC S99.           ERCPNDBI
   653                 24  PBI-I-AH-EXPIRE-YR        PIC S99.           ERCPNDBI
   654             20  PBI-I-AH-EXPIRE-DT-X          REDEFINES          ERCPNDBI
   655                 PBI-I-AH-EXPIRE-DT            PIC X(6).          ERCPNDBI
   656             20  PBI-I-AH-PAYMENT              PIC S9(7)V99.         CL**6
   657             20  PBI-I-AH-PAYMENT-X            REDEFINES             CL**6
   658                 PBI-I-AH-PAYMENT              PIC X(9).             CL**6
   659*00160              20  FILLER                        PIC X(17).
   660             20  PBI-I-VIN                     PIC X(17).
   661                                                                  ERCPNDBI
   662         16  PBI-I-ISSUE-REC-SEQ-5             REDEFINES          ERCPNDBI
   663             PBI-I-CERT-FORM.                                     ERCPNDBI
   664             20  PBI-I-LOAN-OFFICER            PIC X(5).          ERCPNDBI
   665             20  PBI-I-LOAN-TERM               PIC S999.          ERCPNDBI
   666             20  PBI-I-LOAN-TERM-X             REDEFINES          ERCPNDBI
   667                 PBI-I-LOAN-TERM               PIC XXX.           ERCPNDBI
   668             20  PBI-I-1ST-PMT-DT.                                ERCPNDBI
   669                 24  PBI-I-1ST-PMT-MO          PIC S99.           ERCPNDBI
   670                 24  PBI-I-1ST-PMT-DA          PIC S99.           ERCPNDBI
   671                 24  PBI-I-1ST-PMT-YR          PIC S99.           ERCPNDBI
   672             20  PBI-I-1ST-PMT-DT-X            REDEFINES          ERCPNDBI
   673                 PBI-I-1ST-PMT-DT              PIC X(6).          ERCPNDBI
   674             20  PBI-I-EXT-DAYS                PIC S999.          ERCPNDBI
   675             20  PBI-I-EXT-DAYS-X              REDEFINES          ERCPNDBI
   676                 PBI-I-EXT-DAYS                PIC XXX.           ERCPNDBI
   677             20  PBI-I-INDV-GRP-CD             PIC X.             ERCPNDBI
   678             20  PBI-I-REIN-CODE               PIC X.             ERCPNDBI
   679             20  PBI-I-SIG-SW                  PIC X.             ERCPNDBI
   680             20  PBI-I-TERM-TYPE               PIC X.                CL**6
   681*            20  FILLER                        PIC X.                CL**6
   682             20  PBI-I-LOAN-APR                PIC 9(2)V9(4).     ERCPNDBI
   683             20  PBI-I-LOAN-APR-X              REDEFINES          ERCPNDBI
   684                 PBI-I-LOAN-APR                PIC X(6).          ERCPNDBI
   685             20  PBI-I-LIVES                   PIC 9(3).          ERCPNDBI
   686             20  PBI-I-LIVES-X                 REDEFINES          ERCPNDBI
   687                 PBI-I-LIVES                   PIC X(3).             CL**6
   688             20  PBI-I-NO-OF-PAYMENTS          REDEFINES             CL**6
   689                 PBI-I-LIVES                   PIC 9(3).             CL**6
   690             20  PBI-I-NO-OF-PAYMENTS-X        REDEFINES             CL**6
   691                 PBI-I-LIVES                   PIC X(3).          ERCPNDBI
   692             20  PBI-I-PAY-FREQUENCY           PIC 99.            ERCPNDBI
   693             20  PBI-I-PAY-FREQUENCY-X         REDEFINES          ERCPNDBI
   694                 PBI-I-PAY-FREQUENCY           PIC XX.            ERCPNDBI
   695             20  PBI-I-RATE-CLASS              PIC XX.            ERCPNDBI
   696             20  PBI-I-SKIP-CODE               PIC XX.            ERCPNDBI
   697*            20  FILLER                        PIC X.             ERCPNDBI
   698             20  PBI-I-BENEFICIARY             PIC X(25).         ERCPNDBI
   699                                                                  ERCPNDBI
   700         16  PBI-I-ISSUE-REC-SEQ-6             REDEFINES          ERCPNDBI
   701             PBI-I-CERT-FORM.                                     ERCPNDBI
   702             20  PBI-I-INSURED-ADDRESS-1       PIC X(30).         ERCPNDBI
   703             20  PBI-I-INSURED-ADDRESS-2       PIC X(30).         ERCPNDBI
   704             20  FILLER                        PIC X.             ERCPNDBI
   705                                                                  ERCPNDBI
   706         16  PBI-I-ISSUE-REC-SEQ-7             REDEFINES          ERCPNDBI
   707             PBI-I-CERT-FORM.                                     ERCPNDBI
   708             20  PBI-I-INSURED-CITY-STATE.
   709                 24  PBI-I-INSURED-CITY        PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  14
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   710                 24  PBI-I-INSURED-STATE       PIC XX.
   711             20  PBI-I-INSURED-ZIP-CODE.                             CL**7
   712                 24  PBI-I-INSURED-ZIP-PRIME.                        CL**7
   713                     28  PBI-I-INSURED-ZIP-1   PIC X.                CL**7
   714                         88  PBI-I-CANADIAN-POST-CODE                CL**7
   715                                             VALUE 'A' THRU 'Z'.     CL**7
   716                     28  FILLER                PIC X(4).             CL**7
   717                 24  PBI-I-INSURED-ZIP-PLUS4   PIC X(4).             CL**7
   718             20  PBI-I-INSURED-CANADIAN-ZIP  REDEFINES               CL**7
   719                                          PBI-I-INSURED-ZIP-CODE.    CL**7
   720                 24  PBI-I-INS-CAN-POST1       PIC XXX.              CL**7
   721                 24  PBI-I-INS-CAN-POST2       PIC XXX.              CL**7
   722                 24  FILLER                    PIC XXX.              CL**7
   723             20  PBI-I-INSURED-PHONE-NO        PIC X(10).         ERCPNDBI
   724             20  FILLER                        PIC X(12).         ERCPNDBI
   725                                                                     CL*10
   726         16  PBI-I-ISSUE-REC-SEQ-8             REDEFINES          ERCPNDBI
   727             PBI-I-CERT-FORM.                                     ERCPNDBI
   728             20  PBI-I-CRED-BENE-NAME          PIC X(30).         ERCPNDBI
   729             20  PBI-I-CRED-BENE-ADDR1         PIC X(30).         ERCPNDBI
   730             20  FILLER                        PIC X.             ERCPNDBI
   731                                                                  ERCPNDBI
   732         16  PBI-I-ISSUE-REC-SEQ-9             REDEFINES          ERCPNDBI
   733             PBI-I-CERT-FORM.                                     ERCPNDBI
   734             20  PBI-I-CRED-BENE-ADDR2         PIC X(30).         ERCPNDBI
   735             20  PBI-I-CRED-BENE-CITYST.
   736                 24  PBI-I-CRED-BENE-CITY      PIC X(28).
   737                 24  PBI-I-CRED-BENE-STATE     PIC XX.
   738             20  FILLER                        PIC X.             ERCPNDBI
   739                                                                  ERCPNDBI
   740         16  PBI-I-ISSUE-REC-DMD-MISC          REDEFINES             CL*12
   741             PBI-I-ISSUE-REC-SEQ-7.                                  CL*12
   742             20  PBI-I-DMD-CURRENT-PREM-RATE   PIC S99V9(5).         CL*11
   743             20  PBI-I-DMD-PRIMA-FACIA-PRM-RATE                      CL*10
   744                                               PIC S99V9(5).         CL*10
   745             20  PBI-I-DMD-RATE-CODE           PIC X(4).             CL*10
   746             20  PBI-I-DMD-RESIDENT-STATE      PIC XX.               CL*10
   747             20  PBI-I-DMD-LIVES               PIC S9(7).            CL*10
   748             20  PBI-I-DMD-BILLED              PIC S9(7).            CL*10
   749             20  FILLER                        PIC X(27).            CL*10
   750                                                                  ERCPNDBI
   751         16  PBI-I-TRANS-TYPE                  PIC X.             ERCPNDBI
   752             88  PBI-ISSUE-TRANS               VALUE '2'.         ERCPNDBI
   753         16  PBI-I-SEQUENCE                    PIC X.             ERCPNDBI
   754                                                                  ERCPNDBI
   755******************************************************************ERCPNDBI
   756                                                                  ERCPNDBI
   757     12  PBI-CANCEL-RECORD                    REDEFINES           ERCPNDBI
   758         PBI-RECORD-BODY.                                         ERCPNDBI
   759         16  FILLER                            PIC X(17).         ERCPNDBI
   760                                                                  ERCPNDBI
   761         16  PBI-C-CERT-FORM                   PIC X(61).            CL**5
   762         16  PBI-C-CANCEL-REC-SEQ-1 REDEFINES                        CL**5
   763             PBI-C-CERT-FORM.                                        CL**5
   764             20  PBI-C-LF-CANCEL-DATE.                               CL**5
   765                 24  PBI-C-LF-CAN-MO           PIC S99.              CL**5
   766                 24  PBI-C-LF-CAN-DA           PIC S99.              CL**5
   767                 24  PBI-C-LF-CAN-YR           PIC S99.              CL**5
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  15
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   768             20  PBI-C-LF-CANCEL-DATE-X        REDEFINES             CL**5
   769                 PBI-C-LF-CANCEL-DATE          PIC X(6).             CL**5
   770             20  PBI-C-LF-PREM-REFUND          PIC S9(7)V99.         CL**5
   771             20  PBI-C-LF-PREM-REFUND-X        REDEFINES             CL**5
   772                 PBI-C-LF-PREM-REFUND          PIC X(9).             CL**5
   773                                                                  ERCPNDBI
   774             20  PBI-C-AH-CANCEL-DATE.                               CL**5
   775                 24  PBI-C-AH-CAN-MO           PIC S99.              CL**5
   776                 24  PBI-C-AH-CAN-DA           PIC S99.              CL**5
   777                 24  PBI-C-AH-CAN-YR           PIC S99.              CL**5
   778             20  PBI-C-AH-CANCEL-DATE-X        REDEFINES             CL**5
   779                 PBI-C-AH-CANCEL-DATE          PIC X(6).             CL**5
   780             20  PBI-C-AH-PREM-REFUND          PIC S9(7)V99.         CL**5
   781             20  PBI-C-AH-PREM-REFUND-X        REDEFINES             CL**5
   782                 PBI-C-AH-PREM-REFUND          PIC X(9).             CL**5
   783                                                                  ERCPNDBI
   784             20  PBI-C-INSURED-NAME            PIC X(15).            CL**5
   785             20  PBI-C-LIVES                   PIC 999.              CL**5
   786             20  PBI-C-LIVES-X                 REDEFINES             CL**5
   787                 PBI-C-LIVES                   PIC XXX.              CL**5
   788             20  PBI-C-POLICY-FORM-NO          PIC X(12).            CL*13
   789             20  PBI-C-FORCE-CD                PIC X.                CL**5
   790         16  PBI-C-CANCEL-REC-SEQ-2 REDEFINES                        CL**5
   791             PBI-C-CERT-FORM.                                        CL**5
   792             20  PBI-C-BENEFICIARY-NAME        PIC X(25).            CL**5
   793             20  PBI-C-BOW-LOAN-NUMBER         PIC X(14).
   794*            20  FILLER                        PIC X(36).            CL**5
   795             20  FILLER                        PIC X(22).            CL**5
   796         16  PBI-C-TRANS-TYPE                  PIC X.             ERCPNDBI
   797             88  PBI-CANCEL-TRANS              VALUE '3'.         ERCPNDBI
   798         16  PBI-C-SEQUENCE                    PIC X.             ERCPNDBI
   799                                                                  ERCPNDBI
   800******************************************************************ERCPNDBI
   801                                                                  ERCPNDBI
   802     12  PBI-BATCH-RECORD   REDEFINES PBI-RECORD-BODY.            ERCPNDBI
   803         16  PBI-CARRIER                       PIC X.             ERCPNDBI
   804         16  PBI-GROUPING                      PIC X(6).          ERCPNDBI
   805         16  PBI-STATE                         PIC XX.            ERCPNDBI
   806         16  PBI-ACCOUNT                       PIC X(10).         ERCPNDBI
   807                                                                  ERCPNDBI
   808         16  PBI-B-BATCH-NO                    PIC S9(6).         ERCPNDBI
   809         16  PBI-B-BATCH-NO-X                  REDEFINES          ERCPNDBI
   810             PBI-B-BATCH-NO                    PIC X(6).          ERCPNDBI
   811                                                                  ERCPNDBI
   812         16  PBI-B-BATCH-DT.                                      ERCPNDBI
   813             20  PBI-B-BATCH-MO                PIC S99.           ERCPNDBI
   814             20  PBI-B-BATCH-DA                PIC S99.              CL**8
   815             20  PBI-B-BATCH-YR                PIC S99.              CL**8
   816         16  PBI-B-BATCH-DT-X                  REDEFINES          ERCPNDBI
   817             PBI-B-BATCH-DT                    PIC X(6).          ERCPNDBI
   818                                                                  ERCPNDBI
   819         16  PBI-B-CERT-ISS-COUNT              PIC S9(4).         ERCPNDBI
   820         16  PBI-B-CERT-ISS-COUNT-X            REDEFINES          ERCPNDBI
   821             PBI-B-CERT-ISS-COUNT              PIC X(4).          ERCPNDBI
   822                                                                  ERCPNDBI
   823         16  PBI-B-LF-PRM-WRITTEN              PIC S9(7)V99.      ERCPNDBI
   824         16  PBI-B-LF-PRM-WRITTEN-X            REDEFINES          ERCPNDBI
   825             PBI-B-LF-PRM-WRITTEN              PIC X(9).          ERCPNDBI
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  16
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCPNDBI)
   826                                                                  ERCPNDBI
   827         16  PBI-B-AH-PRM-WRITTEN              PIC S9(7)V99.      ERCPNDBI
   828         16  PBI-B-AH-PRM-WRITTEN-X            REDEFINES          ERCPNDBI
   829             PBI-B-AH-PRM-WRITTEN              PIC X(9).          ERCPNDBI
   830                                                                  ERCPNDBI
   831         16  PBI-B-CERT-CAN-COUNT              PIC S9(4).         ERCPNDBI
   832         16  PBI-B-CERT-CAN-COUNT-X            REDEFINES          ERCPNDBI
   833             PBI-B-CERT-CAN-COUNT              PIC X(4).          ERCPNDBI
   834                                                                  ERCPNDBI
   835         16  PBI-B-LF-PRM-CANCELLED            PIC S9(7)V99.      ERCPNDBI
   836         16  PBI-B-LF-PRM-CANCELLED-X          REDEFINES          ERCPNDBI
   837             PBI-B-LF-PRM-CANCELLED            PIC X(9).          ERCPNDBI
   838                                                                  ERCPNDBI
   839         16  PBI-B-AH-PRM-CANCELLED            PIC S9(7)V99.      ERCPNDBI
   840         16  PBI-B-AH-PRM-CANCELLED-X          REDEFINES          ERCPNDBI
   841             PBI-B-AH-PRM-CANCELLED            PIC X(9).          ERCPNDBI
   842                                                                  ERCPNDBI
   843         16  PBI-CLIENT-ID                     PIC XXX.           ERCPNDBI
   844                                                                  ERCPNDBI
   845         16  PBI-B-TRANS-TYPE                  PIC X.             ERCPNDBI
   846             88  PBI-REMITTANCE-TRANS          VALUE '1'.         ERCPNDBI
   847         16  PBI-B-SEQUENCE                    PIC X.             ERCPNDBI
   848                                                                  ERCPNDBI
   849******************************************************************ERCPNDBI
*  850                                 COPY ERCFPBRL.
   851******************************************************************
   852*                                                                *
   853*                                                                *
   854*                            ERCFPBRL.                           *
   855*                                                                *
   856* FILE DESCRIPTION = NEW BUSINESS AND CANCELS FOR FIRST PREMIER  *
   857*                                                                *
   858******************************************************************
   859*                                                                *
   860*                                                                *
   861*   FILE TYPE = QSAM                                             *
   862*   RECORD SIZE = 936  RECFORM = FIXED                           *
   863*                                                                *
   864******************************************************************
   865******************************************************************
   866*                   C H A N G E   L O G
   867*
   868* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   869*-----------------------------------------------------------------
   870*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   871* EFFECTIVE    NUMBER
   872*-----------------------------------------------------------------
   873* 051106                   PEMA  NEW COPYBOOK
   874******************************************************************
   875
   876 01  FIRST-PREMIER-INPUT.
   877     05  FP-RECORD-ID                     PIC X.
   878         88  VALID-REC-1                        VALUE '1'.
   879         88  VALID-REC-2                        VALUE '2'.
   880         88  VALID-REC-3                        VALUE '3'.
   881         88  VALID-REC-4                        VALUE '4'.
   882         88  VALID-REC-5                        VALUE '5'.
   883         88  VALID-REC-7                        VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  17
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
   884         88  VALID-REC-9                        VALUE '9'.
   885     05  FP-RECORD-NA-TYPE                PIC X.
   886     05  FP-RECORD-DATA-TYPE              PIC X.
   887     05  FP-RECORD-SOFT-TYPE              PIC X.
   888     05  FP-RECORD-BODY                   PIC X(932).
   889
   890******************************************************************
   891*    SECTION 1: RECORD ONE                                       *
   892******************************************************************
   893     05  FP-REC-1 REDEFINES FP-RECORD-BODY.
   894         10  FP1-REC-SIZE                 PIC 9(4).
   895         10  FP1-BLOCK-FACTOR             PIC 9(4).
   896         10  FP1-INST-NUMBER              PIC 99.
   897         10  FP1-EDIT-MASK-TYPE           PIC X.
   898         10  FP1-NA-TYPE                  PIC X.
   899         10  FP1-DATA-REC-TYPE            PIC X.
   900         10  FP1-SOFT-TYPE                PIC X.
   901         10  FILLER                       PIC X(914).
   902
   903******************************************************************
   904*    SECTION 2: RECORD TWO                                       *
   905******************************************************************
   906     05  FP-REC-2 REDEFINES FP-RECORD-BODY.
   907         10  FP2-NA-ELEMENTS-USED         PIC 99.
   908         10  FP2-NA-ELEMENT-START         PIC 99.
   909         10  FP2-DATA-ELEMENTS-USED       PIC 99.
   910         10  FP2-DATA-ELEMENTS-START      PIC 99.
   911         10  FP2-SOFT-ELEMENTS-USED       PIC 999.
   912         10  FP2-SOFT-ELEMENTS-START      PIC 99.
   913         10  FILLER                       PIC X(915).
   914
   915******************************************************************
   916*    SECTION 3: RECORD THREE                                     *
   917******************************************************************
   918     05  FP-REC-3 REDEFINES FP-RECORD-BODY.
   919         10  FP3-DATE-CREATED             PIC X(6).
   920         10  FP3-TIME-CREATED             PIC X(4).
   921         10  FILLER                       PIC X(922).
   922
   923******************************************************************
   924*    SECTION 4: RECORD FOUR                                      *
   925******************************************************************
   926     05  FP-REC-4 REDEFINES FP-RECORD-BODY.
   927         10  FP4-PROGRAM-NAME             PIC X(8).
   928         10  FP4-PROGRAM-RELEASE          PIC X(6).
   929         10  FILLER                       PIC X(918).
   930
   931******************************************************************
   932*    SECTION 5: RECORD FIVE                                      *
   933******************************************************************
   934     05  FP-REC-5 REDEFINES FP-RECORD-BODY.
   935         10  FP5-SOFT-FIELD-AREA OCCURS 26.
   936             15  FP5-SOFT-FLD-TYPE        PIC 9.
   937             15  FP5-SOFT-FLD-CODE        PIC X(4).
   938             15  FP5-SOFT-FLD-REF         PIC 999.
   939             15  FP5-SOFT-FLD-OCCURS      PIC 99.
   940         10  FILLER                       PIC X(722).
   941
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  18
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
   942******************************************************************
   943*    SECTION 7: RECORD SEVEN                                     *
   944******************************************************************
   945     05  FP-REC-7 REDEFINES FP-RECORD-BODY.
   946         10  FP7-INST-NUMBER              PIC 99.
   947         10  FP7-ACCOUNT-NUMBER           PIC X(10).
   948         10  FP7-MASTER-LINK              PIC X(7).
   949         10  FP7-1ST-ACCOUNT-FLAG         PIC X.
   950         10  FP7-NAME-1                   PIC X(30).
   951         10  FP7-NAME-2                   PIC X(30).
   952         10  FP7-NAME-3                   PIC X(30).
   953         10  FP7-ADDRESS                  PIC X(30).
   954         10  FP7-CITY-STATE-ZIP           PIC X(35).
   955         10  FP7-SHORT-LNAME              PIC X(15).
   956         10  FP7-SHORT-FNAME              PIC X(10).
   957         10  FP7-MID-INIT                 PIC X.
   958         10  FP7-TAX-ID-CODE              PIC X.
   959         10  FP7-TAX-ID                   PIC X(9).
   960         10  FP7-TAX-ID-NAME-NO           PIC X.
   961         10  FP7-ADDENDA-TYPE             PIC XX.
   962         10  FP7-ADDENDA-NO               PIC 999.
   963         10  FP7-RESP-CODE                PIC 9(5).
   964         10  FP7-MISC-CODE                PIC 999.
   965         10  FP7-EXP-DATE1                PIC X(10).
   966         10  FP7-FORECAST-DATE            PIC X(10).
   967         10  FP7-INS-TABLE                PIC 999.
   968         10  FP7-POLICY-DATE              PIC X(10).
   969         10  FP7-1ST-EARN-DATE            PIC X(10).
   970         10  FP7-LST-EARN-DATE            PIC X(10).
   971         10  FP7-INS-MOS                  PIC 999.
   972         10  FP7-PREMIUM                  PIC 9(8)V99.
   973         10  FP7-CANC-DATE                PIC X(10).
   974         10  FP7-CANC-AMT                 PIC 9(8)V99.
   975         10  FP7-CANC-REASON              PIC 99.
   976         10  FP7-EARN-RATE                PIC 999V9(4).
   977         10  FP7-INT-CODE                 PIC 9.
   978         10  FP7-PMT-AMT                  PIC 9(11)V99.
   979         10  FP7-BALLOON-AMT              PIC 9(11)V99.
   980         10  FP7-MOS-EXT                  PIC 999.
   981         10  FP7-ADJ-AMT                  PIC S9(8)V99.
   982         10  FP7-PREV-PREMIUM             PIC 9(8)V99.
   983         10  FP7-CURR-UEP                 PIC 9(8)V99.
   984         10  FP7-PREV-UEP                 PIC 9(8)V99.
   985         10  FP7-CHG-DATE                 PIC X(10).
   986         10  FP7-REPT-CODE                PIC 9.
   987         10  FP7-CANC-REPT-CODE           PIC 9.
   988         10  FP7-EOM-REPT-CODE            PIC 9.
   989         10  FP7-DESC                     PIC X(60).
   990         10  FP7-FILLER                   PIC X(73).
   991         10  FILLER                       PIC X.
   992         10  FP7-CISM-SHORT-LNAME         PIC X(17).
   993         10  FILLER                       PIC X.
   994         10  FP7-CISM-SHORT-MID-INIT      PIC X(17).
   995         10  FILLER                       PIC X.
   996         10  FP7-CISM-SHORT-FNAME         PIC X(17).
   997         10  FILLER                       PIC X(6).
   998         10  FP7-CISM-GENDER-CODE         PIC 9(12).
   999         10  FILLER                       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  19
* CIFPB511.cbl (/apps/prod/cid1p/copy/ERCFPBRL)
  1000         10  FP7-CISM-TAX-ID-NO           PIC 9(12).
  1001         10  FILLER                       PIC X(8).
  1002         10  FP7-CISM-BIRTH-DT            PIC X(10).
  1003         10  FILLER                       PIC X.
  1004         10  FP7-LASN-ORIG-NOTE-AMT-SIGN  PIC X.
  1005         10  FP7-LASN-ORIG-NOTE-AMT.
  1006             15  FP7-AMT-DOLLARS          PIC 9(13).
  1007             15  FILLER                   PIC X.
  1008             15  FP7-AMT-CENTS            PIC 99.
  1009         10  FILLER                       PIC X(6).
  1010         10  FP7-LASN-RESP-CODE           PIC 9(12).
  1011         10  FILLER                       PIC X(6).
  1012         10  FP7-LASN-LOAN-TERM           PIC 9(12).
  1013         10  FILLER                       PIC X(8).
  1014         10  FP7-LASN-ORIG-1ST-PMT-DT     PIC X(10).
  1015         10  FILLER                       PIC X(4).
  1016         10  FP7-APR.
  1017             15  FP7-APR-SIGN             PIC X.
  1018             15  FP7-APR-WHOLE            PIC 9(6).
  1019             15  FILLER                   PIC X.
  1020             15  FP7-APR-DEC              PIC 9(6).
  1021         10  FILLER                       PIC X.
  1022         10  FP7-CISM-ADDRESS             PIC X(17).
  1023         10  FILLER                       PIC X.
  1024         10  FP7-CISM-CITY                PIC X(17).
  1025         10  FILLER                       PIC X.
  1026         10  FP7-CISM-STATE               PIC X(17).
  1027         10  FILLER                       PIC X(6).
  1028         10  FP7-CISM-ZIP-5               PIC X(12).
  1029         10  FILLER                       PIC X(6).
  1030         10  FP7-CISM-ZIP-9               PIC X(12).
  1031         10  FILLER                       PIC X(6).
  1032         10  FP7-CISM-HOME-PHONE          PIC 9(12).
  1033         10  FILLER                       PIC X(8).
  1034         10  FP7-NOTE-DATE                PIC X(10).
  1035         10  FILLER                       PIC X.
  1036         10  FP7-REG-PYMT-AMT.
  1037             15  FP7-REG-PYMT-PI-AMT-SIGN PIC X.
  1038             15  FP7-REG-PYMT-DOLLARS     PIC 9(13).
  1039             15  FILLER                   PIC X.
  1040             15  FP7-REG-PYMT-CENTS       PIC 99.
  1041         10  FILLER                       PIC X(8).
  1042         10  FP7-CURR-MAT-DATE            PIC X(10).
  1043         10  FILLER                       PIC X(6).
  1044         10  FP7-PYMT-SCHED-FREQ          PIC X(12).
  1045         10  FILLER                       PIC X(6).
  1046         10  FP7-BRANCH-NO                PIC X(12).
  1047
  1048******************************************************************
  1049*    SECTION 9: RECORD NINE                                      *
  1050******************************************************************
  1051     05  FP-REC-9 REDEFINES FP-RECORD-BODY.
  1052         10  FP9-REC-COUNT                PIC 9(8).
  1053         10  FILLER                       PIC X(924).
  1054
  1055******************************************************************
* 1056                                 COPY ELCDATE.
  1057******************************************************************06/11/98
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  20
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1058*                                                                *ELCDATE
  1059*                                                                *ELCDATE
  1060*                            ELCDATE.                            *   LV023
  1061*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
  1062*                            VMOD=2.003                           ELCDATE
  1063*                                                                *ELCDATE
  1064*                                                                *ELCDATE
  1065*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
  1066*                 LENGTH = 200                                   *   CL*19
  1067******************************************************************ELCDATE
  1068                                                                  ELCDATE
  1069 01  DATE-CONVERSION-DATA.                                        ELCDATE
  1070     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
  1071     12  DC-OPTION-CODE                PIC X.                        CL*15
  1072         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
  1073         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
  1074         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
  1075         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
  1076         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
  1077         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
  1078         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
  1079         88  FIND-CENTURY               VALUE '7'.                   CL*22
  1080         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
  1081         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
  1082         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
  1083         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
  1084         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
  1085         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
  1086         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
  1087         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
  1088         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
  1089         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
  1090         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
  1091         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
  1092         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
  1093         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
  1094         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
  1095         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
  1096         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
  1097         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
  1098         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
  1099         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
  1100         88  THREE-CHARACTER-BIN                                  ELCDATE
  1101                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
  1102         88  GREGORIAN-TO-BIN                                        CL**2
  1103                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
  1104         88  BIN-TO-GREGORIAN                                        CL**2
  1105                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
  1106         88  JULIAN-TO-BINARY                                        CL**2
  1107                  VALUES '5' 'C' 'E' 'F'.                            CL*14
  1108     12  DC-ERROR-CODE                 PIC X.                        CL*15
  1109         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
  1110         88  DATE-CONVERSION-ERROR                                ELCDATE
  1111                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
  1112         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
  1113         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
  1114         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
  1115         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  21
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1116         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
  1117         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
  1118         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
  1119         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
  1120         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
  1121         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
  1122     12  DC-END-OF-MONTH               PIC X.                        CL*15
  1123         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
  1124     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
  1125         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
  1126         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
  1127         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
  1128     12  FILLER                        PIC X.                        CL*15
  1129     12  DC-CONVERSION-DATES.                                        CL*15
  1130         16  DC-BIN-DATE-1             PIC XX.                       CL*15
  1131         16  DC-BIN-DATE-2             PIC XX.                       CL*15
  1132         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
  1133         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
  1134                       DC-GREG-DATE-1-EDIT.                       ELCDATE
  1135             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
  1136             20  SLASH1-1              PIC X.                        CL*15
  1137             20  DC-EDIT1-DAY          PIC 99.                       CL*15
  1138             20  SLASH1-2              PIC X.                        CL*15
  1139             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
  1140         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
  1141         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
  1142                     DC-GREG-DATE-2-EDIT.                         ELCDATE
  1143             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
  1144             20  SLASH2-1              PIC X.                        CL*15
  1145             20  DC-EDIT2-DAY          PIC 99.                       CL*15
  1146             20  SLASH2-2              PIC X.                        CL*15
  1147             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
  1148         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
  1149         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
  1150                     DC-GREG-DATE-1-YMD.                          ELCDATE
  1151             20  DC-YMD-YEAR           PIC 99.                       CL*15
  1152             20  DC-YMD-MONTH          PIC 99.                       CL*15
  1153             20  DC-YMD-DAY            PIC 99.                       CL*15
  1154         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
  1155         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
  1156                      DC-GREG-DATE-1-MDY.                         ELCDATE
  1157             20  DC-MDY-MONTH          PIC 99.                       CL*15
  1158             20  DC-MDY-DAY            PIC 99.                       CL*15
  1159             20  DC-MDY-YEAR           PIC 99.                       CL*15
  1160         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
  1161             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
  1162             20  DC-ALPHA-DAY          PIC 99.                       CL*15
  1163             20  FILLER                PIC XX.                       CL*15
  1164             20  DC-ALPHA-CENTURY.                                   CL*15
  1165                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
  1166             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
  1167         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
  1168         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
  1169         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
  1170         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
  1171         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
  1172                                       PIC 9(05).                    CL*20
  1173         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  22
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1174             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
  1175             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
  1176         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
  1177         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
  1178         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
  1179     12  DATE-CONVERSION-VARIBLES.                                   CL*15
  1180         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
  1181         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
  1182             20  FILLER                PIC 9(3).                     CL*15
  1183             20  HOLD-CEN-1-CCYY.                                    CL*15
  1184                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
  1185                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
  1186             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
  1187             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
  1188         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
  1189             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
  1190             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
  1191             20  HOLD-CEN-1-R-CCYY.                                  CL*15
  1192                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
  1193                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
  1194             20  FILLER                PIC 9(3).                     CL*15
  1195         16  HOLD-CENTURY-1-X.                                       CL*15
  1196             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
  1197             20  HOLD-CEN-1-X-CCYY.                                  CL*15
  1198                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
  1199                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
  1200             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
  1201             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
  1202         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
  1203             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
  1204             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
  1205             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
  1206                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
  1207                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
  1208             20  FILLER                PIC XXX.                      CL*23
  1209         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
  1210         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
  1211         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
  1212         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
  1213             20  DC-JULIAN-1-CCYY.                                   CL*15
  1214                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1215                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1216             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1217         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1218         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1219             20  DC-JULIAN-2-CCYY.                                   CL*15
  1220                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1221                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1222             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1223         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1224             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1225             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1226             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1227             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1228             20  DC-EDITA-CCYY.                                      CL*15
  1229                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1230                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1231         16  DC-GREG-DATE-B-EDIT.                                    CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  23
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1232             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1233             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1234             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1235             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1236             20  DC-EDITB-CCYY.                                      CL*15
  1237                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1238                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1239         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1240         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1241                              DC-GREG-DATE-CYMD.                  ELCDATE
  1242             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1243             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1244             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1245             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1246         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1247         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1248                              DC-GREG-DATE-MDCY.                  ELCDATE
  1249             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1250             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1251             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1252             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1253    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1254        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1255    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1256    12  FILLER                         PIC X(28).                    CL*26
* 1257                                 COPY ELCDTECX.
  1258******************************************************************06/05/98
  1259*                                                                *ELCDTECX
  1260*                            ELCDTECX.                           *   LV005
  1261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1262*                            VMOD=2.015                          *ELCDTECX
  1263*                                                                *ELCDTECX
  1264*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
  1265*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
  1266*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
  1267*                                                                *ELCDTECX
  1268******************************************************************ELCDTECX
  1269******************************************************************
  1270*                   C H A N G E   L O G
  1271*
  1272* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1273*-----------------------------------------------------------------
  1274*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1275* EFFECTIVE    NUMBER
  1276*-----------------------------------------------------------------
  1277* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
  1278*                                  BENEFIT CODES FROM 300 TO 900
  1279* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
  1280* 051304    2003080800002  SMVA  ADD REFUND METHOD
  1281******************************************************************
  1282 01  DATE-CARD.                                                   ELCDTECX
  1283     12  DATX-COD                    PIC  X(4).                   ELCDTECX
  1284     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
  1285     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
  1286     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
  1287     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
  1288     12  EP-SW                       PIC  X.                      ELCDTECX
  1289         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  24
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1290     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
  1291         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
  1292     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
  1293     12  RUN-CENTURY.                                             ELCDTECX
  1294         16 RUN-CENTURY-N            PIC  99.                        CL**4
  1295     12  FILLER                      PIC  X.                         CL**4
  1296     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
  1297     12  FILLER                      PIC  XXX.                    ELCDTECX
  1298     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
  1299                                                                  ELCDTECX
  1300 01  FILLER                          PIC  X(7)                       CL**6
  1301                                          VALUE 'OPTIONS'.        ELCDTECX
  1302 01  DATE-CARD-OPTIONS.                                           ELCDTECX
  1303     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
  1304     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
  1305     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
  1306         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
  1307         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
  1308     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
  1309     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
  1310     12  FILLER                      PIC  X.                      ELCDTECX
  1311     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
  1312     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
  1313     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
  1314     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
  1315     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
  1316     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
  1317     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
  1318     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
  1319     12  FILLER                      PIC  X.                      ELCDTECX
  1320     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
  1321     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
  1322     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
  1323     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
  1324     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
  1325     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
  1326     12  FILLER                      PIC  X.                      ELCDTECX
  1327     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
  1328     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
  1329     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
  1330     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
  1331     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
  1332     12  DTE-R78                     PIC  X.                      ELCDTECX
  1333     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
  1334     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
  1335     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
  1336     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
  1337     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
  1338     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
  1339     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
  1340                                     PIC  X.                      ELCDTECX
  1341         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
  1342                                                 ' '.             ELCDTECX
  1343         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
  1344         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
  1345     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
  1346         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
  1347         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  25
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1348     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
  1349     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
  1350                                     PIC  9.                         CL**4
  1351     12  DTE-SYSTEM.                                              ELCDTECX
  1352         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
  1353         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
  1354         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
  1355         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
  1356         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
  1357         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
  1358         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
  1359         16  DTE-SYS-H               PIC  X.                      ELCDTECX
  1360         16  DTE-SYS-I               PIC  X.                      ELCDTECX
  1361         16  DTE-SYS-J               PIC  X.                      ELCDTECX
  1362         16  DTE-SYS-K               PIC  X.                      ELCDTECX
  1363         16  DTE-SYS-L               PIC  X.                      ELCDTECX
  1364         16  DTE-SYS-M               PIC  X.                      ELCDTECX
  1365         16  DTE-SYS-N               PIC  X.                      ELCDTECX
  1366         16  DTE-SYS-O               PIC  X.                      ELCDTECX
  1367         16  DTE-SYS-P               PIC  X.                      ELCDTECX
  1368         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
  1369         16  DTE-SYS-R               PIC  X.                      ELCDTECX
  1370         16  DTE-SYS-S               PIC  X.                      ELCDTECX
  1371         16  DTE-SYS-T               PIC  X.                      ELCDTECX
  1372         16  DTE-SYS-U               PIC  X.                      ELCDTECX
  1373         16  DTE-SYS-V               PIC  X.                      ELCDTECX
  1374         16  DTE-SYS-W               PIC  X.                      ELCDTECX
  1375         16  DTE-SYS-X               PIC  X.                      ELCDTECX
  1376         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
  1377         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
  1378     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
  1379         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
  1380                                     PIC  X.                      ELCDTECX
  1381     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
  1382                                                                  ELCDTECX
  1383 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
  1384     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
  1385     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
  1386     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
  1387*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
  1388     12  FILLER                      PIC  X.                      ELCDTECX
  1389     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
  1390     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
  1391     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
  1392     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
  1393     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
  1394     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
  1395     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
  1396                                                                  ELCDTECX
  1397     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
  1398     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
  1399     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
  1400     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
  1401                                                                  ELCDTECX
  1402     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
  1403     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
  1404     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
  1405     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  26
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1406                                                                  ELCDTECX
  1407     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
  1408     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
  1409                                                                  ELCDTECX
  1410     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
  1411     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
  1412                                                                  ELCDTECX
  1413     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
  1414                                                                  ELCDTECX
  1415 01  DATE-CARD-FACTORS.                                           ELCDTECX
  1416     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
  1417     12  FAC-1                       PIC S999V9(5).               ELCDTECX
  1418     12  FAC-2                       PIC S999V9(5).               ELCDTECX
  1419     12  FAC-3                       PIC S999V9(5).               ELCDTECX
  1420     12  FAC-4                       PIC S999V9(5).               ELCDTECX
  1421     12  FAC-5                       PIC S999V9(5).               ELCDTECX
  1422     12  FAC-6                       PIC S999V9(5).               ELCDTECX
  1423                                                                  ELCDTECX
  1424 01  FILLER                          PIC  X(12)                   ELCDTECX
  1425                                          VALUE 'COMPANY NAME'.   ELCDTECX
  1426 01  COMPANY-NAME-TABLE.                                          ELCDTECX
  1427     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
  1428         16  CNT-ID                  PIC  X.                      ELCDTECX
  1429         16  CNT-NAME                PIC  X(30).                  ELCDTECX
  1430                                                                  ELCDTECX
  1431 01  FILLER                          PIC  X(11)                   ELCDTECX
  1432                                          VALUE 'STATE NAMES'.    ELCDTECX
  1433 01  STATE-NAMES.                                                 ELCDTECX
  1434     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
  1435         16  STATE-SUB               PIC  XX.                     ELCDTECX
  1436         16  STATE-PIC1.                                          ELCDTECX
  1437             20  STATE-ABBR          PIC  XX.                     ELCDTECX
  1438             20  FILLER              PIC  XXX.                    ELCDTECX
  1439             20  STATE-PIC           PIC  X(20).                  ELCDTECX
  1440             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
  1441             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
  1442             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
  1443                                                                  ELCDTECX
  1444 01  FILLER                          PIC  X(13)                   ELCDTECX
  1445                                          VALUE 'CARRIER NAMES'.  ELCDTECX
  1446 01  CARRIER-NAMES.                                               ELCDTECX
  1447     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
  1448         16  CARRIER-SUB             PIC  X.                      ELCDTECX
  1449         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
  1450         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
  1451         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1452         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1453         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
  1454*        16  FILLER                  PIC  X.                      ELCDTECX
  1455         16  CARRIER-SEC-PAY         PIC  X.
  1456             88  SEC-PAY-CARRIER          VALUE 'Y'.
  1457                                                                  ELCDTECX
  1458 01  FILLER                          PIC  X(9)                       CL**6
  1459                                          VALUE 'INS TYPES'.      ELCDTECX
  1460 01  CLAS-INS-TYPES.                                              ELCDTECX
  1461*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
  1462     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
  1463         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  27
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1464         16  CLAS-I-AB3.                                          ELCDTECX
  1465             20  FILLER              PIC  X.                      ELCDTECX
  1466             20  CLAS-I-AB2.                                      ELCDTECX
  1467                 24  FILLER          PIC  X.                      ELCDTECX
  1468                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
  1469         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
  1470             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
  1471             20  FILLER              PIC  X.                         CL**4
  1472         16  CLAS-I-AB10.                                         ELCDTECX
  1473             20  FILLER              PIC  X(9).                   ELCDTECX
  1474             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
  1475         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
  1476         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
  1477         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
  1478         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
  1479             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
  1480         16  CLAS-I-EP               PIC  X.                      ELCDTECX
  1481         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
  1482         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
  1483         16  CLAS-I-BEN-CATEGORY     PIC  X.
  1484         16  CLAS-I-REFUND-METHOD    PIC  X(01).
  1485         16  FILLER                  PIC  X(05).
  1486                                                                  ELCDTECX
  1487 01  FILLER                          PIC  X(16)                   ELCDTECX
  1488                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
  1489 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
  1490     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
  1491                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
  1492         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
  1493         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
  1494         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
  1495         16  CLAS-MORT-DESC.                                      ELCDTECX
  1496             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
  1497             20  FILLER              PIC  XX.                        CL**5
  1498             20  CLAS-YEAR           PIC  X(4).                      CL**6
  1499             20  FILLER              PIC  X.                         CL**5
  1500             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
  1501             20  FILLER              PIC  X.                         CL**5
  1502             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
  1503             20  FILLER              PIC  X.                         CL**5
  1504             20  CLAS-INTEREST       PIC  99.99.                     CL**5
  1505             20  FILLER              PIC  X(5).                      CL**6
  1506                                                                  ELCDTECX
  1507 01  FILLER                          PIC  X(15)                   ELCDTECX
  1508                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
  1509 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
  1510     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
  1511         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
  1512         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
  1513         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
  1514         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
  1515         16  FILLER                  PIC  X(4).                      CL**6
  1516                                                                  ELCDTECX
  1517 01  FILLER                          PIC  X(7)                       CL**6
  1518                                     VALUE 'INDEXES'.             ELCDTECX
  1519 01  CLAS-INDEX-TBL.                                              ELCDTECX
  1520     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
  1521     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  28
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1522     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
  1523     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
  1524     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
  1525     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
  1526     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
  1527     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
  1528     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
  1529     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
  1530     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
  1531     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
  1532     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
  1533     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
  1534     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
  1535     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
  1536     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
  1537                                                                  ELCDTECX
  1538 01  CLAS-TYPE-MISC.                                              ELCDTECX
  1539     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
  1540     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
  1541     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
  1542     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
  1543     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
  1544     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
  1545     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
  1546     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
  1547     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
  1548     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
  1549     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
  1550                                                                  ELCDTECX
  1551 01  FILLER                          PIC  X(13)                   ELCDTECX
  1552                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
  1553 01  CLAS-MISC.                                                   ELCDTECX
  1554     12  DTE-FICH                    PIC  X.                      ELCDTECX
  1555         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
  1556         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
  1557         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
  1558     12  FICH-OPEN                   PIC  X.                      ELCDTECX
  1559     12  REPT-OPEN                   PIC  X.                      ELCDTECX
  1560     12  DTE-PGM-OPT                 PIC  9.                         CL**5
  1561     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
  1562     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
  1563     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
  1564     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
  1565     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
  1566     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
  1567     12  STATE-L                     PIC  XX.                     ELCDTECX
  1568     12  CLAS-CN                     PIC  99.                     ELCDTECX
  1569     12  CLAS-CO                     PIC  99.                     ELCDTECX
  1570     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
  1571         16  DTE-F-1                 PIC  X.                      ELCDTECX
  1572         16  DTE-F-2                 PIC  X.                      ELCDTECX
  1573     12  DTE-ABEND-WORK.                                          ELCDTECX
  1574         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
  1575         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
  1576                                                                  ELCDTECX
  1577 01  FILLER                          PIC  X(12)                   ELCDTECX
  1578                                     VALUE 'WORKING DATE'.        ELCDTECX
  1579 01  WS-DATE-AND-TIME.                                            ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  29
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTECX)
  1580     12  WS-ACCEPT-DATE.                                          ELCDTECX
  1581         16  WS-AD-YY                PIC  99.                     ELCDTECX
  1582         16  WS-AD-MM                PIC  99.                     ELCDTECX
  1583         16  WS-AD-DD                PIC  99.                     ELCDTECX
  1584     12  WS-CURRENT-DATE.                                         ELCDTECX
  1585         16  WS-CD-MM                PIC  99.                     ELCDTECX
  1586         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1587         16  WS-CD-DD                PIC  99.                     ELCDTECX
  1588         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
  1589         16  WS-CD-YY                PIC  99.                     ELCDTECX
  1590     12  WS-TIME-OF-DAY.                                          ELCDTECX
  1591         16  WS-TIME                 PIC  9(6).                   ELCDTECX
  1592         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
  1593                                                                  ELCDTECX
  1594 01  FILLER                          PIC  X(12)                   ELCDTECX
  1595                                     VALUE 'CARRIER CLMS'.        ELCDTECX
  1596 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
  1597     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
  1598         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
  1599         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
  1600         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
  1601                                                                  ELCDTECX
  1602 01  FILLER                          PIC  X(10)                   ELCDTECX
  1603                                     VALUE 'STATE TLRS'.          ELCDTECX
  1604 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
  1605     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
  1606         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
  1607         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
  1608                                                                  ELCDTECX
  1609 01  FILLER                          PIC  X(13)                   ELCDTECX
  1610                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
  1611 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
  1612     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
  1613         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
  1614                                                                  ELCDTECX
  1615 01  FILLER                          PIC  X(13)                   ELCDTECX
  1616                                     VALUE 'MISC CLM DATA'.       ELCDTECX
  1617 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
  1618     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
  1619     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
  1620     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
  1621                                     PIC  X.                         CL**5
  1622     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
  1623     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
  1624     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
  1625     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
  1626     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
  1627     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
  1628     12  INDEXST                     PIC S9(4)   COMP.               CL**6
  1629     12  FILLER                      PIC  X(75).                  ELCDTECX
  1630******************************************************************ELCDTECX
  1631*01  MISC-CARR-PCT-DATA.                                          00001521
  1632*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1633*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1634*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
  1635*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
  1636*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
  1637*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  30
* CIFPB511.cbl
  1638******************************************************************ELCDTECX
* 1639                                 COPY ELCDTEVR.
  1640***************************************************************** 04/15/98
  1641*                                                                *ELCDTEVR
  1642*                                                                *ELCDTEVR
  1643*                            ELCDTEVR.                           *   LV003
  1644*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  1645*                            VMOD=2.001                          *   CL**2
  1646*                                                                *ELCDTEVR
  1647*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
  1648*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
  1649*                                                                *ELCDTEVR
  1650******************************************************************ELCDTEVR
  1651 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
  1652     05  WS-RUN-DATE.                                             ELCDTEVR
  1653         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1654         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
  1655         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
  1656             15  RUN-CC              PIC  99.                     ELCDTEVR
  1657             15  RUN-YR              PIC  99.                     ELCDTEVR
  1658         10  RUN-MO                  PIC  99.                     ELCDTEVR
  1659         10  RUN-DA                  PIC  99.                     ELCDTEVR
  1660     05  WS-RUN-DATE-N REDEFINES                                     CL**2
  1661            WS-RUN-DATE              PIC 9(11).                      CL**2
  1662     05  WS-EP-DT.                                                ELCDTEVR
  1663         10  FILLER                  PIC  9(03).                  ELCDTEVR
  1664         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
  1665         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
  1666             15  EP-CC               PIC  99.                     ELCDTEVR
  1667             15  EP-YR               PIC  99.                     ELCDTEVR
  1668         10  EP-MO                   PIC  99.                     ELCDTEVR
  1669         10  EP-DA                   PIC  99.                     ELCDTEVR
  1670     05  WS-EP-DT-N REDEFINES                                        CL**2
  1671            WS-EP-DT                 PIC 9(11).                      CL**2
  1672     05  WS-DTE-CONV-DT.                                             CL**4
  1673         10  FILLER                  PIC  9(03).                     CL**4
  1674         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
  1675         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
  1676             15  DTE-CONV-CC         PIC  99.                        CL**4
  1677             15  DTE-CONV-YR         PIC  99.                        CL**4
  1678         10  DTE-CONV-MO             PIC  99.                        CL**4
  1679         10  DTE-CONV-DA             PIC  99.                        CL**4
  1680     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
  1681            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
  1682 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
  1683     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
  1684         10  FILLER                            PIC 999.           ELCDTEVR
  1685         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
  1686         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
  1687             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
  1688             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
  1689         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
  1690         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
  1691     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
  1692            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
  1693     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
  1694         10  FILLER                            PIC 999.           ELCDTEVR
  1695         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  31
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
  1696         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
  1697         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
  1698         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
  1699     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
  1700            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
  1701 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
  1702     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
  1703         10  FILLER                            PIC 999.           ELCDTEVR
  1704         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
  1705         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
  1706             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
  1707             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
  1708         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
  1709         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
  1710     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
  1711            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
  1712     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
  1713         10  FILLER                            PIC 999.           ELCDTEVR
  1714         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
  1715         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
  1716             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
  1717             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
  1718         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
  1719         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
  1720     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
  1721            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
  1722     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
  1723         10  FILLER                            PIC 999.           ELCDTEVR
  1724         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
  1725         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
  1726             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
  1727             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
  1728         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
  1729         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
  1730     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
  1731            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
  1732 01  WS-RATE-RECORD.                                              ELCDTEVR
  1733         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
  1734             10  FILLER                        PIC 999.           ELCDTEVR
  1735             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
  1736             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
  1737                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
  1738                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
  1739             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
  1740             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
  1741         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
  1742                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
  1743                                                                  00133669
  1744******************************************************************00133673
  1745 PROCEDURE DIVISION.
  1746
* 1747                                 COPY ELCDTERX.
  1748******************************************************************04/15/98
  1749*                                                                *ELCDTERX
  1750*                                                                *ELCDTERX
  1751*                            ELCDTERX.                           *   LV002
  1752*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1753*                            VMOD=2.007                          *ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  32
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1754*                                                                *ELCDTERX
  1755*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1756*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1757*      = ELCDTEFD)                                               *ELCDTERX
  1758*                                                                *ELCDTERX
  1759******************************************************************ELCDTERX
  1760                                                                  ELCDTERX
  1761     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1762                                                                  ELCDTERX
  1763     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1764     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1765     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1766                                                                  ELCDTERX
  1767     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1768                                                                  ELCDTERX
  1769******************************************************************ELCDTERX
  1770*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1771*          WARNING MESSAGES.                                      ELCDTERX
  1772******************************************************************ELCDTERX
  1773     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1774         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1775                                                                  ELCDTERX
  1776     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1777                                                                  ELCDTERX
  1778     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1779                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1780                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1781                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1782                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1783                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1784                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1785                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1786                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1787                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1788                                                                  ELCDTERX
  1789     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1790                                                                  ELCDTERX
  1791     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1792                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1793                                                                  ELCDTERX
  1794     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1795     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1796     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1797     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1798                                                                  ELCDTERX
  1799     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1800         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1801     ELSE                                                         ELCDTERX
  1802         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1803                                                                  ELCDTERX
  1804     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1805         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1806     ELSE                                                         ELCDTERX
  1807         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1808                                                                  ELCDTERX
  1809 0005-READ--CARD.                                                 ELCDTERX
  1810     READ DISK-DATE                                               ELCDTERX
  1811         AT END CLOSE DISK-DATE                                   ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  33
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1812             GO TO 0060-READ--TEST.                               ELCDTERX
  1813                                                                  ELCDTERX
  1814     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1815                                                                  ELCDTERX
  1816     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
  1817         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1818         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1819         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1820         GO TO 0005-READ--CARD.                                   ELCDTERX
  1821                                                                  ELCDTERX
  1822     IF DD-ID = 'CLAD'                                            ELCDTERX
  1823         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1824         GO TO 0005-READ--CARD.                                   ELCDTERX
  1825                                                                  ELCDTERX
  1826     IF DD-ID = 'CLAX'                                            ELCDTERX
  1827         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1828         GO TO 0005-READ--CARD.                                   ELCDTERX
  1829                                                                  ELCDTERX
  1830     IF DD-ID = 'CLAF'                                            ELCDTERX
  1831         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1832         GO TO 0005-READ--CARD.                                   ELCDTERX
  1833                                                                  ELCDTERX
  1834     IF DD-ID = 'CLAC'                                            ELCDTERX
  1835         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1836                                                                  ELCDTERX
  1837     IF DD-ID = 'CARR'                                            ELCDTERX
  1838         GO TO 0015-READ--CARR.                                   ELCDTERX
  1839                                                                  ELCDTERX
  1840     IF DD-ID = 'STAT'                                            ELCDTERX
  1841         GO TO 0020-READ--STAT.                                   ELCDTERX
  1842                                                                  ELCDTERX
  1843     IF DD-ID = 'BUSC'                                            ELCDTERX
  1844         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1845                                                                  ELCDTERX
  1846     IF DD-ID = 'MORT'                                            ELCDTERX
  1847         GO TO 0030-READ--MORT.                                   ELCDTERX
  1848                                                                  ELCDTERX
  1849     IF DD-ID = 'CLAI'                                            ELCDTERX
  1850         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1851                                                                  ELCDTERX
  1852     IF DD-ID = 'COLC'                                            ELCDTERX
  1853         GO TO 0065-READ--COLC.                                   ELCDTERX
  1854                                                                  ELCDTERX
  1855     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1856        DD-IDA = 'CL'                                             ELCDTERX
  1857         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1858                                                                  ELCDTERX
  1859     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1860        DD-IDA = 'PO'                                             ELCDTERX
  1861         GO TO 0050-READ--POXX.                                   ELCDTERX
  1862                                                                  ELCDTERX
  1863     IF DD-ID = 'OPCA'                                            ELCDTERX
  1864         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1865                                                                  ELCDTERX
  1866     IF DD-ID = 'OPST'                                            ELCDTERX
  1867         GO TO 0072-READ--OPST.                                   ELCDTERX
  1868                                                                  ELCDTERX
  1869     IF DD-ID = 'OPBS'                                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  34
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1870         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1871                                                                  ELCDTERX
  1872     IF DD-ID = 'OPMS'                                            ELCDTERX
  1873         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1874                                                                  ELCDTERX
  1875     GO TO 0005-READ--CARD.                                       ELCDTERX
  1876                                                                  ELCDTERX
  1877 0010-READ--CLAC.                                                 ELCDTERX
  1878     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1879     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1880     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1881     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1882     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1883     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1884     GO TO 0005-READ--CARD.                                       ELCDTERX
  1885                                                                  ELCDTERX
  1886 0015-READ--CARR.                                                 ELCDTERX
  1887     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1888     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1889        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1890        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1891        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1892        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1893        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1894        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1895        MOVE DD-CARR1-SECPAY-SW
  1896                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1897     END-IF
  1898                                                                  ELCDTERX
  1899     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1900     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1901        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1902        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1903        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1904        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1905        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1906        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1907        MOVE DD-CARR2-SECPAY-SW
  1908                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1909     END-IF
  1910                                                                  ELCDTERX
  1911                                                                  ELCDTERX
  1912     GO TO 0005-READ--CARD.                                       ELCDTERX
  1913                                                                  ELCDTERX
  1914 0020-READ--STAT.                                                 ELCDTERX
  1915     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1916     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1917        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1918         GO TO 0005-READ--CARD.                                   ELCDTERX
  1919                                                                  ELCDTERX
  1920     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1921     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1922     GO TO 0020-READ--STAT.                                       ELCDTERX
  1923                                                                  ELCDTERX
  1924 0025-READ--BUSC.                                                 ELCDTERX
  1925     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1926     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1927        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  35
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1928         GO TO 0005-READ--CARD.                                   ELCDTERX
  1929                                                                  ELCDTERX
  1930     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1931     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1932     GO TO 0025-READ--BUSC.                                       ELCDTERX
  1933                                                                  ELCDTERX
  1934 0030-READ--MORT.                                                 ELCDTERX
  1935     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1936     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1937        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1938         GO TO 0005-READ--CARD.                                   ELCDTERX
  1939                                                                  ELCDTERX
  1940     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1941     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1942     GO TO 0030-READ--MORT.                                       ELCDTERX
  1943                                                                  ELCDTERX
  1944 0035-READ--CLXX.                                                 ELCDTERX
  1945     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1946          GO TO 0005-READ--CARD.                                  ELCDTERX
  1947                                                                  ELCDTERX
  1948     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1949         DISPLAY '***********************************************'ELCDTERX
  1950         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1951         DISPLAY '***********************************************'ELCDTERX
  1952         GO TO 0055-READ--STOP.                                   ELCDTERX
  1953                                                                  ELCDTERX
  1954     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1955        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1956         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1957                                                                  ELCDTERX
  1958     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1959        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1960         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1961                                                                  ELCDTERX
  1962*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1963     GO TO 0005-READ--CARD.                                       ELCDTERX
  1964                                                                  ELCDTERX
  1965 0040-READ--CLAI.                                                 ELCDTERX
  1966     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1967     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1968        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1969         GO TO 0005-READ--CARD.                                   ELCDTERX
  1970                                                                  ELCDTERX
  1971     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1972     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1973     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1974                                                                  ELCDTERX
  1975 0045-READ--DUMP.                                                 ELCDTERX
  1976     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1977     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1978                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1979     PERFORM ABEND-PGM.                                           ELCDTERX
  1980                                                                  ELCDTERX
  1981 0050-READ--POXX.                                                 ELCDTERX
  1982     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1983         GO TO 0005-READ--CARD.                                   ELCDTERX
  1984                                                                  ELCDTERX
  1985     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  36
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1986         DISPLAY '***********************************************'ELCDTERX
  1987         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1988         DISPLAY '***********************************************'ELCDTERX
  1989         GO TO 0055-READ--STOP.                                   ELCDTERX
  1990                                                                  ELCDTERX
  1991     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1992     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1993     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1994     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1995                                                                  ELCDTERX
  1996     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1997         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1998     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1999         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  2000                                                                  ELCDTERX
  2001     GO TO 0005-READ--CARD.                                       ELCDTERX
  2002                                                                  ELCDTERX
  2003 0055-READ--STOP.                                                 ELCDTERX
  2004     GOBACK.                                                      ELCDTERX
  2005                                                                  ELCDTERX
  2006 0060-READ--TEST.                                                 ELCDTERX
  2007     IF DATX-COD        = SPACE  OR                               ELCDTERX
  2008        CLAX-ID         = SPACE  OR                               ELCDTERX
  2009        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  2010         GO TO 0045-READ--DUMP.                                   ELCDTERX
  2011                                                                  ELCDTERX
  2012     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  2013     GO TO 0079-READ--EXIT.                                       ELCDTERX
  2014                                                                  ELCDTERX
  2015 0065-READ--COLC.                                                 ELCDTERX
  2016     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  2017     GO TO 0005-READ--CARD.                                       ELCDTERX
  2018                                                                  ELCDTERX
  2019 0070-READ--OPCA.                                                 ELCDTERX
  2020                                                                  ELCDTERX
  2021     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2022                                                                  ELCDTERX
  2023     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  2024             OR                                                   ELCDTERX
  2025         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  2026         GO TO 0005-READ--CARD.                                   ELCDTERX
  2027                                                                  ELCDTERX
  2028     ADD 1                       TO INDEXCA.                      ELCDTERX
  2029     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  2030                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  2031     GO TO 0070-READ--OPCA.                                       ELCDTERX
  2032                                                                  ELCDTERX
  2033 0072-READ--OPST.                                                 ELCDTERX
  2034                                                                  ELCDTERX
  2035     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2036                                                                  ELCDTERX
  2037     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  2038             OR                                                   ELCDTERX
  2039         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2040         GO TO 0005-READ--CARD.                                   ELCDTERX
  2041                                                                  ELCDTERX
  2042     ADD 1                       TO INDEXST.                      ELCDTERX
  2043     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  37
* CIFPB511.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  2044                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  2045     GO TO 0072-READ--OPST.                                       ELCDTERX
  2046                                                                  ELCDTERX
  2047 0074-READ--OPBS.                                                 ELCDTERX
  2048                                                                  ELCDTERX
  2049     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  2050                                                                  ELCDTERX
  2051     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  2052             OR                                                   ELCDTERX
  2053         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  2054         GO TO 0005-READ--CARD.                                   ELCDTERX
  2055                                                                  ELCDTERX
  2056     ADD 1                       TO INDEXBS.                      ELCDTERX
  2057     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  2058     GO TO 0074-READ--OPBS.                                       ELCDTERX
  2059                                                                  ELCDTERX
  2060 0079-READ--EXIT.                                                 ELCDTERX
  2061*    EXIT.                                                        ELCDTERX
  2062******************************************************************ELCDTERX
  2063
  2064     OPEN INPUT FPB-IN
  2065
  2066     ACCEPT WORK-DATE-IN         FROM DATE
  2067     DISPLAY ' WORK DATE IN ' WORK-DATE-IN
  2068
  2069     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'
  2070     DISPLAY '*   CURRENT DATE IS -- ' WS-CURRENT-DATE
  2071     MOVE RUN-DATE               TO W-DISPLAY-DATE
  2072     DISPLAY ' RUN DATE IS ' W-DISPLAY-DATE
  2073     DISPLAY '* * * * * * * * * * * * * * * * * * * * * * *'
  2074
  2075     SORT SORT-FILE
  2076         ON ASCENDING KEY SR-CONTROL SR-CERT-NO SR-REC-TYPE
  2077             INPUT PROCEDURE  0000-SORT-INPUT-PROCEDURE
  2078             OUTPUT PROCEDURE 0001-SORT-OUTPUT-PROCEDURE.
  2079
  2080     PERFORM 0015-FINALIZE       THRU 0015-EXIT
  2081
  2082     DISPLAY ' RECORDS INPUT      ' RECS-IN
  2083     DISPLAY ' RECORDS RELEASED   ' RECS-REL
  2084     DISPLAY ' RECORDS RETURNED   ' RECS-RET
  2085
  2086     GOBACK
  2087
  2088     .
  2089 0000-SORT-INPUT-PROCEDURE SECTION.
  2090
  2091     PERFORM 0040-READ-FPB       THRU 0040-EXIT
  2092
  2093     PERFORM 0030-PROCESS-FPB    THRU 0030-EXIT UNTIL
  2094        END-OF-FPB
  2095
  2096     PERFORM 0045-WRITE-PENDING-RECS
  2097                                 THRU 0045-EXIT
  2098
  2099     .
  2100 0001-SORT-OUTPUT-PROCEDURE SECTION.
  2101
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  38
* CIFPB511.cbl
  2102     OPEN OUTPUT FPB-OUT
  2103     PERFORM 0025-RETURN-FPB     THRU 0025-EXIT
  2104     MOVE ' ' TO WS-EOF-SW
  2105     MOVE SR-CONTROL             TO WS-PREV-SR-ACCOUNT
  2106     PERFORM 0020-PROCESS        THRU 0020-EXIT UNTIL
  2107        END-OF-FPB
  2108
  2109     .
  2110 0015-FINALIZE SECTION.
  2111
  2112     PERFORM 0160-ACCOUNT-BREAK  THRU 0160-EXIT
  2113     CLOSE FPB-IN FPB-OUT
  2114
  2115     .
  2116 0015-EXIT.
  2117     EXIT.
  2118
  2119 0020-PROCESS.
  2120
  2121     IF SR-CONTROL NOT = WS-PREV-SR-ACCOUNT
  2122        PERFORM 0160-ACCOUNT-BREAK THRU 0160-EXIT
  2123        MOVE SR-CONTROL          TO WS-PREV-SR-ACCOUNT
  2124     END-IF
  2125     EVALUATE TRUE
  2126        WHEN SR-REC-TYPE = '21'
  2127           ADD +1 TO FP-CERT-ISS
  2128        WHEN SR-REC-TYPE = '23'
  2129           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2130           COMPUTE FP-LF-WRITTEN = FP-LF-WRITTEN +
  2131              PBI-I-LF-PREM-AMT + PBI-I-LF-ALT-PREM-AMT
  2132        WHEN SR-REC-TYPE = '24'
  2133           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2134           COMPUTE FP-AH-WRITTEN = FP-AH-WRITTEN +
  2135              PBI-I-AH-PREM-AMT
  2136        WHEN SR-REC-TYPE = '31'
  2137           ADD +1 TO FP-CERT-CANC
  2138           MOVE SR-PENDING-RECORD TO PBI-RECORD-BODY
  2139           COMPUTE FP-LF-CANC = FP-LF-CANC +
  2140              PBI-C-LF-PREM-REFUND
  2141           COMPUTE FP-AH-CANC = FP-AH-CANC +
  2142              PBI-C-AH-PREM-REFUND
  2143     END-EVALUATE
  2144
  2145     WRITE CARD-RECORD           FROM SORT-RECORD
  2146
  2147     PERFORM 0025-RETURN-FPB     THRU 0025-EXIT
  2148
  2149     .
  2150 0020-EXIT.
  2151     EXIT.
  2152
  2153 0025-RETURN-FPB.
  2154
  2155     RETURN SORT-FILE AT END
  2156          SET END-OF-FPB         TO TRUE
  2157     END-RETURN
  2158
  2159     IF NOT END-OF-FPB
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  39
* CIFPB511.cbl
  2160        ADD 1                    TO RECS-RET
  2161     END-IF
  2162
  2163     .
  2164 0025-EXIT.
  2165     EXIT.
  2166
  2167 0030-PROCESS-FPB.
  2168
  2169     IF NOT FPB-VALID-REC-7
  2170        CONTINUE
  2171     ELSE
  2172        IF FPB-ACCT-NO NOT = WS-SAVE-ACCT-NO
  2173           PERFORM 0045-WRITE-PENDING-RECS
  2174                                 THRU 0045-EXIT
  2175           MOVE FPB-IN-RECORD    TO FIRST-PREMIER-INPUT
  2176           MOVE FPB-ACCT-NO      TO WS-SAVE-ACCT-NO
  2177           PERFORM 0070-BUILD-COMMON
  2178                                 THRU 0070-EXIT
  2179        END-IF
  2180        MOVE FPB-IN-RECORD       TO FIRST-PREMIER-INPUT
  2181        IF FP7-CANC-DATE NOT = SPACES
  2182           PERFORM 0060-PROCESS-CANCELS
  2183                                 THRU 0060-EXIT
  2184        ELSE
  2185           PERFORM 0055-PROCESS-ISSUES
  2186                                 THRU 0055-EXIT
  2187        END-IF
  2188     END-IF
  2189
  2190     PERFORM 0040-READ-FPB       THRU 0040-EXIT
  2191
  2192     .
  2193 0030-EXIT.
  2194     EXIT.
  2195
  2196 0040-READ-FPB.
  2197
  2198     READ FPB-IN AT END
  2199          SET END-OF-FPB         TO TRUE
  2200     END-READ
  2201
  2202     IF NOT END-OF-FPB
  2203        ADD 1                    TO RECS-IN
  2204     END-IF
  2205
  2206     .
  2207 0040-EXIT.
  2208     EXIT.
  2209
  2210 0045-WRITE-PENDING-RECS.
  2211
  2212     IF (WS-LF-PREM > ZEROS)
  2213        OR (WS-AH-PREM > ZEROS)
  2214        PERFORM 0050-BUILD-ISSUE-REC
  2215                                 THRU 0050-EXIT
  2216     ELSE
  2217        IF (WS-LF-REF > ZEROS)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  40
* CIFPB511.cbl
  2218           OR (WS-AH-REF > ZEROS)
  2219           PERFORM 0065-BUILD-CANCEL-REC
  2220                                 THRU 0065-EXIT
  2221        END-IF
  2222     END-IF
  2223
  2224     .
  2225 0045-EXIT.
  2226     EXIT.
  2227
  2228
  2229 0050-BUILD-ISSUE-REC.
  2230
  2231*    IF (WS-LF-PREM = ZEROS)
  2232*       AND (WS-AH-PREM > ZEROS)
  2233*       DISPLAY ' FOUND A&H ONLY USING 1107201 '
  2234*       MOVE '0001107201'        TO OUT-ACCOUNT-NO
  2235*    ELSE
  2236*       MOVE '0001107200'        TO OUT-ACCOUNT-NO
  2237*    END-IF
  2238     move '0001107200'           to out-account-no
  2239     if found-ah-only
  2240        move '0001107201'        to out-account-no
  2241        DISPLAY ' FOUND A&H ONLY USING 1107201 ' save-cert
  2242     end-if
  2243     PERFORM 0080-BUILD-SEQ-1    THRU 0080-EXIT
  2244     PERFORM 0090-BUILD-SEQ-2    THRU 0090-EXIT
  2245     PERFORM 0100-BUILD-SEQ-3    THRU 0100-EXIT
  2246     PERFORM 0110-BUILD-SEQ-4    THRU 0110-EXIT
  2247     PERFORM 0120-BUILD-SEQ-5    THRU 0120-EXIT
  2248     PERFORM 0122-BUILD-SEQ-6    THRU 0122-EXIT
  2249     PERFORM 0125-BUILD-SEQ-7    THRU 0125-EXIT
  2250     PERFORM 0127-BUILD-SEQ-8    THRU 0127-EXIT
  2251
  2252     .
  2253 0050-EXIT.
  2254     EXIT.
  2255
  2256 0055-PROCESS-ISSUES.
  2257
  2258     DISPLAY ' FOUND ISSUE '
  2259     IF FP7-INS-TABLE NOT NUMERIC
  2260        MOVE ZEROS               TO FP7-INS-TABLE
  2261     END-IF
  2262
  2263     IF FP7-BALLOON-AMT NOT NUMERIC
  2264        MOVE ZEROS               TO FP7-BALLOON-AMT
  2265     END-IF
  2266
  2267     IF FP7-PREMIUM NOT NUMERIC
  2268        MOVE ZEROS               TO FP7-PREMIUM
  2269     END-IF
  2270
  2271     EVALUATE TRUE
  2272        WHEN FP7-INS-TABLE = 51
  2273           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2274           MOVE '22'             TO WS-LF-BENEFIT-CD
  2275        WHEN FP7-INS-TABLE = 52
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  41
* CIFPB511.cbl
  2276           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2277           MOVE '23'             TO WS-LF-BENEFIT-CD
  2278        WHEN (FP7-INS-TABLE = 53)
  2279             AND (WS-LF-PREM NOT = ZEROS)
  2280           MOVE FP7-PREMIUM      TO WS-LF-PREM-ALT
  2281           MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2282           MOVE '62'             TO WS-LF-BENEFIT-CD
  2283        WHEN (FP7-INS-TABLE = 54)
  2284             AND (WS-LF-PREM NOT = ZEROS)
  2285           MOVE FP7-PREMIUM      TO WS-LF-PREM-ALT
  2286           MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2287           MOVE '63'             TO WS-LF-BENEFIT-CD
  2288        WHEN (FP7-INS-TABLE = 53)
  2289             AND (WS-LF-PREM = ZEROS)
  2290           DISPLAY ' FOUND PURE LEVEL ' FP7-ACCOUNT-NUMBER
  2291           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2292*          MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2293           MOVE '24'             TO WS-LF-BENEFIT-CD
  2294        WHEN (FP7-INS-TABLE = 54)
  2295             AND (WS-LF-PREM = ZEROS)
  2296           DISPLAY ' FOUND PURE LEVEL ' FP7-ACCOUNT-NUMBER
  2297           MOVE FP7-PREMIUM      TO WS-LF-PREM
  2298*          MOVE FP7-BALLOON-AMT  TO WS-LF-BALLOON
  2299           MOVE '25'             TO WS-LF-BENEFIT-CD
  2300        WHEN FP7-INS-TABLE = 55
  2301           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2302           MOVE '03'             TO WS-AH-BENEFIT-CD
  2303        WHEN FP7-INS-TABLE = 57
  2304           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2305           MOVE '03'             TO WS-AH-BENEFIT-CD
  2306           set found-ah-only to true
  2307        WHEN FP7-INS-TABLE = 56
  2308           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2309           MOVE '53'             TO WS-AH-BENEFIT-CD
  2310        WHEN FP7-INS-TABLE = 58
  2311           MOVE FP7-PREMIUM      TO WS-AH-PREM
  2312           MOVE '53'             TO WS-AH-BENEFIT-CD
  2313           set found-ah-only to true
  2314        WHEN OTHER
  2315           DISPLAY ' INVALID OR UNKNOWN INS TABLE '
  2316              FP7-INS-TABLE
  2317           PERFORM ABEND-PGM
  2318     END-EVALUATE
  2319
  2320     .
  2321 0055-EXIT.
  2322     EXIT.
  2323
  2324 0060-PROCESS-CANCELS.
  2325
  2326     IF FP7-INS-TABLE NOT NUMERIC
  2327        MOVE ZEROS               TO FP7-INS-TABLE
  2328     END-IF
  2329
  2330     MOVE FP7-CANC-DATE (7:4)    TO WS-WORK-DATE (1:4)
  2331     MOVE FP7-CANC-DATE (1:2)    TO WS-WORK-DATE (5:2)
  2332     MOVE FP7-CANC-DATE (4:2)    TO WS-WORK-DATE (7:2)
  2333     IF WS-WORK-DATE-N NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  42
* CIFPB511.cbl
  2334        MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2335        MOVE 'L'                    TO DC-OPTION-CODE
  2336        PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2337        IF NO-CONVERSION-ERROR
  2338           CONTINUE
  2339*          MOVE DC-GREG-DATE-1-MDY  TO WS-REF-DATE
  2340        ELSE
  2341           DISPLAY ' BAD REFUND DATE ' FP7-CANC-DATE
  2342           ' CERT = ' FP7-ACCOUNT-NUMBER
  2343        END-IF
  2344     END-IF
  2345
  2346     EVALUATE TRUE
  2347        WHEN FP7-INS-TABLE = 51 OR 52 OR 53 OR 54
  2348           COMPUTE WS-LF-REF = WS-LF-REF + FP7-CANC-AMT
  2349           MOVE DC-GREG-DATE-1-MDY
  2350                                 TO WS-LF-REF-DATE
  2351        WHEN FP7-INS-TABLE = 55 OR 56
  2352           MOVE FP7-CANC-AMT     TO WS-AH-REF
  2353           MOVE DC-GREG-DATE-1-MDY
  2354                                 TO WS-AH-REF-DATE
  2355        WHEN FP7-INS-TABLE = 57 or 58
  2356           set found-ah-only to true
  2357           MOVE FP7-CANC-AMT     TO WS-AH-REF
  2358           MOVE DC-GREG-DATE-1-MDY
  2359                                 TO WS-AH-REF-DATE
  2360        WHEN OTHER
  2361           DISPLAY ' INVALID OR UNKNOWN INS TABLE '
  2362              FP7-INS-TABLE
  2363           PERFORM ABEND-PGM
  2364     END-EVALUATE
  2365
  2366     .
  2367 0060-EXIT.
  2368     EXIT.
  2369
  2370 0065-BUILD-CANCEL-REC.
  2371
  2372     move '0001107200'           to out-account-no
  2373     if found-ah-only
  2374        move '0001107201'        to out-account-no
  2375        DISPLAY ' FOUND A&H ONLY CAN USING 1107201 ' save-cert
  2376     end-if
  2377     PERFORM 0130-BUILD-CANCEL   THRU 0130-EXIT
  2378
  2379     .
  2380 0065-EXIT.
  2381     EXIT.
  2382
  2383 0070-BUILD-COMMON.
  2384
  2385*    DISPLAY FIRST-PREMIER-INPUT
  2386     MOVE ' '                    TO WS-ISS-SW
  2387                                    WS-CAN-SW
  2388
  2389     MOVE ZEROS                  TO WS-BIRTH-DT
  2390                                    WS-1ST-PMT-DT
  2391
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  43
* CIFPB511.cbl
  2392*    DISPLAY ' NOTE DATE ' FP7-NOTE-DATE
  2393     MOVE FP7-NOTE-DATE (7:4)    TO WS-WORK-DATE (1:4)
  2394     MOVE FP7-NOTE-DATE (1:2)    TO WS-WORK-DATE (5:2)
  2395     MOVE FP7-NOTE-DATE (4:2)    TO WS-WORK-DATE (7:2)
  2396     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2397     MOVE 'L'                    TO DC-OPTION-CODE
  2398     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2399     IF NO-CONVERSION-ERROR
  2400        MOVE DC-BIN-DATE-1       TO WS-BIN-EFF-DT
  2401        MOVE DC-GREG-DATE-1-MDY  TO SAVE-EFF-DATE
  2402     ELSE
  2403        DISPLAY ' BAD EFFECT  DT ' WS-WORK-DATE '  '
  2404        'CERT = ' FP7-ACCOUNT-NUMBER
  2405     END-IF
  2406
  2407     MOVE FP7-LASN-ORIG-1ST-PMT-DT (7:4)
  2408                                 TO WS-WORK-DATE (1:4)
  2409     MOVE FP7-LASN-ORIG-1ST-PMT-DT (1:2)
  2410                                 TO WS-WORK-DATE (5:2)
  2411     MOVE FP7-LASN-ORIG-1ST-PMT-DT (4:2)
  2412                                 TO WS-WORK-DATE (7:2)
  2413     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2414     MOVE 'L'                    TO DC-OPTION-CODE
  2415     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2416     IF NO-CONVERSION-ERROR
  2417        MOVE DC-BIN-DATE-1       TO WS-BIN-1ST-PAY-DT
  2418        MOVE DC-GREG-DATE-1-MDY  TO WS-1ST-PMT-DT
  2419     ELSE
  2420        DISPLAY ' BAD 1ST PMT DT ' WS-WORK-DATE '  '
  2421        'CERT = ' FP7-ACCOUNT-NUMBER
  2422     END-IF
  2423
  2424     MOVE FP7-CISM-BIRTH-DT (7:4)
  2425                                 TO WS-WORK-DATE (1:4)
  2426                                    WORK-BIRTH-DATE (1:4)
  2427     MOVE FP7-CISM-BIRTH-DT (1:2)
  2428                                 TO WS-WORK-DATE (5:2)
  2429                                    WB-MM
  2430     MOVE FP7-CISM-BIRTH-DT (4:2)
  2431                                 TO WS-WORK-DATE (7:2)
  2432                                    WB-DD
  2433     MOVE WS-WORK-DATE-N         TO DC-GREG-DATE-CYMD
  2434     MOVE 'L'                    TO DC-OPTION-CODE
  2435     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2436     IF NO-CONVERSION-ERROR
  2437        MOVE DC-BIN-DATE-1       TO WS-BIN-BIRTH-DT
  2438     ELSE
  2439        DISPLAY ' BAD BIRTH DATE ' FP7-CISM-BIRTH-DT
  2440        ' CERT = ' FP7-ACCOUNT-NUMBER
  2441     END-IF
  2442
  2443     MOVE 40                     TO WS-INSURED-AGE
  2444
  2445     MOVE WS-BIN-BIRTH-DT        TO DC-BIN-DATE-1
  2446     MOVE WS-BIN-EFF-DT          TO DC-BIN-DATE-2
  2447     MOVE '1'                    TO DC-OPTION-CODE
  2448     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  2449     IF NO-CONVERSION-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  44
* CIFPB511.cbl
  2450        COMPUTE WS-INSURED-AGE = DC-ELAPSED-MONTHS / +12
  2451     ELSE
  2452        DISPLAY ' BAD AGE CALC CERT = ' FP7-ACCOUNT-NUMBER
  2453        ' ' DC-ERROR-CODE
  2454     END-IF
  2455
  2456     MOVE  FP7-ACCOUNT-NUMBER    TO SAVE-CERT
  2457
  2458     IF FP7-PMT-AMT NOT NUMERIC
  2459        MOVE ZEROS               TO FP7-PMT-AMT
  2460     END-IF
  2461
  2462     IF FP7-CANC-AMT NOT NUMERIC
  2463        MOVE ZEROS               TO FP7-CANC-AMT
  2464     END-IF
  2465
  2466     IF FP7-INS-MOS NOT NUMERIC
  2467        MOVE ZEROS               TO FP7-INS-MOS
  2468     END-IF
  2469
  2470     IF FP7-AMT-DOLLARS NOT NUMERIC
  2471        MOVE ZEROS               TO FP7-AMT-DOLLARS
  2472     END-IF
  2473
  2474     IF FP7-AMT-CENTS NOT NUMERIC
  2475        MOVE ZEROS               TO FP7-AMT-CENTS
  2476     END-IF
  2477
  2478     MOVE FP7-AMT-DOLLARS        TO WS-WORK-AMT-DOLLARS
  2479     MOVE FP7-AMT-CENTS          TO WS-WORK-AMT-CENTS
  2480
  2481     DISPLAY ' FP7 APR =' FP7-APR
  2482     IF FP7-APR-WHOLE NOT NUMERIC
  2483        MOVE ZEROS               TO FP7-APR-WHOLE
  2484     END-IF
  2485     IF FP7-APR-DEC NOT NUMERIC
  2486        MOVE ZEROS               TO FP7-APR-DEC
  2487     END-IF
  2488     MOVE FP7-APR-WHOLE          TO WS-WORK-APR-DOLLARS
  2489     MOVE FP7-APR-DEC            TO WS-WORK-APR-CENTS
  2490     DISPLAY ' APR = **' WS-WORK-APR-N '**'
  2491
  2492     IF FP7-LASN-LOAN-TERM NOT NUMERIC
  2493        MOVE ZEROS               TO FP7-LASN-LOAN-TERM
  2494     END-IF
  2495
  2496     MOVE SPACES                 TO WS-LF-BENEFIT-CD
  2497                                    WS-AH-BENEFIT-CD
  2498                                    WS-AH-ONLY-SW
  2499     MOVE ZEROS                  TO WS-LF-PREM
  2500                                    WS-AH-PREM
  2501                                    WS-LF-REF
  2502                                    WS-AH-REF
  2503                                    WS-LF-PREM-ALT
  2504                                    WS-LF-BALLOON
  2505                                    WS-LF-REF-DATE
  2506                                    WS-AH-REF-DATE
  2507
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  45
* CIFPB511.cbl
  2508     .
  2509 0070-EXIT.
  2510     EXIT.
  2511
  2512 0080-BUILD-SEQ-1.
  2513
  2514     ADD 1                       TO LOGIC-CNT
  2515     ADD 1                       TO CERT-CNT
  2516*    ADD 1                       TO FP-CERT-ISS
  2517     ADD 1                       TO TOT-CERT-ISS
  2518
  2519     MOVE SPACES                 TO PBI-RECORD-BODY
  2520
  2521     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2522     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2523
  2524     MOVE FP7-SHORT-FNAME        TO PBI-I-INS-1ST-NAME
  2525     MOVE FP7-MID-INIT           TO PBI-I-INS-MIDDLE-INIT
  2526     MOVE FP7-SHORT-LNAME        TO PBI-I-INS-LAST-NAME
  2527
  2528     MOVE WS-INSURED-AGE         TO PBI-I-INSURED-AGE
  2529     MOVE 'M'                    TO PBI-I-INSURED-SEX
  2530
  2531     STRING FP7-TAX-ID (1:3) '-' FP7-TAX-ID (4:2) '-'
  2532        FP7-TAX-ID (6:4) DELIMITED BY SIZE INTO PBI-I-SOC-SEC-NO
  2533     END-STRING
  2534
  2535     MOVE WS-BIRTH-DT            TO PBI-I-BIRTHDAY
  2536
  2537     MOVE '2'                    TO PBI-TRANS-TYPE
  2538     MOVE '1'                    TO PBI-SEQUENCE
  2539
  2540     MOVE PBI-ISSUE-RECORD       TO OUT-RECORD (1:80)
  2541     PERFORM 0140-RELEASE-REC    THRU 0140-EXIT
  2542
  2543     .
  2544 0080-EXIT.
  2545     EXIT.
  2546
  2547 0090-BUILD-SEQ-2.
  2548
  2549     MOVE SPACES                 TO PBI-RECORD-BODY
  2550     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2551     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2552
  2553     MOVE +1                     TO S1
  2554     IF FP7-NAME-2 NOT = SPACES
  2555        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2556           (S2 > +30)
  2557           OR (FP7-NAME-2 (S2:1) = ' ')
  2558        END-PERFORM
  2559        IF (S2 < +30)
  2560           AND (S2 > +1)
  2561           MOVE FP7-NAME-2 (S1:(S2 - 1))
  2562                                 TO PBI-I-JNT-1ST-NAME
  2563        END-IF
  2564        IF (FP7-NAME-2 (S2:1) = SPACES)
  2565           AND (FP7-NAME-2 ((S2 + 2):1) = SPACES)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  46
* CIFPB511.cbl
  2566           MOVE FP7-NAME-2 ((S2 + 1):1)
  2567                                 TO PBI-I-JNT-MIDDLE-INIT
  2568           COMPUTE S2 = S2 + 3
  2569        ELSE
  2570           COMPUTE S2 = S2 + 1
  2571        END-IF
  2572        MOVE S2                  TO S1
  2573        COMPUTE S2 = 31 - S2
  2574        MOVE FP7-NAME-2 (S1:S2)  TO PBI-I-JNT-LAST-NAME
  2575     END-IF
  2576
  2577     MOVE '2'                    TO PBI-TRANS-TYPE
  2578     MOVE '2'                    TO PBI-SEQUENCE
  2579
  2580     IF PBI-I-ISSUE-REC-SEQ-2 NOT = SPACES
  2581        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2582        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2583     END-IF
  2584
  2585     .
  2586 0090-EXIT.
  2587     EXIT.
  2588
  2589 0100-BUILD-SEQ-3.
  2590
  2591     MOVE SPACES                 TO PBI-RECORD-BODY
  2592
  2593     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2594     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2595
  2596     MOVE WS-LF-BENEFIT-CD       TO PBI-I-LF-BENEFIT-TYPE
  2597     MOVE WS-LF-PREM             TO PBI-I-LF-PREM-AMT
  2598     MOVE WS-LF-PREM-ALT         TO PBI-I-LF-ALT-PREM-AMT
  2599     MOVE WS-LF-BALLOON          TO PBI-I-LF-ALT-BENEFIT-AMT
  2600
  2601     COMPUTE PBI-I-LF-BENEFIT-AMT = FP7-PMT-AMT * FP7-INS-MOS
  2602*    IF WS-WORK-AMT-N NOT = ZEROS
  2603*       MOVE WS-WORK-AMT-N       TO PBI-I-LF-BENEFIT-AMT
  2604*    END-IF
  2605
  2606     MOVE FP7-INS-MOS            TO PBI-I-LF-TERM
  2607
  2608     ADD WS-LF-PREM              TO TOT-LIFE-WRITTEN
  2609*                                   FP-LF-WRITTEN
  2610
  2611     ADD WS-LF-PREM-ALT          TO TOT-LIFE-WRITTEN
  2612*                                   FP-LF-WRITTEN
  2613
  2614     IF PBI-I-LF-PREM-AMT = ZEROS
  2615        MOVE ZEROS               TO PBI-I-LF-BENEFIT-AMT
  2616     END-IF
  2617
  2618     MOVE '2'                    TO PBI-TRANS-TYPE
  2619     MOVE '3'                    TO PBI-SEQUENCE
  2620
  2621     IF (PBI-I-LF-PREM-AMT > ZEROS)
  2622*       AND (PBI-I-LF-BENEFIT-AMT > ZEROS)
  2623        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  47
* CIFPB511.cbl
  2624        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2625     END-IF
  2626
  2627     .
  2628 0100-EXIT.
  2629     EXIT.
  2630
  2631 0110-BUILD-SEQ-4.
  2632
  2633     MOVE SPACES                 TO PBI-RECORD-BODY
  2634
  2635     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2636     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2637
  2638     DISPLAY ' BENEFIT CD **' WS-AH-BENEFIT-CD '**'
  2639     DISPLAY '  PMT AMT   **' FP7-PMT-AMT '**'
  2640     DISPLAY '  PREM AMT  **' WS-AH-PREM '**'
  2641     MOVE WS-AH-BENEFIT-CD       TO PBI-I-AH-BENEFIT-TYPE
  2642     MOVE FP7-PMT-AMT            TO PBI-I-AH-BENEFIT-AMT
  2643     MOVE FP7-INS-MOS            TO PBI-I-AH-TERM
  2644     MOVE WS-AH-PREM             TO PBI-I-AH-PREM-AMT
  2645
  2646
  2647     ADD WS-AH-PREM              TO TOT-AH-WRITTEN
  2648*                                   FP-AH-WRITTEN
  2649
  2650     MOVE '2'                       TO  PBI-TRANS-TYPE.
  2651     MOVE '4'                       TO  PBI-SEQUENCE.
  2652
  2653     IF (PBI-I-AH-BENEFIT-AMT > ZEROS)
  2654        AND (PBI-I-AH-PREM-AMT > ZEROS)
  2655        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2656        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2657     END-IF
  2658
  2659     .
  2660 0110-EXIT.
  2661     EXIT.
  2662
  2663 0120-BUILD-SEQ-5.
  2664
  2665     MOVE SPACES                 TO PBI-RECORD-BODY
  2666
  2667     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2668     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2669
  2670     MOVE FP7-RESP-CODE          TO PBI-I-LOAN-OFFICER
  2671
  2672     SET S3                      TO +1
  2673*    SEARCH ALL LOAN-OFFS AT END
  2674*       MOVE 'XX'                TO PBI-I-LOAN-OFFICER (1:2)
  2675*         WHEN RESP-CODE (S3) = PBI-I-LOAN-OFFICER (3:3)
  2676*            MOVE BRANCH-CODE (S3) TO PBI-I-LOAN-OFFICER (1:2)
  2677*    END-SEARCH
  2678     MOVE FP7-BRANCH-NO (11:2)   TO PBI-I-LOAN-OFFICER (1:2)
  2679
  2680*    MOVE FP7-LASN-LOAN-TERM     TO PBI-I-LOAN-TERM
  2681
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  48
* CIFPB511.cbl
  2682     MOVE WS-1ST-PMT-DT          TO PBI-I-1ST-PMT-DT
  2683
  2684     MOVE WS-WORK-APR-N          TO PBI-I-LOAN-APR
  2685
  2686     MOVE '2'                    TO PBI-TRANS-TYPE
  2687     MOVE '5'                    TO PBI-SEQUENCE
  2688
  2689     MOVE PBI-ISSUE-RECORD       TO OUT-RECORD (1:80)
  2690     PERFORM 0140-RELEASE-REC    THRU 0140-EXIT
  2691
  2692     .
  2693 0120-EXIT.
  2694     EXIT.
  2695
  2696 0122-BUILD-SEQ-6.
  2697
  2698     MOVE SPACES                 TO PBI-RECORD-BODY
  2699
  2700     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2701     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2702
  2703     MOVE FP7-ADDRESS            TO PBI-I-INSURED-ADDRESS-1
  2704
  2705     MOVE '2'                    TO PBI-TRANS-TYPE
  2706     MOVE '6'                    TO PBI-SEQUENCE
  2707
  2708     IF PBI-I-ISSUE-REC-SEQ-6 NOT = SPACES
  2709        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2710        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2711     END-IF
  2712
  2713     .
  2714 0122-EXIT.
  2715     EXIT.
  2716
  2717 0125-BUILD-SEQ-7.
  2718
  2719     MOVE SPACES                 TO PBI-RECORD-BODY
  2720
  2721     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2722     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2723
  2724     MOVE FP7-CISM-CITY          TO PBI-I-INSURED-CITY
  2725     MOVE FP7-CISM-STATE         TO PBI-I-INSURED-STATE
  2726*    STRING FP7-CISM-CITY ', ' FP7-CISM-STATE DELIMITED BY SIZE
  2727*       INTO PBI-I-INSURED-CITY-STATE
  2728*    END-STRING
  2729     MOVE FP7-CISM-ZIP-9 (4:9)   TO PBI-I-INSURED-ZIP-CODE
  2730     MOVE FP7-CISM-HOME-PHONE (3:10)
  2731                                 TO PBI-I-INSURED-PHONE-NO
  2732
  2733     MOVE '2'                    TO PBI-TRANS-TYPE
  2734     MOVE '7'                    TO PBI-SEQUENCE
  2735
  2736     IF PBI-I-ISSUE-REC-SEQ-7 NOT = SPACES
  2737        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2738        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2739     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  49
* CIFPB511.cbl
  2740
  2741     .
  2742 0125-EXIT.
  2743     EXIT.
  2744
  2745 0127-BUILD-SEQ-8.
  2746
  2747     MOVE SPACES                 TO PBI-RECORD-BODY
  2748
  2749     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2750     MOVE SAVE-CERT              TO PBI-CERT-PRIME
  2751
  2752     MOVE 'FIRST PREMIER BANK'   TO  PBI-I-CRED-BENE-NAME
  2753
  2754     MOVE '2'                    TO PBI-TRANS-TYPE
  2755     MOVE '8'                    TO PBI-SEQUENCE
  2756
  2757     IF PBI-I-ISSUE-REC-SEQ-8 NOT = SPACES
  2758        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2759        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2760     END-IF
  2761
  2762     .
  2763 0127-EXIT.
  2764     EXIT.
  2765
  2766 0130-BUILD-CANCEL.
  2767
  2768     MOVE SPACES                 TO PBI-RECORD-BODY
  2769     ADD 1                       TO LOGIC-CANC-CNT
  2770     ADD 1                       TO CANC-CNT
  2771
  2772     MOVE SAVE-EFF-DATE          TO PBI-CERT-EFF-DT-X
  2773     MOVE WS-SAVE-ACCT-NO        TO PBI-CERT-PRIME
  2774
  2775     MOVE FP7-SHORT-LNAME        TO PBI-C-INSURED-NAME
  2776
  2777     MOVE WS-LF-REF              TO PBI-C-LF-PREM-REFUND
  2778     MOVE WS-AH-REF              TO PBI-C-AH-PREM-REFUND
  2779
  2780     IF PBI-C-LF-PREM-REFUND > ZEROS
  2781        MOVE WS-LF-REF-DATE      TO PBI-C-LF-CANCEL-DATE
  2782     END-IF
  2783
  2784     IF PBI-C-AH-PREM-REFUND > ZEROS
  2785        MOVE WS-AH-REF-DATE      TO PBI-C-AH-CANCEL-DATE
  2786     END-IF
  2787
  2788     MOVE '3'                    TO PBI-C-TRANS-TYPE
  2789     MOVE '1'                    TO PBI-C-SEQUENCE
  2790
  2791*    ADD 1                       TO FP-CERT-CANC
  2792*    ADD PBI-C-LF-PREM-REFUND    TO FP-LF-CANC
  2793*    ADD PBI-C-AH-PREM-REFUND    TO FP-AH-CANC
  2794
  2795     ADD 1                       TO TOT-CERT-CANC
  2796     ADD PBI-C-LF-PREM-REFUND    TO TOT-LIFE-CANC
  2797     ADD PBI-C-AH-PREM-REFUND    TO TOT-AH-CANC
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  50
* CIFPB511.cbl
  2798
  2799     IF (PBI-C-LF-PREM-REFUND > ZEROS)
  2800        OR (PBI-C-AH-PREM-REFUND > ZEROS)
  2801        MOVE PBI-ISSUE-RECORD    TO OUT-RECORD (1:80)
  2802        PERFORM 0140-RELEASE-REC THRU 0140-EXIT
  2803     END-IF
  2804
  2805     .
  2806 0130-EXIT.
  2807     EXIT.
  2808
  2809 0140-RELEASE-REC.
  2810
  2811     MOVE '1'                 TO OUT-BATCH-HDR-IND
  2812     RELEASE SORT-RECORD      FROM OUT-RECORD
  2813     ADD +1 TO RECS-REL
  2814
  2815     .
  2816 0140-EXIT.
  2817     EXIT.
  2818
  2819 0160-ACCOUNT-BREAK.
  2820
  2821     MOVE '9'                    TO FP-CARR
  2822     MOVE '000000'               TO FP-COMP
  2823     MOVE 'SD'                   TO FP-STATE
  2824     MOVE WS-PREV-SR-ACCOUNT     TO FP-ACCT-NO
  2825     MOVE 'FP'                   TO FP-BATCH-ID
  2826     MOVE WORK-MO-IN             TO FP-BATCH-DA
  2827     ADD  1                      TO FP-BATCH-NO
  2828     MOVE WORK-YR-IN             TO FP-HD-EFF-YR
  2829     MOVE WORK-MO-IN             TO FP-HD-EFF-MO
  2830     MOVE WORK-DA-IN             TO FP-HD-EFF-DA
  2831     MOVE 'CID'                  TO FP-CLIENT-ID
  2832     MOVE '1'                    TO FP-TRANS-TYPE
  2833     MOVE '0'                    TO FP-SEQUENCE-NO
  2834     MOVE WS-PREV-SR-ACCOUNT     TO FP-ACCOUNT-NO
  2835     MOVE '0'                    TO FP-BATCH-HDR-IND
  2836     ADD 1                       TO HDR-CNT
  2837
  2838     WRITE CARD-RECORD           FROM FPB-BATCH-HDR
  2839
  2840     MOVE ZEROS                 TO FP-LF-WRITTEN
  2841                                   FP-LF-CANC
  2842                                   FP-AH-WRITTEN
  2843                                   FP-AH-CANC
  2844                                   FP-CERT-ISS
  2845                                   FP-CERT-CANC
  2846                                   CERT-CNT
  2847                                   CANC-CNT
  2848                                   DETAIL-CNT
  2849
  2850     .
  2851 0160-EXIT.
  2852     EXIT.
  2853
  2854 8500-DATE-CONVERT.
  2855
* Micro Focus Server Express         V5.1 revision 000 14-Nov-12 16:14 Page  51
* CIFPB511.cbl
  2856     CALL 'ELDATCX'              USING DATE-CONVERSION-DATA
  2857
  2858     .
  2859 8590-EXIT.
  2860     EXIT.
  2861
  2862 ABEND-PGM.
*                 COPY ELCABEND.
  2863***************************************************************** 04/14/98
  2864*                                                               * ELCABEND
  2865*                            ELCABEND.                          *    LV003
  2866*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
  2867*                            VMOD 2.002                              CL**2
  2868*                                                               * ELCABEND
  2869*                THIS SECTION DISPLAYS THE NECESSARY MESSAGES   * ELCABEND
  2870*            AND THEN ABENDS.                                   * ELCABEND
  2871*                                                               * ELCABEND
  2872*  NO  CID  MODS  IN  COPYBOOK  ELCABEND                        * ELCABEND
  2873*                                                               * ELCABEND
  2874***************************************************************** ELCABEND
  2875*APS-010.                                                         ELCABEND
  2876     DISPLAY WS-ABEND-MESSAGE.                                    ELCABEND
  2877     DISPLAY WS-ABEND-MESSAGE UPON CONSOLE.                       ELCABEND
  2878                                                                  ELCABEND
  2879     IF WS-ABEND-FILE-STATUS NOT = ZERO                           ELCABEND
  2880         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2881         DISPLAY 'FILE STATUS = ' WS-ABEND-FILE-STATUS            ELCABEND
  2882                                 UPON CONSOLE.                    ELCABEND
  2883                                                                  ELCABEND
  2884     IF WS-RETURN-CODE NOT = ZERO                                 ELCABEND
  2885         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2886         DISPLAY 'RETURN CODE = '  WS-RETURN-CODE                 ELCABEND
  2887                                 UPON CONSOLE.                    ELCABEND
  2888                                                                  ELCABEND
  2889     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2890     DISPLAY 'PROGRAM WILL NOW ABEND **************'              ELCABEND
  2891                                 UPON CONSOLE.                    ELCABEND
  2892                                                                  ELCABEND
  2893     DIVIDE WS-ZERO BY WS-ZERO GIVING WS-ZERO.                    ELCABEND
  2894     CALL 'ABORTME'.
  2895                                                                  ELCABEND
  2896 APS-EXIT.                                                        ELCABEND
  2897     EXIT.                                                        ELCABEND
  2898
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       51296     Code:        8023
