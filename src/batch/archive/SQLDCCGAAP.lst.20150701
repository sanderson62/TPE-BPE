* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   1
* SQLDCCGAAP.cbl
* Options: int("SQLDCCGAAP.int") anim csi verbose NOBOUND PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("SQLDCCGAAP.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"ebmlsfile" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" NOCHECKDIV NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"32" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SQLDCCGAAP.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SQLDCCGAAP.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE
*          "0" NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR NOSTICKY-LINKAGE
*          NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"2" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2****************************************************************
     3 IDENTIFICATION DIVISION.
     4 PROGRAM-ID. sqldccgaap.
     5 AUTHOR.   Pablo.
     6
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   2
* SQLDCCGAAP.cbl
    14*            *                                                   *
    15*            *****************************************************
    16
    17 ENVIRONMENT DIVISION.
    18 CONFIGURATION SECTION.
    19 INPUT-OUTPUT SECTION.
    20 FILE-CONTROL.
    21
    22     SELECT FILE-IN          ASSIGN TO SYS010
    23                             ORGANIZATION IS LINE SEQUENTIAL.
    24
    25     SELECT DISK-DATE        ASSIGN TO SYS019.
    26
    27 DATA DIVISION.
    28 FILE SECTION.
    29
    30 FD  FILE-IN
    31     BLOCK CONTAINS 0 RECORDS
    32     RECORDING MODE F.
    33
    34 01  FILE-IN-REC                PIC X(410).
    35
    36 FD  DISK-DATE
*   37                              COPY ELCDTEFD.
    38******************************************************************04/15/98
    39*                                                                *ELCDTEFD
    40*                                                                *ELCDTEFD
    41*                            ELCDTEFD.                           *   LV002
    42*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
    43*                            VMOD=2.007                          *   CL**2
    44*                                                                *ELCDTEFD
    45******************************************************************ELCDTEFD
    46     BLOCK CONTAINS 0 RECORDS
    47     RECORDING MODE F.                                            ELCDTEFD
    48                                                                  ELCDTEFD
    49 01  DATE-DISK.                                                   ELCDTEFD
    50     12  DD-ID                       PIC  X(4).                   ELCDTEFD
    51     12  FILLER                      PIC  X(14).                  ELCDTEFD
    52     12  DD-CR1                      PIC  9.                      ELCDTEFD
    53     12  DD-CR1N                     PIC  X(30).                  ELCDTEFD
    54     12  DD-CR2                      PIC  9.                      ELCDTEFD
    55     12  DD-CR2N                     PIC  X(30).                  ELCDTEFD
    56     12  FILLER                      PIC  X(20).                  ELCDTEFD
    57                                                                  ELCDTEFD
    58 01  DATE-DISK-R.                                                 ELCDTEFD
    59     12  FILLER                      PIC  X(4).                   ELCDTEFD
    60     12  DD-ST           OCCURS 3 TIMES                           ELCDTEFD
    61                                     PIC  X(32).                  ELCDTEFD
    62                                                                  ELCDTEFD
    63 01  DATE-DISK-T.                                                 ELCDTEFD
    64     12  FILLER                      PIC  X(4).                   ELCDTEFD
    65     12  DD-TYPE         OCCURS 2 TIMES                           ELCDTEFD
    66                                     PIC  X(48).                  ELCDTEFD
    67                                                                  ELCDTEFD
    68 01  DATE-DISK-M.                                                 ELCDTEFD
    69     12  FILLER                      PIC  X(4).                   ELCDTEFD
    70     12  DD-MORT         OCCURS 2 TIMES                           ELCDTEFD
    71                                     PIC  X(48).                  ELCDTEFD
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   3
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEFD)
    72                                                                  ELCDTEFD
    73 01  DATE-DISK-P.                                                 ELCDTEFD
    74     12  DD-IDA                      PIC  XX.                     ELCDTEFD
    75     12  DD-IDX                      PIC  99.                     ELCDTEFD
    76     12  DD-DATA                     PIC  X(96).                  ELCDTEFD
    77     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    78         16  DD-PS-PIC   OCCURS 50 TIMES                          ELCDTEFD
    79                                     PIC  X.                      ELCDTEFD
    80         16  FILLER                  PIC  X(46).                  ELCDTEFD
    81     12  FILLER  REDEFINES DD-DATA.                               ELCDTEFD
    82         16  DD-PS-PICO  OCCURS 20 TIMES.                         ELCDTEFD
    83             20  DD-PS-PRT           PIC  X.                      ELCDTEFD
    84             20  DD-PS-FMT           PIC  X.                      ELCDTEFD
    85             20  DD-PS-PRC           PIC  X.                      ELCDTEFD
    86             20  DD-PS-TOT           PIC  X.                      ELCDTEFD
    87         16  FILLER                  PIC  X(16).                  ELCDTEFD
    88                                                                  ELCDTEFD
    89 01  DATE-DISK-E.                                                 ELCDTEFD
    90     12  FILLER                      PIC  X(4).                   ELCDTEFD
    91     12  DD-EDIT         OCCURS 24 TIMES                          ELCDTEFD
    92                                     PIC  X(4).                   ELCDTEFD
    93                                                                  ELCDTEFD
    94 01  DATE-DISK-C.                                                 ELCDTEFD
    95     12  FILLER                      PIC  X(7).                   ELCDTEFD
    96     12  DD-CARR1-SECPAY-SW          PIC  X.
    97     12  DD-CARR1-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
    98     12  DD-CARR1-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
    99     12  DD-CARR1-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   100     12  DD-CARR1                    PIC  X.                      ELCDTEFD
   101     12  DD-CARR1S                   PIC  XX.                     ELCDTEFD
   102     12  DD-CARR1N                   PIC  X(30).                  ELCDTEFD
   103     12  DD-CARR2                    PIC  X.                      ELCDTEFD
   104     12  DD-CARR2S                   PIC  XX.                     ELCDTEFD
   105     12  DD-CARR2N                   PIC  X(30).                  ELCDTEFD
   106     12  DD-CARR2-UEP-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   107     12  DD-CARR2-R78-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   108     12  DD-CARR2-PRO-PCT            PIC  S9V9(4) COMP-3.         ELCDTEFD
   109     12  DD-CARR2-SECPAY-SW          PIC  X.
   110     12  FILLER                      PIC  X(7).                   ELCDTEFD
   111                                                                  ELCDTEFD
   112 01  DATE-DISK-OPT.                                               ELCDTEFD
   113     12  FILLER                      PIC  X(04).                  ELCDTEFD
   114     12  DD-TLR-DATA.                                             ELCDTEFD
   115         16  DD-TLR                  OCCURS 32 TIMES              ELCDTEFD
   116                                     PIC  X(03).                  ELCDTEFD
   117     12  DD-STATE-DATA REDEFINES DD-TLR-DATA.                     ELCDTEFD
   118         16  DD-STATE-FLDS           OCCURS 16 TIMES              ELCDTEFD
   119                                     PIC  X(06).                  ELCDTEFD
   120     12  DD-CARR-DATA REDEFINES DD-TLR-DATA.                      ELCDTEFD
   121         16  DD-CARR-FLDS            OCCURS 13 TIMES              ELCDTEFD
   122                                     PIC  X(07).                  ELCDTEFD
   123         16  FILLER                  PIC  X(05).                  ELCDTEFD
   124     12  DD-MISC-DATA REDEFINES DD-TLR-DATA                       ELCDTEFD
   125                                     PIC  X(96).                  ELCDTEFD
   126******************************************************************ELCDTEFD
   127
   128 working-storage section.
   129
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   4
* SQLDCCGAAP.cbl
*  130 EXEC SQL
*  131    INCLUDE SQLDA
*  132 END-EXEC
   133 01 SQLDA sync.
   134    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   135    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   136    05 SQLN                  PIC S9(4) COMP-5 value 0.
   137    05 SQLD                  PIC S9(4) COMP-5 value 0.
   138    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   139       10 SQLTYPE            PIC S9(4) COMP-5.
   140       10 SQLLEN             PIC S9(4) COMP-5.
   141$IF P64 SET
   142X      *> For 64-bit environments, ensure that SQLDATA is
   143X      *> aligned on an 8-byte boundary.
   144X      10 FILLER             PIC S9(9) COMP-5.
   145$END
   146       10 SQLDATA            USAGE POINTER.
   147       10 SQLIND             USAGE POINTER.
   148       10 SQLNAME.
   149          15 SQLNAMEL        PIC S9(4) COMP-5.
   150          15 SQLNAMEC        PIC X(30).
   151
   152* Values for SQLTYPE
   153
   154 78  ESQL-DATE-CHAR              VALUE 384.
   155 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   156 78  ESQL-DATE-REC               VALUE 386.
   157 78  ESQL-DATE-REC-NULL          VALUE 387.
   158 78  ESQL-TIME-CHAR              VALUE 388.
   159 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   160 78  ESQL-TIME-REC               VALUE 390.
   161 78  ESQL-TIME-REC-NULL          VALUE 391.
   162 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   163 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   164 78  ESQL-TIMESTAMP-REC          VALUE 394.
   165 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   166 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   167 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   168 78  ESQL-TS-OFFSET-REC          VALUE 398.
   169 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   170 78  ESQL-LONGVARBINARY          VALUE 404.
   171 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   172 78  ESQL-LONGVARCHAR            VALUE 408.
   173 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   174 78  ESQL-BINARY                 VALUE 444.
   175 78  ESQL-BINARY-NULL            VALUE 445.
   176 78  ESQL-VARBINARY              VALUE 446.
   177 78  ESQL-VARBINARY-NULL         VALUE 447.
   178 78  ESQL-VARCHAR                VALUE 448.
   179 78  ESQL-VARCHAR-NULL           VALUE 449.
   180
   181 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   182 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   183
   184 78  ESQL-CHAR                   VALUE 452.
   185 78  ESQL-CHAR-NULL              VALUE 453.
   186
   187 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   5
* SQLDCCGAAP.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   188 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   189
   190 78  ESQL-DOUBLE                 VALUE 480.
   191 78  ESQL-DOUBLE-NULL            VALUE 481.
   192 78  ESQL-REAL                   VALUE 482.
   193 78  ESQL-REAL-NULL              VALUE 483.
   194 78  ESQL-DECIMAL                VALUE 484.
   195 78  ESQL-DECIMAL-NULL           VALUE 485.
   196 78  ESQL-INTEGER                VALUE 496.
   197 78  ESQL-INTEGER-NULL           VALUE 497.
   198 78  ESQL-SMALLINT               VALUE 500.
   199 78  ESQL-SMALLINT-NULL          VALUE 501.
   200 78  ESQL-TINYINT                VALUE 502.
   201 78  ESQL-TINYINT-NULL           VALUE 503.
   202
*  203 EXEC SQL
*  204    INCLUDE SQLCA
*  205 END-EXEC
   206 01 SQLCA.
   207     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   208     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   209     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   210     05  SQLERRM.
   211         49  SQLERRML    PIC S9(4) COMP-5.
   212         49  SQLERRMC    PIC X(70).
   213     05  SQLERRP         PIC X(8).
   214     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   215     05  SQLWARN.
   216         10  SQLWARN0    PIC X.
   217         10  SQLWARN1    PIC X.
   218         10  SQLWARN2    PIC X.
   219         10  SQLWARN3    PIC X.
   220         10  SQLWARN4    PIC X.
   221         10  SQLWARN5    PIC X.
   222         10  SQLWARN6    PIC X.
   223         10  SQLWARN7    PIC X.
   224     05  SQLEXT.
   225         10  SQLWARN8    PIC X.
   226         10  SQLWARN9    PIC X.
   227         10  SQLWARN10   PIC X.
   228         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   229     05  SQLSTATE    PIC X(5).
   230
   231 77  rec-cnt                     pic 9(7) value zeros.
   232 77  ws-recs-in                  pic 9(7) value zeros.
   233 77  eof-sw                      pic x value ' '.
   234     88  end-of-input               value 'Y'.
   235
   236 EXEC SQL
   237    BEGIN DECLARE SECTION
   238 END-EXEC
   239
   240 01  sqlcmd                      pic x(1024).
   241 01  WS-MOE-DATE                 pic x(10).
   242 01  svr                         pic x(32).
   243 01  usr                         pic x(32).
   244 01  pass                        pic x(32).
   245 01  usr-pass                    pic x(64).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   6
* SQLDCCGAAP.cbl
   246 01  ws-disp-code                pic s9(11).
   247
   248 01  GAAP-DETAIL-RECORD.
   249     12  EX-CARRIER              PIC X.
   250     12  EX-TAB1                 PIC X.
   251     12  EX-GROUPING             PIC X(6).
   252     12  EX-TAB2                 PIC X.
   253     12  EX-STATE                PIC XX.
   254     12  EX-TAB3                 PIC X.
   255     12  EX-ACCOUNT              PIC X(10).
   256     12  EX-TAB4                 PIC X.
   257     12  EX-EFF                  PIC X(10).
   258     12  EX-TAB5                 PIC X.
   259     12  EX-CERT-NO              PIC X(11).
   260     12  EX-TAB6                 PIC X.
   261     12  EX-LFTYP                PIC XX.
   262     12  EX-TAB7                 PIC X.
   263     12  EX-LF-TERM              PIC 999.
   264     12  EX-TAB8                 PIC X.
   265     12  EX-LF-REMTERM           PIC 999.
   266     12  EX-TAB9                 PIC X.
   267     12  EX-LFBEN                PIC x(13).
   268     12  EX-TAB10                PIC X.
   269     12  EX-LFPRM                PIC x(11).
   270     12  EX-TAB11                PIC X.
   271     12  EX-AHTYP                PIC XX.
   272     12  EX-TAB12                PIC X.
   273     12  EX-AH-TERM              PIC 999.
   274     12  EX-TAB13                PIC X.
   275     12  EX-AH-REMTERM           PIC 999.
   276     12  EX-TAB14                PIC X.
   277     12  EX-AHBEN                PIC x(11).
   278     12  EX-TAB15                PIC X.
   279     12  EX-AHPRM                PIC x(11).
   280     12  EX-TAB16                PIC X.
   281     12  EX-REM-AMT              PIC x(12).
   282     12  EX-TAB17                PIC X.
   283     12  EX-PLFPRM               PIC x(11).
   284     12  EX-TAB18                PIC X.
   285     12  EX-RLFPRM               PIC x(11).
   286     12  EX-TAB19                PIC X.
   287     12  EX-SLFPRM               PIC x(11).
   288     12  EX-TAB20                PIC X.
   289     12  EX-PAHPRM               PIC x(11).
   290     12  EX-TAB21                PIC X.
   291     12  EX-RAHPRM               PIC x(11).
   292     12  EX-TAB22                PIC X.
   293     12  EX-SAHPRM               PIC x(11).
   294     12  EX-TAB23                PIC X.
   295     12  EX-REIN                 PIC X.
   296     12  EX-TAB24                PIC X.
   297     12  EX-REIN-CO              PIC X(03).
   298     12  EX-TAB25                PIC X.
   299     12  EX-AH-REM-BEN           PIC x(13).
   300     12  EX-TAB26                PIC X.
   301     12  EX-MORT-RESV            PIC x(11).
   302     12  EX-TAB27                PIC X.
   303     12  EX-REIN-SUB             PIC X(03).
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   7
* SQLDCCGAAP.cbl
   304     12  EX-TAB28                PIC X.
   305     12  EX-SEX-CODE             PIC X.
   306     12  EX-TAB29                PIC X.
   307     12  EX-LOAN-TERM            PIC 999.
   308     12  EX-TAB30                PIC X.
   309     12  EX-LF-EXP-DT            PIC X(10).
   310     12  EX-TAB31                PIC X.
   311     12  EX-AH-EXP-DT            PIC X(10).
   312     12  EX-TAB32                PIC X.
   313     12  EX-LF-UP-REMTERM        PIC 999.
   314     12  EX-TAB33                PIC X.
   315     12  EX-AH-UP-REMTERM        PIC 999.
   316     12  EX-TAB34                PIC X.
   317     12  EX-UNLD-STAT-RESV       PIC x(11).
   318     12  EX-TAB35                PIC X.
   319     12  EX-LFCOM                PIC x(09).
   320     12  EX-TAB36                PIC X.
   321     12  EX-PLFCOM               PIC x(9).
   322     12  EX-TAB37                PIC X.
   323     12  EX-RLFCOM               PIC x(9).
   324     12  EX-TAB38                PIC X.
   325     12  EX-SLFCOM               PIC x(9).
   326     12  EX-TAB39                PIC X.
   327     12  EX-AHCOM                PIC x(9).
   328     12  EX-TAB40                PIC X.
   329     12  EX-PAHCOM               PIC x(9).
   330     12  EX-TAB41                PIC X.
   331     12  EX-RAHCOM               PIC x(9).
   332     12  EX-TAB42                PIC X.
   333     12  EX-SAHCOM               PIC x(9).
   334     12  EX-TAB43                PIC X.
   335     12  EX-MO-DEC               PIC x(11).
   336     12  EX-TAB44                PIC X.
   337     12  EX-MORT-FACT            PIC x(11).
   338     12  EX-TAB45                PIC X.
   339     12  EX-MORT-AGE             PIC 999.
   340     12  EX-TAB46                PIC X.
   341     12  EX-MORT-TABLE           PIC XXXX.
   342     12  EX-TAB47                PIC X.
   343     12  EX-ALT-MORT-TABLE       PIC XXXX.
   344
   345 EXEC SQL
   346    END DECLARE SECTION
   347 END-EXEC
   348
   349 01  FILLER.
   350     05  ABEND-CODE                  PIC X(4) VALUE SPACES.
   351     05  ABEND-OPTION                PIC X    VALUE 'Y'.
   352     05  WS-ABEND-MESSAGE            PIC X(80)   VALUE SPACES.
   353     05  WS-ABEND-FILE-STATUS        PIC XX      VALUE ZERO.
   354     05  WS-RETURN-CODE       COMP-3 PIC S9(3)   VALUE ZERO.
   355     05  PGM-SUB                     PIC S999 COMP-3 VALUE +344.
   356
*  357                                 COPY ELCDTECX.
   358******************************************************************06/05/98
   359*                                                                *ELCDTECX
   360*                            ELCDTECX.                           *   LV005
   361*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   8
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   362*                            VMOD=2.015                          *ELCDTECX
   363*                                                                *ELCDTECX
   364*      WORKING STORAGE COPY CODE FOR APPLICATIONS CALLING        *ELCDTECX
   365*      THE DATE CARD DISK FILE. ( READ ROUTINE = ELCDTERX,       *ELCDTECX
   366*      AND DISK FILE FD = ELCDTEFX)                              *ELCDTECX
   367*                                                                *ELCDTECX
   368******************************************************************ELCDTECX
   369******************************************************************
   370*                   C H A N G E   L O G
   371*
   372* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   373*-----------------------------------------------------------------
   374*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   375* EFFECTIVE    NUMBER
   376*-----------------------------------------------------------------
   377* 092602    2002091900008  PEMA  INCREASE NUMBER OF MAXIMUM
   378*                                  BENEFIT CODES FROM 300 TO 900
   379* 090803    2003080800002  PEMA  ADD CATEGORY FOR SUPER GAP
   380* 051304    2003080800002  SMVA  ADD REFUND METHOD
   381******************************************************************
   382 01  DATE-CARD.                                                   ELCDTECX
   383     12  DATX-COD                    PIC  X(4).                   ELCDTECX
   384     12  RUN-DATE                    PIC  9(11)  COMP-3.          ELCDTECX
   385     12  ALPH-DATE                   PIC  X(18).                  ELCDTECX
   386     12  EP-DT                       PIC  9(11)  COMP-3.          ELCDTECX
   387     12  PEND-ACT-FILE               PIC  XX.                     ELCDTECX
   388     12  EP-SW                       PIC  X.                      ELCDTECX
   389         88  NO-EP-EXTRACTS          VALUE SPACE.                 ELCDTECX
   390     12  TAPE-BATCHES                PIC  X.                      ELCDTECX
   391         88  TP-PREL-BAL             VALUE '1'.                   ELCDTECX
   392     12  BIN-RUN-DATE                PIC  XX.                     ELCDTECX
   393     12  RUN-CENTURY.                                             ELCDTECX
   394         16 RUN-CENTURY-N            PIC  99.                        CL**4
   395     12  FILLER                      PIC  X.                         CL**4
   396     12  CLAS-MORT-OVRD              PIC  X(4).                   ELCDTECX
   397     12  FILLER                      PIC  XXX.                    ELCDTECX
   398     12  COMPANY-NAME                PIC  X(30).                  ELCDTECX
   399                                                                  ELCDTECX
   400 01  FILLER                          PIC  X(7)                       CL**6
   401                                          VALUE 'OPTIONS'.        ELCDTECX
   402 01  DATE-CARD-OPTIONS.                                           ELCDTECX
   403     12  DATE-OPTIONS-ID             PIC  X(4).                   ELCDTECX
   404     12  DTE-MIN-PREM                PIC  99V99.                  ELCDTECX
   405     12  DTE-LANGUAGE-IND            PIC  X.                      ELCDTECX
   406         88  DTE-LANGUAGE-IS-FR           VALUE 'F'.              ELCDTECX
   407         88  DTE-LANGUAGE-IS-ENG          VALUE 'E'.              ELCDTECX
   408     12  DTE-MIN-AGE                 PIC  99.                     ELCDTECX
   409     12  DTE-DEFAULT-AGE             PIC  99.                     ELCDTECX
   410     12  FILLER                      PIC  X.                      ELCDTECX
   411     12  DTE-MAX-TERM                PIC  999.                    ELCDTECX
   412     12  DTE-COMP-VG                 PIC  X.                      ELCDTECX
   413     12  DTE-REM-TRM                 PIC  X.                      ELCDTECX
   414     12  DTE-PRM-CK                  PIC S99V99.                  ELCDTECX
   415     12  DTE-PRORATA                 PIC  X.                      ELCDTECX
   416     12  DTE-CLM-REJ                 PIC  X.                      ELCDTECX
   417     12  DTE-REF-REJ                 PIC  X.                      ELCDTECX
   418     12  DTE-COM-TBL-USED            PIC  X.                      ELCDTECX
   419     12  FILLER                      PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page   9
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   420     12  DTE-QTR-CO                  PIC  X.                      ELCDTECX
   421     12  DTE-REF-CK                  PIC S99V99.                  ELCDTECX
   422     12  DTE-CLM-CK                  PIC S99V99.                  ELCDTECX
   423     12  DTE-CONV-DT                 PIC 9(11) COMP-3.               CL**2
   424     12  DTE-DEFAULT-SEX             PIC  X.                      ELCDTECX
   425     12  DTE-EPL-FORMAT              PIC  X.                      ELCDTECX
   426     12  FILLER                      PIC  X.                      ELCDTECX
   427     12  DTE-JT-AGE                  PIC  X.                      ELCDTECX
   428     12  DTE-KEY-BIRTH               PIC  X.                      ELCDTECX
   429     12  DTE-REINSURANCE             PIC  X.                      ELCDTECX
   430     12  DTE-CLAIM-SORT              PIC  X.                      ELCDTECX
   431     12  DTE-WRT-OFF                 PIC  S99V99.                 ELCDTECX
   432     12  DTE-R78                     PIC  X.                      ELCDTECX
   433     12  DTE-DLY-BILL                PIC  X.                      ELCDTECX
   434     12  DTE-ALT-MORT-CODE           PIC  X(4).                   ELCDTECX
   435     12  DTE-CLAIM-PAID-THRU-TO      PIC  X.                      ELCDTECX
   436     12  DTE-COMPENSATION-ACCESS     PIC  X.                      ELCDTECX
   437     12  DTE-MORTG-ACCESS-CNTL       PIC  X.                      ELCDTECX
   438     12  DTE-MP-ALT-MORT-CODE        PIC  X(4).                   ELCDTECX
   439     12  DTE-MORTALITY-AGE-CALC-METHOD                            ELCDTECX
   440                                     PIC  X.                      ELCDTECX
   441         88  DTE-USE-TABLE-ASSIGNED-METHOD VALUE '1'              ELCDTECX
   442                                                 ' '.             ELCDTECX
   443         88  DTE-USE-ALL-AGE-LAST          VALUE '2'.             ELCDTECX
   444         88  DTE-USE-ALL-AGE-NEAR          VALUE '3'.             ELCDTECX
   445     12  DTE-RESERVE-OPTION-SWITCH   PIC  X.                      ELCDTECX
   446         88  DTE-OPT-RESERVE-METHOD-AUTH       VALUE 'Y'.         ELCDTECX
   447         88  DTE-OPT-RESERVE-METHOD-UNAUTH     VALUE 'N' ' '.     ELCDTECX
   448     12  DTE-REM-TRM-CALC-OPTION     PIC  X.                      ELCDTECX
   449     12  DTE-EXPERIENCE-RETENTION-AGE                             ELCDTECX
   450                                     PIC  9.                         CL**4
   451     12  DTE-SYSTEM.                                              ELCDTECX
   452         16  DTE-SYS-A-CREDIT        PIC  X.                      ELCDTECX
   453         16  DTE-SYS-B-PEND-CLAIM    PIC  X.                      ELCDTECX
   454         16  DTE-SYS-C-CONFIRMATIONS PIC  X.                      ELCDTECX
   455         16  DTE-SYS-D-DEMAND-BILL   PIC  X.                      ELCDTECX
   456         16  DTE-SYS-E-CLASIC-CLAIMS PIC  X.                      ELCDTECX
   457         16  DTE-SYS-F-CLASIC-CREDIT PIC  X.                      ELCDTECX
   458         16  DTE-SYS-G-AR-USED       PIC  X.                      ELCDTECX
   459         16  DTE-SYS-H               PIC  X.                      ELCDTECX
   460         16  DTE-SYS-I               PIC  X.                      ELCDTECX
   461         16  DTE-SYS-J               PIC  X.                      ELCDTECX
   462         16  DTE-SYS-K               PIC  X.                      ELCDTECX
   463         16  DTE-SYS-L               PIC  X.                      ELCDTECX
   464         16  DTE-SYS-M               PIC  X.                      ELCDTECX
   465         16  DTE-SYS-N               PIC  X.                      ELCDTECX
   466         16  DTE-SYS-O               PIC  X.                      ELCDTECX
   467         16  DTE-SYS-P               PIC  X.                      ELCDTECX
   468         16  DTE-SYS-Q               PIC  X.                      ELCDTECX
   469         16  DTE-SYS-R               PIC  X.                      ELCDTECX
   470         16  DTE-SYS-S               PIC  X.                      ELCDTECX
   471         16  DTE-SYS-T               PIC  X.                      ELCDTECX
   472         16  DTE-SYS-U               PIC  X.                      ELCDTECX
   473         16  DTE-SYS-V               PIC  X.                      ELCDTECX
   474         16  DTE-SYS-W               PIC  X.                      ELCDTECX
   475         16  DTE-SYS-X               PIC  X.                      ELCDTECX
   476         16  DTE-SYS-Y               PIC  X.                      ELCDTECX
   477         16  DTE-SYS-Z               PIC  X.                      ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  10
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   478     12  FILLER                      REDEFINES DTE-SYSTEM.        ELCDTECX
   479         16  DTE-SYS-CODE            OCCURS 26 TIMES              ELCDTECX
   480                                     PIC  X.                      ELCDTECX
   481     12  DTE-CLIENT                  PIC  XXX.                    ELCDTECX
   482                                                                  ELCDTECX
   483 01  CLASIC-SYSTEM-CODES.                                         ELCDTECX
   484     12  DTE-COLC-ID                 PIC  X(4).                   ELCDTECX
   485     12  DTE-CLASIC-COMPANY-CD       PIC  X.                      ELCDTECX
   486     12  DTE-CLASIC-COMPANY-NUMBER   PIC  999.                    ELCDTECX
   487*    12  DTE-CLASIC-CLAIM-ACCESS     PIC  X.                      ELCDTECX
   488     12  FILLER                      PIC  X.                      ELCDTECX
   489     12  CLASIC-REIN-MAINT           PIC  XX.                     ELCDTECX
   490     12  CLASIC-COMP-MAINT           PIC  XX.                     ELCDTECX
   491     12  CLASIC-ACCT-MAINT           PIC  XX.                     ELCDTECX
   492     12  CLASIC-CTBL-MAINT           PIC  XX.                     ELCDTECX
   493     12  CLASIC-RATE-MAINT           PIC  XX.                     ELCDTECX
   494     12  CLASIC-CREDIT-EOM-DT        PIC  XX.                     ELCDTECX
   495     12  CLASIC-CLAIMS-EOM-DT        PIC  XX.                     ELCDTECX
   496                                                                  ELCDTECX
   497     12  LIFE-OVERRIDE-L1            PIC  X.                      ELCDTECX
   498     12  LIFE-OVERRIDE-L2            PIC  XX.                     ELCDTECX
   499     12  LIFE-OVERRIDE-L6            PIC  X(6).                   ELCDTECX
   500     12  LIFE-OVERRIDE-L12           PIC  X(12).                  ELCDTECX
   501                                                                  ELCDTECX
   502     12  AH-OVERRIDE-L1              PIC  X.                      ELCDTECX
   503     12  AH-OVERRIDE-L2              PIC  XX.                     ELCDTECX
   504     12  AH-OVERRIDE-L6              PIC  X(6).                   ELCDTECX
   505     12  AH-OVERRIDE-L12             PIC  X(12).                  ELCDTECX
   506                                                                  ELCDTECX
   507     12  CLAS-REPORT-CD1-CAPTION     PIC  X(10).                  ELCDTECX
   508     12  CLAS-REPORT-CD2-CAPTION     PIC  X(10).                  ELCDTECX
   509                                                                  ELCDTECX
   510     12  CLASIC-MORTG-EOM-DT         PIC  XX.                     ELCDTECX
   511     12  CLASIC-AR-EOM-DT            PIC  XX.                     ELCDTECX
   512                                                                  ELCDTECX
   513     12  FILLER                      PIC  X(11)      VALUE SPACE. ELCDTECX
   514                                                                  ELCDTECX
   515 01  DATE-CARD-FACTORS.                                           ELCDTECX
   516     12  DATE-FACTOR-ID              PIC  X(4).                   ELCDTECX
   517     12  FAC-1                       PIC S999V9(5).               ELCDTECX
   518     12  FAC-2                       PIC S999V9(5).               ELCDTECX
   519     12  FAC-3                       PIC S999V9(5).               ELCDTECX
   520     12  FAC-4                       PIC S999V9(5).               ELCDTECX
   521     12  FAC-5                       PIC S999V9(5).               ELCDTECX
   522     12  FAC-6                       PIC S999V9(5).               ELCDTECX
   523                                                                  ELCDTECX
   524 01  FILLER                          PIC  X(12)                   ELCDTECX
   525                                          VALUE 'COMPANY NAME'.   ELCDTECX
   526 01  COMPANY-NAME-TABLE.                                          ELCDTECX
   527     12  C-N-TBL                     OCCURS 6 TIMES.              ELCDTECX
   528         16  CNT-ID                  PIC  X.                      ELCDTECX
   529         16  CNT-NAME                PIC  X(30).                  ELCDTECX
   530                                                                  ELCDTECX
   531 01  FILLER                          PIC  X(11)                   ELCDTECX
   532                                          VALUE 'STATE NAMES'.    ELCDTECX
   533 01  STATE-NAMES.                                                 ELCDTECX
   534     12  STATE-NAME-FLD              OCCURS 75 TIMES.             ELCDTECX
   535         16  STATE-SUB               PIC  XX.                     ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  11
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   536         16  STATE-PIC1.                                          ELCDTECX
   537             20  STATE-ABBR          PIC  XX.                     ELCDTECX
   538             20  FILLER              PIC  XXX.                    ELCDTECX
   539             20  STATE-PIC           PIC  X(20).                  ELCDTECX
   540             20  STATE-CALL-EARN     PIC  X.                      ELCDTECX
   541             20  STATE-CALL-BREAK    PIC  X.                      ELCDTECX
   542             20  STATE-PRIM-FAC-DEV  PIC  XXX.                    ELCDTECX
   543                                                                  ELCDTECX
   544 01  FILLER                          PIC  X(13)                   ELCDTECX
   545                                          VALUE 'CARRIER NAMES'.  ELCDTECX
   546 01  CARRIER-NAMES.                                               ELCDTECX
   547     12  CARRIER-NAME-FLD            OCCURS 25 TIMES.             ELCDTECX
   548         16  CARRIER-SUB             PIC  X.                      ELCDTECX
   549         16  CARRIER-DOM-ST          PIC  XX.                     ELCDTECX
   550         16  CARRIER-PIC             PIC  X(30).                  ELCDTECX
   551         16  CARRIER-UEP-PCT         PIC  S9V9(4) COMP-3.            CL**6
   552         16  CARRIER-R78-PCT         PIC  S9V9(4) COMP-3.            CL**6
   553         16  CARRIER-PRO-PCT         PIC  S9V9(4) COMP-3.            CL**6
   554*        16  FILLER                  PIC  X.                      ELCDTECX
   555         16  CARRIER-SEC-PAY         PIC  X.
   556             88  SEC-PAY-CARRIER          VALUE 'Y'.
   557                                                                  ELCDTECX
   558 01  FILLER                          PIC  X(9)                       CL**6
   559                                          VALUE 'INS TYPES'.      ELCDTECX
   560 01  CLAS-INS-TYPES.                                              ELCDTECX
   561*    12 CLAS-ALL-TYPES               OCCURS 300 TIMES.            ELCDTECX
   562     12 CLAS-ALL-TYPES               OCCURS 900 TIMES.            ELCDTECX
   563         16  CLAS-I-BEN              PIC  XX.                     ELCDTECX
   564         16  CLAS-I-AB3.                                          ELCDTECX
   565             20  FILLER              PIC  X.                      ELCDTECX
   566             20  CLAS-I-AB2.                                      ELCDTECX
   567                 24  FILLER          PIC  X.                      ELCDTECX
   568                 24  CLAS-I-AB1      PIC  X.                      ELCDTECX
   569         16  CLAS-I-AB3-AH REDEFINES CLAS-I-AB3.                  ELCDTECX
   570             20  CLAS-EXCLUSION      PIC  XX.                        CL**4
   571             20  FILLER              PIC  X.                         CL**4
   572         16  CLAS-I-AB10.                                         ELCDTECX
   573             20  FILLER              PIC  X(9).                   ELCDTECX
   574             20  CLAS-I-REIN-YN      PIC  X.                      ELCDTECX
   575         16  CLAS-I-COMMENT          PIC  X(10).                  ELCDTECX
   576         16  CLAS-I-JOINT            PIC  X.                      ELCDTECX
   577         16  CLAS-I-RL-AH            PIC  X.                      ELCDTECX
   578         16  CLAS-I-CALC-TYPE.                                    ELCDTECX
   579             20  CLAS-I-BAL          PIC  X.                      ELCDTECX
   580         16  CLAS-I-EP               PIC  X.                      ELCDTECX
   581         16  CLAS-CO-BEN-I-G-CD      PIC  X.                      ELCDTECX
   582         16  CLAS-CO-REM-TERM-CALC   PIC  X.                      ELCDTECX
   583         16  CLAS-I-BEN-CATEGORY     PIC  X.
   584         16  CLAS-I-REFUND-METHOD    PIC  X(01).
   585         16  FILLER                  PIC  X(05).
   586                                                                  ELCDTECX
   587 01  FILLER                          PIC  X(16)                   ELCDTECX
   588                                     VALUE 'MORTALITY TABLES'.    ELCDTECX
   589 01  CLAS-MORTALITY-CODES.                                        ELCDTECX
   590     12  CLAS-MORT-FLD               OCCURS 99 TIMES              ELCDTECX
   591                                     INDEXED BY CLAS-MORT-NDX.    ELCDTECX
   592         16  CLAS-MORT-CODE          PIC  X(4).                      CL**6
   593         16  CLAS-MORT-J-CODE        PIC  X.                         CL**5
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  12
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   594         16  CLAS-MORT-J-FACT        PIC S9V9(4).                    CL**6
   595         16  CLAS-MORT-DESC.                                      ELCDTECX
   596             20  CLAS-RESERVE-ADJ    PIC  999.                       CL**6
   597             20  FILLER              PIC  XX.                        CL**5
   598             20  CLAS-YEAR           PIC  X(4).                      CL**6
   599             20  FILLER              PIC  X.                         CL**5
   600             20  CLAS-TABLE-TYPE     PIC  XXX.                       CL**6
   601             20  FILLER              PIC  X.                         CL**5
   602             20  CLAS-AGE-METHOD     PIC  XX.                        CL**5
   603             20  FILLER              PIC  X.                         CL**5
   604             20  CLAS-INTEREST       PIC  99.99.                     CL**5
   605             20  FILLER              PIC  X(5).                      CL**6
   606                                                                  ELCDTECX
   607 01  FILLER                          PIC  X(15)                   ELCDTECX
   608                                     VALUE 'BUSINESS TABLES'.     ELCDTECX
   609 01  CLAS-BUSINESS-CLASSES.                                       ELCDTECX
   610     12  CLAS-BUSC-FLD               OCCURS 50 TIMES.             ELCDTECX
   611         16  CLAS-BUSC-CODE          PIC  99.                     ELCDTECX
   612         16  CLAS-BUSC-GROUP         PIC  X.                      ELCDTECX
   613         16  CLAS-BUSC-DESC          PIC  X(19).                  ELCDTECX
   614         16  CLAS-BUSC-EXCL          PIC  X.                         CL**5
   615         16  FILLER                  PIC  X(4).                      CL**6
   616                                                                  ELCDTECX
   617 01  FILLER                          PIC  X(7)                       CL**6
   618                                     VALUE 'INDEXES'.             ELCDTECX
   619 01  CLAS-INDEX-TBL.                                              ELCDTECX
   620     12  CLAX-ID                     PIC  X(4).                   ELCDTECX
   621     12  CLAS-STARTC                 PIC S9(4) COMP.              ELCDTECX
   622     12  CLAS-MAXC                   PIC S9(4) COMP.              ELCDTECX
   623     12  CLAS-STARTL                 PIC S9(4) COMP.              ELCDTECX
   624     12  CLAS-MAXL                   PIC S9(4) COMP.              ELCDTECX
   625     12  CLAS-STARTA                 PIC S9(4) COMP.              ELCDTECX
   626     12  CLAS-MAXA                   PIC S9(4) COMP.              ELCDTECX
   627     12  CLAS-STARTM                 PIC S9(4) COMP.              ELCDTECX
   628     12  CLAS-MAXM                   PIC S9(4) COMP.              ELCDTECX
   629     12  CLAS-STARTB                 PIC S9(4) COMP.              ELCDTECX
   630     12  CLAS-MAXB                   PIC S9(4) COMP.              ELCDTECX
   631     12  CLAS-STARTS                 PIC S9(4) COMP.              ELCDTECX
   632     12  CLAS-MAXS                   PIC S9(4) COMP.              ELCDTECX
   633     12  CLAS-STARTE                 PIC S9(4) COMP.              ELCDTECX
   634     12  CLAS-MAXE                   PIC S9(4) COMP.              ELCDTECX
   635     12  CLAS-STARTCN                PIC S9(4) COMP.              ELCDTECX
   636     12  CLAS-MAXCN                  PIC S9(4) COMP.              ELCDTECX
   637                                                                  ELCDTECX
   638 01  CLAS-TYPE-MISC.                                              ELCDTECX
   639     12  CLAS-INDEXC                 PIC S9(4) COMP.              ELCDTECX
   640     12  CLAS-INDEXL                 PIC S9(4) COMP.              ELCDTECX
   641     12  CLAS-INDEXA                 PIC S9(4) COMP.              ELCDTECX
   642     12  CLAS-INDEXM                 PIC S9(4) COMP.              ELCDTECX
   643     12  CLAS-INDEXB                 PIC S9(4) COMP.              ELCDTECX
   644     12  CLAS-INDEXS                 PIC S9(4) COMP.              ELCDTECX
   645     12  CLAS-INDEXE                 PIC S9(4) COMP.              ELCDTECX
   646     12  CLAS-INDEX                  PIC S9(4) COMP.              ELCDTECX
   647     12  CLAS-INDEXEN                PIC S9(4) COMP.              ELCDTECX
   648     12  CLAS-INDEXCN                PIC S9(4) COMP.              ELCDTECX
   649     12  CLAS-INDEXON                PIC S9(4) COMP.              ELCDTECX
   650                                                                  ELCDTECX
   651 01  FILLER                          PIC  X(13)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  13
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   652                                     VALUE 'MISCELLANEOUS'.       ELCDTECX
   653 01  CLAS-MISC.                                                   ELCDTECX
   654     12  DTE-FICH                    PIC  X.                      ELCDTECX
   655         88  FICH-NO                 VALUE SPACE.                 ELCDTECX
   656         88  FICH-ONLY               VALUE '1'.                   ELCDTECX
   657         88  FICH-BOTH               VALUE '2'.                   ELCDTECX
   658     12  FICH-OPEN                   PIC  X.                      ELCDTECX
   659     12  REPT-OPEN                   PIC  X.                      ELCDTECX
   660     12  DTE-PGM-OPT                 PIC  9.                         CL**5
   661     12  DTE-PRT-OPT                 PIC  X.                      ELCDTECX
   662     12  DTE-FMT-OPT                 PIC  9.                      ELCDTECX
   663     12  DTE-PRC-OPT                 PIC  9.                      ELCDTECX
   664     12  DTE-TOT-OPT                 PIC  9.                      ELCDTECX
   665     12  CLAS-LOOK                   PIC  XX.                     ELCDTECX
   666     12  DTE-TOT-LINES               PIC S9(8)      COMP.         ELCDTECX
   667     12  STATE-L                     PIC  XX.                     ELCDTECX
   668     12  CLAS-CN                     PIC  99.                     ELCDTECX
   669     12  CLAS-CO                     PIC  99.                     ELCDTECX
   670     12  DTE-VSAM-FLAGS                              VALUE ZERO.  ELCDTECX
   671         16  DTE-F-1                 PIC  X.                      ELCDTECX
   672         16  DTE-F-2                 PIC  X.                      ELCDTECX
   673     12  DTE-ABEND-WORK.                                          ELCDTECX
   674         16  DTE-ABEND-CD-1          PIC  XX         VALUE SPACES.ELCDTECX
   675         16  DTE-ABEND-CD-2          PIC  XX         VALUE SPACES.ELCDTECX
   676                                                                  ELCDTECX
   677 01  FILLER                          PIC  X(12)                   ELCDTECX
   678                                     VALUE 'WORKING DATE'.        ELCDTECX
   679 01  WS-DATE-AND-TIME.                                            ELCDTECX
   680     12  WS-ACCEPT-DATE.                                          ELCDTECX
   681         16  WS-AD-YY                PIC  99.                     ELCDTECX
   682         16  WS-AD-MM                PIC  99.                     ELCDTECX
   683         16  WS-AD-DD                PIC  99.                     ELCDTECX
   684     12  WS-CURRENT-DATE.                                         ELCDTECX
   685         16  WS-CD-MM                PIC  99.                     ELCDTECX
   686         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   687         16  WS-CD-DD                PIC  99.                     ELCDTECX
   688         16  FILLER                  PIC  X          VALUE '/'.   ELCDTECX
   689         16  WS-CD-YY                PIC  99.                     ELCDTECX
   690     12  WS-TIME-OF-DAY.                                          ELCDTECX
   691         16  WS-TIME                 PIC  9(6).                   ELCDTECX
   692         16  WS-HUN-SEC              PIC  99.                     ELCDTECX
   693                                                                  ELCDTECX
   694 01  FILLER                          PIC  X(12)                   ELCDTECX
   695                                     VALUE 'CARRIER CLMS'.        ELCDTECX
   696 01  CARRIER-OPT-CLAIM-DATA.                                      ELCDTECX
   697     12  CARRIER-FLDS                OCCURS 25 TIMES.             ELCDTECX
   698         16  CARRIER-IBNR-SWITCH     PIC  X.                         CL**5
   699         16  CARRIER-IBNR-PERCENT    PIC S9V9(4) COMP-3.             CL**6
   700         16  CARRIER-CIDA-DISCOUNT   PIC S9V9(4) COMP-3.             CL**6
   701                                                                  ELCDTECX
   702 01  FILLER                          PIC  X(10)                   ELCDTECX
   703                                     VALUE 'STATE TLRS'.          ELCDTECX
   704 01  STATE-TARGET-LOSS-RATIOS.                                    ELCDTECX
   705     12  STATE-TLR-FLD               OCCURS 75 TIMES.             ELCDTECX
   706         16  STATE-TARGET-LOSS-RATIO PIC S9V9(4) COMP-3.             CL**6
   707         16  STATE-CALC-INTEREST     PIC S9V9(4) COMP-3.             CL**6
   708                                                                  ELCDTECX
   709 01  FILLER                          PIC  X(13)                   ELCDTECX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  14
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTECX)
   710                                     VALUE 'BUSINESS TLRS'.       ELCDTECX
   711 01  BUSINESS-TRGT-LOSS-RATIO-MODS.                               ELCDTECX
   712     12  BUS-TLRM-FLD                OCCURS 99 TIMES.             ELCDTECX
   713         16  BUS-TRGT-LOSS-RATIO-MOD PIC S9V9(4) COMP-3.             CL**6
   714                                                                  ELCDTECX
   715 01  FILLER                          PIC  X(13)                   ELCDTECX
   716                                     VALUE 'MISC CLM DATA'.       ELCDTECX
   717 01  MISC-OPT-CLM-RSV-DATA.                                       ELCDTECX
   718     12  COMPANY-CALC-INTEREST       PIC S9V9(4) COMP-3.             CL**6
   719     12  COMPANY-CIDA-DISCOUNT       PIC S9V9(4) COMP-3.             CL**6
   720     12  COMPANY-CRDB-TABLE-SELECTION                             ELCDTECX
   721                                     PIC  X.                         CL**5
   722     12  COMPANY-IBNR-AH-FACTOR      PIC S9V9(4) COMP-3.             CL**6
   723     12  COMPANY-IBNR-LAG-MONTH      PIC S999    COMP-3.             CL**6
   724     12  COMPANY-IBNR-LIFE-FACTOR    PIC S9V9(4) COMP-3.             CL**6
   725     12  COMPANY-OPTION-START-DATE   PIC  XX.                        CL**5
   726     12  INDEXBS                     PIC S9(4)   COMP.               CL**6
   727     12  INDEXCA                     PIC S9(4)   COMP.               CL**6
   728     12  INDEXST                     PIC S9(4)   COMP.               CL**6
   729     12  FILLER                      PIC  X(75).                  ELCDTECX
   730******************************************************************ELCDTECX
   731*01  MISC-CARR-PCT-DATA.                                          00001521
   732*    12  DD-CARR1-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   733*    12  DD-CARR1-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   734*    12  DD-CARR1-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   735*    12  DD-CARR2-UEP-PCT            PIC S9V9(4) COMP-3.          00001522
   736*    12  DD-CARR2-R78-PCT            PIC S9V9(4) COMP-3.          00001522
   737*    12  DD-CARR2-PRO-PCT            PIC S9V9(4) COMP-3.          00001522
   738******************************************************************ELCDTECX
*  739                                 copy ELCDTEVR.
   740***************************************************************** 04/15/98
   741*                                                                *ELCDTEVR
   742*                                                                *ELCDTEVR
   743*                            ELCDTEVR.                           *   LV003
   744*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**3
   745*                            VMOD=2.001                          *   CL**2
   746*                                                                *ELCDTEVR
   747*   WORKING STORAGE FOR DATE VARIABLES CREATED                   *ELCDTEVR
   748*   FOR THE YEAR 2000 DATE MODIFICATION                          *ELCDTEVR
   749*                                                                *ELCDTEVR
   750******************************************************************ELCDTEVR
   751 01  WS-DATE-CARD-DATE.                                           ELCDTEVR
   752     05  WS-RUN-DATE.                                             ELCDTEVR
   753         10  FILLER                  PIC  9(03).                  ELCDTEVR
   754         10  RUN-CCYY                PIC  9(04).                  ELCDTEVR
   755         10  RUN-CCYR  REDEFINES  RUN-CCYY.                       ELCDTEVR
   756             15  RUN-CC              PIC  99.                     ELCDTEVR
   757             15  RUN-YR              PIC  99.                     ELCDTEVR
   758         10  RUN-MO                  PIC  99.                     ELCDTEVR
   759         10  RUN-DA                  PIC  99.                     ELCDTEVR
   760     05  WS-RUN-DATE-N REDEFINES                                     CL**2
   761            WS-RUN-DATE              PIC 9(11).                      CL**2
   762     05  WS-EP-DT.                                                ELCDTEVR
   763         10  FILLER                  PIC  9(03).                  ELCDTEVR
   764         10  EP-CCYY                 PIC  9(04).                  ELCDTEVR
   765         10  EP-CCYR  REDEFINES  EP-CCYY.                         ELCDTEVR
   766             15  EP-CC               PIC  99.                     ELCDTEVR
   767             15  EP-YR               PIC  99.                     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  15
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   768         10  EP-MO                   PIC  99.                     ELCDTEVR
   769         10  EP-DA                   PIC  99.                     ELCDTEVR
   770     05  WS-EP-DT-N REDEFINES                                        CL**2
   771            WS-EP-DT                 PIC 9(11).                      CL**2
   772     05  WS-DTE-CONV-DT.                                             CL**4
   773         10  FILLER                  PIC  9(03).                     CL**4
   774         10  DTE-CONV-CCYY           PIC  9(04).                     CL**4
   775         10  DTE-CONV-CCYR  REDEFINES  DTE-CONV-CCYY.                CL**4
   776             15  DTE-CONV-CC         PIC  99.                        CL**4
   777             15  DTE-CONV-YR         PIC  99.                        CL**4
   778         10  DTE-CONV-MO             PIC  99.                        CL**4
   779         10  DTE-CONV-DA             PIC  99.                        CL**4
   780     05  WS-DTE-CONV-DT-N REDEFINES                                  CL**4
   781            WS-DTE-CONV-DT           PIC  9(11).                     CL**4
   782 01  WS-BALANCE-FORWARD-DATE.                                     ELCDTEVR
   783     05  WS-BF-LAST-ACTIVITY-DATE.                                ELCDTEVR
   784         10  FILLER                            PIC 999.           ELCDTEVR
   785         10  BF-ACT-CCYY                       PIC 9(04).         ELCDTEVR
   786         10  BF-ACT-CCYR  REDEFINES  BF-ACT-CCYY.                 ELCDTEVR
   787             15  BF-ACT-CC                     PIC 99.            ELCDTEVR
   788             15  BF-ACT-YEAR                   PIC 99.            ELCDTEVR
   789         10  BF-ACT-MONTH                      PIC 99.            ELCDTEVR
   790         10  BF-ACT-DAY                        PIC 99.            ELCDTEVR
   791     05  WS-BF-LAST-ACTIVITY-DATE-N REDEFINES                        CL**2
   792            WS-BF-LAST-ACTIVITY-DATE           PIC 9(11).            CL**2
   793     05  WS-BF-CURRENT-LAST-STMT-DT.                              ELCDTEVR
   794         10  FILLER                            PIC 999.           ELCDTEVR
   795         10  BF-CURRENT-LAST-STMT-CEN          PIC 99.            ELCDTEVR
   796         10  BF-CURRENT-LAST-STMT-YEAR         PIC 99.            ELCDTEVR
   797         10  BF-CURRENT-LAST-STMT-MONTH        PIC 99.            ELCDTEVR
   798         10  BF-CURRENT-LAST-STMT-DAY          PIC 99.            ELCDTEVR
   799     05  WS-BF-CURRENT-LAST-STMT-DT-N REDEFINES                      CL**2
   800            WS-BF-CURRENT-LAST-STMT-DT        PIC 9(11).             CL**2
   801 01  WS-ADD-CONF-TRANSACTIONS-DTE.                                ELCDTEVR
   802     05  WS-AC-CERT-EFF-DATE.                                     ELCDTEVR
   803         10  FILLER                            PIC 999.           ELCDTEVR
   804         10  AC-CERT-CCYY                      PIC 9(04).         ELCDTEVR
   805         10  AC-CERT-CCYR  REDEFINES  AC-CERT-CCYY.               ELCDTEVR
   806             15  AC-CERT-CC                    PIC 99.            ELCDTEVR
   807             15  AC-CERT-YR                    PIC 99.            ELCDTEVR
   808         10  AC-CERT-MO                        PIC 99.            ELCDTEVR
   809         10  AC-CERT-DA                        PIC 99.            ELCDTEVR
   810     05  WS-AC-CERT-EFF-DATE-N REDEFINES                             CL**2
   811            WS-AC-CERT-EFF-DATE                PIC 9(11).            CL**2
   812     05  WS-AC-LIFE-CANCEL-DATE.                                  ELCDTEVR
   813         10  FILLER                            PIC 999.           ELCDTEVR
   814         10  AC-LIFE-CANCEL-CCYY               PIC 9(04).         ELCDTEVR
   815         10  AC-LIFE-CANCEL-CCYR REDEFINES AC-LIFE-CANCEL-CCYY.   ELCDTEVR
   816             15  AC-LIFE-CANCEL-CC             PIC 99.            ELCDTEVR
   817             15  AC-LIFE-CANCEL-YR             PIC 99.            ELCDTEVR
   818         10  AC-LIFE-CANCEL-MO                 PIC 99.            ELCDTEVR
   819         10  AC-LIFE-CANCEL-DA                 PIC 99.            ELCDTEVR
   820     05  WS-AC-LIFE-CANCEL-DATE-N REDEFINES                          CL**2
   821            WS-AC-LIFE-CANCEL-DATE             PIC 9(11).            CL**2
   822     05  WS-AC-AH-CANCEL-DATE.                                    ELCDTEVR
   823         10  FILLER                            PIC 999.           ELCDTEVR
   824         10  AC-AH-CANCEL-CCYY                 PIC 9(04).         ELCDTEVR
   825         10  AC-AH-CANCEL-CCYR  REDEFINES  AC-AH-CANCEL-CCYY.     ELCDTEVR
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  16
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTEVR)
   826             15  AC-AH-CANCEL-CC               PIC 99.            ELCDTEVR
   827             15  AC-AH-CANCEL-YR               PIC 99.            ELCDTEVR
   828         10  AC-AH-CANCEL-MO                   PIC 99.            ELCDTEVR
   829         10  AC-AH-CANCEL-DA                   PIC 99.            ELCDTEVR
   830     05  WS-AC-AH-CANCEL-DATE-N REDEFINES                            CL**2
   831            WS-AC-AH-CANCEL-DATE               PIC 9(11).            CL**2
   832 01  WS-RATE-RECORD.                                              ELCDTEVR
   833         05  WS-RT-EXPIRY-DATE.                                   ELCDTEVR
   834             10  FILLER                        PIC 999.           ELCDTEVR
   835             10  RT-EXP-CCYY                   PIC 9(04).         ELCDTEVR
   836             10  RT-EXP-CCYR  REDEFINES  RT-EXP-CCYY.             ELCDTEVR
   837                 15  RT-EXP-CC                 PIC 99.            ELCDTEVR
   838                 15  RT-EXP-YR                 PIC 99.            ELCDTEVR
   839             10  RT-EXP-MO                     PIC 99.            ELCDTEVR
   840             10  RT-EXP-DA                     PIC 99.            ELCDTEVR
   841         05  WS-RT-EXPIRY-DATE-N REDEFINES                           CL**2
   842                WS-RT-EXPIRY-DATE              PIC 9(11).            CL**2
*  843                                 COPY ELCDATE.
   844******************************************************************06/11/98
   845*                                                                *ELCDATE
   846*                                                                *ELCDATE
   847*                            ELCDATE.                            *   LV023
   848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL*16
   849*                            VMOD=2.003                           ELCDATE
   850*                                                                *ELCDATE
   851*                                                                *ELCDATE
   852*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *ELCDATE
   853*                 LENGTH = 200                                   *   CL*19
   854******************************************************************ELCDATE
   855                                                                  ELCDATE
   856 01  DATE-CONVERSION-DATA.                                        ELCDATE
   857     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.    CL*19
   858     12  DC-OPTION-CODE                PIC X.                        CL*15
   859         88  BIN-TO-GREG                VALUE ' '.                ELCDATE
   860         88  ELAPSED-BETWEEN-BIN        VALUE '1'.                ELCDATE
   861         88  EDIT-GREG-TO-BIN           VALUE '2'.                ELCDATE
   862         88  YMD-GREG-TO-BIN            VALUE '3'.                ELCDATE
   863         88  MDY-GREG-TO-BIN            VALUE '4'.                ELCDATE
   864         88  JULIAN-TO-BIN              VALUE '5'.                ELCDATE
   865         88  BIN-PLUS-ELAPSED           VALUE '6'.                ELCDATE
   866         88  FIND-CENTURY               VALUE '7'.                   CL*22
   867         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.                ELCDATE
   868         88  EDIT-GREG-TO-BIN-3         VALUE '9'.                ELCDATE
   869         88  YMD-GREG-TO-BIN-3          VALUE 'A'.                ELCDATE
   870         88  MDY-GREG-TO-BIN-3          VALUE 'B'.                ELCDATE
   871         88  JULIAN-TO-BIN-3            VALUE 'C'.                ELCDATE
   872         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.                ELCDATE
   873         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.                   CL*14
   874         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.                   CL*14
   875         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.                   CL*14
   876         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.         CL*14
   877         88  CHECK-LEAP-YEAR            VALUE 'H'.                   CL*14
   878         88  BIN-3-TO-GREG              VALUE 'I'.                   CL*14
   879         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.                   CL*14
   880         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.                   CL*14
   881         88  CYMD-GREG-TO-BIN           VALUE 'L'.                   CL*14
   882         88  MDCY-GREG-TO-BIN           VALUE 'M'.                   CL*14
   883         88  MDY-GREG-TO-JULIAN         VALUE 'N'.                   CL*14
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  17
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   884         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.                   CL*14
   885         88  YMD-GREG-TO-JULIAN         VALUE 'P'.                   CL*14
   886         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.                   CL*14
   887         88  THREE-CHARACTER-BIN                                  ELCDATE
   888                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.       CL*14
   889         88  GREGORIAN-TO-BIN                                        CL**2
   890                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.    CL*14
   891         88  BIN-TO-GREGORIAN                                        CL**2
   892                  VALUES ' ' '1' 'I' '8' 'G'.                        CL*14
   893         88  JULIAN-TO-BINARY                                        CL**2
   894                  VALUES '5' 'C' 'E' 'F'.                            CL*14
   895     12  DC-ERROR-CODE                 PIC X.                        CL*15
   896         88  NO-CONVERSION-ERROR        VALUE ' '.                   CL**3
   897         88  DATE-CONVERSION-ERROR                                ELCDATE
   898                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.        CL*14
   899         88  DATE-IS-ZERO               VALUE '1'.                ELCDATE
   900         88  DATE-IS-NON-NUMERIC        VALUE '2'.                ELCDATE
   901         88  DATE-IS-INVALID            VALUE '3'.                ELCDATE
   902         88  DATE1-GREATER-DATE2        VALUE '4'.                ELCDATE
   903         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.                ELCDATE
   904         88  DATE-INVALID-OPTION        VALUE '9'.                ELCDATE
   905         88  INVALID-CENTURY            VALUE 'A'.                ELCDATE
   906         88  ONLY-CENTURY               VALUE 'B'.                ELCDATE
   907         88  ONLY-LEAP-YEAR             VALUE 'C'.                ELCDATE
   908         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.              CL**3
   909     12  DC-END-OF-MONTH               PIC X.                        CL*15
   910         88  CALCULATE-END-OF-MONTH     VALUE '1'.                ELCDATE
   911     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.         CL*15
   912         88  USE-NORMAL-PROCESS         VALUE ' '.                ELCDATE
   913         88  ADJUST-DOWN-100-YRS        VALUE '1'.                ELCDATE
   914         88  ADJUST-UP-100-YRS          VALUE '2'.                ELCDATE
   915     12  FILLER                        PIC X.                        CL*15
   916     12  DC-CONVERSION-DATES.                                        CL*15
   917         16  DC-BIN-DATE-1             PIC XX.                       CL*15
   918         16  DC-BIN-DATE-2             PIC XX.                       CL*15
   919         16  DC-GREG-DATE-1-EDIT       PIC X(08).                    CL*15
   920         16  DC-GREG-DATE-1-EDIT-R REDEFINES                         CL*15
   921                       DC-GREG-DATE-1-EDIT.                       ELCDATE
   922             20  DC-EDIT1-MONTH        PIC 99.                       CL*15
   923             20  SLASH1-1              PIC X.                        CL*15
   924             20  DC-EDIT1-DAY          PIC 99.                       CL*15
   925             20  SLASH1-2              PIC X.                        CL*15
   926             20  DC-EDIT1-YEAR         PIC 99.                       CL*15
   927         16  DC-GREG-DATE-2-EDIT       PIC X(08).                    CL*15
   928         16  DC-GREG-DATE-2-EDIT-R REDEFINES                         CL*15
   929                     DC-GREG-DATE-2-EDIT.                         ELCDATE
   930             20  DC-EDIT2-MONTH        PIC 99.                       CL*15
   931             20  SLASH2-1              PIC X.                        CL*15
   932             20  DC-EDIT2-DAY          PIC 99.                       CL*15
   933             20  SLASH2-2              PIC X.                        CL*15
   934             20  DC-EDIT2-YEAR         PIC 99.                       CL*15
   935         16  DC-GREG-DATE-1-YMD        PIC 9(06).                    CL*15
   936         16  DC-GREG-DATE-1-YMD-R  REDEFINES                         CL*15
   937                     DC-GREG-DATE-1-YMD.                          ELCDATE
   938             20  DC-YMD-YEAR           PIC 99.                       CL*15
   939             20  DC-YMD-MONTH          PIC 99.                       CL*15
   940             20  DC-YMD-DAY            PIC 99.                       CL*15
   941         16  DC-GREG-DATE-1-MDY        PIC 9(06).                    CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  18
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
   942         16  DC-GREG-DATE-1-MDY-R REDEFINES                          CL*15
   943                      DC-GREG-DATE-1-MDY.                         ELCDATE
   944             20  DC-MDY-MONTH          PIC 99.                       CL*15
   945             20  DC-MDY-DAY            PIC 99.                       CL*15
   946             20  DC-MDY-YEAR           PIC 99.                       CL*15
   947         16  DC-GREG-DATE-1-ALPHA.                                   CL*15
   948             20  DC-ALPHA-MONTH        PIC X(10).                    CL*15
   949             20  DC-ALPHA-DAY          PIC 99.                       CL*15
   950             20  FILLER                PIC XX.                       CL*15
   951             20  DC-ALPHA-CENTURY.                                   CL*15
   952                 24 DC-ALPHA-CEN-N     PIC 99.                       CL*15
   953             20  DC-ALPHA-YEAR         PIC 99.                       CL*15
   954         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.           CL*15
   955         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.           CL*15
   956         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.           CL*15
   957         16  DC-JULIAN-DATE            PIC 9(05).                    CL*15
   958         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE                CL*20
   959                                       PIC 9(05).                    CL*20
   960         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.                  CL*15
   961             20  DC-JULIAN-YEAR        PIC 99.                       CL*15
   962             20  DC-JULIAN-DAYS        PIC 999.                      CL*15
   963         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.       CL*15
   964         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.    CL*15
   965         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.    CL*15
   966     12  DATE-CONVERSION-VARIBLES.                                   CL*15
   967         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.            CL*15
   968         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.          CL*15
   969             20  FILLER                PIC 9(3).                     CL*15
   970             20  HOLD-CEN-1-CCYY.                                    CL*15
   971                 24  HOLD-CEN-1-CC     PIC 99.                       CL*17
   972                 24  HOLD-CEN-1-YY     PIC 99.                       CL*17
   973             20  HOLD-CEN-1-MO         PIC 99.                       CL*17
   974             20  HOLD-CEN-1-DA         PIC 99.                       CL*17
   975         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.            CL*15
   976             20  HOLD-CEN-1-R-MO       PIC 99.                       CL*17
   977             20  HOLD-CEN-1-R-DA       PIC 99.                       CL*17
   978             20  HOLD-CEN-1-R-CCYY.                                  CL*15
   979                 24  HOLD-CEN-1-R-CC   PIC 99.                       CL*17
   980                 24  HOLD-CEN-1-R-YY   PIC 99.                       CL*17
   981             20  FILLER                PIC 9(3).                     CL*15
   982         16  HOLD-CENTURY-1-X.                                       CL*15
   983             20  FILLER                PIC X(3)  VALUE SPACES.       CL*15
   984             20  HOLD-CEN-1-X-CCYY.                                  CL*15
   985                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.          CL*17
   986                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.          CL*17
   987             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.          CL*17
   988             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.          CL*17
   989         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.          CL*15
   990             20  HOLD-CEN-1-R-X-MO     PIC XX.                       CL*17
   991             20  HOLD-CEN-1-R-X-DA     PIC XX.                       CL*17
   992             20  HOLD-CEN-1-R-X-CCYY.                                CL*15
   993                 24  HOLD-CEN-1-R-X-CC PIC XX.                       CL*17
   994                 24  HOLD-CEN-1-R-X-YY PIC XX.                       CL*17
   995             20  FILLER                PIC XXX.                      CL*23
   996         16  DC-BIN-DATE-EXPAND-1      PIC XXX.                      CL*15
   997         16  DC-BIN-DATE-EXPAND-2      PIC XXX.                      CL*15
   998         16  DC-JULIAN-DATE-1          PIC 9(07).                    CL*15
   999         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.          CL*15
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  19
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDATE)
  1000             20  DC-JULIAN-1-CCYY.                                   CL*15
  1001                 24  DC-JULIAN-1-CC    PIC 99.                       CL*15
  1002                 24  DC-JULIAN-1-YR    PIC 99.                       CL*15
  1003             20  DC-JULIAN-DA-1        PIC 999.                      CL*15
  1004         16  DC-JULIAN-DATE-2          PIC 9(07).                    CL*15
  1005         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.          CL*15
  1006             20  DC-JULIAN-2-CCYY.                                   CL*15
  1007                 24  DC-JULIAN-2-CC    PIC 99.                       CL*15
  1008                 24  DC-JULIAN-2-YR    PIC 99.                       CL*15
  1009             20  DC-JULIAN-DA-2        PIC 999.                      CL*15
  1010         16  DC-GREG-DATE-A-EDIT.                                    CL*15
  1011             20  DC-EDITA-MONTH        PIC 99.                       CL*15
  1012             20  SLASHA-1              PIC X VALUE '/'.              CL*15
  1013             20  DC-EDITA-DAY          PIC 99.                       CL*15
  1014             20  SLASHA-2              PIC X VALUE '/'.              CL*15
  1015             20  DC-EDITA-CCYY.                                      CL*15
  1016                 24  DC-EDITA-CENT     PIC 99.                       CL*15
  1017                 24  DC-EDITA-YEAR     PIC 99.                       CL*15
  1018         16  DC-GREG-DATE-B-EDIT.                                    CL*15
  1019             20  DC-EDITB-MONTH        PIC 99.                       CL*15
  1020             20  SLASHB-1              PIC X VALUE '/'.              CL*15
  1021             20  DC-EDITB-DAY          PIC 99.                       CL*15
  1022             20  SLASHB-2              PIC X VALUE '/'.              CL*15
  1023             20  DC-EDITB-CCYY.                                      CL*15
  1024                 24  DC-EDITB-CENT     PIC 99.                       CL*15
  1025                 24  DC-EDITB-YEAR     PIC 99.                       CL*15
  1026         16  DC-GREG-DATE-CYMD         PIC 9(08).                    CL*15
  1027         16  DC-GREG-DATE-CYMD-R REDEFINES                           CL*15
  1028                              DC-GREG-DATE-CYMD.                  ELCDATE
  1029             20  DC-CYMD-CEN           PIC 99.                       CL*15
  1030             20  DC-CYMD-YEAR          PIC 99.                       CL*15
  1031             20  DC-CYMD-MONTH         PIC 99.                       CL*15
  1032             20  DC-CYMD-DAY           PIC 99.                       CL*15
  1033         16  DC-GREG-DATE-MDCY         PIC 9(08).                    CL*15
  1034         16  DC-GREG-DATE-MDCY-R REDEFINES                           CL*15
  1035                              DC-GREG-DATE-MDCY.                  ELCDATE
  1036             20  DC-MDCY-MONTH         PIC 99.                       CL*15
  1037             20  DC-MDCY-DAY           PIC 99.                       CL*15
  1038             20  DC-MDCY-CEN           PIC 99.                       CL*15
  1039             20  DC-MDCY-YEAR          PIC 99.                       CL*15
  1040    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.      ELCDATE
  1041        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.        ELCDATE
  1042    12  DC-EL310-DATE                  PIC X(21).                    CL*26
  1043    12  FILLER                         PIC X(28).                    CL*26
  1044
  1045 procedure division.
* 1046                                 COPY ELCDTERX.
  1047******************************************************************04/15/98
  1048*                                                                *ELCDTERX
  1049*                                                                *ELCDTERX
  1050*                            ELCDTERX.                           *   LV002
  1051*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1052*                            VMOD=2.007                          *ELCDTERX
  1053*                                                                *ELCDTERX
  1054*      LOAD DATE CARD DISK FILE INTO WORKING STORAGE AREA        *ELCDTERX
  1055*      (COPY CODE FOR W/S = ELCDTECX AND COPY CODE FOR FD        *ELCDTERX
  1056*      = ELCDTEFD)                                               *ELCDTERX
  1057*                                                                *ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  20
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1058******************************************************************ELCDTERX
  1059                                                                  ELCDTERX
  1060     ACCEPT WS-ACCEPT-DATE       FROM  DATE.                      ELCDTERX
  1061                                                                  ELCDTERX
  1062     MOVE WS-AD-YY               TO  WS-CD-YY.                    ELCDTERX
  1063     MOVE WS-AD-MM               TO  WS-CD-MM.                    ELCDTERX
  1064     MOVE WS-AD-DD               TO  WS-CD-DD.                    ELCDTERX
  1065                                                                  ELCDTERX
  1066     ACCEPT WS-TIME-OF-DAY       FROM  TIME.                      ELCDTERX
  1067                                                                  ELCDTERX
  1068******************************************************************ELCDTERX
  1069*    NOTE: THE FOLLOWING STATEMENT IS USED TO ELIMINATE COB II    ELCDTERX
  1070*          WARNING MESSAGES.                                      ELCDTERX
  1071******************************************************************ELCDTERX
  1072     IF WS-CD-YY = LOW-VALUES                                     ELCDTERX
  1073         COMPUTE PGM-SUB = PGM-SUB + 1.                           ELCDTERX
  1074                                                                  ELCDTERX
  1075     OPEN INPUT DISK-DATE.                                        ELCDTERX
  1076                                                                  ELCDTERX
  1077     MOVE SPACE TO DATE-CARD         CLAS-BUSINESS-CLASSES        ELCDTERX
  1078                   STATE-NAMES       CLAS-MORTALITY-CODES         ELCDTERX
  1079                   CLAS-INS-TYPES    COMPANY-NAME-TABLE           ELCDTERX
  1080                   DATE-CARD-OPTIONS DATE-CARD-FACTORS            ELCDTERX
  1081                   CLAX-ID           CLAS-MISC                    ELCDTERX
  1082                   CARRIER-NAMES     CLASIC-SYSTEM-CODES          ELCDTERX
  1083                   CARRIER-OPT-CLAIM-DATA                         ELCDTERX
  1084                   STATE-TARGET-LOSS-RATIOS                       ELCDTERX
  1085                   BUSINESS-TRGT-LOSS-RATIO-MODS                  ELCDTERX
  1086                   MISC-OPT-CLM-RSV-DATA.                         ELCDTERX
  1087                                                                  ELCDTERX
  1088     MOVE LOW-VALUES TO CLAS-INDEX-TBL CLAS-TYPE-MISC.            ELCDTERX
  1089                                                                  ELCDTERX
  1090     MOVE ZERO TO CLAS-CN DTE-TOT-LINES CLAS-CO                   ELCDTERX
  1091                  INDEXCA INDEXBS INDEXST.                        ELCDTERX
  1092                                                                  ELCDTERX
  1093     COMPUTE CLAS-CN = PGM-SUB / +50.                             ELCDTERX
  1094     COMPUTE CLAS-CO = PGM-SUB / +20.                             ELCDTERX
  1095     COMPUTE CLAS-INDEXEN = PGM-SUB - (CLAS-CN * +50).            ELCDTERX
  1096     COMPUTE CLAS-INDEXON = PGM-SUB - (CLAS-CO * +20).            ELCDTERX
  1097                                                                  ELCDTERX
  1098     IF CLAS-INDEXEN = ZERO                                       ELCDTERX
  1099         MOVE +50               TO CLAS-INDEXEN                   ELCDTERX
  1100     ELSE                                                         ELCDTERX
  1101         ADD +1                 TO CLAS-CN.                       ELCDTERX
  1102                                                                  ELCDTERX
  1103     IF CLAS-INDEXON = ZERO                                       ELCDTERX
  1104         MOVE +20               TO CLAS-INDEXON                   ELCDTERX
  1105     ELSE                                                         ELCDTERX
  1106         ADD +1                 TO CLAS-CO.                       ELCDTERX
  1107                                                                  ELCDTERX
  1108 0005-READ--CARD.                                                 ELCDTERX
  1109     READ DISK-DATE                                               ELCDTERX
  1110         AT END CLOSE DISK-DATE                                   ELCDTERX
  1111             GO TO 0060-READ--TEST.                               ELCDTERX
  1112                                                                  ELCDTERX
  1113     MOVE ZERO                   TO CLAS-INDEX.                   ELCDTERX
  1114                                                                  ELCDTERX
  1115     IF DD-ID = 'CLAS' OR 'LIFE' OR 'GLED'                        ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  21
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1116         MOVE DATE-DISK          TO DATE-CARD                     ELCDTERX
  1117         MOVE RUN-DATE           TO WS-RUN-DATE-N                    CL**2
  1118         MOVE EP-DT              TO WS-EP-DT-N                       CL**2
  1119         GO TO 0005-READ--CARD.                                   ELCDTERX
  1120                                                                  ELCDTERX
  1121     IF DD-ID = 'CLAD'                                            ELCDTERX
  1122         MOVE DATE-DISK          TO DATE-CARD-OPTIONS             ELCDTERX
  1123         GO TO 0005-READ--CARD.                                   ELCDTERX
  1124                                                                  ELCDTERX
  1125     IF DD-ID = 'CLAX'                                            ELCDTERX
  1126         MOVE DATE-DISK          TO CLAS-INDEX-TBL                ELCDTERX
  1127         GO TO 0005-READ--CARD.                                   ELCDTERX
  1128                                                                  ELCDTERX
  1129     IF DD-ID = 'CLAF'                                            ELCDTERX
  1130         MOVE DATE-DISK          TO DATE-CARD-FACTORS             ELCDTERX
  1131         GO TO 0005-READ--CARD.                                   ELCDTERX
  1132                                                                  ELCDTERX
  1133     IF DD-ID = 'CLAC'                                            ELCDTERX
  1134         GO TO 0010-READ--CLAC.                                   ELCDTERX
  1135                                                                  ELCDTERX
  1136     IF DD-ID = 'CARR'                                            ELCDTERX
  1137         GO TO 0015-READ--CARR.                                   ELCDTERX
  1138                                                                  ELCDTERX
  1139     IF DD-ID = 'STAT'                                            ELCDTERX
  1140         GO TO 0020-READ--STAT.                                   ELCDTERX
  1141                                                                  ELCDTERX
  1142     IF DD-ID = 'BUSC'                                            ELCDTERX
  1143         GO TO 0025-READ--BUSC.                                   ELCDTERX
  1144                                                                  ELCDTERX
  1145     IF DD-ID = 'MORT'                                            ELCDTERX
  1146         GO TO 0030-READ--MORT.                                   ELCDTERX
  1147                                                                  ELCDTERX
  1148     IF DD-ID = 'CLAI'                                            ELCDTERX
  1149         GO TO 0040-READ--CLAI.                                   ELCDTERX
  1150                                                                  ELCDTERX
  1151     IF DD-ID = 'COLC'                                            ELCDTERX
  1152         GO TO 0065-READ--COLC.                                   ELCDTERX
  1153                                                                  ELCDTERX
  1154     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1155        DD-IDA = 'CL'                                             ELCDTERX
  1156         GO TO 0035-READ--CLXX.                                   ELCDTERX
  1157                                                                  ELCDTERX
  1158     IF DD-IDX NUMERIC AND                                        ELCDTERX
  1159        DD-IDA = 'PO'                                             ELCDTERX
  1160         GO TO 0050-READ--POXX.                                   ELCDTERX
  1161                                                                  ELCDTERX
  1162     IF DD-ID = 'OPCA'                                            ELCDTERX
  1163         GO TO 0070-READ--OPCA.                                   ELCDTERX
  1164                                                                  ELCDTERX
  1165     IF DD-ID = 'OPST'                                            ELCDTERX
  1166         GO TO 0072-READ--OPST.                                   ELCDTERX
  1167                                                                  ELCDTERX
  1168     IF DD-ID = 'OPBS'                                            ELCDTERX
  1169         GO TO 0074-READ--OPBS.                                   ELCDTERX
  1170                                                                  ELCDTERX
  1171     IF DD-ID = 'OPMS'                                            ELCDTERX
  1172         MOVE DD-MISC-DATA       TO MISC-OPT-CLM-RSV-DATA.        ELCDTERX
  1173                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  22
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1174     GO TO 0005-READ--CARD.                                       ELCDTERX
  1175                                                                  ELCDTERX
  1176 0010-READ--CLAC.                                                 ELCDTERX
  1177     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1178     MOVE DD-CR1                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1179     MOVE DD-CR1N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1180     ADD 1                       TO CLAS-INDEXC.                  ELCDTERX
  1181     MOVE DD-CR2                 TO CNT-ID (CLAS-INDEXC).         ELCDTERX
  1182     MOVE DD-CR2N                TO CNT-NAME (CLAS-INDEXC).       ELCDTERX
  1183     GO TO 0005-READ--CARD.                                       ELCDTERX
  1184                                                                  ELCDTERX
  1185 0015-READ--CARR.                                                 ELCDTERX
  1186     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1187     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1188        MOVE DD-CARR1         TO CARRIER-SUB (CLAS-INDEXCN)
  1189        MOVE DD-CARR1S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1190        MOVE DD-CARR1N        TO CARRIER-PIC (CLAS-INDEXCN)
  1191        MOVE DD-CARR1-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1192        MOVE DD-CARR1-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1193        MOVE DD-CARR1-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1194        MOVE DD-CARR1-SECPAY-SW
  1195                               TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1196     END-IF
  1197                                                                  ELCDTERX
  1198     ADD 1  TO  CLAS-INDEXCN.                                     ELCDTERX
  1199     IF CLAS-INDEXCN LESS THAN +26                                ELCDTERX
  1200        MOVE DD-CARR2         TO CARRIER-SUB (CLAS-INDEXCN)
  1201        MOVE DD-CARR2S        TO CARRIER-DOM-ST (CLAS-INDEXCN)
  1202        MOVE DD-CARR2N        TO CARRIER-PIC (CLAS-INDEXCN)
  1203        MOVE DD-CARR2-UEP-PCT TO CARRIER-UEP-PCT (CLAS-INDEXCN)
  1204        MOVE DD-CARR2-R78-PCT TO CARRIER-R78-PCT (CLAS-INDEXCN)
  1205        MOVE DD-CARR2-PRO-PCT TO CARRIER-PRO-PCT (CLAS-INDEXCN)
  1206        MOVE DD-CARR2-SECPAY-SW
  1207                              TO CARRIER-SEC-PAY (CLAS-INDEXCN)
  1208     END-IF
  1209                                                                  ELCDTERX
  1210                                                                  ELCDTERX
  1211     GO TO 0005-READ--CARD.                                       ELCDTERX
  1212                                                                  ELCDTERX
  1213 0020-READ--STAT.                                                 ELCDTERX
  1214     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1215     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1216        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1217         GO TO 0005-READ--CARD.                                   ELCDTERX
  1218                                                                  ELCDTERX
  1219     ADD 1                       TO CLAS-INDEXS.                  ELCDTERX
  1220     MOVE DD-ST (CLAS-INDEX)     TO STATE-NAME-FLD (CLAS-INDEXS). ELCDTERX
  1221     GO TO 0020-READ--STAT.                                       ELCDTERX
  1222                                                                  ELCDTERX
  1223 0025-READ--BUSC.                                                 ELCDTERX
  1224     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1225     IF CLAS-INDEX GREATER 3  OR                                  ELCDTERX
  1226        DD-ST (CLAS-INDEX) = SPACE                                ELCDTERX
  1227         GO TO 0005-READ--CARD.                                   ELCDTERX
  1228                                                                  ELCDTERX
  1229     ADD 1                       TO CLAS-INDEXB.                  ELCDTERX
  1230     MOVE DD-ST (CLAS-INDEX)     TO CLAS-BUSC-FLD (CLAS-INDEXB).  ELCDTERX
  1231     GO TO 0025-READ--BUSC.                                       ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  23
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1232                                                                  ELCDTERX
  1233 0030-READ--MORT.                                                 ELCDTERX
  1234     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1235     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1236        DD-MORT (CLAS-INDEX) = SPACE                              ELCDTERX
  1237         GO TO 0005-READ--CARD.                                   ELCDTERX
  1238                                                                  ELCDTERX
  1239     ADD 1                       TO CLAS-INDEXM.                  ELCDTERX
  1240     MOVE DD-MORT (CLAS-INDEX)   TO CLAS-MORT-FLD (CLAS-INDEXM).  ELCDTERX
  1241     GO TO 0030-READ--MORT.                                       ELCDTERX
  1242                                                                  ELCDTERX
  1243 0035-READ--CLXX.                                                 ELCDTERX
  1244     IF DD-IDX NOT = CLAS-CN                                      ELCDTERX
  1245          GO TO 0005-READ--CARD.                                  ELCDTERX
  1246                                                                  ELCDTERX
  1247     IF DD-PS-PIC (CLAS-INDEXEN) = 'X'                            ELCDTERX
  1248         DISPLAY '***********************************************'ELCDTERX
  1249         DISPLAY 'PROGRAM ECS-', PGM-SUB, ' NOT SCHEDULED TO RUN' ELCDTERX
  1250         DISPLAY '***********************************************'ELCDTERX
  1251         GO TO 0055-READ--STOP.                                   ELCDTERX
  1252                                                                  ELCDTERX
  1253     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'A'  AND                ELCDTERX
  1254        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'I'                  ELCDTERX
  1255         MOVE '1'                TO DTE-FICH.                     ELCDTERX
  1256                                                                  ELCDTERX
  1257     IF DD-PS-PIC (CLAS-INDEXEN) NOT LESS 'J'  AND                ELCDTERX
  1258        DD-PS-PIC (CLAS-INDEXEN) NOT GREATER 'R'                  ELCDTERX
  1259         MOVE '2'                TO DTE-FICH.                     ELCDTERX
  1260                                                                  ELCDTERX
  1261*    MOVE DD-PS-PIC (CLAS-INDEXEN) TO DTE-PGM-OPT.                ELCDTERX
  1262     GO TO 0005-READ--CARD.                                       ELCDTERX
  1263                                                                  ELCDTERX
  1264 0040-READ--CLAI.                                                 ELCDTERX
  1265     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1266     IF CLAS-INDEX GREATER 2  OR                                  ELCDTERX
  1267        DD-TYPE (CLAS-INDEX) = SPACE                              ELCDTERX
  1268         GO TO 0005-READ--CARD.                                   ELCDTERX
  1269                                                                  ELCDTERX
  1270     ADD 1                       TO CLAS-INDEXA.                  ELCDTERX
  1271     MOVE DD-TYPE (CLAS-INDEX) TO CLAS-ALL-TYPES (CLAS-INDEXA).   ELCDTERX
  1272     GO TO 0040-READ--CLAI.                                       ELCDTERX
  1273                                                                  ELCDTERX
  1274 0045-READ--DUMP.                                                 ELCDTERX
  1275     MOVE +999 TO WS-RETURN-CODE                                  ELCDTERX
  1276     MOVE 'MISSING AND/OR INVALID CLAS DATE CARD'                 ELCDTERX
  1277                                 TO  WS-ABEND-MESSAGE             ELCDTERX
  1278     PERFORM ABEND-PGM.                                           ELCDTERX
  1279                                                                  ELCDTERX
  1280 0050-READ--POXX.                                                 ELCDTERX
  1281     IF DD-IDX NOT = CLAS-CO                                      ELCDTERX
  1282         GO TO 0005-READ--CARD.                                   ELCDTERX
  1283                                                                  ELCDTERX
  1284     IF DD-PS-PRC (CLAS-INDEXON) = 'X'                            ELCDTERX
  1285         DISPLAY '***********************************************'ELCDTERX
  1286         DISPLAY 'ECS - ', PGM-SUB, ' IS NOT SCHEDULED TO RUN'    ELCDTERX
  1287         DISPLAY '***********************************************'ELCDTERX
  1288         GO TO 0055-READ--STOP.                                   ELCDTERX
  1289                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  24
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1290     MOVE DD-PS-PRT (CLAS-INDEXON) TO DTE-PRT-OPT.                ELCDTERX
  1291     MOVE DD-PS-FMT (CLAS-INDEXON) TO DTE-FMT-OPT.                ELCDTERX
  1292     MOVE DD-PS-PRC (CLAS-INDEXON) TO DTE-PRC-OPT DTE-PGM-OPT.    ELCDTERX
  1293     MOVE DD-PS-TOT (CLAS-INDEXON) TO DTE-TOT-OPT.                ELCDTERX
  1294                                                                  ELCDTERX
  1295     IF DTE-PRT-OPT = 'B'                                         ELCDTERX
  1296         MOVE '2'                  TO DTE-FICH.                   ELCDTERX
  1297     IF DTE-PRT-OPT = 'F'                                         ELCDTERX
  1298         MOVE '1'                  TO DTE-FICH.                   ELCDTERX
  1299                                                                  ELCDTERX
  1300     GO TO 0005-READ--CARD.                                       ELCDTERX
  1301                                                                  ELCDTERX
  1302 0055-READ--STOP.                                                 ELCDTERX
  1303     GOBACK.                                                      ELCDTERX
  1304                                                                  ELCDTERX
  1305 0060-READ--TEST.                                                 ELCDTERX
  1306     IF DATX-COD        = SPACE  OR                               ELCDTERX
  1307        CLAX-ID         = SPACE  OR                               ELCDTERX
  1308        DATE-OPTIONS-ID = SPACE                                   ELCDTERX
  1309         GO TO 0045-READ--DUMP.                                   ELCDTERX
  1310                                                                  ELCDTERX
  1311     MOVE LOW-VALUE TO CLAS-TYPE-MISC.                            ELCDTERX
  1312     GO TO 0079-READ--EXIT.                                       ELCDTERX
  1313                                                                  ELCDTERX
  1314 0065-READ--COLC.                                                 ELCDTERX
  1315     MOVE DATE-DISK              TO CLASIC-SYSTEM-CODES.          ELCDTERX
  1316     GO TO 0005-READ--CARD.                                       ELCDTERX
  1317                                                                  ELCDTERX
  1318 0070-READ--OPCA.                                                 ELCDTERX
  1319                                                                  ELCDTERX
  1320     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1321                                                                  ELCDTERX
  1322     IF  CLAS-INDEX GREATER 13                                    ELCDTERX
  1323             OR                                                   ELCDTERX
  1324         DD-CARR-FLDS (CLAS-INDEX) = SPACE                        ELCDTERX
  1325         GO TO 0005-READ--CARD.                                   ELCDTERX
  1326                                                                  ELCDTERX
  1327     ADD 1                       TO INDEXCA.                      ELCDTERX
  1328     MOVE DD-CARR-FLDS (CLAS-INDEX)                               ELCDTERX
  1329                                 TO CARRIER-FLDS (INDEXCA).       ELCDTERX
  1330     GO TO 0070-READ--OPCA.                                       ELCDTERX
  1331                                                                  ELCDTERX
  1332 0072-READ--OPST.                                                 ELCDTERX
  1333                                                                  ELCDTERX
  1334     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1335                                                                  ELCDTERX
  1336     IF  CLAS-INDEX GREATER 16                                    ELCDTERX
  1337             OR                                                   ELCDTERX
  1338         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1339         GO TO 0005-READ--CARD.                                   ELCDTERX
  1340                                                                  ELCDTERX
  1341     ADD 1                       TO INDEXST.                      ELCDTERX
  1342     MOVE DD-STATE-FLDS (CLAS-INDEX)                              ELCDTERX
  1343                                 TO STATE-TLR-FLD (INDEXST).      ELCDTERX
  1344     GO TO 0072-READ--OPST.                                       ELCDTERX
  1345                                                                  ELCDTERX
  1346 0074-READ--OPBS.                                                 ELCDTERX
  1347                                                                  ELCDTERX
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  25
* SQLDCCGAAP.cbl (/apps/prod/cid1p/copy/ELCDTERX)
  1348     ADD 1                       TO CLAS-INDEX.                   ELCDTERX
  1349                                                                  ELCDTERX
  1350     IF  CLAS-INDEX GREATER 32                                    ELCDTERX
  1351             OR                                                   ELCDTERX
  1352         DD-TLR (CLAS-INDEX) = SPACE                              ELCDTERX
  1353         GO TO 0005-READ--CARD.                                   ELCDTERX
  1354                                                                  ELCDTERX
  1355     ADD 1                       TO INDEXBS.                      ELCDTERX
  1356     MOVE DD-TLR (CLAS-INDEX)    TO BUS-TLRM-FLD (INDEXBS).       ELCDTERX
  1357     GO TO 0074-READ--OPBS.                                       ELCDTERX
  1358                                                                  ELCDTERX
  1359 0079-READ--EXIT.                                                 ELCDTERX
  1360*    EXIT.                                                        ELCDTERX
  1361******************************************************************ELCDTERX
  1362 0000-begin.
  1363
  1364     display ' Begin Program '
  1365     perform 0010-init           thru 0010-exit
  1366     perform 0020-connect        thru 0020-exit
  1367*    perform 0030-drop-table     thru 0030-exit
  1368*    perform 0040-create-table   thru 0040-exit
  1369     open input file-in
  1370
  1371     EXEC SQL
  1372        SET AUTOCOMMIT OFF
  1373     END-EXEC
  1374
  1375     perform 0046-read-input     thru 0046-exit
  1376     perform 0045-process-input  thru 0045-exit until
  1377        end-of-input
  1378*      or ws-recs-in > 10000
  1379
  1380     perform 0055-update-table   thru 0055-exit
  1381     perform 0060-finish-up      thru 0060-exit
  1382     close file-in
  1383     display ' End Program '
  1384     display ' rows inserted ' rec-cnt
  1385     display ' records read  ' ws-recs-in
  1386     goback
  1387
  1388     .
  1389 0010-init.
  1390
  1391     move 'NTCSO2_Logic'         to svr
  1392     move 'sa'                   to usr
  1393     move 'ntcso2'               to pass
  1394
  1395*    move 'NTCSO2TST_Logic'      to svr
  1396*    move 'sa'                   to usr
  1397*    move 'ntcso2'               to pass
  1398
  1399     MOVE BIN-RUN-DATE           TO DC-BIN-DATE-1
  1400     MOVE    ' '                 TO DC-OPTION-CODE
  1401     PERFORM 8500-DATE-CONVERT   THRU 8590-EXIT
  1402     move dc-greg-date-a-edit    to ws-moe-date
  1403
  1404     .
  1405 0010-exit.
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  26
* SQLDCCGAAP.cbl
  1406     exit.
  1407
  1408 0020-connect.
  1409
  1410     display 'Begin connect to DB '
  1411     string
  1412         usr delimited space
  1413         "." delimited size
  1414         pass delimited space into usr-pass
  1415     end-string
  1416
  1417     display ' usr pass ' usr-pass
  1418
  1419     EXEC SQL
  1420        CONNECT TO :svr USER :usr-pass
  1421     END-EXEC
  1422
  1423     if sqlcode not = 0
  1424        display "Error: cannot connect "
  1425        display sqlcode
  1426        display sqlerrmc
  1427        goback
  1428     end-if
  1429
  1430     display " connect to DB successful "
  1431
  1432     .
  1433 0020-exit.
  1434     exit.
  1435
  1436 0030-drop-table.
  1437
  1438     display 'Begin Drop table'
  1439     EXEC SQL
  1440         drop table DCC_GAAP_DW
  1441     END-EXEC
  1442     if sqlcode not = 0
  1443        display "Error(anticipated) : cannot drop table "
  1444        display sqlcode
  1445        display sqlerrmc
  1446*       goback
  1447     end-if
  1448
  1449     display ' sql return code ' sqlcode
  1450     display ' sql err mess    ' sqlerrmc
  1451
  1452     .
  1453 0030-exit.
  1454     exit.
  1455
  1456 0040-create-table.
  1457
  1458     display ' Begin Create table'
  1459
  1460     EXEC SQL
  1461        create table DCC_GAAP_DW (
  1462             moe_date datetime not null,
  1463             rein_co char(3),
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  27
* SQLDCCGAAP.cbl
  1464             rein_sub char(3),
  1465             carrier char(1) not null,
  1466             grouping char(6) not null,
  1467             state char(2) not null,
  1468             account char(10) not null,
  1469             eff datetime not null,
  1470             cert_no char(11) not null,
  1471             lftyp char(2),
  1472             lf_term int,
  1473             lf_remterm int ,
  1474             lfben decimal(11,2),
  1475             lfprm decimal(9,2),
  1476             ahtyp char(2),
  1477             ah_term int,
  1478             ah_remterm int,
  1479             ahben decimal(9,2),
  1480             ahprm decimal(9,2),
  1481             rem_amt decimal(10,2),
  1482             plfprm decimal(9,2),
  1483             rlfprm decimal(9,2),
  1484             slfprm decimal(9,2),
  1485             pahprm decimal(9,2),
  1486             rahprm decimal(9,2),
  1487             sahprm decimal(9,2),
  1488             rein char(1),
  1489             ah_rem_ben decimal(11,2),
  1490             mort_resv decimal(9,2),
  1491             sex_code char(1),
  1492             loan_term int,
  1493             lf_exp_dt datetime,
  1494             ah_exp_dt datetime,
  1495             lf_up_remterm int,
  1496             ah_up_remterm int,
  1497             unld_stat_resv decimal(9,2),
  1498             lfcom decimal(9,2),
  1499             plfcom decimal(9,2),
  1500             rlfcom decimal(9,2),
  1501             slfcom decimal(9,2),
  1502             ahcom decimal(9,2),
  1503             pahcom decimal(9,2),
  1504             rahcom decimal(9,2),
  1505             sahcom decimal(9,2),
  1506             mo_dec decimal(9,2),
  1507             mort_fact decimal(9,4),
  1508             mort_age int,
  1509             mort_table char(4),
  1510             alt_mort_table char(4)
  1511           CONSTRAINT PK_DCC_GAAP_DW PRIMARY KEY CLUSTERED
  1512             (moe_date, rein_co, rein_sub, carrier, grouping,
  1513             state, account, eff, cert_no)
  1514             )
  1515     END-EXEC
  1516
  1517     if sqlcode not = 0
  1518        display "Error: cannot create table "
  1519        move sqlcode             to ws-disp-code
  1520        display ' sql return code ' ws-disp-code
  1521        display ' sql err mess    ' sqlerrmc
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  28
* SQLDCCGAAP.cbl
  1522        goback
  1523     end-if
  1524
  1525     display " Create table successful "
  1526
  1527     .
  1528 0040-exit.
  1529     exit.
  1530
  1531 0045-process-input.
  1532
  1533     perform 0050-insert-row     thru 0050-exit
  1534     perform 0046-read-input     thru 0046-exit
  1535
  1536     .
  1537 0045-exit.
  1538     exit.
  1539
  1540 0046-read-input.
  1541
  1542     read file-in at end
  1543        set end-of-input         to true
  1544     end-read
  1545
  1546     if not end-of-input
  1547        move file-in-rec         to gaap-detail-record
  1548        add 1                    to ws-recs-in
  1549     end-if
  1550
  1551
  1552     .
  1553 0046-exit.
  1554     exit.
  1555
  1556 0050-insert-row.
  1557
  1558*    display ' Begin Insert row '
  1559
  1560     EXEC SQL
  1561        insert into DCC_GAAP_DW (
  1562             MOE_DATE,
  1563             REIN_CO,
  1564             REIN_SUB,
  1565             CARRIER,
  1566             GROUPING,
  1567             STATE,
  1568             ACCOUNT,
  1569             EFF,
  1570             CERT_NO,
  1571             LFTYP,
  1572             LF_TERM,
  1573             LF_REMTERM,
  1574             LFBEN,
  1575             LFPRM,
  1576             AHTYP,
  1577             AH_TERM,
  1578             AH_REMTERM,
  1579             AHBEN,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  29
* SQLDCCGAAP.cbl
  1580             AHPRM,
  1581             REM_AMT,
  1582             PLFPRM,
  1583             RLFPRM,
  1584             SLFPRM,
  1585             PAHPRM,
  1586             RAHPRM,
  1587             SAHPRM,
  1588             REIN,
  1589             AH_REM_BEN,
  1590             MORT_RESV,
  1591             SEX_CODE,
  1592             LOAN_TERM,
  1593             LF_EXP_DT,
  1594             AH_EXP_DT,
  1595             LF_UP_REMTERM,
  1596             AH_UP_REMTERM,
  1597             UNLD_STAT_RESV,
  1598             LFCOM,
  1599             PLFCOM,
  1600             RLFCOM,
  1601             SLFCOM,
  1602             AHCOM,
  1603             PAHCOM,
  1604             RAHCOM,
  1605             SAHCOM,
  1606             MO_DEC,
  1607             MORT_FACT,
  1608             MORT_AGE,
  1609             MORT_TABLE,
  1610             ALT_MORT_TABLE)
  1611                values (
  1612             :WS-MOE-DATE,
  1613             :EX-REIN-CO,
  1614             :EX-REIN-SUB,
  1615             :EX-CARRIER,
  1616             :EX-GROUPING,
  1617             :EX-STATE,
  1618             :EX-ACCOUNT,
  1619             :EX-EFF,
  1620             :EX-CERT-NO,
  1621             :EX-LFTYP,
  1622             :EX-LF-TERM,
  1623             :EX-LF-REMTERM,
  1624             :EX-LFBEN,
  1625             :EX-LFPRM,
  1626             :EX-AHTYP,
  1627             :EX-AH-TERM,
  1628             :EX-AH-REMTERM,
  1629             :EX-AHBEN,
  1630             :EX-AHPRM,
  1631             :EX-REM-AMT,
  1632             :EX-PLFPRM,
  1633             :EX-RLFPRM,
  1634             :EX-SLFPRM,
  1635             :EX-PAHPRM,
  1636             :EX-RAHPRM,
  1637             :EX-SAHPRM,
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  30
* SQLDCCGAAP.cbl
  1638             :EX-REIN,
  1639             :EX-AH-REM-BEN,
  1640             :EX-MORT-RESV,
  1641             :EX-SEX-CODE,
  1642             :EX-LOAN-TERM,
  1643             :EX-LF-EXP-DT,
  1644             :EX-AH-EXP-DT,
  1645             :EX-LF-UP-REMTERM,
  1646             :EX-AH-UP-REMTERM,
  1647             :EX-UNLD-STAT-RESV,
  1648             :EX-LFCOM,
  1649             :EX-PLFCOM,
  1650             :EX-RLFCOM,
  1651             :EX-SLFCOM,
  1652             :EX-AHCOM,
  1653             :EX-PAHCOM,
  1654             :EX-RAHCOM,
  1655             :EX-SAHCOM,
  1656             :EX-MO-DEC,
  1657             :EX-MORT-FACT,
  1658             :EX-MORT-AGE,
  1659             :EX-MORT-TABLE,
  1660             :EX-ALT-MORT-TABLE)
  1661     END-EXEC
  1662
  1663     if sqlcode not = 0
  1664        display "Error: cannot insert row "
  1665        display ' sql return code ' sqlcode
  1666        display ' sql err mess    ' sqlerrmc
  1667        display ' recs so far ' rec-cnt
  1668        display ' offending rec ' gaap-detail-record
  1669        goback
  1670     end-if
  1671
  1672     add 1 to rec-cnt
  1673
  1674     .
  1675 0050-exit.
  1676     exit.
  1677
  1678 0055-update-table.
  1679
  1680     move spaces                 to sqlcmd
  1681     string 'update DCC_GAAP_DW '
  1682            'set lf_exp_dt = NULL '
  1683            'where (lf_exp_dt = '
  1684            'CONVERT(DATETIME, ''1900-01-01 00:00:00'', 102))'
  1685        delimited by size into sqlcmd
  1686     end-string
  1687     display ' cmd **' sqlcmd '**'
  1688
  1689     display ' Begin Exp Dt Updates '
  1690     exec sql
  1691        EXECUTE IMMEDIATE :sqlcmd
  1692     end-exec
  1693
  1694*    exec sql
  1695*       UPDATE DCC_GAAP_DW
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  31
* SQLDCCGAAP.cbl
  1696*       SET lf_exp_dt = NULL
  1697*       WHERE (lf_exp_dt =
  1698*          CONVERT(DATETIME, '1900-01-01 00:00:00', 102))
  1699*    end-exec
  1700
  1701     if sqlcode not = 0
  1702        display "Error: update lf exp dt  "
  1703        display ' sql return code ' sqlcode
  1704        display ' sql err mess    ' sqlerrmc
  1705        goback
  1706     end-if
  1707
  1708     display ' Lf Exp Dt Update success '
  1709
  1710     move spaces                 to sqlcmd
  1711     string 'update DCC_GAAP_DW '
  1712            'set ah_exp_dt = NULL '
  1713            'where (ah_exp_dt = '
  1714            'CONVERT(DATETIME, ''1900-01-01 00:00:00'', 102))'
  1715        delimited by size into sqlcmd
  1716     end-string
  1717     display ' cmd **' sqlcmd '**'
  1718
  1719     exec sql
  1720        EXECUTE IMMEDIATE :sqlcmd
  1721     end-exec
  1722
  1723*    exec sql
  1724*       UPDATE DCC_GAAP_DW
  1725*       SET ah_exp_dt = NULL
  1726*       WHERE (ah_exp_dt =
  1727*          CONVERT(DATETIME, '1900-01-01 00:00:00', 102))
  1728*    end-exec
  1729
  1730     if sqlcode not = 0
  1731        display "Error: update ah exp dt  "
  1732        display ' sql return code ' sqlcode
  1733        display ' sql err mess    ' sqlerrmc
  1734        goback
  1735     end-if
  1736
  1737     display ' Ah Exp Dt Update success '
  1738
  1739     .
  1740 0055-exit.
  1741     exit.
  1742
  1743 0060-finish-up.
  1744
  1745     display ' Begin Commit '
  1746     EXEC SQL
  1747         commit transaction
  1748     END-EXEC
  1749     if sqlcode not = 0
  1750        display "Error: commit "
  1751        display ' sql return code ' sqlcode
  1752        display ' sql err mess    ' sqlerrmc
  1753        goback
* Micro Focus Server Express         V5.1 revision 000 14-Aug-13 14:28 Page  32
* SQLDCCGAAP.cbl
  1754     end-if
  1755
  1756     display " Commit trans successful "
  1757
  1758     display ' Begin Disconnect '
  1759     EXEC SQL
  1760         commit work release
  1761     END-EXEC
  1762     if sqlcode not = 0
  1763        display "Error: commit release "
  1764        display ' sql return code ' sqlcode
  1765        display ' sql err mess    ' sqlerrmc
  1766     end-if
  1767
  1768     .
  1769 0060-exit.
  1770     exit.
  1771
  1772 8500-DATE-CONVERT.
* 1773                                 COPY ELCDCS.
  1774****************************************************************  04/15/98
  1775*                                                              *  ELCDCS
  1776*                                                              *  ELCDCS
  1777*                            ELCDCS.                           *     LV003
  1778*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE               CL**2
  1779*                            VMOD=2.002                        *     CL**3
  1780*                                                              *  ELCDCS
  1781*           THIS SECTION CALLS THE DATE CONVERSION SUBROUTINE. *  ELCDCS
  1782****************************************************************. ELCDCS
  1783                                                                  ELCDCS
  1784 8510-DATE-CONVERSION.                                            ELCDCS
  1785     CALL 'ELDATCX' USING DATE-CONVERSION-DATA.                   ELCDCS
  1786                                                                  ELCDCS
  1787 8590-EXIT.                                                       ELCDCS
  1788     EXIT.                                                        ELCDCS
  1789                                                                  ELCDCS
  1790
  1791 abend-pgm.
  1792
  1793      call 'ABORTME'.
  1794
  1795      goback.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      180564     Code:       13704
